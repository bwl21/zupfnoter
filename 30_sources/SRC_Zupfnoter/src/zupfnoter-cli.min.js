!function(){return function t(e,r,n){function i(a,o){if(!r[a]){if(!e[a]){var c="function"==typeof require&&require;if(!o&&c)return c(a,!0);if(s)return s(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var u=r[a]={exports:{}};e[a][0].call(u.exports,function(t){return i(e[a][1][t]||t)},u,u.exports,t,e,r,n)}return r[a].exports}for(var s="function"==typeof require&&require,a=0;a<n.length;a++)i(n[a]);return i}}()({1:[function(t,e,r){!function(t){function e(t,e){"wrap"in(e=e||{})||(e.wrap=80),1==e.wrap&&(e.wrap=-1),"indent"in e||(e.indent="  "),"arrayPadding"in e||(e.arrayPadding="padding"in e?e.padding:0),"objectPadding"in e||(e.objectPadding="padding"in e?e.padding:0),"beforeComma"in e||(e.beforeComma="aroundComma"in e?e.aroundComma:0),"afterComma"in e||(e.afterComma="aroundComma"in e?e.aroundComma:0),"beforeColon"in e||(e.beforeColon="aroundColon"in e?e.aroundColon:0),"afterColon"in e||(e.afterColon="aroundColon"in e?e.aroundColon:0),"beforeColon1"in e||(e.beforeColon1="aroundColon1"in e?e.aroundColon1:"beforeColon"in e?e.beforeColon:0),"afterColon1"in e||(e.afterColon1="aroundColon1"in e?e.aroundColon1:"afterColon"in e?e.afterColon:0),"beforeColonN"in e||(e.beforeColonN="aroundColonN"in e?e.aroundColonN:"beforeColon"in e?e.beforeColon:0),"afterColonN"in e||(e.afterColonN="aroundColonN"in e?e.aroundColonN:"afterColon"in e?e.afterColon:0);var r,n=l(" ",e.arrayPadding),i=l(" ",e.objectPadding),s=l(" ",e.beforeComma)+","+l(" ",e.afterComma),a=l(" ",e.beforeColon1)+":"+l(" ",e.afterColon1),o=l(" ",e.beforeColonN)+":"+l(" ",e.afterColonN),c=(r=new Map,function(t,f){var $=r.get(t);return $||r.set(t,$={}),$[f]||($[f]=function(t,r){if(null==t)return r+"null";if("number"==typeof t){var f=t===+t&&t!==(0|t);return r+(f&&"decimals"in e?t.toFixed(e.decimals):t+"")}if(t instanceof Array){if(!t.length)return r+"[]";var $=t.map(function(t){return c(t,"")}),h=r+"["+n+$.join(s)+n+"]";if(!1===e.wrap||h.length<=e.wrap)return h;if(e.short){var p=r+" "+n;return($=t.map(function(t){return c(t,p)}))[0]=$[0].replace(p,r+"["+n),$[$.length-1]=$[$.length-1]+n+"]",$.join(",\n")}var p=r+e.indent;return r+"[\n"+t.map(function(t){return c(t,p)}).join(",\n")+"\n"+(e.indentLast?p:r)+"]"}if(t instanceof Object){var d=[],_=0,m=e.sort||e.sorted;for(var y in t){var g=d[_++]=[y,t[y]];!0===m?g[2]=y:"function"==typeof m&&(g[2]=m(y,t[y],t))}if(!d.length)return r+"{}";m&&(d=d.sort(function(t,e){return t=t[2],e=e[2],t<e?-1:t>e?1:0}));var v=d.map(function(t){return[JSON.stringify(t[0]),c(t[1],"")]});e.sorted&&(v=v.sort(function(t,e){return t=t[0],e=e[0],t<e?-1:t>e?1:0})),v=v.map(function(t){return t.join(a)}).join(s);var h=r+"{"+i+v+i+"}";if(!1===e.wrap||h.length<e.wrap)return h;if(e.short){if((v=d.map(function(t){return[r+" "+i+JSON.stringify(t[0]),t[1]]}))[0][0]=v[0][0].replace(r+" ",r+"{"),e.aligned){for(var b=0,_=v.length;_--;)v[_][0].length>b&&(b=v[_][0].length);for(var A=l(" ",b),_=v.length;_--;)v[_][0]=u(A,v[_][0])}for(var _=v.length;_--;){var y=v[_][0],x=v[_][1],p=l(" ",(y+o).length),h=y+o+c(x,"");v[_]=!1===e.wrap||h.length<=e.wrap||!x||"object"!=typeof x?h:y+o+c(x,p).replace(/^\s+/,"")}return v.join(",\n")+i+"}"}var v=[],_=0;for(var y in t){var g=v[_++]=[r+e.indent+JSON.stringify(y),t[y]];!0===m?g[2]=y:"function"==typeof m&&(g[2]=m(y,t[y],t))}if(m&&(v=v.sort(function(t,e){return t=t[2],e=e[2],t<e?-1:t>e?1:0})),e.aligned){for(var b=0,_=v.length;_--;)v[_][0].length>b&&(b=v[_][0].length);for(var A=l(" ",b),_=v.length;_--;)v[_][0]=u(A,v[_][0])}for(var p=r+e.indent,_=v.length;_--;){var y=v[_][0],x=v[_][1],h=y+o+c(x,"");v[_]=!1===e.wrap||h.length<=e.wrap||!x||"object"!=typeof x?h:y+o+c(x,p).replace(/^\s+/,"")}return r+"{\n"+v.join(",\n")+"\n"+(e.indentLast?p:r)+"}"}return r+JSON.stringify(t)}(t,f)),$[f]});return c(t,"");function l(t,e){for(var r="";1&e&&(r+=t),e>>=1;)t+=t;return r}function u(t,e){return(e+t).substring(0,t.length)}}t.neatJSON=e,e.version="0.8.3"}(void 0===r?this:r)},{}],2:[function(t,e,r){"use strict";var n=t("./compile"),i=t("./compile/resolve"),s=t("./cache"),a=t("./compile/schema_obj"),o=t("json-stable-stringify"),c=t("./compile/formats"),l=t("./compile/rules"),u=t("./v5"),f=t("./compile/util"),$=t("./async"),h=t("co");e.exports=g,g.prototype.compileAsync=$.compile;var p=t("./keyword");g.prototype.addKeyword=p.add,g.prototype.getKeyword=p.get,g.prototype.removeKeyword=p.remove,g.ValidationError=t("./compile/validation_error");var d="http://json-schema.org/draft-04/schema",_=/^(?:(?:[a-z][a-z0-9+-.]*:)?\/\/)?[^\s]*$/i;function m(t){return _.test(t)}var y=["removeAdditional","useDefaults","coerceTypes"];function g(e){if(!(this instanceof g))return new g(e);var r=this;function p(t,e){var n;if("string"==typeof t){if(!(n=x(t)))throw new Error('no schema with key or ref "'+t+'"')}else{var i=E(t);n=i.validate||S(i)}var s=n(e);return!0===n.$async?"*"==r._opts.async?h(s):s:(r.errors=n.errors,s)}function v(t,e,n,s){if(Array.isArray(t))for(var a=0;a<t.length;a++)v(t[a],void 0,n,s);else C(e=i.normalizeId(e||t.id)),r._schemas[e]=E(t,n,s,!0)}function b(t,e,r){v(t,e,r,!0)}function A(t,e){var n,i,s=t.$schema||r._opts.defaultMeta||(n=r._opts.meta,r._opts.defaultMeta="object"==typeof n?n.id||n:r._opts.v5?u.META_SCHEMA_ID:d,r._opts.defaultMeta),a=r._formats.uri;r._formats.uri="function"==typeof a?m:_;try{i=p(s,t)}finally{r._formats.uri=a}if(!i&&e){var o="schema is invalid: "+N();if("log"!=r._opts.validateSchema)throw new Error(o);console.error(o)}return i}function x(t){var e=w(t);switch(typeof e){case"object":return e.validate||S(e);case"string":return x(e);case"undefined":return function(t){var e=i.schema.call(r,{schema:{}},t);if(e){var s=e.schema,o=e.root,c=e.baseId,l=n.call(r,s,o,void 0,c);return r._fragments[t]=new a({ref:t,fragment:!0,schema:s,root:o,baseId:c,validate:l}),l}}(t)}}function w(t){return t=i.normalizeId(t),r._schemas[t]||r._refs[t]||r._fragments[t]}function k(t,e){for(var n in t){var i=t[n];i.meta||e&&!e.test(n)||(r._cache.del(i.jsonStr),delete t[n])}}function E(t,e,n,s){if("object"!=typeof t)throw new Error("schema should be object");var c=o(t),l=r._cache.get(c);if(l)return l;s=s||!1!==r._opts.addUsedSchema;var u=i.normalizeId(t.id);u&&s&&C(u);var f,$=!1!==r._opts.validateSchema&&!e;$&&!(f=t.id&&t.id==t.$schema)&&A(t,!0);var h=i.ids.call(r,t),p=new a({id:u,schema:t,localRefs:h,jsonStr:c,meta:n});return"#"!=u[0]&&s&&(r._refs[u]=p),r._cache.put(c,p),$&&f&&A(t,!0),p}function S(t,e){if(t.compiling)return t.validate=a,a.schema=t.schema,a.errors=null,a.root=e||a,!0===t.schema.$async&&(a.$async=!0),a;var i,s;t.compiling=!0,t.meta&&(i=r._opts,r._opts=r._metaOpts);try{s=n.call(r,t.schema,e,t.localRefs)}finally{t.compiling=!1,t.meta&&(r._opts=i)}return t.validate=s,t.refs=s.refs,t.refVal=s.refVal,t.root=s.root,s;function a(){var e=t.validate,r=e.apply(null,arguments);return a.errors=e.errors,r}}function N(t,e){if(!(t=t||r.errors))return"No errors";for(var n=void 0===(e=e||{}).separator?", ":e.separator,i=void 0===e.dataVar?"data":e.dataVar,s="",a=0;a<t.length;a++){var o=t[a];o&&(s+=i+o.dataPath+" "+o.message+n)}return s.slice(0,-n.length)}function I(t,e){"string"==typeof e&&(e=new RegExp(e)),r._formats[t]=e}function C(t){if(r._schemas[t]||r._refs[t])throw new Error('schema with key or id "'+t+'" already exists')}e=this._opts=f.copy(e)||{},this._schemas={},this._refs={},this._fragments={},this._formats=c(e.format),this._cache=e.cache||new s,this._loadingSchemas={},this._compilations=[],this.RULES=l(),this.validate=p,this.compile=function(t,e){var r=E(t,void 0,e);return r.validate||S(r)},this.addSchema=v,this.addMetaSchema=b,this.validateSchema=A,this.getSchema=x,this.removeSchema=function(t){if(t instanceof RegExp)return k(r._schemas,t),void k(r._refs,t);switch(typeof t){case"undefined":return k(r._schemas),k(r._refs),void r._cache.clear();case"string":var e=w(t);return e&&r._cache.del(e.jsonStr),delete r._schemas[t],void delete r._refs[t];case"object":var n=o(t);r._cache.del(n);var s=t.id;s&&(s=i.normalizeId(s),delete r._schemas[s],delete r._refs[s])}},this.addFormat=I,this.errorsText=N,this._addSchema=E,this._compile=S,e.loopRequired=e.loopRequired||1/0,(e.async||e.transpile)&&$.setup(e),!0===e.beautify&&(e.beautify={indent_size:2}),"property"==e.errorDataPath&&(e._errorDataPathProperty=!0),this._metaOpts=function(){for(var t=f.copy(r._opts),e=0;e<y.length;e++)delete t[y[e]];return t}(),e.formats&&function(){for(var t in r._opts.formats){var e=r._opts.formats[t];I(t,e)}}(),function(){if(!1!==r._opts.meta){var e=t("./refs/json-schema-draft-04.json");b(e,d,!0),r._refs["http://json-schema.org/schema"]=d}}(),e.v5&&u.enable(this),"object"==typeof e.meta&&b(e.meta),function(){var t=r._opts.schemas;if(!t)return;if(Array.isArray(t))v(t);else for(var e in t)v(t[e],e)}()}},{"./async":3,"./cache":4,"./compile":8,"./compile/formats":7,"./compile/resolve":9,"./compile/rules":10,"./compile/schema_obj":11,"./compile/util":13,"./compile/validation_error":14,"./keyword":39,"./refs/json-schema-draft-04.json":40,"./v5":42,co:45,"json-stable-stringify":78}],3:[function(t,e,r){"use strict";e.exports={setup:function t(e,r){!1!==r&&(r=!0);var n,i=e.async,l=e.transpile;switch(typeof l){case"string":var u=o[l];if(!u)throw new Error("bad transpiler: "+l);return e._transpileFunc=u(e,r);case"undefined":case"boolean":if("string"==typeof i){if(!(n=a[i]))throw new Error("bad async mode: "+i);return e.transpile=n(e,r)}for(var f=0;f<c.length;f++){var $=c[f];if(t($,!1))return s.copy($,e),e.transpile}throw new Error("generators, nodent and regenerator are not available");case"function":return e._transpileFunc=e.transpile;default:throw new Error("bad transpiler: "+l)}},compile:function(t,e){var r,n=this;try{r=this._addSchema(t)}catch(t){return void setTimeout(function(){e(t)})}if(r.validate)setTimeout(function(){e(null,r.validate)});else{if("function"!=typeof this._opts.loadSchema)throw new Error("options.loadSchema should be a function");!function t(e,r,i){var s;try{s=n.compile(e)}catch(t){return void(t.missingSchema?function a(t){var i=t.missingSchema;if(n._refs[i]||n._schemas[i])return r(new Error("Schema "+i+" is loaded but "+t.missingRef+" cannot be resolved"));var s=n._loadingSchemas[i];s?"function"==typeof s?n._loadingSchemas[i]=[s,a]:s[s.length]=a:(n._loadingSchemas[i]=a,n._opts.loadSchema(i,function(t,e){var r=n._loadingSchemas[i];if(delete n._loadingSchemas[i],"function"==typeof r)r(t,e);else for(var s=0;s<r.length;s++)r[s](t,e)}));function a(t,s){if(t)return r(t);if(!n._refs[i]&&!n._schemas[i])try{n.addSchema(s,i)}catch(t){return void r(t)}!function t(e,r,i){var s;try{s=n.compile(e)}catch(t){return void(t.missingSchema?a(t):o(t))}o(null,s);function a(i){var s=i.missingSchema;if(n._refs[s]||n._schemas[s])return r(new Error("Schema "+s+" is loaded but "+i.missingRef+" cannot be resolved"));var a=n._loadingSchemas[s];function o(i,a){if(i)return r(i);if(!n._refs[s]&&!n._schemas[s])try{n.addSchema(a,s)}catch(t){return void r(t)}t(e,r)}a?"function"==typeof a?n._loadingSchemas[s]=[a,o]:a[a.length]=o:(n._loadingSchemas[s]=o,n._opts.loadSchema(s,function(t,e){var r=n._loadingSchemas[s];if(delete n._loadingSchemas[s],"function"==typeof r)r(t,e);else for(var i=0;i<r.length;i++)r[i](t,e)}))}function o(t,e){if(!i)return r(t,e);setTimeout(function(){r(t,e)})}}(e,r)}}(t):o(t))}o(null,s);function a(i){var s=i.missingSchema;if(n._refs[s]||n._schemas[s])return r(new Error("Schema "+s+" is loaded but "+i.missingRef+" cannot be resolved"));var a=n._loadingSchemas[s];function o(i,a){if(i)return r(i);if(!n._refs[s]&&!n._schemas[s])try{n.addSchema(a,s)}catch(t){return void r(t)}t(e,r)}a?"function"==typeof a?n._loadingSchemas[s]=[a,o]:a[a.length]=o:(n._loadingSchemas[s]=o,n._opts.loadSchema(s,function(t,e){var r=n._loadingSchemas[s];if(delete n._loadingSchemas[s],"function"==typeof r)r(t,e);else for(var i=0;i<r.length;i++)r[i](t,e)}))}function o(t,e){if(!i)return r(t,e);setTimeout(function(){r(t,e)})}}(t,e,!0)}}};var n,i,s=t("./compile/util"),a={"*":l,"co*":l,es7:function(t,e){try{return new Function("(async function(){})()")(),!0}catch(t){if(e)throw new Error("es7 async functions not supported")}}},o={nodent:function(e,r){try{if(!i){i=t("nodent")({log:!1,dontInstallRequireHook:!0})}return"es7"!=e.async&&(e.async&&!0!==e.async&&console.warn("nodent transpiles only es7 async functions"),e.async="es7"),f}catch(t){if(r)throw new Error("nodent not available")}},regenerator:function(e,r){try{if(!n){(n=t("regenerator")).runtime()}return e.async&&!0!==e.async||(e.async="es7"),u}catch(t){if(r)throw new Error("regenerator not available")}}},c=[{async:"co*"},{async:"es7",transpile:"nodent"},{async:"co*",transpile:"regenerator"}];function l(t,e){try{return new Function("(function*(){})()")(),!0}catch(t){if(e)throw new Error("generators not supported")}}function u(t){return n.compile(t).code}function f(t){return i.compile(t,"",{promises:!0,sourcemap:!1}).code}},{"./compile/util":13}],4:[function(t,e,r){"use strict";var n=e.exports=function(){this._cache={}};n.prototype.put=function(t,e){this._cache[t]=e},n.prototype.get=function(t){return this._cache[t]},n.prototype.del=function(t){delete this._cache[t]},n.prototype.clear=function(){this._cache={}}},{}],5:[function(t,e,r){"use strict";e.exports={$ref:t("../dotjs/ref"),allOf:t("../dotjs/allOf"),anyOf:t("../dotjs/anyOf"),dependencies:t("../dotjs/dependencies"),enum:t("../dotjs/enum"),format:t("../dotjs/format"),items:t("../dotjs/items"),maximum:t("../dotjs/_limit"),minimum:t("../dotjs/_limit"),maxItems:t("../dotjs/_limitItems"),minItems:t("../dotjs/_limitItems"),maxLength:t("../dotjs/_limitLength"),minLength:t("../dotjs/_limitLength"),maxProperties:t("../dotjs/_limitProperties"),minProperties:t("../dotjs/_limitProperties"),multipleOf:t("../dotjs/multipleOf"),not:t("../dotjs/not"),oneOf:t("../dotjs/oneOf"),pattern:t("../dotjs/pattern"),properties:t("../dotjs/properties"),required:t("../dotjs/required"),uniqueItems:t("../dotjs/uniqueItems"),validate:t("../dotjs/validate")}},{"../dotjs/_limit":16,"../dotjs/_limitItems":17,"../dotjs/_limitLength":18,"../dotjs/_limitProperties":19,"../dotjs/allOf":20,"../dotjs/anyOf":21,"../dotjs/dependencies":24,"../dotjs/enum":25,"../dotjs/format":26,"../dotjs/items":27,"../dotjs/multipleOf":28,"../dotjs/not":29,"../dotjs/oneOf":30,"../dotjs/pattern":31,"../dotjs/properties":33,"../dotjs/ref":34,"../dotjs/required":35,"../dotjs/uniqueItems":37,"../dotjs/validate":38}],6:[function(t,e,r){"use strict";e.exports=function t(e,r){if(e===r)return!0;var n,i=Array.isArray(e),s=Array.isArray(r);if(i&&s){if(e.length!=r.length)return!1;for(n=0;n<e.length;n++)if(!t(e[n],r[n]))return!1;return!0}if(i!=s)return!1;if(e&&r&&"object"==typeof e&&"object"==typeof r){var a=Object.keys(e);if(a.length!==Object.keys(r).length)return!1;var o=e instanceof Date,c=r instanceof Date;if(o&&c)return e.getTime()==r.getTime();if(o!=c)return!1;var l=e instanceof RegExp,u=r instanceof RegExp;if(l&&u)return e.toString()==r.toString();if(l!=u)return!1;for(n=0;n<a.length;n++)if(!Object.prototype.hasOwnProperty.call(r,a[n]))return!1;for(n=0;n<a.length;n++)if(!t(e[a[n]],r[a[n]]))return!1;return!0}return!1}},{}],7:[function(t,e,r){"use strict";var n=t("./util"),i=/^\d\d\d\d-(\d\d)-(\d\d)$/,s=[0,31,29,31,30,31,30,31,31,30,31,30,31],a=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d:\d\d)?$/i,o=/^[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*$/i,c=/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@\/?]|%[0-9a-f]{2})*)?(?:\#(?:[a-z0-9\-._~!$&'()*+,;=:@\/?]|%[0-9a-f]{2})*)?$/i,l=/^(?:urn\:uuid\:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,u=/^(?:\/(?:[^~\/]|~0|~1)*)*$|^\#(?:\/(?:[a-z0-9_\-\.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,f=/^(?:0|[1-9][0-9]*)(?:\#|(?:\/(?:[^~\/]|~0|~1)*)*)$/;function $(t){t="full"==t?"full":"fast";var e=n.copy($[t]);for(var r in $.compare)e[r]={validate:e[r],compare:$.compare[r]};return e}function h(t){var e=t.match(i);if(!e)return!1;var r=+e[1],n=+e[2];return r>=1&&r<=12&&n>=1&&n<=s[r]}function p(t,e){var r=t.match(a);if(!r)return!1;var n=r[1],i=r[2],s=r[3],o=r[5];return n<=23&&i<=59&&s<=59&&(!e||o)}e.exports=$,$.fast={date:/^\d\d\d\d-[0-1]\d-[0-3]\d$/,time:/^[0-2]\d:[0-5]\d:[0-5]\d(?:\.\d+)?(?:z|[+-]\d\d:\d\d)?$/i,"date-time":/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s][0-2]\d:[0-5]\d:[0-5]\d(?:\.\d+)?(?:z|[+-]\d\d:\d\d)$/i,uri:/^(?:[a-z][a-z0-9+-.]*)?(?:\:|\/)\/?[^\s]*$/i,email:/^[a-z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i,hostname:o,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:m,uuid:l,"json-pointer":u,"relative-json-pointer":f},$.full={date:h,time:p,"date-time":function(t){var e=t.split(d);return 2==e.length&&h(e[0])&&p(e[1],!0)},uri:function(t){return _.test(t)&&c.test(t)},email:/^[a-z0-9!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&''*+\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:function(t){return t.length<=255&&o.test(t)},ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:m,uuid:l,"json-pointer":u,"relative-json-pointer":f},$.compare={date:y,time:g,"date-time":function(t,e){if(!t||!e)return;t=t.split(d),e=e.split(d);var r=y(t[0],e[0]);if(void 0===r)return;return r||g(t[1],e[1])}};var d=/t|\s/i;var _=/\/|\:/;function m(t){try{return new RegExp(t),!0}catch(t){return!1}}function y(t,e){if(t&&e)return t>e?1:t<e?-1:t===e?0:void 0}function g(t,e){if(t&&e&&(t=t.match(a),e=e.match(a),t&&e))return(t=t[1]+t[2]+t[3]+(t[4]||""))>(e=e[1]+e[2]+e[3]+(e[4]||""))?1:t<e?-1:t===e?0:void 0}},{"./util":13}],8:[function(t,e,r){"use strict";var n,i=t("./resolve"),s=t("./util"),a=t("json-stable-stringify"),o=t("../async");var c=t("../dotjs/validate"),l=t("co"),u=s.ucs2length,f=t("./equal"),$=t("./validation_error");function h(t,e,r){for(var n=0;n<this._compilations.length;n++){var i=this._compilations[n];if(i.schema==t&&i.root==e&&i.baseId==r)return n}return-1}function p(t,e){return"var pattern"+t+" = new RegExp("+s.toQuotedString(e[t])+");"}function d(t){return"var default"+t+" = defaults["+t+"];"}function _(t,e){return e[t]?"var refVal"+t+" = refVal["+t+"];":""}function m(t){return"var customRule"+t+" = customRules["+t+"];"}function y(t,e){if(!t.length)return"";for(var r="",n=0;n<t.length;n++)r+=e(n,t);return r}e.exports=function e(r,g,v,b){var A=this,x=this._opts,w=[void 0],k={},E=[],S={},N=[],I={},C=[],O=!1!==x.sourceCode;g=g||{schema:r,refVal:w,refs:k};var B=function(t,e,r){var n=h.call(this,t,e,r);return n>=0?{index:n,compiling:!0}:(n=this._compilations.length,this._compilations[n]={schema:t,root:e,baseId:r},{index:n,compiling:!1})}.call(this,r,g,b);var M=this._compilations[B.index];if(B.compiling)return M.callValidate=function t(){var e=M.validate;var r=e.apply(null,arguments);t.errors=e.errors;return r};var P=this._formats;var F=this.RULES;try{var L=j(r,g,v,b);M.validate=L;var T=M.callValidate;return T&&(T.schema=L.schema,T.errors=null,T.refs=L.refs,T.refVal=L.refVal,T.root=L.root,T.$async=L.$async,O&&(T.sourceCode=L.sourceCode)),L}finally{(function(t,e,r){var n=h.call(this,t,e,r);n>=0&&this._compilations.splice(n,1)}).call(this,r,g,b)}function j(r,a,h,v){var b=!a||a&&a.schema==r;if(a.schema!=g.schema)return e.call(A,r,a,h,v);var S=!0===r.$async;S&&!x.transpile&&o.setup(x);var I=c({isTop:!0,schema:r,isRoot:b,baseId:v,root:a,schemaPath:"",errSchemaPath:"#",errorPath:'""',RULES:F,validate:c,util:s,resolve:i,resolveRef:R,usePattern:U,useDefault:q,useCustomRule:H,opts:x,formats:P,self:A});I=y(w,_)+y(E,p)+y(N,d)+y(C,m)+I,x.beautify&&(!function(){if(void 0===n)try{n=t("js-beautify").js_beautify}catch(t){n=!1}}(),n?I=n(I,x.beautify):console.error('"npm install js-beautify" to use beautify option'));var B,M,L=x._transpileFunc;try{M=S&&L?L(I):I;var T=new Function("self","RULES","formats","root","refVal","defaults","customRules","co","equal","ucs2length","ValidationError",M);B=T(A,F,P,g,w,N,C,l,f,u,$),w[0]=B}catch(t){throw console.error("Error compiling schema, function code:",M),t}return B.schema=r,B.errors=null,B.refs=k,B.refVal=w,B.root=b?B:a,S&&(B.$async=!0),O&&(B.sourceCode=I),!0===x.sourceCode&&(B.source={patterns:E,defaults:N}),B}function R(t,r,n){r=i.url(t,r);var s,a,o=k[r];if(void 0!==o)return z(s=w[o],a="refVal["+o+"]");if(!n&&g.refs){var c=g.refs[r];if(void 0!==c)return s=g.refVal[c],a=D(r,s),z(s,a)}a=D(r);var l=i.call(A,j,g,r);if(!l){var u=v&&v[r];u&&(l=i.inlineRef(u,x.inlineRefs)?u:e.call(A,u,g,v,t))}return l?(function(t,e){var r=k[t];w[r]=e}(r,l),z(l,a)):void 0}function D(t,e){var r=w.length;return w[r]=e,k[t]=r,"refVal"+r}function z(t,e){return"object"==typeof t?{code:e,schema:t,inline:!0}:{code:e,$async:t&&t.$async}}function U(t){var e=S[t];return void 0===e&&(e=S[t]=E.length,E[e]=t),"pattern"+e}function q(t){switch(typeof t){case"boolean":case"number":return""+t;case"string":return s.toQuotedString(t);case"object":if(null===t)return"null";var e=a(t),r=I[e];return void 0===r&&(r=I[e]=N.length,N[r]=t),"default"+r}}function H(t,e,r,n){var i=t.definition.validateSchema;if(i&&!1!==A._opts.validateSchema){var s=i(e);if(!s){var a="keyword schema is invalid: "+A.errorsText(i.errors);if("log"!=A._opts.validateSchema)throw new Error(a);console.error(a)}}var o,c=t.definition.compile,l=t.definition.inline,u=t.definition.macro;c?o=c.call(A,e,r,n):u?(o=u.call(A,e,r,n),!1!==x.validateSchema&&A.validateSchema(o,!0)):o=l?l.call(A,n,t.keyword,e,r):t.definition.validate;var f=C.length;return C[f]=o,{code:"customRule"+f,validate:o}}}},{"../async":3,"../dotjs/validate":38,"./equal":6,"./resolve":9,"./util":13,"./validation_error":14,co:45,"json-stable-stringify":78}],9:[function(t,e,r){"use strict";var n=t("url"),i=t("./equal"),s=t("./util"),a=t("./schema_obj");function o(t,e,r){var n=this._refs[r];if("string"==typeof n){if(!this._refs[n])return o.call(this,t,e,n);n=this._refs[n]}if((n=n||this._schemas[r])instanceof a)return $(n.schema,this._opts.inlineRefs)?n.schema:n.validate||this._compile(n);var i,s,l,u=c.call(this,e,r);return u&&(i=u.schema,e=u.root,l=u.baseId),i instanceof a?s=i.validate||t.call(this,i.schema,e,void 0,l):i&&(s=$(i,this._opts.inlineRefs)?i:t.call(this,i,e,void 0,l)),s}function c(t,e){var r=n.parse(e,!1,!0),i=p(r),s=h(t.schema.id);if(i!==s){var o=_(i),l=this._refs[o];if("string"==typeof l)return function(t,e,r){var n=c.call(this,t,e);if(n){var i=n.schema,s=n.baseId;return t=n.root,i.id&&(s=m(s,i.id)),u.call(this,r,s,i,t)}}.call(this,t,l,r);if(l instanceof a)l.validate||this._compile(l),t=l;else{if(!((l=this._schemas[o])instanceof a))return;if(l.validate||this._compile(l),o==_(e))return{schema:l,root:t,baseId:s};t=l}if(!t.schema)return;s=h(t.schema.id)}return u.call(this,r,s,t.schema,t)}e.exports=o,o.normalizeId=_,o.fullPath=h,o.url=m,o.ids=function(t){var e=_(t.id),r={};return function t(e,a,o){if(Array.isArray(e))for(var c=0;c<e.length;c++)t.call(this,e[c],a+"/"+c,o);else if(e&&"object"==typeof e){if("string"==typeof e.id){var l=o=o?n.resolve(o,e.id):e.id;l=_(l);var u=this._refs[l];if("string"==typeof u&&(u=this._refs[u]),u&&u.schema){if(!i(e,u.schema))throw new Error('id "'+l+'" resolves to more than one schema')}else if(l!=_(a))if("#"==l[0]){if(r[l]&&!i(e,r[l]))throw new Error('id "'+l+'" resolves to more than one schema');r[l]=e}else this._refs[l]=a}for(var f in e)t.call(this,e[f],a+"/"+s.escapeFragment(f),o)}}.call(this,t,h(e,!1),e),r},o.inlineRef=$,o.schema=c;var l=s.toHash(["properties","patternProperties","enum","dependencies","definitions"]);function u(t,e,r,n){if(t.hash=t.hash||"","#/"==t.hash.slice(0,2)){for(var i=t.hash.split("/"),a=1;a<i.length;a++){var o=i[a];if(o){if(!(r=r[o=s.unescapeFragment(o)]))break;if(r.id&&!l[o]&&(e=m(e,r.id)),r.$ref){var u=m(e,r.$ref),f=c.call(this,n,u);f&&(r=f.schema,n=f.root,e=f.baseId)}}}return r&&r!=n.schema?{schema:r,root:n,baseId:e}:void 0}}var f=s.toHash(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum"]);function $(t,e){return!1!==e&&(void 0===e||!0===e?function t(e){var r;if(Array.isArray(e)){for(var n=0;n<e.length;n++)if("object"==typeof(r=e[n])&&!t(r))return!1}else for(var i in e){if("$ref"==i)return!1;if("object"==typeof(r=e[i])&&!t(r))return!1}return!0}(t):e?function t(e){var r,n=0;if(Array.isArray(e)){for(var i=0;i<e.length;i++)if("object"==typeof(r=e[i])&&(n+=t(r)),n==1/0)return 1/0}else for(var s in e){if("$ref"==s)return 1/0;if(f[s])n++;else if("object"==typeof(r=e[s])&&(n+=t(r)+1),n==1/0)return 1/0}return n}(t)<=e:void 0)}function h(t,e){return!1!==e&&(t=_(t)),p(n.parse(t,!1,!0))}function p(t){var e=t.protocol||"//"==t.href.slice(0,2)?"//":"";return(t.protocol||"")+e+(t.host||"")+(t.path||"")+"#"}var d=/#\/?$/;function _(t){return t?t.replace(d,""):""}function m(t,e){return e=_(e),n.resolve(t,e)}},{"./equal":6,"./schema_obj":11,"./util":13,url:void 0}],10:[function(t,e,r){"use strict";var n=t("./_rules"),i=t("./util").toHash;e.exports=function(){var t=[{type:"number",rules:["maximum","minimum","multipleOf"]},{type:"string",rules:["maxLength","minLength","pattern","format"]},{type:"array",rules:["maxItems","minItems","uniqueItems","items"]},{type:"object",rules:["maxProperties","minProperties","required","dependencies","properties"]},{rules:["$ref","enum","not","anyOf","oneOf","allOf"]}],e=["type","additionalProperties","patternProperties"];return t.all=i(e),t.forEach(function(r){r.rules=r.rules.map(function(r){return e.push(r),t.all[r]={keyword:r,code:n[r]}})}),t.keywords=i(e.concat(["additionalItems","$schema","id","title","description","default"])),t.types=i(["number","integer","string","array","object","boolean","null"]),t.custom={},t}},{"./_rules":5,"./util":13}],11:[function(t,e,r){"use strict";var n=t("./util");e.exports=function(t){n.copy(t,this)}},{"./util":13}],12:[function(t,e,r){"use strict";e.exports=function(t){for(var e,r=0,n=t.length,i=0;i<n;)r++,(e=t.charCodeAt(i++))>=55296&&e<=56319&&i<n&&56320==(64512&(e=t.charCodeAt(i)))&&i++;return r}},{}],13:[function(t,e,r){"use strict";function n(t,e,r){var n=r?" !== ":" === ",i=r?" || ":" && ",s=r?"!":"",a=r?"":"!";switch(t){case"null":return e+n+"null";case"array":return s+"Array.isArray("+e+")";case"object":return"("+s+e+i+"typeof "+e+n+'"object"'+i+a+"Array.isArray("+e+"))";case"integer":return"(typeof "+e+n+'"number"'+i+a+"("+e+" % 1)"+i+e+n+e+")";default:return"typeof "+e+n+'"'+t+'"'}}e.exports={copy:function(t,e){for(var r in e=e||{},t)e[r]=t[r];return e},checkDataType:n,checkDataTypes:function(t,e){switch(t.length){case 1:return n(t[0],e,!0);default:var r="",i=s(t);for(var a in i.array&&i.object&&(r=i.null?"(":"(!"+e+" || ",r+="typeof "+e+' !== "object")',delete i.null,delete i.array,delete i.object),i.number&&delete i.integer,i)r+=(r?" && ":"")+n(a,e,!0);return r}},coerceToTypes:function(t,e){if(Array.isArray(e)){for(var r=[],n=0;n<e.length;n++){var s=e[n];i[s]?r[r.length]=s:"array"===t&&"array"===s&&(r[r.length]=s)}if(r.length)return r}else{if(i[e])return[e];if("array"===t&&"array"===e)return["array"]}},toHash:s,getProperty:c,escapeQuotes:l,ucs2length:t("./ucs2length"),varOccurences:function(t,e){e+="[^0-9]";var r=t.match(new RegExp(e,"g"));return r?r.length:0},varReplace:function(t,e,r){return e+="([^0-9])",r=r.replace(/\$/g,"$$$$"),t.replace(new RegExp(e,"g"),r+"$1")},cleanUpCode:function(t){return t.replace(u,"").replace(f,"").replace($,"if (!($1))")},cleanUpVarErrors:function(t,e){var r=t.match(h);return r&&2===r.length?e?t.replace(d,"").replace(y,g):t.replace(p,"").replace(_,m):t},schemaHasRules:function(t,e){for(var r in t)if(e[r])return!0},schemaHasRulesExcept:function(t,e,r){for(var n in t)if(n!=r&&e[n])return!0},stableStringify:t("json-stable-stringify"),toQuotedString:v,getPathExpr:function(t,e,r,n){return x(t,r?"'/' + "+e+(n?"":".replace(/~/g, '~0').replace(/\\//g, '~1')"):n?"'[' + "+e+" + ']'":"'[\\'' + "+e+" + '\\']'")},getPath:function(t,e,r){var n=v(r?"/"+w(e):c(e));return x(t,n)},getData:function(t,e,r){var n,i,s,a;if(""===t)return"rootData";if("/"==t[0]){if(!b.test(t))throw new Error("Invalid JSON-pointer: "+t);i=t,s="rootData"}else{if(!(a=t.match(A)))throw new Error("Invalid JSON-pointer: "+t);if(n=+a[1],"#"==(i=a[2])){if(n>=e)throw new Error("Cannot access property/index "+n+" levels up, current level is "+e);return r[e-n]}if(n>e)throw new Error("Cannot access data "+n+" levels up, current level is "+e);if(s="data"+(e-n||""),!i)return s}for(var o=s,l=i.split("/"),u=0;u<l.length;u++){var f=l[u];f&&(s+=c(k(f)),o+=" && "+s)}return o},unescapeFragment:function(t){return k(decodeURIComponent(t))},escapeFragment:function(t){return encodeURIComponent(w(t))},escapeJsonPointer:w};var i=s(["string","number","integer","boolean","null"]);function s(t){for(var e={},r=0;r<t.length;r++)e[t[r]]=!0;return e}var a=/^[a-z$_][a-z$_0-9]*$/i,o=/'|\\/g;function c(t){return"number"==typeof t?"["+t+"]":a.test(t)?"."+t:"['"+l(t)+"']"}function l(t){return t.replace(o,"\\$&").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\f/g,"\\f").replace(/\t/g,"\\t")}var u=/else\s*{\s*}/g,f=/if\s*\([^)]+\)\s*\{\s*\}(?!\s*else)/g,$=/if\s*\(([^)]+)\)\s*\{\s*\}\s*else(?!\s*if)/g;var h=/[^v\.]errors/g,p=/var errors = 0;|var vErrors = null;|validate.errors = vErrors;/g,d=/var errors = 0;|var vErrors = null;/g,_="return errors === 0;",m="validate.errors = null; return true;",y=/if \(errors === 0\) return true;\s*else throw new ValidationError\(vErrors\);/,g="return true;";function v(t){return"'"+l(t)+"'"}var b=/^\/(?:[^~]|~0|~1)*$/,A=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function x(t,e){return'""'==t?e:(t+" + "+e).replace(/' \+ '/g,"")}function w(t){return t.replace(/~/g,"~0").replace(/\//g,"~1")}function k(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}},{"./ucs2length":12,"json-stable-stringify":78}],14:[function(t,e,r){"use strict";function n(t){this.message="validation failed",this.errors=t,this.ajv=this.validation=!0}e.exports=n,n.prototype=Object.create(Error.prototype),n.prototype.constructor=n},{}],15:[function(t,e,r){"use strict";e.exports=function(t,e){var r=" ",n=t.level,i=t.dataLevel,s=t.schema[e],a=t.schemaPath+t.util.getProperty(e),o=t.errSchemaPath+"/"+e,c=!t.opts.allErrors,l="data"+(i||""),u="valid"+n;if(r+="var "+u+" = undefined;",!1===t.opts.format)return r+=" "+u+" = true; ";var f=t.schema.format,$=t.opts.v5&&f.$data,h="";if($){r+=" var "+(p="format"+n)+" = formats["+t.util.getData(f.$data,i,t.dataPathArr)+"] , "+(d="compare"+n)+" = "+p+" && "+p+".compare;"}else{var p;if(!(p=t.formats[f])||!p.compare)return r+="  "+u+" = true; ";var d="formats"+t.util.getProperty(f)+".compare"}var _,m="formatMaximum"==e,y="formatExclusive"+(m?"Maximum":"Minimum"),g=t.schema[y],v=t.opts.v5&&g&&g.$data,b=m?"<":">",A="result"+n,x=t.opts.v5&&s&&s.$data;if(x?(r+=" var schema"+n+" = "+t.util.getData(s.$data,i,t.dataPathArr)+"; ",_="schema"+n):_=s,v){var w=t.util.getData(g.$data,i,t.dataPathArr),k="exclusive"+n,E="' + "+(I="op"+n)+" + '";r+=" var schemaExcl"+n+" = "+w+"; ",r+=" if (typeof "+(w="schemaExcl"+n)+" != 'boolean' && "+w+" !== undefined) { "+u+" = false; ";var S=y;(C=C||[]).push(r),r="",!1!==t.createErrors?(r+=" { keyword: '"+(S||"_formatExclusiveLimit")+"' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(o)+" , params: {} ",!1!==t.opts.messages&&(r+=" , message: '"+y+" should be boolean' "),t.opts.verbose&&(r+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ";var N=r;r=C.pop(),!t.compositeRule&&c?t.async?r+=" throw new ValidationError(["+N+"]); ":r+=" validate.errors = ["+N+"]; return false; ":r+=" var err = "+N+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" }  ",c&&(h+="}",r+=" else { "),x&&(r+=" if ("+_+" === undefined) "+u+" = true; else if (typeof "+_+" != 'string') "+u+" = false; else { ",h+="}"),$&&(r+=" if (!"+d+") "+u+" = true; else { ",h+="}"),r+=" var "+A+" = "+d+"("+l+",  ",r+=x?""+_:""+t.util.toQuotedString(s),r+=" ); if ("+A+" === undefined) "+u+" = false; var "+k+" = "+w+" === true; if ("+u+" === undefined) { "+u+" = "+k+" ? "+A+" "+b+" 0 : "+A+" "+b+"= 0; } if (!"+u+") var op"+n+" = "+k+" ? '"+b+"' : '"+b+"=';"}else{E=b;(k=!0===g)||(E+="=");var I="'"+E+"'";x&&(r+=" if ("+_+" === undefined) "+u+" = true; else if (typeof "+_+" != 'string') "+u+" = false; else { ",h+="}"),$&&(r+=" if (!"+d+") "+u+" = true; else { ",h+="}"),r+=" var "+A+" = "+d+"("+l+",  ",r+=x?""+_:""+t.util.toQuotedString(s),r+=" ); if ("+A+" === undefined) "+u+" = false; if ("+u+" === undefined) "+u+" = "+A+" "+b,k||(r+="="),r+=" 0;"}r+=h+"if (!"+u+") { ";var C;S=e;(C=C||[]).push(r),r="",!1!==t.createErrors?(r+=" { keyword: '"+(S||"_formatLimit")+"' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(o)+" , params: { comparison: "+I+", limit:  ",r+=x?""+_:""+t.util.toQuotedString(s),r+=" , exclusive: "+k+" } ",!1!==t.opts.messages&&(r+=" , message: 'should be "+E+' "',r+=x?"' + "+_+" + '":""+t.util.escapeQuotes(s),r+="\"' "),t.opts.verbose&&(r+=" , schema:  ",r+=x?"validate.schema"+a:""+t.util.toQuotedString(s),r+="         , parentSchema: validate.schema"+t.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ";N=r;return r=C.pop(),!t.compositeRule&&c?t.async?r+=" throw new ValidationError(["+N+"]); ":r+=" validate.errors = ["+N+"]; return false; ":r+=" var err = "+N+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+="}"}},{}],16:[function(t,e,r){"use strict";e.exports=function(t,e){var r,n=" ",i=t.level,s=t.dataLevel,a=t.schema[e],o=t.schemaPath+t.util.getProperty(e),c=t.errSchemaPath+"/"+e,l=!t.opts.allErrors,u="data"+(s||""),f=t.opts.v5&&a&&a.$data;f?(n+=" var schema"+i+" = "+t.util.getData(a.$data,s,t.dataPathArr)+"; ",r="schema"+i):r=a;var $="maximum"==e,h=$?"exclusiveMaximum":"exclusiveMinimum",p=t.schema[h],d=$?"<":">",_=$?">":"<";if(t.opts.v5&&p&&p.$data){var m=t.util.getData(p.$data,s,t.dataPathArr),y="exclusive"+i,g="' + "+(A="op"+i)+" + '";n+=" var schemaExcl"+i+" = "+m+"; ",n+=" var exclusive"+i+"; if (typeof "+(m="schemaExcl"+i)+" != 'boolean' && typeof "+m+" != 'undefined') { ";var v=h;(x=x||[]).push(n),n="",!1!==t.createErrors?(n+=" { keyword: '"+(v||"_exclusiveLimit")+"' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(c)+" , params: {} ",!1!==t.opts.messages&&(n+=" , message: '"+h+" should be boolean' "),t.opts.verbose&&(n+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+u+" "),n+=" } "):n+=" {} ";var b=n;n=x.pop(),!t.compositeRule&&l?t.async?n+=" throw new ValidationError(["+b+"]); ":n+=" validate.errors = ["+b+"]; return false; ":n+=" var err = "+b+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } else if( ",f&&(n+=" ("+r+" !== undefined && typeof "+r+" != 'number') || "),n+=" ((exclusive"+i+" = "+m+" === true) ? "+u+" "+_+"= "+r+" : "+u+" "+_+" "+r+") || "+u+" !== "+u+") { var op"+i+" = exclusive"+i+" ? '"+d+"' : '"+d+"=';"}else{g=d;(y=!0===p)||(g+="=");var A="'"+g+"'";n+=" if ( ",f&&(n+=" ("+r+" !== undefined && typeof "+r+" != 'number') || "),n+=" "+u+" "+_,y&&(n+="="),n+=" "+r+" || "+u+" !== "+u+") {"}var x;v=e;(x=x||[]).push(n),n="",!1!==t.createErrors?(n+=" { keyword: '"+(v||"_limit")+"' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(c)+" , params: { comparison: "+A+", limit: "+r+", exclusive: "+y+" } ",!1!==t.opts.messages&&(n+=" , message: 'should be "+g+" ",n+=f?"' + "+r:a+"'"),t.opts.verbose&&(n+=" , schema:  ",n+=f?"validate.schema"+o:""+a,n+="         , parentSchema: validate.schema"+t.schemaPath+" , data: "+u+" "),n+=" } "):n+=" {} ";b=n;return n=x.pop(),!t.compositeRule&&l?t.async?n+=" throw new ValidationError(["+b+"]); ":n+=" validate.errors = ["+b+"]; return false; ":n+=" var err = "+b+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } ",l&&(n+=" else { "),n}},{}],17:[function(t,e,r){"use strict";e.exports=function(t,e){var r,n=" ",i=t.level,s=t.dataLevel,a=t.schema[e],o=t.schemaPath+t.util.getProperty(e),c=t.errSchemaPath+"/"+e,l=!t.opts.allErrors,u="data"+(s||""),f=t.opts.v5&&a&&a.$data;f?(n+=" var schema"+i+" = "+t.util.getData(a.$data,s,t.dataPathArr)+"; ",r="schema"+i):r=a,n+="if ( ",f&&(n+=" ("+r+" !== undefined && typeof "+r+" != 'number') || "),n+=" "+u+".length "+("maxItems"==e?">":"<")+" "+r+") { ";var $=e,h=h||[];h.push(n),n="",!1!==t.createErrors?(n+=" { keyword: '"+($||"_limitItems")+"' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(c)+" , params: { limit: "+r+" } ",!1!==t.opts.messages&&(n+=" , message: 'should NOT have ",n+="maxItems"==e?"more":"less",n+=" than ",n+=f?"' + "+r+" + '":""+a,n+=" items' "),t.opts.verbose&&(n+=" , schema:  ",n+=f?"validate.schema"+o:""+a,n+="         , parentSchema: validate.schema"+t.schemaPath+" , data: "+u+" "),n+=" } "):n+=" {} ";var p=n;return n=h.pop(),!t.compositeRule&&l?t.async?n+=" throw new ValidationError(["+p+"]); ":n+=" validate.errors = ["+p+"]; return false; ":n+=" var err = "+p+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+="} ",l&&(n+=" else { "),n}},{}],18:[function(t,e,r){"use strict";e.exports=function(t,e){var r,n=" ",i=t.level,s=t.dataLevel,a=t.schema[e],o=t.schemaPath+t.util.getProperty(e),c=t.errSchemaPath+"/"+e,l=!t.opts.allErrors,u="data"+(s||""),f=t.opts.v5&&a&&a.$data;f?(n+=" var schema"+i+" = "+t.util.getData(a.$data,s,t.dataPathArr)+"; ",r="schema"+i):r=a;var $="maxLength"==e?">":"<";n+="if ( ",f&&(n+=" ("+r+" !== undefined && typeof "+r+" != 'number') || "),!1===t.opts.unicode?n+=" "+u+".length ":n+=" ucs2length("+u+") ",n+=" "+$+" "+r+") { ";var h=e,p=p||[];p.push(n),n="",!1!==t.createErrors?(n+=" { keyword: '"+(h||"_limitLength")+"' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(c)+" , params: { limit: "+r+" } ",!1!==t.opts.messages&&(n+=" , message: 'should NOT be ",n+="maxLength"==e?"longer":"shorter",n+=" than ",n+=f?"' + "+r+" + '":""+a,n+=" characters' "),t.opts.verbose&&(n+=" , schema:  ",n+=f?"validate.schema"+o:""+a,n+="         , parentSchema: validate.schema"+t.schemaPath+" , data: "+u+" "),n+=" } "):n+=" {} ";var d=n;return n=p.pop(),!t.compositeRule&&l?t.async?n+=" throw new ValidationError(["+d+"]); ":n+=" validate.errors = ["+d+"]; return false; ":n+=" var err = "+d+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+="} ",l&&(n+=" else { "),n}},{}],19:[function(t,e,r){"use strict";e.exports=function(t,e){var r,n=" ",i=t.level,s=t.dataLevel,a=t.schema[e],o=t.schemaPath+t.util.getProperty(e),c=t.errSchemaPath+"/"+e,l=!t.opts.allErrors,u="data"+(s||""),f=t.opts.v5&&a&&a.$data;f?(n+=" var schema"+i+" = "+t.util.getData(a.$data,s,t.dataPathArr)+"; ",r="schema"+i):r=a,n+="if ( ",f&&(n+=" ("+r+" !== undefined && typeof "+r+" != 'number') || "),n+=" Object.keys("+u+").length "+("maxProperties"==e?">":"<")+" "+r+") { ";var $=e,h=h||[];h.push(n),n="",!1!==t.createErrors?(n+=" { keyword: '"+($||"_limitProperties")+"' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(c)+" , params: { limit: "+r+" } ",!1!==t.opts.messages&&(n+=" , message: 'should NOT have ",n+="maxProperties"==e?"more":"less",n+=" than ",n+=f?"' + "+r+" + '":""+a,n+=" properties' "),t.opts.verbose&&(n+=" , schema:  ",n+=f?"validate.schema"+o:""+a,n+="         , parentSchema: validate.schema"+t.schemaPath+" , data: "+u+" "),n+=" } "):n+=" {} ";var p=n;return n=h.pop(),!t.compositeRule&&l?t.async?n+=" throw new ValidationError(["+p+"]); ":n+=" validate.errors = ["+p+"]; return false; ":n+=" var err = "+p+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+="} ",l&&(n+=" else { "),n}},{}],20:[function(t,e,r){"use strict";e.exports=function(t,e){var r=" ",n=t.schema[e],i=t.schemaPath+t.util.getProperty(e),s=t.errSchemaPath+"/"+e,a=!t.opts.allErrors,o=t.util.copy(t),c="";o.level++;var l="valid"+o.level,u=o.baseId,f=!0,$=n;if($)for(var h,p=-1,d=$.length-1;p<d;)h=$[p+=1],t.util.schemaHasRules(h,t.RULES.all)&&(f=!1,o.schema=h,o.schemaPath=i+"["+p+"]",o.errSchemaPath=s+"/"+p,r+="  "+t.validate(o)+" ",o.baseId=u,a&&(r+=" if ("+l+") { ",c+="}"));return a&&(r+=f?" if (true) { ":" "+c.slice(0,-1)+" "),r=t.util.cleanUpCode(r)}},{}],21:[function(t,e,r){"use strict";e.exports=function(t,e){var r=" ",n=t.level,i=t.dataLevel,s=t.schema[e],a=t.schemaPath+t.util.getProperty(e),o=t.errSchemaPath+"/"+e,c=!t.opts.allErrors,l="data"+(i||""),u="valid"+n,f="errs__"+n,$=t.util.copy(t),h="";$.level++;var p="valid"+$.level;if(s.every(function(e){return t.util.schemaHasRules(e,t.RULES.all)})){var d=$.baseId;r+=" var "+f+" = errors; var "+u+" = false;  ";var _=t.compositeRule;t.compositeRule=$.compositeRule=!0;var m=s;if(m)for(var y,g=-1,v=m.length-1;g<v;)y=m[g+=1],$.schema=y,$.schemaPath=a+"["+g+"]",$.errSchemaPath=o+"/"+g,r+="  "+t.validate($)+" ",$.baseId=d,r+=" "+u+" = "+u+" || "+p+"; if (!"+u+") { ",h+="}";t.compositeRule=$.compositeRule=_,r+=" "+h+" if (!"+u+") {  var err =   ",!1!==t.createErrors?(r+=" { keyword: 'anyOf' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(o)+" , params: {} ",!1!==t.opts.messages&&(r+=" , message: 'should match some schema in anyOf' "),t.opts.verbose&&(r+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } else {  errors = "+f+"; if (vErrors !== null) { if ("+f+") vErrors.length = "+f+"; else vErrors = null; } ",t.opts.allErrors&&(r+=" } "),r=t.util.cleanUpCode(r)}else c&&(r+=" if (true) { ");return r}},{}],22:[function(t,e,r){"use strict";e.exports=function(t,e){var r=" ",n=t.level,i=t.dataLevel,s=t.schema[e],a=t.schemaPath+t.util.getProperty(e),o=t.errSchemaPath+"/"+e,c=!t.opts.allErrors,l="data"+(i||""),u="valid"+n,f=t.opts.v5&&s&&s.$data;f&&(r+=" var schema"+n+" = "+t.util.getData(s.$data,i,t.dataPathArr)+"; "),f||(r+=" var schema"+n+" = validate.schema"+a+";"),r+="var "+u+" = equal("+l+", schema"+n+"); if (!"+u+") {   ";var $=$||[];$.push(r),r="",!1!==t.createErrors?(r+=" { keyword: 'constant' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(o)+" , params: {} ",!1!==t.opts.messages&&(r+=" , message: 'should be equal to constant' "),t.opts.verbose&&(r+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ";var h=r;return r=$.pop(),!t.compositeRule&&c?t.async?r+=" throw new ValidationError(["+h+"]); ":r+=" validate.errors = ["+h+"]; return false; ":r+=" var err = "+h+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" }"}},{}],23:[function(t,e,r){"use strict";e.exports=function(t,e){var r,n,i=" ",s=t.level,a=t.dataLevel,o=t.schema[e],c=t.schemaPath+t.util.getProperty(e),l=t.errSchemaPath+"/"+e,u=!t.opts.allErrors,f="data"+(a||""),$="valid"+s,h="errs__"+s,p=t.opts.v5&&o&&o.$data;p?(i+=" var schema"+s+" = "+t.util.getData(o.$data,a,t.dataPathArr)+"; ",n="schema"+s):n=o;var d,_,m,y,g,v="definition"+s,b=this.definition;if(p&&b.$data){g="keywordValidate"+s;var A=b.validateSchema;i+=" var "+v+" = RULES.custom['"+e+"'].definition; var "+g+" = "+v+".validate;"}else n="validate.schema"+c,g=(y=t.useCustomRule(this,o,t.schema,t)).code,d=b.compile,_=b.inline,m=b.macro;var x=g+".errors",w="i"+s,k="ruleErr"+s,E=b.async;if(E&&!t.async)throw new Error("async keyword in sync schema");if(_||m||(i+=x+" = null;"),i+="var "+h+" = errors;var "+$+";",A&&(i+=" "+$+" = "+v+".validateSchema("+n+"); if ("+$+") {"),_)b.statements?i+=" "+y.validate+" ":i+=" "+$+" = "+y.validate+"; ";else if(m){var S=t.util.copy(t);S.level++;var N="valid"+S.level;S.schema=y.validate,S.schemaPath="";var I=t.compositeRule;t.compositeRule=S.compositeRule=!0;var C=t.validate(S).replace(/validate\.schema/g,g);t.compositeRule=S.compositeRule=I,i+=" "+C}else{(P=P||[]).push(i),i="",i+="  "+g+".call( ",t.opts.passContext?i+="this":i+="self",d||!1===b.schema?i+=" , "+f+" ":i+=" , "+n+" , "+f+" , validate.schema"+t.schemaPath+" ",i+=" , (dataPath || '')",'""'!=t.errorPath&&(i+=" + "+t.errorPath);var O=a?"data"+(a-1||""):"parentData",B=a?t.dataPathArr[a]:"parentDataProperty",M=i+=" , "+O+" , "+B+" , rootData )  ";i=P.pop(),!1===b.errors?(i+=" "+$+" = ",E&&(i+=""+t.yieldAwait),i+=M+"; "):i+=E?" var "+(x="customErrors"+s)+" = null; try { "+$+" = "+t.yieldAwait+M+"; } catch (e) { "+$+" = false; if (e instanceof ValidationError) "+x+" = e.errors; else throw e; } ":" "+x+" = null; "+$+" = "+M+"; "}if(b.modifying&&(i+=" "+f+" = "+O+"["+B+"];"),A&&(i+=" }"),b.valid)u&&(i+=" if (true) { ");else{var P;i+=" if ( ",void 0===b.valid?(i+=" !",i+=m?""+N:""+$):i+=" "+!b.valid+" ",i+=") { ",r=this.keyword,(P=P||[]).push(i),i="",(P=P||[]).push(i),i="",!1!==t.createErrors?(i+=" { keyword: '"+(r||"custom")+"' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(l)+" , params: { keyword: '"+this.keyword+"' } ",!1!==t.opts.messages&&(i+=" , message: 'should pass \""+this.keyword+"\" keyword validation' "),t.opts.verbose&&(i+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+f+" "),i+=" } "):i+=" {} ";var F=i;i=P.pop(),!t.compositeRule&&u?t.async?i+=" throw new ValidationError(["+F+"]); ":i+=" validate.errors = ["+F+"]; return false; ":i+=" var err = "+F+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";var L=i;i=P.pop(),_?b.errors?"full"!=b.errors&&(i+="  for (var "+w+"="+h+"; "+w+"<errors; "+w+"++) { var "+k+" = vErrors["+w+"]; if ("+k+".dataPath === undefined) "+k+".dataPath = (dataPath || '') + "+t.errorPath+"; if ("+k+".schemaPath === undefined) { "+k+'.schemaPath = "'+l+'"; } ',t.opts.verbose&&(i+=" "+k+".schema = "+n+"; "+k+".data = "+f+"; "),i+=" } "):!1===b.errors?i+=" "+L+" ":(i+=" if ("+h+" == errors) { "+L+" } else {  for (var "+w+"="+h+"; "+w+"<errors; "+w+"++) { var "+k+" = vErrors["+w+"]; if ("+k+".dataPath === undefined) "+k+".dataPath = (dataPath || '') + "+t.errorPath+"; if ("+k+".schemaPath === undefined) { "+k+'.schemaPath = "'+l+'"; } ',t.opts.verbose&&(i+=" "+k+".schema = "+n+"; "+k+".data = "+f+"; "),i+=" } } "):m?(i+="   var err =   ",!1!==t.createErrors?(i+=" { keyword: '"+(r||"custom")+"' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(l)+" , params: { keyword: '"+this.keyword+"' } ",!1!==t.opts.messages&&(i+=" , message: 'should pass \""+this.keyword+"\" keyword validation' "),t.opts.verbose&&(i+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+f+" "),i+=" } "):i+=" {} ",i+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!t.compositeRule&&u&&(t.async?i+=" throw new ValidationError(vErrors); ":i+=" validate.errors = vErrors; return false; ")):!1===b.errors?i+=" "+L+" ":(i+=" if (Array.isArray("+x+")) { if (vErrors === null) vErrors = "+x+"; else vErrors = vErrors.concat("+x+"); errors = vErrors.length;  for (var "+w+"="+h+"; "+w+"<errors; "+w+"++) { var "+k+" = vErrors["+w+"]; if ("+k+".dataPath === undefined) "+k+".dataPath = (dataPath || '') + "+t.errorPath+";  "+k+'.schemaPath = "'+l+'";  ',t.opts.verbose&&(i+=" "+k+".schema = "+n+"; "+k+".data = "+f+"; "),i+=" } } else { "+L+" } "),i+=" } ",u&&(i+=" else { ")}return i}},{}],24:[function(t,e,r){"use strict";e.exports=function(t,e){var r=" ",n=t.level,i=t.dataLevel,s=t.schema[e],a=t.schemaPath+t.util.getProperty(e),o=t.errSchemaPath+"/"+e,c=!t.opts.allErrors,l="data"+(i||""),u="errs__"+n,f=t.util.copy(t),$="";f.level++;var h="valid"+f.level,p={},d={};for(g in s){var _=s[g],m=Array.isArray(_)?d:p;m[g]=_}r+="var "+u+" = errors;";var y=t.errorPath;for(var g in r+="var missing"+n+";",d){if(m=d[g],r+=" if ("+l+t.util.getProperty(g)+" !== undefined ",c){r+=" && ( ";var v=m;if(v)for(var b,A=-1,x=v.length-1;A<x;){b=v[A+=1],A&&(r+=" || "),r+=" ( "+l+(B=t.util.getProperty(b))+" === undefined && (missing"+n+" = "+t.util.toQuotedString(t.opts.jsonPointers?b:B)+") ) "}r+=")) {  ";var w="missing"+n,k="' + "+w+" + '";t.opts._errorDataPathProperty&&(t.errorPath=t.opts.jsonPointers?t.util.getPathExpr(y,w,!0):y+" + "+w);var E=E||[];E.push(r),r="",!1!==t.createErrors?(r+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(o)+" , params: { property: '"+t.util.escapeQuotes(g)+"', missingProperty: '"+k+"', depsCount: "+m.length+", deps: '"+t.util.escapeQuotes(1==m.length?m[0]:m.join(", "))+"' } ",!1!==t.opts.messages&&(r+=" , message: 'should have ",1==m.length?r+="property "+t.util.escapeQuotes(m[0]):r+="properties "+t.util.escapeQuotes(m.join(", ")),r+=" when property "+t.util.escapeQuotes(g)+" is present' "),t.opts.verbose&&(r+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ";var S=r;r=E.pop(),!t.compositeRule&&c?t.async?r+=" throw new ValidationError(["+S+"]); ":r+=" validate.errors = ["+S+"]; return false; ":r+=" var err = "+S+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else{r+=" ) { ";var N=m;if(N)for(var I,C=-1,O=N.length-1;C<O;){I=N[C+=1];var B=t.util.getProperty(I);k=t.util.escapeQuotes(I);t.opts._errorDataPathProperty&&(t.errorPath=t.util.getPath(y,I,t.opts.jsonPointers)),r+=" if ("+l+B+" === undefined) {  var err =   ",!1!==t.createErrors?(r+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(o)+" , params: { property: '"+t.util.escapeQuotes(g)+"', missingProperty: '"+k+"', depsCount: "+m.length+", deps: '"+t.util.escapeQuotes(1==m.length?m[0]:m.join(", "))+"' } ",!1!==t.opts.messages&&(r+=" , message: 'should have ",1==m.length?r+="property "+t.util.escapeQuotes(m[0]):r+="properties "+t.util.escapeQuotes(m.join(", ")),r+=" when property "+t.util.escapeQuotes(g)+" is present' "),t.opts.verbose&&(r+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}r+=" }   ",c&&($+="}",r+=" else { ")}t.errorPath=y;var M=f.baseId;for(var g in p){_=p[g];t.util.schemaHasRules(_,t.RULES.all)&&(r+=" "+h+" = true; if ("+l+t.util.getProperty(g)+" !== undefined) { ",f.schema=_,f.schemaPath=a+t.util.getProperty(g),f.errSchemaPath=o+"/"+t.util.escapeFragment(g),r+="  "+t.validate(f)+" ",f.baseId=M,r+=" }  ",c&&(r+=" if ("+h+") { ",$+="}"))}return c&&(r+="   "+$+" if ("+u+" == errors) {"),r=t.util.cleanUpCode(r)}},{}],25:[function(t,e,r){"use strict";e.exports=function(t,e){var r=" ",n=t.level,i=t.dataLevel,s=t.schema[e],a=t.schemaPath+t.util.getProperty(e),o=t.errSchemaPath+"/"+e,c=!t.opts.allErrors,l="data"+(i||""),u="valid"+n,f=t.opts.v5&&s&&s.$data;f&&(r+=" var schema"+n+" = "+t.util.getData(s.$data,i,t.dataPathArr)+"; ");var $="i"+n,h="schema"+n;f||(r+=" var "+h+" = validate.schema"+a+";"),r+="var "+u+";",f&&(r+=" if (schema"+n+" === undefined) "+u+" = true; else if (!Array.isArray(schema"+n+")) "+u+" = false; else {"),r+=u+" = false;for (var "+$+"=0; "+$+"<"+h+".length; "+$+"++) if (equal("+l+", "+h+"["+$+"])) { "+u+" = true; break; }",f&&(r+="  }  "),r+=" if (!"+u+") {   ";var p=p||[];p.push(r),r="",!1!==t.createErrors?(r+=" { keyword: 'enum' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(o)+" , params: { allowedValues: schema"+n+" } ",!1!==t.opts.messages&&(r+=" , message: 'should be equal to one of the allowed values' "),t.opts.verbose&&(r+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ";var d=r;return r=p.pop(),!t.compositeRule&&c?t.async?r+=" throw new ValidationError(["+d+"]); ":r+=" validate.errors = ["+d+"]; return false; ":r+=" var err = "+d+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" }",c&&(r+=" else { "),r}},{}],26:[function(t,e,r){"use strict";e.exports=function(t,e){var r=" ",n=t.level,i=t.dataLevel,s=t.schema[e],a=t.schemaPath+t.util.getProperty(e),o=t.errSchemaPath+"/"+e,c=!t.opts.allErrors,l="data"+(i||"");if(!1===t.opts.format)return c&&(r+=" if (true) { "),r;var u,f=t.opts.v5&&s&&s.$data;f?(r+=" var schema"+n+" = "+t.util.getData(s.$data,i,t.dataPathArr)+"; ",u="schema"+n):u=s;var $=t.opts.unknownFormats,h=Array.isArray($);if(f){r+=" var "+(p="format"+n)+" = formats["+u+"]; var isObject"+n+" = typeof "+p+" == 'object' && !("+p+" instanceof RegExp) && "+p+".validate; if (isObject"+n+") { ",t.async&&(r+=" var async"+n+" = "+p+".async; "),r+=" "+p+" = "+p+".validate; } if (  ",f&&(r+=" ("+u+" !== undefined && typeof "+u+" != 'string') || "),r+=" (",(!0===$||h)&&(r+=" ("+u+" && !"+p+" ",h&&(r+=" && self._opts.unknownFormats.indexOf("+u+") == -1 "),r+=") || "),r+=" ("+p+" && !(typeof "+p+" == 'function' ? ",t.async?r+=" (async"+n+" ? "+t.yieldAwait+" "+p+"("+l+") : "+p+"("+l+")) ":r+=" "+p+"("+l+") ",r+=" : "+p+".test("+l+"))))) {"}else{var p;if(!(p=t.formats[s])){if(!0===$||h&&-1==$.indexOf(s))throw new Error('unknown format "'+s+'" is used in schema at path "'+t.errSchemaPath+'"');return h||(console.warn('unknown format "'+s+'" ignored in schema at path "'+t.errSchemaPath+'"'),"ignore"!==$&&console.warn("In the next major version it will throw exception. See option unknownFormats for more information")),c&&(r+=" if (true) { "),r}var d="object"==typeof p&&!(p instanceof RegExp)&&p.validate;if(d){var _=!0===p.async;p=p.validate}if(_){if(!t.async)throw new Error("async format in sync schema");var m="formats"+t.util.getProperty(s)+".validate";r+=" if (!("+t.yieldAwait+" "+m+"("+l+"))) { "}else{r+=" if (! ";m="formats"+t.util.getProperty(s);d&&(m+=".validate"),r+="function"==typeof p?" "+m+"("+l+") ":" "+m+".test("+l+") ",r+=") { "}}var y=y||[];y.push(r),r="",!1!==t.createErrors?(r+=" { keyword: 'format' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(o)+" , params: { format:  ",r+=f?""+u:""+t.util.toQuotedString(s),r+="  } ",!1!==t.opts.messages&&(r+=" , message: 'should match format \"",r+=f?"' + "+u+" + '":""+t.util.escapeQuotes(s),r+="\"' "),t.opts.verbose&&(r+=" , schema:  ",r+=f?"validate.schema"+a:""+t.util.toQuotedString(s),r+="         , parentSchema: validate.schema"+t.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ";var g=r;return r=y.pop(),!t.compositeRule&&c?t.async?r+=" throw new ValidationError(["+g+"]); ":r+=" validate.errors = ["+g+"]; return false; ":r+=" var err = "+g+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } ",c&&(r+=" else { "),r}},{}],27:[function(t,e,r){"use strict";e.exports=function(t,e){var r=" ",n=t.level,i=t.dataLevel,s=t.schema[e],a=t.schemaPath+t.util.getProperty(e),o=t.errSchemaPath+"/"+e,c=!t.opts.allErrors,l="data"+(i||""),u="valid"+n,f="errs__"+n,$=t.util.copy(t),h="";$.level++;var p="valid"+$.level,d="i"+n,_=$.dataLevel=t.dataLevel+1,m="data"+_,y=t.baseId;if(r+="var "+f+" = errors;var "+u+";",Array.isArray(s)){var g=t.schema.additionalItems;if(!1===g){r+=" "+u+" = "+l+".length <= "+s.length+"; ";var v=o;o=t.errSchemaPath+"/additionalItems",r+="  if (!"+u+") {   ";var b=b||[];b.push(r),r="",!1!==t.createErrors?(r+=" { keyword: 'additionalItems' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(o)+" , params: { limit: "+s.length+" } ",!1!==t.opts.messages&&(r+=" , message: 'should NOT have more than "+s.length+" items' "),t.opts.verbose&&(r+=" , schema: false , parentSchema: validate.schema"+t.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ";var A=r;r=b.pop(),!t.compositeRule&&c?t.async?r+=" throw new ValidationError(["+A+"]); ":r+=" validate.errors = ["+A+"]; return false; ":r+=" var err = "+A+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } ",o=v,c&&(h+="}",r+=" else { ")}var x=s;if(x)for(var w,k=-1,E=x.length-1;k<E;)if(w=x[k+=1],t.util.schemaHasRules(w,t.RULES.all)){r+=" "+p+" = true; if ("+l+".length > "+k+") { ";var S=l+"["+k+"]";$.schema=w,$.schemaPath=a+"["+k+"]",$.errSchemaPath=o+"/"+k,$.errorPath=t.util.getPathExpr(t.errorPath,k,t.opts.jsonPointers,!0),$.dataPathArr[_]=k;var N=t.validate($);$.baseId=y,t.util.varOccurences(N,m)<2?r+=" "+t.util.varReplace(N,m,S)+" ":r+=" var "+m+" = "+S+"; "+N+" ",r+=" }  ",c&&(r+=" if ("+p+") { ",h+="}")}if("object"==typeof g&&t.util.schemaHasRules(g,t.RULES.all)){$.schema=g,$.schemaPath=t.schemaPath+".additionalItems",$.errSchemaPath=t.errSchemaPath+"/additionalItems",r+=" "+p+" = true; if ("+l+".length > "+s.length+") {  for (var "+d+" = "+s.length+"; "+d+" < "+l+".length; "+d+"++) { ",$.errorPath=t.util.getPathExpr(t.errorPath,d,t.opts.jsonPointers,!0);S=l+"["+d+"]";$.dataPathArr[_]=d;N=t.validate($);$.baseId=y,t.util.varOccurences(N,m)<2?r+=" "+t.util.varReplace(N,m,S)+" ":r+=" var "+m+" = "+S+"; "+N+" ",c&&(r+=" if (!"+p+") break; "),r+=" } }  ",c&&(r+=" if ("+p+") { ",h+="}")}}else if(t.util.schemaHasRules(s,t.RULES.all)){$.schema=s,$.schemaPath=a,$.errSchemaPath=o,r+="  for (var "+d+" = 0; "+d+" < "+l+".length; "+d+"++) { ",$.errorPath=t.util.getPathExpr(t.errorPath,d,t.opts.jsonPointers,!0);S=l+"["+d+"]";$.dataPathArr[_]=d;N=t.validate($);$.baseId=y,t.util.varOccurences(N,m)<2?r+=" "+t.util.varReplace(N,m,S)+" ":r+=" var "+m+" = "+S+"; "+N+" ",c&&(r+=" if (!"+p+") break; "),r+=" }  ",c&&(r+=" if ("+p+") { ",h+="}")}return c&&(r+=" "+h+" if ("+f+" == errors) {"),r=t.util.cleanUpCode(r)}},{}],28:[function(t,e,r){"use strict";e.exports=function(t,e){var r,n=" ",i=t.level,s=t.dataLevel,a=t.schema[e],o=t.schemaPath+t.util.getProperty(e),c=t.errSchemaPath+"/"+e,l=!t.opts.allErrors,u="data"+(s||""),f=t.opts.v5&&a&&a.$data;f?(n+=" var schema"+i+" = "+t.util.getData(a.$data,s,t.dataPathArr)+"; ",r="schema"+i):r=a,n+="var division"+i+";if (",f&&(n+=" "+r+" !== undefined && ( typeof "+r+" != 'number' || "),n+=" (division"+i+" = "+u+" / "+r+", ",t.opts.multipleOfPrecision?n+=" Math.abs(Math.round(division"+i+") - division"+i+") > 1e-"+t.opts.multipleOfPrecision+" ":n+=" division"+i+" !== parseInt(division"+i+") ",n+=" ) ",f&&(n+="  )  "),n+=" ) {   ";var $=$||[];$.push(n),n="",!1!==t.createErrors?(n+=" { keyword: 'multipleOf' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(c)+" , params: { multipleOf: "+r+" } ",!1!==t.opts.messages&&(n+=" , message: 'should be multiple of ",n+=f?"' + "+r:a+"'"),t.opts.verbose&&(n+=" , schema:  ",n+=f?"validate.schema"+o:""+a,n+="         , parentSchema: validate.schema"+t.schemaPath+" , data: "+u+" "),n+=" } "):n+=" {} ";var h=n;return n=$.pop(),!t.compositeRule&&l?t.async?n+=" throw new ValidationError(["+h+"]); ":n+=" validate.errors = ["+h+"]; return false; ":n+=" var err = "+h+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+="} ",l&&(n+=" else { "),n}},{}],29:[function(t,e,r){"use strict";e.exports=function(t,e){var r=" ",n=t.level,i=t.dataLevel,s=t.schema[e],a=t.schemaPath+t.util.getProperty(e),o=t.errSchemaPath+"/"+e,c=!t.opts.allErrors,l="data"+(i||""),u="errs__"+n,f=t.util.copy(t);f.level++;var $="valid"+f.level;if(t.util.schemaHasRules(s,t.RULES.all)){f.schema=s,f.schemaPath=a,f.errSchemaPath=o,r+=" var "+u+" = errors;  ";var h,p=t.compositeRule;t.compositeRule=f.compositeRule=!0,f.createErrors=!1,f.opts.allErrors&&(h=f.opts.allErrors,f.opts.allErrors=!1),r+=" "+t.validate(f)+" ",f.createErrors=!0,h&&(f.opts.allErrors=h),t.compositeRule=f.compositeRule=p,r+=" if ("+$+") {   ";var d=d||[];d.push(r),r="",!1!==t.createErrors?(r+=" { keyword: 'not' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(o)+" , params: {} ",!1!==t.opts.messages&&(r+=" , message: 'should NOT be valid' "),t.opts.verbose&&(r+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ";var _=r;r=d.pop(),!t.compositeRule&&c?t.async?r+=" throw new ValidationError(["+_+"]); ":r+=" validate.errors = ["+_+"]; return false; ":r+=" var err = "+_+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } else {  errors = "+u+"; if (vErrors !== null) { if ("+u+") vErrors.length = "+u+"; else vErrors = null; } ",t.opts.allErrors&&(r+=" } ")}else r+="  var err =   ",!1!==t.createErrors?(r+=" { keyword: 'not' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(o)+" , params: {} ",!1!==t.opts.messages&&(r+=" , message: 'should NOT be valid' "),t.opts.verbose&&(r+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",c&&(r+=" if (false) { ");return r}},{}],30:[function(t,e,r){"use strict";e.exports=function(t,e){var r=" ",n=t.level,i=t.dataLevel,s=t.schema[e],a=t.schemaPath+t.util.getProperty(e),o=t.errSchemaPath+"/"+e,c=!t.opts.allErrors,l="data"+(i||""),u="valid"+n,f="errs__"+n,$=t.util.copy(t),h="";$.level++;var p="valid"+$.level;r+="var "+f+" = errors;var prevValid"+n+" = false;var "+u+" = false;";var d=$.baseId,_=t.compositeRule;t.compositeRule=$.compositeRule=!0;var m=s;if(m)for(var y,g=-1,v=m.length-1;g<v;)y=m[g+=1],t.util.schemaHasRules(y,t.RULES.all)?($.schema=y,$.schemaPath=a+"["+g+"]",$.errSchemaPath=o+"/"+g,r+="  "+t.validate($)+" ",$.baseId=d):r+=" var "+p+" = true; ",g&&(r+=" if ("+p+" && prevValid"+n+") "+u+" = false; else { ",h+="}"),r+=" if ("+p+") "+u+" = prevValid"+n+" = true;";t.compositeRule=$.compositeRule=_,r+=h+"if (!"+u+") {   ";var b=b||[];b.push(r),r="",!1!==t.createErrors?(r+=" { keyword: 'oneOf' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(o)+" , params: {} ",!1!==t.opts.messages&&(r+=" , message: 'should match exactly one schema in oneOf' "),t.opts.verbose&&(r+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ";var A=r;return r=b.pop(),!t.compositeRule&&c?t.async?r+=" throw new ValidationError(["+A+"]); ":r+=" validate.errors = ["+A+"]; return false; ":r+=" var err = "+A+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+="} else {  errors = "+f+"; if (vErrors !== null) { if ("+f+") vErrors.length = "+f+"; else vErrors = null; }",t.opts.allErrors&&(r+=" } "),r}},{}],31:[function(t,e,r){"use strict";e.exports=function(t,e){var r,n=" ",i=t.level,s=t.dataLevel,a=t.schema[e],o=t.schemaPath+t.util.getProperty(e),c=t.errSchemaPath+"/"+e,l=!t.opts.allErrors,u="data"+(s||""),f=t.opts.v5&&a&&a.$data;f?(n+=" var schema"+i+" = "+t.util.getData(a.$data,s,t.dataPathArr)+"; ",r="schema"+i):r=a,n+="if ( ",f&&(n+=" ("+r+" !== undefined && typeof "+r+" != 'string') || "),n+=" !"+(f?"(new RegExp("+r+"))":t.usePattern(a))+".test("+u+") ) {   ";var $=$||[];$.push(n),n="",!1!==t.createErrors?(n+=" { keyword: 'pattern' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(c)+" , params: { pattern:  ",n+=f?""+r:""+t.util.toQuotedString(a),n+="  } ",!1!==t.opts.messages&&(n+=" , message: 'should match pattern \"",n+=f?"' + "+r+" + '":""+t.util.escapeQuotes(a),n+="\"' "),t.opts.verbose&&(n+=" , schema:  ",n+=f?"validate.schema"+o:""+t.util.toQuotedString(a),n+="         , parentSchema: validate.schema"+t.schemaPath+" , data: "+u+" "),n+=" } "):n+=" {} ";var h=n;return n=$.pop(),!t.compositeRule&&l?t.async?n+=" throw new ValidationError(["+h+"]); ":n+=" validate.errors = ["+h+"]; return false; ":n+=" var err = "+h+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+="} ",l&&(n+=" else { "),n}},{}],32:[function(t,e,r){"use strict";e.exports=function(t,e){var r=" ",n=t.level,i=t.dataLevel,s=t.schema[e],a=t.schemaPath+t.util.getProperty(e),o=t.errSchemaPath+"/"+e,c=!t.opts.allErrors,l="data"+(i||""),u="valid"+n,f="key"+n,$="patternMatched"+n,h="",p=t.opts.ownProperties;r+="var "+u+" = true;";var d=s;if(d)for(var _,m=-1,y=d.length-1;m<y;){_=d[m+=1],r+=" var "+$+" = false; for (var "+f+" in "+l+") {  ",p&&(r+=" if (!Object.prototype.hasOwnProperty.call("+l+", "+f+")) continue; "),r+=" "+$+" = "+t.usePattern(_)+".test("+f+"); if ("+$+") break; } ";var g=t.util.escapeQuotes(_);r+=" if (!"+$+") { "+u+" = false;  var err =   ",!1!==t.createErrors?(r+=" { keyword: 'patternRequired' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(o)+" , params: { missingPattern: '"+g+"' } ",!1!==t.opts.messages&&(r+=" , message: 'should have property matching pattern \\'"+g+"\\'' "),t.opts.verbose&&(r+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; }   ",c&&(h+="}",r+=" else { ")}return r+=""+h}},{}],33:[function(t,e,r){"use strict";e.exports=function(t,e){var r=" ",n=t.level,i=t.dataLevel,s=t.schema[e],a=t.schemaPath+t.util.getProperty(e),o=t.errSchemaPath+"/"+e,c=!t.opts.allErrors,l="data"+(i||""),u="valid"+n,f="errs__"+n,$=t.util.copy(t),h="";$.level++;var p="valid"+$.level,d="key"+n,_=$.dataLevel=t.dataLevel+1,m="data"+_,y=Object.keys(s||{}),g=t.schema.patternProperties||{},v=Object.keys(g),b=t.schema.additionalProperties,A=y.length||v.length,x=!1===b,w="object"==typeof b&&Object.keys(b).length,k=t.opts.removeAdditional,E=x||w||k,S=t.opts.ownProperties,N=t.baseId,I=t.schema.required;if(I&&(!t.opts.v5||!I.$data)&&I.length<t.opts.loopRequired)var C=t.util.toHash(I);if(t.opts.v5)var O=t.schema.patternGroups||{},B=Object.keys(O);if(r+="var "+f+" = errors;var "+p+" = true;",E){if(r+=" for (var "+d+" in "+l+") {  ",S&&(r+=" if (!Object.prototype.hasOwnProperty.call("+l+", "+d+")) continue; "),A){if(r+=" var isAdditional"+n+" = !(false ",y.length)if(y.length>5)r+=" || validate.schema"+a+"["+d+"] ";else{var M=y;if(M)for(var P=-1,F=M.length-1;P<F;)X=M[P+=1],r+=" || "+d+" == "+t.util.toQuotedString(X)+" "}if(v.length){var L=v;if(L)for(var T=-1,j=L.length-1;T<j;)st=L[T+=1],r+=" || "+t.usePattern(st)+".test("+d+") "}if(t.opts.v5&&B&&B.length){var R=B;if(R){T=-1;for(var D=R.length-1;T<D;)lt=R[T+=1],r+=" || "+t.usePattern(lt)+".test("+d+") "}}r+=" ); if (isAdditional"+n+") { "}if("all"==k)r+=" delete "+l+"["+d+"]; ";else{var z=t.errorPath,U="' + "+d+" + '";if(t.opts._errorDataPathProperty&&(t.errorPath=t.util.getPathExpr(t.errorPath,d,t.opts.jsonPointers)),x)if(k)r+=" delete "+l+"["+d+"]; ";else{r+=" "+p+" = false; ";var q=o;o=t.errSchemaPath+"/additionalProperties",(yt=yt||[]).push(r),r="",!1!==t.createErrors?(r+=" { keyword: 'additionalProperties' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(o)+" , params: { additionalProperty: '"+U+"' } ",!1!==t.opts.messages&&(r+=" , message: 'should NOT have additional properties' "),t.opts.verbose&&(r+=" , schema: false , parentSchema: validate.schema"+t.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ";var H=r;r=yt.pop(),!t.compositeRule&&c?t.async?r+=" throw new ValidationError(["+H+"]); ":r+=" validate.errors = ["+H+"]; return false; ":r+=" var err = "+H+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",o=q,c&&(r+=" break; ")}else if(w)if("failing"==k){r+=" var "+f+" = errors;  ";var Q=t.compositeRule;t.compositeRule=$.compositeRule=!0,$.schema=b,$.schemaPath=t.schemaPath+".additionalProperties",$.errSchemaPath=t.errSchemaPath+"/additionalProperties",$.errorPath=t.opts._errorDataPathProperty?t.errorPath:t.util.getPathExpr(t.errorPath,d,t.opts.jsonPointers);var Y=l+"["+d+"]";$.dataPathArr[_]=d;var G=t.validate($);$.baseId=N,t.util.varOccurences(G,m)<2?r+=" "+t.util.varReplace(G,m,Y)+" ":r+=" var "+m+" = "+Y+"; "+G+" ",r+=" if (!"+p+") { errors = "+f+"; if (validate.errors !== null) { if (errors) validate.errors.length = errors; else validate.errors = null; } delete "+l+"["+d+"]; }  ",t.compositeRule=$.compositeRule=Q}else{$.schema=b,$.schemaPath=t.schemaPath+".additionalProperties",$.errSchemaPath=t.errSchemaPath+"/additionalProperties",$.errorPath=t.opts._errorDataPathProperty?t.errorPath:t.util.getPathExpr(t.errorPath,d,t.opts.jsonPointers);Y=l+"["+d+"]";$.dataPathArr[_]=d;G=t.validate($);$.baseId=N,t.util.varOccurences(G,m)<2?r+=" "+t.util.varReplace(G,m,Y)+" ":r+=" var "+m+" = "+Y+"; "+G+" ",c&&(r+=" if (!"+p+") break; ")}t.errorPath=z}A&&(r+=" } "),r+=" }  ",c&&(r+=" if ("+p+") { ",h+="}")}var V=t.opts.useDefaults&&!t.compositeRule;if(y.length){var J=y;if(J)for(var X,W=-1,K=J.length-1;W<K;){var Z=s[X=J[W+=1]];if(t.util.schemaHasRules(Z,t.RULES.all)){var tt=t.util.getProperty(X),et=(Y=l+tt,V&&void 0!==Z.default);$.schema=Z,$.schemaPath=a+tt,$.errSchemaPath=o+"/"+t.util.escapeFragment(X),$.errorPath=t.util.getPath(t.errorPath,X,t.opts.jsonPointers),$.dataPathArr[_]=t.util.toQuotedString(X);G=t.validate($);if($.baseId=N,t.util.varOccurences(G,m)<2){G=t.util.varReplace(G,m,Y);var rt=Y}else{rt=m;r+=" var "+m+" = "+Y+"; "}if(et)r+=" "+G+" ";else{if(C&&C[X]){r+=" if ("+rt+" === undefined) { "+p+" = false; ";z=t.errorPath,q=o;var nt=t.util.escapeQuotes(X);t.opts._errorDataPathProperty&&(t.errorPath=t.util.getPath(z,X,t.opts.jsonPointers)),o=t.errSchemaPath+"/required",(yt=yt||[]).push(r),r="",!1!==t.createErrors?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(o)+" , params: { missingProperty: '"+nt+"' } ",!1!==t.opts.messages&&(r+=" , message: '",t.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+nt+"\\'",r+="' "),t.opts.verbose&&(r+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ";H=r;r=yt.pop(),!t.compositeRule&&c?t.async?r+=" throw new ValidationError(["+H+"]); ":r+=" validate.errors = ["+H+"]; return false; ":r+=" var err = "+H+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",o=q,t.errorPath=z,r+=" } else { "}else r+=c?" if ("+rt+" === undefined) { "+p+" = true; } else { ":" if ("+rt+" !== undefined) { ";r+=" "+G+" } "}}c&&(r+=" if ("+p+") { ",h+="}")}}var it=v;if(it)for(var st,at=-1,ot=it.length-1;at<ot;){Z=g[st=it[at+=1]];if(t.util.schemaHasRules(Z,t.RULES.all)){$.schema=Z,$.schemaPath=t.schemaPath+".patternProperties"+t.util.getProperty(st),$.errSchemaPath=t.errSchemaPath+"/patternProperties/"+t.util.escapeFragment(st),r+=" for (var "+d+" in "+l+") {  ",S&&(r+=" if (!Object.prototype.hasOwnProperty.call("+l+", "+d+")) continue; "),r+=" if ("+t.usePattern(st)+".test("+d+")) { ",$.errorPath=t.util.getPathExpr(t.errorPath,d,t.opts.jsonPointers);Y=l+"["+d+"]";$.dataPathArr[_]=d;G=t.validate($);$.baseId=N,t.util.varOccurences(G,m)<2?r+=" "+t.util.varReplace(G,m,Y)+" ":r+=" var "+m+" = "+Y+"; "+G+" ",c&&(r+=" if (!"+p+") break; "),r+=" } ",c&&(r+=" else "+p+" = true; "),r+=" }  ",c&&(r+=" if ("+p+") { ",h+="}")}}if(t.opts.v5){var ct=B;if(ct)for(var lt,ut=-1,ft=ct.length-1;ut<ft;){var $t=O[lt=ct[ut+=1]];Z=$t.schema;if(t.util.schemaHasRules(Z,t.RULES.all)){$.schema=Z,$.schemaPath=t.schemaPath+".patternGroups"+t.util.getProperty(lt)+".schema",$.errSchemaPath=t.errSchemaPath+"/patternGroups/"+t.util.escapeFragment(lt)+"/schema",r+=" var pgPropCount"+n+" = 0; for (var "+d+" in "+l+") {  ",S&&(r+=" if (!Object.prototype.hasOwnProperty.call("+l+", "+d+")) continue; "),r+=" if ("+t.usePattern(lt)+".test("+d+")) { pgPropCount"+n+"++; ",$.errorPath=t.util.getPathExpr(t.errorPath,d,t.opts.jsonPointers);Y=l+"["+d+"]";$.dataPathArr[_]=d;G=t.validate($);$.baseId=N,t.util.varOccurences(G,m)<2?r+=" "+t.util.varReplace(G,m,Y)+" ":r+=" var "+m+" = "+Y+"; "+G+" ",c&&(r+=" if (!"+p+") break; "),r+=" } ",c&&(r+=" else "+p+" = true; "),r+=" }  ",c&&(r+=" if ("+p+") { ",h+="}");var ht=$t.minimum,pt=$t.maximum;if(void 0!==ht||void 0!==pt){r+=" var "+u+" = true; ";q=o;if(void 0!==ht){var dt=ht,_t="minimum",mt="less";r+=" "+u+" = pgPropCount"+n+" >= "+ht+"; ",o=t.errSchemaPath+"/patternGroups/minimum",r+="  if (!"+u+") {   ",(yt=yt||[]).push(r),r="",!1!==t.createErrors?(r+=" { keyword: 'patternGroups' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(o)+" , params: { reason: '"+_t+"', limit: "+dt+", pattern: '"+t.util.escapeQuotes(lt)+"' } ",!1!==t.opts.messages&&(r+=" , message: 'should NOT have "+mt+" than "+dt+' properties matching pattern "'+t.util.escapeQuotes(lt)+"\"' "),t.opts.verbose&&(r+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ";H=r;r=yt.pop(),!t.compositeRule&&c?t.async?r+=" throw new ValidationError(["+H+"]); ":r+=" validate.errors = ["+H+"]; return false; ":r+=" var err = "+H+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } ",void 0!==pt&&(r+=" else ")}if(void 0!==pt){var yt;dt=pt,_t="maximum",mt="more";r+=" "+u+" = pgPropCount"+n+" <= "+pt+"; ",o=t.errSchemaPath+"/patternGroups/maximum",r+="  if (!"+u+") {   ",(yt=yt||[]).push(r),r="",!1!==t.createErrors?(r+=" { keyword: 'patternGroups' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(o)+" , params: { reason: '"+_t+"', limit: "+dt+", pattern: '"+t.util.escapeQuotes(lt)+"' } ",!1!==t.opts.messages&&(r+=" , message: 'should NOT have "+mt+" than "+dt+' properties matching pattern "'+t.util.escapeQuotes(lt)+"\"' "),t.opts.verbose&&(r+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ";H=r;r=yt.pop(),!t.compositeRule&&c?t.async?r+=" throw new ValidationError(["+H+"]); ":r+=" validate.errors = ["+H+"]; return false; ":r+=" var err = "+H+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } "}o=q,c&&(r+=" if ("+u+") { ",h+="}")}}}}return c&&(r+=" "+h+" if ("+f+" == errors) {"),r=t.util.cleanUpCode(r)}},{}],34:[function(t,e,r){"use strict";e.exports=function(t,e){var r,n,i=" ",s=t.level,a=t.dataLevel,o=t.schema[e],c=t.errSchemaPath+"/"+e,l=!t.opts.allErrors,u="data"+(a||""),f="valid"+s;if("#"==o||"#/"==o)t.isRoot?(r=t.async,n="validate"):(r=!0===t.root.schema.$async,n="root.refVal[0]");else{var $=t.resolveRef(t.baseId,o,t.isRoot);if(void 0===$){var h="can't resolve reference "+o+" from id "+t.baseId;if("fail"==t.opts.missingRefs){console.log(h),(y=y||[]).push(i),i="",!1!==t.createErrors?(i+=" { keyword: '$ref' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(c)+" , params: { ref: '"+t.util.escapeQuotes(o)+"' } ",!1!==t.opts.messages&&(i+=" , message: 'can\\'t resolve reference "+t.util.escapeQuotes(o)+"' "),t.opts.verbose&&(i+=" , schema: "+t.util.toQuotedString(o)+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+u+" "),i+=" } "):i+=" {} ";var p=i;i=y.pop(),!t.compositeRule&&l?t.async?i+=" throw new ValidationError(["+p+"]); ":i+=" validate.errors = ["+p+"]; return false; ":i+=" var err = "+p+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",l&&(i+=" if (false) { ")}else{if("ignore"!=t.opts.missingRefs){var d=new Error(h);throw d.missingRef=t.resolve.url(t.baseId,o),d.missingSchema=t.resolve.normalizeId(t.resolve.fullPath(d.missingRef)),d}console.log(h),l&&(i+=" if (true) { ")}}else if($.inline){var _=t.util.copy(t);_.level++;var m="valid"+_.level;_.schema=$.schema,_.schemaPath="",_.errSchemaPath=o,i+=" "+t.validate(_).replace(/validate\.schema/g,$.code)+" ",l&&(i+=" if ("+m+") { ")}else r=!0===$.$async,n=$.code}if(n){var y;(y=y||[]).push(i),i="",t.opts.passContext?i+=" "+n+".call(this, ":i+=" "+n+"( ",i+=" "+u+", (dataPath || '')",'""'!=t.errorPath&&(i+=" + "+t.errorPath);var g=i+=" , "+(a?"data"+(a-1||""):"parentData")+" , "+(a?t.dataPathArr[a]:"parentDataProperty")+", rootData)  ";if(i=y.pop(),r){if(!t.async)throw new Error("async schema referenced by sync schema");i+=" try { ",l&&(i+="var "+f+" ="),i+=" "+t.yieldAwait+" "+g+"; } catch (e) { if (!(e instanceof ValidationError)) throw e; if (vErrors === null) vErrors = e.errors; else vErrors = vErrors.concat(e.errors); errors = vErrors.length; } ",l&&(i+=" if ("+f+") { ")}else i+=" if (!"+g+") { if (vErrors === null) vErrors = "+n+".errors; else vErrors = vErrors.concat("+n+".errors); errors = vErrors.length; } ",l&&(i+=" else { ")}return i}},{}],35:[function(t,e,r){"use strict";e.exports=function(t,e){var r=" ",n=t.level,i=t.dataLevel,s=t.schema[e],a=t.schemaPath+t.util.getProperty(e),o=t.errSchemaPath+"/"+e,c=!t.opts.allErrors,l="data"+(i||""),u="valid"+n,f=t.opts.v5&&s&&s.$data;f&&(r+=" var schema"+n+" = "+t.util.getData(s.$data,i,t.dataPathArr)+"; ");var $="schema"+n;if(!f)if(s.length<t.opts.loopRequired&&t.schema.properties&&Object.keys(t.schema.properties).length){var h=[],p=s;if(p)for(var d,_=-1,m=p.length-1;_<m;){d=p[_+=1];var y=t.schema.properties[d];y&&t.util.schemaHasRules(y,t.RULES.all)||(h[h.length]=d)}}else h=s;if(f||h.length){var g=t.errorPath,v=f||h.length>=t.opts.loopRequired;if(c)if(r+=" var missing"+n+"; ",v){f||(r+=" var "+$+" = validate.schema"+a+"; ");var b="' + "+(N="schema"+n+"["+(k="i"+n)+"]")+" + '";t.opts._errorDataPathProperty&&(t.errorPath=t.util.getPathExpr(g,N,t.opts.jsonPointers)),r+=" var "+u+" = true; ",f&&(r+=" if (schema"+n+" === undefined) "+u+" = true; else if (!Array.isArray(schema"+n+")) "+u+" = false; else {"),r+=" for (var "+k+" = 0; "+k+" < "+$+".length; "+k+"++) { "+u+" = "+l+"["+$+"["+k+"]] !== undefined; if (!"+u+") break; } ",f&&(r+="  }  "),r+="  if (!"+u+") {   ",(S=S||[]).push(r),r="",!1!==t.createErrors?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(o)+" , params: { missingProperty: '"+b+"' } ",!1!==t.opts.messages&&(r+=" , message: '",t.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+b+"\\'",r+="' "),t.opts.verbose&&(r+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ";var A=r;r=S.pop(),!t.compositeRule&&c?t.async?r+=" throw new ValidationError(["+A+"]); ":r+=" validate.errors = ["+A+"]; return false; ":r+=" var err = "+A+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } else { "}else{r+=" if ( ";var x=h;if(x)for(var w,k=-1,E=x.length-1;k<E;){w=x[k+=1],k&&(r+=" || "),r+=" ( "+l+(M=t.util.getProperty(w))+" === undefined && (missing"+n+" = "+t.util.toQuotedString(t.opts.jsonPointers?w:M)+") ) "}r+=") {  ";var S;b="' + "+(N="missing"+n)+" + '";t.opts._errorDataPathProperty&&(t.errorPath=t.opts.jsonPointers?t.util.getPathExpr(g,N,!0):g+" + "+N),(S=S||[]).push(r),r="",!1!==t.createErrors?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(o)+" , params: { missingProperty: '"+b+"' } ",!1!==t.opts.messages&&(r+=" , message: '",t.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+b+"\\'",r+="' "),t.opts.verbose&&(r+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ";A=r;r=S.pop(),!t.compositeRule&&c?t.async?r+=" throw new ValidationError(["+A+"]); ":r+=" validate.errors = ["+A+"]; return false; ":r+=" var err = "+A+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } else { "}else if(v){f||(r+=" var "+$+" = validate.schema"+a+"; ");var N;b="' + "+(N="schema"+n+"["+(k="i"+n)+"]")+" + '";t.opts._errorDataPathProperty&&(t.errorPath=t.util.getPathExpr(g,N,t.opts.jsonPointers)),f&&(r+=" if ("+$+" && !Array.isArray("+$+")) {  var err =   ",!1!==t.createErrors?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(o)+" , params: { missingProperty: '"+b+"' } ",!1!==t.opts.messages&&(r+=" , message: '",t.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+b+"\\'",r+="' "),t.opts.verbose&&(r+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } else if ("+$+" !== undefined) { "),r+=" for (var "+k+" = 0; "+k+" < "+$+".length; "+k+"++) { if ("+l+"["+$+"["+k+"]] === undefined) {  var err =   ",!1!==t.createErrors?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(o)+" , params: { missingProperty: '"+b+"' } ",!1!==t.opts.messages&&(r+=" , message: '",t.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+b+"\\'",r+="' "),t.opts.verbose&&(r+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } } ",f&&(r+="  }  ")}else{var I=h;if(I)for(var C,O=-1,B=I.length-1;O<B;){C=I[O+=1];var M=t.util.getProperty(C);b=t.util.escapeQuotes(C);t.opts._errorDataPathProperty&&(t.errorPath=t.util.getPath(g,C,t.opts.jsonPointers)),r+=" if ("+l+M+" === undefined) {  var err =   ",!1!==t.createErrors?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(o)+" , params: { missingProperty: '"+b+"' } ",!1!==t.opts.messages&&(r+=" , message: '",t.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+b+"\\'",r+="' "),t.opts.verbose&&(r+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}t.errorPath=g}else c&&(r+=" if (true) {");return r}},{}],36:[function(t,e,r){"use strict";e.exports=function(t,e){var r=" ",n=t.level,i=t.dataLevel,s=t.schema[e],a=t.schemaPath+t.util.getProperty(e),o=t.errSchemaPath+"/"+e,c=!t.opts.allErrors,l="data"+(i||""),u="valid"+n,f="errs__"+n,$=t.util.copy(t),h="";$.level++;var p,d="valid"+$.level,_="ifPassed"+t.level,m=$.baseId;r+="var "+_+";";var y=s;if(y)for(var g,v=-1,b=y.length-1;v<b;){if(g=y[v+=1],v&&!p&&(r+=" if (!"+_+") { ",h+="}"),g.if&&t.util.schemaHasRules(g.if,t.RULES.all)){r+=" var "+f+" = errors;   ";var A=t.compositeRule;if(t.compositeRule=$.compositeRule=!0,$.createErrors=!1,$.schema=g.if,$.schemaPath=a+"["+v+"].if",$.errSchemaPath=o+"/"+v+"/if",r+="  "+t.validate($)+" ",$.baseId=m,$.createErrors=!0,t.compositeRule=$.compositeRule=A,r+=" "+_+" = "+d+"; if ("+_+") {  ","boolean"==typeof g.then){if(!1===g.then){(w=w||[]).push(r),r="",!1!==t.createErrors?(r+=" { keyword: 'switch' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(o)+" , params: { caseIndex: "+v+" } ",!1!==t.opts.messages&&(r+=" , message: 'should pass \"switch\" keyword validation' "),t.opts.verbose&&(r+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ";var x=r;r=w.pop(),!t.compositeRule&&c?t.async?r+=" throw new ValidationError(["+x+"]); ":r+=" validate.errors = ["+x+"]; return false; ":r+=" var err = "+x+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}r+=" var "+d+" = "+g.then+"; "}else $.schema=g.then,$.schemaPath=a+"["+v+"].then",$.errSchemaPath=o+"/"+v+"/then",r+="  "+t.validate($)+" ",$.baseId=m;r+="  } else {  errors = "+f+"; if (vErrors !== null) { if ("+f+") vErrors.length = "+f+"; else vErrors = null; } } "}else if(r+=" "+_+" = true;  ","boolean"==typeof g.then){if(!1===g.then){var w;(w=w||[]).push(r),r="",!1!==t.createErrors?(r+=" { keyword: 'switch' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(o)+" , params: { caseIndex: "+v+" } ",!1!==t.opts.messages&&(r+=" , message: 'should pass \"switch\" keyword validation' "),t.opts.verbose&&(r+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ";x=r;r=w.pop(),!t.compositeRule&&c?t.async?r+=" throw new ValidationError(["+x+"]); ":r+=" validate.errors = ["+x+"]; return false; ":r+=" var err = "+x+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}r+=" var "+d+" = "+g.then+"; "}else $.schema=g.then,$.schemaPath=a+"["+v+"].then",$.errSchemaPath=o+"/"+v+"/then",r+="  "+t.validate($)+" ",$.baseId=m;p=g.continue}return r+=h+"var "+u+" = "+d+"; ",r=t.util.cleanUpCode(r)}},{}],37:[function(t,e,r){"use strict";e.exports=function(t,e){var r,n=" ",i=t.level,s=t.dataLevel,a=t.schema[e],o=t.schemaPath+t.util.getProperty(e),c=t.errSchemaPath+"/"+e,l=!t.opts.allErrors,u="data"+(s||""),f="valid"+i,$=t.opts.v5&&a&&a.$data;if($?(n+=" var schema"+i+" = "+t.util.getData(a.$data,s,t.dataPathArr)+"; ",r="schema"+i):r=a,(a||$)&&!1!==t.opts.uniqueItems){$&&(n+=" var "+f+"; if ("+r+" === false || "+r+" === undefined) "+f+" = true; else if (typeof "+r+" != 'boolean') "+f+" = false; else { "),n+=" var "+f+" = true; if ("+u+".length > 1) { var i = "+u+".length, j; outer: for (;i--;) { for (j = i; j--;) { if (equal("+u+"[i], "+u+"[j])) { "+f+" = false; break outer; } } } } ",$&&(n+="  }  "),n+=" if (!"+f+") {   ";var h=h||[];h.push(n),n="",!1!==t.createErrors?(n+=" { keyword: 'uniqueItems' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(c)+" , params: { i: i, j: j } ",!1!==t.opts.messages&&(n+=" , message: 'should NOT have duplicate items (items ## ' + j + ' and ' + i + ' are identical)' "),t.opts.verbose&&(n+=" , schema:  ",n+=$?"validate.schema"+o:""+a,n+="         , parentSchema: validate.schema"+t.schemaPath+" , data: "+u+" "),n+=" } "):n+=" {} ";var p=n;n=h.pop(),!t.compositeRule&&l?t.async?n+=" throw new ValidationError(["+p+"]); ":n+=" validate.errors = ["+p+"]; return false; ":n+=" var err = "+p+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } ",l&&(n+=" else { ")}else l&&(n+=" if (true) { ");return n}},{}],38:[function(t,e,r){"use strict";e.exports=function(t,e){var r="",n=!0===t.schema.$async;if(t.isTop){var i=t.isTop,s=t.level=0,a=t.dataLevel=0,o="data";if(t.rootId=t.resolve.fullPath(t.root.schema.id),t.baseId=t.baseId||t.rootId,n){t.async=!0;var c="es7"==t.opts.async;t.yieldAwait=c?"await":"yield"}delete t.isTop,t.dataPathArr=[void 0],r+=" var validate = ",n?c?r+=" (async function ":("co*"==t.opts.async&&(r+="co.wrap"),r+="(function* "):r+=" (function ",r+=" (data, dataPath, parentData, parentDataProperty, rootData) { 'use strict'; var vErrors = null; ",r+=" var errors = 0;     ",r+=" if (rootData === undefined) rootData = data;"}else{s=t.level,o="data"+((a=t.dataLevel)||"");if(t.schema.id&&(t.baseId=t.resolve.url(t.baseId,t.schema.id)),n&&!t.async)throw new Error("async schema in sync schema");r+=" var errs_"+s+" = errors;"}var l,u="valid"+s,f=!t.opts.allErrors,$="",h="",p=t.schema.type,d=Array.isArray(p);if(p&&t.opts.coerceTypes){var _=t.util.coerceToTypes(t.opts.coerceTypes,p);if(_){var m=t.schemaPath+".type",y=t.errSchemaPath+"/type",g=d?"checkDataTypes":"checkDataType";r+=" if ("+t.util[g](p,o,!0)+") {  ";var v="dataType"+s,b="coerced"+s;r+=" var "+v+" = typeof "+o+"; ","array"==t.opts.coerceTypes&&(r+=" if ("+v+" == 'object' && Array.isArray("+o+")) "+v+" = 'array'; "),r+=" var "+b+" = undefined; ";var A="",x=_;if(x)for(var w,k=-1,E=x.length-1;k<E;)w=x[k+=1],k&&(r+=" if ("+b+" === undefined) { ",A+="}"),"array"==t.opts.coerceTypes&&"array"!=w&&(r+=" if ("+v+" == 'array' && "+o+".length == 1) { "+b+" = "+o+" = "+o+"[0]; "+v+" = typeof "+o+";  } "),"string"==w?r+=" if ("+v+" == 'number' || "+v+" == 'boolean') "+b+" = '' + "+o+"; else if ("+o+" === null) "+b+" = ''; ":"number"==w||"integer"==w?(r+=" if ("+v+" == 'boolean' || "+o+" === null || ("+v+" == 'string' && "+o+" && "+o+" == +"+o+" ","integer"==w&&(r+=" && !("+o+" % 1)"),r+=")) "+b+" = +"+o+"; "):"boolean"==w?r+=" if ("+o+" === 'false' || "+o+" === 0 || "+o+" === null) "+b+" = false; else if ("+o+" === 'true' || "+o+" === 1) "+b+" = true; ":"null"==w?r+=" if ("+o+" === '' || "+o+" === 0 || "+o+" === false) "+b+" = null; ":"array"==t.opts.coerceTypes&&"array"==w&&(r+=" if ("+v+" == 'string' || "+v+" == 'number' || "+v+" == 'boolean' || "+o+" == null) "+b+" = ["+o+"]; ");r+=" "+A+" if ("+b+" === undefined) {   ",(G=G||[]).push(r),r="",!1!==t.createErrors?(r+=" { keyword: 'type' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(y)+" , params: { type: '",r+=d?""+p.join(","):""+p,r+="' } ",!1!==t.opts.messages&&(r+=" , message: 'should be ",r+=d?""+p.join(","):""+p,r+="' "),t.opts.verbose&&(r+=" , schema: validate.schema"+m+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+o+" "),r+=" } "):r+=" {} ";var S=r;r=G.pop(),!t.compositeRule&&f?t.async?r+=" throw new ValidationError(["+S+"]); ":r+=" validate.errors = ["+S+"]; return false; ":r+=" var err = "+S+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } else {  ";var N=a?"data"+(a-1||""):"parentData";r+=" "+o+" = "+b+"; ",a||(r+="if ("+N+" !== undefined)"),r+=" "+N+"["+(a?t.dataPathArr[a]:"parentDataProperty")+"] = "+b+"; } } "}}if(t.schema.$ref&&(l=t.util.schemaHasRulesExcept(t.schema,t.RULES.all,"$ref"))){if("fail"==t.opts.extendRefs)throw new Error('$ref: validation keywords used in schema at path "'+t.errSchemaPath+'"');"ignore"==t.opts.extendRefs?(l=!1,console.log('$ref: keywords ignored in schema at path "'+t.errSchemaPath+'"')):!0!==t.opts.extendRefs&&console.log('$ref: all keywords used in schema at path "'+t.errSchemaPath+'". It will change in the next major version, see issue #260. Use option { extendRefs: true } to keep current behaviour')}if(t.schema.$ref&&!l)r+=" "+t.RULES.all.$ref.code(t,"$ref")+" ",f&&(r+=" } if (errors === ",r+=i?"0":"errs_"+s,r+=") { ",h+="}");else{var I=t.RULES;if(I)for(var C,O=-1,B=I.length-1;O<B;)if(V(C=I[O+=1])){if(C.type&&(r+=" if ("+t.util.checkDataType(C.type,o)+") { "),t.opts.useDefaults&&!t.compositeRule)if("object"==C.type&&t.schema.properties){var M=t.schema.properties,P=Object.keys(M);if(P)for(var F,L=-1,T=P.length-1;L<T;){if(void 0!==(R=M[F=P[L+=1]]).default)r+="  if ("+(z=o+t.util.getProperty(F))+" === undefined) "+z+" = ","shared"==t.opts.useDefaults?r+=" "+t.useDefault(R.default)+" ":r+=" "+JSON.stringify(R.default)+" ",r+="; "}}else if("array"==C.type&&Array.isArray(t.schema.items)){var j=t.schema.items;if(j){k=-1;for(var R,D=j.length-1;k<D;){var z;if(void 0!==(R=j[k+=1]).default)r+="  if ("+(z=o+"["+k+"]")+" === undefined) "+z+" = ","shared"==t.opts.useDefaults?r+=" "+t.useDefault(R.default)+" ":r+=" "+JSON.stringify(R.default)+" ",r+="; "}}}var U=C.rules;if(U)for(var q,H=-1,Q=U.length-1;H<Q;)J(q=U[H+=1])&&(r+=" "+q.code(t,q.keyword)+" ",f&&($+="}"));if(f&&(r+=" "+$+" ",$=""),C.type&&(r+=" } ",p&&p===C.type&&!_)){var Y=!0;r+=" else { ";m=t.schemaPath+".type",y=t.errSchemaPath+"/type";(G=G||[]).push(r),r="",!1!==t.createErrors?(r+=" { keyword: 'type' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(y)+" , params: { type: '",r+=d?""+p.join(","):""+p,r+="' } ",!1!==t.opts.messages&&(r+=" , message: 'should be ",r+=d?""+p.join(","):""+p,r+="' "),t.opts.verbose&&(r+=" , schema: validate.schema"+m+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+o+" "),r+=" } "):r+=" {} ";S=r;r=G.pop(),!t.compositeRule&&f?t.async?r+=" throw new ValidationError(["+S+"]); ":r+=" validate.errors = ["+S+"]; return false; ":r+=" var err = "+S+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } "}f&&(r+=" if (errors === ",r+=i?"0":"errs_"+s,r+=") { ",h+="}")}}if(p&&!Y&&!_){var G;m=t.schemaPath+".type",y=t.errSchemaPath+"/type",g=d?"checkDataTypes":"checkDataType";r+=" if ("+t.util[g](p,o,!0)+") {   ",(G=G||[]).push(r),r="",!1!==t.createErrors?(r+=" { keyword: 'type' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(y)+" , params: { type: '",r+=d?""+p.join(","):""+p,r+="' } ",!1!==t.opts.messages&&(r+=" , message: 'should be ",r+=d?""+p.join(","):""+p,r+="' "),t.opts.verbose&&(r+=" , schema: validate.schema"+m+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+o+" "),r+=" } "):r+=" {} ";S=r;r=G.pop(),!t.compositeRule&&f?t.async?r+=" throw new ValidationError(["+S+"]); ":r+=" validate.errors = ["+S+"]; return false; ":r+=" var err = "+S+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" }"}function V(t){for(var e=0;e<t.rules.length;e++)if(J(t.rules[e]))return!0}function J(e){return void 0!==t.schema[e.keyword]||"properties"==e.keyword&&(!1===t.schema.additionalProperties||"object"==typeof t.schema.additionalProperties||t.schema.patternProperties&&Object.keys(t.schema.patternProperties).length||t.opts.v5&&t.schema.patternGroups&&Object.keys(t.schema.patternGroups).length)}return f&&(r+=" "+h+" "),i?(n?(r+=" if (errors === 0) return true;           ",r+=" else throw new ValidationError(vErrors); "):(r+=" validate.errors = vErrors; ",r+=" return errors === 0;       "),r+=" }); return validate;"):r+=" var "+u+" = errors === errs_"+s+";",r=t.util.cleanUpCode(r),i&&f&&(r=t.util.cleanUpVarErrors(r,n)),r}},{}],39:[function(t,e,r){"use strict";var n=/^[a-z_$][a-z0-9_$\-]*$/i,i=t("./dotjs/custom");e.exports={add:function(t,e){var r=this.RULES;if(r.keywords[t])throw new Error("Keyword "+t+" is already defined");if(!n.test(t))throw new Error("Keyword "+t+" is not a valid identifier");if(e){if(e.macro&&void 0!==e.valid)throw new Error('"valid" option cannot be used with macro keywords');var s=e.type;if(Array.isArray(s)){var a,o=s.length;for(a=0;a<o;a++)f(s[a]);for(a=0;a<o;a++)u(t,s[a],e)}else s&&f(s),u(t,s,e);var c=!0===e.$data&&this._opts.v5;if(c&&!e.validate)throw new Error('$data support: "validate" function is not defined');var l=e.metaSchema;l&&(c&&(l={anyOf:[l,{$ref:"https://raw.githubusercontent.com/epoberezkin/ajv/master/lib/refs/json-schema-v5.json#/definitions/$data"}]}),e.validateSchema=this.compile(l,!0))}function u(t,e,n){for(var s,a=0;a<r.length;a++){var o=r[a];if(o.type==e){s=o;break}}s||(s={type:e,rules:[]},r.push(s));var c={keyword:t,definition:n,custom:!0,code:i};s.rules.push(c),r.custom[t]=c}function f(t){if(!r.types[t])throw new Error("Unknown type "+t)}r.keywords[t]=r.all[t]=!0},get:function(t){var e=this.RULES.custom[t];return e?e.definition:this.RULES.keywords[t]||!1},remove:function(t){var e=this.RULES;delete e.keywords[t],delete e.all[t],delete e.custom[t];for(var r=0;r<e.length;r++)for(var n=e[r].rules,i=0;i<n.length;i++)if(n[i].keyword==t){n.splice(i,1);break}}}},{"./dotjs/custom":23}],40:[function(t,e,r){e.exports={id:"http://json-schema.org/draft-04/schema#",$schema:"http://json-schema.org/draft-04/schema#",description:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},positiveInteger:{type:"integer",minimum:0},positiveIntegerDefault0:{allOf:[{$ref:"#/definitions/positiveInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},minItems:1,uniqueItems:!0}},type:"object",properties:{id:{type:"string",format:"uri"},$schema:{type:"string",format:"uri"},title:{type:"string"},description:{type:"string"},default:{},multipleOf:{type:"number",minimum:0,exclusiveMinimum:!0},maximum:{type:"number"},exclusiveMaximum:{type:"boolean",default:!1},minimum:{type:"number"},exclusiveMinimum:{type:"boolean",default:!1},maxLength:{$ref:"#/definitions/positiveInteger"},minLength:{$ref:"#/definitions/positiveIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{anyOf:[{type:"boolean"},{$ref:"#"}],default:{}},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:{}},maxItems:{$ref:"#/definitions/positiveInteger"},minItems:{$ref:"#/definitions/positiveIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},maxProperties:{$ref:"#/definitions/positiveInteger"},minProperties:{$ref:"#/definitions/positiveIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{anyOf:[{type:"boolean"},{$ref:"#"}],default:{}},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},enum:{type:"array",minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},dependencies:{exclusiveMaximum:["maximum"],exclusiveMinimum:["minimum"]},default:{}}},{}],41:[function(t,e,r){e.exports={id:"https://raw.githubusercontent.com/epoberezkin/ajv/master/lib/refs/json-schema-v5.json#",$schema:"http://json-schema.org/draft-04/schema#",description:"Core schema meta-schema (v5 proposals)",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},positiveInteger:{type:"integer",minimum:0},positiveIntegerDefault0:{allOf:[{$ref:"#/definitions/positiveInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},minItems:1,uniqueItems:!0},$data:{type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1}},type:"object",properties:{id:{type:"string",format:"uri"},$schema:{type:"string",format:"uri"},title:{type:"string"},description:{type:"string"},default:{},multipleOf:{anyOf:[{type:"number",minimum:0,exclusiveMinimum:!0},{$ref:"#/definitions/$data"}]},maximum:{anyOf:[{type:"number"},{$ref:"#/definitions/$data"}]},exclusiveMaximum:{anyOf:[{type:"boolean",default:!1},{$ref:"#/definitions/$data"}]},minimum:{anyOf:[{type:"number"},{$ref:"#/definitions/$data"}]},exclusiveMinimum:{anyOf:[{type:"boolean",default:!1},{$ref:"#/definitions/$data"}]},maxLength:{anyOf:[{$ref:"#/definitions/positiveInteger"},{$ref:"#/definitions/$data"}]},minLength:{anyOf:[{$ref:"#/definitions/positiveIntegerDefault0"},{$ref:"#/definitions/$data"}]},pattern:{anyOf:[{type:"string",format:"regex"},{$ref:"#/definitions/$data"}]},additionalItems:{anyOf:[{type:"boolean"},{$ref:"#"},{$ref:"#/definitions/$data"}],default:{}},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:{}},maxItems:{anyOf:[{$ref:"#/definitions/positiveInteger"},{$ref:"#/definitions/$data"}]},minItems:{anyOf:[{$ref:"#/definitions/positiveIntegerDefault0"},{$ref:"#/definitions/$data"}]},uniqueItems:{anyOf:[{type:"boolean",default:!1},{$ref:"#/definitions/$data"}]},maxProperties:{anyOf:[{$ref:"#/definitions/positiveInteger"},{$ref:"#/definitions/$data"}]},minProperties:{anyOf:[{$ref:"#/definitions/positiveIntegerDefault0"},{$ref:"#/definitions/$data"}]},required:{anyOf:[{$ref:"#/definitions/stringArray"},{$ref:"#/definitions/$data"}]},additionalProperties:{anyOf:[{type:"boolean"},{$ref:"#"},{$ref:"#/definitions/$data"}],default:{}},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},enum:{anyOf:[{type:"array",minItems:1,uniqueItems:!0},{$ref:"#/definitions/$data"}]},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"},format:{anyOf:[{type:"string"},{$ref:"#/definitions/$data"}]},formatMaximum:{anyOf:[{type:"string"},{$ref:"#/definitions/$data"}]},formatMinimum:{anyOf:[{type:"string"},{$ref:"#/definitions/$data"}]},formatExclusiveMaximum:{anyOf:[{type:"boolean",default:!1},{$ref:"#/definitions/$data"}]},formatExclusiveMinimum:{anyOf:[{type:"boolean",default:!1},{$ref:"#/definitions/$data"}]},constant:{anyOf:[{},{$ref:"#/definitions/$data"}]},contains:{$ref:"#"},patternGroups:{type:"object",additionalProperties:{type:"object",required:["schema"],properties:{maximum:{anyOf:[{$ref:"#/definitions/positiveInteger"},{$ref:"#/definitions/$data"}]},minimum:{anyOf:[{$ref:"#/definitions/positiveIntegerDefault0"},{$ref:"#/definitions/$data"}]},schema:{$ref:"#"}},additionalProperties:!1},default:{}},switch:{type:"array",items:{required:["then"],properties:{if:{$ref:"#"},then:{anyOf:[{type:"boolean"},{$ref:"#"}]},continue:{type:"boolean"}},additionalProperties:!1,dependencies:{continue:["if"]}}}},dependencies:{exclusiveMaximum:["maximum"],exclusiveMinimum:["minimum"],formatMaximum:["format"],formatMinimum:["format"],formatExclusiveMaximum:["formatMaximum"],formatExclusiveMinimum:["formatMinimum"]},default:{}}},{}],42:[function(t,e,r){"use strict";var n="https://raw.githubusercontent.com/epoberezkin/ajv/master/lib/refs/json-schema-v5.json";function i(t){return{not:{items:{not:t}}}}e.exports={enable:function(e){var r={switch:t("./dotjs/switch"),constant:t("./dotjs/constant"),_formatLimit:t("./dotjs/_formatLimit"),patternRequired:t("./dotjs/patternRequired")};if(!1!==e._opts.meta){var s=t("./refs/json-schema-v5.json");e.addMetaSchema(s,n)}function a(t,n,i){var s={inline:i||r[t],statements:!0,errors:"full"};n&&(s.type=n),e.addKeyword(t,s)}a("constant"),e.addKeyword("contains",{type:"array",macro:i}),a("formatMaximum","string",r._formatLimit),a("formatMinimum","string",r._formatLimit),e.addKeyword("formatExclusiveMaximum"),e.addKeyword("formatExclusiveMinimum"),e.addKeyword("patternGroups"),a("patternRequired","object"),a("switch")},META_SCHEMA_ID:n}},{"./dotjs/_formatLimit":15,"./dotjs/constant":22,"./dotjs/patternRequired":32,"./dotjs/switch":36,"./refs/json-schema-v5.json":41}],43:[function(t,e,r){"use strict";function n(t,e,r){t instanceof RegExp&&(t=i(t,r)),e instanceof RegExp&&(e=i(e,r));var n=s(t,e,r);return n&&{start:n[0],end:n[1],pre:r.slice(0,n[0]),body:r.slice(n[0]+t.length,n[1]),post:r.slice(n[1]+e.length)}}function i(t,e){var r=e.match(t);return r?r[0]:null}function s(t,e,r){var n,i,s,a,o,c=r.indexOf(t),l=r.indexOf(e,c+1),u=c;if(c>=0&&l>0){for(n=[],s=r.length;u>=0&&!o;)u==c?(n.push(u),c=r.indexOf(t,u+1)):1==n.length?o=[n.pop(),l]:((i=n.pop())<s&&(s=i,a=l),l=r.indexOf(e,u+1)),u=c<l&&c>=0?c:l;n.length&&(o=[s,a])}return o}e.exports=n,n.range=s},{}],44:[function(t,e,r){var n=t("concat-map"),i=t("balanced-match");e.exports=function(t){if(!t)return[];"{}"===t.substr(0,2)&&(t="\\{\\}"+t.substr(2));return function t(e,r){var s=[];var a=i("{","}",e);if(!a||/\$$/.test(a.pre))return[e];var c=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(a.body);var l=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(a.body);var f=c||l;var _=a.body.indexOf(",")>=0;if(!f&&!_)return a.post.match(/,.*\}/)?(e=a.pre+"{"+a.body+o+a.post,t(e)):[e];var m;if(f)m=a.body.split(/\.\./);else if(1===(m=function t(e){if(!e)return[""];var r=[];var n=i("{","}",e);if(!n)return e.split(",");var s=n.pre;var a=n.body;var o=n.post;var c=s.split(",");c[c.length-1]+="{"+a+"}";var l=t(o);o.length&&(c[c.length-1]+=l.shift(),c.push.apply(c,l));r.push.apply(r,c);return r}(a.body)).length&&1===(m=t(m[0],!1).map($)).length){var y=a.post.length?t(a.post,!1):[""];return y.map(function(t){return a.pre+m[0]+t})}var g=a.pre;var y=a.post.length?t(a.post,!1):[""];var v;if(f){var b=u(m[0]),A=u(m[1]),x=Math.max(m[0].length,m[1].length),w=3==m.length?Math.abs(u(m[2])):1,k=p,E=A<b;E&&(w*=-1,k=d);var S=m.some(h);v=[];for(var N=b;k(N,A);N+=w){var I;if(l)"\\"===(I=String.fromCharCode(N))&&(I="");else if(I=String(N),S){var C=x-I.length;if(C>0){var O=new Array(C+1).join("0");I=N<0?"-"+O+I.slice(1):O+I}}v.push(I)}}else v=n(m,function(e){return t(e,!1)});for(var B=0;B<v.length;B++)for(var M=0;M<y.length;M++){var P=g+v[B]+y[M];(!r||f||P)&&s.push(P)}return s}(function(t){return t.split("\\\\").join(s).split("\\{").join(a).split("\\}").join(o).split("\\,").join(c).split("\\.").join(l)}(t),!0).map(f)};var s="\0SLASH"+Math.random()+"\0",a="\0OPEN"+Math.random()+"\0",o="\0CLOSE"+Math.random()+"\0",c="\0COMMA"+Math.random()+"\0",l="\0PERIOD"+Math.random()+"\0";function u(t){return parseInt(t,10)==t?parseInt(t,10):t.charCodeAt(0)}function f(t){return t.split(s).join("\\").split(a).join("{").split(o).join("}").split(c).join(",").split(l).join(".")}function $(t){return"{"+t+"}"}function h(t){return/^-?0\d/.test(t)}function p(t,e){return t<=e}function d(t,e){return t>=e}},{"balanced-match":43,"concat-map":46}],45:[function(t,e,r){var n=Array.prototype.slice;function i(t){var e=this,r=n.call(arguments,1);return new Promise(function(n,i){if("function"==typeof t&&(t=t.apply(e,r)),!t||"function"!=typeof t.next)return n(t);function o(e){var r;try{r=t.next(e)}catch(t){return i(t)}l(r)}function c(e){var r;try{r=t.throw(e)}catch(t){return i(t)}l(r)}function l(t){if(t.done)return n(t.value);var r=s.call(e,t.value);return r&&a(r)?r.then(o,c):c(new TypeError('You may only yield a function, promise, generator, array, or object, but the following object was passed: "'+String(t.value)+'"'))}o()})}function s(t){return t?a(t)?t:function(t){var e=t.constructor;return!!e&&("GeneratorFunction"===e.name||"GeneratorFunction"===e.displayName||o(e.prototype))}(t)||o(t)?i.call(this,t):"function"==typeof t?function(t){var e=this;return new Promise(function(r,i){t.call(e,function(t,e){if(t)return i(t);arguments.length>2&&(e=n.call(arguments,1)),r(e)})})}.call(this,t):Array.isArray(t)?function(t){return Promise.all(t.map(s,this))}.call(this,t):Object==t.constructor?function(t){for(var e=new t.constructor,r=Object.keys(t),n=[],i=0;i<r.length;i++){var o=r[i],c=s.call(this,t[o]);c&&a(c)?l(c,o):e[o]=t[o]}return Promise.all(n).then(function(){return e});function l(t,r){e[r]=void 0,n.push(t.then(function(t){e[r]=t}))}}.call(this,t):t:t}function a(t){return"function"==typeof t.then}function o(t){return"function"==typeof t.next&&"function"==typeof t.throw}e.exports=i.default=i.co=i,i.wrap=function(t){return e.__generatorFunction__=t,e;function e(){return i.call(this,t.apply(this,arguments))}}},{}],46:[function(t,e,r){e.exports=function(t,e){for(var r=[],i=0;i<t.length;i++){var s=e(t[i],i);n(s)?r.push.apply(r,s):r.push(s)}return r};var n=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},{}],47:[function(t,e,r){"use strict";var n=t("iconv-lite"),i=t("./iconv-loader");function s(t,e,r){return"UTF-8"===e?n.decode(t,r):"UTF-8"===r?n.encode(t,e):n.encode(n.decode(t,r),e)}function a(t){return(t||"").toString().trim().replace(/^latin[\-_]?(\d+)$/i,"ISO-8859-$1").replace(/^win(?:dows)?[\-_]?(\d+)$/i,"WINDOWS-$1").replace(/^utf[\-_]?(\d+)$/i,"UTF-$1").replace(/^ks_c_5601\-1987$/i,"CP949").replace(/^us[\-_]?ascii$/i,"ASCII").toUpperCase()}e.exports.convert=function(t,e,r,n){var o;r=a(r||"UTF-8"),e=a(e||"UTF-8"),t=t||"","UTF-8"!==r&&"string"==typeof t&&(t=new Buffer(t,"binary"));if(r===e)o="string"==typeof t?new Buffer(t):t;else if(i&&!n)try{o=function(t,e,r){var n,s;return s=new i(r,e+"//TRANSLIT//IGNORE"),(n=s.convert(t)).slice(0,n.length)}(t,e,r)}catch(n){console.error(n);try{o=s(t,e,r)}catch(e){console.error(e),o=t}}else try{o=s(t,e,r)}catch(e){console.error(e),o=t}"string"==typeof o&&(o=new Buffer(o,"utf-8"));return o}},{"./iconv-loader":48,"iconv-lite":73}],48:[function(t,e,r){"use strict";var n;try{"iconv",n=t("iconv").Iconv}catch(t){}e.exports=n},{}],49:[function(t,e,r){e.exports=u,u.realpath=u,u.sync=f,u.realpathSync=f,u.monkeypatch=function(){n.realpath=u,n.realpathSync=f},u.unmonkeypatch=function(){n.realpath=i,n.realpathSync=s};var n=t("fs"),i=n.realpath,s=n.realpathSync,a=process.version,o=/^v[0-5]\./.test(a),c=t("./old.js");function l(t){return t&&"realpath"===t.syscall&&("ELOOP"===t.code||"ENOMEM"===t.code||"ENAMETOOLONG"===t.code)}function u(t,e,r){if(o)return i(t,e,r);"function"==typeof e&&(r=e,e=null),i(t,e,function(n,i){l(n)?c.realpath(t,e,r):r(n,i)})}function f(t,e){if(o)return s(t,e);try{return s(t,e)}catch(r){if(l(r))return c.realpathSync(t,e);throw r}}},{"./old.js":50,fs:void 0}],50:[function(t,e,r){var n=t("path"),i="win32"===process.platform,s=t("fs"),a=process.env.NODE_DEBUG&&/fs/.test(process.env.NODE_DEBUG);function o(t){return"function"==typeof t?t:function(){var t;if(a){var e=new Error;t=function(t){t&&(e.message=t.message,r(t=e))}}else t=r;return t;function r(t){if(t){if(process.throwDeprecation)throw t;if(!process.noDeprecation){var e="fs: missing callback "+(t.stack||t.message);process.traceDeprecation?console.trace(e):console.error(e)}}}}()}n.normalize;if(i)var c=/(.*?)(?:[\/\\]+|$)/g;else c=/(.*?)(?:[\/]+|$)/g;if(i)var l=/^(?:[a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/][^\\\/]+)?[\\\/]*/;else l=/^[\/]*/;r.realpathSync=function(t,e){if(t=n.resolve(t),e&&Object.prototype.hasOwnProperty.call(e,t))return e[t];var r,a,o,u,f=t,$={},h={};function p(){var e=l.exec(t);r=e[0].length,a=e[0],o=e[0],u="",i&&!h[o]&&(s.lstatSync(o),h[o]=!0)}for(p();r<t.length;){c.lastIndex=r;var d=c.exec(t);if(u=a,a+=d[0],o=u+d[1],r=c.lastIndex,!(h[o]||e&&e[o]===o)){var _;if(e&&Object.prototype.hasOwnProperty.call(e,o))_=e[o];else{var m=s.lstatSync(o);if(!m.isSymbolicLink()){h[o]=!0,e&&(e[o]=o);continue}var y=null;if(!i){var g=m.dev.toString(32)+":"+m.ino.toString(32);$.hasOwnProperty(g)&&(y=$[g])}null===y&&(s.statSync(o),y=s.readlinkSync(o)),_=n.resolve(u,y),e&&(e[o]=_),i||($[g]=y)}t=n.resolve(_,t.slice(r)),p()}}return e&&(e[f]=t),t},r.realpath=function(t,e,r){if("function"!=typeof r&&(r=o(e),e=null),t=n.resolve(t),e&&Object.prototype.hasOwnProperty.call(e,t))return process.nextTick(r.bind(null,null,e[t]));var a,u,f,$,h=t,p={},d={};function _(){var e=l.exec(t);a=e[0].length,u=e[0],f=e[0],$="",i&&!d[f]?s.lstat(f,function(t){if(t)return r(t);d[f]=!0,m()}):process.nextTick(m)}function m(){if(a>=t.length)return e&&(e[h]=t),r(null,t);c.lastIndex=a;var n=c.exec(t);return $=u,u+=n[0],f=$+n[1],a=c.lastIndex,d[f]||e&&e[f]===f?process.nextTick(m):e&&Object.prototype.hasOwnProperty.call(e,f)?v(e[f]):s.lstat(f,y)}function y(t,n){if(t)return r(t);if(!n.isSymbolicLink())return d[f]=!0,e&&(e[f]=f),process.nextTick(m);if(!i){var a=n.dev.toString(32)+":"+n.ino.toString(32);if(p.hasOwnProperty(a))return g(null,p[a],f)}s.stat(f,function(t){if(t)return r(t);s.readlink(f,function(t,e){i||(p[a]=e),g(t,e)})})}function g(t,i,s){if(t)return r(t);var a=n.resolve($,i);e&&(e[s]=a),v(a)}function v(e){t=n.resolve(e,t.slice(a)),_()}_()}},{fs:void 0,path:void 0}],51:[function(t,e,r){function n(t,e){return Object.prototype.hasOwnProperty.call(t,e)}r.alphasort=l,r.alphasorti=c,r.setopts=function(t,e,r){r||(r={});if(r.matchBase&&-1===e.indexOf("/")){if(r.noglobstar)throw new Error("base matching requires globstar");e="**/"+e}t.silent=!!r.silent,t.pattern=e,t.strict=!1!==r.strict,t.realpath=!!r.realpath,t.realpathCache=r.realpathCache||Object.create(null),t.follow=!!r.follow,t.dot=!!r.dot,t.mark=!!r.mark,t.nodir=!!r.nodir,t.nodir&&(t.mark=!0);t.sync=!!r.sync,t.nounique=!!r.nounique,t.nonull=!!r.nonull,t.nosort=!!r.nosort,t.nocase=!!r.nocase,t.stat=!!r.stat,t.noprocess=!!r.noprocess,t.absolute=!!r.absolute,t.maxLength=r.maxLength||1/0,t.cache=r.cache||Object.create(null),t.statCache=r.statCache||Object.create(null),t.symlinks=r.symlinks||Object.create(null),function(t,e){t.ignore=e.ignore||[],Array.isArray(t.ignore)||(t.ignore=[t.ignore]);t.ignore.length&&(t.ignore=t.ignore.map(u))}(t,r),t.changedCwd=!1;var s=process.cwd();n(r,"cwd")?(t.cwd=i.resolve(r.cwd),t.changedCwd=t.cwd!==s):t.cwd=s;t.root=r.root||i.resolve(t.cwd,"/"),t.root=i.resolve(t.root),"win32"===process.platform&&(t.root=t.root.replace(/\\/g,"/"));t.cwdAbs=a(t.cwd)?t.cwd:f(t,t.cwd),"win32"===process.platform&&(t.cwdAbs=t.cwdAbs.replace(/\\/g,"/"));t.nomount=!!r.nomount,r.nonegate=!0,r.nocomment=!0,t.minimatch=new o(e,r),t.options=t.minimatch.options},r.ownProp=n,r.makeAbs=f,r.finish=function(t){for(var e=t.nounique,r=e?[]:Object.create(null),n=0,i=t.matches.length;n<i;n++){var s=t.matches[n];if(s&&0!==Object.keys(s).length){var a=Object.keys(s);e?r.push.apply(r,a):a.forEach(function(t){r[t]=!0})}else if(t.nonull){var o=t.minimatch.globSet[n];e?r.push(o):r[o]=!0}}e||(r=Object.keys(r));t.nosort||(r=r.sort(t.nocase?c:l));if(t.mark){for(var n=0;n<r.length;n++)r[n]=t._mark(r[n]);t.nodir&&(r=r.filter(function(e){var r=!/\/$/.test(e),n=t.cache[e]||t.cache[f(t,e)];return r&&n&&(r="DIR"!==n&&!Array.isArray(n)),r}))}t.ignore.length&&(r=r.filter(function(e){return!$(t,e)}));t.found=r},r.mark=function(t,e){var r=f(t,e),n=t.cache[r],i=e;if(n){var s="DIR"===n||Array.isArray(n),a="/"===e.slice(-1);if(s&&!a?i+="/":!s&&a&&(i=i.slice(0,-1)),i!==e){var o=f(t,i);t.statCache[o]=t.statCache[r],t.cache[o]=t.cache[r]}}return i},r.isIgnored=$,r.childrenIgnored=function(t,e){return!!t.ignore.length&&t.ignore.some(function(t){return!(!t.gmatcher||!t.gmatcher.match(e))})};var i=t("path"),s=t("minimatch"),a=t("path-is-absolute"),o=s.Minimatch;function c(t,e){return t.toLowerCase().localeCompare(e.toLowerCase())}function l(t,e){return t.localeCompare(e)}function u(t){var e=null;if("/**"===t.slice(-3)){var r=t.replace(/(\/\*\*)+$/,"");e=new o(r,{dot:!0})}return{matcher:new o(t,{dot:!0}),gmatcher:e}}function f(t,e){var r=e;return r="/"===e.charAt(0)?i.join(t.root,e):a(e)||""===e?e:t.changedCwd?i.resolve(t.cwd,e):i.resolve(e),"win32"===process.platform&&(r=r.replace(/\\/g,"/")),r}function $(t,e){return!!t.ignore.length&&t.ignore.some(function(t){return t.matcher.match(e)||!(!t.gmatcher||!t.gmatcher.match(e))})}},{minimatch:82,path:void 0,"path-is-absolute":84}],52:[function(t,e,r){e.exports=g;var n=t("fs"),i=t("fs.realpath"),s=t("minimatch"),a=(s.Minimatch,t("inherits")),o=t("events").EventEmitter,c=t("path"),l=t("assert"),u=t("path-is-absolute"),f=t("./sync.js"),$=t("./common.js"),h=($.alphasort,$.alphasorti,$.setopts),p=$.ownProp,d=t("inflight"),_=(t("util"),$.childrenIgnored),m=$.isIgnored,y=t("once");function g(t,e,r){if("function"==typeof e&&(r=e,e={}),e||(e={}),e.sync){if(r)throw new TypeError("callback provided to sync glob");return f(t,e)}return new b(t,e,r)}g.sync=f;var v=g.GlobSync=f.GlobSync;function b(t,e,r){if("function"==typeof e&&(r=e,e=null),e&&e.sync){if(r)throw new TypeError("callback provided to sync glob");return new v(t,e)}if(!(this instanceof b))return new b(t,e,r);h(this,t,e),this._didRealPath=!1;var n=this.minimatch.set.length;this.matches=new Array(n),"function"==typeof r&&(r=y(r),this.on("error",r),this.on("end",function(t){r(null,t)}));var i=this;if(this._processing=0,this._emitQueue=[],this._processQueue=[],this.paused=!1,this.noprocess)return this;if(0===n)return o();for(var s=!0,a=0;a<n;a++)this._process(this.minimatch.set[a],a,!1,o);function o(){--i._processing,i._processing<=0&&(s?process.nextTick(function(){i._finish()}):i._finish())}s=!1}g.glob=g,g.hasMagic=function(t,e){var r=function(t,e){if(null===e||"object"!=typeof e)return t;for(var r=Object.keys(e),n=r.length;n--;)t[r[n]]=e[r[n]];return t}({},e);r.noprocess=!0;var n=new b(t,r).minimatch.set;if(!t)return!1;if(n.length>1)return!0;for(var i=0;i<n[0].length;i++)if("string"!=typeof n[0][i])return!0;return!1},g.Glob=b,a(b,o),b.prototype._finish=function(){if(l(this instanceof b),!this.aborted){if(this.realpath&&!this._didRealpath)return this._realpath();$.finish(this),this.emit("end",this.found)}},b.prototype._realpath=function(){if(!this._didRealpath){this._didRealpath=!0;var t=this.matches.length;if(0===t)return this._finish();for(var e=this,r=0;r<this.matches.length;r++)this._realpathSet(r,n)}function n(){0==--t&&e._finish()}},b.prototype._realpathSet=function(t,e){var r=this.matches[t];if(!r)return e();var n=Object.keys(r),s=this,a=n.length;if(0===a)return e();var o=this.matches[t]=Object.create(null);n.forEach(function(r,n){r=s._makeAbs(r),i.realpath(r,s.realpathCache,function(n,i){n?"stat"===n.syscall?o[r]=!0:s.emit("error",n):o[i]=!0,0==--a&&(s.matches[t]=o,e())})})},b.prototype._mark=function(t){return $.mark(this,t)},b.prototype._makeAbs=function(t){return $.makeAbs(this,t)},b.prototype.abort=function(){this.aborted=!0,this.emit("abort")},b.prototype.pause=function(){this.paused||(this.paused=!0,this.emit("pause"))},b.prototype.resume=function(){if(this.paused){if(this.emit("resume"),this.paused=!1,this._emitQueue.length){var t=this._emitQueue.slice(0);this._emitQueue.length=0;for(var e=0;e<t.length;e++){var r=t[e];this._emitMatch(r[0],r[1])}}if(this._processQueue.length){var n=this._processQueue.slice(0);this._processQueue.length=0;for(e=0;e<n.length;e++){var i=n[e];this._processing--,this._process(i[0],i[1],i[2],i[3])}}}},b.prototype._process=function(t,e,r,n){if(l(this instanceof b),l("function"==typeof n),!this.aborted)if(this._processing++,this.paused)this._processQueue.push([t,e,r,n]);else{for(var i,a=0;"string"==typeof t[a];)a++;switch(a){case t.length:return void this._processSimple(t.join("/"),e,n);case 0:i=null;break;default:i=t.slice(0,a).join("/")}var o,c=t.slice(a);null===i?o=".":u(i)||u(t.join("/"))?(i&&u(i)||(i="/"+i),o=i):o=i;var f=this._makeAbs(o);if(_(this,o))return n();c[0]===s.GLOBSTAR?this._processGlobStar(i,o,f,c,e,r,n):this._processReaddir(i,o,f,c,e,r,n)}},b.prototype._processReaddir=function(t,e,r,n,i,s,a){var o=this;this._readdir(r,s,function(c,l){return o._processReaddir2(t,e,r,n,i,s,l,a)})},b.prototype._processReaddir2=function(t,e,r,n,i,s,a,o){if(!a)return o();for(var l=n[0],u=!!this.minimatch.negate,f=l._glob,$=this.dot||"."===f.charAt(0),h=[],p=0;p<a.length;p++){if("."!==(_=a[p]).charAt(0)||$)(u&&!t?!_.match(l):_.match(l))&&h.push(_)}var d=h.length;if(0===d)return o();if(1===n.length&&!this.mark&&!this.stat){this.matches[i]||(this.matches[i]=Object.create(null));for(p=0;p<d;p++){var _=h[p];t&&(_="/"!==t?t+"/"+_:t+_),"/"!==_.charAt(0)||this.nomount||(_=c.join(this.root,_)),this._emitMatch(i,_)}return o()}n.shift();for(p=0;p<d;p++){_=h[p];t&&(_="/"!==t?t+"/"+_:t+_),this._process([_].concat(n),i,s,o)}o()},b.prototype._emitMatch=function(t,e){if(!this.aborted&&!m(this,e))if(this.paused)this._emitQueue.push([t,e]);else{var r=u(e)?e:this._makeAbs(e);if(this.mark&&(e=this._mark(e)),this.absolute&&(e=r),!this.matches[t][e]){if(this.nodir){var n=this.cache[r];if("DIR"===n||Array.isArray(n))return}this.matches[t][e]=!0;var i=this.statCache[r];i&&this.emit("stat",e,i),this.emit("match",e)}}},b.prototype._readdirInGlobStar=function(t,e){if(!this.aborted){if(this.follow)return this._readdir(t,!1,e);var r=this,i=d("lstat\0"+t,function(n,i){if(n&&"ENOENT"===n.code)return e();var s=i&&i.isSymbolicLink();r.symlinks[t]=s,s||!i||i.isDirectory()?r._readdir(t,!1,e):(r.cache[t]="FILE",e())});i&&n.lstat(t,i)}},b.prototype._readdir=function(t,e,r){if(!this.aborted&&(r=d("readdir\0"+t+"\0"+e,r))){if(e&&!p(this.symlinks,t))return this._readdirInGlobStar(t,r);if(p(this.cache,t)){var i=this.cache[t];if(!i||"FILE"===i)return r();if(Array.isArray(i))return r(null,i)}n.readdir(t,function(t,e,r){return function(n,i){n?t._readdirError(e,n,r):t._readdirEntries(e,i,r)}}(this,t,r))}},b.prototype._readdirEntries=function(t,e,r){if(!this.aborted){if(!this.mark&&!this.stat)for(var n=0;n<e.length;n++){var i=e[n];i="/"===t?t+i:t+"/"+i,this.cache[i]=!0}return this.cache[t]=e,r(null,e)}},b.prototype._readdirError=function(t,e,r){if(!this.aborted){switch(e.code){case"ENOTSUP":case"ENOTDIR":var n=this._makeAbs(t);if(this.cache[n]="FILE",n===this.cwdAbs){var i=new Error(e.code+" invalid cwd "+this.cwd);i.path=this.cwd,i.code=e.code,this.emit("error",i),this.abort()}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(t)]=!1;break;default:this.cache[this._makeAbs(t)]=!1,this.strict&&(this.emit("error",e),this.abort()),this.silent||console.error("glob error",e)}return r()}},b.prototype._processGlobStar=function(t,e,r,n,i,s,a){var o=this;this._readdir(r,s,function(c,l){o._processGlobStar2(t,e,r,n,i,s,l,a)})},b.prototype._processGlobStar2=function(t,e,r,n,i,s,a,o){if(!a)return o();var c=n.slice(1),l=t?[t]:[],u=l.concat(c);this._process(u,i,!1,o);var f=this.symlinks[r],$=a.length;if(f&&s)return o();for(var h=0;h<$;h++){if("."!==a[h].charAt(0)||this.dot){var p=l.concat(a[h],c);this._process(p,i,!0,o);var d=l.concat(a[h],n);this._process(d,i,!0,o)}}o()},b.prototype._processSimple=function(t,e,r){var n=this;this._stat(t,function(i,s){n._processSimple2(t,e,i,s,r)})},b.prototype._processSimple2=function(t,e,r,n,i){if(this.matches[e]||(this.matches[e]=Object.create(null)),!n)return i();if(t&&u(t)&&!this.nomount){var s=/[\/\\]$/.test(t);"/"===t.charAt(0)?t=c.join(this.root,t):(t=c.resolve(this.root,t),s&&(t+="/"))}"win32"===process.platform&&(t=t.replace(/\\/g,"/")),this._emitMatch(e,t),i()},b.prototype._stat=function(t,e){var r=this._makeAbs(t),i="/"===t.slice(-1);if(t.length>this.maxLength)return e();if(!this.stat&&p(this.cache,r)){var s=this.cache[r];if(Array.isArray(s)&&(s="DIR"),!i||"DIR"===s)return e(null,s);if(i&&"FILE"===s)return e()}var a=this.statCache[r];if(void 0!==a){if(!1===a)return e(null,a);var o=a.isDirectory()?"DIR":"FILE";return i&&"FILE"===o?e():e(null,o,a)}var c=this,l=d("stat\0"+r,function(i,s){if(s&&s.isSymbolicLink())return n.stat(r,function(n,i){n?c._stat2(t,r,null,s,e):c._stat2(t,r,n,i,e)});c._stat2(t,r,i,s,e)});l&&n.lstat(r,l)},b.prototype._stat2=function(t,e,r,n,i){if(r&&("ENOENT"===r.code||"ENOTDIR"===r.code))return this.statCache[e]=!1,i();var s="/"===t.slice(-1);if(this.statCache[e]=n,"/"===e.slice(-1)&&n&&!n.isDirectory())return i(null,!1,n);var a=!0;return n&&(a=n.isDirectory()?"DIR":"FILE"),this.cache[e]=this.cache[e]||a,s&&"FILE"===a?i():i(null,a,n)}},{"./common.js":51,"./sync.js":53,assert:void 0,events:void 0,fs:void 0,"fs.realpath":49,inflight:75,inherits:76,minimatch:82,once:83,path:void 0,"path-is-absolute":84,util:void 0}],53:[function(t,e,r){e.exports=p,p.GlobSync=d;var n=t("fs"),i=t("fs.realpath"),s=t("minimatch"),a=(s.Minimatch,t("./glob.js").Glob,t("util"),t("path")),o=t("assert"),c=t("path-is-absolute"),l=t("./common.js"),u=(l.alphasort,l.alphasorti,l.setopts),f=l.ownProp,$=l.childrenIgnored,h=l.isIgnored;function p(t,e){if("function"==typeof e||3===arguments.length)throw new TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");return new d(t,e).found}function d(t,e){if(!t)throw new Error("must provide pattern");if("function"==typeof e||3===arguments.length)throw new TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");if(!(this instanceof d))return new d(t,e);if(u(this,t,e),this.noprocess)return this;var r=this.minimatch.set.length;this.matches=new Array(r);for(var n=0;n<r;n++)this._process(this.minimatch.set[n],n,!1);this._finish()}d.prototype._finish=function(){if(o(this instanceof d),this.realpath){var t=this;this.matches.forEach(function(e,r){var n=t.matches[r]=Object.create(null);for(var s in e)try{s=t._makeAbs(s),n[i.realpathSync(s,t.realpathCache)]=!0}catch(e){if("stat"!==e.syscall)throw e;n[t._makeAbs(s)]=!0}})}l.finish(this)},d.prototype._process=function(t,e,r){o(this instanceof d);for(var n,i=0;"string"==typeof t[i];)i++;switch(i){case t.length:return void this._processSimple(t.join("/"),e);case 0:n=null;break;default:n=t.slice(0,i).join("/")}var a,l=t.slice(i);null===n?a=".":c(n)||c(t.join("/"))?(n&&c(n)||(n="/"+n),a=n):a=n;var u=this._makeAbs(a);$(this,a)||(l[0]===s.GLOBSTAR?this._processGlobStar(n,a,u,l,e,r):this._processReaddir(n,a,u,l,e,r))},d.prototype._processReaddir=function(t,e,r,n,i,s){var o=this._readdir(r,s);if(o){for(var c=n[0],l=!!this.minimatch.negate,u=c._glob,f=this.dot||"."===u.charAt(0),$=[],h=0;h<o.length;h++){if("."!==(_=o[h]).charAt(0)||f)(l&&!t?!_.match(c):_.match(c))&&$.push(_)}var p=$.length;if(0!==p)if(1!==n.length||this.mark||this.stat){n.shift();for(h=0;h<p;h++){var d;_=$[h];d=t?[t,_]:[_],this._process(d.concat(n),i,s)}}else{this.matches[i]||(this.matches[i]=Object.create(null));for(var h=0;h<p;h++){var _=$[h];t&&(_="/"!==t.slice(-1)?t+"/"+_:t+_),"/"!==_.charAt(0)||this.nomount||(_=a.join(this.root,_)),this._emitMatch(i,_)}}}},d.prototype._emitMatch=function(t,e){if(!h(this,e)){var r=this._makeAbs(e);if(this.mark&&(e=this._mark(e)),this.absolute&&(e=r),!this.matches[t][e]){if(this.nodir){var n=this.cache[r];if("DIR"===n||Array.isArray(n))return}this.matches[t][e]=!0,this.stat&&this._stat(e)}}},d.prototype._readdirInGlobStar=function(t){if(this.follow)return this._readdir(t,!1);var e,r;try{r=n.lstatSync(t)}catch(t){if("ENOENT"===t.code)return null}var i=r&&r.isSymbolicLink();return this.symlinks[t]=i,i||!r||r.isDirectory()?e=this._readdir(t,!1):this.cache[t]="FILE",e},d.prototype._readdir=function(t,e){if(e&&!f(this.symlinks,t))return this._readdirInGlobStar(t);if(f(this.cache,t)){var r=this.cache[t];if(!r||"FILE"===r)return null;if(Array.isArray(r))return r}try{return this._readdirEntries(t,n.readdirSync(t))}catch(e){return this._readdirError(t,e),null}},d.prototype._readdirEntries=function(t,e){if(!this.mark&&!this.stat)for(var r=0;r<e.length;r++){var n=e[r];n="/"===t?t+n:t+"/"+n,this.cache[n]=!0}return this.cache[t]=e,e},d.prototype._readdirError=function(t,e){switch(e.code){case"ENOTSUP":case"ENOTDIR":var r=this._makeAbs(t);if(this.cache[r]="FILE",r===this.cwdAbs){var n=new Error(e.code+" invalid cwd "+this.cwd);throw n.path=this.cwd,n.code=e.code,n}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(t)]=!1;break;default:if(this.cache[this._makeAbs(t)]=!1,this.strict)throw e;this.silent||console.error("glob error",e)}},d.prototype._processGlobStar=function(t,e,r,n,i,s){var a=this._readdir(r,s);if(a){var o=n.slice(1),c=t?[t]:[],l=c.concat(o);this._process(l,i,!1);var u=a.length;if(!this.symlinks[r]||!s)for(var f=0;f<u;f++){if("."!==a[f].charAt(0)||this.dot){var $=c.concat(a[f],o);this._process($,i,!0);var h=c.concat(a[f],n);this._process(h,i,!0)}}}},d.prototype._processSimple=function(t,e){var r=this._stat(t);if(this.matches[e]||(this.matches[e]=Object.create(null)),r){if(t&&c(t)&&!this.nomount){var n=/[\/\\]$/.test(t);"/"===t.charAt(0)?t=a.join(this.root,t):(t=a.resolve(this.root,t),n&&(t+="/"))}"win32"===process.platform&&(t=t.replace(/\\/g,"/")),this._emitMatch(e,t)}},d.prototype._stat=function(t){var e=this._makeAbs(t),r="/"===t.slice(-1);if(t.length>this.maxLength)return!1;if(!this.stat&&f(this.cache,e)){var i=this.cache[e];if(Array.isArray(i)&&(i="DIR"),!r||"DIR"===i)return i;if(r&&"FILE"===i)return!1}var s=this.statCache[e];if(!s){var a;try{a=n.lstatSync(e)}catch(t){if(t&&("ENOENT"===t.code||"ENOTDIR"===t.code))return this.statCache[e]=!1,!1}if(a&&a.isSymbolicLink())try{s=n.statSync(e)}catch(t){s=a}else s=a}this.statCache[e]=s;i=!0;return s&&(i=s.isDirectory()?"DIR":"FILE"),this.cache[e]=this.cache[e]||i,(!r||"FILE"!==i)&&i},d.prototype._mark=function(t){return l.mark(this,t)},d.prototype._makeAbs=function(t){return l.makeAbs(this,t)}},{"./common.js":51,"./glob.js":52,assert:void 0,fs:void 0,"fs.realpath":49,minimatch:82,path:void 0,"path-is-absolute":84,util:void 0}],54:[function(t,e,r){"use strict";var n=t("buffer").Buffer;r._dbcs=l;for(var i=-1,s=-2,a=-1e3,o=new Array(256),c=0;c<256;c++)o[c]=i;function l(t,e){if(this.encodingName=t.encodingName,!t)throw new Error("DBCS codec is called without the data.");if(!t.table)throw new Error("Encoding '"+this.encodingName+"' has no data.");var r=t.table();this.decodeTables=[],this.decodeTables[0]=o.slice(0),this.decodeTableSeq=[];for(var n=0;n<r.length;n++)this._addDecodeChunk(r[n]);this.defaultCharUnicode=e.defaultCharUnicode,this.encodeTable=[],this.encodeTableSeq=[];var c={};if(t.encodeSkipVals)for(n=0;n<t.encodeSkipVals.length;n++){var l=t.encodeSkipVals[n];if("number"==typeof l)c[l]=!0;else for(var u=l.from;u<=l.to;u++)c[u]=!0}if(this._fillEncodeTable(0,0,c),t.encodeAdd)for(var f in t.encodeAdd)Object.prototype.hasOwnProperty.call(t.encodeAdd,f)&&this._setEncodeChar(f.charCodeAt(0),t.encodeAdd[f]);if(this.defCharSB=this.encodeTable[0][e.defaultCharSingleByte.charCodeAt(0)],this.defCharSB===i&&(this.defCharSB=this.encodeTable[0]["?"]),this.defCharSB===i&&(this.defCharSB="?".charCodeAt(0)),"function"==typeof t.gb18030){this.gb18030=t.gb18030();var $=this.decodeTables.length,h=this.decodeTables[$]=o.slice(0),p=this.decodeTables.length,d=this.decodeTables[p]=o.slice(0);for(n=129;n<=254;n++){var _=a-this.decodeTables[0][n],m=this.decodeTables[_];for(u=48;u<=57;u++)m[u]=a-$}for(n=129;n<=254;n++)h[n]=a-p;for(n=48;n<=57;n++)d[n]=s}}function u(t,e){this.leadSurrogate=-1,this.seqObj=void 0,this.encodeTable=e.encodeTable,this.encodeTableSeq=e.encodeTableSeq,this.defaultCharSingleByte=e.defCharSB,this.gb18030=e.gb18030}function f(t,e){this.nodeIdx=0,this.prevBuf=new n(0),this.decodeTables=e.decodeTables,this.decodeTableSeq=e.decodeTableSeq,this.defaultCharUnicode=e.defaultCharUnicode,this.gb18030=e.gb18030}function $(t,e){if(t[0]>e)return-1;for(var r=0,n=t.length;r<n-1;){var i=r+Math.floor((n-r+1)/2);t[i]<=e?r=i:n=i}return r}l.prototype.encoder=u,l.prototype.decoder=f,l.prototype._getDecodeTrieNode=function(t){for(var e=[];t>0;t>>=8)e.push(255&t);0==e.length&&e.push(0);for(var r=this.decodeTables[0],n=e.length-1;n>0;n--){var s=r[e[n]];if(s==i)r[e[n]]=a-this.decodeTables.length,this.decodeTables.push(r=o.slice(0));else{if(!(s<=a))throw new Error("Overwrite byte in "+this.encodingName+", addr: "+t.toString(16));r=this.decodeTables[a-s]}}return r},l.prototype._addDecodeChunk=function(t){var e=parseInt(t[0],16),r=this._getDecodeTrieNode(e);e&=255;for(var n=1;n<t.length;n++){var i=t[n];if("string"==typeof i)for(var s=0;s<i.length;){var a=i.charCodeAt(s++);if(55296<=a&&a<56320){var o=i.charCodeAt(s++);if(!(56320<=o&&o<57344))throw new Error("Incorrect surrogate pair in "+this.encodingName+" at chunk "+t[0]);r[e++]=65536+1024*(a-55296)+(o-56320)}else if(4080<a&&a<=4095){for(var c=4095-a+2,l=[],u=0;u<c;u++)l.push(i.charCodeAt(s++));r[e++]=-10-this.decodeTableSeq.length,this.decodeTableSeq.push(l)}else r[e++]=a}else{if("number"!=typeof i)throw new Error("Incorrect type '"+typeof i+"' given in "+this.encodingName+" at chunk "+t[0]);var f=r[e-1]+1;for(s=0;s<i;s++)r[e++]=f++}}if(e>255)throw new Error("Incorrect chunk in "+this.encodingName+" at addr "+t[0]+": too long"+e)},l.prototype._getEncodeBucket=function(t){var e=t>>8;return void 0===this.encodeTable[e]&&(this.encodeTable[e]=o.slice(0)),this.encodeTable[e]},l.prototype._setEncodeChar=function(t,e){var r=this._getEncodeBucket(t),n=255&t;r[n]<=-10?this.encodeTableSeq[-10-r[n]][-1]=e:r[n]==i&&(r[n]=e)},l.prototype._setEncodeSequence=function(t,e){var r,n=t[0],s=this._getEncodeBucket(n),a=255&n;s[a]<=-10?r=this.encodeTableSeq[-10-s[a]]:(r={},s[a]!==i&&(r[-1]=s[a]),s[a]=-10-this.encodeTableSeq.length,this.encodeTableSeq.push(r));for(var o=1;o<t.length-1;o++){var c=r[n];"object"==typeof c?r=c:(r=r[n]={},void 0!==c&&(r[-1]=c))}r[n=t[t.length-1]]=e},l.prototype._fillEncodeTable=function(t,e,r){for(var n=this.decodeTables[t],i=0;i<256;i++){var s=n[i],o=e+i;r[o]||(s>=0?this._setEncodeChar(s,o):s<=a?this._fillEncodeTable(a-s,o<<8,r):s<=-10&&this._setEncodeSequence(this.decodeTableSeq[-10-s],o))}},u.prototype.write=function(t){for(var e=new n(t.length*(this.gb18030?4:3)),r=this.leadSurrogate,s=this.seqObj,a=-1,o=0,c=0;;){if(-1===a){if(o==t.length)break;var l=t.charCodeAt(o++)}else{l=a;a=-1}if(55296<=l&&l<57344)if(l<56320){if(-1===r){r=l;continue}r=l,l=i}else-1!==r?(l=65536+1024*(r-55296)+(l-56320),r=-1):l=i;else-1!==r&&(a=l,l=i,r=-1);var u=i;if(void 0!==s&&l!=i){var f=s[l];if("object"==typeof f){s=f;continue}"number"==typeof f?u=f:null==f&&void 0!==(f=s[-1])&&(u=f,a=l),s=void 0}else if(l>=0){var h=this.encodeTable[l>>8];if(void 0!==h&&(u=h[255&l]),u<=-10){s=this.encodeTableSeq[-10-u];continue}if(u==i&&this.gb18030){var p=$(this.gb18030.uChars,l);if(-1!=p){u=this.gb18030.gbChars[p]+(l-this.gb18030.uChars[p]);e[c++]=129+Math.floor(u/12600),u%=12600,e[c++]=48+Math.floor(u/1260),u%=1260,e[c++]=129+Math.floor(u/10),u%=10,e[c++]=48+u;continue}}}u===i&&(u=this.defaultCharSingleByte),u<256?e[c++]=u:u<65536?(e[c++]=u>>8,e[c++]=255&u):(e[c++]=u>>16,e[c++]=u>>8&255,e[c++]=255&u)}return this.seqObj=s,this.leadSurrogate=r,e.slice(0,c)},u.prototype.end=function(){if(-1!==this.leadSurrogate||void 0!==this.seqObj){var t=new n(10),e=0;if(this.seqObj){var r=this.seqObj[-1];void 0!==r&&(r<256?t[e++]=r:(t[e++]=r>>8,t[e++]=255&r)),this.seqObj=void 0}return-1!==this.leadSurrogate&&(t[e++]=this.defaultCharSingleByte,this.leadSurrogate=-1),t.slice(0,e)}},u.prototype.findIdx=$,f.prototype.write=function(t){var e=new n(2*t.length),r=this.nodeIdx,o=this.prevBuf,c=this.prevBuf.length,l=-this.prevBuf.length;c>0&&(o=n.concat([o,t.slice(0,10)]));for(var u=0,f=0;u<t.length;u++){var h,p=u>=0?t[u]:o[u+c];if((h=this.decodeTables[r][p])>=0);else if(h===i)u=l,h=this.defaultCharUnicode.charCodeAt(0);else if(h===s){var d=l>=0?t.slice(l,u+1):o.slice(l+c,u+1+c),_=12600*(d[0]-129)+1260*(d[1]-48)+10*(d[2]-129)+(d[3]-48),m=$(this.gb18030.gbChars,_);h=this.gb18030.uChars[m]+_-this.gb18030.gbChars[m]}else{if(h<=a){r=a-h;continue}if(!(h<=-10))throw new Error("iconv-lite internal error: invalid decoding table value "+h+" at "+r+"/"+p);for(var y=this.decodeTableSeq[-10-h],g=0;g<y.length-1;g++)h=y[g],e[f++]=255&h,e[f++]=h>>8;h=y[y.length-1]}if(h>65535){h-=65536;var v=55296+Math.floor(h/1024);e[f++]=255&v,e[f++]=v>>8,h=56320+h%1024}e[f++]=255&h,e[f++]=h>>8,r=0,l=u+1}return this.nodeIdx=r,this.prevBuf=l>=0?t.slice(l):o.slice(l+c),e.slice(0,f).toString("ucs2")},f.prototype.end=function(){for(var t="";this.prevBuf.length>0;){t+=this.defaultCharUnicode;var e=this.prevBuf.slice(1);this.prevBuf=new n(0),this.nodeIdx=0,e.length>0&&(t+=this.write(e))}return this.nodeIdx=0,t}},{buffer:void 0}],55:[function(t,e,r){"use strict";e.exports={shiftjis:{type:"_dbcs",table:function(){return t("./tables/shiftjis.json")},encodeAdd:{"":92,"":126},encodeSkipVals:[{from:60736,to:63808}]},csshiftjis:"shiftjis",mskanji:"shiftjis",sjis:"shiftjis",windows31j:"shiftjis",ms31j:"shiftjis",xsjis:"shiftjis",windows932:"shiftjis",ms932:"shiftjis",932:"shiftjis",cp932:"shiftjis",eucjp:{type:"_dbcs",table:function(){return t("./tables/eucjp.json")},encodeAdd:{"":92,"":126}},gb2312:"cp936",gb231280:"cp936",gb23121980:"cp936",csgb2312:"cp936",csiso58gb231280:"cp936",euccn:"cp936",windows936:"cp936",ms936:"cp936",936:"cp936",cp936:{type:"_dbcs",table:function(){return t("./tables/cp936.json")}},gbk:{type:"_dbcs",table:function(){return t("./tables/cp936.json").concat(t("./tables/gbk-added.json"))}},xgbk:"gbk",isoir58:"gbk",gb18030:{type:"_dbcs",table:function(){return t("./tables/cp936.json").concat(t("./tables/gbk-added.json"))},gb18030:function(){return t("./tables/gb18030-ranges.json")},encodeSkipVals:[128],encodeAdd:{"":41699}},chinese:"gb18030",windows949:"cp949",ms949:"cp949",949:"cp949",cp949:{type:"_dbcs",table:function(){return t("./tables/cp949.json")}},cseuckr:"cp949",csksc56011987:"cp949",euckr:"cp949",isoir149:"cp949",korean:"cp949",ksc56011987:"cp949",ksc56011989:"cp949",ksc5601:"cp949",windows950:"cp950",ms950:"cp950",950:"cp950",cp950:{type:"_dbcs",table:function(){return t("./tables/cp950.json")}},big5:"big5hkscs",big5hkscs:{type:"_dbcs",table:function(){return t("./tables/cp950.json").concat(t("./tables/big5-added.json"))},encodeSkipVals:[41676]},cnbig5:"big5hkscs",csbig5:"big5hkscs",xxbig5:"big5hkscs"}},{"./tables/big5-added.json":61,"./tables/cp936.json":62,"./tables/cp949.json":63,"./tables/cp950.json":64,"./tables/eucjp.json":65,"./tables/gb18030-ranges.json":66,"./tables/gbk-added.json":67,"./tables/shiftjis.json":68}],56:[function(t,e,r){"use strict";for(var n=[t("./internal"),t("./utf16"),t("./utf7"),t("./sbcs-codec"),t("./sbcs-data"),t("./sbcs-data-generated"),t("./dbcs-codec"),t("./dbcs-data")],i=0;i<n.length;i++){e=n[i];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(r[s]=e[s])}},{"./dbcs-codec":54,"./dbcs-data":55,"./internal":57,"./sbcs-codec":58,"./sbcs-data":60,"./sbcs-data-generated":59,"./utf16":69,"./utf7":70}],57:[function(t,e,r){"use strict";var n=t("buffer").Buffer;function i(t,e){this.enc=t.encodingName,this.bomAware=t.bomAware,"base64"===this.enc?this.encoder=c:"cesu8"===this.enc&&(this.enc="utf8",this.encoder=l,""!==new n("eda0bdedb2a9","hex").toString()&&(this.decoder=u,this.defaultCharUnicode=e.defaultCharUnicode))}e.exports={utf8:{type:"_internal",bomAware:!0},cesu8:{type:"_internal",bomAware:!0},unicode11utf8:"utf8",ucs2:{type:"_internal",bomAware:!0},utf16le:"ucs2",binary:{type:"_internal"},base64:{type:"_internal"},hex:{type:"_internal"},_internal:i},i.prototype.encoder=o,i.prototype.decoder=a;var s=t("string_decoder").StringDecoder;function a(t,e){s.call(this,e.enc)}function o(t,e){this.enc=e.enc}function c(t,e){this.prevStr=""}function l(t,e){}function u(t,e){this.acc=0,this.contBytes=0,this.accBytes=0,this.defaultCharUnicode=e.defaultCharUnicode}s.prototype.end||(s.prototype.end=function(){}),a.prototype=s.prototype,o.prototype.write=function(t){return new n(t,this.enc)},o.prototype.end=function(){},c.prototype.write=function(t){var e=(t=this.prevStr+t).length-t.length%4;return this.prevStr=t.slice(e),t=t.slice(0,e),new n(t,"base64")},c.prototype.end=function(){return new n(this.prevStr,"base64")},l.prototype.write=function(t){for(var e=new n(3*t.length),r=0,i=0;i<t.length;i++){var s=t.charCodeAt(i);s<128?e[r++]=s:s<2048?(e[r++]=192+(s>>>6),e[r++]=128+(63&s)):(e[r++]=224+(s>>>12),e[r++]=128+(s>>>6&63),e[r++]=128+(63&s))}return e.slice(0,r)},l.prototype.end=function(){},u.prototype.write=function(t){for(var e=this.acc,r=this.contBytes,n=this.accBytes,i="",s=0;s<t.length;s++){var a=t[s];128!=(192&a)?(r>0&&(i+=this.defaultCharUnicode,r=0),a<128?i+=String.fromCharCode(a):a<224?(e=31&a,r=1,n=1):a<240?(e=15&a,r=2,n=1):i+=this.defaultCharUnicode):r>0?(e=e<<6|63&a,n++,0===--r&&(i+=2===n&&e<128&&e>0?this.defaultCharUnicode:3===n&&e<2048?this.defaultCharUnicode:String.fromCharCode(e))):i+=this.defaultCharUnicode}return this.acc=e,this.contBytes=r,this.accBytes=n,i},u.prototype.end=function(){var t=0;return this.contBytes>0&&(t+=this.defaultCharUnicode),t}},{buffer:void 0,string_decoder:void 0}],58:[function(t,e,r){"use strict";var n=t("buffer").Buffer;function i(t,e){if(!t)throw new Error("SBCS codec is called without the data.");if(!t.chars||128!==t.chars.length&&256!==t.chars.length)throw new Error("Encoding '"+t.type+"' has incorrect 'chars' (must be of len 128 or 256)");if(128===t.chars.length){for(var r="",i=0;i<128;i++)r+=String.fromCharCode(i);t.chars=r+t.chars}this.decodeBuf=new n(t.chars,"ucs2");var s=new n(65536);s.fill(e.defaultCharSingleByte.charCodeAt(0));for(i=0;i<t.chars.length;i++)s[t.chars.charCodeAt(i)]=i;this.encodeBuf=s}function s(t,e){this.encodeBuf=e.encodeBuf}function a(t,e){this.decodeBuf=e.decodeBuf}r._sbcs=i,i.prototype.encoder=s,i.prototype.decoder=a,s.prototype.write=function(t){for(var e=new n(t.length),r=0;r<t.length;r++)e[r]=this.encodeBuf[t.charCodeAt(r)];return e},s.prototype.end=function(){},a.prototype.write=function(t){for(var e=this.decodeBuf,r=new n(2*t.length),i=0,s=0,a=0;a<t.length;a++)i=2*t[a],r[s=2*a]=e[i],r[s+1]=e[i+1];return r.toString("ucs2")},a.prototype.end=function(){}},{buffer:void 0}],59:[function(t,e,r){"use strict";e.exports={437:"cp437",737:"cp737",775:"cp775",850:"cp850",852:"cp852",855:"cp855",856:"cp856",857:"cp857",858:"cp858",860:"cp860",861:"cp861",862:"cp862",863:"cp863",864:"cp864",865:"cp865",866:"cp866",869:"cp869",874:"windows874",922:"cp922",1046:"cp1046",1124:"cp1124",1125:"cp1125",1129:"cp1129",1133:"cp1133",1161:"cp1161",1162:"cp1162",1163:"cp1163",1250:"windows1250",1251:"windows1251",1252:"windows1252",1253:"windows1253",1254:"windows1254",1255:"windows1255",1256:"windows1256",1257:"windows1257",1258:"windows1258",28591:"iso88591",28592:"iso88592",28593:"iso88593",28594:"iso88594",28595:"iso88595",28596:"iso88596",28597:"iso88597",28598:"iso88598",28599:"iso88599",28600:"iso885910",28601:"iso885911",28603:"iso885913",28604:"iso885914",28605:"iso885915",28606:"iso885916",windows874:{type:"_sbcs",chars:""},win874:"windows874",cp874:"windows874",windows1250:{type:"_sbcs",chars:""},win1250:"windows1250",cp1250:"windows1250",windows1251:{type:"_sbcs",chars:""},win1251:"windows1251",cp1251:"windows1251",windows1252:{type:"_sbcs",chars:""},win1252:"windows1252",cp1252:"windows1252",windows1253:{type:"_sbcs",chars:""},win1253:"windows1253",cp1253:"windows1253",windows1254:{type:"_sbcs",chars:""},win1254:"windows1254",cp1254:"windows1254",windows1255:{type:"_sbcs",chars:""},win1255:"windows1255",cp1255:"windows1255",windows1256:{type:"_sbcs",chars:""},win1256:"windows1256",cp1256:"windows1256",windows1257:{type:"_sbcs",chars:""},win1257:"windows1257",cp1257:"windows1257",windows1258:{type:"_sbcs",chars:""},win1258:"windows1258",cp1258:"windows1258",iso88591:{type:"_sbcs",chars:""},cp28591:"iso88591",iso88592:{type:"_sbcs",chars:""},cp28592:"iso88592",iso88593:{type:"_sbcs",chars:""},cp28593:"iso88593",iso88594:{type:"_sbcs",chars:""},cp28594:"iso88594",iso88595:{type:"_sbcs",chars:""},cp28595:"iso88595",iso88596:{type:"_sbcs",chars:""},cp28596:"iso88596",iso88597:{type:"_sbcs",chars:""},cp28597:"iso88597",iso88598:{type:"_sbcs",chars:""},cp28598:"iso88598",iso88599:{type:"_sbcs",chars:""},cp28599:"iso88599",iso885910:{type:"_sbcs",chars:""},cp28600:"iso885910",iso885911:{type:"_sbcs",chars:""},cp28601:"iso885911",iso885913:{type:"_sbcs",chars:""},cp28603:"iso885913",iso885914:{type:"_sbcs",chars:""},cp28604:"iso885914",iso885915:{type:"_sbcs",chars:""},cp28605:"iso885915",iso885916:{type:"_sbcs",chars:""},cp28606:"iso885916",cp437:{type:"_sbcs",chars:""},ibm437:"cp437",csibm437:"cp437",cp737:{type:"_sbcs",chars:""},ibm737:"cp737",csibm737:"cp737",cp775:{type:"_sbcs",chars:""},ibm775:"cp775",csibm775:"cp775",cp850:{type:"_sbcs",chars:""},ibm850:"cp850",csibm850:"cp850",cp852:{type:"_sbcs",chars:""},ibm852:"cp852",csibm852:"cp852",cp855:{type:"_sbcs",chars:""},ibm855:"cp855",csibm855:"cp855",cp856:{type:"_sbcs",chars:""},ibm856:"cp856",csibm856:"cp856",cp857:{type:"_sbcs",chars:""},ibm857:"cp857",csibm857:"cp857",cp858:{type:"_sbcs",chars:""},ibm858:"cp858",csibm858:"cp858",cp860:{type:"_sbcs",chars:""},ibm860:"cp860",csibm860:"cp860",cp861:{type:"_sbcs",chars:""},ibm861:"cp861",csibm861:"cp861",cp862:{type:"_sbcs",chars:""},ibm862:"cp862",csibm862:"cp862",cp863:{type:"_sbcs",chars:""},ibm863:"cp863",csibm863:"cp863",cp864:{type:"_sbcs",chars:"\0\b\t\n\v\f\r !\"#$&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~"},ibm864:"cp864",csibm864:"cp864",cp865:{type:"_sbcs",chars:""},ibm865:"cp865",csibm865:"cp865",cp866:{type:"_sbcs",chars:""},ibm866:"cp866",csibm866:"cp866",cp869:{type:"_sbcs",chars:""},ibm869:"cp869",csibm869:"cp869",cp922:{type:"_sbcs",chars:""},ibm922:"cp922",csibm922:"cp922",cp1046:{type:"_sbcs",chars:""},ibm1046:"cp1046",csibm1046:"cp1046",cp1124:{type:"_sbcs",chars:""},ibm1124:"cp1124",csibm1124:"cp1124",cp1125:{type:"_sbcs",chars:""},ibm1125:"cp1125",csibm1125:"cp1125",cp1129:{type:"_sbcs",chars:""},ibm1129:"cp1129",csibm1129:"cp1129",cp1133:{type:"_sbcs",chars:""},ibm1133:"cp1133",csibm1133:"cp1133",cp1161:{type:"_sbcs",chars:""},ibm1161:"cp1161",csibm1161:"cp1161",cp1162:{type:"_sbcs",chars:""},ibm1162:"cp1162",csibm1162:"cp1162",cp1163:{type:"_sbcs",chars:""},ibm1163:"cp1163",csibm1163:"cp1163",maccroatian:{type:"_sbcs",chars:""},maccyrillic:{type:"_sbcs",chars:""},macgreek:{type:"_sbcs",chars:""},maciceland:{type:"_sbcs",chars:""},macroman:{type:"_sbcs",chars:""},macromania:{type:"_sbcs",chars:""},macthai:{type:"_sbcs",chars:"\ufeff"},macturkish:{type:"_sbcs",chars:""},macukraine:{type:"_sbcs",chars:""},koi8r:{type:"_sbcs",chars:""},koi8u:{type:"_sbcs",chars:""},koi8ru:{type:"_sbcs",chars:""},koi8t:{type:"_sbcs",chars:""},armscii8:{type:"_sbcs",chars:")(.,-"},rk1048:{type:"_sbcs",chars:""},tcvn:{type:"_sbcs",chars:"\0\b\t\n\v\f\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~"},georgianacademy:{type:"_sbcs",chars:""},georgianps:{type:"_sbcs",chars:""},pt154:{type:"_sbcs",chars:""},viscii:{type:"_sbcs",chars:"\0\b\t\n\v\f\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~"},iso646cn:{type:"_sbcs",chars:"\0\b\t\n\v\f\r !\"#%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}"},iso646jp:{type:"_sbcs",chars:"\0\b\t\n\v\f\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[]^_`abcdefghijklmnopqrstuvwxyz{|}"},hproman8:{type:"_sbcs",chars:""},macintosh:{type:"_sbcs",chars:""},ascii:{type:"_sbcs",chars:""},tis620:{type:"_sbcs",chars:""}}},{}],60:[function(t,e,r){"use strict";e.exports={10029:"maccenteuro",maccenteuro:{type:"_sbcs",chars:""},808:"cp808",ibm808:"cp808",cp808:{type:"_sbcs",chars:""},ascii8bit:"ascii",usascii:"ascii",ansix34:"ascii",ansix341968:"ascii",ansix341986:"ascii",csascii:"ascii",cp367:"ascii",ibm367:"ascii",isoir6:"ascii",iso646us:"ascii",iso646irv:"ascii",us:"ascii",latin1:"iso88591",latin2:"iso88592",latin3:"iso88593",latin4:"iso88594",latin5:"iso88599",latin6:"iso885910",latin7:"iso885913",latin8:"iso885914",latin9:"iso885915",latin10:"iso885916",csisolatin1:"iso88591",csisolatin2:"iso88592",csisolatin3:"iso88593",csisolatin4:"iso88594",csisolatincyrillic:"iso88595",csisolatinarabic:"iso88596",csisolatingreek:"iso88597",csisolatinhebrew:"iso88598",csisolatin5:"iso88599",csisolatin6:"iso885910",l1:"iso88591",l2:"iso88592",l3:"iso88593",l4:"iso88594",l5:"iso88599",l6:"iso885910",l7:"iso885913",l8:"iso885914",l9:"iso885915",l10:"iso885916",isoir14:"iso646jp",isoir57:"iso646cn",isoir100:"iso88591",isoir101:"iso88592",isoir109:"iso88593",isoir110:"iso88594",isoir144:"iso88595",isoir127:"iso88596",isoir126:"iso88597",isoir138:"iso88598",isoir148:"iso88599",isoir157:"iso885910",isoir166:"tis620",isoir179:"iso885913",isoir199:"iso885914",isoir203:"iso885915",isoir226:"iso885916",cp819:"iso88591",ibm819:"iso88591",cyrillic:"iso88595",arabic:"iso88596",arabic8:"iso88596",ecma114:"iso88596",asmo708:"iso88596",greek:"iso88597",greek8:"iso88597",ecma118:"iso88597",elot928:"iso88597",hebrew:"iso88598",hebrew8:"iso88598",turkish:"iso88599",turkish8:"iso88599",thai:"iso885911",thai8:"iso885911",celtic:"iso885914",celtic8:"iso885914",isoceltic:"iso885914",tis6200:"tis620",tis62025291:"tis620",tis62025330:"tis620",10000:"macroman",10006:"macgreek",10007:"maccyrillic",10079:"maciceland",10081:"macturkish",cspc8codepage437:"cp437",cspc775baltic:"cp775",cspc850multilingual:"cp850",cspcp852:"cp852",cspc862latinhebrew:"cp862",cpgr:"cp869",msee:"cp1250",mscyrl:"cp1251",msansi:"cp1252",msgreek:"cp1253",msturk:"cp1254",mshebr:"cp1255",msarab:"cp1256",winbaltrim:"cp1257",cp20866:"koi8r",20866:"koi8r",ibm878:"koi8r",cskoi8r:"koi8r",cp21866:"koi8u",21866:"koi8u",ibm1168:"koi8u",strk10482002:"rk1048",tcvn5712:"tcvn",tcvn57121:"tcvn",gb198880:"iso646cn",cn:"iso646cn",csiso14jisc6220ro:"iso646jp",jisc62201969ro:"iso646jp",jp:"iso646jp",cshproman8:"hproman8",r8:"hproman8",roman8:"hproman8",xroman8:"hproman8",ibm1051:"hproman8",mac:"macintosh",csmacintosh:"macintosh"}},{}],61:[function(t,e,r){e.exports=[["8740",""],["8767",""],["87a1",""],["8840","",4,""],["88a1",""],["8940",""],["8943",""],["8946",""],["894c",""],["89a1",""],["89ab",""],["89b0",""],["89b5",""],["89c1",""],["89c5",""],["8a40",""],["8a43",""],["8a64",""],["8a76",""],["8aa1",""],["8aac",""],["8ab2",""],["8abb",""],["8ac9",""],["8ace",""],["8adf",""],["8af6",""],["8b40",""],["8b55",""],["8ba1",""],["8bde",""],["8c40",""],["8ca1",""],["8ca7",""],["8cc9",""],["8cce",""],["8ce6",""],["8d40",""],["8d42",""],["8da1",""],["8e40",""],["8ea1",""],["8f40",""],["8fa1",""],["9040",""],["90a1",""],["9140",""],["91a1",""],["9240",""],["92a1",""],["9340",""],["93a1",""],["9440",""],["94a1",""],["9540",""],["95a1",""],["9640",""],["96a1",""],["9740",""],["97a1",""],["9840",""],["98a1",""],["9940",""],["99a1",""],["9a40",""],["9aa1",""],["9b40",""],["9b62",""],["9ba1",""],["9c40",""],["9ca1",""],["9d40",""],["9da1",""],["9e40",""],["9ea1",""],["9ead",""],["9ec5",""],["9ef5",""],["9f40",""],["9f4f",""],["9fa1",""],["9fae",""],["9fb2",""],["9fc1",""],["9fc9",""],["9fdb",""],["9fe7",""],["9feb",""],["9ff0",""],["a040",""],["a055",""],["a058",""],["a05b",""],["a063",""],["a073",""],["a0a1",""],["a0a6",""],["a0ae",""],["a0b0",""],["a0d4",""],["a0e2",""],["a3c0","",31,""],["c6a1","",9,"",9,"",9,"",23],["c740","",58,""],["c7a1","",81,"",5,"",4],["c840","",26,"",25,""],["c8a1",""],["c8cd",""],["c8f5",""],["f9fe",""],["fa40",""],["faa1",""],["fb40",""],["fba1",""],["fc40",""],["fca1",""],["fd40",""],["fda1",""],["fe40",""],["fea1",""]]},{}],62:[function(t,e,r){e.exports=[["0","\0",127,""],["8140","",5,"",9,"",6,""],["8180","",6,"",4,"",4,"",5,""],["8240","",4,"",8,"",4,"",11],["8280","",10,"",4,"",7,"",5,"",8,"",20,"",4,"",6,""],["8340","",17,"",5,"",10,"",4,"",9,""],["8380","",5,"",13,"",28,"",4,"",4,"",5],["8440","",5,"",5,""],["8480","",9,"",4,"",6,"",6,"",9,"",5,"",10,"",7,""],["8540","",9,""],["8580","",4,"",6,"",4,"",4,"",7,""],["8640","",4,"",5,"",4,"",5,""],["8680","",4,"",4,"",5,"",6,"",8,"",4,"",4,"",4,""],["8740","",7,"",11,"",4,"",4],["8780","",7,"",6,"",14,"",10,"",6,"",12,"",8,"",5,"",6],["8840","",9,"",4,"",4,""],["8880","",4,"",6,"",8,"",6,"",7,"",4,"",4,"",7],["8940","",5,"",6,"",4,"",5,"",4,"",16,""],["8980","",4,"",4,"",7,"",17,"",10,"",13,"",5,"",7,"",4,""],["8a40","",4,"",12,""],["8a80","",5,"",6,"",4,"",11,"",6,"",4,"",4,"",9,"",5],["8b40","",8,"",17,"",6,"",13,""],["8b80","",4,"",4,"",5,"",4,"",4,"",22,"",11,"",25,"",7,"",6],["8c40","",7,""],["8c80","",8,"",4,"",6,"",6,"",6,"",4,"",4,"",4],["8d40","",5,"",5,"",5,"",6,"",9,"",4],["8d80","",5,"",4,"",4,"",4,"",7,"",7,"",10,"",10,"",12,"",21,""],["8e40","",21,"",12,"",6,"",12,""],["8e80","",4,"",7,"",4,"",4,"",5,"",6,"",4,"",14,"",4,"",4,"",6],["8f40","",5,"",11,"",8,""],["8f80","",6,"",14,"",5,"",5,"",4,""],["9040","",4,"",4,"",6,""],["9080","",7,"",4,"",4,"",4,"",4,"",18,"",6],["9140","",6,"",6,"",18,"",4,""],["9180","",6,"",8,"",9,"",5,"",4,"",4,"",16,"",13,"",8,"",5,"",4,""],["9240","",6,"",5,""],["9280","",5,"",7,"",6,""],["9340","",6,"",4,"",4,"",5,""],["9380","",5,"",4,"",6,"",4,"",7,"",9,"",6,"",8,"",4,"",6,""],["9440","",24,"",7,"",7,"",4,"",8],["9480","",4,"",4,"",14,"",7,"",7,""],["9540","",4,"",4,"",6,""],["9580","",4,"",4,"",8,"",4,"",4,"",25,"",7,"",5,""],["9640","",5,"",4,""],["9680","",7,"",9,"",7,"",4,"",6,"",6,"",5],["9740","",7,"",8,"",7,"",9,""],["9780","",6,"",5,"",4,"",9,"",4,"",11,"",7,"",16,""],["9840","",4,"",5,"",9,""],["9880","",7,"",5,"",11,"",9,"",9,"",11,"",5,"",5,"",6,"",4,"",7,"",6,""],["9940","",4,"",10,"",6,"",8,"",4,"",7,"",5],["9980","",114,"",6],["9a40","",11,"",7,"",13,""],["9a80","",4,"",7,"",7,"",6,"",4,"",4,"",7,"",6,"",4,"",4,""],["9b40","",4,""],["9b80","",5,"",4,"",4,"",5,""],["9c40","",7,""],["9c80","",7,"",7,"",10,"",14,"",4,"",6,"",5],["9d40","",7,"",4,"",9,"",6,""],["9d80","",9,"",5,"",6,"",12,"",4,"",10,"",5,"",5,"",6,"",10,""],["9e40","",7,"",32,"",7,"",6,"",6],["9e80","",9,"",17,"",13,"",11,"",12,"",12,""],["9f40","",6,"",10,"",4,"",10,"",7,""],["9f80","",13,"",12,"",4,"",4,"",5,"",4,"",4,"",6,"",5,"",8,"",9,"",4],["a040","",9,"",5,"",9,"",11,"",19],["a080","",9,"",6,"",4,"",11,"",11,"",6,""],["a1a1","",7,""],["a2a1","",9],["a2b1","",19,"",19,"",9],["a2e5","",9],["a2f1","",11],["a3a1","",88,""],["a4a1","",82],["a5a1","",85],["a6a1","",16,"",6],["a6c1","",16,"",6],["a6e0",""],["a6ee",""],["a6f4",""],["a7a1","",5,"",25],["a7d1","",5,"",25],["a840","",35,"",6],["a880","",7,""],["a8a1",""],["a8bd",""],["a8c0",""],["a8c5","",36],["a940","",8,""],["a959",""],["a95c",""],["a960","",9,"",8],["a980","",4,""],["a996",""],["a9a4","",75],["aa40","",5,"",5,"",8],["aa80","",7,"",10,""],["ab40","",11,"",4,"",5,"",4],["ab80","",6,"",4],["ac40","",10,"",8,"",5,"",4,"",11],["ac80","",6,"",12,"",4,""],["ad40","",10,"",7,"",15,"",12],["ad80","",9,"",8,"",6,""],["ae40","",6,"",7,"",4,""],["ae80","",7,"",6,"",4,""],["af40","",4,""],["af80",""],["b040","",6,"",5,"",4,"",6,"",7,""],["b080","",7,"",8,"",9,""],["b140","",4,"",7,"",10,""],["b180","",4,"",7,"",7,""],["b240","",11,"",5,"",11,"",4],["b280","",12,"",8,"",4,""],["b340","",5,""],["b380","",11,"",7,"",6,""],["b440","",7,"",9],["b480","",4,"",5,"",6,""],["b540","",5,"",9,"",4,"",14,"",4,"",8,""],["b580","",6,"",4,""],["b640","",6,"",11,"",10,"",4,"",5,""],["b680","",6,"",4,""],["b740","",14,"",5,"",9,"",4,"",16],["b780","",6,""],["b840","",4,"",10,"",10,"",9,"",5,""],["b880","",4,""],["b940","",5,"",10,"",6,""],["b980","",7,""],["ba40","",4,"",4,"",7,"",5,""],["ba80","",4,"",5,"",12,"",5,""],["bb40","",9,"",36,"",5,"",9],["bb80","",6,"",4,""],["bc40","",6,"",6,"",5,"",7,"",13,"",5],["bc80","",14,"",6,""],["bd40","",54,"",7],["bd80","",32,""],["be40","",12,"",6,"",42],["be80","",32,""],["bf40","",62],["bf80","",4,"",4,"",21,""],["c040","",35,"",23,""],["c080","",6,"",9,""],["c140","",4,"",7,"",4,"",4,"",6,""],["c180","",4,"",4,"",5,""],["c240","",6,"",5,""],["c280","",13,"",5,"",11,""],["c340","",5,"",4,"",6,""],["c380","",12,"",4,""],["c440","",5,"",4,"",4,"",5,"",4,""],["c480","",7,"",5,"",6,""],["c540","",14,"",4,"",5,"",4,"",5,""],["c580","",7,"",7,""],["c640",""],["c680","",4,"",9,""],["c740","",4,"",4,"",6,"",6,"",6,""],["c780",""],["c840","",4,"",5,"",5,"",7,"",5,"",7,""],["c880","",6,"",4,"",4,""],["c940","",4,"",7,"",12,""],["c980","",4,"",4,"",10,""],["ca40","",8,"",8,"",9,"",4,"",10],["ca80","",4,"",8,""],["cb40","",6,"",10,"",6,"",5,"",6,"",6,"",4,""],["cb80","",5,"",6,"",14,""],["cc40","",4,"",10,"",15,"",13,""],["cc80","",11,"",4,"",7,""],["cd40","",6,"",6,"",4,"",5,"",4,"",4,""],["cd80",""],["ce40","",6,"",5,"",7,""],["ce80","",4,"",6,"",4,""],["cf40","",4,"",4,"",6,"",9],["cf80","",5,"",7,"",4,""],["d040","",13,"",5,"",5,"",5,"",6,""],["d080","",4,"",4,"",5,""],["d140","",4,"",4,"",6,"",5],["d180","",4,"",4,"",4,""],["d240","",8,"",24,"",5,"",19,""],["d280","",26,""],["d340","",30,"",6],["d380","",4,"",5,"",21,""],["d440","",31,"",8,"",21],["d480","",25,"",6,""],["d540","",7,"",7,"",46],["d580","",32,""],["d640","",34,"",27],["d680","",30,""],["d740","",31,"",4,"",25],["d780","",24,""],["d840","",8,"",7,"",5,"",6,"",6,"",6,""],["d880","",6,"",20,""],["d940","",62],["d980","",32,""],["da40","",14,"",8,"",4,"",9,""],["da80","",12,""],["db40","",6,"",7,"",4,""],["db80","",4,"",5,"",11,""],["dc40","",4,"",6,"",6,"",11,"",6,"",7],["dc80","",10,"",21,""],["dd40","",62],["dd80","",32,""],["de40","",32,""],["de80","",4,""],["df40","",5,"",4,"",4,"",5,"",4,"",6,""],["df80","",4,""],["e040","",19,""],["e080","",10,"",6,"",8,""],["e140","",4,"",6,"",5,"",5,""],["e180","",10,"",9,"",8,""],["e240","",62],["e280","",32,"",5,""],["e340","",45,"",16],["e380","",7,"",24,""],["e440","",5,"",24,"",31],["e480","",32,""],["e540","",51,"",10],["e580","",31,""],["e640","",34,"",27],["e680","",29,""],["e740","",7,"",54],["e780","",32,"",6,"",4,""],["e840","",14,"",43,""],["e880","",20,""],["e940","",7,"",42],["e980","",32,""],["ea40","",27,"",6,""],["ea80","",4,"",12,""],["eb40","",9,"",7,"",9,"",6,""],["eb80","",4,""],["ec40","",8,"",4,"",18,"",7],["ec80","",4,"",7,"",4,"",4,""],["ed40","",6,"",46],["ed80","",4,"",23,""],["ee40","",62],["ee80","",32,"",4,"",6,""],["ef40","",5,"",37,"",4],["ef80","",30,"",4,"",8,""],["f040","",4,"",28,"",26],["f080","",9,"",12,"",4,"",6,""],["f140","",10,"",47],["f180","",32,""],["f240","",62],["f280","",32,""],["f340","",17,"",6,"",4,""],["f380","",8,"",6,""],["f440","",5,"",10,"",10,"",7,"",5],["f480","",32,""],["f540","",62],["f580","",32,""],["f640","",62],["f680","",32,"",5,"",5,"",4,"",7,""],["f740","",62],["f780","",4,"",4,""],["f840","",62],["f880","",32],["f940","",62],["f980","",32],["fa40","",62],["fa80","",32],["fb40","",27,"",9,""],["fb80","",5,"",8,"",5,""],["fc40","",8,"",4,"",8,"",6],["fc80","",4,"",5,"",8,""],["fd40","",4,"",4,"",10,"",38],["fd80","",5,"",11,"",4,""],["fe40",""]]},{}],63:[function(t,e,r){e.exports=[["0","\0",127],["8141","",4,"",6,""],["8161","",9,"",5,""],["8181","",18,"",4,"",6,"",5,"",6,"",7,"",7,"",4,"",4,""],["8241","",7,"",5],["8261","",6,"",5,""],["8281","",7,"",7,"",4,"",10,"",5,"",17,"",7,"",6,"",7,"",18],["8341","",5,"",5,"",7],["8361","",18,""],["8381","",4,"",6,"",5,"",5,"",46,"",6,"",5,"",8],["8441","",5,"",8],["8461","",18],["8481","",7,"",6,"",5,"",10,"",5,"",18,"",5,"",6,"",5,"",26,""],["8541","",5,"",4,"",6,"",4],["8561","",5,"",5,"",6,""],["8581","",6,"",6,"",9,"",26,"",29,"",6,"",5,""],["8641","",6,"",5,""],["8661","",6,"",10],["8681","",22,"",4,"",6,"",5,"",6,"",22,"",4,""],["8741","",9,"",15],["8761","",18,""],["8781","",5,"",7,"",7,"",5,"",6,"",5,"",18,"",6,"",26,"",6,"",4],["8841","",4,"",5,"",6,"",4],["8861","",4,""],["8881","",15,"",4,"",6,"",5,"",54,""],["8941","",6,"",5,""],["8961","",10,"",5,""],["8981","",21,"",18,"",18,"",6,"",6,"",7,"",15],["8a41","",10,"",6,""],["8a61","",4,"",18,""],["8a81","",4,"",19,"",5,"",7,"",5,"",6,"",5,"",4,"",5,"",26,""],["8b41","",5,"",4,"",6,""],["8b61","",6,"",8],["8b81","",52,"",4,"",6,"",5,"",18,"",18],["8c41","",15,"",4],["8c61","",6,"",5,"",6,"",5],["8c81","",12,"",26,"",50,"",5,"",16],["8d41","",16,"",8],["8d61","",17,""],["8d81","",4,"",33,"",6,"",7,"",6,"",9,"",6,"",5,"",6,""],["8e41","",6,"",5,"",8],["8e61","",4,"",19],["8e81","",13,"",6,"",4,"",6,"",5,"",6,"",5,"",11,"",7,"",6,"",5,"",7],["8f41","",7,"",17],["8f61","",7,"",6,"",4],["8f81","",5,"",7,"",5,"",6,"",5,"",18,"",6,"",26,"",6,"",5],["9041","",6,"",5,""],["9061","",5,"",15],["9081","",12,"",6,"",5,"",4,"",6,"",4,"",5,"",11,"",33,""],["9141","",6,"",5],["9161","",9,"",5],["9181","",20,"",4,"",5,"",14,"",33,"",7,"",5,"",6],["9241","",7,"",4,""],["9261","",7,"",7,"",4],["9281","",21,"",18,"",6,"",7,"",6,"",35,""],["9341","",4,""],["9361","",6,"",8],["9381","",37,"",4,"",4,"",6,"",5,"",7,"",22,""],["9441","",5,"",5,"",8],["9461","",5,"",6,"",12],["9481","",5,"",6,"",6,"",9,"",22,"",4,"",6,"",10,"",6,"",24],["9541","",11,"",5,""],["9561","",6,"",5,""],["9581","",6,"",35,"",4,"",4,"",4,"",6,"",5,"",13,"",14],["9641","",23,""],["9661","",6,"",5,"",8],["9681","",10,"",5,"",13,"",33,"",6,"",44],["9741","",16,"",8],["9761","",17,"",7],["9781","",11,"",5,"",6,"",89,""],["9841","",16,"",5,""],["9861","",6,"",15],["9881","",21,"",6,"",5,"",4,"",6,"",5,"",6,"",5,"",6,"",5,""],["9941","",6,"",5,""],["9961","",6,"",5,""],["9981","",8,"",5,"",4,"",11,"",5,"",6,"",6,"",6,"",7,"",6,"",5,""],["9a41","",16],["9a61","",6,"",6,""],["9a81","",4,"",6,"",5,"",5,"",6,"",5,"",5,"",33,"",5,"",6,""],["9b41","",6,"",8],["9b61","",17,"",7],["9b81","",25,"",4,"",5,"",50,"",22,""],["9c41","",4,"",5,"",5],["9c61","",8,"",6,"",9],["9c81","",8,"",6,"",6,"",9,"",26,"",6,"",5,"",18,"",6,"",12],["9d41","",13,"",8],["9d61","",25],["9d81","",8,"",5,"",9,"",6,"",10,"",6,"",5,"",6,"",5,""],["9e41","",7,"",9,""],["9e61","",4,"",6,""],["9e81","",6,"",6,"",6,"",5,"",10,"",5,"",6,"",5,"",6,""],["9f41","",5,"",4,"",5,""],["9f61","",6,"",5,""],["9f81","",4,"",5,"",6,"",5,"",6,"",4,"",6,"",7,"",4,"",4,""],["a041","",5,"",6,""],["a061","",5,"",13],["a081","",4,"",4,"",4,"",6,"",5,"",6,"",5,"",26,"",4,"",5,"",7,""],["a141","",18,""],["a161","",6,"",5,""],["a181","",14,"",5,"",4,"",9,""],["a241","",5,"",18],["a261","",6,"",18],["a281","",7,"",6,"",7,""],["a341","",6,"",10,""],["a361","",6,"",16],["a381","",16,"",4,"",58,"",32,""],["a441","",5,""],["a461","",5,"",12],["a481","",28,"",93],["a541","",4,"",6,"",5,""],["a561","",17,"",5,""],["a581","",16,"",14,"",9],["a5b0","",9],["a5c1","",16,"",6],["a5e1","",16,"",6],["a641","",19,""],["a661","",5,"",5,"",6],["a681","",6,"",18,"",7],["a741","",4,"",6,"",7],["a761","",22,""],["a781","",6,"",5,"",7,"",9,"",9,"",4,"",5,"",4,""],["a841","",10,"",14],["a861","",18,"",6],["a881","",19,"",11,""],["a8a6",""],["a8a8",""],["a8b1","",27,"",25,"",14,""],["a941","",14,"",10],["a961","",18],["a981","",14,"",6,"",27,"",25,"",14,""],["aa41","",6,"",4,""],["aa61","",4,"",5,"",6,""],["aa81","",29,"",82],["ab41","",6,"",5,""],["ab61","",6,"",5,"",5],["ab81","",8,"",6,"",12,"",85],["ac41","",5,"",6,""],["ac61","",11,"",4],["ac81","",28,"",5,"",25],["acd1","",5,"",25],["ad41","",6,"",5,"",7],["ad61","",6,"",10,""],["ad81","",5,"",18,""],["ae41","",5,"",16],["ae61","",5,"",6,"",4],["ae81","",6,"",5,""],["af41","",19],["af61","",13,"",5,""],["af81","",5,"",6,"",5,""],["b041","",5,"",5,"",12],["b061","",5,"",19],["b081","",13,"",6,"",5,"",7,"",4,""],["b141","",6,"",5,""],["b161","",6,"",5,"",11],["b181","",14,"",6,""],["b241","",6,"",5,""],["b261","",18,"",5,""],["b281","",5,"",18,"",6,""],["b341","",19,""],["b361","",5,"",5,"",5],["b381","",5,"",5,"",19,"",4,""],["b441","",5,"",6,"",5],["b461","",6,"",10,""],["b481","",6,"",18,"",4,"",4,""],["b541","",14,"",5],["b561","",5,"",5,"",4],["b581","",6,"",5,"",11,""],["b641","",7,"",17],["b661","",15,""],["b681","",5,"",6,"",5,""],["b741","",13,"",6,""],["b761","",20,""],["b781","",6,"",14,""],["b841","",7,"",17],["b861","",8,"",13],["b881","",5,"",24,"",4,""],["b941","",6,"",5,""],["b961","",14,"",6,""],["b981","",22,"",4,"",4,""],["ba41","",5,"",6,""],["ba61","",5,"",4,"",5],["ba81","",6,"",9,""],["bb41","",4,"",5,"",4,""],["bb61","",6,"",5,""],["bb81","",31,""],["bc41","",17,""],["bc61","",5,"",6,""],["bc81","",4,"",6,"",5,"",5,"",4,""],["bd41","",7,"",7,""],["bd61","",5,"",13],["bd81","",5,"",25,""],["be41","",7,"",14],["be61","",7,"",7,""],["be81","",4,"",4,"",5,"",8,"",6,""],["bf41","",10,"",14],["bf61","",18,""],["bf81","",5,"",7,"",6,"",5,""],["c041","",5,"",6,"",5],["c061","",25],["c081","",6,"",5,"",7,""],["c141","",5,"",6,""],["c161","",19,""],["c181","",31,""],["c241","",4,"",5,""],["c261","",4,"",5,"",6,""],["c281","",5,"",7,"",9,""],["c341","",4],["c361","",4,"",5,"",11],["c381","",5,"",7,"",5,""],["c441","",7,"",7,""],["c461","",5,"",4],["c481","",5,"",11,""],["c541","",6,"",5,""],["c561","",6,"",5,"",4],["c581","",6,"",5,""],["c641","",6,"",5],["c6a1",""],["c7a1",""],["c8a1",""],["caa1",""],["cba1",""],["cca1",""],["cda1",""],["cea1",""],["cfa1",""],["d0a1",""],["d1a1","",5,"",4,""],["d2a1","",4,"",5,"",10,"",7,"",5,""],["d3a1",""],["d4a1",""],["d5a1",""],["d6a1",""],["d7a1",""],["d8a1",""],["d9a1",""],["daa1",""],["dba1",""],["dca1",""],["dda1",""],["dea1",""],["dfa1",""],["e0a1",""],["e1a1",""],["e2a1",""],["e3a1",""],["e4a1",""],["e5a1",""],["e6a1",""],["e7a1",""],["e8a1",""],["e9a1",""],["eaa1",""],["eba1",""],["eca1",""],["eda1",""],["eea1",""],["efa1",""],["f0a1",""],["f1a1",""],["f2a1",""],["f3a1",""],["f4a1",""],["f5a1",""],["f6a1",""],["f7a1",""],["f8a1",""],["f9a1",""],["faa1",""],["fba1",""],["fca1",""],["fda1",""]]},{}],64:[function(t,e,r){e.exports=[["0","\0",127],["a140",""],["a1a1","",4,""],["a240","",7,""],["a2a1","",9,"",9,"",8,"",25,"",21],["a340","",16,"",6,"",16,"",6,"",10],["a3a1","",25,""],["a3e1",""],["a440",""],["a4a1",""],["a540",""],["a5a1",""],["a640",""],["a6a1",""],["a740",""],["a7a1",""],["a840",""],["a8a1",""],["a940",""],["a9a1",""],["aa40",""],["aaa1",""],["ab40",""],["aba1",""],["ac40",""],["aca1",""],["ad40",""],["ada1",""],["ae40",""],["aea1",""],["af40",""],["afa1",""],["b040",""],["b0a1",""],["b140",""],["b1a1",""],["b240",""],["b2a1",""],["b340",""],["b3a1",""],["b440",""],["b4a1",""],["b540",""],["b5a1",""],["b640",""],["b6a1",""],["b740",""],["b7a1",""],["b840",""],["b8a1",""],["b940",""],["b9a1",""],["ba40",""],["baa1",""],["bb40",""],["bba1",""],["bc40",""],["bca1",""],["bd40",""],["bda1",""],["be40",""],["bea1",""],["bf40",""],["bfa1",""],["c040",""],["c0a1",""],["c140",""],["c1a1",""],["c240",""],["c2a1",""],["c340",""],["c3a1",""],["c440",""],["c4a1",""],["c540",""],["c5a1",""],["c640",""],["c940",""],["c9a1",""],["ca40",""],["caa1",""],["cb40",""],["cba1",""],["cc40",""],["cca1",""],["cd40",""],["cda1",""],["ce40",""],["cea1",""],["cf40",""],["cfa1",""],["d040",""],["d0a1",""],["d140",""],["d1a1",""],["d240",""],["d2a1",""],["d340",""],["d3a1",""],["d440",""],["d4a1",""],["d540",""],["d5a1",""],["d640",""],["d6a1",""],["d740",""],["d7a1",""],["d840",""],["d8a1",""],["d940",""],["d9a1",""],["da40",""],["daa1",""],["db40",""],["dba1",""],["dc40",""],["dca1",""],["dd40",""],["dda1",""],["de40",""],["dea1",""],["df40",""],["dfa1",""],["e040",""],["e0a1",""],["e140",""],["e1a1",""],["e240",""],["e2a1",""],["e340",""],["e3a1",""],["e440",""],["e4a1",""],["e540",""],["e5a1",""],["e640",""],["e6a1",""],["e740",""],["e7a1",""],["e840",""],["e8a1",""],["e940",""],["e9a1",""],["ea40",""],["eaa1",""],["eb40",""],["eba1",""],["ec40",""],["eca1",""],["ed40",""],["eda1",""],["ee40",""],["eea1",""],["ef40",""],["efa1",""],["f040",""],["f0a1",""],["f140",""],["f1a1",""],["f240",""],["f2a1",""],["f340",""],["f3a1",""],["f440",""],["f4a1",""],["f540",""],["f5a1",""],["f640",""],["f6a1",""],["f740",""],["f7a1",""],["f840",""],["f8a1",""],["f940",""],["f9a1",""]]},{}],65:[function(t,e,r){e.exports=[["0","\0",127],["8ea1","",62],["a1a1","",9,""],["a2a1",""],["a2ba",""],["a2ca",""],["a2dc",""],["a2f2",""],["a2fe",""],["a3b0","",9],["a3c1","",25],["a3e1","",25],["a4a1","",82],["a5a1","",85],["a6a1","",16,"",6],["a6c1","",16,"",6],["a7a1","",5,"",25],["a7d1","",5,"",25],["a8a1",""],["ada1","",19,"",9],["adc0",""],["addf","",4,""],["b0a1",""],["b1a1",""],["b2a1",""],["b3a1",""],["b4a1",""],["b5a1",""],["b6a1",""],["b7a1",""],["b8a1",""],["b9a1",""],["baa1",""],["bba1",""],["bca1",""],["bda1",""],["bea1",""],["bfa1",""],["c0a1",""],["c1a1",""],["c2a1",""],["c3a1",""],["c4a1",""],["c5a1",""],["c6a1",""],["c7a1",""],["c8a1",""],["c9a1",""],["caa1",""],["cba1",""],["cca1",""],["cda1",""],["cea1",""],["cfa1",""],["d0a1",""],["d1a1",""],["d2a1",""],["d3a1",""],["d4a1",""],["d5a1",""],["d6a1",""],["d7a1",""],["d8a1",""],["d9a1",""],["daa1",""],["dba1",""],["dca1",""],["dda1",""],["dea1",""],["dfa1",""],["e0a1",""],["e1a1",""],["e2a1",""],["e3a1",""],["e4a1",""],["e5a1",""],["e6a1",""],["e7a1",""],["e8a1",""],["e9a1",""],["eaa1",""],["eba1",""],["eca1",""],["eda1",""],["eea1",""],["efa1",""],["f0a1",""],["f1a1",""],["f2a1",""],["f3a1",""],["f4a1",""],["f9a1",""],["faa1",""],["fba1",""],["fca1",""],["fcf1","",9,""],["8fa2af",""],["8fa2c2",""],["8fa2eb",""],["8fa6e1",""],["8fa6e7",""],["8fa6e9",""],["8fa6ec",""],["8fa6f1",""],["8fa7c2","",10,""],["8fa7f2","",10,""],["8fa9a1",""],["8fa9a4",""],["8fa9a6",""],["8fa9a8",""],["8fa9ab",""],["8fa9af",""],["8fa9c1",""],["8faaa1",""],["8faaba",""],["8faba1",""],["8fabbd",""],["8fabc5",""],["8fb0a1",""],["8fb1a1",""],["8fb2a1","",4,""],["8fb3a1",""],["8fb4a1",""],["8fb5a1",""],["8fb6a1","",5,"",4,""],["8fb7a1","",4,""],["8fb8a1",""],["8fb9a1",""],["8fbaa1","",4,""],["8fbba1",""],["8fbca1","",4,""],["8fbda1","",4,""],["8fbea1","",4,""],["8fbfa1",""],["8fc0a1",""],["8fc1a1",""],["8fc2a1",""],["8fc3a1","",4,""],["8fc4a1",""],["8fc5a1",""],["8fc6a1",""],["8fc7a1",""],["8fc8a1",""],["8fc9a1","",4,"",4,""],["8fcaa1",""],["8fcba1",""],["8fcca1","",9,""],["8fcda1","",5,""],["8fcea1","",6,""],["8fcfa1",""],["8fd0a1",""],["8fd1a1",""],["8fd2a1","",5],["8fd3a1",""],["8fd4a1","",4,""],["8fd5a1",""],["8fd6a1",""],["8fd7a1",""],["8fd8a1",""],["8fd9a1","",4,"",6,""],["8fdaa1","",4,""],["8fdba1","",6,""],["8fdca1","",4,""],["8fdda1","",4,""],["8fdea1","",4,""],["8fdfa1",""],["8fe0a1",""],["8fe1a1","",4,""],["8fe2a1",""],["8fe3a1","",5,"",4,""],["8fe4a1","",4,""],["8fe5a1","",4,""],["8fe6a1",""],["8fe7a1",""],["8fe8a1","",4,""],["8fe9a1","",4],["8feaa1","",4,""],["8feba1","",4,""],["8feca1",""],["8feda1","",4,"",4,""]]},{}],66:[function(t,e,r){e.exports={uChars:[128,165,169,178,184,216,226,235,238,244,248,251,253,258,276,284,300,325,329,334,364,463,465,467,469,471,473,475,477,506,594,610,712,716,730,930,938,962,970,1026,1104,1106,8209,8215,8218,8222,8231,8241,8244,8246,8252,8365,8452,8454,8458,8471,8482,8556,8570,8596,8602,8713,8720,8722,8726,8731,8737,8740,8742,8748,8751,8760,8766,8777,8781,8787,8802,8808,8816,8854,8858,8870,8896,8979,9322,9372,9548,9588,9616,9622,9634,9652,9662,9672,9676,9680,9702,9735,9738,9793,9795,11906,11909,11913,11917,11928,11944,11947,11951,11956,11960,11964,11979,12284,12292,12312,12319,12330,12351,12436,12447,12535,12543,12586,12842,12850,12964,13200,13215,13218,13253,13263,13267,13270,13384,13428,13727,13839,13851,14617,14703,14801,14816,14964,15183,15471,15585,16471,16736,17208,17325,17330,17374,17623,17997,18018,18212,18218,18301,18318,18760,18811,18814,18820,18823,18844,18848,18872,19576,19620,19738,19887,40870,59244,59336,59367,59413,59417,59423,59431,59437,59443,59452,59460,59478,59493,63789,63866,63894,63976,63986,64016,64018,64021,64025,64034,64037,64042,65074,65093,65107,65112,65127,65132,65375,65510,65536],gbChars:[0,36,38,45,50,81,89,95,96,100,103,104,105,109,126,133,148,172,175,179,208,306,307,308,309,310,311,312,313,341,428,443,544,545,558,741,742,749,750,805,819,820,7922,7924,7925,7927,7934,7943,7944,7945,7950,8062,8148,8149,8152,8164,8174,8236,8240,8262,8264,8374,8380,8381,8384,8388,8390,8392,8393,8394,8396,8401,8406,8416,8419,8424,8437,8439,8445,8482,8485,8496,8521,8603,8936,8946,9046,9050,9063,9066,9076,9092,9100,9108,9111,9113,9131,9162,9164,9218,9219,11329,11331,11334,11336,11346,11361,11363,11366,11370,11372,11375,11389,11682,11686,11687,11692,11694,11714,11716,11723,11725,11730,11736,11982,11989,12102,12336,12348,12350,12384,12393,12395,12397,12510,12553,12851,12962,12973,13738,13823,13919,13933,14080,14298,14585,14698,15583,15847,16318,16434,16438,16481,16729,17102,17122,17315,17320,17402,17418,17859,17909,17911,17915,17916,17936,17939,17961,18664,18703,18814,18962,19043,33469,33470,33471,33484,33485,33490,33497,33501,33505,33513,33520,33536,33550,37845,37921,37948,38029,38038,38064,38065,38066,38069,38075,38076,38078,39108,39109,39113,39114,39115,39116,39265,39394,189e3]}},{}],67:[function(t,e,r){e.exports=[["a140","",62],["a180","",32],["a240","",62],["a280","",32],["a2ab","",5],["a2e3",""],["a2ef",""],["a2fd",""],["a340","",62],["a380","",31,""],["a440","",62],["a480","",32],["a4f4","",10],["a540","",62],["a580","",32],["a5f7","",7],["a640","",62],["a680","",32],["a6b9","",7],["a6d9","",6],["a6ec",""],["a6f3",""],["a6f6","",8],["a740","",62],["a780","",32],["a7c2","",14],["a7f2","",12],["a896","",10],["a8bc",""],["a8bf",""],["a8c1",""],["a8ea","",20],["a958",""],["a95b",""],["a95d",""],["a989","",11],["a997","",12],["a9f0","",14],["aaa1","",93],["aba1","",93],["aca1","",93],["ada1","",93],["aea1","",93],["afa1","",93],["d7fa","",4],["f8a1","",93],["f9a1","",93],["faa1","",93],["fba1","",93],["fca1","",93],["fda1","",93],["fe50",""],["fe80","",6,"",93]]},{}],68:[function(t,e,r){e.exports=[["0","\0",128],["a1","",62],["8140","",9,""],["8180",""],["81b8",""],["81c8",""],["81da",""],["81f0",""],["81fc",""],["824f","",9],["8260","",25],["8281","",25],["829f","",82],["8340","",62],["8380","",22],["839f","",16,"",6],["83bf","",16,"",6],["8440","",5,"",25],["8470","",5,"",7],["8480","",17],["849f",""],["8740","",19,"",9],["875f",""],["877e",""],["8780","",4,""],["889f",""],["8940",""],["8980",""],["8a40",""],["8a80",""],["8b40",""],["8b80",""],["8c40",""],["8c80",""],["8d40",""],["8d80",""],["8e40",""],["8e80",""],["8f40",""],["8f80",""],["9040",""],["9080",""],["9140",""],["9180",""],["9240",""],["9280",""],["9340",""],["9380",""],["9440",""],["9480",""],["9540",""],["9580",""],["9640",""],["9680",""],["9740",""],["9780",""],["9840",""],["989f",""],["9940",""],["9980",""],["9a40",""],["9a80",""],["9b40",""],["9b80",""],["9c40",""],["9c80",""],["9d40",""],["9d80",""],["9e40",""],["9e80",""],["9f40",""],["9f80",""],["e040",""],["e080",""],["e140",""],["e180",""],["e240",""],["e280",""],["e340",""],["e380",""],["e440",""],["e480",""],["e540",""],["e580",""],["e640",""],["e680",""],["e740",""],["e780",""],["e840",""],["e880",""],["e940",""],["e980",""],["ea40",""],["ea80",""],["ed40",""],["ed80",""],["ee40",""],["ee80",""],["eeef","",9,""],["f040","",62],["f080","",124],["f140","",62],["f180","",124],["f240","",62],["f280","",124],["f340","",62],["f380","",124],["f440","",62],["f480","",124],["f540","",62],["f580","",124],["f640","",62],["f680","",124],["f740","",62],["f780","",124],["f840","",62],["f880","",124],["f940",""],["fa40","",9,"",9,""],["fa80",""],["fb40",""],["fb80",""],["fc40",""]]},{}],69:[function(t,e,r){"use strict";var n=t("buffer").Buffer;function i(){}function s(){}function a(){this.overflowByte=-1}function o(t,e){this.iconv=e}function c(t,e){void 0===(t=t||{}).addBOM&&(t.addBOM=!0),this.encoder=e.iconv.getEncoder("utf-16le",t)}function l(t,e){this.decoder=null,this.initialBytes=[],this.initialBytesLen=0,this.options=t||{},this.iconv=e.iconv}function u(t,e){var r=e||"utf-16le";if(t.length>=2)if(254==t[0]&&255==t[1])r="utf-16be";else if(255==t[0]&&254==t[1])r="utf-16le";else{for(var n=0,i=0,s=Math.min(t.length-t.length%2,64),a=0;a<s;a+=2)0===t[a]&&0!==t[a+1]&&i++,0!==t[a]&&0===t[a+1]&&n++;i>n?r="utf-16be":i<n&&(r="utf-16le")}return r}r.utf16be=i,i.prototype.encoder=s,i.prototype.decoder=a,i.prototype.bomAware=!0,s.prototype.write=function(t){for(var e=new n(t,"ucs2"),r=0;r<e.length;r+=2){var i=e[r];e[r]=e[r+1],e[r+1]=i}return e},s.prototype.end=function(){},a.prototype.write=function(t){if(0==t.length)return"";var e=new n(t.length+1),r=0,i=0;for(-1!==this.overflowByte&&(e[0]=t[0],e[1]=this.overflowByte,r=1,i=2);r<t.length-1;r+=2,i+=2)e[i]=t[r+1],e[i+1]=t[r];return this.overflowByte=r==t.length-1?t[t.length-1]:-1,e.slice(0,i).toString("ucs2")},a.prototype.end=function(){},r.utf16=o,o.prototype.encoder=c,o.prototype.decoder=l,c.prototype.write=function(t){return this.encoder.write(t)},c.prototype.end=function(){return this.encoder.end()},l.prototype.write=function(t){if(!this.decoder){if(this.initialBytes.push(t),this.initialBytesLen+=t.length,this.initialBytesLen<16)return"";var e=u(t=n.concat(this.initialBytes),this.options.defaultEncoding);this.decoder=this.iconv.getDecoder(e,this.options),this.initialBytes.length=this.initialBytesLen=0}return this.decoder.write(t)},l.prototype.end=function(){if(!this.decoder){var t=n.concat(this.initialBytes),e=u(t,this.options.defaultEncoding);this.decoder=this.iconv.getDecoder(e,this.options);var r=this.decoder.write(t),i=this.decoder.end();return i?r+i:r}return this.decoder.end()}},{buffer:void 0}],70:[function(t,e,r){"use strict";var n=t("buffer").Buffer;function i(t,e){this.iconv=e}r.utf7=i,r.unicode11utf7="utf7",i.prototype.encoder=a,i.prototype.decoder=o,i.prototype.bomAware=!0;var s=/[^A-Za-z0-9'\(\),-\.\/:\? \n\r\t]+/g;function a(t,e){this.iconv=e.iconv}function o(t,e){this.iconv=e.iconv,this.inBase64=!1,this.base64Accum=""}a.prototype.write=function(t){return new n(t.replace(s,function(t){return"+"+("+"===t?"":this.iconv.encode(t,"utf16-be").toString("base64").replace(/=+$/,""))+"-"}.bind(this)))},a.prototype.end=function(){};for(var c=/[A-Za-z0-9\/+]/,l=[],u=0;u<256;u++)l[u]=c.test(String.fromCharCode(u));var f="+".charCodeAt(0),$="-".charCodeAt(0),h="&".charCodeAt(0);function p(t,e){this.iconv=e}function d(t,e){this.iconv=e.iconv,this.inBase64=!1,this.base64Accum=new n(6),this.base64AccumIdx=0}function _(t,e){this.iconv=e.iconv,this.inBase64=!1,this.base64Accum=""}o.prototype.write=function(t){for(var e="",r=0,i=this.inBase64,s=this.base64Accum,a=0;a<t.length;a++)if(i){if(!l[t[a]]){if(a==r&&t[a]==$)e+="+";else{var o=s+t.slice(r,a).toString();e+=this.iconv.decode(new n(o,"base64"),"utf16-be")}t[a]!=$&&a--,r=a+1,i=!1,s=""}}else t[a]==f&&(e+=this.iconv.decode(t.slice(r,a),"ascii"),r=a+1,i=!0);if(i){var c=(o=s+t.slice(r).toString()).length-o.length%8;s=o.slice(c),o=o.slice(0,c),e+=this.iconv.decode(new n(o,"base64"),"utf16-be")}else e+=this.iconv.decode(t.slice(r),"ascii");return this.inBase64=i,this.base64Accum=s,e},o.prototype.end=function(){var t="";return this.inBase64&&this.base64Accum.length>0&&(t=this.iconv.decode(new n(this.base64Accum,"base64"),"utf16-be")),this.inBase64=!1,this.base64Accum="",t},r.utf7imap=p,p.prototype.encoder=d,p.prototype.decoder=_,p.prototype.bomAware=!0,d.prototype.write=function(t){for(var e=this.inBase64,r=this.base64Accum,i=this.base64AccumIdx,s=new n(5*t.length+10),a=0,o=0;o<t.length;o++){var c=t.charCodeAt(o);32<=c&&c<=126?(e&&(i>0&&(a+=s.write(r.slice(0,i).toString("base64").replace(/\//g,",").replace(/=+$/,""),a),i=0),s[a++]=$,e=!1),e||(s[a++]=c,c===h&&(s[a++]=$))):(e||(s[a++]=h,e=!0),e&&(r[i++]=c>>8,r[i++]=255&c,i==r.length&&(a+=s.write(r.toString("base64").replace(/\//g,","),a),i=0)))}return this.inBase64=e,this.base64AccumIdx=i,s.slice(0,a)},d.prototype.end=function(){var t=new n(10),e=0;return this.inBase64&&(this.base64AccumIdx>0&&(e+=t.write(this.base64Accum.slice(0,this.base64AccumIdx).toString("base64").replace(/\//g,",").replace(/=+$/,""),e),this.base64AccumIdx=0),t[e++]=$,this.inBase64=!1),t.slice(0,e)};var m=l.slice();m[",".charCodeAt(0)]=!0,_.prototype.write=function(t){for(var e="",r=0,i=this.inBase64,s=this.base64Accum,a=0;a<t.length;a++)if(i){if(!m[t[a]]){if(a==r&&t[a]==$)e+="&";else{var o=s+t.slice(r,a).toString().replace(/,/g,"/");e+=this.iconv.decode(new n(o,"base64"),"utf16-be")}t[a]!=$&&a--,r=a+1,i=!1,s=""}}else t[a]==h&&(e+=this.iconv.decode(t.slice(r,a),"ascii"),r=a+1,i=!0);if(i){var c=(o=s+t.slice(r).toString().replace(/,/g,"/")).length-o.length%8;s=o.slice(c),o=o.slice(0,c),e+=this.iconv.decode(new n(o,"base64"),"utf16-be")}else e+=this.iconv.decode(t.slice(r),"ascii");return this.inBase64=i,this.base64Accum=s,e},_.prototype.end=function(){var t="";return this.inBase64&&this.base64Accum.length>0&&(t=this.iconv.decode(new n(this.base64Accum,"base64"),"utf16-be")),this.inBase64=!1,this.base64Accum="",t}},{buffer:void 0}],71:[function(t,e,r){"use strict";function n(t,e){this.encoder=t,this.addBOM=!0}function i(t,e){this.decoder=t,this.pass=!1,this.options=e||{}}r.PrependBOM=n,n.prototype.write=function(t){return this.addBOM&&(t="\ufeff"+t,this.addBOM=!1),this.encoder.write(t)},n.prototype.end=function(){return this.encoder.end()},r.StripBOM=i,i.prototype.write=function(t){var e=this.decoder.write(t);return this.pass||!e?e:("\ufeff"===e[0]&&(e=e.slice(1),"function"==typeof this.options.stripBOM&&this.options.stripBOM()),this.pass=!0,e)},i.prototype.end=function(){return this.decoder.end()}},{}],72:[function(t,e,r){"use strict";var n=t("buffer").Buffer;e.exports=function(e){var r=void 0;e.supportsNodeEncodingsExtension=!(new n(0)instanceof Uint8Array),e.extendNodeEncodings=function(){if(!r){if(r={},!e.supportsNodeEncodingsExtension)return console.error("ACTION NEEDED: require('iconv-lite').extendNodeEncodings() is not supported in your version of Node"),void console.error("See more info at https://github.com/ashtuchkin/iconv-lite/wiki/Node-v4-compatibility");var i={hex:!0,utf8:!0,"utf-8":!0,ascii:!0,binary:!0,base64:!0,ucs2:!0,"ucs-2":!0,utf16le:!0,"utf-16le":!0};n.isNativeEncoding=function(t){return t&&i[t.toLowerCase()]};var s=t("buffer").SlowBuffer;if(r.SlowBufferToString=s.prototype.toString,s.prototype.toString=function(t,i,s){return t=String(t||"utf8").toLowerCase(),n.isNativeEncoding(t)?r.SlowBufferToString.call(this,t,i,s):(void 0===i&&(i=0),void 0===s&&(s=this.length),e.decode(this.slice(i,s),t))},r.SlowBufferWrite=s.prototype.write,s.prototype.write=function(t,i,s,a){if(isFinite(i))isFinite(s)||(a=s,s=void 0);else{var o=a;a=i,i=s,s=o}i=+i||0;var c=this.length-i;if(s?(s=+s)>c&&(s=c):s=c,a=String(a||"utf8").toLowerCase(),n.isNativeEncoding(a))return r.SlowBufferWrite.call(this,t,i,s,a);if(t.length>0&&(s<0||i<0))throw new RangeError("attempt to write beyond buffer bounds");var l=e.encode(t,a);return l.length<s&&(s=l.length),l.copy(this,i,0,s),s},r.BufferIsEncoding=n.isEncoding,n.isEncoding=function(t){return n.isNativeEncoding(t)||e.encodingExists(t)},r.BufferByteLength=n.byteLength,n.byteLength=s.byteLength=function(t,i){return i=String(i||"utf8").toLowerCase(),n.isNativeEncoding(i)?r.BufferByteLength.call(this,t,i):e.encode(t,i).length},r.BufferToString=n.prototype.toString,n.prototype.toString=function(t,i,s){return t=String(t||"utf8").toLowerCase(),n.isNativeEncoding(t)?r.BufferToString.call(this,t,i,s):(void 0===i&&(i=0),void 0===s&&(s=this.length),e.decode(this.slice(i,s),t))},r.BufferWrite=n.prototype.write,n.prototype.write=function(t,i,s,a){var o=i,c=s,l=a;if(isFinite(i))isFinite(s)||(a=s,s=void 0);else{var u=a;a=i,i=s,s=u}if(a=String(a||"utf8").toLowerCase(),n.isNativeEncoding(a))return r.BufferWrite.call(this,t,o,c,l);i=+i||0;var f=this.length-i;if(s?(s=+s)>f&&(s=f):s=f,t.length>0&&(s<0||i<0))throw new RangeError("attempt to write beyond buffer bounds");var $=e.encode(t,a);return $.length<s&&(s=$.length),$.copy(this,i,0,s),s},e.supportsStreams){var a=t("stream").Readable;r.ReadableSetEncoding=a.prototype.setEncoding,a.prototype.setEncoding=function(t,r){this._readableState.decoder=e.getDecoder(t,r),this._readableState.encoding=t},a.prototype.collect=e._collect}}},e.undoExtendNodeEncodings=function(){if(e.supportsNodeEncodingsExtension){if(!r)throw new Error("require('iconv-lite').undoExtendNodeEncodings(): Nothing to undo; extendNodeEncodings() is not called.");delete n.isNativeEncoding;var i=t("buffer").SlowBuffer;if(i.prototype.toString=r.SlowBufferToString,i.prototype.write=r.SlowBufferWrite,n.isEncoding=r.BufferIsEncoding,n.byteLength=r.BufferByteLength,n.prototype.toString=r.BufferToString,n.prototype.write=r.BufferWrite,e.supportsStreams){var s=t("stream").Readable;s.prototype.setEncoding=r.ReadableSetEncoding,delete s.prototype.collect}r=void 0}}}},{buffer:void 0,stream:void 0}],73:[function(t,e,r){"use strict";var n=t("buffer").Buffer,i=t("./bom-handling"),s=e.exports;s.encodings=null,s.defaultCharUnicode="",s.defaultCharSingleByte="?",s.encode=function(t,e,r){t=""+(t||"");var i=s.getEncoder(e,r),a=i.write(t),o=i.end();return o&&o.length>0?n.concat([a,o]):a},s.decode=function(t,e,r){"string"==typeof t&&(s.skipDecodeWarning||(console.error("Iconv-lite warning: decode()-ing strings is deprecated. Refer to https://github.com/ashtuchkin/iconv-lite/wiki/Use-Buffers-when-decoding"),s.skipDecodeWarning=!0),t=new n(""+(t||""),"binary"));var i=s.getDecoder(e,r),a=i.write(t),o=i.end();return o?a+o:a},s.encodingExists=function(t){try{return s.getCodec(t),!0}catch(t){return!1}},s.toEncoding=s.encode,s.fromEncoding=s.decode,s._codecDataCache={},s.getCodec=function(e){s.encodings||(s.encodings=t("../encodings"));for(var r=(""+e).toLowerCase().replace(/[^0-9a-z]|:\d{4}$/g,""),n={};;){var i=s._codecDataCache[r];if(i)return i;var a=s.encodings[r];switch(typeof a){case"string":r=a;break;case"object":for(var o in a)n[o]=a[o];n.encodingName||(n.encodingName=r),r=a.type;break;case"function":return n.encodingName||(n.encodingName=r),i=new a(n,s),s._codecDataCache[n.encodingName]=i,i;default:throw new Error("Encoding not recognized: '"+e+"' (searched as: '"+r+"')")}}},s.getEncoder=function(t,e){var r=s.getCodec(t),n=new r.encoder(e,r);return r.bomAware&&e&&e.addBOM&&(n=new i.PrependBOM(n,e)),n},s.getDecoder=function(t,e){var r=s.getCodec(t),n=new r.decoder(e,r);return!r.bomAware||e&&!1===e.stripBOM||(n=new i.StripBOM(n,e)),n};var a="undefined"!=typeof process&&process.versions&&process.versions.node;if(a){var o=a.split(".").map(Number);(o[0]>0||o[1]>=10)&&t("./streams")(s),t("./extend-node")(s)}},{"../encodings":56,"./bom-handling":71,"./extend-node":72,"./streams":74,buffer:void 0}],74:[function(t,e,r){"use strict";var n=t("buffer").Buffer,i=t("stream").Transform;function s(t,e){this.conv=t,(e=e||{}).decodeStrings=!1,i.call(this,e)}function a(t,e){this.conv=t,(e=e||{}).encoding=this.encoding="utf8",i.call(this,e)}e.exports=function(t){t.encodeStream=function(e,r){return new s(t.getEncoder(e,r),r)},t.decodeStream=function(e,r){return new a(t.getDecoder(e,r),r)},t.supportsStreams=!0,t.IconvLiteEncoderStream=s,t.IconvLiteDecoderStream=a,t._collect=a.prototype.collect},s.prototype=Object.create(i.prototype,{constructor:{value:s}}),s.prototype._transform=function(t,e,r){if("string"!=typeof t)return r(new Error("Iconv encoding stream needs strings as its input."));try{var n=this.conv.write(t);n&&n.length&&this.push(n),r()}catch(t){r(t)}},s.prototype._flush=function(t){try{var e=this.conv.end();e&&e.length&&this.push(e),t()}catch(e){t(e)}},s.prototype.collect=function(t){var e=[];return this.on("error",t),this.on("data",function(t){e.push(t)}),this.on("end",function(){t(null,n.concat(e))}),this},a.prototype=Object.create(i.prototype,{constructor:{value:a}}),a.prototype._transform=function(t,e,r){if(!n.isBuffer(t))return r(new Error("Iconv decoding stream needs buffers as its input."));try{var i=this.conv.write(t);i&&i.length&&this.push(i,this.encoding),r()}catch(t){r(t)}},a.prototype._flush=function(t){try{var e=this.conv.end();e&&e.length&&this.push(e,this.encoding),t()}catch(e){t(e)}},a.prototype.collect=function(t){var e="";return this.on("error",t),this.on("data",function(t){e+=t}),this.on("end",function(){t(null,e)}),this}},{buffer:void 0,stream:void 0}],75:[function(t,e,r){var n=t("wrappy"),i=Object.create(null),s=t("once");e.exports=n(function(t,e){return i[t]?(i[t].push(e),null):(i[t]=[e],function(t){return s(function e(){var r=i[t],n=r.length,s=function(t){for(var e=t.length,r=[],n=0;n<e;n++)r[n]=t[n];return r}(arguments);try{for(var a=0;a<n;a++)r[a].apply(null,s)}finally{r.length>n?(r.splice(0,n),process.nextTick(function(){e.apply(null,s)})):delete i[t]}})}(t))})},{once:83,wrappy:86}],76:[function(t,e,r){try{var n=t("util");if("function"!=typeof n.inherits)throw"";e.exports=n.inherits}catch(r){e.exports=t("./inherits_browser.js")}},{"./inherits_browser.js":77,util:void 0}],77:[function(t,e,r){"function"==typeof Object.create?e.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(t,e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}},{}],78:[function(t,e,r){var n="undefined"!=typeof JSON?JSON:t("jsonify");e.exports=function(t,e){e||(e={}),"function"==typeof e&&(e={cmp:e});var r=e.space||"";"number"==typeof r&&(r=Array(r+1).join(" "));var a,o="boolean"==typeof e.cycles&&e.cycles,c=e.replacer||function(t,e){return e},l=e.cmp&&(a=e.cmp,function(t){return function(e,r){var n={key:e,value:t[e]},i={key:r,value:t[r]};return a(n,i)}}),u=[];return function t(e,a,f,$){var h=r?"\n"+new Array($+1).join(r):"",p=r?": ":":";if(f&&f.toJSON&&"function"==typeof f.toJSON&&(f=f.toJSON()),void 0!==(f=c.call(e,a,f))){if("object"!=typeof f||null===f)return n.stringify(f);if(i(f)){for(var d=[],_=0;_<f.length;_++){var m=t(f,_,f[_],$+1)||n.stringify(null);d.push(h+r+m)}return"["+d.join(",")+h+"]"}if(-1!==u.indexOf(f)){if(o)return n.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}u.push(f);var y=s(f).sort(l&&l(f));for(d=[],_=0;_<y.length;_++){var g=t(f,a=y[_],f[a],$+1);if(g){var v=n.stringify(a)+p+g;d.push(h+r+v)}}return u.splice(u.indexOf(f),1),"{"+d.join(",")+h+"}"}}({"":t},"",t,0)};var i=Array.isArray||function(t){return"[object Array]"==={}.toString.call(t)},s=Object.keys||function(t){var e=Object.prototype.hasOwnProperty||function(){return!0},r=[];for(var n in t)e.call(t,n)&&r.push(n);return r}},{jsonify:79}],79:[function(t,e,r){r.parse=t("./lib/parse"),r.stringify=t("./lib/stringify")},{"./lib/parse":80,"./lib/stringify":81}],80:[function(t,e,r){var n,i,s,a,o={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},c=function(t){throw{name:"SyntaxError",message:t,at:n,text:s}},l=function(t){return t&&t!==i&&c("Expected '"+t+"' instead of '"+i+"'"),i=s.charAt(n),n+=1,i},u=function(){var t,e="";for("-"===i&&(e="-",l("-"));i>="0"&&i<="9";)e+=i,l();if("."===i)for(e+=".";l()&&i>="0"&&i<="9";)e+=i;if("e"===i||"E"===i)for(e+=i,l(),"-"!==i&&"+"!==i||(e+=i,l());i>="0"&&i<="9";)e+=i,l();if(t=+e,isFinite(t))return t;c("Bad number")},f=function(){var t,e,r,n="";if('"'===i)for(;l();){if('"'===i)return l(),n;if("\\"===i)if(l(),"u"===i){for(r=0,e=0;e<4&&(t=parseInt(l(),16),isFinite(t));e+=1)r=16*r+t;n+=String.fromCharCode(r)}else{if("string"!=typeof o[i])break;n+=o[i]}else n+=i}c("Bad string")},$=function(){for(;i&&i<=" ";)l()};a=function(){switch($(),i){case"{":return function(){var t,e={};if("{"===i){if(l("{"),$(),"}"===i)return l("}"),e;for(;i;){if(t=f(),$(),l(":"),Object.hasOwnProperty.call(e,t)&&c('Duplicate key "'+t+'"'),e[t]=a(),$(),"}"===i)return l("}"),e;l(","),$()}}c("Bad object")}();case"[":return function(){var t=[];if("["===i){if(l("["),$(),"]"===i)return l("]"),t;for(;i;){if(t.push(a()),$(),"]"===i)return l("]"),t;l(","),$()}}c("Bad array")}();case'"':return f();case"-":return u();default:return i>="0"&&i<="9"?u():function(){switch(i){case"t":return l("t"),l("r"),l("u"),l("e"),!0;case"f":return l("f"),l("a"),l("l"),l("s"),l("e"),!1;case"n":return l("n"),l("u"),l("l"),l("l"),null}c("Unexpected '"+i+"'")}()}},e.exports=function(t,e){var r;return s=t,n=0,i=" ",r=a(),$(),i&&c("Syntax error"),"function"==typeof e?function t(r,n){var i,s,a=r[n];if(a&&"object"==typeof a)for(i in a)Object.prototype.hasOwnProperty.call(a,i)&&(void 0!==(s=t(a,i))?a[i]=s:delete a[i]);return e.call(r,n,a)}({"":r},""):r}},{}],81:[function(t,e,r){var n,i,s,a=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,o={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function c(t){return a.lastIndex=0,a.test(t)?'"'+t.replace(a,function(t){var e=o[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}e.exports=function(t,e,r){var a;if(n="",i="","number"==typeof r)for(a=0;a<r;a+=1)i+=" ";else"string"==typeof r&&(i=r);if(s=e,e&&"function"!=typeof e&&("object"!=typeof e||"number"!=typeof e.length))throw new Error("JSON.stringify");return function t(e,r){var a,o,l,u,f,$=n,h=r[e];switch(h&&"object"==typeof h&&"function"==typeof h.toJSON&&(h=h.toJSON(e)),"function"==typeof s&&(h=s.call(r,e,h)),typeof h){case"string":return c(h);case"number":return isFinite(h)?String(h):"null";case"boolean":case"null":return String(h);case"object":if(!h)return"null";if(n+=i,f=[],"[object Array]"===Object.prototype.toString.apply(h)){for(u=h.length,a=0;a<u;a+=1)f[a]=t(a,h)||"null";return l=0===f.length?"[]":n?"[\n"+n+f.join(",\n"+n)+"\n"+$+"]":"["+f.join(",")+"]",n=$,l}if(s&&"object"==typeof s)for(u=s.length,a=0;a<u;a+=1)"string"==typeof(o=s[a])&&(l=t(o,h))&&f.push(c(o)+(n?": ":":")+l);else for(o in h)Object.prototype.hasOwnProperty.call(h,o)&&(l=t(o,h))&&f.push(c(o)+(n?": ":":")+l);return l=0===f.length?"{}":n?"{\n"+n+f.join(",\n"+n)+"\n"+$+"}":"{"+f.join(",")+"}",n=$,l}}("",{"":t})}},{}],82:[function(t,e,r){e.exports=p,p.Minimatch=d;var n={sep:"/"};try{n=t("path")}catch(t){}var i=p.GLOBSTAR=d.GLOBSTAR={},s=t("brace-expansion"),a={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},o="[^/]",c=o+"*?",l="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",u="(?:(?!(?:\\/|^)\\.).)*?",f="().*{}+?[]^$\\!".split("").reduce(function(t,e){return t[e]=!0,t},{});var $=/\/+/;function h(t,e){t=t||{},e=e||{};var r={};return Object.keys(e).forEach(function(t){r[t]=e[t]}),Object.keys(t).forEach(function(e){r[e]=t[e]}),r}function p(t,e,r){if("string"!=typeof e)throw new TypeError("glob pattern string required");return r||(r={}),!(!r.nocomment&&"#"===e.charAt(0))&&(""===e.trim()?""===t:new d(e,r).match(t))}function d(t,e){if(!(this instanceof d))return new d(t,e);if("string"!=typeof t)throw new TypeError("glob pattern string required");e||(e={}),t=t.trim(),"/"!==n.sep&&(t=t.split(n.sep).join("/")),this.options=e,this.set=[],this.pattern=t,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.make()}function _(t,e){if(e||(e=this instanceof d?this.options:{}),void 0===(t=void 0===t?this.pattern:t))throw new TypeError("undefined pattern");return e.nobrace||!t.match(/\{.*\}/)?[t]:s(t)}p.filter=function(t,e){return e=e||{},function(r,n,i){return p(r,t,e)}},p.defaults=function(t){if(!t||!Object.keys(t).length)return p;var e=p,r=function(r,n,i){return e.minimatch(r,n,h(t,i))};return r.Minimatch=function(r,n){return new e.Minimatch(r,h(t,n))},r},d.defaults=function(t){return t&&Object.keys(t).length?p.defaults(t).Minimatch:d},d.prototype.debug=function(){},d.prototype.make=function(){if(this._made)return;var t=this.pattern,e=this.options;if(!e.nocomment&&"#"===t.charAt(0))return void(this.comment=!0);if(!t)return void(this.empty=!0);this.parseNegate();var r=this.globSet=this.braceExpand();e.debug&&(this.debug=console.error);this.debug(this.pattern,r),r=this.globParts=r.map(function(t){return t.split($)}),this.debug(this.pattern,r),r=r.map(function(t,e,r){return t.map(this.parse,this)},this),this.debug(this.pattern,r),r=r.filter(function(t){return-1===t.indexOf(!1)}),this.debug(this.pattern,r),this.set=r},d.prototype.parseNegate=function(){var t=this.pattern,e=!1,r=this.options,n=0;if(r.nonegate)return;for(var i=0,s=t.length;i<s&&"!"===t.charAt(i);i++)e=!e,n++;n&&(this.pattern=t.substr(n));this.negate=e},p.braceExpand=function(t,e){return _(t,e)},d.prototype.braceExpand=_,d.prototype.parse=function(t,e){if(t.length>65536)throw new TypeError("pattern is too long");var r=this.options;if(!r.noglobstar&&"**"===t)return i;if(""===t)return"";var n,s="",l=!!r.nocase,u=!1,$=[],h=[],p=!1,d=-1,_=-1,y="."===t.charAt(0)?"":r.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",g=this;function v(){if(n){switch(n){case"*":s+=c,l=!0;break;case"?":s+=o,l=!0;break;default:s+="\\"+n}g.debug("clearStateChar %j %j",n,s),n=!1}}for(var b,A=0,x=t.length;A<x&&(b=t.charAt(A));A++)if(this.debug("%s\t%s %s %j",t,A,s,b),u&&f[b])s+="\\"+b,u=!1;else switch(b){case"/":return!1;case"\\":v(),u=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s\t%s %s %j <-- stateChar",t,A,s,b),p){this.debug("  in class"),"!"===b&&A===_+1&&(b="^"),s+=b;continue}g.debug("call clearStateChar %j",n),v(),n=b,r.noext&&v();continue;case"(":if(p){s+="(";continue}if(!n){s+="\\(";continue}$.push({type:n,start:A-1,reStart:s.length,open:a[n].open,close:a[n].close}),s+="!"===n?"(?:(?!(?:":"(?:",this.debug("plType %j %j",n,s),n=!1;continue;case")":if(p||!$.length){s+="\\)";continue}v(),l=!0;var w=$.pop();s+=w.close,"!"===w.type&&h.push(w),w.reEnd=s.length;continue;case"|":if(p||!$.length||u){s+="\\|",u=!1;continue}v(),s+="|";continue;case"[":if(v(),p){s+="\\"+b;continue}p=!0,_=A,d=s.length,s+=b;continue;case"]":if(A===_+1||!p){s+="\\"+b,u=!1;continue}if(p){var k=t.substring(_+1,A);try{RegExp("["+k+"]")}catch(t){var E=this.parse(k,m);s=s.substr(0,d)+"\\["+E[0]+"\\]",l=l||E[1],p=!1;continue}}l=!0,p=!1,s+=b;continue;default:v(),u?u=!1:!f[b]||"^"===b&&p||(s+="\\"),s+=b}p&&(k=t.substr(_+1),E=this.parse(k,m),s=s.substr(0,d)+"\\["+E[0],l=l||E[1]);for(w=$.pop();w;w=$.pop()){var S=s.slice(w.reStart+w.open.length);this.debug("setting tail",s,w),S=S.replace(/((?:\\{2}){0,64})(\\?)\|/g,function(t,e,r){return r||(r="\\"),e+e+r+"|"}),this.debug("tail=%j\n   %s",S,S,w,s);var N="*"===w.type?c:"?"===w.type?o:"\\"+w.type;l=!0,s=s.slice(0,w.reStart)+N+"\\("+S}v(),u&&(s+="\\\\");var I=!1;switch(s.charAt(0)){case".":case"[":case"(":I=!0}for(var C=h.length-1;C>-1;C--){var O=h[C],B=s.slice(0,O.reStart),M=s.slice(O.reStart,O.reEnd-8),P=s.slice(O.reEnd-8,O.reEnd),F=s.slice(O.reEnd);P+=F;var L=B.split("(").length-1,T=F;for(A=0;A<L;A++)T=T.replace(/\)[+*?]?/,"");var j="";""===(F=T)&&e!==m&&(j="$");var R=B+M+F+j+P;s=R}""!==s&&l&&(s="(?=.)"+s);I&&(s=y+s);if(e===m)return[s,l];if(!l)return t.replace(/\\(.)/g,"$1");var D=r.nocase?"i":"";try{var z=new RegExp("^"+s+"$",D)}catch(t){return new RegExp("$.")}return z._glob=t,z._src=s,z};var m={};p.makeRe=function(t,e){return new d(t,e||{}).makeRe()},d.prototype.makeRe=function(){if(this.regexp||!1===this.regexp)return this.regexp;var t=this.set;if(!t.length)return this.regexp=!1,this.regexp;var e=this.options,r=e.noglobstar?c:e.dot?l:u,n=e.nocase?"i":"",s=t.map(function(t){return t.map(function(t){return t===i?r:"string"==typeof t?t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"):t._src}).join("\\/")}).join("|");s="^(?:"+s+")$",this.negate&&(s="^(?!"+s+").*$");try{this.regexp=new RegExp(s,n)}catch(t){this.regexp=!1}return this.regexp},p.match=function(t,e,r){var n=new d(e,r=r||{});return t=t.filter(function(t){return n.match(t)}),n.options.nonull&&!t.length&&t.push(e),t},d.prototype.match=function(t,e){if(this.debug("match",t,this.pattern),this.comment)return!1;if(this.empty)return""===t;if("/"===t&&e)return!0;var r=this.options;"/"!==n.sep&&(t=t.split(n.sep).join("/"));t=t.split($),this.debug(this.pattern,"split",t);var i,s,a=this.set;for(this.debug(this.pattern,"set",a),s=t.length-1;s>=0&&!(i=t[s]);s--);for(s=0;s<a.length;s++){var o=a[s],c=t;r.matchBase&&1===o.length&&(c=[i]);var l=this.matchOne(c,o,e);if(l)return!!r.flipNegate||!this.negate}return!r.flipNegate&&this.negate},d.prototype.matchOne=function(t,e,r){var n=this.options;this.debug("matchOne",{this:this,file:t,pattern:e}),this.debug("matchOne",t.length,e.length);for(var s=0,a=0,o=t.length,c=e.length;s<o&&a<c;s++,a++){this.debug("matchOne loop");var l,u=e[a],f=t[s];if(this.debug(e,u,f),!1===u)return!1;if(u===i){this.debug("GLOBSTAR",[e,u,f]);var $=s,h=a+1;if(h===c){for(this.debug("** at the end");s<o;s++)if("."===t[s]||".."===t[s]||!n.dot&&"."===t[s].charAt(0))return!1;return!0}for(;$<o;){var p=t[$];if(this.debug("\nglobstar while",t,$,e,h,p),this.matchOne(t.slice($),e.slice(h),r))return this.debug("globstar found match!",$,o,p),!0;if("."===p||".."===p||!n.dot&&"."===p.charAt(0)){this.debug("dot detected!",t,$,e,h);break}this.debug("globstar swallow a segment, and continue"),$++}return!(!r||(this.debug("\n>>> no match, partial?",t,$,e,h),$!==o))}if("string"==typeof u?(l=n.nocase?f.toLowerCase()===u.toLowerCase():f===u,this.debug("string match",u,f,l)):(l=f.match(u),this.debug("pattern match",u,f,l)),!l)return!1}if(s===o&&a===c)return!0;if(s===o)return r;if(a===c)return s===o-1&&""===t[s];throw new Error("wtf?")}},{"brace-expansion":44,path:void 0}],83:[function(t,e,r){var n=t("wrappy");function i(t){var e=function(){return e.called?e.value:(e.called=!0,e.value=t.apply(this,arguments))};return e.called=!1,e}function s(t){var e=function(){if(e.called)throw new Error(e.onceError);return e.called=!0,e.value=t.apply(this,arguments)},r=t.name||"Function wrapped with `once`";return e.onceError=r+" shouldn't be called more than once",e.called=!1,e}e.exports=n(i),e.exports.strict=n(s),i.proto=i(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return i(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return s(this)},configurable:!0})})},{wrappy:86}],84:[function(t,e,r){"use strict";function n(t){return"/"===t.charAt(0)}function i(t){var e=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/.exec(t),r=e[1]||"",n=Boolean(r&&":"!==r.charAt(1));return Boolean(e[2]||n)}e.exports="win32"===process.platform?i:n,e.exports.posix=n,e.exports.win32=i},{}],85:[function(t,e,r){const n=t("url"),i=t("fs");t("path");r.XMLHttpRequest=function(){"use strict";const e=this,r=t("http"),s=t("https");let a,o,c={},l=!1;const u={"User-Agent":"node-XMLHttpRequest",Accept:"*/*"};let f={};const $={},h=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","content-transfer-encoding","cookie","cookie2","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","via"],p=["TRACE","TRACK","CONNECT"];let d=!1,_=!1;const m={};this.UNSENT=0,this.OPENED=1,this.HEADERS_RECEIVED=2,this.LOADING=3,this.DONE=4,this.readyState=this.UNSENT,this.onreadystatechange=null,this.responseText="",this.responseXML="",this.status=null,this.statusText=null,this.withCredentials=!1,this.responseType="";this.open=function(t,e,r,n,i){if(this.abort(),_=!1,!function(t){return t&&-1===p.indexOf(t)}(t))throw new Error("SecurityError: Request method not allowed");c={method:t,url:e.toString(),async:"boolean"!=typeof r||r,user:n||null,password:i||null},y(this.OPENED)},this.setDisableHeaderCheck=function(t){l=t},this.setRequestHeader=function(t,e){if(this.readyState!==this.OPENED)throw new Error("INVALID_STATE_ERR: setRequestHeader can only be called when state is OPEN");if(function(t){return l||t&&-1===h.indexOf(t.toLowerCase())}(t)){if(d)throw new Error("INVALID_STATE_ERR: send flag is true");t=$[t.toLowerCase()]||t,$[t.toLowerCase()]=t,f[t]=f[t]?f[t]+", "+e:e}else console.warn('Refused to set unsafe header "'+t+'"')},this.getResponseHeader=function(t){return"string"==typeof t&&this.readyState>this.OPENED&&o&&o.headers&&o.headers[t.toLowerCase()]&&!_?o.headers[t.toLowerCase()]:null},this.getAllResponseHeaders=function(){if(this.readyState<this.HEADERS_RECEIVED||_)return"";let t="";for(let e in o.headers)"set-cookie"!==e&&"set-cookie2"!==e&&(t+=e+": "+o.headers[e]+"\r\n");return t.substr(0,t.length-2)},this.getRequestHeader=function(t){return"string"==typeof t&&$[t.toLowerCase()]?f[$[t.toLowerCase()]]:""},this.send=function(l){if(this.readyState!==this.OPENED)throw new Error("INVALID_STATE_ERR: connection must be opened before send() is called");if(d)throw new Error("INVALID_STATE_ERR: send has already been called");let h=!1,p=!1;const m=n.parse(c.url);let g;switch(m.protocol){case"https:":h=!0,g=m.hostname;break;case"http:":g=m.hostname;break;case"file:":p=!0;break;case void 0:case null:case"":g="localhost";break;default:throw new Error("Protocol not supported.")}if(p){if("GET"!==c.method)throw new Error("XMLHttpRequest: Only GET method is supported");if(c.async)i.readFile(m.pathname,"utf8",function(t,r){t?e.handleError(t):(e.status=200,e.responseText=r,y(e.DONE))});else try{this.responseText=i.readFileSync(m.pathname,"utf8"),this.status=200,y(e.DONE)}catch(t){this.handleError(t)}return}const v=m.port||(h?443:80),b=m.pathname+(m.search?m.search:"");for(let t in u)$[t.toLowerCase()]||(f[t]=u[t]);if(f.Host=g,"["===m.host[0]&&(f.Host="["+f.Host+"]"),h&&443===v||80===v||(f.Host+=":"+m.port),c.user){void 0===c.password&&(c.password="");const t=Buffer.from(c.user+":"+c.password);f.Authorization="Basic "+t.toString("base64")}"GET"===c.method||"HEAD"===c.method?l=null:l?(f["Content-Length"]=Buffer.isBuffer(l)?l.length:Buffer.byteLength(l),this.getRequestHeader("Content-Type")||(f["Content-Type"]="text/plain;charset=UTF-8")):"POST"===c.method&&(f["Content-Length"]=0);const A={host:g,port:v,path:b,method:c.method,headers:f,agent:!1,withCredentials:e.withCredentials},x=this.responseType||"text";if(_=!1,c.async){var w=h?s.request:r.request;d=!0,e.dispatchEvent("readystatechange");const t=function t(r){if(301!==(o=r).statusCode&&302!==o.statusCode&&303!==o.statusCode&&307!==o.statusCode)o.setEncoding("utf8"),y(e.HEADERS_RECEIVED),e.status=o.statusCode,o.on("data",function(t){t&&(e.responseText+=t),d&&y(e.LOADING)}),o.on("end",function(){d&&(y(e.DONE),d=!1)}),o.on("error",function(t){e.handleError(t)});else{c.url=o.headers.location;const r=n.parse(c.url);g=r.hostname;const s={hostname:r.hostname,port:r.port,path:r.path,method:303===o.statusCode?"GET":c.method,headers:f,withCredentials:e.withCredentials};(a=w(s,t).on("error",i)).end()}},i=function(t){e.handleError(t)};a=w(A,t).on("error",i),l&&a.write(l),a.end(),e.dispatchEvent("loadstart")}else{const r="text"===x?"utf8":"binary",n=t("child_process").execSync(`"${process.argv[0]}" "${__dirname}/request.js" --ssl="${h}" --encoding="${r}" --request-options=${JSON.stringify(JSON.stringify(A))}`,{stdio:"pipe"}),i=JSON.parse(n.toString("utf8"));i.error?e.handleError(i.error):(o=i.data,e.status=i.data.statusCode,"binary"===r?e.response=Uint8Array.from(i.data.binary.data).buffer:e.responseText=i.data.text,y(e.DONE))}},this.handleError=function(t){this.status=0,this.statusText=t,this.responseText=t.stack,_=!0,y(this.DONE),this.dispatchEvent("error")},this.abort=function(){a&&(a.abort(),a=null),f=u,this.status=0,this.responseText="",this.responseXML="",_=!0,this.readyState===this.UNSENT||this.readyState===this.OPENED&&!d||this.readyState===this.DONE||(d=!1,y(this.DONE)),this.readyState=this.UNSENT,this.dispatchEvent("abort")},this.addEventListener=function(t,e){t in m||(m[t]=[]),m[t].push(e)},this.removeEventListener=function(t,e){t in m&&(m[t]=m[t].filter(function(t){return t!==e}))},this.dispatchEvent=function(t){if("function"==typeof e["on"+t]&&e["on"+t](),t in m)for(let r=0,n=m[t].length;r<n;r++)m[t][r].call(e)};const y=function(t){t!==e.LOADING&&e.readyState===t||(e.readyState=t,(c.async||e.readyState<e.OPENED||e.readyState===e.DONE)&&e.dispatchEvent("readystatechange"),e.readyState!==e.DONE||_||(e.dispatchEvent("load"),e.dispatchEvent("loadend")))}}},{child_process:void 0,fs:void 0,http:void 0,https:void 0,path:void 0,url:void 0}],86:[function(t,e,r){e.exports=function t(e,r){if(e&&r)return t(e)(r);if("function"!=typeof e)throw new TypeError("need wrapper function");Object.keys(e).forEach(function(t){n[t]=e[t]});return n;function n(){for(var t=new Array(arguments.length),r=0;r<t.length;r++)t[r]=arguments[r];var n=e.apply(this,t),i=t[t.length-1];return"function"==typeof n&&n!==i&&Object.keys(i).forEach(function(t){n[t]=i[t]}),n}}},{}],87:[function(require,module,exports){navigator={},function(t){var e,r,n,i,s,a,o=this;if("undefined"!=typeof global&&(o=global),"undefined"!=typeof window&&(o=window),"log"in(e="object"==typeof o.console?o.console:null==o.console?o.console={}:{})||(e.log=function(){}),"warn"in e||(e.warn=e.log),void 0!==this.Opal)return e.warn("Opal already loaded. Loading twice can cause troubles, please fix your setup."),this.Opal;var c=this.Opal={};c.global=o,o.Opal=c,c.config={missing_require_severity:"error",unsupported_features_severity:"warning",enable_stack_trace:!0};var l=Object.hasOwnProperty,u=Function.prototype.bind,f=Object.setPrototypeOf,$=Array.prototype.slice,h=Array.prototype.splice,p=4;function d(t,e,r){"string"==typeof t?t[e]=r:Object.defineProperty(t,e,{value:r,enumerable:!1,configurable:!0,writable:!0})}function _(t,e){if(t)return t.$$const[e]}function m(t,e){var r,n,i;if(null!=t)for(r=0,n=(i=c.ancestors(t)).length;r<n;r++)if(i[r].$$const&&l.call(i[r].$$const,e))return i[r].$$const[e]}function y(t,e,r){if(!r)return(t||i).$const_missing(e)}function g(t){return t.hasOwnProperty("$$iclass")&&t.hasOwnProperty("$$root")}function v(t){var e=b(t);return t.$$is_module&&t.$$iclasses.push(e),e}function b(t){var e={},r=t.$$prototype;r.hasOwnProperty("$$dummy")&&(r=r.$$define_methods_on);var n,i=Object.getOwnPropertyNames(r),s=i.length;for(n=0;n<s;n++){var a=i[n];d(e,a,r[a])}return d(e,"$$iclass",!0),d(e,"$$module",t),e}function A(t){var e=t.length,r=t[0];if(d(r,"$$root",!0),1===e)return{first:r,last:r};for(var n=r,i=1;i<e;i++){var s=t[i];f(n,s),n=s}return{first:t[0],last:t[e-1]}}function x(t){if(!t.hasOwnProperty("$$dummy"))return t.hasOwnProperty("$$iclass")?t.$$module:t.hasOwnProperty("$$class")?t.$$class:void 0}function w(t){return"function"==typeof t&&!t.$$stub}c.uid=function(){return p+=2},c.id=function(t){return t.$$is_number?2*t+1:null!=t.$$id?t.$$id:(d(t,"$$id",c.uid()),t.$$id)},c.gvars={},c.exit=function(t){c.gvars.DEBUG&&e.log("Exited with status "+t)},c.exceptions=[],c.pop_exception=function(){c.gvars["!"]=c.exceptions.pop()||r},c.inspect=function(e){return e===t?"undefined":null===e?"null":e.$$class?e.$inspect():e.toString()},c.defineProperty=d,c.slice=$,c.truthy=function(t){return t!==r&&null!=t&&(!t.$$is_boolean||1==t)},c.falsy=function(t){return t===r||null==t||t.$$is_boolean&&0==t},c.const_get_local=function(t,e,r){var n;if(null!=t){if("::"===t&&(t=i),!t.$$is_module&&!t.$$is_class)throw new c.TypeError(t.toString()+" is not a class/module");return null!=(n=_(t,e))?n:null!=(n=y(t,e,r))?n:void 0}},c.const_get_qualified=function(t,e,r){var n,s,a,o=c.const_cache_version;if(null!=t){if("::"===t&&(t=i),!t.$$is_module&&!t.$$is_class)throw new c.TypeError(t.toString()+" is not a class/module");return null==(s=t.$$const_cache)&&(d(t,"$$const_cache",Object.create(null)),s=t.$$const_cache),null==(a=s[e])||a[0]!==o?(null!=(n=_(t,e))||(n=m(t,e)),s[e]=[o,n]):n=a[1],null!=n?n:y(t,e,r)}},c.const_cache_version=1,c.const_get_relative=function(t,e,r){var n,s,a,o=t[0],l=c.const_cache_version;return null==(s=t.$$const_cache)&&(d(t,"$$const_cache",Object.create(null)),s=t.$$const_cache),null==(a=s[e])||a[0]!==l?(null!=(n=_(o,e))||null!=(n=function(t,e){var r,n,i;if(0!==t.length)for(r=0,n=t.length;r<n;r++)if(null!=(i=t[r].$$const[e]))return i}(t,e))||null!=(n=m(o,e))||(n=function(t,e){if(null==t||t.$$is_module)return m(i,e)}(o,e)),s[e]=[l,n]):n=a[1],null!=n?n:y(o,e,r)},c.const_set=function(t,e,n){return null!=t&&"::"!==t||(t=i),n.$$is_a_module&&(null!=n.$$name&&n.$$name!==r||(n.$$name=e),null==n.$$base_module&&(n.$$base_module=t)),t.$$const=t.$$const||Object.create(null),t.$$const[e]=n,t.$$=t.$$const,c.const_cache_version++,t===i&&(c[e]=n),d(t,e,n),n},c.constants=function(t,e){null==e&&(e=!0);var r,n,s,a,o=[t],l={};for(e&&(o=o.concat(c.ancestors(t))),e&&t.$$is_module&&(o=o.concat([c.Object]).concat(c.ancestors(c.Object))),n=0,s=o.length;n<s&&(r=o[n],t===i||r!=i);n++)for(a in r.$$const)l[a]=!0;return Object.keys(l)},c.const_remove=function(t,e){if(c.const_cache_version++,null!=t.$$const[e]){var n=t.$$const[e];return delete t.$$const[e],n}if(null!=t.$$autoload&&null!=t.$$autoload[e])return delete t.$$autoload[e],r;throw c.NameError.$new("constant "+t+"::"+t.$name()+" not defined")},c.allocate_class=function(t,e){var r,n;return n=null!=e&&e.$$bridge?function(){var t=$.call(arguments),n=new(u.apply(e.$$constructor,[null].concat(t)));return f(n,r.$$prototype),n}:function(){},t&&d(n,"displayName","::"+t),d(r=n,"$$name",t),d(r,"$$constructor",n),d(r,"$$prototype",n.prototype),d(r,"$$const",{}),d(r,"$$is_class",!0),d(r,"$$is_a_module",!0),d(r,"$$super",e),d(r,"$$cvars",{}),d(r,"$$own_included_modules",[]),d(r,"$$own_prepended_modules",[]),d(r,"$$ancestors",[]),d(r,"$$ancestors_cache_version",null),d(r.$$prototype,"$$class",r),c.Class&&f(r,c.Class.prototype),null!=e&&(f(r.$$prototype,e.$$prototype),e.$$meta&&c.build_class_singleton_class(r)),r},c.klass=function(t,e,r){var n;null==t?t=i:t.$$is_class||t.$$is_module||(t=t.$$class),null==e||e.hasOwnProperty("$$is_class")||(n=e,e=i);var s=function(t,e){var r=_(t,e);if(r){if(!r.$$is_class)throw c.TypeError.$new(e+" is not a class");return r}}(t,r);return s?(e&&function(t,e){if(t.$$super!==e)throw c.TypeError.$new("superclass mismatch for class "+t.$$name)}(s,e),s):(null==e&&(e=i),s=c.allocate_class(r,e),c.const_set(t,r,s),e.$inherited&&e.$inherited(s),n&&c.bridge(n,s),s)},c.allocate_module=function(t){var e=function(){};t&&d(e,"displayName",t+".$$constructor");var r=e;return t&&d(e,"displayName",t+".constructor"),d(r,"$$name",t),d(r,"$$prototype",e.prototype),d(r,"$$const",{}),d(r,"$$is_module",!0),d(r,"$$is_a_module",!0),d(r,"$$cvars",{}),d(r,"$$iclasses",[]),d(r,"$$own_included_modules",[]),d(r,"$$own_prepended_modules",[]),d(r,"$$ancestors",[r]),d(r,"$$ancestors_cache_version",null),f(r,c.Module.prototype),r},c.module=function(t,e){var r;return null==t?t=i:t.$$is_class||t.$$is_module||(t=t.$$class),(r=function(t,e){var r=_(t,e);if(null==r&&t===i&&(r=m(i,e)),r&&!r.$$is_module&&r!==i)throw c.TypeError.$new(e+" is not a module");return r}(t,e))?r:(r=c.allocate_module(e),c.const_set(t,e,r),r)},c.get_singleton_class=function(t){return t.$$meta?t.$$meta:t.hasOwnProperty("$$is_class")?c.build_class_singleton_class(t):t.hasOwnProperty("$$is_module")?c.build_module_singletin_class(t):c.build_object_singleton_class(t)},c.build_class_singleton_class=function(t){var e,r;return t.$$meta?t.$$meta:(e=t===n?a:c.get_singleton_class(t.$$super),d(r=c.allocate_class(null,e,function(){}),"$$is_singleton",!0),d(r,"$$singleton_of",t),d(t,"$$meta",r),f(t,r.$$prototype),d(t,"$$class",c.Class),r)},c.build_module_singletin_class=function(t){if(t.$$meta)return t.$$meta;var e=c.allocate_class(null,c.Module,function(){});return d(e,"$$is_singleton",!0),d(e,"$$singleton_of",t),d(t,"$$meta",e),f(t,e.$$prototype),d(t,"$$class",c.Module),e},c.build_object_singleton_class=function(t){var e=t.$$class,n=c.allocate_class(r,e,function(){});return d(n,"$$is_singleton",!0),d(n,"$$singleton_of",t),delete n.$$prototype.$$class,d(t,"$$meta",n),f(t,t.$$meta.$$prototype),n},c.is_method=function(t){return"$"===t[0]&&"$"!==t[1]},c.instance_methods=function(t){for(var e=[],r=[],n=c.ancestors(t),i=0,s=n.length;i<s;i++){var a=n[i].$$prototype;a.hasOwnProperty("$$dummy")&&(a=a.$$define_methods_on);for(var o=Object.getOwnPropertyNames(a),l=0,u=o.length;l<u;l++){var f=o[l];if(c.is_method(f)){var $=f.slice(1),h=a[f];h.$$stub&&-1===e.indexOf($)&&e.push($),h.$$stub||-1!==r.indexOf($)||-1!==e.indexOf($)||r.push($)}}}return r},c.own_instance_methods=function(t){var e=[],r=t.$$prototype;r.hasOwnProperty("$$dummy")&&(r=r.$$define_methods_on);for(var n=Object.getOwnPropertyNames(r),i=0,s=n.length;i<s;i++){var a=n[i];if(c.is_method(a))if(!r[a].$$stub){var o=a.slice(1);e.push(o)}}return e},c.methods=function(t){return c.instance_methods(c.get_singleton_class(t))},c.own_methods=function(t){return c.own_instance_methods(c.get_singleton_class(t))},c.receiver_methods=function(t){var e=c.get_singleton_class(t),r=c.own_instance_methods(e),n=c.own_instance_methods(e.$$super);return r.concat(n)},c.class_variables=function(t){var e,r=c.ancestors(t),n={};for(e=r.length-1;e>=0;e--){var i=r[e];for(var s in i.$$cvars)n[s]=i.$$cvars[s]}return n},c.class_variable_set=function(t,e,r){var n,i=c.ancestors(t);for(n=i.length-2;n>=0;n--){var s=i[n];if(l.call(s.$$cvars,e))return s.$$cvars[e]=r,r}return t.$$cvars[e]=r,r},c.append_features=function(t,e){var r=c.ancestors(t),n=[];if(-1!==r.indexOf(e))throw c.ArgumentError.$new("cyclic include detected");for(var i=0,s=r.length;i<s;i++){var a=v(r[i]);d(a,"$$included",!0),n.push(a)}var o,l,u=c.ancestors(e),$=A(n);if(-1===u.indexOf(t))o=e.$$prototype,l=Object.getPrototypeOf(e.$$prototype);else{for(var h=e.$$prototype,p=Object.getPrototypeOf(h);null!=p&&(!g(p)||p.$$module!==t);)h=p,p=Object.getPrototypeOf(p);for(var _=Object.getPrototypeOf(p);_.hasOwnProperty("$$iclass")&&!g(_);)_=Object.getPrototypeOf(_);o=h,l=_}f(o,$.first),f($.last,l),e.$$own_included_modules=function(t){for(var e,r=[],n=Object.getPrototypeOf(t.$$prototype);n&&!n.hasOwnProperty("$$class");)(e=x(n))&&r.push(e),n=Object.getPrototypeOf(n);return r}(e),c.const_cache_version++},c.prepend_features=function(t,e){var r=c.ancestors(t),n=[];if(-1!==r.indexOf(e))throw c.ArgumentError.$new("cyclic prepend detected");for(var i=0,s=r.length;i<s;i++){var a=v(r[i]);d(a,"$$prepended",!0),n.push(a)}var o,l,u,$=A(n),h=e.$$prototype,p=Object.getPrototypeOf(h);if(h.hasOwnProperty("$$dummy")?o=h.$$define_methods_on:(o=b(e),function(t){for(var e=t.$$prototype,r=Object.getOwnPropertyNames(e),n=0;n<r.length;n++){var i=r[n];c.is_method(i)&&delete e[i]}}(e),d(h,"$$dummy",!0),d(h,"$$define_methods_on",o),f(h,o),f(o,p)),-1!==c.ancestors(e).indexOf(t))throw c.RuntimeError.$new("Prepending a module multiple times is not supported");for(l=h,u=Object.getPrototypeOf(h);null!=u&&!u.hasOwnProperty("$$root")&&u!==o&&u.hasOwnProperty("$$iclass");)u=Object.getPrototypeOf(u);f(l,$.first),f($.last,u),e.$$own_prepended_modules=function(t){var e,r=[],n=Object.getPrototypeOf(t.$$prototype);if(t.$$prototype.hasOwnProperty("$$dummy"))for(;n&&n!==t.$$prototype.$$define_methods_on;)(e=x(n))&&r.push(e),n=Object.getPrototypeOf(n);return r}(e),c.const_cache_version++},c.bridge=function(t,e){if(t.hasOwnProperty("$$bridge"))throw c.ArgumentError.$new("already bridged");e.$$super||c.Object;e.$$prototype;d(t,"$$bridge",e),f(t.prototype,(e.$$super||c.Object).$$prototype),d(e,"$$prototype",t.prototype),d(e.$$prototype,"$$class",e),d(e,"$$constructor",t),d(e,"$$bridge",!0)},c.ancestors=function(t){if(!t)return[];if(t.$$ancestors_cache_version===c.const_cache_version)return t.$$ancestors;var e,r,n,i=[];for(e=0,n=(r=function(t){return t.$$own_prepended_modules.concat([t]).concat(t.$$own_included_modules)}(t)).length;e<n;e++)i.push(r[e]);if(t.$$super)for(e=0,n=(r=c.ancestors(t.$$super)).length;e<n;e++)i.push(r[e]);return t.$$ancestors_cache_version=c.const_cache_version,t.$$ancestors=i,i},c.included_modules=function(t){for(var e=[],r=null,n=Object.getPrototypeOf(t.$$prototype);n&&Object.getPrototypeOf(n);n=Object.getPrototypeOf(n))(r=x(n))&&r.$$is_module&&n.$$iclass&&n.$$included&&e.push(r);return e},c.add_stubs=function(t){for(var e=c.BasicObject.$$prototype,r=0,n=t.length;r<n;r++){var i=t[r],s=e[i];(null==s||s.$$stub)&&c.add_stub_for(e,i)}},c.add_stub_for=function(t,e){d(t,e,c.stub_for(e))},c.stub_for=function(t){function e(){this.$method_missing.$$p=e.$$p,e.$$p=null;for(var r=new Array(arguments.length),n=0,i=r.length;n<i;n++)r[n]=arguments[n];return this.$method_missing.apply(this,[t.slice(1)].concat(r))}return e.$$stub=!0,e},c.ac=function(t,e,r,n){var i="";throw r.$$is_a_module?i+=r.$$name+".":i+=r.$$class.$$name+"#",i+=n,c.ArgumentError.$new("["+i+"] wrong number of arguments("+t+" for "+e+")")},c.block_ac=function(t,e,r){var n="`block in "+r+"'";throw c.ArgumentError.$new(n+": wrong number of arguments ("+t+" for "+e+")")},c.find_super_dispatcher=function(t,e,r,n,i){for(var s,a,o="$"+e,l=(s=t.hasOwnProperty("$$meta")?c.ancestors(t.$$meta):c.ancestors(t.$$class)).indexOf(r.$$owner)+1;l<s.length;l++){var u=s[l].$$prototype;if(u.hasOwnProperty("$$dummy")&&(u=u.$$define_methods_on),u.hasOwnProperty(o)){var f=u[o];f.$$stub||(a=f);break}}if(!n&&null==a&&c.Kernel.$method_missing===t.$method_missing)throw c.NoMethodError.$new("super: no superclass method `"+e+"' for "+t,e);return a},c.find_iter_super_dispatcher=function(t,e,r,n,i){var s=e;if(!r)throw c.RuntimeError.$new("super called outside of method");if(i&&r.$$define_meth)throw c.RuntimeError.$new("implicit argument passing of super from method defined by define_method() is not supported. Specify all arguments explicitly");return r.$$def&&(s=r.$$jsid),c.find_super_dispatcher(t,s,r,n)},c.ret=function(t){throw c.returner.$v=t,c.returner},c.brk=function(t,e){throw e.$v=t,e},c.new_brk=function(){return new Error("unexpected break")},c.yield1=function(t,e){if("function"!=typeof t)throw c.LocalJumpError.$new("no block given");var r=t.$$has_top_level_mlhs_arg,n=t.$$has_trailing_comma_in_args;return(t.length>1||(r||n)&&1===t.length)&&(e=c.to_ary(e)),(t.length>1||n&&1===t.length)&&e.$$is_array?t.apply(null,e):t(e)},c.yieldX=function(t,e){if("function"!=typeof t)throw c.LocalJumpError.$new("no block given");if(t.length>1&&1===e.length&&e[0].$$is_array)return t.apply(null,e[0]);if(!e.$$is_array){for(var r=new Array(e.length),n=0,i=r.length;n<i;n++)r[n]=e[n];return t.apply(null,r)}return t.apply(null,e)},c.rescue=function(t,e){for(var r=0;r<e.length;r++){var n=e[r];if(n.$$is_array){var i=c.rescue(t,n);if(i)return i}else{if(n===c.JS.Error)return n;if(n["$==="](t))return n}}return null},c.is_a=function(t,e){if(null!=e&&t.$$meta===e||t.$$class===e)return!0;if(t.$$is_number&&e.$$is_number_class)return!0;var r,n,i=c.ancestors(t.$$is_class?c.get_singleton_class(t):t.$$meta||t.$$class);for(r=0,n=i.length;r<n;r++)if(i[r]===e)return!0;return!1},c.to_hash=function(t){if(t.$$is_hash)return t;if(t["$respond_to?"]("to_hash",!0)){var e=t.$to_hash();if(e.$$is_hash)return e;throw c.TypeError.$new("Can't convert "+t.$$class+" to Hash ("+t.$$class+"#to_hash gives "+e.$$class+")")}throw c.TypeError.$new("no implicit conversion of "+t.$$class+" into Hash")},c.to_ary=function(t){if(t.$$is_array)return t;if(t["$respond_to?"]("to_ary",!0)){var e=t.$to_ary();if(e===r)return[t];if(e.$$is_array)return e;throw c.TypeError.$new("Can't convert "+t.$$class+" to Array ("+t.$$class+"#to_ary gives "+e.$$class+")")}return[t]},c.to_a=function(t){if(t.$$is_array)return t.slice();if(t["$respond_to?"]("to_a",!0)){var e=t.$to_a();if(e===r)return[t];if(e.$$is_array)return e;throw c.TypeError.$new("Can't convert "+t.$$class+" to Array ("+t.$$class+"#to_a gives "+e.$$class+")")}return[t]},c.extract_kwargs=function(t){var e=t[t.length-1];return null!=e&&e["$respond_to?"]("to_hash",!0)?(h.call(t,t.length-1,1),e.$to_hash()):c.hash2([],{})},c.kwrestargs=function(t,e){var r,n=[],i={},s=t.$$smap;for(r in s)e[r]||(n.push(r),i[r]=s[r]);return c.hash2(n,i)},c.send=function(t,e,r,n){var i="string"==typeof e?t["$"+e]:e;return null!=i?("function"==typeof n&&(i.$$p=n),i.apply(t,r)):t.$method_missing.apply(t,[e].concat(r))},c.lambda=function(t){return t.$$is_lambda=!0,t},c.def=function(t,e,r){t===c.top?c.defn(c.Object,e,r):!t.$$eval&&t.$$is_a_module?c.defn(t,e,r):c.defs(t,e,r)},c.defn=function(t,e,r){r.displayName=e,r.$$owner=t;var n=t.$$prototype;if(n.hasOwnProperty("$$dummy")&&(n=n.$$define_methods_on),d(n,e,r),t.$$is_module){t.$$module_function&&c.defs(t,e,r);for(var i=0,s=t.$$iclasses,a=s.length;i<a;i++){d(s[i],e,r)}}var o=t.$$singleton_of;!t.$method_added||t.$method_added.$$stub||o?o&&o.$singleton_method_added&&!o.$singleton_method_added.$$stub&&o.$singleton_method_added(e.substr(1)):t.$method_added(e.substr(1))},c.defs=function(t,e,r){if(t.$$is_string||t.$$is_number)throw c.TypeError.$new("can't define singleton");c.defn(c.get_singleton_class(t),e,r)},c.rdef=function(t,e){if(!l.call(t.$$prototype,e))throw c.NameError.$new("method '"+e.substr(1)+"' not defined in "+t.$name());delete t.$$prototype[e],t.$$is_singleton?t.$$prototype.$singleton_method_removed&&!t.$$prototype.$singleton_method_removed.$$stub&&t.$$prototype.$singleton_method_removed(e.substr(1)):t.$method_removed&&!t.$method_removed.$$stub&&t.$method_removed(e.substr(1))},c.udef=function(t,e){if(!t.$$prototype[e]||t.$$prototype[e].$$stub)throw c.NameError.$new("method '"+e.substr(1)+"' not defined in "+t.$name());c.add_stub_for(t.$$prototype,e),t.$$is_singleton?t.$$prototype.$singleton_method_undefined&&!t.$$prototype.$singleton_method_undefined.$$stub&&t.$$prototype.$singleton_method_undefined(e.substr(1)):t.$method_undefined&&!t.$method_undefined.$$stub&&t.$method_undefined(e.substr(1))},c.alias=function(t,e,r){var n,i="$"+e,s="$"+r,a=t.$$prototype["$"+r];if(t.$$eval)return c.alias(c.get_singleton_class(t),e,r);if(!w(a)){for(var o=t.$$super;"function"!=typeof a&&o;)a=o[s],o=o.$$super;if(!w(a)&&t.$$is_module&&(a=c.Object.$$prototype[s]),!w(a))throw c.NameError.$new("undefined method `"+r+"' for class `"+t.$name()+"'")}return a.$$alias_of&&(a=a.$$alias_of),(n=function(){var t,e,r,i=n.$$p;for(t=new Array(arguments.length),e=0,r=arguments.length;e<r;e++)t[e]=arguments[e];return null!=i&&(n.$$p=null),c.send(this,a,t,i)}).displayName=e,n.length=a.length,n.$$arity=a.$$arity,n.$$parameters=a.$$parameters,n.$$source_location=a.$$source_location,n.$$alias_of=a,n.$$alias_name=e,c.defn(t,i,n),t},c.alias_native=function(t,e,r){var n="$"+e,i=t.$$prototype[r];if("function"!=typeof i||i.$$stub)throw c.NameError.$new("undefined native method `"+r+"' for class `"+t.$name()+"'");return c.defn(t,n,i),t},c.hash_init=function(t){t.$$smap=Object.create(null),t.$$map=Object.create(null),t.$$keys=[]},c.hash_clone=function(t,e){e.$$none=t.$$none,e.$$proc=t.$$proc;for(var r,n,i=0,s=t.$$keys,a=t.$$smap,o=s.length;i<o;i++)(r=s[i]).$$is_string?n=a[r]:(n=r.value,r=r.key),c.hash_put(e,r,n)},c.hash_put=function(e,r,n){if(r.$$is_string)return l.call(e.$$smap,r)||e.$$keys.push(r),void(e.$$smap[r]=n);var i,s,a;if(i=e.$$by_identity?c.id(r):r.$hash(),!l.call(e.$$map,i))return s={key:r,key_hash:i,value:n},e.$$keys.push(s),void(e.$$map[i]=s);for(s=e.$$map[i];s;){if(r===s.key||r["$eql?"](s.key)){a=t,s.value=n;break}a=s,s=s.next}a&&(s={key:r,key_hash:i,value:n},e.$$keys.push(s),a.next=s)},c.hash_get=function(t,e){if(e.$$is_string)return l.call(t.$$smap,e)?t.$$smap[e]:void 0;var r,n;if(r=t.$$by_identity?c.id(e):e.$hash(),l.call(t.$$map,r))for(n=t.$$map[r];n;){if(e===n.key||e["$eql?"](n.key))return n.value;n=n.next}},c.hash_delete=function(t,e){var r,n,i=t.$$keys,s=i.length;if(e.$$is_string){if(!l.call(t.$$smap,e))return;for(r=0;r<s;r++)if(i[r]===e){i.splice(r,1);break}return n=t.$$smap[e],delete t.$$smap[e],n}var a=e.$hash();if(l.call(t.$$map,a))for(var o,c=t.$$map[a];c;){if(e===c.key||e["$eql?"](c.key)){for(n=c.value,r=0;r<s;r++)if(i[r]===c){i.splice(r,1);break}return o&&c.next?o.next=c.next:o?delete o.next:c.next?t.$$map[a]=c.next:delete t.$$map[a],n}o=c,c=c.next}},c.hash_rehash=function(e){for(var r,n,i,s=0,a=e.$$keys.length;s<a;s++)if(!e.$$keys[s].$$is_string&&(r=e.$$keys[s].key.$hash())!==e.$$keys[s].key_hash){for(n=e.$$map[e.$$keys[s].key_hash],i=t;n;){if(n===e.$$keys[s]){i&&n.next?i.next=n.next:i?delete i.next:n.next?e.$$map[e.$$keys[s].key_hash]=n.next:delete e.$$map[e.$$keys[s].key_hash];break}i=n,n=n.next}if(e.$$keys[s].key_hash=r,l.call(e.$$map,r)){for(n=e.$$map[r],i=t;n;){if(n===e.$$keys[s]){i=t;break}i=n,n=n.next}i&&(i.next=e.$$keys[s])}else e.$$map[r]=e.$$keys[s]}},c.hash=function(){var t,e,r,n,i,s,a=arguments.length;if(1===a&&arguments[0].$$is_hash)return arguments[0];if(e=new c.Hash,c.hash_init(e),1===a&&arguments[0].$$is_array){for(n=(t=arguments[0]).length,r=0;r<n;r++){if(2!==t[r].length)throw c.ArgumentError.$new("value not of length 2: "+t[r].$inspect());i=t[r][0],s=t[r][1],c.hash_put(e,i,s)}return e}if(1===a){for(i in t=arguments[0])l.call(t,i)&&(s=t[i],c.hash_put(e,i,s));return e}if(a%2!=0)throw c.ArgumentError.$new("odd number of arguments for Hash");for(r=0;r<a;r+=2)i=arguments[r],s=arguments[r+1],c.hash_put(e,i,s);return e},c.hash2=function(t,e){var r=new c.Hash;return r.$$smap=e,r.$$map=Object.create(null),r.$$keys=t,r},c.range=function(t,e,r){var n=new c.Range;return n.begin=t,n.end=e,n.excl=r,n},c.ivar=function(t){return"constructor"===t||"displayName"===t||"__count__"===t||"__noSuchMethod__"===t||"__parent__"===t||"__proto__"===t||"hasOwnProperty"===t||"valueOf"===t?t+"$":t},c.escape_regexp=function(t){return t.replace(/([-[\]\/{}()*+?.^$\\| ])/g,"\\$1").replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r").replace(/[\f]/g,"\\f").replace(/[\t]/g,"\\t")},c.global_regexp=function(t){return t.global?t:(null==t.$$g?t.$$g=new RegExp(t.source,(t.multiline?"gm":"g")+(t.ignoreCase?"i":"")):t.$$g.lastIndex=null,t.$$g)},c.global_multiline_regexp=function(t){var e;if(t.multiline){if(t.global)return t;e=null!=t.$$g?t.$$g:t.$$g=new RegExp(t.source,"gm"+(t.ignoreCase?"i":""))}else e=null!=t.$$gm?t.$$gm:t.$$gm=new RegExp(t.source,"gm"+(t.ignoreCase?"i":""));return e.lastIndex=null,e},c.modules={},c.loaded_features=["corelib/runtime"],c.current_dir=".",c.require_table={"corelib/runtime":!0},c.normalize=function(t){var e,r,n=[];"."!==c.current_dir&&(t=c.current_dir.replace(/\/*$/,"/")+t);for(var i=0,s=(e=(t=(t=t.replace(/^\.\//,"")).replace(/\.(rb|opal|js)$/,"")).split("/")).length;i<s;i++)""!==(r=e[i])&&(".."===r?n.pop():n.push(r));return n.join("/")},c.loaded=function(t){var e,r,n;for(e=0,r=t.length;e<r;e++)n=c.normalize(t[e]),c.require_table[n]||(c.loaded_features.push(n),c.require_table[n]=!0)},c.load=function(t){t=c.normalize(t),c.loaded([t]);var r=c.modules[t];if(r)r(c);else{var n=c.config.missing_require_severity,i="cannot load such file -- "+t;if("error"===n)throw c.LoadError?c.LoadError.$new(i):i;"warning"===n&&e.warn("WARNING: LoadError: "+i)}return!0},c.require=function(t){return t=c.normalize(t),!c.require_table[t]&&c.load(t)},c.BasicObject=n=c.allocate_class("BasicObject",null,function(){}),c.Object=i=c.allocate_class("Object",c.BasicObject,function(){}),c.Module=s=c.allocate_class("Module",c.Object,function(){}),c.Class=a=c.allocate_class("Class",c.Module,function(){}),f(c.BasicObject,c.Class.$$prototype),f(c.Object,c.Class.$$prototype),f(c.Module,c.Class.$$prototype),f(c.Class,c.Class.$$prototype),n.$$const.BasicObject=n,c.const_set(i,"BasicObject",n),c.const_set(i,"Object",i),c.const_set(i,"Module",s),c.const_set(i,"Class",a),n.$$class=a,i.$$class=a,s.$$class=a,a.$$class=a,d(i.$$prototype,"toString",function(){var t=this.$to_s();return t.$$is_string&&"object"==typeof t?t.valueOf():t}),d(i.$$prototype,"$require",c.require),c.$$=i.$$,c.top=new i,c.top.$to_s=c.top.$inspect=function(){return"main"},c.NilClass=c.allocate_class("NilClass",c.Object,function(){}),c.const_set(i,"NilClass",c.NilClass),(r=c.nil=new c.NilClass).$$id=4,r.call=r.apply=function(){throw c.LocalJumpError.$new("no block given")},c.breaker=new Error("unexpected break (old)"),c.returner=new Error("unexpected return"),TypeError.$$super=Error}.call(this),Opal.loaded(["corelib/runtime.js"]),Opal.modules["corelib/helpers"]=function(t){t.top;var e=[],r=t.nil,n=(t.const_get_qualified,t.const_get_relative),i=(t.breaker,t.slice,t.module),s=t.truthy;return t.add_stubs(["$new","$class","$===","$respond_to?","$raise","$type_error","$__send__","$coerce_to","$nil?","$<=>","$coerce_to!","$!=","$[]","$upcase"]),function(e,a){var o,c,l,u,f,$,h,p,d,_,m,y,g,v,b=i(e,"Opal"),A=[b].concat(a);t.defs(b,"$bridge",o=function(e,r){return t.bridge(e,r)},o.$$arity=2),t.defs(b,"$type_error",c=function(t,e,i,a){var o;return null==i&&(i=r),null==a&&(a=r),s(s(o=i)?a:o)?n(A,"TypeError").$new("can't convert "+t.$class()+" into "+e+" ("+t.$class()+"#"+i+" gives "+a.$class()+")"):n(A,"TypeError").$new("no implicit conversion of "+t.$class()+" into "+e)},c.$$arity=-3),t.defs(b,"$coerce_to",l=function(t,e,r){return s(e["$==="](t))?t:(s(t["$respond_to?"](r))||this.$raise(this.$type_error(t,e)),t.$__send__(r))},l.$$arity=3),t.defs(b,"$coerce_to!",u=function(t,e,r){var n;return n=this.$coerce_to(t,e,r),s(e["$==="](n))||this.$raise(this.$type_error(t,e,r,n)),n},u.$$arity=3),t.defs(b,"$coerce_to?",f=function(t,e,n){var i=r;return s(t["$respond_to?"](n))?(i=this.$coerce_to(t,e,n),s(i["$nil?"]())?r:(s(e["$==="](i))||this.$raise(this.$type_error(t,e,n,i)),i)):r},f.$$arity=3),t.defs(b,"$try_convert",$=function(t,e,n){return s(e["$==="](t))?t:s(t["$respond_to?"](n))?t.$__send__(n):r},$.$$arity=3),t.defs(b,"$compare",h=function(t,e){var i;return i=t["$<=>"](e),s(i===r)&&this.$raise(n(A,"ArgumentError"),"comparison of "+t.$class()+" with "+e.$class()+" failed"),i},h.$$arity=2),t.defs(b,"$destructure",p=function(t){if(1==t.length)return t[0];if(t.$$is_array)return t;for(var e=new Array(t.length),r=0,n=e.length;r<n;r++)e[r]=t[r];return e},p.$$arity=1),t.defs(b,"$respond_to?",d=function(t,e,r){return null==r&&(r=!1),!(null==t||!t.$$class)&&t["$respond_to?"](e,r)},d.$$arity=-3),t.defs(b,"$inspect_obj",_=function(e){return t.inspect(e)},_.$$arity=1),t.defs(b,"$instance_variable_name!",m=function(t){return t=n(A,"Opal")["$coerce_to!"](t,n(A,"String"),"to_str"),s(/^@[a-zA-Z_][a-zA-Z0-9_]*?$/.test(t))||this.$raise(n(A,"NameError").$new("'"+t+"' is not allowed as an instance variable name",t)),t},m.$$arity=1),t.defs(b,"$class_variable_name!",y=function(t){return t=n(A,"Opal")["$coerce_to!"](t,n(A,"String"),"to_str"),s(t.length<3||"@@"!==t.slice(0,2))&&this.$raise(n(A,"NameError").$new("`"+t+"' is not allowed as a class variable name",t)),t},y.$$arity=1),t.defs(b,"$const_name!",g=function(t){return t=n(A,"Opal")["$coerce_to!"](t,n(A,"String"),"to_str"),s(t["$[]"](0)["$!="](t["$[]"](0).$upcase()))&&this.$raise(n(A,"NameError"),"wrong constant name "+t),t},g.$$arity=1),t.defs(b,"$pristine",v=function(e,n){for(var i,s,a,o=(i=t.slice.call(arguments,1,arguments.length)).length-1;o>=0;o--)s=i[o],(a=e.$$prototype["$"+s])&&!a.$$stub&&(a.$$pristine=!0);return r},v.$$arity=-2)}(e[0],e)},Opal.modules["corelib/module"]=function(Opal){function $rb_lt(t,e){return"number"==typeof t&&"number"==typeof e?t<e:t["$<"](e)}function $rb_gt(t,e){return"number"==typeof t&&"number"==typeof e?t>e:t["$>"](e)}var self=Opal.top,$nesting=[],nil=Opal.nil,$$$=Opal.const_get_qualified,$$=Opal.const_get_relative,$breaker=Opal.breaker,$slice=Opal.slice,$klass=Opal.klass,$send=Opal.send,$truthy=Opal.truthy,$lambda=Opal.lambda,$range=Opal.range,$hash2=Opal.hash2;return Opal.add_stubs(["$module_eval","$to_proc","$===","$raise","$equal?","$<","$>","$nil?","$attr_reader","$attr_writer","$class_variable_name!","$new","$const_name!","$=~","$inject","$split","$const_get","$==","$!~","$start_with?","$bind","$call","$class","$append_features","$included","$name","$cover?","$size","$merge","$compile","$proc","$any?","$prepend_features","$prepended","$to_s","$__id__","$constants","$include?","$copy_class_variables","$copy_constants"]),function($base,$super,$parent_nesting){var self=$klass($base,$super,"Module"),$nesting=[self].concat($parent_nesting),$Module_allocate$1,$Module_initialize$2,$Module_$eq_eq_eq$3,$Module_$lt$4,$Module_$lt_eq$5,$Module_$gt$6,$Module_$gt_eq$7,$Module_$lt_eq_gt$8,$Module_alias_method$9,$Module_alias_native$10,$Module_ancestors$11,$Module_append_features$12,$Module_attr_accessor$13,$Module_attr_reader$14,$Module_attr_writer$15,$Module_autoload$16,$Module_class_variables$17,$Module_class_variable_get$18,$Module_class_variable_set$19,$Module_class_variable_defined$ques$20,$Module_remove_class_variable$21,$Module_constants$22,$Module_constants$23,$Module_nesting$24,$Module_const_defined$ques$25,$Module_const_get$26,$Module_const_missing$28,$Module_const_set$29,$Module_public_constant$30,$Module_define_method$31,$Module_remove_method$33,$Module_singleton_class$ques$34,$Module_include$35,$Module_included_modules$36,$Module_include$ques$37,$Module_instance_method$38,$Module_instance_methods$39,$Module_included$40,$Module_extended$41,$Module_extend_object$42,$Module_method_added$43,$Module_method_removed$44,$Module_method_undefined$45,$Module_module_eval$46,$Module_module_exec$48,$Module_method_defined$ques$49,$Module_module_function$50,$Module_name$51,$Module_prepend$52,$Module_prepend_features$53,$Module_prepended$54,$Module_remove_const$55,$Module_to_s$56,$Module_undef_method$57,$Module_instance_variables$58,$Module_dup$59,$Module_copy_class_variables$60,$Module_copy_constants$61;return Opal.defs(self,"$allocate",$Module_allocate$1=function(){var t=Opal.allocate_module(nil,function(){});return this!==Opal.Module&&Object.setPrototypeOf(t,this.$$prototype),t},$Module_allocate$1.$$arity=0),Opal.def(self,"$initialize",$Module_initialize$2=function(){var t=$Module_initialize$2.$$p,e=t||nil;return t&&($Module_initialize$2.$$p=null),t&&($Module_initialize$2.$$p=null),e!==nil?$send(this,"module_eval",[],e.$to_proc()):nil},$Module_initialize$2.$$arity=0),Opal.def(self,"$===",$Module_$eq_eq_eq$3=function(t){return!$truthy(null==t)&&Opal.is_a(t,this)},$Module_$eq_eq_eq$3.$$arity=1),Opal.def(self,"$<",$Module_$lt$4=function(t){$truthy($$($nesting,"Module")["$==="](t))||this.$raise($$($nesting,"TypeError"),"compared with non class/module");var e,r,n;if(this===t)return!1;for(r=0,n=(e=Opal.ancestors(this)).length;r<n;r++)if(e[r]===t)return!0;for(r=0,n=(e=Opal.ancestors(t)).length;r<n;r++)if(e[r]===this)return!1;return nil},$Module_$lt$4.$$arity=1),Opal.def(self,"$<=",$Module_$lt_eq$5=function(t){var e;return $truthy(e=this["$equal?"](t))?e:$rb_lt(this,t)},$Module_$lt_eq$5.$$arity=1),Opal.def(self,"$>",$Module_$gt$6=function(t){return $truthy($$($nesting,"Module")["$==="](t))||this.$raise($$($nesting,"TypeError"),"compared with non class/module"),$rb_lt(t,this)},$Module_$gt$6.$$arity=1),Opal.def(self,"$>=",$Module_$gt_eq$7=function(t){var e;return $truthy(e=this["$equal?"](t))?e:$rb_gt(this,t)},$Module_$gt_eq$7.$$arity=1),Opal.def(self,"$<=>",$Module_$lt_eq_gt$8=function(t){var e=nil;return this===t?0:$truthy($$($nesting,"Module")["$==="](t))?(e=$rb_lt(this,t),$truthy(e["$nil?"]())?nil:$truthy(e)?-1:1):nil},$Module_$lt_eq_gt$8.$$arity=1),Opal.def(self,"$alias_method",$Module_alias_method$9=function(t,e){return Opal.alias(this,t,e),this},$Module_alias_method$9.$$arity=2),Opal.def(self,"$alias_native",$Module_alias_native$10=function(t,e){return null==e&&(e=t),Opal.alias_native(this,t,e),this},$Module_alias_native$10.$$arity=-2),Opal.def(self,"$ancestors",$Module_ancestors$11=function(){return Opal.ancestors(this)},$Module_ancestors$11.$$arity=0),Opal.def(self,"$append_features",$Module_append_features$12=function(t){return Opal.append_features(this,t),this},$Module_append_features$12.$$arity=1),Opal.def(self,"$attr_accessor",$Module_attr_accessor$13=function(t){var e;return e=Opal.slice.call(arguments,0,arguments.length),$send(this,"attr_reader",Opal.to_a(e)),$send(this,"attr_writer",Opal.to_a(e))},$Module_attr_accessor$13.$$arity=-1),Opal.alias(self,"attr","attr_accessor"),Opal.def(self,"$attr_reader",$Module_attr_reader$14=function(t){var e;e=Opal.slice.call(arguments,0,arguments.length);for(var r=this.$$prototype,n=e.length-1;n>=0;n--){var i=e[n],s="$"+i,a=Opal.ivar(i),o=function(t){return function(){return null==this[t]?nil:this[t]}}(a);Opal.defineProperty(r,a,nil),o.$$parameters=[],o.$$arity=0,Opal.defn(this,s,o)}return nil},$Module_attr_reader$14.$$arity=-1),Opal.def(self,"$attr_writer",$Module_attr_writer$15=function(t){var e;e=Opal.slice.call(arguments,0,arguments.length);for(var r=this.$$prototype,n=e.length-1;n>=0;n--){var i=e[n],s="$"+i+"=",a=Opal.ivar(i),o=function(t){return function(e){return this[t]=e}}(a);o.$$parameters=[["req"]],o.$$arity=1,Opal.defineProperty(r,a,nil),Opal.defn(this,s,o)}return nil},$Module_attr_writer$15.$$arity=-1),Opal.def(self,"$autoload",$Module_autoload$16=function(t,e){return null==this.$$autoload&&(this.$$autoload={}),Opal.const_cache_version++,this.$$autoload[t]=e,nil},$Module_autoload$16.$$arity=2),Opal.def(self,"$class_variables",$Module_class_variables$17=function(){return Object.keys(Opal.class_variables(this))},$Module_class_variables$17.$$arity=0),Opal.def(self,"$class_variable_get",$Module_class_variable_get$18=function(t){t=$$($nesting,"Opal")["$class_variable_name!"](t);var e=Opal.class_variables(this)[t];return null==e&&this.$raise($$($nesting,"NameError").$new("uninitialized class variable "+t+" in "+this,t)),e},$Module_class_variable_get$18.$$arity=1),Opal.def(self,"$class_variable_set",$Module_class_variable_set$19=function(t,e){return t=$$($nesting,"Opal")["$class_variable_name!"](t),Opal.class_variable_set(this,t,e)},$Module_class_variable_set$19.$$arity=2),Opal.def(self,"$class_variable_defined?",$Module_class_variable_defined$ques$20=function(t){return t=$$($nesting,"Opal")["$class_variable_name!"](t),Opal.class_variables(this).hasOwnProperty(t)},$Module_class_variable_defined$ques$20.$$arity=1),Opal.def(self,"$remove_class_variable",$Module_remove_class_variable$21=function(t){if(t=$$($nesting,"Opal")["$class_variable_name!"](t),Opal.hasOwnProperty.call(this.$$cvars,t)){var e=this.$$cvars[t];return delete this.$$cvars[t],e}this.$raise($$($nesting,"NameError"),"cannot remove "+t+" for "+this)},$Module_remove_class_variable$21.$$arity=1),Opal.def(self,"$constants",$Module_constants$22=function(t){return null==t&&(t=!0),Opal.constants(this,t)},$Module_constants$22.$$arity=-1),Opal.defs(self,"$constants",$Module_constants$23=function(t){if(null==t){var e,r,n,i=(this.$$nesting||[]).concat(Opal.Object),s={};for(r=0,n=i.length;r<n;r++)for(e in i[r].$$const)s[e]=!0;return Object.keys(s)}return Opal.constants(this,t)},$Module_constants$23.$$arity=-1),Opal.defs(self,"$nesting",$Module_nesting$24=function(){return this.$$nesting||[]},$Module_nesting$24.$$arity=0),Opal.def(self,"$const_defined?",$Module_const_defined$ques$25=function(t,e){null==e&&(e=!0),t=$$($nesting,"Opal")["$const_name!"](t),$truthy(t["$=~"]($$$($$($nesting,"Opal"),"CONST_NAME_REGEXP")))||this.$raise($$($nesting,"NameError").$new("wrong constant name "+t,t));var r,n,i=[this];for(e&&(i=i.concat(Opal.ancestors(this)),this.$$is_module&&(i=i.concat([Opal.Object]).concat(Opal.ancestors(Opal.Object)))),r=0,n=i.length;r<n;r++)if(null!=i[r].$$const[t])return!0;return!1},$Module_const_defined$ques$25.$$arity=-2),Opal.def(self,"$const_get",$Module_const_get$26=function(t,e){var r;return null==e&&(e=!0),0===(t=$$($nesting,"Opal")["$const_name!"](t)).indexOf("::")&&"::"!==t&&(t=t.slice(2)),$truthy(-1!=t.indexOf("::")&&"::"!=t)?$send(t.$split("::"),"inject",[this],((r=function(t,e){r.$$s;return null==t&&(t=nil),null==e&&(e=nil),t.$const_get(e)}).$$s=this,r.$$arity=2,r)):($truthy(t["$=~"]($$$($$($nesting,"Opal"),"CONST_NAME_REGEXP")))||this.$raise($$($nesting,"NameError").$new("wrong constant name "+t,t)),e?$$([this],t):Opal.const_get_local(this,t))},$Module_const_get$26.$$arity=-2),Opal.def(self,"$const_missing",$Module_const_missing$28=function(t){var e,r=this;if(r.$$autoload){var n=r.$$autoload[t];if(n)return r.$require(n),r.$const_get(t)}return e=r["$=="]($$($nesting,"Object"))?t:r+"::"+t,r.$raise($$($nesting,"NameError").$new("uninitialized constant "+e,t))},$Module_const_missing$28.$$arity=1),Opal.def(self,"$const_set",$Module_const_set$29=function(t,e){var r;return t=$$($nesting,"Opal")["$const_name!"](t),$truthy($truthy(r=t["$!~"]($$$($$($nesting,"Opal"),"CONST_NAME_REGEXP")))?r:t["$start_with?"]("::"))&&this.$raise($$($nesting,"NameError").$new("wrong constant name "+t,t)),Opal.const_set(this,t,e),e},$Module_const_set$29.$$arity=2),Opal.def(self,"$public_constant",$Module_public_constant$30=function(t){return nil},$Module_public_constant$30.$$arity=1),Opal.def(self,"$define_method",$Module_define_method$31=function(t,e){var r,n,i=$Module_define_method$31.$$p,s=i||nil,a=this,o=nil;i&&($Module_define_method$31.$$p=null),i&&($Module_define_method$31.$$p=null),$truthy(void 0===e&&s===nil)&&a.$raise($$($nesting,"ArgumentError"),"tried to create a Proc object without a block");var c="$"+t;return(s=$truthy(r=s)?r:(o=e,$$($nesting,"Proc")["$==="](o)?e:$$($nesting,"Method")["$==="](o)?e.$to_proc().$$unbound:$$($nesting,"UnboundMethod")["$==="](o)?$lambda(((n=function(t){var r,i,s=n.$$s||this;return r=Opal.slice.call(arguments,0,arguments.length),i=e.$bind(s),$send(i,"call",Opal.to_a(r))}).$$s=a,n.$$arity=-1,n)):a.$raise($$($nesting,"TypeError"),"wrong argument type "+s.$class()+" (expected Proc/Method)"))).$$jsid=t,s.$$s=null,s.$$def=s,s.$$define_meth=!0,Opal.defn(a,c,s),t},$Module_define_method$31.$$arity=-2),Opal.def(self,"$remove_method",$Module_remove_method$33=function(t){for(var e,r=0,n=(e=Opal.slice.call(arguments,0,arguments.length)).length;r<n;r++)Opal.rdef(this,"$"+e[r]);return this},$Module_remove_method$33.$$arity=-1),Opal.def(self,"$singleton_class?",$Module_singleton_class$ques$34=function(){return!!this.$$is_singleton},$Module_singleton_class$ques$34.$$arity=0),Opal.def(self,"$include",$Module_include$35=function(t){for(var e,r=(e=Opal.slice.call(arguments,0,arguments.length)).length-1;r>=0;r--){var n=e[r];n.$$is_module||this.$raise($$($nesting,"TypeError"),"wrong argument type "+n.$class()+" (expected Module)"),n.$append_features(this),n.$included(this)}return this},$Module_include$35.$$arity=-1),Opal.def(self,"$included_modules",$Module_included_modules$36=function(){return Opal.included_modules(this)},$Module_included_modules$36.$$arity=0),Opal.def(self,"$include?",$Module_include$ques$37=function(t){t.$$is_module||this.$raise($$($nesting,"TypeError"),"wrong argument type "+t.$class()+" (expected Module)");var e,r,n,i=Opal.ancestors(this);for(e=0,r=i.length;e<r;e++)if((n=i[e])===t&&n!==this)return!0;return!1},$Module_include$ques$37.$$arity=1),Opal.def(self,"$instance_method",$Module_instance_method$38=function(t){var e=this.$$prototype["$"+t];return e&&!e.$$stub||this.$raise($$($nesting,"NameError").$new("undefined method `"+t+"' for class `"+this.$name()+"'",t)),$$($nesting,"UnboundMethod").$new(this,e.$$owner||this,e,t)},$Module_instance_method$38.$$arity=1),Opal.def(self,"$instance_methods",$Module_instance_methods$39=function(t){return null==t&&(t=!0),$truthy(t)?Opal.instance_methods(this):Opal.own_instance_methods(this)},$Module_instance_methods$39.$$arity=-1),Opal.def(self,"$included",$Module_included$40=function(t){return nil},$Module_included$40.$$arity=1),Opal.def(self,"$extended",$Module_extended$41=function(t){return nil},$Module_extended$41.$$arity=1),Opal.def(self,"$extend_object",$Module_extend_object$42=function(t){return nil},$Module_extend_object$42.$$arity=1),Opal.def(self,"$method_added",$Module_method_added$43=function(t){return Opal.slice.call(arguments,0,arguments.length),nil},$Module_method_added$43.$$arity=-1),Opal.def(self,"$method_removed",$Module_method_removed$44=function(t){return Opal.slice.call(arguments,0,arguments.length),nil},$Module_method_removed$44.$$arity=-1),Opal.def(self,"$method_undefined",$Module_method_undefined$45=function(t){return Opal.slice.call(arguments,0,arguments.length),nil},$Module_method_undefined$45.$$arity=-1),Opal.def(self,"$module_eval",$Module_module_eval$46=function $$module_eval($a){var $iter=$Module_module_eval$46.$$p,block=$iter||nil,$post_args,args,$b,$$47,self=this,string=nil,file=nil,_lineno=nil,default_eval_options=nil,compiling_options=nil,compiled=nil;$iter&&($Module_module_eval$46.$$p=null),$iter&&($Module_module_eval$46.$$p=null),$post_args=Opal.slice.call(arguments,0,arguments.length),args=$post_args,$truthy($truthy($b=block["$nil?"]())?!!Opal.compile:$b)?($truthy($range(1,3,!1)["$cover?"](args.$size()))||$$($nesting,"Kernel").$raise($$($nesting,"ArgumentError"),"wrong number of arguments (0 for 1..3)"),$b=[].concat(Opal.to_a(args)),string=null==$b[0]?nil:$b[0],file=null==$b[1]?nil:$b[1],_lineno=null==$b[2]?nil:$b[2],default_eval_options=$hash2(["file","eval"],{file:$truthy($b=file)?$b:"(eval)",eval:!0}),compiling_options=Opal.hash({arity_check:!1}).$merge(default_eval_options),compiled=$$($nesting,"Opal").$compile(string,compiling_options),block=$send($$($nesting,"Kernel"),"proc",[],($$47=function(){var self=$$47.$$s||this;return function(self){return eval(compiled)}(self)},$$47.$$s=self,$$47.$$arity=0,$$47))):$truthy(args["$any?"]())&&$$($nesting,"Kernel").$raise($$($nesting,"ArgumentError"),"wrong number of arguments ("+args.$size()+" for 0)\n\n  NOTE:If you want to enable passing a String argument please add \"require 'opal-parser'\" to your script\n");var old=block.$$s,result;return block.$$s=null,result=block.apply(self,[self]),block.$$s=old,result},$Module_module_eval$46.$$arity=-1),Opal.alias(self,"class_eval","module_eval"),Opal.def(self,"$module_exec",$Module_module_exec$48=function(t){var e,r=$Module_module_exec$48.$$p,n=r||nil;r&&($Module_module_exec$48.$$p=null),r&&($Module_module_exec$48.$$p=null),e=Opal.slice.call(arguments,0,arguments.length),n===nil&&this.$raise($$($nesting,"LocalJumpError"),"no block given");var i,s=n.$$s;return n.$$s=null,i=n.apply(this,e),n.$$s=s,i},$Module_module_exec$48.$$arity=-1),Opal.alias(self,"class_exec","module_exec"),Opal.def(self,"$method_defined?",$Module_method_defined$ques$49=function(t){var e=this.$$prototype["$"+t];return!!e&&!e.$$stub},$Module_method_defined$ques$49.$$arity=1),Opal.def(self,"$module_function",$Module_module_function$50=function(t){var e;if(0===(e=Opal.slice.call(arguments,0,arguments.length)).length)this.$$module_function=!0;else for(var r=0,n=e.length;r<n;r++){var i="$"+e[r],s=this.$$prototype[i];Opal.defs(this,i,s)}return this},$Module_module_function$50.$$arity=-1),Opal.def(self,"$name",$Module_name$51=function(){if(this.$$full_name)return this.$$full_name;for(var t=[],e=this;e;){if(e.$$name===nil||null==e.$$name)return nil;if(t.unshift(e.$$name),(e=e.$$base_module)===Opal.Object)break}return 0===t.length?nil:this.$$full_name=t.join("::")},$Module_name$51.$$arity=0),Opal.def(self,"$prepend",$Module_prepend$52=function(t){var e;0===(e=Opal.slice.call(arguments,0,arguments.length)).length&&this.$raise($$($nesting,"ArgumentError"),"wrong number of arguments (given 0, expected 1+)");for(var r=e.length-1;r>=0;r--){var n=e[r];n.$$is_module||this.$raise($$($nesting,"TypeError"),"wrong argument type "+n.$class()+" (expected Module)"),n.$prepend_features(this),n.$prepended(this)}return this},$Module_prepend$52.$$arity=-1),Opal.def(self,"$prepend_features",$Module_prepend_features$53=function(t){return this.$$is_module||this.$raise($$($nesting,"TypeError"),"wrong argument type "+this.$class()+" (expected Module)"),Opal.prepend_features(this,t),this},$Module_prepend_features$53.$$arity=1),Opal.def(self,"$prepended",$Module_prepended$54=function(t){return nil},$Module_prepended$54.$$arity=1),Opal.def(self,"$remove_const",$Module_remove_const$55=function(t){return Opal.const_remove(this,t)},$Module_remove_const$55.$$arity=1),Opal.def(self,"$to_s",$Module_to_s$56=function(){var t;return $truthy(t=Opal.Module.$name.call(this))?t:"#<"+(this.$$is_module?"Module":"Class")+":0x"+this.$__id__().$to_s(16)+">"},$Module_to_s$56.$$arity=0),Opal.def(self,"$undef_method",$Module_undef_method$57=function(t){for(var e,r=0,n=(e=Opal.slice.call(arguments,0,arguments.length)).length;r<n;r++)Opal.udef(this,"$"+e[r]);return this},$Module_undef_method$57.$$arity=-1),Opal.def(self,"$instance_variables",$Module_instance_variables$58=function(){var t=nil;Opal.Module.$$nesting=$nesting,t=this.$constants();var e=[];for(var r in this)this.hasOwnProperty(r)&&"$"!==r.charAt(0)&&"constructor"!==r&&!t["$include?"](r)&&e.push("@"+r);return e},$Module_instance_variables$58.$$arity=0),Opal.def(self,"$dup",$Module_dup$59=function(){var t,e=$Module_dup$59.$$p,r=nil,n=nil,i=nil;for(e&&($Module_dup$59.$$p=null),i=0,t=arguments.length,n=new Array(t);i<t;i++)n[i]=arguments[i];return(r=$send(this,Opal.find_super_dispatcher(this,"dup",$Module_dup$59,!1),n,e)).$copy_class_variables(this),r.$copy_constants(this),r},$Module_dup$59.$$arity=0),Opal.def(self,"$copy_class_variables",$Module_copy_class_variables$60=function(t){for(var e in t.$$cvars)this.$$cvars[e]=t.$$cvars[e]},$Module_copy_class_variables$60.$$arity=1),Opal.def(self,"$copy_constants",$Module_copy_constants$61=function(t){var e,r=t.$$const;for(e in r)Opal.const_set(this,e,r[e])},$Module_copy_constants$61.$$arity=1),nil&&"copy_constants"}($nesting[0],null,$nesting)},Opal.modules["corelib/class"]=function(t){var e=t.top,r=[],n=t.nil,i=(t.const_get_qualified,t.const_get_relative),s=(t.breaker,t.slice,t.klass),a=t.send;return t.add_stubs(["$require","$class_eval","$to_proc","$initialize_copy","$allocate","$name","$to_s"]),e.$require("corelib/module"),function(e,r,o){var c,l,u,f,$,h,p,d=s(e,null,"Class"),_=[d].concat(o);return t.defs(d,"$new",c=function(e){var r=c.$$p,s=r||n;if(r&&(c.$$p=null),r&&(c.$$p=null),null==e&&(e=i(_,"Object")),!e.$$is_class)throw t.TypeError.$new("superclass must be a Class");var o=t.allocate_class(n,e);return e.$inherited(o),s!==n&&a(o,"class_eval",[],s.$to_proc()),o},c.$$arity=-1),t.def(d,"$allocate",l=function(){var e=new this.$$constructor;return e.$$id=t.uid(),e},l.$$arity=0),t.def(d,"$inherited",u=function(t){return n},u.$$arity=1),t.def(d,"$initialize_dup",f=function(t){this.$initialize_copy(t),this.$$name=null,this.$$full_name=null},f.$$arity=1),t.def(d,"$new",$=function(e){var r,i=$.$$p,s=i||n;i&&($.$$p=null),i&&($.$$p=null),r=t.slice.call(arguments,0,arguments.length);var a=this.$allocate();return t.send(a,a.$initialize,r,s),a},$.$$arity=-1),t.def(d,"$superclass",h=function(){return this.$$super||n},h.$$arity=0),t.def(d,"$to_s",p=function(){var e=p.$$p;e&&(p.$$p=null);var r=this.$$singleton_of;return r&&r.$$is_a_module?"#<Class:"+r.$name()+">":r?"#<Class:#<"+r.$$class.$name()+":0x"+t.id(r).$to_s(16)+">>":a(this,t.find_super_dispatcher(this,"to_s",p,!1),[],null)},p.$$arity=0),n&&"to_s"}(r[0],0,r)},Opal.modules["corelib/basic_object"]=function(Opal){var self=Opal.top,$nesting=[],nil=Opal.nil,$$$=Opal.const_get_qualified,$$=Opal.const_get_relative,$breaker=Opal.breaker,$slice=Opal.slice,$klass=Opal.klass,$truthy=Opal.truthy,$range=Opal.range,$hash2=Opal.hash2,$send=Opal.send;return Opal.add_stubs(["$==","$!","$nil?","$cover?","$size","$raise","$merge","$compile","$proc","$any?","$inspect","$new"]),function($base,$super,$parent_nesting){var self=$klass($base,$super,"BasicObject"),$nesting=[self].concat($parent_nesting),$BasicObject_initialize$1,$BasicObject_$eq_eq$2,$BasicObject_eql$ques$3,$BasicObject___id__$4,$BasicObject___send__$5,$BasicObject_$excl$6,$BasicObject_$not_eq$7,$BasicObject_instance_eval$8,$BasicObject_instance_exec$10,$BasicObject_singleton_method_added$11,$BasicObject_singleton_method_removed$12,$BasicObject_singleton_method_undefined$13,$BasicObject_class$14,$BasicObject_method_missing$15;return Opal.def(self,"$initialize",$BasicObject_initialize$1=function(t){return Opal.slice.call(arguments,0,arguments.length),nil},$BasicObject_initialize$1.$$arity=-1),Opal.def(self,"$==",$BasicObject_$eq_eq$2=function(t){return this===t},$BasicObject_$eq_eq$2.$$arity=1),Opal.def(self,"$eql?",$BasicObject_eql$ques$3=function(t){return this["$=="](t)},$BasicObject_eql$ques$3.$$arity=1),Opal.alias(self,"equal?","=="),Opal.def(self,"$__id__",$BasicObject___id__$4=function(){return null!=this.$$id?this.$$id:(Opal.defineProperty(this,"$$id",Opal.uid()),this.$$id)},$BasicObject___id__$4.$$arity=0),Opal.def(self,"$__send__",$BasicObject___send__$5=function(t,e){var r,n=$BasicObject___send__$5.$$p,i=n||nil;n&&($BasicObject___send__$5.$$p=null),n&&($BasicObject___send__$5.$$p=null),r=Opal.slice.call(arguments,1,arguments.length);var s=this["$"+t];return s?(i!==nil&&(s.$$p=i),s.apply(this,r)):(i!==nil&&(this.$method_missing.$$p=i),this.$method_missing.apply(this,[t].concat(r)))},$BasicObject___send__$5.$$arity=-2),Opal.def(self,"$!",$BasicObject_$excl$6=function(){return!1},$BasicObject_$excl$6.$$arity=0),Opal.def(self,"$!=",$BasicObject_$not_eq$7=function(t){return this["$=="](t)["$!"]()},$BasicObject_$not_eq$7.$$arity=1),Opal.def(self,"$instance_eval",$BasicObject_instance_eval$8=function $$instance_eval($a){var $iter=$BasicObject_instance_eval$8.$$p,block=$iter||nil,$post_args,args,$b,$$9,self=this,string=nil,file=nil,_lineno=nil,default_eval_options=nil,compiling_options=nil,compiled=nil;$iter&&($BasicObject_instance_eval$8.$$p=null),$iter&&($BasicObject_instance_eval$8.$$p=null),$post_args=Opal.slice.call(arguments,0,arguments.length),args=$post_args,$truthy($truthy($b=block["$nil?"]())?!!Opal.compile:$b)?($truthy($range(1,3,!1)["$cover?"](args.$size()))||$$$("::","Kernel").$raise($$$("::","ArgumentError"),"wrong number of arguments (0 for 1..3)"),$b=[].concat(Opal.to_a(args)),string=null==$b[0]?nil:$b[0],file=null==$b[1]?nil:$b[1],_lineno=null==$b[2]?nil:$b[2],default_eval_options=$hash2(["file","eval"],{file:$truthy($b=file)?$b:"(eval)",eval:!0}),compiling_options=Opal.hash({arity_check:!1}).$merge(default_eval_options),compiled=$$$("::","Opal").$compile(string,compiling_options),block=$send($$$("::","Kernel"),"proc",[],($$9=function(){var self=$$9.$$s||this;return function(self){return eval(compiled)}(self)},$$9.$$s=self,$$9.$$arity=0,$$9))):$truthy(args["$any?"]())&&$$$("::","Kernel").$raise($$$("::","ArgumentError"),"wrong number of arguments ("+args.$size()+" for 0)");var old=block.$$s,result;if(block.$$s=null,self.$$is_a_module){self.$$eval=!0;try{result=block.call(self,self)}finally{self.$$eval=!1}}else result=block.call(self,self);return block.$$s=old,result},$BasicObject_instance_eval$8.$$arity=-1),Opal.def(self,"$instance_exec",$BasicObject_instance_exec$10=function(t){var e,r=$BasicObject_instance_exec$10.$$p,n=r||nil;r&&($BasicObject_instance_exec$10.$$p=null),r&&($BasicObject_instance_exec$10.$$p=null),e=Opal.slice.call(arguments,0,arguments.length),$truthy(n)||$$$("::","Kernel").$raise($$$("::","ArgumentError"),"no block given");var i,s=n.$$s;if(n.$$s=null,this.$$is_a_module){this.$$eval=!0;try{i=n.apply(this,e)}finally{this.$$eval=!1}}else i=n.apply(this,e);return n.$$s=s,i},$BasicObject_instance_exec$10.$$arity=-1),Opal.def(self,"$singleton_method_added",$BasicObject_singleton_method_added$11=function(t){return Opal.slice.call(arguments,0,arguments.length),nil},$BasicObject_singleton_method_added$11.$$arity=-1),Opal.def(self,"$singleton_method_removed",$BasicObject_singleton_method_removed$12=function(t){return Opal.slice.call(arguments,0,arguments.length),nil},$BasicObject_singleton_method_removed$12.$$arity=-1),Opal.def(self,"$singleton_method_undefined",$BasicObject_singleton_method_undefined$13=function(t){return Opal.slice.call(arguments,0,arguments.length),nil},$BasicObject_singleton_method_undefined$13.$$arity=-1),Opal.def(self,"$class",$BasicObject_class$14=function(){return this.$$class},$BasicObject_class$14.$$arity=0),Opal.def(self,"$method_missing",$BasicObject_method_missing$15=function(t,e){var r,n=$BasicObject_method_missing$15.$$p,i=this;return n&&($BasicObject_method_missing$15.$$p=null),n&&($BasicObject_method_missing$15.$$p=null),Opal.slice.call(arguments,1,arguments.length),r=$truthy(i.$inspect&&!i.$inspect.$$stub)?"undefined method `"+t+"' for "+i.$inspect()+":"+i.$$class:"undefined method `"+t+"' for "+i.$$class,$$$("::","Kernel").$raise($$$("::","NoMethodError").$new(r,t))},$BasicObject_method_missing$15.$$arity=-2),nil&&"method_missing"}($nesting[0],null,$nesting)},Opal.modules["corelib/kernel"]=function(t){t.top;var e=[],r=t.nil,n=t.const_get_qualified,i=t.const_get_relative,s=(t.breaker,t.slice,t.module),a=t.truthy,o=t.gvars,c=t.hash2,l=t.send,u=t.klass;return t.add_stubs(["$raise","$new","$inspect","$!","$=~","$==","$object_id","$class","$coerce_to?","$<<","$allocate","$copy_instance_variables","$copy_singleton_methods","$initialize_clone","$initialize_copy","$define_method","$singleton_class","$to_proc","$initialize_dup","$for","$empty?","$pop","$call","$coerce_to","$append_features","$extend_object","$extended","$__id__","$to_s","$instance_variable_name!","$respond_to?","$to_int","$coerce_to!","$Integer","$nil?","$===","$enum_for","$result","$any?","$print","$format","$puts","$each","$<=","$length","$[]","$exception","$is_a?","$rand","$respond_to_missing?","$try_convert!","$expand_path","$join","$start_with?","$new_seed","$srand","$sym","$arg","$open","$include"]),function(e,u){var f,$,h,p,d,_,m,y,g,v,b,A,x,w,k,E,S,N,I,C,O,B,M,P,F,L,T,j,R,D,z,U,q,H,Q,Y,G,V,J,X,W,K,Z,tt,et,rt,nt,it,st,at,ot,ct,lt,ut,ft,$t,ht,pt,dt,_t,mt,yt,gt,vt,bt,At=s(e,"Kernel"),xt=[At].concat(u);t.def(At,"$method_missing",f=function(e,r){var n,s=f.$$p;return s&&(f.$$p=null),s&&(f.$$p=null),n=t.slice.call(arguments,1,arguments.length),this.$raise(i(xt,"NoMethodError").$new("undefined method `"+e+"' for "+this.$inspect(),e,n))},f.$$arity=-2),t.def(At,"$=~",$=function(t){return!1},$.$$arity=1),t.def(At,"$!~",h=function(t){return this["$=~"](t)["$!"]()},h.$$arity=1),t.def(At,"$===",p=function(t){var e;return a(e=this.$object_id()["$=="](t.$object_id()))?e:this["$=="](t)},p.$$arity=1),t.def(At,"$<=>",d=function(t){this.$$comparable=!0;var e=this["$=="](t);return e&&e!==r?0:r},d.$$arity=1),t.def(At,"$method",_=function(t){var e=this["$"+t];return e&&!e.$$stub||this.$raise(i(xt,"NameError").$new("undefined method `"+t+"' for class `"+this.$class()+"'",t)),i(xt,"Method").$new(this,e.$$owner||this.$class(),e,t)},_.$$arity=1),t.def(At,"$methods",m=function(e){return null==e&&(e=!0),a(e)?t.methods(this):t.own_methods(this)},m.$$arity=-1),t.def(At,"$public_methods",y=function(e){return null==e&&(e=!0),a(e)?t.methods(this):t.receiver_methods(this)},y.$$arity=-1),t.def(At,"$Array",g=function(t){var e;return t===r?[]:t.$$is_array?t:(e=i(xt,"Opal")["$coerce_to?"](t,i(xt,"Array"),"to_ary"))!==r?e:(e=i(xt,"Opal")["$coerce_to?"](t,i(xt,"Array"),"to_a"))!==r?e:[t]},g.$$arity=1),t.def(At,"$at_exit",v=function(){var t,e=v.$$p,n=e||r;return null==o.__at_exit__&&(o.__at_exit__=r),e&&(v.$$p=null),e&&(v.$$p=null),o.__at_exit__=a(t=o.__at_exit__)?t:[],o.__at_exit__["$<<"](n)},v.$$arity=0),t.def(At,"$caller",b=function(e){return t.slice.call(arguments,0,arguments.length),[]},b.$$arity=-1),t.def(At,"$class",A=function(){return this.$$class},A.$$arity=0),t.def(At,"$copy_instance_variables",x=function(t){var e,r,n,i=Object.keys(t);for(e=0,r=i.length;e<r;e++)"$"!==(n=i[e]).charAt(0)&&t.hasOwnProperty(n)&&(this[n]=t[n])},x.$$arity=1),t.def(At,"$copy_singleton_methods",w=function(e){var r,n,i,s;if(e.hasOwnProperty("$$meta")){var a=t.get_singleton_class(e),o=t.get_singleton_class(this);for(r=0,s=(i=Object.getOwnPropertyNames(a.$$prototype)).length;r<s;r++)n=i[r],t.is_method(n)&&(o.$$prototype[n]=a.$$prototype[n]);o.$$const=Object.assign({},a.$$const),Object.setPrototypeOf(o.$$prototype,Object.getPrototypeOf(a.$$prototype))}for(r=0,s=(i=Object.getOwnPropertyNames(e)).length;r<s;r++)"$"===(n=i[r]).charAt(0)&&"$"!==n.charAt(1)&&e.hasOwnProperty(n)&&(this[n]=e[n])},w.$$arity=1),t.def(At,"$clone",k=function(e){var n=r;if(null==e)e=c([],{});else if(!e.$$is_hash)throw t.ArgumentError.$new("expected kwargs");return null==e.$$smap.freeze&&!0,(n=this.$class().$allocate()).$copy_instance_variables(this),n.$copy_singleton_methods(this),n.$initialize_clone(this),n},k.$$arity=-1),t.def(At,"$initialize_clone",E=function(t){return this.$initialize_copy(t)},E.$$arity=1),t.def(At,"$define_singleton_method",S=function(t,e){var n=S.$$p,i=n||r;return n&&(S.$$p=null),n&&(S.$$p=null),l(this.$singleton_class(),"define_method",[t,e],i.$to_proc())},S.$$arity=-2),t.def(At,"$dup",N=function(){var t=r;return(t=this.$class().$allocate()).$copy_instance_variables(this),t.$initialize_dup(this),t},N.$$arity=0),t.def(At,"$initialize_dup",I=function(t){return this.$initialize_copy(t)},I.$$arity=1),t.def(At,"$enum_for",C=function(e,n){var s,a,o,c=C.$$p,u=c||r,f=this;return c&&(C.$$p=null),c&&(C.$$p=null),(s=t.slice.call(arguments,0,arguments.length)).length>0&&(a=s[0],s.splice(0,1)),null==a&&(a="each"),o=s,l(i(xt,"Enumerator"),"for",[f,a].concat(t.to_a(o)),u.$to_proc())},C.$$arity=-1),t.alias(At,"to_enum","enum_for"),t.def(At,"$equal?",O=function(t){return this===t},O.$$arity=1),t.def(At,"$exit",B=function(e){var n;for(null==o.__at_exit__&&(o.__at_exit__=r),null==e&&(e=!0),o.__at_exit__=a(n=o.__at_exit__)?n:[];!a(o.__at_exit__["$empty?"]());)o.__at_exit__.$pop().$call();return e=e.$$is_boolean?e?0:1:i(xt,"Opal").$coerce_to(e,i(xt,"Integer"),"to_int"),t.exit(e),r},B.$$arity=-1),t.def(At,"$extend",M=function(e){var r;r=t.slice.call(arguments,0,arguments.length);for(var n=this.$singleton_class(),s=r.length-1;s>=0;s--){var a=r[s];a.$$is_module||this.$raise(i(xt,"TypeError"),"wrong argument type "+a.$class()+" (expected Module)"),a.$append_features(n),a.$extend_object(this),a.$extended(this)}return this},M.$$arity=-1),t.def(At,"$hash",P=function(){return this.$__id__()},P.$$arity=0),t.def(At,"$initialize_copy",F=function(t){return r},F.$$arity=1),t.def(At,"$inspect",L=function(){return this.$to_s()},L.$$arity=0),t.def(At,"$instance_of?",T=function(t){return t.$$is_class||t.$$is_module||this.$raise(i(xt,"TypeError"),"class or module required"),this.$$class===t},T.$$arity=1),t.def(At,"$instance_variable_defined?",j=function(e){return e=i(xt,"Opal")["$instance_variable_name!"](e),t.hasOwnProperty.call(this,e.substr(1))},j.$$arity=1),t.def(At,"$instance_variable_get",R=function(e){e=i(xt,"Opal")["$instance_variable_name!"](e);var n=this[t.ivar(e.substr(1))];return null==n?r:n},R.$$arity=1),t.def(At,"$instance_variable_set",D=function(e,r){return e=i(xt,"Opal")["$instance_variable_name!"](e),this[t.ivar(e.substr(1))]=r},D.$$arity=2),t.def(At,"$remove_instance_variable",z=function(e){e=i(xt,"Opal")["$instance_variable_name!"](e);var r,n=t.ivar(e.substr(1));return this.hasOwnProperty(n)?(r=this[n],delete this[n],r):this.$raise(i(xt,"NameError"),"instance variable "+e+" not defined")},z.$$arity=1),t.def(At,"$instance_variables",U=function(){var t,e=[];for(var r in this)this.hasOwnProperty(r)&&"$"!==r.charAt(0)&&(t="$"===r.substr(-1)?r.slice(0,r.length-1):r,e.push("@"+t));return e},U.$$arity=0),t.def(At,"$Integer",q=function(t,e){var n,s,a,o=this;return t.$$is_string?"0"===t?0:(void 0===e?e=0:(1===(e=i(xt,"Opal").$coerce_to(e,i(xt,"Integer"),"to_int"))||e<0||e>36)&&o.$raise(i(xt,"ArgumentError"),"invalid radix "+e),s=(s=(s=t.toLowerCase()).replace(/(\d)_(?=\d)/g,"$1")).replace(/^(\s*[+-]?)(0[bodx]?)/,function(r,n,s){switch(s){case"0b":if(0===e||2===e)return e=2,n;case"0":case"0o":if(0===e||8===e)return e=8,n;case"0d":if(0===e||10===e)return e=10,n;case"0x":if(0===e||16===e)return e=16,n}o.$raise(i(xt,"ArgumentError"),'invalid value for Integer(): "'+t+'"')}),a="0-"+((e=0===e?10:e)<=10?e-1:"9a-"+String.fromCharCode(e-11+97)),new RegExp("^\\s*[+-]?["+a+"]+\\s*$").test(s)||o.$raise(i(xt,"ArgumentError"),'invalid value for Integer(): "'+t+'"'),n=parseInt(s,e),isNaN(n)&&o.$raise(i(xt,"ArgumentError"),'invalid value for Integer(): "'+t+'"'),n):(void 0!==e&&o.$raise(i(xt,"ArgumentError"),"base specified for non string value"),t===r&&o.$raise(i(xt,"TypeError"),"can't convert nil into Integer"),t.$$is_number?((t===1/0||t===-1/0||isNaN(t))&&o.$raise(i(xt,"FloatDomainError"),t),Math.floor(t)):t["$respond_to?"]("to_int")&&(n=t.$to_int())!==r?n:i(xt,"Opal")["$coerce_to!"](t,i(xt,"Integer"),"to_i"))},q.$$arity=-2),t.def(At,"$Float",H=function(t){var e;return t===r&&this.$raise(i(xt,"TypeError"),"can't convert nil into Float"),t.$$is_string?(e=(e=t.toString()).replace(/(\d)_(?=\d)/g,"$1"),/^\s*[-+]?0[xX][0-9a-fA-F]+\s*$/.test(e)?this.$Integer(e):(/^\s*[-+]?[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?\s*$/.test(e)||this.$raise(i(xt,"ArgumentError"),'invalid value for Float(): "'+t+'"'),parseFloat(e))):i(xt,"Opal")["$coerce_to!"](t,i(xt,"Float"),"to_f")},H.$$arity=1),t.def(At,"$Hash",Q=function(t){var e;return a(a(e=t["$nil?"]())?e:t["$=="]([]))?c([],{}):a(i(xt,"Hash")["$==="](t))?t:i(xt,"Opal")["$coerce_to!"](t,i(xt,"Hash"),"to_hash")},Q.$$arity=1),t.def(At,"$is_a?",Y=function(e){return e.$$is_class||e.$$is_module||this.$raise(i(xt,"TypeError"),"class or module required"),t.is_a(this,e)},Y.$$arity=1),t.def(At,"$itself",G=function(){return this},G.$$arity=0),t.alias(At,"kind_of?","is_a?"),t.def(At,"$lambda",V=function(){var e=V.$$p,n=e||r;return e&&(V.$$p=null),e&&(V.$$p=null),t.lambda(n)},V.$$arity=0),t.def(At,"$load",J=function(e){return e=i(xt,"Opal")["$coerce_to!"](e,i(xt,"String"),"to_str"),t.load(e)},J.$$arity=1),t.def(At,"$loop",X=function(){var e,s=X.$$p,o=s||r,c=r;if(s&&(X.$$p=null),o===r)return l(this,"enum_for",["loop"],((e=function(){e.$$s;return n(i(xt,"Float"),"INFINITY")}).$$s=this,e.$$arity=0,e));for(;a(!0);)try{t.yieldX(o,[])}catch(e){if(!t.rescue(e,[i(xt,"StopIteration")]))throw e;c=e;try{return c.$result()}finally{t.pop_exception()}}return this},X.$$arity=0),t.def(At,"$nil?",W=function(){return!1},W.$$arity=0),t.alias(At,"object_id","__id__"),t.def(At,"$printf",K=function(e){var n,i;return n=t.slice.call(arguments,0,arguments.length),a((i=n)["$any?"]())&&this.$print(l(this,"format",t.to_a(i))),r},K.$$arity=-1),t.def(At,"$proc",Z=function(){var t=Z.$$p,e=t||r;return t&&(Z.$$p=null),t&&(Z.$$p=null),a(e)||this.$raise(i(xt,"ArgumentError"),"tried to create Proc object without a block"),e.$$is_lambda=!1,e},Z.$$arity=0),t.def(At,"$puts",tt=function(e){var n;return null==o.stdout&&(o.stdout=r),n=t.slice.call(arguments,0,arguments.length),l(o.stdout,"puts",t.to_a(n))},tt.$$arity=-1),t.def(At,"$p",et=function(e){var n,i,s,c,u;return n=t.slice.call(arguments,0,arguments.length),l(i=n,"each",[],((s=function(t){s.$$s;return null==o.stdout&&(o.stdout=r),null==t&&(t=r),o.stdout.$puts(t.$inspect())}).$$s=this,s.$$arity=1,s)),a((c=i.$length(),u=1,"number"==typeof c&&"number"==typeof u?c<=u:c["$<="](u)))?i["$[]"](0):i},et.$$arity=-1),t.def(At,"$print",rt=function(e){var n;return null==o.stdout&&(o.stdout=r),n=t.slice.call(arguments,0,arguments.length),l(o.stdout,"print",t.to_a(n))},rt.$$arity=-1),t.def(At,"$warn",nt=function(e){var n,i;return null==o.VERBOSE&&(o.VERBOSE=r),null==o.stderr&&(o.stderr=r),n=t.slice.call(arguments,0,arguments.length),a(a(i=o.VERBOSE["$nil?"]())?i:n["$empty?"]())?r:l(o.stderr,"puts",t.to_a(n))},nt.$$arity=-1),t.def(At,"$raise",it=function(e,n,s){if(null==o["!"]&&(o["!"]=r),null==n&&(n=r),null==s&&(s=r),null==e&&o["!"]!==r)throw o["!"];throw null==e?e=i(xt,"RuntimeError").$new():e.$$is_string?e=i(xt,"RuntimeError").$new(e):e.$$is_class&&e["$respond_to?"]("exception")?e=e.$exception(n):e["$is_a?"](i(xt,"Exception"))||(e=i(xt,"TypeError").$new("exception class/object expected")),o["!"]!==r&&t.exceptions.push(o["!"]),o["!"]=e,e},it.$$arity=-1),t.alias(At,"fail","raise"),t.def(At,"$rand",st=function(t){return void 0===t?n(i(xt,"Random"),"DEFAULT").$rand():(t.$$is_number&&(t<0&&(t=Math.abs(t)),t%1!=0&&(t=t.$to_i()),0===t&&(t=void 0)),n(i(xt,"Random"),"DEFAULT").$rand(t))},st.$$arity=-1),t.def(At,"$respond_to?",at=function(t,e){if(null==e&&(e=!1),a(this["$respond_to_missing?"](t,e)))return!0;var r=this["$"+t];return"function"==typeof r&&!r.$$stub},at.$$arity=-2),t.def(At,"$respond_to_missing?",ot=function(t,e){return null==e&&(e=!1),!1},ot.$$arity=-2),t.def(At,"$require",ct=function(e){return e=i(xt,"Opal")["$coerce_to!"](e,i(xt,"String"),"to_str"),t.require(e)},ct.$$arity=1),t.def(At,"$require_relative",lt=function(e){return i(xt,"Opal")["$try_convert!"](e,i(xt,"String"),"to_str"),e=i(xt,"File").$expand_path(i(xt,"File").$join(t.current_file,"..",e)),t.require(e)},lt.$$arity=1),t.def(At,"$require_tree",ut=function(e){var r=[];for(var n in e=i(xt,"File").$expand_path(e),"."===(e=t.normalize(e))&&(e=""),t.modules)n["$start_with?"](e)&&r.push([n,t.require(n)]);return r},ut.$$arity=1),t.alias(At,"send","__send__"),t.alias(At,"public_send","__send__"),t.def(At,"$singleton_class",ft=function(){return t.get_singleton_class(this)},ft.$$arity=0),t.def(At,"$sleep",$t=function(e){null==e&&(e=r),e===r&&this.$raise(i(xt,"TypeError"),"can't convert NilClass into time interval"),e.$$is_number||this.$raise(i(xt,"TypeError"),"can't convert "+e.$class()+" into time interval"),e<0&&this.$raise(i(xt,"ArgumentError"),"time interval must be positive");for(var n=t.global.performance?function(){return performance.now()}:function(){return new Date},s=n();n()-s<=1e3*e;);return e},$t.$$arity=-1),t.def(At,"$srand",ht=function(t){return null==t&&(t=i(xt,"Random").$new_seed()),i(xt,"Random").$srand(t)},ht.$$arity=-1),t.def(At,"$String",pt=function(t){var e;return a(e=i(xt,"Opal")["$coerce_to?"](t,i(xt,"String"),"to_str"))?e:i(xt,"Opal")["$coerce_to!"](t,i(xt,"String"),"to_s")},pt.$$arity=1),t.def(At,"$tap",dt=function(){var e=dt.$$p,n=e||r;return e&&(dt.$$p=null),e&&(dt.$$p=null),t.yield1(n,this),this},dt.$$arity=0),t.def(At,"$to_proc",_t=function(){return this},_t.$$arity=0),t.def(At,"$to_s",mt=function(){return"#<"+this.$class()+":0x"+this.$__id__().$to_s(16)+">"},mt.$$arity=0),t.def(At,"$catch",yt=function(e){var n=yt.$$p,s=n||r,a=r;n&&(yt.$$p=null);try{return t.yieldX(s,[])}catch(r){if(!t.rescue(r,[i(xt,"UncaughtThrowError")]))throw r;a=r;try{return a.$sym()["$=="](e)?a.$arg():this.$raise()}finally{t.pop_exception()}}},yt.$$arity=1),t.def(At,"$throw",gt=function(e){var r;return r=t.slice.call(arguments,0,arguments.length),this.$raise(i(xt,"UncaughtThrowError"),r)},gt.$$arity=-1),t.def(At,"$open",vt=function(e){var n,s=vt.$$p,a=s||r;return s&&(vt.$$p=null),s&&(vt.$$p=null),n=t.slice.call(arguments,0,arguments.length),l(i(xt,"File"),"open",t.to_a(n),a.$to_proc())},vt.$$arity=-1),t.def(At,"$yield_self",bt=function(){var e,n=bt.$$p,i=n||r;return n&&(bt.$$p=null),i===r?l(this,"enum_for",["yield_self"],((e=function(){e.$$s;return 1}).$$s=this,e.$$arity=0,e)):t.yield1(i,this)},bt.$$arity=0)}(e[0],e),function(t,e,r){var n=u(t,null,"Object"),s=[n].concat(r);return n.$include(i(s,"Kernel"))}(e[0],0,e)},Opal.modules["corelib/error"]=function(t){t.top;var e=[],r=t.nil,n=(t.const_get_qualified,t.const_get_relative),i=(t.breaker,t.slice,t.klass),s=t.send,a=t.truthy,o=t.module,c=t.hash2;return t.add_stubs(["$new","$clone","$to_s","$empty?","$class","$raise","$+","$attr_reader","$[]","$>","$length","$inspect"]),function(e,o,c){var l,u,f,$,h,p,d,_,m,y,g=i(e,o,"Exception"),v=[g].concat(c);g.$$prototype.message=r,t.defs(g,"$new",l=function(e){var n,i=(n=t.slice.call(arguments,0,arguments.length)).length>0?n[0]:r,s=new this.$$constructor(i);return s.name=this.$$name,s.message=i,t.send(s,s.$initialize,n),t.config.enable_stack_trace&&Error.captureStackTrace&&Error.captureStackTrace(s,y),s},l.$$arity=-1),y=g.$new,t.defs(g,"$exception",u=function(e){var r;return r=t.slice.call(arguments,0,arguments.length),s(this,"new",t.to_a(r))},u.$$arity=-1),t.def(g,"$initialize",f=function(e){var n;return n=t.slice.call(arguments,0,arguments.length),this.message=n.length>0?n[0]:r},f.$$arity=-1),t.def(g,"$backtrace",$=function(){if(this.backtrace)return this.backtrace;var t=this.stack;return"string"==typeof t?t.split("\n").slice(0,15):t?t.slice(0,15):[]},$.$$arity=0),t.def(g,"$exception",h=function(t){if(null==t&&(t=r),t===r||this===t)return this;var e=this.$clone();return e.message=t,e.stack=this.stack,e},h.$$arity=-1),t.def(g,"$message",p=function(){return this.$to_s()},p.$$arity=0),t.def(g,"$inspect",d=function(){var t=r;return t=this.$to_s(),a(t["$empty?"]())?this.$class().$to_s():"#<"+this.$class().$to_s()+": "+this.$to_s()+">"},d.$$arity=0),t.def(g,"$set_backtrace",_=function(t){var e,i,s=!0;if(t===r)this.backtrace=r,this.stack="";else if(t.$$is_string)this.backtrace=[t],this.stack=t;else{if(t.$$is_array){for(e=0,i=t.length;e<i;e++)if(!t[e].$$is_string){s=!1;break}}else s=!1;!1===s&&this.$raise(n(v,"TypeError"),"backtrace must be Array of String"),this.backtrace=t,this.stack=t.join("\n")}return t},_.$$arity=1),t.def(g,"$to_s",m=function(){var t,e;return a(t=a(e=this.message)?this.message.$to_s():e)?t:this.$class().$to_s()},m.$$arity=0)}(e[0],Error,e),function(t,e,r){[i(t,e,"ScriptError")].concat(r)}(e[0],n(e,"Exception"),e),function(t,e,r){[i(t,e,"SyntaxError")].concat(r)}(e[0],n(e,"ScriptError"),e),function(t,e,r){[i(t,e,"LoadError")].concat(r)}(e[0],n(e,"ScriptError"),e),function(t,e,r){[i(t,e,"NotImplementedError")].concat(r)}(e[0],n(e,"ScriptError"),e),function(t,e,r){[i(t,e,"SystemExit")].concat(r)}(e[0],n(e,"Exception"),e),function(t,e,r){[i(t,e,"NoMemoryError")].concat(r)}(e[0],n(e,"Exception"),e),function(t,e,r){[i(t,e,"SignalException")].concat(r)}(e[0],n(e,"Exception"),e),function(t,e,r){[i(t,e,"Interrupt")].concat(r)}(e[0],n(e,"Exception"),e),function(t,e,r){[i(t,e,"SecurityError")].concat(r)}(e[0],n(e,"Exception"),e),function(t,e,r){[i(t,e,"StandardError")].concat(r)}(e[0],n(e,"Exception"),e),function(t,e,r){[i(t,e,"EncodingError")].concat(r)}(e[0],n(e,"StandardError"),e),function(t,e,r){[i(t,e,"ZeroDivisionError")].concat(r)}(e[0],n(e,"StandardError"),e),function(t,e,r){[i(t,e,"NameError")].concat(r)}(e[0],n(e,"StandardError"),e),function(t,e,r){[i(t,e,"NoMethodError")].concat(r)}(e[0],n(e,"NameError"),e),function(t,e,r){[i(t,e,"RuntimeError")].concat(r)}(e[0],n(e,"StandardError"),e),function(t,e,r){[i(t,e,"FrozenError")].concat(r)}(e[0],n(e,"RuntimeError"),e),function(t,e,r){[i(t,e,"LocalJumpError")].concat(r)}(e[0],n(e,"StandardError"),e),function(t,e,r){[i(t,e,"TypeError")].concat(r)}(e[0],n(e,"StandardError"),e),function(t,e,r){[i(t,e,"ArgumentError")].concat(r)}(e[0],n(e,"StandardError"),e),function(t,e,r){[i(t,e,"IndexError")].concat(r)}(e[0],n(e,"StandardError"),e),function(t,e,r){[i(t,e,"StopIteration")].concat(r)}(e[0],n(e,"IndexError"),e),function(t,e,r){[i(t,e,"KeyError")].concat(r)}(e[0],n(e,"IndexError"),e),function(t,e,r){[i(t,e,"RangeError")].concat(r)}(e[0],n(e,"StandardError"),e),function(t,e,r){[i(t,e,"FloatDomainError")].concat(r)}(e[0],n(e,"RangeError"),e),function(t,e,r){[i(t,e,"IOError")].concat(r)}(e[0],n(e,"StandardError"),e),function(t,e,r){[i(t,e,"SystemCallError")].concat(r)}(e[0],n(e,"StandardError"),e),function(e,c){var l=[o(e,"Errno")].concat(c);!function(e,n,o){var c,l=i(e,n,"EINVAL");[l].concat(o);t.defs(l,"$new",c=function(e){var n,i,o=c.$$p,l=r;return o&&(c.$$p=null),null==e&&(e=r),l="Invalid argument",a(e)&&(i=" - "+e,l="number"==typeof(n=l)&&"number"==typeof i?n+i:n["$+"](i)),s(this,t.find_super_dispatcher(this,"new",c,!1,this.$$class.$$prototype),[l],null)},c.$$arity=-1)}(l[0],n(l,"SystemCallError"),l)}(e[0],e),function(e,n,o){var c,l=i(e,n,"UncaughtThrowError");[l].concat(o);l.$$prototype.sym=r,l.$attr_reader("sym","arg"),t.def(l,"$initialize",c=function(e){var r,n,i=c.$$p;return i&&(c.$$p=null),this.sym=e["$[]"](0),a((r=e.$length(),n=1,"number"==typeof r&&"number"==typeof n?r>n:r["$>"](n)))&&(this.arg=e["$[]"](1)),s(this,t.find_super_dispatcher(this,"initialize",c,!1),["uncaught throw "+this.sym.$inspect()],null)},c.$$arity=1)}(e[0],n(e,"ArgumentError"),e),function(e,n,a){var o,c=i(e,null,"NameError");[c].concat(a);c.$attr_reader("name"),t.def(c,"$initialize",o=function(e,n){var i=o.$$p;return i&&(o.$$p=null),null==n&&(n=r),s(this,t.find_super_dispatcher(this,"initialize",o,!1),[e],null),this.name=n},o.$$arity=-2)}(e[0],0,e),function(e,n,a){var o,c=i(e,null,"NoMethodError");[c].concat(a);c.$attr_reader("args"),t.def(c,"$initialize",o=function(e,n,i){var a=o.$$p;return a&&(o.$$p=null),null==n&&(n=r),null==i&&(i=[]),s(this,t.find_super_dispatcher(this,"initialize",o,!1),[e,n],null),this.args=i},o.$$arity=-2)}(e[0],0,e),function(t,e,r){var n=i(t,null,"StopIteration");[n].concat(r);n.$attr_reader("result")}(e[0],0,e),function(e,o,l){var u,f,$,h=i(e,null,"KeyError"),p=[h].concat(l);h.$$prototype.receiver=h.$$prototype.key=r,t.def(h,"$initialize",u=function(e,n){var i,a,o=u.$$p;if(o&&(u.$$p=null),null==n)n=c([],{});else if(!n.$$is_hash)throw t.ArgumentError.$new("expected kwargs");return null==(i=n.$$smap.receiver)&&(i=r),null==(a=n.$$smap.key)&&(a=r),s(this,t.find_super_dispatcher(this,"initialize",u,!1),[e],null),this.receiver=i,this.key=a},u.$$arity=-2),t.def(h,"$receiver",f=function(){var t;return a(t=this.receiver)?t:this.$raise(n(p,"ArgumentError"),"no receiver is available")},f.$$arity=0),t.def(h,"$key",$=function(){var t;return a(t=this.key)?t:this.$raise(n(p,"ArgumentError"),"no key is available")},$.$$arity=0)}(e[0],0,e),function(t,e){var r=[o(t,"JS")].concat(e);!function(t,e,r){[i(t,null,"Error")].concat(r)}(r[0],0,r)}(e[0],e)},Opal.modules["corelib/constants"]=function(t){t.top;var e=[],r=(t.nil,t.const_get_qualified,t.const_get_relative);t.breaker,t.slice;return t.const_set(e[0],"RUBY_PLATFORM","opal"),t.const_set(e[0],"RUBY_ENGINE","opal"),t.const_set(e[0],"RUBY_VERSION","2.5.7"),t.const_set(e[0],"RUBY_ENGINE_VERSION","1.0.3"),t.const_set(e[0],"RUBY_RELEASE_DATE","2020-02-01"),t.const_set(e[0],"RUBY_PATCHLEVEL",0),t.const_set(e[0],"RUBY_REVISION",0),t.const_set(e[0],"RUBY_COPYRIGHT","opal - Copyright (C) 2013-2020 Adam Beynon and the Opal contributors"),t.const_set(e[0],"RUBY_DESCRIPTION","opal "+r(e,"RUBY_ENGINE_VERSION")+" ("+r(e,"RUBY_RELEASE_DATE")+" revision "+r(e,"RUBY_REVISION")+")")},Opal.modules["opal/base"]=function(t){var e=t.top;t.nil,t.const_get_qualified,t.const_get_relative,t.breaker,t.slice;return t.add_stubs(["$require"]),e.$require("corelib/runtime"),e.$require("corelib/helpers"),e.$require("corelib/module"),e.$require("corelib/class"),e.$require("corelib/basic_object"),e.$require("corelib/kernel"),e.$require("corelib/error"),e.$require("corelib/constants")},Opal.modules["corelib/nil"]=function(t){t.top;var e=[],r=t.nil,n=(t.const_get_qualified,t.const_get_relative),i=(t.breaker,t.slice,t.klass),s=t.hash2,a=t.truthy;return t.add_stubs(["$raise","$name","$new","$>","$length","$Rational"]),function(e,o,c){var l,u,f,$,h,p,d,_,m,y,g,v,b,A,x,w,k,E,S=i(e,null,"NilClass"),N=[S].concat(c);S.$$prototype.$$meta=S,function(e,r){var i,s=[e].concat(r);t.def(e,"$allocate",i=function(){return this.$raise(n(s,"TypeError"),"allocator undefined for "+this.$name())},i.$$arity=0),t.udef(e,"$new")}(t.get_singleton_class(S),N),t.def(S,"$!",l=function(){return!0},l.$$arity=0),t.def(S,"$&",u=function(t){return!1},u.$$arity=1),t.def(S,"$|",f=function(t){return!1!==t&&t!==r},f.$$arity=1),t.def(S,"$^",$=function(t){return!1!==t&&t!==r},$.$$arity=1),t.def(S,"$==",h=function(t){return t===r},h.$$arity=1),t.def(S,"$dup",p=function(){return r},p.$$arity=0),t.def(S,"$clone",d=function(e){if(null==e)e=s([],{});else if(!e.$$is_hash)throw t.ArgumentError.$new("expected kwargs");return null==e.$$smap.freeze&&!0,r},d.$$arity=-1),t.def(S,"$inspect",_=function(){return"nil"},_.$$arity=0),t.def(S,"$nil?",m=function(){return!0},m.$$arity=0),t.def(S,"$singleton_class",y=function(){return n(N,"NilClass")},y.$$arity=0),t.def(S,"$to_a",g=function(){return[]},g.$$arity=0),t.def(S,"$to_h",v=function(){return t.hash()},v.$$arity=0),t.def(S,"$to_i",b=function(){return 0},b.$$arity=0),t.alias(S,"to_f","to_i"),t.def(S,"$to_s",A=function(){return""},A.$$arity=0),t.def(S,"$to_c",x=function(){return n(N,"Complex").$new(0,0)},x.$$arity=0),t.def(S,"$rationalize",w=function(e){var r,i,s;return r=t.slice.call(arguments,0,arguments.length),a((i=r.$length(),s=1,"number"==typeof i&&"number"==typeof s?i>s:i["$>"](s)))&&this.$raise(n(N,"ArgumentError")),this.$Rational(0,1)},w.$$arity=-1),t.def(S,"$to_r",k=function(){return this.$Rational(0,1)},k.$$arity=0),t.def(S,"$instance_variables",E=function(){return[]},E.$$arity=0)}(e[0],0,e),t.const_set(e[0],"NIL",r)},Opal.modules["corelib/boolean"]=function(t){t.top;var e=[],r=t.nil,n=(t.const_get_qualified,t.const_get_relative),i=(t.breaker,t.slice,t.klass),s=t.hash2;return t.add_stubs(["$raise","$name"]),function(e,a,o){var c,l,u,f,$,h,p,d,_,m,y=i(e,a,"Boolean"),g=[y].concat(o);t.defineProperty(y.$$prototype,"$$is_boolean",!0),t.defineProperty(y.$$prototype,"$$meta",y),function(e,r){var i,s=[e].concat(r);t.def(e,"$allocate",i=function(){return this.$raise(n(s,"TypeError"),"allocator undefined for "+this.$name())},i.$$arity=0),t.udef(e,"$new")}(t.get_singleton_class(y),g),t.def(y,"$__id__",c=function(){return this.valueOf()?2:0},c.$$arity=0),t.alias(y,"object_id","__id__"),t.def(y,"$!",l=function(){return 1!=this},l.$$arity=0),t.def(y,"$&",u=function(t){return 1==this&&(!1!==t&&t!==r)},u.$$arity=1),t.def(y,"$|",f=function(t){return 1==this||!1!==t&&t!==r},f.$$arity=1),t.def(y,"$^",$=function(t){return 1==this?!1===t||t===r:!1!==t&&t!==r},$.$$arity=1),t.def(y,"$==",h=function(t){return 1==this===t.valueOf()},h.$$arity=1),t.alias(y,"equal?","=="),t.alias(y,"eql?","=="),t.def(y,"$singleton_class",p=function(){return n(g,"Boolean")},p.$$arity=0),t.def(y,"$to_s",d=function(){return 1==this?"true":"false"},d.$$arity=0),t.def(y,"$dup",_=function(){return this},_.$$arity=0),t.def(y,"$clone",m=function(e){if(null==e)e=s([],{});else if(!e.$$is_hash)throw t.ArgumentError.$new("expected kwargs");return null==e.$$smap.freeze&&!0,this},m.$$arity=-1)}(e[0],Boolean,e),t.const_set(e[0],"TrueClass",n(e,"Boolean")),t.const_set(e[0],"FalseClass",n(e,"Boolean")),t.const_set(e[0],"TRUE",!0),t.const_set(e[0],"FALSE",!1)},Opal.modules["corelib/comparable"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t>e:t["$>"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t<e:t["$<"](e)}t.top;var n=[],i=t.nil,s=(t.const_get_qualified,t.const_get_relative),a=(t.breaker,t.slice,t.module),o=t.truthy;return t.add_stubs(["$>","$<","$===","$raise","$class","$equal?","$<=>"]),function(n,c){var l,u,f,$,h,p,d,_=a(n,"Comparable"),m=[_].concat(c),y=i;function g(n){return t.is_a(n,t.Integer)?n:e(n,0)?1:r(n,0)?-1:0}function v(t,e){var r;y=e,r=i["$==="](y)||(!0)["$==="](y)||(!1)["$==="](y)||s(m,"Integer")["$==="](y)||s(m,"Float")["$==="](y)?e.$inspect():e.$$class,_.$raise(s(m,"ArgumentError"),"comparison of "+t.$class()+" with "+r+" failed")}t.def(_,"$==",l=function(e){var r;return!!o(this["$equal?"](e))||this["$<=>"]!=t.Kernel["$<=>"]&&(this.$$comparable?(delete this.$$comparable,!1):!!o(r=this["$<=>"](e))&&0==g(r))},l.$$arity=1),t.def(_,"$>",u=function(t){var e;return o(e=this["$<=>"](t))||v(this,t),g(e)>0},u.$$arity=1),t.def(_,"$>=",f=function(t){var e;return o(e=this["$<=>"](t))||v(this,t),g(e)>=0},f.$$arity=1),t.def(_,"$<",$=function(t){var e;return o(e=this["$<=>"](t))||v(this,t),g(e)<0},$.$$arity=1),t.def(_,"$<=",h=function(t){var e;return o(e=this["$<=>"](t))||v(this,t),g(e)<=0},h.$$arity=1),t.def(_,"$between?",p=function(t,n){return!r(this,t)&&!e(this,n)},p.$$arity=2),t.def(_,"$clamp",d=function(t,e){var r;return r=t["$<=>"](e),o(r)||v(t,e),o(g(r)>0)&&this.$raise(s(m,"ArgumentError"),"min argument must be smaller than max argument"),o(g(this["$<=>"](t))<0)?t:o(g(this["$<=>"](e))>0)?e:this},d.$$arity=2)}(n[0],n)},Opal.modules["corelib/regexp"]=function(t){t.top;var e=[],r=t.nil,n=(t.const_get_qualified,t.const_get_relative),i=(t.breaker,t.slice,t.klass),s=t.send,a=t.truthy,o=t.gvars;return t.add_stubs(["$nil?","$[]","$raise","$escape","$options","$to_str","$new","$join","$coerce_to!","$!","$match","$coerce_to?","$begin","$coerce_to","$=~","$attr_reader","$===","$inspect","$to_a"]),function(t,e,r){[i(t,e,"RegexpError")].concat(r)}(e[0],n(e,"StandardError"),e),function(e,c,l){var u,f,$,h,p,d,_,m,y,g,v=i(e,c,"Regexp"),b=[v].concat(l);t.const_set(b[0],"IGNORECASE",1),t.const_set(b[0],"EXTENDED",2),t.const_set(b[0],"MULTILINE",4),t.defineProperty(v.$$prototype,"$$is_regexp",!0),function(e,i){var c,l,u,f,$,h=[e].concat(i);t.def(e,"$allocate",c=function(){var e,n=c.$$p,i=r,a=r,o=r;for(n&&(c.$$p=null),o=0,e=arguments.length,a=new Array(e);o<e;o++)a[o]=arguments[o];return(i=s(this,t.find_super_dispatcher(this,"allocate",c,!1),a,n)).uninitialized=!0,i},c.$$arity=0),t.def(e,"$escape",l=function(e){return t.escape_regexp(e)},l.$$arity=1),t.def(e,"$last_match",u=function(t){return null==o["~"]&&(o["~"]=r),null==t&&(t=r),a(t["$nil?"]())?o["~"]:o["~"]["$[]"](t)},u.$$arity=-1),t.alias(e,"quote","escape"),t.def(e,"$union",f=function(e){var r,i,s,a,o,c;if(0==(r=t.slice.call(arguments,0,arguments.length)).length)return/(?!)/;if(1==r.length&&r[0].$$is_regexp)return r[0];i=r[0].$$is_array,r.length>1&&i&&this.$raise(n(h,"TypeError"),"no implicit conversion of Array into String"),i&&(r=r[0]),o=void 0,s=[];for(var l=0;l<r.length;l++)(a=r[l]).$$is_string?s.push(this.$escape(a)):a.$$is_regexp?(c=a.$options(),null!=o&&o!=c&&this.$raise(n(h,"TypeError"),"All expressions must use the same options"),o=c,s.push("("+a.source+")")):s.push(this.$escape(a.$to_str()));return this.$new(s.$join("|"),o)},f.$$arity=-1),t.def(e,"$new",$=function(t,e){if(t.$$is_regexp)return new RegExp(t);if("\\"===(t=n(h,"Opal")["$coerce_to!"](t,n(h,"String"),"to_str")).charAt(t.length-1)&&"\\"!==t.charAt(t.length-2)&&this.$raise(n(h,"RegexpError"),"too short escape sequence: /"+t+"/"),void 0===e||e["$!"]())return new RegExp(t);if(e.$$is_number){var r="";n(h,"IGNORECASE")&e&&(r+="i"),n(h,"MULTILINE")&e&&(r+="m"),e=r}else e="i";return new RegExp(t,e)},$.$$arity=-2)}(t.get_singleton_class(v),b),t.def(v,"$==",u=function(t){return t instanceof RegExp&&this.toString()===t.toString()},u.$$arity=1),t.def(v,"$===",f=function(t){return this.$match(n(b,"Opal")["$coerce_to?"](t,n(b,"String"),"to_str"))!==r},f.$$arity=1),t.def(v,"$=~",$=function(t){var e;return null==o["~"]&&(o["~"]=r),a(e=this.$match(t))?o["~"].$begin(0):e},$.$$arity=1),t.alias(v,"eql?","=="),t.def(v,"$inspect",h=function(){var t=this.toString(),e=/^\/(.*)\/([^\/]*)$/.exec(t);if(e){for(var r=e[1],n=e[2],i=r.split(""),s=i.length,a=!1,o="",c=0;c<s;c++){var l=i[c];a||"/"!=l||(o=o.concat("\\")),o=o.concat(l),a="\\"==l&&!a}return"/"+o+"/"+n}return t},h.$$arity=0),t.def(v,"$match",p=function(e,i){var s=p.$$p,a=s||r;if(null==o["~"]&&(o["~"]=r),s&&(p.$$p=null),s&&(p.$$p=null),this.uninitialized&&this.$raise(n(b,"TypeError"),"uninitialized Regexp"),void 0===i){if(e===r)return o["~"]=r;var c=this.exec(n(b,"Opal").$coerce_to(e,n(b,"String"),"to_str"));return c?(o["~"]=n(b,"MatchData").$new(this,c),a===r?o["~"]:t.yield1(a,o["~"])):o["~"]=r}if(i=n(b,"Opal").$coerce_to(i,n(b,"Integer"),"to_int"),e===r)return o["~"]=r;if(e=n(b,"Opal").$coerce_to(e,n(b,"String"),"to_str"),i<0&&(i+=e.length)<0)return o["~"]=r;for(var l,u=t.global_regexp(this);;){if(null===(l=u.exec(e)))return o["~"]=r;if(l.index>=i)return o["~"]=n(b,"MatchData").$new(u,l),a===r?o["~"]:t.yield1(a,o["~"]);u.lastIndex=l.index+1}},p.$$arity=-2),t.def(v,"$match?",d=function(e,i){var s;return this.uninitialized&&this.$raise(n(b,"TypeError"),"uninitialized Regexp"),void 0===i?e!==r&&this.test(n(b,"Opal").$coerce_to(e,n(b,"String"),"to_str")):(i=n(b,"Opal").$coerce_to(i,n(b,"Integer"),"to_int"),e!==r&&(e=n(b,"Opal").$coerce_to(e,n(b,"String"),"to_str"),!(i<0&&(i+=e.length)<0)&&!(null===(s=t.global_regexp(this).exec(e))||s.index<i)))},d.$$arity=-2),t.def(v,"$~",_=function(){return null==o._&&(o._=r),this["$=~"](o._)},_.$$arity=0),t.def(v,"$source",m=function(){return this.source},m.$$arity=0),t.def(v,"$options",y=function(){this.uninitialized&&this.$raise(n(b,"TypeError"),"uninitialized Regexp");var t=0;return this.multiline&&(t|=n(b,"MULTILINE")),this.ignoreCase&&(t|=n(b,"IGNORECASE")),t},y.$$arity=0),t.def(v,"$casefold?",g=function(){return this.ignoreCase},g.$$arity=0),t.alias(v,"to_s","source")}(e[0],RegExp,e),function(e,c,l){var u,f,$,h,p,d,_,m,y,g,v,b,A=i(e,null,"MatchData"),x=[A].concat(l);return A.$$prototype.matches=r,A.$attr_reader("post_match","pre_match","regexp","string"),t.def(A,"$initialize",u=function(t,e){o["~"]=this,this.regexp=t,this.begin=e.index,this.string=e.input,this.pre_match=e.input.slice(0,e.index),this.post_match=e.input.slice(e.index+e[0].length),this.matches=[];for(var n=0,i=e.length;n<i;n++){var s=e[n];null==s?this.matches.push(r):this.matches.push(s)}},u.$$arity=2),t.def(A,"$[]",f=function(e){var r;return r=t.slice.call(arguments,0,arguments.length),s(this.matches,"[]",t.to_a(r))},f.$$arity=-1),t.def(A,"$offset",$=function(t){return 0!==t&&this.$raise(n(x,"ArgumentError"),"MatchData#offset only supports 0th element"),[this.begin,this.begin+this.matches[t].length]},$.$$arity=1),t.def(A,"$==",h=function(t){var e,r,i,s;return!!a(n(x,"MatchData")["$==="](t))&&(a(e=a(r=a(i=a(s=this.string==t.string)?this.regexp.toString()==t.regexp.toString():s)?this.pre_match==t.pre_match:i)?this.post_match==t.post_match:r)?this.begin==t.begin:e)},h.$$arity=1),t.alias(A,"eql?","=="),t.def(A,"$begin",p=function(t){return 0!==t&&this.$raise(n(x,"ArgumentError"),"MatchData#begin only supports 0th element"),this.begin},p.$$arity=1),t.def(A,"$end",d=function(t){return 0!==t&&this.$raise(n(x,"ArgumentError"),"MatchData#end only supports 0th element"),this.begin+this.matches[t].length},d.$$arity=1),t.def(A,"$captures",_=function(){return this.matches.slice(1)},_.$$arity=0),t.def(A,"$inspect",m=function(){for(var t="#<MatchData "+this.matches[0].$inspect(),e=1,r=this.matches.length;e<r;e++)t+=" "+e+":"+this.matches[e].$inspect();return t+">"},m.$$arity=0),t.def(A,"$length",y=function(){return this.matches.length},y.$$arity=0),t.alias(A,"size","length"),t.def(A,"$to_a",g=function(){return this.matches},g.$$arity=0),t.def(A,"$to_s",v=function(){return this.matches[0]},v.$$arity=0),t.def(A,"$values_at",b=function(e){var i;i=t.slice.call(arguments,0,arguments.length);var s,a,o,c=[];for(s=0;s<i.length;s++)i[s].$$is_range&&((a=i[s].$to_a()).unshift(s,1),Array.prototype.splice.apply(i,a)),(o=n(x,"Opal")["$coerce_to!"](i[s],n(x,"Integer"),"to_int"))<0&&(o+=this.matches.length)<0?c.push(r):c.push(this.matches[o]);return c},b.$$arity=-1),r&&"values_at"}(e[0],0,e)},Opal.modules["corelib/string"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t/e:t["$/"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}var n=t.top,i=[],s=t.nil,a=t.const_get_qualified,o=t.const_get_relative,c=(t.breaker,t.slice,t.klass),l=t.truthy,u=t.send,f=t.gvars;return t.add_stubs(["$require","$include","$coerce_to?","$coerce_to","$raise","$===","$format","$to_s","$respond_to?","$to_str","$<=>","$==","$=~","$new","$force_encoding","$casecmp","$empty?","$ljust","$ceil","$/","$+","$rjust","$floor","$to_a","$each_char","$to_proc","$coerce_to!","$copy_singleton_methods","$initialize_clone","$initialize_dup","$enum_for","$size","$chomp","$[]","$to_i","$each_line","$encoding","$class","$match","$match?","$captures","$proc","$succ","$escape"]),n.$require("corelib/comparable"),n.$require("corelib/regexp"),function(n,i,$){var h,p,d,_,m,y,g,v,b,A,x,w,k,E,S,N,I,C,O,B,M,P,F,L,T,j,R,D,z,U,q,H,Q,Y,G,V,J,X,W,K,Z,tt,et,rt,nt,it,st,at,ot,ct,lt,ut,ft,$t,ht,pt,dt,_t,mt,yt,gt,vt,bt,At,xt,wt,kt,Et,St,Nt,It,Ct,Ot,Bt,Mt,Pt,Ft=c(n,i,"String"),Lt=[Ft].concat($);function Tt(t){function e(t){var e,r,n,i,s,a,c="",l=t.length;for(e=0;e<l;e++)if("-"===(r=t.charAt(e))&&e>0&&e<l-1&&!n){for((i=t.charCodeAt(e-1))>(s=t.charCodeAt(e+1))&&Ft.$raise(o(Lt,"ArgumentError"),'invalid range "'+i+"-"+s+'" in string transliteration'),a=i+1;a<s+1;a++)c+=String.fromCharCode(a);n=!0,e++}else n="\\"===r,c+=r;return c}function r(t,e){if(0===t.length)return e;var r,n,i="",s=t.length;for(r=0;r<s;r++)n=t.charAt(r),-1!==e.indexOf(n)&&(i+=n);return i}var n,i,s,a,c,l,u="",f="";for(n=0,i=t.length;n<i;n++)s=e((a="^"===(s=o(Lt,"Opal").$coerce_to(t[n],o(Lt,"String"),"to_str")).charAt(0)&&s.length>1)?s.slice(1):s),a?f=r(f,s):u=r(u,s);if(u.length>0&&f.length>0){for(l="",n=0,i=u.length;n<i;n++)c=u.charAt(n),-1===f.indexOf(c)&&(l+=c);u=l,f=""}return u.length>0?"["+o(Lt,"Regexp").$escape(u)+"]":f.length>0?"[^"+o(Lt,"Regexp").$escape(f)+"]":null}Ft.$include(o(Lt,"Comparable")),t.defineProperty(Ft.$$prototype,"$$is_string",!0),t.defineProperty(Ft.$$prototype,"$$cast",function(t){var e=this.$$class;return e.$$constructor===String?t:new e.$$constructor(t)}),t.def(Ft,"$__id__",h=function(){return this.toString()},h.$$arity=0),t.alias(Ft,"object_id","__id__"),t.defs(Ft,"$try_convert",p=function(t){return o(Lt,"Opal")["$coerce_to?"](t,o(Lt,"String"),"to_str")},p.$$arity=1),t.defs(Ft,"$new",d=function(t){return null==t&&(t=""),t=o(Lt,"Opal").$coerce_to(t,o(Lt,"String"),"to_str"),new this.$$constructor(t)},d.$$arity=-1),t.def(Ft,"$initialize",_=function(t){return void 0===t?this:this.$raise(o(Lt,"NotImplementedError"),"Mutable strings are not supported in Opal.")},_.$$arity=-1),t.def(Ft,"$%",m=function(e){var r=this;return l(o(Lt,"Array")["$==="](e))?u(r,"format",[r].concat(t.to_a(e))):r.$format(r,e)},m.$$arity=1),t.def(Ft,"$*",y=function(t){if((t=o(Lt,"Opal").$coerce_to(t,o(Lt,"Integer"),"to_int"))<0&&this.$raise(o(Lt,"ArgumentError"),"negative argument"),0===t)return this.$$cast("");var e="",r=this.toString();for(r.length*t>=1<<28&&this.$raise(o(Lt,"RangeError"),"multiply count must not overflow maximum string size");1==(1&t)&&(e+=r),0!==(t>>>=1);)r+=r;return this.$$cast(e)},y.$$arity=1),t.def(Ft,"$+",g=function(t){return this+(t=o(Lt,"Opal").$coerce_to(t,o(Lt,"String"),"to_str")).$to_s()},g.$$arity=1),t.def(Ft,"$<=>",v=function(t){if(l(t["$respond_to?"]("to_str")))return this>(t=t.$to_str().$to_s())?1:this<t?-1:0;var e=t["$<=>"](this);return e===s?s:e>0?-1:e<0?1:0},v.$$arity=1),t.def(Ft,"$==",b=function(t){return t.$$is_string?this.toString()===t.toString():!!o(Lt,"Opal")["$respond_to?"](t,"to_str")&&t["$=="](this)},b.$$arity=1),t.alias(Ft,"eql?","=="),t.alias(Ft,"===","=="),t.def(Ft,"$=~",A=function(t){return t.$$is_string&&this.$raise(o(Lt,"TypeError"),"type mismatch: String given"),t["$=~"](this)},A.$$arity=1),t.def(Ft,"$[]",x=function(t,e){var r,n=this.length;if(t.$$is_range)return r=t.excl,e=o(Lt,"Opal").$coerce_to(t.end,o(Lt,"Integer"),"to_int"),t=o(Lt,"Opal").$coerce_to(t.begin,o(Lt,"Integer"),"to_int"),Math.abs(t)>n?s:(t<0&&(t+=n),e<0&&(e+=n),r||(e+=1),(e-=t)<0&&(e=0),this.$$cast(this.substr(t,e)));if(t.$$is_string)return null!=e&&this.$raise(o(Lt,"TypeError")),-1!==this.indexOf(t)?this.$$cast(t):s;if(t.$$is_regexp){var i=this.match(t);return null===i?(f["~"]=s,s):(f["~"]=o(Lt,"MatchData").$new(t,i),null==e?this.$$cast(i[0]):(e=o(Lt,"Opal").$coerce_to(e,o(Lt,"Integer"),"to_int"))<0&&-e<i.length?this.$$cast(i[e+=i.length]):e>=0&&e<i.length?this.$$cast(i[e]):s)}return(t=o(Lt,"Opal").$coerce_to(t,o(Lt,"Integer"),"to_int"))<0&&(t+=n),null==e?t>=n||t<0?s:this.$$cast(this.substr(t,1)):(e=o(Lt,"Opal").$coerce_to(e,o(Lt,"Integer"),"to_int"))<0?s:t>n||t<0?s:this.$$cast(this.substr(t,e))},x.$$arity=-2),t.alias(Ft,"byteslice","[]"),t.def(Ft,"$b",w=function(){return this.$force_encoding("binary")},w.$$arity=0),t.def(Ft,"$capitalize",k=function(){return this.$$cast(this.charAt(0).toUpperCase()+this.substr(1).toLowerCase())},k.$$arity=0),t.def(Ft,"$casecmp",E=function(t){var e=this;if(!l(t["$respond_to?"]("to_str")))return s;t=o(Lt,"Opal").$coerce_to(t,o(Lt,"String"),"to_str").$to_s();var r=/^[\x00-\x7F]*$/;return r.test(e)&&r.test(t)&&(e=e.toLowerCase(),t=t.toLowerCase()),e["$<=>"](t)},E.$$arity=1),t.def(Ft,"$casecmp?",S=function(t){var e=this.$casecmp(t);return e===s?s:0===e},S.$$arity=1),t.def(Ft,"$center",N=function(t,n){if(null==n&&(n=" "),t=o(Lt,"Opal").$coerce_to(t,o(Lt,"Integer"),"to_int"),n=o(Lt,"Opal").$coerce_to(n,o(Lt,"String"),"to_str").$to_s(),l(n["$empty?"]())&&this.$raise(o(Lt,"ArgumentError"),"zero width padding"),l(t<=this.length))return this;var i=this.$ljust(e(r(t,this.length),2).$ceil(),n),s=this.$rjust(e(r(t,this.length),2).$floor(),n);return this.$$cast(s+i.slice(this.length))},N.$$arity=-2),t.def(Ft,"$chars",I=function(){var t=I.$$p,e=t||s;return t&&(I.$$p=null),t&&(I.$$p=null),l(e)?u(this,"each_char",[],e.$to_proc()):this.$each_char().$to_a()},I.$$arity=0),t.def(Ft,"$chomp",C=function(t){var e;if(null==f["/"]&&(f["/"]=s),null==t&&(t=f["/"]),l(t===s||0===this.length))return this;if("\n"===(t=o(Lt,"Opal")["$coerce_to!"](t,o(Lt,"String"),"to_str").$to_s()))e=this.replace(/\r?\n?$/,"");else if(""===t)e=this.replace(/(\r?\n)+$/,"");else if(this.length>=t.length){this.substr(this.length-t.length,t.length)===t&&(e=this.substr(0,this.length-t.length))}return null!=e?this.$$cast(e):this},C.$$arity=-1),t.def(Ft,"$chop",O=function(){var t,e=this.length;return t=e<=1?"":"\n"===this.charAt(e-1)&&"\r"===this.charAt(e-2)?this.substr(0,e-2):this.substr(0,e-1),this.$$cast(t)},O.$$arity=0),t.def(Ft,"$chr",B=function(){return this.charAt(0)},B.$$arity=0),t.def(Ft,"$clone",M=function(){var t=s;return(t=this.slice()).$copy_singleton_methods(this),t.$initialize_clone(this),t},M.$$arity=0),t.def(Ft,"$dup",P=function(){var t=s;return(t=this.slice()).$initialize_dup(this),t},P.$$arity=0),t.def(Ft,"$count",F=function(e){var r;0===(r=t.slice.call(arguments,0,arguments.length)).length&&this.$raise(o(Lt,"ArgumentError"),"ArgumentError: wrong number of arguments (0 for 1+)");var n=Tt(r);return null===n?0:this.length-this.replace(new RegExp(n,"g"),"").length},F.$$arity=-1),t.def(Ft,"$delete",L=function(e){var r;0===(r=t.slice.call(arguments,0,arguments.length)).length&&this.$raise(o(Lt,"ArgumentError"),"ArgumentError: wrong number of arguments (0 for 1+)");var n=Tt(r);return null===n?this:this.$$cast(this.replace(new RegExp(n,"g"),""))},L.$$arity=-1),t.def(Ft,"$delete_prefix",T=function(t){return t.$$is_string||(t=o(Lt,"Opal").$coerce_to(t,o(Lt,"String"),"to_str")),this.slice(0,t.length)===t?this.$$cast(this.slice(t.length)):this},T.$$arity=1),t.def(Ft,"$delete_suffix",j=function(t){return t.$$is_string||(t=o(Lt,"Opal").$coerce_to(t,o(Lt,"String"),"to_str")),this.slice(this.length-t.length)===t?this.$$cast(this.slice(0,this.length-t.length)):this},j.$$arity=1),t.def(Ft,"$downcase",R=function(){return this.$$cast(this.toLowerCase())},R.$$arity=0),t.def(Ft,"$each_char",D=function(){var e,r=D.$$p,n=r||s;if(r&&(D.$$p=null),r&&(D.$$p=null),n===s)return u(this,"enum_for",["each_char"],((e=function(){return(e.$$s||this).$size()}).$$s=this,e.$$arity=0,e));for(var i=0,a=this.length;i<a;i++)t.yield1(n,this.charAt(i));return this},D.$$arity=0),t.def(Ft,"$each_line",z=function(e){var r,n,i,a,c,l,u,$=z.$$p,h=$||s;if(null==f["/"]&&(f["/"]=s),$&&(z.$$p=null),$&&(z.$$p=null),null==e&&(e=f["/"]),h===s)return this.$enum_for("each_line",e);if(e===s)return t.yield1(h,this),this;if(0===(e=o(Lt,"Opal").$coerce_to(e,o(Lt,"String"),"to_str")).length){for(n=0,i=(r=this.split(/(\n{2,})/)).length;n<i;n+=2)if(r[n]||r[n+1]){var p=(r[n]||"")+(r[n+1]||"");t.yield1(h,this.$$cast(p))}return this}for(c=this.$chomp(e),l=this.length!=c.length,n=0,a=(u=c.split(e)).length;n<a;n++)n<a-1||l?t.yield1(h,this.$$cast(u[n]+e)):t.yield1(h,this.$$cast(u[n]));return this},z.$$arity=-1),t.def(Ft,"$empty?",U=function(){return 0===this.length},U.$$arity=0),t.def(Ft,"$end_with?",q=function(e){for(var r,n=0,i=(r=t.slice.call(arguments,0,arguments.length)).length;n<i;n++){var s=o(Lt,"Opal").$coerce_to(r[n],o(Lt,"String"),"to_str").$to_s();if(this.length>=s.length&&this.substr(this.length-s.length,s.length)==s)return!0}return!1},q.$$arity=-1),t.alias(Ft,"equal?","==="),t.def(Ft,"$gsub",H=function(e,r){var n=H.$$p,i=n||s,a=this;if(n&&(H.$$p=null),n&&(H.$$p=null),void 0===r&&i===s)return a.$enum_for("gsub",e);var c,l,u,$="",h=s,p=0;for(e.$$is_regexp?e=t.global_multiline_regexp(e):(e=o(Lt,"Opal").$coerce_to(e,o(Lt,"String"),"to_str"),e=new RegExp(e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gm"));;){if(null===(c=e.exec(a))){f["~"]=s,$+=a.slice(p);break}h=o(Lt,"MatchData").$new(e,c),void 0===r?(u=e.lastIndex,l=i(c[0]),e.lastIndex=u):r.$$is_hash?l=r["$[]"](c[0]).$to_s():(r.$$is_string||(r=o(Lt,"Opal").$coerce_to(r,o(Lt,"String"),"to_str")),l=r.replace(/([\\]+)([0-9+&`'])/g,function(t,e,r){if(e.length%2==0)return t;switch(r){case"+":for(var n=c.length-1;n>0;n--)if(void 0!==c[n])return e.slice(1)+c[n];return"";case"&":return e.slice(1)+c[0];case"`":return e.slice(1)+a.slice(0,c.index);case"'":return e.slice(1)+a.slice(c.index+c[0].length);default:return e.slice(1)+(c[r]||"")}}).replace(/\\\\/g,"\\")),e.lastIndex===c.index?($+=l+a.slice(p,c.index+1),e.lastIndex+=1):$+=a.slice(p,c.index)+l,p=e.lastIndex}return f["~"]=h,a.$$cast($)},H.$$arity=-2),t.def(Ft,"$hash",Q=function(){return this.toString()},Q.$$arity=0),t.def(Ft,"$hex",Y=function(){return this.$to_i(16)},Y.$$arity=0),t.def(Ft,"$include?",G=function(t){return t.$$is_string||(t=o(Lt,"Opal").$coerce_to(t,o(Lt,"String"),"to_str")),-1!==this.indexOf(t)},G.$$arity=1),t.def(Ft,"$index",V=function(e,r){var n,i,a;if(void 0===r)r=0;else if((r=o(Lt,"Opal").$coerce_to(r,o(Lt,"Integer"),"to_int"))<0&&(r+=this.length)<0)return s;if(e.$$is_regexp)for(a=t.global_multiline_regexp(e);;){if(null===(i=a.exec(this))){f["~"]=s,n=-1;break}if(i.index>=r){f["~"]=o(Lt,"MatchData").$new(a,i),n=i.index;break}a.lastIndex=i.index+1}else n=0===(e=o(Lt,"Opal").$coerce_to(e,o(Lt,"String"),"to_str")).length&&r>this.length?-1:this.indexOf(e,r);return-1===n?s:n},V.$$arity=-2),t.def(Ft,"$inspect",J=function(){var t={"":"\\a","":"\\e","\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r","\v":"\\v",'"':'\\"',"\\":"\\\\"};return'"'+this.replace(/[\\\"\x00-\x1f\u007F-\u009F\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,function(e){return t[e]||"\\u"+("0000"+e.charCodeAt(0).toString(16).toUpperCase()).slice(-4)}).replace(/\#[\$\@\{]/g,"\\$&")+'"'},J.$$arity=0),t.def(Ft,"$intern",X=function(){return this.toString()},X.$$arity=0),t.def(Ft,"$lines",W=function(t){var e=W.$$p,r=e||s,n=s;return null==f["/"]&&(f["/"]=s),e&&(W.$$p=null),e&&(W.$$p=null),null==t&&(t=f["/"]),n=u(this,"each_line",[t],r.$to_proc()),l(r)?this:n.$to_a()},W.$$arity=-1),t.def(Ft,"$length",K=function(){return this.length},K.$$arity=0),t.def(Ft,"$ljust",Z=function(t,e){if(null==e&&(e=" "),t=o(Lt,"Opal").$coerce_to(t,o(Lt,"Integer"),"to_int"),e=o(Lt,"Opal").$coerce_to(e,o(Lt,"String"),"to_str").$to_s(),l(e["$empty?"]())&&this.$raise(o(Lt,"ArgumentError"),"zero width padding"),l(t<=this.length))return this;var r=-1,n="";for(t-=this.length;++r<t;)n+=e;return this.$$cast(this+n.slice(0,t))},Z.$$arity=-2),t.def(Ft,"$lstrip",tt=function(){return this.replace(/^\s*/,"")},tt.$$arity=0),t.def(Ft,"$ascii_only?",et=function(){return!this.$encoding()["$=="](a(o(Lt,"Encoding"),"UTF_16BE"))&&/^[\x00-\x7F]*$/.test(this)},et.$$arity=0),t.def(Ft,"$match",rt=function(t,e){var r,n=rt.$$p,i=n||s;return n&&(rt.$$p=null),n&&(rt.$$p=null),l(l(r=o(Lt,"String")["$==="](t))?r:t["$respond_to?"]("to_str"))&&(t=o(Lt,"Regexp").$new(t.$to_str())),l(o(Lt,"Regexp")["$==="](t))||this.$raise(o(Lt,"TypeError"),"wrong argument type "+t.$class()+" (expected Regexp)"),u(t,"match",[this,e],i.$to_proc())},rt.$$arity=-2),t.def(Ft,"$match?",nt=function(t,e){var r;return l(l(r=o(Lt,"String")["$==="](t))?r:t["$respond_to?"]("to_str"))&&(t=o(Lt,"Regexp").$new(t.$to_str())),l(o(Lt,"Regexp")["$==="](t))||this.$raise(o(Lt,"TypeError"),"wrong argument type "+t.$class()+" (expected Regexp)"),t["$match?"](this,e)},nt.$$arity=-2),t.def(Ft,"$next",it=function(){var t=this.length;if(0===t)return this.$$cast("");for(var e,r=this,n=this.search(/[a-zA-Z0-9]/),i=!1;t--;){if((e=this.charCodeAt(t))>=48&&e<=57||e>=65&&e<=90||e>=97&&e<=122)switch(e){case 57:i=!0,e=48;break;case 90:i=!0,e=65;break;case 122:i=!0,e=97;break;default:i=!1,e+=1}else-1===n?255===e?(i=!0,e=0):(i=!1,e+=1):i=!0;if(r=r.slice(0,t)+String.fromCharCode(e)+r.slice(t+1),i&&(0===t||t===n)){switch(e){case 65:case 97:break;default:e+=1}r=0===t?String.fromCharCode(e)+r:r.slice(0,t)+String.fromCharCode(e)+r.slice(t),i=!1}if(!i)break}return this.$$cast(r)},it.$$arity=0),t.def(Ft,"$oct",st=function(){var t,e=this,r=8;return/^\s*_/.test(e)?0:(e=e.replace(/^(\s*[+-]?)(0[bodx]?)(.+)$/i,function(t,e,n,i){switch(i.charAt(0)){case"+":case"-":return t;case"0":if("x"===i.charAt(1)&&"0x"===n)return t}switch(n){case"0b":r=2;break;case"0":case"0o":r=8;break;case"0d":r=10;break;case"0x":r=16}return e+i}),t=parseInt(e.replace(/_(?!_)/g,""),r),isNaN(t)?0:t)},st.$$arity=0),t.def(Ft,"$ord",at=function(){return this.charCodeAt(0)},at.$$arity=0),t.def(Ft,"$partition",ot=function(t){var e,r;return t.$$is_regexp?null===(r=t.exec(this))?e=-1:(o(Lt,"MatchData").$new(t,r),t=r[0],e=r.index):(t=o(Lt,"Opal").$coerce_to(t,o(Lt,"String"),"to_str"),e=this.indexOf(t)),-1===e?[this,"",""]:[this.slice(0,e),this.slice(e,e+t.length),this.slice(e+t.length)]},ot.$$arity=1),t.def(Ft,"$reverse",ct=function(){return this.split("").reverse().join("")},ct.$$arity=0),t.def(Ft,"$rindex",lt=function(e,r){var n,i,a,c;if(void 0===r)r=this.length;else if((r=o(Lt,"Opal").$coerce_to(r,o(Lt,"Integer"),"to_int"))<0&&(r+=this.length)<0)return s;if(e.$$is_regexp){for(i=null,a=t.global_multiline_regexp(e);!(null===(c=a.exec(this))||c.index>r);)i=c,a.lastIndex=i.index+1;null===i?(f["~"]=s,n=-1):(o(Lt,"MatchData").$new(a,i),n=i.index)}else e=o(Lt,"Opal").$coerce_to(e,o(Lt,"String"),"to_str"),n=this.lastIndexOf(e,r);return-1===n?s:n},lt.$$arity=-2),t.def(Ft,"$rjust",ut=function(t,e){if(null==e&&(e=" "),t=o(Lt,"Opal").$coerce_to(t,o(Lt,"Integer"),"to_int"),e=o(Lt,"Opal").$coerce_to(e,o(Lt,"String"),"to_str").$to_s(),l(e["$empty?"]())&&this.$raise(o(Lt,"ArgumentError"),"zero width padding"),l(t<=this.length))return this;var r=Math.floor(t-this.length),n=Math.floor(r/e.length),i=Array(n+1).join(e),s=r-i.length;return this.$$cast(i+e.slice(0,s)+this)},ut.$$arity=-2),t.def(Ft,"$rpartition",ft=function(e){var r,n,i,s;if(e.$$is_regexp){for(n=null,i=t.global_multiline_regexp(e);null!==(s=i.exec(this));)n=s,i.lastIndex=n.index+1;null===n?r=-1:(o(Lt,"MatchData").$new(i,n),e=n[0],r=n.index)}else e=o(Lt,"Opal").$coerce_to(e,o(Lt,"String"),"to_str"),r=this.lastIndexOf(e);return-1===r?["","",this]:[this.slice(0,r),this.slice(r,r+e.length),this.slice(r+e.length)]},ft.$$arity=1),t.def(Ft,"$rstrip",$t=function(){return this.replace(/[\s\u0000]*$/,"")},$t.$$arity=0),t.def(Ft,"$scan",ht=function(e){var r=ht.$$p,n=r||s;r&&(ht.$$p=null),r&&(ht.$$p=null);var i,a=[],c=s;for(e.$$is_regexp?e=t.global_multiline_regexp(e):(e=o(Lt,"Opal").$coerce_to(e,o(Lt,"String"),"to_str"),e=new RegExp(e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gm"));null!=(i=e.exec(this));)c=o(Lt,"MatchData").$new(e,i),n===s?1==i.length?a.push(i[0]):a.push(c.$captures()):1==i.length?n(i[0]):n.call(this,c.$captures()),e.lastIndex===i.index&&(e.lastIndex+=1);return f["~"]=c,n!==s?this:a},ht.$$arity=1),t.alias(Ft,"size","length"),t.alias(Ft,"slice","[]"),t.def(Ft,"$split",pt=function(e,r){var n,i=this;if(null==f[";"]&&(f[";"]=s),0===i.length)return[];if(void 0===r)r=0;else if(1===(r=o(Lt,"Opal")["$coerce_to!"](r,o(Lt,"Integer"),"to_int")))return[i];void 0!==e&&e!==s||(e=l(n=f[";"])?n:" ");var a,c,u,$=[],h=i.toString(),p=0;if(e.$$is_regexp?e=t.global_multiline_regexp(e):" "===(e=o(Lt,"Opal").$coerce_to(e,o(Lt,"String"),"to_str").$to_s())?(e=/\s+/gm,h=h.replace(/^\s+/,"")):e=new RegExp(e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gm"),1===($=h.split(e)).length&&$[0]===h)return[i.$$cast($[0])];for(;-1!==(c=$.indexOf(void 0));)$.splice(c,1);function d(){for(c=0;c<$.length;c++)$[c]=i.$$cast($[c])}if(0===r){for(;""===$[$.length-1];)$.length-=1;return d(),$}if(a=e.exec(h),r<0){if(null!==a&&""===a[0]&&-1===e.source.indexOf("(?="))for(c=0,u=a.length;c<u;c++)$.push("");return d(),$}if(null!==a&&""===a[0])return $.splice(r-1,$.length-1,$.slice(r-1).join("")),d(),$;if(r>=$.length)return d(),$;for(c=0;null!==a&&(c++,p=e.lastIndex,c+1!==r);)a=e.exec(h);return $.splice(r-1,$.length-1,h.slice(p)),d(),$},pt.$$arity=-1),t.def(Ft,"$squeeze",dt=function(e){var r;if(0===(r=t.slice.call(arguments,0,arguments.length)).length)return this.$$cast(this.replace(/(.)\1+/g,"$1"));var n=Tt(r);return null===n?this:this.$$cast(this.replace(new RegExp("("+n+")\\1+","g"),"$1"))},dt.$$arity=-1),t.def(Ft,"$start_with?",_t=function(e){for(var r,n=0,i=(r=t.slice.call(arguments,0,arguments.length)).length;n<i;n++){var s=o(Lt,"Opal").$coerce_to(r[n],o(Lt,"String"),"to_str").$to_s();if(0===this.indexOf(s))return!0}return!1},_t.$$arity=-1),t.def(Ft,"$strip",mt=function(){return this.replace(/^\s*/,"").replace(/[\s\u0000]*$/,"")},mt.$$arity=0),t.def(Ft,"$sub",yt=function(t,e){var r=yt.$$p,n=r||s,i=this;r&&(yt.$$p=null),r&&(yt.$$p=null),t.$$is_regexp||(t=o(Lt,"Opal").$coerce_to(t,o(Lt,"String"),"to_str"),t=new RegExp(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")));var a,c=t.exec(i);return null===c?(f["~"]=s,a=i.toString()):(o(Lt,"MatchData").$new(t,c),void 0===e?(n===s&&i.$raise(o(Lt,"ArgumentError"),"wrong number of arguments (1 for 2)"),a=i.slice(0,c.index)+n(c[0])+i.slice(c.index+c[0].length)):e.$$is_hash?a=i.slice(0,c.index)+e["$[]"](c[0]).$to_s()+i.slice(c.index+c[0].length):(e=(e=o(Lt,"Opal").$coerce_to(e,o(Lt,"String"),"to_str")).replace(/([\\]+)([0-9+&`'])/g,function(t,e,r){if(e.length%2==0)return t;switch(r){case"+":for(var n=c.length-1;n>0;n--)if(void 0!==c[n])return e.slice(1)+c[n];return"";case"&":return e.slice(1)+c[0];case"`":return e.slice(1)+i.slice(0,c.index);case"'":return e.slice(1)+i.slice(c.index+c[0].length);default:return e.slice(1)+(c[r]||"")}}).replace(/\\\\/g,"\\"),a=i.slice(0,c.index)+e+i.slice(c.index+c[0].length))),i.$$cast(a)},yt.$$arity=-2),t.alias(Ft,"succ","next"),t.def(Ft,"$sum",gt=function(t){null==t&&(t=16),t=o(Lt,"Opal").$coerce_to(t,o(Lt,"Integer"),"to_int");for(var e=0,r=this.length,n=0;n<r;n++)e+=this.charCodeAt(n);return t<=0?e:e&Math.pow(2,t)-1},gt.$$arity=-1),t.def(Ft,"$swapcase",vt=function(){var t=this.replace(/([a-z]+)|([A-Z]+)/g,function(t,e,r){return e?t.toUpperCase():t.toLowerCase()});return this.constructor===String?t:this.$class().$new(t)},vt.$$arity=0),t.def(Ft,"$to_f",bt=function(){if("_"===this.charAt(0))return 0;var t=parseFloat(this.replace(/_/g,""));return isNaN(t)||t==1/0||t==-1/0?0:t},bt.$$arity=0),t.def(Ft,"$to_i",At=function(t){null==t&&(t=10);var e,r=this.toLowerCase(),n=o(Lt,"Opal").$coerce_to(t,o(Lt,"Integer"),"to_int");return(1===n||n<0||n>36)&&this.$raise(o(Lt,"ArgumentError"),"invalid radix "+n),/^\s*_/.test(r)?0:(r=r.replace(/^(\s*[+-]?)(0[bodx]?)(.+)$/,function(t,e,r,i){switch(i.charAt(0)){case"+":case"-":return t;case"0":if("x"===i.charAt(1)&&"0x"===r&&(0===n||16===n))return t}switch(r){case"0b":if(0===n||2===n)return n=2,e+i;break;case"0":case"0o":if(0===n||8===n)return n=8,e+i;break;case"0d":if(0===n||10===n)return n=10,e+i;break;case"0x":if(0===n||16===n)return n=16,e+i}return t}),e=parseInt(r.replace(/_(?!_)/g,""),n),isNaN(e)?0:e)},At.$$arity=-1),t.def(Ft,"$to_proc",xt=function(){var e,n,i=xt.$$p;return i&&(xt.$$p=null),n=r("$",this.valueOf()),u(this,"proc",[],((e=function(r){var i,a=e.$$s||this,c=e.$$p,l=c||s;c&&(e.$$p=null),0===(i=t.slice.call(arguments,0,arguments.length)).length&&a.$raise(o(Lt,"ArgumentError"),"no receiver given");var u=i[0];null==u&&(u=s);var f=u[n];return f?("function"==typeof l&&(f.$$p=l),1===i.length?f.call(u):f.apply(u,i.slice(1))):u.$method_missing.apply(u,i)}).$$s=this,e.$$arity=-1,e))},xt.$$arity=0),t.def(Ft,"$to_s",wt=function(){return this.toString()},wt.$$arity=0),t.alias(Ft,"to_str","to_s"),t.alias(Ft,"to_sym","intern"),t.def(Ft,"$tr",kt=function(t,e){var r,n,i,s,a,c,l;if(t=o(Lt,"Opal").$coerce_to(t,o(Lt,"String"),"to_str").$to_s(),e=o(Lt,"Opal").$coerce_to(e,o(Lt,"String"),"to_str").$to_s(),0==t.length||t===e)return this;var u={},f=t.split(""),$=f.length,h=e.split(""),p=h.length,d=!1,_=null;"^"===f[0]&&f.length>1&&(d=!0,f.shift(),_=h[p-1],$-=1);var m=[],y=null;for(n=!1,r=0;r<$;r++)if(s=f[r],null==y)y=s,m.push(s);else if("-"===s)"-"===y?(m.push("-"),m.push("-")):r==$-1?m.push("-"):n=!0;else if(n){for((a=y.charCodeAt(0))>(c=s.charCodeAt(0))&&this.$raise(o(Lt,"ArgumentError"),'invalid range "'+String.fromCharCode(a)+"-"+String.fromCharCode(c)+'" in string transliteration'),i=a+1;i<c;i++)m.push(String.fromCharCode(i));m.push(s),n=null,y=null}else m.push(s);if($=(f=m).length,d)for(r=0;r<$;r++)u[f[r]]=!0;else{if(p>0){var g=[],v=null;for(n=!1,r=0;r<p;r++)if(s=h[r],null==v)v=s,g.push(s);else if("-"===s)"-"===v?(g.push("-"),g.push("-")):r==p-1?g.push("-"):n=!0;else if(n){for((a=v.charCodeAt(0))>(c=s.charCodeAt(0))&&this.$raise(o(Lt,"ArgumentError"),'invalid range "'+String.fromCharCode(a)+"-"+String.fromCharCode(c)+'" in string transliteration'),i=a+1;i<c;i++)g.push(String.fromCharCode(i));g.push(s),n=null,v=null}else g.push(s);p=(h=g).length}var b=$-p;if(b>0){var A=p>0?h[p-1]:"";for(r=0;r<b;r++)h.push(A)}for(r=0;r<$;r++)u[f[r]]=h[r]}var x="";for(r=0,l=this.length;r<l;r++){var w=u[s=this.charAt(r)];x+=d?null==w?_:s:null!=w?w:s}return this.$$cast(x)},kt.$$arity=2),t.def(Ft,"$tr_s",Et=function(t,e){var r,n,i,s,a,c,l;if(t=o(Lt,"Opal").$coerce_to(t,o(Lt,"String"),"to_str").$to_s(),e=o(Lt,"Opal").$coerce_to(e,o(Lt,"String"),"to_str").$to_s(),0==t.length)return this;var u={},f=t.split(""),$=f.length,h=e.split(""),p=h.length,d=!1,_=null;"^"===f[0]&&f.length>1&&(d=!0,f.shift(),_=h[p-1],$-=1);var m=[],y=null;for(n=!1,r=0;r<$;r++)if(s=f[r],null==y)y=s,m.push(s);else if("-"===s)"-"===y?(m.push("-"),m.push("-")):r==$-1?m.push("-"):n=!0;else if(n){for((a=y.charCodeAt(0))>(c=s.charCodeAt(0))&&this.$raise(o(Lt,"ArgumentError"),'invalid range "'+String.fromCharCode(a)+"-"+String.fromCharCode(c)+'" in string transliteration'),i=a+1;i<c;i++)m.push(String.fromCharCode(i));m.push(s),n=null,y=null}else m.push(s);if($=(f=m).length,d)for(r=0;r<$;r++)u[f[r]]=!0;else{if(p>0){var g=[];for(n=!1,r=0;r<p;r++)if(s=h[r],null==y)y=s,g.push(s);else if("-"===s)r==p-1?g.push("-"):n=!0;else if(n){for((a=y.charCodeAt(0))>(c=s.charCodeAt(0))&&this.$raise(o(Lt,"ArgumentError"),'invalid range "'+String.fromCharCode(a)+"-"+String.fromCharCode(c)+'" in string transliteration'),i=a+1;i<c;i++)g.push(String.fromCharCode(i));g.push(s),n=null,y=null}else g.push(s);p=(h=g).length}var v=$-p;if(v>0){var b=p>0?h[p-1]:"";for(r=0;r<v;r++)h.push(b)}for(r=0;r<$;r++)u[f[r]]=h[r]}var A="",x=null;for(r=0,l=this.length;r<l;r++){var w=u[s=this.charAt(r)];d?null==w?null==x&&(A+=_,x=!0):(A+=s,x=null):null!=w?null!=x&&x===w||(A+=w,x=w):(A+=s,x=null)}return this.$$cast(A)},Et.$$arity=2),t.def(Ft,"$upcase",St=function(){return this.$$cast(this.toUpperCase())},St.$$arity=0),t.def(Ft,"$upto",Nt=function(t,e){var r=Nt.$$p,n=r||s;if(r&&(Nt.$$p=null),r&&(Nt.$$p=null),null==e&&(e=!1),n===s)return this.$enum_for("upto",t,e);t=o(Lt,"Opal").$coerce_to(t,o(Lt,"String"),"to_str");var i,a,c=this.toString();if(1===c.length&&1===t.length)for(i=c.charCodeAt(0),a=t.charCodeAt(0);i<=a&&(!e||i!==a);)n(String.fromCharCode(i)),i+=1;else if(parseInt(c,10).toString()===c&&parseInt(t,10).toString()===t)for(i=parseInt(c,10),a=parseInt(t,10);i<=a&&(!e||i!==a);)n(i.toString()),i+=1;else for(;c.length<=t.length&&c<=t&&(!e||c!==t);)n(c),c=c.$succ();return this},Nt.$$arity=-2),t.def(Ft,"$instance_variables",It=function(){return[]},It.$$arity=0),t.defs(Ft,"$_load",Ct=function(e){var r;return r=t.slice.call(arguments,0,arguments.length),u(this,"new",t.to_a(r))},Ct.$$arity=-1),t.def(Ft,"$unicode_normalize",Ot=function(t){return this.toString()},Ot.$$arity=-1),t.def(Ft,"$unicode_normalized?",Bt=function(t){return!0},Bt.$$arity=-1),t.def(Ft,"$unpack",Mt=function(t){return this.$raise("To use String#unpack, you must first require 'corelib/string/unpack'.")},Mt.$$arity=1),t.def(Ft,"$unpack1",Pt=function(t){return this.$raise("To use String#unpack1, you must first require 'corelib/string/unpack'.")},Pt.$$arity=1)}(i[0],String,i),t.const_set(i[0],"Symbol",o(i,"String"))},Opal.modules["corelib/enumerable"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t>e:t["$>"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}function n(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}function i(t,e){return"number"==typeof t&&"number"==typeof e?t<=e:t["$<="](e)}t.top;var s=[],a=t.nil,o=t.const_get_qualified,c=t.const_get_relative,l=(t.breaker,t.slice,t.module),u=t.truthy,f=t.send,$=t.falsy,h=t.hash2,p=t.lambda;return t.add_stubs(["$each","$public_send","$destructure","$to_enum","$enumerator_size","$new","$yield","$raise","$slice_when","$!","$enum_for","$flatten","$map","$warn","$proc","$==","$nil?","$respond_to?","$coerce_to!","$>","$*","$coerce_to","$try_convert","$<","$+","$-","$ceil","$/","$size","$__send__","$length","$<=","$[]","$push","$<<","$[]=","$===","$inspect","$<=>","$first","$reverse","$sort","$to_proc","$compare","$call","$dup","$to_a","$sort!","$map!","$key?","$values","$zip"]),function(s,d){var _,m,y,g,v,b,A,x,w,k,E,S,N,I,C,O,B,M,P,F,L,T,j,R,D,z,U,q,H,Q,Y,G,V,J,X,W,K,Z,tt,et,rt,nt,it,st,at,ot,ct,lt,ut=l(s,"Enumerable"),ft=[ut].concat(d);function $t(t){return 0===t.length&&(t=[a]),t.length>1&&(t=[t]),t}t.def(ut,"$all?",_=function(e){try{var r,n,i,s=_.$$p,o=s||a;return s&&(_.$$p=null),s&&(_.$$p=null),u(void 0!==e)?f(this,"each",[],((r=function(n){var i;r.$$s;if(i=$t(t.slice.call(arguments,0,arguments.length)),u(f(e,"public_send",["==="].concat(t.to_a(i)))))return a;t.ret(!1)}).$$s=this,r.$$arity=-1,r)):f(this,"each",[],o!==a?((n=function(e){var r;n.$$s;if(r=t.slice.call(arguments,0,arguments.length),u(t.yieldX(o,t.to_a(r))))return a;t.ret(!1)}).$$s=this,n.$$arity=-1,n):((i=function(e){var r;i.$$s;if(r=t.slice.call(arguments,0,arguments.length),u(c(ft,"Opal").$destructure(r)))return a;t.ret(!1)}).$$s=this,i.$$arity=-1,i)),!0}catch(e){if(e===t.returner)return e.$v;throw e}},_.$$arity=-1),t.def(ut,"$any?",m=function(e){try{var r,n,i,s=m.$$p,o=s||a;return s&&(m.$$p=null),s&&(m.$$p=null),u(void 0!==e)?f(this,"each",[],((r=function(n){var i;r.$$s;if(i=$t(t.slice.call(arguments,0,arguments.length)),!u(f(e,"public_send",["==="].concat(t.to_a(i)))))return a;t.ret(!0)}).$$s=this,r.$$arity=-1,r)):f(this,"each",[],o!==a?((n=function(e){var r;n.$$s;if(r=t.slice.call(arguments,0,arguments.length),!u(t.yieldX(o,t.to_a(r))))return a;t.ret(!0)}).$$s=this,n.$$arity=-1,n):((i=function(e){var r;i.$$s;if(r=t.slice.call(arguments,0,arguments.length),!u(c(ft,"Opal").$destructure(r)))return a;t.ret(!0)}).$$s=this,i.$$arity=-1,i)),!1}catch(e){if(e===t.returner)return e.$v;throw e}},m.$$arity=-1),t.def(ut,"$chunk",y=function(){var e,r,n=y.$$p,i=n||a;return n&&(y.$$p=null),n&&(y.$$p=null),i===a?f(this,"to_enum",["chunk"],((e=function(){return(e.$$s||this).$enumerator_size()}).$$s=this,e.$$arity=0,e)):f(o("::","Enumerator"),"new",[],((r=function(e){var n=r.$$s||this;null==e&&(e=a);var s=a,o=[];function c(){o.length>0&&e.$yield(s,o)}n.$each.$$p=function(e){var r=t.yield1(i,e);r===a?(c(),o=[],s=a):(s===a||s===r?o.push(e):(c(),o=[e]),s=r)},n.$each(),c()}).$$s=this,r.$$arity=1,r))},y.$$arity=0),t.def(ut,"$chunk_while",g=function(){var e,r=g.$$p,n=r||a;return r&&(g.$$p=null),r&&(g.$$p=null),n!==a||this.$raise(c(ft,"ArgumentError"),"no block given"),f(this,"slice_when",[],((e=function(r,i){e.$$s;return null==r&&(r=a),null==i&&(i=a),t.yieldX(n,[r,i])["$!"]()}).$$s=this,e.$$arity=2,e))},g.$$arity=0),t.def(ut,"$collect",v=function(){var e,r=v.$$p,n=r||a;if(r&&(v.$$p=null),r&&(v.$$p=null),n===a)return f(this,"enum_for",["collect"],((e=function(){return(e.$$s||this).$enumerator_size()}).$$s=this,e.$$arity=0,e));var i=[];return this.$each.$$p=function(){var e=t.yieldX(n,arguments);i.push(e)},this.$each(),i},v.$$arity=0),t.def(ut,"$collect_concat",b=function(){var e,r,n=b.$$p,i=n||a;return n&&(b.$$p=null),n&&(b.$$p=null),i===a?f(this,"enum_for",["collect_concat"],((e=function(){return(e.$$s||this).$enumerator_size()}).$$s=this,e.$$arity=0,e)):f(this,"map",[],(r=function(e){r.$$s;return null==e&&(e=a),t.yield1(i,e)},r.$$s=this,r.$$arity=1,r)).$flatten(1)},b.$$arity=0),t.def(ut,"$count",A=function(e){var r,n,i,s=A.$$p,o=s||a,l=a;return s&&(A.$$p=null),s&&(A.$$p=null),l=0,null!=e&&o!==a&&this.$warn("warning: given block not used"),u(null!=e)?o=f(this,"proc",[],((r=function(n){var i;r.$$s;return i=t.slice.call(arguments,0,arguments.length),c(ft,"Opal").$destructure(i)["$=="](e)}).$$s=this,r.$$arity=-1,r)):u(o["$nil?"]())&&(o=f(this,"proc",[],((n=function(){n.$$s;return!0}).$$s=this,n.$$arity=0,n))),f(this,"each",[],((i=function(e){var r;i.$$s;return r=t.slice.call(arguments,0,arguments.length),u(t.yieldX(o,r))?l++:a}).$$s=this,i.$$arity=-1,i)),l},A.$$arity=-1),t.def(ut,"$cycle",x=function(r){var n,i=x.$$p,s=i||a;if(i&&(x.$$p=null),i&&(x.$$p=null),null==r&&(r=a),s===a)return f(this,"enum_for",["cycle",r],((n=function(){var t,i,s=n.$$s||this;return u(r["$nil?"]())?u(s["$respond_to?"]("size"))?o(c(ft,"Float"),"INFINITY"):a:(r=c(ft,"Opal")["$coerce_to!"](r,c(ft,"Integer"),"to_int"),u(e(r,0))?(t=s.$enumerator_size(),i=r,"number"==typeof t&&"number"==typeof i?t*i:t["$*"](i)):0)}).$$s=this,n.$$arity=0,n));if(u(r["$nil?"]()));else if(r=c(ft,"Opal")["$coerce_to!"](r,c(ft,"Integer"),"to_int"),u(r<=0))return a;var l,$,h=[];if(this.$each.$$p=function(){var e=c(ft,"Opal").$destructure(arguments);t.yield1(s,e);h.push(e)},this.$each(),0===h.length)return a;if(r===a)for(;;)for(l=0,$=h.length;l<$;l++)t.yield1(s,h[l]);else for(;r>1;){for(l=0,$=h.length;l<$;l++)t.yield1(s,h[l]);r--}},x.$$arity=-1),t.def(ut,"$detect",w=function(e){try{var r,n=w.$$p,i=n||a;return n&&(w.$$p=null),n&&(w.$$p=null),i===a?this.$enum_for("detect",e):(f(this,"each",[],((r=function(e){var n,s;r.$$s;if(n=t.slice.call(arguments,0,arguments.length),s=c(ft,"Opal").$destructure(n),!u(t.yield1(i,s)))return a;t.ret(s)}).$$s=this,r.$$arity=-1,r)),void 0!==e?"function"==typeof e?e():e:a)}catch(e){if(e===t.returner)return e.$v;throw e}},w.$$arity=-1),t.def(ut,"$drop",k=function(t){t=c(ft,"Opal").$coerce_to(t,c(ft,"Integer"),"to_int"),u(t<0)&&this.$raise(c(ft,"ArgumentError"),"attempt to drop negative size");var e=[],r=0;return this.$each.$$p=function(){t<=r&&e.push(c(ft,"Opal").$destructure(arguments)),r++},this.$each(),e},k.$$arity=1),t.def(ut,"$drop_while",E=function(){var e=E.$$p,r=e||a;if(e&&(E.$$p=null),e&&(E.$$p=null),r===a)return this.$enum_for("drop_while");var n=[],i=!0;return this.$each.$$p=function(){var e=c(ft,"Opal").$destructure(arguments);if(i){var s=t.yield1(r,e);$(s)&&(i=!1,n.push(e))}else n.push(e)},this.$each(),n},E.$$arity=0),t.def(ut,"$each_cons",S=function(e){var i,s=S.$$p,o=s||a;if(s&&(S.$$p=null),s&&(S.$$p=null),u(1!=arguments.length)&&this.$raise(c(ft,"ArgumentError"),"wrong number of arguments ("+arguments.length+" for 1)"),e=c(ft,"Opal").$try_convert(e,c(ft,"Integer"),"to_int"),u(e<=0)&&this.$raise(c(ft,"ArgumentError"),"invalid size"),o===a)return f(this,"enum_for",["each_cons",e],((i=function(){var t,s,o,c=i.$$s||this,l=a;return l=c.$enumerator_size(),u(l["$nil?"]())?a:u(u(t=l["$=="](0))?t:(o=e,"number"==typeof(s=l)&&"number"==typeof o?s<o:s["$<"](o)))?0:r(n(l,e),1)}).$$s=this,i.$$arity=0,i));var l=[],$=a;return this.$each.$$p=function(){var r=c(ft,"Opal").$destructure(arguments);l.push(r),l.length>e&&l.shift(),l.length==e&&t.yield1(o,l.slice(0,e))},this.$each(),$},S.$$arity=1),t.def(ut,"$each_entry",N=function(e){var r,n,i=N.$$p,s=i||a;return i&&(N.$$p=null),i&&(N.$$p=null),r=t.slice.call(arguments,0,arguments.length),s===a?f(this,"to_enum",["each_entry"].concat(t.to_a(r)),((n=function(){return(n.$$s||this).$enumerator_size()}).$$s=this,n.$$arity=0,n)):(this.$each.$$p=function(){var e=c(ft,"Opal").$destructure(arguments);t.yield1(s,e)},this.$each.apply(this,r),this)},N.$$arity=-1),t.def(ut,"$each_slice",I=function(e){var r,n=I.$$p,i=n||a;if(n&&(I.$$p=null),n&&(I.$$p=null),e=c(ft,"Opal").$coerce_to(e,c(ft,"Integer"),"to_int"),u(e<=0)&&this.$raise(c(ft,"ArgumentError"),"invalid slice size"),i===a)return f(this,"enum_for",["each_slice",e],((r=function(){var t,n,i=r.$$s||this;return u(i["$respond_to?"]("size"))?(t=i.$size(),n=e,"number"==typeof t&&"number"==typeof n?t/n:t["$/"](n)).$ceil():a}).$$s=this,r.$$arity=0,r));var s=[];return this.$each.$$p=function(){var r=c(ft,"Opal").$destructure(arguments);s.push(r),s.length===e&&(t.yield1(i,s),s=[])},this.$each(),s.length>0&&t.yield1(i,s),a},I.$$arity=1),t.def(ut,"$each_with_index",C=function(e){var r,n,i=C.$$p,s=i||a;if(i&&(C.$$p=null),i&&(C.$$p=null),r=t.slice.call(arguments,0,arguments.length),s===a)return f(this,"enum_for",["each_with_index"].concat(t.to_a(r)),((n=function(){return(n.$$s||this).$enumerator_size()}).$$s=this,n.$$arity=0,n));var o=0;return this.$each.$$p=function(){var t=c(ft,"Opal").$destructure(arguments);s(t,o),o++},this.$each.apply(this,r),this},C.$$arity=-1),t.def(ut,"$each_with_object",O=function(t){var e,r=O.$$p,n=r||a;return r&&(O.$$p=null),r&&(O.$$p=null),n===a?f(this,"enum_for",["each_with_object",t],((e=function(){return(e.$$s||this).$enumerator_size()}).$$s=this,e.$$arity=0,e)):(this.$each.$$p=function(){var e=c(ft,"Opal").$destructure(arguments);n(e,t)},this.$each(),t)},O.$$arity=1),t.def(ut,"$entries",B=function(e){var r;r=t.slice.call(arguments,0,arguments.length);var n=[];return this.$each.$$p=function(){n.push(c(ft,"Opal").$destructure(arguments))},this.$each.apply(this,r),n},B.$$arity=-1),t.alias(ut,"find","detect"),t.def(ut,"$find_all",M=function(){var e,r=M.$$p,n=r||a;if(r&&(M.$$p=null),r&&(M.$$p=null),n===a)return f(this,"enum_for",["find_all"],((e=function(){return(e.$$s||this).$enumerator_size()}).$$s=this,e.$$arity=0,e));var i=[];return this.$each.$$p=function(){var e=c(ft,"Opal").$destructure(arguments),r=t.yield1(n,e);u(r)&&i.push(e)},this.$each(),i},M.$$arity=0),t.def(ut,"$find_index",P=function(e){try{var r,n,i=P.$$p,s=i||a,o=a;return i&&(P.$$p=null),i&&(P.$$p=null),u(void 0===e&&s===a)?this.$enum_for("find_index"):(null!=e&&s!==a&&this.$warn("warning: given block not used"),o=0,u(null!=e)?f(this,"each",[],((r=function(n){var i;r.$$s;return i=t.slice.call(arguments,0,arguments.length),c(ft,"Opal").$destructure(i)["$=="](e)&&t.ret(o),o+=1}).$$s=this,r.$$arity=-1,r)):f(this,"each",[],((n=function(e){var r;n.$$s;return r=t.slice.call(arguments,0,arguments.length),u(t.yieldX(s,t.to_a(r)))&&t.ret(o),o+=1}).$$s=this,n.$$arity=-1,n)),a)}catch(e){if(e===t.returner)return e.$v;throw e}},P.$$arity=-1),t.def(ut,"$first",F=function(e){try{var r,n,i=a,s=a;return u(void 0===e)?f(this,"each",[],((r=function(e){r.$$s;null==e&&(e=a),t.ret(e)}).$$s=this,r.$$arity=1,r)):(i=[],e=c(ft,"Opal").$coerce_to(e,c(ft,"Integer"),"to_int"),u(e<0)&&this.$raise(c(ft,"ArgumentError"),"attempt to take negative size"),u(0==e)?[]:(s=0,f(this,"each",[],((n=function(r){var o;n.$$s;if(o=t.slice.call(arguments,0,arguments.length),i.push(c(ft,"Opal").$destructure(o)),!u(e<=++s))return a;t.ret(i)}).$$s=this,n.$$arity=-1,n)),i))}catch(e){if(e===t.returner)return e.$v;throw e}},F.$$arity=-1),t.alias(ut,"flat_map","collect_concat"),t.def(ut,"$grep",L=function(r){var n,s=L.$$p,o=s||a,c=a;return s&&(L.$$p=null),s&&(L.$$p=null),c=[],f(this,"each",[],((n=function(s){var l,$;n.$$s;return $=$t(l=t.slice.call(arguments,0,arguments.length)),u(f(r,"__send__",["==="].concat(t.to_a($))))?(o!==a?(u(e(l.$length(),1))&&(l=[l]),l=t.yieldX(o,t.to_a(l))):u(i(l.$length(),1))&&(l=l["$[]"](0)),c.$push(l)):a}).$$s=this,n.$$arity=-1,n)),c},L.$$arity=1),t.def(ut,"$grep_v",T=function(r){var n,s=T.$$p,o=s||a,c=a;return s&&(T.$$p=null),s&&(T.$$p=null),c=[],f(this,"each",[],((n=function(s){var l,$;n.$$s;return $=$t(l=t.slice.call(arguments,0,arguments.length)),u(f(r,"__send__",["==="].concat(t.to_a($))))?a:(o!==a?(u(e(l.$length(),1))&&(l=[l]),l=t.yieldX(o,t.to_a(l))):u(i(l.$length(),1))&&(l=l["$[]"](0)),c.$push(l))}).$$s=this,n.$$arity=-1,n)),c},T.$$arity=1),t.def(ut,"$group_by",j=function(){var e,r,i=j.$$p,s=i||a,o=a,l=a;return i&&(j.$$p=null),i&&(j.$$p=null),s===a?f(this,"enum_for",["group_by"],((e=function(){return(e.$$s||this).$enumerator_size()}).$$s=this,e.$$arity=0,e)):(o=h([],{}),this.$each.$$p=function(){var e=c(ft,"Opal").$destructure(arguments),i=t.yield1(s,e);(u(r=o["$[]"](i))?r:(l=[i,[]],f(o,"[]=",t.to_a(l)),l[n(l.length,1)]))["$<<"](e)},this.$each(),o)},j.$$arity=0),t.def(ut,"$include?",R=function(e){try{var r;return f(this,"each",[],((r=function(n){var i;r.$$s;if(i=t.slice.call(arguments,0,arguments.length),!c(ft,"Opal").$destructure(i)["$=="](e))return a;t.ret(!0)}).$$s=this,r.$$arity=-1,r)),!1}catch(e){if(e===t.returner)return e.$v;throw e}},R.$$arity=1),t.def(ut,"$inject",D=function(e,r){var n=D.$$p,i=n||a;n&&(D.$$p=null),n&&(D.$$p=null);var s=e;return i!==a&&void 0===r?this.$each.$$p=function(){var e=c(ft,"Opal").$destructure(arguments);void 0!==s?(e=t.yieldX(i,[s,e]),s=e):s=e}:(void 0===r&&(c(ft,"Symbol")["$==="](e)||this.$raise(c(ft,"TypeError"),e.$inspect()+" is not a Symbol"),r=e,s=void 0),this.$each.$$p=function(){var t=c(ft,"Opal").$destructure(arguments);s=void 0!==s?s.$__send__(r,t):t}),this.$each(),null==s?a:s},D.$$arity=-1),t.def(ut,"$lazy",z=function(){var e;return f(o(c(ft,"Enumerator"),"Lazy"),"new",[this,this.$enumerator_size()],((e=function(r,n){var i;e.$$s;return null==r&&(r=a),i=t.slice.call(arguments,1,arguments.length),f(r,"yield",t.to_a(i))}).$$s=this,e.$$arity=-2,e))},z.$$arity=0),t.def(ut,"$enumerator_size",U=function(){return u(this["$respond_to?"]("size"))?this.$size():a},U.$$arity=0),t.alias(ut,"map","collect"),t.def(ut,"$max",q=function(e){var r,n,i=q.$$p,s=i||a,o=this;return i&&(q.$$p=null),i&&(q.$$p=null),void 0===e||e===a?(o.$each.$$p=function(){var e=c(ft,"Opal").$destructure(arguments);void 0!==r?((n=s!==a?t.yieldX(s,[e,r]):e["$<=>"](r))===a&&o.$raise(c(ft,"ArgumentError"),"comparison failed"),n>0&&(r=e)):r=e},o.$each(),void 0===r?a:r):(e=c(ft,"Opal").$coerce_to(e,c(ft,"Integer"),"to_int"),f(o,"sort",[],s.$to_proc()).$reverse().$first(e))},q.$$arity=-1),t.def(ut,"$max_by",H=function(){var e,r,n,i=H.$$p,s=i||a;return i&&(H.$$p=null),i&&(H.$$p=null),u(s)?(this.$each.$$p=function(){var e=c(ft,"Opal").$destructure(arguments),i=t.yield1(s,e);if(void 0===r)return r=e,void(n=i);i["$<=>"](n)>0&&(r=e,n=i)},this.$each(),void 0===r?a:r):f(this,"enum_for",["max_by"],((e=function(){return(e.$$s||this).$enumerator_size()}).$$s=this,e.$$arity=0,e))},H.$$arity=0),t.alias(ut,"member?","include?"),t.def(ut,"$min",Q=function(){var t,e=Q.$$p,r=e||a,n=this;return e&&(Q.$$p=null),e&&(Q.$$p=null),n.$each.$$p=r!==a?function(){var e=c(ft,"Opal").$destructure(arguments);if(void 0!==t){var i=r(e,t);i===a&&n.$raise(c(ft,"ArgumentError"),"comparison failed"),i<0&&(t=e)}else t=e}:function(){var e=c(ft,"Opal").$destructure(arguments);void 0!==t?c(ft,"Opal").$compare(e,t)<0&&(t=e):t=e},n.$each(),void 0===t?a:t},Q.$$arity=0),t.def(ut,"$min_by",Y=function(){var e,r,n,i=Y.$$p,s=i||a;return i&&(Y.$$p=null),i&&(Y.$$p=null),u(s)?(this.$each.$$p=function(){var e=c(ft,"Opal").$destructure(arguments),i=t.yield1(s,e);if(void 0===r)return r=e,void(n=i);i["$<=>"](n)<0&&(r=e,n=i)},this.$each(),void 0===r?a:r):f(this,"enum_for",["min_by"],((e=function(){return(e.$$s||this).$enumerator_size()}).$$s=this,e.$$arity=0,e))},Y.$$arity=0),t.def(ut,"$minmax",G=function(){var t,e,r=G.$$p,n=r||a,i=this;r&&(G.$$p=null),r&&(G.$$p=null),n=u(t=n)?t:f(i,"proc",[],((e=function(t,r){e.$$s;return null==t&&(t=a),null==r&&(r=a),t["$<=>"](r)}).$$s=i,e.$$arity=2,e));var s=a,o=a,l=!0;return i.$each.$$p=function(){var t=c(ft,"Opal").$destructure(arguments);if(l)s=o=t,l=!1;else{var e=n.$call(s,t);e===a?i.$raise(c(ft,"ArgumentError"),"comparison failed"):e>0&&(s=t);var r=n.$call(o,t);r===a?i.$raise(c(ft,"ArgumentError"),"comparison failed"):r<0&&(o=t)}},i.$each(),[s,o]},G.$$arity=0),t.def(ut,"$minmax_by",V=function(){var t=V.$$p;return t&&(V.$$p=null),t&&(V.$$p=null),this.$raise(c(ft,"NotImplementedError"))},V.$$arity=0),t.def(ut,"$none?",J=function(e){try{var r,n,i,s=J.$$p,o=s||a;return s&&(J.$$p=null),s&&(J.$$p=null),u(void 0!==e)?f(this,"each",[],((r=function(n){var i;r.$$s;if(i=$t(t.slice.call(arguments,0,arguments.length)),!u(f(e,"public_send",["==="].concat(t.to_a(i)))))return a;t.ret(!1)}).$$s=this,r.$$arity=-1,r)):f(this,"each",[],o!==a?((n=function(e){var r;n.$$s;if(r=t.slice.call(arguments,0,arguments.length),!u(t.yieldX(o,t.to_a(r))))return a;t.ret(!1)}).$$s=this,n.$$arity=-1,n):((i=function(e){var r,n;i.$$s;if(r=t.slice.call(arguments,0,arguments.length),n=c(ft,"Opal").$destructure(r),!u(n))return a;t.ret(!1)}).$$s=this,i.$$arity=-1,i)),!0}catch(e){if(e===t.returner)return e.$v;throw e}},J.$$arity=-1),t.def(ut,"$one?",X=function(n){try{var i,s,o,l=X.$$p,$=l||a,h=a;return l&&(X.$$p=null),l&&(X.$$p=null),h=0,u(void 0!==n)?f(this,"each",[],((i=function(s){var o;i.$$s;return o=$t(t.slice.call(arguments,0,arguments.length)),u(f(n,"public_send",["==="].concat(t.to_a(o))))?(h=r(h,1),u(e(h,1))?void t.ret(!1):a):a}).$$s=this,i.$$arity=-1,i)):f(this,"each",[],$!==a?((s=function(n){var i;s.$$s;return i=t.slice.call(arguments,0,arguments.length),u(t.yieldX($,t.to_a(i)))?(h=r(h,1),u(e(h,1))?void t.ret(!1):a):a}).$$s=this,s.$$arity=-1,s):((o=function(n){var i;o.$$s;return i=t.slice.call(arguments,0,arguments.length),u(c(ft,"Opal").$destructure(i))?(h=r(h,1),u(e(h,1))?void t.ret(!1):a):a}).$$s=this,o.$$arity=-1,o)),h["$=="](1)}catch(e){if(e===t.returner)return e.$v;throw e}},X.$$arity=-1),t.def(ut,"$partition",W=function(){var e,r=W.$$p,n=r||a;if(r&&(W.$$p=null),r&&(W.$$p=null),n===a)return f(this,"enum_for",["partition"],((e=function(){return(e.$$s||this).$enumerator_size()}).$$s=this,e.$$arity=0,e));var i=[],s=[];return this.$each.$$p=function(){var e=c(ft,"Opal").$destructure(arguments),r=t.yield1(n,e);u(r)?i.push(e):s.push(e)},this.$each(),[i,s]},W.$$arity=0),t.alias(ut,"reduce","inject"),t.def(ut,"$reject",K=function(){var e,r=K.$$p,n=r||a;if(r&&(K.$$p=null),r&&(K.$$p=null),n===a)return f(this,"enum_for",["reject"],((e=function(){return(e.$$s||this).$enumerator_size()}).$$s=this,e.$$arity=0,e));var i=[];return this.$each.$$p=function(){var e=c(ft,"Opal").$destructure(arguments),r=t.yield1(n,e);$(r)&&i.push(e)},this.$each(),i},K.$$arity=0),t.def(ut,"$reverse_each",Z=function(){var e,r=Z.$$p,n=r||a;if(r&&(Z.$$p=null),r&&(Z.$$p=null),n===a)return f(this,"enum_for",["reverse_each"],((e=function(){return(e.$$s||this).$enumerator_size()}).$$s=this,e.$$arity=0,e));var i=[];this.$each.$$p=function(){i.push(arguments)},this.$each();for(var s=i.length-1;s>=0;s--)t.yieldX(n,i[s]);return i},Z.$$arity=0),t.alias(ut,"select","find_all"),t.def(ut,"$slice_before",tt=function(e){var r,n=tt.$$p,i=n||a;return n&&(tt.$$p=null),n&&(tt.$$p=null),u(void 0===e&&i===a)&&this.$raise(c(ft,"ArgumentError"),"both pattern and block are given"),u(void 0!==e&&i!==a||arguments.length>1)&&this.$raise(c(ft,"ArgumentError"),"wrong number of arguments ("+arguments.length+" expected 1)"),f(c(ft,"Enumerator"),"new",[],((r=function(n){var s=r.$$s||this;null==n&&(n=a);var o=[];s.$each.$$p=i!==a?void 0===e?function(){var e=c(ft,"Opal").$destructure(arguments),r=t.yield1(i,e);u(r)&&o.length>0&&(n["$<<"](o),o=[]),o.push(e)}:function(){var t=c(ft,"Opal").$destructure(arguments),r=i(t,e.$dup());u(r)&&o.length>0&&(n["$<<"](o),o=[]),o.push(t)}:function(){var t=c(ft,"Opal").$destructure(arguments),r=e["$==="](t);u(r)&&o.length>0&&(n["$<<"](o),o=[]),o.push(t)},s.$each(),o.length>0&&n["$<<"](o)}).$$s=this,r.$$arity=1,r))},tt.$$arity=-1),t.def(ut,"$slice_after",et=function(e){var r,n,i=et.$$p,s=i||a;return i&&(et.$$p=null),i&&(et.$$p=null),u(void 0===e&&s===a)&&this.$raise(c(ft,"ArgumentError"),"both pattern and block are given"),u(void 0!==e&&s!==a||arguments.length>1)&&this.$raise(c(ft,"ArgumentError"),"wrong number of arguments ("+arguments.length+" expected 1)"),u(void 0!==e)&&(s=f(this,"proc",[],((r=function(t){r.$$s;return null==t&&(t=a),e["$==="](t)}).$$s=this,r.$$arity=1,r))),f(c(ft,"Enumerator"),"new",[],((n=function(e){var r,i=n.$$s||this;null==e&&(e=a),i.$each.$$p=function(){var n=c(ft,"Opal").$destructure(arguments),i=t.yield1(s,n);null==r&&(r=[]),u(i)?(r.push(n),e.$yield(r),r=null):r.push(n)},i.$each(),null!=r&&e.$yield(r)}).$$s=this,n.$$arity=1,n))},et.$$arity=-1),t.def(ut,"$slice_when",rt=function(){var e,r=rt.$$p,n=r||a;return r&&(rt.$$p=null),r&&(rt.$$p=null),n!==a||this.$raise(c(ft,"ArgumentError"),"wrong number of arguments (0 for 1)"),f(c(ft,"Enumerator"),"new",[],((e=function(r){var i=e.$$s||this;null==r&&(r=a);var s=a,o=a;i.$each_cons.$$p=function(){var e=c(ft,"Opal").$destructure(arguments),i=e[0],l=e[1],f=t.yieldX(n,[i,l]);o=l,s===a&&(s=[]),u(f)?(s.push(i),r.$yield(s),s=[]):s.push(i)},i.$each_cons(2),s!==a&&(s.push(o),r.$yield(s))}).$$s=this,e.$$arity=1,e))},rt.$$arity=0),t.def(ut,"$sort",nt=function(){var t,e,r=nt.$$p,n=r||a;return r&&(nt.$$p=null),r&&(nt.$$p=null),e=this.$to_a(),n!==a||(n=p(((t=function(e,r){t.$$s;return null==e&&(e=a),null==r&&(r=a),e["$<=>"](r)}).$$s=this,t.$$arity=2,t))),f(e,"sort",[],n.$to_proc())},nt.$$arity=0),t.def(ut,"$sort_by",it=function(){var e,r,n,i,s,o=it.$$p,l=o||a;return o&&(it.$$p=null),o&&(it.$$p=null),l===a?f(this,"enum_for",["sort_by"],((e=function(){return(e.$$s||this).$enumerator_size()}).$$s=this,e.$$arity=0,e)):(s=f(this,"map",[],((r=function(){var e;r.$$s;return e=c(ft,"Opal").$destructure(arguments),[t.yield1(l,e),e]}).$$s=this,r.$$arity=0,r)),f(s,"sort!",[],((n=function(t,e){n.$$s;return null==t&&(t=a),null==e&&(e=a),t[0]["$<=>"](e[0])}).$$s=this,n.$$arity=2,n)),f(s,"map!",[],((i=function(t){i.$$s;return null==t&&(t=a),t[1]}).$$s=this,i.$$arity=1,i)))},it.$$arity=0),t.def(ut,"$sum",st=function(e){var n,i=st.$$p,s=i||a,o=a;return i&&(st.$$p=null),null==e&&(e=0),o=e,f(this,"each",[],((n=function(e){var i,l,u;n.$$s;return i=t.slice.call(arguments,0,arguments.length),l=i,u=s!==a?t.yieldX(s,t.to_a(l)):c(ft,"Opal").$destructure(l),o=r(o,u)}).$$s=this,n.$$arity=-1,n)),o},st.$$arity=-1),t.def(ut,"$take",at=function(t){return this.$first(t)},at.$$arity=1),t.def(ut,"$take_while",ot=function(){try{var e,r=ot.$$p,n=r||a,i=a;return r&&(ot.$$p=null),r&&(ot.$$p=null),u(n)?(i=[],f(this,"each",[],((e=function(r){var s,a;e.$$s;return s=t.slice.call(arguments,0,arguments.length),a=c(ft,"Opal").$destructure(s),u(t.yield1(n,a))||t.ret(i),i.push(a)}).$$s=this,e.$$arity=-1,e))):this.$enum_for("take_while")}catch(e){if(e===t.returner)return e.$v;throw e}},ot.$$arity=0),t.def(ut,"$uniq",ct=function(){var e,r=ct.$$p,i=r||a,s=a;return r&&(ct.$$p=null),r&&(ct.$$p=null),s=h([],{}),f(this,"each",[],((e=function(r){e.$$s;var o,l,$,h=a;return o=t.slice.call(arguments,0,arguments.length),l=c(ft,"Opal").$destructure(o),$=i!==a?t.yield1(i,l):l,u(s["$key?"]($))?a:(h=[$,l],f(s,"[]=",t.to_a(h)),h[n(h.length,1)])}).$$s=this,e.$$arity=-1,e)),s.$values()},ct.$$arity=0),t.alias(ut,"to_a","entries"),t.def(ut,"$zip",lt=function(e){var r,n=lt.$$p;return n&&(lt.$$p=null),n&&(lt.$$p=null),r=t.slice.call(arguments,0,arguments.length),f(this.$to_a(),"zip",t.to_a(r))},lt.$$arity=-1)}(s[0],s)},Opal.modules["corelib/enumerator"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t<e:t["$<"](e)}var n=t.top,i=[],s=t.nil,a=(t.const_get_qualified,t.const_get_relative),o=t.breaker,c=t.slice,l=t.klass,u=t.truthy,f=t.send,$=t.falsy;return t.add_stubs(["$require","$include","$allocate","$new","$to_proc","$coerce_to","$nil?","$empty?","$+","$class","$__send__","$===","$call","$enum_for","$size","$destructure","$inspect","$any?","$[]","$raise","$yield","$each","$enumerator_size","$respond_to?","$try_convert","$<","$for"]),n.$require("corelib/enumerable"),function(n,i,h){var p,d,_,m,y,g,v=l(n,null,"Enumerator"),b=[v].concat(h);return v.$$prototype.size=v.$$prototype.args=v.$$prototype.object=v.$$prototype.method=s,v.$include(a(b,"Enumerable")),v.$$prototype.$$is_enumerator=!0,t.defs(v,"$for",p=function(e,r,n){var i,a,o,c=p.$$p,l=c||s;c&&(p.$$p=null),c&&(p.$$p=null),(i=t.slice.call(arguments,1,arguments.length)).length>0&&(a=i[0],i.splice(0,1)),null==a&&(a="each"),o=i;var u=this.$allocate();return u.object=e,u.size=l,u.method=a,u.args=o,u},p.$$arity=-2),t.def(v,"$initialize",d=function(e){var r=d.$$p,n=r||s;return r&&(d.$$p=null),r&&(d.$$p=null),t.slice.call(arguments,0,arguments.length),u(n)?(this.object=f(a(b,"Generator"),"new",[],n.$to_proc()),this.method="each",this.args=[],this.size=arguments[0]||s,u(this.size)?this.size=a(b,"Opal").$coerce_to(this.size,a(b,"Integer"),"to_int"):s):(this.object=arguments[0],this.method=arguments[1]||"each",this.args=c.call(arguments,2),this.size=s)},d.$$arity=-1),t.def(v,"$each",_=function(r){var n,i,a=_.$$p,o=a||s;return a&&(_.$$p=null),a&&(_.$$p=null),n=t.slice.call(arguments,0,arguments.length),u(u(i=o["$nil?"]())?n["$empty?"]():i)?this:(n=e(this.args,n),u(o["$nil?"]())?f(this.$class(),"new",[this.object,this.method].concat(t.to_a(n))):f(this.object,"__send__",[this.method].concat(t.to_a(n)),o.$to_proc()))},_.$$arity=-1),t.def(v,"$size",m=function(){return u(a(b,"Proc")["$==="](this.size))?f(this.size,"call",t.to_a(this.args)):this.size},m.$$arity=0),t.def(v,"$with_index",y=function(t){var e,r=y.$$p,n=r||s;if(r&&(y.$$p=null),r&&(y.$$p=null),null==t&&(t=0),t=u(t)?a(b,"Opal").$coerce_to(t,a(b,"Integer"),"to_int"):0,!u(n))return f(this,"enum_for",["with_index",t],((e=function(){return(e.$$s||this).$size()}).$$s=this,e.$$arity=0,e));var i=t;return this.$each.$$p=function(){var t=a(b,"Opal").$destructure(arguments),e=n(t,i);return i++,e},this.$each()},y.$$arity=-1),t.alias(v,"with_object","each_with_object"),t.def(v,"$inspect",g=function(){var t=s;return t="#<"+this.$class()+": "+this.object.$inspect()+":"+this.method,u(this.args["$any?"]())&&(t=e(t,"("+this.args.$inspect()["$[]"](a(b,"Range").$new(1,-2))+")")),e(t,">")},g.$$arity=0),function(e,r,n){var i,c,$=l(e,null,"Generator"),h=[$].concat(n);$.$$prototype.block=s,$.$include(a(h,"Enumerable")),t.def($,"$initialize",i=function(){var t=i.$$p,e=t||s;return t&&(i.$$p=null),t&&(i.$$p=null),u(e)||this.$raise(a(h,"LocalJumpError"),"no block given"),this.block=e},i.$$arity=0),t.def($,"$each",c=function(e){var r,n,i=c.$$p,l=i||s;i&&(c.$$p=null),i&&(c.$$p=null),r=t.slice.call(arguments,0,arguments.length),n=f(a(h,"Yielder"),"new",[],l.$to_proc());try{r.unshift(n),t.yieldX(this.block,r)}catch(t){if(t===o)return o.$v;throw t}return this},c.$$arity=-1)}(b[0],0,b),function(e,r,n){var i,a,c,u=l(e,null,"Yielder");[u].concat(n);u.$$prototype.block=s,t.def(u,"$initialize",i=function(){var t=i.$$p,e=t||s;return t&&(i.$$p=null),t&&(i.$$p=null),this.block=e},i.$$arity=0),t.def(u,"$yield",a=function(e){var r;r=t.slice.call(arguments,0,arguments.length);var n=t.yieldX(this.block,r);if(n===o)throw o;return n},a.$$arity=-1),t.def(u,"$<<",c=function(e){var r;return r=t.slice.call(arguments,0,arguments.length),f(this,"yield",t.to_a(r)),this},c.$$arity=-1)}(b[0],0,b),function(n,i,o){var c,h,p,d,_,m,y,g,v,b,A,x,w,k=l(n,i,"Lazy"),E=[k].concat(o);return k.$$prototype.enumerator=s,function(t,e,r){[l(t,e,"StopLazyError")].concat(r)}(E[0],a(E,"Exception"),E),t.def(k,"$initialize",c=function(e,r){var n,i=c.$$p,o=i||s;return i&&(c.$$p=null),i&&(c.$$p=null),null==r&&(r=s),o!==s||this.$raise(a(E,"ArgumentError"),"tried to call lazy new without a block"),this.enumerator=e,f(this,t.find_super_dispatcher(this,"initialize",c,!1),[r],((n=function(r,i){var c,l,u=n.$$s||this;null==r&&(r=s),c=t.slice.call(arguments,1,arguments.length);try{return f(e,"each",t.to_a(c),((l=function(e){var n;l.$$s;(n=t.slice.call(arguments,0,arguments.length)).unshift(r),t.yieldX(o,n)}).$$s=u,l.$$arity=-1,l))}catch(e){if(!t.rescue(e,[a(E,"Exception")]))throw e;try{return s}finally{t.pop_exception()}}}).$$s=this,n.$$arity=-2,n))},c.$$arity=-2),t.alias(k,"force","to_a"),t.def(k,"$lazy",h=function(){return this},h.$$arity=0),t.def(k,"$collect",p=function(){var e,r=p.$$p,n=r||s;return r&&(p.$$p=null),r&&(p.$$p=null),u(n)||this.$raise(a(E,"ArgumentError"),"tried to call lazy map without a block"),f(a(E,"Lazy"),"new",[this,this.$enumerator_size()],((e=function(r,i){var a;e.$$s;null==r&&(r=s),a=t.slice.call(arguments,1,arguments.length);var o=t.yieldX(n,a);r.$yield(o)}).$$s=this,e.$$arity=-2,e))},p.$$arity=0),t.def(k,"$collect_concat",d=function(){var e,r=d.$$p,n=r||s;return r&&(d.$$p=null),r&&(d.$$p=null),u(n)||this.$raise(a(E,"ArgumentError"),"tried to call lazy map without a block"),f(a(E,"Lazy"),"new",[this,s],((e=function(r,i){var o,c,l,u=e.$$s||this;null==r&&(r=s),o=t.slice.call(arguments,1,arguments.length);var $=t.yieldX(n,o);$["$respond_to?"]("force")&&$["$respond_to?"]("each")?f($,"each",[],((c=function(t){c.$$s;return null==t&&(t=s),r.$yield(t)}).$$s=u,c.$$arity=1,c)):a(E,"Opal").$try_convert($,a(E,"Array"),"to_ary")===s?r.$yield($):f($,"each",[],((l=function(t){l.$$s;return null==t&&(t=s),r.$yield(t)}).$$s=u,l.$$arity=1,l))}).$$s=this,e.$$arity=-2,e))},d.$$arity=0),t.def(k,"$drop",_=function(n){var i,o,c,l=s;return n=a(E,"Opal").$coerce_to(n,a(E,"Integer"),"to_int"),u(r(n,0))&&this.$raise(a(E,"ArgumentError"),"attempt to drop negative size"),o=this.$enumerator_size(),c=u(a(E,"Integer")["$==="](o))&&u(r(n,o))?n:o,l=0,f(a(E,"Lazy"),"new",[this,c],((i=function(a,o){var c;i.$$s;return null==a&&(a=s),c=t.slice.call(arguments,1,arguments.length),u(r(l,n))?l=e(l,1):f(a,"yield",t.to_a(c))}).$$s=this,i.$$arity=-2,i))},_.$$arity=1),t.def(k,"$drop_while",m=function(){var e,r=m.$$p,n=r||s,i=s;return r&&(m.$$p=null),r&&(m.$$p=null),u(n)||this.$raise(a(E,"ArgumentError"),"tried to call lazy drop_while without a block"),i=!0,f(a(E,"Lazy"),"new",[this,s],((e=function(r,a){var o;e.$$s;if(null==r&&(r=s),o=t.slice.call(arguments,1,arguments.length),!u(i))return f(r,"yield",t.to_a(o));var c=t.yieldX(n,o);$(c)&&(i=!1,f(r,"yield",t.to_a(o)))}).$$s=this,e.$$arity=-2,e))},m.$$arity=0),t.def(k,"$enum_for",y=function(e,r){var n,i,a,o=y.$$p,c=o||s,l=this;return o&&(y.$$p=null),o&&(y.$$p=null),(n=t.slice.call(arguments,0,arguments.length)).length>0&&(i=n[0],n.splice(0,1)),null==i&&(i="each"),a=n,f(l.$class(),"for",[l,i].concat(t.to_a(a)),c.$to_proc())},y.$$arity=-1),t.def(k,"$find_all",g=function(){var e,r=g.$$p,n=r||s;return r&&(g.$$p=null),r&&(g.$$p=null),u(n)||this.$raise(a(E,"ArgumentError"),"tried to call lazy select without a block"),f(a(E,"Lazy"),"new",[this,s],((e=function(r,i){var a;e.$$s;null==r&&(r=s),a=t.slice.call(arguments,1,arguments.length);var o=t.yieldX(n,a);u(o)&&f(r,"yield",t.to_a(a))}).$$s=this,e.$$arity=-2,e))},g.$$arity=0),t.alias(k,"flat_map","collect_concat"),t.def(k,"$grep",v=function(e){var r,n,i=v.$$p,o=i||s;return i&&(v.$$p=null),i&&(v.$$p=null),u(o)?f(a(E,"Lazy"),"new",[this,s],((r=function(n,i){var c;r.$$s;null==n&&(n=s),c=t.slice.call(arguments,1,arguments.length);var l=a(E,"Opal").$destructure(c),f=e["$==="](l);u(f)&&(f=t.yield1(o,l),n.$yield(t.yield1(o,l)))}).$$s=this,r.$$arity=-2,r)):f(a(E,"Lazy"),"new",[this,s],((n=function(r,i){var o;n.$$s;null==r&&(r=s),o=t.slice.call(arguments,1,arguments.length);var c=a(E,"Opal").$destructure(o),l=e["$==="](c);u(l)&&r.$yield(c)}).$$s=this,n.$$arity=-2,n))},v.$$arity=1),t.alias(k,"map","collect"),t.alias(k,"select","find_all"),t.def(k,"$reject",b=function(){var e,r=b.$$p,n=r||s;return r&&(b.$$p=null),r&&(b.$$p=null),u(n)||this.$raise(a(E,"ArgumentError"),"tried to call lazy reject without a block"),f(a(E,"Lazy"),"new",[this,s],((e=function(r,i){var a;e.$$s;null==r&&(r=s),a=t.slice.call(arguments,1,arguments.length);var o=t.yieldX(n,a);$(o)&&f(r,"yield",t.to_a(a))}).$$s=this,e.$$arity=-2,e))},b.$$arity=0),t.def(k,"$take",A=function(n){var i,o,c,l=s;return n=a(E,"Opal").$coerce_to(n,a(E,"Integer"),"to_int"),u(r(n,0))&&this.$raise(a(E,"ArgumentError"),"attempt to take negative size"),o=this.$enumerator_size(),c=u(a(E,"Integer")["$==="](o))&&u(r(n,o))?n:o,l=0,f(a(E,"Lazy"),"new",[this,c],((i=function(o,c){var $,h=i.$$s||this;return null==o&&(o=s),$=t.slice.call(arguments,1,arguments.length),u(r(l,n))?(f(o,"yield",t.to_a($)),l=e(l,1)):h.$raise(a(E,"StopLazyError"))}).$$s=this,i.$$arity=-2,i))},A.$$arity=1),t.def(k,"$take_while",x=function(){var e,r=x.$$p,n=r||s;return r&&(x.$$p=null),r&&(x.$$p=null),u(n)||this.$raise(a(E,"ArgumentError"),"tried to call lazy take_while without a block"),f(a(E,"Lazy"),"new",[this,s],((e=function(r,i){var o,c=e.$$s||this;null==r&&(r=s),o=t.slice.call(arguments,1,arguments.length);var l=t.yieldX(n,o);u(l)?f(r,"yield",t.to_a(o)):c.$raise(a(E,"StopLazyError"))}).$$s=this,e.$$arity=-2,e))},x.$$arity=0),t.alias(k,"to_enum","enum_for"),t.def(k,"$inspect",w=function(){return"#<"+this.$class()+": "+this.enumerator.$inspect()+">"},w.$$arity=0),s&&"inspect"}(b[0],v,b)}(i[0],0,i)},Opal.modules["corelib/numeric"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t*e:t["$*"](e)}function n(t,e){return"number"==typeof t&&"number"==typeof e?t<e:t["$<"](e)}function i(t,e){return"number"==typeof t&&"number"==typeof e?t/e:t["$/"](e)}var s=t.top,a=[],o=t.nil,c=t.const_get_qualified,l=t.const_get_relative,u=(t.breaker,t.slice,t.klass),f=t.truthy,$=t.hash2;return t.add_stubs(["$require","$include","$instance_of?","$class","$Float","$respond_to?","$coerce","$__send__","$===","$raise","$equal?","$-","$*","$div","$<","$-@","$ceil","$to_f","$denominator","$to_r","$==","$floor","$/","$%","$Complex","$zero?","$numerator","$abs","$arg","$coerce_to!","$round","$to_i","$truncate","$>"]),s.$require("corelib/comparable"),function(s,a,h){var p,d,_,m,y,g,v,b,A,x,w,k,E,S,N,I,C,O,B,M,P,F,L,T,j,R,D,z,U,q,H,Q,Y,G,V,J,X,W=u(s,null,"Numeric"),K=[W].concat(h);return W.$include(l(K,"Comparable")),t.def(W,"$coerce",p=function(t){return f(t["$instance_of?"](this.$class()))?[t,this]:[this.$Float(t),this.$Float(this)]},p.$$arity=1),t.def(W,"$__coerced__",d=function(e,r){var n,i,s=this,a=o,c=o,u=o;return f(r["$respond_to?"]("coerce"))?(i=r.$coerce(s),a=null==(n=t.to_ary(i))[0]?o:n[0],c=null==n[1]?o:n[1],a.$__send__(e,c)):"+"["$==="](u=e)||"-"["$==="](u)||"*"["$==="](u)||"/"["$==="](u)||"%"["$==="](u)||"&"["$==="](u)||"|"["$==="](u)||"^"["$==="](u)||"**"["$==="](u)?s.$raise(l(K,"TypeError"),r.$class()+" can't be coerced into Numeric"):">"["$==="](u)||">="["$==="](u)||"<"["$==="](u)||"<="["$==="](u)||"<=>"["$==="](u)?s.$raise(l(K,"ArgumentError"),"comparison of "+s.$class()+" with "+r.$class()+" failed"):o},d.$$arity=2),t.def(W,"$<=>",_=function(t){return f(this["$equal?"](t))?0:o},_.$$arity=1),t.def(W,"$+@",m=function(){return this},m.$$arity=0),t.def(W,"$-@",y=function(){return e(0,this)},y.$$arity=0),t.def(W,"$%",g=function(t){return e(this,r(t,this.$div(t)))},g.$$arity=1),t.def(W,"$abs",v=function(){return n(this,0)?this["$-@"]():this},v.$$arity=0),t.def(W,"$abs2",b=function(){return r(this,this)},b.$$arity=0),t.def(W,"$angle",A=function(){return n(this,0)?c(l(K,"Math"),"PI"):0},A.$$arity=0),t.alias(W,"arg","angle"),t.def(W,"$ceil",x=function(t){return null==t&&(t=0),this.$to_f().$ceil(t)},x.$$arity=-1),t.def(W,"$conj",w=function(){return this},w.$$arity=0),t.alias(W,"conjugate","conj"),t.def(W,"$denominator",k=function(){return this.$to_r().$denominator()},k.$$arity=0),t.def(W,"$div",E=function(t){return t["$=="](0)&&this.$raise(l(K,"ZeroDivisionError"),"divided by o"),i(this,t).$floor()},E.$$arity=1),t.def(W,"$divmod",S=function(t){return[this.$div(t),this["$%"](t)]},S.$$arity=1),t.def(W,"$fdiv",N=function(t){return i(this.$to_f(),t)},N.$$arity=1),t.def(W,"$floor",I=function(t){return null==t&&(t=0),this.$to_f().$floor(t)},I.$$arity=-1),t.def(W,"$i",C=function(){return this.$Complex(0,this)},C.$$arity=0),t.def(W,"$imag",O=function(){return 0},O.$$arity=0),t.alias(W,"imaginary","imag"),t.def(W,"$integer?",B=function(){return!1},B.$$arity=0),t.alias(W,"magnitude","abs"),t.alias(W,"modulo","%"),t.def(W,"$nonzero?",M=function(){return f(this["$zero?"]())?o:this},M.$$arity=0),t.def(W,"$numerator",P=function(){return this.$to_r().$numerator()},P.$$arity=0),t.alias(W,"phase","arg"),t.def(W,"$polar",F=function(){return[this.$abs(),this.$arg()]},F.$$arity=0),t.def(W,"$quo",L=function(t){return i(l(K,"Opal")["$coerce_to!"](this,l(K,"Rational"),"to_r"),t)},L.$$arity=1),t.def(W,"$real",T=function(){return this},T.$$arity=0),t.def(W,"$real?",j=function(){return!0},j.$$arity=0),t.def(W,"$rect",R=function(){return[this,0]},R.$$arity=0),t.alias(W,"rectangular","rect"),t.def(W,"$round",D=function(t){return this.$to_f().$round(t)},D.$$arity=-1),t.def(W,"$to_c",z=function(){return this.$Complex(this,0)},z.$$arity=0),t.def(W,"$to_int",U=function(){return this.$to_i()},U.$$arity=0),t.def(W,"$truncate",q=function(t){return null==t&&(t=0),this.$to_f().$truncate(t)},q.$$arity=-1),t.def(W,"$zero?",H=function(){return this["$=="](0)},H.$$arity=0),t.def(W,"$positive?",Q=function(){var t,e;return e=0,"number"==typeof(t=this)&&"number"==typeof e?t>e:t["$>"](e)},Q.$$arity=0),t.def(W,"$negative?",Y=function(){return n(this,0)},Y.$$arity=0),t.def(W,"$dup",G=function(){return this},G.$$arity=0),t.def(W,"$clone",V=function(e){if(null==e)e=$([],{});else if(!e.$$is_hash)throw t.ArgumentError.$new("expected kwargs");return null==e.$$smap.freeze&&!0,this},V.$$arity=-1),t.def(W,"$finite?",J=function(){return!0},J.$$arity=0),t.def(W,"$infinite?",X=function(){return o},X.$$arity=0),o&&"infinite?"}(a[0],0,a)},Opal.modules["corelib/array"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t>e:t["$>"](e)}var r=t.top,n=[],i=t.nil,s=t.const_get_qualified,a=t.const_get_relative,o=(t.breaker,t.slice,t.klass),c=t.truthy,l=t.hash2,u=t.send,f=t.gvars;return t.add_stubs(["$require","$include","$to_a","$warn","$raise","$replace","$respond_to?","$to_ary","$coerce_to","$coerce_to?","$===","$join","$to_str","$class","$hash","$<=>","$==","$object_id","$inspect","$enum_for","$bsearch_index","$to_proc","$nil?","$coerce_to!","$>","$*","$enumerator_size","$empty?","$size","$map","$equal?","$dup","$each","$[]","$dig","$eql?","$length","$begin","$end","$exclude_end?","$flatten","$__id__","$to_s","$new","$max","$min","$!","$>=","$**","$delete_if","$reverse","$rotate","$rand","$at","$keep_if","$shuffle!","$<","$sort","$sort_by","$!=","$times","$[]=","$-","$<<","$values","$is_a?","$last","$first","$upto","$reject","$pristine","$singleton_class"]),r.$require("corelib/enumerable"),r.$require("corelib/numeric"),function(r,n,$){var h,p,d,_,m,y,g,v,b,A,x,w,k,E,S,N,I,C,O,B,M,P,F,L,T,j,R,D,z,U,q,H,Q,Y,G,V,J,X,W,K,Z,tt,et,rt,nt,it,st,at,ot,ct,lt,ut,ft,$t,ht,pt,dt,_t,mt,yt,gt,vt,bt,At,xt,wt,kt,Et,St,Nt,It,Ct,Ot,Bt,Mt,Pt,Ft,Lt,Tt,jt,Rt,Dt,zt,Ut,qt,Ht,Qt,Yt,Gt,Vt,Jt,Xt,Wt,Kt=o(r,n,"Array"),Zt=[Kt].concat($);function te(e,r){return r.$$name===t.Array?e:r.$allocate().$replace(e.$to_a())}function ee(t,e){return t===e||0===e?1:e>0&&t>e?ee(t-1,e-1)+ee(t-1,e):0}return Kt.$include(a(Zt,"Enumerable")),t.defineProperty(Kt.$$prototype,"$$is_array",!0),t.defs(Kt,"$[]",h=function(e){return te(t.slice.call(arguments,0,arguments.length),this)},h.$$arity=-1),t.def(Kt,"$initialize",p=function(t,e){var r,n,o=p.$$p,c=o||i;if(o&&(p.$$p=null),o&&(p.$$p=null),null==t&&(t=i),null==e&&(e=i),e!==i&&c!==i&&this.$warn("warning: block supersedes default value argument"),t>s(a(Zt,"Integer"),"MAX")&&this.$raise(a(Zt,"ArgumentError"),"array size too big"),arguments.length>2&&this.$raise(a(Zt,"ArgumentError"),"wrong number of arguments ("+arguments.length+" for 0..2)"),0===arguments.length)return this.splice(0,this.length),this;if(1===arguments.length){if(t.$$is_array)return this.$replace(t.$to_a()),this;if(t["$respond_to?"]("to_ary"))return this.$replace(t.$to_ary()),this}if((t=a(Zt,"Opal").$coerce_to(t,a(Zt,"Integer"),"to_int"))<0&&this.$raise(a(Zt,"ArgumentError"),"negative array size"),this.splice(0,this.length),c===i)for(r=0;r<t;r++)this.push(e);else for(r=0;r<t;r++)n=c(r),this[r]=n;return this},p.$$arity=-1),t.defs(Kt,"$try_convert",d=function(t){return a(Zt,"Opal")["$coerce_to?"](t,a(Zt,"Array"),"to_ary")},d.$$arity=1),t.def(Kt,"$&",_=function(e){e=c(a(Zt,"Array")["$==="](e))?e.$to_a():a(Zt,"Opal").$coerce_to(e,a(Zt,"Array"),"to_ary").$to_a();var r,n,i,s=[],o=l([],{});for(r=0,n=e.length;r<n;r++)t.hash_put(o,e[r],!0);for(r=0,n=this.length;r<n;r++)i=this[r],void 0!==t.hash_delete(o,i)&&s.push(i);return s},_.$$arity=1),t.def(Kt,"$|",m=function(e){e=c(a(Zt,"Array")["$==="](e))?e.$to_a():a(Zt,"Opal").$coerce_to(e,a(Zt,"Array"),"to_ary").$to_a();var r,n,i=l([],{});for(r=0,n=this.length;r<n;r++)t.hash_put(i,this[r],!0);for(r=0,n=e.length;r<n;r++)t.hash_put(i,e[r],!0);return i.$keys()},m.$$arity=1),t.def(Kt,"$*",y=function(t){if(c(t["$respond_to?"]("to_str")))return this.$join(t.$to_str());t=a(Zt,"Opal").$coerce_to(t,a(Zt,"Integer"),"to_int"),c(t<0)&&this.$raise(a(Zt,"ArgumentError"),"negative argument");for(var e=[],r=this.$to_a(),n=0;n<t;n++)e=e.concat(r);return te(e,this.$class())},y.$$arity=1),t.def(Kt,"$+",g=function(t){return t=c(a(Zt,"Array")["$==="](t))?t.$to_a():a(Zt,"Opal").$coerce_to(t,a(Zt,"Array"),"to_ary").$to_a(),this.concat(t)},g.$$arity=1),t.def(Kt,"$-",v=function(e){if(e=c(a(Zt,"Array")["$==="](e))?e.$to_a():a(Zt,"Opal").$coerce_to(e,a(Zt,"Array"),"to_ary").$to_a(),c(0===this.length))return[];if(c(0===e.length))return this.slice();var r,n,i,s=[],o=l([],{});for(r=0,n=e.length;r<n;r++)t.hash_put(o,e[r],!0);for(r=0,n=this.length;r<n;r++)i=this[r],void 0===t.hash_get(o,i)&&s.push(i);return s},v.$$arity=1),t.def(Kt,"$<<",b=function(t){return this.push(t),this},b.$$arity=1),t.def(Kt,"$<=>",A=function(t){if(c(a(Zt,"Array")["$==="](t)))t=t.$to_a();else{if(!c(t["$respond_to?"]("to_ary")))return i;t=t.$to_ary().$to_a()}if(this.$hash()===t.$hash())return 0;for(var e=Math.min(this.length,t.length),r=0;r<e;r++){var n=this[r]["$<=>"](t[r]);if(0!==n)return n}return this.length["$<=>"](t.length)},A.$$arity=1),t.def(Kt,"$==",x=function(t){var e={};return function t(r,n){var i,s,o,c;if(r===n)return!0;if(!n.$$is_array)return!!a(Zt,"Opal")["$respond_to?"](n,"to_ary")&&n["$=="](r);if(r.$$constructor!==Array&&(r=r.$to_a()),n.$$constructor!==Array&&(n=n.$to_a()),r.length!==n.length)return!1;for(e[r.$object_id()]=!0,i=0,s=r.length;i<s;i++)if(o=r[i],c=n[i],o.$$is_array){if(c.$$is_array&&c.length!==o.length)return!1;if(!e.hasOwnProperty(o.$object_id())&&!t(o,c))return!1}else if(!o["$=="](c))return!1;return!0}(this,t)},x.$$arity=1),t.def(Kt,"$[]",w=function(e,r){return e.$$is_range?function(e,r){var n,s,a,o=e.length;return n=r.excl,s=t.Opal.$coerce_to(r.begin,t.Integer,"to_int"),a=t.Opal.$coerce_to(r.end,t.Integer,"to_int"),s<0&&(s+=o)<0?i:s>o?i:a<0&&(a+=o)<0?[]:(n||(a+=1),te(e.slice(s,a),e.$class()))}(this,e):function(e,r,n){var s=e.length;return(r=t.Opal.$coerce_to(r,t.Integer,"to_int"))<0&&(r+=s)<0?i:void 0===n?r>=s||r<0?i:e[r]:(n=t.Opal.$coerce_to(n,t.Integer,"to_int"))<0||r>s||r<0?i:te(e.slice(r,r+n),e.$class())}(this,e,r)},w.$$arity=-2),t.def(Kt,"$[]=",k=function(t,e,r){var n,s,o=i,l=i,u=this.length;if(c(a(Zt,"Range")["$==="](t))){o=c(a(Zt,"Array")["$==="](e))?e.$to_a():c(e["$respond_to?"]("to_ary"))?e.$to_ary().$to_a():[e];var f=t.excl,$=a(Zt,"Opal").$coerce_to(t.begin,a(Zt,"Integer"),"to_int"),h=a(Zt,"Opal").$coerce_to(t.end,a(Zt,"Integer"),"to_int");if($<0&&($+=u)<0&&this.$raise(a(Zt,"RangeError"),t.$inspect()+" out of range"),h<0&&(h+=u),f||(h+=1),$>u)for(n=u;n<$;n++)this[n]=i;return h<0?this.splice.apply(this,[$,0].concat(o)):this.splice.apply(this,[$,h-$].concat(o)),e}if(c(void 0===r)?l=1:(l=e,e=r,o=c(a(Zt,"Array")["$==="](e))?e.$to_a():c(e["$respond_to?"]("to_ary"))?e.$to_ary().$to_a():[e]),t=a(Zt,"Opal").$coerce_to(t,a(Zt,"Integer"),"to_int"),l=a(Zt,"Opal").$coerce_to(l,a(Zt,"Integer"),"to_int"),t<0&&(s=t,(t+=u)<0&&this.$raise(a(Zt,"IndexError"),"index "+s+" too small for array; minimum "+-this.length)),l<0&&this.$raise(a(Zt,"IndexError"),"negative length ("+l+")"),t>u)for(n=u;n<t;n++)this[n]=i;return void 0===r?this[t]=e:this.splice.apply(this,[t,l].concat(o)),e},k.$$arity=-3),t.def(Kt,"$any?",E=function(e){var r,n=E.$$p,s=i,a=i;for(n&&(E.$$p=null),a=0,r=arguments.length,s=new Array(r);a<r;a++)s[a]=arguments[a];return n&&(E.$$p=null),0!==this.length&&u(this,t.find_super_dispatcher(this,"any?",E,!1),s,n)},E.$$arity=-1),t.def(Kt,"$assoc",S=function(t){for(var e,r=0,n=this.length;r<n;r++)if((e=this[r]).length&&e[0]["$=="](t))return e;return i},S.$$arity=1),t.def(Kt,"$at",N=function(t){return(t=a(Zt,"Opal").$coerce_to(t,a(Zt,"Integer"),"to_int"))<0&&(t+=this.length),t<0||t>=this.length?i:this[t]},N.$$arity=1),t.def(Kt,"$bsearch_index",I=function(){var e=I.$$p,r=e||i;if(e&&(I.$$p=null),e&&(I.$$p=null),r===i)return this.$enum_for("bsearch_index");for(var n,s,o,c=0,l=this.length,u=!1,f=i;c<l;){if(s=this[n=c+Math.floor((l-c)/2)],!0===(o=t.yield1(r,s)))f=n,u=!0;else if(!1===o||o===i)u=!1;else if(o.$$is_number){if(0===o)return n;u=o<0}else this.$raise(a(Zt,"TypeError"),"wrong argument type "+o.$class()+" (must be numeric, true, false or nil)");u?l=n:c=n+1}return f},I.$$arity=0),t.def(Kt,"$bsearch",C=function(){var t,e=C.$$p,r=e||i;return e&&(C.$$p=null),e&&(C.$$p=null),r===i?this.$enum_for("bsearch"):null!=(t=u(this,"bsearch_index",[],r.$to_proc()))&&t.$$is_number?this[t]:t},C.$$arity=0),t.def(Kt,"$cycle",O=function(r){var n,o,l,f,$=O.$$p,h=$||i;if($&&(O.$$p=null),$&&(O.$$p=null),null==r&&(r=i),h===i)return u(this,"enum_for",["cycle",r],((n=function(){var t,i,o=n.$$s||this;return c(r["$nil?"]())?s(a(Zt,"Float"),"INFINITY"):(r=a(Zt,"Opal")["$coerce_to!"](r,a(Zt,"Integer"),"to_int"),c(e(r,0))?(t=o.$enumerator_size(),i=r,"number"==typeof t&&"number"==typeof i?t*i:t["$*"](i)):0)}).$$s=this,n.$$arity=0,n));if(c(c(o=this["$empty?"]())?o:r["$=="](0)))return i;if(r===i)for(;;)for(l=0,f=this.length;l<f;l++)t.yield1(h,this[l]);else{if((r=a(Zt,"Opal")["$coerce_to!"](r,a(Zt,"Integer"),"to_int"))<=0)return this;for(;r>0;){for(l=0,f=this.length;l<f;l++)t.yield1(h,this[l]);r--}}return this},O.$$arity=-1),t.def(Kt,"$clear",B=function(){return this.splice(0,this.length),this},B.$$arity=0),t.def(Kt,"$count",M=function(e){var r,n,s=M.$$p,a=s||i,o=i,l=i;for(s&&(M.$$p=null),l=0,n=arguments.length,o=new Array(n);l<n;l++)o[l]=arguments[l];return s&&(M.$$p=null),null==e&&(e=i),c(c(r=e)?r:a)?u(this,t.find_super_dispatcher(this,"count",M,!1),o,s):this.$size()},M.$$arity=-1),t.def(Kt,"$initialize_copy",P=function(t){return this.$replace(t)},P.$$arity=1),t.def(Kt,"$collect",F=function(){var e,r=F.$$p,n=r||i;if(r&&(F.$$p=null),r&&(F.$$p=null),n===i)return u(this,"enum_for",["collect"],((e=function(){return(e.$$s||this).$size()}).$$s=this,e.$$arity=0,e));for(var s=[],a=0,o=this.length;a<o;a++){var c=t.yield1(n,this[a]);s.push(c)}return s},F.$$arity=0),t.def(Kt,"$collect!",L=function(){var e,r=L.$$p,n=r||i;if(r&&(L.$$p=null),r&&(L.$$p=null),n===i)return u(this,"enum_for",["collect!"],((e=function(){return(e.$$s||this).$size()}).$$s=this,e.$$arity=0,e));for(var s=0,a=this.length;s<a;s++){var o=t.yield1(n,this[s]);this[s]=o}return this},L.$$arity=0),t.def(Kt,"$combination",T=function(e){var r,n,s,o,c,l,f,$,h,p=T.$$p,d=p||i;if(p&&(T.$$p=null),n=a(Zt,"Opal")["$coerce_to!"](e,a(Zt,"Integer"),"to_int"),d===i)return u(this,"enum_for",["combination",n],((r=function(){return ee((r.$$s||this).length,n)}).$$s=this,r.$$arity=0,r));if(0===n)t.yield1(d,[]);else if(1===n)for(s=0,o=this.length;s<o;s++)t.yield1(d,[this[s]]);else if(n===this.length)t.yield1(d,this.slice());else if(n>=0&&n<this.length){for(c=[],s=0;s<=n+1;s++)c.push(0);for(l=[],f=0,$=!1,c[0]=-1;!$;){for(l[f]=this[c[f+1]];f<n-1;)h=c[++f+1]=c[f]+1,l[f]=this[h];t.yield1(d,l.slice()),f++;do{$=0===f,c[f]++,f--}while(c[f+1]+n===this.length+f+1)}}return this},T.$$arity=1),t.def(Kt,"$repeated_combination",j=function(e){var r,n,s=j.$$p,o=s||i;if(s&&(j.$$p=null),n=a(Zt,"Opal")["$coerce_to!"](e,a(Zt,"Integer"),"to_int"),o===i)return u(this,"enum_for",["repeated_combination",n],((r=function(){return ee((r.$$s||this).length+n-1,n)}).$$s=this,r.$$arity=0,r));return n>=0&&function e(r,n,i,s){if(i.length!=r)for(var a=n;a<s.length;a++)i.push(s[a]),e(r,a,i,s),i.pop();else{var c=i.slice();t.yield1(o,c)}}(n,0,[],this),this},j.$$arity=1),t.def(Kt,"$compact",R=function(){for(var t,e=[],r=0,n=this.length;r<n;r++)(t=this[r])!==i&&e.push(t);return e},R.$$arity=0),t.def(Kt,"$compact!",D=function(){for(var t=this.length,e=0,r=this.length;e<r;e++)this[e]===i&&(this.splice(e,1),r--,e--);return this.length===t?i:this},D.$$arity=0),t.def(Kt,"$concat",z=function(e){var r,n,s,o;return r=t.slice.call(arguments,0,arguments.length),n=u(n=r,"map",[],((s=function(t){var e=s.$$s||this;return null==t&&(t=i),t=c(a(Zt,"Array")["$==="](t))?t.$to_a():a(Zt,"Opal").$coerce_to(t,a(Zt,"Array"),"to_ary").$to_a(),c(t["$equal?"](e))&&(t=t.$dup()),t}).$$s=this,s.$$arity=1,s)),u(n,"each",[],((o=function(t){var e=o.$$s||this;null==t&&(t=i);for(var r=0,n=t.length;r<n;r++)e.push(t[r])}).$$s=this,o.$$arity=1,o)),this},z.$$arity=-1),t.def(Kt,"$delete",U=function(e){var r=U.$$p,n=r||i;r&&(U.$$p=null);for(var s=this.length,a=0,o=s;a<o;a++)this[a]["$=="](e)&&(this.splice(a,1),o--,a--);return this.length===s?n!==i?t.yieldX(n,[]):i:e},U.$$arity=1),t.def(Kt,"$delete_at",q=function(t){if((t=a(Zt,"Opal").$coerce_to(t,a(Zt,"Integer"),"to_int"))<0&&(t+=this.length),t<0||t>=this.length)return i;var e=this[t];return this.splice(t,1),e},q.$$arity=1),t.def(Kt,"$delete_if",H=function(){var t,e=H.$$p,r=e||i;if(e&&(H.$$p=null),e&&(H.$$p=null),r===i)return u(this,"enum_for",["delete_if"],((t=function(){return(t.$$s||this).$size()}).$$s=this,t.$$arity=0,t));for(var n,s=0,a=this.length;s<a;s++)!1!==(n=r(this[s]))&&n!==i&&(this.splice(s,1),a--,s--);return this},H.$$arity=0),t.def(Kt,"$dig",Q=function(e,r){var n,s=i;return n=t.slice.call(arguments,1,arguments.length),(s=this["$[]"](e))===i||0===n.length?s:(c(s["$respond_to?"]("dig"))||this.$raise(a(Zt,"TypeError"),s.$class()+" does not have #dig method"),u(s,"dig",t.to_a(n)))},Q.$$arity=-2),t.def(Kt,"$drop",Y=function(t){return t<0&&this.$raise(a(Zt,"ArgumentError")),this.slice(t)},Y.$$arity=1),t.def(Kt,"$dup",G=function(){var e,r=G.$$p,n=i,s=i;for(r&&(G.$$p=null),s=0,e=arguments.length,n=new Array(e);s<e;s++)n[s]=arguments[s];return this.$$class===t.Array&&this.$$class.$allocate.$$pristine&&this.$copy_instance_variables.$$pristine&&this.$initialize_dup.$$pristine?this.slice(0):u(this,t.find_super_dispatcher(this,"dup",G,!1),n,r)},G.$$arity=0),t.def(Kt,"$each",V=function(){var e,r=V.$$p,n=r||i;if(r&&(V.$$p=null),r&&(V.$$p=null),n===i)return u(this,"enum_for",["each"],((e=function(){return(e.$$s||this).$size()}).$$s=this,e.$$arity=0,e));for(var s=0,a=this.length;s<a;s++)t.yield1(n,this[s]);return this},V.$$arity=0),t.def(Kt,"$each_index",J=function(){var e,r=J.$$p,n=r||i;if(r&&(J.$$p=null),r&&(J.$$p=null),n===i)return u(this,"enum_for",["each_index"],((e=function(){return(e.$$s||this).$size()}).$$s=this,e.$$arity=0,e));for(var s=0,a=this.length;s<a;s++)t.yield1(n,s);return this},J.$$arity=0),t.def(Kt,"$empty?",X=function(){return 0===this.length},X.$$arity=0),t.def(Kt,"$eql?",W=function(t){var e={};return function t(r,n){var i,s,a,o;if(!n.$$is_array)return!1;if(n=n.$to_a(),r.length!==n.length)return!1;for(e[r.$object_id()]=!0,i=0,s=r.length;i<s;i++)if(a=r[i],o=n[i],a.$$is_array){if(o.$$is_array&&o.length!==a.length)return!1;if(!e.hasOwnProperty(a.$object_id())&&!t(a,o))return!1}else if(!a["$eql?"](o))return!1;return!0}(this,t)},W.$$arity=1),t.def(Kt,"$fetch",K=function(t,e){var r=K.$$p,n=r||i;r&&(K.$$p=null),r&&(K.$$p=null);var s=t;return(t=a(Zt,"Opal").$coerce_to(t,a(Zt,"Integer"),"to_int"))<0&&(t+=this.length),t>=0&&t<this.length?this[t]:(n!==i&&null!=e&&this.$warn("warning: block supersedes default value argument"),n!==i?n(s):null!=e?e:void(0===this.length?this.$raise(a(Zt,"IndexError"),"index "+s+" outside of array bounds: 0...0"):this.$raise(a(Zt,"IndexError"),"index "+s+" outside of array bounds: -"+this.length+"..."+this.length)))},K.$$arity=-2),t.def(Kt,"$fill",Z=function(e){var r,n,s,o,l,u=Z.$$p,f=u||i,$=i,h=i,p=i,d=i,_=i;if(u&&(Z.$$p=null),u&&(Z.$$p=null),r=t.slice.call(arguments,0,arguments.length),c(f)?(c(r.length>2)&&this.$raise(a(Zt,"ArgumentError"),"wrong number of arguments ("+r.$length()+" for 0..2)"),s=r,$=null==(n=t.to_ary(s))[0]?i:n[0],h=null==n[1]?i:n[1]):(c(0==r.length)?this.$raise(a(Zt,"ArgumentError"),"wrong number of arguments (0 for 1..3)"):c(r.length>3)&&this.$raise(a(Zt,"ArgumentError"),"wrong number of arguments ("+r.$length()+" for 1..3)"),s=r,p=null==(n=t.to_ary(s))[0]?i:n[0],$=null==n[1]?i:n[1],h=null==n[2]?i:n[2]),c(a(Zt,"Range")["$==="]($))){if(c(h)&&this.$raise(a(Zt,"TypeError"),"length invalid with range"),d=a(Zt,"Opal").$coerce_to($.$begin(),a(Zt,"Integer"),"to_int"),c(d<0)&&(d+=this.length),c(d<0)&&this.$raise(a(Zt,"RangeError"),$.$inspect()+" out of range"),_=a(Zt,"Opal").$coerce_to($.$end(),a(Zt,"Integer"),"to_int"),c(_<0)&&(_+=this.length),c($["$exclude_end?"]())||(_+=1),c(_<=d))return this}else if(c($))if(d=a(Zt,"Opal").$coerce_to($,a(Zt,"Integer"),"to_int"),c(d<0)&&(d+=this.length),c(d<0)&&(d=0),c(h)){if(_=a(Zt,"Opal").$coerce_to(h,a(Zt,"Integer"),"to_int"),c(0==_))return this;_+=d}else _=this.length;else d=0,_=this.length;if(c(d>this.length))for(o=this.length;o<_;o++)this[o]=i;if(c(_>this.length)&&(this.length=_),c(f))for(this.length;d<_;d++)l=f(d),this[d]=l;else for(this.length;d<_;d++)this[d]=p;return this},Z.$$arity=-1),t.def(Kt,"$first",tt=function(t){return null==t?0===this.length?i:this[0]:((t=a(Zt,"Opal").$coerce_to(t,a(Zt,"Integer"),"to_int"))<0&&this.$raise(a(Zt,"ArgumentError"),"negative array size"),this.slice(0,t))},tt.$$arity=-1),t.def(Kt,"$flatten",et=function(t){var e=this;return void 0!==t&&(t=a(Zt,"Opal").$coerce_to(t,a(Zt,"Integer"),"to_int")),te(function t(r,n){var s,o,c,l,u=[];for(s=0,o=(r=r.$to_a()).length;s<o;s++)if(c=r[s],a(Zt,"Opal")["$respond_to?"](c,"to_ary",!0))if((l=c.$to_ary())!==i)switch(l.$$is_array||e.$raise(a(Zt,"TypeError")),l===e&&e.$raise(a(Zt,"ArgumentError")),n){case void 0:u=u.concat(t(l));break;case 0:u.push(l);break;default:u.push.apply(u,t(l,n-1))}else u.push(c);else u.push(c);return u}(e,t),e.$class())},et.$$arity=-1),t.def(Kt,"$flatten!",rt=function(t){var e=this.$flatten(t);if(this.length==e.length){for(var r=0,n=this.length;r<n&&this[r]===e[r];r++);if(r==n)return i}return this.$replace(e),this},rt.$$arity=-1),t.def(Kt,"$hash",nt=function(){var e,r,n,i=void 0===t.hash_ids,s=["A"],a=this.$object_id();try{if(i&&(t.hash_ids=Object.create(null)),t.hash_ids[a])return"self";for(n in t.hash_ids)if(e=t.hash_ids[n],this["$eql?"](e))return"self";for(t.hash_ids[a]=this,r=0;r<this.length;r++)e=this[r],s.push(e.$hash());return s.join(",")}finally{i&&(t.hash_ids=void 0)}},nt.$$arity=0),t.def(Kt,"$include?",it=function(t){for(var e=0,r=this.length;e<r;e++)if(this[e]["$=="](t))return!0;return!1},it.$$arity=1),t.def(Kt,"$index",st=function(t){var e,r,n,s=st.$$p,a=s||i;if(s&&(st.$$p=null),s&&(st.$$p=null),null!=t&&a!==i&&this.$warn("warning: given block not used"),null!=t){for(e=0,r=this.length;e<r;e++)if(this[e]["$=="](t))return e}else{if(a===i)return this.$enum_for("index");for(e=0,r=this.length;e<r;e++)if(!1!==(n=a(this[e]))&&n!==i)return e}return i},st.$$arity=-1),t.def(Kt,"$insert",at=function(e,r){var n;if(n=t.slice.call(arguments,1,arguments.length),e=a(Zt,"Opal").$coerce_to(e,a(Zt,"Integer"),"to_int"),n.length>0){if(e<0&&(e+=this.length+1)<0&&this.$raise(a(Zt,"IndexError"),e+" is out of bounds"),e>this.length)for(var s=this.length;s<e;s++)this.push(i);this.splice.apply(this,[e,0].concat(n))}return this},at.$$arity=-2),t.def(Kt,"$inspect",ot=function(){for(var t=[],e=this.$__id__(),r=0,n=this.length;r<n;r++){var i=this["$[]"](r);i.$__id__()===e?t.push("[...]"):t.push(i.$inspect())}return"["+t.join(", ")+"]"},ot.$$arity=0),t.def(Kt,"$join",ct=function(e){if(null==f[","]&&(f[","]=i),null==e&&(e=i),c(0===this.length))return"";c(e===i)&&(e=f[","]);var r,n,s,o,l=[];for(r=0,n=this.length;r<n;r++)s=this[r],a(Zt,"Opal")["$respond_to?"](s,"to_str")&&(o=s.$to_str())!==i?l.push(o.$to_s()):a(Zt,"Opal")["$respond_to?"](s,"to_ary")&&((o=s.$to_ary())===this&&this.$raise(a(Zt,"ArgumentError")),o!==i)?l.push(o.$join(e)):a(Zt,"Opal")["$respond_to?"](s,"to_s")&&(o=s.$to_s())!==i?l.push(o):this.$raise(a(Zt,"NoMethodError").$new(t.inspect(s)+" doesn't respond to #to_str, #to_ary or #to_s","to_str"));return e===i?l.join(""):l.join(a(Zt,"Opal")["$coerce_to!"](e,a(Zt,"String"),"to_str").$to_s())},ct.$$arity=-1),t.def(Kt,"$keep_if",lt=function(){var t,e=lt.$$p,r=e||i;if(e&&(lt.$$p=null),e&&(lt.$$p=null),r===i)return u(this,"enum_for",["keep_if"],((t=function(){return(t.$$s||this).$size()}).$$s=this,t.$$arity=0,t));for(var n,s=0,a=this.length;s<a;s++)!1!==(n=r(this[s]))&&n!==i||(this.splice(s,1),a--,s--);return this},lt.$$arity=0),t.def(Kt,"$last",ut=function(t){return null==t?0===this.length?i:this[this.length-1]:((t=a(Zt,"Opal").$coerce_to(t,a(Zt,"Integer"),"to_int"))<0&&this.$raise(a(Zt,"ArgumentError"),"negative array size"),t>this.length&&(t=this.length),this.slice(this.length-t,this.length))},ut.$$arity=-1),t.def(Kt,"$length",ft=function(){return this.length},ft.$$arity=0),t.alias(Kt,"map","collect"),t.alias(Kt,"map!","collect!"),t.def(Kt,"$max",$t=function(t){var e=$t.$$p,r=e||i;return e&&($t.$$p=null),e&&($t.$$p=null),u(this.$each(),"max",[t],r.$to_proc())},$t.$$arity=-1),t.def(Kt,"$min",ht=function(){var t=ht.$$p,e=t||i;return t&&(ht.$$p=null),t&&(ht.$$p=null),u(this.$each(),"min",[],e.$to_proc())},ht.$$arity=0),t.def(Kt,"$permutation",pt=function(e){var r,n,s,o,c=pt.$$p,l=c||i,f=this,$=i,h=i;if(c&&(pt.$$p=null),c&&(pt.$$p=null),l===i)return u(f,"enum_for",["permutation",e],((r=function(){var t=r.$$s||this;return function(t,e){for(var r=e>=0?1:0;e;)r*=t,t--,e--;return r}(t.length,void 0===e?t.length:e)}).$$s=f,r.$$arity=0,r));if((e=void 0===e?f.length:a(Zt,"Opal").$coerce_to(e,a(Zt,"Integer"),"to_int"))<0||f.length<e);else if(0===e)t.yield1(l,[]);else if(1===e)for(var p=0;p<f.length;p++)t.yield1(l,[f[p]]);else $=a(Zt,"Array").$new(e),h=a(Zt,"Array").$new(f.length,!1),n=function(e,r,i,s,a){f=this;for(var c=0;c<f.length;c++)if(s["$[]"](c)["$!"]())if(r[i]=c,i<e-1)s[c]=!0,n.call(f,e,r,i+1,s,a),s[c]=!1;else{o=[];for(var l=0;l<r.length;l++)o.push(f[r[l]]);t.yield1(a,o)}},l!==i?(s=f.slice(),n.call(s,e,$,0,h,l)):n.call(f,e,$,0,h,l);return f},pt.$$arity=-1),t.def(Kt,"$repeated_permutation",dt=function(e){var r,n,s=dt.$$p,o=s||i;if(s&&(dt.$$p=null),n=a(Zt,"Opal")["$coerce_to!"](e,a(Zt,"Integer"),"to_int"),o===i)return u(this,"enum_for",["repeated_permutation",n],((r=function(){var t,e,i=r.$$s||this;return c((e=0,"number"==typeof(t=n)&&"number"==typeof e?t>=e:t["$>="](e)))?i.$size()["$**"](n):0}).$$s=this,r.$$arity=0,r));return function e(r,n,i){if(n.length!=r)for(var s=0;s<i.length;s++)n.push(i[s]),e(r,n,i),n.pop();else{var a=n.slice();t.yield1(o,a)}}(n,[],this.slice()),this},dt.$$arity=1),t.def(Kt,"$pop",_t=function(t){return c(void 0===t)?c(0===this.length)?i:this.pop():(t=a(Zt,"Opal").$coerce_to(t,a(Zt,"Integer"),"to_int"),c(t<0)&&this.$raise(a(Zt,"ArgumentError"),"negative array size"),c(0===this.length)?[]:c(t>this.length)?this.splice(0,this.length):this.splice(this.length-t,this.length))},_t.$$arity=-1),t.def(Kt,"$product",mt=function(e){var r,n,s=mt.$$p,o=s||i;s&&(mt.$$p=null),s&&(mt.$$p=null),r=t.slice.call(arguments,0,arguments.length);var c,l,u,f,$=o!==i?null:[],h=(n=r).length+1,p=new Array(h),d=new Array(h),_=new Array(h),m=1;for(_[0]=this,c=1;c<h;c++)_[c]=a(Zt,"Opal").$coerce_to(n[c-1],a(Zt,"Array"),"to_ary");for(c=0;c<h;c++){if(0===(f=_[c].length))return $||this;(m*=f)>2147483647&&this.$raise(a(Zt,"RangeError"),"too big to product"),d[c]=f,p[c]=0}t:for(;;){for(u=[],c=0;c<h;c++)u.push(_[c][p[c]]);for($?$.push(u):t.yield1(o,u),p[l=h-1]++;p[l]===d[l];){if(p[l]=0,--l<0)break t;p[l]++}}return $||this},mt.$$arity=-1),t.def(Kt,"$push",yt=function(e){for(var r,n=0,i=(r=t.slice.call(arguments,0,arguments.length)).length;n<i;n++)this.push(r[n]);return this},yt.$$arity=-1),t.alias(Kt,"append","push"),t.def(Kt,"$rassoc",gt=function(t){for(var e,r=0,n=this.length;r<n;r++)if((e=this[r]).length&&void 0!==e[1]&&e[1]["$=="](t))return e;return i},gt.$$arity=1),t.def(Kt,"$reject",vt=function(){var t,e=vt.$$p,r=e||i;if(e&&(vt.$$p=null),e&&(vt.$$p=null),r===i)return u(this,"enum_for",["reject"],((t=function(){return(t.$$s||this).$size()}).$$s=this,t.$$arity=0,t));for(var n,s=[],a=0,o=this.length;a<o;a++)!1!==(n=r(this[a]))&&n!==i||s.push(this[a]);return s},vt.$$arity=0),t.def(Kt,"$reject!",bt=function(){var t,e,r=bt.$$p,n=r||i;return r&&(bt.$$p=null),r&&(bt.$$p=null),n===i?u(this,"enum_for",["reject!"],((t=function(){return(t.$$s||this).$size()}).$$s=this,t.$$arity=0,t)):(e=this.$length(),u(this,"delete_if",[],n.$to_proc()),this.$length()["$=="](e)?i:this)},bt.$$arity=0),t.def(Kt,"$replace",At=function(t){return t=c(a(Zt,"Array")["$==="](t))?t.$to_a():a(Zt,"Opal").$coerce_to(t,a(Zt,"Array"),"to_ary").$to_a(),this.splice(0,this.length),this.push.apply(this,t),this},At.$$arity=1),t.def(Kt,"$reverse",xt=function(){return this.slice(0).reverse()},xt.$$arity=0),t.def(Kt,"$reverse!",wt=function(){return this.reverse()},wt.$$arity=0),t.def(Kt,"$reverse_each",kt=function(){var t,e=kt.$$p,r=e||i;return e&&(kt.$$p=null),e&&(kt.$$p=null),r===i?u(this,"enum_for",["reverse_each"],((t=function(){return(t.$$s||this).$size()}).$$s=this,t.$$arity=0,t)):(u(this.$reverse(),"each",[],r.$to_proc()),this)},kt.$$arity=0),t.def(Kt,"$rindex",Et=function(t){var e,r,n=Et.$$p,s=n||i;if(n&&(Et.$$p=null),n&&(Et.$$p=null),null!=t&&s!==i&&this.$warn("warning: given block not used"),null!=t){for(e=this.length-1;e>=0&&!(e>=this.length);e--)if(this[e]["$=="](t))return e}else if(s!==i){for(e=this.length-1;e>=0&&!(e>=this.length);e--)if(!1!==(r=s(this[e]))&&r!==i)return e}else if(null==t)return this.$enum_for("rindex");return i},Et.$$arity=-1),t.def(Kt,"$rotate",St=function(t){var e,r,n,i;return null==t&&(t=1),t=a(Zt,"Opal").$coerce_to(t,a(Zt,"Integer"),"to_int"),1===this.length?this.slice():0===this.length?[]:(r=t%(e=this.slice()).length,n=e.slice(r),i=e.slice(0,r),n.concat(i))},St.$$arity=-1),t.def(Kt,"$rotate!",Nt=function(t){var e;return null==t&&(t=1),0===this.length||1===this.length?this:(t=a(Zt,"Opal").$coerce_to(t,a(Zt,"Integer"),"to_int"),e=this.$rotate(t),this.$replace(e))},Nt.$$arity=-1),function(e,r,n){var s,l,u=o(e,null,"SampleRandom"),f=[u].concat(n);u.$$prototype.rng=i,t.def(u,"$initialize",s=function(t){return this.rng=t},s.$$arity=1),t.def(u,"$rand",l=function(t){var e;return e=a(f,"Opal").$coerce_to(this.rng.$rand(t),a(f,"Integer"),"to_int"),c(e<0)&&this.$raise(a(f,"RangeError"),"random value must be >= 0"),c(e<t)||this.$raise(a(f,"RangeError"),"random value must be less than Array size"),e},l.$$arity=1)}(Zt[0],0,Zt),t.def(Kt,"$sample",It=function(t,e){var r,n,s,o,l,u,f,$,h,p=i,d=i;if(c(void 0===t))return this.$at(a(Zt,"Kernel").$rand(this.length));if(c(void 0===e)?c(p=a(Zt,"Opal")["$coerce_to?"](t,a(Zt,"Hash"),"to_hash"))?(e=p,t=i):(e=i,t=a(Zt,"Opal").$coerce_to(t,a(Zt,"Integer"),"to_int")):(t=a(Zt,"Opal").$coerce_to(t,a(Zt,"Integer"),"to_int"),e=a(Zt,"Opal").$coerce_to(e,a(Zt,"Hash"),"to_hash")),c(c(r=t)?t<0:r)&&this.$raise(a(Zt,"ArgumentError"),"count must be greater than 0"),c(e)&&(d=e["$[]"]("random")),d=c(c(r=d)?d["$respond_to?"]("rand"):r)?a(Zt,"SampleRandom").$new(d):a(Zt,"Kernel"),!c(t))return this[d.$rand(this.length)];switch(t>this.length&&(t=this.length),t){case 0:return[];case 1:return[this[d.$rand(this.length)]];case 2:return(l=d.$rand(this.length))===(u=d.$rand(this.length))&&(u=0===l?l+1:l-1),[this[l],this[u]];default:if(this.length/t>3){for(n=!1,s=0,l=1,(o=a(Zt,"Array").$new(t))[0]=d.$rand(this.length);l<t;){for(f=d.$rand(this.length),u=0;u<l;){for(;f===o[u];){if(++s>100){n=!0;break}f=d.$rand(this.length)}if(n)break;u++}if(n)break;o[l]=f,l++}if(!n){for(l=0;l<t;)o[l]=this[o[l]],l++;return o}}o=this.slice();for(var _=0;_<t;_++)$=d.$rand(this.length),h=o[_],o[_]=o[$],o[$]=h;return t===this.length?o:o["$[]"](0,t)}},It.$$arity=-1),t.def(Kt,"$select",Ct=function(){var e,r=Ct.$$p,n=r||i;if(r&&(Ct.$$p=null),r&&(Ct.$$p=null),n===i)return u(this,"enum_for",["select"],((e=function(){return(e.$$s||this).$size()}).$$s=this,e.$$arity=0,e));for(var s,a,o=[],c=0,l=this.length;c<l;c++)s=this[c],a=t.yield1(n,s),t.truthy(a)&&o.push(s);return o},Ct.$$arity=0),t.def(Kt,"$select!",Ot=function(){var t,e=Ot.$$p,r=e||i;if(e&&(Ot.$$p=null),e&&(Ot.$$p=null),r===i)return u(this,"enum_for",["select!"],((t=function(){return(t.$$s||this).$size()}).$$s=this,t.$$arity=0,t));var n=this.length;return u(this,"keep_if",[],r.$to_proc()),this.length===n?i:this},Ot.$$arity=0),t.def(Kt,"$shift",Bt=function(t){return c(void 0===t)?c(0===this.length)?i:this.shift():(t=a(Zt,"Opal").$coerce_to(t,a(Zt,"Integer"),"to_int"),c(t<0)&&this.$raise(a(Zt,"ArgumentError"),"negative array size"),c(0===this.length)?[]:this.splice(0,t))},Bt.$$arity=-1),t.alias(Kt,"size","length"),t.def(Kt,"$shuffle",Mt=function(t){return this.$dup().$to_a()["$shuffle!"](t)},Mt.$$arity=-1),t.def(Kt,"$shuffle!",Pt=function(t){var e,r,n,s=this.length;for(void 0!==t&&(t=a(Zt,"Opal")["$coerce_to?"](t,a(Zt,"Hash"),"to_hash"))!==i&&(t=t["$[]"]("random"))!==i&&t["$respond_to?"]("rand")&&(e=t);s;)e?((r=e.$rand(s).$to_int())<0&&this.$raise(a(Zt,"RangeError"),"random number too small "+r),r>=s&&this.$raise(a(Zt,"RangeError"),"random number too big "+r)):r=this.$rand(s),n=this[--s],this[s]=this[r],this[r]=n;return this},Pt.$$arity=-1),t.alias(Kt,"slice","[]"),t.def(Kt,"$slice!",Ft=function(t,e){var r=i,n=i,s=i,o=i,l=i;if(r=i,c(void 0===e))if(c(a(Zt,"Range")["$==="](t))){n=t,r=this["$[]"](n),s=a(Zt,"Opal").$coerce_to(n.$begin(),a(Zt,"Integer"),"to_int"),o=a(Zt,"Opal").$coerce_to(n.$end(),a(Zt,"Integer"),"to_int"),s<0&&(s+=this.length),o<0?o+=this.length:o>=this.length&&(o=this.length-1,n.excl&&(o+=1));var u=o-s;n.excl?o-=1:u+=1,s<this.length&&s>=0&&o<this.length&&o>=0&&u>0&&this.splice(s,u)}else{if((l=a(Zt,"Opal").$coerce_to(t,a(Zt,"Integer"),"to_int"))<0&&(l+=this.length),l<0||l>=this.length)return i;r=this[l],0===l?this.shift():this.splice(l,1)}else{if(l=a(Zt,"Opal").$coerce_to(t,a(Zt,"Integer"),"to_int"),(e=a(Zt,"Opal").$coerce_to(e,a(Zt,"Integer"),"to_int"))<0)return i;r=this["$[]"](l,e),l<0&&(l+=this.length),l+e>this.length&&(e=this.length-l),l<this.length&&l>=0&&this.splice(l,e)}return r},Ft.$$arity=-2),t.def(Kt,"$sort",Lt=function(){var t=Lt.$$p,r=t||i,n=this;return t&&(Lt.$$p=null),t&&(Lt.$$p=null),c(n.length>1)?(r===i&&(r=function(t,e){return t["$<=>"](e)}),n.slice().sort(function(t,s){var o,c,l=r(t,s);return l===i&&n.$raise(a(Zt,"ArgumentError"),"comparison of "+t.$inspect()+" with "+s.$inspect()+" failed"),e(l,0)?1:(c=0,("number"==typeof(o=l)&&"number"==typeof c?o<c:o["$<"](c))?-1:0)})):n},Lt.$$arity=0),t.def(Kt,"$sort!",Tt=function(){var t,e=Tt.$$p,r=e||i;e&&(Tt.$$p=null),e&&(Tt.$$p=null),t=r!==i?u(this.slice(),"sort",[],r.$to_proc()):this.slice().$sort(),this.length=0;for(var n=0,s=t.length;n<s;n++)this.push(t[n]);return this},Tt.$$arity=0),t.def(Kt,"$sort_by!",jt=function(){var t,e=jt.$$p,r=e||i;return e&&(jt.$$p=null),e&&(jt.$$p=null),r===i?u(this,"enum_for",["sort_by!"],((t=function(){return(t.$$s||this).$size()}).$$s=this,t.$$arity=0,t)):this.$replace(u(this,"sort_by",[],r.$to_proc()))},jt.$$arity=0),t.def(Kt,"$take",Rt=function(t){return t<0&&this.$raise(a(Zt,"ArgumentError")),this.slice(0,t)},Rt.$$arity=1),t.def(Kt,"$take_while",Dt=function(){var t=Dt.$$p,e=t||i;t&&(Dt.$$p=null),t&&(Dt.$$p=null);for(var r,n,s=[],a=0,o=this.length;a<o;a++){if(!1===(n=e(r=this[a]))||n===i)return s;s.push(r)}return s},Dt.$$arity=0),t.def(Kt,"$to_a",zt=function(){return this},zt.$$arity=0),t.alias(Kt,"to_ary","to_a"),t.def(Kt,"$to_h",Ut=function(){var e,r,n,i,s=this.length,o=l([],{});for(e=0;e<s;e++)(r=a(Zt,"Opal")["$coerce_to?"](this[e],a(Zt,"Array"),"to_ary")).$$is_array||this.$raise(a(Zt,"TypeError"),"wrong element type "+r.$class()+" at "+e+" (expected array)"),2!==r.length&&this.$raise(a(Zt,"ArgumentError"),"wrong array length at "+e+" (expected 2, was "+r.$length()+")"),n=r[0],i=r[1],t.hash_put(o,n,i);return o},Ut.$$arity=0),t.alias(Kt,"to_s","inspect"),t.def(Kt,"$transpose",qt=function(){var e,r=i,n=i;return c(this["$empty?"]())?[]:(r=[],n=i,u(this,"each",[],((e=function(s){var o,l,f=e.$$s||this;return null==s&&(s=i),s=c(a(Zt,"Array")["$==="](s))?s.$to_a():a(Zt,"Opal").$coerce_to(s,a(Zt,"Array"),"to_ary").$to_a(),n=c(o=n)?o:s.length,c(s.length["$!="](n))&&f.$raise(a(Zt,"IndexError"),"element size differs ("+s.length+" should be "+n+")"),u(s.length,"times",[],((l=function(e){l.$$s;var n,a,o,f=i;return null==e&&(e=i),(c(n=r["$[]"](e))?n:(f=[e,[]],u(r,"[]=",t.to_a(f)),f[(a=f.length,o=1,"number"==typeof a&&"number"==typeof o?a-o:a["$-"](o))]))["$<<"](s.$at(e))}).$$s=f,l.$$arity=1,l))}).$$s=this,e.$$arity=1,e)),r)},qt.$$arity=0),t.def(Kt,"$uniq",Ht=function(){var e=Ht.$$p,r=e||i;e&&(Ht.$$p=null),e&&(Ht.$$p=null);var n,s,a,o,c=l([],{});if(r===i)for(n=0,s=this.length;n<s;n++)a=this[n],void 0===t.hash_get(c,a)&&t.hash_put(c,a,a);else for(n=0,s=this.length;n<s;n++)a=this[n],o=t.yield1(r,a),void 0===t.hash_get(c,o)&&t.hash_put(c,o,a);return te(c.$values(),this.$class())},Ht.$$arity=0),t.def(Kt,"$uniq!",Qt=function(){var e=Qt.$$p,r=e||i;e&&(Qt.$$p=null),e&&(Qt.$$p=null);var n,s,a,o,c=this.length,u=l([],{});for(n=0,s=c;n<s;n++)a=this[n],o=r===i?a:t.yield1(r,a),void 0!==t.hash_get(u,o)?(this.splice(n,1),s--,n--):t.hash_put(u,o,a);return this.length===c?i:this},Qt.$$arity=0),t.def(Kt,"$unshift",Yt=function(e){for(var r,n=(r=t.slice.call(arguments,0,arguments.length)).length-1;n>=0;n--)this.unshift(r[n]);return this},Yt.$$arity=-1),t.alias(Kt,"prepend","unshift"),t.def(Kt,"$values_at",Gt=function(e){var r,n,s=i;return r=t.slice.call(arguments,0,arguments.length),s=[],u(r,"each",[],((n=function(t){var e,r=n.$$s||this,o=i,l=i,f=i;return null==t&&(t=i),c(t["$is_a?"](a(Zt,"Range")))?(o=a(Zt,"Opal").$coerce_to(t.$last(),a(Zt,"Integer"),"to_int"),(l=a(Zt,"Opal").$coerce_to(t.$first(),a(Zt,"Integer"),"to_int"))<0?(l+=r.length,i):(o<0&&(o+=r.length),t["$exclude_end?"]()&&o--,o<l?i:u(l,"upto",[o],((e=function(t){var r=e.$$s||this;return null==t&&(t=i),s["$<<"](r.$at(t))}).$$s=r,e.$$arity=1,e)))):(f=a(Zt,"Opal").$coerce_to(t,a(Zt,"Integer"),"to_int"),s["$<<"](r.$at(f)))}).$$s=this,n.$$arity=1,n)),s},Gt.$$arity=-1),t.def(Kt,"$zip",Vt=function(e){var r,n,s=Vt.$$p,o=s||i;s&&(Vt.$$p=null),s&&(Vt.$$p=null),r=t.slice.call(arguments,0,arguments.length);var l,u,f,$,h,p=[],d=this.length;for($=0,h=r.length;$<h;$++)(u=r[$]).$$is_array||(u.$$is_enumerator?u.$size()===1/0?r[$]=u.$take(d):r[$]=u.$to_a():r[$]=(c(n=a(Zt,"Opal")["$coerce_to?"](u,a(Zt,"Array"),"to_ary"))?n:a(Zt,"Opal")["$coerce_to!"](u,a(Zt,"Enumerator"),"each")).$to_a());for(f=0;f<d;f++){for(l=[this[f]],$=0,h=r.length;$<h;$++)null==(u=r[$][f])&&(u=i),l[$+1]=u;p[f]=l}if(o!==i){for(f=0;f<d;f++)o(p[f]);return i}return p},Vt.$$arity=-1),t.defs(Kt,"$inherited",Jt=function(t){t.$$prototype.$to_a=function(){return this.slice(0,this.length)}},Jt.$$arity=1),t.def(Kt,"$instance_variables",Xt=function(){var e,r,n=Xt.$$p,s=i,a=i;for(n&&(Xt.$$p=null),a=0,r=arguments.length,s=new Array(r);a<r;a++)s[a]=arguments[a];return u(u(this,t.find_super_dispatcher(this,"instance_variables",Xt,!1),s,n),"reject",[],((e=function(t){var r;e.$$s;return null==t&&(t=i),c(r=/^@\d+$/.test(t))?r:t["$=="]("@length")}).$$s=this,e.$$arity=1,e))},Xt.$$arity=0),a(Zt,"Opal").$pristine(Kt.$singleton_class(),"allocate"),a(Zt,"Opal").$pristine(Kt,"copy_instance_variables","initialize_dup"),t.def(Kt,"$pack",Wt=function(e){return t.slice.call(arguments,0,arguments.length),this.$raise("To use Array#pack, you must first require 'corelib/array/pack'.")},Wt.$$arity=-1),i&&"pack"}(n[0],Array,n)},Opal.modules["corelib/hash"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t>=e:t["$>="](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}var n=t.top,i=[],s=t.nil,a=(t.const_get_qualified,t.const_get_relative),o=(t.breaker,t.slice,t.klass),c=t.send,l=t.hash2,u=t.truthy;return t.add_stubs(["$require","$include","$coerce_to?","$[]","$merge!","$allocate","$raise","$coerce_to!","$each","$fetch","$>=","$>","$==","$compare_by_identity","$lambda?","$abs","$arity","$enum_for","$size","$respond_to?","$class","$dig","$new","$inspect","$map","$to_proc","$flatten","$eql?","$default","$dup","$default_proc","$default_proc=","$-","$default=","$proc"]),n.$require("corelib/enumerable"),function(n,i,f){var $,h,p,d,_,m,y,g,v,b,A,x,w,k,E,S,N,I,C,O,B,M,P,F,L,T,j,R,D,z,U,q,H,Q,Y,G,V,J,X,W,K,Z,tt,et,rt,nt,it,st,at,ot,ct,lt,ut,ft,$t,ht,pt,dt,_t,mt,yt,gt,vt,bt=o(n,null,"Hash"),At=[bt].concat(f);return bt.$include(a(At,"Enumerable")),bt.$$prototype.$$is_hash=!0,t.defs(bt,"$[]",$=function(e){var r,n,i,o=(r=t.slice.call(arguments,0,arguments.length)).length;if(1===o){if((n=a(At,"Opal")["$coerce_to?"](r["$[]"](0),a(At,"Hash"),"to_hash"))!==s)return this.$allocate()["$merge!"](n);for((r=a(At,"Opal")["$coerce_to?"](r["$[]"](0),a(At,"Array"),"to_ary"))===s&&this.$raise(a(At,"ArgumentError"),"odd number of arguments for Hash"),o=r.length,n=this.$allocate(),i=0;i<o;i++)if(r[i].$$is_array)switch(r[i].length){case 1:n.$store(r[i][0],s);break;case 2:n.$store(r[i][0],r[i][1]);break;default:this.$raise(a(At,"ArgumentError"),"invalid number of elements ("+r[i].length+" for 1..2)")}return n}for(o%2!=0&&this.$raise(a(At,"ArgumentError"),"odd number of arguments for Hash"),n=this.$allocate(),i=0;i<o;i+=2)n.$store(r[i],r[i+1]);return n},$.$$arity=-1),t.defs(bt,"$allocate",h=function(){var e=new this.$$constructor;return t.hash_init(e),e.$$none=s,e.$$proc=s,e},h.$$arity=0),t.defs(bt,"$try_convert",p=function(t){return a(At,"Opal")["$coerce_to?"](t,a(At,"Hash"),"to_hash")},p.$$arity=1),t.def(bt,"$initialize",d=function(t){var e=d.$$p,r=e||s;return e&&(d.$$p=null),e&&(d.$$p=null),void 0!==t&&r!==s&&this.$raise(a(At,"ArgumentError"),"wrong number of arguments (1 for 0)"),this.$$none=void 0===t?s:t,this.$$proc=r,this},d.$$arity=-1),t.def(bt,"$==",_=function(e){if(this===e)return!0;if(!e.$$is_hash)return!1;if(this.$$keys.length!==e.$$keys.length)return!1;for(var r,n,i,s=0,a=this.$$keys,o=a.length;s<o;s++)if((r=a[s]).$$is_string?(n=this.$$smap[r],i=e.$$smap[r]):(n=r.value,i=t.hash_get(e,r.key)),void 0===i||!n["$eql?"](i))return!1;return!0},_.$$arity=1),t.def(bt,"$>=",m=function(t){var e,r=s;return t=a(At,"Opal")["$coerce_to!"](t,a(At,"Hash"),"to_hash"),!(this.$$keys.length<t.$$keys.length)&&(r=!0,c(t,"each",[],((e=function(t,n){var i,a=e.$$s||this;null==t&&(t=s),null==n&&(n=s),null!=(i=a.$fetch(t,null))&&i===n||(r=!1)}).$$s=this,e.$$arity=2,e)),r)},m.$$arity=1),t.def(bt,"$>",y=function(t){return t=a(At,"Opal")["$coerce_to!"](t,a(At,"Hash"),"to_hash"),!(this.$$keys.length<=t.$$keys.length)&&e(this,t)},y.$$arity=1),t.def(bt,"$<",g=function(t){var e,r;return t=a(At,"Opal")["$coerce_to!"](t,a(At,"Hash"),"to_hash"),r=this,"number"==typeof(e=t)&&"number"==typeof r?e>r:e["$>"](r)},g.$$arity=1),t.def(bt,"$<=",v=function(t){return e(t=a(At,"Opal")["$coerce_to!"](t,a(At,"Hash"),"to_hash"),this)},v.$$arity=1),t.def(bt,"$[]",b=function(e){var r=t.hash_get(this,e);return void 0!==r?r:this.$default(e)},b.$$arity=1),t.def(bt,"$[]=",A=function(e,r){return t.hash_put(this,e,r),r},A.$$arity=2),t.def(bt,"$assoc",x=function(t){for(var e,r=0,n=this.$$keys,i=n.length;r<i;r++)if((e=n[r]).$$is_string){if(e["$=="](t))return[e,this.$$smap[e]]}else if(e.key["$=="](t))return[e.key,e.value];return s},x.$$arity=1),t.def(bt,"$clear",w=function(){return t.hash_init(this),this},w.$$arity=0),t.def(bt,"$clone",k=function(){var e=new this.$$class;return t.hash_init(e),t.hash_clone(this,e),e},k.$$arity=0),t.def(bt,"$compact",E=function(){for(var e,r,n=t.hash(),i=0,a=this.$$keys,o=a.length;i<o;i++)(e=a[i]).$$is_string?r=this.$$smap[e]:(r=e.value,e=e.key),r!==s&&t.hash_put(n,e,r);return n},E.$$arity=0),t.def(bt,"$compact!",S=function(){for(var e,r,n=!1,i=0,a=this.$$keys,o=a.length;i<o;i++)(e=a[i]).$$is_string?r=this.$$smap[e]:(r=e.value,e=e.key),r===s&&void 0!==t.hash_delete(this,e)&&(n=!0,o--,i--);return n?this:s},S.$$arity=0),t.def(bt,"$compare_by_identity",N=function(){var e,r,n,i,s=this.$$keys;if(this.$$by_identity)return this;if(0===this.$$keys.length)return this.$$by_identity=!0,this;for(i=l([],{}).$compare_by_identity(),e=0,r=s.length;e<r;e++)(n=s[e]).$$is_string||(n=n.key),t.hash_put(i,n,t.hash_get(this,n));return this.$$by_identity=!0,this.$$map=i.$$map,this.$$smap=i.$$smap,this},N.$$arity=0),t.def(bt,"$compare_by_identity?",I=function(){return!0===this.$$by_identity},I.$$arity=0),t.def(bt,"$default",C=function(t){return void 0!==t&&this.$$proc!==s&&void 0!==this.$$proc?this.$$proc.$call(this,t):void 0===this.$$none?s:this.$$none},C.$$arity=-1),t.def(bt,"$default=",O=function(t){return this.$$proc=s,this.$$none=t,t},O.$$arity=1),t.def(bt,"$default_proc",B=function(){return void 0!==this.$$proc?this.$$proc:s},B.$$arity=0),t.def(bt,"$default_proc=",M=function(t){var e=t;return e!==s&&(e=a(At,"Opal")["$coerce_to!"](e,a(At,"Proc"),"to_proc"))["$lambda?"]()&&2!==e.$arity().$abs()&&this.$raise(a(At,"TypeError"),"default_proc takes two arguments"),this.$$none=s,this.$$proc=e,t},M.$$arity=1),t.def(bt,"$delete",P=function(e){var r=P.$$p,n=r||s;r&&(P.$$p=null),r&&(P.$$p=null);var i=t.hash_delete(this,e);return void 0!==i?i:n!==s?t.yield1(n,e):s},P.$$arity=1),t.def(bt,"$delete_if",F=function(){var e,r=F.$$p,n=r||s;if(r&&(F.$$p=null),r&&(F.$$p=null),!u(n))return c(this,"enum_for",["delete_if"],((e=function(){return(e.$$s||this).$size()}).$$s=this,e.$$arity=0,e));for(var i,a,o,l=0,f=this.$$keys,$=f.length;l<$;l++)(i=f[l]).$$is_string?a=this.$$smap[i]:(a=i.value,i=i.key),!1!==(o=n(i,a))&&o!==s&&void 0!==t.hash_delete(this,i)&&($--,l--);return this},F.$$arity=0),t.alias(bt,"dup","clone"),t.def(bt,"$dig",L=function(e,r){var n,i=s;return n=t.slice.call(arguments,1,arguments.length),(i=this["$[]"](e))===s||0===n.length?i:(u(i["$respond_to?"]("dig"))||this.$raise(a(At,"TypeError"),i.$class()+" does not have #dig method"),c(i,"dig",t.to_a(n)))},L.$$arity=-2),t.def(bt,"$each",T=function(){var e,r=T.$$p,n=r||s;if(r&&(T.$$p=null),r&&(T.$$p=null),!u(n))return c(this,"enum_for",["each"],((e=function(){return(e.$$s||this).$size()}).$$s=this,e.$$arity=0,e));for(var i,a,o=0,l=this.$$keys,f=l.length;o<f;o++)(i=l[o]).$$is_string?a=this.$$smap[i]:(a=i.value,i=i.key),t.yield1(n,[i,a]);return this},T.$$arity=0),t.def(bt,"$each_key",j=function(){var t,e=j.$$p,r=e||s;if(e&&(j.$$p=null),e&&(j.$$p=null),!u(r))return c(this,"enum_for",["each_key"],((t=function(){return(t.$$s||this).$size()}).$$s=this,t.$$arity=0,t));for(var n,i=0,a=this.$$keys,o=a.length;i<o;i++)r((n=a[i]).$$is_string?n:n.key);return this},j.$$arity=0),t.alias(bt,"each_pair","each"),t.def(bt,"$each_value",R=function(){var t,e=R.$$p,r=e||s;if(e&&(R.$$p=null),e&&(R.$$p=null),!u(r))return c(this,"enum_for",["each_value"],((t=function(){return(t.$$s||this).$size()}).$$s=this,t.$$arity=0,t));for(var n,i=0,a=this.$$keys,o=a.length;i<o;i++)r((n=a[i]).$$is_string?this.$$smap[n]:n.value);return this},R.$$arity=0),t.def(bt,"$empty?",D=function(){return 0===this.$$keys.length},D.$$arity=0),t.alias(bt,"eql?","=="),t.def(bt,"$fetch",z=function(e,r){var n=z.$$p,i=n||s;n&&(z.$$p=null),n&&(z.$$p=null);var o=t.hash_get(this,e);return void 0!==o?o:i!==s?i(e):void 0!==r?r:this.$raise(a(At,"KeyError").$new("key not found: "+e.$inspect(),l(["key","receiver"],{key:e,receiver:this})))},z.$$arity=-2),t.def(bt,"$fetch_values",U=function(e){var r,n,i=U.$$p,a=i||s;return i&&(U.$$p=null),i&&(U.$$p=null),r=t.slice.call(arguments,0,arguments.length),c(r,"map",[],((n=function(t){var e=n.$$s||this;return null==t&&(t=s),c(e,"fetch",[t],a.$to_proc())}).$$s=this,n.$$arity=1,n))},U.$$arity=-1),t.def(bt,"$flatten",q=function(t){null==t&&(t=1),t=a(At,"Opal")["$coerce_to!"](t,a(At,"Integer"),"to_int");for(var e,r,n=[],i=0,s=this.$$keys,o=s.length;i<o;i++)if((e=s[i]).$$is_string?r=this.$$smap[e]:(r=e.value,e=e.key),n.push(e),r.$$is_array){if(1===t){n.push(r);continue}n=n.concat(r.$flatten(t-2))}else n.push(r);return n},q.$$arity=-1),t.def(bt,"$has_key?",H=function(e){return void 0!==t.hash_get(this,e)},H.$$arity=1),t.def(bt,"$has_value?",Q=function(t){for(var e,r=0,n=this.$$keys,i=n.length;r<i;r++)if(((e=n[r]).$$is_string?this.$$smap[e]:e.value)["$=="](t))return!0;return!1},Q.$$arity=1),t.def(bt,"$hash",Y=function(){var e,r,n=void 0===t.hash_ids,i=this.$object_id(),s=["Hash"];try{if(n&&(t.hash_ids=Object.create(null)),t[i])return"self";for(e in t.hash_ids)if(r=t.hash_ids[e],this["$eql?"](r))return"self";t.hash_ids[i]=this;for(var a=0,o=this.$$keys,c=o.length;a<c;a++)(e=o[a]).$$is_string?s.push([e,this.$$smap[e].$hash()]):s.push([e.key_hash,e.value.$hash()]);return s.sort().join()}finally{n&&(t.hash_ids=void 0)}},Y.$$arity=0),t.alias(bt,"include?","has_key?"),t.def(bt,"$index",G=function(t){for(var e,r,n=0,i=this.$$keys,a=i.length;n<a;n++)if((e=i[n]).$$is_string?r=this.$$smap[e]:(r=e.value,e=e.key),r["$=="](t))return e;return s},G.$$arity=1),t.def(bt,"$indexes",V=function(e){for(var r,n,i,s=[],a=0,o=(r=t.slice.call(arguments,0,arguments.length)).length;a<o;a++)n=r[a],void 0!==(i=t.hash_get(this,n))?s.push(i):s.push(this.$default());return s},V.$$arity=-1),t.alias(bt,"indices","indexes"),t.def(bt,"$inspect",J=function(){var t=void 0===vt,e=this.$object_id(),r=[];try{if(t&&(vt={}),vt.hasOwnProperty(e))return"{...}";vt[e]=!0;for(var n,i,s=0,a=this.$$keys,o=a.length;s<o;s++)(n=a[s]).$$is_string?i=this.$$smap[n]:(i=n.value,n=n.key),r.push(n.$inspect()+"=>"+i.$inspect());return"{"+r.join(", ")+"}"}finally{t&&(vt=void 0)}},J.$$arity=0),t.def(bt,"$invert",X=function(){for(var e,r,n=t.hash(),i=0,s=this.$$keys,a=s.length;i<a;i++)(e=s[i]).$$is_string?r=this.$$smap[e]:(r=e.value,e=e.key),t.hash_put(n,r,e);return n},X.$$arity=0),t.def(bt,"$keep_if",W=function(){var e,r=W.$$p,n=r||s;if(r&&(W.$$p=null),r&&(W.$$p=null),!u(n))return c(this,"enum_for",["keep_if"],((e=function(){return(e.$$s||this).$size()}).$$s=this,e.$$arity=0,e));for(var i,a,o,l=0,f=this.$$keys,$=f.length;l<$;l++)(i=f[l]).$$is_string?a=this.$$smap[i]:(a=i.value,i=i.key),!1!==(o=n(i,a))&&o!==s||void 0!==t.hash_delete(this,i)&&($--,l--);return this},W.$$arity=0),t.alias(bt,"key","index"),t.alias(bt,"key?","has_key?"),t.def(bt,"$keys",K=function(){for(var t,e=[],r=0,n=this.$$keys,i=n.length;r<i;r++)(t=n[r]).$$is_string?e.push(t):e.push(t.key);return e},K.$$arity=0),t.def(bt,"$length",Z=function(){return this.$$keys.length},Z.$$arity=0),t.alias(bt,"member?","has_key?"),t.def(bt,"$merge",tt=function(t){var e=tt.$$p,r=e||s;return e&&(tt.$$p=null),e&&(tt.$$p=null),c(this.$dup(),"merge!",[t],r.$to_proc())},tt.$$arity=1),t.def(bt,"$merge!",et=function(e){var r=et.$$p,n=r||s;r&&(et.$$p=null),r&&(et.$$p=null),e.$$is_hash||(e=a(At,"Opal")["$coerce_to!"](e,a(At,"Hash"),"to_hash"));var i,o,c,l,u=e.$$keys,f=u.length;if(n===s){for(i=0;i<f;i++)(o=u[i]).$$is_string?l=e.$$smap[o]:(l=o.value,o=o.key),t.hash_put(this,o,l);return this}for(i=0;i<f;i++)(o=u[i]).$$is_string?l=e.$$smap[o]:(l=o.value,o=o.key),void 0!==(c=t.hash_get(this,o))?t.hash_put(this,o,n(o,c,l)):t.hash_put(this,o,l);return this},et.$$arity=1),t.def(bt,"$rassoc",rt=function(t){for(var e,r,n=0,i=this.$$keys,a=i.length;n<a;n++)if((e=i[n]).$$is_string?r=this.$$smap[e]:(r=e.value,e=e.key),r["$=="](t))return[e,r];return s},rt.$$arity=1),t.def(bt,"$rehash",nt=function(){return t.hash_rehash(this),this},nt.$$arity=0),t.def(bt,"$reject",it=function(){var e,r=it.$$p,n=r||s;if(r&&(it.$$p=null),r&&(it.$$p=null),!u(n))return c(this,"enum_for",["reject"],((e=function(){return(e.$$s||this).$size()}).$$s=this,e.$$arity=0,e));for(var i,a,o,l=t.hash(),f=0,$=this.$$keys,h=$.length;f<h;f++)(i=$[f]).$$is_string?a=this.$$smap[i]:(a=i.value,i=i.key),!1!==(o=n(i,a))&&o!==s||t.hash_put(l,i,a);return l},it.$$arity=0),t.def(bt,"$reject!",st=function(){var e,r=st.$$p,n=r||s;if(r&&(st.$$p=null),r&&(st.$$p=null),!u(n))return c(this,"enum_for",["reject!"],((e=function(){return(e.$$s||this).$size()}).$$s=this,e.$$arity=0,e));for(var i,a,o,l=!1,f=0,$=this.$$keys,h=$.length;f<h;f++)(i=$[f]).$$is_string?a=this.$$smap[i]:(a=i.value,i=i.key),!1!==(o=n(i,a))&&o!==s&&void 0!==t.hash_delete(this,i)&&(l=!0,h--,f--);return l?this:s},st.$$arity=0),t.def(bt,"$replace",at=function(e){var n=s;e=a(At,"Opal")["$coerce_to!"](e,a(At,"Hash"),"to_hash"),t.hash_init(this);for(var i,o,l=0,f=e.$$keys,$=f.length;l<$;l++)(i=f[l]).$$is_string?o=e.$$smap[i]:(o=i.value,i=i.key),t.hash_put(this,i,o);return u(e.$default_proc())?(n=[e.$default_proc()],c(this,"default_proc=",t.to_a(n)),n[r(n.length,1)]):(n=[e.$default()],c(this,"default=",t.to_a(n)),n[r(n.length,1)]),this},at.$$arity=1),t.def(bt,"$select",ot=function(){var e,r=ot.$$p,n=r||s;if(r&&(ot.$$p=null),r&&(ot.$$p=null),!u(n))return c(this,"enum_for",["select"],((e=function(){return(e.$$s||this).$size()}).$$s=this,e.$$arity=0,e));for(var i,a,o,l=t.hash(),f=0,$=this.$$keys,h=$.length;f<h;f++)(i=$[f]).$$is_string?a=this.$$smap[i]:(a=i.value,i=i.key),!1!==(o=n(i,a))&&o!==s&&t.hash_put(l,i,a);return l},ot.$$arity=0),t.def(bt,"$select!",ct=function(){var e,r=ct.$$p,n=r||s;if(r&&(ct.$$p=null),r&&(ct.$$p=null),!u(n))return c(this,"enum_for",["select!"],((e=function(){return(e.$$s||this).$size()}).$$s=this,e.$$arity=0,e));for(var i,a,o,l=s,f=0,$=this.$$keys,h=$.length;f<h;f++)(i=$[f]).$$is_string?a=this.$$smap[i]:(a=i.value,i=i.key),!1!==(o=n(i,a))&&o!==s||(void 0!==t.hash_delete(this,i)&&(h--,f--),l=this);return l},ct.$$arity=0),t.def(bt,"$shift",lt=function(){var e,r=this.$$keys;return r.length>0?[e=(e=r[0]).$$is_string?e:e.key,t.hash_delete(this,e)]:this.$default(s)},lt.$$arity=0),t.alias(bt,"size","length"),t.def(bt,"$slice",ut=function(e){var r;r=t.slice.call(arguments,0,arguments.length);for(var n=t.hash(),i=0,s=r.length;i<s;i++){var a=r[i],o=t.hash_get(this,a);void 0!==o&&t.hash_put(n,a,o)}return n},ut.$$arity=-1),t.alias(bt,"store","[]="),t.def(bt,"$to_a",ft=function(){for(var t,e,r=[],n=0,i=this.$$keys,s=i.length;n<s;n++)(t=i[n]).$$is_string?e=this.$$smap[t]:(e=t.value,t=t.key),r.push([t,e]);return r},ft.$$arity=0),t.def(bt,"$to_h",$t=function(){if(this.$$class===t.Hash)return this;var e=new t.Hash;return t.hash_init(e),t.hash_clone(this,e),e},$t.$$arity=0),t.def(bt,"$to_hash",ht=function(){return this},ht.$$arity=0),t.def(bt,"$to_proc",pt=function(){var t;return c(this,"proc",[],((t=function(e){var r=t.$$s||this;return null==e&&r.$raise(a(At,"ArgumentError"),"no key given"),r["$[]"](e)}).$$s=this,t.$$arity=-1,t))},pt.$$arity=0),t.alias(bt,"to_s","inspect"),t.def(bt,"$transform_keys",dt=function(){var e,r=dt.$$p,n=r||s;if(r&&(dt.$$p=null),r&&(dt.$$p=null),!u(n))return c(this,"enum_for",["transform_keys"],((e=function(){return(e.$$s||this).$size()}).$$s=this,e.$$arity=0,e));for(var i,a,o=t.hash(),l=0,f=this.$$keys,$=f.length;l<$;l++)(i=f[l]).$$is_string?a=this.$$smap[i]:(a=i.value,i=i.key),i=t.yield1(n,i),t.hash_put(o,i,a);return o},dt.$$arity=0),t.def(bt,"$transform_keys!",_t=function(){var e,r=_t.$$p,n=r||s;if(r&&(_t.$$p=null),r&&(_t.$$p=null),!u(n))return c(this,"enum_for",["transform_keys!"],((e=function(){return(e.$$s||this).$size()}).$$s=this,e.$$arity=0,e));var i,a,o,l,f=t.slice.call(this.$$keys),$=f.length;for(i=0;i<$;i++)(a=f[i]).$$is_string?o=this.$$smap[a]:(o=a.value,a=a.key),l=t.yield1(n,a),t.hash_delete(this,a),t.hash_put(this,l,o);return this},_t.$$arity=0),t.def(bt,"$transform_values",mt=function(){var e,r=mt.$$p,n=r||s;if(r&&(mt.$$p=null),r&&(mt.$$p=null),!u(n))return c(this,"enum_for",["transform_values"],((e=function(){return(e.$$s||this).$size()}).$$s=this,e.$$arity=0,e));for(var i,a,o=t.hash(),l=0,f=this.$$keys,$=f.length;l<$;l++)(i=f[l]).$$is_string?a=this.$$smap[i]:(a=i.value,i=i.key),a=t.yield1(n,a),t.hash_put(o,i,a);return o},mt.$$arity=0),t.def(bt,"$transform_values!",yt=function(){var e,r=yt.$$p,n=r||s;if(r&&(yt.$$p=null),r&&(yt.$$p=null),!u(n))return c(this,"enum_for",["transform_values!"],((e=function(){return(e.$$s||this).$size()}).$$s=this,e.$$arity=0,e));for(var i,a,o=0,l=this.$$keys,f=l.length;o<f;o++)(i=l[o]).$$is_string?a=this.$$smap[i]:(a=i.value,i=i.key),a=t.yield1(n,a),t.hash_put(this,i,a);return this},yt.$$arity=0),t.alias(bt,"update","merge!"),t.alias(bt,"value?","has_value?"),t.alias(bt,"values_at","indexes"),t.def(bt,"$values",gt=function(){for(var t,e=[],r=0,n=this.$$keys,i=n.length;r<i;r++)(t=n[r]).$$is_string?e.push(this.$$smap[t]):e.push(t.value);return e},gt.$$arity=0),s&&"values"}(i[0],0,i)},Opal.modules["corelib/number"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t>e:t["$>"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t<e:t["$<"](e)}function n(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}function i(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}function s(t,e){return"number"==typeof t&&"number"==typeof e?t/e:t["$/"](e)}function a(t,e){return"number"==typeof t&&"number"==typeof e?t*e:t["$*"](e)}var o=t.top,c=[],l=t.nil,u=t.const_get_qualified,f=t.const_get_relative,$=(t.breaker,t.slice,t.klass),h=t.truthy,p=t.send,d=t.hash2;return t.add_stubs(["$require","$bridge","$raise","$name","$class","$Float","$respond_to?","$coerce_to!","$__coerced__","$===","$!","$>","$**","$new","$<","$to_f","$==","$nan?","$infinite?","$enum_for","$+","$-","$gcd","$lcm","$%","$/","$frexp","$to_i","$ldexp","$rationalize","$*","$<<","$to_r","$truncate","$-@","$size","$<=","$>=","$<=>","$compare","$any?"]),o.$require("corelib/numeric"),function(o,c,_){var m,y,g,v,b,A,x,w,k,E,S,N,I,C,O,B,M,P,F,L,T,j,R,D,z,U,q,H,Q,Y,G,V,J,X,W,K,Z,tt,et,rt,nt,it,st,at,ot,ct,lt,ut,ft,$t,ht,pt,dt,_t,mt,yt,gt,vt,bt,At,xt,wt,kt,Et,St,Nt,It,Ct,Ot,Bt,Mt,Pt,Ft=$(o,c,"Number"),Lt=[Ft].concat(_);f(Lt,"Opal").$bridge(Number,Ft),t.defineProperty(Ft.$$prototype,"$$is_number",!0),Ft.$$is_number_class=!0,function(e,r){var n,i=[e].concat(r);t.def(e,"$allocate",n=function(){return this.$raise(f(i,"TypeError"),"allocator undefined for "+this.$name())},n.$$arity=0),t.udef(e,"$new")}(t.get_singleton_class(Ft),Lt),t.def(Ft,"$coerce",m=function(t){if(t===l)this.$raise(f(Lt,"TypeError"),"can't convert "+t.$class()+" into Float");else{if(t.$$is_string)return[this.$Float(t),this];if(t["$respond_to?"]("to_f"))return[f(Lt,"Opal")["$coerce_to!"](t,f(Lt,"Float"),"to_f"),this];if(t.$$is_number)return[t,this];this.$raise(f(Lt,"TypeError"),"can't convert "+t.$class()+" into Float")}},m.$$arity=1),t.def(Ft,"$__id__",y=function(){return 2*this+1},y.$$arity=0),t.alias(Ft,"object_id","__id__"),t.def(Ft,"$+",g=function(t){return t.$$is_number?this+t:this.$__coerced__("+",t)},g.$$arity=1),t.def(Ft,"$-",v=function(t){return t.$$is_number?this-t:this.$__coerced__("-",t)},v.$$arity=1),t.def(Ft,"$*",b=function(t){return t.$$is_number?this*t:this.$__coerced__("*",t)},b.$$arity=1),t.def(Ft,"$/",A=function(t){return t.$$is_number?this/t:this.$__coerced__("/",t)},A.$$arity=1),t.alias(Ft,"fdiv","/"),t.def(Ft,"$%",x=function(t){return t.$$is_number?t==-1/0?t:0!=t?t<0||this<0?(this%t+t)%t:this%t:void this.$raise(f(Lt,"ZeroDivisionError"),"divided by 0"):this.$__coerced__("%",t)},x.$$arity=1),t.def(Ft,"$&",w=function(t){return t.$$is_number?this&t:this.$__coerced__("&",t)},w.$$arity=1),t.def(Ft,"$|",k=function(t){return t.$$is_number?this|t:this.$__coerced__("|",t)},k.$$arity=1),t.def(Ft,"$^",E=function(t){return t.$$is_number?this^t:this.$__coerced__("^",t)},E.$$arity=1),t.def(Ft,"$<",S=function(t){return t.$$is_number?this<t:this.$__coerced__("<",t)},S.$$arity=1),t.def(Ft,"$<=",N=function(t){return t.$$is_number?this<=t:this.$__coerced__("<=",t)},N.$$arity=1),t.def(Ft,"$>",I=function(t){return t.$$is_number?this>t:this.$__coerced__(">",t)},I.$$arity=1),t.def(Ft,"$>=",C=function(t){return t.$$is_number?this>=t:this.$__coerced__(">=",t)},C.$$arity=1);t.def(Ft,"$<=>",O=function(e){try{return function(t,e){return e.$$is_number?isNaN(t)||isNaN(e)?l:t>e?1:t<e?-1:0:t.$__coerced__("<=>",e)}(this,e)}catch(e){if(!t.rescue(e,[f(Lt,"ArgumentError")]))throw e;try{return l}finally{t.pop_exception()}}},O.$$arity=1),t.def(Ft,"$<<",B=function(t){return(t=f(Lt,"Opal")["$coerce_to!"](t,f(Lt,"Integer"),"to_int"))>0?this<<t:this>>-t},B.$$arity=1),t.def(Ft,"$>>",M=function(t){return(t=f(Lt,"Opal")["$coerce_to!"](t,f(Lt,"Integer"),"to_int"))>0?this>>t:this<<-t},M.$$arity=1),t.def(Ft,"$[]",P=function(t){return(t=f(Lt,"Opal")["$coerce_to!"](t,f(Lt,"Integer"),"to_int"))<0?0:t>=32?this<0?1:0:this>>t&1},P.$$arity=1),t.def(Ft,"$+@",F=function(){return+this},F.$$arity=0),t.def(Ft,"$-@",L=function(){return-this},L.$$arity=0),t.def(Ft,"$~",T=function(){return~this},T.$$arity=0),t.def(Ft,"$**",j=function(t){var n,i;return h(f(Lt,"Integer")["$==="](t))?h(h(n=f(Lt,"Integer")["$==="](this)["$!"]())?n:e(t,0))?Math.pow(this,t):f(Lt,"Rational").$new(this,1)["$**"](t):h((n=r(this,0))?h(i=f(Lt,"Float")["$==="](t))?i:f(Lt,"Rational")["$==="](t):r(this,0))?f(Lt,"Complex").$new(this,0)["$**"](t.$to_f()):h(null!=t.$$is_number)?Math.pow(this,t):this.$__coerced__("**",t)},j.$$arity=1),t.def(Ft,"$===",R=function(t){return t.$$is_number?this.valueOf()===t.valueOf():!!t["$respond_to?"]("==")&&t["$=="](this)},R.$$arity=1),t.def(Ft,"$==",D=function(t){return t.$$is_number?this.valueOf()===t.valueOf():!!t["$respond_to?"]("==")&&t["$=="](this)},D.$$arity=1),t.def(Ft,"$abs",z=function(){return Math.abs(this)},z.$$arity=0),t.def(Ft,"$abs2",U=function(){return Math.abs(this*this)},U.$$arity=0),t.def(Ft,"$allbits?",q=function(t){return(this&(t=f(Lt,"Opal")["$coerce_to!"](t,f(Lt,"Integer"),"to_int")))==t},q.$$arity=1),t.def(Ft,"$anybits?",H=function(t){return 0!=(this&(t=f(Lt,"Opal")["$coerce_to!"](t,f(Lt,"Integer"),"to_int")))},H.$$arity=1),t.def(Ft,"$angle",Q=function(){return h(this["$nan?"]())?this:0==this?1/this>0?0:Math.PI:this<0?Math.PI:0},Q.$$arity=0),t.alias(Ft,"arg","angle"),t.alias(Ft,"phase","angle"),t.def(Ft,"$bit_length",Y=function(){if(h(f(Lt,"Integer")["$==="](this))||this.$raise(f(Lt,"NoMethodError").$new("undefined method `bit_length` for "+this+":Float","bit_length")),0===this||-1===this)return 0;for(var t=0,e=this<0?~this:this;0!=e;)t+=1,e>>>=1;return t},Y.$$arity=0),t.def(Ft,"$ceil",G=function(t){null==t&&(t=0);var e=this.$to_f();if(e%1==0&&t>=0)return e;var r=Math.pow(10,t),n=Math.ceil(e*r)/r;return e%1==0&&(n=Math.round(n)),n},G.$$arity=-1),t.def(Ft,"$chr",V=function(t){return String.fromCharCode(this)},V.$$arity=-1),t.def(Ft,"$denominator",J=function(){var e,r,n=J.$$p,i=l,s=l;for(n&&(J.$$p=null),s=0,r=arguments.length,i=new Array(r);s<r;s++)i[s]=arguments[s];return h(h(e=this["$nan?"]())?e:this["$infinite?"]())?1:p(this,t.find_super_dispatcher(this,"denominator",J,!1),i,n)},J.$$arity=0),t.def(Ft,"$downto",X=function(t){var r,s=X.$$p,a=s||l;if(s&&(X.$$p=null),s&&(X.$$p=null),a===l)return p(this,"enum_for",["downto",t],((r=function(){var s=r.$$s||this;return h(f(Lt,"Numeric")["$==="](t))||s.$raise(f(Lt,"ArgumentError"),"comparison of "+s.$class()+" with "+t.$class()+" failed"),h(e(t,s))?0:n(i(s,t),1)}).$$s=this,r.$$arity=0,r));t.$$is_number||this.$raise(f(Lt,"ArgumentError"),"comparison of "+this.$class()+" with "+t.$class()+" failed");for(var o=this;o>=t;o--)a(o);return this},X.$$arity=1),t.alias(Ft,"eql?","=="),t.def(Ft,"$equal?",W=function(t){var e;return h(e=this["$=="](t))?e:isNaN(this)&&isNaN(t)},W.$$arity=1),t.def(Ft,"$even?",K=function(){return this%2==0},K.$$arity=0),t.def(Ft,"$floor",Z=function(t){null==t&&(t=0);var e=this.$to_f();if(e%1==0&&t>=0)return e;var r=Math.pow(10,t),n=Math.floor(e*r)/r;return e%1==0&&(n=Math.round(n)),n},Z.$$arity=-1),t.def(Ft,"$gcd",tt=function(t){h(f(Lt,"Integer")["$==="](t))||this.$raise(f(Lt,"TypeError"),"not an integer");for(var e=Math.abs(this),r=Math.abs(t);e>0;){var n=e;e=r%e,r=n}return r},tt.$$arity=1),t.def(Ft,"$gcdlcm",et=function(t){return[this.$gcd(),this.$lcm()]},et.$$arity=1),t.def(Ft,"$integer?",rt=function(){return this%1==0},rt.$$arity=0),t.def(Ft,"$is_a?",nt=function(e){var r,n=nt.$$p,i=l,s=l;for(n&&(nt.$$p=null),s=0,r=arguments.length,i=new Array(r);s<r;s++)i[s]=arguments[s];return!!h(e["$=="](f(Lt,"Integer"))?f(Lt,"Integer")["$==="](this):e["$=="](f(Lt,"Integer")))||(!!h(e["$=="](f(Lt,"Integer"))?f(Lt,"Integer")["$==="](this):e["$=="](f(Lt,"Integer")))||(!!h(e["$=="](f(Lt,"Float"))?f(Lt,"Float")["$==="](this):e["$=="](f(Lt,"Float")))||p(this,t.find_super_dispatcher(this,"is_a?",nt,!1),i,n)))},nt.$$arity=1),t.alias(Ft,"kind_of?","is_a?"),t.def(Ft,"$instance_of?",it=function(e){var r,n=it.$$p,i=l,s=l;for(n&&(it.$$p=null),s=0,r=arguments.length,i=new Array(r);s<r;s++)i[s]=arguments[s];return!!h(e["$=="](f(Lt,"Integer"))?f(Lt,"Integer")["$==="](this):e["$=="](f(Lt,"Integer")))||(!!h(e["$=="](f(Lt,"Integer"))?f(Lt,"Integer")["$==="](this):e["$=="](f(Lt,"Integer")))||(!!h(e["$=="](f(Lt,"Float"))?f(Lt,"Float")["$==="](this):e["$=="](f(Lt,"Float")))||p(this,t.find_super_dispatcher(this,"instance_of?",it,!1),i,n)))},it.$$arity=1),t.def(Ft,"$lcm",st=function(t){return h(f(Lt,"Integer")["$==="](t))||this.$raise(f(Lt,"TypeError"),"not an integer"),0==this||0==t?0:Math.abs(this*t/this.$gcd(t))},st.$$arity=1),t.alias(Ft,"magnitude","abs"),t.alias(Ft,"modulo","%"),t.def(Ft,"$next",at=function(){return this+1},at.$$arity=0),t.def(Ft,"$nobits?",ot=function(t){return 0==(this&(t=f(Lt,"Opal")["$coerce_to!"](t,f(Lt,"Integer"),"to_int")))},ot.$$arity=1),t.def(Ft,"$nonzero?",ct=function(){return 0==this?l:this},ct.$$arity=0),t.def(Ft,"$numerator",lt=function(){var e,r,n=lt.$$p,i=l,s=l;for(n&&(lt.$$p=null),s=0,r=arguments.length,i=new Array(r);s<r;s++)i[s]=arguments[s];return h(h(e=this["$nan?"]())?e:this["$infinite?"]())?this:p(this,t.find_super_dispatcher(this,"numerator",lt,!1),i,n)},lt.$$arity=0),t.def(Ft,"$odd?",ut=function(){return this%2!=0},ut.$$arity=0),t.def(Ft,"$ord",ft=function(){return this},ft.$$arity=0),t.def(Ft,"$pow",$t=function(t,e){return 0==this&&this.$raise(f(Lt,"ZeroDivisionError"),"divided by 0"),void 0===e?this["$**"](t):(f(Lt,"Integer")["$==="](t)||this.$raise(f(Lt,"TypeError"),"Integer#pow() 2nd argument not allowed unless a 1st argument is integer"),t<0&&this.$raise(f(Lt,"TypeError"),"Integer#pow() 1st argument cannot be negative when 2nd argument specified"),f(Lt,"Integer")["$==="](e)||this.$raise(f(Lt,"TypeError"),"Integer#pow() 2nd argument not allowed unless all arguments are integers"),0===e&&this.$raise(f(Lt,"ZeroDivisionError"),"divided by 0"),this["$**"](t)["$%"](e))},$t.$$arity=-2),t.def(Ft,"$pred",ht=function(){return this-1},ht.$$arity=0),t.def(Ft,"$quo",pt=function(e){var r,n=pt.$$p,i=l,a=l;for(n&&(pt.$$p=null),a=0,r=arguments.length,i=new Array(r);a<r;a++)i[a]=arguments[a];return h(f(Lt,"Integer")["$==="](this))?p(this,t.find_super_dispatcher(this,"quo",pt,!1),i,n):s(this,e)},pt.$$arity=1),t.def(Ft,"$rationalize",dt=function(e){var r,n,s=l,o=l;return arguments.length>1&&this.$raise(f(Lt,"ArgumentError"),"wrong number of arguments ("+arguments.length+" for 0..1)"),h(f(Lt,"Integer")["$==="](this))?f(Lt,"Rational").$new(this,1):h(this["$infinite?"]())?this.$raise(f(Lt,"FloatDomainError"),"Infinity"):h(this["$nan?"]())?this.$raise(f(Lt,"FloatDomainError"),"NaN"):h(null==e)?(n=f(Lt,"Math").$frexp(this),s=null==(r=t.to_ary(n))[0]?l:r[0],o=null==r[1]?l:r[1],s=f(Lt,"Math").$ldexp(s,u(f(Lt,"Float"),"MANT_DIG")).$to_i(),o=i(o,u(f(Lt,"Float"),"MANT_DIG")),f(Lt,"Rational").$new(a(2,s),1["$<<"](i(1,o))).$rationalize(f(Lt,"Rational").$new(1,1["$<<"](i(1,o))))):this.$to_r().$rationalize(e)},dt.$$arity=-1),t.def(Ft,"$remainder",_t=function(t){return i(this,a(t,s(this,t).$truncate()))},_t.$$arity=1),t.def(Ft,"$round",mt=function(a){var o,c,$,p,d=l;if(h(f(Lt,"Integer")["$==="](this))){if(h(null==a))return this;if(h(h(o=f(Lt,"Float")["$==="](a))?a["$infinite?"]():o)&&this.$raise(f(Lt,"RangeError"),"Infinity"),a=f(Lt,"Opal")["$coerce_to!"](a,f(Lt,"Integer"),"to_int"),h(r(a,u(f(Lt,"Integer"),"MIN")))&&this.$raise(f(Lt,"RangeError"),"out of bounds"),h(a>=0))return this;if(.415241*(a=a["$-@"]())-.125>this.$size())return 0;var _=Math.pow(10,a),m=Math.floor((Math.abs(m)+_/2)/_)*_;return this<0?-m:m}if(h(h(o=this["$nan?"]())?null==a:o)&&this.$raise(f(Lt,"FloatDomainError"),"NaN"),a=f(Lt,"Opal")["$coerce_to!"](a||0,f(Lt,"Integer"),"to_int"),h((p=0,"number"==typeof($=a)&&"number"==typeof p?$<=p:$["$<="](p))))h(this["$nan?"]())?this.$raise(f(Lt,"RangeError"),"NaN"):h(this["$infinite?"]())&&this.$raise(f(Lt,"FloatDomainError"),"Infinity");else{if(a["$=="](0))return Math.round(this);if(h(h(o=this["$nan?"]())?o:this["$infinite?"]()))return this}return c=f(Lt,"Math").$frexp(this),null==(o=t.to_ary(c))[0]?l:o[0],d=null==o[1]?l:o[1],h(function(t,e){return"number"==typeof t&&"number"==typeof e?t>=e:t["$>="](e)}(a,i(n(u(f(Lt,"Float"),"DIG"),2),h(e(d,0))?s(d,4):i(s(d,3),1))))?this:h(r(a,(h(e(d,0))?n(s(d,3),1):s(d,4))["$-@"]()))?0:Math.round(this*Math.pow(10,a))/Math.pow(10,a)},mt.$$arity=-1),t.def(Ft,"$step",yt=function(e,r,n){var i,s,a,o,c,$,h,_=yt.$$p,m=_||l,y=this,g=l,v=l;if(_&&(yt.$$p=null),_&&(yt.$$p=null),i=t.slice.call(arguments,0,arguments.length),null==(s=t.extract_kwargs(i)))s=d([],{});else if(!s.$$is_hash)throw t.ArgumentError.$new("expected kwargs");function b(){void 0!==c&&(a=c),void 0===a&&(a=l),o===l&&y.$raise(f(Lt,"TypeError"),"step must be numeric"),0===o&&y.$raise(f(Lt,"ArgumentError"),"step can't be 0"),void 0!==$&&(o=$),o!==l&&null!=o||(o=1);var t=o["$<=>"](0);t===l&&y.$raise(f(Lt,"ArgumentError"),"0 can't be coerced into "+o.$class()),a!==l&&null!=a||(a=t>0?u(f(Lt,"Float"),"INFINITY"):u(f(Lt,"Float"),"INFINITY")["$-@"]()),f(Lt,"Opal").$compare(y,a)}function A(){if(o>0&&y>a||o<0&&y<a)return 0;if(o===1/0||o===-1/0)return 1;var t=Math.abs,e=Math.floor,r=(t(y)+t(a)+t(a-y))/t(o)*u(f(Lt,"Float"),"EPSILON");return r===1/0||r===-1/0?0:(r>.5&&(r=.5),e((a-y)/o+r)+1)}function x(){if(b(),0===o)return 1/0;if(o%1!=0)return A();if(o>0&&y>a||o<0&&y<a)return 0;var t=Math.ceil,e=Math.abs;return t((e(y-a)+1)/e(o))}if(i.length>0&&(a=i[0],i.splice(0,1)),i.length>0&&(o=i[0],i.splice(0,1)),c=s.$$smap.to,$=s.$$smap.by,void 0!==a&&void 0!==c&&y.$raise(f(Lt,"ArgumentError"),"to is given twice"),void 0!==o&&void 0!==$&&y.$raise(f(Lt,"ArgumentError"),"step is given twice"),m===l)return g=[],v=d([],{}),void 0!==a&&g.push(a),void 0!==o&&g.push(o),void 0!==c&&t.hash_put(v,"to",c),void 0!==$&&t.hash_put(v,"by",$),v["$any?"]()&&g.push(v),p(y,"enum_for",["step"].concat(t.to_a(g)),((h=function(){h.$$s;return x()}).$$s=y,h.$$arity=0,h));if(b(),0===o)for(;;)m(y);if(y%1!=0||a%1!=0||o%1!=0){var w=A();if(w>0)if(o===1/0||o===-1/0)m(y);else{var k,E=0;if(o>0)for(;E<w;)a<(k=E*o+y)&&(k=a),m(k),E+=1;else for(;E<w;)a>(k=E*o+y)&&(k=a),m(k),E+=1}}else{var S=y;if(o>0)for(;S<=a;)m(S),S+=o;else for(;S>=a;)m(S),S+=o}return y},yt.$$arity=-1),t.alias(Ft,"succ","next"),t.def(Ft,"$times",gt=function(){var t,e=gt.$$p,r=e||l;if(e&&(gt.$$p=null),e&&(gt.$$p=null),!h(r))return p(this,"enum_for",["times"],((t=function(){return t.$$s||this}).$$s=this,t.$$arity=0,t));for(var n=0;n<this;n++)r(n);return this},gt.$$arity=0),t.def(Ft,"$to_f",vt=function(){return this},vt.$$arity=0),t.def(Ft,"$to_i",bt=function(){return parseInt(this,10)},bt.$$arity=0),t.alias(Ft,"to_int","to_i"),t.def(Ft,"$to_r",At=function(){var e,r,n=l,s=l;return h(f(Lt,"Integer")["$==="](this))?f(Lt,"Rational").$new(this,1):(r=f(Lt,"Math").$frexp(this),n=null==(e=t.to_ary(r))[0]?l:e[0],s=null==e[1]?l:e[1],n=f(Lt,"Math").$ldexp(n,u(f(Lt,"Float"),"MANT_DIG")).$to_i(),s=i(s,u(f(Lt,"Float"),"MANT_DIG")),a(n,u(f(Lt,"Float"),"RADIX")["$**"](s)).$to_r())},At.$$arity=0),t.def(Ft,"$to_s",xt=function(t){var n;return null==t&&(t=10),t=f(Lt,"Opal")["$coerce_to!"](t,f(Lt,"Integer"),"to_int"),h(h(n=r(t,2))?n:e(t,36))&&this.$raise(f(Lt,"ArgumentError"),"invalid radix "+t),this.toString(t)},xt.$$arity=-1),t.def(Ft,"$truncate",wt=function(t){null==t&&(t=0);var e=this.$to_f();if(e%1==0&&t>=0)return e;var r=Math.pow(10,t),n=parseInt(e*r,10)/r;return e%1==0&&(n=Math.round(n)),n},wt.$$arity=-1),t.alias(Ft,"inspect","to_s"),t.def(Ft,"$digits",kt=function(t){null==t&&(t=10),r(this,0)&&this.$raise(u(f(Lt,"Math"),"DomainError"),"out of domain"),t=f(Lt,"Opal")["$coerce_to!"](t,f(Lt,"Integer"),"to_int"),h(r(t,2))&&this.$raise(f(Lt,"ArgumentError"),"invalid radix "+t);for(var e=this,n=[];0!==e;)n.push(e%t),e=parseInt(e/t,10);return n},kt.$$arity=-1),t.def(Ft,"$divmod",Et=function(e){var r,n,i=Et.$$p,s=l,a=l;for(i&&(Et.$$p=null),a=0,n=arguments.length,s=new Array(n);a<n;a++)s[a]=arguments[a];return h(h(r=this["$nan?"]())?r:e["$nan?"]())?this.$raise(f(Lt,"FloatDomainError"),"NaN"):h(this["$infinite?"]())?this.$raise(f(Lt,"FloatDomainError"),"Infinity"):p(this,t.find_super_dispatcher(this,"divmod",Et,!1),s,i)},Et.$$arity=1),t.def(Ft,"$upto",St=function(t){var e,s=St.$$p,a=s||l;if(s&&(St.$$p=null),s&&(St.$$p=null),a===l)return p(this,"enum_for",["upto",t],((e=function(){var s=e.$$s||this;return h(f(Lt,"Numeric")["$==="](t))||s.$raise(f(Lt,"ArgumentError"),"comparison of "+s.$class()+" with "+t.$class()+" failed"),h(r(t,s))?0:n(i(t,s),1)}).$$s=this,e.$$arity=0,e));t.$$is_number||this.$raise(f(Lt,"ArgumentError"),"comparison of "+this.$class()+" with "+t.$class()+" failed");for(var o=this;o<=t;o++)a(o);return this},St.$$arity=1),t.def(Ft,"$zero?",Nt=function(){return 0==this},Nt.$$arity=0),t.def(Ft,"$size",It=function(){return 4},It.$$arity=0),t.def(Ft,"$nan?",Ct=function(){return isNaN(this)},Ct.$$arity=0),t.def(Ft,"$finite?",Ot=function(){return this!=1/0&&this!=-1/0&&!isNaN(this)},Ot.$$arity=0),t.def(Ft,"$infinite?",Bt=function(){return this==1/0?1:this==-1/0?-1:l},Bt.$$arity=0),t.def(Ft,"$positive?",Mt=function(){return 0!=this&&(this==1/0||1/this>0)},Mt.$$arity=0),t.def(Ft,"$negative?",Pt=function(){return this==-1/0||1/this<0},Pt.$$arity=0)}(c[0],f(c,"Numeric"),c),t.const_set(c[0],"Fixnum",f(c,"Number")),function(e,r,n){var i=$(e,r,"Integer"),s=[i].concat(n);i.$$is_number_class=!0,function(e,r){var n,i,s,a=[e].concat(r);t.def(e,"$allocate",n=function(){return this.$raise(f(a,"TypeError"),"allocator undefined for "+this.$name())},n.$$arity=0),t.udef(e,"$new"),t.def(e,"$===",i=function(t){return!!t.$$is_number&&t%1==0},i.$$arity=1),t.def(e,"$sqrt",s=function(t){return(t=f(a,"Opal")["$coerce_to!"](t,f(a,"Integer"),"to_int"))<0&&this.$raise(u(f(a,"Math"),"DomainError"),'Numerical argument is out of domain - "isqrt"'),parseInt(Math.sqrt(t),10)},s.$$arity=1)}(t.get_singleton_class(i),s),t.const_set(s[0],"MAX",Math.pow(2,30)-1),t.const_set(s[0],"MIN",-Math.pow(2,30))}(c[0],f(c,"Numeric"),c),function(e,r,n){var i=$(e,r,"Float"),s=[i].concat(n);return i.$$is_number_class=!0,function(e,r){var n,i,s=[e].concat(r);t.def(e,"$allocate",n=function(){return this.$raise(f(s,"TypeError"),"allocator undefined for "+this.$name())},n.$$arity=0),t.udef(e,"$new"),t.def(e,"$===",i=function(t){return!!t.$$is_number},i.$$arity=1)}(t.get_singleton_class(i),s),t.const_set(s[0],"INFINITY",1/0),t.const_set(s[0],"MAX",Number.MAX_VALUE),t.const_set(s[0],"MIN",Number.MIN_VALUE),t.const_set(s[0],"NAN",NaN),t.const_set(s[0],"DIG",15),t.const_set(s[0],"MANT_DIG",53),t.const_set(s[0],"RADIX",2),t.const_set(s[0],"EPSILON",Number.EPSILON||2.220446049250313e-16)}(c[0],f(c,"Numeric"),c)},Opal.modules["corelib/range"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t<=e:t["$<="](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t<e:t["$<"](e)}function n(t,e){return"number"==typeof t&&"number"==typeof e?t>e:t["$>"](e)}function i(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}var s=t.top,a=[],o=t.nil,c=t.const_get_qualified,l=t.const_get_relative,u=(t.breaker,t.slice,t.klass),f=t.truthy,$=t.send;return t.add_stubs(["$require","$include","$attr_reader","$raise","$<=>","$include?","$<=","$<","$enum_for","$upto","$to_proc","$respond_to?","$class","$succ","$!","$==","$===","$exclude_end?","$eql?","$begin","$end","$last","$to_a","$>","$-","$abs","$to_i","$coerce_to!","$ceil","$/","$size","$loop","$+","$*","$>=","$each_with_index","$%","$bsearch","$inspect","$[]","$hash"]),s.$require("corelib/enumerable"),function(s,a,h){var p,d,_,m,y,g,v,b,A,x,w,k,E,S,N,I,C,O,B=u(s,null,"Range"),M=[B].concat(h);return B.$$prototype.begin=B.$$prototype.end=B.$$prototype.excl=o,B.$include(l(M,"Enumerable")),B.$$prototype.$$is_range=!0,B.$attr_reader("begin","end"),t.def(B,"$initialize",p=function(t,e,r){return null==r&&(r=!1),f(this.begin)&&this.$raise(l(M,"NameError"),"'initialize' called twice"),f(t["$<=>"](e))||this.$raise(l(M,"ArgumentError"),"bad value for range"),this.begin=t,this.end=e,this.excl=r},p.$$arity=-3),t.def(B,"$==",d=function(t){return!!t.$$is_range&&(this.excl===t.excl&&this.begin==t.begin&&this.end==t.end)},d.$$arity=1),t.def(B,"$===",_=function(t){return this["$include?"](t)},_.$$arity=1),t.def(B,"$cover?",m=function(t){var n,i,s;return i=this.begin["$<=>"](t),!!f(f(n=i)?e(i,0):n)&&(s=t["$<=>"](this.end),f(this.excl)?f(n=s)?r(s,0):n:f(n=s)?e(s,0):n)},m.$$arity=1),t.def(B,"$each",y=function(){var e,n,i,s,a=y.$$p,c=a||o,u=this,h=o;if(a&&(y.$$p=null),a&&(y.$$p=null),c===o)return u.$enum_for("each");if(u.begin.$$is_number&&u.end.$$is_number){for(u.begin%1==0&&u.end%1==0||u.$raise(l(M,"TypeError"),"can't iterate from Float"),i=u.begin,s=u.end+(f(u.excl)?0:1);i<s;i++)c(i);return u}if(u.begin.$$is_string&&u.end.$$is_string)return $(u.begin,"upto",[u.end,u.excl],c.$to_proc()),u;for(h=u.begin,n=u.end,f(h["$respond_to?"]("succ"))||u.$raise(l(M,"TypeError"),"can't iterate from "+h.$class());f(r(h["$<=>"](n),0));)t.yield1(c,h),h=h.$succ();return f(f(e=u.excl["$!"]())?h["$=="](n):e)&&t.yield1(c,h),u},y.$$arity=0),t.def(B,"$eql?",g=function(t){var e,r;return!!f(l(M,"Range")["$==="](t))&&(f(e=f(r=this.excl["$==="](t["$exclude_end?"]()))?this.begin["$eql?"](t.$begin()):r)?this.end["$eql?"](t.$end()):e)},g.$$arity=1),t.def(B,"$exclude_end?",v=function(){return this.excl},v.$$arity=0),t.def(B,"$first",b=function(e){var r,n=b.$$p,i=o,s=o;for(n&&(b.$$p=null),s=0,r=arguments.length,i=new Array(r);s<r;s++)i[s]=arguments[s];return f(null==e)?this.begin:$(this,t.find_super_dispatcher(this,"first",b,!1),i,n)},b.$$arity=-1),t.alias(B,"include?","cover?"),t.def(B,"$last",A=function(t){return f(null==t)?this.end:this.$to_a().$last(t)},A.$$arity=-1),t.def(B,"$max",x=function(){var e,r,i=x.$$p,s=i||o,a=o,c=o;for(i&&(x.$$p=null),c=0,r=arguments.length,a=new Array(r);c<r;c++)a[c]=arguments[c];return s!==o?$(this,t.find_super_dispatcher(this,"max",x,!1),a,i):f(n(this.begin,this.end))?o:f(f(e=this.excl)?this.begin["$=="](this.end):e)?o:this.excl?this.end-1:this.end},x.$$arity=0),t.alias(B,"member?","cover?"),t.def(B,"$min",w=function(){var e,r,i=w.$$p,s=i||o,a=o,c=o;for(i&&(w.$$p=null),c=0,r=arguments.length,a=new Array(r);c<r;c++)a[c]=arguments[c];return s!==o?$(this,t.find_super_dispatcher(this,"min",w,!1),a,i):f(n(this.begin,this.end))?o:f(f(e=this.excl)?this.begin["$=="](this.end):e)?o:this.begin},w.$$arity=0),t.def(B,"$size",k=function(){var t,e,n,i,s=o,a=o;return s=this.begin,a=this.end,f(this.excl)&&(i=1,a="number"==typeof(n=a)&&"number"==typeof i?n-i:n["$-"](i)),f(f(t=l(M,"Numeric")["$==="](s))?l(M,"Numeric")["$==="](a):t)?f(r(a,s))?0:(e=c(l(M,"Float"),"INFINITY"),f([s.$abs(),a.$abs()]["$include?"](e))?e:(Math.abs(a-s)+1).$to_i()):o},k.$$arity=0),t.def(B,"$step",E=function(e){var r,s,a,u=E.$$p,h=u||o,p=this,d=o;function _(){e.$$is_number||(e=l(M,"Opal")["$coerce_to!"](e,l(M,"Integer"),"to_int")),e<0?p.$raise(l(M,"ArgumentError"),"step can't be negative"):0===e&&p.$raise(l(M,"ArgumentError"),"step can't be 0")}function m(){if(!p.begin["$respond_to?"]("succ"))return o;if(p.begin.$$is_string&&p.end.$$is_string)return o;if(e%1==0)return(r=p.$size(),n=e,"number"==typeof r&&"number"==typeof n?r/n:r["$/"](n)).$ceil();var t,r,n,i=p.begin,s=p.end,a=Math.abs,u=Math.floor,f=(a(i)+a(s)+a(s-i))/a(e)*c(l(M,"Float"),"EPSILON");return f>.5&&(f=.5),p.excl?(t=u((s-i)/e-f))*e+i<s&&t++:t=u((s-i)/e+f)+1,t}return u&&(E.$$p=null),null==e&&(e=1),h===o?$(p,"enum_for",["step",e],((r=function(){r.$$s;return _(),m()}).$$s=p,r.$$arity=0,r)):(_(),f(p.begin.$$is_number&&p.end.$$is_number)?(d=0,function(){var r=t.new_brk();try{$(p,"loop",[],((s=function(){var a,c,l,u=s.$$s||this;return null==u.begin&&(u.begin=o),null==u.excl&&(u.excl=o),null==u.end&&(u.end=o),a=i(u.begin,(l=e,"number"==typeof(c=d)&&"number"==typeof l?c*l:c["$*"](l))),f(u.excl)?f(function(t,e){return"number"==typeof t&&"number"==typeof e?t>=e:t["$>="](e)}(a,u.end))&&t.brk(o,r):f(n(a,u.end))&&t.brk(o,r),t.yield1(h,a),d=i(d,1)}).$$s=p,s.$$brk=r,s.$$arity=0,s))}catch(t){if(t===r)return t.$v;throw t}}()):(p.begin.$$is_string&&p.end.$$is_string&&e%1!=0&&p.$raise(l(M,"TypeError"),"no implicit conversion to float from string"),$(p,"each_with_index",[],((a=function(r,n){a.$$s;return null==r&&(r=o),null==n&&(n=o),n["$%"](e)["$=="](0)?t.yield1(h,r):o}).$$s=p,a.$$arity=2,a))),p)},E.$$arity=-1),t.def(B,"$bsearch",S=function(){var t=S.$$p,e=t||o;return t&&(S.$$p=null),t&&(S.$$p=null),e===o?this.$enum_for("bsearch"):(f(this.begin.$$is_number&&this.end.$$is_number)||this.$raise(l(M,"TypeError"),"can't do binary search for "+this.begin.$class()),$(this.$to_a(),"bsearch",[],e.$to_proc()))},S.$$arity=0),t.def(B,"$to_s",N=function(){var t=this;return t.begin+(f(t.excl)?"...":"..")+t.end},N.$$arity=0),t.def(B,"$inspect",I=function(){var t=this;return t.begin.$inspect()+(f(t.excl)?"...":"..")+t.end.$inspect()},I.$$arity=0),t.def(B,"$marshal_load",C=function(t){return this.begin=t["$[]"]("begin"),this.end=t["$[]"]("end"),this.excl=t["$[]"]("excl")},C.$$arity=1),t.def(B,"$hash",O=function(){return[this.begin,this.end,this.excl].$hash()},O.$$arity=0),o&&"hash"}(a[0],0,a)},Opal.modules["corelib/proc"]=function(t){t.top;var e=[],r=t.nil,n=(t.const_get_qualified,t.const_get_relative),i=(t.breaker,t.slice),s=t.klass,a=t.truthy;return t.add_stubs(["$raise","$coerce_to!"]),function(e,o,c){var l,u,f,$,h,p,d,_,m,y,g=s(e,o,"Proc"),v=[g].concat(c);return t.defineProperty(g.$$prototype,"$$is_proc",!0),t.defineProperty(g.$$prototype,"$$is_lambda",!1),t.defs(g,"$new",l=function(){var t=l.$$p,e=t||r;return t&&(l.$$p=null),t&&(l.$$p=null),a(e)||this.$raise(n(v,"ArgumentError"),"tried to create a Proc object without a block"),e},l.$$arity=0),t.def(g,"$call",u=function(e){var n,i=u.$$p,s=i||r;i&&(u.$$p=null),i&&(u.$$p=null),n=t.slice.call(arguments,0,arguments.length),s!==r&&(this.$$p=s);var a,o=this.$$brk;if(o)try{a=this.$$is_lambda?this.apply(null,n):t.yieldX(this,n)}catch(t){if(t===o)return o.$v;throw t}else a=this.$$is_lambda?this.apply(null,n):t.yieldX(this,n);return a},u.$$arity=-1),t.alias(g,"[]","call"),t.alias(g,"===","call"),t.alias(g,"yield","call"),t.def(g,"$to_proc",f=function(){return this},f.$$arity=0),t.def(g,"$lambda?",$=function(){return!!this.$$is_lambda},$.$$arity=0),t.def(g,"$arity",h=function(){return this.$$is_curried?-1:this.$$arity},h.$$arity=0),t.def(g,"$source_location",p=function(){return this.$$is_curried,r},p.$$arity=0),t.def(g,"$binding",d=function(){return this.$$is_curried&&this.$raise(n(v,"ArgumentError"),"Can't create Binding"),r},d.$$arity=0),t.def(g,"$parameters",_=function(){if(this.$$is_curried)return[["rest"]];if(this.$$parameters){if(this.$$is_lambda)return this.$$parameters;var t,e,r=[];for(t=0,e=this.$$parameters.length;t<e;t++){var n=this.$$parameters[t];"req"===n[0]&&(n=["opt",n[1]]),r.push(n)}return r}return[]},_.$$arity=0),t.def(g,"$curry",m=function(t){var e=this;function r(){var s,a=i.call(arguments),o=a.length;return o>t&&e.$$is_lambda&&!e.$$is_curried&&e.$raise(n(v,"ArgumentError"),"wrong number of arguments ("+o+" for "+t+")"),o>=t?e.$call.apply(e,a):((s=function(){return r.apply(null,a.concat(i.call(arguments)))}).$$is_lambda=e.$$is_lambda,s.$$is_curried=!0,s)}return void 0===t?t=e.length:(t=n(v,"Opal")["$coerce_to!"](t,n(v,"Integer"),"to_int"),e.$$is_lambda&&t!==e.length&&e.$raise(n(v,"ArgumentError"),"wrong number of arguments ("+t+" for "+e.length+")")),r.$$is_lambda=e.$$is_lambda,r.$$is_curried=!0,r},m.$$arity=-1),t.def(g,"$dup",y=function(){var t=this.$$original_proc||this,e=function(){return t.apply(this,arguments)};for(var r in this)this.hasOwnProperty(r)&&(e[r]=this[r]);return e},y.$$arity=0),t.alias(g,"clone","dup")}(e[0],Function,e)},Opal.modules["corelib/method"]=function(t){t.top;var e=[],r=t.nil,n=(t.const_get_qualified,t.const_get_relative),i=(t.breaker,t.slice,t.klass),s=t.truthy;return t.add_stubs(["$attr_reader","$arity","$new","$class","$join","$source_location","$raise"]),function(e,a,o){var c,l,u,f,$,h,p,d,_,m=i(e,null,"Method"),y=[m].concat(o);m.$$prototype.method=m.$$prototype.receiver=m.$$prototype.owner=m.$$prototype.name=r,m.$attr_reader("owner","receiver","name"),t.def(m,"$initialize",c=function(t,e,r,n){return this.receiver=t,this.owner=e,this.name=n,this.method=r},c.$$arity=4),t.def(m,"$arity",l=function(){return this.method.$arity()},l.$$arity=0),t.def(m,"$parameters",u=function(){return this.method.$$parameters},u.$$arity=0),t.def(m,"$source_location",f=function(){var t;return s(t=this.method.$$source_location)?t:["(eval)",0]},f.$$arity=0),t.def(m,"$comments",$=function(){var t;return s(t=this.method.$$comments)?t:[]},$.$$arity=0),t.def(m,"$call",h=function(e){var n,i=h.$$p,s=i||r;return i&&(h.$$p=null),i&&(h.$$p=null),n=t.slice.call(arguments,0,arguments.length),this.method.$$p=s,this.method.apply(this.receiver,n)},h.$$arity=-1),t.alias(m,"[]","call"),t.def(m,"$unbind",p=function(){return n(y,"UnboundMethod").$new(this.receiver.$class(),this.owner,this.method,this.name)},p.$$arity=0),t.def(m,"$to_proc",d=function(){var t=this.$call.bind(this);return t.$$unbound=this.method,t.$$is_lambda=!0,t.$$arity=this.method.$$arity,t.$$parameters=this.method.$$parameters,t},d.$$arity=0),t.def(m,"$inspect",_=function(){return"#<"+this.$class()+": "+this.receiver.$class()+"#"+this.name+" (defined in "+this.owner+" in "+this.$source_location().$join(":")+")>"},_.$$arity=0)}(e[0],0,e),function(e,a,o){var c,l,u,f,$,h,p,d=i(e,null,"UnboundMethod"),_=[d].concat(o);return d.$$prototype.method=d.$$prototype.owner=d.$$prototype.name=d.$$prototype.source=r,d.$attr_reader("source","owner","name"),t.def(d,"$initialize",c=function(t,e,r,n){return this.source=t,this.owner=e,this.method=r,this.name=n},c.$$arity=4),t.def(d,"$arity",l=function(){return this.method.$arity()},l.$$arity=0),t.def(d,"$parameters",u=function(){return this.method.$$parameters},u.$$arity=0),t.def(d,"$source_location",f=function(){var t;return s(t=this.method.$$source_location)?t:["(eval)",0]},f.$$arity=0),t.def(d,"$comments",$=function(){var t;return s(t=this.method.$$comments)?t:[]},$.$$arity=0),t.def(d,"$bind",h=function(e){if(this.owner.$$is_module||t.is_a(e,this.owner))return n(_,"Method").$new(e,this.owner,this.method,this.name);this.$raise(n(_,"TypeError"),"can't bind singleton method to a different class (expected "+e+".kind_of?("+this.owner+" to be true)")},h.$$arity=1),t.def(d,"$inspect",p=function(){return"#<"+this.$class()+": "+this.source+"#"+this.name+" (defined in "+this.owner+" in "+this.$source_location().$join(":")+")>"},p.$$arity=0),r&&"inspect"}(e[0],0,e)},Opal.modules["corelib/variables"]=function(t){t.top;var e=[],r=t.nil,n=(t.const_get_qualified,t.const_get_relative),i=(t.breaker,t.slice,t.gvars),s=t.hash2;return t.add_stubs(["$new"]),i["&"]=i["~"]=i["`"]=i["'"]=r,i.LOADED_FEATURES=i['"']=t.loaded_features,i.LOAD_PATH=i[":"]=[],i["/"]="\n",i[","]=r,t.const_set(e[0],"ARGV",[]),t.const_set(e[0],"ARGF",n(e,"Object").$new()),t.const_set(e[0],"ENV",s([],{})),i.VERBOSE=!1,i.DEBUG=!1,i.SAFE=0},Opal.modules["opal/regexp_anchors"]=function(t){t.top;var e=[],r=t.nil,n=(t.const_get_qualified,t.const_get_relative),i=(t.breaker,t.slice,t.module);return t.add_stubs(["$==","$new"]),function(e,s){var a=[i(e,"Opal")].concat(s);t.const_set(a[0],"REGEXP_START",n(a,"RUBY_ENGINE")["$=="]("opal")?"^":r),t.const_set(a[0],"REGEXP_END",n(a,"RUBY_ENGINE")["$=="]("opal")?"$":r),t.const_set(a[0],"FORBIDDEN_STARTING_IDENTIFIER_CHARS","\\u0001-\\u002F\\u003A-\\u0040\\u005B-\\u005E\\u0060\\u007B-\\u007F"),t.const_set(a[0],"FORBIDDEN_ENDING_IDENTIFIER_CHARS","\\u0001-\\u0020\\u0022-\\u002F\\u003A-\\u003E\\u0040\\u005B-\\u005E\\u0060\\u007B-\\u007F"),t.const_set(a[0],"INLINE_IDENTIFIER_REGEXP",n(a,"Regexp").$new("[^"+n(a,"FORBIDDEN_STARTING_IDENTIFIER_CHARS")+"]*[^"+n(a,"FORBIDDEN_ENDING_IDENTIFIER_CHARS")+"]")),t.const_set(a[0],"FORBIDDEN_CONST_NAME_CHARS","\\u0001-\\u0020\\u0021-\\u002F\\u003B-\\u003F\\u0040\\u005B-\\u005E\\u0060\\u007B-\\u007F"),t.const_set(a[0],"CONST_NAME_REGEXP",n(a,"Regexp").$new(n(a,"REGEXP_START")+"(::)?[A-Z][^"+n(a,"FORBIDDEN_CONST_NAME_CHARS")+"]*"+n(a,"REGEXP_END")))}(e[0],e)},Opal.modules["opal/mini"]=function(t){var e=t.top;t.nil,t.const_get_qualified,t.const_get_relative,t.breaker,t.slice;return t.add_stubs(["$require"]),e.$require("opal/base"),e.$require("corelib/nil"),e.$require("corelib/boolean"),e.$require("corelib/string"),e.$require("corelib/comparable"),e.$require("corelib/enumerable"),e.$require("corelib/enumerator"),e.$require("corelib/array"),e.$require("corelib/hash"),e.$require("corelib/number"),e.$require("corelib/range"),e.$require("corelib/proc"),e.$require("corelib/method"),e.$require("corelib/regexp"),e.$require("corelib/variables"),e.$require("opal/regexp_anchors")},Opal.modules["corelib/kernel/format"]=function(t){t.top;var e=[],r=t.nil,n=(t.const_get_qualified,t.const_get_relative),i=(t.breaker,t.slice,t.module),s=t.truthy,a=t.gvars;return t.add_stubs(["$==","$length","$respond_to?","$[]","$coerce_to?","$nil?","$to_a","$raise","$to_int","$fetch","$Integer","$Float","$to_ary","$to_str","$coerce_to","$inspect","$to_s"]),function(e,o){var c,l=i(e,"Kernel"),u=[l].concat(o);t.def(l,"$format",c=function(e,i){var o,c,l=this,f=r;null==a.DEBUG&&(a.DEBUG=r),o=t.slice.call(arguments,1,arguments.length),s((c=o).$length()["$=="](1)?c["$[]"](0)["$respond_to?"]("to_ary"):c.$length()["$=="](1))&&(f=n(u,"Opal")["$coerce_to?"](c["$[]"](0),n(u,"Array"),"to_ary"),s(f["$nil?"]())||(c=f.$to_a()));var $,h,p,d,_,m,y,g,v,b,A,x,w,k,E,S,N="",I=0,C=e.length,O=1,B=0,M=32,P=128;function F(){S&M&&l.$raise(n(u,"ArgumentError"),"flag after width"),S&P&&l.$raise(n(u,"ArgumentError"),"flag after precision")}function L(){S&M&&l.$raise(n(u,"ArgumentError"),"width given twice"),S&P&&l.$raise(n(u,"ArgumentError"),"width after precision")}function T(t){return t>=c.length&&l.$raise(n(u,"ArgumentError"),"too few arguments"),c[t]}function j(){switch(B){case-1:l.$raise(n(u,"ArgumentError"),"unnumbered("+O+") mixed with numbered");case-2:l.$raise(n(u,"ArgumentError"),"unnumbered("+O+") mixed with named")}return T((B=O++)-1)}function R(t){return B>0&&l.$raise(n(u,"ArgumentError"),"numbered("+t+") after unnumbered("+B+")"),-2===B&&l.$raise(n(u,"ArgumentError"),"numbered("+t+") after named"),t<1&&l.$raise(n(u,"ArgumentError"),"invalid index - "+t+"$"),B=-1,T(t-1)}function D(){return void 0===E?j():E}function z(t){for(var r,i="";;h++){if(h===C&&l.$raise(n(u,"ArgumentError"),"malformed format string - %*[0-9]"),e.charCodeAt(h)<48||e.charCodeAt(h)>57)return h--,(r=parseInt(i,10)||0)>2147483647&&l.$raise(n(u,"ArgumentError"),t+" too big"),r;i+=e.charAt(h)}}function U(t){var r,n=z(t);return"$"===e.charAt(h+1)?(h++,r=R(n)):r=j(),r.$to_int()}for(h=e.indexOf("%");-1!==h;h=e.indexOf("%",h)){switch(d=void 0,S=0,m=-1,y=-1,E=void 0,$=h,h++,e.charAt(h)){case"%":I=h;case"":case"\n":case"\0":h++;continue}t:for(;h<C;h++)switch(e.charAt(h)){case" ":F(),S|=16;continue t;case"#":F(),S|=1;continue t;case"+":F(),S|=4;continue t;case"-":F(),S|=2;continue t;case"0":F(),S|=8;continue t;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":if(g=z("width"),"$"===e.charAt(h+1)){if(h+2===C){d="%",h++;break t}void 0!==E&&l.$raise(n(u,"ArgumentError"),"value given twice - %"+g+"$"),E=R(g),h++}else L(),S|=M,m=g;continue t;case"<":case"{":for(b="<"===e.charAt(h)?">":"}",v="",h++;;h++){if(h===C&&l.$raise(n(u,"ArgumentError"),"malformed name - unmatched parenthesis"),e.charAt(h)===b){if(B>0&&l.$raise(n(u,"ArgumentError"),"named "+v+" after unnumbered("+B+")"),-1===B&&l.$raise(n(u,"ArgumentError"),"named "+v+" after numbered"),B=-2,void 0!==c[0]&&c[0].$$is_hash||l.$raise(n(u,"ArgumentError"),"one hash required"),E=c[0].$fetch(v),">"===b)continue t;if(d=E.toString(),-1!==y&&(d=d.slice(0,y)),2&S)for(;d.length<m;)d+=" ";else for(;d.length<m;)d=" "+d;break t}v+=e.charAt(h)}case"*":h++,L(),S|=M,(m=U("width"))<0&&(S|=2,m=-m);continue t;case".":if(S&P&&l.$raise(n(u,"ArgumentError"),"precision given twice"),S|=64|P,y=0,h++,"*"===e.charAt(h)){h++,(y=U("precision"))<0&&(S&=-65);continue t}y=z("precision");continue t;case"d":case"i":case"u":if((p=l.$Integer(D()))>=0){for(d=p.toString();d.length<y;)d="0"+d;if(2&S)for((4&S||16&S)&&(d=(4&S?"+":" ")+d);d.length<m;)d+=" ";else if(8&S&&-1===y){for(;d.length<m-(4&S||16&S?1:0);)d="0"+d;(4&S||16&S)&&(d=(4&S?"+":" ")+d)}else for((4&S||16&S)&&(d=(4&S?"+":" ")+d);d.length<m;)d=" "+d}else{for(d=(-p).toString();d.length<y;)d="0"+d;if(2&S)for(d="-"+d;d.length<m;)d+=" ";else if(8&S&&-1===y){for(;d.length<m-1;)d="0"+d;d="-"+d}else for(d="-"+d;d.length<m;)d=" "+d}break t;case"b":case"B":case"o":case"x":case"X":switch(e.charAt(h)){case"b":case"B":A=2,x="0b",w=/^1+/,k="1";break;case"o":A=8,x="0",w=/^3?7+/,k="7";break;case"x":case"X":A=16,x="0x",w=/^f+/,k="f"}if((p=l.$Integer(D()))>=0){for(d=p.toString(A);d.length<y;)d="0"+d;if(2&S)for((4&S||16&S)&&(d=(4&S?"+":" ")+d),1&S&&0!==p&&(d=x+d);d.length<m;)d+=" ";else if(8&S&&-1===y){for(;d.length<m-(4&S||16&S?1:0)-(1&S&&0!==p?x.length:0);)d="0"+d;1&S&&0!==p&&(d=x+d),(4&S||16&S)&&(d=(4&S?"+":" ")+d)}else for(1&S&&0!==p&&(d=x+d),(4&S||16&S)&&(d=(4&S?"+":" ")+d);d.length<m;)d=" "+d}else if(4&S||16&S){for(d=(-p).toString(A);d.length<y;)d="0"+d;if(2&S)for(1&S&&(d=x+d),d="-"+d;d.length<m;)d+=" ";else if(8&S&&-1===y){for(;d.length<m-1-(1&S?2:0);)d="0"+d;1&S&&(d=x+d),d="-"+d}else for(1&S&&(d=x+d),d="-"+d;d.length<m;)d=" "+d}else{for(d=(p>>>0).toString(A).replace(w,k);d.length<y-2;)d=k+d;if(2&S)for(d=".."+d,1&S&&(d=x+d);d.length<m;)d+=" ";else if(8&S&&-1===y){for(;d.length<m-2-(1&S?x.length:0);)d=k+d;d=".."+d,1&S&&(d=x+d)}else for(d=".."+d,1&S&&(d=x+d);d.length<m;)d=" "+d}e.charAt(h)===e.charAt(h).toUpperCase()&&(d=d.toUpperCase());break t;case"f":case"e":case"E":case"g":case"G":if((p=l.$Float(D()))>=0||isNaN(p)){if(p===1/0)d="Inf";else switch(e.charAt(h)){case"f":d=p.toFixed(-1===y?6:y);break;case"e":case"E":d=p.toExponential(-1===y?6:y);break;case"g":case"G":d=p.toExponential(),(_=parseInt(d.split("e")[1],10))<-4||_>=(-1===y?6:y)||(d=p.toPrecision(-1===y?1&S?6:void 0:y))}if(2&S)for((4&S||16&S)&&(d=(4&S?"+":" ")+d);d.length<m;)d+=" ";else if(8&S&&p!==1/0&&!isNaN(p)){for(;d.length<m-(4&S||16&S?1:0);)d="0"+d;(4&S||16&S)&&(d=(4&S?"+":" ")+d)}else for((4&S||16&S)&&(d=(4&S?"+":" ")+d);d.length<m;)d=" "+d}else{if(p===-1/0)d="Inf";else switch(e.charAt(h)){case"f":d=(-p).toFixed(-1===y?6:y);break;case"e":case"E":d=(-p).toExponential(-1===y?6:y);break;case"g":case"G":d=(-p).toExponential(),(_=parseInt(d.split("e")[1],10))<-4||_>=(-1===y?6:y)||(d=(-p).toPrecision(-1===y?1&S?6:void 0:y))}if(2&S)for(d="-"+d;d.length<m;)d+=" ";else if(8&S&&p!==-1/0){for(;d.length<m-1;)d="0"+d;d="-"+d}else for(d="-"+d;d.length<m;)d=" "+d}e.charAt(h)!==e.charAt(h).toUpperCase()||p===1/0||p===-1/0||isNaN(p)||(d=d.toUpperCase()),d=d.replace(/([eE][-+]?)([0-9])$/,"$10$2");break t;case"a":case"A":l.$raise(n(u,"NotImplementedError"),"`A` and `a` format field types are not implemented in Opal yet");case"c":if((p=D())["$respond_to?"]("to_ary")&&(p=p.$to_ary()[0]),1!==(d=p["$respond_to?"]("to_str")?p.$to_str():String.fromCharCode(n(u,"Opal").$coerce_to(p,n(u,"Integer"),"to_int"))).length&&l.$raise(n(u,"ArgumentError"),"%c requires a character"),2&S)for(;d.length<m;)d+=" ";else for(;d.length<m;)d=" "+d;break t;case"p":if(d=D().$inspect(),-1!==y&&(d=d.slice(0,y)),2&S)for(;d.length<m;)d+=" ";else for(;d.length<m;)d=" "+d;break t;case"s":if(d=D().$to_s(),-1!==y&&(d=d.slice(0,y)),2&S)for(;d.length<m;)d+=" ";else for(;d.length<m;)d=" "+d;break t;default:l.$raise(n(u,"ArgumentError"),"malformed format string - %"+e.charAt(h))}void 0===d&&l.$raise(n(u,"ArgumentError"),"malformed format string - %"),N+=e.slice(I,$)+d,I=h+1}return a.DEBUG&&B>=0&&O<c.length&&l.$raise(n(u,"ArgumentError"),"too many arguments for format string"),N+e.slice(I)},c.$$arity=-2),t.alias(l,"sprintf","format")}(e[0],e)},Opal.modules["corelib/string/encoding"]=function(t){var e,r,n,i,s,a=t.top,o=[],c=t.nil,l=t.const_get_qualified,u=t.const_get_relative,f=(t.breaker,t.slice,t.klass),$=t.hash2,h=t.truthy,p=t.send;return t.add_stubs(["$require","$+","$[]","$new","$to_proc","$each","$const_set","$sub","$==","$default_external","$upcase","$raise","$attr_accessor","$attr_reader","$register","$length","$bytes","$to_a","$each_byte","$bytesize","$enum_for","$each_codepoint","$force_encoding","$dup","$coerce_to!","$find","$getbyte"]),a.$require("corelib/string"),function(e,r,n){var i,s,a,o,l,d,_,m,y,g,v=f(e,null,"Encoding"),b=[v].concat(n);v.$$prototype.ascii=v.$$prototype.dummy=v.$$prototype.name=c,t.defineProperty(v,"$$register",{}),t.defs(v,"$register",i=function(t,e){var r,n,s,a,o,l=i.$$p,f=l||c,d=c,_=c;return l&&(i.$$p=null),l&&(i.$$p=null),null==e&&(e=$([],{})),a=[t],o=h(r=e["$[]"]("aliases"))?r:[],d="number"==typeof a&&"number"==typeof o?a+o:a["$+"](o),s=p(u(b,"Class"),"new",[this],f.$to_proc()).$new(t,d,!!h(r=e["$[]"]("ascii"))&&r,!!h(r=e["$[]"]("dummy"))&&r),_=this.$$register,p(d,"each",[],((n=function(t){var e=n.$$s||this;return null==t&&(t=c),e.$const_set(t.$sub("-","_"),s),_["$$"+t]=s}).$$s=this,n.$$arity=1,n))},i.$$arity=-2),t.defs(v,"$find",s=function(t){var e,r,n;return t["$=="]("default_external")?this.$default_external():(r=this.$$register,n=h(e=r["$$"+t])?e:r["$$"+t.$upcase()],h(n)||this.$raise(u(b,"ArgumentError"),"unknown encoding name - "+t),n)},s.$$arity=1),function(t,e){[t].concat(e);t.$attr_accessor("default_external")}(t.get_singleton_class(v),b),v.$attr_reader("name","names"),t.def(v,"$initialize",a=function(t,e,r,n){return this.name=t,this.names=e,this.ascii=r,this.dummy=n},a.$$arity=4),t.def(v,"$ascii_compatible?",o=function(){return this.ascii},o.$$arity=0),t.def(v,"$dummy?",l=function(){return this.dummy},l.$$arity=0),t.def(v,"$to_s",d=function(){return this.name},d.$$arity=0),t.def(v,"$inspect",_=function(){var t=this;return"#<Encoding:"+t.name+(h(t.dummy)?" (dummy)":c)+">"},_.$$arity=0),t.def(v,"$each_byte",m=function(e){return t.slice.call(arguments,0,arguments.length),this.$raise(u(b,"NotImplementedError"))},m.$$arity=-1),t.def(v,"$getbyte",y=function(e){return t.slice.call(arguments,0,arguments.length),this.$raise(u(b,"NotImplementedError"))},y.$$arity=-1),t.def(v,"$bytesize",g=function(e){return t.slice.call(arguments,0,arguments.length),this.$raise(u(b,"NotImplementedError"))},g.$$arity=-1),function(t,e,r){[f(t,e,"EncodingError")].concat(r)}(b[0],u(b,"StandardError"),b),function(t,e,r){[f(t,e,"CompatibilityError")].concat(r)}(b[0],u(b,"EncodingError"),b)}(o[0],0,o),p(u(o,"Encoding"),"register",["UTF-8",$(["aliases","ascii"],{aliases:["CP65001"],ascii:!0})],((e=function(){var r,n,i=e.$$s||this;return t.def(i,"$each_byte",r=function(e){var n=r.$$p,i=n||c;n&&(r.$$p=null),n&&(r.$$p=null);for(var s=0,a=e.length;s<a;s++){var o=e.charCodeAt(s);if(o<=127)t.yield1(i,o);else for(var l=encodeURIComponent(e.charAt(s)).substr(1).split("%"),u=0,f=l.length;u<f;u++)t.yield1(i,parseInt(l[u],16))}},r.$$arity=1),t.def(i,"$bytesize",n=function(t){return t.$bytes().$length()},n.$$arity=1),c&&"bytesize"}).$$s=a,e.$$arity=0,e)),p(u(o,"Encoding"),"register",["UTF-16LE"],((r=function(){var e,n,i=r.$$s||this;return t.def(i,"$each_byte",e=function(r){var n=e.$$p,i=n||c;n&&(e.$$p=null),n&&(e.$$p=null);for(var s=0,a=r.length;s<a;s++){var o=r.charCodeAt(s);t.yield1(i,255&o),t.yield1(i,o>>8)}},e.$$arity=1),t.def(i,"$bytesize",n=function(t){return t.$bytes().$length()},n.$$arity=1),c&&"bytesize"}).$$s=a,r.$$arity=0,r)),p(u(o,"Encoding"),"register",["UTF-16BE"],((n=function(){var e,r,i=n.$$s||this;return t.def(i,"$each_byte",e=function(r){var n=e.$$p,i=n||c;n&&(e.$$p=null),n&&(e.$$p=null);for(var s=0,a=r.length;s<a;s++){var o=r.charCodeAt(s);t.yield1(i,o>>8),t.yield1(i,255&o)}},e.$$arity=1),t.def(i,"$bytesize",r=function(t){return t.$bytes().$length()},r.$$arity=1),c&&"bytesize"}).$$s=a,n.$$arity=0,n)),p(u(o,"Encoding"),"register",["UTF-32LE"],((i=function(){var e,r,n=i.$$s||this;return t.def(n,"$each_byte",e=function(r){var n=e.$$p,i=n||c;n&&(e.$$p=null),n&&(e.$$p=null);for(var s=0,a=r.length;s<a;s++){var o=r.charCodeAt(s);t.yield1(i,255&o),t.yield1(i,o>>8)}},e.$$arity=1),t.def(n,"$bytesize",r=function(t){return t.$bytes().$length()},r.$$arity=1),c&&"bytesize"}).$$s=a,i.$$arity=0,i)),p(u(o,"Encoding"),"register",["ASCII-8BIT",$(["aliases","ascii","dummy"],{aliases:["BINARY","US-ASCII","ASCII"],ascii:!0,dummy:!0})],((s=function(){var e,r,n=s.$$s||this;return t.def(n,"$each_byte",e=function(r){var n=e.$$p,i=n||c;n&&(e.$$p=null),n&&(e.$$p=null);for(var s=0,a=r.length;s<a;s++){var o=r.charCodeAt(s);t.yield1(i,255&o),t.yield1(i,o>>8)}},e.$$arity=1),t.def(n,"$bytesize",r=function(t){return t.$bytes().$length()},r.$$arity=1),c&&"bytesize"}).$$s=a,s.$$arity=0,s)),function(e,r,n){var i,s,a,o,$,h,d,_,m,y=f(e,null,"String"),g=[y].concat(n);return y.$$prototype.encoding=c,y.$attr_reader("encoding"),t.defineProperty(String.prototype,"encoding",l(u(g,"Encoding"),"UTF_16LE")),t.def(y,"$bytes",i=function(){return this.$each_byte().$to_a()},i.$$arity=0),t.def(y,"$bytesize",s=function(){return this.encoding.$bytesize(this)},s.$$arity=0),t.def(y,"$each_byte",a=function(){var t=a.$$p,e=t||c;return t&&(a.$$p=null),t&&(a.$$p=null),e===c?this.$enum_for("each_byte"):(p(this.encoding,"each_byte",[this],e.$to_proc()),this)},a.$$arity=0),t.def(y,"$each_codepoint",o=function(){var e=o.$$p,r=e||c;if(e&&(o.$$p=null),e&&(o.$$p=null),r===c)return this.$enum_for("each_codepoint");for(var n=0,i=this.length;n<i;n++)t.yield1(r,this.codePointAt(n));return this},o.$$arity=0),t.def(y,"$codepoints",$=function(){var t=$.$$p,e=t||c;return t&&($.$$p=null),t&&($.$$p=null),e!==c?p(this,"each_codepoint",[],e.$to_proc()):this.$each_codepoint().$to_a()},$.$$arity=0),t.def(y,"$encode",h=function(t){return this.$dup().$force_encoding(t)},h.$$arity=1),t.def(y,"$force_encoding",d=function(t){return t===this.encoding?this:(t=u(g,"Opal")["$coerce_to!"](t,u(g,"String"),"to_s"),(t=u(g,"Encoding").$find(t))===this.encoding?this:(this.encoding=t,this))},d.$$arity=1),t.def(y,"$getbyte",_=function(t){return this.encoding.$getbyte(this,t)},_.$$arity=1),t.def(y,"$valid_encoding?",m=function(){return!0},m.$$arity=0),c&&"valid_encoding?"}(o[0],0,o)},Opal.modules["corelib/math"]=function(t){t.top;var e=[],r=(t.nil,t.const_get_qualified),n=t.const_get_relative,i=(t.breaker,t.slice,t.module),s=t.truthy;return t.add_stubs(["$new","$raise","$Float","$type_error","$Integer","$module_function","$checked","$float!","$===","$gamma","$-","$integer!","$/","$infinite?"]),function(e,a){var o,c,l,u,f,$,h,p,d,_,m,y,g,v,b,A,x,w,k,E,S,N,I,C,O,B,M,P,F,L=i(e,"Math"),T=[L].concat(a);t.const_set(T[0],"E",Math.E),t.const_set(T[0],"PI",Math.PI),t.const_set(T[0],"DomainError",n(T,"Class").$new(n(T,"StandardError"))),t.defs(L,"$checked",o=function(e,r){var i;if(i=t.slice.call(arguments,1,arguments.length),isNaN(i[0])||2==i.length&&isNaN(i[1]))return NaN;var s=Math[e].apply(null,i);return isNaN(s)&&this.$raise(n(T,"DomainError"),'Numerical argument is out of domain - "'+e+'"'),s},o.$$arity=-2),t.defs(L,"$float!",c=function(e){try{return this.$Float(e)}catch(r){if(!t.rescue(r,[n(T,"ArgumentError")]))throw r;try{return this.$raise(n(T,"Opal").$type_error(e,n(T,"Float")))}finally{t.pop_exception()}}},c.$$arity=1),t.defs(L,"$integer!",l=function(e){try{return this.$Integer(e)}catch(r){if(!t.rescue(r,[n(T,"ArgumentError")]))throw r;try{return this.$raise(n(T,"Opal").$type_error(e,n(T,"Integer")))}finally{t.pop_exception()}}},l.$$arity=1),L.$module_function(),t.def(L,"$acos",u=function(t){return n(T,"Math").$checked("acos",n(T,"Math")["$float!"](t))},u.$$arity=1),s(void 0!==Math.acosh)||(Math.acosh=function(t){return Math.log(t+Math.sqrt(t*t-1))}),t.def(L,"$acosh",f=function(t){return n(T,"Math").$checked("acosh",n(T,"Math")["$float!"](t))},f.$$arity=1),t.def(L,"$asin",$=function(t){return n(T,"Math").$checked("asin",n(T,"Math")["$float!"](t))},$.$$arity=1),s(void 0!==Math.asinh)||(Math.asinh=function(t){return Math.log(t+Math.sqrt(t*t+1))}),t.def(L,"$asinh",h=function(t){return n(T,"Math").$checked("asinh",n(T,"Math")["$float!"](t))},h.$$arity=1),t.def(L,"$atan",p=function(t){return n(T,"Math").$checked("atan",n(T,"Math")["$float!"](t))},p.$$arity=1),t.def(L,"$atan2",d=function(t,e){return n(T,"Math").$checked("atan2",n(T,"Math")["$float!"](t),n(T,"Math")["$float!"](e))},d.$$arity=2),s(void 0!==Math.atanh)||(Math.atanh=function(t){return.5*Math.log((1+t)/(1-t))}),t.def(L,"$atanh",_=function(t){return n(T,"Math").$checked("atanh",n(T,"Math")["$float!"](t))},_.$$arity=1),s(void 0!==Math.cbrt)||(Math.cbrt=function(t){if(0==t)return 0;if(t<0)return-Math.cbrt(-t);for(var e=t,r=0;e<.125;)e*=8,r--;for(;e>1;)e*=.125,r++;for(e=(-.46946116*e+1.072302)*e+.3812513;r<0;)e*=.5,r++;for(;r>0;)e*=2,r--;return e=2/3*(e=2/3*(e=2/3*(e=2/3*e+1/3*t/(e*e))+1/3*t/(e*e))+1/3*t/(e*e))+1/3*t/(e*e)}),t.def(L,"$cbrt",m=function(t){return n(T,"Math").$checked("cbrt",n(T,"Math")["$float!"](t))},m.$$arity=1),t.def(L,"$cos",y=function(t){return n(T,"Math").$checked("cos",n(T,"Math")["$float!"](t))},y.$$arity=1),s(void 0!==Math.cosh)||(Math.cosh=function(t){return(Math.exp(t)+Math.exp(-t))/2}),t.def(L,"$cosh",g=function(t){return n(T,"Math").$checked("cosh",n(T,"Math")["$float!"](t))},g.$$arity=1),s(void 0!==Math.erf)||t.defineProperty(Math,"erf",function(t){var e=1;t<0&&(e=-1);var r=1/(1+.3275911*(t=Math.abs(t)));return e*(1-((((1.061405429*r-1.453152027)*r+1.421413741)*r-.284496736)*r+.254829592)*r*Math.exp(-t*t))}),t.def(L,"$erf",v=function(t){return n(T,"Math").$checked("erf",n(T,"Math")["$float!"](t))},v.$$arity=1),s(void 0!==Math.erfc)||t.defineProperty(Math,"erfc",function(t){var e=Math.abs(t),r=1/(.5*e+1),n=-e*e-1.26551223+r*(r*(r*(r*(r*(r*(r*(r*(.17087277*r-.82215223)+1.48851587)-1.13520398)+.27886807)-.18628806)+.09678418)+.37409196)+1.00002368),i=r*Math.exp(n);return t<0?2-i:i}),t.def(L,"$erfc",b=function(t){return n(T,"Math").$checked("erfc",n(T,"Math")["$float!"](t))},b.$$arity=1),t.def(L,"$exp",A=function(t){return n(T,"Math").$checked("exp",n(T,"Math")["$float!"](t))},A.$$arity=1),t.def(L,"$frexp",x=function(t){if(t=n(T,"Math")["$float!"](t),isNaN(t))return[NaN,0];var e=Math.floor(Math.log(Math.abs(t))/Math.log(2))+1;return[t/Math.pow(2,e),e]},x.$$arity=1),t.def(L,"$gamma",w=function(t){var e,r,i,s,a,o,c,l,u;t=n(T,"Math")["$float!"](t);var f,$,h=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22];if(isNaN(t))return NaN;if(0===t&&1/t<0)return-1/0;if(-1!==t&&t!==-1/0||this.$raise(n(T,"DomainError"),'Numerical argument is out of domain - "gamma"'),n(T,"Integer")["$==="](t)){if(t<=0)return isFinite(t)?1/0:NaN;if(t>171)return 1/0;for(s=t-2,a=t-1;s>1;)a*=s,s--;return 0==a&&(a=1),a}if(t<.5)return Math.PI/(Math.sin(Math.PI*t)*n(T,"Math").$gamma(($=t,"number"==typeof(f=1)&&"number"==typeof $?f-$:f["$-"]($))));if(t>=171.35)return 1/0;if(t>85)return u=(l=(c=(o=t*t)*t)*t)*t,Math.sqrt(2*Math.PI/t)*Math.pow(t/Math.E,t)*(1+1/(12*t)+1/(288*o)-139/(51840*c)-571/(2488320*l)+163879/(209018880*u)+5246819/(75246796800*u*t));for(t-=1,i=h[0],e=1;e<h.length;++e)i+=h[e]/(t+e);return r=t+4.7421875+.5,Math.sqrt(2*Math.PI)*Math.pow(r,t+.5)*Math.exp(-r)*i},w.$$arity=1),s(void 0!==Math.hypot)||(Math.hypot=function(t,e){return Math.sqrt(t*t+e*e)}),t.def(L,"$hypot",k=function(t,e){return n(T,"Math").$checked("hypot",n(T,"Math")["$float!"](t),n(T,"Math")["$float!"](e))},k.$$arity=2),t.def(L,"$ldexp",E=function(t,e){return t=n(T,"Math")["$float!"](t),e=n(T,"Math")["$integer!"](e),isNaN(e)&&this.$raise(n(T,"RangeError"),"float NaN out of range of integer"),t*Math.pow(2,e)},E.$$arity=2),t.def(L,"$lgamma",S=function(t){return-1==t?[1/0,1]:[Math.log(Math.abs(n(T,"Math").$gamma(t))),n(T,"Math").$gamma(t)<0?-1:1]},S.$$arity=1),t.def(L,"$log",N=function(t,e){var r,i;return s(n(T,"String")["$==="](t))&&this.$raise(n(T,"Opal").$type_error(t,n(T,"Float"))),s(null==e)?n(T,"Math").$checked("log",n(T,"Math")["$float!"](t)):(s(n(T,"String")["$==="](e))&&this.$raise(n(T,"Opal").$type_error(e,n(T,"Float"))),r=n(T,"Math").$checked("log",n(T,"Math")["$float!"](t)),i=n(T,"Math").$checked("log",n(T,"Math")["$float!"](e)),"number"==typeof r&&"number"==typeof i?r/i:r["$/"](i))},N.$$arity=-2),s(void 0!==Math.log10)||(Math.log10=function(t){return Math.log(t)/Math.LN10}),t.def(L,"$log10",I=function(t){return s(n(T,"String")["$==="](t))&&this.$raise(n(T,"Opal").$type_error(t,n(T,"Float"))),n(T,"Math").$checked("log10",n(T,"Math")["$float!"](t))},I.$$arity=1),s(void 0!==Math.log2)||(Math.log2=function(t){return Math.log(t)/Math.LN2}),t.def(L,"$log2",C=function(t){return s(n(T,"String")["$==="](t))&&this.$raise(n(T,"Opal").$type_error(t,n(T,"Float"))),n(T,"Math").$checked("log2",n(T,"Math")["$float!"](t))},C.$$arity=1),t.def(L,"$sin",O=function(t){return n(T,"Math").$checked("sin",n(T,"Math")["$float!"](t))},O.$$arity=1),s(void 0!==Math.sinh)||(Math.sinh=function(t){return(Math.exp(t)-Math.exp(-t))/2}),t.def(L,"$sinh",B=function(t){return n(T,"Math").$checked("sinh",n(T,"Math")["$float!"](t))},B.$$arity=1),t.def(L,"$sqrt",M=function(t){return n(T,"Math").$checked("sqrt",n(T,"Math")["$float!"](t))},M.$$arity=1),t.def(L,"$tan",P=function(t){return t=n(T,"Math")["$float!"](t),s(t["$infinite?"]())?r(n(T,"Float"),"NAN"):n(T,"Math").$checked("tan",n(T,"Math")["$float!"](t))},P.$$arity=1),s(void 0!==Math.tanh)||(Math.tanh=function(t){return t==1/0?1:t==-1/0?-1:(Math.exp(t)-Math.exp(-t))/(Math.exp(t)+Math.exp(-t))}),t.def(L,"$tanh",F=function(t){return n(T,"Math").$checked("tanh",n(T,"Math")["$float!"](t))},F.$$arity=1)}(e[0],e)},Opal.modules["corelib/complex"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t*e:t["$*"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}function n(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}function i(t,e){return"number"==typeof t&&"number"==typeof e?t/e:t["$/"](e)}var s=t.top,a=[],o=t.nil,c=t.const_get_qualified,l=t.const_get_relative,u=(t.breaker,t.slice,t.klass),f=t.truthy,$=t.module;return t.add_stubs(["$require","$===","$real?","$raise","$new","$*","$cos","$sin","$attr_reader","$class","$==","$real","$imag","$Complex","$-@","$+","$__coerced__","$-","$nan?","$/","$conj","$abs2","$quo","$polar","$exp","$log","$>","$!=","$divmod","$**","$hypot","$atan2","$lcm","$denominator","$finite?","$infinite?","$numerator","$abs","$arg","$rationalize","$to_f","$to_i","$to_r","$inspect","$positive?","$zero?","$Rational"]),s.$require("corelib/numeric"),function(s,a,$){var h,p,d,_,m,y,g,v,b,A,x,w,k,E,S,N,I,C,O,B,M,P,F,L,T,j,R,D,z,U,q,H=u(s,a,"Complex"),Q=[H].concat($);H.$$prototype.real=H.$$prototype.imag=o,t.defs(H,"$rect",h=function(t,e){var r,n,i;return null==e&&(e=0),f(f(r=f(n=f(i=l(Q,"Numeric")["$==="](t))?t["$real?"]():i)?l(Q,"Numeric")["$==="](e):n)?e["$real?"]():r)||this.$raise(l(Q,"TypeError"),"not a real"),this.$new(t,e)},h.$$arity=-2),function(e,r){[e].concat(r);t.alias(e,"rectangular","rect")}(t.get_singleton_class(H),Q),t.defs(H,"$polar",p=function(t,r){var n,i,s;return null==r&&(r=0),f(f(n=f(i=f(s=l(Q,"Numeric")["$==="](t))?t["$real?"]():s)?l(Q,"Numeric")["$==="](r):i)?r["$real?"]():n)||this.$raise(l(Q,"TypeError"),"not a real"),this.$new(e(t,l(Q,"Math").$cos(r)),e(t,l(Q,"Math").$sin(r)))},p.$$arity=-2),H.$attr_reader("real","imag"),t.def(H,"$initialize",d=function(t,e){return null==e&&(e=0),this.real=t,this.imag=e},d.$$arity=-2),t.def(H,"$coerce",_=function(t){var e;return f(l(Q,"Complex")["$==="](t))?[t,this]:f(f(e=l(Q,"Numeric")["$==="](t))?t["$real?"]():e)?[l(Q,"Complex").$new(t,0),this]:this.$raise(l(Q,"TypeError"),t.$class()+" can't be coerced into Complex")},_.$$arity=1),t.def(H,"$==",m=function(t){var e;return f(l(Q,"Complex")["$==="](t))?(e=this.real["$=="](t.$real()))?this.imag["$=="](t.$imag()):this.real["$=="](t.$real()):f(f(e=l(Q,"Numeric")["$==="](t))?t["$real?"]():e)?(e=this.real["$=="](t))?this.imag["$=="](0):this.real["$=="](t):t["$=="](this)},m.$$arity=1),t.def(H,"$-@",y=function(){return this.$Complex(this.real["$-@"](),this.imag["$-@"]())},y.$$arity=0),t.def(H,"$+",g=function(t){var e;return f(l(Q,"Complex")["$==="](t))?this.$Complex(r(this.real,t.$real()),r(this.imag,t.$imag())):f(f(e=l(Q,"Numeric")["$==="](t))?t["$real?"]():e)?this.$Complex(r(this.real,t),this.imag):this.$__coerced__("+",t)},g.$$arity=1),t.def(H,"$-",v=function(t){var e;return f(l(Q,"Complex")["$==="](t))?this.$Complex(n(this.real,t.$real()),n(this.imag,t.$imag())):f(f(e=l(Q,"Numeric")["$==="](t))?t["$real?"]():e)?this.$Complex(n(this.real,t),this.imag):this.$__coerced__("-",t)},v.$$arity=1),t.def(H,"$*",b=function(t){var i;return f(l(Q,"Complex")["$==="](t))?this.$Complex(n(e(this.real,t.$real()),e(this.imag,t.$imag())),r(e(this.real,t.$imag()),e(this.imag,t.$real()))):f(f(i=l(Q,"Numeric")["$==="](t))?t["$real?"]():i)?this.$Complex(e(this.real,t),e(this.imag,t)):this.$__coerced__("*",t)},b.$$arity=1),t.def(H,"$/",A=function(t){var r,n,s,a;return f(l(Q,"Complex")["$==="](t))?f(f(r=f(n=f(s=f(a=l(Q,"Number")["$==="](this.real))?this.real["$nan?"]():a)?s:f(a=l(Q,"Number")["$==="](this.imag))?this.imag["$nan?"]():a)?n:f(s=l(Q,"Number")["$==="](t.$real()))?t.$real()["$nan?"]():s)?r:f(n=l(Q,"Number")["$==="](t.$imag()))?t.$imag()["$nan?"]():n)?l(Q,"Complex").$new(c(l(Q,"Float"),"NAN"),c(l(Q,"Float"),"NAN")):i(e(this,t.$conj()),t.$abs2()):f(f(r=l(Q,"Numeric")["$==="](t))?t["$real?"]():r)?this.$Complex(this.real.$quo(t),this.imag.$quo(t)):this.$__coerced__("/",t)},A.$$arity=1),t.def(H,"$**",x=function(s){var a,c,u,$,h,p,d=o,_=o,m=o,y=o,g=o,v=o,b=o,A=o,x=o,w=o,k=o;if(s["$=="](0))return l(Q,"Complex").$new(1,0);if(f(l(Q,"Complex")["$==="](s)))return c=this.$polar(),d=null==(a=t.to_ary(c))[0]?o:a[0],_=null==a[1]?o:a[1],m=s.$real(),y=s.$imag(),g=l(Q,"Math").$exp(n(e(m,l(Q,"Math").$log(d)),e(y,_))),v=r(e(_,m),e(y,l(Q,"Math").$log(d))),l(Q,"Complex").$polar(g,v);if(f(l(Q,"Integer")["$==="](s))){if(f((p=0,"number"==typeof(h=s)&&"number"==typeof p?h>p:h["$>"](p)))){for(A=b=this,x=n(s,1);f(x["$!="](0));){for(u=x.$divmod(2),w=null==(c=t.to_ary(u))[0]?o:c[0],k=null==c[1]?o:c[1];k["$=="](0);)b=this.$Complex(n(e(b.$real(),b.$real()),e(b.$imag(),b.$imag())),e(e(2,b.$real()),b.$imag())),$=(x=w).$divmod(2),w=null==(u=t.to_ary($))[0]?o:u[0],k=null==u[1]?o:u[1];A=e(A,b),x=n(x,1)}return A}return i(l(Q,"Rational").$new(1,1),this)["$**"](s["$-@"]())}return f(f(a=l(Q,"Float")["$==="](s))?a:l(Q,"Rational")["$==="](s))?(c=this.$polar(),d=null==(a=t.to_ary(c))[0]?o:a[0],_=null==a[1]?o:a[1],l(Q,"Complex").$polar(d["$**"](s),e(_,s))):this.$__coerced__("**",s)},x.$$arity=1),t.def(H,"$abs",w=function(){return l(Q,"Math").$hypot(this.real,this.imag)},w.$$arity=0),t.def(H,"$abs2",k=function(){return r(e(this.real,this.real),e(this.imag,this.imag))},k.$$arity=0),t.def(H,"$angle",E=function(){return l(Q,"Math").$atan2(this.imag,this.real)},E.$$arity=0),t.alias(H,"arg","angle"),t.def(H,"$conj",S=function(){return this.$Complex(this.real,this.imag["$-@"]())},S.$$arity=0),t.alias(H,"conjugate","conj"),t.def(H,"$denominator",N=function(){return this.real.$denominator().$lcm(this.imag.$denominator())},N.$$arity=0),t.alias(H,"divide","/"),t.def(H,"$eql?",I=function(t){var e,r;return f(e=f(r=l(Q,"Complex")["$==="](t))?this.real.$class()["$=="](this.imag.$class()):r)?this["$=="](t):e},I.$$arity=1),t.def(H,"$fdiv",C=function(t){return f(l(Q,"Numeric")["$==="](t))||this.$raise(l(Q,"TypeError"),t.$class()+" can't be coerced into Complex"),i(this,t)},C.$$arity=1),t.def(H,"$finite?",O=function(){var t;return f(t=this.real["$finite?"]())?this.imag["$finite?"]():t},O.$$arity=0),t.def(H,"$hash",B=function(){return"Complex:"+this.real+":"+this.imag},B.$$arity=0),t.alias(H,"imaginary","imag"),t.def(H,"$infinite?",M=function(){var t;return f(t=this.real["$infinite?"]())?t:this.imag["$infinite?"]()},M.$$arity=0),t.def(H,"$inspect",P=function(){return"("+this+")"},P.$$arity=0),t.alias(H,"magnitude","abs"),t.udef(H,"$negative?"),t.def(H,"$numerator",F=function(){var t;return t=this.$denominator(),this.$Complex(e(this.real.$numerator(),i(t,this.real.$denominator())),e(this.imag.$numerator(),i(t,this.imag.$denominator())))},F.$$arity=0),t.alias(H,"phase","arg"),t.def(H,"$polar",L=function(){return[this.$abs(),this.$arg()]},L.$$arity=0),t.udef(H,"$positive?"),t.alias(H,"quo","/"),t.def(H,"$rationalize",T=function(t){return arguments.length>1&&this.$raise(l(Q,"ArgumentError"),"wrong number of arguments ("+arguments.length+" for 0..1)"),f(this.imag["$!="](0))&&this.$raise(l(Q,"RangeError"),"can't' convert "+this+" into Rational"),this.$real().$rationalize(t)},T.$$arity=-1),t.def(H,"$real?",j=function(){return!1},j.$$arity=0),t.def(H,"$rect",R=function(){return[this.real,this.imag]},R.$$arity=0),t.alias(H,"rectangular","rect"),t.def(H,"$to_f",D=function(){return this.imag["$=="](0)||this.$raise(l(Q,"RangeError"),"can't convert "+this+" into Float"),this.real.$to_f()},D.$$arity=0),t.def(H,"$to_i",z=function(){return this.imag["$=="](0)||this.$raise(l(Q,"RangeError"),"can't convert "+this+" into Integer"),this.real.$to_i()},z.$$arity=0),t.def(H,"$to_r",U=function(){return this.imag["$=="](0)||this.$raise(l(Q,"RangeError"),"can't convert "+this+" into Rational"),this.real.$to_r()},U.$$arity=0),t.def(H,"$to_s",q=function(){var t,e,n,i=this,s=o;return s=r(s=r(s=i.real.$inspect(),f(f(t=f(e=f(n=l(Q,"Number")["$==="](i.imag))?i.imag["$nan?"]():n)?e:i.imag["$positive?"]())?t:i.imag["$zero?"]())?"+":"-"),i.imag.$abs().$inspect()),f(f(t=l(Q,"Number")["$==="](i.imag))?f(e=i.imag["$nan?"]())?e:i.imag["$infinite?"]():t)&&(s=r(s,"*")),r(s,"i")},q.$$arity=0),t.const_set(Q[0],"I",H.$new(0,1))}(a[0],l(a,"Numeric"),a),function(e,r){var n,i=$(e,"Kernel"),s=[i].concat(r);t.def(i,"$Complex",n=function(t,e){return null==e&&(e=o),f(e)?l(s,"Complex").$new(t,e):l(s,"Complex").$new(t,0)},n.$$arity=-2)}(a[0],a),function(e,r,n){var i,s=u(e,null,"String");[s].concat(n);return t.def(s,"$to_c",i=function(){var t,e,r=this,n=r,i=/[+-]?[\d_]+(\.[\d_]+)?(e\d+)?/;n.match(i);function s(){return i.test(n)}function a(){var t=n.match(i)[0];return n=n.slice(t.length),t.replace(/_/g,"")}function o(){if(s()){var t=parseFloat(a());if("/"===n[0]){if(n=n.slice(1),s()){var e=parseFloat(a());return r.$Rational(t,e)}return n="/"+n,t}return t}return null}return(t=o())?(e=o())?r.$Complex(t,e):"i"===n[0]?r.$Complex(0,t):r.$Complex(t,0):"i"===n[0]?r.$Complex(0,1):"-"===n[0]&&"i"===n[1]?r.$Complex(0,-1):"+"===n[0]&&"i"===n[1]?r.$Complex(0,1):r.$Complex(0,0)},i.$$arity=0),o&&"to_c"}(a[0],0,a)},Opal.modules["corelib/rational"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t<e:t["$<"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t/e:t["$/"](e)}function n(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}function i(t,e){return"number"==typeof t&&"number"==typeof e?t*e:t["$*"](e)}function s(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}var a=t.top,o=[],c=t.nil,l=t.const_get_qualified,u=t.const_get_relative,f=(t.breaker,t.slice,t.klass),$=t.truthy,h=t.module;return t.add_stubs(["$require","$to_i","$==","$raise","$<","$-@","$new","$gcd","$/","$nil?","$===","$reduce","$to_r","$equal?","$!","$coerce_to!","$to_f","$numerator","$denominator","$<=>","$-","$*","$__coerced__","$+","$Rational","$>","$**","$abs","$ceil","$with_precision","$floor","$<=","$truncate","$send","$convert"]),a.$require("corelib/numeric"),function(a,o,h){var p,d,_,m,y,g,v,b,A,x,w,k,E,S,N,I,C,O,B,M,P,F,L,T,j,R,D=f(a,o,"Rational"),z=[D].concat(h);D.$$prototype.num=D.$$prototype.den=c,t.defs(D,"$reduce",p=function(t,n){var i;if(t=t.$to_i(),(n=n.$to_i())["$=="](0))this.$raise(u(z,"ZeroDivisionError"),"divided by 0");else if($(e(n,0)))t=t["$-@"](),n=n["$-@"]();else if(n["$=="](1))return this.$new(t,n);return i=t.$gcd(n),this.$new(r(t,i),r(n,i))},p.$$arity=2),t.defs(D,"$convert",d=function(t,e){var n,i;return $($(n=t["$nil?"]())?n:e["$nil?"]())&&this.$raise(u(z,"TypeError"),"cannot convert nil into Rational"),$($(n=u(z,"Integer")["$==="](t))?u(z,"Integer")["$==="](e):n)?this.$reduce(t,e):($($(n=$(i=u(z,"Float")["$==="](t))?i:u(z,"String")["$==="](t))?n:u(z,"Complex")["$==="](t))&&(t=t.$to_r()),$($(n=$(i=u(z,"Float")["$==="](e))?i:u(z,"String")["$==="](e))?n:u(z,"Complex")["$==="](e))&&(e=e.$to_r()),$($(n=e["$equal?"](1))?u(z,"Integer")["$==="](t)["$!"]():n)?u(z,"Opal")["$coerce_to!"](t,u(z,"Rational"),"to_r"):$($(n=u(z,"Numeric")["$==="](t))?u(z,"Numeric")["$==="](e):n)?r(t,e):this.$reduce(t,e))},d.$$arity=2),t.def(D,"$initialize",_=function(t,e){return this.num=t,this.den=e},_.$$arity=2),t.def(D,"$numerator",m=function(){return this.num},m.$$arity=0),t.def(D,"$denominator",y=function(){return this.den},y.$$arity=0),t.def(D,"$coerce",g=function(t){var e=this,r=c;return r=t,u(z,"Rational")["$==="](r)?[t,e]:u(z,"Integer")["$==="](r)?[t.$to_r(),e]:u(z,"Float")["$==="](r)?[t,e.$to_f()]:c},g.$$arity=1),t.def(D,"$==",v=function(t){var e=this,r=c;return r=t,u(z,"Rational")["$==="](r)?e.num["$=="](t.$numerator())?e.den["$=="](t.$denominator()):e.num["$=="](t.$numerator()):u(z,"Integer")["$==="](r)?e.num["$=="](t)?e.den["$=="](1):e.num["$=="](t):u(z,"Float")["$==="](r)?e.$to_f()["$=="](t):t["$=="](e)},v.$$arity=1),t.def(D,"$<=>",b=function(t){var e=this,r=c;return r=t,u(z,"Rational")["$==="](r)?n(i(e.num,t.$denominator()),i(e.den,t.$numerator()))["$<=>"](0):u(z,"Integer")["$==="](r)?n(e.num,i(e.den,t))["$<=>"](0):u(z,"Float")["$==="](r)?e.$to_f()["$<=>"](t):e.$__coerced__("<=>",t)},b.$$arity=1),t.def(D,"$+",A=function(t){var e=this,r=c,n=c,a=c;return r=t,u(z,"Rational")["$==="](r)?(n=s(i(e.num,t.$denominator()),i(e.den,t.$numerator())),a=i(e.den,t.$denominator()),e.$Rational(n,a)):u(z,"Integer")["$==="](r)?e.$Rational(s(e.num,i(t,e.den)),e.den):u(z,"Float")["$==="](r)?s(e.$to_f(),t):e.$__coerced__("+",t)},A.$$arity=1),t.def(D,"$-",x=function(t){var e=this,r=c,s=c,a=c;return r=t,u(z,"Rational")["$==="](r)?(s=n(i(e.num,t.$denominator()),i(e.den,t.$numerator())),a=i(e.den,t.$denominator()),e.$Rational(s,a)):u(z,"Integer")["$==="](r)?e.$Rational(n(e.num,i(t,e.den)),e.den):u(z,"Float")["$==="](r)?n(e.$to_f(),t):e.$__coerced__("-",t)},x.$$arity=1),t.def(D,"$*",w=function(t){var e=this,r=c,n=c,s=c;return r=t,u(z,"Rational")["$==="](r)?(n=i(e.num,t.$numerator()),s=i(e.den,t.$denominator()),e.$Rational(n,s)):u(z,"Integer")["$==="](r)?e.$Rational(i(e.num,t),e.den):u(z,"Float")["$==="](r)?i(e.$to_f(),t):e.$__coerced__("*",t)},w.$$arity=1),t.def(D,"$/",k=function(t){var e=this,n=c,s=c,a=c;return n=t,u(z,"Rational")["$==="](n)?(s=i(e.num,t.$denominator()),a=i(e.den,t.$numerator()),e.$Rational(s,a)):u(z,"Integer")["$==="](n)?t["$=="](0)?r(e.$to_f(),0):e.$Rational(e.num,i(e.den,t)):u(z,"Float")["$==="](n)?r(e.$to_f(),t):e.$__coerced__("/",t)},k.$$arity=1),t.def(D,"$**",E=function(t){var r,n,i=this,s=c;return s=t,u(z,"Integer")["$==="](s)?$(i["$=="](0)?e(t,0):i["$=="](0))?l(u(z,"Float"),"INFINITY"):$((n=0,"number"==typeof(r=t)&&"number"==typeof n?r>n:r["$>"](n)))?i.$Rational(i.num["$**"](t),i.den["$**"](t)):$(e(t,0))?i.$Rational(i.den["$**"](t["$-@"]()),i.num["$**"](t["$-@"]())):i.$Rational(1,1):u(z,"Float")["$==="](s)?i.$to_f()["$**"](t):u(z,"Rational")["$==="](s)?t["$=="](0)?i.$Rational(1,1):t.$denominator()["$=="](1)?$(e(t,0))?i.$Rational(i.den["$**"](t.$numerator().$abs()),i.num["$**"](t.$numerator().$abs())):i.$Rational(i.num["$**"](t.$numerator()),i.den["$**"](t.$numerator())):$(i["$=="](0)?e(t,0):i["$=="](0))?i.$raise(u(z,"ZeroDivisionError"),"divided by 0"):i.$to_f()["$**"](t):i.$__coerced__("**",t)},E.$$arity=1),t.def(D,"$abs",S=function(){return this.$Rational(this.num.$abs(),this.den.$abs())},S.$$arity=0),t.def(D,"$ceil",N=function(t){return null==t&&(t=0),t["$=="](0)?r(this.num["$-@"](),this.den)["$-@"]().$ceil():this.$with_precision("ceil",t)},N.$$arity=-1),t.alias(D,"divide","/"),t.def(D,"$floor",I=function(t){return null==t&&(t=0),t["$=="](0)?r(this.num["$-@"](),this.den)["$-@"]().$floor():this.$with_precision("floor",t)},I.$$arity=-1),t.def(D,"$hash",C=function(){return"Rational:"+this.num+":"+this.den},C.$$arity=0),t.def(D,"$inspect",O=function(){return"("+this+")"},O.$$arity=0),t.alias(D,"quo","/"),t.def(D,"$rationalize",B=function(t){if(arguments.length>1&&this.$raise(u(z,"ArgumentError"),"wrong number of arguments ("+arguments.length+" for 0..1)"),null==t)return this;for(var e,i,a,o,c,l,f,$=t.$abs(),h=n(this,$),p=s(this,$),d=0,_=1,m=1,y=0;a=h.$ceil(),f=p,!("number"==typeof(l=a)&&"number"==typeof f?l<=f:l["$<="](f));)e=(o=a-1)*_+d,i=o*y+m,c=r(1,n(p,o)),p=r(1,n(h,o)),h=c,d=_,m=y,_=e,y=i;return this.$Rational(a*_+d,a*y+m)},B.$$arity=-1),t.def(D,"$round",M=function(t){var n=c;return null==t&&(t=0),t["$=="](0)?this.num["$=="](0)?0:this.den["$=="](1)?this.num:(n=r(s(i(this.num.$abs(),2),this.den),i(this.den,2)).$truncate(),$(e(this.num,0))?n["$-@"]():n):this.$with_precision("round",t)},M.$$arity=-1),t.def(D,"$to_f",P=function(){return r(this.num,this.den)},P.$$arity=0),t.def(D,"$to_i",F=function(){return this.$truncate()},F.$$arity=0),t.def(D,"$to_r",L=function(){return this},L.$$arity=0),t.def(D,"$to_s",T=function(){return this.num+"/"+this.den},T.$$arity=0),t.def(D,"$truncate",j=function(t){return null==t&&(t=0),t["$=="](0)?$(e(this.num,0))?this.$ceil():this.$floor():this.$with_precision("truncate",t)},j.$$arity=-1),t.def(D,"$with_precision",R=function(t,n){var s,a=c;return $(u(z,"Integer")["$==="](n))||this.$raise(u(z,"TypeError"),"not an Integer"),a=i(this,s=10["$**"](n)),$(e(n,1))?r(a.$send(t),s).$to_i():this.$Rational(a.$send(t),s)},R.$$arity=2)}(o[0],u(o,"Numeric"),o),function(e,r){var n,i=h(e,"Kernel"),s=[i].concat(r);t.def(i,"$Rational",n=function(t,e){return null==e&&(e=1),u(s,"Rational").$convert(t,e)},n.$$arity=-2)}(o[0],o),function(e,r,n){var i,s=f(e,null,"String");[s].concat(n);return t.def(s,"$to_r",i=function(){var t,e,r=this.trimLeft(),n=/^[+-]?[\d_]+(\.[\d_]+)?/;r.match(n);function i(){return n.test(r)}function s(){var t=r.match(n)[0];return r=r.slice(t.length),t.replace(/_/g,"")}return i()?(t=parseFloat(s()),"/"===r[0]?(r=r.slice(1),i()?(e=parseFloat(s()),this.$Rational(t,e)):this.$Rational(t,1)):this.$Rational(t,1)):this.$Rational(0,1)},i.$$arity=0),c&&"to_r"}(o[0],0,o)},Opal.modules["corelib/time"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t/e:t["$/"](e)}function n(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}function i(t,e){return"number"==typeof t&&"number"==typeof e?t<=e:t["$<="](e)}var s=t.top,a=[],o=t.nil,c=(t.const_get_qualified,t.const_get_relative),l=(t.breaker,t.slice),u=t.klass,f=t.truthy,$=t.range;return t.add_stubs(["$require","$include","$===","$raise","$coerce_to!","$respond_to?","$to_str","$to_i","$new","$<=>","$to_f","$nil?","$>","$<","$strftime","$year","$month","$day","$+","$round","$/","$-","$copy_instance_variables","$initialize_dup","$is_a?","$zero?","$wday","$utc?","$mon","$yday","$hour","$min","$sec","$rjust","$ljust","$zone","$to_s","$[]","$cweek_cyear","$isdst","$<=","$!=","$==","$ceil"]),s.$require("corelib/comparable"),function(s,a,h){var p,d,_,m,y,g,v,b,A,x,w,k,E,S,N,I,C,O,B,M,P,F,L,T,j,R,D,z,U,q,H,Q,Y,G,V,J,X,W,K,Z,tt,et,rt=u(s,a,"Time"),nt=[rt].concat(h);rt.$include(c(nt,"Comparable"));var it=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],st=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],at=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],ot=["January","February","March","April","May","June","July","August","September","October","November","December"];function ct(t,e,r,n,i,s){if(t=t.$$is_string?parseInt(t,10):c(nt,"Opal")["$coerce_to!"](t,c(nt,"Integer"),"to_int"),e===o)e=1;else if(!e.$$is_number)if(e["$respond_to?"]("to_str"))switch((e=e.$to_str()).toLowerCase()){case"jan":e=1;break;case"feb":e=2;break;case"mar":e=3;break;case"apr":e=4;break;case"may":e=5;break;case"jun":e=6;break;case"jul":e=7;break;case"aug":e=8;break;case"sep":e=9;break;case"oct":e=10;break;case"nov":e=11;break;case"dec":e=12;break;default:e=e.$to_i()}else e=c(nt,"Opal")["$coerce_to!"](e,c(nt,"Integer"),"to_int");return(e<1||e>12)&&rt.$raise(c(nt,"ArgumentError"),"month out of range: "+e),e-=1,((r=r===o?1:r.$$is_string?parseInt(r,10):c(nt,"Opal")["$coerce_to!"](r,c(nt,"Integer"),"to_int"))<1||r>31)&&rt.$raise(c(nt,"ArgumentError"),"day out of range: "+r),((n=n===o?0:n.$$is_string?parseInt(n,10):c(nt,"Opal")["$coerce_to!"](n,c(nt,"Integer"),"to_int"))<0||n>24)&&rt.$raise(c(nt,"ArgumentError"),"hour out of range: "+n),((i=i===o?0:i.$$is_string?parseInt(i,10):c(nt,"Opal")["$coerce_to!"](i,c(nt,"Integer"),"to_int"))<0||i>59)&&rt.$raise(c(nt,"ArgumentError"),"min out of range: "+i),s===o?s=0:s.$$is_number||(s=s.$$is_string?parseInt(s,10):c(nt,"Opal")["$coerce_to!"](s,c(nt,"Integer"),"to_int")),(s<0||s>60)&&rt.$raise(c(nt,"ArgumentError"),"sec out of range: "+s),[t,e,r,n,i,s]}return t.defs(rt,"$at",p=function(t,e){var r;return c(nt,"Time")["$==="](t)?(void 0!==e&&this.$raise(c(nt,"TypeError"),"can't convert Time into an exact number"),(r=new Date(t.getTime())).is_utc=t.is_utc,r):(t.$$is_number||(t=c(nt,"Opal")["$coerce_to!"](t,c(nt,"Integer"),"to_int")),void 0===e?new Date(1e3*t):(e.$$is_number||(e=c(nt,"Opal")["$coerce_to!"](e,c(nt,"Integer"),"to_int")),new Date(1e3*t+e/1e3)))},p.$$arity=-2),t.defs(rt,"$new",d=function(t,e,r,n,i,s,a){var l,u;return null==e&&(e=o),null==r&&(r=o),null==n&&(n=o),null==i&&(i=o),null==s&&(s=o),null==a&&(a=o),void 0===t?new Date:(a!==o&&this.$raise(c(nt,"ArgumentError"),"Opal does not support explicitly specifying UTC offset for Time"),t=(l=ct(t,e,r,n,i,s))[0],e=l[1],r=l[2],n=l[3],i=l[4],s=l[5],u=new Date(t,e,r,n,i,0,1e3*s),t<100&&u.setFullYear(t),u)},d.$$arity=-1),t.defs(rt,"$local",_=function(t,e,r,n,i,s,a,c,u,f){var $,h;return null==e&&(e=o),null==r&&(r=o),null==n&&(n=o),null==i&&(i=o),null==s&&(s=o),null==a&&(a=o),null==c&&(c=o),null==u&&(u=o),null==f&&(f=o),10===arguments.length&&(t=($=l.call(arguments))[5],e=$[4],r=$[3],n=$[2],i=$[1],s=$[0]),t=($=ct(t,e,r,n,i,s))[0],e=$[1],r=$[2],n=$[3],i=$[4],s=$[5],h=new Date(t,e,r,n,i,0,1e3*s),t<100&&h.setFullYear(t),h},_.$$arity=-2),t.defs(rt,"$gm",m=function(t,e,r,n,i,s,a,c,u,f){var $,h;return null==e&&(e=o),null==r&&(r=o),null==n&&(n=o),null==i&&(i=o),null==s&&(s=o),null==a&&(a=o),null==c&&(c=o),null==u&&(u=o),null==f&&(f=o),10===arguments.length&&(t=($=l.call(arguments))[5],e=$[4],r=$[3],n=$[2],i=$[1],s=$[0]),t=($=ct(t,e,r,n,i,s))[0],e=$[1],r=$[2],n=$[3],i=$[4],s=$[5],h=new Date(Date.UTC(t,e,r,n,i,0,1e3*s)),t<100&&h.setUTCFullYear(t),h.is_utc=!0,h},m.$$arity=-2),function(e,r){[e].concat(r);t.alias(e,"mktime","local"),t.alias(e,"utc","gm")}(t.get_singleton_class(rt),nt),t.defs(rt,"$now",y=function(){return this.$new()},y.$$arity=0),t.def(rt,"$+",g=function(t){f(c(nt,"Time")["$==="](t))&&this.$raise(c(nt,"TypeError"),"time + time?"),t.$$is_number||(t=c(nt,"Opal")["$coerce_to!"](t,c(nt,"Integer"),"to_int"));var e=new Date(this.getTime()+1e3*t);return e.is_utc=this.is_utc,e},g.$$arity=1),t.def(rt,"$-",v=function(t){if(f(c(nt,"Time")["$==="](t)))return(this.getTime()-t.getTime())/1e3;t.$$is_number||(t=c(nt,"Opal")["$coerce_to!"](t,c(nt,"Integer"),"to_int"));var e=new Date(this.getTime()-1e3*t);return e.is_utc=this.is_utc,e},v.$$arity=1),t.def(rt,"$<=>",b=function(t){var e,r,n=o;return f(c(nt,"Time")["$==="](t))?this.$to_f()["$<=>"](t.$to_f()):(n=t["$<=>"](this),f(n["$nil?"]())?o:f((r=0,"number"==typeof(e=n)&&"number"==typeof r?e>r:e["$>"](r)))?-1:f(function(t,e){return"number"==typeof t&&"number"==typeof e?t<e:t["$<"](e)}(n,0))?1:0)},b.$$arity=1),t.def(rt,"$==",A=function(t){var e;return f(e=c(nt,"Time")["$==="](t))?this.$to_f()===t.$to_f():e},A.$$arity=1),t.def(rt,"$asctime",x=function(){return this.$strftime("%a %b %e %H:%M:%S %Y")},x.$$arity=0),t.alias(rt,"ctime","asctime"),t.def(rt,"$day",w=function(){return this.is_utc?this.getUTCDate():this.getDate()},w.$$arity=0),t.def(rt,"$yday",k=function(){var t;return t=c(nt,"Time").$new(this.$year()).$to_i(),86400,e(r(n(c(nt,"Time").$new(this.$year(),this.$month(),this.$day()).$to_i(),t),86400).$round(),1)},k.$$arity=0),t.def(rt,"$isdst",E=function(){var t=new Date(this.getFullYear(),0,1),e=new Date(this.getFullYear(),6,1);return this.getTimezoneOffset()<Math.max(t.getTimezoneOffset(),e.getTimezoneOffset())},E.$$arity=0),t.alias(rt,"dst?","isdst"),t.def(rt,"$dup",S=function(){var t=o;return(t=new Date(this.getTime())).$copy_instance_variables(this),t.$initialize_dup(this),t},S.$$arity=0),t.def(rt,"$eql?",N=function(t){var e;return f(e=t["$is_a?"](c(nt,"Time")))?this["$<=>"](t)["$zero?"]():e},N.$$arity=1),t.def(rt,"$friday?",I=function(){return 5==this.$wday()},I.$$arity=0),t.def(rt,"$hash",C=function(){return"Time:"+this.getTime()},C.$$arity=0),t.def(rt,"$hour",O=function(){return this.is_utc?this.getUTCHours():this.getHours()},O.$$arity=0),t.def(rt,"$inspect",B=function(){return f(this["$utc?"]())?this.$strftime("%Y-%m-%d %H:%M:%S UTC"):this.$strftime("%Y-%m-%d %H:%M:%S %z")},B.$$arity=0),t.alias(rt,"mday","day"),t.def(rt,"$min",M=function(){return this.is_utc?this.getUTCMinutes():this.getMinutes()},M.$$arity=0),t.def(rt,"$mon",P=function(){return(this.is_utc?this.getUTCMonth():this.getMonth())+1},P.$$arity=0),t.def(rt,"$monday?",F=function(){return 1==this.$wday()},F.$$arity=0),t.alias(rt,"month","mon"),t.def(rt,"$saturday?",L=function(){return 6==this.$wday()},L.$$arity=0),t.def(rt,"$sec",T=function(){return this.is_utc?this.getUTCSeconds():this.getSeconds()},T.$$arity=0),t.def(rt,"$succ",j=function(){var t=new Date(this.getTime()+1e3);return t.is_utc=this.is_utc,t},j.$$arity=0),t.def(rt,"$usec",R=function(){return 1e3*this.getMilliseconds()},R.$$arity=0),t.def(rt,"$zone",D=function(){var t,e=this.toString();return"GMT"==(t=-1==e.indexOf("(")?e.match(/[A-Z]{3,4}/)[0]:e.match(/\((.+)\)(?:\s|$)/)[1])&&/(GMT\W*\d{4})/.test(e)?RegExp.$1:t},D.$$arity=0),t.def(rt,"$getgm",z=function(){var t=new Date(this.getTime());return t.is_utc=!0,t},z.$$arity=0),t.alias(rt,"getutc","getgm"),t.def(rt,"$gmtime",U=function(){return this.is_utc=!0,this},U.$$arity=0),t.alias(rt,"utc","gmtime"),t.def(rt,"$gmt?",q=function(){return!0===this.is_utc},q.$$arity=0),t.def(rt,"$gmt_offset",H=function(){return this.is_utc?0:60*-this.getTimezoneOffset()},H.$$arity=0),t.def(rt,"$strftime",Q=function(t){var e=this;return t.replace(/%([\-_#^0]*:{0,2})(\d+)?([EO]*)(.)/g,function(t,r,n,i,s){var a="",o=-1!==r.indexOf("0"),c=-1===r.indexOf("-"),l=-1!==r.indexOf("_"),u=-1!==r.indexOf("^"),f=-1!==r.indexOf("#"),h=(r.match(":")||[]).length;switch(n=parseInt(n,10),o&&l&&(r.indexOf("0")<r.indexOf("_")?o=!1:l=!1),s){case"Y":a+=e.$year();break;case"C":o=!l,a+=Math.round(e.$year()/100);break;case"y":o=!l,a+=e.$year()%100;break;case"m":o=!l,a+=e.$mon();break;case"B":a+=ot[e.$mon()-1];break;case"b":case"h":l=!o,a+=at[e.$mon()-1];break;case"d":o=!l,a+=e.$day();break;case"e":l=!o,a+=e.$day();break;case"j":a+=e.$yday();break;case"H":o=!l,a+=e.$hour();break;case"k":l=!o,a+=e.$hour();break;case"I":o=!l,a+=e.$hour()%12||12;break;case"l":l=!o,a+=e.$hour()%12||12;break;case"P":a+=e.$hour()>=12?"pm":"am";break;case"p":a+=e.$hour()>=12?"PM":"AM";break;case"M":o=!l,a+=e.$min();break;case"S":o=!l,a+=e.$sec();break;case"L":o=!l,n=isNaN(n)?3:n,a+=e.getMilliseconds();break;case"N":n=isNaN(n)?9:n,a=(a+=e.getMilliseconds().toString().$rjust(3,"0")).$ljust(n,"0");break;case"z":var p=e.getTimezoneOffset(),d=Math.floor(Math.abs(p)/60),_=Math.abs(p)%60;a+=p<0?"+":"-",a+=d<10?"0":"",a+=d,h>0&&(a+=":"),a+=_<10?"0":"",a+=_,h>1&&(a+=":00");break;case"Z":a+=e.$zone();break;case"A":a+=it[e.$wday()];break;case"a":a+=st[e.$wday()];break;case"u":a+=e.$wday()+1;break;case"w":a+=e.$wday();break;case"V":a+=e.$cweek_cyear()["$[]"](0).$to_s().$rjust(2,"0");break;case"G":a+=e.$cweek_cyear()["$[]"](1);break;case"g":a+=e.$cweek_cyear()["$[]"](1)["$[]"]($(-2,-1,!1));break;case"s":a+=e.$to_i();break;case"n":a+="\n";break;case"t":a+="\t";break;case"%":a+="%";break;case"c":a+=e.$strftime("%a %b %e %T %Y");break;case"D":case"x":a+=e.$strftime("%m/%d/%y");break;case"F":a+=e.$strftime("%Y-%m-%d");break;case"v":a+=e.$strftime("%e-%^b-%4Y");break;case"r":a+=e.$strftime("%I:%M:%S %p");break;case"R":a+=e.$strftime("%H:%M");break;case"T":case"X":a+=e.$strftime("%H:%M:%S");break;default:return t}return u&&(a=a.toUpperCase()),f&&(a=a.replace(/[A-Z]/,function(t){t.toLowerCase()}).replace(/[a-z]/,function(t){t.toUpperCase()})),c&&(o||l)&&(a=a.$rjust(isNaN(n)?2:n,l?" ":"0")),a})},Q.$$arity=1),t.def(rt,"$sunday?",Y=function(){return 0==this.$wday()},Y.$$arity=0),t.def(rt,"$thursday?",G=function(){return 4==this.$wday()},G.$$arity=0),t.def(rt,"$to_a",V=function(){return[this.$sec(),this.$min(),this.$hour(),this.$day(),this.$month(),this.$year(),this.$wday(),this.$yday(),this.$isdst(),this.$zone()]},V.$$arity=0),t.def(rt,"$to_f",J=function(){return this.getTime()/1e3},J.$$arity=0),t.def(rt,"$to_i",X=function(){return parseInt(this.getTime()/1e3,10)},X.$$arity=0),t.alias(rt,"to_s","inspect"),t.def(rt,"$tuesday?",W=function(){return 2==this.$wday()},W.$$arity=0),t.alias(rt,"tv_sec","to_i"),t.alias(rt,"tv_usec","usec"),t.alias(rt,"utc?","gmt?"),t.alias(rt,"gmtoff","gmt_offset"),t.alias(rt,"utc_offset","gmt_offset"),t.def(rt,"$wday",K=function(){return this.is_utc?this.getUTCDay():this.getDay()},K.$$arity=0),t.def(rt,"$wednesday?",Z=function(){return 3==this.$wday()},Z.$$arity=0),t.def(rt,"$year",tt=function(){return this.is_utc?this.getUTCFullYear():this.getFullYear()},tt.$$arity=0),t.def(rt,"$cweek_cyear",et=function(){var t,s=o,a=o,l=o,u=o,$=o;return s=c(nt,"Time").$new(this.$year(),1,1).$wday(),0,a=this.$year(),f(f(t=i(s,4))?s["$!="](0):t)?l=n(s,1):(l=n(n(s,7),1))["$=="](-8)&&(l=-1),u=r(e(this.$yday(),l),7).$ceil(),f(i(u,0))?c(nt,"Time").$new(n(this.$year(),1),12,31).$cweek_cyear():(u["$=="](53)&&($=c(nt,"Time").$new(this.$year(),12,31).$wday(),f(f(t=i($,3))?$["$!="](0):t)&&(u=1,a=e(a,1))),[u,a])},et.$$arity=0),o&&"cweek_cyear"}(a[0],Date,a)},Opal.modules["corelib/struct"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t>e:t["$>"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}function n(t,e){return"number"==typeof t&&"number"==typeof e?t<e:t["$<"](e)}function i(t,e){return"number"==typeof t&&"number"==typeof e?t>=e:t["$>="](e)}function s(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}var a=t.top,o=[],c=t.nil,l=(t.const_get_qualified,t.const_get_relative),u=(t.breaker,t.slice,t.klass),f=t.hash2,$=t.truthy,h=t.send;return t.add_stubs(["$require","$include","$const_name!","$unshift","$map","$coerce_to!","$new","$each","$define_struct_attribute","$allocate","$initialize","$alias_method","$module_eval","$to_proc","$const_set","$==","$raise","$<<","$members","$define_method","$instance_eval","$class","$last","$>","$length","$-","$keys","$any?","$join","$[]","$[]=","$each_with_index","$hash","$===","$<","$-@","$size","$>=","$include?","$to_sym","$instance_of?","$__id__","$eql?","$enum_for","$name","$+","$each_pair","$inspect","$each_with_object","$flatten","$to_a","$respond_to?","$dig"]),a.$require("corelib/enumerable"),function(a,o,p){var d,_,m,y,g,v,b,A,x,w,k,E,S,N,I,C,O,B,M,P=u(a,null,"Struct"),F=[P].concat(p);return P.$include(l(F,"Enumerable")),t.defs(P,"$new",d=function(e,r,n){var i,s,a,o,u,p,_=d.$$p,m=_||c,y=c;if(_&&(d.$$p=null),_&&(d.$$p=null),i=t.slice.call(arguments,1,arguments.length),null==(s=t.extract_kwargs(i)))s=f([],{});else if(!s.$$is_hash)throw t.ArgumentError.$new("expected kwargs");if(a=i,null==(o=s.$$smap.keyword_init)&&(o=!1),$(e))try{e=l(F,"Opal")["$const_name!"](e)}catch(r){if(!t.rescue(r,[l(F,"TypeError"),l(F,"NameError")]))throw r;try{a.$unshift(e),e=c}finally{t.pop_exception()}}return h(a,"map",[],((u=function(t){u.$$s;return null==t&&(t=c),l(F,"Opal")["$coerce_to!"](t,l(F,"String"),"to_str")}).$$s=this,u.$$arity=1,u)),y=h(l(F,"Class"),"new",[this],((p=function(){var e,r=p.$$s||this;return h(a,"each",[],((e=function(t){var r=e.$$s||this;return null==t&&(t=c),r.$define_struct_attribute(t)}).$$s=r,e.$$arity=1,e)),function(e,r){var n;[e].concat(r);return t.def(e,"$new",n=function(e){var r,n=c;return r=t.slice.call(arguments,0,arguments.length),(n=this.$allocate()).$$data={},h(n,"initialize",t.to_a(r)),n},n.$$arity=-1),e.$alias_method("[]","new")}(t.get_singleton_class(r),F)}).$$s=this,p.$$arity=0,p)),$(m)&&h(y,"module_eval",[],m.$to_proc()),y.$$keyword_init=o,$(e)&&l(F,"Struct").$const_set(e,y),y},d.$$arity=-2),t.defs(P,"$define_struct_attribute",_=function(t){var e,r;return this["$=="](l(F,"Struct"))&&this.$raise(l(F,"ArgumentError"),"you cannot define attributes to the Struct class"),this.$members()["$<<"](t),h(this,"define_method",[t],((e=function(){return(e.$$s||this).$$data[t]}).$$s=this,e.$$arity=0,e)),h(this,"define_method",[t+"="],((r=function(e){var n=r.$$s||this;return null==e&&(e=c),n.$$data[t]=e}).$$s=this,r.$$arity=1,r))},_.$$arity=1),t.defs(P,"$members",m=function(){var t;return null==this.members&&(this.members=c),this["$=="](l(F,"Struct"))&&this.$raise(l(F,"ArgumentError"),"the Struct class has no members"),this.members=$(t=this.members)?t:[]},m.$$arity=0),t.defs(P,"$inherited",y=function(t){var e,r;return null==this.members&&(this.members=c),r=this.members,h(t,"instance_eval",[],((e=function(){return(e.$$s||this).members=r}).$$s=this,e.$$arity=0,e))},y.$$arity=1),t.def(P,"$initialize",g=function(n){var i,s,a,o,u,p=c,d=c;return i=t.slice.call(arguments,0,arguments.length),s=i,$(this.$class().$$keyword_init)?(p=$(a=s.$last())?a:f([],{}),$($(a=e(s.$length(),1))?a:1===s.length&&!p.$$is_hash)&&this.$raise(l(F,"ArgumentError"),"wrong number of arguments (given "+s.$length()+", expected 0)"),d=r(p.$keys(),this.$class().$members()),$(d["$any?"]())&&this.$raise(l(F,"ArgumentError"),"unknown keywords: "+d.$join(", ")),h(this.$class().$members(),"each",[],((o=function(e){var n,i=o.$$s||this;return null==e&&(e=c),n=[e,p["$[]"](e)],h(i,"[]=",t.to_a(n)),n[r(n.length,1)]}).$$s=this,o.$$arity=1,o))):($(e(s.$length(),this.$class().$members().$length()))&&this.$raise(l(F,"ArgumentError"),"struct size differs"),h(this.$class().$members(),"each_with_index",[],((u=function(e,n){var i,a=u.$$s||this;return null==e&&(e=c),null==n&&(n=c),i=[e,s["$[]"](n)],h(a,"[]=",t.to_a(i)),i[r(i.length,1)]}).$$s=this,u.$$arity=2,u)))},g.$$arity=-1),t.def(P,"$members",v=function(){return this.$class().$members()},v.$$arity=0),t.def(P,"$hash",b=function(){return l(F,"Hash").$new(this.$$data).$hash()},b.$$arity=0),t.def(P,"$[]",A=function(t){return $(l(F,"Integer")["$==="](t))?($(n(t,this.$class().$members().$size()["$-@"]()))&&this.$raise(l(F,"IndexError"),"offset "+t+" too small for struct(size:"+this.$class().$members().$size()+")"),$(i(t,this.$class().$members().$size()))&&this.$raise(l(F,"IndexError"),"offset "+t+" too large for struct(size:"+this.$class().$members().$size()+")"),t=this.$class().$members()["$[]"](t)):$(l(F,"String")["$==="](t))?this.$$data.hasOwnProperty(t)||this.$raise(l(F,"NameError").$new("no member '"+t+"' in struct",t)):this.$raise(l(F,"TypeError"),"no implicit conversion of "+t.$class()+" into Integer"),t=l(F,"Opal")["$coerce_to!"](t,l(F,"String"),"to_str"),this.$$data[t]},A.$$arity=1),t.def(P,"$[]=",x=function(t,e){return $(l(F,"Integer")["$==="](t))?($(n(t,this.$class().$members().$size()["$-@"]()))&&this.$raise(l(F,"IndexError"),"offset "+t+" too small for struct(size:"+this.$class().$members().$size()+")"),$(i(t,this.$class().$members().$size()))&&this.$raise(l(F,"IndexError"),"offset "+t+" too large for struct(size:"+this.$class().$members().$size()+")"),t=this.$class().$members()["$[]"](t)):$(l(F,"String")["$==="](t))?$(this.$class().$members()["$include?"](t.$to_sym()))||this.$raise(l(F,"NameError").$new("no member '"+t+"' in struct",t)):this.$raise(l(F,"TypeError"),"no implicit conversion of "+t.$class()+" into Integer"),t=l(F,"Opal")["$coerce_to!"](t,l(F,"String"),"to_str"),this.$$data[t]=e},x.$$arity=2),t.def(P,"$==",w=function(t){if(!$(t["$instance_of?"](this.$class())))return!1;var e={},r={};return function t(n,i){var s,a,o;for(s in e[n.$__id__()]=!0,r[i.$__id__()]=!0,n.$$data)if(a=n.$$data[s],o=i.$$data[s],l(F,"Struct")["$==="](a)){if(!(e.hasOwnProperty(a.$__id__())&&r.hasOwnProperty(o.$__id__())||t(a,o)))return!1}else if(!a["$=="](o))return!1;return!0}(this,t)},w.$$arity=1),t.def(P,"$eql?",k=function(t){if(!$(t["$instance_of?"](this.$class())))return!1;var e={},r={};return function t(n,i){var s,a,o;for(s in e[n.$__id__()]=!0,r[i.$__id__()]=!0,n.$$data)if(a=n.$$data[s],o=i.$$data[s],l(F,"Struct")["$==="](a)){if(!(e.hasOwnProperty(a.$__id__())&&r.hasOwnProperty(o.$__id__())||t(a,o)))return!1}else if(!a["$eql?"](o))return!1;return!0}(this,t)},k.$$arity=1),t.def(P,"$each",E=function(){var e,r,n=E.$$p,i=n||c;return n&&(E.$$p=null),i===c?h(this,"enum_for",["each"],((e=function(){return(e.$$s||this).$size()}).$$s=this,e.$$arity=0,e)):(h(this.$class().$members(),"each",[],((r=function(e){var n=r.$$s||this;return null==e&&(e=c),t.yield1(i,n["$[]"](e))}).$$s=this,r.$$arity=1,r)),this)},E.$$arity=0),t.def(P,"$each_pair",S=function(){var e,r,n=S.$$p,i=n||c;return n&&(S.$$p=null),i===c?h(this,"enum_for",["each_pair"],((e=function(){return(e.$$s||this).$size()}).$$s=this,e.$$arity=0,e)):(h(this.$class().$members(),"each",[],((r=function(e){var n=r.$$s||this;return null==e&&(e=c),t.yield1(i,[e,n["$[]"](e)])}).$$s=this,r.$$arity=1,r)),this)},S.$$arity=0),t.def(P,"$length",N=function(){return this.$class().$members().$length()},N.$$arity=0),t.alias(P,"size","length"),t.def(P,"$to_a",I=function(){var t;return h(this.$class().$members(),"map",[],((t=function(e){var r=t.$$s||this;return null==e&&(e=c),r["$[]"](e)}).$$s=this,t.$$arity=1,t))},I.$$arity=0),t.alias(P,"values","to_a"),t.def(P,"$inspect",C=function(){var t,e,r=c;return r="#<struct ",$($(t=l(F,"Struct")["$==="](this))?this.$class().$name():t)&&(r=s(r,this.$class()+" ")),r=s(r=s(r,h(this.$each_pair(),"map",[],(e=function(t,r){e.$$s;return null==t&&(t=c),null==r&&(r=c),t+"="+r.$inspect()},e.$$s=this,e.$$arity=2,e)).$join(", ")),">")},C.$$arity=0),t.alias(P,"to_s","inspect"),t.def(P,"$to_h",O=function(){var e;return h(this.$class().$members(),"each_with_object",[f([],{})],((e=function(n,i){var s,a=e.$$s||this;return null==n&&(n=c),null==i&&(i=c),s=[n,a["$[]"](n)],h(i,"[]=",t.to_a(s)),s[r(s.length,1)]}).$$s=this,e.$$arity=2,e))},O.$$arity=0),t.def(P,"$values_at",B=function(e){var r,n,i;r=t.slice.call(arguments,0,arguments.length);for(var s=[],a=0,o=(n=h(n=r,"map",[],(i=function(t){i.$$s;return null==t&&(t=c),t.$$is_range?t.$to_a():t},i.$$s=this,i.$$arity=1,i)).$flatten()).length;a<o;a++)n[a].$$is_number||this.$raise(l(F,"TypeError"),"no implicit conversion of "+n[a].$class()+" into Integer"),s.push(this["$[]"](n[a]));return s},B.$$arity=-1),t.def(P,"$dig",M=function(e,r){var n,i=this,s=c;return n=t.slice.call(arguments,1,arguments.length),(s=$(e.$$is_string&&i.$$data.hasOwnProperty(e))&&i.$$data[e]||c)===c||0===n.length?s:($(s["$respond_to?"]("dig"))||i.$raise(l(F,"TypeError"),s.$class()+" does not have #dig method"),h(s,"dig",t.to_a(n)))},M.$$arity=-2),c&&"dig"}(o[0],0,o)},Opal.modules["corelib/io"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}t.top;var r=[],n=t.nil,i=t.const_get_qualified,s=t.const_get_relative,a=(t.breaker,t.slice,t.klass),o=t.module,c=t.send,l=t.gvars,u=t.truthy,f=n;t.add_stubs(["$attr_accessor","$size","$write","$join","$map","$String","$empty?","$concat","$chomp","$getbyte","$getc","$raise","$new","$write_proc=","$-","$extend"]),function(e,r,i){var f,$,h,p,d=a(e,null,"IO"),_=[d].concat(i);d.$$prototype.tty=d.$$prototype.closed=n,t.const_set(_[0],"SEEK_SET",0),t.const_set(_[0],"SEEK_CUR",1),t.const_set(_[0],"SEEK_END",2),t.def(d,"$tty?",f=function(){return this.tty},f.$$arity=0),t.def(d,"$closed?",$=function(){return this.closed},$.$$arity=0),d.$attr_accessor("write_proc"),t.def(d,"$write",h=function(t){return this.write_proc(t),t.$size()},h.$$arity=1),d.$attr_accessor("sync","tty"),t.def(d,"$flush",p=function(){return n},p.$$arity=0),function(e,r){var i,s,a,f=o(e,"Writable");[f].concat(r);t.def(f,"$<<",i=function(t){return this.$write(t),this},i.$$arity=1),t.def(f,"$print",s=function(e){var r,i;return null==l[","]&&(l[","]=n),r=t.slice.call(arguments,0,arguments.length),this.$write(c(r,"map",[],(i=function(t){var e=i.$$s||this;return null==t&&(t=n),e.$String(t)},i.$$s=this,i.$$arity=1,i)).$join(l[","])),n},s.$$arity=-1),t.def(f,"$puts",a=function(e){var r,i,s;return null==l["/"]&&(l["/"]=n),r=t.slice.call(arguments,0,arguments.length),s=l["/"],u(r["$empty?"]())?this.$write(l["/"]):this.$write(c(r,"map",[],(i=function(t){var e=i.$$s||this;return null==t&&(t=n),e.$String(t).$chomp()},i.$$s=this,i.$$arity=1,i)).$concat([n]).$join(s)),n},a.$$arity=-1)}(_[0],_),function(e,r){var i,a,c,u,f=o(e,"Readable"),$=[f].concat(r);t.def(f,"$readbyte",i=function(){return this.$getbyte()},i.$$arity=0),t.def(f,"$readchar",a=function(){return this.$getc()},a.$$arity=0),t.def(f,"$readline",c=function(t){return null==l["/"]&&(l["/"]=n),null==t&&(t=l["/"]),this.$raise(s($,"NotImplementedError"))},c.$$arity=-1),t.def(f,"$readpartial",u=function(t,e){return null==e&&(e=n),this.$raise(s($,"NotImplementedError"))},u.$$arity=-2)}(_[0],_)}(r[0],0,r),t.const_set(r[0],"STDERR",l.stderr=s(r,"IO").$new()),t.const_set(r[0],"STDIN",l.stdin=s(r,"IO").$new()),t.const_set(r[0],"STDOUT",l.stdout=s(r,"IO").$new());var $=t.global.console;return f=["object"==typeof process&&"object"==typeof process.stdout?function(t){process.stdout.write(t)}:function(t){$.log(t)}],c(s(r,"STDOUT"),"write_proc=",t.to_a(f)),f[e(f.length,1)],f=["object"==typeof process&&"object"==typeof process.stderr?function(t){process.stderr.write(t)}:function(t){$.warn(t)}],c(s(r,"STDERR"),"write_proc=",t.to_a(f)),f[e(f.length,1)],s(r,"STDOUT").$extend(i(s(r,"IO"),"Writable")),s(r,"STDERR").$extend(i(s(r,"IO"),"Writable"))},Opal.modules["corelib/main"]=function(t){var e,r,n=t.top,i=[],s=t.nil,a=(t.const_get_qualified,t.const_get_relative);t.breaker,t.slice;return t.add_stubs(["$include"]),t.defs(n,"$to_s",e=function(){return"main"},e.$$arity=0),t.defs(n,"$include",r=function(t){return a(i,"Object").$include(t)},r.$$arity=1),s&&"include"},Opal.modules["corelib/dir"]=function(t){t.top;var e=[],r=t.nil,n=(t.const_get_qualified,t.const_get_relative),i=(t.breaker,t.slice,t.klass),s=t.truthy;return t.add_stubs(["$[]"]),function(e,a,o){var c=i(e,null,"Dir"),l=[c].concat(o);return function(e,i){var a,o,c,l=[e].concat(i);return t.def(e,"$chdir",a=function(e){var n=a.$$p,i=n||r,s=r;return n&&(a.$$p=null),function(){try{return s=t.current_dir,t.current_dir=e,t.yieldX(i,[])}finally{t.current_dir=s}}()},a.$$arity=1),t.def(e,"$pwd",o=function(){return t.current_dir||"."},o.$$arity=0),t.alias(e,"getwd","pwd"),t.def(e,"$home",c=function(){var t;return s(t=n(l,"ENV")["$[]"]("HOME"))?t:"."},c.$$arity=0),r&&"home"}(t.get_singleton_class(c),l)}(e[0],0,e)},Opal.modules["corelib/file"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}t.top;var r=[],n=t.nil,i=(t.const_get_qualified,t.const_get_relative),s=(t.breaker,t.slice,t.klass),a=t.truthy,o=t.range,c=t.send;return t.add_stubs(["$respond_to?","$to_path","$pwd","$split","$sub","$+","$unshift","$join","$home","$raise","$start_with?","$absolute_path","$coerce_to!","$basename","$empty?","$rindex","$[]","$nil?","$==","$-","$length","$gsub","$find","$=~","$map","$each_with_index","$flatten","$reject","$to_proc","$end_with?"]),function(r,l,u){var f=s(r,l,"File"),$=[f].concat(u),h=n;return t.const_set($[0],"Separator",t.const_set($[0],"SEPARATOR","/")),t.const_set($[0],"ALT_SEPARATOR",n),t.const_set($[0],"PATH_SEPARATOR",":"),t.const_set($[0],"FNM_SYSCASE",0),h=/^[a-zA-Z]:(?:\\|\/)/,function(r,s){var l,u,f,$,p,d,_,m,y,g=[r].concat(s);function v(t){return a(t["$respond_to?"]("to_path"))&&(t=t.$to_path()),t=i(g,"Opal")["$coerce_to!"](t,i(g,"String"),"to_str")}function b(){return i(g,"ALT_SEPARATOR")===n?t.escape_regexp(i(g,"SEPARATOR")):t.escape_regexp(e(i(g,"SEPARATOR"),i(g,"ALT_SEPARATOR")))}return t.def(r,"$absolute_path",l=function(t,r){var s,o,c,l,u,f,$=n,p=n,d=n,_=n,m=n;null==r&&(r=n),o=i(g,"SEPARATOR"),c=b(),$=[],t=a(t["$respond_to?"]("to_path"))?t.$to_path():t,r=a(s=r)?s:i(g,"Dir").$pwd(),l=t.substr(0,o.length)===o||h.test(t),u=r.substr(0,o.length)===o||h.test(r),a(l)?(p=t.$split(new RegExp("["+c+"]")),d=h.test(t)?"":t.$sub(new RegExp("^(["+c+"]+).*$"),"\\1"),_=!0):(p=e(r.$split(new RegExp("["+c+"]")),t.$split(new RegExp("["+c+"]"))),d=h.test(r)?"":r.$sub(new RegExp("^(["+c+"]+).*$"),"\\1"),_=u);for(var y=0,v=p.length;y<v;y++)(f=p[y])===n||""===f&&(0===$.length||_)||"."===f&&(0===$.length||_)||(".."===f?$.pop():$.push(f));return _||"."===p[0]||$.$unshift("."),m=$.$join(o),a(_)&&(m=e(d,m)),m},l.$$arity=-2),t.def(r,"$expand_path",u=function(t,r){var s,o,c=n,l=n,u=n;return null==r&&(r=n),s=i(g,"SEPARATOR"),o=b(),a("~"===t[0]||r&&"~"===r[0])&&(c=i(g,"Dir").$home(),a(c)||this.$raise(i(g,"ArgumentError"),"couldn't find HOME environment -- expanding `~'"),l=h.test(c)?"":c.$sub(new RegExp("^(["+o+"]+).*$"),"\\1"),a(c["$start_with?"](l))||this.$raise(i(g,"ArgumentError"),"non-absolute home"),c=e(c,s),u=new RegExp("^\\~(?:"+s+"|$)"),t=t.$sub(u,c),a(r)&&(r=r.$sub(u,c))),this.$absolute_path(t,r)},u.$$arity=-2),t.alias(r,"realpath","expand_path"),t.def(r,"$dirname",f=function(t){var e;e=b();var r=(t=v(t)).match(new RegExp("^["+e+"]"));return""===(t=(t=(t=t.replace(new RegExp("["+e+"]+$"),"")).replace(new RegExp("[^"+e+"]+$"),"")).replace(new RegExp("["+e+"]+$"),""))?r?"/":".":t},f.$$arity=1),t.def(r,"$basename",$=function(e,r){var s;return null==r&&(r=n),s=b(),0==(e=v(e)).length?e:(r=r!==n?i(g,"Opal")["$coerce_to!"](r,i(g,"String"),"to_str"):null,e=(e=e.replace(new RegExp("(.)["+s+"]*$"),"$1")).replace(new RegExp("^(?:.*["+s+"])?([^"+s+"]+)$"),"$1"),".*"===r?e=e.replace(/\.[^\.]+$/,""):null!==r&&(r=t.escape_regexp(r),e=e.replace(new RegExp(r+"$"),"")),e)},$.$$arity=-2),t.def(r,"$extname",p=function(r){var i,s,c,l=n,u=n;return r=v(r),l=this.$basename(r),a(l["$empty?"]())?"":(u=l["$[]"](o(1,-1,!1)).$rindex("."),a(a(i=u["$nil?"]())?i:e(u,1)["$=="]((s=l.$length(),c=1,"number"==typeof s&&"number"==typeof c?s-c:s["$-"](c))))?"":l["$[]"](t.Range.$new(e(u,1),-1,!1)))},p.$$arity=1),t.def(r,"$exist?",d=function(e){return null!=t.modules[e]},d.$$arity=1),t.alias(r,"exists?","exist?"),t.def(r,"$directory?",_=function(e){var r,s=n;for(var a in s=[],t.modules)s.push(a);return e=e.$gsub(new RegExp("(^."+i(g,"SEPARATOR")+"+|"+i(g,"SEPARATOR")+"+$)")),c(s,"find",[],((r=function(t){r.$$s;return null==t&&(t=n),t["$=~"](new RegExp("^"+e))}).$$s=this,r.$$arity=1,r))},_.$$arity=1),t.def(r,"$join",m=function(r){var s,o,l,u,f=n;return s=t.slice.call(arguments,0,arguments.length),a((o=s)["$empty?"]())?"":(f="",o=c(o.$flatten().$each_with_index(),"map",[],((l=function(t,r){l.$$s;return null==t&&(t=n),null==r&&(r=n),a(r["$=="](0)?t["$empty?"]():r["$=="](0))?i(g,"SEPARATOR"):a(o.$length()["$=="](e(r,1))?t["$empty?"]():o.$length()["$=="](e(r,1)))?i(g,"SEPARATOR"):t}).$$s=this,l.$$arity=2,l)),o=c(o,"reject",[],"empty?".$to_proc()),c(o,"each_with_index",[],((u=function(t,r){u.$$s;var s,c=n;return null==t&&(t=n),null==r&&(r=n),c=o["$[]"](e(r,1)),a(c["$nil?"]())?f=""+f+t:(a(a(s=t["$end_with?"](i(g,"SEPARATOR")))?c["$start_with?"](i(g,"SEPARATOR")):s)&&(t=t.$sub(new RegExp(i(g,"SEPARATOR")+"+$"),"")),f=a(a(s=t["$end_with?"](i(g,"SEPARATOR")))?s:c["$start_with?"](i(g,"SEPARATOR")))?""+f+t:""+f+t+i(g,"SEPARATOR"))}).$$s=this,u.$$arity=2,u)),f)},m.$$arity=-1),t.def(r,"$split",y=function(t){return t.$split(i(g,"SEPARATOR"))},y.$$arity=1),n&&"split"}(t.get_singleton_class(f),$)}(r[0],i(r,"IO"),r)},Opal.modules["corelib/process"]=function(t){t.top;var e=[],r=t.nil,n=t.const_get_qualified,i=t.const_get_relative,s=(t.breaker,t.slice,t.klass),a=t.truthy;return t.add_stubs(["$const_set","$size","$<<","$__register_clock__","$to_f","$now","$new","$[]","$raise"]),function(e,o,c){var l,u,f,$,h=s(e,null,"Process"),p=[h].concat(c),d=r;if(h.__clocks__=[],t.defs(h,"$__register_clock__",l=function(t,e){return null==this.__clocks__&&(this.__clocks__=r),this.$const_set(t,this.__clocks__.$size()),this.__clocks__["$<<"](e)},l.$$arity=2),h.$__register_clock__("CLOCK_REALTIME",function(){return Date.now()}),d=!1,t.global.performance)d=function(){return performance.now()};else if(t.global.process&&process.hrtime){var _=process.hrtime();d=function(){var t=process.hrtime(_),e=t[1]/1e3|0;return 1e3*t[0]+e/1e3}}a(d)&&h.$__register_clock__("CLOCK_MONOTONIC",d),t.defs(h,"$pid",u=function(){return 0},u.$$arity=0),t.defs(h,"$times",f=function(){var t;return t=i(p,"Time").$now().$to_f(),n(i(p,"Benchmark"),"Tms").$new(t,t,t,t,t)},f.$$arity=0),t.defs(h,"$clock_gettime",$=function(t,e){var s=r;null==this.__clocks__&&(this.__clocks__=r),null==e&&(e="float_second"),a(s=this.__clocks__["$[]"](t))||this.$raise(n(i(p,"Errno"),"EINVAL"),"clock_gettime("+t+") "+this.__clocks__["$[]"](t));var o=s();switch(e){case"float_second":return o/1e3;case"float_millisecond":return o/1;case"float_microsecond":return 1e3*o;case"second":return o/1e3|0;case"millisecond":return o/1|0;case"microsecond":return 1e3*o|0;case"nanosecond":return 1e6*o|0;default:this.$raise(i(p,"ArgumentError"),"unexpected unit: "+e)}},$.$$arity=-2)}(e[0],0,e),function(e,n,i){var a,o=s(e,null,"Signal");[o].concat(i);t.defs(o,"$trap",a=function(e){return t.slice.call(arguments,0,arguments.length),r},a.$$arity=-1)}(e[0],0,e),function(e,n,i){var a,o=s(e,null,"GC");[o].concat(i);return t.defs(o,"$start",a=function(){return r},a.$$arity=0),r&&"start"}(e[0],0,e)},Opal.modules["corelib/random"]=function(t){t.top;var e=[],r=t.nil,n=(t.const_get_qualified,t.const_get_relative),i=(t.breaker,t.slice,t.klass),s=t.truthy,a=t.send;return t.add_stubs(["$attr_reader","$new_seed","$coerce_to!","$reseed","$rand","$seed","$<","$raise","$encode","$join","$new","$chr","$===","$==","$state","$const_defined?","$const_set"]),function(e,o,c){var l,u,f,$,h,p,d,_,m,y,g=i(e,null,"Random"),v=[g].concat(c);return g.$attr_reader("seed","state"),t.def(g,"$initialize",l=function(t){return null==t&&(t=n(v,"Random").$new_seed()),t=n(v,"Opal")["$coerce_to!"](t,n(v,"Integer"),"to_int"),this.state=t,this.$reseed(t)},l.$$arity=-1),t.def(g,"$reseed",u=function(e){return this.seed=e,this.$rng=t.$$rand.reseed(e)},u.$$arity=1),t.defs(g,"$new_seed",f=function(){return t.$$rand.new_seed()},f.$$arity=0),t.defs(g,"$rand",$=function(t){return n(v,"DEFAULT").$rand(t)},$.$$arity=-1),t.defs(g,"$srand",h=function(t){var e;return null==t&&(t=n(v,"Random").$new_seed()),t=n(v,"Opal")["$coerce_to!"](t,n(v,"Integer"),"to_int"),e=n(v,"DEFAULT").$seed(),n(v,"DEFAULT").$reseed(t),e},h.$$arity=-1),t.defs(g,"$urandom",p=function(t){var e,r,i;return t=n(v,"Opal")["$coerce_to!"](t,n(v,"Integer"),"to_int"),s((i=0,"number"==typeof(r=t)&&"number"==typeof i?r<i:r["$<"](i)))&&this.$raise(n(v,"ArgumentError"),"negative string size (or size too big)"),a(n(v,"Array"),"new",[t],(e=function(){return(e.$$s||this).$rand(255).$chr()},e.$$s=this,e.$$arity=0,e)).$join().$encode("ASCII-8BIT")},p.$$arity=1),t.def(g,"$==",d=function(t){return!!s(n(v,"Random")["$==="](t))&&(this.$seed()["$=="](t.$seed())?this.$state()["$=="](t.$state()):this.$seed()["$=="](t.$seed()))},d.$$arity=1),t.def(g,"$bytes",_=function(t){var e;return t=n(v,"Opal")["$coerce_to!"](t,n(v,"Integer"),"to_int"),a(n(v,"Array"),"new",[t],(e=function(){return(e.$$s||this).$rand(255).$chr()},e.$$s=this,e.$$arity=0,e)).$join().$encode("ASCII-8BIT")},_.$$arity=1),t.def(g,"$rand",m=function(e){var i=this;function s(){return i.state++,t.$$rand.rand(i.$rng)}function a(){return Math.floor(s()*e)}return null==e?s():e.$$is_range?function(){var t=e.begin,n=e.end;if(t===r||n===r)return r;var s=n-t;return s<0?r:0===s?t:(n%1!=0||t%1!=0||e.excl||s++,i.$rand(s)+t)}():e.$$is_number?(e<=0&&i.$raise(n(v,"ArgumentError"),"invalid argument - "+e),e%1==0?a():s()*e):((e=n(v,"Opal")["$coerce_to!"](e,n(v,"Integer"),"to_int"))<=0&&i.$raise(n(v,"ArgumentError"),"invalid argument - "+e),a())},m.$$arity=-1),t.defs(g,"$generator=",y=function(e){return t.$$rand=e,s(this["$const_defined?"]("DEFAULT"))?n(v,"DEFAULT").$reseed():this.$const_set("DEFAULT",this.$new(this.$new_seed()))},y.$$arity=1),r&&"generator="}(e[0],0,e)};var MersenneTwister=function(){var t=624,e=397,r=function(t,e){return function(t,e){return 2147483648&t|2147483647&e}(t,e)>>>1^(1&e?2567483615:0)};function n(n){var i;return--n.left<=0&&function(n){var i,s=0,a=n.state;for(n.left=t,n.next=0,i=t-e+1;--i;s++)a[s]=a[s+e]^r(a[s+0],a[s+1]);for(i=e;--i;s++)a[s]=a[s+(e-t)]^r(a[s+0],a[s+1]);a[s]=a[s+(e-t)]^r(a[s+0],a[0])}(n),i=n.state[n.next++],i^=i>>>11,i^=i<<7&2636928640,i^=i<<15&4022730752,(i^=i>>>18)>>>0}return{genrand_real:function(t){return function(t,e){return(67108864*(t>>>=5)+(e>>>=6))*(1/9007199254740992)}(n(t),n(t))},init:function(e){var r={left:0,next:t,state:new Array(t)};return function(e,r){var n;for(e.state[0]=r>>>0,n=1;n<t;n++)e.state[n]=1812433253*(e.state[n-1]^e.state[n-1]>>30>>>0)+n,e.state[n]&=4294967295;e.left=1,e.next=t}(r,e),r}}}();if(Opal.loaded(["corelib/random/MersenneTwister.js"]),Opal.modules["corelib/random/mersenne_twister"]=function(t){var e=t.top,r=[],n=(t.nil,t.const_get_qualified,t.const_get_relative),i=(t.breaker,t.slice,t.klass),s=t.send;return t.add_stubs(["$require","$generator=","$-"]),e.$require("corelib/random/MersenneTwister"),function(e,r,a){var o,c,l,u=i(e,null,"Random"),f=[u].concat(a),$=Number.MAX_SAFE_INTEGER||Math.pow(2,53)-1;return t.const_set(f[0],"MERSENNE_TWISTER_GENERATOR",{new_seed:function(){return Math.round(Math.random()*$)},reseed:function(t){return MersenneTwister.init(t)},rand:function(t){return MersenneTwister.genrand_real(t)}}),o=[n(f,"MERSENNE_TWISTER_GENERATOR")],s(u,"generator=",t.to_a(o)),o[(c=o.length,l=1,"number"==typeof c&&"number"==typeof l?c-l:c["$-"](l))]}(r[0],0,r)},Opal.modules["corelib/unsupported"]=function(t){var e,r,n=t.top,i=[],s=t.nil,a=(t.const_get_qualified,t.const_get_relative),o=(t.breaker,t.slice,t.klass),c=t.module;t.add_stubs(["$raise","$warn","$%"]);var l={};function u(e){switch(t.config.unsupported_features_severity){case"error":a(i,"Kernel").$raise(a(i,"NotImplementedError"),e);break;case"warning":!function(t){if(l[t])return;l[t]=!0,n.$warn(t)}(e)}}return function(e,r,n){var i,s,c,l,u,f,$,h,p,d,_,m,y,g,v,b,A,x,w,k,E,S,N,I=o(e,null,"String"),C=[I].concat(n),O="String#%s not supported. Mutable String methods are not supported in Opal.";t.def(I,"$<<",i=function(e){return t.slice.call(arguments,0,arguments.length),this.$raise(a(C,"NotImplementedError"),O["$%"]("<<"))},i.$$arity=-1),t.def(I,"$capitalize!",s=function(e){return t.slice.call(arguments,0,arguments.length),this.$raise(a(C,"NotImplementedError"),O["$%"]("capitalize!"))},s.$$arity=-1),t.def(I,"$chomp!",c=function(e){return t.slice.call(arguments,0,arguments.length),this.$raise(a(C,"NotImplementedError"),O["$%"]("chomp!"))},c.$$arity=-1),t.def(I,"$chop!",l=function(e){return t.slice.call(arguments,0,arguments.length),this.$raise(a(C,"NotImplementedError"),O["$%"]("chop!"))},l.$$arity=-1),t.def(I,"$downcase!",u=function(e){return t.slice.call(arguments,0,arguments.length),this.$raise(a(C,"NotImplementedError"),O["$%"]("downcase!"))},u.$$arity=-1),t.def(I,"$gsub!",f=function(e){return t.slice.call(arguments,0,arguments.length),this.$raise(a(C,"NotImplementedError"),O["$%"]("gsub!"))},f.$$arity=-1),t.def(I,"$lstrip!",$=function(e){return t.slice.call(arguments,0,arguments.length),this.$raise(a(C,"NotImplementedError"),O["$%"]("lstrip!"))},$.$$arity=-1),t.def(I,"$next!",h=function(e){return t.slice.call(arguments,0,arguments.length),this.$raise(a(C,"NotImplementedError"),O["$%"]("next!"))},h.$$arity=-1),t.def(I,"$reverse!",p=function(e){return t.slice.call(arguments,0,arguments.length),this.$raise(a(C,"NotImplementedError"),O["$%"]("reverse!"))},p.$$arity=-1),t.def(I,"$slice!",d=function(e){return t.slice.call(arguments,0,arguments.length),this.$raise(a(C,"NotImplementedError"),O["$%"]("slice!"))},d.$$arity=-1),t.def(I,"$squeeze!",_=function(e){return t.slice.call(arguments,0,arguments.length),this.$raise(a(C,"NotImplementedError"),O["$%"]("squeeze!"))},_.$$arity=-1),t.def(I,"$strip!",m=function(e){return t.slice.call(arguments,0,arguments.length),this.$raise(a(C,"NotImplementedError"),O["$%"]("strip!"))},m.$$arity=-1),t.def(I,"$sub!",y=function(e){return t.slice.call(arguments,0,arguments.length),this.$raise(a(C,"NotImplementedError"),O["$%"]("sub!"))},y.$$arity=-1),t.def(I,"$succ!",g=function(e){return t.slice.call(arguments,0,arguments.length),this.$raise(a(C,"NotImplementedError"),O["$%"]("succ!"))},g.$$arity=-1),t.def(I,"$swapcase!",v=function(e){return t.slice.call(arguments,0,arguments.length),this.$raise(a(C,"NotImplementedError"),O["$%"]("swapcase!"))},v.$$arity=-1),t.def(I,"$tr!",b=function(e){return t.slice.call(arguments,0,arguments.length),this.$raise(a(C,"NotImplementedError"),O["$%"]("tr!"))},b.$$arity=-1),t.def(I,"$tr_s!",A=function(e){return t.slice.call(arguments,0,arguments.length),this.$raise(a(C,"NotImplementedError"),O["$%"]("tr_s!"))},A.$$arity=-1),t.def(I,"$upcase!",x=function(e){return t.slice.call(arguments,0,arguments.length),this.$raise(a(C,"NotImplementedError"),O["$%"]("upcase!"))},x.$$arity=-1),t.def(I,"$prepend",w=function(e){return t.slice.call(arguments,0,arguments.length),this.$raise(a(C,"NotImplementedError"),O["$%"]("prepend"))},w.$$arity=-1),t.def(I,"$[]=",k=function(e){return t.slice.call(arguments,0,arguments.length),this.$raise(a(C,"NotImplementedError"),O["$%"]("[]="))},k.$$arity=-1),t.def(I,"$clear",E=function(e){return t.slice.call(arguments,0,arguments.length),this.$raise(a(C,"NotImplementedError"),O["$%"]("clear"))},E.$$arity=-1),t.def(I,"$encode!",S=function(e){return t.slice.call(arguments,0,arguments.length),this.$raise(a(C,"NotImplementedError"),O["$%"]("encode!"))},S.$$arity=-1),t.def(I,"$unicode_normalize!",N=function(e){return t.slice.call(arguments,0,arguments.length),this.$raise(a(C,"NotImplementedError"),O["$%"]("unicode_normalize!"))},N.$$arity=-1)}(i[0],0,i),function(e,r){var n,i,s=c(e,"Kernel"),a=([s].concat(r),"Object freezing is not supported by Opal");t.def(s,"$freeze",n=function(){return u(a),this},n.$$arity=0),t.def(s,"$frozen?",i=function(){return u(a),!1},i.$$arity=0)}(i[0],i),function(e,r){var n,i,s,a=c(e,"Kernel"),o=([a].concat(r),"Object tainting is not supported by Opal");t.def(a,"$taint",n=function(){return u(o),this},n.$$arity=0),t.def(a,"$untaint",i=function(){return u(o),this},i.$$arity=0),t.def(a,"$tainted?",s=function(){return u(o),!1},s.$$arity=0)}(i[0],i),function(e,r,n){var i,a,c,l,u=o(e,null,"Module");[u].concat(n);t.def(u,"$public",i=function(e){return 0===t.slice.call(arguments,0,arguments.length).length&&(this.$$module_function=!1),s},i.$$arity=-1),t.alias(u,"private","public"),t.alias(u,"protected","public"),t.alias(u,"nesting","public"),t.def(u,"$private_class_method",a=function(e){return t.slice.call(arguments,0,arguments.length),this},a.$$arity=-1),t.alias(u,"public_class_method","private_class_method"),t.def(u,"$private_method_defined?",c=function(t){return!1},c.$$arity=1),t.def(u,"$private_constant",l=function(e){return t.slice.call(arguments,0,arguments.length),s},l.$$arity=-1),t.alias(u,"protected_method_defined?","private_method_defined?"),t.alias(u,"public_instance_methods","instance_methods"),t.alias(u,"public_instance_method","instance_method"),t.alias(u,"public_method_defined?","method_defined?")}(i[0],0,i),function(e,r){var n,i=c(e,"Kernel");[i].concat(r);t.def(i,"$private_methods",n=function(e){return t.slice.call(arguments,0,arguments.length),[]},n.$$arity=-1),t.alias(i,"private_instance_methods","private_methods")}(i[0],i),function(e,r){var n,i=c(e,"Kernel"),s=[i].concat(r);t.def(i,"$eval",n=function(e){return t.slice.call(arguments,0,arguments.length),this.$raise(a(s,"NotImplementedError"),"To use Kernel#eval, you must first require 'opal-parser'. See https://github.com/opal/opal/blob/"+a(s,"RUBY_ENGINE_VERSION")+"/docs/opal_parser.md for details.")},n.$$arity=-1)}(i[0],i),t.defs(n,"$public",e=function(e){return t.slice.call(arguments,0,arguments.length),s},e.$$arity=-1),t.defs(n,"$private",r=function(e){return t.slice.call(arguments,0,arguments.length),s},r.$$arity=-1),s&&"private"},Opal.modules.opal=function(t){var e=t.top;t.nil,t.const_get_qualified,t.const_get_relative,t.breaker,t.slice;return t.add_stubs(["$require"]),e.$require("opal/base"),e.$require("opal/mini"),e.$require("corelib/kernel/format"),e.$require("corelib/string/encoding"),e.$require("corelib/math"),e.$require("corelib/complex"),e.$require("corelib/rational"),e.$require("corelib/time"),e.$require("corelib/struct"),e.$require("corelib/io"),e.$require("corelib/main"),e.$require("corelib/dir"),e.$require("corelib/file"),e.$require("corelib/process"),e.$require("corelib/random"),e.$require("corelib/random/mersenne_twister.js"),e.$require("corelib/unsupported")},Opal.modules["opal-platform"]=function(t){t.top;var e,r,n,i=t.nil,s=(t.const_get_qualified,t.const_get_relative,t.breaker,t.slice,t.truthy);return"undefined"!=typeof document,e="undefined"!=typeof process&&process.versions&&process.versions.node,r="undefined"!=typeof Java&&Java.type,n="undefined"!=typeof navigator&&/\bHeadlessChrome\//.test(navigator.userAgent),t.const_set([][0],"OPAL_PLATFORM",s(r)?"nashorn":s(e)?"nodejs":s(n)?"headless-chrome":i)},Opal.modules["nodejs/kernel"]=function(t){t.top;var e=[],r=(t.nil,t.const_get_qualified,t.const_get_relative),n=(t.breaker,t.slice,t.module);return t.add_stubs(["$warn","$to_str"]),t.exit=process.exit,function(e,i){var s,a,o=n(e,"Kernel"),c=[o].concat(i);t.const_set(c[0],"NODE_REQUIRE",require),t.def(o,"$caller",s=function(e){var r;t.slice.call(arguments,0,arguments.length);try{throw Error("my error")}catch(t){r=t.stack}return r.$split("\n").slice(3)},s.$$arity=-1),t.def(o,"$node_require",a=function(t){return this.$warn("[DEPRECATION] node_require is deprecated. Please use `require('module')` instead."),r(c,"NODE_REQUIRE")(t.$to_str())},a.$$arity=1)}(e[0],e),t.const_set(e[0],"ARGV",process.argv.slice(2))},Opal.modules["nodejs/file"]=function(t){var e=t.top,r=[],n=t.nil,i=t.const_get_qualified,s=t.const_get_relative,a=(t.breaker,t.slice,t.klass),o=t.truthy,c=t.gvars;t.add_stubs(["$raise","$warn","$const_get","$new","$const_defined?","$const_set","$include","$size","$respond_to?","$path","$join","$call","$exist?","$realpath","$!=","$close","$to_path","$pwd","$to_str","$include?","$delete","$match?","$sub","$attr_reader","$to_a","$each_line","$to_enum","$read","$chomp"]);var l,u={},f=["EACCES","EISDIR","EMFILE","ENOENT","EPERM"];function $(n){switch(t.config.unsupported_features_severity){case"error":s(r,"Kernel").$raise(s(r,"NotImplementedError"),n);break;case"warning":!function(t){if(u[t])return;u[t]=!0,e.$warn(t)}(n)}}function h(t){try{return t()}catch(t){if(f.indexOf(t.code)>=0)throw s(r,"Errno").$const_get(t.code).$new(t.message);throw t}}for(var p=0,d=f.length;p<d;p++)l=f[p],s(r,"Errno")["$const_defined?"](l)||s(r,"Errno").$const_set(l,s(r,"Class").$new(s(r,"SystemCallError")));return function(e,r,l){var u,f,p,d,_,m,y,g,v,b,A,x,w,k,E,S,N,I,C,O,B,M,P=a(e,r,"File"),F=[P].concat(l);null==P.__fs__&&(P.__fs__=n),null==P.__path__&&(P.__path__=n),null==P.__util__&&(P.__util__=n),P.$$prototype.eof=P.$$prototype.binary_flag=P.$$prototype.path=P.$$prototype.fd=n,P.$include(i(i("::","IO"),"Writable")),P.$include(i(i("::","IO"),"Readable")),P.__fs__=require("fs"),P.__path__=require("path"),P.__util__=require("util");var L=P.__fs__,T=P.__path__,j=P.__util__,R="undefined"!=typeof TextEncoder?TextEncoder:j.TextEncoder,D=new("undefined"!=typeof TextDecoder?TextDecoder:j.TextDecoder)("utf8"),z=new R;o(T.sep!==s(F,"Separator"))&&t.const_set(F[0],"ALT_SEPARATOR",T.sep),t.defs(P,"$read",u=function(t){return h(function(){return L.readFileSync(t).toString()})},u.$$arity=1),t.defs(P,"$write",f=function(t,e){return h(function(){return L.writeFileSync(t,e)}),e.$size()},f.$$arity=2),t.defs(P,"$exist?",p=function(t){return o(t["$respond_to?"]("path"))&&(t=t.$path()),h(function(){return L.existsSync(t)})},p.$$arity=1),t.defs(P,"$realpath",d=function(e,r,i){var s=d.$$p,a=s||n;if(s&&(d.$$p=null),s&&(d.$$p=null),null==r&&(r=n),null==i&&(i=n),o(r)&&(e=this.$join(r,e)),a===n)return h(function(){return L.realpathSync(e,i)});L.realpath(e,i,function(e,r){e?t.IOError.$new(e.message):a.$call(r)})},d.$$arity=-2),t.defs(P,"$join",_=function(e){var r;return r=t.slice.call(arguments,0,arguments.length),T.posix.join.apply(T,r)},_.$$arity=-1),t.defs(P,"$directory?",m=function(t){var e=n,r=n;return!!o(this["$exist?"](t))&&(e=h(function(){return!!L.lstatSync(t).isDirectory()}),o(e)||(r=this.$realpath(t),o(r["$!="](t))&&(e=h(function(){return!!L.lstatSync(r).isDirectory()}))),e)},m.$$arity=1),t.defs(P,"$file?",y=function(t){var e=n,r=n;return!!o(this["$exist?"](t))&&(e=h(function(){return!!L.lstatSync(t).isFile()}),o(e)||(r=this.$realpath(t),o(r["$!="](t))&&(e=h(function(){return!!L.lstatSync(r).isFile()}))),e)},y.$$arity=1),t.defs(P,"$readable?",g=function(t){return!!o(this["$exist?"](t))&&"\n        try {\n          __fs__.accessSync(path, __fs__.R_OK);\n          return true;\n        } catch (error) {\n          return false;\n        }\n      "},g.$$arity=1),t.defs(P,"$size",v=function(t){return h(function(){return L.lstatSync(t).size})},v.$$arity=1),t.defs(P,"$open",b=function(e,r){var i=b.$$p,s=i||n,a=n;return i&&(b.$$p=null),null==r&&(r="r"),a=this.$new(e,r),s!==n?function(){try{return t.yield1(s,a)}finally{a.$close()}}():a},b.$$arity=-2),t.defs(P,"$stat",A=function(t){return o(t["$respond_to?"]("path"))&&(t=t.$path()),i(s(F,"File"),"Stat").$new(t)},A.$$arity=1),t.defs(P,"$mtime",x=function(t){return h(function(){return L.statSync(t).mtime})},x.$$arity=1),t.defs(P,"$symlink?",w=function(t){return h(function(){return L.lstatSync(t).isSymbolicLink()})},w.$$arity=1),t.defs(P,"$absolute_path",k=function(t,e){var r;return null==e&&(e=n),t=o(t["$respond_to?"]("to_path"))?t.$to_path():t,e=o(r=e)?r:s(F,"Dir").$pwd(),T.normalize(T.resolve(e.$to_str(),t.$to_str())).split(T.sep).join(T.posix.sep)},k.$$arity=-2),t.def(P,"$initialize",E=function(t,e){var r=n;return null==e&&(e="r"),this.binary_flag=e["$include?"]("b"),e=e.$delete("b"),o((r=/:(.*)/)["$match?"](e))&&($("Encoding option (:encoding) is unsupported by Node.js openSync method and will be removed."),e=e.$sub(r,"")),this.path=t,this.flags=e,this.fd=h(function(){return L.openSync(t,e)})},E.$$arity=-2),P.$attr_reader("path"),t.def(P,"$read",S=function(){var t=this,e=n;if(o(t.eof))return"";if(o(t.binary_flag)){var r=h(function(){return L.readFileSync(t.path)});e=function(t){for(var e=0;e<t.length;)if(9===t[e]||10===t[e]||13===t[e]||32<=t[e]&&t[e]<=126)e+=1;else if(194<=t[e]&&t[e]<=223&&128<=t[e+1]&&t[e+1]<=191)e+=2;else if(224===t[e]&&160<=t[e+1]&&t[e+1]<=191&&128<=t[e+2]&&t[e+2]<=191||(225<=t[e]&&t[e]<=236||238===t[e]||239===t[e])&&128<=t[e+1]&&t[e+1]<=191&&128<=t[e+2]&&t[e+2]<=191||237===t[e]&&128<=t[e+1]&&t[e+1]<=159&&128<=t[e+2]&&t[e+2]<=191)e+=3;else{if(!(240===t[e]&&144<=t[e+1]&&t[e+1]<=191&&128<=t[e+2]&&t[e+2]<=191&&128<=t[e+3]&&t[e+3]<=191||241<=t[e]&&t[e]<=243&&128<=t[e+1]&&t[e+1]<=191&&128<=t[e+2]&&t[e+2]<=191&&128<=t[e+3]&&t[e+3]<=191||244===t[e]&&128<=t[e+1]&&t[e+1]<=143&&128<=t[e+2]&&t[e+2]<=191&&128<=t[e+3]&&t[e+3]<=191))return!1;e+=4}return!0}(r)?r.toString("utf8"):D.decode(z.encode(r.toString("binary")))}else e=h(function(){return L.readFileSync(t.path).toString("utf8")});return t.eof=!0,t.lineno=e.$size(),e},S.$$arity=0),t.def(P,"$readlines",N=function(t){return null==c["/"]&&(c["/"]=n),null==t&&(t=c["/"]),this.$each_line(t).$to_a()},N.$$arity=-1),t.def(P,"$each_line",I=function(e){var r=I.$$p,i=r||n,a=this,l=n;if(null==c["/"]&&(c["/"]=n),r&&(I.$$p=null),r&&(I.$$p=null),null==e&&(e=c["/"]),o(a.eof))return i!==n?a:[].$to_enum();if(i!==n){l=s(F,"File").$read(a.path),a.eof=!1,a.lineno=0;for(var u=l.$chomp(),f=l.length!=u.length,$=u.split(e),h=0,p=$.length;h<p;h++)a.lineno+=1,h<p-1||f?t.yield1(i,$[h]+e):t.yield1(i,$[h]);return a.eof=!0,a}return a.$read().$each_line(e)},I.$$arity=-1),t.def(P,"$write",C=function(t){var e=this;return h(function(){return L.writeSync(e.fd,t)})},C.$$arity=1),t.def(P,"$flush",O=function(){var t=this;return h(function(){return L.fsyncSync(t.fd)})},O.$$arity=0),t.def(P,"$close",B=function(){var t=this;return h(function(){return L.closeSync(t.fd)})},B.$$arity=0),t.def(P,"$mtime",M=function(){var t=this;return h(function(){return L.statSync(t.path).mtime})},M.$$arity=0)}(r[0],s(r,"IO"),r),function(e,r,i){var s,o,c,l=a(e,null,"Stat");[l].concat(i);null==l.__fs__&&(l.__fs__=n),l.$$prototype.path=n,l.__fs__=require("fs");var u=l.__fs__;return t.def(l,"$initialize",s=function(t){return this.path=t},s.$$arity=1),t.def(l,"$file?",o=function(){var t=this;return h(function(){return u.statSync(t.path).isFile()})},o.$$arity=0),t.def(l,"$mtime",c=function(){var t=this;return h(function(){return u.statSync(t.path).mtime})},c.$$arity=0),n&&"mtime"}(s(r,"File"),0,r)},Opal.modules["nodejs/dir"]=function(t){t.top;var e=[],r=t.nil,n=(t.const_get_qualified,t.const_get_relative),i=(t.breaker,t.slice,t.klass),s=t.truthy,a=t.send;return t.add_stubs(["$respond_to?","$flat_map","$to_path","$coerce_to!"]),function(e,o,c){var l=i(e,null,"Dir"),u=[l].concat(c);null==l.__glob__&&(l.__glob__=r),null==l.__fs__&&(l.__fs__=r),null==l.__path__&&(l.__path__=r),null==l.__os__&&(l.__os__=r),l.__glob__=require("glob"),l.__fs__=require("fs"),l.__path__=require("path"),l.__os__=require("os");var f=l.__glob__,$=l.__fs__,h=l.__path__,p=l.__os__;return function(e,i){var o,c,l,u,d,_,m,y=[e].concat(i);return t.def(e,"$[]",o=function(t){return f.sync(t)},o.$$arity=1),t.def(e,"$pwd",c=function(){return process.cwd().split(h.sep).join(h.posix.sep)},c.$$arity=0),t.def(e,"$home",l=function(){return p.homedir()},l.$$arity=0),t.def(e,"$chdir",u=function(t){return process.chdir(t)},u.$$arity=1),t.def(e,"$mkdir",d=function(t){return $.mkdirSync(t)},d.$$arity=1),t.def(e,"$entries",_=function(t){for(var e=[],r=$.readdirSync(t),n=0,i=r.length;n<i;n++)e.push(r[n]);return e},_.$$arity=1),t.def(e,"$glob",m=function(t){var e;return s(t["$respond_to?"]("each"))||(t=[t]),a(t,"flat_map",[],((e=function(t){e.$$s;return null==t&&(t=r),s(t["$respond_to?"]("to_path"))&&(t=t.$to_path()),t=n(y,"Opal")["$coerce_to!"](t,n(y,"String"),"to_str"),f.sync(t)}).$$s=this,e.$$arity=1,e))},m.$$arity=1),t.alias(e,"getwd","pwd")}(t.get_singleton_class(l),u)}(e[0],0,e)},Opal.modules["nodejs/io"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}var r,n,i=t.top,s=[],a=t.nil,o=(t.const_get_qualified,t.const_get_relative),c=(t.breaker,t.slice,t.klass),l=t.lambda,u=t.send,f=a;return t.add_stubs(["$attr_reader","$write","$read","$write_proc=","$-","$tty="]),function(e,r,n){var i,s,l,u,f=c(e,null,"IO"),$=[f].concat(n);null==f.__fs__&&(f.__fs__=a),f.__fs__=require("fs");var h=f.__fs__;f.$attr_reader("eof"),f.$attr_reader("lineno"),t.def(f,"$initialize",i=function(){return this.eof=!1,this.lineno=0},i.$$arity=0),t.defs(f,"$write",s=function(t,e){return o($,"File").$write(t,e)},s.$$arity=2),t.defs(f,"$read",l=function(t){return o($,"File").$read(t)},l.$$arity=1),t.defs(f,"$binread",u=function(e){return function(e){try{return e()}catch(e){if("EACCES"===e.code||"EISDIR"===e.code||"EMFILE"===e.code||"ENOENT"===e.code||"EPERM"===e.code)throw t.IOError.$new(e.message);throw e}}(function(){return h.readFileSync(e).toString("binary")})},u.$$arity=1)}(s[0],0,s),f=[l((r=function(t){r.$$s;return null==t&&(t=a),process.stdout.write(t)},r.$$s=i,r.$$arity=1,r))],u(o(s,"STDOUT"),"write_proc=",t.to_a(f)),f[e(f.length,1)],f=[l((n=function(t){n.$$s;return null==t&&(t=a),process.stderr.write(t)},n.$$s=i,n.$$arity=1,n))],u(o(s,"STDERR"),"write_proc=",t.to_a(f)),f[e(f.length,1)],f=[!0],u(o(s,"STDOUT"),"tty=",t.to_a(f)),f[e(f.length,1)],f=[!0],u(o(s,"STDERR"),"tty=",t.to_a(f)),f[e(f.length,1)]},Opal.modules["nodejs/open-uri"]=function(t){t.top;var e=[],r=t.nil,n=(t.const_get_qualified,t.const_get_relative,t.breaker,t.slice,t.module);return function(e,i){var s,a,o=n(e,"OpenURI");[o].concat(i);null==o.__xmlhttprequest__&&(o.__xmlhttprequest__=r),o.__xmlhttprequest__=require("unxhr");var c=o.__xmlhttprequest__.XMLHttpRequest;t.defs(o,"$request",s=function(t){var e=new c;return e.open("GET",t,!1),e.responseType="arraybuffer",e.send(),e},s.$$arity=1),t.defs(o,"$data",a=function(t){for(var e=t.response,r=new Uint8Array(e),n=[],i=0;i<r.byteLength;i++)n.push(r[i]);return n},a.$$arity=1)}(e[0],e)},Opal.modules.pathname=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}var r=t.top,n=[],i=t.nil,s=t.const_get_qualified,a=t.const_get_relative,o=(t.breaker,t.slice,t.klass),c=t.truthy,l=t.send,u=t.module;return t.add_stubs(["$require","$include","$quote","$===","$to_s","$path","$respond_to?","$to_path","$is_a?","$nil?","$raise","$class","$==","$attr_reader","$!","$relative?","$chop_basename","$basename","$=~","$new","$source","$[]","$rindex","$sub","$absolute?","$expand_path","$plus","$unshift","$length","$!=","$empty?","$first","$shift","$+","$join","$dirname","$pop","$reverse_each","$directory?","$extname","$<=>","$nonzero?","$proc","$casecmp","$cleanpath","$inspect","$include?","$fill","$map","$entries"]),r.$require("corelib/comparable"),function(r,n,u){var f,$,h,p,d,_,m,y,g,v,b,A,x,w,k,E,S,N,I,C,O,B,M,P,F,L=o(r,null,"Pathname"),T=[L].concat(u);L.$$prototype.path=i,L.$include(a(T,"Comparable")),t.const_set(T[0],"SEPARATOR_PAT",new RegExp(a(T,"Regexp").$quote(s(a(T,"File"),"SEPARATOR")))),t.def(L,"$initialize",f=function(t){return c(a(T,"Pathname")["$==="](t))?this.path=t.$path().$to_s():c(t["$respond_to?"]("to_path"))?this.path=t.$to_path():c(t["$is_a?"](a(T,"String")))?this.path=t:c(t["$nil?"]())?this.$raise(a(T,"TypeError"),"no implicit conversion of nil into String"):this.$raise(a(T,"TypeError"),"no implicit conversion of "+t.$class()+" into String"),this.path["$=="]("\0")?this.$raise(a(T,"ArgumentError")):i},f.$$arity=1),L.$attr_reader("path"),t.def(L,"$==",$=function(t){return t.$path()["$=="](this.path)},$.$$arity=1),t.def(L,"$absolute?",h=function(){return this["$relative?"]()["$!"]()},h.$$arity=0),t.def(L,"$relative?",p=function(){var e,r,n=i,s=i;for(n=this.path;c(s=this.$chop_basename(n));)r=s,n=null==(e=t.to_ary(r))[0]?i:e[0];return n["$=="]("")},p.$$arity=0),t.def(L,"$chop_basename",d=function(t){var e;return e=a(T,"File").$basename(t),c(a(T,"Regexp").$new("^"+s(a(T,"Pathname"),"SEPARATOR_PAT").$source()+"?$")["$=~"](e))?i:[t["$[]"](0,t.$rindex(e)),e]},d.$$arity=1),t.def(L,"$root?",_=function(){return this.path["$=="]("/")},_.$$arity=0),t.def(L,"$parent",m=function(){var t=this,e=i;return(e=t.path.$sub(/\/([^\/]+\/?$)/,""))["$=="]("")&&(e=c(t["$absolute?"]())?"/":"."),a(T,"Pathname").$new(e)},m.$$arity=0),t.def(L,"$sub",y=function(e){var r;return r=t.slice.call(arguments,0,arguments.length),a(T,"Pathname").$new(l(this.path,"sub",t.to_a(r)))},y.$$arity=-1),t.def(L,"$cleanpath",g=function(){return t.normalize(this.path)},g.$$arity=0),t.def(L,"$to_path",v=function(){return this.path},v.$$arity=0),t.def(L,"$hash",b=function(){return this.path},b.$$arity=0),t.def(L,"$expand_path",A=function(){return a(T,"Pathname").$new(a(T,"File").$expand_path(this.path))},A.$$arity=0),t.def(L,"$+",x=function(t){return c(a(T,"Pathname")["$==="](t))||(t=a(T,"Pathname").$new(t)),a(T,"Pathname").$new(this.$plus(this.path,t.$to_s()))},x.$$arity=1),t.def(L,"$plus",w=function(r,n){var s,o,l,u=i,f=i,$=i,h=i,p=i,d=i,_=i,m=i,y=i;for(u=n,f=[],$=[];c(h=this.$chop_basename(u));)l=h,u=null==(o=t.to_ary(l))[0]?i:o[0],p=null==o[1]?i:o[1],f.$unshift(u.$length()),$.$unshift(p);if(c(u["$!="]("")))return n;for(d=r;c(!0);){for(;c(c(l=$["$empty?"]()["$!"]())?$.$first()["$=="]("."):l);)f.$shift(),$.$shift();if(!c(_=this.$chop_basename(d)))break;if(l=_,d=null==(o=t.to_ary(l))[0]?i:o[0],!(m=null==o[1]?i:o[1])["$=="](".")){if(c(c(o=c(l=m["$=="](".."))?l:$["$empty?"]())?o:$.$first()["$!="](".."))){d=e(d,m);break}f.$shift(),$.$shift()}}if(_=this.$chop_basename(d),c(c(s=_["$!"]())?new RegExp(a(T,"SEPARATOR_PAT"))["$=~"](a(T,"File").$basename(d)):s))for(;c(c(o=$["$empty?"]()["$!"]())?$.$first()["$=="](".."):o);)f.$shift(),$.$shift();return c($["$empty?"]()["$!"]())?(y=n["$[]"](t.Range.$new(f.$first(),-1,!1)),c(_)?a(T,"File").$join(d,y):e(d,y)):c(_)?d:a(T,"File").$dirname(d)},w.$$arity=2),t.def(L,"$join",k=function(r){try{var n,s,o,u=i;return n=t.slice.call(arguments,0,arguments.length),c((s=n)["$empty?"]())?this:(u=s.$pop(),c(a(T,"Pathname")["$==="](u))||(u=a(T,"Pathname").$new(u)),c(u["$absolute?"]())?u:(l(s,"reverse_each",[],((o=function(r){o.$$s;if(null==r&&(r=i),c(a(T,"Pathname")["$==="](r))||(r=a(T,"Pathname").$new(r)),u=e(r,u),!c(u["$absolute?"]()))return i;t.ret(u)}).$$s=this,o.$$arity=1,o)),e(this,u)))}catch(e){if(e===t.returner)return e.$v;throw e}},k.$$arity=-1),t.def(L,"$split",E=function(){return[this.$dirname(),this.$basename()]},E.$$arity=0),t.def(L,"$dirname",S=function(){return a(T,"Pathname").$new(a(T,"File").$dirname(this.path))},S.$$arity=0),t.def(L,"$basename",N=function(){return a(T,"Pathname").$new(a(T,"File").$basename(this.path))},N.$$arity=0),t.def(L,"$directory?",I=function(){return a(T,"File")["$directory?"](this.path)},I.$$arity=0),t.def(L,"$extname",C=function(){return a(T,"File").$extname(this.path)},C.$$arity=0),t.def(L,"$<=>",O=function(t){return this.$path()["$<=>"](t.$path())},O.$$arity=1),t.alias(L,"eql?","=="),t.alias(L,"===","=="),t.alias(L,"to_str","to_path"),t.alias(L,"to_s","to_path"),t.const_set(T[0],"SAME_PATHS",c(s(a(T,"File"),"FNM_SYSCASE")["$nonzero?"]())?l(L,"proc",[],((B=function(t,e){return B.$$s,null==t&&(t=i),null==e&&(e=i),t.$casecmp(e)["$=="](0)}).$$s=L,B.$$arity=2,B)):l(L,"proc",[],((M=function(t,e){return M.$$s,null==t&&(t=i),null==e&&(e=i),t["$=="](e)}).$$s=L,M.$$arity=2,M))),t.def(L,"$relative_path_from",P=function(r){var n,s,o,u=i,f=i,$=i,h=i,p=i,d=i,_=i;for(o=this.$cleanpath().$to_s(),r=r.$cleanpath().$to_s(),u=o,f=[];c($=this.$chop_basename(u));)s=$,u=null==(n=t.to_ary(s))[0]?i:n[0],h=null==n[1]?i:n[1],c(h["$!="]("."))&&f.$unshift(h);for(p=r,d=[];c($=this.$chop_basename(p));)s=$,p=null==(n=t.to_ary(s))[0]?i:n[0],h=null==n[1]?i:n[1],c(h["$!="]("."))&&d.$unshift(h);for(c(a(T,"SAME_PATHS")["$[]"](u,p))||this.$raise(a(T,"ArgumentError"),"different prefix: "+u.$inspect()+" and "+r.$inspect());c(c(n=c(s=f["$empty?"]()["$!"]())?d["$empty?"]()["$!"]():s)?a(T,"SAME_PATHS")["$[]"](f.$first(),d.$first()):n);)f.$shift(),d.$shift();return c(d["$include?"](".."))&&this.$raise(a(T,"ArgumentError"),"base_directory has ..: "+r.$inspect()),d.$fill(".."),_=e(d,f),c(_["$empty?"]())?a(T,"Pathname").$new("."):a(T,"Pathname").$new(l(a(T,"File"),"join",t.to_a(_)))},P.$$arity=1),t.def(L,"$entries",F=function(){var t;return l(a(T,"Dir").$entries(this.path),"map",[],((t=function(e){var r=t.$$s||this;return null==e&&(e=i),r.$class().$new(e)}).$$s=this,t.$$arity=1,t))},F.$$arity=0)}(n[0],0,n),function(e,r){var n,i=u(e,"Kernel"),s=[i].concat(r);t.def(i,"$Pathname",n=function(t){return a(s,"Pathname").$new(t)},n.$$arity=1)}(n[0],n)},Opal.modules["nodejs/pathname"]=function(t){var e=t.top,r=[],n=t.nil,i=(t.const_get_qualified,t.const_get_relative),s=(t.breaker,t.slice,t.klass);return t.add_stubs(["$require","$include","$to_str","$!","$absolute?"]),e.$require("pathname"),function(e,r,a){var o,c,l,u=s(e,null,"Pathname"),f=[u].concat(a);null==u.__path__&&(u.__path__=n),u.$$prototype.path=n,u.$include(i(f,"Comparable")),u.__path__=require("path");var $=u.__path__;return t.def(u,"$absolute?",o=function(){return $.isAbsolute(this.path.$to_str())},o.$$arity=0),t.def(u,"$relative?",c=function(){return this["$absolute?"]()["$!"]()},c.$$arity=0),t.def(u,"$to_path",l=function(){return this.path},l.$$arity=0),n&&"to_path"}(r[0],0,r)},Opal.modules["nodejs/env"]=function(t){t.top;var e=[],r=t.nil,n=(t.const_get_qualified,t.const_get_relative);t.breaker,t.slice;return t.add_stubs(["$new","$to_s"]),t.const_set(e[0],"ENV",n(e,"Object").$new()),function(e,n){var i,s,a,o,c,l,u;[e].concat(n);return t.def(e,"$[]",i=function(t){return process.env[t]||r},i.$$arity=1),t.def(e,"$[]=",s=function(t,e){return process.env[t.$to_s()]=e.$to_s()},s.$$arity=2),t.def(e,"$key?",a=function(t){return process.env.hasOwnProperty(t)},a.$$arity=1),t.alias(e,"has_key?","key?"),t.alias(e,"include?","key?"),t.alias(e,"member?","key?"),t.def(e,"$empty?",o=function(){return 0===Object.keys(process.env).length},o.$$arity=0),t.def(e,"$keys",c=function(){return Object.keys(process.env)},c.$$arity=0),t.def(e,"$delete",l=function(t){var e=process.env[t]||r;return delete process.env[t],e},l.$$arity=1),t.def(e,"$to_s",u=function(){return"ENV"},u.$$arity=0),r&&"to_s"}(t.get_singleton_class(n(e,"ENV")),e)},Opal.modules.nodejs=function(t){var e,r=t.top,n=[],i=(t.nil,t.const_get_qualified,t.const_get_relative,t.breaker,t.slice,t.module);return t.add_stubs(["$require"]),e=n,[i(n[0],"NodeJS")].concat(e),r.$require("nodejs/kernel"),r.$require("nodejs/file"),r.$require("nodejs/dir"),r.$require("nodejs/io"),r.$require("nodejs/open-uri"),r.$require("nodejs/pathname"),r.$require("nodejs/env")},Opal.modules["nodejs/fileutils"]=function(t){t.top;var e=[],r=t.nil,n=(t.const_get_qualified,t.const_get_relative),i=(t.breaker,t.slice,t.module),s=t.truthy,a=t.send;return t.add_stubs(["$extend","$===","$raise","$each","$Array","$directory?","$join","$basename"]),function(e,o){var c,l,u,f,$,h=i(e,"FileUtils"),p=[h].concat(o);h.$extend(h);var d=n(p,"File").__fs__;t.def(h,"$chmod",c=function(t,e){var i;return s(n(p,"String")["$==="](t))&&this.$raise(n(p,"NotImplementedError"),"symbolic mode is not supported, use numeric mode"),a(this.$Array(e),"each",[],((i=function(e){i.$$s;return null==e&&(e=r),d.chmodSync(t,e)}).$$s=this,i.$$arity=1,i))},c.$$arity=2),t.def(h,"$cp",l=function(t,e){return s(n(p,"File")["$directory?"](e))&&(e=n(p,"File").$join(e,n(p,"File").$basename(t))),d.writeFileSync(e,d.readFileSync(t))},l.$$arity=2),t.def(h,"$rm",u=function(t){return d.unlinkSync(t)},u.$$arity=1),t.def(h,"$mkdir_p",f=function(t){return!!s(n(p,"File")["$directory?"](t))||d.mkdirSync(t)},f.$$arity=1),t.alias(h,"mkpath","mkdir_p"),t.alias(h,"makedirs","mkdir_p"),t.def(h,"$mv",$=function(t,e){return s(n(p,"File")["$directory?"](e))&&(e=n(p,"File").$join(e,n(p,"File").$basename(t))),d.renameSync(t,e)},$.$$arity=2)}(e[0],e)},Opal.modules["vector2d/calculations"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t*e:t["$*"](e)}function n(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}t.top;var i=[],s=t.nil,a=(t.const_get_qualified,t.const_get_relative),o=(t.breaker,t.slice,t.klass),c=t.module,l=t.truthy;return t.add_stubs(["$-","$*","$x","$y","$+","$normalized?","$normalize","$acos","$dot_product","$calculate_each","$sqrt","$squared_distance","$coerce","$class","$cross_product","$angle_between","$private","$new","$send"]),function(i,u,f){var $=[o(i,null,"Vector2d")].concat(f);return function(i,o){var u,f,$,h,p,d,_,m,y,g,v=c(i,"Calculations"),b=[v].concat(o);!function(i,s){var o,u,f,$=c(i,"ClassMethods"),h=[$].concat(s);t.def($,"$cross_product",o=function(t,n){return e(r(t.$x(),n.$y()),r(t.$y(),n.$x()))},o.$$arity=2),t.def($,"$dot_product",u=function(t,e){return n(r(t.$x(),e.$x()),r(t.$y(),e.$y()))},u.$$arity=2),t.def($,"$angle_between",f=function(t,e){var r,n;return r=l(t["$normalized?"]())?t:t.$normalize(),n=l(e["$normalized?"]())?e:e.$normalize(),a(h,"Math").$acos(this.$dot_product(r,n))},f.$$arity=2)}(b[0],b),t.def(v,"$*",u=function(t){return this.$calculate_each("*",t)},u.$$arity=1),t.def(v,"$/",f=function(t){return this.$calculate_each("/",t)},f.$$arity=1),t.def(v,"$+",$=function(t){return this.$calculate_each("+",t)},$.$$arity=1),t.def(v,"$-",h=function(t){return this.$calculate_each("-",t)},h.$$arity=1),t.def(v,"$distance",p=function(t){return a(b,"Math").$sqrt(this.$squared_distance(t))},p.$$arity=1),t.def(v,"$squared_distance",d=function(i){var a,o,c,l,u=s;return o=this.$coerce(i),u=null==(a=t.to_ary(o))[0]?s:a[0],null==a[1]?s:a[1],c=e(u.$x(),this.$x()),l=e(u.$y(),this.$y()),n(r(c,c),r(l,l))},d.$$arity=1),t.def(v,"$dot_product",_=function(e){var r,n,i;return n=this.$coerce(e),i=null==(r=t.to_ary(n))[0]?s:r[0],null==r[1]?s:r[1],this.$class().$dot_product(this,i)},_.$$arity=1),t.def(v,"$cross_product",m=function(e){var r,n,i;return n=this.$coerce(e),i=null==(r=t.to_ary(n))[0]?s:r[0],null==r[1]?s:r[1],this.$class().$cross_product(this,i)},m.$$arity=1),t.def(v,"$angle_between",y=function(e){var r,n,i;return n=this.$coerce(e),i=null==(r=t.to_ary(n))[0]?s:r[0],null==r[1]?s:r[1],this.$class().$angle_between(this,i)},y.$$arity=1),v.$private(),t.def(v,"$calculate_each",g=function(e,r){var n,i,a=s;return i=this.$coerce(r),a=null==(n=t.to_ary(i))[0]?s:n[0],null==n[1]?s:n[1],this.$class().$new(this.$x().$send(e,a.$x()),this.$y().$send(e,a.$y()))},g.$$arity=2)}($[0],$)}(i[0],0,i)},Opal.modules["vector2d/coercions"]=function(t){t.top;var e=[],r=t.nil,n=(t.const_get_qualified,t.const_get_relative),i=(t.breaker,t.slice,t.klass),s=t.module,a=t.hash2;return t.add_stubs(["$===","$parse","$raise","$class","$x","$y","$new","$to_i","$to_f"]),function(e,o,c){var l=[i(e,null,"Vector2d")].concat(c);return function(e,i){var o,c,l,u,f,$,h,p=s(e,"Coercions"),d=[p].concat(i);t.def(p,"$coerce",o=function(t){var e=this,i=r;return i=t,n(d,"Vector2d")["$==="](i)?[t,e]:n(d,"Array")["$==="](i)||n(d,"Numeric")["$==="](i)||n(d,"String")["$==="](i)||n(d,"Hash")["$==="](i)?[n(d,"Vector2d").$parse(t),e]:e.$raise(n(d,"TypeError"),e.$class()+" can't be coerced into "+t.$class())},o.$$arity=1),t.def(p,"$inspect",c=function(){return"Vector2d("+this.$x()+","+this.$y()+")"},c.$$arity=0),t.def(p,"$to_a",l=function(){return[this.$x(),this.$y()]},l.$$arity=0),t.def(p,"$to_hash",u=function(){return a(["x","y"],{x:this.$x(),y:this.$y()})},u.$$arity=0),t.def(p,"$to_i_vector",f=function(){return this.$class().$new(this.$x().$to_i(),this.$y().$to_i())},f.$$arity=0),t.def(p,"$to_f_vector",$=function(){return this.$class().$new(this.$x().$to_f(),this.$y().$to_f())},$.$$arity=0),t.def(p,"$to_s",h=function(){return this.$x()+"x"+this.$y()},h.$$arity=0)}(l[0],l)}(e[0],0,e)},Opal.modules["vector2d/fitting"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t>e:t["$>"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t/e:t["$/"](e)}function n(t,e){return"number"==typeof t&&"number"==typeof e?t*e:t["$*"](e)}function i(t,e){return"number"==typeof t&&"number"==typeof e?t<e:t["$<"](e)}t.top;var s=[],a=t.nil,o=(t.const_get_qualified,t.const_get_relative,t.breaker,t.slice,t.klass),c=t.module,l=t.truthy;return t.add_stubs(["$coerce","$>","$x","$y","$fit","$/","$to_f_vector","$*","$==","$<","$alias_method"]),function(s,u,f){var $=[o(s,null,"Vector2d")].concat(f);return function(s,o){var u,f,$,h=c(s,"Fitting");[h].concat(o);t.def(h,"$contain",u=function(r){var n,i,s=a;return i=this.$coerce(r),s=null==(n=t.to_ary(i))[0]?a:n[0],null==n[1]?a:n[1],l(l(n=e(s.$x(),this.$x()))?n:e(s.$y(),this.$y()))?r.$fit(this):r},u.$$arity=1),t.def(h,"$fit",f=function(s){var o,c,u=a,f=a;return c=this.$coerce(s),u=null==(o=t.to_ary(c))[0]?a:o[0],null==o[1]?a:o[1],f=r(u.$to_f_vector(),this),n(this,l(l(o=f.$y()["$=="](0))?o:l(c=e(f.$x(),0))?i(f.$x(),f.$y()):c)?f.$x():f.$y())},f.$$arity=1),h.$alias_method("constrain_both","fit"),t.def(h,"$fit_either",$=function(s){var o,c,u=a,f=a;return c=this.$coerce(s),u=null==(o=t.to_ary(c))[0]?a:o[0],null==o[1]?a:o[1],f=r(u.$to_f_vector(),this),l(l(o=e(f.$x(),0))?e(f.$y(),0):o)?n(this,f=l(i(f.$x(),f.$y()))?f.$y():f.$x()):this.$fit(u)},$.$$arity=1),h.$alias_method("constrain_one","fit_either")}($[0],$)}(s[0],0,s)},Opal.modules["vector2d/properties"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t*e:t["$*"](e)}t.top;var r=[],n=(t.nil,t.const_get_qualified,t.const_get_relative),i=(t.breaker,t.slice,t.klass),s=t.module;return t.add_stubs(["$atan2","$y","$x","$abs","$/","$to_f","$sqrt","$squared_length","$+","$*","$==","$length"]),function(r,a,o){var c=[i(r,null,"Vector2d")].concat(o);return function(r,i){var a,o,c,l,u,f=s(r,"Properties"),$=[f].concat(i);t.def(f,"$angle",a=function(){return n($,"Math").$atan2(this.$y(),this.$x())},a.$$arity=0),t.def(f,"$aspect_ratio",o=function(){var t,e;return(t=this.$x().$to_f(),e=this.$y().$to_f(),"number"==typeof t&&"number"==typeof e?t/e:t["$/"](e)).$abs()},o.$$arity=0),t.def(f,"$length",c=function(){return n($,"Math").$sqrt(this.$squared_length())},c.$$arity=0),t.def(f,"$squared_length",l=function(){var t,r;return t=e(this.$x(),this.$x()),r=e(this.$y(),this.$y()),"number"==typeof t&&"number"==typeof r?t+r:t["$+"](r)},l.$$arity=0),t.def(f,"$normalized?",u=function(){return this.$length().$to_f()["$=="](1)},u.$$arity=0)}(c[0],c)}(r[0],0,r)},Opal.modules["vector2d/transformations"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t*e:t["$*"](e)}t.top;var r=[],n=(t.nil,t.const_get_qualified,t.const_get_relative),i=(t.breaker,t.slice,t.klass),s=t.module;return t.add_stubs(["$new","$class","$ceil","$x","$y","$floor","$resize","$-@","$*","$/","$length","$-","$cos","$sin","$+","$round","$min"]),function(r,a,o){var c=[i(r,null,"Vector2d")].concat(o);return function(r,i){var a,o,c,l,u,f,$,h,p,d=s(r,"Transformations"),_=[d].concat(i);t.def(d,"$ceil",a=function(){return this.$class().$new(this.$x().$ceil(),this.$y().$ceil())},a.$$arity=0),t.def(d,"$floor",o=function(){return this.$class().$new(this.$x().$floor(),this.$y().$floor())},o.$$arity=0),t.def(d,"$normalize",c=function(){return this.$resize(1)},c.$$arity=0),t.def(d,"$perpendicular",l=function(){return n(_,"Vector2d").$new(this.$y()["$-@"](),this.$x())},l.$$arity=0),t.def(d,"$resize",u=function(t){var r,n;return e(this,(r=t,n=this.$length(),"number"==typeof r&&"number"==typeof n?r/n:r["$/"](n)))},u.$$arity=1),t.def(d,"$reverse",f=function(){return this.$class().$new(this.$x()["$-@"](),this.$y()["$-@"]())},f.$$arity=0),t.def(d,"$rotate",$=function(t){var r,i;return n(_,"Vector2d").$new((r=e(this.$x(),n(_,"Math").$cos(t)),i=e(this.$y(),n(_,"Math").$sin(t)),"number"==typeof r&&"number"==typeof i?r-i:r["$-"](i)),function(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}(e(this.$x(),n(_,"Math").$sin(t)),e(this.$y(),n(_,"Math").$cos(t))))},$.$$arity=1),t.def(d,"$round",h=function(t){return null==t&&(t=0),this.$class().$new(this.$x().$round(t),this.$y().$round(t))},h.$$arity=-1),t.def(d,"$truncate",p=function(t){return this.$resize([t,this.$length()].$min())},p.$$arity=1)}(c[0],c)}(r[0],0,r)},Opal.modules["vector2d/version"]=function(t){t.top;var e=[],r=(t.nil,t.const_get_qualified,t.const_get_relative,t.breaker,t.slice,t.klass);return function(e,n,i){var s=[r(e,null,"Vector2d")].concat(i);return t.const_set(s[0],"VERSION","2.1.0")}(e[0],0,e)},Opal.modules.vector2d=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}var r,n=t.top,i=[],s=t.nil,a=t.const_get_qualified,o=t.const_get_relative,c=(t.breaker,t.slice,t.klass),l=t.truthy,u=t.send;return t.add_stubs(["$require","$extend","$include","$nil?","$parse_single_arg","$new","$private","$===","$parse","$parse_str","$parse_hash","$dup","$has_key?","$[]","$[]=","$-","$=~","$map","$split","$to_proc","$raise","$attr_reader","$x","$y"]),n.$require("vector2d/calculations"),n.$require("vector2d/coercions"),n.$require("vector2d/fitting"),n.$require("vector2d/properties"),n.$require("vector2d/transformations"),n.$require("vector2d/version"),function(r,n,i){var f,$,h=c(r,null,"Vector2d"),p=[h].concat(i);h.$extend(a(a(o(p,"Vector2d"),"Calculations"),"ClassMethods")),h.$include(a(o(p,"Vector2d"),"Calculations")),h.$include(a(o(p,"Vector2d"),"Coercions")),h.$include(a(o(p,"Vector2d"),"Fitting")),h.$include(a(o(p,"Vector2d"),"Properties")),h.$include(a(o(p,"Vector2d"),"Transformations")),function(r,n){var i,a,c,f,$=[r].concat(n);t.def(r,"$parse",i=function(t,e){return null==e&&(e=s),l(e["$nil?"]())?this.$parse_single_arg(t):this.$new(t,e)},i.$$arity=-2),r.$private(),t.def(r,"$parse_single_arg",a=function(e){var r=this,n=s;return n=e,o($,"Vector2d")["$==="](n)?e:o($,"Array")["$==="](n)?u(r,"parse",t.to_a(e)):o($,"String")["$==="](n)?r.$parse_str(e):o($,"Hash")["$==="](n)?r.$parse_hash(e.$dup()):r.$new(e,e)},a.$$arity=1),t.def(r,"$parse_hash",c=function(r){var n=s;return l(r["$has_key?"]("x"))&&(l(r["$[]"]("x"))||(n=["x",r["$[]"]("x")],u(r,"[]=",t.to_a(n)),n[e(n.length,1)])),l(r["$has_key?"]("y"))&&(l(r["$[]"]("y"))||(n=["y",r["$[]"]("y")],u(r,"[]=",t.to_a(n)),n[e(n.length,1)])),this.$new(r["$[]"]("x"),r["$[]"]("y"))},c.$$arity=1),t.def(r,"$parse_str",f=function(e){return l(e["$=~"](/^[\s]*[\d\.]*[\s]*x[\s]*[\d\.]*[\s]*$/))?u(this,"new",t.to_a(u(e.$split("x"),"map",[],"to_f".$to_proc()))):this.$raise(o($,"ArgumentError"),"not a valid string input")},f.$$arity=1)}(t.get_singleton_class(h),p),h.$attr_reader("x","y"),t.def(h,"$initialize",f=function(t,e){var r;return r=[t,e],this.x=r[0],this.y=r[1],r},f.$$arity=2),t.def(h,"$==",$=function(t){var e;return l(e=t.$x()["$==="](this.$x()))?t.$y()["$==="](this.$y()):e},$.$$arity=1)}(i[0],0,i),t.def(n,"$Vector2d",r=function(e){var r;return r=t.slice.call(arguments,0,arguments.length),u(o(i,"Vector2d"),"parse",t.to_a(r))},r.$$arity=-1),s&&"Vector2d"},Opal.modules.json=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}t.top;var r=[],n=t.nil,i=t.const_get_qualified,s=t.const_get_relative,a=(t.breaker,t.slice,t.module),o=t.klass,c=t.send,l=t.hash2,u=t.truthy;return t.add_stubs(["$raise","$new","$push","$[]=","$-","$[]","$create_id","$json_create","$const_get","$attr_accessor","$create_id=","$===","$parse","$generate","$from_object","$merge","$to_json","$responds_to?","$to_io","$write","$to_s","$to_a","$strftime"]),function(r,f){var $,h,p,d,_,m,y,g=a(r,"JSON"),v=[g].concat(f),b=n;!function(t,e,r){[o(t,e,"JSONError")].concat(r)}(v[0],s(v,"StandardError"),v),function(t,e,r){[o(t,e,"ParserError")].concat(r)}(v[0],s(v,"JSONError"),v);var A=t.hasOwnProperty;function x(t){try{return JSON.parse(t)}catch(t){g.$raise(i(s(v,"JSON"),"ParserError"),t.message)}}function w(r,a){var o,l,u,f,$,h;switch(typeof r){case"string":case"number":return r;case"boolean":return!!r;case"null":return n;case"object":if(!r)return n;if(r.$$is_array){for(l=a.array_class.$new(),f=0,$=r.length;f<$;f++)l.$push(w(r[f],a));return l}for(h in u=a.object_class.$new(),r)A.call(r,h)&&(b=[h,w(r[h],a)],c(u,"[]=",t.to_a(b)),b[e(b.length,1)]);return a.parse||(o=u["$[]"](s(v,"JSON").$create_id()))==n?u:i("::","Object").$const_get(o).$json_create(u)}}!function(t,e){[t].concat(e);t.$attr_accessor("create_id")}(t.get_singleton_class(g),v),b=["json_class"],c(g,"create_id=",t.to_a(b)),b[e(b.length,1)],t.defs(g,"$[]",$=function(t,e){return null==e&&(e=l([],{})),u(s(v,"String")["$==="](t))?this.$parse(t,e):this.$generate(t,e)},$.$$arity=-2),t.defs(g,"$parse",h=function(t,e){return null==e&&(e=l([],{})),this.$from_object(x(t),e.$merge(l(["parse"],{parse:!0})))},h.$$arity=-2),t.defs(g,"$parse!",p=function(t,e){return null==e&&(e=l([],{})),this.$parse(t,e)},p.$$arity=-2),t.defs(g,"$load",d=function(t,e){return null==e&&(e=l([],{})),this.$from_object(x(t),e)},d.$$arity=-2),t.defs(g,"$from_object",_=function(r,i){var a=n;return null==i&&(i=l([],{})),u(i["$[]"]("object_class"))||(a=["object_class",s(v,"Hash")],c(i,"[]=",t.to_a(a)),a[e(a.length,1)]),u(i["$[]"]("array_class"))||(a=["array_class",s(v,"Array")],c(i,"[]=",t.to_a(a)),a[e(a.length,1)]),w(r,i.$$smap)},_.$$arity=-2),t.defs(g,"$generate",m=function(t,e){return null==e&&(e=l([],{})),t.$to_json(e)},m.$$arity=-2),t.defs(g,"$dump",y=function(t,e,r){var i;return null==e&&(e=n),null==r&&(r=n),i=this.$generate(t),u(e)?(u(e["$responds_to?"]("to_io"))&&(e=e.$to_io()),e.$write(i),e):i},y.$$arity=-2)}(r[0],r),function(e,r,n){var i,s=o(e,null,"Object");[s].concat(n);t.def(s,"$to_json",i=function(){return this.$to_s().$to_json()},i.$$arity=0)}(r[0],0,r),function(e,r){var n,i=a(e,"Enumerable");[i].concat(r);t.def(i,"$to_json",n=function(){return this.$to_a().$to_json()},n.$$arity=0)}(r[0],r),function(e,r,n){var i,s=o(e,null,"Array");[s].concat(n);t.def(s,"$to_json",i=function(){for(var t=[],e=0,r=this.length;e<r;e++)t.push(this[e].$to_json());return"["+t.join(", ")+"]"},i.$$arity=0)}(r[0],0,r),function(e,r,n){var i,s=o(e,null,"Boolean");[s].concat(n);t.def(s,"$to_json",i=function(){return 1==this?"true":"false"},i.$$arity=0)}(r[0],0,r),function(e,r,n){var i,s=o(e,null,"Hash");[s].concat(n);t.def(s,"$to_json",i=function(){for(var t,e,r=[],n=0,i=this.$$keys,s=i.length;n<s;n++)(t=i[n]).$$is_string?e=this.$$smap[t]:(e=t.value,t=t.key),r.push(t.$to_s().$to_json()+":"+e.$to_json());return"{"+r.join(", ")+"}"},i.$$arity=0)}(r[0],0,r),function(e,r,n){var i,s=o(e,null,"NilClass");[s].concat(n);t.def(s,"$to_json",i=function(){return"null"},i.$$arity=0)}(r[0],0,r),function(e,r,n){var i,s=o(e,null,"Numeric");[s].concat(n);t.def(s,"$to_json",i=function(){return this.toString()},i.$$arity=0)}(r[0],0,r),function(e,r,n){var i=o(e,null,"String");[i].concat(n);t.alias(i,"to_json","inspect")}(r[0],0,r),function(e,r,n){var i,s=o(e,null,"Time");[s].concat(n);t.def(s,"$to_json",i=function(){return this.$strftime("%FT%T%z").$to_json()},i.$$arity=0)}(r[0],0,r),function(e,r,i){var s,a,c=o(e,null,"Date");[c].concat(i);return t.def(c,"$to_json",s=function(){return this.$to_s().$to_json()},s.$$arity=0),t.def(c,"$as_json",a=function(){return this.$to_s()},a.$$arity=0),n&&"as_json"}(r[0],0,r)},Opal.modules["opal-neatjson"]=function(t){var e=t.top,r=[],n=t.nil,i=(t.const_get_qualified,t.const_get_relative),s=(t.breaker,t.slice,t.truthy),a=t.module,o=t.gvars,c=t.hash2,l=t.send;return t.add_stubs(["$==","$require","$has_key?","$lambda","$[]","$[]=","$-","$to_n"]),s(i(r,"RUBY_ENGINE")["$=="]("opal"))?(e.$require("json"),function(e,r){var u,f=a(e,"JSON"),$=[f].concat(r);i($,"OPAL_PLATFORM")["$=="]("nodejs"),o.neatJSON=neatJSON,t.defs(f,"$neat_generate",u=function(e,r){var i,a,u,f=n;return null==o.neatJSON&&(o.neatJSON=n),null==r&&(r=c(["explicit_sort"],{explicit_sort:[]})),s(r["$has_key?"]("explicit_sort"))&&(f=["sort",l(this,"lambda",[],(i=function(t,e,a){var o;i.$$s;return null==t&&(t=n),null==e&&(e=n),null==a&&(a=n),s(o=r["$[]"]("explicit_sort")["$[]"](t))?o:"_9999_"+t},i.$$s=this,i.$$arity=3,i))],l(r,"[]=",t.to_a(f)),f[(a=f.length,u=1,"number"==typeof a&&"number"==typeof u?a-u:a["$-"](u))]),o.neatJSON(JSON.parse(JSON.stringify(e.$to_n())),r.$to_n())},u.$$arity=-2)}(r[0],r)):n},Opal.modules["opal-ajv"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}t.top;var n=[],i=t.nil,s=(t.const_get_qualified,t.const_get_relative),a=(t.breaker,t.slice,t.module),o=t.klass,c=t.truthy,l=t.send,u=t.range,f=t.gvars,$=t.hash2,h=t.hash;return t.add_stubs(["$==","$add_schema","$_schema","$to_n","$each","$start_with?","$gsub","$[]","$push","$error","$new","$strict=","$-","$get","$keys","$validate_filenameparts","$+","$validate","$select","$match","$inject","$[]=","$keep_if","$>","$length","$t","$join","$uniq","$flatten","$values"]),function(n,p){var d=[a(n,"Ajv")].concat(p);!function(n,a,p){var d,_,m,y,g,v,b=o(n,null,"JsonValidator"),A=[b].concat(p);b.$$prototype.root=i,t.def(b,"$initialize",d=function(){var t=i;return t=i,t=(s(A,"OPAL_PLATFORM")["$=="]("nodejs"),Ajv),this.root=t({allErrors:!0,jsonPointers:!0,extendRefs:!0}),this.$add_schema(this.$_schema(),"zupfnoter")},d.$$arity=0),t.def(b,"$add_schema",_=function(t,e){return this.root.addSchema(t.$to_n(),e),i},_.$$arity=2),t.def(b,"$validate",m=function(t,e){var r,n,s=i,a=i;return!1,n=this.root.validate(t,e.$to_n()),s=[],c(n)||(a=this.root.errors,l(a,"each",[],((r=function(t){r.$$s;var e,n=i;return null==f.log&&(f.log=i),null==t&&(t=i),n=t.dataPath,c(n["$start_with?"]("/"))&&(n=n["$[]"](u(1,-1,!1)).$gsub("/",".")),s.$push(n),e=n+": "+t.message+"\n"+JSON.stringify(t.params,null," "),f.log.$error("./opal-ajv.rb".$force_encoding("US-ASCII")+":38 "+e)}).$$s=this,r.$$arity=1,r))),s},m.$$arity=2),t.def(b,"$validate_conf",y=function(n){var a,o,c,u=i;return u=s(A,"Confstack").$new(),o=[!1],l(u,"strict=",t.to_a(o)),e(o.length,1),u.$push(n.$get()),c=u.$get("extract.0"),l(u.$get("extract").$keys(),"each",[],((a=function(t){a.$$s;return null==t&&(t=i),u.$push($(["extract"],{extract:h(t,c)}))}).$$s=this,a.$$arity=1,a)),u.$push($(["extract"],{extract:n.$get("extract")})),u.$get(),r(this.$validate_filenameparts(u),this.$validate("zupfnoter",u.$get()))},y.$$arity=1),t.def(b,"$validate_filenameparts",g=function(n){var a,o,u,h,p,d=i;return p=l(n.$keys(),"select",[],((a=function(t){a.$$s;return null==t&&(t=i),t.$match(/^extract\.\d+\.filenamepart/)}).$$s=this,a.$$arity=1,a)),d=l(p,"inject",[$([],{})],((o=function(r,n){o.$$s;var s=i;return null==f.conf&&(f.conf=i),null==r&&(r=i),null==n&&(n=i),c(r["$[]"](f.conf["$[]"](n)))||(s=[f.conf["$[]"](n),[]],l(r,"[]=",t.to_a(s)),s[e(s.length,1)]),r["$[]"](f.conf["$[]"](n)).$push(n),r}).$$s=this,o.$$arity=2,o)),d=l(d,"keep_if",[],((u=function(t,e){var r,n;u.$$s;return null==t&&(t=i),null==e&&(e=i),r=e.$length(),n=1,"number"==typeof r&&"number"==typeof n?r>n:r["$>"](n)}).$$s=this,u.$$arity=2,u)),l(d,"each",[],((h=function(t,e){var n;h.$$s;return null==f.log&&(f.log=i),null==t&&(t=i),null==e&&(e=i),n=r(r(s(A,"I18n").$t("duplicate filenameparts"),": ''"+t+"'' in "),e.$join(", ")),f.log.$error("./opal-ajv.rb".$force_encoding("US-ASCII")+":70 "+n)}).$$s=this,h.$$arity=2,h)),d.$values().$flatten().$uniq()},g.$$arity=1),t.def(b,"$_schema",v=function(){return $(["$schema","description","type","required","definitions","properties"],{$schema:"http://json-schema.org/draft-04/schema#",description:"Generated from x.json with shasum 0b1781e0803dc084178858e9fbe2b4e0b65c08e7",type:"object",required:["produce","abc_parser","restposition","wrap","defaults","templates","annotations","extract","layout","neatjson"],definitions:$(["apanchor","pos","notes_entry","nb_annotation_xx","minc_entry","nconf_entry","align","notebound_pos","notebound_repeat_outdated","annotated_bezier","extract_layout"],{apanchor:$(["type","enum"],{type:"string",enum:["manual","box","center"]}),pos:$(["type","minItems","uniqueItems","items"],{type:"array",minItems:2,uniqueItems:!1,items:$(["type"],{type:"number"})}),notes_entry:$(["type","required","properties"],{type:"object",required:["pos","text","style"],properties:$(["pos","text","align","style"],{pos:$(["$ref"],{$ref:"#/definitions/pos"}),text:$(["type"],{type:"string"}),align:$(["$ref"],{$ref:"#/definitions/align"}),style:$(["type"],{type:"string"})})}),nb_annotation_xx:$(["type","required","properties"],{type:"object",required:["voices","pos","autopos","style"],properties:$(["voices","pos","autopos","apanchor","style"],{voices:$(["type","minItems","uniqueItems","items"],{type:"array",minItems:0,uniqueItems:!0,items:$([],{})}),pos:$(["$ref"],{$ref:"#/definitions/pos"}),autopos:$(["type"],{type:"boolean"}),apanchor:$(["$ref"],{$ref:"#/definitions/apanchor"}),style:$(["type"],{type:"string"})})}),minc_entry:$(["type","required","additionalProperties","properties"],{type:"object",required:["minc_f"],additionalProperties:!1,properties:$(["minc_f"],{minc_f:$(["type"],{type:"number"})})}),nconf_entry:$(["type","additionalProperties","patternProperties"],{type:"object",additionalProperties:!1,patternProperties:$(["t_d*"],{"t_d*":$(["type","additionalProperties","patternProperties"],{type:"object",additionalProperties:!1,patternProperties:$(["n_d*"],{"n_d*":$(["type","additionalProperties","properties"],{type:"object",additionalProperties:!1,properties:$(["nshift"],{nshift:$(["type"],{type:"number"})})})})})})}),align:$(["type","enum"],{type:"string",enum:["l","r","auto"]}),notebound_pos:$(["type","additionalProperties","patternProperties"],{type:"object",additionalProperties:!1,patternProperties:$(["v_d*"],{"v_d*":$(["type","additionalProperties","patternProperties"],{type:"object",additionalProperties:!1,patternProperties:$(["t_\\d*|\\d*"],{"t_\\d*|\\d*":$(["type","additionalProperties","properties","patternProperties"],{type:"object",additionalProperties:!1,properties:$(["pos","align","show","text","style"],{pos:$(["$ref"],{$ref:"#/definitions/pos"}),align:$(["$ref"],{$ref:"#/definitions/align"}),show:$(["type"],{type:"boolean"}),text:$(["type"],{type:"string"}),style:$(["type"],{type:"string"})}),patternProperties:$(["\\d+"],{"\\d+":$(["type","additionalProperties","properties"],{type:"object",additionalProperties:!1,properties:$(["pos","align","show","text","style"],{pos:$(["$ref"],{$ref:"#/definitions/pos"}),align:$(["$ref"],{$ref:"#/definitions/align"}),show:$(["type"],{type:"boolean"}),text:$(["type"],{type:"string"}),style:$(["type"],{type:"string"})})})})})})})})}),notebound_repeat_outdated:$(["type","additionalProperties","patternProperties"],{type:"object",additionalProperties:!1,patternProperties:$(["v_d*"],{"v_d*":$(["text","style","pos"],{text:"integer",style:$(["type"],{type:"string"}),pos:$(["$ref"],{$ref:"#/definitions/pos"})})})}),annotated_bezier:$(["type","properties"],{type:"object",properties:$(["cp1","cp2","pos","shape","show","style"],{cp1:$(["$ref"],{$ref:"#/definitions/pos"}),cp2:$(["$ref"],{$ref:"#/definitions/pos"}),pos:$(["$ref"],{$ref:"#/definitions/pos"}),shape:$(["type","minItems","uniqueItems","items"],{type:"array",minItems:0,uniqueItems:!0,items:$(["type"],{type:"string"})}),show:$(["type"],{type:"boolean"}),style:$(["type"],{type:"string"})})}),extract_layout:$(["type","requiredx","additionalProperties","properties"],{type:"object",requiredx:["limit_a3","LINE_THIN","LINE_MEDIUM","LINE_THICK","ELLIPSE_SIZE","REST_SIZE","grid"],additionalProperties:!1,properties:$(["limit_a3","beams","bottomup","jumpline_anchor","jumpline_vcut","LINE_THIN","LINE_MEDIUM","LINE_THICK","PITCH_OFFSET","X_SPACING","X_OFFSET","instrument","tuning","DRAWING_AREA_SIZE","ELLIPSE_SIZE","REST_SIZE","grid","color","packer"],{limit_a3:$(["type"],{type:"boolean"}),beams:$(["type"],{type:"boolean"}),bottomup:$(["type"],{type:"boolean"}),jumpline_anchor:$(["$ref"],{$ref:"#/definitions/pos"}),jumpline_vcut:$(["type"],{type:"number"}),LINE_THIN:$(["type"],{type:"number"}),LINE_MEDIUM:$(["type"],{type:"number"}),LINE_THICK:$(["type"],{type:"number"}),PITCH_OFFSET:$(["type"],{type:"integer"}),X_SPACING:$(["type"],{type:"number"}),X_OFFSET:$(["type"],{type:"number"}),instrument:$(["type"],{type:"string"}),tuning:$(["type"],{type:"string"}),DRAWING_AREA_SIZE:$(["type","minItems","items"],{type:"array",minItems:2,items:$(["type"],{type:"number"})}),ELLIPSE_SIZE:$(["type","minItems","items"],{type:"array",minItems:2,items:$(["type"],{type:"number"})}),REST_SIZE:$(["type","minItems","items"],{type:"array",minItems:2,items:$(["type"],{type:"number"})}),grid:$(["type"],{type:"boolean"}),color:$(["type","properties"],{type:"object",properties:$(["color_default","color_variant1","color_variant2"],{color_default:$(["type"],{type:"string"}),color_variant1:$(["type"],{type:"string"}),color_variant2:$(["type"],{type:"string"})})}),packer:$(["type","properties"],{type:"object",properties:$(["pack_method","pack_max_spread_factor","pack_min_increment"],{pack_method:$(["type"],{type:"integer"}),pack_max_spread_factor:$(["type"],{type:"number"}),pack_min_increment:$(["type"],{type:"number"})})})})})}),properties:$(["confstack","produce","template","abc_parser","restposition","wrap","defaults","templates","annotations","extract","layout","neatjson"],{confstack:$(["type","required","properties"],{type:"object",required:["env"],properties:$(["env"],{env:$(["type"],{type:"string"})})}),produce:$(["type","minItems","uniqueItems","items"],{type:"array",minItems:0,uniqueItems:!0,items:$(["type"],{type:"integer"})}),template:$(["type","additionalProperties","properties"],{type:"object",additionalProperties:!1,properties:$(["filebase","title"],{filebase:$(["type"],{type:"string"}),title:$(["type"],{type:"string"})})}),abc_parser:$(["type"],{type:"string"}),restposition:$(["type","additionalProperties","required","properties"],{type:"object",additionalProperties:!1,required:["default","repeatstart","repeatend"],properties:$(["default","repeatstart","repeatend"],{default:$(["type"],{type:"string"}),repeatstart:$(["type"],{type:"string"}),repeatend:$(["type"],{type:"string"})})}),wrap:$(["type"],{type:"integer"}),defaults:$(["type","required","properties"],{type:"object",required:["notebound"],properties:$(["notebound"],{notebound:$(["type","required","properties"],{type:"object",required:["annotation","partname","variantend","tuplet","chord"],properties:$(["annotation","chord","partname","variantend","tuplet"],{annotation:$(["type","required","properties"],{type:"object",required:["pos"],properties:$(["pos","style"],{pos:$(["$ref"],{$ref:"#/definitions/pos"}),style:$(["type"],{type:"string"})})}),chord:$(["type","required","properties"],{type:"object",required:["pos"],properties:$(["pos","style"],{pos:$(["$ref"],{$ref:"#/definitions/pos"}),style:$(["type"],{type:"string"})})}),partname:$(["type","required","properties"],{type:"object",required:["pos"],properties:$(["pos","style","show"],{pos:$(["$ref"],{$ref:"#/definitions/pos"}),style:$(["type"],{type:"string"}),show:$(["type"],{type:"boolean"})})}),variantend:$(["type","required","properties"],{type:"object",required:["pos"],properties:$(["pos","style"],{pos:$(["$ref"],{$ref:"#/definitions/pos"}),style:$(["type"],{type:"string"})})}),tuplet:$(["$ref","required"],{$ref:"#/definitions/annotated_bezier",required:["cp1","cp2","shape"]})})})})}),templates:$(["type","required","properties"],{type:"object",required:["notes","lyrics","tuplet","annotations"],properties:$(["notes","lyrics","tuplet","annotations"],{notes:$(["$ref"],{$ref:"#/definitions/notes_entry"}),lyrics:$(["type","required","properties"],{type:"object",required:["verses","pos"],properties:$(["verses","pos","style"],{verses:$(["type","minItems","uniqueItems","items"],{type:"array",minItems:1,uniqueItems:!0,items:$(["type"],{type:"integer"})}),pos:$(["$ref"],{$ref:"#/definitions/pos"}),style:$(["type"],{type:"string"})})}),tuplet:$(["type","required","properties"],{type:"object",required:["cp1","cp2","shape"],properties:$(["cp1","cp2","shape"],{cp1:$(["$ref"],{$ref:"#/definitions/pos"}),cp2:$(["$ref"],{$ref:"#/definitions/pos"}),shape:$(["type","minItems","uniqueItems","items"],{type:"array",minItems:1,uniqueItems:!0,items:$(["type"],{type:"string"})})})}),annotations:$(["type","required","properties"],{type:"object",required:["text","pos"],properties:$(["text","pos","style"],{text:$(["type"],{type:"string"}),pos:$(["$ref"],{$ref:"#/definitions/pos"}),style:$(["type"],{type:"string"})})})})}),annotations:$(["type","required","properties"],{type:"object",required:["vl","vt","vr"],properties:$(["vl","vt","vr"],{vl:$(["type","required","properties"],{type:"object",required:["text","pos"],properties:$(["text","pos"],{text:$(["type"],{type:"string"}),pos:$(["$ref"],{$ref:"#/definitions/pos"})})}),vt:$(["type","required","properties"],{type:"object",required:["text","pos"],properties:$(["text","pos"],{text:$(["type"],{type:"string"}),pos:$(["$ref"],{$ref:"#/definitions/pos"})})}),vr:$(["type","required","properties"],{type:"object",required:["text","pos"],properties:$(["text","pos"],{text:$(["type"],{type:"string"}),pos:$(["$ref"],{$ref:"#/definitions/pos"})})})})}),extract:$(["type","patternProperties"],{type:"object",patternProperties:$(["d*","4","5"],{"d*":$(["type","additionalProperties","requiredx","properties"],{type:"object",additionalProperties:!1,requiredx:["title","filenamepart","startpos","voices","synchlines","flowlines","subflowlines","jumplines","repeatsigns","layoutlines","legend","lyrics","layout","nonflowrest","notes","barnumbers","countnotes","chords","stringnames","printer"],properties:$(["title","filenamepart","startpos","voices","synchlines","flowlines","subflowlines","jumplines","repeatsigns","layoutlines","legend","lyrics","layout","nonflowrest","notes","notebound","tuplets","barnumbers","countnotes","chords","stringnames","instrument_shape","sortmark","printer","images"],{title:$(["type"],{type:"string"}),filenamepart:$([],{}),startpos:$(["type"],{type:"integer"}),voices:$(["type","minItems","uniqueItems","items"],{type:"array",minItems:1,uniqueItems:!0,items:$(["type"],{type:"integer"})}),synchlines:$(["type","minItems","uniqueItems","items"],{type:"array",minItems:0,uniqueItems:!0,items:$(["type","minItems","uniqueItems","items"],{type:"array",minItems:1,uniqueItems:!0,items:$(["type"],{type:"integer"})})}),flowlines:$(["type","minItems","uniqueItems","items"],{type:"array",minItems:1,uniqueItems:!0,items:$(["type"],{type:"integer"})}),subflowlines:$(["type","minItems","uniqueItems","items"],{type:"array",minItems:1,uniqueItems:!0,items:$(["type"],{type:"integer"})}),jumplines:$(["type","minItems","uniqueItems","items"],{type:"array",minItems:1,uniqueItems:!0,items:$(["type"],{type:"integer"})}),repeatsigns:$(["type","requiredx","properties"],{type:"object",requiredx:["voices","left","right"],properties:$(["voices","left","right"],{voices:$(["type","minItems","uniqueItems","items"],{type:"array",minItems:0,uniqueItems:!0,items:$([],{})}),left:$(["type","required","properties"],{type:"object",required:["pos","text","style"],properties:$(["pos","text","style"],{pos:$(["$ref"],{$ref:"#/definitions/pos"}),text:$(["type"],{type:"string"}),style:$(["type"],{type:"string"})})}),right:$(["type","required","properties"],{type:"object",required:["pos","text","style"],properties:$(["pos","text","style"],{pos:$(["$ref"],{$ref:"#/definitions/pos"}),text:$(["type"],{type:"string"}),style:$(["type"],{type:"string"})})})})}),layoutlines:$(["type","minItems","uniqueItems","items"],{type:"array",minItems:0,uniqueItems:!0,items:$(["type"],{type:"integer"})}),legend:$(["type","required","properties"],{type:"object",required:["spos","pos"],properties:$(["spos","pos","tstyle","align","style","salign"],{spos:$(["$ref"],{$ref:"#/definitions/pos"}),pos:$(["$ref"],{$ref:"#/definitions/pos"}),tstyle:$(["type"],{type:"string"}),align:$(["$ref"],{$ref:"#/definitions/align"}),style:$(["type"],{type:"string"}),salign:$(["$ref"],{$ref:"#/definitions/align"})})}),lyrics:$(["type","patternProperties"],{type:"object",patternProperties:$([".*"],{".*":$(["type","required"],{type:"object",required:["verses","pos"]})})}),layout:$(["$ref"],{$ref:"#/definitions/extract_layout"}),nonflowrest:$(["type"],{type:"boolean"}),notes:$(["patternProperties"],{patternProperties:$([".*"],{".*":$(["$ref"],{$ref:"#/definitions/notes_entry"})})}),notebound:$(["type","additionalProperties","properties"],{type:"object",additionalProperties:!1,properties:$(["annotation","chord","barnumber","c_jumplines","countnote","decoration","flowline","minc","nconf","partname","repeat_begin","repeat_end","tuplet","variantend"],{annotation:$(["$ref"],{$ref:"#/definitions/notebound_pos"}),chord:$(["$ref"],{$ref:"#/definitions/notebound_pos"}),barnumber:$(["$ref","align"],{$ref:"#/definitions/notebound_pos",align:$(["$ref"],{$ref:"#/definitions/align"})}),c_jumplines:$(["type","additionalProperties","patternProperties"],{type:"object",additionalProperties:!1,patternProperties:$(["v_d*"],{"v_d*":$(["p_repeat","p_begin","p_end","p_follow"],{p_repeat:$(["type"],{type:"number"}),p_begin:$(["type"],{type:"number"}),p_end:$(["type"],{type:"number"}),p_follow:$(["type"],{type:"number"})})})}),countnote:$(["$ref"],{$ref:"#/definitions/notebound_pos"}),decoration:$(["type","patternProperties"],{type:"object",patternProperties:$(["d+"],{"d+":$(["$ref"],{$ref:"#/definitions/notebound_pos"})})}),flowline:$(["type","patternProperties"],{type:"object",patternProperties:$(["v_d+"],{"v_d+":$(["type","patternProperties"],{type:"object",patternProperties:$(["d*"],{"d*":$(["$ref"],{$ref:"#/definitions/annotated_bezier"})})})})}),minc:$(["type","additionalProperties","patternProperties"],{type:"object",additionalProperties:!1,patternProperties:$(["d*"],{"d*":$(["$ref"],{$ref:"#/definitions/minc_entry"})})}),nconf:$(["type","additionalProperties","patternProperties"],{type:"object",additionalProperties:!1,patternProperties:$(["v_d*"],{"v_d*":$(["$ref"],{$ref:"#/definitions/nconf_entry"})})}),partname:$(["$ref"],{$ref:"#/definitions/notebound_pos"}),repeat_begin:$(["$ref"],{$ref:"#/definitions/notebound_pos"}),repeat_end:$(["$ref"],{$ref:"#/definitions/notebound_pos"}),tuplet:$(["type","patternProperties"],{type:"object",patternProperties:$(["v_d*"],{"v_d*":$(["type","patternProperties"],{type:"object",patternProperties:$(["d*"],{"d*":$(["$ref"],{$ref:"#/definitions/annotated_bezier"})})})})}),variantend:$(["$ref"],{$ref:"#/definitions/notebound_pos"})})}),tuplets:$(["type","properties"],{type:"object",properties:$(["text"],{text:$(["type"],{type:"string"})})}),barnumbers:$(["type","required","properties"],{type:"object",required:["voices","pos","autopos","style","prefix"],properties:$(["voices","pos","autopos","apanchor","style","prefix"],{voices:$(["type","minItems","uniqueItems","items"],{type:"array",minItems:0,uniqueItems:!0,items:$([],{})}),pos:$(["$ref"],{$ref:"#/definitions/pos"}),autopos:$(["type"],{type:"boolean"}),apanchor:$(["$ref"],{$ref:"#/definitions/apanchor"}),style:$(["type"],{type:"string"}),prefix:$(["type"],{type:"string"})})}),countnotes:$(["type","required","properties","cntextleft","cntextright"],{type:"object",required:["voices","pos","autopos","style"],properties:$(["voices","pos","autopos","apanchor","style"],{voices:$(["type","minItems","uniqueItems","items"],{type:"array",minItems:0,uniqueItems:!0,items:$([],{})}),pos:$(["$ref"],{$ref:"#/definitions/pos"}),autopos:$(["type"],{type:"boolean"}),apanchor:$(["$ref"],{$ref:"#/definitions/apanchor"}),style:$(["type"],{type:"string"})}),cntextleft:$(["type"],{type:"string"}),cntextright:$(["type"],{type:"string"})}),chords:$(["ref","style"],{ref:"#/definitions/nb_annotations",style:$(["type"],{type:"string"})}),stringnames:$(["type","required","properties"],{type:"object",required:["text","vpos","style","marks"],properties:$(["text","vpos","style","marks"],{text:$(["type"],{type:"string"}),vpos:$(["type","minItems","uniqueItems","items"],{type:"array",minItems:0,uniqueItems:!0,items:$(["type"],{type:"integer"})}),style:$(["type"],{type:"string"}),marks:$(["type","required","properties"],{type:"object",required:["vpos","hpos"],properties:$(["vpos","hpos"],{vpos:$(["type","minItems","uniqueItems","items"],{type:"array",minItems:0,uniqueItems:!0,items:$(["type"],{type:"integer"})}),hpos:$(["type","minItems","uniqueItems","items"],{type:"array",minItems:0,uniqueItems:!0,items:$(["type"],{type:"integer"})})})})})}),instrument_shape:$(["type"],{type:"string"}),sortmark:$(["type","properties"],{type:"object",properties:$(["show"],{show:$(["type"],{type:"boolean"})})}),printer:$(["type","required","properties"],{type:"object",required:["a3_offset","a4_offset","show_border"],properties:$(["a3_offset","a4_offset","show_border"],{a3_offset:$(["type","minItems","axItems","uniqueItems","items"],{type:"array",minItems:2,axItems:2,uniqueItems:!1,items:$(["type"],{type:"integer"})}),a4_offset:$(["type","minItems","uniqueItems","items"],{type:"array",minItems:2,uniqueItems:!1,items:$(["type"],{type:"integer"})}),show_border:$(["type"],{type:"boolean"})})}),images:$(["type","patternProperties"],{type:"object",patternProperties:$(["d*"],{"d*":$(["type","properties"],{type:"object",properties:$(["imagename","show","pos","height"],{imagename:$(["type"],{type:"string"}),show:$(["type"],{type:"boolean"}),pos:$(["$ref"],{$ref:"#/definitions/pos"}),height:$(["type"],{type:"number"})})})})})})}),4:$(["type","required","properties"],{type:"object",required:["title","voices"],properties:$(["title","filenamepart","voices"],{title:$(["type"],{type:"string"}),filenamepart:$([],{}),voices:$(["type","minItems","uniqueItems","items"],{type:"array",minItems:1,uniqueItems:!0,items:$(["type"],{type:"integer"})})})}),5:$(["type","required","properties"],{type:"object",required:["title","voices"],properties:$(["title","filenamepart","voices"],{title:$(["type"],{type:"string"}),filenamepart:$([],{}),voices:$(["type","minItems","uniqueItems","items"],{type:"array",minItems:1,uniqueItems:!0,items:$(["type"],{type:"integer"})})})})})}),layout:$(["type","required","properties"],{type:"object",required:["grid","limit_a3","SHOW_SLUR","LINE_THIN","LINE_MEDIUM","LINE_THICK","ELLIPSE_SIZE","REST_SIZE","X_SPACING","X_OFFSET","Y_SCALE","DRAWING_AREA_SIZE","BEAT_RESOLUTION","SHORTEST_NOTE","BEAT_PER_DURATION","PITCH_OFFSET","FONT_STYLE_DEF","MM_PER_POINT","DURATION_TO_STYLE","REST_TO_GLYPH"],properties:$(["grid","limit_a3","SHOW_SLUR","LINE_THIN","LINE_MEDIUM","LINE_THICK","ELLIPSE_SIZE","REST_SIZE","X_SPACING","X_OFFSET","Y_SCALE","DRAWING_AREA_SIZE","BEAT_RESOLUTION","SHORTEST_NOTE","BEAT_PER_DURATION","PITCH_OFFSET","FONT_STYLE_DEF","MM_PER_POINT","DURATION_TO_STYLE","REST_TO_GLYPH"],{grid:$(["type"],{type:"boolean"}),limit_a3:$(["type"],{type:"boolean"}),SHOW_SLUR:$(["type"],{type:"boolean"}),LINE_THIN:$(["type"],{type:"number"}),LINE_MEDIUM:$(["type"],{type:"number"}),LINE_THICK:$(["type"],{type:"number"}),ELLIPSE_SIZE:$(["type","minItems","uniqueItems","items"],{type:"array",minItems:1,uniqueItems:!0,items:$(["type"],{type:"number"})}),REST_SIZE:$(["type","minItems","uniqueItems","items"],{type:"array",minItems:1,uniqueItems:!0,items:$(["type"],{type:"number"})}),X_SPACING:$(["type"],{type:"number"}),X_OFFSET:$(["type"],{type:"number"}),Y_SCALE:$(["type"],{type:"integer"}),DRAWING_AREA_SIZE:$(["type","minItems","uniqueItems","items"],{type:"array",minItems:1,uniqueItems:!0,items:$(["type"],{type:"integer"})}),BEAT_RESOLUTION:$(["type"],{type:"integer"}),SHORTEST_NOTE:$(["type"],{type:"integer"}),BEAT_PER_DURATION:$(["type"],{type:"integer"}),PITCH_OFFSET:$(["type"],{type:"integer"}),FONT_STYLE_DEF:$(["type","required","patternProperties"],{type:"object",required:["bold","italic","large","regular","small_bold","small_italic","small","smaller"],patternProperties:$([".*"],{".*":$(["type","required","properties"],{type:"object",required:["text_color","font_size","font_style"],properties:$(["text_color","font_size","font_style"],{text_color:$(["type","minItems","uniqueItems","items"],{type:"array",minItems:3,uniqueItems:!1,items:$(["type"],{type:"integer"})}),font_size:$(["type"],{type:"integer"}),font_style:$(["type"],{type:"string"})})})})}),MM_PER_POINT:$(["type"],{type:"number"}),DURATION_TO_STYLE:$(["type","required","patternProperties"],{type:"object",required:["err","d64","d48","d32","d24","d16","d12","d8","d6","d4","d3","d2","d1"],patternProperties:$([".*"],{".*":$(["type","minItems","uniqueItems","items"],{type:"array",minItems:3,uniqueItems:!1,items:$(["type"],{type:["number","string","boolean"]})})})}),REST_TO_GLYPH:$(["type","patternProperties"],{type:"object",patternProperties:$([".*"],{".*":$(["type","minItems","uniqueItems","items"],{type:"array",minItems:1,uniqueItems:!0,items:[$(["type","minItems","uniqueItems","items"],{type:"array",minItems:1,uniqueItems:!1,items:$(["type"],{type:"number"})}),$(["type"],{type:"string"}),$(["type"],{type:"boolean"})]})})})})}),neatjson:$(["type","required","properties"],{type:"object",required:["wrap","aligned","after_comma","after_colon_1","after_colon_n","before_colon_n","explicit_sort"],properties:$(["wrap","aligned","after_comma","after_colon_1","after_colon_n","before_colon_n","sorted","explicit_sort"],{wrap:$(["type"],{type:"integer"}),aligned:$(["type"],{type:"boolean"}),after_comma:$(["type"],{type:"integer"}),after_colon_1:$(["type"],{type:"integer"}),after_colon_n:$(["type"],{type:"integer"}),before_colon_n:$(["type"],{type:"integer"}),sorted:$(["type"],{type:"boolean"}),explicit_sort:$(["type"],{type:"object"})})})})})},v.$$arity=0)}(d[0],0,d)}(n[0],n)},Opal.modules.consolelogger=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}function n(t,e){return"number"==typeof t&&"number"==typeof e?t<=e:t["$<="](e)}t.top;var i=[],s=t.nil,a=(t.const_get_qualified,t.const_get_relative),o=(t.breaker,t.slice,t.hash2),c=t.klass,l=t.send,u=t.truthy,f=t.gvars;return t.add_stubs(["$attr_reader","$attr","$[]","$now","$clear_errors","$clear_annotations","$send","$push","$add_annotation","$==","$loglevel","$join","$write","$loglevel?","$info","$-","$>","$count","$+","$call","$to_sym","$message","$invert","$<=","$keys","$private","$first","$last","$<<","$strftime","$puts","$write_html"]),t.const_set(i[0],"LOGLEVELS",o(["message","error","warning","info","debug"],{message:0,error:1,warning:2,info:3,debug:4})),t.const_set(i[0],"LOGICONS",o(["message","error","warning","info","debug"],{message:"icon-info-circled",error:"icon-error-alt",warning:"icon-attention",info:"icon-info-circled",debug:"icon-minus-squared"})),function(i,$,h){var p,d,_,m,y,g,v,b,A,x,w,k,E,S,N,I,C,O,B,M,P,F,L,T,j=c(i,null,"Logger"),R=[j].concat(h);j.$$prototype.captured_errors=j.$$prototype.timestamp=j.$$prototype.annotations=j.$$prototype.benchmarkstack=j.$$prototype.loglevel=s,j.$attr_reader("annotations"),j.$attr("benchmarkstack"),t.def(j,"$clear_annotations",p=function(){return this.annotations=[]},p.$$arity=0),t.def(j,"$initialize",d=function(t){return this.console=t,this.loglevel=a(R,"LOGLEVELS")["$[]"]("info"),this.timestamp=a(R,"Time").$now(),this.benchmarkstack=0,this.$clear_errors(),this.$clear_annotations()},d.$$arity=1),t.def(j,"$clear_annotations",_=function(){return this.annotations=[]},_.$$arity=0),t.def(j,"$log_from_worker",m=function(e){return l(this,"send",[e["$[]"]("type")].concat(t.to_a(e["$[]"]("args"))))},m.$$arity=1),t.def(j,"$error",y=function(t,e,r,n){var i=s;return null==e&&(e=s),null==r&&(r=s),null==n&&(n=[]),this.captured_errors.$push(t),this.$add_annotation(t,e,r,"error"),this.$loglevel()["$=="]("debug")&&(i=n.$join("\n")),this.$write("error",""+t+i)},y.$$arity=-2),t.def(j,"$warning",g=function(t,e,r){return null==e&&(e=s),null==r&&(r=s),u(this["$loglevel?"]("warning"))&&this.$add_annotation(t,e,r,"warning"),this.$write("warning",t)},g.$$arity=-2),t.def(j,"$info",v=function(t,e,r){return null==e&&(e=s),null==r&&(r=s),this.$add_annotation(t,e,r,"info"),this.$write("info",t)},v.$$arity=-2),t.def(j,"$debug",b=function(t,e,r){return null==e&&(e=s),null==r&&(r=s),this.$add_annotation(t,e,r,"debug"),this.$write("debug",t)},b.$$arity=-2),t.def(j,"$message",A=function(t,e,r){return null==e&&(e=s),null==r&&(r=s),this.$add_annotation(t,e,r,"message"),this.$write("message",t)},A.$$arity=-2),t.def(j,"$timestamp",x=function(t,r,n){return null==f.log&&(f.log=s),null==r&&(r=s),null==n&&(n=s),f.log.$info("Timestamp "+e(a(R,"Time").$now(),this.timestamp)+" sec: "+t)},x.$$arity=-2),t.def(j,"$timestamp_start",w=function(){return this.timestamp=a(R,"Time").$now()},w.$$arity=0),t.def(j,"$clear_errors",k=function(){return this.captured_errors=[]},k.$$arity=0),t.def(j,"$has_errors?",E=function(){var t,e;return t=this.captured_errors.$count(),e=0,"number"==typeof t&&"number"==typeof e?t>e:t["$>"](e)},E.$$arity=0),t.def(j,"$get_errors",S=function(){return this.captured_errors},S.$$arity=0),t.def(j,"$get_status",N=function(){return o(["annotations","captured_errors"],{annotations:this.annotations,captured_errors:this.captured_errors})},N.$$arity=0),t.def(j,"$set_status",I=function(t){return this.annotations=t["$[]"]("annotations"),this.captured_errors=t["$[]"]("captured_errors")},I.$$arity=1),t.def(j,"$benchmark",C=function(t){var n,i,o=C.$$p,c=o||s;return null==f.log&&(f.log=s),o&&(C.$$p=null),o&&(C.$$p=null),n=a(R,"Time").$now(),this.benchmarkstack=r(this.benchmarkstack,1),i=c.$call(),f.log.$info(this.benchmarkstack+"  elapsed "+e(a(R,"Time").$now(),n)+" sec for "+t),this.benchmarkstack=e(this.benchmarkstack,1),i},C.$$arity=1),t.def(j,"$console_log",O=function(t){return console.log(t)},O.$$arity=1),t.def(j,"$loglevel=",B=function(t){var e;return null==f.log&&(f.log=s),this.loglevel=u(e=a(R,"LOGLEVELS")["$[]"](t.$to_sym()))?e:a(R,"LOGLEVELS")["$[]"]("debug"),f.log.$message("logging messages up to "+a(R,"LOGLEVELS").$invert()["$[]"](this.loglevel))},B.$$arity=1),t.def(j,"$loglevel",M=function(){return a(R,"LOGLEVELS").$invert()["$[]"](this.loglevel)},M.$$arity=0),t.def(j,"$loglevel?",P=function(t){var e;return n(u(e=a(R,"LOGLEVELS")["$[]"](t))?e:a(R,"LOGLEVELS")["$[]"]("warning"),this.loglevel)},P.$$arity=1),t.def(j,"$loglevels",F=function(){return a(R,"LOGLEVELS").$keys()},F.$$arity=0),j.$private(),t.def(j,"$add_annotation",L=function(t,e,n,i){var a,c=s,l=s;return u(e)&&(c=e,l=u(a=n)?a:[c.$first(),r(c.$last(),1)],this.annotations["$<<"](o(["start_pos","end_pos","text","type"],{start_pos:c,end_pos:l,text:t,type:i}))),s},L.$$arity=4),t.def(j,"$write",T=function(t,e){return u(this["$loglevel?"](t))?(a(R,"Time").$now().$strftime("%H:%M:%S"),this.$puts(e)):s},T.$$arity=2)}(i[0],0,i),function(e,r,i){var o,l=c(e,r,"NodeLogger"),f=[l].concat(i);l.$$prototype.loglevel=s,t.def(l,"$write",o=function(t,e){var r,i;return i=u(r=a(f,"LOGLEVELS")["$[]"](t))?r:a(f,"LOGLEVELS")["$[]"]("warning"),u(n(i,this.loglevel))?(a(f,"Time").$now().$strftime("%H:%M:%S"),this.$puts(e)):s},o.$$arity=2)}(i[0],a(i,"Logger"),i),function(e,r,i){var o,f,$=c(e,r,"ConsoleLogger"),h=[$].concat(i);return $.$$prototype.loglevel=$.$$prototype.console=s,t.def($,"$initialize",o=function(e){var r,n=o.$$p,i=s,a=s;for(n&&(o.$$p=null),a=0,r=arguments.length,i=new Array(r);a<r;a++)i[a]=arguments[a];return l(this,t.find_super_dispatcher(this,"initialize",o,!1),i,n),this.console=e},o.$$arity=1),t.def($,"$write",f=function(t,e){var r,i,o=s;return i=u(r=a(h,"LOGLEVELS")["$[]"](t))?r:a(h,"LOGLEVELS")["$[]"]("warning"),u(n(i,this.loglevel))?(o=a(h,"Time").$now().$strftime("%H:%M:%S"),this.console.$write_html("<li class='"+t+"'><i class=\""+a(h,"LOGICONS")["$[]"](t)+"\"><span class='time'>"+o+"</span><span class='msg'>"+e+"</span></li>"),this.$puts(e)):s},f.$$arity=2),s&&"write"}(i[0],a(i,"Logger"),i)},Opal.modules.harpnotes=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}function n(t,e){return"number"==typeof t&&"number"==typeof e?t/e:t["$/"](e)}function i(t,e){return"number"==typeof t&&"number"==typeof e?t>e:t["$>"](e)}function s(t,e){return"number"==typeof t&&"number"==typeof e?t*e:t["$*"](e)}function a(t,e){return"number"==typeof t&&"number"==typeof e?t<e:t["$<"](e)}function o(t,e){return"number"==typeof t&&"number"==typeof e?t<=e:t["$<="](e)}t.top;var c=[],l=t.nil,u=t.const_get_qualified,f=t.const_get_relative,$=(t.breaker,t.slice,t.module),h=t.klass,p=t.send,d=t.truthy,_=t.hash2,m=t.gvars,y=t.hash,g=t.range;return t.add_stubs(["$attr_accessor","$first","$last","$to_json","$[]","$+","$class","$map","$-","$instance_variables","$instance_variable_get","$is_a?","$raise","$pitch","$beat","$duration","$first_in_part","$attr_reader","$nil?","$uniq","$flatten","$measure_start","$proxy_note","$alias_method","$each","$beat=","$get_proxy_object","$variant","$sheet_drawable","$prev_playable","$prev_playable=","$next_playable","$next_playable=","$!","$companion=","$visible?","$update_beats","$<<","$compact","$expanded_beat_maps","$select","$left","$right","$product","$min_by","$abs","$new","$max","$keys","$last_beat","$private","$inject","$index","$/","$time","$floor","$>","$start_pos","$error","$tuplet","$[]=","$index=","$==","$reset","$_check1","$center","$size","$conf_key","$origin","$_rect_overlap?","$empty?","$warning","$t","$count","$push","$shapes","$get","$clone","$dotted?","$dotted","$gsub","$ord","$length","$strip","$*","$to_f","$font_size=","$font_style=","$get_text_dimensions","$split","$match","$include","$lambda","$===","$_instrument_zipino","$_instrument_saitenspiel","$_instrument_okon","$_instrument_akkordzither","$parse","$join","$tap","$Vector2d","$conf_key=","$conf_value=","$draginfo=","$line_width=","$%","$_layout_prepare_options","$meta_data","$layout_debug_grid","$layout_images","$_layout_voices","$_layout_synclines","$_layout_sheetmarks","$_layout_sortmark","$_layout_instrument","$_layout_cutmarks","$_layout_legend","$_layout_zn_annotations","$_layout_lyrics","$_layout_sheet_annotations","$printer_config=","$pop","$strict=","$<=>","$<","$_layout_voice_handle_visibility","$_layout_voice_playables","$benchmark","$layout_barnumbers_countnotes","$_layout_voice_flowlines","$_layout_voice_subflowlines","$_layout_voice_chordsymbols","$_layout_voice_tuplets","$_layout_voice_slurs","$_layout_voice_gotos","$color=","$_laoyut_voice_repeatmarks","$_layout_voice_notebound_annotations","$create_annotation_background_rect","$decorations","$bardecorations","$reject","$each_with_index","$znid","$round","$-@","$to_a","$align=","$policy","$to","$from","$<=","$next_pitch","$prev_pitch","$to_s","$_mk_pitches_table","$start_with?","$downcase","$_mkflaps_pitches","$_mk_pitch_to_xpos","$call","$flaps_y","$to_i","$position","$style","$companion","$text","$include?","$make_repeatsign_annotation","$debug","$compute_vertical_cut","$make_path_from_jumpline","$tie_end?","$make_slur_path","$notes","$compute_color_by_variant_no","$message","$tie_start?","$slur_starts","$slur_ends","$tuplet_start?","$tuplet_end?","$make_annotated_bezier_path","$visible","$first_in_part?","$layout_playable","$proxy","$make_decorations_per_playable","$more_conf_keys","$visible=","$resolve_placeholder","$harpnote_options","$squeeze","$delete","$strftime","$now","$checksum","$upcase","$build_synch_points","$make_sheetmark_path","$compute_beat_compression","$values","$min","$synched_notes","$voices","$layout_voice","$_get_options_by_voice","$loglevel?","$check_annotations","$get_print_options","$initialize","$set_instrument_handlers","$&","$size_with_dot","$reverse","$compute_note_position","$!=","$count_note","$lyrics","$shift_eu=","$measure_start?","$measure_count","$align","$shift_eu?","$compute_beat_compression_1","$compute_beat_compression_2","$compute_beat_compression_3","$compute_beat_compression_10","$compute_beat_compression_0","$group_by","$sort","$beat_maps","$duration_to_id","$get_minc_factor","$notes_on_beat","$>=","$next_first_in_part","$sort_by","$layout_note","$layout_accord","$layout_pause","$convert_pitch_to_xpos","$compute_ellipse_properties_from_note","$layout_note_shift","$sheet_drawable=","$layout_note_flags","$times","$odd?","$check_duration","$shift","$unshift","$x","$y","$normalize","$to_sym","$start_pos_to_s","$end_pos","$rotate","$angle","$perpendicular","$scan"]),function(c,v){var b=[$(c,"Harpnotes")].concat(v);!function(s,a){var o=[$(s,"Music")].concat(a);!function(n,i,s){var a,o,c,u,$=h(n,null,"MusicEntity"),d=[$].concat(s);$.$$prototype.visible=$.$$prototype.start_pos=l,$.$attr_accessor("beat","conf_key","count_note","decorations","bardecorations","end_pos","next_pitch","next_first_in_part","next_playable","prev_pitch","prev_playable","start_pos","time","endtime","visible","variant","znid","origin","sheet_drawable"),t.def($,"$initialize",a=function(){return this.visible=!0,this.origin=l,this.decorations=[],this.bardecorations=[]},a.$$arity=0),t.def($,"$visible?",o=function(){return this.visible},o.$$arity=0),t.def($,"$start_pos_to_s",c=function(){return"["+this.start_pos.$first()+":"+this.start_pos.$last()+"]"},c.$$arity=0),t.def($,"$to_json",u=function(){var t;return f(d,"Hash")["$[]"](e([["class",this.$class()]],p(r(this.$instance_variables(),["@constructor","@toString"]),"map",[],(t=function(e){var r=t.$$s||this;return null==e&&(e=l),[e,r.$instance_variable_get(e)]},t.$$s=this,t.$$arity=1,t)))).$to_json()},u.$$arity=0)}(o[0],0,o),function(e,r,n){var i,s,a,o,c=h(e,r,"NonPlayable"),$=[c].concat(n);c.$$prototype.companion=l,c.$attr_accessor("companion"),t.def(c,"$companion=",i=function(t){return d(t["$is_a?"](u(u(f($,"Harpnotes"),"Music"),"Playable")))||this.$raise("Companion must be playable"),this.companion=t},i.$$arity=1),t.def(c,"$pitch",s=function(){try{return this.companion.$pitch()}catch(e){if(!t.rescue(e,[f($,"StandardError")]))throw e;try{return l}finally{t.pop_exception()}}},s.$$arity=0),t.def(c,"$beat",a=function(){try{return this.companion.$beat()}catch(e){if(!t.rescue(e,[f($,"StandardError")]))throw e;try{return l}finally{t.pop_exception()}}},a.$$arity=0),t.def(c,"$duration",o=function(){try{return this.companion.$duration()}catch(e){if(!t.rescue(e,[f($,"StandardError")]))throw e;try{return l}finally{t.pop_exception()}}},o.$$arity=0)}(o[0],f(o,"MusicEntity"),o),function(e,r,n){var i,s,a,o,c,u,f,$,d,_,m=h(e,r,"Playable");[m].concat(n);m.$$prototype.tie_end=m.$$prototype.tie_start=m.$$prototype.tuplet_start=m.$$prototype.tuplet_end=m.$$prototype.measure_start=l,m.$attr_accessor("first_in_part","jump_starts","jump_ends","slur_starts","slur_ends","tie_start","tie_end","duration","tuplet","tuplet_start","tuplet_end","shift","count_note","chord_symbol","lyrics","measure_count","measure_start"),t.def(m,"$initialize",i=function(){var e,r=i.$$p,n=l,s=l;for(r&&(i.$$p=null),s=0,e=arguments.length,n=new Array(e);s<e;s++)n[s]=arguments[s];return p(this,t.find_super_dispatcher(this,"initialize",i,!1),n,r),this.slur_starts=[],this.slur_ends=[],this.tie_start=!1,this.tie_end=!1,this.tuplet=1,this.tuplet_start=!1,this.tuplet_end=!1,this.count_note=l},i.$$arity=0),t.def(m,"$first_in_part?",s=function(){return this.$first_in_part()},s.$$arity=0),t.def(m,"$tie_end?",a=function(){return this.tie_end},a.$$arity=0),t.def(m,"$tie_start?",o=function(){return this.tie_start},o.$$arity=0),t.def(m,"$tuplet_start?",c=function(){return this.tuplet_start},c.$$arity=0),t.def(m,"$tuplet_end?",u=function(){return this.tuplet_end},u.$$arity=0),t.def(m,"$measure_start?",f=function(){return this.measure_start},f.$$arity=0),t.def(m,"$proxy_note",$=function(){return this},$.$$arity=0),t.def(m,"$left",d=function(){return this},d.$$arity=0),t.def(m,"$right",_=function(){return this},_.$$arity=0)}(o[0],f(o,"MusicEntity"),o),function(e,r,n){var i,s=h(e,r,"Note");[s].concat(n);s.$attr_reader("pitch","duration"),t.def(s,"$initialize",i=function(e,r){var n=i.$$p;return n&&(i.$$p=null),p(this,t.find_super_dispatcher(this,"initialize",i,!1),[],null),d(e["$nil?"]())&&this.$raise("trying to create a note with undefined pitch"),this.pitch=e,this.next_pitch=e,this.next_playable=this,this.prev_pitch=e,this.prev_playable=this,this.duration=r},i.$$arity=2)}(o[0],f(o,"Playable"),o),function(e,n,i){var s,a,o,c,u,$,_,m,y,g,v,b,A,x,w,k=h(e,n,"SynchPoint"),E=[k].concat(i);k.$$prototype.notes=l,k.$attr_reader("notes","synched_notes"),t.def(k,"$initialize",s=function(e,r){var n=s.$$p;return n&&(s.$$p=null),null==r&&(r=[]),p(this,t.find_super_dispatcher(this,"initialize",s,!1),[],null),d(e["$is_a?"](f(E,"Array")))||this.$raise("Notes must be an array"),this.notes=e,this.synched_notes=[e,r].$flatten().$uniq()},s.$$arity=-2),t.def(k,"$measure_start",a=function(){return this.$proxy_note().$measure_start()},a.$$arity=0),k.$alias_method("measure_start?","measure_start"),t.def(k,"$duration",o=function(){return this.$proxy_note().$duration()},o.$$arity=0),t.def(k,"$beat=",c=function(e){var n;return this.beat=e,p(this.notes,"each",[],((n=function(i){var s;n.$$s;return null==i&&(i=l),s=[e],p(i,"beat=",t.to_a(s)),s[r(s.length,1)]}).$$s=this,n.$$arity=1,n))},c.$$arity=1),t.def(k,"$pitch",u=function(){return this.$proxy_note().$pitch()},u.$$arity=0),t.def(k,"$proxy_note",$=function(){return this.$get_proxy_object(this.notes)},$.$$arity=0),t.def(k,"$variant",_=function(){return this.$proxy_note().$variant()},_.$$arity=0),t.def(k,"$sheet_drawable",m=function(){return this.$proxy_note().$sheet_drawable()},m.$$arity=0),t.def(k,"$prev_playable",y=function(){return this.$proxy_note().$prev_playable()},y.$$arity=0),t.def(k,"$prev_playable=",g=function(e){var n;return n=[e],p(this.$proxy_note(),"prev_playable=",t.to_a(n)),n[r(n.length,1)]},g.$$arity=1),t.def(k,"$next_playable",v=function(){return this.$proxy_note().$next_playable()},v.$$arity=0),t.def(k,"$next_playable=",b=function(e){var n;return n=[e],p(this.$proxy_note(),"next_playable=",t.to_a(n)),n[r(n.length,1)]},b.$$arity=1),t.def(k,"$get_proxy_object",A=function(t){return t.$last()},A.$$arity=1),t.def(k,"$left",x=function(){return this.notes.$first()},x.$$arity=0),t.def(k,"$right",w=function(){return this.notes.$last()},w.$$arity=0)}(o[0],f(o,"Playable"),o),function(e,r,n){var i,s,a,o=h(e,r,"Pause");[o].concat(n);o.$$prototype.visible=o.$$prototype.invisible=l,o.$attr_accessor("duration","pitch"),o.$attr_accessor("invisible"),t.def(o,"$initialize",i=function(e,r){var n=i.$$p;return n&&(i.$$p=null),p(this,t.find_super_dispatcher(this,"initialize",i,!1),[],null),d(e["$nil?"]())&&this.$raise("trying to create a rest with undefined pitch"),this.pitch=e,this.duration=r,this.next_playable=this,this.prev_pitch=e,this.prev_playable=this},i.$$arity=2),t.def(o,"$visible=",s=function(t){return this.visible=t},s.$$arity=1),t.def(o,"$visible?",a=function(){var t;return d(t=this.visible)?this.invisible["$!"]():t},a.$$arity=0)}(o[0],f(o,"Playable"),o),function(e,n,i){var s,a=h(e,n,"MeasureStart");[a].concat(i);t.def(a,"$initialize",s=function(e){var n,i=s.$$p;return i&&(s.$$p=null),p(this,t.find_super_dispatcher(this,"initialize",s,!1),[],null),n=[e],p(this,"companion=",t.to_a(n)),r(n.length,1),this.visible=e["$visible?"]()},s.$$arity=1)}(o[0],f(o,"NonPlayable"),o),function(e,r,n){var i,s=h(e,r,"NewPart");[s].concat(n);s.$attr_reader("name"),t.def(s,"$initialize",i=function(e,r){var n=i.$$p;return n&&(i.$$p=null),null==r&&(r=l),p(this,t.find_super_dispatcher(this,"initialize",i,!1),[],null),this.conf_key=r,this.name=e},i.$$arity=-2)}(o[0],f(o,"NonPlayable"),o),function(e,n,i){var s,a,o,c,u,f=h(e,n,"NoteBoundAnnotation");[f].concat(i);f.$$prototype.annotations=l,t.def(f,"$initialize",s=function(e,n,i){var a,o=s.$$p;return o&&(s.$$p=null),null==i&&(i=l),p(this,t.find_super_dispatcher(this,"initialize",s,!1),[],null),a=[e],p(this,"companion=",t.to_a(a)),r(a.length,1),this.conf_key=i,this.annotations=n},s.$$arity=-3),t.def(f,"$style",a=function(){var t;return d(t=this.annotations["$[]"]("style"))?t:"regular"},a.$$arity=0),t.def(f,"$text",o=function(){return this.annotations["$[]"]("text")},o.$$arity=0),t.def(f,"$position",c=function(){return this.annotations["$[]"]("pos")},c.$$arity=0),t.def(f,"$policy",u=function(){return this.annotations["$[]"]("policy")},u.$$arity=0)}(o[0],f(o,"NonPlayable"),o),function(e,n,i){var s,a,o,c,u,f=h(e,n,"Chordsymbol");[f].concat(i);f.$$prototype.annotations=l,t.def(f,"$initialize",s=function(e,n,i){var a,o=s.$$p;return o&&(s.$$p=null),null==i&&(i=l),p(this,t.find_super_dispatcher(this,"initialize",s,!1),[],null),a=[e],p(this,"companion=",t.to_a(a)),r(a.length,1),this.conf_key=i,this.annotations=n},s.$$arity=-3),t.def(f,"$style",a=function(){var t;return d(t=this.annotations["$[]"]("style"))?t:"regular"},a.$$arity=0),t.def(f,"$text",o=function(){return this.annotations["$[]"]("text")},o.$$arity=0),t.def(f,"$position",c=function(){return this.annotations["$[]"]("pos")},c.$$arity=0),t.def(f,"$policy",u=function(){return this.annotations["$[]"]("policy")},u.$$arity=0)}(o[0],f(o,"NonPlayable"),o),function(e,r,n){var i,s=h(e,r,"Goto"),a=[s].concat(n);s.$attr_reader("from","to","policy"),t.def(s,"$initialize",i=function(e,r,n){var s=i.$$p;return s&&(i.$$p=null),p(this,t.find_super_dispatcher(this,"initialize",i,!1),[],null),d(e["$is_a?"](u(u(f(a,"Harpnotes"),"Music"),"Playable")))||this.$raise("End point of Jump ("+e.$class()+") must be a Playable"),d(r["$is_a?"](u(u(f(a,"Harpnotes"),"Music"),"Playable")))||this.$raise("Start point of Jump ("+r.$class()+") must be a Playable"),this.from=e,this.to=r,this.policy=n,this.conf_key=n["$[]"]("conf_key")},i.$$arity=3)}(o[0],f(o,"MusicEntity"),o),function(e,r,n){var i,s=h(e,r,"BeatMap");[s].concat(n);s.$attr_accessor("index"),t.def(s,"$initialize",i=function(t){return this.index=t},i.$$arity=1)}(o[0],f(o,"Hash"),o),function(e,s,a){var o,c,u,$,y,g,v,b=h(e,null,"Song"),A=[b].concat(a);b.$$prototype.voices=b.$$prototype.beat_maps=b.$$prototype.meta_data=b.$$prototype.harpnote_options=l,b.$attr_reader("voices","beat_maps"),b.$attr_accessor("meta_data","harpnote_options","checksum"),t.def(b,"$to_json",o=function(){return _(["voices","beat_maps","meta_data","harpnote_options"],{voices:this.voices,beat_maps:this.beat_maps,meta_data:this.meta_data,harpnote_options:this.harpnote_options}).$to_json()},o.$$arity=0),t.def(b,"$initialize",c=function(t,e,r){return null==t&&(t=[]),null==e&&(e=8),null==r&&(r=_([],{})),this.voices=t,this.note_length_in_beats=e,this.meta_data=r,this.views=[],this.$update_beats()},c.$$arity=-1),t.def(b,"$<<",u=function(t){return this.voices["$<<"](t),this.$update_beats()},u.$$arity=1),t.def(b,"$build_synch_points",$=function(t){var e;return null==t&&(t=l),p(this.$expanded_beat_maps(),"map",[],(e=function(n){var i,s,a,o=e.$$s||this,c=l,u=l,$=l,h=l,_=l,m=l,y=l,g=l,v=l,b=l;return null==n&&(n=l),u=(c=p([n["$[]"](t.$first()),n["$[]"](t.$last())].$compact(),"select",[],((i=function(t){i.$$s;return null==t&&(t=l),t["$visible?"]()}).$$s=o,i.$$arity=1,i)))["$[]"](0),$=c["$[]"](1),d(d(s=u)?$:s)&&(h=u.$left(),_=u.$right(),m=$.$left(),y=$.$right(),g=[h,_].$product([m,y])),d(g)&&(v=p(g,"min_by",[],((a=function(t){a.$$s;return null==t&&(t=l),r(t.$last().$pitch(),t.$first().$pitch()).$abs()}).$$s=o,a.$$arity=1,a)),b=f(A,"SynchPoint").$new(v,g)),b},e.$$s=this,e.$$arity=1,e)).$flatten().$compact()},$.$$arity=-1),t.def(b,"$last_beat",y=function(){var t;return p(this.beat_maps,"map",[],(t=function(e){var r;t.$$s;return null==e&&(e=l),d(r=e.$keys().$max())?r:0},t.$$s=this,t.$$arity=1,t)).$max()},y.$$arity=0),t.def(b,"$expanded_beat_maps",g=function(){var e;return p(t.Range.$new(0,this.$last_beat(),!1),"map",[],((e=function(t){var r,n=e.$$s||this;return null==n.beat_maps&&(n.beat_maps=l),null==t&&(t=l),p(n.beat_maps,"map",[],((r=function(e){r.$$s;return null==e&&(e=l),e["$[]"](t)}).$$s=n,r.$$arity=1,r))}).$$s=this,e.$$arity=1,e))},g.$$arity=0),b.$private(),t.def(b,"$update_beats",v=function(){var e;return this.beat_maps=p(this.voices,"map",[],((e=function(s){var a,o,c=e.$$s||this,u=l;return null==s&&(s=l),u=0,p(p(s,"select",[],((a=function(t){a.$$s;return null==t&&(t=l),t["$is_a?"](f(A,"Playable"))}).$$s=c,a.$$arity=1,a)),"inject",[f(A,"BeatMap").$new(s.$index())],((o=function(e,a){o.$$s;var c,f,$=l,h=l;return null==m.log&&(m.log=l),null==e&&(e=l),null==a&&(a=l),c=(u=n(a.$time(),8)).$floor(0),f=r(u,c),d(i(f,0))&&($=a.$start_pos(),m.log.$error("unsupported tuplet "+a.$tuplet()+" "+f,$),u=c),h=[u,a],p(e,"[]=",t.to_a(h)),h[r(h.length,1)],h=[u],p(a,"beat=",t.to_a(h)),h[r(h.length,1)],h=[s.$index()],p(e,"index=",t.to_a(h)),h[r(h.length,1)],e}).$$s=c,o.$$arity=2,o))}).$$s=this,e.$$arity=1,e)),l},v.$$arity=0)}(o[0],0,o),function(e,r,n){var i,s,a,o,c=h(e,r,"Voice");[c].concat(n);c.$$prototype.show_voice=c.$$prototype.show_flowline=c.$$prototype.show_jumpline=l,c.$attr_accessor("index","name","show_voice","show_flowline","show_jumpline"),t.def(c,"$initialize",i=function(){var e,r=i.$$p,n=l,s=l;for(r&&(i.$$p=null),s=0,e=arguments.length,n=new Array(e);s<e;s++)n[s]=arguments[s];return this.show_voice=!0,this.show_flowline=!0,this.show_jumpline=!0,p(this,t.find_super_dispatcher(this,"initialize",i,!1),n,r)},i.$$arity=0),t.def(c,"$show_voice?",s=function(){return this.show_voice["$=="](!0)},s.$$arity=0),t.def(c,"$show_flowline?",a=function(){return this.show_flowline["$=="](!0)},a.$$arity=0),t.def(c,"$show_jumpline?",o=function(){return this.show_jumpline["$=="](!0)},o.$$arity=0)}(o[0],f(o,"Array"),o)}(b[0],b),function(n,a){var o=[$(n,"Drawing")].concat(a);!function(r,n,s){var a,o,c,u,$,_=h(r,null,"CollisionDetector"),y=[_].concat(s);_.$$prototype.coll_stack=l,t.def(_,"$initialize",a=function(){return this.$reset()},a.$$arity=0),t.def(_,"$check_annotations",o=function(t){var e,r;return p(p(t,"select",[],((e=function(t){e.$$s;return null==t&&(t=l),t["$is_a?"](f(y,"Annotation"))}).$$s=this,e.$$arity=1,e)),"each",[],((r=function(t){var e=r.$$s||this;return null==t&&(t=l),e.$_check1(t.$center(),t.$size(),t.$conf_key(),t.$origin())}).$$s=this,r.$$arity=1,r))},o.$$arity=1),t.def(_,"$reset",c=function(){return this.coll_stack=[]},c.$$arity=0),t.def(_,"$_check1",u=function(r,n,i,s){var a,o,c,u,$,h,_,g,v=l,b=l;if(null==m.log&&(m.log=l),o=r,u=null==(a=t.to_ary(o))[0]?l:a[0],$=null==a[1]?l:a[1],o=n,h=null==(a=t.to_ary(o))[0]?l:a[0],_=null==a[1]?l:a[1],g=[u,$,e(u,h),e($,_)],v=p(this.coll_stack,"select",[],((c=function(t){var e=c.$$s||this;return null==t&&(t=l),e["$_rect_overlap?"](t,g)}).$$s=this,c.$$arity=1,c)),b=[0,0],d(v["$empty?"]()));else{try{b=s["$[]"]("start_pos")}catch(e){if(!t.rescue(e,[f(y,"StandardError")]))throw e;try{m.log.$error("BUG: Annotation without origin "+"./harpnotes.rb".$force_encoding("US-ASCII")+" 780")}finally{t.pop_exception()}}m.log.$warning(e(f(y,"I18n").$t("annotations too close ["),v.$count()+"] "+i),b)}return this.coll_stack.$push(g),r},u.$$arity=4),t.def(_,"$_rect_overlap?",$=function(e,r){var n,s,a,o,c,u,f,$,h,p,_;return s=e,o=null==(n=t.to_ary(s))[0]?l:n[0],c=null==n[1]?l:n[1],u=null==n[2]?l:n[2],f=null==n[3]?l:n[3],s=r,$=null==(n=t.to_ary(s))[0]?l:n[0],h=null==n[1]?l:n[1],p=null==n[2]?l:n[2],_=null==n[3]?l:n[3],d(n=d(s=d(a=i(u,$))?i(p,o):a)?i(f,h):s)?i(_,c):n},$.$$arity=2)}(o[0],0,o),function(e,r,n){var i,s=h(e,null,"Sheet");[s].concat(n);s.$attr_reader("children","active_voices"),s.$attr_accessor("printer_config"),t.def(s,"$initialize",i=function(t,e){return null==m.conf&&(m.conf=l),this.children=t,this.active_voices=e,this.printer_config=m.conf["$[]"]("printer")},i.$$arity=2)}(o[0],0,o),function(r,n,i){var s,a,o,c=h(r,null,"CompoundDrawable");[c].concat(i);c.$$prototype.shapes=l,c.$attr_accessor("shapes","proxy"),t.def(c,"$initialize",s=function(t,e){return this.shapes=t,this.proxy=e},s.$$arity=2),t.def(c,"$push",a=function(t){return this.shapes["$<<"](t)},a.$$arity=1),t.def(c,"$merge",o=function(t){return this.shapes=e(this.shapes,t.$shapes())},o.$$arity=1)}(o[0],0,o),function(n,i,s){var a,o,c,u,f,$,_,y,g,v=h(n,null,"Drawable");[v].concat(s);v.$$prototype.visible=v.$$prototype.line_width=v.$$prototype.color=v.$$prototype.size=l,v.$attr_accessor("conf_key","conf_value","draginfo","color","size","more_conf_keys"),t.def(v,"$initialize",a=function(){return null==m.conf&&(m.conf=l),this.visible=!0,this.line_width=m.conf.$get("layout.LINE_THIN"),this.conf_key=l,this.more_conf_keys=[],this.color=m.conf.$get("layout.color.color_default"),this.size=[1,1]},a.$$arity=0),t.def(v,"$center",o=function(){return this.$raise("center not implemented for "+this.$class())},o.$$arity=0),t.def(v,"$visible?",c=function(){return this.visible},c.$$arity=0),t.def(v,"$visible=",u=function(t){return this.visible=t},u.$$arity=1),t.def(v,"$line_width=",f=function(t){return this.line_width=t},f.$$arity=1),t.def(v,"$line_width",$=function(){return this.line_width},$.$$arity=0),t.def(v,"$color=",_=function(t){return this.color=t},_.$$arity=1),t.def(v,"$color",y=function(){return this.color},y.$$arity=0),t.def(v,"$size_with_dot",g=function(){var n=l,i=l;return n=this.size.$clone(),d(this["$dotted?"]())&&(i=[0,e(n["$[]"](0),1)],p(n,"[]=",t.to_a(i)),i[r(i.length,1)]),n},g.$$arity=0)}(o[0],0,o),function(e,r,n){var i,s,a,o=h(e,r,"Symbol");[o].concat(n);o.$$prototype.dotted=o.$$prototype.hasbarover=l,o.$attr_accessor("dotted","hasbarover"),t.def(o,"$iniitalize",i=function(){var e,r=i.$$p,n=l,s=l;for(r&&(i.$$p=null),s=0,e=arguments.length,n=new Array(e);s<e;s++)n[s]=arguments[s];return p(this,t.find_super_dispatcher(this,"iniitalize",i,!1),n,r)},i.$$arity=0),t.def(o,"$dotted?",s=function(){return this.dotted},s.$$arity=0),t.def(o,"$hasbarover?",a=function(){return this.hasbarover},a.$$arity=0)}(o[0],f(o,"Drawable"),o),function(e,r,n){var i,s,a,o=h(e,r,"FlowLine");[o].concat(n);o.$$prototype.style=l,o.$attr_reader("from","to","style"),t.def(o,"$initialize",i=function(e,r,n){var s=i.$$p;return s&&(i.$$p=null),null==n&&(n="solid"),p(this,t.find_super_dispatcher(this,"initialize",i,!1),[],null),this.from=e,this.to=r,this.style=n},i.$$arity=-3),t.def(o,"$dashed?",s=function(){return this.style["$=="]("dashed")},s.$$arity=0),t.def(o,"$dotted?",a=function(){return this.style["$=="]("dotted")},a.$$arity=0)}(o[0],f(o,"Drawable"),o),function(e,r,n){var i,s=h(e,r,"Image");[s].concat(n);s.$attr_reader("url","llpos","height","opacity","origin"),t.def(s,"$initialize",i=function(t,e,r,n){return null==n&&(n=l),this.url=t,this.llpos=e,this.height=r,this.origin=l},i.$$arity=-4)}(o[0],f(o,"Drawable"),o),function(e,r,n){var i,s,a=h(e,r,"Path");[a].concat(n);a.$$prototype.fill=l,a.$attr_reader("path","style","origin"),t.def(a,"$initialize",i=function(e,r,n,s){var a=i.$$p;return a&&(i.$$p=null),null==r&&(r=l),null==n&&(n=l),null==s&&(s="solid"),p(this,t.find_super_dispatcher(this,"initialize",i,!1),[],null),this.path=e,this.fill=r,this.origin=n,this.style=s},i.$$arity=-2),t.def(a,"$filled?",s=function(){return this.fill["$=="]("filled")},s.$$arity=0)}(o[0],f(o,"Drawable"),o),function(e,r,n){var i,s,a,o,c,u=h(e,r,"Ellipse");[u].concat(n);u.$$prototype.size=u.$$prototype.fill=u.$$prototype.rect=l,u.$attr_reader("center","size","fill","origin","color"),t.def(u,"$initialize",i=function(e,r,n,s,a,o){var c=i.$$p;return c&&(i.$$p=null),null==n&&(n="filled"),null==s&&(s=!1),null==a&&(a=l),null==o&&(o=!1),p(this,t.find_super_dispatcher(this,"initialize",i,!1),[],null),this.center=e,this.size=r,this.fill=n,this.dotted=s,this.rect=o,this.origin=a},i.$$arity=-3),t.def(u,"$height",s=function(){return this.size.$last()},s.$$arity=0),t.def(u,"$dotted?",a=function(){return this.$dotted()},a.$$arity=0),t.def(u,"$filled?",o=function(){return this.fill["$=="]("filled")},o.$$arity=0),t.def(u,"$rect?",c=function(){return this.rect["$=="](!0)},c.$$arity=0)}(o[0],f(o,"Symbol"),o),function(e,n,a){var o,c,u,$,y,g=h(e,n,"Annotation"),v=[g].concat(a);g.$$prototype.text=g.$$prototype.style=g.$$prototype.center=g.$$prototype.shift_eu=l,g.$attr_reader("center","text","style","origin"),g.$attr_accessor("conf_key","conf_value","align","baseline","shift_eu"),t.def(g,"$initialize",o=function(e,r,n,s,a,c){var u,f,$=o.$$p,h=l;return null==m.log&&(m.log=l),$&&(o.$$p=null),null==n&&(n="regular"),null==s&&(s=l),null==a&&(a=l),null==c&&(c=_([],{})),p(this,t.find_super_dispatcher(this,"initialize",o,!1),[],null),f=r.$gsub(/[]/,_(["","","","","",""],{"":'"',"":'"',"":"'","":"'","":"-","":"-"})),(h=p(f,"gsub",[/./],((u=function(t){u.$$s;return null==t&&(t=l),d(i(t["$[]"](0).$ord(),255))?"":t}).$$s=this,u.$$arity=1,u)))["$=="](f)||(d(s)&&s["$[]"]("startChar"),m.log.$error("replaced unsupported characters with '' "+a,[1,1])),this.center=e,this.text=h,this.style=n,this.align="left",this.baseline="alphabetic",this.origin=s,this.conf_key=a,this.conf_value=c,this.shift_eu=!1},o.$$arity=-3),t.def(g,"$size_estimate",c=function(){var t,e=l,r=l,n=l;return null==m.conf&&(m.conf=l),null==m.log&&(m.log=l),d(d(t=this.text)?i(this.text.$strip().$length(),0):t)?(e=m.conf.$get("layout.FONT_STYLE_DEF."+this.style+".font_size"),d(e)||(e=10,m.log.$error("unsupported style for annotation: "+this.style)),r=s(e,m.conf.$get("layout.MM_PER_POINT").$to_f()),n=s(s(this.text.$length(),r),.55)):(n=(t=[1.5,2])[0],r=t[1]),[n,r]},c.$$arity=0),t.def(g,"$size",u=function(){var e,n,i=l,s=l,a=l;return null==m.conf&&(m.conf=l),null==m.log&&(m.log=l),d((null==(e=v[0].$$cvars["@@pdf"])?l:e)["$nil?"]())&&t.class_variable_set(v[0],"@@pdf",f(v,"JsPDF").$new("l","mm","a3")),i=m.conf.$get("layout.FONT_STYLE_DEF."+this.style+".font_size"),n=m.conf.$get("layout.FONT_STYLE_DEF."+this.style+".font_style"),d(i)||(i=10,m.log.$error("unsupported style for annotation: "+this.style)),s=[i],p(null==(e=v[0].$$cvars["@@pdf"])?l:e,"font_size=",t.to_a(s)),s[r(s.length,1)],s=[n],p(null==(e=v[0].$$cvars["@@pdf"])?l:e,"font_style=",t.to_a(s)),s[r(s.length,1)],[(a=(null==(e=v[0].$$cvars["@@pdf"])?l:e).$get_text_dimensions(this.text.$gsub("&tilde;","~").$split("\n")))["$[]"]("w"),a["$[]"]("h")]},u.$$arity=0),t.def(g,"$shift_eu=",$=function(e){var n=l;return null==m.conf&&(m.conf=l),d(e)&&d(/^[aoveu]$/.$match(this.text))?(this.shift_eu=!0,n=[1,r(this.center["$[]"](1),s(s(m.conf.$get("layout.FONT_STYLE_DEF."+this.style+".font_size"),m.conf.$get("layout.MM_PER_POINT").$to_f()),.25))],p(this.center,"[]=",t.to_a(n)),n[r(n.length,1)]):l},$.$$arity=1),t.def(g,"$shift_eu?",y=function(){return this.shift_eu},y.$$arity=0)}(o[0],f(o,"Drawable"),o),function(e,r,n){var i,s,a,o,c=h(e,r,"Glyph"),u=[c].concat(n);c.$$prototype.size=c.$$prototype.fill=l,c.$attr_reader("center","size","glyph","origin"),t.const_set(u[0],"GLYPHS",_(["rest_1","breath","rest_4","rest_8","rest_16","fermata","emphasis","error"],{rest_1:_(["d","w","h"],{d:[["M",-10,-5],["l",20,0],["l",0,10],["l",-20,0],["l",0,-10],["z"]],w:20,h:10}),breath:_(["d","w","h"],{d:[["M",0,0]],w:0,h:1}),rest_4:_(["d","w","h"],{d:[["M",-1,-10],["c",.12,-.06,.24,-.06,.36,-.03],["c",.09,.06,4.74,5.58,4.86,5.82],["c",.21,.39,.15,.78,-.15,1.26],["c",-.24,.33,-.72,.81,-1.62,1.56],["c",-.45,.36,-.87,.75,-.96,.84],["c",-.93,.99,-1.14,2.49,-.6,3.63],["c",.18,.39,.27,.48,1.32,1.68],["c",1.92,2.25,1.83,2.16,1.83,2.34],["c",0,.18,-.18,.36,-.36,.39],["c",-.15,0,-.27,-.06,-.48,-.27],["c",-.75,-.75,-2.46,-1.29,-3.39,-1.08],["c",-.45,.09,-.69,.27,-.9,.69],["c",-.12,.3,-.21,.66,-.24,1.14],["c",-.03,.66,.09,1.35,.3,2.01],["c",.15,.42,.24,.66,.45,.96],["c",.18,.24,.18,.33,.03,.42],["c",-.12,.06,-.18,.03,-.45,-.3],["c",-1.08,-1.38,-2.07,-3.36,-2.4,-4.83],["c",-.27,-1.05,-.15,-1.77,.27,-2.07],["c",.21,-.12,.42,-.15,.87,-.15],["c",.87,.06,2.1,.39,3.3,.9],["l",.39,.18],["l",-1.65,-1.95],["c",-2.52,-2.97,-2.61,-3.09,-2.7,-3.27],["c",-.09,-.24,-.12,-.48,-.03,-.75],["c",.15,-.48,.57,-.96,1.83,-2.01],["c",.45,-.36,.84,-.72,.93,-.78],["c",.69,-.75,1.02,-1.8,.9,-2.79],["c",-.06,-.33,-.21,-.84,-.39,-1.11],["c",-.09,-.15,-.45,-.6,-.81,-1.05],["c",-.36,-.42,-.69,-.81,-.72,-.87],["c",-.09,-.18,0,-.42,.21,-.51],["z"]],w:7.888,h:21.435}),rest_8:_(["d","w","h"],{d:[["M",-2,-6.7],["c",.66,-.09,1.23,.09,1.68,.51],["c",.27,.3,.39,.54,.57,1.26],["c",.09,.33,.18,.66,.21,.72],["c",.12,.27,.33,.45,.6,.48],["c",.12,0,.18,0,.33,-.09],["c",.39,-.18,1.32,-1.29,1.68,-1.98],["c",.09,-.21,.24,-.3,.39,-.3],["c",.12,0,.27,.09,.33,.18],["c",.03,.06,-.27,1.11,-1.86,6.42],["c",-1.02,3.48,-1.89,6.39,-1.92,6.42],["c",0,.03,-.12,.12,-.24,.15],["c",-.18,.09,-.21,.09,-.45,.09],["c",-.24,0,-.3,0,-.48,-.06],["c",-.09,-.06,-.21,-.12,-.21,-.15],["c",-.06,-.03,.15,-.57,1.68,-4.92],["c",.96,-2.67,1.74,-4.89,1.71,-4.89],["l",-.51,.15],["c",-1.08,.36,-1.74,.48,-2.55,.48],["c",-.66,0,-.84,-.03,-1.32,-.27],["c",-1.32,-.63,-1.77,-2.16,-1.02,-3.3],["c",.33,-.45,.84,-.81,1.38,-.9],["z"]],w:7.534,h:13.883}),rest_16:_(["d","w","h"],{d:[["M",-1.33,-11.12],["c",.66,-.09,1.23,.09,1.68,.51],["c",.27,.3,.39,.54,.57,1.26],["c",.09,.33,.18,.66,.21,.72],["c",.15,.39,.57,.57,.87,.42],["c",.39,-.18,1.2,-1.23,1.62,-2.07],["c",.06,-.15,.24,-.24,.36,-.24],["c",.12,0,.27,.09,.33,.18],["c",.03,.06,-.45,1.86,-2.67,10.17],["c",-1.5,5.55,-2.73,10.14,-2.76,10.17],["c",-.03,.03,-.12,.12,-.24,.15],["c",-.18,.09,-.21,.09,-.45,.09],["c",-.24,0,-.3,0,-.48,-.06],["c",-.09,-.06,-.21,-.12,-.21,-.15],["c",-.06,-.03,.12,-.57,1.44,-4.92],["c",.81,-2.67,1.47,-4.86,1.47,-4.89],["c",-.03,0,-.27,.06,-.54,.15],["c",-1.08,.36,-1.77,.48,-2.58,.48],["c",-.66,0,-.84,-.03,-1.32,-.27],["c",-1.32,-.63,-1.77,-2.16,-1.02,-3.3],["c",.72,-1.05,2.22,-1.23,3.06,-.42],["c",.3,.33,.42,.6,.6,1.38],["c",.09,.45,.21,.78,.33,.9],["c",.09,.09,.27,.18,.45,.21],["c",.12,0,.18,0,.33,-.09],["c",.33,-.15,1.02,-.93,1.41,-1.59],["c",.12,-.21,.18,-.39,.39,-1.08],["c",.66,-2.1,1.17,-3.84,1.17,-3.87],["c",0,0,-.21,.06,-.42,.15],["c",-.51,.15,-1.2,.33,-1.68,.42],["c",-.33,.06,-.51,.06,-.96,.06],["c",-.66,0,-.84,-.03,-1.32,-.27],["c",-1.32,-.63,-1.77,-2.16,-1.02,-3.3],["c",.33,-.45,.84,-.81,1.38,-.9],["z"]],w:9.724,h:21.383}),fermata:_(["d","w","h"],{d:[["M",-.75,-5.34],["c",.12,0,.45,-.03,.69,-.03],["c",2.91,-.03,5.55,1.53,7.41,4.35],["c",1.17,1.71,1.95,3.72,2.43,6.03],["c",.12,.51,.12,.57,.03,.69],["c",-.12,.21,-.48,.27,-.69,.12],["c",-.12,-.09,-.18,-.24,-.27,-.69],["c",-.78,-3.63,-3.42,-6.54,-6.78,-7.38],["c",-.78,-.21,-1.2,-.24,-2.07,-.24],["c",-.63,0,-.84,0,-1.2,.06],["c",-1.83,.27,-3.42,1.08,-4.8,2.37],["c",-1.41,1.35,-2.4,3.21,-2.85,5.19],["c",-.09,.45,-.15,.6,-.27,.69],["c",-.21,.15,-.57,.09,-.69,-.12],["c",-.09,-.12,-.09,-.18,.03,-.69],["c",.33,-1.62,.78,-3,1.47,-4.38],["c",1.77,-3.54,4.44,-5.67,7.56,-5.97],["z"],["M",-.5,1.5],["c",1.38,-.3,2.58,.9,2.31,2.25],["c",-.15,.72,-.78,1.35,-1.47,1.5],["c",-1.38,.27,-2.58,-.93,-2.31,-2.31],["c",.15,-.69,.78,-1.29,1.47,-1.44],["z"]],w:19.748,h:11.289}),emphasis:_(["d","w","h"],{d:[["M",-6.45,-3.69],["c",.06,-.03,.15,-.06,.18,-.06],["c",.06,0,2.85,.72,6.24,1.59],["l",6.33,1.65],["c",.33,.06,.45,.21,.45,.51],["c",0,.3,-.12,.45,-.45,.51],["l",-6.33,1.65],["c",-3.39,.87,-6.18,1.59,-6.21,1.59],["c",-.21,0,-.48,-.24,-.51,-.45],["c",0,-.15,.06,-.36,.18,-.45],["c",.09,-.06,.87,-.27,3.84,-1.05],["c",2.04,-.54,3.84,-.99,4.02,-1.02],["c",.15,-.06,1.14,-.24,2.22,-.42],["c",1.05,-.18,1.92,-.36,1.92,-.36],["c",0,0,-.87,-.18,-1.92,-.36],["c",-1.08,-.18,-2.07,-.36,-2.22,-.42],["c",-.18,-.03,-1.98,-.48,-4.02,-1.02],["c",-2.97,-.78,-3.75,-.99,-3.84,-1.05],["c",-.12,-.09,-.18,-.3,-.18,-.45],["c",.03,-.15,.15,-.3,.3,-.39],["z"]],w:13.5,h:7.5}),error:_(["d","w","h"],{d:[["M",-10,-5],["l",0,10],["l",20,-10],["l",0,10],["z"]],w:20,h:10})})),t.def(c,"$initialize",i=function(e,r,n,s,a,o,c){var $=i.$$p,h=l;return null==m.log&&(m.log=l),$&&(i.$$p=null),null==s&&(s=f(u,"FALSE")),null==a&&(a=l),null==o&&(o=l),null==c&&(c=_([],{})),p(this,t.find_super_dispatcher(this,"initialize",i,!1),[],null),h=f(u,"GLYPHS")["$[]"](n),d(h)||(d(h)||m.log.$error("BUG: unsupported glyph "+n),h=f(u,"GLYPHS")["$[]"]("error")),this.center=e,this.glyph_name=n,this.glyph=h,this.size=r,this.dotted=s,this.origin=a,this.filled=!0,this.conf_key=o,this.conf_value=c,this.coll_stack=[]},i.$$arity=-4),t.def(c,"$height",s=function(){return this.size.$last()},s.$$arity=0),t.def(c,"$dotted?",a=function(){return this.$dotted()},a.$$arity=0),t.def(c,"$filled?",o=function(){return this.fill["$=="]("filled")},o.$$arity=0)}(o[0],f(o,"Symbol"),o)}(b[0],b),function(c,v){var b=[$(c,"Layout")].concat(v);!function(c,$,v){var b,A,x,w,k,E,S,N,I,C,O,B,M,P,F,L,T,j,R,D,z,U,q,H,Q,Y,G,V,J,X,W,K,Z,tt,et,rt,nt,it,st,at,ot,ct,lt,ut,ft,$t,ht,pt,dt,_t,mt,yt,gt,vt,bt,At,xt,wt,kt,Et,St,Nt,It,Ct,Ot,Bt=h(c,null,"Default"),Mt=[Bt].concat(v);Bt.$$prototype.placeholders=Bt.$$prototype.print_options_hash=Bt.$$prototype.print_options_raw=Bt.$$prototype.color_default=Bt.$$prototype.slur_index=Bt.$$prototype.draw_instrument=Bt.$$prototype.instrument_shape=Bt.$$prototype.bottom_annotation_positions=Bt.$$prototype.uri=Bt.$$prototype.y_offset=Bt.$$prototype.beat_spacing=Bt.$$prototype.conf_beat_resolution=Bt.$$prototype.layout_minc=Bt.$$prototype.instrument_orientation=Bt.$$prototype.pitch_to_xpos=Bt.$$prototype.color_variant1=Bt.$$prototype.color_variant2=Bt.$$prototype.print_options_keys=l,Bt.$include(u(f(Mt,"Harpnotes"),"Music")),Bt.$include(u(f(Mt,"Harpnotes"),"Drawing")),Bt.$attr_accessor("uri","placeholders"),t.const_set(Mt[0],"MM_PER_POINT",.3),t.def(Bt,"$initialize",b=function(){return null==m.conf&&(m.conf=l),this.beat_spacing=n(s(m.conf.$get("layout.Y_SCALE"),1),m.conf.$get("layout.BEAT_RESOLUTION")),this.slur_index=_([],{}),this.y_offset=5,this.conf_beat_resolution=m.conf.$get("layout.BEAT_RESOLUTION"),this.layout_minc=_([],{}),this.color_default=m.conf.$get("layout.color.color_default"),this.color_variant1=m.conf.$get("layout.color.color_variant1"),this.color_variant2=m.conf.$get("layout.color.color_variant2"),this.draw_instrument=l,this.draw_instrument_shape=l,d(this.placeholders)?l:this.placeholders=_([],{})},b.$$arity=0),t.def(Bt,"$set_instrument_handlers",A=function(t){var r,n,i,a,o,c;return null==m.conf&&(m.conf=l),n=m.conf["$[]"]("layout.X_OFFSET"),i=m.conf["$[]"]("layout.X_SPACING"),a=m.conf.$get("layout.PITCH_OFFSET"),this.bottom_annotation_positions=[[150,289],[325,289],[380,289]],this.pitch_to_xpos=p(this,"lambda",[],((r=function(t){r.$$s;return null==t&&(t=l),e(s(e(a,t),i),n)}).$$s=this,r.$$arity=1,r)),o=m.conf["$[]"]("layout.instrument"),"Zipino"["$==="](o)?this.$_instrument_zipino(a,n,i):"saitenspiel"["$==="](o)?this.$_instrument_saitenspiel(a,n,i):"okon-f"["$==="](o)||"okon-g"["$==="](o)||"okon-c"["$==="](o)||"okon-d"["$==="](o)||"okon-open"["$==="](o)?this.$_instrument_okon(a,n,i,t):"21-strings-a-f"["$==="](o)?this.bottom_annotation_positions=[[190,287],[190,290],[250,290]]:"18-strings-b-e"["$==="](o)?this.bottom_annotation_positions=[[210,287],[210,290],[280,290]]:("akkordzither"["$==="](o)||"Akkordzither"["$==="](o))&&this.$_instrument_akkordzither(a,n,i,t),c=m.conf.$get("extract."+t+".instrument_shape"),d(c)?this.instrument_shape=f(Mt,"JSON").$parse(c):this.instrument_shape=l},A.$$arity=1),t.def(Bt,"$layout_images",x=function(e,n){var i,s=l,a=l;return s=[],a=e["$[]"]("images"),d(a["$nil?"]())||p(a,"each",[],((i=function(e,a){var o,c=i.$$s||this,$=l;return null==m.resources&&(m.resources=l),null==e&&(e=l),null==a&&(a=l),a["$[]"]("show")["$=="](!0)?($=m.resources["$[]"](a["$[]"]("imagename")),d($["$is_a?"](f(Mt,"Array")))&&($=$.$join()),d($)?s.$push(p(u(u(f(Mt,"Harpnotes"),"Drawing"),"Image").$new($,r(c.$Vector2d(a["$[]"]("pos")),[0,a["$[]"]("height")]),a["$[]"]("height")),"tap",[],((o=function(i){o.$$s;var s=l;return null==i&&(i=l),s=["extract."+n+".images."+e+".pos"],p(i,"conf_key=",t.to_a(s)),s[r(s.length,1)],s=[a["$[]"]("pos")],p(i,"conf_value=",t.to_a(s)),s[r(s.length,1)],s=[_(["handler"],{handler:"annotation"})],p(i,"draginfo=",t.to_a(s)),s[r(s.length,1)]}).$$s=c,o.$$arity=1,o))):l):l}).$$s=this,i.$$arity=2,i)),s},x.$$arity=2),t.def(Bt,"$layout_debug_grid",w=function(){var e,i,a,o,c,$,h=l,d=l,m=l;return h=_(["size","emphasis","line","emphline"],{size:1,emphasis:10,line:.02,emphline:.2}),c=h["$[]"]("size"),$=s(h["$[]"]("emphasis"),c),d=[420,297],m=[],p(p(t.Range.$new(0,n(d.$first(),c),!1),"map",[],((e=function(t){e.$$s;return null==t&&(t=l),s(t,c)}).$$s=this,e.$$arity=1,e)),"each",[],((i=function(e){i.$$s;var n,s=l;return null==e&&(e=l),n=u(u(f(Mt,"Harpnotes"),"Drawing"),"Path").$new([["M",e,0],["l",0,d.$last()]]),s=[h["$[]"]("line")],p(n,"line_width=",t.to_a(s)),s[r(s.length,1)],e["$%"]($)["$=="](0)&&(s=[h["$[]"]("emphline")],p(n,"line_width=",t.to_a(s)),s[r(s.length,1)]),m["$<<"](n)}).$$s=this,i.$$arity=1,i)),p(p(t.Range.$new(0,n(d.$last(),c),!1),"map",[],((a=function(t){a.$$s;return null==t&&(t=l),s(t,c)}).$$s=this,a.$$arity=1,a)),"each",[],((o=function(e){o.$$s;var n,i=l;return null==e&&(e=l),n=u(u(f(Mt,"Harpnotes"),"Drawing"),"Path").$new([["M",0,e],["l",d.$first(),0]]),i=[h["$[]"]("line")],p(n,"line_width=",t.to_a(i)),i[r(i.length,1)],e["$%"]($)["$=="](0)&&(i=[h["$[]"]("emphline")],p(n,"line_width=",t.to_a(i)),i[r(i.length,1)]),m["$<<"](n)}).$$s=this,o.$$arity=1,o)),m},w.$$arity=0),t.def(Bt,"$layout",k=function(n,i,s,a){var o,c,$,h,_,y,g,v,b,A,x,w,k,E,S,N,I,C,O,B=this,M=l,P=l;return null==m.conf&&(m.conf=l),null==i&&(i=l),null==s&&(s=0),null==a&&(a="A4"),B.$_layout_prepare_options(s),$=d(o=n.$meta_data()["$[]"]("title"))?o:"untitled",h=n.$meta_data()["$[]"]("filename"),_=d(m.conf["$[]"]("layout.grid"))?B.$layout_debug_grid():[],y=B.$layout_images(B.print_options_hash,s),c=B.$_layout_voices(i,n,s),g=null==(o=t.to_ary(c))[0]?l:o[0],v=null==o[1]?l:o[1],b=null==o[2]?l:o[2],A=B.$_layout_synclines(n,v),M=B.$_layout_sheetmarks(B.print_options_hash,s),P=B.print_options_hash["$[]"]("sortmark"),d(P["$[]"]("show"))&&M["$<<"](B.$_layout_sortmark($,P)),x=B.$_layout_instrument(),w=B.$_layout_cutmarks(a),k=B.$_layout_legend(n,s,$),E=B.$_layout_zn_annotations(h,n),S=B.$_layout_lyrics(n,s),N=B.$_layout_sheet_annotations(s),I=e(e(e(e(e(e(e(e(e(e(y,_),A),b),k),N),E),S),M),w),x),C=u(u(f(Mt,"Harpnotes"),"Drawing"),"Sheet").$new(I,g),O=[m.conf["$[]"]("printer")],p(C,"printer_config=",t.to_a(O)),r(O.length,1),m.conf.$pop(),m.conf.$pop(),C},k.$$arity=-2),t.def(Bt,"$get_print_options",E=function(e){var n,i,s=l;return null==m.conf&&(m.conf=l),null==m.log&&(m.log=l),s=f(Mt,"Confstack").$new(),n=[!1],p(s,"strict=",t.to_a(n)),r(n.length,1),s.$push(m.conf.$get("extract.0")),i=m.conf.$get("extract."+e),d(i)?s.$push(i):m.log.$warning("selected print variant ["+e+"] not available using [0]: '"+s.$get("title")+"'"),d(s["$[]"]("layout.beams"))&&s.$push(_(["layout"],{layout:_(["DURATION_TO_STYLE"],{DURATION_TO_STYLE:m.conf["$[]"]("layout.DURATION_TO_BEAMS")})})),s},E.$$arity=1),t.const_set(Mt[0],"NOTE_POSITION_LOOKUP",_(["11","12","13","21","22","23","31","32","33"],{11:["r","r"],12:["r","l"],13:["r","l"],21:["r","r"],22:["r","l"],23:["l","l"],31:["l","r"],32:["l","r"],33:["l","l"]})),t.def(Bt,"$compute_note_position",S=function(t,r,n,s){var o,c;return o=e(t["$<=>"](r),2),c=e(n["$<=>"](r),2),d(a(r,10))?["r","r"]:d(i(r,410))?["l","l"]:f(Mt,"NOTE_POSITION_LOOKUP")["$[]"](""+o+c)},S.$$arity=4),t.def(Bt,"$layout_voice",N=function(n,i,s,a){var o,c,u,$,h,_,y,g,v,b,A,x,w,k,E,S,N,I,C,O,B,M,P,F,L,T,j=this,R=l,D=l,z=l,U=l,q=l;return null==m.log&&(m.log=l),null==m.settings&&(m.settings=l),null==m.conf&&(m.conf=l),j.print_options_keys=j.print_options_raw.$keys(),A=a["$[]"]("voice_nr"),x=p(n,"select",[],((o=function(t){o.$$s;return null==t&&(t=l),t["$is_a?"](f(Mt,"Playable"))}).$$s=j,o.$$arity=1,o)),j.$_layout_voice_handle_visibility(x,a),u=j.$_layout_voice_playables(i,x,s,a,A),w=null==(c=t.to_ary(u))[0]?l:c[0],k=null==c[1]?l:c[1],u=p(m.log,"benchmark",["countnotes / barnumbers"],(($=function(){return($.$$s||this).$layout_barnumbers_countnotes(x,s,a,A)}).$$s=j,$.$$arity=0,$)),R=null==(c=t.to_ary(u))[0]?l:c[0],D=null==c[1]?l:c[1],E=m.settings["$[]"]("flowconf")["$=="]("true"),S=m.conf["$[]"]("defaults.notebound.flowline"),z=j.$_layout_voice_flowlines(S,E,s,a,n,A),U=j.$_layout_voice_subflowlines(S,E,s,a,n,A),d(a["$[]"]("subflowline"))||(U=[]),d(a["$[]"]("flowline"))||(z=[]),d(a["$[]"]("countnotes"))||(D=[]),d(a["$[]"]("barnumbers"))||(R=[]),N=d(a["$[]"]("chords"))?j.$_layout_voice_chordsymbols(s,a,n):[],I=j.$_layout_voice_tuplets(x,s,a,A),C=j.$_layout_voice_slurs(x),q=j.$_layout_voice_gotos(s,a,n),d(a["$[]"]("jumpline"))||(q=[]),O=j.color_default,p(q,"each",[],((h=function(e){var n;h.$$s;return null==e&&(e=l),n=[O],p(e,"color=",t.to_a(n)),n[r(n.length,1)]}).$$s=j,h.$$arity=1,h)),B=j.$_laoyut_voice_repeatmarks(s,a,n,A),M=j.$_layout_voice_notebound_annotations(s,a,n),P=p(p(w,"select",[],((_=function(t){_.$$s;return null==t&&(t=l),t["$is_a?"](f(Mt,"Annotation"))}).$$s=j,_.$$arity=1,_)),"map",[],((y=function(t){var e=y.$$s||this;return null==t&&(t=l),e.$create_annotation_background_rect(t,.2)}).$$s=j,y.$$arity=1,y)),F=p(R,"map",[],((g=function(t){var e=g.$$s||this;return null==t&&(t=l),e.$create_annotation_background_rect(t,.2)}).$$s=j,g.$$arity=1,g)),L=p(D,"map",[],((v=function(t){var e=v.$$s||this;return null==t&&(t=l),e.$create_annotation_background_rect(t,-.05)}).$$s=j,v.$$arity=1,v)),T=p(e(e(M,B),N).$compact(),"map",[],((b=function(t){var e=b.$$s||this;return null==t&&(t=l),e.$create_annotation_background_rect(t,.5)}).$$s=j,b.$$arity=1,b)),e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(z,U),C),I),k),L),D),F),R),P),w),q),T),M),N),B).$compact()},N.$$arity=4),t.def(Bt,"$make_decorations_per_playable",I=function(i,a,o,c,$){var h,y,g,v,b,A=l,x=l,w=l,k=l,E=l,S=l;return null==m.conf&&(m.conf=l),A=m.conf["$[]"]("layout.DECORATIIONS_AS_ANNOTATIONS"),x=e(x=e(x=[],p(i.$decorations(),"map",[],((h=function(t){h.$$s;return null==t&&(t=l),[t,"n"]}).$$s=this,h.$$arity=1,h))),p(i.$bardecorations(),"map",[],((y=function(t){y.$$s;return null==t&&(t=l),[t,"b"]}).$$s=this,y.$$arity=1,y))),x=p(x,"reject",[],((g=function(t){g.$$s;return null==t&&(t=l),t["$empty?"]()}).$$s=this,g.$$arity=1,g)),d(x["$empty?"]())||(w=d(i.$measure_start())?2:1,k=.8,E=p(a.$size(),"map",[],((v=function(t){v.$$s;return null==t&&(t=l),s(t,k)}).$$s=this,v.$$arity=1,v)),S=[],p(x,"each_with_index",[],((b=function(s,h){var y,g,v,x,N,I=b.$$s||this,C=l,O=l,B=l,M=l,P=l,F=l,L=l;return null==m.conf&&(m.conf=l),null==s&&(s=l),null==h&&(h=l),v="notebound.decoration.v_"+$+".t_"+i.$znid()+"."+h,N=(x="extract."+o+"."+v)+".pos",C=function(){try{return c["$[]"]("print_options_raw")["$[]"](v+".pos")}catch(e){if(!t.rescue(e,[f(Mt,"StandardError")]))throw e;try{return l}finally{t.pop_exception()}}}(),d(C)||(C=[0,r(n(a.$size().$last()["$-@"](),k),w).$round()]),O=[e(a.$center().$first(),C.$first()),e(a.$center().$last(),C.$last())],B=m.conf["$[]"](x+".show"),M=A["$[]"](s["$[]"](0)),d(M)?(O=e(I.$Vector2d(M["$[]"]("pos")),O).$to_a(),P=d(y=m.conf["$[]"](x+".style"))?y:M["$[]"]("style"),F=u(u(f(Mt,"Harpnotes"),"Drawing"),"Annotation").$new(O,M["$[]"]("text"),P,i.$origin(),N,C),L=[d(y=M["$[]"]("align"))?y:"left"],p(F,"align=",t.to_a(L)),L[r(L.length,1)]):F=u(u(f(Mt,"Harpnotes"),"Drawing"),"Glyph").$new(O,E,s["$[]"](0),!1,l,N,C),p(F,"tap",[],((g=function(e){g.$$s;return null==e&&(e=l),L=[_(["handler"],{handler:"annotation"})],p(e,"draginfo=",t.to_a(L)),L[r(L.length,1)]}).$$s=I,g.$$arity=1,g)),d(d(y=B["$nil?"]())?y:B)?S.$push([F]):l}).$$s=this,b.$$arity=2,b))),S},I.$$arity=5),t.def(Bt,"$make_repeatsign_annotation",C=function(n,i,s,a,c){var $,h,m,y,g,v,b,A=l,x=l,w=l,k=l,E=l;return d($=n.$policy()["$[]"]("from_anchor"))?$:"after",d($=n.$policy()["$[]"]("to_anchor"))?$:"before",i["$=="]("begin")?(A=n.$to(),x=n.$to()["$=="](n.$from())?"left":d(o(A.$pitch(),A.$next_pitch()))?"left":"right"):(A=n.$from(),x=n.$to()["$=="](n.$from())?"right":d(o(A.$prev_pitch(),A.$pitch()))?"right":"left"),m="notebound.repeat_"+i.$to_s()+".v_"+c+"."+A.$znid(),g="extract."+s+"."+(y=m+".pos"),w=a["$[]"]("repeatsigns")["$[]"](x),k=function(){try{return a["$[]"]("print_options_raw")["$[]"](y)}catch(e){if(!t.rescue(e,[f(Mt,"StandardError")]))throw e;try{return l}finally{t.pop_exception()}}}(),d(k)||(k=w["$[]"]("pos")),v=d($=a["$[]"]("print_options_raw")["$[]"](m+".text"))?$:w["$[]"]("text"),b=d($=a["$[]"]("print_options_raw")["$[]"](m+".style"))?$:w["$[]"]("style"),E=e(this.$Vector2d(A.$sheet_drawable().$center()),k),p(u(u(f(Mt,"Harpnotes"),"Drawing"),"Annotation").$new(E.$to_a(),v,b,A.$origin(),g,k),"tap",[],((h=function(e){var n;h.$$s;return null==e&&(e=l),n=[_(["handler"],{handler:"annotation"})],p(e,"draginfo=",t.to_a(n)),n[r(n.length,1)]}).$$s=this,h.$$arity=1,h))},C.$$arity=5),Bt.$private(),t.def(Bt,"$_mkflaps_pitches",O=function(e){var n,i,s=l,a=l;return s=this.$_mk_pitches_table(),i=_([],{}),a=_([],{}),p(e.$split(" ").$each_with_index(),"each",[],((n=function(e,o){n.$$s;var c,u=l;return null==e&&(e=l),null==o&&(o=l),u=[c=s["$[]"](e),o],p(i,"[]=",t.to_a(u)),u[r(u.length,1)],d(e["$start_with?"]("*"))?(u=[c,o],p(a,"[]=",t.to_a(u)),u[r(u.length,1)]):l}).$$s=this,n.$$arity=2,n)),[i,a.$keys()]},O.$$arity=1),t.def(Bt,"$_mk_pitches_table",B=function(){var n,i=l;return i=_(["C","*C","C#","CIS","D","*D","D#","DIS","DES","DB","E","EB","ES","F","*F","F#","FIS","G","*G","G#","GIS","GES","GB","A","*A","A#","AIS","AS","AB","H","B","HB","BB","*HB","*BB"],{C:60,"*C":61,"C#":61,CIS:61,D:62,"*D":63,"D#":63,DIS:63,DES:61,DB:61,E:64,EB:63,ES:63,F:65,"*F":66,"F#":66,FIS:66,G:67,"*G":68,"G#":68,GIS:68,GES:66,GB:66,A:69,"*A":70,"A#":70,AIS:70,AS:68,AB:68,H:71,B:71,HB:70,BB:70,"*HB":71,"*BB":71}),p(i.$keys(),"each",[],((n=function(s){n.$$s;var a,o=l;return null==s&&(s=l),a=i["$[]"](s),o=[e(s,","),r(a,12)],p(i,"[]=",t.to_a(o)),o[r(o.length,1)],o=[e(s,",,"),r(a,24)],p(i,"[]=",t.to_a(o)),o[r(o.length,1)],o=[s.$downcase(),e(a,12)],p(i,"[]=",t.to_a(o)),o[r(o.length,1)],o=[e(s.$downcase(),","),a],p(i,"[]=",t.to_a(o)),o[r(o.length,1)],o=[e(s.$downcase(),",,"),r(a,12)],p(i,"[]=",t.to_a(o)),o[r(o.length,1)],o=[e(s.$downcase(),",,,"),r(a,24)],p(i,"[]=",t.to_a(o)),o[r(o.length,1)],o=[e(s,"'"),e(a,12)],p(i,"[]=",t.to_a(o)),o[r(o.length,1)],o=[e(s,"''"),e(a,24)],p(i,"[]=",t.to_a(o)),o[r(o.length,1)],o=[e(s,"'''"),e(a,36)],p(i,"[]=",t.to_a(o)),o[r(o.length,1)],o=[e(s.$downcase(),"'"),e(a,24)],p(i,"[]=",t.to_a(o)),o[r(o.length,1)],o=[e(s.$downcase(),"''"),e(a,36)],p(i,"[]=",t.to_a(o)),o[r(o.length,1)],o=[e(s.$downcase(),"'''"),e(a,48)],p(i,"[]=",t.to_a(o)),o[r(o.length,1)]}).$$s=this,n.$$arity=1,n)),i},B.$$arity=0),t.def(Bt,"$_instrument_akkordzither",M=function(e,r,n,i){var s,a,o,c,$;return null==m.conf&&(m.conf=l),a=this.$_mkflaps_pitches(m.conf["$[]"]("extract."+i+".stringnames.text")),c=null==(s=t.to_ary(a))[0]?l:s[0],$=null==s[1]?l:s[1],this.pitch_to_xpos=this.$_mk_pitch_to_xpos(e,r,n,c),this.draw_instrument=p(this,"lambda",[],((o=function(){var t,e=o.$$s||this,r=l;return r=[],p($,"each",[],((t=function(e){var n=t.$$s||this;return null==n.pitch_to_xpos&&(n.pitch_to_xpos=l),null==e&&(e=l),r.$push(u(u(f(Mt,"Harpnotes"),"Drawing"),"Annotation").$new([n.pitch_to_xpos.$call(e),n.$flaps_y()["$[]"](e)],"*","large"))}).$$s=e,t.$$arity=1,t))}).$$s=this,o.$$arity=0,o)),this.bottom_annotation_positions=[[150,287],[150,290],[260,290]]},M.$$arity=4),t.def(Bt,"$_mk_pitch_to_xpos",P=function(t,r,n,i){var a;return p(this,"lambda",[],((a=function(o){a.$$s;var c,u=l;return null==o&&(o=l),c=i["$[]"](e(o,t)),u=n["$-@"](),d(c)&&(u=e(s(c,n),r)),u}).$$s=this,a.$$arity=1,a))},P.$$arity=4),t.def(Bt,"$_instrument_okon",F=function(n,i,s,a){var o,c,$,h,d,g,v=l,b=l,A=l,x=l,w=l;return null==m.conf&&(m.conf=l),null==a&&(a=0),v="",b="",g=m.conf["$[]"]("layout.instrument"),"okon-f"["$==="](g)?(b="55 57 58 60 62 64 65 67 69 70 72 74 76 77 79 81 82 84",v=""):"okon-g"["$==="](g)?(b="55 57 59 60 62 64 66 67 69 71 72 74 76 78 79 81 83 84",v="      59          66       71          78       83 "):"okon-c"["$==="](g)?(b="55 57 59 60 62 64 65 67 69 71 72 74 76 77 79 81 83 84",v="      59                   71                   83"):"okon-d"["$==="](g)&&(b="55 57 59 61 62 64 66 67 69 71 73 74 76 78 79 81 83 85",v="      59 61       66       71 73       78       83"),A=_([],{}),"open"["$=="](m.conf["$[]"]("extract."+a+".layout.tuning"))?(c=this.$_mkflaps_pitches(m.conf["$[]"]("extract."+a+".stringnames.text")),A=null==(o=t.to_ary(c))[0]?l:o[0],x=null==o[1]?l:o[1]):(A=f(Mt,"Hash")["$[]"](p(b.$split(" ").$each_with_index(),"map",[],(($=function(t,e){$.$$s;return null==t&&(t=l),null==e&&(e=l),[t.$to_i(),e]}).$$s=this,$.$$arity=2,$))),x=p(v.$split(" "),"map",[],((h=function(t){h.$$s;return null==t&&(t=l),t.$to_i()}).$$s=this,h.$$arity=1,h))),this.pitch_to_xpos=this.$_mk_pitch_to_xpos(n,i,s,A),w=y(59,7,61,7,66,7,71,7,73,20,78,65,83,110),this.bottom_annotation_positions=[[i,290],[e(i,200),290],[e(i,270),290]],this.draw_instrument=p(this,"lambda",[],((d=function(){var n,s,a,o=d.$$s||this,c=l;return null==m.conf&&(m.conf=l),c=[],p(x,"each",[],((n=function(t){var e=n.$$s||this;return null==e.pitch_to_xpos&&(e.pitch_to_xpos=l),null==t&&(t=l),c.$push(u(u(f(Mt,"Harpnotes"),"Drawing"),"Annotation").$new([e.pitch_to_xpos.$call(t),w["$[]"](t)],"*","large"))}).$$s=o,n.$$arity=1,n)),s=u(u(f(Mt,"Harpnotes"),"Drawing"),"Path").$new([["M",r(i,15),280],["L",r(i,15),0],["M",e(i,135),0],["L",e(i,290),157],["L",e(i,290),280]],"open"),a=[m.conf.$get("layout.LINE_MEDIUM")],p(s,"line_width=",t.to_a(a)),r(a.length,1),c.$push(s)}).$$s=this,d.$$arity=0,d))},F.$$arity=-4),t.def(Bt,"$_instrument_saitenspiel",L=function(n,i,a){var o,c;return this.pitch_to_xpos=p(this,"lambda",[],((o=function(t){o.$$s;var r=l,c=l;return null==t&&(t=l),r=(r=f(Mt,"Hash")["$[]"]([[31,0],[36,1],[38,2],[40,3],[41,4],[43,5],[45,6],[47,7],[48,8],[50,9]]))["$[]"](e(t,n)),c=a["$-@"](),d(r)&&(c=e(s(r,a),i)),c}).$$s=this,o.$$arity=1,o)),this.bottom_annotation_positions=[[i,287],[i,290],[e(i,100),290]],this.draw_instrument=p(this,"lambda",[],((c=function(){var n,s;c.$$s;return null==m.conf&&(m.conf=l),n=u(u(f(Mt,"Harpnotes"),"Drawing"),"Path").$new([["M",e(i,30),6],["L",e(i,180),81],["L",e(i,180),216],["L",e(i,30),291]],"open"),s=[m.conf.$get("layout.LINE_MEDIUM")],p(n,"line_width=",t.to_a(s)),r(s.length,1),[n]}).$$s=this,c.$$arity=0,c))},L.$$arity=3),t.def(Bt,"$_instrument_zipino",T=function(n,i,a){var o,c,$,h=l;return"54 55 57 59 60 62 64 66 67 69 71 72 74 76 78",h=f(Mt,"Hash")["$[]"](p("54 55 57 59 60 62 64 66 67 69 71 72 74 76 78".$split(" ").$each_with_index(),"map",[],((o=function(t,e){o.$$s;return null==t&&(t=l),null==e&&(e=l),[t.$to_i(),e]}).$$s=this,o.$$arity=2,o))),this.pitch_to_xpos=p(this,"lambda",[],((c=function(t){c.$$s;var r=l,o=l;return null==t&&(t=l),r=h["$[]"](e(t,n)),o=a["$-@"](),d(r["$nil?"]())||(o=e(s(r,a),i)),o}).$$s=this,c.$$arity=1,c)),this.bottom_annotation_positions=[[i,287],[i,290],[e(i,100),290]],this.draw_instrument=p(this,"lambda",[],(($=function(){var n,s;$.$$s;return null==m.conf&&(m.conf=l),n=u(u(f(Mt,"Harpnotes"),"Drawing"),"Path").$new([["M",e(i,30),20],["L",e(i,190),100],["M",e(i,190),200],["L",e(i,30),281]],"open"),s=[m.conf.$get("layout.LINE_MEDIUM")],p(n,"line_width=",t.to_a(s)),r(s.length,1),[n]}).$$s=this,$.$$arity=0,$)),this.instrument_orientation="horizontal"},T.$$arity=3),t.def(Bt,"$_layout_voice_notebound_annotations",j=function(n,i,s){var a,o;return p(p(s,"select",[],((a=function(t){a.$$s;return null==t&&(t=l),t["$is_a?"](f(Mt,"NoteBoundAnnotation"))}).$$s=this,a.$$arity=1,a)),"map",[],((o=function(s){var a,c,$,h,m=o.$$s||this,y=l,g=l,v=l,b=l,A=l,x=l;return null==s&&(s=l),$=e(s.$conf_key(),".pos"),y=i["$[]"]("print_options_raw").$get(e(s.$conf_key(),".show")),g=!!d(y["$nil?"]())||y,d($)?(v="extract."+n+"."+$,b=function(){try{return i["$[]"]("print_options_raw").$get($)}catch(e){if(!t.rescue(e,[f(Mt,"StandardError")]))throw e;try{return l}finally{t.pop_exception()}}}(),d(b)||(b=s.$position())):(b=s.$position(),v=l),h=d(a=i["$[]"]("print_options_raw").$get(e(s.$conf_key(),".style")))?a:s.$style(),A=e(m.$Vector2d(s.$companion().$sheet_drawable().$center()),b),x=p(u(u(f(Mt,"Harpnotes"),"Drawing"),"Annotation").$new(A.$to_a(),s.$text(),h,s.$companion().$origin(),v,b),"tap",[],((c=function(e){var n;c.$$s;return null==e&&(e=l),n=[_(["handler"],{handler:"annotation"})],p(e,"draginfo=",t.to_a(n)),n[r(n.length,1)]}).$$s=m,c.$$arity=1,c)),d((a=s.$policy()["$=="]("Goto"))?i["$[]"]("jumpline")["$!"]():s.$policy()["$=="]("Goto"))&&(x=l),g["$=="](!1)&&(x=l),x}).$$s=this,o.$$arity=1,o))},j.$$arity=3),t.def(Bt,"$_layout_voice_chordsymbols",R=function(n,i,s){var a,o;return p(p(s,"select",[],((a=function(t){a.$$s;return null==t&&(t=l),t["$is_a?"](f(Mt,"Chordsymbol"))}).$$s=this,a.$$arity=1,a)),"map",[],((o=function(s){var a,c,$,h,m,y=o.$$s||this,g=l,v=l,b=l,A=l,x=l,w=l,k=l;return null==s&&(s=l),g=i["$[]"]("chords"),$=e(s.$conf_key(),".pos"),v=i["$[]"]("print_options_raw").$get(e(s.$conf_key(),".show")),b=!!d(v["$nil?"]())||v,h=g["$[]"]("pos"),d($)?(A="extract."+n+"."+$,x=function(){try{return i["$[]"]("print_options_raw").$get($)}catch(e){if(!t.rescue(e,[f(Mt,"StandardError")]))throw e;try{return l}finally{t.pop_exception()}}}(),d(x)||(x=h)):(x=h,A=l),m=d(a=g["$[]"]("style"))?a:s.$style(),w=e(y.$Vector2d(s.$companion().$sheet_drawable().$center()),x),k=p(u(u(f(Mt,"Harpnotes"),"Drawing"),"Annotation").$new(w.$to_a(),s.$text(),m,s.$companion().$origin(),A,x),"tap",[],((c=function(e){var n;c.$$s;return null==e&&(e=l),n=[_(["handler"],{handler:"annotation"})],p(e,"draginfo=",t.to_a(n)),n[r(n.length,1)]}).$$s=y,c.$$arity=1,c)),d((a=s.$policy()["$=="]("Goto"))?i["$[]"]("jumpline")["$!"]():s.$policy()["$=="]("Goto"))&&(k=l),b["$=="](!1)&&(k=l),k}).$$s=this,o.$$arity=1,o))},R.$$arity=3),t.def(Bt,"$_laoyut_voice_repeatmarks",D=function(t,e,r,n){var i,s,a=l;return a=[],d(e["$[]"]("repeatsigns")["$[]"]("voices")["$include?"](e["$[]"]("voice_nr")))&&(a=p(p(r,"select",[],(i=function(t){var e;i.$$s;return null==t&&(t=l),d(e=t["$is_a?"](f(Mt,"Goto")))?t.$policy()["$[]"]("is_repeat"):e},i.$$s=this,i.$$arity=1,i)),"map",[],(s=function(r){var i,a=s.$$s||this;return null==r&&(r=l),i=a.$make_repeatsign_annotation(r,"begin",t,e,n),[a.$make_repeatsign_annotation(r,"end",t,e,n),i]},s.$$s=this,s.$$arity=1,s)).$flatten()),a},D.$$arity=4),t.def(Bt,"$_layout_voice_gotos",z=function(n,a,o){var c,$;return p(p(o,"select",[],(c=function(t){c.$$s;return null==t&&(t=l),t["$is_a?"](f(Mt,"Goto"))},c.$$s=this,c.$$arity=1,c)),"map",[],($=function(o){var c,h,y,g,v,b,A,x,w=$.$$s||this,k=l,E=l,S=l,N=l,I=l,C=l,O=l,B=l,M=l;return null==m.log&&(m.log=l),null==m.conf&&(m.conf=l),null==o&&(o=l),d(o.$conf_key())&&(k="extract."+n+"."+o.$conf_key(),E=a["$[]"]("print_options_raw")["$[]"](o.$conf_key()),d(E)||(S=k.$gsub(/(.*)\.(\d+)\.(\d+)\.(\w+)/,"\\1.\\2.\\4"),E=a["$[]"]("print_options_raw")["$[]"](S))),d(E)||(E=o.$policy()["$[]"]("distance")),d(E)||(E=1),y=!E["$=="](0),d(i(E,0))&&(E=r(E,1)),N=d(c=o.$policy()["$[]"]("from_anchor"))?c:"after",I=d(c=o.$policy()["$[]"]("to_anchor"))?c:"before",g=d(c=o.$policy()["$[]"]("vertical_anchor"))?c:"from",m.log.$debug("vertical line x offset: "+E+" "+"./harpnotes.rb".$force_encoding("US-ASCII")+":2063"),v=s(e(E,.5),m.conf.$get("layout.X_SPACING")),C=o.$from().$sheet_drawable(),O=o.$to().$sheet_drawable(),d(m.conf["$[]"]("layout.bottomup"))&&(N=(B=_(["before","after"],{before:"after",after:"before"}))["$[]"](N),I=B["$[]"](I)),b=w.$compute_vertical_cut(C,O),A=_(["from","to","vertical","vertical_anchor","padding","xspacing","jumpline_anchor","verticalcut"],{from:_(["center","size","anchor"],{center:C.$center(),size:C.$size(),anchor:N}),to:_(["center","size","anchor"],{center:O.$center(),size:O.$size(),anchor:I}),vertical:v,vertical_anchor:g,padding:o.$policy()["$[]"]("padding"),xspacing:m.conf["$[]"]("layout.X_SPACING"),jumpline_anchor:m.conf["$[]"]("layout.jumpline_anchor"),verticalcut:b}),M=u(u(f(Mt,"Harpnotes"),"Layout"),"Default").$make_path_from_jumpline(A),x=_(["handler","jumpline","xspacing"],{handler:"jumpline",jumpline:A,xspacing:m.conf.$get("layout.X_SPACING")}),d(y)?d(d(c=o.$policy()["$[]"]("is_repeat"))?a["$[]"]("repeatsigns")["$[]"]("voices")["$include?"](a["$[]"]("voice_nr")):c)?l:[p(u(u(f(Mt,"Harpnotes"),"Drawing"),"Path").$new(M["$[]"](0),l,o.$from()),"tap",[],(h=function(e){h.$$s;var n=l;return null==m.conf&&(m.conf=l),null==e&&(e=l),n=[k],p(e,"conf_key=",t.to_a(n)),n[r(n.length,1)],n=[E],p(e,"conf_value=",t.to_a(n)),n[r(n.length,1)],n=[m.conf.$get("layout.LINE_THICK")],p(e,"line_width=",t.to_a(n)),n[r(n.length,1)],n=[x],p(e,"draginfo=",t.to_a(n)),n[r(n.length,1)]},h.$$s=w,h.$$arity=1,h)),u(u(f(Mt,"Harpnotes"),"Drawing"),"Path").$new(M["$[]"](1),"filled",o.$from()),u(u(f(Mt,"Harpnotes"),"Drawing"),"Path").$new(M["$[]"](2),"filled",o.$from())]:l},$.$$s=this,$.$$arity=1,$)).$flatten().$compact()},z.$$arity=3),t.def(Bt,"$_layout_voice_slurs",U=function(n){var i,s=l,a=l;return s=["first_playable",n.$first()],p(this.slur_index,"[]=",t.to_a(s)),s[r(s.length,1)],a=n.$first(),p(n,"inject",[[]],((i=function(n,o){var c,$,h,_,y=i.$$s||this,g=l,v=l,b=l,A=l;return null==y.slur_index&&(y.slur_index=l),null==m.conf&&(m.conf=l),null==n&&(n=l),null==o&&(o=l),d(o["$tie_end?"]())&&(g=e([a.$sheet_drawable().$size()["$[]"](0),o.$sheet_drawable().$size()["$[]"](0)].$max(),.5),v=e(y.$Vector2d(a.$sheet_drawable().$center()),[g,-.5]),b=e(y.$Vector2d(o.$sheet_drawable().$center()),[g,.5]),A=d(m.conf["$[]"]("layout.bottomup"))?y.$make_slur_path(b,v):y.$make_slur_path(v,b),d(o["$is_a?"](u(u(f(Mt,"Harpnotes"),"Music"),"SynchPoint")))?p(o.$notes(),"each_with_index",[],((c=function(i,$){var h,d=c.$$s||this,_=l;null==m.log&&(m.log=l),null==i&&(i=l),null==$&&($=l);try{return v=a.$notes()["$[]"]($),g=e([v.$sheet_drawable().$size()["$[]"](0),i.$sheet_drawable().$size()["$[]"](0)].$max(),.5),v=e(d.$Vector2d(v.$sheet_drawable().$center()),[g,-.5]),b=e(d.$Vector2d(i.$sheet_drawable().$center()),[g,.5]),A=d.$make_slur_path(v,b),n.$push(p(u(u(f(Mt,"Harpnotes"),"Drawing"),"Path").$new(A),"tap",[],((h=function(e){var n=h.$$s||this;return null==m.conf&&(m.conf=l),null==e&&(e=l),s=[m.conf.$get("layout.LINE_THICK")],p(e,"line_width=",t.to_a(s)),s[r(s.length,1)],s=[n.$compute_color_by_variant_no(o.$variant())],p(e,"color=",t.to_a(s)),s[r(s.length,1)]}).$$s=d,h.$$arity=1,h)))}catch(e){if(!t.rescue(e,[f(Mt,"Exception")]))throw e;_=e;try{return m.log.$error(_.$message()+" tied chords which doesn't have same number of notes",i.$start_pos())}finally{t.pop_exception()}}}).$$s=y,c.$$arity=2,c)):n.$push(p(u(u(f(Mt,"Harpnotes"),"Drawing"),"Path").$new(A),"tap",[],(($=function(e){var n=$.$$s||this;return null==m.conf&&(m.conf=l),null==e&&(e=l),s=[m.conf.$get("layout.LINE_THICK")],p(e,"line_width=",t.to_a(s)),s[r(s.length,1)],s=[n.$compute_color_by_variant_no(o.$variant())],p(e,"color=",t.to_a(s)),s[r(s.length,1)]}).$$s=y,$.$$arity=1,$)))),d(o["$tie_start?"]())&&(a=o),p(o.$slur_starts(),"each",[],((h=function(e){var n=h.$$s||this;return null==n.slur_index&&(n.slur_index=l),null==e&&(e=l),s=[e,o],p(n.slur_index,"[]=",t.to_a(s)),s[r(s.length,1)]}).$$s=y,h.$$arity=1,h)),s=[o.$slur_starts().$first(),o],p(y.slur_index,"[]=",t.to_a(s)),s[r(s.length,1)],p(o.$slur_ends(),"each",[],((_=function(i){var a,c,$,h=_.$$s||this,y=l;return null==h.slur_index&&(h.slur_index=l),null==m.conf&&(m.conf=l),null==i&&(i=l),y=d(a=h.slur_index["$[]"](i))?a:h.slur_index["$[]"]("first_playable"),v=e(h.$Vector2d(y.$sheet_drawable().$center()),[3,0]),b=e(h.$Vector2d(o.$sheet_drawable().$center()),[3,0]),$=h.$make_slur_path(v,b),d(m.conf.$get("layout.SHOW_SLUR"))?n.$push(p(u(u(f(Mt,"Harpnotes"),"Drawing"),"Path").$new($),"tap",[],((c=function(e){c.$$s;return null==m.conf&&(m.conf=l),null==e&&(e=l),s=[m.conf.$get("layout.LINE_MEDIUM")],p(e,"line_width=",t.to_a(s)),s[r(s.length,1)]}).$$s=h,c.$$arity=1,c))):l}).$$s=y,_.$$arity=1,_)),n}).$$s=this,i.$$arity=2,i))},U.$$arity=1),t.def(Bt,"$_layout_voice_tuplets",q=function(n,i,s,a){var o,c=l,$=l;return c=n.$first(),$=[],p(n,"inject",[[]],((o=function(n,h){var y,g,v,b,A,x,w=o.$$s||this,k=l,E=l,S=l,N=l,I=l,C=l,O=l,B=l,M=l,P=l,F=l,L=l,T=l,j=l,R=l,D=l,z=l;if(null==m.conf&&(m.conf=l),null==n&&(n=l),null==h&&(h=l),d(h["$tuplet_start?"]())&&(c=h),d(c)&&$.$push(h.$time()),d(h["$tuplet_end?"]())){k="notebound.tuplet.v_"+a+"."+c.$znid(),E="extract."+i+"."+k,S="pos",(N=f(Mt,"Confstack").$new()).$push(m.conf["$[]"]("defaults.notebound.tuplet"));try{N.$push(s["$[]"]("print_options_raw")["$[]"](k))}catch(e){if(!t.rescue(e,[f(Mt,"StandardError")]))throw e;t.pop_exception()}I=w.$Vector2d(c.$sheet_drawable().$center()),C=w.$Vector2d(h.$sheet_drawable().$center()),g=w.$make_annotated_bezier_path([I,C],N),O=null==(y=t.to_ary(g))[0]?l:y[0],B=null==y[1]?l:y[1],M=null==y[2]?l:y[2],P=null==y[3]?l:y[3],F=e(B,function(){try{return N["$[]"]("pos")}catch(e){if(!t.rescue(e,[f(Mt,"StandardError")]))throw e;try{return[0,0]}finally{t.pop_exception()}}}()),L=p(r(F,B).$to_a(),"map",[],((v=function(t){v.$$s;return null==t&&(t=l),t.$round(0)}).$$s=w,v.$$arity=1,v)),T=p(w,"lambda",[],((b=function(t){b.$$s;return null==t&&(t=l),l}).$$s=w,b.$$arity=1,b)),N["$[]"]("show")["$=="](!1)||(j=e(E,".*"),R=d(y=s["$[]"]("print_options_raw")["$[]"]("tuplets.style"))?y:"small",D=_(["handler","p1","p2","cp1","cp2","mp","tuplet_options","conf_key","callback"],{handler:"tuplet",p1:I.$to_a(),p2:C.$to_a(),cp1:M.$to_a(),cp2:P.$to_a(),mp:B,tuplet_options:N,conf_key:E,callback:T}),z=(z=d(y=s["$[]"]("print_options_raw")["$[]"]("tuplets.text"))?y:h.$tuplet().$to_s()).$gsub("{{tuplet}}",h.$tuplet().$to_s()),n.$push(p(u(u(f(Mt,"Harpnotes"),"Drawing"),"Path").$new(O),"tap",[],((A=function(e){A.$$s;var n=l;return null==m.conf&&(m.conf=l),null==e&&(e=l),n=[j],p(e,"conf_key=",t.to_a(n)),n[r(n.length,1)],n=[m.conf.$get("layout.LINE_THIN")],p(e,"line_width=",t.to_a(n)),n[r(n.length,1)],n=[D],p(e,"draginfo=",t.to_a(n)),n[r(n.length,1)]}).$$s=w,A.$$arity=1,A))),n.$push(p(u(u(f(Mt,"Harpnotes"),"Drawing"),"Annotation").$new(F.$to_a(),z,R,c.$origin(),e(E,"."+S),L.$to_a()),"tap",[],((x=function(e){var n;x.$$s;return null==e&&(e=l),n=[_(["handler"],{handler:"annotation"})],p(e,"draginfo=",t.to_a(n)),n[r(n.length,1)]}).$$s=w,x.$$arity=1,x)))),$=[],c=l}return n}).$$s=this,o.$$arity=2,o))},q.$$arity=4),t.def(Bt,"$_layout_voice_subflowlines",H=function(n,i,s,a,o,c){var $,h,m=l;return m=l,p(p(o,"select",[],($=function(t){var e;$.$$s;return null==t&&(t=l),d(e=t["$is_a?"](f(Mt,"Playable")))?e:t["$is_a?"](f(Mt,"SynchPoint"))},$.$$s=this,$.$$arity=1,$)),"map",[],(h=function(o){var $,y,g,v=h.$$s||this,b=l,A=l,x=l,w=l,k=l,E=l,S=l,N=l,I=l,C=l,O=l,B=l,M=l,P=l,F=l;if(null==o&&(o=l),d(a["$[]"]("synched_notes")["$include?"](o.$proxy_note())));else{if(b=l,d(d($=d(y=m["$nil?"]()["$!"]())?m.$visible():y)?o.$visible():$))if(A="notebound.flowline.v_"+c,x=d($=a["$[]"]("print_options_raw")["$[]"](A))?$:_([],{}),w=""+o.$znid(),k=x["$[]"](w),d(d($=k)?$:i["$=="](!0))){S=e(E="extract."+s+"."+A+"."+w,".*"),N=v.$Vector2d(m.$sheet_drawable().$center()),I=v.$Vector2d(o.$sheet_drawable().$center()),(C=f(Mt,"Confstack").$new()).$push(n);try{C.$push(k)}catch(e){if(!t.rescue(e,[f(Mt,"StandardError")]))throw e;t.pop_exception()}y=v.$make_annotated_bezier_path([N,I],C),O=null==($=t.to_ary(y))[0]?l:$[0],B=null==$[1]?l:$[1],M=null==$[2]?l:$[2],P=null==$[3]?l:$[3],F=i["$=="](!0)?_(["handler","p1","p2","cp1","cp2","mp","tuplet_options","conf_key","callback"],{handler:"tuplet",p1:N.$to_a(),p2:I.$to_a(),cp1:M.$to_a(),cp2:P.$to_a(),mp:B,tuplet_options:C,conf_key:E,callback:l}):l,b=p(u(u(f(Mt,"Harpnotes"),"Drawing"),"Path").$new(O,l,l,"dotted"),"tap",[],((g=function(e){g.$$s;var n=l;return null==e&&(e=l),n=[S],p(e,"conf_key=",t.to_a(n)),n[r(n.length,1)],n=[F],p(e,"draginfo=",t.to_a(n)),n[r(n.length,1)]}).$$s=v,g.$$arity=1,g))}else b=f(Mt,"FlowLine").$new(m.$sheet_drawable(),o.$sheet_drawable(),"dotted");d(o["$first_in_part?"]())&&(b=l)}return m=o,b},h.$$s=this,h.$$arity=1,h)).$compact()},H.$$arity=6),t.def(Bt,"$_layout_voice_flowlines",Q=function(n,i,s,a,o,c){var $,h,y,g,v=l,b=l;return v=l,g="notebound.flowline.v_"+c,b=d($=a["$[]"]("print_options_raw")["$[]"](g))?$:_([],{}),p(p(o,"select",[],(h=function(t){h.$$s;return null==t&&(t=l),t["$is_a?"](f(Mt,"Playable"))},h.$$s=this,h.$$arity=1,h)),"map",[],(y=function(a){var o,c,$,h=y.$$s||this,A=l,x=l,w=l,k=l,E=l,S=l,N=l,I=l,C=l,O=l,B=l,M=l,P=l,F=l;if(null==m.conf&&(m.conf=l),null==a&&(a=l),A=l,d(v["$nil?"]()));else{if(d(!0))if(x=""+a.$znid(),w=b["$[]"](x),d(d(o=w)?o:i["$=="](!0))){E=e(k="extract."+s+"."+g+"."+x,".*"),S=h.$Vector2d(v.$sheet_drawable().$center()),N=h.$Vector2d(a.$sheet_drawable().$center()),(I=f(Mt,"Confstack").$new()).$push(n);try{I.$push(w)}catch(e){if(!t.rescue(e,[f(Mt,"StandardError")]))throw e;t.pop_exception()}c=h.$make_annotated_bezier_path([S,N],I),C=null==(o=t.to_ary(c))[0]?l:o[0],O=null==o[1]?l:o[1],B=null==o[2]?l:o[2],M=null==o[3]?l:o[3],P=i["$=="](!0)?_(["handler","p1","p2","cp1","cp2","mp","tuplet_options","conf_key","callback"],{handler:"tuplet",p1:S.$to_a(),p2:N.$to_a(),cp1:B.$to_a(),cp2:M.$to_a(),mp:O,tuplet_options:I,conf_key:k,callback:l}):l,A=p(u(u(f(Mt,"Harpnotes"),"Drawing"),"Path").$new(C),"tap",[],(($=function(e){$.$$s;var n=l;return null==e&&(e=l),n=[E],p(e,"conf_key=",t.to_a(n)),n[r(n.length,1)],n=[P],p(e,"draginfo=",t.to_a(n)),n[r(n.length,1)]}).$$s=h,$.$$arity=1,$))}else A=u(u(f(Mt,"Harpnotes"),"Drawing"),"FlowLine").$new(v.$sheet_drawable(),a.$sheet_drawable());F=[m.conf.$get("layout.LINE_MEDIUM")],p(A,"line_width=",t.to_a(F)),F[r(F.length,1)],d(v["$visible?"]())||(A=l)}return d(a["$first_in_part?"]())&&(A=l),d(a["$visible?"]())||(A=l),v=a,A},y.$$s=this,y.$$arity=1,y)).$compact()},Q.$$arity=6),t.def(Bt,"$_layout_voice_playables",Y=function(t,e,r,n,i){var s,a,o=l;return o=[],a=p(e,"map",[],(s=function(e){var a,c,u,$=s.$$s||this,h=l,p=l;return null==e&&(e=l),c="notebound.nconf.v_"+i+".t_"+e.$time(),u="extract."+r+"."+c,p=(h=$.$layout_playable(e,t,u)).$proxy(),d(d(a=e.$decorations()["$nil?"]())?e.$bardecorations()["$nil?"]():a)?o.$push([]):o.$push($.$make_decorations_per_playable(e,p,r,n,i)),p.$more_conf_keys().$push(_(["conf_key","text","icon","value"],{conf_key:p.$conf_key().$gsub(/\.[^\.]+$/,"")+".nshift",text:f(Mt,"I18n").$t("shift left"),icon:"fa fa-arrow-left",value:-.5})),p.$more_conf_keys().$push(_(["conf_key","text","icon","value"],{conf_key:p.$conf_key().$gsub(/\.[^\.]+$/,"")+".nshift",text:f(Mt,"I18n").$t("shift right"),icon:"fa fa-arrow-right",value:.5})),p.$more_conf_keys().$push(_(["text","icon","value"],{text:"---",icon:"fa fa-arrows-v",value:.5})),p.$more_conf_keys().$push(_(["conf_key","text","icon"],{conf_key:"extract."+r+".notebound.minc."+e.$time()+".minc_f",text:f(Mt,"I18n").$t("Edit Minc"),icon:"fa fa-arrows-v"})),p.$more_conf_keys().$push(_(["conf_key","text","icon","value"],{conf_key:"extract."+r+".notebound.minc."+e.$time()+".minc_f",text:f(Mt,"I18n").$t("increase Minc"),icon:"fa fa-arrow-down",value:.5})),p.$more_conf_keys().$push(_(["conf_key","text","icon","value"],{conf_key:"extract."+r+".notebound.minc."+e.$time()+".minc_f",text:f(Mt,"I18n").$t("decrease Minc"),icon:"fa fa-arrow-up",value:-.5})),h.$shapes()},s.$$s=this,s.$$arity=1,s)).$flatten().$compact(),[o=o.$flatten().$compact(),a]},Y.$$arity=5),t.def(Bt,"$_layout_voice_handle_visibility",G=function(e,n){var i,s=l;return d(n["$[]"]("nonflowrest"))?l:(s=l,p(e,"each",[],((i=function(e){i.$$s;var a,o,c=l;return null==e&&(e=l),d(d(a=e["$is_a?"](f(Mt,"Pause")))?n["$[]"]("flowline")["$!"]():a)&&(c=[!1],p(e,"visible=",t.to_a(c)),c[r(c.length,1)]),d(d(a=d(o=e["$is_a?"](f(Mt,"Pause")))?n["$[]"]("subflowline")["$!"]():o)?n["$[]"]("flowline")["$!"]():a)&&(c=[!1],p(e,"visible=",t.to_a(c)),c[r(c.length,1)]),d(d(a=d(o=n["$[]"]("flowline")["$!"]())?e.$visible():o)?n["$[]"]("synched_notes")["$include?"](e.$proxy_note())["$!"]():a)&&(d(s["$nil?"]())||(c=[!0],p(s,"visible=",t.to_a(c)),c[r(c.length,1)])),s=e}).$$s=this,i.$$arity=1,i)))},G.$$arity=2),t.def(Bt,"$_layout_sheet_annotations",V=function(e){var n,i=l,s=l;null==m.log&&(m.log=l),i=[];try{p(this.print_options_hash["$[]"]("notes"),"each",[],((n=function(s,a){var o,c,$,h=n.$$s||this,m=l;return null==s&&(s=l),null==a&&(a=l),$="extract."+e+".notes."+s,m=d(o=a["$[]"]("align"))?o:"r",m=d(m["$=="]("r"))?"left":"right",d(a["$[]"]("pos"))||h.$raise(f(Mt,"I18n").$t("missing pos")+" in "+$),d(a["$[]"]("text"))||h.$raise(f(Mt,"I18n").$t("missing text")+" in "+$),i["$<<"](p(u(u(f(Mt,"Harpnotes"),"Drawing"),"Annotation").$new(a["$[]"]("pos"),h.$resolve_placeholder(a["$[]"]("text"),$),a["$[]"]("style"),l,$+".pos",a["$[]"]("pos")),"tap",[],((c=function(e){c.$$s;var n=l;return null==e&&(e=l),n=[m],p(e,"align=",t.to_a(n)),n[r(n.length,1)],n=[_(["handler"],{handler:"annotation"})],p(e,"draginfo=",t.to_a(n)),n[r(n.length,1)]}).$$s=h,c.$$arity=1,c)))}).$$s=this,n.$$arity=2,n))}catch(e){if(!t.rescue(e,[f(Mt,"Exception")]))throw e;s=e;try{m.log.$error(s.$message())}finally{t.pop_exception()}}return i},V.$$arity=1),t.def(Bt,"$_layout_instrument",J=function(){var e,n=l,i=l,s=l;return null==m.conf&&(m.conf=l),n=[],d(this.draw_instrument)&&p(this.draw_instrument.$call(),"each",[],((e=function(t){e.$$s;return null==t&&(t=l),n.$push(t)}).$$s=this,e.$$arity=1,e)),d(this.instrument_shape)&&(i=u(u(f(Mt,"Harpnotes"),"Drawing"),"Path").$new(this.instrument_shape,"open"),s=[m.conf.$get("layout.LINE_THICK")],p(i,"line_width=",t.to_a(s)),s[r(s.length,1)],n.$push(i)),n},J.$$arity=0),t.def(Bt,"$_layout_lyrics",X=function(e,n){var s,o,c=l,$=l,h=l,m=l,y=l;return c=[],$=this.print_options_hash["$[]"]("lyrics"),h=e.$harpnote_options()["$[]"]("lyrics")["$[]"]("text"),d(h)&&(m=h.$join("\n"),d($)&&(y=p(m.$gsub("\t"," ").$squeeze(" ").$split(/\n\n+/),"map",[],((s=function(t){s.$$s;return null==t&&(t=l),t.$strip()}).$$s=this,s.$$arity=1,s)),$.$delete("versepos"),p($,"each",[],((o=function(e,s){var $,h,m,g,v,b,A,x,w=o.$$s||this;return null==w.print_options_raw&&(w.print_options_raw=l),null==e&&(e=l),null==s&&(s=l),g=s["$[]"]("pos"),v=p(d($=s["$[]"]("verses"))?$:[],"map",[],(h=function(t){h.$$s;var e=l;return null==t&&(t=l),t["$=="](0)&&(e=9999),d(a(t,0))&&(e=t),d(i(t,0))&&(e=r(t,1)),y["$[]"](e)},h.$$s=w,h.$$arity=1,h)).$join("\n\n"),A="extract."+n+"."+(b="lyrics."+e),x=d($=w.print_options_raw.$get(b+".style"))?$:"regular",c["$<<"](p(u(u(f(Mt,"Harpnotes"),"Drawing"),"Annotation").$new(g,v,x,l,A+".pos",g),"tap",[],((m=function(e){var n;m.$$s;return null==e&&(e=l),n=[_(["handler"],{handler:"annotation"})],p(e,"draginfo=",t.to_a(n)),n[r(n.length,1)]}).$$s=w,m.$$arity=1,m)))}).$$s=this,o.$$arity=2,o)))),c},X.$$arity=2),t.def(Bt,"$_layout_zn_annotations",W=function(t,e){var r,n=l;return n=[],r=f(Mt,"Time").$now().$strftime("%Y-%m-%d %H:%M:%S"),n["$<<"](u(u(f(Mt,"Harpnotes"),"Drawing"),"Annotation").$new(this.bottom_annotation_positions["$[]"](0),t+" - created "+r+" by Zupfnoter "+f(Mt,"VERSION")+" ["+this.uri["$[]"]("hostname")+"]","smaller")),n["$<<"](u(u(f(Mt,"Harpnotes"),"Drawing"),"Annotation").$new(this.bottom_annotation_positions["$[]"](1),"Zupfnoter: https://www.zupfnoter.de","smaller")),n["$<<"](u(u(f(Mt,"Harpnotes"),"Drawing"),"Annotation").$new(this.bottom_annotation_positions["$[]"](2),e.$checksum(),"smaller")),n},W.$$arity=2),t.def(Bt,"$_layout_legend",K=function(e,n,i){var s,a,o,c,$,h,m,y,g,v,b,A,x=l,w=l,k=l;return x=[],w=e.$meta_data()["$[]"]("meter"),d(w)&&(w=w.$last().$split("=").$first()),c=e.$meta_data()["$[]"]("key"),$=e.$meta_data()["$[]"]("composer"),h=e.$meta_data()["$[]"]("tempo_display"),m=this.print_options_hash["$[]"]("title"),y=this.print_options_hash["$[]"]("legend")["$[]"]("pos"),g=d(s=this.print_options_raw.$get("legend.tstyle"))?s:"large",k=d(s=this.print_options_raw.$get("legend.align"))?s:"r",k=d(k["$=="]("l"))?"right":"left",v=this.print_options_hash["$[]"]("legend")["$[]"]("spos"),b=m+"\n"+$+"\nTakt: "+w+" ("+h+")\nTonart: "+c,A=d(s=this.print_options_raw.$get("legend.style"))?s:"regular",x["$<<"](p(u(u(f(Mt,"Harpnotes"),"Drawing"),"Annotation").$new(y,i,g,l,"extract."+n+".legend.pos",y),"tap",[],((a=function(e){a.$$s;var n=l;return null==e&&(e=l),n=[_(["handler"],{handler:"annotation"})],p(e,"draginfo=",t.to_a(n)),n[r(n.length,1)],n=[k],p(e,"align=",t.to_a(n)),n[r(n.length,1)]}).$$s=this,a.$$arity=1,a))),d(this.print_options_raw["$[]"]("notes.T06_legend")["$nil?"]())&&x["$<<"](p(u(u(f(Mt,"Harpnotes"),"Drawing"),"Annotation").$new(v,b,A,l,"extract."+n+".legend.spos",v),"tap",[],((o=function(e){var n;o.$$s;return null==e&&(e=l),n=[_(["handler"],{handler:"annotation"})],p(e,"draginfo=",t.to_a(n)),n[r(n.length,1)]}).$$s=this,o.$$arity=1,o))),x},K.$$arity=3),t.def(Bt,"$_layout_cutmarks",Z=function(t){var r,n=l,a=l;return null==m.conf&&(m.conf=l),n=[],d(t["$=="]("A4")?i(m.conf["$[]"]("printer.a4_pages").$length(),1):t["$=="]("A4"))&&(a=s(12,m.conf.$get("layout.X_SPACING")),p(g(1,2,!1),"each",[],((r=function(t){var i,o=r.$$s||this;return null==t&&(t=l),p([4,290],"each",[],((i=function(r){i.$$s;return null==m.conf&&(m.conf=l),null==r&&(r=l),n["$<<"](u(u(f(Mt,"Harpnotes"),"Drawing"),"Annotation").$new([e(e(s(.25,m.conf.$get("layout.X_SPACING")),m.conf.$get("layout.X_OFFSET")),s(a,t)),r],"x","small",l))}).$$s=o,i.$$arity=1,i))}).$$s=this,r.$$arity=1,r))),n},Z.$$arity=1),t.def(Bt,"$_layout_sortmark",tt=function(i,a){var o,c,$,h,y,g,v,b=l,A=l,x=l;return null==m.conf&&(m.conf=l),h=i.$upcase().$gsub(/[YZ]/,_(["","","","","Y","Z"],{"":"AE","":"OE","":"UE","":"ss",Y:"X",Z:"X"})).$gsub(/[^A-Za-z]/,""),y=e((b=p(e(h,"AAAA").$split(""),"map",[],((o=function(t){o.$$s;return null==t&&(t=l),r(t.$ord(),"A".$ord())}).$$s=this,o.$$arity=1,o)))["$[]"](0),n(s(e(e(s(.1,b["$[]"](1)),s(.01,b["$[]"](2))),s(.001,b["$[]"](3))),.5),2.4)),$=a["$[]"]("size"),A=null==(c=t.to_ary($))[0]?l:c[0],x=null==c[1]?l:c[1],g=d(a["$[]"]("fill"))?"filled":"open",v=[["M",s(e(12.5,y),m.conf.$get("layout.X_SPACING")),0],["l",n(A["$-@"](),2),x],["l",A,0],["l",n(A["$-@"](),2),x["$-@"]()],["l",0,x],["l",0,x["$-@"]()],["z"]],u(u(f(Mt,"Harpnotes"),"Drawing"),"Path").$new(v,g)},tt.$$arity=2),t.def(Bt,"$_layout_synclines",et=function(e,n){var i;return p(n,"map",[],(i=function(n){var s,a,o=i.$$s||this;return null==n&&(n=l),a=e.$build_synch_points(n),p(a,"map",[],((s=function(e){var n,i,a=s.$$s||this;return null==e&&(e=l),n=f(Mt,"FlowLine").$new(e.$notes().$first().$sheet_drawable(),e.$notes().$last().$sheet_drawable(),"dashed"),i=[a.$compute_color_by_variant_no(e.$notes().$first().$variant())],p(n,"color=",t.to_a(i)),r(i.length,1),n}).$$s=o,s.$$arity=1,s))},i.$$s=this,i.$$arity=1,i)).$flatten()},et.$$arity=2),t.def(Bt,"$_layout_sheetmarks",rt=function(i,a){var o,c,$=l,h=l,_=l,y=l,g=l,v=l,b=l,A=l,x=l,w=l;return null==m.conf&&(m.conf=l),$=i["$[]"]("stringnames")["$[]"]("vpos"),h=i["$[]"]("stringnames")["$[]"]("marks")["$[]"]("hpos"),"stringnames",_=[],d(h["$empty?"]())||(_=e(_,p(h,"inject",[[]],((o=function(t,e){var r,n=o.$$s||this;return null==t&&(t=l),null==e&&(e=l),p(i["$[]"]("stringnames")["$[]"]("marks")["$[]"]("vpos"),"each",[],((r=function(n){var i,s=r.$$s||this;return null==s.pitch_to_xpos&&(s.pitch_to_xpos=l),null==n&&(n=l),i=s.$make_sheetmark_path([s.pitch_to_xpos.$call(e),n]),t["$<<"](u(u(f(Mt,"Harpnotes"),"Drawing"),"Path").$new(i,"filled"))}).$$s=n,r.$$arity=1,r)),t}).$$s=this,o.$$arity=2,o)))),d($["$empty?"]())||(y=37,g=s(g=i["$[]"]("stringnames")["$[]"]("text").$split(" "),e(n(y,g.$length()),1)),b=r(e(v=m.conf.$get("layout.PITCH_OFFSET")["$-@"](),y),1),$=i["$[]"]("stringnames")["$[]"]("vpos"),A=i["$[]"]("stringnames")["$[]"]("style"),x=m.conf.$get("layout.X_SPACING"),w=m.conf.$get("layout.X_OFFSET"),_=e(_,p(t.Range.$new(v,b,!1).$to_a(),"inject",[[]],((c=function(n,i){var a,o,h=c.$$s||this;return null==n&&(n=l),null==i&&(i=l),o=e(s(e(v["$-@"](),i),x),w),p($,"each",[],((a=function(e){var s,c=a.$$s||this;return null==e&&(e=l),n["$<<"](p(u(u(f(Mt,"Harpnotes"),"Drawing"),"Annotation").$new([o,e],g["$[]"](r(i,v)),A,l,"stringnames"),"tap",[],((s=function(e){var n;s.$$s;return null==e&&(e=l),n=["center"],p(e,"align=",t.to_a(n)),n[r(n.length,1)]}).$$s=c,s.$$arity=1,s)))}).$$s=h,a.$$arity=1,a)),n}).$$s=this,c.$$arity=2,c)))),_},rt.$$arity=2),t.def(Bt,"$_layout_voices",nt=function(t,i,o){var c,u,$,h,y,g,v,b,A,x,w,k,E=l,S=l,N=l,I=l,C=l;return null==m.log&&(m.log=l),null==m.conf&&(m.conf=l),E=l,p(m.log,"benchmark",["compute beat compression map"],((c=function(){var t,r=c.$$s||this;return null==r.print_options_hash&&(r.print_options_hash=l),t=e(r.print_options_hash["$[]"]("voices"),r.print_options_hash["$[]"]("layoutlines")).$uniq(),E=r.$compute_beat_compression(i,t)}).$$s=this,c.$$arity=0,c)),A=d(u=E.$values().$max())?u:0,S=n(r(m.conf.$get("layout.DRAWING_AREA_SIZE").$last(),this.y_offset),A),d(a(S,this.beat_spacing))&&(N=n(this.beat_spacing,S),m.log.$warning("note distance too small (factor "+N+")")),this.beat_spacing=[S,s(m.conf.$get("layout.packer.pack_max_spreadfactor"),this.beat_spacing)].$min(),t=d(m.conf.$get("layout.bottomup"))?d(u=t)?u:p(f(Mt,"Proc"),"new",[],(($=function(t){var e=$.$$s||this;return null==e.y_size&&(e.y_size=l),null==e.beat_spacing&&(e.beat_spacing=l),null==t&&(t=l),e.y_size-t*e.beat_spacing}).$$s=this,$.$$arity=1,$)):d(u=t)?u:p(f(Mt,"Proc"),"new",[],((h=function(t){var e=h.$$s||this;return null==e.beat_spacing&&(e.beat_spacing=l),null==e.y_offset&&(e.y_offset=l),null==t&&(t=l),t*e.beat_spacing+e.y_offset}).$$s=this,h.$$arity=1,h)),x=p(f(Mt,"Proc"),"new",[],((y=function(e){y.$$s;return null==e&&(e=l),t.$call(E["$[]"](e))}).$$s=this,y.$$arity=1,y)),w=p(this.print_options_hash["$[]"]("synchlines"),"select",[],((g=function(t){var e,r=g.$$s||this;return null==r.print_options_hash&&(r.print_options_hash=l),null==t&&(t=l),d(e=r.print_options_hash["$[]"]("voices")["$include?"](t.$first()))?r.print_options_hash["$[]"]("voices")["$include?"](t.$last()):e}).$$s=this,g.$$arity=1,g)),I=[],p(m.log,"benchmark",["build_syncpoints"],((v=function(){var t,e=v.$$s||this;return I=p(w,"map",[],(t=function(e){var r,n,s=t.$$s||this;return null==e&&(e=l),n=i.$build_synch_points(e),p(n,"map",[],((r=function(t){r.$$s;return null==t&&(t=l),t.$synched_notes()}).$$s=s,r.$$arity=1,r))},t.$$s=e,t.$$arity=1,t)).$flatten()}).$$s=this,v.$$arity=0,v)),C=this.print_options_hash["$[]"]("voices"),k=p(i.$voices().$each_with_index(),"map",[],(b=function(t,e){var r=b.$$s||this;return null==r.print_options_hash&&(r.print_options_hash=l),null==r.print_options_raw&&(r.print_options_raw=l),null==t&&(t=l),null==e&&(e=l),d(C["$include?"](e))?r.$layout_voice(t,x,o,_(["voice_nr","nonflowrest","flowline","subflowline","jumpline","repeatsigns","synched_notes","countnotes","barnumbers","chords","print_options_raw"],{voice_nr:e,nonflowrest:r.print_options_hash["$[]"]("nonflowrest"),flowline:r.print_options_hash["$[]"]("flowlines")["$include?"](e),subflowline:r.print_options_hash["$[]"]("subflowlines")["$include?"](e),jumpline:r.print_options_hash["$[]"]("jumplines")["$include?"](e),repeatsigns:r.print_options_hash["$[]"]("repeatsigns"),synched_notes:I,countnotes:r.$_get_options_by_voice(e,"countnotes"),barnumbers:r.$_get_options_by_voice(e,"barnumbers"),chords:r.$_get_options_by_voice(e,"chords"),print_options_raw:r.print_options_raw})):l},b.$$s=this,b.$$arity=2,b)).$flatten().$compact(),d(m.log["$loglevel?"]("warning"))&&f(Mt,"CollisionDetector").$new().$check_annotations(k),[C,w,k]},nt.$$arity=3),t.def(Bt,"$_get_options_by_voice",it=function(t,e){var r=l;return r=this.print_options_hash["$[]"](e),d(r["$[]"]("voices")["$include?"](t))||(r=l),r},it.$$arity=2),t.def(Bt,"$_layout_prepare_options",st=function(t){var e,r;return null==m.conf&&(m.conf=l),this.print_options_raw=this.$get_print_options(t),this.print_options_hash=this.print_options_raw.$get(),r=d(e=this.print_options_hash["$[]"]("layout"))?e:_([],{}),m.conf.$push(_(["layout"],{layout:r})),m.conf.$push(_(["printer"],{printer:d(e=this.print_options_hash["$[]"]("printer"))?e:_([],{})})),this.$initialize(),this.layout_minc=d(e=this.print_options_raw["$[]"]("notebound.minc"))?e:_([],{}),this.y_offset=this.print_options_hash["$[]"]("startpos"),this.y_size=m.conf.$get("layout.DRAWING_AREA_SIZE").$last(),this.$set_instrument_handlers(t)},st.$$arity=1),t.def(Bt,"$compute_vertical_cut",at=function(t,n){var i,s,a,o,c=l,u=l;return null==m.conf&&(m.conf=l),c=d(i=m.conf["$[]"]("layout.jumpline_vcut"))?i:0,s=r([t.$origin().$prev_playable(),t.$origin().$next_playable()],[t.$origin()]),a=r([n.$origin().$prev_playable(),n.$origin().$next_playable()],[n.$origin()]),o=[t.$origin(),n.$origin()].$compact(),u=e(s,a)["$&"](o),d(u["$empty?"]())||(c=0),c},at.$$arity=2),t.def(Bt,"$layout_barnumbers_countnotes",ot=function(n,i,a,o){var c,$,h,y,g,v,b=l,A=l,x=l,w=l,k=l,E=l,S=l,N=l,I=l,C=l,O=l,B=l,M=l,P=l,F=l,L=l,T=l,j=l,R=l,D=l,z=l;return null==m.conf&&(m.conf=l),g=m.conf["$[]"]("layout.limit_a3")["$=="](!0),v=m.conf["$[]"]("layout.bottomup")["$=="](!0),b=a["$[]"]("countnotes"),A=a["$[]"]("barnumbers"),x=[],w=[],d(d(c=b)?c:A)&&(k=p(n,"select",[],(($=function(t){$.$$s;return null==t&&(t=l),t["$visible?"]()}).$$s=this,$.$$arity=1,$)),d(b)&&(E=b["$[]"]("style"),(c=[1,1])[0],S=c[1],N=b["$[]"]("apanchor"),I=b["$[]"]("autopos"),C=b["$[]"]("pos"),h=b["$[]"]("apbase"),c=t.to_ary(h),O=null==c[0]?l:c[0],B=null==c[1]?l:c[1],M=[b["$[]"]("cntextleft"),b["$[]"]("cntextright")].$compact()),d(A)&&(P=A["$[]"]("style"),(c=[2.7,2.7])[0],F=c[1],L=A["$[]"]("apanchor"),T=A["$[]"]("autopos"),j=A["$[]"]("pos"),h=A["$[]"]("apbase"),c=t.to_ary(h),R=null==c[0]?l:c[0],D=null==c[1]?l:c[1],z=A["$[]"]("prefix")),p(k,"each",[],((y=function(n){var a,c,$,h,m,k,U,q,H,Q,Y,G=y.$$s||this,V=l,J=l,X=l,W=l,K=l,Z=l,tt=l,et=l,rt=l,nt=l,it=l,st=l,at=l,ot=l,ct=l,lt=l,ut=l,ft=l,$t=l,ht=l;return null==G.print_options_keys&&(G.print_options_keys=l),null==G.print_options_raw&&(G.print_options_raw=l),null==n&&(n=l),m=(V=n.$sheet_drawable()).$center(),c=m,a=t.to_ary(c),k=null==a[0]?l:a[0],null==a[1]?l:a[1],c=V.$size(),a=t.to_ary(c),U=null==a[0]?l:a[0],q=null==a[1]?l:a[1],c=V.$size_with_dot(),a=t.to_ary(c),H=null==a[0]?l:a[0],null==a[1]?l:a[1],c=n.$prev_playable().$sheet_drawable().$center(),a=t.to_ary(c),Q=null==a[0]?l:a[0],null==a[1]?l:a[1],c=n.$next_playable().$sheet_drawable().$center(),a=t.to_ary(c),Y=null==a[0]?l:a[0],null==a[1]?l:a[1],c=d(v)?G.$compute_note_position(Y,k,Q,g).$reverse():G.$compute_note_position(Q,k,Y,g),a=t.to_ary(c),J=null==a[0]?l:a[0],X=null==a[1]?l:a[1],d(b)&&(K=(W="notebound.countnote.v_"+o+".t_"+n.$time())+".pos",Z=W+".align",tt=d("center"["$=="](N))?0:q,d(G.print_options_keys["$include?"](K))&&(et=G.print_options_raw["$[]"](K)),d(d(a=G.print_options_keys["$include?"](Z))?G.print_options_raw["$[]"](Z)["$!="]("auto"):a)&&(X=G.print_options_raw["$[]"](Z)),rt=I["$=="](!0)&&d(X["$=="]("l"))?"right":"left",d(M["$empty?"]())?nt=n.$count_note():(nt=(nt=(X["$=="]("l")?M.$first():M.$last()).$gsub("{lyrics}",n.$lyrics())).$gsub("{countnote}",n.$count_note()),d(nt["$empty?"]())&&(nt="~")),d(et)||(et=I["$=="](!0)?[e(d((a=X["$=="]("r"))?d(c=n["$tie_start?"]())?c:n["$tie_end?"]():X["$=="]("r"))?1:0,X["$=="]("l")?e(U,O)["$-@"]():e(H,O)),d(v)?e(e(tt,B),s(S,2))["$-@"]():e(tt,B)]:C),it=e(G.$Vector2d(m),et),st=p(u(u(f(Mt,"Harpnotes"),"Drawing"),"Annotation").$new(it.$to_a(),nt,E,n.$origin(),"extract."+i+"."+K,et),"tap",[],(($=function(e){$.$$s;var n=l;return null==e&&(e=l),n=[[!0,(n=[rt],p(e,"align=",t.to_a(n)),n[r(n.length,1)])]],p(e,"shift_eu=",t.to_a(n)),n[r(n.length,1)],n=[_(["handler"],{handler:"annotation"})],p(e,"draginfo=",t.to_a(n)),n[r(n.length,1)],e.$more_conf_keys().$push(_(["conf_key","text","icon","value"],{conf_key:"extract."+i+"."+Z,text:f(Mt,"I18n").$t("countnote left"),icon:"fa fa-arrow-left",value:"l"})),e.$more_conf_keys().$push(_(["conf_key","text","icon","value"],{conf_key:"extract."+i+"."+Z,text:f(Mt,"I18n").$t("countnote right"),icon:"fa fa-arrow-right",value:"r"}))}).$$s=G,$.$$arity=1,$)),x.$push(st)),d(d(a=A)?n["$measure_start?"]():a)?(K=(W="notebound.countnote.v_"+o+".t_"+n.$time())+".pos",Z=W+".align","extract."+i+"."+W,nt=d(a=n.$count_note())?a:"",at="notebound.barnumber.v_"+o+".t_"+n.$time(),ct=at+".align","extract."+i+"."+(ot=at+".pos"),lt=d(a=""+z+n.$measure_count().$to_s())?a:"",ut=d("center"["$=="](L))?0:q,d(G.print_options_keys["$include?"](ot))&&(ft=G.print_options_raw["$[]"](ot)),d(d(a=G.print_options_keys["$include?"](ct))?G.print_options_raw["$[]"](ct)["$!="]("auto"):a)&&(J=G.print_options_raw["$[]"](ct)),$t=T["$=="](!0)&&d(J["$=="]("l"))?"right":"left",d(ft)||(ft=T["$=="](!0)?[e(d((a=J["$=="]("r"))?d(c=n["$tie_start?"]())?c:n["$tie_end?"]():J["$=="]("r"))?1:0,J["$=="]("l")?e(U,R)["$-@"]():e(H,R)),d(v)?e(ut,D):e(e(ut,D),F)["$-@"]()]:j),ht=e(G.$Vector2d(m),ft),st=p(u(u(f(Mt,"Harpnotes"),"Drawing"),"Annotation").$new(ht.$to_a(),lt,P,n.$origin(),"extract."+i+"."+ot,ft),"tap",[],((h=function(e){h.$$s;var n=l;return null==e&&(e=l),n=[$t],p(e,"align=",t.to_a(n)),n[r(n.length,1)],n=[_(["handler"],{handler:"annotation"})],p(e,"draginfo=",t.to_a(n)),n[r(n.length,1)],e.$more_conf_keys().$push(_(["conf_key","text","icon","value"],{conf_key:"extract."+i+"."+ct,text:f(Mt,"I18n").$t("barnumber left"),icon:"fa fa-arrow-left",value:"l"})),e.$more_conf_keys().$push(_(["conf_key","text","icon","value"],{conf_key:"extract."+i+"."+ct,text:f(Mt,"I18n").$t("barnumber right"),icon:"fa fa-arrow-right",value:"r"}))}).$$s=G,h.$$arity=1,h)),w.$push(st)):l}).$$s=this,y.$$arity=1,y))),[w,x]},ot.$$arity=4),t.def(Bt,"$create_annotation_background_rect",ct=function(n,i){var a,o,c=l,u=l,$=l,h=l,_=l,m=l,y=l;return null==i&&(i=.1),c=c=this.$Vector2d(n.$center()),$=[e((u=p(n.$size(),"map",[],((a=function(t){a.$$s;return null==t&&(t=l),s(t,.5)}).$$s=this,a.$$arity=1,a))).$first(),i),e(u.$last(),i)],_=n.$align(),h="left"["$==="](_)?u.$first():"right"["$==="](_)?u.$first()["$-@"]():"center"["$==="](_)?0:l,m=u.$last(),d(n["$shift_eu?"]())?(m=r(s(u["$[]"](1),1),s(i,.7)),y=[1,s($["$[]"](1),.5)],p($,"[]=",t.to_a(y)),y[r(y.length,1)]):d(/[|gyqp]/.$match(n.$text()))||(m=r(s(u["$[]"](1),1),s(i,.5)),y=[1,s($["$[]"](1),.7)],p($,"[]=",t.to_a(y)),y[r(y.length,1)]),o=f(Mt,"Ellipse").$new(e(c,[h,m]).$to_a(),$,"filled",!1,l,!0),y=["white"],p(o,"color=",t.to_a(y)),y[r(y.length,1)],o},ct.$$arity=-2),t.def(Bt,"$compute_beat_compression",lt=function(t,e){var r,n=l;return null==m.conf&&(m.conf=l),m.conf.$get("layout.packer.pack_method")["$=="](1)&&(n=this.$compute_beat_compression_1(t,e)),m.conf.$get("layout.packer.pack_method")["$=="](2)&&(n=this.$compute_beat_compression_2(t,e)),m.conf.$get("layout.packer.pack_method")["$=="](3)&&(n=this.$compute_beat_compression_3(t,e)),m.conf.$get("layout.packer.pack_method")["$=="](10)&&(n=this.$compute_beat_compression_10(t,e)),(d(r=m.conf.$get("layout.packer.pack_method"))?r:0)["$=="](0)&&(n=this.$compute_beat_compression_0(t,e)),n},lt.$$arity=2),t.def(Bt,"$compute_beat_compression_2",ut=function(e,n){var i,a,o,c,$,h,d,m,y,g=l,v=l;return m=_([],{}),g=p(p(p(n,"map",[],(i=function(t){i.$$s;return null==t&&(t=l),e.$voices()["$[]"](t)},i.$$s=this,i.$$arity=1,i)),"inject",[[]],(a=function(t,e){a.$$s;return null==t&&(t=l),null==e&&(e=l),t.$push(e)},a.$$s=this,a.$$arity=2,a)).$flatten(),"select",[],((o=function(t){o.$$s;return null==t&&(t=l),t["$is_a?"](u(u(f(Mt,"Harpnotes"),"Music"),"Playable"))}).$$s=this,o.$$arity=1,o)),y=p(p(g,"select",[],((c=function(t){c.$$s;return null==t&&(t=l),t["$is_a?"](u(u(f(Mt,"Harpnotes"),"Music"),"SynchPoint"))}).$$s=this,c.$$arity=1,c)),"map",[],(($=function(t){$.$$s;return null==t&&(t=l),t.$notes()}).$$s=this,$.$$arity=1,$)),g=g.$push(y).$flatten(),v=p(g,"group_by",[],((h=function(t){h.$$s;return null==t&&(t=l),t.$beat()}).$$s=this,h.$$arity=1,h)),p(v.$keys().$sort(),"each",[],((d=function(e){var n;d.$$s;return null==e&&(e=l),n=[e,s(e,8)],p(m,"[]=",t.to_a(n)),n[r(n.length,1)]}).$$s=this,d.$$arity=1,d)),m},ut.$$arity=2),t.def(Bt,"$compute_beat_compression_10",ft=function(r,i){var s,a,o,c,u,$,h=l,_=l,y=l;return null==m.conf&&(m.conf=l),p(r.$beat_maps(),"map",[],(s=function(t){s.$$s;return null==t&&(t=l),t.$keys().$max()},s.$$s=this,s.$$arity=1,s)).$max(),h=0,_=0,u=p(i,"inject",[[]],(a=function(t,e){a.$$s;return null==t&&(t=l),null==e&&(e=l),t.$push(r.$beat_maps()["$[]"](e))},a.$$s=this,a.$$arity=2,a)).$compact(),$=p(r.$beat_maps(),"inject",[[]],(o=function(t,e){o.$$s;return null==t&&(t=l),null==e&&(e=l),t.$push(e.$keys()),t},o.$$s=this,o.$$arity=2,o)).$flatten().$uniq().$sort(),y=m.conf.$get("layout.DURATION_TO_STYLE"),f(Mt,"Hash")["$[]"](p($,"map",[],((c=function(r){var i,s,a,o,$,g,v,b=c.$$s||this,A=l,x=l,w=l,k=l;if(null==b.conf_beat_resolution&&(b.conf_beat_resolution=l),null==m.log&&(m.log=l),null==r&&(r=l),A=p(u,"map",[],(i=function(t){i.$$s;return null==t&&(t=l),t["$[]"](r)},i.$$s=b,i.$$arity=1,i)).$flatten().$compact(),$=p(A,"map",[],(s=function(t){s.$$s;return null==t&&(t=l),t.$duration()},s.$$s=b,s.$$arity=1,s)).$max(),g=A["$empty?"](),x=p(A,"select",[],((a=function(t){a.$$s;return null==t&&(t=l),t["$first_in_part?"]()}).$$s=b,a.$$arity=1,a)),v=p(A,"select",[],(o=function(t){o.$$s;return null==t&&(t=l),t["$measure_start?"]()},o.$$s=b,o.$$arity=1,o)).$first(),d(g));else{try{w=b.conf_beat_resolution*y["$[]"](b.$duration_to_id($)).$first()}catch(e){if(!t.rescue(e,[f(Mt,"Exception")]))throw e;e;try{m.log.$error("BUG: unsupported duration: "+$+" on beat "+r+",  "+A.$to_json())}finally{t.pop_exception()}}k=n(e(w,_),2),_=w,d(v)&&(k=e(k,n(k,4))),d(x["$empty?"]())||(k=e(k,k)),k=e(k,b.$get_minc_factor(A.$first().$time(),k)),h=e(h,k)}return[r,h]}).$$s=this,c.$$arity=1,c)))},ft.$$arity=2),t.def(Bt,"$get_minc_factor",$t=function(e,r){var n=l;if(null==r&&(r=this.conf_beat_resolution),n=this.layout_minc["$[]"](e.$to_s()),!d(n))return 0;try{return s(n["$[]"]("minc_f"),r)}catch(e){if(!t.rescue(e,[f(Mt,"StandardError")]))throw e;try{return 0}finally{t.pop_exception()}}},$t.$$arity=-2),t.def(Bt,"$compute_beat_compression_0",ht=function(i,a){var o,c,$,h,y,g,v,b,A,x,w=l,k=l,E=l,S=l,N=l;return null==m.conf&&(m.conf=l),w=m.conf.$get("layout.DURATION_TO_STYLE"),s(d(o=m.conf.$get("layout.packer.pack_min_increment"))?o:0,this.conf_beat_resolution),k=0,A=_([],{}),E=0,S=p(p(p(a,"map",[],(c=function(t){c.$$s;return null==t&&(t=l),i.$voices()["$[]"](t)},c.$$s=this,c.$$arity=1,c)),"inject",[[]],($=function(t,e){$.$$s;return null==t&&(t=l),null==e&&(e=l),t.$push(e)},$.$$s=this,$.$$arity=2,$)).$flatten(),"select",[],((h=function(t){h.$$s;return null==t&&(t=l),t["$is_a?"](u(u(f(Mt,"Harpnotes"),"Music"),"Playable"))}).$$s=this,h.$$arity=1,h)),x=p(p(S,"select",[],((y=function(t){y.$$s;return null==t&&(t=l),t["$is_a?"](u(u(f(Mt,"Harpnotes"),"Music"),"SynchPoint"))}).$$s=this,y.$$arity=1,y)),"map",[],((g=function(t){g.$$s;return null==t&&(t=l),t.$notes()}).$$s=this,g.$$arity=1,g)),S=S.$push(x).$flatten(),N=p(S,"group_by",[],((v=function(t){v.$$s;return null==t&&(t=l),t.$beat()}).$$s=this,v.$$arity=1,v)),p(N.$keys().$sort(),"each",[],((b=function(i){var s,a,o,c,u,$,h=b.$$s||this,_=l,y=l,g=l,v=l,x=l;null==h.conf_beat_resolution&&(h.conf_beat_resolution=l),null==m.log&&(m.log=l),null==i&&(i=l),_=N["$[]"](i),c=p(_,"map",[],(s=function(t){s.$$s;return null==t&&(t=l),t.$duration()},s.$$s=h,s.$$arity=1,s)).$max(),y=p(_,"select",[],((a=function(t){a.$$s;return null==t&&(t=l),t["$first_in_part?"]()}).$$s=h,a.$$arity=1,a)),g=p(_,"select",[],((o=function(t){o.$$s;return null==t&&(t=l),t["$measure_start?"]()}).$$s=h,o.$$arity=1,o));try{v=h.conf_beat_resolution*w["$[]"](h.$duration_to_id(c)).$first()}catch(e){if(!t.rescue(e,[f(Mt,"Exception")]))throw e;e;try{m.log.$error("BUG: unsupported duration: "+c+" on beat "+i+",  "+h.$notes_on_beat().$to_json())}finally{t.pop_exception()}}return u=n(e(v,E),2),E=v,x=u,d(y["$empty?"]())||(x=e(x,u)),d(g["$empty?"]())||(x=e(x,n(x,4))),x=e(x,h.$get_minc_factor(_.$first().$time(),u)),$=[i,k=e(k,x)],p(A,"[]=",t.to_a($)),$[r($.length,1)]}).$$s=this,b.$$arity=1,b)),A},ht.$$arity=2),t.def(Bt,"$compute_beat_compression_1",pt=function(i,a){var o,c,$,h,y,g,v,b,A,x,w,k=l,E=l,S=l,N=l,I=l,C=l,O=l;return null==m.conf&&(m.conf=l),k=m.conf.$get("layout.DURATION_TO_STYLE"),A=s(d(o=m.conf.$get("layout.packer.pack_min_increment"))?o:0,this.conf_beat_resolution),E=_([],{}),x=_([],{}),S=0,N=0,I=0,C=p(p(p(a,"map",[],(c=function(t){c.$$s;return null==t&&(t=l),i.$voices()["$[]"](t)},c.$$s=this,c.$$arity=1,c)),"inject",[[]],($=function(t,e){$.$$s;return null==t&&(t=l),null==e&&(e=l),t.$push(e)},$.$$s=this,$.$$arity=2,$)).$flatten(),"select",[],((h=function(t){h.$$s;return null==t&&(t=l),t["$is_a?"](u(u(f(Mt,"Harpnotes"),"Music"),"Playable"))}).$$s=this,h.$$arity=1,h)),w=p(p(C,"select",[],((y=function(t){y.$$s;return null==t&&(t=l),t["$is_a?"](u(u(f(Mt,"Harpnotes"),"Music"),"SynchPoint"))}).$$s=this,y.$$arity=1,y)),"map",[],((g=function(t){g.$$s;return null==t&&(t=l),t.$notes()}).$$s=this,g.$$arity=1,g)),C=C.$push(w).$flatten(),O=p(C,"group_by",[],((v=function(t){v.$$s;return null==t&&(t=l),t.$beat()}).$$s=this,v.$$arity=1,v)),p(O.$keys().$sort(),"each",[],((b=function(i){var s,a,o,c,u,$,h,_,y,g=b.$$s||this,v=l,w=l,C=l,B=l,M=l,P=l,F=l;null==g.conf_beat_resolution&&(g.conf_beat_resolution=l),null==m.log&&(m.log=l),null==i&&(i=l),v=O["$[]"](i),h=p(v,"map",[],(s=function(t){s.$$s;return null==t&&(t=l),t.$duration()},s.$$s=g,s.$$arity=1,s)).$max();try{w=g.conf_beat_resolution*k["$[]"](g.$duration_to_id(h)).$first()}catch(e){if(!t.rescue(e,[f(Mt,"Exception")]))throw e;e;try{m.log.$error("BUG: unsupported duration: "+h+" on beat "+i+",  "+g.$notes_on_beat().$to_json())}finally{t.pop_exception()}}return _=n(e(w,I),2),I=w,C=p(v,"select",[],((a=function(t){var e,n,i;a.$$s;return null==t&&(t=l),n=d(e=E["$[]"](t.$pitch()))?e:-1,i=r(S,A),"number"==typeof n&&"number"==typeof i?n>=i:n["$>="](i)}).$$s=g,a.$$arity=1,a)),B=p(v,"select",[],((o=function(t){o.$$s;var e,r=l,n=l;return null==t&&(t=l),r=[d(e=t.$prev_pitch())?e:t.$pitch(),t.$pitch(),d(e=t.$next_pitch())?e:t.$pitch()],n=(d(e=r.$sort().$reverse()["$=="](r))?e:r.$sort()["$=="](r))["$!"](),d(t.$next_first_in_part())&&(n=!1),n}).$$s=g,o.$$arity=1,o)),M=p(v,"select",[],((c=function(t){c.$$s;return null==t&&(t=l),t["$first_in_part?"]()}).$$s=g,c.$$arity=1,c)),P=p(v,"select",[],((u=function(t){u.$$s;return null==t&&(t=l),t["$measure_start?"]()}).$$s=g,u.$$arity=1,u)),F=N,N=A,d(C["$empty?"]()["$!"]())?F=_:d(B["$empty?"]()["$!"]())&&(F=N=n(_,2)),d(M["$empty?"]())||(F=e(F,_),N=A),d(P["$empty?"]())||(F=e(F,n(F,4))),F=e(F,g.$get_minc_factor(v.$first().$time(),_)),S=e(S,F),p(v,"each",[],(($=function(e){var n;$.$$s;return null==e&&(e=l),n=[e.$pitch(),S],p(E,"[]=",t.to_a(n)),n[r(n.length,1)]}).$$s=g,$.$$arity=1,$)),y=[i,S],p(x,"[]=",t.to_a(y)),y[r(y.length,1)]}).$$s=this,b.$$arity=1,b)),x},pt.$$arity=2),t.def(Bt,"$compute_beat_compression_3",dt=function(i,a){var c,$,h,y,g,v,b,A,x,w,k,E=l,S=l,N=l,I=l,C=l,O=l;return null==m.conf&&(m.conf=l),E=m.conf.$get("layout.DURATION_TO_STYLE"),x=s(d(c=m.conf.$get("layout.packer.pack_min_increment"))?c:0,this.conf_beat_resolution),S=_([],{}),N=_([],{}),w=_([],{}),I=0,0,0,C=p(p(p(a.$uniq(),"map",[],($=function(t){$.$$s;return null==t&&(t=l),i.$voices()["$[]"](t)},$.$$s=this,$.$$arity=1,$)),"inject",[[]],(h=function(t,e){h.$$s;return null==t&&(t=l),null==e&&(e=l),t.$push(e)},h.$$s=this,h.$$arity=2,h)).$flatten(),"select",[],((y=function(t){y.$$s;return null==t&&(t=l),t["$is_a?"](u(u(f(Mt,"Harpnotes"),"Music"),"Playable"))}).$$s=this,y.$$arity=1,y)),k=p(p(C,"select",[],((g=function(t){g.$$s;return null==t&&(t=l),t["$is_a?"](u(u(f(Mt,"Harpnotes"),"Music"),"SynchPoint"))}).$$s=this,g.$$arity=1,g)),"map",[],((v=function(t){v.$$s;return null==t&&(t=l),t.$notes()}).$$s=this,v.$$arity=1,v)),C=C.$push(k).$flatten(),O=p(C,"group_by",[],((b=function(t){b.$$s;return null==t&&(t=l),t.$beat()}).$$s=this,b.$$arity=1,b)),p(O.$keys().$sort(),"each",[],((A=function(i){var s,a,c,u,$,h,y,g,v=A.$$s||this,b=l,k=l,C=l,B=l,M=l,P=l;return null==i&&(i=l),b=O["$[]"](i),y=(N=p(b,"inject",[_([],{})],((s=function(e,n){var i,a=s.$$s||this;return null==e&&(e=l),null==n&&(n=l),p(p(f(Mt,"Range"),"new",t.to_a([n.$prev_pitch(),n.$pitch()].$sort())),"each",[],((i=function(s){var a;i.$$s;return null==s&&(s=l),a=[s,_(["beat","note","pitch","kind"],{beat:I,note:n,pitch:s,kind:n.$pitch()["$=="](s)?"note":"line"})],p(e,"[]=",t.to_a(a)),a[r(a.length,1)]}).$$s=a,i.$$arity=1,i)),n.$pitch()["$=="](n.$prev_pitch())||e.$delete(n.$prev_pitch()),e}).$$s=v,s.$$arity=2,s))).$keys()["$&"](S.$keys()),k=p(y,"map",[],(a=function(n){var s,c=a.$$s||this,u=l,$=l,h=l;null==c.conf_beat_resolution&&(c.conf_beat_resolution=l),null==m.log&&(m.log=l),null==n&&(n=l),u=l;try{$=c.conf_beat_resolution*E["$[]"](c.$duration_to_id(N["$[]"](n)["$[]"]("note").$duration())).$first()}catch(e){if(!t.rescue(e,[f(Mt,"Exception")]))throw e;e;try{m.log.$error("BUG: unsupported duration: "+N["$[]"](n)["$[]"]("note").$duration()+" on beat "+i+",  "+N["$[]"](n)["$[]"]("note").$to_json())}finally{t.pop_exception()}}return s=S["$[]"](n)["$[]"]("kind")+"-"+N["$[]"](n)["$[]"]("kind"),d(["note-note","note-line","line-note","dline-line"]["$include?"](s))&&d(o(N["$[]"](n)["$[]"]("beat"),e(S["$[]"](n)["$[]"]("beat"),x)))&&(u=N["$[]"](n),N["$[]"](n)["$[]"]("note"),h=["inc",$],p(u,"[]=",t.to_a(h)),h[r(h.length,1)]),u},a.$$s=v,a.$$arity=1,a)).$compact(),C=x,C=d(k["$[]"](0))?p(k,"sort_by",[],(c=function(t){c.$$s;return null==t&&(t=l),t["$[]"]("inc")},c.$$s=v,c.$$arity=1,c)).$first()["$[]"]("inc"):x,B=p(b,"select",[],((u=function(t){u.$$s;return null==t&&(t=l),t["$first_in_part?"]()}).$$s=v,u.$$arity=1,u)),M=p(b,"select",[],(($=function(t){$.$$s;return null==t&&(t=l),t["$measure_start?"]()}).$$s=v,$.$$arity=1,$)),P=C,d(B["$empty?"]())||(P=e(P,C)),d(M["$empty?"]())||(P=e(P,n(P,4))),P=e(P,v.$get_minc_factor(b.$first().$time(),C)),I=e(I,P),p(N.$keys(),"each",[],((h=function(e){var n;h.$$s;return null==e&&(e=l),n=[e,_(["beat","kind","inc"],{beat:I,kind:N["$[]"](e)["$[]"]("kind"),inc:P})],p(S,"[]=",t.to_a(n)),n[r(n.length,1)]}).$$s=v,h.$$arity=1,h)),g=[i,I],p(w,"[]=",t.to_a(g)),g[r(g.length,1)]}).$$s=this,A.$$arity=1,A)),w},dt.$$arity=2),t.def(Bt,"$layout_playable",_t=function(t,e,r){var n=this;return null==m.log&&(m.log=l),d(t["$is_a?"](f(Mt,"Note")))?n.$layout_note(t,e,r+".n_0"):d(t["$is_a?"](f(Mt,"SynchPoint")))?n.$layout_accord(t,e,r):d(t["$is_a?"](f(Mt,"Pause")))?n.$layout_pause(t,e,r+".n_0"):m.log.$error("BUG: Missing Music -> Sheet transform: "+t)},_t.$$arity=3),t.def(Bt,"$layout_note",mt=function(i,s,a){var o,c,u,$,h,_,y,g,v,b=l,A=l,x=l,w=l,k=l,E=l;return null==m.conf&&(m.conf=l),u=this.$convert_pitch_to_xpos(i),$=s.$call(i.$beat()),c=this.$compute_ellipse_properties_from_note(i),h=null==(o=t.to_ary(c))[0]?l:o[0],_=null==o[1]?l:o[1],b=null==o[2]?l:o[2],y=null==o[3]?l:o[3],g=this.$layout_note_shift(i,b,u,h,a),v=this.$compute_color_by_variant_no(i.$variant()),A=f(Mt,"Ellipse").$new([e(u,g),$],b,_,h,i),d(i["$visible?"]())||(x=[!1],p(A,"visible=",t.to_a(x)),x[r(x.length,1)]),x=[e(a,".***")],p(A,"conf_key=",t.to_a(x)),x[r(x.length,1)],x=[A],p(i,"sheet_drawable=",t.to_a(x)),x[r(x.length,1)],x=[v],p(A,"color=",t.to_a(x)),x[r(x.length,1)],x=[m.conf.$get("layout.LINE_THICK")],p(A,"line_width=",t.to_a(x)),x[r(x.length,1)],w=f(Mt,"CompoundDrawable").$new([A],A),d(y)&&w.$push(this.$layout_note_flags(u,$,b,g,v,y)),d(i.$measure_start())&&(k=e(b.$last(),m.conf.$get("layout.LINE_THICK")),d(m.conf.$get("layout.bottomup"))&&(k=k["$-@"]()),E=d(d(o=y)?m.conf.$get("layout.bottomup")["$!"]():o)?m.conf.$get("layout.LINE_THICK"):0,A=f(Mt,"Ellipse").$new([r(e(u,g),E),r($,k)],[r(b.$first(),E),n(m.conf.$get("layout.LINE_THICK"),2)],"filled",!1,l,!0),d(i["$visible?"]())||(x=[!1],p(A,"visible=",t.to_a(x)),x[r(x.length,1)]),x=[v],p(A,"color=",t.to_a(x)),x[r(x.length,1)],x=[m.conf.$get("layout.LINE_THIN")],p(A,"line_width=",t.to_a(x)),x[r(x.length,1)],w.$push(A)),w},mt.$$arity=3),t.def(Bt,"$layout_note_flags",yt=function(i,a,o,c,$,h){var d,_,y,g,v=l,b=l,A=l,x=l,w=l,k=l,E=l,S=l,N=l,I=l,C=l,O=l;return null==m.conf&&(m.conf=l),this.instrument_orientation["$=="]("horizontal")?(d=[s(2,o["$[]"](1)),.1],v=d[0],b=d[1],A=m.conf.$get("layout.LINE_MEDIUM"),x=e(i,n(c,2)),w=r(e(a,o["$[]"](1)),n(A,2)),k=[["M",x,w],["l",v,b]],E=(d=[s(-.6,o["$[]"](0)),s(.6,o["$[]"](1))])[0],S=d[1],N=E,I=function(){try{return n(s(b,N),v)}catch(e){if(!t.rescue(e,[f(Mt,"StandardError")]))throw e;try{return 0}finally{t.pop_exception()}}}(),C=["l",E,S],p(h,"times",[],((_=function(t){_.$$s;return null==t&&(t=l),k=e(k,[["M",e(e(x,v),s(t,N)),e(w,b)],C])}).$$s=this,_.$$arity=1,_))):(d=[.1,s(2,o["$[]"](1))],v=d[0],b=d[1],A=m.conf.$get("layout.LINE_MEDIUM"),x=r(e(e(i,c),o["$[]"](0)),n(A,2)),k=[["M",x,w=a],["l",v,b["$-@"]()]],E=(d=[s(1.3,o["$[]"](1)),s(.6,o["$[]"](1))])[0],S=d[1],I=S,N=function(){try{return n(s(v,I),b)}catch(e){if(!t.rescue(e,[f(Mt,"StandardError")]))throw e;try{return 0}finally{t.pop_exception()}}}(),C=["l",E,S],p(h,"times",[],((y=function(t){y.$$s;return null==t&&(t=l),k=e(k,[["M",r(e(x,v),s(t,N)),e(r(a,b),s(t,I))],C])}).$$s=this,y.$$arity=1,y))),g=u(u(f(Mt,"Harpnotes"),"Drawing"),"Path").$new(k,"open"),O=[A],p(g,"line_width=",t.to_a(O)),O[r(O.length,1)],O=[$],p(g,"color=",t.to_a(O)),O[r(O.length,1)],g},yt.$$arity=6),t.def(Bt,"$convert_pitch_to_xpos",gt=function(t){return this.pitch_to_xpos.$call(t.$pitch())},gt.$$arity=1),t.def(Bt,"$compute_color_by_variant_no",vt=function(t){var e=this;return t["$=="](0)?e.color_default:d(t["$odd?"]())?e.color_variant1:e.color_variant2},vt.$$arity=1),t.def(Bt,"$compute_ellipse_properties_from_note",bt=function(e){var r,n,i,a,o,c,u;return null==m.conf&&(m.conf=l),n=m.conf.$get("layout.DURATION_TO_STYLE")["$[]"](this.$check_duration(e)),r=t.to_ary(n),a=null==r[0]?l:r[0],o=null==r[1]?l:r[1],c=null==r[2]?l:r[2],u=null==r[3]?l:r[3],[c,o,p(m.conf.$get("layout.ELLIPSE_SIZE"),"map",[],((i=function(t){i.$$s;return null==t&&(t=l),s(t,a)}).$$s=this,i.$$arity=1,i)),u]},bt.$$arity=1),t.def(Bt,"$layout_note_shift",At=function(t,n,o,c,u){var f=l,$=l,h=l;return null==m.conf&&(m.conf=l),f=0,d(m.conf.$get("layout.limit_a3"))&&(d(a(o,5))&&(f=e(f,n.$first())),d(i(o,415))&&(f=e(f,n.$first()["$-@"]()),d(c)&&(f=r(f,1.5)))),d(t.$shift())&&(f=t.$shift()["$[]"]("dir")["$=="](-1)?e(f,n.$first()["$-@"]()):e(f,n.$first())),d(u)&&($=u.$gsub(/extract\.(\d+)\./,""),d(this.print_options_keys["$include?"]($+".nshift"))&&(h=this.print_options_raw["$[]"]($+".nshift"),f=s(s(n.$first(),2),h))),f},At.$$arity=5),t.def(Bt,"$layout_accord",xt=function(t,e,r){var n,i,s,a,o,c=l,u=l;return c=p(t.$notes().$reverse().$each_with_index(),"map",[],(n=function(t,i){var s=n.$$s||this;return null==t&&(t=l),null==i&&(i=l),s.$layout_note(t,e,r+".n_"+i)},n.$$s=this,n.$$arity=2,n)).$reverse(),o=t.$get_proxy_object(c).$proxy(),u=p(p(c,"map",[],((i=function(t){i.$$s;return null==t&&(t=l),t.$proxy()}).$$s=this,i.$$arity=1,i)),"sort_by",[],((s=function(t){s.$$s;return null==t&&(t=l),t.$center().$first()}).$$s=this,s.$$arity=1,s)),(c=p(c,"map",[],((a=function(t){a.$$s;return null==t&&(t=l),t.$shapes()}).$$s=this,a.$$arity=1,a))).$unshift(f(Mt,"FlowLine").$new(u.$first(),u.$last(),"dashed")),f(Mt,"CompoundDrawable").$new(c,o)},xt.$$arity=3),t.def(Bt,"$layout_pause",wt=function(i,a,o){var c,$,h,_,y,g,v,b,A=l,x=l,w=l,k=l,E=l,S=l,N=l;return null==m.conf&&(m.conf=l),h=this.$convert_pitch_to_xpos(i),_=a.$call(i.$beat()),$=m.conf.$get("layout.REST_TO_GLYPH")["$[]"](this.$check_duration(i)),A=null==(c=t.to_ary($))[0]?l:c[0],y=null==c[1]?l:c[1],g=null==c[2]?l:c[2],w=[s((x=m.conf.$get("layout.REST_SIZE")).$first(),A.$first()),s(x.$last(),A.$last())],v=this.$layout_note_shift(i,w,h,g,o),b=this.$compute_color_by_variant_no(i.$variant()),k=l,k=u(u(f(Mt,"Harpnotes"),"Drawing"),"Glyph").$new([e(h,v),_],w,y,g,i),E=[e(o,".***")],p(k,"conf_key=",t.to_a(E)),E[r(E.length,1)],E=[k],p(i,"sheet_drawable=",t.to_a(E)),E[r(E.length,1)],E=[b],p(k,"color=",t.to_a(E)),E[r(E.length,1)],E=[m.conf.$get("layout.LINE_THICK")],p(k,"line_width=",t.to_a(E)),E[r(E.length,1)],d(i["$visible?"]())||(E=[!1],p(k,"visible=",t.to_a(E)),E[r(E.length,1)]),S=f(Mt,"CompoundDrawable").$new([k],k),d(i.$measure_start())&&(N=e(w.$last(),m.conf.$get("layout.LINE_THICK")),d(m.conf.$get("layout.bottomup"))&&(N=N["$-@"]()),k=f(Mt,"Ellipse").$new([e(h,v),r(_,N)],[w.$first(),n(m.conf.$get("layout.LINE_THICK"),2)],"filled",!1,l,!0),E=[b],p(k,"color=",t.to_a(E)),E[r(E.length,1)],E=[m.conf.$get("layout.LINE_THIN")],p(k,"line_width=",t.to_a(E)),E[r(E.length,1)],d(i["$visible?"]())||(E=[!1],p(k,"visible=",t.to_a(E)),E[r(E.length,1)]),S.$push(k)),S},wt.$$arity=3),t.defs(Bt,"$make_path_from_jumpline",kt=function(n){var a,o,c,u,f,$,h,p,_,m,y,g,v,b,A,x,w,k,E,S,N,I,C=l,O=l,B=l,M=l,P=l,F=l,L=l,T=l,j=l,R=l,D=l,z=l,U=l;return o=n["$[]"]("jumpline_anchor"),c=null==(a=t.to_ary(o))[0]?l:a[0],u=null==a[1]?l:a[1],C=this.$Vector2d(n["$[]"]("from")["$[]"]("center")),f=e(this.$Vector2d(n["$[]"]("from")["$[]"]("size")),[c,u]),$=n["$[]"]("from")["$[]"]("anchor")["$=="]("before")?-1:1,O=this.$Vector2d(n["$[]"]("to")["$[]"]("center")),h=e(this.$Vector2d(n["$[]"]("to")["$[]"]("size")),[c,u]),p=n["$[]"]("to")["$[]"]("anchor")["$=="]("before")?-1:1,_=n["$[]"]("vertical"),B=n["$[]"]("verticalcut"),M=C,n["$[]"]("vertical_anchor")["$=="]("to")&&(M=O),P=this.$Vector2d(e(M.$x(),_),C.$y()),F=this.$Vector2d(e(M.$x(),_),O.$y()),L=this.$Vector2d(s(r(P,C),[1,0]).$normalize().$x(),0),T=this.$Vector2d(s(r(F,O),[1,0]).$normalize().$x(),0),m=s(f,[L.$x(),$]),y=s(h,[T.$x(),p]),P=e(P,s(m,[0,1])),F=e(F,s(y,[0,1])),j=P.$y()["$=="](F.$y())?0:this.$Vector2d(0,s(r(P,F),[0,1]).$normalize().$y()),g=e(C,m),R=P,D=F,v=e(O,y),b=e(e(O,y),s(T,[2,0])),A=e(e(v,s(T,2.5)),[0,1]),x=r(e(v,s(T,2.5)),[0,1]),w=r(D.$y(),R.$y()),z=d(i(w,0))?B:B["$-@"](),B["$=="](0)&&(z=w),E=e(k=e(R,[0,z]),j),S=r(D,[0,z]),N=e(e(k,s(j,1.5)),[.5,0]),I=r(e(k,s(j,1.5)),[.5,0]),U=B["$=="](0)?[]:[["M"].concat(t.to_a(k)),["l"].concat(t.to_a(r(N,k))),["l"].concat(t.to_a(r(I,N))),["l"].concat(t.to_a(r(k,I))),["z"]],[[["M"].concat(t.to_a(g)),["l"].concat(t.to_a(r(R,g))),["l"].concat(t.to_a(r(E,R))),["M"].concat(t.to_a(S)),["L"].concat(t.to_a(D)),["L"].concat(t.to_a(b))],[["M"].concat(t.to_a(v)),["l"].concat(t.to_a(r(A,v))),["l"].concat(t.to_a(r(x,A))),["l"].concat(t.to_a(r(v,x))),["z"]],U]},kt.$$arity=1),t.def(Bt,"$duration_to_id",Et=function(t){var e=l;return null==m.conf&&(m.conf=l),e=("d"+t).$to_sym(),d(m.conf.$get("layout.DURATION_TO_STYLE")["$[]"](e)["$nil?"]())&&(e="err"),e},Et.$$arity=1),t.def(Bt,"$check_duration",St=function(t){var e=l;return null==m.log&&(m.log=l),e=this.$duration_to_id(t.$duration()),d(e["$==="]("err"))&&m.log.$error("unsupported duration at "+t.$start_pos_to_s(),t.$start_pos(),t.$end_pos()),e},St.$$arity=1),t.def(Bt,"$make_sheetmark_path",Nt=function(t){var e,i,a,o=l,c=l;return i=.5,5,o=r(this.$Vector2d(t),[i,n(5,2)]),a=[this.$Vector2d(i,s(2,i)["$-@"]()),this.$Vector2d(i,s(2,i)),this.$Vector2d(0,5),this.$Vector2d(i["$-@"](),s(2,i)),this.$Vector2d(i["$-@"](),s(-2,i)),this.$Vector2d(0,5["$-@"]())],c=[["M",o.$x(),o.$y()]],p(a,"each",[],((e=function(t){e.$$s;return null==t&&(t=l),c["$<<"](["l",t.$x(),t.$y()])}).$$s=this,e.$$arity=1,e)),c},Nt.$$arity=1),t.def(Bt,"$make_slur_path",It=function(t,n){var i=l,a=l,o=l,c=l;return i=r(n,t),o=(a=this.$Vector2d(s(.3,i.$length()),0).$rotate(i.$angle())).$rotate(-.4),c=e(i,a.$reverse().$rotate(.4)),[["M",t.$x(),t.$y()],["c",o.$x(),o.$y(),c.$x(),c.$y(),i.$x(),i.$y()]]},It.$$arity=2),t.def(Bt,"$make_annotated_bezier_path",Ct=function(t,i){var a,c,$,h,p,_,y,g,v,b=l,A=l,x=l,w=l,k=l,E=l,S=l,N=l,I=l,C=l,O=l,B=l,M=l;return null==m.log&&(m.log=l),b=t.$first(),x=r(A=t.$last(),b),w=this.$Vector2d(i["$[]"]("cp1")),k=this.$Vector2d(i["$[]"]("cp2")),c=s(u(f(Mt,"Math"),"PI"),-.5),E=w.$rotate(x.$angle()).$rotate(c),S=e(x,S=k.$rotate(x.$angle()).$rotate(c)),m.log.$debug(E.$to_s()+" - "+S.$to_s()),N=e(b,E),I=e(b,S),$=n(e(b,N),2),h=n(e(A,I),2),C=n(e($,p=n(e(N,I),2)),2),_=n(e(h,p),2),O=C["$=="](_)?this.$Vector2d([0,0]):r(C,_).$perpendicular().$normalize(),B=e(B=d(d(a=o(N.$x(),b.$x()))?o(b.$x(),A.$x()):a)?r(e(n(e(C,_),2),s(O,-2)),[2,0]):e(n(e(C,_),2),s(O,2)),[0,-2]),y=[["M",b.$x(),b.$y()]],g=[["c",E.$x(),E.$y(),S.$x(),S.$y(),x.$x(),x.$y()]],v=[["l",E.$x(),E.$y()],["L",I.$x(),I.$y()],["L",A.$x(),A.$y()]],M=[],d(i["$[]"]("shape")["$include?"]("c"))&&(M=e(M,e(y,g))),d(i["$[]"]("shape")["$include?"]("l"))&&(M=e(M,e(y,v))),[M,B,N,I]},Ct.$$arity=2),t.def(Bt,"$resolve_placeholder",Ot=function(t,e){var r,n,i=l;return n=(i=t).$scan(/\{\{([^\}]+)\}\}/),p(n,"each",[],((r=function(n){var s=r.$$s||this,a=l;return null==s.placeholders&&(s.placeholders=l),null==m.log&&(m.log=l),null==n&&(n=l),a=s.placeholders["$[]"](n.$first()),d(a)?(t=a.$call(),d(t)||(m.log.$error(f(Mt,"I18n").$t("no placeholder value found in ")+" in '"+e+"': '"+n.$first()+"'"),t=""),i=i.$gsub("{{"+n+"}}",t)):m.log.$error(f(Mt,"I18n").$t("wrong placeholder: ")+" in '"+e+"': '"+n.$first()+"'")}).$$s=this,r.$$arity=1,r)),i},Ot.$$arity=2)}(b[0],0,b)}(b[0],b)}(c[0],c)},Opal.modules.abc_to_harpnotes_factory=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}t.top;var n=[],i=t.nil,s=t.const_get_qualified,a=t.const_get_relative,o=(t.breaker,t.slice,t.module),c=t.klass,l=t.gvars,u=t.truthy,f=t.hash2,$=t.send;return t.add_stubs(["$===","$new","$error","$split","$[]","$count","$length","$last","$each","$match","$parse","$[]=","$-","$first","$<<","$message","$+","$inject","$each_with_index","$include?","$t","$strip","$==","$get_metadata","$map","$select","$nil?","$join","$compact","$flatten"]),function(n,h){var p=[o(n,"Harpnotes")].concat(h);!function(n,h){var p=[o(n,"Input")].concat(h);!function(e,r,n){var o,u=c(e,null,"ABCToHarpnotesFactory"),f=[u].concat(n);t.defs(u,"$create_engine",o=function(t){var e=i;return null==l.log&&(l.log=i),"ABC2SVG"["$==="](t)?e=s(s(a(f,"Harpnotes"),"Input"),"Abc2svgToHarpnotes").$new():(l.log.$error("Undefined abc parser: "+t),e=s(s(a(f,"Harpnotes"),"Input"),"Abc2svgToHarpnotes").$new()),e},o.$$arity=1)}(p[0],0,p),function(n,s,o){var h,p,d,_,m,y=c(n,null,"AbstractAbcToHarpnotes"),g=[y].concat(o);y.$$prototype.abc_code=i,t.def(y,"$initialize",h=function(){return this.abc_code=i,this.previous_new_part=[]},h.$$arity=0),t.def(y,"$charpos_to_line_column",p=function(t){var e,r,n=i;return r=u(e=t)?e:1,[(n=this.abc_code["$[]"](1,r).$split("\n")).$count(),n.$last().$length()]},p.$$arity=1),t.def(y,"$parse_harpnote_config",d=function(n){var s,o=i,c=i,h=i;return o=f([],{}),c=1,$(n.$split("\n"),"each",[],((s=function(n){var f,h=s.$$s||this,p=i,d=i,_=i,m=i,y=i;if(null==l.log&&(l.log=i),null==n&&(n=i),p=$(n,"match",[/^%%%%hn\.(print|legend|note|annotation|lyrics) (.*)/],((f=function(t){f.$$s;return null==t&&(t=i),[t["$[]"](1),t["$[]"](2)]}).$$s=h,f.$$arity=1,f)),u(p))try{d=a(g,"JSON").$parse(p.$last()),_=["line_no",c],$(d,"[]=",t.to_a(_)),_[e(_.length,1)],u(o["$[]"](p.$first()))||(_=[p.$first(),[]],$(o,"[]=",t.to_a(_)),_[e(_.length,1)]),o["$[]"](p.$first())["$<<"](d)}catch(e){if(!t.rescue(e,[a(g,"Exception")]))throw e;m=e;try{y="error in harpnote commands: "+m.$message()+" ["+c+":"+p+"]",l.log.$error(y,[c,1],[c,2])}finally{t.pop_exception()}}return c=r(c,1)}).$$s=this,s.$$arity=1,s)),u(o["$[]"]("legend"))&&(h=["legend",o["$[]"]("legend").$first()],$(o,"[]=",t.to_a(h)),h[e(h.length,1)]),u(o["$[]"]("lyrics"))&&(h=["lyrics",o["$[]"]("lyrics").$first()],$(o,"[]=",t.to_a(h)),h[e(h.length,1)]),o},d.$$arity=1),t.def(y,"$get_metadata",_=function(n){var s;return $(n.$split("\n").$each_with_index(),"inject",[f([],{})],((s=function(n,o){var c,f,h,p,d,_=s.$$s||this,m=i,y=i,v=i,b=i;return null==l.log&&(l.log=i),null==n&&(n=i),null==o&&(o=i),f=o,p=null==(c=t.to_ary(f))[0]?i:c[0],d=null==c[1]?i:c[1],m=$(p,"match",[/^([A-Z]):\s*(.*)/],((h=function(t){h.$$s;return null==t&&(t=i),[t["$[]"](1),t["$[]"](2)]}).$$s=_,h.$$arity=1,h)),u(m)&&(y=m.$first(),u(n["$[]"](y))?(u(["F","X"]["$include?"](y))&&l.log.$error(a(g,"I18n").$t("more than one line found for ")+" ':"+y+"'",[r(d,1),1]),n["$[]"](y)["$<<"](m.$last().$strip())):(y["$=="]("F")&&(v=m.$last().$strip(),u(v["$include?"]("{{"))||u(v.$match(/^[a-zA-z0-9_\-\.]+$/))||l.log.$error('"'+v+'": '+a(g,"I18n").$t("bad characters in filename"),[r(d,1),1])),b=[y,[m.$last().$strip()]],$(n,"[]=",t.to_a(b)),b[e(b.length,1)])),n}).$$s=this,s.$$arity=2,s.$$has_top_level_mlhs_arg=!0,s))},_.$$arity=1),t.def(y,"$add_metadata",m=function(t,e){var r,n,s=i;return s=this.$get_metadata(t),[$($(e,"select",[],((r=function(t,e){r.$$s;return null==t&&(t=i),null==e&&(e=i),s["$[]"](t)["$nil?"]()}).$$s=this,r.$$arity=2,r)),"map",[],((n=function(t,e){n.$$s;return null==t&&(t=i),null==e&&(e=i),t+":"+e}).$$s=this,n.$$arity=2,n)),t].$flatten().$compact().$join("\n")},m.$$arity=2)}(p[0],0,p)}(p[0],p)}(n[0],n)},Opal.modules.native=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}var r=t.top,n=[],i=t.nil,s=t.const_get_qualified,a=t.const_get_relative,o=(t.breaker,t.slice,t.module),c=t.truthy,l=t.send,u=t.hash2,f=t.range,$=t.klass,h=t.gvars;return t.add_stubs(["$try_convert","$native?","$respond_to?","$to_n","$raise","$inspect","$Native","$proc","$map!","$end_with?","$define_method","$[]","$convert","$call","$to_proc","$new","$each","$native_reader","$native_writer","$extend","$warn","$include","$is_a?","$map","$to_a","$_Array","$method_missing","$bind","$instance_method","$slice","$-","$length","$[]=","$enum_for","$===","$>=","$<<","$each_pair","$_initialize","$name","$native_module"]),function(e,r){var n,$,h,p,d,_,m=o(e,"Native"),y=[m].concat(r);t.defs(m,"$is_a?",n=function(t,e){try{return t instanceof this.$try_convert(e)}catch(t){return!1}},n.$$arity=2),t.defs(m,"$try_convert",$=function(t,e){return null==e&&(e=i),this["$native?"](t)?t:t["$respond_to?"]("to_n")?t.$to_n():e},$.$$arity=-2),t.defs(m,"$convert",h=function(t){return this["$native?"](t)?t:t["$respond_to?"]("to_n")?t.$to_n():void this.$raise(a(y,"ArgumentError"),t.$inspect()+" isn't native")},h.$$arity=1),t.defs(m,"$call",p=function(e,r,n){var s,a=p.$$p,o=a||i;a&&(p.$$p=null),a&&(p.$$p=null),s=t.slice.call(arguments,2,arguments.length);var c=e[r];if(c instanceof Function){for(var l=new Array(s.length),u=0,f=s.length;u<f;u++){var $=s[u],h=this.$try_convert($);l[u]=h===i?$:h}return o!==i&&l.push(o),this.$Native(c.apply(e,l))}return this.$Native(c)},p.$$arity=-3),t.defs(m,"$proc",d=function(){var e,r=d.$$p,n=r||i;return r&&(d.$$p=null),r&&(d.$$p=null),c(n)||this.$raise(a(y,"LocalJumpError"),"no block given"),l(s("::","Kernel"),"proc",[],((e=function(r){var s,a,o,c,u=e.$$s||this;if(s=t.slice.call(arguments,0,arguments.length),l(a=s,"map!",[],((o=function(t){var e=o.$$s||this;return null==t&&(t=i),e.$Native(t)}).$$s=u,o.$$arity=1,o)),c=u.$Native(this),this===t.global)return n.apply(u,a);var f=n.$$s;n.$$s=null;try{return n.apply(c,a)}finally{n.$$s=f}}).$$s=this,e.$$arity=-1,e))},d.$$arity=0),function(e,r){var n,s,$,h,p=o(e,"Helpers"),d=[p].concat(r);t.def(p,"$alias_native",n=function(e,r,s){var o,$,h,p,_,m,y,g=n.$$p;if(g&&(n.$$p=null),o=t.slice.call(arguments,1,arguments.length),null==($=t.extract_kwargs(o)))$=u([],{});else if(!$.$$is_hash)throw t.ArgumentError.$new("expected kwargs");return o.length>0&&(h=o[0],o.splice(0,1)),null==h&&(h=e),null==(p=$.$$smap.as)&&(p=i),c(h["$end_with?"]("="))?l(this,"define_method",[e],((_=function(t){var e=_.$$s||this;return null==e.native&&(e.native=i),null==t&&(t=i),e.native[h["$[]"](f(0,-2,!1))]=a(d,"Native").$convert(t),t}).$$s=this,_.$$arity=1,_)):c(p)?l(this,"define_method",[e],((m=function(e){var r,n=m.$$s||this,s=m.$$p,o=s||i,u=i;return null==n.native&&(n.native=i),s&&(m.$$p=null),r=t.slice.call(arguments,0,arguments.length),u=l(a(d,"Native"),"call",[n.native,h].concat(t.to_a(r)),o.$to_proc()),c(u)?p.$new(u.$to_n()):i}).$$s=this,m.$$arity=-1,m)):l(this,"define_method",[e],((y=function(e){var r,n=y.$$s||this,s=y.$$p,o=s||i;return null==n.native&&(n.native=i),s&&(y.$$p=null),r=t.slice.call(arguments,0,arguments.length),l(a(d,"Native"),"call",[n.native,h].concat(t.to_a(r)),o.$to_proc())}).$$s=this,y.$$arity=-1,y))},n.$$arity=-2),t.def(p,"$native_reader",s=function(e){var r,n;return r=t.slice.call(arguments,0,arguments.length),l(r,"each",[],((n=function(t){var e,r=n.$$s||this;return null==t&&(t=i),l(r,"define_method",[t],((e=function(){var r=e.$$s||this;return null==r.native&&(r.native=i),r.$Native(r.native[t])}).$$s=r,e.$$arity=0,e))}).$$s=this,n.$$arity=1,n))},s.$$arity=-1),t.def(p,"$native_writer",$=function(e){var r,n;return r=t.slice.call(arguments,0,arguments.length),l(r,"each",[],((n=function(t){var e,r=n.$$s||this;return null==t&&(t=i),l(r,"define_method",[t+"="],((e=function(r){var n=e.$$s||this;return null==n.native&&(n.native=i),null==r&&(r=i),n.$Native(n.native[t]=r)}).$$s=r,e.$$arity=1,e))}).$$s=this,n.$$arity=1,n))},$.$$arity=-1),t.def(p,"$native_accessor",h=function(e){var r;return r=t.slice.call(arguments,0,arguments.length),l(this,"native_reader",t.to_a(r)),l(this,"native_writer",t.to_a(r))},h.$$arity=-1)}(y[0],y),function(e,r){var n,l,u,f=o(e,"Wrapper"),$=[f].concat(r);t.def(f,"$initialize",n=function(t){return c(s("::","Kernel")["$native?"](t))||s("::","Kernel").$raise(a($,"ArgumentError"),t.$inspect()+" isn't native"),this.native=t},n.$$arity=1),t.def(f,"$to_n",l=function(){return null==this.native&&(this.native=i),this.native},l.$$arity=0),t.defs(f,"$included",u=function(t){return t.$extend(a($,"Helpers"))},u.$$arity=1)}(y[0],y),t.defs(m,"$included",_=function(t){return this.$warn("Including ::Native is deprecated. Please include Native::Wrapper instead."),t.$include(a(y,"Wrapper"))},_.$$arity=1)}(n[0],n),function(e,r){var n,u,f,$=o(e,"Kernel"),h=[$].concat(r);t.def($,"$native?",n=function(t){return null==t||!t.$$class},n.$$arity=1),t.def($,"$Native",u=function(e){var r,n,o=u.$$p;return o&&(u.$$p=null),c(null==e)?i:c(this["$native?"](e))?s(a(h,"Native"),"Object").$new(e):c(e["$is_a?"](a(h,"Array")))?l(e,"map",[],((r=function(t){var e=r.$$s||this;return null==t&&(t=i),e.$Native(t)}).$$s=this,r.$$arity=1,r)):c(e["$is_a?"](a(h,"Proc")))?l(this,"proc",[],((n=function(r){var s,a=n.$$s||this,o=n.$$p,c=o||i;return o&&(n.$$p=null),s=t.slice.call(arguments,0,arguments.length),a.$Native(l(e,"call",t.to_a(s),c.$to_proc()))}).$$s=this,n.$$arity=-1,n)):e},u.$$arity=1),t.alias($,"_Array","Array"),t.def($,"$Array",f=function(e,r){var n,o=f.$$p,u=o||i;return o&&(f.$$p=null),o&&(f.$$p=null),n=t.slice.call(arguments,1,arguments.length),c(this["$native?"](e))?l(s(a(h,"Native"),"Array"),"new",[e].concat(t.to_a(n)),u.$to_proc()).$to_a():this.$_Array(e)},f.$$arity=-2)}(n[0],n),function(r,n,a){var o,f,h,p,d,_,m,y,g,v,b,A,x,w,k,E=$(r,n,"Object");[E].concat(a);E.$$prototype.native=i,E.$include(s(s("::","Native"),"Wrapper")),t.def(E,"$==",o=function(t){return this.native===s("::","Native").$try_convert(t)},o.$$arity=1),t.def(E,"$has_key?",f=function(e){return t.hasOwnProperty.call(this.native,e)},f.$$arity=1),t.alias(E,"key?","has_key?"),t.alias(E,"include?","has_key?"),t.alias(E,"member?","has_key?"),t.def(E,"$each",h=function(e){var r,n=h.$$p,s=n||i;if(n&&(h.$$p=null),r=t.slice.call(arguments,0,arguments.length),s!==i){for(var a in this.native)t.yieldX(s,[a,this.native[a]]);return this}return l(this,"method_missing",["each"].concat(t.to_a(r)))},h.$$arity=-1),t.def(E,"$[]",p=function(t){var e=this.native[t];return e instanceof Function?e:s("::","Native").$call(this.native,t)},p.$$arity=1),t.def(E,"$[]=",d=function(t,e){var r;return r=s("::","Native").$try_convert(e),c(r===i)?this.native[t]=e:this.native[t]=r},d.$$arity=2),t.def(E,"$merge!",_=function(t){for(var e in t=s("::","Native").$convert(t))this.native[e]=t[e];return this},_.$$arity=1),t.def(E,"$respond_to?",m=function(t,e){return null==e&&(e=!1),s("::","Kernel").$instance_method("respond_to?").$bind(this).$call(t,e)},m.$$arity=-2),t.def(E,"$respond_to_missing?",y=function(e,r){return null==r&&(r=!1),t.hasOwnProperty.call(this.native,e)},y.$$arity=-2),t.def(E,"$method_missing",g=function(r,n){var a,o=g.$$p,c=o||i,u=i;return o&&(g.$$p=null),o&&(g.$$p=null),a=t.slice.call(arguments,1,arguments.length),"="===r.charAt(r.length-1)?(u=[r.$slice(0,e(r.$length(),1)),a["$[]"](0)],l(this,"[]=",t.to_a(u)),u[e(u.length,1)]):l(s("::","Native"),"call",[this.native,r].concat(t.to_a(a)),c.$to_proc())},g.$$arity=-2),t.def(E,"$nil?",v=function(){return!1},v.$$arity=0),t.def(E,"$is_a?",b=function(e){return t.is_a(this,e)},b.$$arity=1),t.alias(E,"kind_of?","is_a?"),t.def(E,"$instance_of?",A=function(t){return this.$$class===t},A.$$arity=1),t.def(E,"$class",x=function(){return this.$$class},x.$$arity=0),t.def(E,"$to_a",w=function(t){var e=w.$$p,r=e||i;return e&&(w.$$p=null),e&&(w.$$p=null),null==t&&(t=u([],{})),l(s(s("::","Native"),"Array"),"new",[this.native,t],r.$to_proc()).$to_a()},w.$$arity=-1),t.def(E,"$inspect",k=function(){return"#<Native:"+String(this.native)+">"},k.$$arity=0)}(a(n,"Native"),a(n,"BasicObject"),n),function(r,n,o){var f,h,p,d,_,m,y,g=$(r,null,"Array"),v=[g].concat(o);g.$$prototype.named=g.$$prototype.native=g.$$prototype.get=g.$$prototype.block=g.$$prototype.set=g.$$prototype.length=i,g.$include(s(a(v,"Native"),"Wrapper")),g.$include(a(v,"Enumerable")),t.def(g,"$initialize",f=function(e,r){var n,s=f.$$p,o=s||i;return s&&(f.$$p=null),s&&(f.$$p=null),null==r&&(r=u([],{})),l(this,t.find_super_dispatcher(this,"initialize",f,!1),[e],null),this.get=c(n=r["$[]"]("get"))?n:r["$[]"]("access"),this.named=r["$[]"]("named"),this.set=c(n=r["$[]"]("set"))?n:r["$[]"]("access"),this.length=c(n=r["$[]"]("length"))?n:"length",this.block=o,c(null==this.$length())?this.$raise(a(v,"ArgumentError"),"no length found on the array-like object"):i},f.$$arity=-2),t.def(g,"$each",h=function(){var e=h.$$p,r=e||i;if(e&&(h.$$p=null),e&&(h.$$p=null),!c(r))return this.$enum_for("each");for(var n=0,s=this.$length();n<s;n++)t.yield1(r,this["$[]"](n));return this},h.$$arity=0),t.def(g,"$[]",p=function(t){var e=this,r=i,n=i;return n=t,r=a(v,"String")["$==="](n)||a(v,"Symbol")["$==="](n)?c(e.named)?e.native[e.named](t):e.native[t]:a(v,"Integer")["$==="](n)?c(e.get)?e.native[e.get](t):e.native[t]:i,c(r)?c(e.block)?e.block.$call(r):e.$Native(r):i},p.$$arity=1),t.def(g,"$[]=",d=function(t,e){return c(this.set)?this.native[this.set](t,a(v,"Native").$convert(e)):this.native[t]=a(v,"Native").$convert(e)},d.$$arity=2),t.def(g,"$last",_=function(t){var r,n,s=i,a=i;if(null==t&&(t=i),c(t)){for(s=e(this.$length(),1),a=[];c((n=0,"number"==typeof(r=s)&&"number"==typeof n?r>=n:r["$>="](n)));)a["$<<"](this["$[]"](s)),s=e(s,1);return a}return this["$[]"](e(this.$length(),1))},_.$$arity=-1),t.def(g,"$length",m=function(){return this.native[this.length]},m.$$arity=0),t.alias(g,"to_ary","to_a"),t.def(g,"$inspect",y=function(){return this.$to_a().$inspect()},y.$$arity=0)}(a(n,"Native"),0,n),function(e,r,n){var i,s=$(e,null,"Numeric");[s].concat(n);t.def(s,"$to_n",i=function(){return this.valueOf()},i.$$arity=0)}(n[0],0,n),function(e,r,n){var i,s=$(e,null,"Proc");[s].concat(n);t.def(s,"$to_n",i=function(){return this},i.$$arity=0)}(n[0],0,n),function(e,r,n){var i,s=$(e,null,"String");[s].concat(n);t.def(s,"$to_n",i=function(){return this.valueOf()},i.$$arity=0)}(n[0],0,n),function(e,r,n){var i,s=$(e,null,"Regexp");[s].concat(n);t.def(s,"$to_n",i=function(){return this.valueOf()},i.$$arity=0)}(n[0],0,n),function(e,r,n){var s,a=$(e,null,"MatchData");[a].concat(n);a.$$prototype.matches=i,t.def(a,"$to_n",s=function(){return this.matches},s.$$arity=0)}(n[0],0,n),function(e,r,n){var s,o=$(e,null,"Struct"),c=[o].concat(n);t.def(o,"$to_n",s=function(){var t,e=i;return e={},l(this,"each_pair",[],((t=function(r,n){t.$$s;return null==r&&(r=i),null==n&&(n=i),e[r]=a(c,"Native").$try_convert(n,n)}).$$s=this,t.$$arity=2,t)),e},s.$$arity=0)}(n[0],0,n),function(e,r,n){var i,s=$(e,null,"Array"),o=[s].concat(n);t.def(s,"$to_n",i=function(){for(var t=[],e=0,r=this.length;e<r;e++){var n=this[e];t.push(a(o,"Native").$try_convert(n,n))}return t},i.$$arity=0)}(n[0],0,n),function(e,r,n){var i,s=$(e,null,"Boolean");[s].concat(n);t.def(s,"$to_n",i=function(){return this.valueOf()},i.$$arity=0)}(n[0],0,n),function(e,r,n){var i,s=$(e,null,"Time");[s].concat(n);t.def(s,"$to_n",i=function(){return this},i.$$arity=0)}(n[0],0,n),function(e,r,n){var i,s=$(e,null,"NilClass");[s].concat(n);t.def(s,"$to_n",i=function(){return null},i.$$arity=0)}(n[0],0,n),function(e,r,n){var s,o,c=$(e,null,"Hash"),u=[c].concat(n);t.alias(c,"_initialize","initialize"),t.def(c,"$initialize",s=function(t){var e=s.$$p,r=e||i,n=this;if(e&&(s.$$p=null),e&&(s.$$p=null),null!=t&&(void 0===t.constructor||t.constructor===Object)){var o,c,f=n.$$smap,$=n.$$keys;for(o in t)!(c=t[o])||void 0!==c.constructor&&c.constructor!==Object?c&&c.$$is_array?(c=c.map(function(t){return!t||void 0!==t.constructor&&t.constructor!==Object?n.$Native(t):a(u,"Hash").$new(t)}),f[o]=c):f[o]=n.$Native(c):f[o]=a(u,"Hash").$new(c),$.push(o);return n}return l(n,"_initialize",[t],r.$to_proc())},s.$$arity=-1),t.def(c,"$to_n",o=function(){for(var t,e,r={},n=this.$$keys,i=this.$$smap,s=0,o=n.length;s<o;s++)e=(t=n[s]).$$is_string?i[t]:(t=t.key).value,r[t]=a(u,"Native").$try_convert(e,e);return r},o.$$arity=0)}(n[0],0,n),function(e,r,n){var i,s=$(e,null,"Module");[s].concat(n);t.def(s,"$native_module",i=function(){return t.global[this.$name()]=this},i.$$arity=0)}(n[0],0,n),function(e,r,n){var i,s,o=$(e,null,"Class"),c=[o].concat(n);t.def(o,"$native_alias",i=function(t,e){var r=this.prototype["$"+e];r||this.$raise(a(c,"NameError").$new("undefined method `"+e+"' for class `"+this.$inspect()+"'",e)),this.prototype[t]=r},i.$$arity=2),t.def(o,"$native_class",s=function(){return this.$native_module(),this.new=this.$new},s.$$arity=0)}(n[0],0,n),h.$=h.global=r.$Native(t.global)},Opal.modules.abc2svg_to_harpnotes=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}function n(t,e){return"number"==typeof t&&"number"==typeof e?t/e:t["$/"](e)}function i(t,e){return"number"==typeof t&&"number"==typeof e?t>e:t["$>"](e)}function s(t,e){return"number"==typeof t&&"number"==typeof e?t*e:t["$*"](e)}var a=t.top,o=[],c=t.nil,l=t.const_get_qualified,u=t.const_get_relative,f=(t.breaker,t.slice,t.module),$=t.klass,h=t.send,p=t.hash2,d=t.gvars,_=t.truthy,m=t.hash,y=t.range;return t.add_stubs(["$require","$attr_reader","$+","$keys","$[]","$get","$_reset_state","$get_metadata","$new","$abcplay=","$-","$get_abcmodel","$nil?","$raise","$t","$_make_metadata","$_transform_voices","$meta_data=","$_make_harpnote_options","$harpnote_options=","$meta_data","$empty?","$error","$[]=","$compact","$map","$gsub","$strip","$charpos_to_line_column","$_get_key_by_accidentals","$first","$==","$flatten","$select","$/","$to_i","$sum","$>=","$join","$private","$match","$to_a","$each_with_index","$_transform_voice","$_make_variant_ending_jumps","$unshift","$to_s","$_investigate_first_bar","$each","$send","$inject","$<<","$_make_jumplines","$_make_notebound_annotations","$_transform_chordsymbol","$count","$last","$warning","$!","$=~","$_parse_decorations","$bardecorations=","$_extract_goto_info_from_bar","$!=","$length","$push","$_bar_is_repetition_end?","$>","$pop","$_transform_bar_repeat_end","$include?","$_parse_origin","$_parse_tuplet_info","$_transform_measure_start","$_convert_duration","$decorations=","$measure_count=","$_transform_count_note","$count_note=","$_transform_lyrics","$lyrics=","$time=","$_mkznid","$znid=","$origin=","$start_pos=","$end_pos=","$tuplet=","$tuplet_start=","$tuplet_end=","$variant=","$visible=","$time","$duration","$duration=","$origin","$start_pos","$end_pos","$tuplet","$tuplet_start","$tuplet_end","$tie_end=","$tie_start=","$_parse_slur","$_push_slur","$slur_starts=","$_pop_slur","$slur_ends=","$measure_start=","$_make_repeats_jumps_annotations","$is_a?","$_extract_chord_lines","$znid","$*","$%","$scan","$min","$round","$floor","$invisible=","$prev_pitch","$pitch=","$start_pos_to_s","$===","$shift=","$notes","$to_f","$pitch","$next_pitch=","$next_playable=","$next_first_in_part=","$prev_pitch=","$prev_playable=","$first_in_part=","$<","$start_with?","$to_sym","$&","$>>"]),a.$require("native"),function(a,o){var g=[f(a,"Harpnotes")].concat(o);!function(a,o){var g=[f(a,"Input")].concat(o);!function(a,o,f){var g,v,b,A,x,w,k,E,S,N,I,C,O,B,M,P,F,L,T,j,R,D,z,U,q,H,Q,Y,G,V,J,X,W,K,Z,tt,et,rt,nt,it,st,at,ot,ct,lt=$(a,o,"Abc2svgToHarpnotes"),ut=[lt].concat(f);lt.$$prototype.abc_code=lt.$$prototype.abcplay=lt.$$prototype.abc_model=lt.$$prototype.meta_data=lt.$$prototype.info_fields=lt.$$prototype.remark_table=lt.$$prototype.score_statements=lt.$$prototype.wmeasure=lt.$$prototype.measure_start_time=lt.$$prototype.next_note_marks=lt.$$prototype.previous_note=lt.$$prototype.variant_no=lt.$$prototype.variant_endings=lt.$$prototype.repetition_stack=lt.$$prototype.pushed_variant_ending_repeat=lt.$$prototype.part_table=lt.$$prototype.measure_count=lt.$$prototype.tie_started=lt.$$prototype.countby=lt.$$prototype._shortest_note=lt.$$prototype.pitch_providers=lt.$$prototype.tempo_statements=lt.$$prototype.slurstack=lt.$$prototype.tuplet_p=c,t.const_set(ut[0],"ABC2SVG_DURATION_FACTOR",1536),lt.$attr_reader("abc_model"),t.def(lt,"$initialize",g=function(){var r,n=g.$$p,i=c,s=c;for(null==d.conf&&(d.conf=c),n&&(g.$$p=null),s=0,r=arguments.length,i=new Array(r);s<r;s++)i[s]=arguments[s];return h(this,t.find_super_dispatcher(this,"initialize",g,!1),i,n),this.abcplay=c,this.abc_code=c,this.previous_new_part=[],this.score_statements=[],this.part_table=p([],{}),this.abc_model=p([],{}),this.tempo_statements=[],this.supported_decorations=e(d.conf["$[]"]("layout.DECORATIIONS_AS_ANNOTATIONS").$keys(),["fermata","emphasis","breath"]),this._shortest_note=d.conf.$get("layout.SHORTEST_NOTE"),this.$_reset_state()},g.$$arity=0),t.def(lt,"$transform",v=function(n){var i,s,a,o=c,f=c,$=c,m=c;return null==d.conf&&(d.conf=c),null==d.log&&(d.log=c),this.abc_code=n,this.annotations=d.conf.$get("annotations"),this.info_fields=this.$get_metadata(this.abc_code),o=l(u(ut,"ABC2SVG"),"Abc2Svg").$new(c,p(["mode"],{mode:"model"})),_(this.abcplay)&&(f=[this.abcplay],h(o,"abcplay=",t.to_a(f)),f[r(f.length,1)]),s=o.$get_abcmodel(n),i=t.to_ary(s),this.abc_model=null==i[0]?c:i[0],a=null==i[1]?c:i[1],_(this.abc_model["$nil?"]())&&this.$raise(u(ut,"I18n").$t("no suitable ABC found")),this.$_make_metadata(),$=this.$_transform_voices(),f=[this.meta_data],h($,"meta_data=",t.to_a(f)),f[r(f.length,1)],f=[this.$_make_harpnote_options()],h($,"harpnote_options=",t.to_a(f)),f[r(f.length,1)],m=$.$meta_data()["$[]"]("filename"),_(m["$empty?"]())&&d.log.$error(e("./abc2svg_to_harpnotes.rb".$force_encoding("US-ASCII")+":51: ",u(ut,"I18n").$t("Filename not specified in song add an F: instruction")),[1,1]),[$,a]},v.$$arity=1),t.def(lt,"$_make_harpnote_options",b=function(){var n,i,s=c;return null==d.conf&&(d.conf=c),i=p(["lyrics"],{lyrics:p(["text"],{text:this.info_fields["$[]"]("W")})}),s=["template",d.conf.$get("template")],h(i,"[]=",t.to_a(s)),s[r(s.length,1)],s=["print",h(d.conf.$get("produce"),"map",[],(n=function(t){n.$$s;var r,i,s=c;return null==d.conf&&(d.conf=c),null==d.log&&(d.log=c),null==t&&(t=c),i=d.conf.$get("extract."+t+".title"),_(i)?(s=(_(r=d.conf.$get("extract."+t+".filenamepart"))?r:i).$strip().$gsub(/[^a-zA-Z0-9\-\_]/,"_"),p(["title","view_id","filenamepart"],{title:i,view_id:t,filenamepart:s})):(d.log.$error(e(e("./abc2svg_to_harpnotes.rb".$force_encoding("US-ASCII")+":66: ",u(ut,"I18n").$t("could not find extract with number"))," "+t),[1,1],[1e3,1e3]),c)},n.$$s=this,n.$$arity=1,n)).$compact()],h(i,"[]=",t.to_a(s)),s[r(s.length,1)],i},b.$$arity=0),t.def(lt,"$_get_key_by_accidentals",A=function(t){var r=c,n=c,i=c;return null==d.log&&(d.log=c),r=t["$[]"]("k_mode"),_(t["$[]"]("k_mode")["$nil?"]())&&(r=0,n=this.$charpos_to_line_column(t["$[]"]("istart")),i=this.$charpos_to_line_column(t["$[]"]("iend")),d.log.$error(e("./abc2svg_to_harpnotes.rb".$force_encoding("US-ASCII")+":80: ",u(ut,"I18n").$t("please specify a key note")),n,i)),m(7,["C#","D#Dor","E#Phr","F#Lyd","G#Mix","A#m","B#Loc"],6,["F#","G#Dor","A#Phr","BLyd","C#Mix","D#m","E#Loc"],5,["B","C#Dor","D#Phr","ELyd","F#Mix","G#m","A#Loc"],4,["E","F#Dor","G#Phr","ALyd","BMix","C#m","D#Loc"],3,["A","BDor","C#Phr","DLyd","EMix","F#m","G#Loc"],2,["D","EDor","F#Phr","GLyd","AMix","Bm","C#Loc"],1,["G","ADor","BPhr","CLyd","DMix","Em","F#Loc"],0,["C","DDor","EPhr","FLyd","GMix","Am","BLoc"],-1,["F","GDor","APhr","BbLyd","CMix","Dm","ELoc"],-2,["Bb","CDor","DPhr","EbLyd","FMix","Gm","ALoc"],-3,["Eb","FDor","GPhr","AbLyd","BbMix","Cm","DLoc"],-4,["Ab","BbDor","CPhr","DbLyd","EbMix","Fm","GLoc"],-5,["Db","EbDor","FPhr","GbLyd","AbMix","Bbm","CLoc"],-6,["Gb","AbDor","BbPhrCbLyd","DbMix","Ebm","FLoc"],-7,["CbDbDor","EbPhrFbLyd","GbMix","Abm","BbLoc"])["$[]"](t["$[]"]("k_sf"))["$[]"](r)},A.$$arity=1),t.def(lt,"$_make_metadata",x=function(){var t,e,r,i,s,a,o,l=c,f=c,$=c,d=c,m=c,y=c;return l=this.$_get_key_by_accidentals(this.abc_model["$[]"]("voices").$first()["$[]"]("voice_properties")["$[]"]("key")),i=this.$_get_key_by_accidentals(this.abc_model["$[]"]("voices").$first()["$[]"]("voice_properties")["$[]"]("okey")),f="",l["$=="](i)||(f="(Original in "+i+")"),s=this.abc_model["$[]"]("music_type_ids")["$[]"]("tempo"),$=h(this.abc_model["$[]"]("voices"),"map",[],(t=function(e){var r,n=t.$$s||this;return null==e&&(e=c),h(e["$[]"]("symbols"),"select",[],(r=function(t){r.$$s;return null==t&&(t=c),t["$[]"]("type")["$=="](s)},r.$$s=n,r.$$arity=1,r)).$first()},t.$$s=this,t.$$arity=1,t)).$flatten().$compact().$first(),_(_(e=$)?$["$[]"]("tempo_notes"):e)?(d=h($["$[]"]("tempo_notes"),"map",[],((r=function(t){r.$$s;return null==t&&(t=c),n(t,u(ut,"ABC2SVG_DURATION_FACTOR"))}).$$s=this,r.$$arity=1,r)),m=$["$[]"]("tempo").$to_i(),y="1/"+n(1,d.$sum())+"="+m):(d=[.25],m=120,y="1/4=120"),_((o=1,"number"==typeof(a=m)&&"number"==typeof o?a>=o:a["$>="](o)))||(m=120),this.meta_data=p(["number","composer","title","filename","tempo","tempo_display","meter","key","o_key"],{number:this.info_fields["$[]"]("X").$first(),composer:(_(e=this.info_fields["$[]"]("C"))?e:[]).$join("\n"),title:(_(e=this.info_fields["$[]"]("T"))?e:[]).$join("\n"),filename:(_(e=this.info_fields["$[]"]("F"))?e:[]).$join("\n"),tempo:p(["duration","bpm","sym"],{duration:d,bpm:m,sym:$}),tempo_display:y,meter:this.info_fields["$[]"]("M"),key:l,o_key:f})},x.$$arity=0),lt.$private(),t.def(lt,"$_mkznid",w=function(t){var r=c,n=c,i=c;return null==d.log&&(d.log=c),r=this.remark_table["$[]"](t["$[]"]("time")),_(r)?_(r.$match(/[a-z][a-zA-Z0-9_]*/))||(n=this.$charpos_to_line_column(t["$[]"]("istart")),i=this.$charpos_to_line_column(t["$[]"]("iend")),d.log.$error(e("./abc2svg_to_harpnotes.rb".$force_encoding("US-ASCII")+":147: ",u(ut,"I18n").$t("illegal character in [r:] (must be of [a-z][a-z0.9_])")),n,i),r=r="_"+r+"_"):_(r)||(r=""+t["$[]"]("time")),r},w.$$arity=1),t.def(lt,"$_reset_state",k=function(){var t;return this.countnames=h(y(1,32,!1).$to_a(),"map",[],(t=function(e){t.$$s;return null==e&&(e=c),[e,"e","u","e"]},t.$$s=this,t.$$arity=1,t)).$flatten(),this.jumptargets=p([],{}),this.is_first_measure=!0,this.measure_start_time=0,this.measure_count=0,this.next_note_marks=p(["measure","repeat_start","variant_ending","variant_followup"],{measure:!1,repeat_start:!1,variant_ending:!1,variant_followup:!1}),this.previous_new_part=[],this.previous_note=c,this.remark_table=p([],{}),this.repetition_stack=[],this.variant_endings=[[]],this.tie_started=!1,this.variant_no=0,this.slurstack=0,this.tuplet_count=1,this.tuplet_down_count=1,this.countby=c,this.wmeasure=0},k.$$arity=0),t.def(lt,"$_transform_voices",E=function(){var t,r=c;return(r=h(this.abc_model["$[]"]("voices").$each_with_index(),"map",[],(t=function(r,n){var i,s=t.$$s||this,a=c;return null==r&&(r=c),null==n&&(n=c),i="v_"+e(n,1),a=s.$_transform_voice(r,i),_(a["$empty?"]())||(a=e(a,s.$_make_variant_ending_jumps(i))),a},t.$$s=this,t.$$arity=2,t)).$compact()).$unshift(r.$first()),l(l(u(ut,"Harpnotes"),"Music"),"Song").$new(r)},E.$$arity=0),t.def(lt,"$_transform_voice",S=function(n,i){var s,a,o,l,f,$,p,m,y,g,v,b=c,A=c;return null==d.log&&(d.log=c),m=this.abc_model["$[]"]("music_type_ids")["$[]"]("note").$to_s(),this.$_reset_state(),this.wmeasure=n["$[]"]("voice_properties")["$[]"]("meter")["$[]"]("wmeasure"),this.countby=function(){try{return n["$[]"]("voice_properties")["$[]"]("meter")["$[]"]("a_meter").$first()["$[]"]("bot").$to_i()}catch(e){if(!t.rescue(e,[u(ut,"StandardError")]))throw e;try{return c}finally{t.pop_exception()}}}(),this.$_investigate_first_bar(n),h(n["$[]"]("symbols"),"each",[],((s=function(e){var n=s.$$s||this,i=c;return null==e&&(e=c),i=["start_pos",n.$charpos_to_line_column(e["$[]"]("istart"))],h(e,"[]=",t.to_a(i)),i[r(i.length,1)],i=["end_pos",n.$charpos_to_line_column(e["$[]"]("iend"))],h(e,"[]=",t.to_a(i)),i[r(i.length,1)]}).$$s=this,s.$$arity=1,s)),this.pitch_providers=h(n["$[]"]("symbols"),"map",[],((a=function(t){a.$$s;return null==t&&(t=c),t["$[]"]("type").$to_s()["$=="](m)?t:c}).$$s=this,a.$$arity=1,a)),b=(b=h(n["$[]"]("symbols").$each_with_index(),"map",[],((o=function(r,n){var s,a=o.$$s||this,l=c;null==a.abc_model&&(a.abc_model=c),null==d.log&&(d.log=c),null==r&&(r=c),null==n&&(n=c),s=a.abc_model["$[]"]("music_types")["$[]"](r["$[]"]("type"));try{b=a.$send("_transform_"+s,r,n,i)}catch(n){if(!t.rescue(n,[u(ut,"Exception")]))throw n;l=n;try{d.log.$error(e("./abc2svg_to_harpnotes.rb".$force_encoding("US-ASCII")+":226: ",""+l),a.$charpos_to_line_column(r["$[]"]("istart")))}finally{t.pop_exception()}}return b}).$$s=this,o.$$arity=2,o))).$flatten(),y=h(b,"inject",[[]],((l=function(t,e){var r=l.$$s||this;return null==t&&(t=c),null==e&&(e=c),t["$<<"](r.$_make_jumplines(e,i)),t}).$$s=this,l.$$arity=2,l)),g=h(b,"inject",[[]],((f=function(t,e){var r=f.$$s||this;return null==t&&(t=c),null==e&&(e=c),t["$<<"](r.$_make_notebound_annotations(e,i))}).$$s=this,f.$$arity=2,f)),v=h(b,"inject",[[]],(($=function(t,e){var r=$.$$s||this;return null==t&&(t=c),null==e&&(e=c),t["$<<"](r.$_transform_chordsymbol(e,i))}).$$s=this,$.$$arity=2,$)),b=(b=e(b,e(e(y,g),v))).$flatten().$compact(),_(b.$count()["$=="](0))&&(A=i.$gsub("v_","").$to_i(),_(_(p=this.score_statements.$last())?this.score_statements.$last()["$[]"]("sy")["$[]"]("voices")["$[]"](r(A,1)):p)?d.log.$warning(u(ut,"I18n").$t("Voice has no notes or is not in %%score")+":  V:"+n["$[]"]("voice_properties")["$[]"]("id"),this.$charpos_to_line_column(1)):d.log.$warning(u(ut,"I18n").$t("Voice not in %%score")+":  V:"+n["$[]"]("voice_properties")["$[]"]("id"),this.$charpos_to_line_column(1))),b},S.$$arity=2),t.def(lt,"$_investigate_first_bar",N=function(e){var n,i,s,a=c,o=c;return s=this.abc_model["$[]"]("music_type_ids")["$[]"]("bar").$to_s(),a=h(e["$[]"]("symbols"),"select",[],(n=function(t){n.$$s;return null==t&&(t=c),t["$[]"]("type").$to_s()["$=="](s)?t["$[]"]("invisible")["$!"]():t["$[]"]("type").$to_s()["$=="](s)},n.$$s=this,n.$$arity=1,n)).$compact(),this.measure_start_time=0,_(_(i=a.$first())?this.wmeasure["$nil?"]()["$!"]():i)?(this.measure_start_time=r(a.$first()["$[]"]("time"),this.wmeasure),_(_(i=a.$first())?this.measure_start_time["$=="](0):i)?(o=["measure",!0],h(this.next_note_marks,"[]=",t.to_a(o)),o[r(o.length,1)]):c):c},N.$$arity=1),t.def(lt,"$_bar_is_repetition_end?",I=function(t){return t["$=~"](/^:.*$/)},I.$$arity=1),t.def(lt,"$_transform_bar",C=function(n,s,a){var o,l,f,$=this,m=c,y=c,g=c,v=c,b=c;return null==d.log&&(d.log=c),m=[],y=n["$[]"]("bar_type"),g=$.$_parse_decorations(n),_(g["$empty?"]())||(v=[g],h($.previous_note,"bardecorations=",t.to_a(v)),v[r(v.length,1)]),f=n["$[]"]("text"),b=function(){try{return $.$_extract_goto_info_from_bar(n).$last()["$[]"]("distance")}catch(e){if(!t.rescue(e,[u(ut,"StandardError")]))throw e;try{return[-10,10,15]}finally{t.pop_exception()}}}(),_(_(o=n["$[]"]("invisible"))?o:y["$=~"](/^\:?([\[\]]+)$/))||(v=["measure",!0],h($.next_note_marks,"[]=",t.to_a(v)),v[r(v.length,1)]),_(y["$=~"](/^.*:$/))&&(v=["repeat_start",!0],h($.next_note_marks,"[]=",t.to_a(v)),v[r(v.length,1)]),n["$[]"]("rbstart")["$=="](2)&&($.variant_no=e($.variant_no,1),v=["variant_ending",p(["text"],{text:f})],h($.next_note_marks,"[]=",t.to_a(v)),v[r(v.length,1)]),_((o=n["$[]"]("rbstart")["$=="](2))?$.variant_endings.$last()["$empty?"]():n["$[]"]("rbstart")["$=="](2))&&(_(b.$length()["$!="](3))&&(d.log.$error(e("./abc2svg_to_harpnotes.rb".$force_encoding("US-ASCII")+":322: ","you need to specify 3 values: "+b),$.$charpos_to_line_column(n["$[]"]("istart")),$.$charpos_to_line_column(n["$[]"]("iend"))),b=[-10,10,15]),$.variant_endings.$last().$push(p(["rbstop","distance"],{rbstop:$.previous_note,distance:b}))),_(_(o=_(l=n["$[]"]("rbstop")["$=="](2))?$.variant_endings.$last().$last()["$nil?"]()["$!"]():l)?$.variant_endings.$last().$last()["$[]"]("rbstart"):o)&&(v=["rbstop",$.previous_note],h($.variant_endings.$last().$last(),"[]=",t.to_a(v)),v[r(v.length,1)],_($["$_bar_is_repetition_end?"](y))&&(v=["repeat_end",!0],h($.variant_endings.$last().$last(),"[]=",t.to_a(v)),v[r(v.length,1)]),_($["$_bar_is_repetition_end?"](y))?($.pushed_variant_ending_repeat=!0,$.repetition_stack.$push($.repetition_stack.$last())):_(_(o=$.pushed_variant_ending_repeat)?i($.repetition_stack.$count(),1):o)&&$.repetition_stack.$pop(),n["$[]"]("rbstart")["$=="](2)||(v=["variant_followup",!0],h($.next_note_marks,"[]=",t.to_a(v)),v[r(v.length,1)],$.variant_endings.$push([]),$.variant_no=0)),_($["$_bar_is_repetition_end?"](y))&&m["$<<"]($.$_transform_bar_repeat_end(n,s,a)),_((o=n["$[]"]("rbstop")["$=="](2))?n["$[]"]("rbstart")["$=="](2)["$!"]():n["$[]"]("rbstop")["$=="](2))&&_(y["$include?"](":"))&&(r(n["$[]"]("time"),$.measure_start_time)["$=="]($.wmeasure)||(v=["measure",!1],h($.next_note_marks,"[]=",t.to_a(v)),v[r(v.length,1)])),_(["||","|]"]["$include?"](y))&&(v=["first_in_part",!0],h($.next_note_marks,"[]=",t.to_a(v)),v[r(v.length,1)]),$.is_first_measure=!1,m},C.$$arity=3),t.def(lt,"$_transform_part",O=function(n,i,s){var a,o=c,l=c;return null==d.log&&(d.log=c),_(this.part_table["$[]"](n["$[]"]("time")))&&(o=this.$charpos_to_line_column(n["$[]"]("istart")),l=this.$charpos_to_line_column(n["$[]"]("iend")),d.log.$error(e(e("./abc2svg_to_harpnotes.rb".$force_encoding("US-ASCII")+":383: ","abc:"+o.$first()+":"+o.$last()+" Error: "),u(ut,"I18n").$t("Multiple parts for same note")),o,l)),a=[n["$[]"]("time"),n["$[]"]("text")],h(this.part_table,"[]=",t.to_a(a)),r(a.length,1),c},O.$$arity=3),t.def(lt,"$_transform_remark",B=function(n,i,s){var a,o=c,l=c;return null==d.log&&(d.log=c),_(this.remark_table["$[]"](n["$[]"]("time")))&&(o=this.$charpos_to_line_column(n["$[]"]("istart")),l=this.$charpos_to_line_column(n["$[]"]("iend")),d.log.$error(e(e("./abc2svg_to_harpnotes.rb".$force_encoding("US-ASCII")+":393: ","abc:"+o.$first()+":"+o.$last()+" Error: "),u(ut,"I18n").$t("Multiple remarks for same note")),o,l)),a=[n["$[]"]("time"),n["$[]"]("text")],h(this.remark_table,"[]=",t.to_a(a)),r(a.length,1),c},B.$$arity=3),t.def(lt,"$_transform_note",M=function(e,n,i){var s,a,o,f,$,p,d,m,y,g,v,b,A,x,w=c,k=c,E=c,S=c,N=c,I=c;return s=[(w=this.$_parse_origin(e))["$[]"]("startChar"),w["$[]"]("endChar")],d=s[0],m=s[1],a=this.$_parse_tuplet_info(e),s=t.to_ary(a),y=null==s[0]?c:s[0],g=null==s[1]?c:s[1],v=null==s[2]?c:s[2],b=this.$_parse_decorations(e),this.$_transform_measure_start(e),A=this.$_convert_duration(e["$[]"]("notes").$first()["$[]"]("dur")),k=h(e["$[]"]("notes"),"map",[],((o=function(n){var i,s=o.$$s||this,a=c;return null==s.measure_count&&(s.measure_count=c),null==s.variant_no&&(s.variant_no=c),null==n&&(n=c),i=l(l(u(ut,"Harpnotes"),"Music"),"Note").$new(n["$[]"]("midi"),A),a=[b],h(i,"decorations=",t.to_a(a)),a[r(a.length,1)],a=[s.measure_count],h(i,"measure_count=",t.to_a(a)),a[r(a.length,1)],a=[s.$_transform_count_note(e)],h(i,"count_note=",t.to_a(a)),a[r(a.length,1)],a=[s.$_transform_lyrics(e)],h(i,"lyrics=",t.to_a(a)),a[r(a.length,1)],a=[e["$[]"]("time")],h(i,"time=",t.to_a(a)),a[r(a.length,1)],a=[s.$_mkznid(e)],h(i,"znid=",t.to_a(a)),a[r(a.length,1)],a=[w],h(i,"origin=",t.to_a(a)),a[r(a.length,1)],a=[s.$charpos_to_line_column(d)],h(i,"start_pos=",t.to_a(a)),a[r(a.length,1)],a=[s.$charpos_to_line_column(m)],h(i,"end_pos=",t.to_a(a)),a[r(a.length,1)],a=[y],h(i,"tuplet=",t.to_a(a)),a[r(a.length,1)],a=[v],h(i,"tuplet_start=",t.to_a(a)),a[r(a.length,1)],a=[g],h(i,"tuplet_end=",t.to_a(a)),a[r(a.length,1)],a=[s.variant_no],h(i,"variant=",t.to_a(a)),a[r(a.length,1)],_(e["$[]"]("invis"))&&(a=[!1],h(i,"visible=",t.to_a(a)),a[r(a.length,1)]),i}).$$s=this,o.$$arity=1,o)),E=[],k.$count()["$=="](1)?E["$<<"](k.$first()):(S=l(l(u(ut,"Harpnotes"),"Music"),"SynchPoint").$new(k),N=k.$first(),I=[this.$_mkznid(e)],h(S,"znid=",t.to_a(I)),I[r(I.length,1)],I=[b],h(S,"decorations=",t.to_a(I)),I[r(I.length,1)],I=[this.measure_count],h(S,"measure_count=",t.to_a(I)),I[r(I.length,1)],I=[this.$_transform_count_note(e)],h(S,"count_note=",t.to_a(I)),I[r(I.length,1)],I=[this.$_transform_lyrics(e)],h(S,"lyrics=",t.to_a(I)),I[r(I.length,1)],I=[N.$time()],h(S,"time=",t.to_a(I)),I[r(I.length,1)],I=[N.$duration()],h(S,"duration=",t.to_a(I)),I[r(I.length,1)],I=[N.$origin()],h(S,"origin=",t.to_a(I)),I[r(I.length,1)],I=[N.$start_pos()],h(S,"start_pos=",t.to_a(I)),I[r(I.length,1)],I=[N.$end_pos()],h(S,"end_pos=",t.to_a(I)),I[r(I.length,1)],I=[N.$tuplet()],h(S,"tuplet=",t.to_a(I)),I[r(I.length,1)],I=[N.$tuplet_start()],h(S,"tuplet_start=",t.to_a(I)),I[r(I.length,1)],I=[N.$tuplet_end()],h(S,"tuplet_end=",t.to_a(I)),I[r(I.length,1)],E["$<<"](S)),_(this.repetition_stack["$empty?"]())&&this.repetition_stack["$<<"](E.$last()),I=[this.tie_started],h(E.$first(),"tie_end=",t.to_a(I)),I[r(I.length,1)],this.tie_started=e["$[]"]("ti1")["$nil?"]()["$!"](),I=[this.tie_started],h(E.$first(),"tie_start=",t.to_a(I)),I[r(I.length,1)],I=[h(this.$_parse_slur(e["$[]"]("slur_sls")),"map",[],(f=function(t){var e=f.$$s||this;return null==t&&(t=c),e.$_push_slur()},f.$$s=this,f.$$arity=1,f))],h(E.$first(),"slur_starts=",t.to_a(I)),I[r(I.length,1)],x=_(s=e["$[]"]("slur_end"))?s:0,I=[h(t.Range.$new(1,x,!1),"map",[],($=function(){return($.$$s||this).$_pop_slur()},$.$$s=this,$.$$arity=0,$))],h(E.$first(),"slur_ends=",t.to_a(I)),I[r(I.length,1)],_(this.next_note_marks["$[]"]("measure"))&&(h(k,"each",[],((p=function(e){p.$$s;return null==e&&(e=c),I=[!0],h(e,"measure_start=",t.to_a(I)),I[r(I.length,1)]}).$$s=this,p.$$arity=1,p)),I=["measure",!1],h(this.next_note_marks,"[]=",t.to_a(I)),I[r(I.length,1)]),this.$_make_repeats_jumps_annotations(E,e,i,b),E},M.$$arity=3),t.def(lt,"$_transform_measure_start",P=function(t){return _(this.next_note_marks["$[]"]("measure"))?(this.measure_count=e(this.measure_count,1),this.measure_start_time=t["$[]"]("time")):c},P.$$arity=1),t.def(lt,"$_transform_chordsymbol",F=function(t,e){var r,n=c,i=c;return n=[],_(t["$is_a?"](l(l(u(ut,"Harpnotes"),"Music"),"Playable")))&&(i=this.$_extract_chord_lines(t.$origin()["$[]"]("raw_voice_element")),h(i,"each_with_index",[],((r=function(i,s){r.$$s;var a=c,o=c,f=c,$=c;return null==d.conf&&(d.conf=c),null==i&&(i=c),null==s&&(s=c),a=i.$match(/^([^!#\<\>]+)([^\@]+)?(\@(\-?[0-9\.]+),(\-?[0-9\.]+))?$/),_(a)?(o=(o=a["$[]"](1)).$gsub("","#").$gsub("","b"),f=d.conf["$[]"]("defaults.notebound.chord.pos"),$="notebound.chord."+e+"."+t.$znid()+"."+s,n["$<<"](l(l(u(ut,"Harpnotes"),"Music"),"Chordsymbol").$new(t,p(["style","pos","text"],{style:"large",pos:f,text:o}),$))):c}).$$s=this,r.$$arity=2,r))),n},F.$$arity=2),t.def(lt,"$_transform_count_note",L=function(i){var a,o,l,f=c,$=c,p=c,d=c,m=c,y=c;return _(this.countby)?(f=n(u(ut,"ABC2SVG_DURATION_FACTOR"),this.countby),p=e($=n(s(4,r(i["$[]"]("time"),this.measure_start_time)),f),n(s(4,i["$[]"]("dur")),f)),d=[[/^<\d+>.*eue$/,"eue"],[/^<\d+>.*e$/,"e"],[/^u.*$/,"e"]],_(_(a=$["$%"](1)["$=="](0))?p["$%"](1)["$=="](0):a)?(m=(m=h(t.Range.$new($,p,!0).$to_a(),"map",[],(o=function(t){var e=o.$$s||this;return null==e.countnames&&(e.countnames=c),null==t&&(t=c),e.countnames["$[]"](t)},o.$$s=this,o.$$arity=1,o)).$join()).$gsub(/(\d+)/,"<\\1>"),y=h(d,"select",[],(l=function(t){l.$$s;return null==t&&(t=c),m.$match(t.$first())},l.$$s=this,l.$$arity=1,l)).$first(),_(y)&&(m=m.$gsub(y.$last(),"")),m=(m=m.$scan(/<\d+>|[eu]/).$join("-")).$gsub(/[<>]/,"")):m=$["$%"](1)["$=="](0)?"tra":"la"):m="x",m},L.$$arity=1),t.def(lt,"$_convert_duration",T=function(t){return[128,s(n(t,u(ut,"ABC2SVG_DURATION_FACTOR")),this._shortest_note).$round()].$min()},T.$$arity=1),t.def(lt,"$_transform_staves",j=function(t,e,r){var n=c,s=c;return null==d.log&&(d.log=c),_(this.score_statements)||(this.score_statements=[]),this.score_statements.$push(t),_(i(this.score_statements.$length(),1))?(n=this.$charpos_to_line_column(t["$[]"]("istart")),s=this.$charpos_to_line_column(t["$[]"]("iend")),d.log.$warning(""+u(ut,"I18n").$t("you have multiple %%score statements"),n,s)):c},j.$$arity=3),t.def(lt,"$_transform_rest",R=function(e,i,s){var a,o,f,$,p,m,y,g,v,b=c,A=c,x=c,w=c,k=c,E=c;return null==d.conf&&(d.conf=c),$=(a=[(b=this.$_parse_origin(e))["$[]"]("startChar"),b["$[]"]("endChar")])[0],p=a[1],A=[this.pitch_providers["$[]"](t.Range.$new(0,i,!1)).$compact().$last(),this.pitch_providers["$[]"](t.Range.$new(i,-1,!1)).$compact().$first()],d.conf["$[]"]("restposition.default")["$=="]("previous")&&(A=[_(a=A.$first())?a:A.$last()]),d.conf["$[]"]("restposition.default")["$=="]("next")&&(A=[_(a=A.$last())?a:A.$first()]),m=this.$_parse_decorations(e),A=A.$compact(),x=_(A["$empty?"]())?60:n((A=h(A,"map",[],((o=function(t){o.$$s;return null==t&&(t=c),t["$[]"]("notes").$last()["$[]"]("midi")}).$$s=this,o.$$arity=1,o))).$inject("+"),A.$length()).$floor().$to_i(),_(x["$nil?"]())&&(this.$raise("undefined pitch"),x=60),this.$_transform_measure_start(e),w=e["$[]"]("notes"),w=_(w)?w.$first()["$[]"]("dur"):e["$[]"]("dur"),w=this.$_convert_duration(w),f=this.$_parse_tuplet_info(e),y=null==(a=t.to_ary(f))[0]?c:a[0],g=null==a[1]?c:a[1],v=null==a[2]?c:a[2],k=l(l(u(ut,"Harpnotes"),"Music"),"Pause").$new(x,w),E=[this.measure_count],h(k,"measure_count=",t.to_a(E)),E[r(E.length,1)],E=[m],h(k,"decorations=",t.to_a(E)),E[r(E.length,1)],E=[this.$_transform_count_note(e)],h(k,"count_note=",t.to_a(E)),E[r(E.length,1)],E=[this.$_transform_lyrics(e)],h(k,"lyrics=",t.to_a(E)),E[r(E.length,1)],E=[this.$_mkznid(e)],h(k,"znid=",t.to_a(E)),E[r(E.length,1)],E=[e["$[]"]("time")],h(k,"time=",t.to_a(E)),E[r(E.length,1)],E=[this.$_parse_origin(e)],h(k,"origin=",t.to_a(E)),E[r(E.length,1)],E=[this.$charpos_to_line_column($)],h(k,"start_pos=",t.to_a(E)),E[r(E.length,1)],E=[this.$charpos_to_line_column(p)],h(k,"end_pos=",t.to_a(E)),E[r(E.length,1)],E=[this.variant_no],h(k,"variant=",t.to_a(E)),E[r(E.length,1)],E=[y],h(k,"tuplet=",t.to_a(E)),E[r(E.length,1)],E=[v],h(k,"tuplet_start=",t.to_a(E)),E[r(E.length,1)],E=[g],h(k,"tuplet_end=",t.to_a(E)),E[r(E.length,1)],_(e["$[]"]("invis"))&&(E=[!1],h(k,"visible=",t.to_a(E)),E[r(E.length,1)]),E=[e["$[]"]("invis")],h(k,"invisible=",t.to_a(E)),E[r(E.length,1)],_(this.repetition_stack["$empty?"]())&&this.repetition_stack["$<<"](k),k=[k],_(this.next_note_marks["$[]"]("measure"))&&(E=[!0],h(k.$first(),"measure_start=",t.to_a(E)),E[r(E.length,1)],E=["measure",!1],h(this.next_note_marks,"[]=",t.to_a(E)),E[r(E.length,1)]),this.$_make_repeats_jumps_annotations(k,e,s,m),k},R.$$arity=3),t.def(lt,"$_transform_tempo",D=function(t,r,n){var i=c,s=c;return null==d.log&&(d.log=c),_(this.tempo_statements["$empty?"]())||(i=this.$charpos_to_line_column(t["$[]"]("istart")),s=this.$charpos_to_line_column(t["$[]"]("iend")),d.log.$error(e(e("./abc2svg_to_harpnotes.rb".$force_encoding("US-ASCII")+":680: ","abc:"+i.$first()+":"+i.$last()+" Error: "),u(ut,"I18n").$t("tempo change not suported by zupfnoter")),i,s)),this.tempo_statements.$push(t)},D.$$arity=3),t.def(lt,"$_transform_yspace",z=function(t,e){return c},z.$$arity=2),t.def(lt,"$_transform_bar_repeat_end",U=function(e,n,s){var a,o=c,f=c,$=c,m=c,y=c;return null==d.conf&&(d.conf=c),f=(o=this.repetition_stack.$length())["$=="](1)?this.repetition_stack.$last():this.repetition_stack.$pop(),$=this.$_extract_goto_info_from_bar(e),m=function(){try{return $.$last()["$[]"]("distance")}catch(e){if(!t.rescue(e,[u(ut,"StandardError")]))throw e;try{return[2]}finally{t.pop_exception()}}}(),_(i(m.$count(),1))&&this.$raise("too many distance values for repeat end. Need only one "+m),_(this.previous_note["$is_a?"](l(l(u(ut,"Harpnotes"),"Music"),"Pause")))&&d.conf["$[]"]("restposition.repeatend")["$=="]("previous")&&(y=[this.previous_note.$prev_pitch()],h(this.previous_note,"pitch=",t.to_a(y)),y[r(y.length,1)]),m=m.$first(),y=["first_in_part",!0],h(this.next_note_marks,"[]=",t.to_a(y)),y[r(y.length,1)],a="notebound.c_jumplines."+s+"."+this.previous_note.$znid()+".p_repeat",[l(l(u(ut,"Harpnotes"),"Music"),"Goto").$new(this.previous_note,f,p(["distance","is_repeat","level","conf_key"],{distance:m,is_repeat:!0,level:o,conf_key:a}))]},U.$$arity=3),t.def(lt,"$_transform_grace",q=function(){return c},q.$$arity=0),t.def(lt,"$_transform_format",H=function(t){return c},H.$$arity=1),t.def(lt,"$_transform_key",Q=function(t){return c},Q.$$arity=1),t.def(lt,"$_transform_lyrics",Y=function(t){var e,r,n=c;return _(t["$[]"]("a_ly"))?(n=t["$[]"]("a_ly").$first(),_(n)&&(n=(e=n["$[]"]("t"),e===c||null==e?c:h(e,"gsub",["\n","-"])).$gsub("_",""))):n="",_(r=n)?r:""},Y.$$arity=1),t.def(lt,"$_transform_meter",G=function(r){var n=c,i=c;return null==d.log&&(d.log=c),_(this.next_note_marks["$[]"]("measure"))||(n=this.$charpos_to_line_column(r["$[]"]("istart")),i=this.$charpos_to_line_column(r["$[]"]("iend")),d.log.$warning(e("abc:"+n.$first()+":"+n.$last()+" Error: ",u(ut,"I18n").$t("Meter change not at beginning of measure")),n,i)),this.is_first_measure=!0,this.wmeasure=r["$[]"]("wmeasure"),this.countby=function(){try{return r["$[]"]("a_meter").$first()["$[]"]("bot").$to_i()}catch(e){if(!t.rescue(e,[u(ut,"StandardError")]))throw e;try{return c}finally{t.pop_exception()}}}(),c},G.$$arity=1),t.def(lt,"$_transform_block",V=function(t){return c},V.$$arity=1),t.def(lt,"$_transform_clef",J=function(t){return c},J.$$arity=1),t.def(lt,"$_make_variant_ending_jumps",X=function(e){var r,n,i=this,s=c;return s=[],n=_(i.variant_endings.$last()["$empty?"]())?-2:-1,h(i.variant_endings["$[]"](t.Range.$new(0,n,!1)),"each",[],((r=function(n){var i,a,o,f=r.$$s||this,$=c,d=c,m=c,g=c;return null==n&&(n=c),$=n["$[]"](0)["$[]"]("distance"),d=n.$first()["$[]"]("rbstop"),o="notebound.c_jumplines."+e+"."+d.$znid(),m=_(n["$[]"](-1)["$[]"]("is_followup"))?-2:-1,h(n["$[]"](t.Range.$new(1,m,!1)),"each_with_index",[],((i=function(t,e){var r;i.$$s;return null==t&&(t=c),null==e&&(e=c),r=o+"."+e+".p_begin",s["$<<"](l(l(u(ut,"Harpnotes"),"Music"),"Goto").$new(n["$[]"](0)["$[]"]("rbstop"),t["$[]"]("rbstart"),p(["conf_key","distance","from_anchor","to_anchor"],{conf_key:r,distance:$["$[]"](0),from_anchor:"after",to_anchor:"before"})))}).$$s=f,i.$$arity=2,i)),h(n["$[]"](y(1,-3,!1)),"each_with_index",[],((a=function(t,e){a.$$s;var r=c;return null==t&&(t=c),null==e&&(e=c),_(t["$[]"]("repeat_end"))?c:(r=o+".p_end",s["$<<"](l(l(u(ut,"Harpnotes"),"Music"),"Goto").$new(t["$[]"]("rbstop"),n["$[]"](-1)["$[]"]("rbstart"),p(["conf_key","distance","from_anchor","to_anchor","vertical_anchor"],{conf_key:r,distance:$["$[]"](1),from_anchor:"after",to_anchor:"before",vertical_anchor:"to"}))))}).$$s=f,a.$$arity=2,a)),_(n["$[]"](-1)["$[]"]("is_followup"))?(g=o+".p_follow",s["$<<"](l(l(u(ut,"Harpnotes"),"Music"),"Goto").$new(n["$[]"](-2)["$[]"]("rbstop"),n["$[]"](-1)["$[]"]("rbstart"),p(["conf_key","distance","from_anchor","to_anchor","vertical_anchor"],{conf_key:g,distance:$["$[]"](2),from_anchor:"after",to_anchor:"before",vertical_anchor:"to"})))):c}).$$s=i,r.$$arity=1,r)),s},X.$$arity=1),t.def(lt,"$_make_jumplines",W=function(t,e){var r,n=c;return _(t["$is_a?"](l(l(u(ut,"Harpnotes"),"Music"),"Playable")))?(n=this.$_extract_goto_info_from_bar(t.$origin()["$[]"]("raw_voice_element")),h(n,"inject",[[]],((r=function(n,i){var s,a,o,f,$=r.$$s||this,h=c;return null==$.jumptargets&&($.jumptargets=c),null==d.log&&(d.log=c),null==n&&(n=c),null==i&&(i=c),a=i["$[]"]("target"),h=$.jumptargets["$[]"](a),o="notebound.c_jumplines."+e+"."+t.$znid()+".p_goto",f=_(s=i["$[]"]("distance").$first())?s:2,_(h["$nil?"]())?d.log.$error("target '"+a+"' not found in voice at "+t.$start_pos_to_s(),t.$start_pos(),t.$end_pos()):n["$<<"](l(l(u(ut,"Harpnotes"),"Music"),"Goto").$new(t,h,p(["conf_key","distance"],{conf_key:o,distance:f}))),n}).$$s=this,r.$$arity=2,r))):c},W.$$arity=2),t.def(lt,"$_make_notebound_annotations",K=function(n,s){var a,o=c,f=c;return o=[],_(n["$is_a?"](l(l(u(ut,"Harpnotes"),"Music"),"Playable")))&&(f=this.$_extract_chord_lines(n.$origin()["$[]"]("raw_voice_element")),h(f,"each_with_index",[],((a=function(f,$){var m,y,g,v,b,A=a.$$s||this,x=c,w=c,k=c,E=c,S=c,N=c,I=c,C=c,O=c,B=c,M=c;return null==A.annotations&&(A.annotations=c),null==d.log&&(d.log=c),null==d.conf&&(d.conf=c),null==f&&(f=c),null==$&&($=c),x=f.$match(/^([!#\<\>])([^\@]+)?(\@(\-?[0-9\.]+),(\-?[0-9\.]+))?$/),_(x)?(w=x["$[]"](1),k=x["$[]"](2),_(x["$[]"](4))&&(E=x["$[]"](4)),_(x["$[]"](5))&&(S=x["$[]"](5)),"#"["$==="](N=w)?(I=A.annotations["$[]"](k),_(I)||d.log.$error(e(e("./abc2svg_to_harpnotes.rb".$force_encoding("US-ASCII")+":856: ",u(ut,"I18n").$t("could not find annotation"))," "+k),n.$start_pos(),n.$end_pos())):"!"["$==="](N)?I=p(["text","style"],{text:k,style:"regular"}):"<"["$==="](N)?(C=[p(["dir","size","style"],{dir:-1,size:k,style:"regular"})],h(n,"shift=",t.to_a(C)),C[r(C.length,1)],_(n["$is_a?"](l(l(u(ut,"Harpnotes"),"Music"),"SynchPoint")))&&h(n.$notes(),"each",[],((m=function(e){m.$$s;return null==e&&(e=c),C=[p(["dir","size","style"],{dir:-1,size:k,style:"regular"})],h(e,"shift=",t.to_a(C)),C[r(C.length,1)]}).$$s=A,m.$$arity=1,m))):">"["$==="](N)?(C=[p(["dir","size","style"],{dir:1,size:k,style:"regular"})],h(n,"shift=",t.to_a(C)),C[r(C.length,1)],_(n["$is_a?"](l(l(u(ut,"Harpnotes"),"Music"),"SynchPoint")))&&h(n.$notes(),"each",[],((y=function(e){y.$$s;return null==e&&(e=c),C=[p(["dir","size","style"],{dir:1,size:k,style:"regular"})],h(e,"shift=",t.to_a(C)),C[r(C.length,1)]}).$$s=A,y.$$arity=1,y))):I=c,_(I)?(_(E)&&(O=h([E,S],"map",[],((g=function(t){g.$$s;return null==t&&(t=c),t.$to_f()}).$$s=A,g.$$arity=1,g))),B=_(v=_(b=O)?b:I["$[]"]("pos"))?v:d.conf["$[]"]("defaults.notebound.annotation.pos"),_(n.$znid())&&(M="notebound.annotation."+s+"."+n.$znid()),_(i($,0))&&(M="notebound.annotation."+s+"."+n.$znid()+"."+$),o["$<<"](l(l(u(ut,"Harpnotes"),"Music"),"NoteBoundAnnotation").$new(n,p(["style","pos","text"],{style:I["$[]"]("style"),pos:B,text:I["$[]"]("text")}),M))):c):c}).$$s=this,a.$$arity=2,a))),o},K.$$arity=2),t.def(lt,"$_make_repeats_jumps_annotations",Z=function(e,n,i,s){var a,o,f,$,m,g=c,v=c,b=c,A=c,x=c;return null==d.conf&&(d.conf=c),null==s&&(s=[]),g=e.$first(),f=this.part_table["$[]"](n["$[]"]("time")),_(this.previous_note)&&(v=[g.$pitch()],h(this.previous_note,"next_pitch=",t.to_a(v)),v[r(v.length,1)],v=[g],h(this.previous_note,"next_playable=",t.to_a(v)),v[r(v.length,1)],_(f)&&(v=[!0],h(this.previous_note,"next_first_in_part=",t.to_a(v)),v[r(v.length,1)]),v=[this.previous_note.$pitch()],h(g,"prev_pitch=",t.to_a(v)),v[r(v.length,1)],v=[this.previous_note],h(g,"prev_playable=",t.to_a(v)),v[r(v.length,1)]),this.previous_note=g,$=g.$znid(),_(f)&&(_($)&&(b="notebound.partname."+i+"."+$),A=d.conf["$[]"]("defaults.notebound.partname.pos"),v=[!0],h(e.$first(),"first_in_part=",t.to_a(v)),v[r(v.length,1)],e["$<<"](l(l(u(ut,"Harpnotes"),"Music"),"NoteBoundAnnotation").$new(e.$first(),p(["style","pos","text"],{style:"bold",pos:A,text:f}),b))),_(this.next_note_marks["$[]"]("repeat_start"))&&(v=[!0],h(this.previous_note,"first_in_part=",t.to_a(v)),v[r(v.length,1)],this.repetition_stack["$<<"](e.$first()),v=["repeat_start",!1],h(this.next_note_marks,"[]=",t.to_a(v)),v[r(v.length,1)]),_(this.next_note_marks["$[]"]("first_in_part"))&&(v=[!0],h(this.previous_note,"first_in_part=",t.to_a(v)),v[r(v.length,1)],v=["first_in_part",!1],h(this.next_note_marks,"[]=",t.to_a(v)),v[r(v.length,1)]),_(this.next_note_marks["$[]"]("variant_ending"))&&(x=this.next_note_marks["$[]"]("variant_ending")["$[]"]("text"),_($)&&(b="notebound.variantend."+i+"."+$),A=d.conf["$[]"]("defaults.notebound.variantend.pos"),v=[!0],h(e.$first(),"first_in_part=",t.to_a(v)),v[r(v.length,1)],e["$<<"](l(l(u(ut,"Harpnotes"),"Music"),"NoteBoundAnnotation").$new(e.$first(),p(["style","pos","text","policy"],{style:"regular",pos:A,text:x,policy:"Goto"}),b)),v=["variant_ending",c],h(this.next_note_marks,"[]=",t.to_a(v)),v[r(v.length,1)],this.variant_endings.$last().$push(p([],{})),v=["rbstart",this.previous_note],h(this.variant_endings.$last().$last(),"[]=",t.to_a(v)),v[r(v.length,1)]),_(this.next_note_marks["$[]"]("variant_followup"))&&(v=[!0],h(this.previous_note,"first_in_part=",t.to_a(v)),v[r(v.length,1)],this.variant_endings["$[]"](-2).$push(p(["rbstart","is_followup"],{rbstart:this.previous_note,is_followup:!0})),v=["variant_followup",!1],h(this.next_note_marks,"[]=",t.to_a(v)),v[r(v.length,1)]),m=this.$_extract_chord_lines(n),h(h(m,"select",[],((a=function(t){a.$$s;return null==t&&(t=c),t["$[]"](0)["$=="](":")}).$$s=this,a.$$arity=1,a)),"each",[],((o=function(n){var i,s=o.$$s||this;return null==s.jumptargets&&(s.jumptargets=c),null==n&&(n=c),v=[n["$[]"](y(1,-1,!1)),h(e,"select",[],(i=function(t){i.$$s;return null==t&&(t=c),t["$is_a?"](l(l(u(ut,"Harpnotes"),"Music"),"Playable"))},i.$$s=s,i.$$arity=1,i)).$last()],h(s.jumptargets,"[]=",t.to_a(v)),v[r(v.length,1)]}).$$s=this,o.$$arity=1,o)),_(s["$include?"]("breath"))?(v=["first_in_part",!0],h(this.next_note_marks,"[]=",t.to_a(v)),v[r(v.length,1)]):c},Z.$$arity=-4),t.def(lt,"$_get_extra",tt=function(e,r){var n,i,s=this;return function(){try{return _(n=e["$[]"]("extra"))?h(e["$[]"]("extra"),"select",[],(i=function(t){i.$$s;return null==t&&(t=c),t["$[]"]("type").$to_s()["$=="](r.$to_s())},i.$$s=s,i.$$arity=1,i)).$first():n}catch(e){if(!t.rescue(e,[u(ut,"StandardError")]))throw e;try{return c}finally{t.pop_exception()}}}()},tt.$$arity=2),t.def(lt,"$_push_slur",et=function(){return this.slurstack=e(this.slurstack,1)},et.$$arity=0),t.def(lt,"$_pop_slur",rt=function(){var t,e,n;return t=this.slurstack,this.slurstack=r(this.slurstack,1),_((e=this.slurstack,n=0,"number"==typeof e&&"number"==typeof n?e<n:e["$<"](n)))&&(this.slurstack=0),t},rt.$$arity=0),t.def(lt,"$_extract_chord_lines",nt=function(t){var e,r,n;return n=t["$[]"]("a_gch"),_(n)?h(h(n,"select",[],((e=function(t){e.$$s;return null==t&&(t=c),t["$[]"]("type")["$=="]("^"),!0}).$$s=this,e.$$arity=1,e)),"map",[],((r=function(t){r.$$s;return null==t&&(t=c),t["$[]"]("text")}).$$s=this,r.$$arity=1,r)):[]},nt.$$arity=1),t.def(lt,"$_extract_goto_info_from_bar",it=function(t){var r,n;return n=this.$_extract_chord_lines(t),h(n,"inject",[[]],((r=function(n,i){var s,a=r.$$s||this,o=c,l=c,f=c,$=c,m=c;return null==d.log&&(d.log=c),null==n&&(n=c),null==i&&(i=c),_(i["$start_with?"]("@"))&&(o=i.$match(/^^@([^\@]*)@(\-?\d*)(,(\-?\d*),(\-?\d*))?$/),_(o)?(l=o["$[]"](1),f=h([2,4,5],"map",[],(s=function(t){s.$$s;return null==t&&(t=c),_(o["$[]"](t))?o["$[]"](t).$to_i():c},s.$$s=a,s.$$arity=1,s)).$compact(),n.$push(p(["target","distance"],{target:l,distance:f}))):($=a.$charpos_to_line_column(t["$[]"]("istart")),m=a.$charpos_to_line_column(t["$[]"]("iend")),d.log.$error(e("./abc2svg_to_harpnotes.rb".$force_encoding("US-ASCII")+":1009: ",u(ut,"I18n").$t("Syntax-Error in Jump anotation")),$,m))),n}).$$s=this,r.$$arity=2,r))},it.$$arity=1),t.def(lt,"$_parse_decorations",st=function(t){var e,r,n,i,s=c;return i=_(e=t["$[]"]("a_dd"))?e:[],s=h(i,"map",[],((r=function(t){r.$$s;return null==t&&(t=c),s=t["$[]"]("name").$to_sym()}).$$s=this,r.$$arity=1,r)),h(s.$flatten(),"select",[],((n=function(t){var e=n.$$s||this;return null==e.supported_decorations&&(e.supported_decorations=c),null==t&&(t=c),e.supported_decorations["$include?"](t)}).$$s=this,n.$$arity=1,n))},st.$$arity=1),t.def(lt,"$_parse_origin",at=function(t){return p(["startChar","endChar","start_pos","end_pos","raw_voice_element"],{startChar:t["$[]"]("istart"),endChar:t["$[]"]("iend"),start_pos:t["$[]"]("start_pos"),end_pos:t["$[]"]("end_pos"),raw_voice_element:t})},at.$$arity=1),t.def(lt,"$_parse_slur",ot=function(t){var e,r=c,n=c;for(r=_(e=t)?e:0,n=[];_(i(r,0));)n.$push(r["$&"](15)),r=r["$>>"](4);return n},ot.$$arity=1),t.def(lt,"$_parse_tuplet_info",ct=function(t){var r,n,i,s,a,o=c,l=c,f=c,$=c,p=c;return null==d.log&&(d.log=c),_(t["$[]"]("in_tuplet"))?(_((r=t["$[]"]("tp"))===c||null==r?c:h(r,"[]",[1]))?(o=this.$charpos_to_line_column(t["$[]"]("istart")),l=this.$charpos_to_line_column(t["$[]"]("iend")),d.log.$error(e(e("./abc2svg_to_harpnotes.rb".$force_encoding("US-ASCII")+":1061: ","abc:"+o.$first()+":"+o.$last()+" Error: "),u(ut,"I18n").$t("Nested Tuplet")),o,l)):_((n=t["$[]"]("tp"))===c||null==n?c:h(n,"[]",[0]))?(this.tuplet_p=(s=(i=t["$[]"]("tp"))===c||null==i?c:h(i,"first",[]))===c||null==s?c:h(s,"[]",["p"]),f=!0):f=!1,$=this.tuplet_p,_(_(a=t["$[]"]("tpe"))?this.tuplet_p["$nil?"]()["$!"]():a)?(p=!0,this.tuplet_p=c):p=c):($=1,f=c,p=c),[$,p,f]},ct.$$arity=1)}(g[0],u(g,"AbstractAbcToHarpnotes"),g)}(g[0],g)}(o[0],o)},Opal.modules["opal-jspdf"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}function n(t,e){return"number"==typeof t&&"number"==typeof e?t/e:t["$/"](e)}var i=t.top,s=[],a=t.nil,o=(t.const_get_qualified,t.const_get_relative,t.breaker,t.slice,t.klass),c=t.truthy,l=t.send;return t.add_stubs(["$require","$attr_accessor","$apply_offset_to_point","$[]","$nil?","$start_with?","$raise","$to_n","$map","$*","$-","$==","$+","$/","$Native","$private","$first","$last"]),i.$require("native"),function(i,s,u){var f,$,h,p,d,_,m,y,g,v,b,A,x,w,k,E,S,N,I,C,O,B,M,P,F=o(i,null,"JsPDF");[F].concat(u);return F.$$prototype.native_jspdf=F.$$prototype.x_offset=F.$$prototype.y_offset=a,F.$attr_accessor("x_offset","y_offset"),t.def(F,"$initialize",f=function(t,e,r){return null==t&&(t="p"),null==e&&(e="mm"),null==r&&(r="a4"),this.x_offset=0,this.y_offset=0,this.native_jspdf=new jsPDF(t,e,r)},f.$$arity=-1),t.defs(F,"$jspdfversion",$=function(){return jsPDF.version},$.$$arity=0),t.def(F,"$line",h=function(t,e){var r,n;return r=this.$apply_offset_to_point(t),n=this.$apply_offset_to_point(e),this.native_jspdf.lines([[n[0]-r[0],n[1]-r[1]]],r[0],r[1])},h.$$arity=2),t.def(F,"$line_cap=",p=function(t){return this.native_jspdf.setLineCap(t)},p.$$arity=1),t.def(F,"$ellipse",d=function(t,e,r){var n=a;return null==r&&(r=void 0),n=this.$apply_offset_to_point(t),this.native_jspdf.ellipse(n["$[]"](0),n["$[]"](1),e["$[]"](0),e["$[]"](1),r)},d.$$arity=-3),t.def(F,"$fill=",_=function(t){return this.native_jspdf.setFillColor(t[0],t[1],t[2])},_.$$arity=1),t.def(F,"$stroke=",m=function(t){return this.native_jspdf.setDrawColor(t[0],t[1],t[2])},m.$$arity=1),t.def(F,"$line_width=",y=function(t){return this.native_jspdf.setLineWidth(t)},y.$$arity=1),t.def(F,"$line_dash=",g=function(t){return null==t&&(t=3),c(t["$nil?"]())&&(t=void 0),this.native_jspdf.setLineDash([t,t],t)},g.$$arity=-1),t.def(F,"$text_color=",v=function(t){return this.native_jspdf.setTextColor(t[0],t[1],t[2])},v.$$arity=1),t.def(F,"$font_size=",b=function(t){return this.native_jspdf.setFontSize(t)},b.$$arity=1),t.def(F,"$font_style=",A=function(t){return this.native_jspdf.setFontStyle(t)},A.$$arity=1),t.def(F,"$use_solid_lines",x=function(){return this.native_jspdf.setLineDash("",0)},x.$$arity=0),t.def(F,"$image",w=function(e,r,n,i){var s,o,l,u,f=a;return o=this.$apply_offset_to_point([r,n]),l=null==(s=t.to_ary(o))[0]?a:s[0],u=null==s[1]?a:s[1],f=a,c(e["$start_with?"]("data:image/jpeg"))&&(f="jpeg"),c(e["$start_with?"]("data:image/png"))&&(f="png"),c(f)?this.native_jspdf.addImage(e,f,l,u,0,i):this.$raise("image format not supported for pdf: "+f)},w.$$arity=4),t.def(F,"$text",k=function(e,r,n,i){var s,o,c,l;return null==i&&(i=a),o=this.$apply_offset_to_point([e,r]),c=null==(s=t.to_ary(o))[0]?a:s[0],l=null==s[1]?a:s[1],this.native_jspdf.text(c,l,n,i.$to_n())},k.$$arity=-4),t.def(F,"$rect_like_ellipse",E=function(t,r,n){var i,s=a,o=a;return null==n&&(n="undefined"),s=this.$apply_offset_to_point(t),o=l(r,"map",[],((i=function(t){var e,r;i.$$s;return null==t&&(t=a),r=t,"number"==typeof(e=2)&&"number"==typeof r?e*r:e["$*"](r)}).$$s=this,i.$$arity=1,i)),this.native_jspdf.rect(e(s["$[]"](0),r["$[]"](0)),e(s["$[]"](1),r["$[]"](1)),o["$[]"](0),o["$[]"](1),n)},E.$$arity=-3),t.def(F,"$rect",S=function(e,r,n,i,s){var o,c,l,u;return null==s&&(s="undefined"),c=this.$apply_offset_to_point([e,r]),l=null==(o=t.to_ary(c))[0]?a:o[0],u=null==o[1]?a:o[1],this.native_jspdf.rect(l,u,n,i,s)},S.$$arity=-5),t.def(F,"$lines",N=function(e,r,n,i,s,o){var c,l,u,f;return l=this.$apply_offset_to_point([r,n]),u=null==(c=t.to_ary(l))[0]?a:c[0],f=null==c[1]?a:c[1],this.native_jspdf.lines(e,u,f,i,s,o)},N.$$arity=6),t.def(F,"$output",I=function(t,e){return null==t&&(t="raw"),null==e&&(e=a),t["$=="]("raw")&&(t=void 0),c(e["$nil?"]())&&(e=void 0),this.native_jspdf.output(t,e)},I.$$arity=-1),t.def(F,"$left_arrowhead",C=function(i,s){var o,c,l,u,f,$,h,p;return 1,c=this.$apply_offset_to_point([i,s]),l=null==(o=t.to_ary(c))[0]?a:o[0],u=null==o[1]?a:o[1],f=l,$=r(l,1),h=r(u,n(1,2)),p=e(u,n(1,2)),this.native_jspdf.triangle(f,u,$,h,$,p,f,u,"FD")},C.$$arity=2),t.def(F,"$addPage",O=function(){return this.native_jspdf.addPage()},O.$$arity=0),t.def(F,"$get_text_width",B=function(t){return this.native_jspdf.getTextWidth(t)},B.$$arity=1),t.def(F,"$get_text_dimensions",M=function(t){return this.$Native(this.native_jspdf.getTextDimensions(t.$to_n()))},M.$$arity=1),F.$private(),t.def(F,"$apply_offset_to_point",P=function(t){return[r(t.$first(),this.x_offset),r(t.$last(),this.y_offset)]},P.$$arity=1),a&&"apply_offset_to_point"}(s[0],0,s)},Opal.modules["opal-jszip"]=function(t){t.top;var e=[],r=(t.nil,t.const_get_qualified,t.const_get_relative),n=(t.breaker,t.slice,t.module),i=t.klass;return t.add_stubs(["$new","$to_blob"]),function(e,s){var a=[n(e,"JSZip")].concat(s);!function(e,n,s){var a,o,c,l,u,f,$=i(e,null,"ZipFile"),h=[$].concat(s);t.def($,"$initialize",a=function(){return this.zip=new JSZip},a.$$arity=0),t.def($,"$folder",o=function(t){return r(h,"Folder").$new(this.zip.folder(t))},o.$$arity=1),t.def($,"$file",c=function(t,e){return this.zip.file(t,e)},c.$$arity=2),t.def($,"$to_blob",l=function(){return this.zip.generate({type:"blob"})},l.$$arity=0),t.def($,"$to_blob_url",u=function(){var t;return t=this.$to_blob(),window.URL.createObjectURL(t)},u.$$arity=0),t.def($,"$to_base64",f=function(){return this.zip.generate()},f.$$arity=0)}(a[0],0,a),function(e,r,n){var s,a,o=i(e,null,"Folder");[o].concat(n);t.def(o,"$initialize",s=function(t){return this.folder=t},s.$$arity=1),t.def(o,"$file",a=function(t,e){return this.folder.file(t,e)},a.$$arity=2)}(a[0],0,a)}(e[0],e)},Opal.modules.pdf_engine=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t*e:t["$*"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}function n(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}function i(t,e){return"number"==typeof t&&"number"==typeof e?t/e:t["$/"](e)}var s=t.top,a=[],o=t.nil,c=t.const_get_qualified,l=t.const_get_relative,u=(t.breaker,t.slice,t.module),f=t.klass,$=t.hash2,h=t.gvars,p=t.send,d=t.truthy,_=t.range;return t.add_stubs(["$require","$include","$attr_reader","$new","$*","$[]","$last","$printer_config","$y_offset=","$-","$each","$draw_segment","$+","$first","$x_offset=","$draw_sheet","$addPage","$rect","$children","$line_width","$line_width=","$is_a?","$visible?","$draw_ellipse","$draw_flowline","$draw_glyph","$draw_path","$draw_annotation","$draw_image","$error","$class","$private","$get","$style","$text_color=","$font_size=","$font_style=","$align","$gsub","$text","$==","$split","$empty?","$center","$color","$filled?","$size","$stroke=","$fill=","$rect?","$rect_like_ellipse","$ellipse","$fill","$map","$/","$dotted?","$draw_the_dot","$hasbarover","$draw_the_barover","$glyph","$===","$lines","$push","$hasbarover?","$dashed?","$line_dash=","$line","$from","$to","$use_solid_lines","$clone","$[]=","$distance","$nil?","$level","$left_arrowhead","$Vector2d","$llpos","$height","$image","$url","$x","$y","$opacity","$line_cap=","$path","$inject","$flatten"]),s.$require("opal-jspdf"),s.$require("harpnotes"),function(s,a){var m=[u(s,"Harpnotes")].concat(a);!function(s,a,u){var m,y,g,v,b,A,x,w,k,E,S,N,I,C,O=f(s,null,"PDFEngine"),B=[O].concat(u);O.$$prototype.pdf=o,O.$include(c(l(B,"Harpnotes"),"Drawing")),O.$attr_reader("pdf"),t.const_set(B[0],"PADDING",4),t.const_set(B[0],"JUMPLINE_INDENT",10),t.const_set(B[0],"JUMPLINE_INDENT",10),t.const_set(B[0],"DOTTED_SIZE",.5),t.const_set(B[0],"COLORS",$(["black","white","grey","lightgrey","darkgrey","dimgrey"],{black:[0,0,0],white:[255,255,255],grey:[128,128,128],lightgrey:[211,211,211],darkgrey:[169,169,169],dimgrey:[105,105,105]})),t.def(O,"$initialize",m=function(){return this.pdf=l(B,"JsPDF").$new("l","mm","a3")},m.$$arity=0),t.def(O,"$draw_in_segments",y=function(i){var s,a,c,u,f,$=o;return null==h.conf&&(h.conf=o),c=e(-12,h.conf["$[]"]("layout.X_SPACING")),this.pdf=l(B,"JsPDF").$new("p","mm","a4"),u=[i.$printer_config()["$[]"]("a4_offset").$last()],p(this.pdf,"y_offset=",t.to_a(u)),r(u.length,1),$=!1,f=d(s=i.$printer_config()["$[]"]("a4_pages"))?s:[0,1,2],p(f,"each",[],((a=function(t){var r=a.$$s||this;return null==t&&(t=o),r.$draw_segment(n(n(30,i.$printer_config()["$[]"]("a4_offset").$first()),e(t,c)),i,$),$=!0}).$$s=this,a.$$arity=1,a)),this.pdf},y.$$arity=1),t.def(O,"$draw",g=function(e){var r,n;return n=e.$printer_config()["$[]"]("a3_offset"),r=t.to_ary(n),this.pdf["$x_offset="](null==r[0]?o:r[0]),this.pdf["$y_offset="](null==r[1]?o:r[1]),this.$draw_sheet(e)},g.$$arity=1),t.def(O,"$draw_segment",v=function(e,n,i){var s;return null==i&&(i=!1),s=[e],p(this.pdf,"x_offset=",t.to_a(s)),r(s.length,1),d(i)&&this.pdf.$addPage(),this.$draw_sheet(n)},v.$$arity=-3),t.def(O,"$draw_sheet",b=function(e){var n;return d(e.$printer_config()["$[]"]("show_border"))&&(this.pdf.$rect(1,1,418,295,"S"),this.pdf.$rect(0,0,420,297,"S")),p(e.$children(),"each",[],((n=function(e){var i,s=n.$$s||this;return null==s.pdf&&(s.pdf=o),null==h.log&&(h.log=o),null==e&&(e=o),i=[e.$line_width()],p(s.pdf,"line_width=",t.to_a(i)),r(i.length,1),d(e["$is_a?"](l(B,"Ellipse")))?d(e["$visible?"]())?s.$draw_ellipse(e):o:d(e["$is_a?"](l(B,"FlowLine")))?d(e["$visible?"]())?s.$draw_flowline(e):o:d(e["$is_a?"](c(c(l(B,"Harpnotes"),"Drawing"),"Glyph")))?d(e["$visible?"]())?s.$draw_glyph(e):o:d(e["$is_a?"](c(c(l(B,"Harpnotes"),"Drawing"),"Path")))?d(e["$visible?"]())?s.$draw_path(e):o:d(e["$is_a?"](c(c(l(B,"Harpnotes"),"Drawing"),"Annotation")))?d(e["$visible?"]())?s.$draw_annotation(e):o:d(e["$is_a?"](c(c(l(B,"Harpnotes"),"Drawing"),"Image")))?s.$draw_image(e):(h.log.$error("BUG: don't know how to draw "+e.$class()+" ("+"./pdf_engine.rb".$force_encoding("US-ASCII")+" 74)"),o)}).$$s=this,n.$$arity=1,n)),this.pdf},b.$$arity=1),O.$private(),t.def(O,"$draw_annotation",A=function(i){var s,a,c,l,u=o,f=o,_=o;return null==h.conf&&(h.conf=o),u=d(s=h.conf.$get("layout.FONT_STYLE_DEF")["$[]"](i.$style()))?s:h.conf.$get("layout.FONT_STYLE_DEF")["$[]"]("regular"),c=h.conf.$get("layout.MM_PER_POINT"),f=[u["$[]"]("text_color")],p(this.pdf,"text_color=",t.to_a(f)),f[r(f.length,1)],f=[e(u["$[]"]("font_size"),.983)],p(this.pdf,"font_size=",t.to_a(f)),f[r(f.length,1)],f=[u["$[]"]("font_style")],p(this.pdf,"font_style=",t.to_a(f)),f[r(f.length,1)],l=d(s=i.$align())?s:"left",_=(_=p(i.$text(),"gsub",[/(\\?)(~)/],((a=function(t){a.$$s;return null==t&&(t=o),t["$[]"](0)["$=="]("\\")?t["$[]"](1):" "}).$$s=this,a.$$arity=1,a))).$split("\n"),d(_["$empty?"]())&&(_=[""]),this.pdf.$text(i.$center().$first(),n(i.$center().$last(),e(u["$[]"]("font_size"),c)),_,$(["align"],{align:l}))},A.$$arity=1),t.def(O,"$draw_ellipse",x=function(e){var n,s,a,c=o,u=o;return s=l(B,"COLORS")["$[]"](e.$color()),a=d(e["$filled?"]())?"F":"FD",c=e.$size(),u=[0],p(this.pdf,"line_width=",t.to_a(u)),u[r(u.length,1)],u=[s],p(this.pdf,"stroke=",t.to_a(u)),u[r(u.length,1)],u=[d(e["$filled?"]())?s:l(B,"COLORS")["$[]"]("white")],p(this.pdf,"fill=",t.to_a(u)),u[r(u.length,1)],d(e["$rect?"]())?this.pdf.$rect_like_ellipse(e.$center(),c,a):this.pdf.$ellipse(e.$center(),c,a),e.$fill()["$=="]("filled")||(u=[e.$line_width()],p(this.pdf,"line_width=",t.to_a(u)),u[r(u.length,1)],c=p(c,"map",[],((n=function(t){n.$$s;return null==t&&(t=o),r(t,i(e.$line_width(),2))}).$$s=this,n.$$arity=1,n)),d(e["$rect?"]())?this.pdf.$rect_like_ellipse(e.$center(),c,a):this.pdf.$ellipse(e.$center(),c,a)),d(e["$dotted?"]())&&this.$draw_the_dot(e),d(e.$hasbarover())&&this.$draw_the_barover(e),u=[l(B,"COLORS")["$[]"]("black")],p(this.pdf,"stroke=",t.to_a(u)),u[r(u.length,1)],u=[l(B,"COLORS")["$[]"]("black")],p(this.pdf,"fill=",t.to_a(u)),u[r(u.length,1)]},x.$$arity=1),t.def(O,"$draw_glyph",w=function(s){var a,c,u,f,$=o,m=o,y=o,g=o,v=o,b=o,A=o;return s["$filled?"]("FD","FD"),$=[p(_(0,3,!0),"map",[],(a=function(){a.$$s;return d(s["$filled?"]())?0:128},a.$$s=this,a.$$arity=0,a))],p(this.pdf,"fill=",t.to_a($)),$[r($.length,1)],m=[r(s.$center().$first(),s.$size().$first()),r(s.$center().$last(),s.$size().$last())],m=[s.$center().$first(),s.$center().$last()],y=[e(s.$size().$first(),2),e(s.$size().$last(),2)],f=i(y.$last(),s.$glyph()["$[]"]("h")),[s.$glyph()["$[]"]("w"),s.$glyph()["$[]"]("h")],p([s.$glyph()["$[]"]("w"),s.$glyph()["$[]"]("h")],"map",[],((c=function(t){c.$$s;return null==t&&(t=o),e(i(t,2),f)}).$$s=this,c.$$arity=1,c)),$=[g=l(B,"COLORS")["$[]"]("white")],p(this.pdf,"fill=",t.to_a($)),$[r($.length,1)],$=[g],p(this.pdf,"stroke=",t.to_a($)),$[r($.length,1)],this.pdf.$rect_like_ellipse(s.$center(),s.$size(),"FD"),$=[g=l(B,"COLORS")["$[]"](s.$color())],p(this.pdf,"fill=",t.to_a($)),$[r($.length,1)],$=[g],p(this.pdf,"stroke=",t.to_a($)),$[r($.length,1)],v=[f,f],b=[],A=[],$=[1e-4],p(this.pdf,"line_width=",t.to_a($)),$[r($.length,1)],p(s.$glyph()["$[]"]("d"),"each",[],((u=function(t){var r=u.$$s||this,i=o;return null==r.pdf&&(r.pdf=o),null==h.log&&(h.log=o),null==t&&(t=o),i=t.$first(),"M"["$==="](i)?(b=[],A=[n(m.$first(),e(t["$[]"](1),v.$first())),n(m.$last(),e(t["$[]"](2),v.$last()))],d(b["$empty?"]())?o:r.pdf.$lines(b,A.$first(),A.$last(),v,"FD",!1)):"l"["$==="](i)?b.$push(t["$[]"](_(1,-1,!1))):"m"["$==="](i)?b.$push(t["$[]"](_(1,-1,!1))):"c"["$==="](i)?b.$push(t["$[]"](_(1,-1,!1))):"z"["$==="](i)?(d(b["$empty?"]())||r.pdf.$lines(b,A.$first(),A.$last(),v,"FD",!0),b=[]):h.log.$error("BUG: unsupported Pdf Path command '"+t.$first()+"' in glyph ("+"./pdf_engine.rb".$force_encoding("US-ASCII")+" 195)")}).$$s=this,u.$$arity=1,u)),$=[[0,0,0]],p(this.pdf,"stroke=",t.to_a($)),$[r($.length,1)],d(s["$dotted?"]())&&this.$draw_the_dot(s),d(s["$hasbarover?"]())?this.$draw_the_barover(s):o},w.$$arity=1),t.def(O,"$draw_the_dot",k=function(e){var i,s,a,c,u,f=o;return i=l(B,"COLORS")["$[]"](e.$color()),s=n(l(B,"DOTTED_SIZE"),e.$line_width()),a=n(l(B,"DOTTED_SIZE"),e.$line_width()),c=n(e.$center().$first(),n(e.$size().$first(),s)),u=e.$center().$last(),f=[0],p(this.pdf,"line_width=",t.to_a(f)),f[r(f.length,1)],f=[[255,255,255]],p(this.pdf,"fill=",t.to_a(f)),f[r(f.length,1)],f=[[255,255,255]],p(this.pdf,"stroke=",t.to_a(f)),f[r(f.length,1)],this.pdf.$ellipse([c,u],[a,a],"FD"),f=[i],p(this.pdf,"fill=",t.to_a(f)),f[r(f.length,1)],f=[i],p(this.pdf,"stroke=",t.to_a(f)),f[r(f.length,1)],this.pdf.$ellipse([c,u],[l(B,"DOTTED_SIZE"),l(B,"DOTTED_SIZE")],"FD")},k.$$arity=1),t.def(O,"$draw_the_barover",E=function(n){var i,s,a;return i=[l(B,"COLORS")["$[]"](n.$color())],p(this.pdf,"fill=",t.to_a(i)),r(i.length,1),s=[n.$center().$first(),r(r(n.$center().$last(),n.$size().$last()),e(1.3,n.$line_width()))],a=[n.$size().$first(),.2],this.pdf.$rect_like_ellipse(s,a,"F")},E.$$arity=1),t.def(O,"$draw_flowline",S=function(e){var n=o;return n=[l(B,"COLORS")["$[]"](e.$color())],p(this.pdf,"stroke=",t.to_a(n)),n[r(n.length,1)],d(e["$dashed?"]())&&(n=[i(3,2.84)],p(this.pdf,"line_dash=",t.to_a(n)),n[r(n.length,1)]),d(e["$dotted?"]())&&(n=[i(1.5,2.84)],p(this.pdf,"line_dash=",t.to_a(n)),n[r(n.length,1)]),this.pdf.$line(e.$from().$center(),e.$to().$center()),this.pdf.$use_solid_lines()},S.$$arity=1),t.def(O,"$draw_jumpline",N=function(s){var a,c=o,u=o,f=o,$=o,h=o;return u=[0,n((c=s.$from().$center().$clone())["$[]"](0),l(B,"PADDING"))],p(c,"[]=",t.to_a(u)),u[r(u.length,1)],u=[1,r(c["$[]"](1),i(l(B,"PADDING"),4))],p(c,"[]=",t.to_a(u)),u[r(u.length,1)],u=[0,n((f=s.$to().$center().$clone())["$[]"](0),l(B,"PADDING"))],p(f,"[]=",t.to_a(u)),u[r(u.length,1)],u=[1,n(f["$[]"](1),i(l(B,"PADDING"),4))],p(f,"[]=",t.to_a(u)),u[r(u.length,1)],$=s.$distance(),h=d($["$nil?"]())?r(418,e(s.$level(),l(B,"JUMPLINE_INDENT"))):n(f["$[]"](0),$),u=[p(_(0,3,!0),"map",[],(a=function(){a.$$s;return 0},a.$$s=this,a.$$arity=0,a))],p(this.pdf,"stroke=",t.to_a(u)),u[r(u.length,1)],this.pdf.$line(f,[h,f["$[]"](1)]),this.pdf.$line([h,f["$[]"](1)],[h,c["$[]"](1)]),this.pdf.$line([h,c["$[]"](1)],c),this.pdf.$left_arrowhead(c["$[]"](0),c["$[]"](1))},N.$$arity=1),t.def(O,"$draw_image",I=function(t){var e=o;return e=n(n(this.$Vector2d([0,0]),t.$llpos()),[0,t.$height()]),this.pdf.$image(t.$url(),e.$x(),e.$y(),t.$height(),t.$opacity())},I.$$arity=1),t.def(O,"$draw_path",C=function(e){var i,s,a,c,u=o,f=o,$=o;return u=[],s=[1,1],f=[],a=d(e["$filled?"]())?"FD":"S",c=l(B,"COLORS")["$[]"](e.$color()),$=[d(e["$filled?"]())?c:l(B,"COLORS")["$[]"]("white")],p(this.pdf,"fill=",t.to_a($)),$[r($.length,1)],$=[c],p(this.pdf,"stroke=",t.to_a($)),$[r($.length,1)],$=["round"],p(this.pdf,"line_cap=",t.to_a($)),$[r($.length,1)],p(e.$path(),"each",[],((i=function(t){var e,c=i.$$s||this,l=o,$=o;return null==c.pdf&&(c.pdf=o),null==h.log&&(h.log=o),null==t&&(t=o),l=t.$first(),"M"["$==="](l)?(d(u["$empty?"]())||c.pdf.$lines(u,f.$first(),f.$last(),s,a,!1),u=[],f=t["$[]"](_(1,2,!1))):"L"["$==="](l)?($=p([[f],u].$flatten(1),"inject",[[0,0]],((e=function(t,r){return e.$$s,null==t&&(t=o),null==r&&(r=o),[n(r["$[]"](0),t["$[]"](-2)),n(r["$[]"](1),t["$[]"](-1))]}).$$s=c,e.$$arity=2,e)),d(u["$empty?"]())||c.pdf.$lines(u,f.$first(),f.$last(),s,a,!1),f=$,(u=[]).$push([r(t["$[]"](1),$.$first()),r(t["$[]"](2),$.$last())])):"l"["$==="](l)?u.$push(t["$[]"](_(1,-1,!1))):"c"["$==="](l)?u.$push(t["$[]"](_(1,-1,!1))):"z"["$==="](l)?(d(u["$empty?"]())||c.pdf.$lines(u,f.$first(),f.$last(),s,"FD",!0),u=[]):h.log.$error("BUG: unsupported command '"+t.$first()+"' in glyph ("+"./pdf_engine.rb".$force_encoding("US-ASCII")+" 328)")}).$$s=this,i.$$arity=1,i)),d(u["$empty?"]())?o:this.pdf.$lines(u,f.$first(),f.$last(),s,a,!1)},C.$$arity=1)}(m[0],0,m)}(a[0],a)},Opal.modules.init_conf=function(t){t.top;var e=[],r=t.nil,n=(t.const_get_qualified,t.const_get_relative),i=(t.breaker,t.slice,t.module),s=t.send,a=t.truthy,o=t.hash2,c=t.gvars,l=t.range;return t.add_stubs(["$join","$map","$each_with_index","$split","$between?","$lambda","$[]","$get","$cut_string_names","$year","$now","$t","$to_a","$first","$+","$last"]),function(e,u){var f,$,h=i(e,"InitConf"),p=[h].concat(u);t.defs(h,"$cut_string_names",f=function(t,e,n){var i;return s(t.$split(" ").$each_with_index(),"map",[],(i=function(t,s){i.$$s;return null==t&&(t=r),null==s&&(s=r),a(s["$between?"](e,n))?t:"~"},i.$$s=this,i.$$arity=2,i)).$join(" ")},f.$$arity=3),t.defs(h,"$init_conf",$=function(){var t,e,i,a,u,f,$,h,d,_,m,y,g,v,b,A,x,w,k,E,S,N,I,C,O,B,M,P,F,L,T,j,R=r;return R=["produce","annotations","restposition","default","repeatstart","repeatend","extract","title","filenamepart","startpos","voices","flowlines","subflowlines","synchlines","jumplines","repeatsigns","layoutlines","barnumbers","countnotes","legend","nonflowrest","lyrics","notes","images","tuplets","layout","printer","annotation","decoration","partname","variantend","countnote","c_jumplines","tuplet","minc","flowline","imagename","stringnames","limit_a3","LINE_THIN","LINE_MEDIUM","LINE_THICK","ELLIPSE_SIZE","REST_SIZE","DRAWING_AREA_SIZE","instrument","bottomup","beams","packer","pack_method","pack_max_spreadfactor","pack_min_increment","sortmark","show","fill","size","PITCH_OFFSET","X_OFFSET","X_SPACING","jumpline_anchor","jumpline_vcut","a3_offset","a4_offset","a4_pages","T01_number","T01_number_extract","T02_copyright_music","T03_copyright_harpnotes","T04_to_order","T05_printed_extracts","T06_legend","T99_do_not_copy","0","1","2","3","4","5","6","verses","cp1","cp2","shape","pos","hpos","height","vpos","spos","autopos","apbase","text","style","marks","resources","d64","d48","d32","d24","d16","d12","d8","d6","d4","d3","d2","d1"],o(["produce","abc_parser","restposition","template","wrap","defaults","templates","presets","annotations","extract","layout","neatjson"],{produce:[0],abc_parser:"ABC2SVG",restposition:o(["default","repeatstart","repeatend"],{default:"center",repeatstart:"next",repeatend:"default"}),template:o(["filebase","title"],{filebase:"-no-template-",title:"- no template -"}),wrap:60,defaults:o(["notebound"],{notebound:o(["annotation","chord","partname","variantend","tuplet","flowline"],{annotation:o(["pos"],{pos:[5,-7]}),chord:o(["pos"],{pos:[0,0]}),partname:o(["pos"],{pos:[-4,-7]}),variantend:o(["pos"],{pos:[-4,-7]}),tuplet:o(["cp1","cp2","shape","show"],{cp1:[5,2],cp2:[5,-2],shape:["c"],show:!0}),flowline:o(["cp1","cp2","shape","show"],{cp1:[0,10],cp2:[0,-10],shape:["c"],show:!0})})}),templates:o(["notes","lyrics","images","tuplet","annotations","extracts"],{notes:o(["pos","text","style"],{pos:[320,6],text:"ENTER_NOTE",style:"large"}),lyrics:o(["verses","pos","style"],{verses:[1],pos:[350,70],style:"regular"}),images:o(["imagename","show","pos","height"],{imagename:"",show:!0,pos:[10,10],height:100}),tuplet:o(["cp1","cp2","shape","show"],{cp1:[5,2],cp2:[5,-2],shape:["c"],show:!0}),annotations:o(["text","pos"],{text:"_vorlage_",pos:[-5,-6]}),extracts:o(["title","filenamepart","notes"],{title:"",filenamepart:"-",notes:o(["T01_number_extract"],{T01_number_extract:o(["text"],{text:"{{extract_filename}}"})})})}),presets:o(["barnumbers_countnotes","stdextract","layout","instrument","notes","printer"],{barnumbers_countnotes:o(["anchor_at_box","anchor_at_center","countnotes_with_lyrics"],{anchor_at_box:o(["barnumbers","countnotes"],{barnumbers:o(["apanchor","apbase"],{apanchor:"box",apbase:[1,1]}),countnotes:o(["apanchor","apbase"],{apanchor:"box",apbase:[1,-.5]})}),anchor_at_center:o(["barnumbers","countnotes"],{barnumbers:o(["apanchor","apbase"],{apanchor:"center",apbase:[1,.3]}),countnotes:o(["apanchor","apbase"],{apanchor:"center",apbase:[1,0]})}),countnotes_with_lyrics:o(["countnotes"],{countnotes:o(["cntextleft","cntextright"],{cntextleft:"{lyrics} {countnote}",cntextright:"{countnote} {lyrics}"})})}),stdextract:o([],{}),layout:o(["notes_small","notes_regular","notes_large","notes_with_beams","-","packer_compact","packer_regular","--","color_on","color_off","---","jumpline_anchor_close","jumpline_anchor_medium","jumpline_anchor_wide","jumpline_open","jumpline_close"],{notes_small:o(["LINE_MEDIUM","LINE_THICK","ELLIPSE_SIZE","REST_SIZE","beams"],{LINE_MEDIUM:.2,LINE_THICK:.3,ELLIPSE_SIZE:[3.5,1.3],REST_SIZE:[4,1.5],beams:!1}),notes_regular:o(["LINE_MEDIUM","LINE_THICK","ELLIPSE_SIZE","REST_SIZE","beams"],{LINE_MEDIUM:s(this,"lambda",[],(t=function(){t.$$s;return null==c.conf&&(c.conf=r),c.conf["$[]"]("extract.0.layout.LINE_MEDIUM")},t.$$s=this,t.$$arity=0,t)),LINE_THICK:s(this,"lambda",[],(e=function(){e.$$s;return null==c.conf&&(c.conf=r),c.conf["$[]"]("extract.0.layout.LINE_THICK")},e.$$s=this,e.$$arity=0,e)),ELLIPSE_SIZE:s(this,"lambda",[],(i=function(){i.$$s;return null==c.conf&&(c.conf=r),c.conf["$[]"]("extract.0.layout.ELLIPSE_SIZE")},i.$$s=this,i.$$arity=0,i)),REST_SIZE:s(this,"lambda",[],(a=function(){a.$$s;return null==c.conf&&(c.conf=r),c.conf["$[]"]("extract.0.layout.REST_SIZE")},a.$$s=this,a.$$arity=0,a)),beams:!1}),notes_large:o(["LINE_MEDIUM","LINE_THICK","ELLIPSE_SIZE","REST_SIZE","beams"],{LINE_MEDIUM:.3,LINE_THICK:.7,ELLIPSE_SIZE:[4,2],REST_SIZE:[4,2],beams:!1}),notes_with_beams:o(["LINE_THIN","LINE_MEDIUM","LINE_THICK","ELLIPSE_SIZE","REST_SIZE","beams"],{LINE_THIN:.1,LINE_MEDIUM:.2,LINE_THICK:.5,ELLIPSE_SIZE:[1.3,1],REST_SIZE:[2,1.3],beams:!0}),"-":o([],{}),packer_compact:o(["packer"],{packer:o(["pack_method","pack_max_spreadfactor","pack_min_increment"],{pack_method:1,pack_max_spreadfactor:2,pack_min_increment:.2})}),packer_regular:o(["packer"],{packer:s(this,"lambda",[],(u=function(){u.$$s;return null==c.conf&&(c.conf=r),c.conf.$get("extract.0.layout.packer")},u.$$s=this,u.$$arity=0,u))}),"--":o([],{}),color_on:o(["color"],{color:o(["color_default","color_variant1","color_variant2"],{color_default:"black",color_variant1:"grey",color_variant2:"darkgrey"})}),color_off:o(["color"],{color:o(["color_default","color_variant1","color_variant2"],{color_default:"black",color_variant1:"black",color_variant2:"black"})}),"---":o([],{}),jumpline_anchor_close:o(["jumpline_anchor"],{jumpline_anchor:[3,1]}),jumpline_anchor_medium:o(["jumpline_anchor"],{jumpline_anchor:[5,1]}),jumpline_anchor_wide:o(["jumpline_anchor"],{jumpline_anchor:[10,1]}),jumpline_open:o(["jumpline_vcut"],{jumpline_vcut:3}),jumpline_close:o(["jumpline_vcut"],{jumpline_vcut:0})}),instrument:o(["37-strings-g-g","25-strings-g-g","25-strings-G-g Bass","21-strings-a-f","18-strings-b-e","saitenspiel","Zipino","Okon-Harfe","Akkordzither"],{"37-strings-g-g":o(["layout","stringnames","instrument_shape","printer"],{layout:o(["instrument","limit_a3","beams","bottomup","PITCH_OFFSET","X_SPACING","X_OFFSET"],{instrument:"37-strings-g-g",limit_a3:!0,beams:!1,bottomup:!1,PITCH_OFFSET:s(this,"lambda",[],(f=function(){f.$$s;return null==c.conf&&(c.conf=r),c.conf["$[]"]("extract.0.layout.PITCH_OFFSET")},f.$$s=this,f.$$arity=0,f)),X_SPACING:s(this,"lambda",[],($=function(){$.$$s;return null==c.conf&&(c.conf=r),c.conf["$[]"]("extract.0.layout.X_SPACING")},$.$$s=this,$.$$arity=0,$)),X_OFFSET:s(this,"lambda",[],(h=function(){h.$$s;return null==c.conf&&(c.conf=r),c.conf["$[]"]("extract.0.layout.X_OFFSET")},h.$$s=this,h.$$arity=0,h))}),stringnames:o(["text","marks"],{text:s(this,"lambda",[],(d=function(){d.$$s;return null==c.conf&&(c.conf=r),c.conf["$[]"]("extract.0.stringnames.text")},d.$$s=this,d.$$arity=0,d)),marks:o(["hpos"],{hpos:[43,79]})}),instrument_shape:r,printer:o(["a4_pages","a4_offset","a3_offset"],{a4_pages:[0,1,2],a4_offset:s(this,"lambda",[],(_=function(){_.$$s;return null==c.conf&&(c.conf=r),c.conf["$[]"]("extract.0.printer.a4_offset")},_.$$s=this,_.$$arity=0,_)),a3_offset:s(this,"lambda",[],(m=function(){m.$$s;return null==c.conf&&(c.conf=r),c.conf["$[]"]("extract.0.printer.a3_offset")},m.$$s=this,m.$$arity=0,m))})}),"25-strings-g-g":o(["layout","stringnames","instrument_shape","printer"],{layout:o(["instrument","limit_a3","beams","bottomup","PITCH_OFFSET","X_SPACING","X_OFFSET"],{instrument:"25-strings-g-g",limit_a3:!1,beams:!1,bottomup:!1,PITCH_OFFSET:s(this,"lambda",[],(y=function(){y.$$s;return null==c.conf&&(c.conf=r),c.conf["$[]"]("extract.0.layout.PITCH_OFFSET")},y.$$s=this,y.$$arity=0,y)),X_SPACING:s(this,"lambda",[],(g=function(){g.$$s;return null==c.conf&&(c.conf=r),c.conf["$[]"]("extract.0.layout.X_SPACING")},g.$$s=this,g.$$arity=0,g)),X_OFFSET:s(this,"lambda",[],(v=function(){v.$$s;return null==c.conf&&(c.conf=r),c.conf["$[]"]("extract.0.layout.X_OFFSET")},v.$$s=this,v.$$arity=0,v))}),stringnames:o(["text","marks"],{text:s(this,"lambda",[],(b=function(){var t=b.$$s||this;return null==c.conf&&(c.conf=r),t.$cut_string_names(c.conf["$[]"]("extract.0.stringnames.text"),12,36)},b.$$s=this,b.$$arity=0,b)),marks:o(["hpos"],{hpos:[55,79]})}),instrument_shape:r,printer:o(["a4_pages","a3_offset","a4_offset"],{a4_pages:[1,2],a3_offset:[-5,0],a4_offset:s(this,"lambda",[],(A=function(){A.$$s;return null==c.conf&&(c.conf=r),c.conf["$[]"]("extract.0.printer.a4_offset")},A.$$s=this,A.$$arity=0,A))})}),"25-strings-G-g Bass":o(["layout","stringnames","instrument_shape","printer"],{layout:o(["instrument","limit_a3","beams","bottomup","PITCH_OFFSET","X_SPACING","X_OFFSET"],{instrument:"25-strings-g-g",limit_a3:!1,beams:!1,bottomup:!1,PITCH_OFFSET:s(this,"lambda",[],(x=function(){x.$$s;return-31},x.$$s=this,x.$$arity=0,x)),X_SPACING:s(this,"lambda",[],(w=function(){w.$$s;return null==c.conf&&(c.conf=r),c.conf["$[]"]("extract.0.layout.X_SPACING")},w.$$s=this,w.$$arity=0,w)),X_OFFSET:s(this,"lambda",[],(k=function(){k.$$s;return null==c.conf&&(c.conf=r),c.conf["$[]"]("extract.0.layout.X_OFFSET")},k.$$s=this,k.$$arity=0,k))}),stringnames:o(["text","marks"],{text:s(this,"lambda",[],(E=function(){var t=E.$$s||this;return null==c.conf&&(c.conf=r),t.$cut_string_names(c.conf["$[]"]("extract.0.stringnames.text"),12,36)},E.$$s=this,E.$$arity=0,E)),marks:o(["hpos"],{hpos:[43,67]})}),instrument_shape:r,printer:o(["a4_pages","a3_offset","a4_offset"],{a4_pages:[1,2],a3_offset:[-5,0],a4_offset:s(this,"lambda",[],(S=function(){S.$$s;return null==c.conf&&(c.conf=r),c.conf["$[]"]("extract.0.printer.a4_offset")},S.$$s=this,S.$$arity=0,S))})}),"21-strings-a-f":o(["layout","stringnames","instrument_shape","printer"],{layout:o(["instrument","limit_a3","beams","bottomup","PITCH_OFFSET","X_SPACING","X_OFFSET"],{instrument:"21-strings-a-f",limit_a3:!1,beams:!1,bottomup:!1,PITCH_OFFSET:s(this,"lambda",[],(N=function(){N.$$s;return null==c.conf&&(c.conf=r),c.conf["$[]"]("extract.0.layout.PITCH_OFFSET")},N.$$s=this,N.$$arity=0,N)),X_SPACING:s(this,"lambda",[],(I=function(){I.$$s;return null==c.conf&&(c.conf=r),c.conf["$[]"]("extract.0.layout.X_SPACING")},I.$$s=this,I.$$arity=0,I)),X_OFFSET:23}),stringnames:o(["text","marks"],{text:s(this,"lambda",[],(C=function(){var t=C.$$s||this;return null==c.conf&&(c.conf=r),t.$cut_string_names(c.conf["$[]"]("extract.0.stringnames.text"),14,34)},C.$$s=this,C.$$arity=0,C)),marks:o(["hpos"],{hpos:[57,77]})}),instrument_shape:r,printer:o(["a4_pages","a3_offset","a4_offset"],{a4_pages:[1,2],a3_offset:[-5,0],a4_offset:s(this,"lambda",[],(O=function(){O.$$s;return null==c.conf&&(c.conf=r),c.conf["$[]"]("extract.0.printer.a4_offset")},O.$$s=this,O.$$arity=0,O))})}),"18-strings-b-e":o(["layout","stringnames","instrument_shape","printer"],{layout:o(["instrument","limit_a3","beams","bottomup","PITCH_OFFSET","X_SPACING","X_OFFSET"],{instrument:"18-strings-b-e",limit_a3:!1,beams:!1,bottomup:!1,PITCH_OFFSET:s(this,"lambda",[],(B=function(){B.$$s;return null==c.conf&&(c.conf=r),c.conf["$[]"]("extract.0.layout.PITCH_OFFSET")},B.$$s=this,B.$$arity=0,B)),X_SPACING:s(this,"lambda",[],(M=function(){M.$$s;return null==c.conf&&(c.conf=r),c.conf["$[]"]("extract.0.layout.X_SPACING")},M.$$s=this,M.$$arity=0,M)),X_OFFSET:28.5}),stringnames:o(["text","marks"],{text:s(this,"lambda",[],(P=function(){var t=P.$$s||this;return null==c.conf&&(c.conf=r),t.$cut_string_names(c.conf["$[]"]("extract.0.stringnames.text"),16,33)},P.$$s=this,P.$$arity=0,P)),marks:o(["hpos"],{hpos:[59,76]})}),instrument_shape:r,printer:o(["a4_pages","a3_offset","a4_offset"],{a4_pages:[2],a3_offset:[0,0],a4_offset:[40,0]})}),saitenspiel:o(["layout","stringnames","instrument_shape","printer"],{layout:o(["instrument","limit_a3","beams","bottomup","PITCH_OFFSET","X_SPACING","X_OFFSET"],{instrument:"saitenspiel",limit_a3:!1,beams:!1,bottomup:!1,PITCH_OFFSET:-24,X_SPACING:14.5,X_OFFSET:240}),stringnames:o(["text","marks"],{text:"G C D E F G A B C D  ~ ~ ~ ~ ~ ~ ~",marks:o(["hpos"],{hpos:[55,74]})}),instrument_shape:r,printer:o(["a4_pages","a3_offset","a4_offset"],{a4_pages:[2],a3_offset:[0,0],a4_offset:[35,0]})}),Zipino:o(["layout","stringnames","instrument_shape","printer"],{layout:o(["instrument","limit_a3","beams","bottomup","PITCH_OFFSET","X_SPACING","X_OFFSET","ELLIPSE_SIZE","REST_SIZE"],{instrument:"Zipino",limit_a3:!0,beams:!0,bottomup:!1,PITCH_OFFSET:0,X_SPACING:12.5,X_OFFSET:230,ELLIPSE_SIZE:[2,2],REST_SIZE:[2,2]}),stringnames:o(["text","marks"],{text:"F# G A B C D E F# G A B C D E F# ~ ~ ~ ~ ~ ~  ~",marks:o(["hpos"],{hpos:[54]})}),instrument_shape:r,printer:o(["a4_pages","a3_offset","a4_offset"],{a4_pages:[2],a3_offset:[0,0],a4_offset:[35,0]})}),"Okon-Harfe":o(["layout","stringnames","instrument_shape","printer"],{layout:o(["instrument","beams","bottomup","limit_a3","PITCH_OFFSET","X_SPACING","X_OFFSET"],{instrument:"okon-f",beams:!0,bottomup:!0,limit_a3:!1,PITCH_OFFSET:0,X_SPACING:15,X_OFFSET:50}),stringnames:o(["text","marks"],{text:"G, A, BB, C D E F G A BB c d e f g a bb c' ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~",marks:o(["hpos"],{hpos:[55,74]})}),instrument_shape:r,printer:o(["a4_pages","a3_offset","a4_offset"],{a4_pages:[1,2],a3_offset:[-35,0],a4_offset:[70,0]})}),Akkordzither:o(["layout","stringnames","instrument_shape","printer"],{layout:o(["instrument","tuning","beams","bottomup","limit_a3","PITCH_OFFSET","X_SPACING","X_OFFSET"],{instrument:"akkordzither",tuning:"open",beams:!0,bottomup:!1,limit_a3:!1,PITCH_OFFSET:0,X_SPACING:8.9,X_OFFSET:140}),stringnames:o(["text","marks"],{text:"C C# D E F F# G G# A B C' C# D' E' F' F#' G' G#' A' B' C''  ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ",marks:o(["hpos"],{hpos:[60]})}),instrument_shape:'[["M", 228, 0], ["L",  335, 185], ["L", 335,297]]',printer:o(["a4_pages","a3_offset","a4_offset"],{a4_pages:[1,2,3],a3_offset:[0,0],a4_offset:[108,0]})})}),notes:o(["T01_number","T01_number_extract","T01_number_extract_value","T02_copyright_music","T03_copyright_harpnotes","T04_to_order","T05_printed_extracts","T06_legend","T99_do_not_copy","T01_T99"],{T01_number:o(["value"],{value:o(["pos","text","style","align"],{pos:[410,17],text:"XXX-{{number}}",style:"bold",align:"l"})}),T01_number_extract:o(["value"],{value:o(["pos","text","style"],{pos:[411,17],text:"{{extract_filename}}",style:"bold"})}),T01_number_extract_value:o(["key","value"],{key:"T01_number_extract",value:o(["text"],{text:"{{extract_filename}}"})}),T02_copyright_music:o(["value"],{value:o(["pos","text","style"],{pos:[340,251],text:s(this,"lambda",[],(F=function(){F.$$s;return" "+n(p,"Time").$now().$year()+"\n"+n(p,"I18n").$t("Private copy")},F.$$s=this,F.$$arity=0,F)),style:"small"})}),T03_copyright_harpnotes:o(["value"],{value:o(["pos","text","style"],{pos:[340,260],text:" "+n(p,"Time").$now().$year()+" Notenbild: zupfnoter.de",style:"small"})}),T04_to_order:o(["value"],{value:o(["pos","text","style"],{pos:[340,242],text:s(this,"lambda",[],(L=function(){L.$$s;return n(p,"I18n").$t("provided by\n")},L.$$s=this,L.$$arity=0,L)),style:"small"})}),T05_printed_extracts:o(["value"],{value:o(["pos","text","style","align"],{pos:[410,22],text:"{{printed_extracts}}",style:"smaller",align:"l"})}),T06_legend:o(["value"],{value:o(["pos","text","style"],{pos:[360,30],text:"{{extract_title}}\n{{composer}}\nTakt: {{meter}} ({{tempo}})\nTonart: {{key}}",style:"small"})}),T99_do_not_copy:o(["value"],{value:o(["pos","text","style"],{pos:[380,284],text:s(this,"lambda",[],(T=function(){T.$$s;return n(p,"I18n").$t("Please do not copy")},T.$$s=this,T.$$arity=0,T)),style:"small_bold"})}),T01_T99:o(["value"],{value:o([],{})})}),printer:o(["printer_left","printer_centric","printer_right"],{printer_left:o(["printer","layout"],{printer:o(["a3_offset","a4_offset","show_border"],{a3_offset:[-10,0],a4_offset:[-5,0],show_border:!1}),layout:o(["limit_a3"],{limit_a3:!1})}),printer_centric:o(["printer","layout"],{printer:o(["a3_offset","a4_offset","show_border"],{a3_offset:[0,0],a4_offset:[5,0],show_border:!1}),layout:o(["limit_a3"],{limit_a3:!0})}),printer_right:o(["printer","layout"],{printer:o(["a3_offset","a4_offset","show_border"],{a3_offset:[10,0],a4_offset:[5,0],show_border:!1}),layout:o(["limit_a3"],{limit_a3:!1})})})}),annotations:o(["vl","vt","vb","vr","rit"],{vl:o(["text","pos"],{text:"v",pos:[-5,-5]}),vt:o(["text","pos"],{text:"v",pos:[-1,-5]}),vb:o(["text","pos"],{text:"v",pos:[-1,2]}),vr:o(["text","pos"],{text:"v",pos:[2,-5]}),rit:o(["text","pos","style"],{text:"rit",pos:[2,-5],style:"italic"})}),extract:o(["0","1","2","3"],{0:o(["title","startpos","voices","synchlines","flowlines","subflowlines","jumplines","repeatsigns","layoutlines","legend","lyrics","images","layout","sortmark","nonflowrest","notes","tuplets","barnumbers","countnotes","chords","stringnames","printer"],{title:"alle Stimmen",startpos:15,voices:[1,2,3,4],synchlines:[[1,2],[3,4]],flowlines:[1,3],subflowlines:[2,4],jumplines:[1,3],repeatsigns:o(["voices","left","right"],{voices:[],left:o(["pos","text","style"],{pos:[-7,-2],text:"|:",style:"bold"}),right:o(["pos","text","style"],{pos:[5,-2],text:":|",style:"bold"})}),layoutlines:[1,2,3,4],legend:o(["spos","pos","tstyle","align","style"],{spos:[320,27],pos:[320,7],tstyle:"large",align:"r",style:"regular"}),lyrics:o([],{}),images:o([],{}),layout:o(["limit_a3","bottomup","beams","jumpline_anchor","color","LINE_THIN","LINE_MEDIUM","LINE_THICK","PITCH_OFFSET","X_SPACING","X_OFFSET","ELLIPSE_SIZE","REST_SIZE","DRAWING_AREA_SIZE","instrument","tuning","packer"],{limit_a3:!0,bottomup:!1,beams:!1,jumpline_anchor:[3,1],color:o(["color_default","color_variant1","color_variant2"],{color_default:"black",color_variant1:"grey",color_variant2:"dimgrey"}),LINE_THIN:.1,LINE_MEDIUM:.3,LINE_THICK:.5,PITCH_OFFSET:-43,X_SPACING:11.5,X_OFFSET:2.8,ELLIPSE_SIZE:[3.5,1.7],REST_SIZE:[4,2],DRAWING_AREA_SIZE:[400,282],instrument:"37-strings-g-g",tuning:"fixed",packer:o(["pack_method","pack_max_spreadfactor","pack_min_increment"],{pack_method:0,pack_max_spreadfactor:2,pack_min_increment:.2})}),sortmark:o(["size","fill","show"],{size:[2,4],fill:!0,show:!1}),nonflowrest:!1,notes:o([],{}),tuplets:o(["text"],{text:"{{tuplet}}"}),barnumbers:o(["voices","pos","autopos","apanchor","apbase","style","prefix"],{voices:[],pos:[6,-4],autopos:!0,apanchor:"box",apbase:[1,1],style:"small_bold",prefix:""}),countnotes:o(["voices","pos","autopos","apbase","apanchor","style"],{voices:[],pos:[3,-2],autopos:!0,apbase:[1,-.5],apanchor:"box",style:"smaller"}),chords:o(["voices","pos","autopos","apbase","apanchor","style"],{voices:[],pos:[3,-2],autopos:!0,apbase:[1,-.5],apanchor:"box",style:"large"}),stringnames:o(["text","vpos","style","marks"],{text:"G G# A A# B C C# D D# E F F# G G# A A# B C C# D D# E F F# G G# A A# B C C# D D# E F F# G",vpos:[],style:"small",marks:o(["vpos","hpos"],{vpos:[11],hpos:[43,55,79]})}),printer:o(["a3_offset","a4_offset","a4_pages","show_border"],{a3_offset:[0,0],a4_offset:[-5,0],a4_pages:[0,1,2],show_border:!1})}),1:o(["title","voices"],{title:"Sopran, Alt",voices:[1,2]}),2:o(["title","voices"],{title:"Tenor, Bass",voices:[3,4]}),3:o(["title","voices"],{title:"Melodie",voices:[1]})}),layout:o(["grid","limit_a3","SHOW_SLUR","LINE_THIN","LINE_MEDIUM","LINE_THICK","ELLIPSE_SIZE","REST_SIZE","X_SPACING","X_OFFSET","Y_SCALE","DRAWING_AREA_SIZE","BEAT_RESOLUTION","SHORTEST_NOTE","BEAT_PER_DURATION","PITCH_OFFSET","FONT_STYLE_DEF","MM_PER_POINT","DURATION_TO_STYLE","DURATION_TO_BEAMS","REST_TO_GLYPH","DECORATIIONS_AS_ANNOTATIONS"],{grid:!1,limit_a3:!0,SHOW_SLUR:!1,LINE_THIN:.1,LINE_MEDIUM:.3,LINE_THICK:.5,ELLIPSE_SIZE:[3.5,1.7],REST_SIZE:[4,2],X_SPACING:11.5,X_OFFSET:2.8,Y_SCALE:4,DRAWING_AREA_SIZE:[400,282],BEAT_RESOLUTION:192,SHORTEST_NOTE:64,BEAT_PER_DURATION:3,PITCH_OFFSET:-43,FONT_STYLE_DEF:o(["bold","italic","large","regular","small_bold","small_italic","small","smaller"],{bold:o(["text_color","font_size","font_style"],{text_color:[0,0,0],font_size:12,font_style:"bold"}),italic:o(["text_color","font_size","font_style"],{text_color:[0,0,0],font_size:12,font_style:"italic"}),large:o(["text_color","font_size","font_style"],{text_color:[0,0,0],font_size:20,font_style:"bold"}),regular:o(["text_color","font_size","font_style"],{text_color:[0,0,0],font_size:12,font_style:"normal"}),small_bold:o(["text_color","font_size","font_style"],{text_color:[0,0,0],font_size:9,font_style:"bold"}),small_italic:o(["text_color","font_size","font_style"],{text_color:[0,0,0],font_size:9,font_style:"italic"}),small:o(["text_color","font_size","font_style"],{text_color:[0,0,0],font_size:9,font_style:"normal"}),smaller:o(["text_color","font_size","font_style"],{text_color:[0,0,0],font_size:6,font_style:"normal"})}),MM_PER_POINT:.3,DURATION_TO_STYLE:o(["err","d64","d48","d32","d24","d16","d12","d8","d6","d4","d3","d2","d1"],{err:[2,"filled",!1],d64:[1,"empty",!1],d48:[.75,"empty",!0],d32:[.75,"empty",!1],d24:[.75,"filled",!0],d16:[.75,"filled",!1],d12:[.5,"filled",!0],d8:[.5,"filled",!1],d6:[.3,"filled",!0],d4:[.3,"filled",!1],d3:[.1,"filled",!0],d2:[.1,"filled",!1],d1:[.05,"filled",!1]}),DURATION_TO_BEAMS:o(["d64","d48","d32","d24","d16","d12","d8","d6","d4","d3","d2","d1"],{d64:[1,"empty",!1],d48:[1,"empty",!0,0],d32:[1,"empty",!1,0],d24:[1,"filled",!0,0],d16:[1,"filled",!1,0],d12:[1,"filled",!0,1],d8:[1,"filled",!1,1],d6:[1,"filled",!0,2],d4:[1,"filled",!1,2],d3:[1,"filled",!0,3],d2:[1,"filled",!1,3],d1:[1,"filled",!1,4]}),REST_TO_GLYPH:o(["err","d64","d48","d32","d24","d16","d12","d8","d6","d4","d3","d2","d1"],{err:[[2,2],"rest_1",!1],d64:[[1,.8],"rest_1",!1],d48:[[.5,.4],"rest_1",!0],d32:[[.5,.4],"rest_1",!1],d24:[[.4,.75],"rest_4",!0],d16:[[.4,.75],"rest_4",!1],d12:[[.4,.5],"rest_8",!0],d8:[[.4,.5],"rest_8",!1],d6:[[.4,.3],"rest_16",!0],d4:[[.3,.3],"rest_16",!1],d3:[[.3,.5],"rest_32",!0],d2:[[.3,.5],"rest_32",!1],d1:[[.3,.5],"rest_64",!1]}),DECORATIIONS_AS_ANNOTATIONS:o(["<(","<)",">(",">)","arpeggio","coda","crescendo(","crescendo)","D.C.","D.C.alfine","D.S.","dacapo","dacoda","dasegno","diminuendo(","diminuendo)","f","ff","fff","ffff","fine","p","pp","ppp","pppp","segno"],{"<(":o(["text","pos","style"],{text:"cresc",pos:[5,0],style:"small_italic"}),"<)":o(["text","pos","style"],{text:"/cresc",pos:[5,0],style:"small_italic"}),">(":o(["text","pos","style"],{text:"dimin",pos:[5,0],style:"small_italic"}),">)":o(["text","pos","style"],{text:"/dimin",pos:[5,0],style:"small_italic"}),arpeggio:o(["text","pos","style"],{text:"arpeggio ",pos:[-20,0],style:"small_italic"}),coda:o(["text","pos","style","align","show"],{text:"Coda",pos:[0,-5],style:"bold",align:"center",show:"all"}),"crescendo(":o(["text","pos","style"],{text:"cresc",pos:[5,0],style:"small_italic"}),"crescendo)":o(["text","pos","style"],{text:"/cresc",pos:[5,0],style:"small_italic"}),"D.C.":o(["text","pos","style"],{text:"D.C.",pos:[5,5],style:"bold"}),"D.C.alfine":o(["text","pos","style"],{text:"D.C. al fine",pos:[5,5],style:"bold"}),"D.S.":o(["text","pos","style"],{text:"D.S.",pos:[5,5],style:"bold"}),dacapo:o(["text","pos","style"],{text:"da Capo",pos:[5,5],style:"bold"}),dacoda:o(["text","pos","style"],{text:"da Coda",pos:[5,5],style:"bold"}),dasegno:o(["text","pos","style"],{text:"da Segno",pos:[5,5],style:"bold"}),"diminuendo(":o(["text","pos","style"],{text:"dimin",pos:[5,0],style:"small_italic"}),"diminuendo)":o(["text","pos","style"],{text:"/dimin",pos:[5,0],style:"small_italic"}),f:o(["text","pos","style"],{text:"f",pos:[3,0],style:"small_italic"}),ff:o(["text","pos","style"],{text:"ff",pos:[3,0],style:"small_italic"}),fff:o(["text","pos","style"],{text:"fff",pos:[3,0],style:"small_italic"}),ffff:o(["text","pos","style"],{text:"ffff",pos:[3,0],style:"small_italic"}),fine:o(["text","pos","style","align","show"],{text:"Fine",pos:[10,5],style:"bold",align:"center",show:"all"}),p:o(["text","pos","style"],{text:"p",pos:[3,0],style:"small_italic"}),pp:o(["text","pos","style"],{text:"pp",pos:[3,0],style:"small_italic"}),ppp:o(["text","pos","style"],{text:"ppp",pos:[3,0],style:"small_italic"}),pppp:o(["text","pos","style"],{text:"pppp",pos:[3,0],style:"small_italic"}),segno:o(["text","pos","style","align","show"],{text:"Segno",pos:[0,-5],style:"bold",align:"center",show:"all"})})}),neatjson:o(["wrap","aligned","after_comma","after_colon_1","after_colon_n","before_colon_n","short","afterComma","afterColon1","afterColonN","beforeColonN","decimals","explicit_sort"],{wrap:60,aligned:!0,after_comma:1,after_colon_1:1,after_colon_n:1,before_colon_n:1,short:!1,afterComma:1,afterColon1:1,afterColonN:1,beforeColonN:1,decimals:2,explicit_sort:n(p,"Hash")["$[]"](s(R.$each_with_index().$to_a(),"map",[],(j=function(t){var e,n;j.$$s;return null==t&&(t=r),[t.$first(),(e="_",n=("000"+t.$last())["$[]"](l(-4,-1,!1)),"number"==typeof e&&"number"==typeof n?e+n:e["$+"](n))]},j.$$s=this,j.$$arity=1,j)))})})},$.$$arity=0)}(e[0],e),t.const_set(e[0],"DBX_APIKEY_FULL","zwydv2vbgp30e05"),t.const_set(e[0],"DBX_APIKEY_APP","xr3zna7wrp75zax"),t.const_set(e[0],"CONFIG_SEPARATOR","%%%%zupfnoter.config")},Opal.modules.text_pane=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}function n(t,e){return"number"==typeof t&&"number"==typeof e?t>e:t["$>"](e)}t.top;var i=[],s=t.nil,a=t.const_get_qualified,o=t.const_get_relative,c=(t.breaker,t.slice,t.module),l=t.klass,u=t.hash2,f=t.truthy,$=t.send,h=t.range,p=t.gvars;return t.add_stubs(["$attr_accessor","$reset","$push","$[]","$pop","$empty?","$reverse","$flatten","$lambda","$new","$_clean_models","$create_lyrics_editor","$from_lyrics","$on","$Native","$getSession","$save_to_localstorage","$clear_markers","$call","$niil","$scan","$+","$===","$join","$editor","$raise","$t","$gsub","$_get_unison_edit_replacement","$last_match","$get_selection_positions","$min","$first","$max","$last","$strip","$_get_abc_from_editor","$_get_config_json","$_has_resources?","$_get_resources_json","$_split_parts","$map","$-","$set_markers","$to_n","$each","$add_marker","$split","$<<","$clear","$_get_config_model","$to_s","$[]=","$==","$do","$_set_config_model","$get","$set_config_model","$_set_config_json","$token","$get_selection_info","$type","$replace_range","$startpos","$endpos","$start_with?","$delete","$deep_dup","$get_lyrics_raw","$>","$count","$get_abc_part","$error","$clear_errors","$get_lyrics","$replace_text","$call_consumers","$nil?","$_set_abc_to_editor","$_set_resources_json","$set_text","$select","$parse","$clean_localstorage","$each_with_index","$benchmark","$neat_generate","$undo","$info","$dig","$redo","$undo_history","$redo_history","$!"]),function(i,d){var _=[c(i,"Harpnotes")].concat(d);!function(i,c,d){var _,m,y,g,v,b,A,x,w,k,E,S,N,I,C,O,B,M,P,F,L,T,j,R,D,z,U,q,H,Q,Y,G,V,J,X,W,K,Z,tt,et,rt,nt,it,st,at,ot,ct,lt,ut,ft,$t,ht,pt,dt,_t,mt,yt,gt,vt,bt,At=l(i,null,"TextPane"),xt=[At].concat(d);At.$$prototype.editor=At.$$prototype.range=At.$$prototype.config_separator=At.$$prototype.markers=At.$$prototype.config_models=At.$$prototype.dirty=At.$$prototype.config_undo=At.$$prototype.on_change=At.$$prototype.lyrics_editor=At.$$prototype.controller=At.$$prototype.handle_from_lyrics=s,At.$attr_accessor("editor","controller","autofold"),function(e,r,n){var i,a,o,c,$,h,p,d=l(e,null,"UndoManager");[d].concat(n);d.$$prototype.undostack=d.$$prototype.currentstate=d.$$prototype.redostack=s,t.def(d,"$initialize",i=function(){return this.$reset()},i.$$arity=0),t.def(d,"$reset",a=function(){return this.undostack=[],this.redostack=[],this.currentstate=u(["title","state"],{title:"init state",state:u([],{})})},a.$$arity=0),t.def(d,"$do",o=function(t,e){return this.undostack.$push(this.currentstate),this.redostack=[],this.currentstate=u(["title","state"],{title:e,state:t}),this.currentstate},o.$$arity=2),t.def(d,"$undo",c=function(){var t=s;return f(this.undostack["$[]"](1))?(t=this.undostack.$pop(),this.redostack.$push(this.currentstate),this.currentstate=t):s},c.$$arity=0),t.def(d,"$redo",$=function(){var t=s;return f(this.redostack["$empty?"]())?s:(t=this.redostack.$pop(),this.undostack.$push(this.currentstate),this.currentstate=t)},$.$$arity=0),t.def(d,"$undo_history",h=function(){return[this.undostack,this.currentstate].$flatten().$reverse()},h.$$arity=0),t.def(d,"$redo_history",p=function(){return[this.redostack].$flatten().$reverse()},p.$$arity=0)}(xt[0],0,xt),t.def(At,"$initialize",_=function(t){var e,r=ace.require("ace/ext/language_tools");r.setCompleters([r.snippetCompleter]);var n=ace.edit(t);return n.commands.bindKey("Cmd-L",null),n.commands.bindKey("Ctrl-L",null),n.commands.bindKey("Ctrl-P",null),n.commands.bindKey("Ctrl-K",null),n.$blockScrolling=1/0,n.getSession().setMode("ace/mode/abc"),n.setTheme("ace/theme/abc"),n.setOptions({highlightActiveLine:!0,enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!1}),this.editor=n,this.range=ace.require("ace/range").Range,this.inhibit_callbacks=!1,this.markers=[],this.autofold=!0,this.on_change=$(this,"lambda",[],((e=function(){e.$$s;return s}).$$s=this,e.$$arity=0,e)),this.config_separator="%%%%zupfnoter",this.dirty=u([],{}),this.config_undo=o(xt,"UndoManager").$new(),this.$_clean_models(),this.$create_lyrics_editor("abcLyrics")},_.$$arity=1),t.def(At,"$create_lyrics_editor",m=function(t){var e=this,r=ace.require("ace/ext/language_tools");r.setCompleters([r.snippetCompleter]);var n=ace.edit(t);return n.$blockScrolling=1/0,n.getSession().setMode("ace/mode/markdown"),n.setTheme("ace/theme/abc"),n.setOptions({highlightActiveLine:!0,enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!1}),n.on("change",function(){e.$from_lyrics()}),e.lyrics_editor=n,e.lyrics_range=ace.require("ace/range").Range,e.lyrics_inhibit_callbacks=!1,e.lyrics_markers=[]},m.$$arity=1),t.def(At,"$on_change",y=function(){var t,e=y.$$p,r=e||s;return e&&(y.$$p=null),e&&(y.$$p=null),this.on_change=r,$(this.$Native(this.$Native(this.editor).$getSession()),"on",["change"],((t=function(e){var r=t.$$s||this;return null==r.on_change&&(r.on_change=s),null==e&&(e=s),r.$save_to_localstorage("zn_abc"),r.$clear_markers(),r.on_change.$call(e)}).$$s=this,t.$$arity=1,t))},y.$$arity=0),t.def(At,"$on_selection_change",g=function(){var t,e=g.$$p,r=e||s;return e&&(g.$$p=null),e&&(g.$$p=null),$(this.$Native(this.$Native(this.editor)["$[]"]("selection")),"on",["changeSelection"],((t=function(e){var n=t.$$s||this;return null==n.inhibit_callbacks&&(n.inhibit_callbacks=s),null==e&&(e=s),f(n.inhibit_callbacks)?s:r.$call(e)}).$$s=this,t.$$arity=1,t))},g.$$arity=0),t.def(At,"$on_cursor_change",v=function(){var t,e=v.$$p,r=e||s;return e&&(v.$$p=null),e&&(v.$$p=null),r.$call(s),$(this.$Native(this.$Native(this.editor)["$[]"]("selection")),"on",["changeCursor"],((t=function(e){var n=t.$$s||this;return null==n.inhibit_callbacks&&(n.inhibit_callbacks=s),null==e&&(e=s),f(n.inhibit_callbacks)?s:r.$call(e)}).$$s=this,t.$$arity=1,t))},v.$$arity=0),t.def(At,"$clear_selection",b=function(){return this.editor.selection.clearSelection(),this.$niil()},b.$$arity=0),t.def(At,"$_get_unison_edit_replacement",A=function(t,r,n){var i,a=s,c=s;return a=t["$[]"](1).$scan(o(xt,"Regexp").$new(r)),c=e(e("[",t["$[]"](1)),"]"),"replaceByFirst"["$==="](i=n)?c=a["$[]"](0):"replaceByLast"["$==="](i)?c=a["$[]"](-1):"replaceBySecond"["$==="](i)?f(a["$[]"](1))&&(c=a["$[]"](1)):"replaceBySecondLast"["$==="](i)?f(a["$[]"](1))&&(c=a["$[]"](-2)):"replaceByInnerPart"["$==="](i)?f(a["$[]"](2))&&(c=e(e("[",a["$[]"](h(1,-2,!1)).$join()),"]")):"swapFirstWithLast"["$==="](i)?f(a["$[]"](1))&&(c=e(e("[",[a["$[]"](-1),a["$[]"](h(1,-2,!1)),a["$[]"](0)].$flatten().$join()),"]")):"revert"["$==="](i)&&(c=e(e("[",a.$reverse().$join()),"]")),c},A.$$arity=3),t.def(At,"$edit_unisons",x=function(t){var e,r,n=s,i=s,a=s,c=s;return r=this.editor.selection.getRange(),n=this.editor.getSession().doc.getTextRange(this.$editor().selection.getRange()),f(n["$empty?"]())?this.$raise(o(xt,"I18n").$t("Selection is empty")):(i="[\\^\\_=]?[a-zA-Z][',]*",a=o(xt,"Regexp").$new("\\[("+i+")\\s*("+i+")?\\s*(("+i+"\\s*)*)("+i+")?\\]"),a=o(xt,"Regexp").$new("\\[\\s*(("+i+"\\s*)+)\\]"),c=n,c=$(n,"gsub",[a],((e=function(r){var n=e.$$s||this;return null==r&&(r=s),n.$_get_unison_edit_replacement(o(xt,"Regexp").$last_match(),i,t)}).$$s=this,e.$$arity=1,e)),this.$editor().session.replace(r,c)),s},x.$$arity=1),t.def(At,"$get_selection_positions",w=function(){return doc=this.editor.selection.doc,range=this.editor.selection.getRange(),range_start=doc.positionToIndex(range.start,0),range_end=doc.positionToIndex(range.end,0),[range_start,range_end]},w.$$arity=0),t.def(At,"$get_selection_ranges",k=function(){var t=this.editor.selection.doc;return this.editor.selection.getAllRanges().map(function(e){return[t.positionToIndex(e.start,0),t.positionToIndex(e.end,0)]})},k.$$arity=0),t.def(At,"$get_selection_info",E=function(){return doc=this.editor.selection.doc,range=this.editor.selection.getRange(),token=this.editor.session.getTokenAt(range.start.row,range.start.column),token&&(token.startpos=[range.start.row,token.start],token.endpos=[range.start.row,token.start+token.value.length]),this.$Native({selection:[[range.start.row+1,range.start.column+1],[range.end.row+1,range.end.column+1]],token:token})},E.$$arity=0),t.def(At,"$select_range_by_position",S=function(t,e,r){var n,i,a=s;null==r&&(r=!1),n=[(a=f(r)?this.$get_selection_positions():[t,e]).$first(),t].$min(),i=[a.$last(),e].$max(),doc=this.editor.selection.doc,startrange=doc.indexToPosition(n),endrange=doc.indexToPosition(i),range=new this.range(startrange.row,startrange.column,endrange.row,endrange.column),myrange={start:startrange,end:endrange},this.editor.focus(),this.editor.selection.setSelectionRange(myrange,!1)},S.$$arity=-3),t.def(At,"$set_focus",N=function(){return this.editor.focus()},N.$$arity=0),t.def(At,"$select_add_range_by_position",I=function(t,e,r){var n,i,a=s;null==r&&(r=!1),n=[(a=f(r)?this.$get_selection_positions():[t,e]).$first(),t].$min(),i=[a.$last(),e].$max(),doc=this.editor.selection.doc,startrange=doc.indexToPosition(n),endrange=doc.indexToPosition(i),range=new this.range(startrange.row,startrange.column,endrange.row,endrange.column),myrange={start:startrange,end:endrange},this.editor.focus(),this.editor.selection.addRange(range,!1)},I.$$arity=-3),t.def(At,"$get_text",C=function(){var t=s;return t=e(t=this.$_get_abc_from_editor().$strip(),e("\n\n"+this.config_separator+".config\n\n",this.$_get_config_json())),f(this["$_has_resources?"]())&&(t=e(t,e("\n\n"+this.config_separator+".resources\n\n",this.$_get_resources_json()))),t},C.$$arity=0),t.def(At,"$set_text",O=function(t){return this.$_split_parts(t)},O.$$arity=1),t.def(At,"$replace_range",B=function(t,e,r){therange=new this.range(t[0],t[1],e[0],e[1]),this.$editor().getSession().replace(therange,r)},B.$$arity=3),t.def(At,"$replace_text",M=function(t,e){return this.editor.replace(e,{needle:t}),s},M.$$arity=2),t.def(At,"$set_annotations",P=function(t){var e,n=s;return n=$(t,"map",[],((e=function(t){e.$$s;return null==t&&(t=s),u(["row","text","type"],{row:r(t["$[]"]("start_pos").$first(),1),text:t["$[]"]("text"),type:t["$[]"]("type")})}).$$s=this,e.$$arity=1,e)),this.$set_markers(t),this.editor.getSession().setAnnotations(n.$to_n()),s},P.$$arity=1),t.def(At,"$set_markers",F=function(t){var e;return this.$clear_markers(),$(t,"each",[],((e=function(t){var r=e.$$s||this;return null==t&&(t=s),r.$add_marker(t)}).$$s=this,e.$$arity=1,e))},F.$$arity=1),t.def(At,"$prepend_comment",L=function(t){var r,n;n=e($(t.$split(/\r?\n/),"map",[],(r=function(t){r.$$s;return null==t&&(t=s),"% "+t},r.$$s=this,r.$$arity=1,r)).$join("\n"),"\n%\n"),this.editor.selection.moveCursorFileStart(),this.editor.insert(n)},L.$$arity=1),t.def(At,"$append_text",T=function(t){this.editor.selection.moveCursorFileEnd(),this.editor.insert(t)},T.$$arity=1),t.def(At,"$add_marker",j=function(t){var e,n=s,i=s;return n=u(["row","col"],{row:t["$[]"]("start_pos").$first(),col:t["$[]"]("start_pos").$last()}),i=u(["row","col"],{row:t["$[]"]("end_pos").$first(),col:t["$[]"]("end_pos").$last()}),e=this.editor.getSession().addMarker(new this.range(r(n["$[]"]("row"),1),r(n["$[]"]("col"),1),r(i["$[]"]("row"),1),r(i["$[]"]("col"),1)),"marked","line",!0),this.markers["$<<"](u(["from","to","id"],{from:[n["$[]"]("row"),n["$[]"]("col")],to:[i["$[]"]("row"),i["$[]"]("col")],id:e})),s},j.$$arity=1),t.def(At,"$clear_markers",R=function(){var t;return $(this.markers,"each",[],((t=function(e){var r=t.$$s||this;return null==r.editor&&(r.editor=s),null==e&&(e=s),r.editor.session.removeMarker(e["$[]"]("id"))}).$$s=this,t.$$arity=1,t)),this.markers.$clear()},R.$$arity=0),t.def(At,"$get_abc_part",D=function(){return this.editor.getSession().getValue()},D.$$arity=0),t.def(At,"$get_config_part",z=function(){return this.config_models["$[]"]("config")},z.$$arity=0),t.def(At,"$get_config_model",U=function(){var t;return t=this.$_get_config_model(),f(t)?[this.$_get_config_model(),!0]:[u([],{}),!1]},U.$$arity=0),t.def(At,"$get_checksum",q=function(){var t,e=s;e=this.$_get_abc_from_editor().$strip();var r=305419896;for(t=0;t<e.length;t++)r+=e.charCodeAt(t)*(t+1);return r.$to_s().$scan(/...?/).$join(" ")},q.$$arity=0),t.def(At,"$resize",H=function(){return this.editor.resize()},H.$$arity=0),t.def(At,"$set_config_model",Q=function(e,n,i){var s;return null==n&&(n="no desc"),null==i&&(i=!0),s=["zn_config",!0],$(this.dirty,"[]=",t.to_a(s)),r(s.length,1),i["$=="](!0)&&this.config_undo.$do(e,n),this.$_set_config_model(e)},Q.$$arity=-2),t.def(At,"$patch_config_part",Y=function(e,n,i){var c,l=s,u=s;return null==i&&(i=e),l=a(o(xt,"Confstack"),"Confstack").$new(!1),u=a(o(xt,"Confstack"),"Confstack").$new(!1),l.$push(this.$_get_config_model()),c=[e,n],$(u,"[]=",t.to_a(c)),r(c.length,1),l.$push(u.$get()),this.$set_config_model(l.$get(),i,!0)},Y.$$arity=-3),t.def(At,"$copy_config_part_to_extract",G=function(e,n,i){var c,l=s,u=s;return null==i&&(i=e),l=a(o(xt,"Confstack"),"Confstack").$new(!1),u=a(o(xt,"Confstack"),"Confstack").$new(!1),l.$push(this.$_get_config_model()),c=[e.$gsub(/^extract\.\d+/,"extract."+n),l.$get(e)],$(u,"[]=",t.to_a(c)),r(c.length,1),l.$push(u.$get()),this.$set_config_model(l.$get(),i,!0)},G.$$arity=-3),t.def(At,"$neat_config_part",V=function(){return this.$_set_config_json(this.$_get_config_json(),"neat config_part",!1)},V.$$arity=0),t.def(At,"$patch_resources",J=function(e,n){var i=s;return null==p.resources&&(p.resources=s),i=["zn_resources",!0],$(this.dirty,"[]=",t.to_a(i)),i[r(i.length,1)],i=[e,n],$(p.resources,"[]=",t.to_a(i)),i[r(i.length,1)],this.$save_to_localstorage("zn_resources"),this.on_change.$call(s)},J.$$arity=2),t.def(At,"$patch_token",X=function(t,e,r){var n=s;return(n=this.$get_selection_info().$token()).$type().$to_s()["$=="](t.$to_s())||this.$raise("cannot patch token if there is a name mismatch '"+n.$type()+"' - '"+t+"'"),this.$replace_range(n.$startpos(),n.$endpos(),r)},X.$$arity=3),t.def(At,"$extend_config_part",W=function(e,n){var i,c=s,l=s;return c=a(o(xt,"Confstack"),"Confstack").$new(!1),l=a(o(xt,"Confstack"),"Confstack").$new(!1),c.$push(this.$_get_config_model()),i=[e,n],$(l,"[]=",t.to_a(i)),r(i.length,1),c.$push(l.$get()),c.$push(this.$_get_config_model()),this.$set_config_model(c.$get(),"extend "+e,!0)},W.$$arity=2),t.def(At,"$delete_config_part",K=function(e){var n=s,i=s;return null==p.resources&&(p.resources=s),f(e["$start_with?"]("$resources"))?p.resources.$delete(e.$split(".").$last()):((n=a(o(xt,"Confstack"),"Confstack").$new(!1)).$push(this.$_get_config_model().$deep_dup()),i=[e,a(o(xt,"Confstack"),"DeleteMe")],$(n,"[]=",t.to_a(i)),i[r(i.length,1)],this.$set_config_model(n.$get(),"delete "+e,!0))},K.$$arity=1),t.def(At,"$get_config_part_value",Z=function(t){var e=s;return(e=a(o(xt,"Confstack"),"Confstack").$new(!1)).$push(this.$_get_config_model()),e["$[]"](t)},Z.$$arity=1),t.def(At,"$get_lyrics",tt=function(){var t,e=s;return e=this.$get_lyrics_raw(),f(n(e.$count(),0))?$(e,"map",[],(t=function(e){t.$$s;return null==e&&(e=s),e.$first().$gsub(/\nW\:[ \t]*/,"\n")},t.$$s=this,t.$$arity=1,t)).$join().$strip():s},tt.$$arity=0),t.def(At,"$get_lyrics_raw",et=function(){var t,e=s;return null==p.log&&(p.log=s),t=/((\n((W\:)([^\n]*)\n)+)+)/,e=this.$get_abc_part().$scan(t),f(n(e.$count(),1))&&p.log.$error("you have more than one lyrics section in your abc code"),e},et.$$arity=0),t.def(At,"$to_lyrics",rt=function(){var t,r=s,n=s;return null==p.log&&(p.log=s),p.log.$clear_errors(),t=this.$get_lyrics(),f(t)||(n=e((r=this.$get_abc_part()).$strip(),"\n%\nW:\n%\n%\n"),this.$replace_text(r,n)),this.handle_from_lyrics=!1,this.lyrics_editor.getSession().setValue(this.$get_lyrics()),this.handle_from_lyrics=!0,this.controller.$call_consumers("error_alert"),s},rt.$$arity=0),t.def(At,"$from_lyrics",nt=function(){var t,e=s,r=s;return f(this.handle_from_lyrics)&&(e=this.$get_lyrics_raw().$first().$first(),r=this.lyrics_editor.getSession().getValue(),f(r["$empty?"]())&&(r=" "),r="\n"+(r=$(r.$split("\n"),"map",[],(t=function(e){t.$$s;return null==e&&(e=s),"W:"+e},t.$$s=this,t.$$arity=1,t)).$join("\n"))+"\n",this.$replace_text(e,r)),s},nt.$$arity=0),t.def(At,"$restore_from_localstorage",it=function(){var t,e=s,r=s,n=s,i=s;return e=this.$Native(localStorage.getItem("abc_data")),f(e["$nil?"]())?(r=this.$Native(localStorage.getItem("zn_abc")),f(r)&&this.$_set_abc_to_editor(r),n=f(t=this.$Native(localStorage.getItem("zn_config")))?t:u([],{}),this.config_undo.$reset(),f(n)&&this.$_set_config_json(n,"from localstore zn_config",!0),i=this.$Native(localStorage.getItem("zn_resources")),f(i)&&this.$_set_resources_json(i)):(localStorage.removeItem("abc_data"),f(e["$nil?"]())||this.$set_text(e)),this.dirty=u([],{})},it.$$arity=0),t.def(At,"$save_to_localstorage",st=function(e){var n=s;return null==e&&(e=s),f(e)&&(n=[e,!0],$(this.dirty,"[]=",t.to_a(n)),n[r(n.length,1)]),this.dirty["$[]"]("zn_abc")["$=="](!0)&&localStorage.setItem("zn_abc",this.$_get_abc_from_editor()),this.dirty["$[]"]("zn_config")["$=="](!0)&&localStorage.setItem("zn_config",this.$_get_config_json()),this.dirty["$[]"]("zn_resources")["$=="](!0)&&localStorage.setItem("zn_resources",this.$_get_resources_json()),this.dirty=u([],{})},st.$$arity=-1),t.def(At,"$clean_localstorage",at=function(){return localStorage.removeItem("zn_abc"),localStorage.removeItem("zn_config"),localStorage.removeItem("zn_resources"),s},at.$$arity=0),t.def(At,"$get_config_from_text",ot=function(t){var e,r,n=s;return n=(r=$(t.$split(this.config_separator),"select",[],(e=function(t){e.$$s;return null==t&&(t=s),t["$start_with?"](".config")},e.$$s=this,e.$$arity=1,e)).$first())===s||null==r?s:$(r,"gsub",[".config",""]),f(n)?o(xt,"JSON").$parse(n):s},ot.$$arity=1),t.def(At,"$_split_parts",ct=function(t){var r;return this.$_clean_models(),this.$clean_localstorage(),$(t.$split(this.config_separator),"each_with_index",[],((r=function(t,n){var i=r.$$s||this;return null==i.config_undo&&(i.config_undo=s),null==p.log&&(p.log=s),null==t&&(t=s),null==n&&(n=s),n["$=="](0)?i.$_set_abc_to_editor(t):f(t["$start_with?"](".config"))?(i.config_undo.$reset(),i.$_set_config_json(t.$split(".config").$last(),"from loaded abc",!0)):f(t["$start_with?"](".resources"))?i.$_set_resources_json(t.$split(".resources").$last()):p.log.$error(e(o(xt,"I18n").$t("unsupported section found in abc file: "),t["$[]"](h(0,10,!1))))}).$$s=this,r.$$arity=2,r))},ct.$$arity=1),t.def(At,"$_set_abc_to_editor",lt=function(t){return this.inhibit_callbacks=!0,this.editor.getSession().setValue(t),this.inhibit_callbacks=!1,this.$save_to_localstorage("zn_abc")},lt.$$arity=1),t.def(At,"$_get_abc_from_editor",ut=function(){return"",this.editor.getSession().getValue()},ut.$$arity=0),t.def(At,"$_set_config_json",ft=function(t,e,r){return null==e&&(e="no desc"),null==r&&(r=!0),this.$set_config_model(o(xt,"JSON").$parse(t),e,r)},ft.$$arity=-2),t.def(At,"$_get_config_json",$t=function(){var t,e;return null==p.conf&&(p.conf=s),null==p.log&&(p.log=s),e=p.conf["$[]"]("neatjson"),$(p.log,"benchmark",["neat_json",768,"./text_pane.rb".$force_encoding("US-ASCII")],((t=function(){var r=t.$$s||this;return o(xt,"JSON").$neat_generate(r.$_get_config_model(),e)}).$$s=this,t.$$arity=0,t))},$t.$$arity=0),t.def(At,"$_get_config_model",ht=function(){var t;return f(t=this.config_models["$[]"]("config"))?t:u([],{})},ht.$$arity=0),t.def(At,"$_set_config_model",pt=function(e){var n;return n=["config",e],$(this.config_models,"[]=",t.to_a(n)),r(n.length,1),this.$save_to_localstorage("zn_config"),this.on_change.$call(s)},pt.$$arity=1),t.def(At,"$undo_config",dt=function(){var t=s;return null==p.log&&(p.log=s),t=this.config_undo.$undo(),f(t)?(p.log.$info("undo: "+t["$[]"]("title")+": "+t["$[]"]("state").$dig("extract","0","legend","pos")),f(t)?this.$set_config_model(t["$[]"]("state"),t["$[]"]("title"),!1):s):s},dt.$$arity=0),t.def(At,"$redo_config",_t=function(){var t=s;return null==p.log&&(p.log=s),t=this.config_undo.$redo(),f(t)?(p.log.$info("redo: "+t["$[]"]("title")+": "+t["$[]"]("state").$dig("extract","0","legend","pos")),f(t)?this.$set_config_model(t["$[]"]("state"),t["$[]"]("title"),!1):s):s},_t.$$arity=0),t.def(At,"$history_config",mt=function(){return u(["undo","redo"],{undo:this.config_undo.$undo_history(),redo:this.config_undo.$redo_history()})},mt.$$arity=0),t.def(At,"$_set_resources_json",yt=function(t){return p.resources=o(xt,"JSON").$parse(t),this.$save_to_localstorage("zn_resources"),this.on_change.$call(s)},yt.$$arity=1),t.def(At,"$_get_resources_json",gt=function(){return null==p.resources&&(p.resources=s),null==p.conf&&(p.conf=s),o(xt,"JSON").$neat_generate(p.resources,p.conf["$[]"]("neatjson"))},gt.$$arity=0),t.def(At,"$_has_resources?",vt=function(){return null==p.resources&&(p.resources=s),p.resources["$empty?"]()["$!"]()},vt.$$arity=0),t.def(At,"$_clean_models",bt=function(){return p.resources=u([],{}),this.config_models=u([],{}),this.dirty=u([],{})},bt.$$arity=0)}(_[0],0,_)}(i[0],i)},Opal.modules["command-controller"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}t.top;var r=[],n=t.nil,i=(t.const_get_qualified,t.const_get_relative),s=(t.breaker,t.slice,t.module),a=t.klass,o=t.truthy,c=t.send,l=t.hash2,u=t.range;return t.add_stubs(["$attr_reader","$call","$lambda","$raise","$new","$set_help","$set_default","$push","$!","$start_with?","$to_s","$each","$name","$[]","$get_default","$[]=","$-","$get_help","$empty?","$get_clean_argument_values","$perform","$undoable?","$clear","$can_undo?","$pop","$invert","$can_redo?","$map","$scan","$first","$select","$nil?","$to_sym","$parse_string","$gsub","$each_with_index","$parameter_name","$clone","$unshift","$to_a","$is_public?","$last","$join","$parameters"]),function(r,f){var $=[s(r,"CommandController")].concat(f);!function(e,r,i){var s,c,l,u,f,$=a(e,null,"Parameter");[$].concat(i);$.$$prototype.default_action=$.$$prototype.name=$.$$prototype.help_action=n,$.$attr_reader("name"),t.def($,"$initialize",s=function(t,e){return this.name=t,this.type=e},s.$$arity=2),t.def($,"$set_help",c=function(){var t=c.$$p,e=t||n;return t&&(c.$$p=null),t&&(c.$$p=null),this.help_action=e},c.$$arity=0),t.def($,"$set_default",l=function(){var t=l.$$p,e=t||n;return t&&(l.$$p=null),t&&(l.$$p=null),this.default_action=e},l.$$arity=0),t.def($,"$get_help",u=function(){var t=n;return t=this.default_action.$call(),o(t)&&(t="["+t+"]"),"{"+this.name+"}"+t+" = "+this.help_action.$call()},u.$$arity=0),t.def($,"$get_default",f=function(){return this.default_action.$call()},f.$$arity=0)}($[0],0,$),function(r,s,u){var f,$,h,p,d,_,m,y,g,v,b,A,x,w,k,E=a(r,null,"Command"),S=[E].concat(u);E.$$prototype.parameters=E.$$prototype.name=E.$$prototype.action=E.$$prototype.inverse_action=E.$$prototype.help_action=E.$$prototype.undoable=n,E.$attr_reader("name","parameters"),t.def(E,"$initialize",f=function(t){var e,r,i;return this.name=t,this.help_action=c(this,"lambda",[],((e=function(){e.$$s;return"no help defined for "+t}).$$s=this,e.$$arity=0,e)),this.parameters=[],this.action=c(this,"lambda",[],((r=function(e){var i=r.$$s||this;return null==e&&(e=n),i.$raise("No action defined for "+t)}).$$s=this,r.$$arity=1,r)),this.inverse_action=c(this,"lambda",[],((i=function(e){var r=i.$$s||this;return null==e&&(e=n),r.$raise("No  undo defined fore "+t)}).$$s=this,i.$$arity=1,i)),this.undoable=!0},f.$$arity=1),t.def(E,"$add_parameter",$=function(t,e,r,s){var a,o,l,u=$.$$p,f=u||n;return u&&($.$$p=null),u&&($.$$p=null),null==r&&(r=n),null==s&&(s=n),l=i(S,"Parameter").$new(t,e),c(l,"set_help",[],((a=function(){a.$$s;return r}).$$s=this,a.$$arity=0,a)),c(l,"set_default",[],((o=function(){o.$$s;return s}).$$s=this,o.$$arity=0,o)),f!==n&&f.$call(l),this.parameters.$push(l)},$.$$arity=-3),t.def(E,"$as_action",h=function(){var t=h.$$p,e=t||n;return t&&(h.$$p=null),t&&(h.$$p=null),this.action=e},h.$$arity=0),t.def(E,"$as_inverse",p=function(){var t=p.$$p,e=t||n;return t&&(p.$$p=null),t&&(p.$$p=null),this.inverse_action=e},p.$$arity=0),t.def(E,"$is_public?",d=function(){return this.name.$to_s()["$start_with?"]("_")["$!"]()},d.$$arity=0),t.def(E,"$set_help",_=function(){var t=_.$$p,e=t||n;return t&&(_.$$p=null),t&&(_.$$p=null),this.help_action=e},_.$$arity=0),t.def(E,"$perform",m=function(t){return this.action.$call(t)},m.$$arity=1),t.def(E,"$invert",y=function(t){return this.inverse_action.$call(t)},y.$$arity=1),t.def(E,"$get_clean_argument_values",g=function(r){var i,s;return s=l([],{}),c(this.parameters,"each",[],((i=function(a){var l,u;i.$$s;return null==a&&(a=n),u=[a.$name(),o(l=r["$[]"](a.$name()))?l:a.$get_default()],c(s,"[]=",t.to_a(u)),u[e(u.length,1)]}).$$s=this,i.$$arity=1,i)),s},g.$$arity=1),t.def(E,"$get_help",v=function(){return this.help_action.$call()},v.$$arity=0),t.def(E,"$parameter_name",b=function(t){return this.parameters["$[]"](t).$name()},b.$$arity=1),t.def(E,"$parameter_help",A=function(t){return this.parameters["$[]"](t).$get_help()},A.$$arity=1),t.def(E,"$parameter_default",x=function(t){return this.parameters["$[]"](t).$get_default()},x.$$arity=1),t.def(E,"$undoable?",w=function(){return this.undoable},w.$$arity=0),t.def(E,"$undoable=",k=function(t){return this.undoable=t},k.$$arity=1)}($[0],0,$),function(r,s,f){var $,h,p,d,_,m,y,g,v,b,A,x,w,k,E=a(r,null,"CommandStack"),S=[E].concat(f);E.$$prototype.commands=E.$$prototype.undo_stack=E.$$prototype.redo_stack=E.$$prototype.history_stack=n,t.def(E,"$initialize",$=function(){return this.commands=l([],{}),this.undo_stack=[],this.redo_stack=[],this.history_stack=[]},$.$$arity=0),t.def(E,"$add_command",h=function(r){var s,a=h.$$p,o=a||n,l=n;return a&&(h.$$p=null),a&&(h.$$p=null),l=i(S,"Command").$new(r),o.$call(l),s=[l.$name(),l],c(this.commands,"[]=",t.to_a(s)),s[e(s.length,1)]},h.$$arity=1),t.def(E,"$can_undo?",p=function(){return this.undo_stack["$empty?"]()["$!"]()},p.$$arity=0),t.def(E,"$can_redo?",d=function(){return this.redo_stack["$empty?"]()["$!"]()},d.$$arity=0),t.def(E,"$perform",_=function(t,e){var r;return r=t.$get_clean_argument_values(e),t.$perform(r),o(t["$undoable?"]())&&(this.undo_stack.$push([t,r]),this.redo_stack.$clear()),this.history_stack.$push(["  do",t,r])},_.$$arity=2),t.def(E,"$undo",m=function(){var e,r,i=n,s=n;return o(this["$can_undo?"]())?(r=this.undo_stack.$pop(),i=null==(e=t.to_ary(r))[0]?n:e[0],s=null==e[1]?n:e[1],this.redo_stack.$push([i,s]),this.history_stack.$push(["undo",i,s]),i.$invert(s)):this.$raise("nothing to undo")},m.$$arity=0),t.def(E,"$redo",y=function(){var e,r,i=n,s=n;return o(this["$can_redo?"]())?(r=this.redo_stack.$pop(),i=null==(e=t.to_ary(r))[0]?n:e[0],s=null==e[1]?n:e[1],this.$perform(i,s)):this.$raise("nothing to redo")},y.$$arity=0),t.const_set(S[0],"STRING_COMMAND_REGEX",/([^ \\\^"{]+)|"(([^\\"]|\\["n\\])*)"|(\{.+\})/),t.def(E,"$parse_string",g=function(t){var e;return c(t.$scan(i(S,"STRING_COMMAND_REGEX")),"map",[],((e=function(t){var r,i=e.$$s||this;return null==t&&(t=n),c(t,"select",[],(r=function(t){r.$$s;return null==t&&(t=n),t["$nil?"]()["$!"]()},r.$$s=i,r.$$arity=1,r)).$first()}).$$s=this,e.$$arity=1,e))},g.$$arity=1),t.def(E,"$run_parsed_command",v=function(t,e){var r;return r=this.commands["$[]"](t.$to_sym()),this.$perform(r,e)},v.$$arity=2),t.def(E,"$run_string",b=function(r){var s,a,f,$=n,h=n;return f=l([],{}),$=this.$parse_string(r),o($["$empty?"]())&&($=["help"]),$=c($,"map",[],((s=function(t){s.$$s;return null==t&&(t=n),t.$gsub("\\\\","\\")}).$$s=this,s.$$arity=1,s)),h=this.commands["$[]"]($.$first().$to_sym()),o(h)||this.$raise("wrong command: "+r),c($["$[]"](u(1,-1,!1)),"each_with_index",[],((a=function(s,o){var l=a.$$s||this,u=n;null==s&&(s=n),null==o&&(o=n);try{return u=[h.$parameter_name(o),s],c(f,"[]=",t.to_a(u)),u[e(u.length,1)]}catch(e){if(!t.rescue(e,[i(S,"StandardError")]))throw e;try{return l.$raise("too many arguments in '"+r+"'")}finally{t.pop_exception()}}}).$$s=this,a.$$arity=2,a)),this.$perform(h,f)},b.$$arity=1),t.def(E,"$history",A=function(){return this.history_stack.$clone()},A.$$arity=0),t.def(E,"$undostack",x=function(){var t;return c(this.undo_stack,"map",[],((t=function(e){t.$$s;return null==e&&(e=n),e.$clone().$unshift("undo")}).$$s=this,t.$$arity=1,t))},x.$$arity=0),t.def(E,"$redostack",w=function(){var t;return c(this.redo_stack,"map",[],((t=function(e){t.$$s;return null==e&&(e=n),e.$clone().$unshift("redo")}).$$s=this,t.$$arity=1,t))},w.$$arity=0),t.def(E,"$help_string_style",k=function(){var t,e;return c(c(this.commands.$to_a(),"select",[],((t=function(e){t.$$s;return null==e&&(e=n),e.$last()["$is_public?"]()}).$$s=this,t.$$arity=1,t)),"map",[],((e=function(t,r){var i,s,a=e.$$s||this;return null==t&&(t=n),null==r&&(r=n),s=c(r.$parameters(),"map",[],(i=function(t){i.$$s;return null==t&&(t=n),"{"+t.$name()+"}"},i.$$s=a,i.$$arity=1,i)).$join(" "),r.$name()+" "+s+" : "+r.$get_help()}).$$s=this,e.$$arity=2,e))},k.$$arity=0)}($[0],0,$)}(r[0],r)},Opal.modules.controller=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}t.top;var n=[],i=t.nil,s=t.const_get_qualified,a=t.const_get_relative,o=(t.breaker,t.slice,t.klass),c=t.truthy,l=t.hash2,u=t.gvars,f=t.send,h=t.range;return t.add_stubs(["$nil?","$Native","$now","$load_dir","$save_dir","$[]","$warning","$update","$to_json","$[]=","$-","$parse","$clone","$private","$attr_accessor","$html","$find","$new","$post_named_message","$downcase","$locale","$call_consumers","$to_n","$phrases","$strict=","$push","$_init_conf","$load_from_loacalstorage","$on_command","$save_to_localstorage","$handle_command","$info","$jspdfversion","$check_suppoerted_browser","$controller=","$each","$select","$methods","$=~","$send","$setup_tune_preview","$setup_harpnote_preview","$setup_harpnote_player","$setup_worker_listners","$get_uri","$class","$last","$cleanup_localstorage","$empty?","$get_abc_part","$load_demo_tune","$set_status","$loglevel","$get_current_template","$load_from_uri","$==","$get_lyrics","$ok?","$render_previews","$error","$t","$setup_ui_listener","$show_message_of_the_day","$year","$+","$join","$get_errors","$lambda","$has_errors?","$make_error_popup","$get_notes","$map","$to_s","$call","$get_config_form_menu_entries","$clear_errors","$timestamp_start","$timestamp","$run_string","$message","$backtrace","$run_parsed_command","$include?","$systemstatus","$uniq","$always","$fail","$then","$get","$set_text","$body","$alert","$restore_from_localstorage","$match","$first","$chordnotes","$chordfor","$scan_notesstring","$get_chords_for","$scan","$upcase","$tomidi","$play_pitches","$compact","$draw","$layout_harpnotes","$draw_in_segments","$migrate_config_lyrics","$migrate_notes","$migrate_config_cleanup","$delete","$inject","$split","$gsub","$to_i","$count","$is_a?","$resolve","$tap","$is_playing?","$stop_play_abc","$is_stopped?","$play_auto","$play_song","$play_selection","$play_from_selection","$stop","$set_active","$tweak_abc_text","$benchmark","$compute_tune_preview","$get_checksum","$set_svg","$set_inactive","$start_with?","$get_config_from_editor","$debug","$load_song","$active_voices","$harpnote_preview_printer","$save_scroll_position","$resize","$clear_annotations","$render_previews_in_worker","$render_previews_in_uithread","$render_tunepreview__in_worker","$clear","$size","$render_harpnotepreview_in_worker","$render_tunepreview_in_uithread","$render_harpnotepreview_callback","$bind_elements","$set_annotations","$annotations","$output","$!","$file","$get_text","$render_a4","$render_a3","$to_blob","$strftime","$load_music_model","$keys","$set_extracts_menu","$validate_conf","$uri=","$get_placeholder_replacers","$placeholders=","$layout","$pop","$meta_data","$reset_to","$transform","$abc_model","$player_model_abc=","$checksum=","$get_config_model","$migrate_config","$set_config_model","$add_class","$scroll_into_view","$has_class?","$scroll_to_element","$remove_class","$select_range_by_position","$range_highlight_more","$range_unhighlight_more","$range_unhighlight","$highlight_abc_object","$between?","$select_add_range_by_position","$get_selection_ranges","$to_a","$flatten","$merge!","$loglevel=","$app_name","$app_id","$dig","$set_harppreview_size","$set_view_box","$on_select","$select_abc_object","$on_drag_start","$on_drag_end","$zip","$patch_config_part","$refresh_form","$on_mouseover","$on_mouseout","$on_draggable_rightcklick","$set_canvas","$on_named_message","$<=","$shift","$set_worker_model","$log_from_worker","$on_change","$request_refresh","$on_selection_change","$get_selection_info","$unhighlight_all","$range_highlight","$on_cursor_change","$on_noteon","$highlight_abc_object_by_player_callback","$on_noteoff","$on_songoff","$on","$shift_key","$alt_key","$meta_key","$ctrl_key","$key_code","$===","$ord","$prevent","$play_abc","$toggle_console","$chr","$key","$newValue","$present_message_of_the_day","$>","$init_conf"]),function(e,r,n){var i,s,c,l=o(e,null,"LastRenderMonitor"),u=[l].concat(n);t.def(l,"$ok?",i=function(){var t;return t=localStorage.getItem("lastrender"),this.$Native(t)["$nil?"]()},i.$$arity=0),t.def(l,"$set_active",s=function(){return localStorage.setItem("lastrender",a(u,"Time").$now()),!0},s.$$arity=0),t.def(l,"$clear",c=function(){return localStorage.removeItem("lastrender"),!1},c.$$arity=0)}(n[0],0,n),function(r,n,s){var $,h,p,d,_,m,y,g,v,b=o(r,null,"LocalStore"),A=[b].concat(s);b.$$prototype.directory=b.$$prototype.name=i,t.def(b,"$initialize",$=function(t){return this.name=t,this.$load_dir(),c(this.directory)?i:(this.directory=l([],{}),this.$save_dir())},$.$$arity=1),t.def(b,"$create",h=function(t,e,r){return null==u.log&&(u.log=i),null==r&&(r=i),c(this.directory["$[]"](t))?u.log.$warning("local storage: key '"+t+"' already exists"):this.$update(t,e,r,!0)},h.$$arity=-3),t.def(b,"$update",p=function(r,n,s,a){var o,$,h=i;return null==u.log&&(u.log=i),null==s&&(s=i),null==a&&(a=!1),$=l(["p","title"],{p:n,title:s}).$to_json(),c(c(o=this.directory["$[]"](r))?o:a)?(localStorage.setItem(this.$mangle_key(r),$),h=[r,s],f(this.directory,"[]=",t.to_a(h)),h[e(h.length,1)],this.$save_dir()):u.log.$warning("local storage update: key '"+r+"' does not exist")},p.$$arity=-3),t.def(b,"$retrieve",d=function(t){var e=i,r=i;return e=a(A,"JSON").$parse(localStorage.getItem(this.$mangle_key(t))),c(e)&&(r=e["$[]"]("p")),r},d.$$arity=1),t.def(b,"$delete",_=function(r){var n=i;return null==u.log&&(u.log=i),c(this.directory["$[]"](r))?u.log.$warning("local storage: key '"+r+"' does not exist"):(localStorage.removeItem(this.$mangle_key(r)),n=[r,i],f(this.directory,"[]=",t.to_a(n)),n[e(n.length,1)],this.$save_dir())},_.$$arity=1),t.def(b,"$list",m=function(){return this.directory.$clone()},m.$$arity=0),b.$private(),t.def(b,"$mangle_key",y=function(t){return this.name+"."+t},y.$$arity=1),t.def(b,"$load_dir",g=function(){var t;return t=this.name+"__dir",this.directory=a(A,"JSON").$parse(localStorage.getItem(t))},g.$$arity=0),t.def(b,"$save_dir",v=function(){var t,e;return t=this.directory.$to_json(),e=this.name+"__dir",localStorage.setItem(e,t)},v.$$arity=0)}(n[0],0,n),function(n,p,d){var _,m,y,g,v,b,A,x,w,k,E,S,N,I,C,O,B,M,P,F,L,T,j,R,D,z,U,q,H,Q,Y,G,V,J,X,W,K,Z,tt,et,rt,nt,it,st,at,ot,ct,lt,ut,ft,$t,ht,pt,dt,_t,mt,yt,gt,vt,bt,At,xt,wt,kt,Et,St,Nt,It,Ct,Ot,Bt=o(n,null,"Controller"),Mt=[Bt].concat(d);return Bt.$$prototype.worker=Bt.$$prototype.console=Bt.$$prototype.editor=Bt.$$prototype.systemstatus=Bt.$$prototype.worker_info=Bt.$$prototype.systemstatus_consumers=Bt.$$prototype.commands=Bt.$$prototype.dropboxpath=Bt.$$prototype.harpnote_player=Bt.$$prototype.harpnote_preview_printer=Bt.$$prototype.pdf_preview_string=Bt.$$prototype.song_harpnotes=Bt.$$prototype.music_model=Bt.$$prototype.tune_preview_printer=Bt.$$prototype.expand_selection=Bt.$$prototype.abc_model=Bt.$$prototype.dropboxclient=Bt.$$prototype.dropboxloginstate=Bt.$$prototype.worker_tunepreview=Bt.$$prototype.info_url=Bt.$$prototype.refresh_timer=i,Bt.$attr_accessor("dropped_abc","dropboxclient","dropboxpath","editor","harpnote_preview_printer","info_url","tune_preview_printer","systemstatus","zupfnoter_ui","pdf_preview_string"),t.def(Bt,"$initialize",_=function(){var r,n,o,$,h,p,d,_,m,y=i,g=i,v=i,b=i,A=i;return null==u.conf&&(u.conf=i),null==u.log&&(u.log=i),y=a(Mt,"Time").$now(),y=a(Mt,"Element").$find("#buster").$html(),y=a(Mt,"JSON").$parse(y)["$[]"]("buster"),this.worker=a(Mt,"NamedWebworker").$new("public/znworker.js"+y),this.worker_tunepreview=this.worker,this.worker_info=l(["version"],{version:"unknown"}),this.worker.$post_named_message("get_worker_info",i),g=l(["de","de-de","en","en-us"],{de:"de-de","de-de":"de-de",en:"en-US","en-us":"en-US"}),p=function(){try{return navigator.language.$downcase()}catch(e){if(!t.rescue(e,[a(Mt,"StandardError")]))throw e;try{return"de-de"}finally{t.pop_exception()}}}(),d=c(r=g["$[]"](p))?r:"de-de",this.info_url="https://www.zupfnoter.de/category/info_"+d,this.refresh_timer=[],this.render_stack=[],this.version=a(Mt,"VERSION"),c(p)&&f(a(Mt,"I18n"),"locale",[d],((n=function(){var t,e=n.$$s||this;return null==e.worker&&(e.worker=i),e.$call_consumers("localizedtexts"),t=JSON.stringify(a(Mt,"I18n").$phrases().$to_n()),e.worker.$post_named_message("i18n_set_locale",t)}).$$s=this,n.$$arity=0,n)),u.conf=a(Mt,"Confstack").$new(i),v=[!1],f(u.conf,"strict=",t.to_a(v)),v[e(v.length,1)],u.conf.$push(this.$_init_conf()),this.zupfnoter_ui=new init_w2ui(this),this.console=s(a(Mt,"JqConsole"),"JqConsole").$new("commandconsole","zupfnoter> "),this.console.$load_from_loacalstorage(),f(this.console,"on_command",[],((o=function(t){var e=o.$$s||this;return null==e.console&&(e.console=i),null==t&&(t=i),e.console.$save_to_localstorage(),e.$handle_command(t)}).$$s=this,o.$$arity=1,o)),this.dropped_abc="T: nothing dropped yet",u.log=a(Mt,"ConsoleLogger").$new(this.console),u.log.$info("Welcome to Zupfnoter"),u.log.$info("Zupfnoter "+a(Mt,"VERSION")),u.log.$info("Opal:     "+a(Mt,"RUBY_ENGINE_VERSION")),u.log.$info("Ruby:     "+a(Mt,"RUBY_VERSION")),u.log.$info("Abc2svg:  "+abc2svg.version),u.log.$info("JsPdf:    "+a(Mt,"JsPDF").$jspdfversion()),u.log.$info("Browser:  "+bowser.name+"  "+bowser.version),u.log.$info("Language: "+d),this.$check_suppoerted_browser(),u.resources=l([],{}),u.settings=l(["autoscroll","follow"],{autoscroll:"true",follow:"true"}),this.$call_consumers("settings_menu"),this.json_validator=s(a(Mt,"Ajv"),"JsonValidator").$new(),this.editor=s(a(Mt,"Harpnotes"),"TextPane").$new("abcEditor"),v=[this],f(this.editor,"controller=",t.to_a(v)),v[e(v.length,1)],this.songbook=a(Mt,"LocalStore").$new("songbook"),this.abc_transformer=s(s(a(Mt,"Harpnotes"),"Input"),"Abc2svgToHarpnotes").$new(),this.dropboxclient=s(s(a(Mt,"Opal"),"DropboxJs"),"NilClient").$new(),this.systemstatus=l(["version","dropboxpathlist"],{version:a(Mt,"VERSION"),dropboxpathlist:[]}),this.commands=s(a(Mt,"CommandController"),"CommandStack").$new(),f(f(this.$methods(),"select",[],(($=function(t){$.$$s;return null==t&&(t=i),t["$=~"](/__ic.*/)}).$$s=this,$.$$arity=1,$)),"each",[],((h=function(t){var e=h.$$s||this;return null==t&&(t=i),e.$send(t)}).$$s=this,h.$$arity=1,h)),this.$setup_tune_preview(),this.$setup_harpnote_preview(),this.$setup_harpnote_player(),this.$setup_worker_listners(),b=this.$class().$get_uri(),_=function(){try{return b["$[]"]("parsed_search")["$[]"]("mode").$last()}catch(e){if(!t.rescue(e,[a(Mt,"StandardError")]))throw e;try{return"work"}finally{t.pop_exception()}}}(),this.$cleanup_localstorage(),this.$load_from_loacalstorage(),c(this.editor.$get_abc_part()["$empty?"]())&&this.$load_demo_tune(),c(this.systemstatus["$[]"]("view"))||this.$set_status(l(["dropbox","music_model","loglevel","autorefresh","view","mode"],{dropbox:"not connected",music_model:"unchanged",loglevel:u.log.$loglevel(),autorefresh:"off",view:0,mode:_})),this.$set_status(l(["mode"],{mode:_})),c(this.systemstatus["$[]"]("saveformat"))||this.$set_status(l(["saveformat"],{saveformat:"A3-A4"})),this.$get_current_template(),this.$handle_command("dreconnect"),m=function(){try{return b["$[]"]("parsed_search")["$[]"]("load")}catch(e){if(!t.rescue(e,[a(Mt,"StandardError")]))throw e;try{return i}finally{t.pop_exception()}}}(),c(m)&&this.$load_from_uri(b["$[]"]("parsed_search")["$[]"]("load")),this.systemstatus["$[]"]("mode")["$=="]("demo")?this.$handle_command("view 0"):(this.editor.$get_lyrics(),A=a(Mt,"LastRenderMonitor").$new(),c(A["$ok?"]())?c(b["$[]"]("parsed_search")["$[]"]("debug"))||this.$render_previews():(u.log.$error(a(Mt,"I18n").$t("last session failed. Did not render. Cleanup ABC, then render manually")),this.$call_consumers("error_alert"))),this.$setup_ui_listener(),this.$show_message_of_the_day()},_.$$arity=0),t.def(Bt,"$about_zupfnoter",m=function(){return"<p>"+a(Mt,"I18n").$t("Free software to create sheets for table harps")+"</p>\n         <table>\n          <tbody>\n          <tr><td>Zupfnoter:</td><td>"+a(Mt,"VERSION")+"</td></tr>\n          <tr><td>Worker:</td><td>"+this.worker_info["$[]"]("version")+'</td></tr>\n          <tr><td><a target="_blank" href="http://opalrb.com">Opal</a>:</td><td>'+a(Mt,"RUBY_ENGINE_VERSION")+"</td></tr>\n          <tr><td>Ruby:</td><td>"+a(Mt,"RUBY_VERSION")+'</td></tr>\n          <tr><td><a target="_blank" href="http://moinejf.free.fr/js/index.html">abc2svg</a>:</td><td>'+abc2svg.version+'</td></tr>\n          <tr><td><a target="_blank" href="https://wim.vree.org/js/xml2abc-js_index.html">xml2abc.js</a>:</td><td>'+xml2abc_VERSION+'</td></tr>\n          <tr><td><a target="_blank" href="https://parall.ax/products/jspdf">jsPDF</a>:</td><td>'+a(Mt,"JsPDF").$jspdfversion()+"</td></tr>\n         </tbody>\n        </table>\n        <p> "+a(Mt,"Time").$now().$year()+' Bernhard Weichel - info@zupfnoter.de</p>\n        <p><a target="_blank" href="https://www.zupfnoter.de">Website: https://www.zupfnoter.de</a></p>\n    '},m.$$arity=0),t.def(Bt,"$make_error_popup",y=function(){return null==u.log&&(u.log=i),r(r("<p>Wenn du nicht weiter kommmst, poste eine Anfrage ber Men 'Hilfe / support'</p><p>",u.log.$get_errors().$join("<br/>\n")),"</p>")},y.$$arity=0),t.def(Bt,"$call_consumers",g=function(t){var e,r,n,s,a,o,$,h,p,d,_,m,y,g,v,b,A,x,w,k;return this.systemstatus_consumers=l(["systemstatus","lock","unlock","localizedtexts","statusline","error_alert","play_start","play_stop","play_stopping","disable_save","enable_save","before_open","document_title","current_notes","settings_menu","extracts","harp_preview_size","render_status","show_config_tab","update_pdf_preview"],{systemstatus:[f(this,"lambda",[],(e=function(){var t=e.$$s||this;return null==t.systemstatus&&(t.systemstatus=i),update_systemstatus_w2ui(t.systemstatus.$to_n())},e.$$s=this,e.$$arity=0,e))],lock:[f(this,"lambda",[],(r=function(){r.$$s;return lockscreen()},r.$$s=this,r.$$arity=0,r))],unlock:[f(this,"lambda",[],(n=function(){n.$$s;return unlockscreen()},n.$$s=this,n.$$arity=0,n))],localizedtexts:[f(this,"lambda",[],(s=function(){var t=s.$$s||this;return update_localized_texts(t)},s.$$s=this,s.$$arity=0,s))],statusline:[],error_alert:[f(this,"lambda",[],(a=function(){var t=a.$$s||this;return null==u.log&&(u.log=i),c(u.log["$has_errors?"]())?window.update_error_status_w2ui(t.$make_error_popup()):i},a.$$s=this,a.$$arity=0,a))],play_start:[f(this,"lambda",[],(o=function(){o.$$s;return update_play_w2ui("start")},o.$$s=this,o.$$arity=0,o))],play_stop:[f(this,"lambda",[],($=function(){$.$$s;return update_play_w2ui("stop")},$.$$s=this,$.$$arity=0,$))],play_stopping:[f(this,"lambda",[],(h=function(){h.$$s;return update_play_w2ui("stopping")},h.$$s=this,h.$$arity=0,h))],disable_save:[f(this,"lambda",[],(p=function(){p.$$s;return disable_save()},p.$$s=this,p.$$arity=0,p))],enable_save:[f(this,"lambda",[],(d=function(){d.$$s;return enable_save()},d.$$s=this,d.$$arity=0,d))],before_open:[f(this,"lambda",[],(_=function(){_.$$s;return before_open()},_.$$s=this,_.$$arity=0,_))],document_title:[f(this,"lambda",[],(m=function(){var t=m.$$s||this;return null==t.document_title&&(t.document_title=i),document.title=t.document_title},m.$$s=this,m.$$arity=0,m))],current_notes:[f(this,"lambda",[],(y=function(){var t=y.$$s||this;return null==t.harpnote_player&&(t.harpnote_player=i),update_current_notes_w2ui(t.harpnote_player.$get_notes().$join(" "))},y.$$s=this,y.$$arity=0,y))],settings_menu:[f(this,"lambda",[],(g=function(){g.$$s;return null==u.settings&&(u.settings=i),update_settings_menu(u.settings.$to_n())},g.$$s=this,g.$$arity=0,g))],extracts:[f(this,"lambda",[],(v=function(){var t,e=v.$$s||this,r=i;return null==e.extracts&&(e.extracts=i),r=f(e.extracts,"map",[],((t=function(e,r){t.$$s;return null==e&&(e=i),null==r&&(r=i),l(["id","text"],{id:e,text:e+": "+r})}).$$s=e,t.$$arity=2,t)),set_extract_menu(r.$to_n()),e.$call_consumers("systemstatus")},v.$$s=this,v.$$arity=0,v))],harp_preview_size:[f(this,"lambda",[],(b=function(){var t=b.$$s||this;return null==t.harp_preview_size&&(t.harp_preview_size=i),set_harp_preview_size(t.harp_preview_size)},b.$$s=this,b.$$arity=0,b))],render_status:[f(this,"lambda",[],(A=function(){var t=A.$$s||this;return null==t.systemstatus&&(t.systemstatus=i),null==t.render_stack&&(t.render_stack=i),set_render_status(t.systemstatus["$[]"]("autorefresh")+" "+t.render_stack.$to_s())},A.$$s=this,A.$$arity=0,A))],show_config_tab:[f(this,"lambda",[],(x=function(){x.$$s;return show_config_tab()},x.$$s=this,x.$$arity=0,x))],update_pdf_preview:[f(this,"lambda",[],(w=function(){var t=w.$$s||this;return update_pdf_preview(t)},w.$$s=this,w.$$arity=0,w))]}),f(this.systemstatus_consumers["$[]"](t),"each",[],((k=function(t){k.$$s;return null==t&&(t=i),t.$call()}).$$s=this,k.$$arity=1,k))},g.$$arity=1),t.def(Bt,"$get_config_form_menu_entries",v=function(){return a(Mt,"ConfstackEditor").$get_config_form_menu_entries()},v.$$arity=0),t.def(Bt,"$get_decoration_menu_entries",b=function(){var t;return null==u.conf&&(u.conf=i),r([l(["id","text","icon","tooltip"],{id:"!fermata!",text:"Fermata",icon:"fa fa-bars",tooltip:r(a(Mt,"I18n").$t("insert decoration: "),"Fermata: 'H'")}),l(["id","text","icon","tooltip"],{id:"!breath!",text:a(Mt,"I18n").$t("Breath - interrupt Flowline"),icon:"fa fa-bars",tooltip:a(Mt,"I18n").$t("interrupts flowline after the note")}),l(["id","text","icon","tooltip"],{id:"!emphasis!",text:"Emphasis ",icon:"fa fa-bars",tooltip:r(a(Mt,"I18n").$t("insert decoration: "),"Emphasis: 'L'")}),l(["id","text","icon","tooltip"],{id:'"^#rit"',text:"rit",icon:"fa fa-bars",tooltip:a(Mt,"I18n").$t("insert Ritardando")}),l(["id","text","icon","tooltip"],{id:'"^#vb"',text:"Damper",icon:"fa fa-bars",tooltip:a(Mt,"I18n").$t("insert Damper below note")})],f(u.conf["$[]"]("layout.DECORATIIONS_AS_ANNOTATIONS"),"map",[],((t=function(e,r){t.$$s;return null==e&&(e=i),null==r&&(r=i),l(["id","text","icon"],{id:"!"+e+"!",text:"!"+e+"!: "+a(Mt,"I18n").$t("comes as")+" '"+r["$[]"]("text")+"'",icon:"fa fa-bars"})}).$$s=this,t.$$arity=2,t)))},b.$$arity=0),t.def(Bt,"$handle_command",A=function(e){var r=i;null==u.log&&(u.log=i),u.log.$clear_errors();try{u.log.$timestamp_start(),u.log.$timestamp(e),this.commands.$run_string(e)}catch(n){if(!t.rescue(n,[a(Mt,"Exception")]))throw n;r=n;try{u.log.$error(r.$message()+' in command "'+e+'"',i,i,r.$backtrace())}finally{t.pop_exception()}}return this.$call_consumers("error_alert")},A.$$arity=1),t.def(Bt,"$handle_parsed_command",x=function(e,r){var n=i;null==u.log&&(u.log=i),u.log.$clear_errors();try{u.log.$timestamp_start(),u.log.$timestamp(e),this.commands.$run_parsed_command(e,this.$Native(r))}catch(r){if(!t.rescue(r,[a(Mt,"Exception")]))throw r;n=r;try{u.log.$error(n.$message()+' in command "'+e+'"',i,i,n.$backtrace())}finally{t.pop_exception()}}return this.$call_consumers("error_alert")},x.$$arity=2),t.def(Bt,"$save_to_localstorage",w=function(){var t,e;return e=f(this.systemstatus,"select",[],(t=function(e,r){t.$$s;return null==e&&(e=i),null==r&&(r=i),["last_read_info_id","zndropboxlogincmd","music_model","view","autorefresh","loglevel","nwworkingdir","dropboxapp","dropboxpath","dropboxpathlist","dropboxloginstate","perspective","saveformat","zoom"]["$include?"](e)},t.$$s=this,t.$$arity=2,t)).$to_json(),this.systemstatus["$[]"]("mode")["$=="]("work")&&localStorage.setItem("systemstatus",e),this.editor.$save_to_localstorage()},w.$$arity=0),t.def(Bt,"$push_to_dropboxpathlist",k=function(){var t,e=i;return(e=c(t=this.$systemstatus()["$[]"]("dropboxpathlist"))?t:[]).$push(this.dropboxpath),e=e.$uniq().$last(10),this.$set_status(l(["dropboxpathlist"],{dropboxpathlist:e}))},k.$$arity=0),t.def(Bt,"$load_from_uri",E=function(t){var e,r,n;return f(f(f(a(Mt,"HTTP").$get(t),"then",[],((e=function(t){var r=e.$$s||this;return null==r.editor&&(r.editor=i),null==t&&(t=i),r.editor.$set_text(t.$body())}).$$s=this,e.$$arity=1,e)),"fail",[],((r=function(e){var n=r.$$s||this;return null==e&&(e=i),n.$alert("could not load from URL: "+t)}).$$s=this,r.$$arity=1,r)),"always",[],((n=function(t){n.$$s;return null==t&&(t=i),i}).$$s=this,n.$$arity=1,n))},E.$$arity=1),t.def(Bt,"$load_from_loacalstorage",S=function(){var t;return this.editor.$restore_from_localstorage(),t=a(Mt,"JSON").$parse(localStorage.getItem("systemstatus")),c(t)&&this.$set_status(t),i},S.$$arity=0),t.def(Bt,"$cleanup_localstorage",N=function(){var t,e,r=i;return e=Object.keys(localStorage),r=f(e,"select",[],((t=function(e){t.$$s;return null==e&&(e=i),e.$match(/dropbox\-auth:default:/)}).$$s=this,t.$$arity=1,t)),c(r["$empty?"]())||(localStorage.removeItem(r.$first()),localStorage.removeItem("systemstatus")),localStorage.setItem("zupfnoterVersion",a(Mt,"VERSION")),i},N.$$arity=0),t.def(Bt,"$get_chordnotes",I=function(t){return a(Mt,"Chordengine").$new("C").$chordnotes(t)},I.$$arity=1),t.def(Bt,"$get_chords_for",C=function(t){var e;return e=t,a(Mt,"Chordengine").$new("C").$chordfor(e)},C.$$arity=1),t.def(Bt,"$get_chords_for_string",O=function(t){var e;return e=this.$scan_notesstring(t),this.$get_chords_for(e)},O.$$arity=1),t.def(Bt,"$scan_notesstring",B=function(t){var e;return f(t.$scan(/([a-gA-G])([#b])?/),"map",[],((e=function(t){e.$$s;return null==t&&(t=i),""+t.$first().$upcase()+t.$last()}).$$s=this,e.$$arity=1,e))},B.$$arity=1),t.def(Bt,"$play_chord",M=function(t){var e,n,s=i;return this.$call_consumers("play_start"),s=a(Mt,"Chordengine").$new("C"),n=f(s.$tomidi(s.$chordnotes(t,"#")),"map",[],((e=function(t){e.$$s;return null==t&&(t=i),r(t,60)}).$$s=this,e.$$arity=1,e)),this.harpnote_player.$play_pitches(n)},M.$$arity=1),t.def(Bt,"$play_chordnotes",P=function(t){var e,n,s,o=i;return this.$call_consumers("play_start"),n=this.$scan_notesstring(t),o=a(Mt,"Chordengine").$new("C"),s=f(o.$tomidi(n).$compact(),"map",[],((e=function(t){e.$$s;return null==t&&(t=i),r(t,60)}).$$s=this,e.$$arity=1,e)),this.harpnote_player.$play_pitches(s)},P.$$arity=1),t.def(Bt,"$load_demo_tune",F=function(){var t;return"public/demos/zndemo_42_Ich_steh_an_deiner_krippen_hier.abc",f(a(Mt,"HTTP"),"get",["public/demos/zndemo_42_Ich_steh_an_deiner_krippen_hier.abc",l(["async"],{async:!1})],((t=function(e){var r=t.$$s||this;return null==r.editor&&(r.editor=i),null==e&&(e=i),r.editor.$set_text(e.$body()),e.$body()}).$$s=this,t.$$arity=1,t))},F.$$arity=0),t.def(Bt,"$render_a3",L=function(r){var n,o,c=i;return null==u.settings&&(u.settings=i),null==r&&(r=this.systemstatus["$[]"]("view")),n=u.settings["$[]"]("flowconf"),c=["flowconf",!1],f(u.settings,"[]=",t.to_a(c)),c[e(c.length,1)],o=s(a(Mt,"Harpnotes"),"PDFEngine").$new().$draw(this.$layout_harpnotes(r,"A3")),c=["flowconf",n],f(u.settings,"[]=",t.to_a(c)),c[e(c.length,1)],o},L.$$arity=-1),t.def(Bt,"$render_a4",T=function(r){var n,o,c=i;return null==u.settings&&(u.settings=i),null==r&&(r=this.systemstatus["$[]"]("view")),n=u.settings["$[]"]("flowconf"),c=["flowconf",!1],f(u.settings,"[]=",t.to_a(c)),c[e(c.length,1)],o=s(a(Mt,"Harpnotes"),"PDFEngine").$new().$draw_in_segments(this.$layout_harpnotes(r,"A4")),c=["flowconf",n],f(u.settings,"[]=",t.to_a(c)),c[e(c.length,1)],o},T.$$arity=-1),t.def(Bt,"$migrate_config",j=function(r){var n,s=i,o=i,$=i,h=i,p=i,d=i;return null==u.version&&(u.version=i),s=a(Mt,"Confstack").$new(!1),o=[!1],f(s,"strict=",t.to_a(o)),o[e(o.length,1)],$=a(Mt,"Confstack").$new(!1),o=[!1],f($,"strict=",t.to_a(o)),o[e(o.length,1)],$.$push(r.$clone()),s.$push(r),c(r["$[]"]("extract"))&&(h=this.$migrate_config_lyrics(s),s.$push(h),p=this.$migrate_notes(s),s.$push(p)),o=["$schema",a(Mt,"SCHEMA_VERSION")],f(s,"[]=",t.to_a(o)),o[e(o.length,1)],n=this.$migrate_config_cleanup(s.$get()),d=$.$get()["$=="](n)?l(["changed","message","oldversion"],{changed:!1,message:"",oldversion:$["$[]"](u.version)}):l(["changed","message","oldversion"],{changed:!0,message:a(Mt,"I18n").$t(a(Mt,"I18n").$t("Please double check the generated sheets.\n\nYour abc file was automatically migrated\nto Zupfnoter version"))+" "+a(Mt,"VERSION"),oldversion:$["$[]"]("$version")}),o=["$version",a(Mt,"VERSION")],f(n,"[]=",t.to_a(o)),o[e(o.length,1)],[n,d]},j.$$arity=1),t.def(Bt,"$migrate_config_cleanup",R=function(t){var e;return c(t["$[]"]("extract"))&&f(t["$[]"]("extract"),"each",[],((e=function(t,r){e.$$s;var n=i;return null==t&&(t=i),null==r&&(r=i),n=r["$[]"]("lyrics"),c(n)?n.$delete("versepos"):i}).$$s=this,e.$$arity=2,e)),t},R.$$arity=1),t.def(Bt,"$migrate_config_lyrics",D=function(n){var s,a;return a=f(n["$[]"]("extract"),"inject",[l([],{})],((s=function(n,a){var o,u=s.$$s||this,$=i,h=i,p=i;return null==n&&(n=i),null==a&&(a=i),$=a.$last()["$[]"]("lyrics"),c($)&&($=$["$[]"]("versepos")),c($)&&(h=f($,"inject",[l([],{})],((o=function(n,s){var a,c,u,$=o.$$s||this;return null==n&&(n=i),null==s&&(s=i),c=f(s.$first().$gsub(","," ").$split(" "),"map",[],((a=function(t){a.$$s;return null==t&&(t=i),t.$to_i()}).$$s=$,a.$$arity=1,a)),u=[r(n.$count(),1).$to_s(),l(["verses","pos"],{verses:c,pos:s.$last()})],f(n,"[]=",t.to_a(u)),e(u.length,1),n}).$$s=u,o.$$arity=2,o)),p=[a.$first(),l(["lyrics"],{lyrics:h})],f(n,"[]=",t.to_a(p)),p[e(p.length,1)]),n}).$$s=this,s.$$arity=2,s)),l(["extract"],{extract:a})},D.$$arity=1),t.def(Bt,"$migrate_notes",z=function(n){var s,o;return o=f(n["$[]"]("extract"),"inject",[l([],{})],((s=function(n,o){var u,$=s.$$s||this,h=i,p=i,d=i;return null==n&&(n=i),null==o&&(o=i),h=o.$last()["$[]"]("notes"),c(h["$is_a?"](a(Mt,"Array")))&&(p=f(h,"inject",[l([],{})],((u=function(n,s){var a;u.$$s;return null==n&&(n=i),null==s&&(s=i),a=[r(n.$count(),1).$to_s(),s],f(n,"[]=",t.to_a(a)),e(a.length,1),n}).$$s=$,u.$$arity=2,u)),d=[o.$first(),l(["notes"],{notes:p})],f(n,"[]=",t.to_a(d)),d[e(d.length,1)]),n}).$$s=this,s.$$arity=2,s)),l(["extract"],{extract:o})},z.$$arity=1),t.def(Bt,"$play_abc",U=function(t){var e,r,n=i;return null==t&&(t="music_model"),n=c(this.systemstatus["$[]"]("harpnotes_dirty"))?this.$render_previews():a(Mt,"Promise").$new().$resolve(),f(f(n,"then",[],((e=function(){var r,n=e.$$s||this;return f(a(Mt,"Promise").$new(),"tap",[],((r=function(e){var n=r.$$s||this;return null==n.harpnote_player&&(n.harpnote_player=i),null==e&&(e=i),c(n.harpnote_player["$is_playing?"]())?(n.$call_consumers("play_stopping"),n.$stop_play_abc()):c(n.harpnote_player["$is_stopped?"]())&&(n.$call_consumers("play_start"),t["$=="]("auto")&&n.harpnote_player.$play_auto(),t["$=="]("music_model")&&n.harpnote_player.$play_song(),t["$=="]("selection")&&n.harpnote_player.$play_selection(),t["$=="]("selection_ff")&&n.harpnote_player.$play_from_selection()),e.$resolve()}).$$s=n,r.$$arity=1,r))}).$$s=this,e.$$arity=0,e)),"fail",[],((r=function(t){var e=r.$$s||this;return null==u.log&&(u.log=i),null==t&&(t=i),u.log.$error("bug: Error in player "+t,"./controller.rb".$force_encoding("US-ASCII"),624),e.$call_consumers("error_alert")}).$$s=this,r.$$arity=1,r))},U.$$arity=-1),t.def(Bt,"$stop_play_abc",q=function(){return this.harpnote_player.$stop()},q.$$arity=0),t.def(Bt,"$render_tunepreview_in_uithread",H=function(){var e,r=i,n=i;null==u.log&&(u.log=i),this.$set_active("#tunePreview"),this.$setup_tune_preview();try{r=this.$tweak_abc_text(),f(u.log,"benchmark",["render tune preview"],((e=function(){var t,n=e.$$s||this;return null==n.tune_preview_printer&&(n.tune_preview_printer=i),null==n.editor&&(n.editor=i),t=n.tune_preview_printer.$compute_tune_preview(r,n.editor.$get_checksum()),n.tune_preview_printer.$set_svg(t),n.$set_inactive("#tunePreview")}).$$s=this,e.$$arity=0,e))}catch(e){if(!t.rescue(e,[a(Mt,"Exception")]))throw e;n=e;try{u.log.$error("Bug "+n.$message(),i,i,n.$backtrace())}finally{t.pop_exception()}}return i},H.$$arity=0),t.def(Bt,"$render_tunepreview__in_worker",Q=function(){var e,r=i,n=i;null==u.log&&(u.log=i),this.$set_active("#tunePreview"),this.$setup_tune_preview();try{r=this.$tweak_abc_text(),f(u.log,"benchmark",["render tune preview by worker"],((e=function(){var t=e.$$s||this;return null==t.worker_tunepreview&&(t.worker_tunepreview=i),null==t.editor&&(t.editor=i),t.worker_tunepreview.$post_named_message("compute_tune_preview",l(["abc","checksum"],{abc:r,checksum:t.editor.$get_checksum()}))}).$$s=this,e.$$arity=0,e))}catch(e){if(!t.rescue(e,[a(Mt,"Exception")]))throw e;n=e;try{u.log.$error("Bug "+n.$message(),i,i,n.$backtrace())}finally{t.pop_exception()}}return i},Q.$$arity=0),t.def(Bt,"$tweak_abc_text",Y=function(){var t,e=i;return e=this.editor.$get_abc_part(),f(e.$split("\n"),"map",[],(t=function(e){var r,n=t.$$s||this,s=i;return null==e&&(e=i),s=e,c(e["$start_with?"]("W:"))&&(s=f(s,"gsub",[/(\\?)(~)/],((r=function(t){r.$$s;return null==t&&(t=i),t["$[]"](0)["$=="]("\\")?t["$[]"](1):" "}).$$s=n,r.$$arity=1,r))),s},t.$$s=this,t.$$arity=1,t)).$join("\n")},Y.$$arity=0),t.def(Bt,"$render_harpnotepreview_in_worker",G=function(){var t;return null==u.log&&(u.log=i),f(u.log,"benchmark",["render_harpnotepreview_callback_by_worker"],((t=function(){var e=t.$$s||this;return null==e.worker&&(e.worker=i),null==e.systemstatus&&(e.systemstatus=i),null==e.editor&&(e.editor=i),null==u.settings&&(u.settings=i),null==u.resources&&(u.resources=i),e.$set_active("#harpPreview"),e.worker.$post_named_message("compute_harpnotes_preview",l(["settings","resources","systemstatus","uri","config_from_editor","page_format","abc_part_from_editor","checksum"],{settings:u.settings,resources:u.resources,systemstatus:e.systemstatus,uri:l(["hostname"],{hostname:e.$class().$get_uri()["$[]"]("hostname")}),config_from_editor:e.$get_config_from_editor(),page_format:"A3",abc_part_from_editor:e.editor.$get_abc_part(),checksum:e.editor.$get_checksum()}))}).$$s=this,t.$$arity=0,t)),i},G.$$arity=0),t.def(Bt,"$render_harpnotepreview_callback",V=function(){var e;return null==u.log&&(u.log=i),f(u.log,"benchmark",["render_harpnotepreview_callback"],((e=function(){var r,n,s=e.$$s||this,o=i;null==s.systemstatus&&(s.systemstatus=i),null==s.song_harpnotes&&(s.song_harpnotes=i),null==u.log&&(u.log=i);try{u.log.$debug("viewid: "+s.systemstatus["$[]"]("view")+" "+"./controller.rb".$force_encoding("US-ASCII")+" 706"),s.song_harpnotes=s.$layout_harpnotes(s.systemstatus["$[]"]("view"),"A3"),c(s.song_harpnotes)&&(f(u.log,"benchmark",["loading music to player"],((r=function(){var t=r.$$s||this;return null==t.harpnote_player&&(t.harpnote_player=i),null==t.music_model&&(t.music_model=i),null==t.song_harpnotes&&(t.song_harpnotes=i),t.harpnote_player.$load_song(t.music_model,t.song_harpnotes.$active_voices())}).$$s=s,r.$$arity=0,r)),f(u.log,"benchmark",["drawing preview sheet"],((n=function(){var t,e=n.$$s||this;return null==e.harpnote_preview_printer&&(e.harpnote_preview_printer=i),null==e.song_harpnotes&&(e.song_harpnotes=i),t=e.harpnote_preview_printer.$draw(e.song_harpnotes),e.harpnote_preview_printer.$set_svg(t),e.$harpnote_preview_printer().$draw(e.song_harpnotes),e.$set_inactive("#harpPreview")}).$$s=s,n.$$arity=0,n)),s.$set_status(l(["harpnotes_dirty"],{harpnotes_dirty:!1})))}catch(e){if(!t.rescue(e,[a(Mt,"Exception")]))throw e;o=e;try{u.log.$error("Bug "+o.$message(),i,i,o.$backtrace())}finally{t.pop_exception()}}return s.$set_status(l(["refresh"],{refresh:!1}))}).$$s=this,e.$$arity=0,e)),i},V.$$arity=0),t.def(Bt,"$render_previews",J=function(){var t;return null==u.log&&(u.log=i),a(Mt,"LastRenderMonitor").$new().$set_active(),this.$save_to_localstorage(),this.harpnote_preview_printer.$save_scroll_position(),this.editor.$resize(),u.log.$info("rendering"),this.$set_status(l(["harpnotes_dirty"],{harpnotes_dirty:!0})),u.log.$clear_errors(),u.log.$clear_annotations(),this.systemstatus["$[]"]("autorefresh")["$=="]("on")?this.$render_previews_in_worker():f(this.$render_previews_in_uithread(),"then",[],((t=function(){return(t.$$s||this).$call_consumers("update_pdf_preview")}).$$s=this,t.$$arity=0,t))},J.$$arity=0),t.def(Bt,"$render_previews_in_worker",X=function(){var t,e,n;return this.$render_tunepreview__in_worker(),f(f(f(a(Mt,"Promise").$new(),"tap",[],((t=function(e){t.$$s;return null==e&&(e=i),e.$resolve()}).$$s=this,t.$$arity=1,t)),"fail",[],((e=function(){return(e.$$s||this).$alert("fail")}).$$s=this,e.$$arity=0,e)),"then",[],((n=function(){var t,e,s=n.$$s||this;return f(f(a(Mt,"Promise").$new(),"tap",[],((t=function(e){var n=t.$$s||this;return null==n.harpnote_preview_printer&&(n.harpnote_preview_printer=i),null==n.render_stack&&(n.render_stack=i),null==e&&(e=i),n.harpnote_preview_printer.$clear(),n.render_stack.$push(r(n.render_stack.$count(),1)),n.$call_consumers("render_status"),n.render_stack.$size()["$=="](1)&&n.$render_harpnotepreview_in_worker(),e.$resolve()}).$$s=s,t.$$arity=1,t)),"fail",[],((e=function(){return(e.$$s||this).$alert("BUG - This should never happen in render Previews "+"./controller.rb".$force_encoding("US-ASCII")+" 779")}).$$s=s,e.$$arity=0,e))}).$$s=this,n.$$arity=0,n))},X.$$arity=0),t.def(Bt,"$render_previews_in_uithread",W=function(){var t,e,r,n;return this.$render_tunepreview_in_uithread(),f(f(f(f(a(Mt,"Promise").$new(),"tap",[],((t=function(e){t.$$s;return null==e&&(e=i),e.$resolve()}).$$s=this,t.$$arity=1,t)),"then",[],((e=function(){var t,r,n=e.$$s||this;return f(f(a(Mt,"Promise").$new(),"tap",[],((t=function(e){var r=t.$$s||this;return null==r.harpnote_preview_printer&&(r.harpnote_preview_printer=i),null==e&&(e=i),r.harpnote_preview_printer.$clear(),r.$set_active("#harpPreview"),setTimeout(function(){r.$render_harpnotepreview_callback(),e.$resolve()},0)}).$$s=n,t.$$arity=1,t)),"fail",[],((r=function(){return(r.$$s||this).$alert("BUG - This should never happen in render Previews "+"./controller.rb".$force_encoding("US-ASCII")+" 807")}).$$s=n,r.$$arity=0,r))}).$$s=this,e.$$arity=0,e)),"then",[],((r=function(){var t,e=r.$$s||this;return f(a(Mt,"Promise").$new(),"tap",[],((t=function(e){var r=t.$$s||this;return null==r.harpnote_preview_printer&&(r.harpnote_preview_printer=i),null==r.editor&&(r.editor=i),null==u.log&&(u.log=i),null==e&&(e=i),r.harpnote_preview_printer.$bind_elements(),r.$call_consumers("error_alert"),r.editor.$set_annotations(u.log.$annotations()),a(Mt,"LastRenderMonitor").$new().$clear(),e.$resolve()}).$$s=e,t.$$arity=1,t))}).$$s=this,r.$$arity=0,r)),"then",[],((n=function(){var t,e=n.$$s||this;return f(a(Mt,"Promise").$new(),"tap",[],((t=function(e){var r=t.$$s||this,n=i;return null==r.song_harpnotes&&(r.song_harpnotes=i),null==e&&(e=i),n=s(a(Mt,"Harpnotes"),"PDFEngine").$new(),r.pdf_preview_string=n.$draw(r.song_harpnotes).$output("datauristring"),e.$resolve()}).$$s=e,t.$$arity=1,t))}).$$s=this,n.$$arity=0,n))},W.$$arity=0),t.def(Bt,"$pdf_preview_string",K=function(){var t,e=i;return c(c(t=this.systemstatus["$[]"]("autorefresh"))?this.pdf_preview_string["$empty?"]()["$!"]():t)?this.pdf_preview_string:(e=s(a(Mt,"Harpnotes"),"PDFEngine").$new(),this.pdf_preview_string=e.$draw(this.song_harpnotes).$output("datauristring"))},K.$$arity=0),t.def(Bt,"$save_file",Z=function(){var t,e,r=i;return(r=s(a(Mt,"JSZip"),"ZipFile").$new()).$file("song.abc",this.editor.$get_text()),r.$file("harpnotes_a4.pdf",this.$render_a4().$output("blob")),r.$file("harpnotes_a3.pdf",this.$render_a3().$output("blob")),t=r.$to_blob(),e="song"+a(Mt,"Time").$now().$strftime("%d%m%Y%H%M%S")+".zip",window.saveAs(t,e)},Z.$$arity=0),t.def(Bt,"$layout_harpnotes",tt=function(r,n){var o,l,$,h=i,p=i;null==u.log&&(u.log=i),null==u.conf&&(u.conf=i),null==r&&(r=0),null==n&&(n="A4"),f(u.log,"benchmark",["transforming music model"],((o=function(){return(o.$$s||this).$load_music_model()}).$$s=this,o.$$arity=0,o)),u.image_list=function(){try{return u.conf.$get()["$[]"]("resources").$keys()}catch(e){if(!t.rescue(e,[a(Mt,"StandardError")]))throw e;try{return i}finally{t.pop_exception()}}}(),this.$set_extracts_menu();try{try{f(u.log,"benchmark",["validate default conf"],((l=function(){var t,e=l.$$s||this;return null==e.json_validator&&(e.json_validator=i),null==e.validation_errors&&(e.validation_errors=i),null==u.log&&(u.log=i),null==u.settings&&(u.settings=i),null==u.conf&&(u.conf=i),e.validation_errors=[],c(c(t=u.log.$loglevel()["$=="]("debug"))?t:u.settings["$[]"]("validate")["$=="]("true"))&&(e.validation_errors=e.json_validator.$validate_conf(u.conf)),e.validation_errors}).$$s=this,l.$$arity=0,l)),this.$call_consumers("document_title"),h=i,f(u.log,"benchmark",["computing layout"],(($=function(){var o=$.$$s||this,c=i,l=i;return null==o.music_model&&(o.music_model=i),c=s(s(a(Mt,"Harpnotes"),"Layout"),"Default").$new(),l=[o.$class().$get_uri()],f(c,"uri=",t.to_a(l)),l[e(l.length,1)],l=[o.$get_placeholder_replacers(r)],f(c,"placeholders=",t.to_a(l)),l[e(l.length,1)],h=c.$layout(o.music_model,i,r,n)}).$$s=this,$.$$arity=0,$)),this.editor.$set_annotations(u.log.$annotations())}catch(e){if(!t.rescue(e,[a(Mt,"Exception")]))throw e;p=e;try{u.log.$error("./controller.rb".$force_encoding("US-ASCII")+":883: "+p.$message(),i,i,p.$backtrace())}finally{t.pop_exception()}}}finally{u.conf.$pop()}return h},tt.$$arity=-1),t.def(Bt,"$get_placeholder_replacers",et=function(t){var e,r,n,s,o,$,h,p,d,_,m,y;return l(["composer","key","meter","number","o_key","tempo","title","extract_title","extract_filename","printed_extracts","watermark","current_year"],{composer:f(this,"lambda",[],(e=function(){var t=e.$$s||this;return null==t.music_model&&(t.music_model=i),t.music_model.$meta_data()["$[]"]("composer")},e.$$s=this,e.$$arity=0,e)),key:f(this,"lambda",[],(r=function(){var t=r.$$s||this;return null==t.music_model&&(t.music_model=i),t.music_model.$meta_data()["$[]"]("key")},r.$$s=this,r.$$arity=0,r)),meter:f(this,"lambda",[],(n=function(){var t=n.$$s||this;return null==t.music_model&&(t.music_model=i),t.music_model.$meta_data()["$[]"]("meter").$join(" ")},n.$$s=this,n.$$arity=0,n)),number:f(this,"lambda",[],(s=function(){var t=s.$$s||this;return null==t.music_model&&(t.music_model=i),t.music_model.$meta_data()["$[]"]("number")},s.$$s=this,s.$$arity=0,s)),o_key:f(this,"lambda",[],(o=function(){var t=o.$$s||this;return null==t.music_model&&(t.music_model=i),t.music_model.$meta_data()["$[]"]("o_key")},o.$$s=this,o.$$arity=0,o)),tempo:f(this,"lambda",[],($=function(){var t=$.$$s||this;return null==t.music_model&&(t.music_model=i),t.music_model.$meta_data()["$[]"]("tempo_display")},$.$$s=this,$.$$arity=0,$)),title:f(this,"lambda",[],(h=function(){var t=h.$$s||this;return null==t.music_model&&(t.music_model=i),t.music_model.$meta_data()["$[]"]("title")},h.$$s=this,h.$$arity=0,h)),extract_title:f(this,"lambda",[],(p=function(){p.$$s;return null==u.conf&&(u.conf=i),u.conf["$[]"]("extract."+t+".title")},p.$$s=this,p.$$arity=0,p)),extract_filename:f(this,"lambda",[],(d=function(){d.$$s;return null==u.conf&&(u.conf=i),u.conf["$[]"]("extract."+t+".filenamepart")},d.$$s=this,d.$$arity=0,d)),printed_extracts:f(this,"lambda",[],(_=function(){var t,e=_.$$s||this;return null==u.conf&&(u.conf=i),f(u.conf["$[]"]("produce"),"map",[],(t=function(e){t.$$s;return null==u.conf&&(u.conf=i),null==e&&(e=i),u.conf["$[]"]("extract."+e+".filenamepart")},t.$$s=e,t.$$arity=1,t)).$join(" ")},_.$$s=this,_.$$arity=0,_)),watermark:f(this,"lambda",[],(m=function(){var t;m.$$s;return null==u.settings&&(u.settings=i),c(t=u.settings["$[]"]("watermark"))?t:""},m.$$s=this,m.$$arity=0,m)),current_year:f(this,"lambda",[],(y=function(){y.$$s;return a(Mt,"Time").$now().$year().$to_s()},y.$$s=this,y.$$arity=0,y))})},et.$$arity=1),t.def(Bt,"$load_music_model",rt=function(){var r,n,o,c,l=i,$=i;return null==u.conf&&(u.conf=i),o=this.$get_config_from_editor(),u.conf.$reset_to(1),u.conf.$push(o),n=(l=s(s(a(Mt,"Harpnotes"),"Input"),"Abc2svgToHarpnotes").$new()).$transform(this.editor.$get_abc_part()),r=t.to_ary(n),this.music_model=null==r[0]?i:r[0],c=null==r[1]?i:r[1],this.abc_model=l.$abc_model(),$=[c],f(this.harpnote_player,"player_model_abc=",t.to_a($)),$[e($.length,1)],$=[this.editor.$get_checksum()],f(this.music_model,"checksum=",t.to_a($)),$[e($.length,1)],this.document_title=this.music_model.$meta_data()["$[]"]("filename")},rt.$$arity=0),t.def(Bt,"$get_config_from_editor",nt=function(){var e,r,n=i,s=i;return null==u.log&&(u.log=i),r=this.editor.$get_config_model(),n=null==(e=t.to_ary(r))[0]?i:e[0],s=null==e[1]?i:e[1],c(s)&&(r=this.$migrate_config(n),n=null==(e=t.to_ary(r))[0]?i:e[0],s=null==e[1]?i:e[1],c(s["$[]"]("changed"))&&(u.log.$info(s["$[]"]("message")),this.editor.$set_config_model(n,"{migrated config}",!0))),n},nt.$$arity=0),t.defs(Bt,"$get_uri",it=function(){var t=i;t=i,t=new URL(window.location.href);var e={};return t.search.substr(1).split("&").forEach(function(t){var r=t.split("="),n=r[0],i=r[1]&&decodeURIComponent(r[1]);(e[n]=e[n]||[]).push(i)}),t.parsed_search=e,this.$Native(t)},it.$$arity=0),t.def(Bt,"$highlight_abc_object_by_player_callback",st=function(t,e){var r,n,s=i,o=i;return s=a(Mt,"Element").$find("._"+t+"_"),c(e)?(s.$add_class("highlightplay"),this.tune_preview_printer.$scroll_into_view(s.$first()),o=f(s,"select",[],(r=function(t){r.$$s;return null==t&&(t=i),t["$has_class?"]("znref")},r.$$s=this,r.$$arity=1,r)).$last(),c(o)&&this.harpnote_preview_printer.$scroll_to_element(f(s,"select",[],(n=function(t){n.$$s;return null==t&&(t=i),t["$has_class?"]("znref")},n.$$s=this,n.$$arity=1,n)).$last())):s.$remove_class("highlightplay"),i},st.$$arity=2),t.def(Bt,"$highlight_abc_object",at=function(t){var r,n=i,s=i;return r=(n=this.$Native(t))["$[]"]("startChar"),(s=n["$[]"]("endChar"))["$=="](r)&&(s=e(s,5)),c(this.harpnote_player["$is_playing?"]())||(this.editor.$select_range_by_position(r,s,this.expand_selection),this.$call_consumers("current_notes")),this.tune_preview_printer.$range_highlight_more(n["$[]"]("startChar"),n["$[]"]("endChar")),this.harpnote_preview_printer.$range_highlight_more(n["$[]"]("startChar"),n["$[]"]("endChar"))},at.$$arity=1),t.def(Bt,"$unhighlight_abc_object",ot=function(t){var e=i;return e=this.$Native(t),this.tune_preview_printer.$range_unhighlight_more(e["$[]"]("startChar"),e["$[]"]("endChar")),this.harpnote_preview_printer.$range_unhighlight(e["$[]"]("startChar"),e["$[]"]("endChar"))},ot.$$arity=1),t.def(Bt,"$select_abc_object",ct=function(t){return this.$highlight_abc_object(t)},ct.$$arity=1),t.def(Bt,"$select_by_time_segments",lt=function(e){var r,n,s,a,o=i;return o=[],a=f(this.abc_model["$[]"]("voices"),"map",[],((r=function(t){r.$$s;return null==t&&(t=i),t["$[]"]("symbols")}).$$s=this,r.$$arity=1,r)),f(e,"each",[],((n=function(e){var r,s=n.$$s||this;return null==e&&(e=i),f(a,"each",[],((r=function(n){var s,a,l=r.$$s||this,u=i;return null==n&&(n=i),u=f(f(n,"select",[],((s=function(t){s.$$s;return null==t&&(t=i),[5,6,12,14]["$include?"](t["$[]"]("type"))["$!"]()}).$$s=l,s.$$arity=1,s)),"select",[],((a=function(r){a.$$s;return null==r&&(r=i),f(r["$[]"]("time"),"between?",t.to_a(e))}).$$s=l,a.$$arity=1,a)),c(u["$empty?"]())?i:o.$push([u.$first(),u.$last()])}).$$s=s,r.$$arity=1,r))}).$$s=this,n.$$arity=1,n)),f(o,"each",[],((s=function(t){var e=s.$$s||this;return null==e.editor&&(e.editor=i),null==t&&(t=i),t["$=="](o.$first())?e.editor.$select_range_by_position(t.$first()["$[]"]("istart"),t.$last()["$[]"]("iend")):e.editor.$select_add_range_by_position(t.$first()["$[]"]("istart"),t.$last()["$[]"]("iend"))}).$$s=this,s.$$arity=1,s))},lt.$$arity=1),t.def(Bt,"$get_selected_time_segments",ut=function(){var n,s=i;return null==u.log&&(u.log=i),s=this.editor.$get_selection_ranges(),u.log.$info(s.$to_json()),f(s,"map",[],((n=function(s){var o,l=n.$$s||this,$=i,h=i,p=i;return null==l.abc_model&&(l.abc_model=i),null==u.log&&(u.log=i),null==s&&(s=i),($=s.$to_a()).$first()["$=="]($.$last())||($=[$.$first(),e($.$last(),1)]),h=f(l.abc_model["$[]"]("voices"),"map",[],((o=function(e){var r,n=o.$$s||this;return null==e&&(e=i),f(e["$[]"]("symbols"),"select",[],((r=function(e){var n,s;r.$$s;return null==e&&(e=i),c(n=(c(s=e["$[]"]("iend")["$nil?"]())?s:e["$[]"]("istart")["$nil?"]())["$!"]())?c(s=f(e["$[]"]("istart"),"between?",t.to_a($)))?s:f(e["$[]"]("iend"),"between?",t.to_a($)):n}).$$s=n,r.$$arity=1,r))}).$$s=l,o.$$arity=1,o)).$flatten().$compact(),u.log.$info(h.$to_json()),c(h["$empty?"]())?(u.log.$error(a(Mt,"I18n").$t("your cursor is not within a voice")),p=[0,0]):p=[h.$first()["$[]"]("time"),e(r(h.$last()["$[]"]("time"),h.$last()["$[]"]("dur")),1)],p}).$$s=this,n.$$arity=1,n))},ut.$$arity=0),t.def(Bt,"$set_status",ft=function(r){var n=i;return null==u.log&&(u.log=i),this.systemstatus["$merge!"](r),u.log.$debug("sytemstatus: "+this.systemstatus.$to_s()+" "+"./controller.rb".$force_encoding("US-ASCII")+" 1109"),this.systemstatus["$[]"]("loglevel")["$=="](u.log.$loglevel())||(n=[this.systemstatus["$[]"]("loglevel")],f(u.log,"loglevel=",t.to_a(n)),n[e(n.length,1)]),this.$save_to_localstorage(),this.$call_consumers("systemstatus"),i},ft.$$arity=1),t.def(Bt,"$set_status_dropbox_status",$t=function(){return this.$set_status(l(["dropbox","dropboxapp","dropboxpath","dropboxloginstate"],{dropbox:this.dropboxclient.$app_name()+": "+this.dropboxpath,dropboxapp:this.dropboxclient.$app_id(),dropboxpath:this.dropboxpath,dropboxloginstate:this.dropboxloginstate}))},$t.$$arity=0),t.def(Bt,"$clear_status_dropbox_status",ht=function(){return this.$set_status(l(["dropbox","dropboxapp","dropboxpath","dropboxloginstate"],{dropbox:this.dropboxclient.$app_name()+": "+this.dropboxpath,dropboxapp:i,dropboxpath:i,dropboxloginstate:i}))},ht.$$arity=0),t.def(Bt,"$set_extracts_menu",pt=function(){var t;return null==u.log&&(u.log=i),f(u.log,"benchmark",["prepare extract menu"],((t=function(){var e,r=t.$$s||this,n=i;return null==u.conf&&(u.conf=i),n=u.conf["$[]"]("produce"),r.extracts=f(u.conf.$get("extract"),"inject",[[]],((e=function(t,r){var s,a;e.$$s;return null==t&&(t=i),null==r&&(r=i),s=r.$last().$dig("filenamepart"),a=""+(c(n["$include?"](r.$first().$to_i()))?"*  ":" ")+s+" "+r.$last()["$[]"]("title")+" ",t.$push([r.$first(),a])}).$$s=r,e.$$arity=2,e)),r.$call_consumers("extracts")}).$$s=this,t.$$arity=0,t))},pt.$$arity=0),t.def(Bt,"$setup_harpnote_preview",dt=function(){var t,e,n,o,u,h;return this.harpnote_preview_printer=s(a(Mt,"Harpnotes"),"SvgEngine").$new("harpPreview",10,10),this.$set_harppreview_size([2200,1400]),this.harpnote_preview_printer.$set_view_box(0,0,420,297),f(this.harpnote_preview_printer,"on_select",[],((t=function(e){var r=t.$$s||this;return null==e&&(e=i),r.$select_abc_object(e["$[]"]("origin"))}).$$s=this,t.$$arity=1,t)),f(this.harpnote_preview_printer,"on_drag_start",[],((e=function(t){e.$$s;return null==t&&(t=i),i}).$$s=this,e.$$arity=1,e)),f(this.harpnote_preview_printer,"on_drag_end",[],((n=function(t){var e,s,a=n.$$s||this,o=i;return null==a.editor&&(a.editor=i),null==a.config_form_editor&&(a.config_form_editor=i),null==t&&(t=i),s=t["$[]"]("conf_key"),o=t["$[]"]("conf_value_new"),c(o)||(o=f(t["$[]"]("conf_value")["$[]"]("pos").$zip(t["$[]"]("delta")),"map",[],((e=function(t){e.$$s;return null==t&&(t=i),r(t.$first(),t.$last())}).$$s=a,e.$$arity=1,e))),a.editor.$patch_config_part(s,o,"drag "+s),c(a.config_form_editor)?a.config_form_editor.$refresh_form():i}).$$s=this,n.$$arity=1,n)),f(this.harpnote_preview_printer,"on_mouseover",[],((o=function(t){o.$$s;return null==t&&(t=i),update_mouseover_status_w2ui(t["$[]"]("conf_key"))}).$$s=this,o.$$arity=1,o)),f(this.harpnote_preview_printer,"on_mouseout",[],((u=function(t){u.$$s;return null==t&&(t=i),update_mouseover_status_w2ui("")}).$$s=this,u.$$arity=1,u)),f(this.harpnote_preview_printer,"on_draggable_rightcklick",[],((h=function(t){var e,r=h.$$s||this,n=i;return null==t&&(t=i),n=[],c(t["$[]"]("conf_key"))&&n.$push(l(["id","text","icon"],{id:t["$[]"]("conf_key"),text:a(Mt,"I18n").$t("Edit Config"),icon:"fa fa-gear"})),f(t["$[]"]("more_conf_keys"),"each",[],((e=function(t){var r,s,a,o;e.$$s;return null==t&&(t=i),r=t["$[]"]("conf_key"),s=t["$[]"]("text"),a=t["$[]"]("icon"),o=t["$[]"]("value"),n.$push(l(["id","text","icon","value"],{id:r,text:s,icon:a,value:o}))}).$$s=r,e.$$arity=1,e)),$(t["$[]"]("element")).w2menu({items:n.$to_n(),onSelect:function(t){w2ui.layout_left_tabs.click("configtab"),null!=t.item.value&&r.$handle_command("cconf "+t.item.id+" "+t.item.value),r.$handle_command("editconf "+t.item.id.$gsub(/\.[^\.]+$/,"")),null!=t.item.value&&r.$handle_command("render")}}),!1}).$$s=this,h.$$arity=1,h))},dt.$$arity=0),t.def(Bt,"$setup_tune_preview",_t=function(){var t;return this.tune_preview_printer=s(a(Mt,"ABC2SVG"),"Abc2Svg").$new(a(Mt,"Element").$find("#tunePreview")),f(this.tune_preview_printer,"on_select",[],((t=function(e){var r=t.$$s||this;return null==e&&(e=i),r.$Native(e),r.$select_abc_object(e)}).$$s=this,t.$$arity=1,t))},_t.$$arity=0),t.def(Bt,"$setup_harpnote_player",mt=function(){var r;return this.harpnote_player=s(s(a(Mt,"Harpnotes"),"Music"),"HarpnotePlayer").$new(),r=[this],f(this.harpnote_player,"controller=",t.to_a(r)),r[e(r.length,1)]},mt.$$arity=0),t.def(Bt,"$set_harppreview_size",yt=function(t){return this.harp_preview_size=t,this.harpnote_preview_printer.$set_canvas(t),this.$call_consumers("harp_preview_size")},yt.$$arity=1),t.def(Bt,"$toggle_autorefresh",gt=function(){return this.systemstatus["$[]"]("autorefresh")["$=="]("on")?this.$handle_command("autorefresh off"):this.$handle_command("autorefresh on"),this.$call_consumers("render_status")},gt.$$arity=0),t.def(Bt,"$toggle_console",vt=function(){w2ui.layout.toggle("bottom",!0),this.editor.$resize()},vt.$$arity=0),t.def(Bt,"$show_console",bt=function(){w2ui.layout.show("bottom",!0),this.editor.$resize()},bt.$$arity=0),t.def(Bt,"$setup_worker_listners",At=function(){var r,n,s,o,$,h,p,d,_,m,y,g;return f(this.worker_tunepreview,"on_named_message",["compute_tune_preview"],((r=function(t){var e,n=r.$$s||this;return null==u.log&&(u.log=i),null==t&&(t=i),f(u.log,"benchmark",["preocessing reply from compute_tune_preview"],((e=function(){var r,n=e.$$s||this;return null==n.tune_preview_printer&&(n.tune_preview_printer=i),r=t["$[]"]("payload"),n.$set_inactive("#tunePreview"),n.tune_preview_printer.$set_svg(r)}).$$s=n,e.$$arity=0,e))}).$$s=this,r.$$arity=1,r)),f(this.worker,"on_named_message",["get_worker_info"],((n=function(t){var e=n.$$s||this;return null==t&&(t=i),e.worker_info=t["$[]"]("payload")}).$$s=this,n.$$arity=1,n)),f(this.worker,"on_named_message",["set_logger_status"],((s=function(t){var e=s.$$s||this;return null==e.editor&&(e.editor=i),null==u.log&&(u.log=i),null==t&&(t=i),e.editor.$set_annotations(u.log.$annotations())}).$$s=this,s.$$arity=1,s)),f(this.worker,"on_named_message",["compute_harpnotes_preview"],((o=function(t){var e,r=o.$$s||this;return null==u.log&&(u.log=i),null==t&&(t=i),f(u.log,"benchmark",["processing reply from compute_harpnotes_preview"],((e=function(){var r,n,s,o=e.$$s||this;return null==o.render_stack&&(o.render_stack=i),null==o.harpnote_preview_printer&&(o.harpnote_preview_printer=i),null==o.harp_preview_size&&(o.harp_preview_size=i),null==o.editor&&(o.editor=i),null==u.log&&(u.log=i),r=t["$[]"]("payload"),c((n=o.render_stack.$size(),s=1,"number"==typeof n&&"number"==typeof s?n<=s:n["$<="](s)))&&(o.harpnote_preview_printer.$set_svg(r),o.$set_harppreview_size(o.harp_preview_size),o.$set_status(l(["harpnotes_dirty"],{harpnotes_dirty:!1})),o.$set_status(l(["refresh"],{refresh:!1})),o.$set_inactive("#harpPreview"),a(Mt,"LastRenderMonitor").$new().$clear(),o.editor.$set_annotations(u.log.$annotations())),o.render_stack.$shift(),o.$call_consumers("render_status"),c(o.render_stack["$empty?"]())||(o.render_stack.$clear(),o.$render_previews()),i}).$$s=r,e.$$arity=0,e))}).$$s=this,o.$$arity=1,o)),f(this.worker,"on_named_message",["compute_pdf_preview"],(($=function(t){var e,r=$.$$s||this;return null==u.log&&(u.log=i),null==t&&(t=i),f(u.log,"benchmark",["preocessing reply from compute_pdf_preview"],((e=function(){var r=e.$$s||this;return r.pdf_preview_string=t["$[]"]("payload"),r.$call_consumers("update_pdf_preview")}).$$s=r,e.$$arity=0,e))}).$$s=this,$.$$arity=1,$)),f(this.worker,"on_named_message",["error_alert"],((h=function(t){var e=h.$$s||this;return null==t&&(t=i),e.$call_consumers("error_alert")}).$$s=this,h.$$arity=1,h)),f(this.worker,"on_named_message",["update_ui"],((p=function(t){var e=p.$$s||this;return null==t&&(t=i),e.extracts=t["$[]"]("payload")["$[]"]("extracts"),e.$call_consumers("extracts"),e.document_title=t["$[]"]("payload")["$[]"]("document_title"),e.$call_consumers("document_title")}).$$s=this,p.$$arity=1,p)),f(this.worker,"on_named_message",["load_player_model_abc"],((d=function(r){var n,s=d.$$s||this;return null==u.log&&(u.log=i),null==r&&(r=i),f(u.log,"benchmark",["preocessing reply from load_player_model_abc"],((n=function(){var s,a=n.$$s||this;return null==a.harpnote_player&&(a.harpnote_player=i),s=[JSON.parse(r["$[]"]("payload"))],f(a.harpnote_player,"player_model_abc=",t.to_a(s)),s[e(s.length,1)]}).$$s=s,n.$$arity=0,n))}).$$s=this,d.$$arity=1,d)),f(this.worker,"on_named_message",["load_player_from_worker"],((_=function(t){var e,r=_.$$s||this;return null==u.log&&(u.log=i),null==t&&(t=i),f(u.log,"benchmark",["preocessing reply from load_player_model"],((e=function(){var r=e.$$s||this;return null==r.harpnote_player&&(r.harpnote_player=i),r.harpnote_player.$set_worker_model(t["$[]"]("payload"))}).$$s=r,e.$$arity=0,e))}).$$s=this,_.$$arity=1,_)),f(this.worker,"on_named_message",["load_abc_model"],((m=function(t){var e,r=m.$$s||this;return null==u.log&&(u.log=i),null==t&&(t=i),f(u.log,"benchmark",["preocessing reply from load_abc_model"],((e=function(){return(e.$$s||this).abc_model=t["$[]"]("payload")}).$$s=r,e.$$arity=0,e))}).$$s=this,m.$$arity=1,m)),f(this.worker,"on_named_message",["log"],((y=function(t){y.$$s;return null==u.log&&(u.log=i),null==t&&(t=i),u.log.$log_from_worker(t["$[]"]("payload"))}).$$s=this,y.$$arity=1,y)),f(this.worker,"on_named_message",["rescue_from_worker_error"],((g=function(t){var e=g.$$s||this;return null==e.render_stack&&(e.render_stack=i),null==t&&(t=i),e.render_stack.$clear(),e.$call_consumers("error_alert"),e.$call_consumers("render_status")}).$$s=this,g.$$arity=1,g))},At.$$arity=0),t.def(Bt,"$setup_ui_listener",xt=function(){var t,e,n,s,o,$,p,d,_;return null==u.window&&(u.window=i),f(this.editor,"on_change",[],((t=function(e){var r=t.$$s||this;return null==e&&(e=i),r.$set_status(l(["music_model"],{music_model:"changed"})),r.$set_status(l(["harpnotes_dirty"],{harpnotes_dirty:!0})),r.$request_refresh(!0),i}).$$s=this,t.$$arity=1,t)),f(this.editor,"on_selection_change",[],((e=function(t){var r,n,s=e.$$s||this;return null==s.editor&&(s.editor=i),null==s.harpnote_preview_printer&&(s.harpnote_preview_printer=i),null==s.tune_preview_printer&&(s.tune_preview_printer=i),null==t&&(t=i),n=s.editor.$get_selection_ranges(),s.editor.$get_selection_info(),s.harpnote_preview_printer.$unhighlight_all(),s.tune_preview_printer.$unhighlight_all(),f(n,"each",[],((r=function(t){var e=r.$$s||this;return null==e.harpnote_preview_printer&&(e.harpnote_preview_printer=i),null==e.tune_preview_printer&&(e.tune_preview_printer=i),null==e.harpnote_player&&(e.harpnote_player=i),null==t&&(t=i),e.harpnote_preview_printer.$range_highlight_more(t.$first(),t.$last()),e.tune_preview_printer.$range_highlight_more(t.$first(),t.$last()),e.harpnote_player.$range_highlight(t.$first(),t.$last())}).$$s=s,r.$$arity=1,r))}).$$s=this,e.$$arity=1,e)),f(this.editor,"on_cursor_change",[],((n=function(t){var e,s=n.$$s||this,a=i,o=i,u=i,f=i,$=i;return null==s.editor&&(s.editor=i),null==t&&(t=i),s.$request_refresh(!1),a=s.editor.$get_selection_info(),e=s.editor.$get_selection_ranges(),u=(o=a["$[]"]("selection")).$first().$first()+":"+o.$first().$last(),o.$first()["$=="](o.$last())||(u=r(u," - "+o.$last().$first()+":"+o.$last().$last())),f=c(a["$[]"]("token"))?a["$[]"]("token"):l(["type","value"],{type:"",value:""}),$=l(["position","tokeninfo","token","selections"],{position:u,tokeninfo:f["$[]"]("type")+" ["+f["$[]"]("value")+"]",token:f,selections:e}),update_editor_status_w2ui($.$to_n())}).$$s=this,n.$$arity=1,n)),f(this.harpnote_player,"on_noteon",[],((s=function(t){var e=s.$$s||this;return null==u.settings&&(u.settings=i),null==t&&(t=i),u.settings["$[]"]("follow")["$=="]("false")?i:e.$highlight_abc_object_by_player_callback(t["$[]"]("startChar"),!0)}).$$s=this,s.$$arity=1,s)),f(this.harpnote_player,"on_noteoff",[],((o=function(t){var e=o.$$s||this;return null==u.settings&&(u.settings=i),null==t&&(t=i),u.settings["$[]"]("follow")["$=="]("false")?i:e.$highlight_abc_object_by_player_callback(t["$[]"]("startChar"),!1)}).$$s=this,o.$$arity=1,o)),f(this.harpnote_player,"on_songoff",[],(($=function(){var t=$.$$s||this;return t.$stop_play_abc(),t.$call_consumers("play_stop")}).$$s=this,$.$$arity=0,$)),f(u.window,"on",["mousedown"],((p=function(t){var e=p.$$s||this;return null==t&&(t=i),e.expand_selection=t.$shift_key(),!0}).$$s=this,p.$$arity=1,p)),f(a(Mt,"Element").$find("body"),"on",["keydown"],((d=function(t){var e,r,n=d.$$s||this,s=i;return null==n.editor&&(n.editor=i),null==n.zupfnoter_ui&&(n.zupfnoter_ui=i),null==t&&(t=i),c(t.$alt_key())?i:c(c(e=t.$meta_key())?e:t.$ctrl_key())?(s=t.$key_code(),"A".$ord()["$==="](s)?n.editor.$select_range_by_position(0,1e4):"R".$ord()["$==="](s)||13["$==="](s)?(t.$prevent(),n.$handle_command("render")):"S".$ord()["$==="](s)?(t.$prevent(),n.$handle_command("dsave")):"P".$ord()["$==="](s)?(t.$prevent(),n.$play_abc("auto")):"K".$ord()["$==="](s)?(t.$prevent(),n.$toggle_console()):"L".$ord()["$==="](s)?(n.zupfnoter_ui.toggle_full_screen(),t.$prevent()):function(t){for(var e=0,r=t.length;e<r;e++)if(t[e]["$==="](s))return!0;return!1}(f(h(0,9,!1),"map",[],((r=function(t){return r.$$s,null==t&&(t=i),t.$to_s().$ord()}).$$s=n,r.$$arity=1,r)))?(t.$prevent(),n.$handle_command("view "+t.$key_code().$chr())):i):i}).$$s=this,d.$$arity=1,d)),f(a(Mt,"Element").$find(window),"on",["storage"],((_=function(t){var e,r=_.$$s||this,n=i,s=i;return null==r.systemstatus&&(r.systemstatus=i),null==u.log&&(u.log=i),null==t&&(t=i),n=r.$Native(t["$[]"]("originalEvent")).$key(),s=r.$Native(t["$[]"]("originalEvent")).$newValue(),u.log.$debug("got storage event "+n+": "+s+" ("+"./controller.rb".$force_encoding("US-ASCII")+" 1497)"),c(c(e=r.systemstatus["$[]"]("autorefresh")["$=="]("remote")?n["$=="]("command"):r.systemstatus["$[]"]("autorefresh")["$=="]("remote"))?s["$=="]("render"):e)?r.$load_from_loacalstorage():i}).$$s=this,_.$$arity=1,_))},xt.$$arity=0),t.def(Bt,"$show_message_of_the_day",wt=function(){var t,e=this,r=i;r=[],t=e.info_url+"/feed/",$.get(t,function(t){$(t).find("item").each(function(){var t=$(this);r.push({title:t.find("title").text(),description:t.find("description").text(),link:t.find("link").text(),pubDate:t.find("pubDate").text(),postId:t.find("post-id").text()})}),e.$present_message_of_the_day(r)})},wt.$$arity=0),t.def(Bt,"$present_message_of_the_day",kt=function(t){var e,n,s,o,u,$,h,p,d,_,m=i,y=i;if(u=this.$Native(t.$first())["$[]"]("postId").$to_i(),$=c(e=this.$systemstatus()["$[]"]("last_read_info_id"))?e:0,h=f(this,"lambda",[],((n=function(){return(n.$$s||this).$set_status(l(["last_read_info_id"],{last_read_info_id:u}))}).$$s=this,n.$$arity=0,n)),p=f(this,"lambda",[],((s=function(){s.$$s;return i}).$$s=this,s.$$arity=0,s)),m=r(m='<h3><a href="'+this.info_url+'" target="_blank">'+a(Mt,"I18n").$t("read now")+"</a></h3>",f(t,"map",[],(o=function(t){var e,r=o.$$s||this,n=i;return null==t&&(t=i),e=(n=r.$Native(t))["$[]"]("postId"),n["$[]"]("description"),'<div style="text-align:left;"><p>'+e+": "+n["$[]"]("title")+"</p></div>"},o.$$s=this,o.$$arity=1,o)).$join()),y=l(["msg","title","width","height","modal","btn_yes","btn_no","callBack"],{msg:m,title:a(Mt,"I18n").$t("There is new unread information"),width:600,height:200,modal:!0,btn_yes:l(["text","class","style","callBack"],{text:a(Mt,"I18n").$t("already read"),class:"",style:"",callBack:h}),btn_no:l(["text","class","style","callBack"],{text:a(Mt,"I18n").$t("read later"),class:"",style:"",callBack:p}),callBack:i}),!c((d=u,_=$,"number"==typeof d&&"number"==typeof _?d>_:d["$>"](_))))return i;w2confirm(y.$to_n())},kt.$$arity=1),t.def(Bt,"$request_refresh",Et=function(t){var e,r=this,n=i;return c(t)&&r.$set_status(l(["refresh"],{refresh:!0})),c(r.refresh_timer["$empty?"]())||f(r.refresh_timer,"each",[],((e=function(t){var r=e.$$s||this;return null==r.refresh_timer&&(r.refresh_timer=i),null==t&&(t=i),clearTimeout(t),r.refresh_timer.$pop()}).$$s=r,e.$$arity=1,e)),c(r.systemstatus["$[]"]("refresh"))?(r.$stop_play_abc(),n=r.systemstatus["$[]"]("autorefresh"),"on"["$==="](n)?r.refresh_timer.$push(setTimeout(function(){r.$render_previews()},600)):"off"["$==="](n)?r.refresh_timer.$push(setTimeout(function(){r.$render_tunepreview_in_uithread()},600)):("remote"["$==="](n),i)):i},Et.$$arity=1),t.def(Bt,"$send_remote_command",St=function(t){return localStorage.setItem("command",""),localStorage.setItem("command",t)},St.$$arity=1),t.def(Bt,"$set_active",Nt=function(t){return a(Mt,"Element").$find(t).$add_class("spinner")},Nt.$$arity=1),t.def(Bt,"$set_inactive",It=function(t){return a(Mt,"Element").$find(t).$remove_class("spinner")},It.$$arity=1),t.def(Bt,"$check_suppoerted_browser",Ct=function(){var t=i,e=i;return null==u.log&&(u.log=i),c((t=["Chrome","Firefox","Vivaldi","Opera"])["$include?"](bowser.name))?i:(e=r(a(Mt,"I18n").$t("Unsupported browser. Please use one of "),t.$to_s()),u.log.$warning(e),alert(e))},Ct.$$arity=0),t.def(Bt,"$_init_conf",Ot=function(){return a(Mt,"InitConf").$init_conf()},Ot.$$arity=0),i&&"_init_conf"}(n[0],0,n)},Opal.modules["controller-cli"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}t.top;var n=[],i=t.nil,s=t.const_get_qualified,a=t.const_get_relative,o=(t.breaker,t.slice,t.klass),c=t.hash2,l=t.gvars,u=t.send,f=t.truthy,$=t.module,h=t.range;return t.add_stubs(["$attr_reader","$new","$loglevel=","$-","$info","$strict=","$push","$_init_conf","$set_text","$patch_config_part","$get_config_from_editor","$reset_to","$get","$create_engine","$transform","$get_abc_part","$abc_model","$get_checksum","$checksum=","$layout_harpnotes","$include?","$[]","$meta_data","$dig","$harpnote_options","$raise","$each","$output","$render_a3","$[]=","$t","$jspdfversion","$last","$split","$get_candidate_keys","$map","$join","$to_s","$first","$compact","$gsub","$length","$+","$reverse","$lambda","$_split_parts","$_clean_models","$each_with_index","$==","$start_with?","$_set_config_json","$_set_resources_json","$error"]),function(e,r,n){var i,s=o(e,null,"Controller");[s].concat(n);t.defs(s,"$get_uri",i=function(){return c(["hostname"],{hostname:"zupfnoter-cli"})},i.$$arity=0)}(n[0],0,n),function(r,n,$){var h,p,d,_,m,y,g,v=o(r,n,"CliController"),b=[v].concat($);v.$$prototype.editor=v.$$prototype.music_model=i,v.$attr_reader("abc_model"),t.def(v,"$initialize",h=function(){var r=i;return null==l.log&&(l.log=i),null==l.conf&&(l.conf=i),l.log=a(b,"NodeLogger").$new("x.log"),r=["warning"],u(l.log,"loglevel=",t.to_a(r)),r[e(r.length,1)],l.log.$info("Welcome to Zupfnoter"),l.log.$info("Zupfnoter "+a(b,"VERSION")),l.log.$info("Opal:     "+a(b,"RUBY_ENGINE_VERSION")),l.log.$info("Ruby:     "+a(b,"RUBY_VERSION")),l.log.$info("Abc2svg:  "+abc2svg.version),l.conf=a(b,"Confstack").$new(i),r=[!1],u(l.conf,"strict=",t.to_a(r)),r[e(r.length,1)],l.conf.$push(this.$_init_conf()),l.settings=c([],{}),this.editor=a(b,"TextPaneEmulatorForCli").$new(),this.json_validator=s(a(b,"Ajv"),"JsonValidator").$new()},h.$$arity=0),t.def(v,"$set_abc_input",p=function(t){return this.editor.$set_text(t)},p.$$arity=1),t.def(v,"$call_consumers",d=function(t){return i},d.$$arity=1),t.def(v,"$apply_config",_=function(t){return this.editor.$patch_config_part("",t,"from json file")},_.$$arity=1),t.def(v,"$load_music_model",m=function(){var r,n,o,c,f,$=i;return null==l.conf&&(l.conf=i),o=this.$get_config_from_editor(),l.conf.$reset_to(1),l.conf.$push(o),c=l.conf.$get("abc_parser"),n=($=s(s(a(b,"Harpnotes"),"Input"),"ABCToHarpnotesFactory").$create_engine(c)).$transform(this.editor.$get_abc_part()),r=t.to_ary(n),this.music_model=null==r[0]?i:r[0],this.player_model_abc=null==r[1]?i:r[1],this.abc_model=$.$abc_model(),f=[this.editor.$get_checksum()],u(this.music_model,"checksum=",t.to_a(f)),f[e(f.length,1)]},m.$$arity=0),t.def(v,"$produce_pdfs",y=function(r){var n,s,a,o=i,l=i;return this.$layout_harpnotes(),f(this.music_model.$meta_data()["$[]"]("filename")["$include?"]("{{"))?(!0,o=this.music_model.$harpnote_options().$dig("template","filebase"),f(o)||this.$raise("no filebase given for template"),l=[]):(l=this.music_model.$harpnote_options()["$[]"]("print"),o=this.music_model.$meta_data()["$[]"]("filename")),s=r,a=c([],{}),u(l,"each",[],((n=function(r){var c,l,f=n.$$s||this;return null==r&&(r=i),c=r["$[]"]("view_id"),l=[s+"/"+o+"_"+r["$[]"]("filenamepart")+"_a3.pdf",f.$render_a3(c).$output("raw")],u(a,"[]=",t.to_a(l)),e(l.length,1),i}).$$s=this,n.$$arity=1,n)),a},y.$$arity=1),t.def(v,"$about_zupfnoter",g=function(){return a(b,"I18n").$t("Free software to create sheets for table harps")+"\n          Zupfnoter: "+a(b,"VERSION")+"\n          Opal     : "+a(b,"RUBY_ENGINE_VERSION")+"\n          Ruby     : "+a(b,"RUBY_VERSION")+"\n          abc2svg  : "+abc2svg.version+"\n          jsPD     : "+a(b,"JsPDF").$jspdfversion()+"\n          Website  : https://www.zupfnoter.de\n    "},g.$$arity=0)}(n[0],a(n,"Controller"),n),function(n,s){var a,o,c,h,p,d,_=$(n,"I18n");[_].concat(s);t.defs(_,"$t",a=function(t){return t},a.$$arity=1),t.defs(_,"$t_key",o=function(t){return this.$t(t.$split(".").$last())},o.$$arity=1),t.defs(_,"$t_help",c=function(t){var e,r,n,s=i,a=i;return s=this.$get_candidate_keys(t),a=u(s,"map",[],((e=function(t){e.$$s;return null==l.conf_helptext&&(l.conf_helptext=i),null==t&&(t=i),l.conf_helptext["$[]"](t.$join("."))}).$$s=this,e.$$arity=1,e)),s=u(s,"map",[],(r=function(t){r.$$s;return null==t&&(t=i),t.$join(".")},r.$$s=this,r.$$arity=1,r)).$to_s(),"<h2>"+t+'</h2><div style="padding:0.5em;width:30em;">'+(f(n=a.$compact().$first())?n:"no help for "+s)+"</div>"},c.$$arity=1),t.defs(_,"$get_candidate_keys",h=function(n){var s,a,o,c,f,$,h=i,p=i,d=i,_=i;return h=u(h=n,"gsub",[/^(extract\.)(\d+)(.*)$/],((s=function(){var t;s.$$s;return((t=l["~"])===i?i:t["$[]"](1))+"0"+((t=l["~"])===i?i:t["$[]"](3))}).$$s=this,s.$$arity=0,s)),h=u(h,"gsub",[/^(extract\.0\.lyrics\.)(\d+)(.*)$/],((a=function(){var t;a.$$s;return((t=l["~"])===i?i:t["$[]"](1))+"0"+((t=l["~"])===i?i:t["$[]"](3))}).$$s=this,a.$$arity=0,a)),h=u(h,"gsub",[/^(extract\.0\.images\.)(\d+)(.*)$/],((o=function(){var t;o.$$s;return((t=l["~"])===i?i:t["$[]"](1))+"0"+((t=l["~"])===i?i:t["$[]"](3))}).$$s=this,o.$$arity=0,o)),h=u(h,"gsub",[/^(extract\.0\.notes\.)([a-zA-SU-Z_0-9]+)(.*)$/],((c=function(){var t;c.$$s;return((t=l["~"])===i?i:t["$[]"](1))+"0"+((t=l["~"])===i?i:t["$[]"](3))}).$$s=this,c.$$arity=0,c)),h=u(h,"gsub",[/^(extract\.0\.tuplet\.)([a-zA-SU-Z_0-9]+)(.*)$/],((f=function(){var t;f.$$s;return((t=l["~"])===i?i:t["$[]"](1))+"0"+((t=l["~"])===i?i:t["$[]"](3))}).$$s=this,f.$$arity=0,f)),p=h.$split("."),d=[],_=[],u(t.Range.$new(0,e(p.$length(),1),!1),"each",[],(($=function(e){$.$$s;return null==e&&(e=i),_.$push(p["$[]"](t.Range.$new(e,-1,!1)))}).$$s=this,$.$$arity=1,$)),r(_,d.$reverse())},h.$$arity=1),t.defs(_,"$locale",p=function(t){return i},p.$$arity=1),t.defs(_,"$phrases",d=function(){return i},d.$$arity=0)}(n[0],n),function(e,n,s){var c,$,p,d,_,m,y,g,v,b,A,x=o(e,n,"TextPaneEmulatorForCli"),w=[x].concat(s);return x.$$prototype.abc_part=x.$$prototype.config_separator=i,t.def(x,"$initialize",c=function(){var t;return this.abc_text=i,this.config_separator="%%%%zupfnoter",this.on_change=u(this,"lambda",[],((t=function(){t.$$s;return i}).$$s=this,t.$$arity=0,t)),this.config_undo=a(w,"UndoManager").$new()},c.$$arity=0),t.def(x,"$get_abc_part",$=function(){return this.abc_part},$.$$arity=0),t.def(x,"$set_text",p=function(t){return this.$_split_parts(t)},p.$$arity=1),t.def(x,"$_split_parts",d=function(t){var e;return this.$_clean_models(),u(t.$split(this.config_separator),"each_with_index",[],((e=function(t,n){var s=e.$$s||this;return null==l.log&&(l.log=i),null==t&&(t=i),null==n&&(n=i),n["$=="](0)?s.abc_part=t:f(t["$start_with?"](".config"))?s.$_set_config_json(t.$split(".config").$last(),"from loaded abc",!0):f(t["$start_with?"](".resources"))?s.$_set_resources_json(t.$split(".resources").$last()):l.log.$error(r(a(w,"I18n").$t("unsupported section found in abc file: "),t["$[]"](h(0,10,!1))))}).$$s=this,e.$$arity=2,e))},d.$$arity=1),t.def(x,"$_get_abc_from_editor",_=function(){return this.abc_part},_.$$arity=0),t.def(x,"$set_config_part",m=function(t){return i},m.$$arity=1),t.def(x,"$clear_markers",y=function(){return i},y.$$arity=0),t.def(x,"$set_markers",g=function(){return i},g.$$arity=0),t.def(x,"$set_annotations",v=function(){return i},v.$$arity=0),t.def(x,"$save_to_localstorage",b=function(t){return null==t&&(t=i),i},b.$$arity=-1),t.def(x,"$clean_localstorage",A=function(){return i},A.$$arity=0),i&&"clean_localstorage"}(n[0],s(a(n,"Harpnotes"),"TextPane"),n)},Opal.modules.confstack2=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}var n=t.top,i=[],s=t.nil,a=t.const_get_qualified,o=t.const_get_relative,c=(t.breaker,t.slice,t.klass),l=t.truthy,u=t.send,f=t.hash2,$=t.hash,h=t.range;return t.add_stubs(["$to_n","$duplicable?","$dup","$map","$to_proc","$each_pair","$===","$deep_dup","$[]=","$-","$delete","$deep_merge!","$[]","$is_a?","$deep_merge","$key?","$call","$inject","$respond_to?","$keys","$join","$compact","$push","$digkeys","$require","$attr_accessor","$+","$push_from_env","$first","$caller","$last","$count","$new","$get_from_env","$to_json","$push_to_env","$include?","$nil?","$parse","$pop","$get","$open","$puts","$to_yaml","$has_key?","$dig","$split","$!","$raise","$==","$_resolve_dependencies","$each","$each_with_index","$_get_one","$select","$to_i","$reverse","$private","$index","$class","$_resolve_value_dependency","$_resolve_hash_dependency","$_resolve_array_dependency"]),function(e,r,n){var i,s=c(e,null,"Object");[s].concat(n);t.def(s,"$duplicable?",i=function(){return!0},i.$$arity=0)}(i[0],0,i),function(e,r,n){var i,s=c(e,null,"NilClass");[s].concat(n);t.def(s,"$duplicable?",i=function(){return!1},i.$$arity=0)}(i[0],0,i),function(e,r,n){var i,s=c(e,null,"FalseClass");[s].concat(n);t.def(s,"$duplicable?",i=function(){return!1},i.$$arity=0)}(i[0],0,i),function(e,r,n){var i,s=c(e,null,"TrueClass");[s].concat(n);t.def(s,"$duplicable?",i=function(){return!1},i.$$arity=0)}(i[0],0,i),function(e,r,n){var i,s=c(e,null,"Symbol");[s].concat(n);t.def(s,"$duplicable?",i=function(){return!1},i.$$arity=0)}(i[0],0,i),function(e,r,n){var i,s=c(e,null,"Numeric");[s].concat(n);t.def(s,"$duplicable?",i=function(){return!1},i.$$arity=0)}(i[0],0,i),function(e,r,n){var i,s=c(e,null,"BigDecimal");[s].concat(n);t.def(s,"$duplicable?",i=function(){return!0},i.$$arity=0)}(i[0],0,i),function(e,r,n){var i,s=c(e,null,"Method");[s].concat(n);t.def(s,"$duplicable?",i=function(){return!1},i.$$arity=0)}(i[0],0,i),function(e,r,n){var i,s=c(e,null,"String");[s].concat(n);t.def(s,"$deep_dup",i=function(){return this.$to_n()},i.$$arity=0)}(i[0],0,i),function(e,r,n){var i,s=c(e,null,"Numerical");[s].concat(n);t.def(s,"$deep_dup",i=function(){return this.$to_n()},i.$$arity=0)}(i[0],0,i),function(e,r,n){var i,s=c(e,null,"Object");[s].concat(n);t.def(s,"$deep_dup",i=function(){return l(this["$duplicable?"]())?this.$dup():this},i.$$arity=0)}(i[0],0,i),function(e,r,n){var i,s=c(e,null,"Array");[s].concat(n);t.def(s,"$deep_dup",i=function(){return u(this,"map",[],"deep_dup".$to_proc())},i.$$arity=0)}(i[0],0,i),function(r,n,i){var f,$,h,p=c(r,null,"Hash"),d=[p].concat(i);t.def(p,"$deep_dup",f=function(){var r,n=s;return n=this.$dup(),u(this,"each_pair",[],((r=function(i,o){r.$$s;var c=s;return null==i&&(i=s),null==o&&(o=s),l(!!l(!1)&&a("::","String")["$==="](i))?(c=[i,o.$deep_dup()],u(n,"[]=",t.to_a(c)),c[e(c.length,1)]):(n.$delete(i),c=[i.$deep_dup(),o.$deep_dup()],u(n,"[]=",t.to_a(c)),c[e(c.length,1)])}).$$s=this,r.$$arity=2,r)),n},f.$$arity=0),t.def(p,"$deep_merge",$=function(t){var e=$.$$p,r=e||s;return e&&($.$$p=null),e&&($.$$p=null),u(this.$dup(),"deep_merge!",[t],r.$to_proc())},$.$$arity=1),t.def(p,"$deep_merge!",h=function(r){var n,i=h.$$p,a=i||s;return i&&(h.$$p=null),i&&(h.$$p=null),u(r,"each_pair",[],((n=function(r,i){var c,f,$=n.$$s||this,h=s;return null==r&&(r=s),null==i&&(i=s),h=$["$[]"](r),f=[r,l(l(c=h["$is_a?"](o(d,"Hash")))?i["$is_a?"](o(d,"Hash")):c)?u(h,"deep_merge",[i],a.$to_proc()):l((c=a!==s)?$["$key?"](r):a!==s)?a.$call(r,h,i):i],u($,"[]=",t.to_a(f)),f[e(f.length,1)]}).$$s=this,n.$$arity=2,n)),this},h.$$arity=1)}(i[0],0,i),function(e,r,n){var i,a,o=c(e,null,"Hash");[o].concat(n);t.def(o,"$dig",i=function(e){var r,n;return r=t.slice.call(arguments,0,arguments.length),u(r,"inject",[this],((n=function(t,e){n.$$s;return null==t&&(t=s),null==e&&(e=s),l(t["$respond_to?"]("keys"))?t["$[]"](e):s}).$$s=this,n.$$arity=2,n))},i.$$arity=-1),t.def(o,"$digkeys",a=function(t,e){var r;return null==t&&(t=[]),null==e&&(e=s),u(this.$keys(),"inject",[t],((r=function(t,n){var i,a=r.$$s||this;return null==t&&(t=s),null==n&&(n=s),i=[e,n].$compact().$join("."),t.$push(i),l(a["$[]"](n)["$respond_to?"]("keys"))&&a["$[]"](n).$digkeys(t,i),t}).$$s=this,r.$$arity=2,r))},a.$$arity=-1)}(i[0],0,i),n.$require("json"),function(n,i,a){var p,d,_,m,y,g,v,b,A,x,w,k,E,S,N,I,C,O,B=c(n,null,"Confstack"),M=[B].concat(a);return B.$$prototype.confstack_name=B.$$prototype.sourcestack=B.$$prototype.confstack=B.$$prototype.lookup_cache=B.$$prototype.strict=B.$$prototype.confresult_cache=B.$$prototype.callstack=s,function(t,e,r){[c(t,null,"DeleteMe")].concat(r)}(M[0],0,M),B.$attr_accessor("strict"),t.def(B,"$initialize",p=function(t){return null==t&&(t="default"),this.callstack=[],this.confstack=[f([],{})],this.lookup_cache=f([],{}),this.confresult_cache=f([],{}),this.sourcestack=[],this.strict=!0,l(t)&&(this.confstack_name=r("confstack__",t),this.$push(f(["confstack"],{confstack:f(["env"],{env:this.confstack_name})})),this.$push_from_env()),this},p.$$arity=-1),t.def(B,"$push",d=function(t){var e=s;return null==t&&(t=f([],{})),this.confresult_cache=f([],{}),this.lookup_cache=f([],{}),l(t["$is_a?"](o(M,"Hash")))&&(this.sourcestack.$push(this.$caller().$first()),e=this.confstack.$last().$deep_dup().$deep_merge(t),this.confstack.$push(e)),this.confstack.$count()},d.$$arity=-1),t.def(B,"$push_to_env",_=function(r){var n,i,a=s;return null==r&&(r=f([],{})),(a=o(M,"Confstack").$new(!1)).$push(this.$get_from_env()),a.$push(r),n=a["$[]"]().$to_json(),i=[this["$[]"]("confstack.env"),n],u(o(M,"ENV"),"[]=",t.to_a(i)),e(i.length,1),this.$push(r)},_.$$arity=-1),t.def(B,"$push_from_env",m=function(){return this.$push_to_env(this.$get_from_env())},m.$$arity=0),t.def(B,"$get_from_env",y=function(){var t=s,e=s;return t=f([],{}),l(this.$keys()["$include?"]("confstack.env"))&&(e=o(M,"ENV")["$[]"](this["$[]"]("confstack.env")),l(e["$nil?"]())||(t=o(M,"JSON").$parse(e))),t},y.$$arity=0),t.def(B,"$pop",g=function(){return this.lookup_cache=f([],{}),this.sourcestack.$pop(),this.confstack.$pop(),this.confstack.$count()},g.$$arity=0),t.def(B,"$reset_to",v=function(e){return this.lookup_cache=f([],{}),this.sourcestack=this.sourcestack["$[]"](t.Range.$new(0,e,!1)),this.confstack=this.confstack["$[]"](t.Range.$new(0,e,!1)),this.confstack.$count()},v.$$arity=1),t.def(B,"$save",b=function(t){var e,r,n=s;return n=this.$get(),u(o(M,"File"),"open",[t+".yaml","w"],((e=function(t){e.$$s;return null==t&&(t=s),t.$puts(n.$to_yaml())}).$$s=this,e.$$arity=1,e)),u(o(M,"File"),"open",[t+".json","w"],((r=function(t){r.$$s;return null==t&&(t=s),t.$puts(n.$to_json())}).$$s=this,r.$$arity=1,r))},b.$$arity=1),t.def(B,"$get",A=function(r,n){var i,a,o=s,c=s;return null==r&&(r=s),null==n&&(n=f(["resolve"],{resolve:!0})),l(r["$nil?"]())?o=this.confstack.$last():l(this.lookup_cache["$has_key?"](r))?o=this.lookup_cache["$[]"](r):(c=[r,o=u(this.confstack.$last(),"dig",t.to_a(r.$split(".")))],u(this.lookup_cache,"[]=",t.to_a(c)),c[e(c.length,1)],l(o)||l(l(i=l(a=o["$nil?"]())?this.$keys()["$include?"](r)["$!"]():a)?this.strict:i)&&this.$raise("confstack: key not available: "+r)),n["$[]"]("resolve")["$=="](!0)&&(o=this.$_resolve_dependencies(r,o)),o},A.$$arity=-1),t.alias(B,"[]","get"),t.def(B,"$each",x=function(){var t,e=x.$$p,r=e||s;return e&&(x.$$p=null),e&&(x.$$p=null),u(this.$keys(),"each",[],((t=function(e){var n=t.$$s||this;return null==e&&(e=s),r.$call(e,n["$[]"](e))}).$$s=this,t.$$arity=1,t))},x.$$arity=0),t.def(B,"$keys",w=function(){return this.confstack.$last().$digkeys()},w.$$arity=0),t.def(B,"$get_source",k=function(t){var e,r,n,i,a=s;return i=u(this.confstack.$each_with_index(),"map",[],((e=function(r,n){var i=e.$$s||this;return null==r&&(r=s),null==n&&(n=s),[i.$_get_one(r,t),n]}).$$s=this,e.$$arity=2,e)),a=u(i,"select",[],(r=function(t){r.$$s;return null==t&&(t=s),t.$first()["$nil?"]()["$!"]()},r.$$s=this,r.$$arity=1,r)).$last(),u(this.confstack,"map",[],(n=function(e,r){var i=n.$$s||this;return null==e&&(e=s),null==r&&(r=s),i.$_get_one(e,t)},n.$$s=this,n.$$arity=2,n)).$compact().$last(),this.sourcestack["$[]"](a.$last().$to_i())},k.$$arity=1),t.def(B,"$[]=",E=function(t,e){var r,n=s,i=s;return l(e["$=="](o(M,"DeleteMe")))?this.$delete(t):(n=t.$split(".").$reverse(),i=u(n,"inject",[e],((r=function(t,e){r.$$s;return null==t&&(t=s),null==e&&(e=s),$(e,t)}).$$s=this,r.$$arity=2,r)),this.$push(i))},E.$$arity=2),t.def(B,"$delete",S=function(e){var r=s;return r=e.$split("."),u(this.confstack.$last(),"dig",t.to_a(r["$[]"](h(0,-2,!1)))).$delete(r.$last())},S.$$arity=1),B.$private(),t.def(B,"$_resolve_value_dependency",N=function(n,i){var a,o=s,c=s,f=s;return l(this.confresult_cache["$has_key?"](i))?o=this.confresult_cache["$[]"](i):(l(this.callstack["$include?"](n))&&(c=this.callstack["$[]"](t.Range.$new(u(this.callstack,"index",[],((a=function(t){a.$$s;return null==t&&(t=s),t["$=="](n)}).$$s=this,a.$$arity=1,a)),-1,!1)),this.callstack=[],this.$raise("circular conf dependency: "+r(c,[n+" ..."]))),this.callstack.$push(n),o=i.$call(),this.callstack.$pop(),f=[n,o],u(this.confresult_cache,"[]=",t.to_a(f)),f[e(f.length,1)]),o},N.$$arity=2),t.def(B,"$_resolve_array_dependency",I=function(t,e){var r;return u(e,"map",[],((r=function(t){var e=r.$$s||this;return null==t&&(t=s),e.$_resolve_dependencies(s,t)}).$$s=this,r.$$arity=1,r))},I.$$arity=2),t.def(B,"$_resolve_hash_dependency",C=function(r,n){var i;return u(n,"inject",[f([],{})],((i=function(n,a){var o,c=i.$$s||this;return null==n&&(n=s),null==a&&(a=s),o=[a.$first(),c.$_resolve_dependencies([r,a.$first()],a.$last())],u(n,"[]=",t.to_a(o)),e(o.length,1),n}).$$s=this,i.$$arity=2,i))},C.$$arity=2),t.def(B,"$_resolve_dependencies",O=function(t,e){return e.$class()["$=="](o(M,"Proc"))&&(e=this.$_resolve_value_dependency(t,e)),e.$class()["$=="](o(M,"Hash"))&&(e=this.$_resolve_hash_dependency(t,e)),e.$class()["$=="](o(M,"Array"))&&(e=this.$_resolve_array_dependency(t,e)),e},O.$$arity=2),s&&"_resolve_dependencies"}(i[0],0,i)},Opal.modules["opal-abc2svg"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}t.top;var n=[],i=t.nil,s=(t.const_get_qualified,t.const_get_relative),a=(t.breaker,t.slice,t.module),o=t.klass,c=t.hash2,l=t.send,u=t.truthy,f=t.gvars;return t.add_stubs(["$attr_accessor","$lambda","$phrases","$set_callback","$error","$+","$[]","$===","$_anno_start","$_anno_stop","$push","$to_n","$unhighlight_all","$range_highlight_more","$nil?","$each","$get_elements_by_range","$find","$==","$scroll_into_view","$add_class","$remove_class","$id","$gsub","$t","$strip_js","$get_svg","$compute_tune_preview","$set_svg","$html","$debug","$parse","$join","$[]=","$-","$sort","$map","$>","$*","$first","$last","$private","$loglevel","$split","$inject","$length","$_mk_id","$stopPropagation","$Native","$call"]),function(n,$){var h=[a(n,"ABC2SVG")].concat($);!function(n,a,$){var h,p,d,_,m,y,g,v,b,A,x,w,k,E,S,N,I,C,O,B,M,P,F=o(n,null,"Abc2Svg"),L=[F].concat($);F.$$prototype.user=F.$$prototype.root=F.$$prototype.printer=F.$$prototype.abc_source=F.$$prototype.interactive_elements=F.$$prototype.player_model=F.$$prototype.abc_model=F.$$prototype.svgbuf=F.$$prototype.on_select=i,F.$attr_accessor("abcplay"),t.def(F,"$initialize",h=function(t,r){var n,a,o,$,h,p;return null==f.log&&(f.log=i),null==r&&(r=c(["mode"],{mode:"svg"})),this.on_select=l(this,"lambda",[],((n=function(t){n.$$s;return null==t&&(t=i),i}).$$s=this,n.$$arity=1,n)),this.printer=t,this.svgbuf=[],this.abc_source="",this.interactive_elements=c([],{}),this.abc_model=i,this.player_model=[],this.object_map=c([],{}),this.abcplay=i,this.user=c(["img_out","errmsg","read_file","annotate","page_format","keep_remark","textrans"],{img_out:i,errmsg:i,read_file:i,annotate:!0,page_format:!0,keep_remark:!0,textrans:s(L,"I18n").$phrases()}),l(this,"set_callback",["errmsg"],((a=function(t,r,n){a.$$s;return null==f.log&&(f.log=i),null==t&&(t=i),null==r&&(r=i),null==n&&(n=i),u(r)?f.log.$error(t,[e(r,1),e(n,1)]):f.log.$error(t)}).$$s=this,a.$$arity=3,a)),p=r["$[]"]("mode"),"svg"["$==="](p)?(l(this,"set_callback",["anno_start"],((o=function(t,e,r,n,s,a,c){var l=o.$$s||this;return null==t&&(t=i),null==e&&(e=i),null==r&&(r=i),null==n&&(n=i),null==s&&(s=i),null==a&&(a=i),null==c&&(c=i),l.$_anno_start(t,e,r,n,s,a,c)}).$$s=this,o.$$arity=7,o)),l(this,"set_callback",["anno_stop"],(($=function(t,e,r,n,s,a,o){var c=$.$$s||this;return null==t&&(t=i),null==e&&(e=i),null==r&&(r=i),null==n&&(n=i),null==s&&(s=i),null==a&&(a=i),null==o&&(o=i),c.$_anno_stop(t,e,r,n,s,a,o)}).$$s=this,$.$$arity=7,$)),l(this,"set_callback",["img_out"],((h=function(t){var e=h.$$s||this;return null==e.svgbuf&&(e.svgbuf=i),null==t&&(t=i),e.svgbuf.$push(t)}).$$s=this,h.$$arity=1,h))):"model"["$==="](p)||f.log.$error("BUG: unsupported mode for abc2svg"),this.root=new abc2svg.Abc(this.user.$to_n()),"\nI:titletrim 0\nI:measurenb 1\nI:contbarnb 1\nI:linewarn 0\nI:staffnonote 2\nI:stretchlast 1\n      ",this.root.tosvg("my_parameters","\nI:titletrim 0\nI:measurenb 1\nI:contbarnb 1\nI:linewarn 0\nI:staffnonote 2\nI:stretchlast 1\n      "),this.root},h.$$arity=-2),t.def(F,"$range_highlight",p=function(t,e){return this.$unhighlight_all(),this.$range_highlight_more(t,e),i},p.$$arity=2),t.def(F,"$scroll_into_view",d=function(t){if(u(t["$nil?"]()))return i;t.parents(".svg_block").get(0).scrollIntoView(!0)},d.$$arity=1),t.def(F,"$range_highlight_more",_=function(t,e){var r;return l(this.$get_elements_by_range(t,e),"each",[],((r=function(t){var e=r.$$s||this,n=i;return null==f.settings&&(f.settings=i),null==t&&(t=i),n=s(L,"Element").$find("#"+t),f.settings["$[]"]("autoscroll")["$=="]("false")||e.$scroll_into_view(n),n.$add_class("highlight")}).$$s=this,r.$$arity=1,r)),i},_.$$arity=2),t.def(F,"$range_unhighlight_more",m=function(t,e){var r;return l(this.$get_elements_by_range(t,e),"each",[],((r=function(t){r.$$s;return null==t&&(t=i),s(L,"Element").$find("#"+t).$remove_class("highlight")}).$$s=this,r.$$arity=1,r))},m.$$arity=2),t.def(F,"$unhighlight_all",y=function(){return s(L,"Element").$find("#"+this.printer.$id()+" .highlight").$remove_class("highlight")},y.$$arity=0),t.def(F,"$on_select",g=function(){var t=g.$$p,e=t||i;return t&&(g.$$p=null),t&&(g.$$p=null),this.on_select=e},g.$$arity=0),t.def(F,"$strip_js",v=function(t){var e;return null==f.log&&(f.log=i),e=t.$gsub(/(I:|%%)(beginjs|endjs)/,"% removed "),t["$=="](e)||f.log.$error(s(L,"I18n").$t("CAUTION: your abc-code is vulnerable !!! removed beginjs / endjs"),[1,1]),e},v.$$arity=1),t.def(F,"$compute_tune_preview",b=function(t,e){return null==e&&(e=""),"\n%%textoption right\n%%textfont * * 8\n%%text "+e,this.abc_source=this.$strip_js(t),this.interactive_elements=c([],{}),this.svgbuf=[],this.root.tosvg("abc",this.abc_source),c(["svg","interactive_elements"],{svg:this.$get_svg(),interactive_elements:this.interactive_elements})},b.$$arity=-2),t.def(F,"$draw",A=function(t,e){var r;return null==e&&(e=""),r=this.$compute_tune_preview(t,e=""),this.$set_svg(r)},A.$$arity=-2),t.def(F,"$set_svg",x=function(t){return this.interactive_elements=t["$[]"]("interactive_elements"),this.printer.$html(t["$[]"]("svg")),i},x.$$arity=1),t.def(F,"$get_abcmodel",w=function(t){var e;null==f.log&&(f.log=i),e=this.$strip_js(t),abc2svg.modules.load(e,function(){console.log("modules loaded")},function(t){f.log.$error(t)});var r=ToAudio();for(this.root.tosvg("abc",e),tunes=this.root.tunes.slice(0);tune=tunes.shift(),tune;){r.add(tune[0],tune[1]);var n=(new AbcJSON).gen_json(tune[0],tune[1],abc2svg.sym_name,tune[2])}return this.player_model=abc2svg.sndmem(this.root),f.log.$debug(n),this.abc_model=s(L,"JSON").$parse(n),[this.abc_model,this.player_model]},w.$$arity=1),t.def(F,"$get_svg",k=function(){return this.svgbuf.$join("\n").$gsub("<svg ",'<div class="svg_block"><svg ').$gsub("</svg>","</svg></div>")},k.$$arity=0),t.def(F,"$get_html",E=function(){return'\n      <html>\n      <head>\n        <meta charset="utf-8"/>\n        <style type="text/css">\n           rect.abcref {fill-opacity:0.0}\n          .nobrk s\t{ white-space:nowrap; }\n          svg {display:block}\n        </style>\n      </head>\n      <body>\n         '+this.printer.$html()+"\n      </body>\n      "},E.$$arity=0),t.def(F,"$set_callback",S=function(e){var n,s=S.$$p,a=s||i;return s&&(S.$$p=null),s&&(S.$$p=null),n=[e,a],l(this.user,"[]=",t.to_a(n)),n[r(n.length,1)]},S.$$arity=1),t.def(F,"$get_elements_by_range",N=function(t,e){var n,s=i,a=i;return s=[t,e].$sort(),a=[],l(this.interactive_elements,"each",[],((n=function(t,e){var o,c,f,$=n.$$s||this,h=i;return null==t&&(t=i),null==e&&(e=i),h=l(["startChar","endChar"],"map",[],(o=function(t){o.$$s;return null==t&&(t=i),e["$[]"](t)},o.$$s=$,o.$$arity=1,o)).$sort(),u(function(t,e){return"number"==typeof t&&"number"==typeof e?t>e:t["$>"](e)}((c=r(s.$first(),h.$last()),f=r(h.$first(),s.$last()),"number"==typeof c&&"number"==typeof f?c*f:c["$*"](f)),0))?a.$push(t):i}).$$s=this,n.$$arity=2,n)),a},N.$$arity=2),F.$private(),t.def(F,"$_callback_get_abcmodel_outdated",I=function(t,e,r,n){var a;return null==f.log&&(f.log=i),"",(new AbcMIDI).add(t,e),a=(new AbcJSON).gen_json(t,e,r,n),f.log.$loglevel()["$=="]("debug")&&f.log.$debug(a),this.abc_model=s(L,"JSON").$parse(a),this.abc_model},I.$$arity=4),t.def(F,"$_get_charpos",C=function(r,n,s){var a,o=i;return o=this.abc_source.$split("\n"),e(l(o["$[]"](t.Range.$new(0,n,!1)),"inject",[0],((a=function(t,r){a.$$s;return null==t&&(t=i),null==r&&(r=i),e(t,r.$length())}).$$s=this,a.$$arity=2,a)),s)},C.$$arity=3),t.def(F,"$_anno_start",O=function(t,e,r,n,s,a,o){var c;return c=this.$_mk_id(t,e,r),this.root.out_svg('<g class="'+c+'">\n'),i},O.$$arity=7),t.def(F,"$_clickabcnote",B=function(t,e){return this.$Native(t).$stopPropagation(),this.on_select.$call(this.interactive_elements["$[]"](e))},B.$$arity=2),t.def(F,"$_anno_stop",M=function(e,n,i,s,a,o,u){var f,$,h;return $="onclick=\"Opal.top.uicontroller.tune_preview_printer.$_clickabcnote(evt, '"+(f=this.$_mk_id(e,n,i))+"')\"",this.root.out_svg("</g>\n"),this.root.out_svg("<rect "+$+' class="abcref _'+n+'_" id="'+f+'" x="'),this.root.out_sxsy(s,'" y="',a),this.root.out_svg('" width="'+o.toFixed(2)+'" height="'+u.toFixed(2)+'"/>\n'),h=[f,c(["startChar","endChar"],{startChar:n,endChar:i})],l(this.interactive_elements,"[]=",t.to_a(h)),h[r(h.length,1)]},M.$$arity=7),t.def(F,"$_mk_id",P=function(t,e,r){return"_"+t+"_"+e+"_"+r+"_"},P.$$arity=3)}(h[0],0,h)}(n[0],n)},Opal.modules["version-prod"]=function(t){t.top;var e=[],r=(t.nil,t.const_get_qualified,t.const_get_relative);t.breaker,t.slice;return t.add_stubs(["$year","$now"]),t.const_set(e[0],"VERSION","V_1.14-59-g3f1ebb75"),t.const_set(e[0],"SCHEMA_VERSION","https://zupfnoter.weichel21.de/schema/zupfnoter-config_1.0.json"),t.const_set(e[0],"COPYRIGHT"," "+r(e,"Time").$now().$year()+" https://www.zupfnoter.de")},void 0===abc2svg)var abc2svg={};abc2svg.C={BLEN:1536,BAR:0,CLEF:1,CUSTOS:2,GRACE:4,KEY:5,METER:6,MREST:7,NOTE:8,PART:9,REST:10,SPACE:11,STAVES:12,STBRK:13,TEMPO:14,BLOCK:16,REMARK:17,FULL:0,EMPTY:1,OVAL:2,OVALBARS:3,SQUARE:4,SL_ABOVE:1,SL_BELOW:2,SL_AUTO:3,SL_HIDDEN:4,SL_DOTTED:8},abc2svg.sym_name=["bar","clef","custos","","grace","key","meter","Zrest","note","part","rest","yspace","staves","Break","tempo","","block","remark"],abc2svg.keys=[new Int8Array([-1,-1,-1,-1,-1,-1,-1]),new Int8Array([-1,-1,-1,0,-1,-1,-1]),new Int8Array([0,-1,-1,0,-1,-1,-1]),new Int8Array([0,-1,-1,0,0,-1,-1]),new Int8Array([0,0,-1,0,0,-1,-1]),new Int8Array([0,0,-1,0,0,0,-1]),new Int8Array([0,0,0,0,0,0,-1]),new Int8Array([0,0,0,0,0,0,0]),new Int8Array([0,0,0,1,0,0,0]),new Int8Array([1,0,0,1,0,0,0]),new Int8Array([1,0,0,1,1,0,0]),new Int8Array([1,1,0,1,1,0,0]),new Int8Array([1,1,0,1,1,1,0]),new Int8Array([1,1,1,1,1,1,0]),new Int8Array([1,1,1,1,1,1,1])],abc2svg.p_b40=new Int8Array([2,8,14,19,25,31,37]),abc2svg.b40_p=new Int8Array([0,0,0,0,0,0,1,1,1,1,1,1,2,2,2,2,2,3,3,3,3,3,3,4,4,4,4,4,4,5,5,5,5,5,5,6,6,6,6,6]),abc2svg.b40_a=new Int8Array([-2,-1,0,1,2,0,-2,-1,0,1,2,0,-2,-1,0,1,2,-2,-1,0,1,2,0,-2,-1,0,1,2,0,-2,-1,0,1,2,0,-2,-1,0,1,2]),abc2svg.b40_m=new Int8Array([-2,-1,0,1,2,0,0,1,2,3,4,0,2,3,4,5,6,3,4,5,6,7,0,5,6,7,8,9,0,7,8,9,10,11,0,9,10,11,12,13]),abc2svg.b40k=new Int8Array([36,1,2,3,8,2,2,7,8,13,14,2,8,13,14,19,20,13,14,19,20,25,2,19,24,25,30,31,2,25,30,31,36,37,2,31,36,37,38,3]),abc2svg.b40sf=new Int8Array([-2,-7,0,7,2,88,0,-5,2,-3,4,88,2,-3,4,-1,6,-3,4,-1,6,1,88,-1,-6,1,-4,3,88,1,-4,3,-2,5,88,3,-2,5,0,7]),abc2svg.isb40=new Int8Array([0,1,6,11,12,17,18,23,28,29,34,35]),abc2svg.ifb40=new Int8Array([0,5,6,11,12,17,22,23,28,29,34,39]),abc2svg.pab40=function(t,e){var r=40*((t+=19)/7|0)+abc2svg.p_b40[t%7];return e&&3!=e&&(r+=e),r},abc2svg.b40p=function(t){return 7*(t/40|0)+abc2svg.b40_p[t%40]-19},abc2svg.b40a=function(t){return abc2svg.b40_a[t%40]},abc2svg.b40m=function(t){return 12*(t/40|0)+abc2svg.b40_m[t%40]},abc2svg.pitcmp=function(t,e){return t.pit-e.pit},abc2svg.Abc=function(user){"use strict";var C=abc2svg.C,require=empty_function,system=empty_function,write=empty_function,XMLHttpRequest=empty_function,OPEN_BRACE=1,CLOSE_BRACE=2,OPEN_BRACKET=4,CLOSE_BRACKET=8,OPEN_PARENTH=16,CLOSE_PARENTH=32,STOP_BAR=64,FL_VOICE=128,OPEN_BRACE2=256,CLOSE_BRACE2=512,OPEN_BRACKET2=1024,CLOSE_BRACKET2=2048,MASTER_VOICE=4096,IN=96,CM=37.8,YSTEP=256,errs={bad_char:"Bad character '$1'",bad_grace:"Bad character in grace note sequence",bad_transp:"Bad transpose value",bad_val:"Bad value in $1",bar_grace:"Cannot have a bar in grace notes",ignored:"$1: inside tune - ignored",misplaced:"Misplaced '$1' in %%score",must_note:"!$1! must be on a note",must_note_rest:"!$1! must be on a note or a rest",nonote_vo:"No note in voice overlay",not_ascii:"Not an ASCII character",not_enough_n:"Not enough notes/rests for %%repeat",not_enough_m:"Not enough measures for %%repeat",not_enough_p:"Not enough parameters in %%map",not_in_tune:"Cannot have '$1' inside a tune"},self=this,glovar={meter:{type:C.METER,wmeasure:1,a_meter:[]}},info={},parse={ctx:{},prefix:"%",state:0,ottava:[],line:new scanBuf},tunes=[],psvg;function clone(t,e){if(!t)return t;var r=new t.constructor;for(var n in t)t.hasOwnProperty(n)&&(e&&"object"==typeof t[n]?r[n]=clone(t[n],e-1):r[n]=t[n]);return r}function errbld(t,e,r,n){var i,s,a,o,c;if(user.errbld){switch(t){case 0:t="warn";break;case 1:t="error";break;default:t="fatal"}user.errbld(t,e,r,n)}else{if(null!=n&&n>=0){for(i=a=0;!((s=parse.file.indexOf("\n",i))<0||s>n);)a++,i=s+1;o=n-i}switch(c="",r&&(c=r,a&&(c+=":"+(a+1)+":"+(o+1)),c+=" "),t){case 0:c+="Warning: ";break;case 1:c+="Error: ";break;default:c+="Internal bug: "}user.errmsg(c+e,a,o)}}function error(t,e,r,n,i,s,a){var o;!t&&cfmt.quiet||(user.textrans&&(o=user.textrans[r])&&(r=o),arguments.length>3&&(r=r.replace(/\$./g,function(t){switch(t){case"$1":return n;case"$2":return i;case"$3":return s;default:return a}})),e&&e.fname?errbld(t,r,e.fname,e.istart):errbld(t,r))}function scanBuf(){this.index=0,scanBuf.prototype.char=function(){return this.buffer[this.index]},scanBuf.prototype.next_char=function(){return this.buffer[++this.index]},scanBuf.prototype.get_int=function(){for(var t=0,e=this.buffer[this.index];e>="0"&&e<="9";)t=10*t+Number(e),e=this.next_char();return t}}function syntax(t,e,r,n,i,s){error(t,{fname:parse.fname,istart:parse.istart+parse.line.index},e,r,n,i,s)}function js_inject(js){/eval *\(|Function|setTimeout|setInterval/.test(js)?syntax(1,"Unsecure code"):eval('"use strict";\n'+js)}var dd_tb={},a_de,decos={dot:"0 stc 5 1 1",tenuto:"0 emb 5 3 3",slide:"1 sld 3 7 0",arpeggio:"2 arp 12 10 0",roll:"3 roll 7 6 6",fermata:"3 hld 10 7 7",emphasis:"3 accent 7 4 4",lowermordent:"3 lmrd 10 5 5",coda:"3 coda 24 10 10",uppermordent:"3 umrd 10 5 5",segno:"3 sgno 22 8 8",trill:"3 trl 14 5 5",upbow:"3 upb 10 5 5",downbow:"3 dnb 9 5 5",gmark:"3 grm 6 5 5",wedge:"0 wedge 7 3 3",turnx:"3 turnx 10 0 5",breath:"3 brth 0 1 20",longphrase:"3 lphr 0 1 1",mediumphrase:"3 mphr 0 1 1",shortphrase:"3 sphr 0 1 1",invertedfermata:"3 hld 10 7 7",invertedturn:"3 turn 10 0 5",invertedturnx:"3 turnx 10 0 5",0:"3 fng 8 3 3 0",1:"3 fng 8 3 3 1",2:"3 fng 8 3 3 2",3:"3 fng 8 3 3 3",4:"3 fng 8 3 3 4",5:"3 fng 8 3 3 5",plus:"3 dplus 7 3 3","+":"3 dplus 7 3 3",accent:"3 accent 7 4 4",">":"3 accent 7 4 4",marcato:"3 marcato 9 3 3","^":"3 marcato 9 3 3",mordent:"3 lmrd 10 5 5",open:"3 opend 10 3 3",snap:"3 snap 14 3 3",thumb:"3 thumb 14 3 3",dacapo:"3 dacs 16 20 20 Da Capo",dacoda:"3 dacs 16 20 20 Da Coda","D.C.":"3 dcap 16 10 10","D.S.":"3 dsgn 16 10 10","D.C.alcoda":"3 dacs 16 38 38 D.C. al Coda","D.S.alcoda":"3 dacs 16 38 38 D.S. al Coda","D.C.alfine":"3 dacs 16 38 38 D.C. al Fine","D.S.alfine":"3 dacs 16 38 38 D.S. al Fine",fine:"3 dacs 16 10 10 Fine",turn:"3 turn 10 0 5","trill(":"3 ltr 8 0 0","trill)":"3 ltr 8 0 0",f:"6 f 18 1 7",ff:"6 ff 18 2 10",fff:"6 fff 18 4 13",ffff:"6 ffff 18 6 16",mf:"6 mf 18 6 13",mp:"6 mp 18 6 16",p:"6 p 18 2 8",pp:"6 pp 18 5 14",ppp:"6 ppp 18 8 20",pppp:"6 pppp 18 10 25",pralltriller:"3 umrd 10 5 5",sfz:"6 sfz 18 4 10",ped:"4 ped 18 6 10","ped-up":"4 pedoff 12 4 4","ped(":"4 lped 20 1 1","ped)":"4 lped 20 1 1","crescendo(":"6 cresc 18 0 0","crescendo)":"6 cresc 18 0 0","<(":"6 cresc 18 0 0","<)":"6 cresc 18 0 0","diminuendo(":"6 dim 18 0 0","diminuendo)":"6 dim 18 0 0",">(":"6 dim 18 0 0",">)":"6 dim 18 0 0","-(":"8 gliss 0 0 0","-)":"8 gliss 0 0 0","~(":"8 glisq 0 0 0","~)":"8 glisq 0 0 0","8va(":"3 8va 10 0 0","8va)":"3 8va 10 0 0","8vb(":"4 8vb 10 0 0","8vb)":"4 8vb 10 0 0","15ma(":"3 15ma 10 0 0","15ma)":"3 15ma 10 0 0","15mb(":"4 15mb 10 0 0","15mb)":"4 15mb 10 0 0",invisible:"32 0 0 0 0",beamon:"33 0 0 0 0",trem1:"34 0 0 0 0",trem2:"34 0 0 0 0",trem3:"34 0 0 0 0",trem4:"34 0 0 0 0",xstem:"35 0 0 0 0",beambr1:"36 0 0 0 0",beambr2:"36 0 0 0 0",rbstop:"37 0 0 0 0","/":"38 0 0 6 6","//":"38 0 0 6 6","///":"38 0 0 6 6","beam-accel":"39 0 0 0 0","beam-rall":"39 0 0 0 0",stemless:"40 0 0 0 0",rbend:"41 0 0 0 0"},f_near=[!0,!0,!0],f_note=[!1,!1,!1,!0,!0,!0,!1,!1,!0],f_staff=[!1,!1,!1,!1,!1,!1,!0,!0];function y_get(t,e,r,n){var i,s=staff_tb[t],a=r/realwidth*YSTEP|0,o=(r+n)/realwidth*YSTEP|0;if(a<0&&(a=0),o>=YSTEP&&a>(o=YSTEP-1)&&(a=o),e)for(i=s.top[a++];a<=o;)i<s.top[a]&&(i=s.top[a]),a++;else for(i=s.bot[a++];a<=o;)i>s.bot[a]&&(i=s.bot[a]),a++;return i}function y_set(t,e,r,n,i){var s=staff_tb[t],a=r/realwidth*YSTEP|0,o=(r+n)/realwidth*YSTEP|0;if(a<0&&(a=0),o>=YSTEP&&a>(o=YSTEP-1)&&(a=o),e)for(;a<=o;)s.top[a]<i&&(s.top[a]=i),a++;else for(;a<=o;)s.bot[a]>i&&(s.bot[a]=i),a++}function up_p(t,e){switch(e){case C.SL_ABOVE:return!0;case C.SL_BELOW:return!1}return t.multi&&0!=t.multi?t.multi>0:!!t.p_v.have_ly&&t.pos.voc!=C.SL_ABOVE}function d_arp(t){var e,r,n,i=t.s,s=t.dd,a=5;if(i.type==C.NOTE)for(e=0;e<=i.nhd;e++){if(i.notes[e].acc)n=5+i.notes[e].shac;else switch(n=6-i.notes[e].shhd,i.head){case C.SQUARE:n+=3.5;break;case C.OVALBARS:case C.OVAL:n+=2}n>a&&(a=n)}(r=3*(i.notes[i.nhd].pit-i.notes[0].pit)+4)<(e=s.h)&&(r=e),t.has_val=!0,t.val=r,t.x-=a,t.y=3*(i.notes[0].pit-18)-3}function d_cresc(t){if(!t.ldst){var e,r,n,i,s,a,o,c,l,u,f=t.s,$=t.start;s=(e=$.s).x+3,(c=$.ix)>0&&(l=a_de[c-1]),t.st=f.st,t.lden=!1,t.has_val=!0,(i=up_p(f,f.pos.dyn))&&(t.up=!0),l&&l.s==e&&(t.up&&!l.up||!t.up&&l.up)&&(n=l.dd,f_staff[n.func]&&(o=l.x+l.val+4)>s&&(s=o)),t.defl.noen?(a=t.x-s)<20&&(s=t.x-20-3,a=20):(o=f.x,(u=a_de[t.ix+1])&&u.s==e&&(t.up&&!u.up||!t.up&&u.up)&&(n=u.dd,f_staff[n.func]&&(o-=5)),(a=o-s-4)<20&&(s-=.5*(20-a),a=20)),t.val=a,t.x=s,t.y=y_get(t.st,i,s,a),i||(r=t.dd,t.y-=r.h)}}function d_near(t){var e,r,n=t.s,i=t.dd;i.str||((r=n.multi?n.multi>0:n.stem<0)?e=0|n.ymx:"w"==i.name[0]?(t.inv=!0,e=n.ymn):e=n.ymn-i.h,e>-6&&e<24&&(r&&(e+=3),e=6*((e+6)/6|0)-6),r?n.ymx=e+i.h:"w"==i.name[0]?n.ymn=e-i.h:n.ymn=e,t.y=e,n.type==C.NOTE&&(t.x+=n.notes[n.stem>=0?0:n.nhd].shhd),"d"==i.name[0]&&n.nflags>=-1&&(r?n.stem>0&&(t.x+=3.5):n.stem<0&&(t.x-=3.5)))}function d_pf(t){var e,r,n,i,s,a=t.s,o=t.dd;t.ldst||(t.start?d_cresc(t):(t.val=o.wl+o.wr,(i=up_p(a,a.pos.vol))&&(t.up=!0),n=a.x-o.wl,t.ix>0&&(s=a_de[t.ix-1]).s==a&&(t.up&&!s.up||!t.up&&s.up)&&(e=s.dd,f_staff[e.func]&&(r=s.x+s.val+4)>n&&(n=r)),t.x=n,t.y=y_get(a.st,i,n,t.val),i||(t.y-=o.h)))}function d_slide(t){var e,r,n=t.s,i=n.notes[0].pit,s=5;for(e=0;e<=n.nhd;e++){if(n.notes[e].acc)r=4+n.notes[e].shac;else switch(r=5-n.notes[e].shhd,n.head){case C.SQUARE:r+=3.5;break;case C.OVALBARS:case C.OVAL:r+=2}n.notes[e].pit<=i+3&&r>s&&(s=r)}t.x-=s,t.y=3*(i-18)}function d_trill(t){if(!t.ldst){var e,r,n,i,s=t.dd,a=t.s,o=a.st,c=t.start.s,l=c.x;if(t.prev&&(l=t.prev.x+10,r=t.prev.y),t.st=o,4!=s.func)switch(s.glyph){case"8va":case"15ma":e=1;break;default:e=a.multi>=0}t.defl.noen?(n=t.x-l)<20&&(l=t.x-20-3,n=20):(n=a.x-l-6,a.type==C.NOTE&&(n-=6),n<20&&(l-=.5*(20-n),n=20)),s=t.dd,r||(r=y_get(o,e,l,n)),e?r<(i=staff_tb[c.st].topbar+2)&&(r=i):(r-=s.h)>(i=staff_tb[c.st].botbar-2)&&(r=i),t.lden=!1,t.has_val=!0,t.val=n,t.x=l,t.y=r,e&&(r+=s.h),y_set(o,e,l,n,r),e?c.ymx=a.ymx=r:c.ymn=a.ymn=r}}function d_upstaff(t){if(!t.ldst)if(t.start)d_trill(t);else{var e,r,n,i=t.s,s=t.dd,a=i.x,o=s.wl+s.wr,c=staff_tb[i.st].topbar+2,l=staff_tb[i.st].botbar-2;if(i.nhd&&(a+=i.notes[i.stem>=0?0:i.nhd].shhd),r=-1,4==s.func)r=0;else if(i.pos)switch(i.pos.orn){case C.SL_ABOVE:r=1;break;case C.SL_BELOW:r=0}switch(s.glyph){case"accent":case"roll":!r||r<0&&(i.multi<0||!i.multi&&i.stem>0)?((e=y_get(i.st,!1,i.x-s.wl,o)-2)>l&&(e=l),e-=s.h,y_set(i.st,!1,i.x,0,e),n=!0,i.ymn=e):((e=y_get(i.st,!0,i.x-s.wl,o)+2)<c&&(e=c),y_set(i.st,!0,i.x-s.wl,o,e+s.h),i.ymx=e+s.h);break;case"brth":case"lphr":case"mphr":case"sphr":for(e=c+1,"brth"==s.glyph&&e<i.ymx&&(e=i.ymx),i=i.ts_next;i&&!i.seqst;i=i.ts_next);a+=.45*((i?i.x:realwidth)-a);break;default:0==s.name.indexOf("invert")&&(n=!0),"invertedfermata"!=s.name&&(r>0||r<0&&i.multi>=0)?((e=y_get(i.st,!0,i.x-s.wl,o)+2)<c&&(e=c),y_set(i.st,!0,i.x-s.wl,o,e+s.h),i.ymx=e+s.h):((e=y_get(i.st,!1,i.x-s.wl,o)-2)>l&&(e=l),e-=s.h,y_set(i.st,!1,i.x-s.wl,o,e),"fermata"==s.name&&(n=!0),i.ymn=e)}n&&(e+=s.h,t.inv=!0),t.x=a,t.y=e}}var func_tb=[d_near,d_slide,d_arp,d_upstaff,d_upstaff,d_trill,d_pf,d_cresc];function deco_add(t){var e=t.match(/(\S*)\s+(.*)/);decos[e[1]]=e[2]}function deco_def(t){var e,r,n,i,s,a,o=decos[t];if(o)if(e=o.match(/(\d+)\s+(.+?)\s+([0-9.]+)\s+([0-9.]+)\s+([0-9.]+)/)){var c=Number(e[1]),l=parseFloat(e[3]),u=parseFloat(e[4]),f=parseFloat(e[5]);if(isNaN(c))error(1,null,"%%deco: bad C function value '$1'",e[1]);else if((c<0||c>10)&&(c<32||c>41))error(1,null,"%%deco: bad C function index '$1'",c);else if(5==c&&(c=3),7==c&&(c=6),l<0||u<0||f<0)error(1,null,"%%deco: cannot have a negative value '$1'",o);else{if(!(l>50||u>80||f>80)){if((r=dd_tb[t])||(r={name:t},dd_tb[t]=r),r.func=0==r.name.indexOf("head-")?9:c,r.glyph=e[2],r.h=l,r.wl=u,r.wr=f,(a=o.replace(e[0],"").trim())&&('"'==a[0]&&(a=a.slice(1,-1)),r.str=a),6==r.func&&null==r.str&&(r.str=r.name),"("==(s=r.name.slice(-1))||")"==s&&r.name.indexOf("(")<0)if(r.str=null,i=r.name.slice(0,-1)+("("==s?")":"("),n=dd_tb[i])"("==s?(r.dd_en=n,n.dd_st=r):(r.dd_st=n,n.dd_en=r);else if(!(n=deco_def(i)))return;return r}error(1,null,"%%deco: abnormal h/wl/wr value '$1'",o)}}else error(1,null,"Invalid decoration '$1'",t);else cfmt.decoerr&&error(1,null,"Unknown decoration '$1'",t)}function deco_cnv(t,e,r){var n,i,s,a,o,c=t.length;for(n=0;n<c;n++)if(a=t[n],(s=dd_tb[a])||(s=deco_def(a))){switch(s.func){case 0:if(e.type==C.BAR&&"dot"==s.name){e.bar_dotted=!0;break}case 1:case 2:if(!e.notes){error(1,e,errs.must_note_rest,s.name);continue}break;case 8:if(e.type!=C.NOTE){error(1,e,errs.must_note,s.name);continue}(o=e.notes[e.nhd]).a_dcn||(o.a_dcn=[]),o.a_dcn.push(s.name);continue;case 9:if(!e.notes){error(1,e,errs.must_note_rest,s.name);continue}for(i=0;i<=e.nhd;i++)(o=e.notes[i]).a_dcn||(o.a_dcn=[]),o.a_dcn.push(s.name);continue;default:break;case 10:if(e.notes)for(i=0;i<=e.nhd;i++)e.notes[i].color=s.name;else e.color=s.name;continue;case 32:e.invis=!0;continue;case 33:if(e.type!=C.BAR){error(1,e,"!beamon! must be on a bar");continue}e.beam_on=!0;continue;case 34:if(e.type!=C.NOTE||!r||r.type!=C.NOTE||e.dur!=r.dur){error(1,e,"!$1! must be on the last of a couple of notes",s.name);continue}for(e.trem2=!0,e.beam_end=!0,e.beam_st=!1,r.beam_st=!0,r.beam_end=!1,e.ntrem=r.ntrem=Number(s.name[4]),i=0;i<=e.nhd;i++)e.notes[i].dur*=2;for(i=0;i<=r.nhd;i++)r.notes[i].dur*=2;continue;case 35:if(e.type!=C.NOTE){error(1,e,"!xstem! must be on a note");continue}e.xstem=!0;continue;case 36:if(e.type!=C.NOTE){error(1,e,errs.must_note,s.name);continue}"1"==s.name[6]?e.beam_br1=!0:e.beam_br2=!0;continue;case 37:e.rbstop=1;continue;case 38:if(e.type!=C.NOTE){error(1,e,errs.must_note,s.name);continue}e.trem1=!0,e.ntrem=s.name.length;continue;case 39:if(e.type!=C.NOTE){error(1,e,errs.must_note,s.name);continue}e.feathered_beam="a"==s.name[5]?1:-1;continue;case 40:e.stemless=!0;continue;case 41:e.rbstop=2;continue}e.a_dd||(e.a_dd=[]),e.a_dd.push(s)}}function deco_update(t,e){var r,n,i=a_de.length;for(r=0;r<i;r++)(n=a_de[r]).s==t&&(n.x+=e)}function deco_width(t){var e,r,n=0,i=t.a_dd,s=i.length;for(r=0;r<s;r++)switch((e=i[r]).func){case 1:n<7&&(n=7);break;case 2:n<14&&(n=14);break;case 3:switch(e.glyph){case"brth":case"lphr":case"mphr":case"sphr":t.wr<20&&(t.wr=20)}}return 0!=n&&t.prev&&t.prev.type==C.BAR&&(n-=3),n}function draw_all_deco(){if(0!=a_de.length){var t,e,r,n,i,s,a,o,c,l,u,f,$,h=[],p=[];if(!cfmt.dynalign)for(a=staff_tb[i=nstaff].y;--i>=0;)o=staff_tb[i].y,p[i]=.5*(a+24+o),a=o;for(;t=a_de.shift();)(e=t.dd)&&(e.dd_en||(r=t.s,(u=(n=e.glyph).indexOf("/"))>0&&(n=r.stem>=0?n.slice(0,u):n.slice(u+1)),f_staff[e.func]?set_sscale(r.st):set_scale(r),i=t.st,staff_tb[i].topbar&&(s=t.x,a=t.y+staff_tb[i].y,null!=t.m?s+=r.notes[t.m].shhd*stv_g.scale:f_staff[e.func]&&!cfmt.dynalign&&(t.up&&i>0||!t.up&&i<nstaff)&&(c=t.up?p[--i]:p[i++],c-=.5*e.h,(t.up&&a<c||!t.up&&a>c)&&(o=y_get(i,!t.up,t.x,t.val)+staff_tb[i].y,t.up&&(o-=e.h),(t.up&&o>c||!t.up&&o<c)&&(a=c))),(l=user[n])&&"function"==typeof l?l(s,a,t):self.psdeco(n,s,a,t)||(anno_start(r,"deco"),t.inv&&(g_open(s,a,0,1,-1),s=a=0),t.has_val?(2!=e.func||stv_g.st<0?out_deco_val(s,a,n,t.val/stv_g.scale,t.defl):out_deco_val(s,a,n,t.val,t.defl),t.defl.noen&&h.push(t.start)):null!=e.str?("@"==(f=e.str)[0]&&($=f.match(/^@([0-9.-]+),([0-9.-]+);?/),s+=Number($[1]),a+=Number($[2]),f=f.replace($[0],"")),out_deco_str(s,a,n,f)):t.lden?out_deco_long(s,a,t):xygl(s,a,n),stv_g.g&&g_close(),anno_stop(r,"deco")))));a_de=h}}function draw_deco_near(){var t,e;function r(t,e){var r,n,i,s,a=t.notes[e],o=a.a_dcn.length;for(n=0;n<o;n++)if(i=a.a_dcn[n],(s=dd_tb[i])||(s=deco_def(i))){switch(s.func){case 0:case 1:case 3:case 4:case 8:break;default:error(1,null,"Cannot have !$1! on a head",s.name);continue;case 9:a.invis=!0;break;case 10:a.color=s.name;continue;case 32:a.invis=!0;continue;case 40:t.stemless=!0;continue}r={s:t,dd:s,st:t.st,m:e,ix:0,defl:{},x:t.x,y:3*(a.pit-18)},a_de.push(r),s.dd_en?r.ldst=!0:s.dd_st&&(r.lden=!0,r.defl.nost=!0)}}function n(t){var e;if(t.a_dd&&function(t){var e,r,n,i,s=t.a_dd.length;for(r=0;r<s;r++){switch((e=t.a_dd[r]).func){default:n=0;break;case 3:case 4:n=t.pos.orn;break;case 6:n=t.pos.vol;break;case 7:n=t.pos.dyn}n!=C.SL_HIDDEN&&(i={s:t,dd:e,st:t.st,ix:a_de.length,defl:{},x:t.x,y:t.y},a_de.push(i),e.dd_en?i.ldst=!0:e.dd_st&&(i.lden=!0,i.defl.nost=!0),f_near[e.func]&&func_tb[e.func](i))}}(t),t.notes)for(e=0;e<t.notes.length;e++)t.notes[e].a_dcn&&r(t,e)}for(t=tsfirst;t;t=t.ts_next){switch(t.type){case C.CLEF:case C.KEY:case C.METER:continue}break}for(0!=a_de.length&&function(t){var e,r,n=t.x-t.wl,i=a_de.length;for(e=0;e<i;e++)(r=a_de[e]).ix=e,r.s.x=r.x=n,r.defl.nost=!0}(t);t;t=t.ts_next){switch(t.type){case C.BAR:case C.MREST:case C.NOTE:case C.REST:case C.SPACE:break;case C.GRACE:for(e=t.extra;e;e=e.next)n(e);default:continue}n(t)}!function(){var t,e,r,n,i,s,a,o,c,l=a_de.length;for(t=0;t<l;t++)if((r=a_de[t]).ldst){for(s=(i=r.dd).dd_en,a=(o=r.s).v,e=t+1;e<l&&((n=a_de[e]).start||n.dd!=s||n.s.v!=a);e++);if(e==l)for(c=o.st,e=t+1;e<l&&((n=a_de[e]).start||n.dd!=s||n.s.st!=c);e++);e==l&&((n={s:r.s,st:r.st,dd:s,ix:a_de.length-1,x:realwidth-6,y:r.s.y,lden:!0,defl:{noen:!0}}).x<o.x+10&&(n.x=o.x+10),null!=r.m&&(n.m=r.m),a_de.push(n)),n.start=r,n.defl.nost=r.defl.nost,"trill("==i.name&&t>0&&"trill"==a_de[t-1].dd.name&&(n.prev=a_de[t-1])}for(t=0;t<l;t++)(n=a_de[t]).lden&&!n.start&&((r={s:prev_scut(o=n.s),st:n.st,dd:n.dd.dd_st,ix:a_de.length-1,y:o.y,ldst:!0}).x=r.s.x,null!=n.m&&(r.m=n.m),a_de.push(r),n.start=r)}()}function draw_deco_note(){var t,e,r,n=a_de.length;for(t=0;t<n;t++)r=(e=a_de[t]).dd.func,f_note[r]&&null==e.m&&func_tb[r](e)}function draw_deco_staff(){var t,e,r,n,i,s,a,o,c,l,u,f,$,h,p,d=new Array(nstaff+1),_=a_de.length;function m(t){var e,r,i,s,a,o,c;for(i=staff_tb[t.st].topbar+25,e=t.sym;e;e=e.next)if(e.type==C.BAR&&e.rbstart&&!e.norepbra){if(!e.next)break;for(c||(c=e,set_font("repeat")),r=e;e.next&&!(e=e.next).rbstop;);i<(s=y_get(t.st,!0,r.x,e.x-r.x))&&(i=s),r.text&&(o=strwh(r.text),s=y_get(t.st,!0,r.x+4,o[0]),i<(s+=o[1])&&(i=s)),e.rbstart&&(e=e.prev)}if(e=c)for(set_dscale(t.st,!0),s=i*staff_tb[t.st].staffscale;e;e=e.next)if(e.rbstart&&!e.norepbra){for(r=e;e.next&&!(e=e.next).rbstop;);if(r==e)break;n=r.x,a=e.type!=C.BAR?e.rbstop?0:e.x-realwidth+4:e.bar_type.length>1&&"[]"!=e.bar_type||"]"==e.bar_type?r.st>0&&!(cur_sy.staves[r.st-1].flags&STOP_BAR)?e.wl:":"==e.bar_type.slice(-1)?12:":"!=e.bar_type[0]?0:8:e.rbstop?0:8,a=e.x-n-a,e.next||e.rbstop||t.bar_start||(t.bar_start=clone(e),t.bar_start.type=C.BAR,t.bar_start.bar_type="",delete t.bar_start.text,t.bar_start.rbstart=1,delete t.bar_start.a_gch),r.text&&xy_str(n+4,s-gene.curfont.size-3,r.text),xypath(n,s),2==r.rbstart&&(output+="m0 20v-20"),output+="h"+a.toFixed(1),2==e.rbstop&&(output+="v20"),output+='"/>\n',y_set(r.st,!0,n,a,i+2),e.rbstart&&(e=e.prev)}}for(a=0;a<=nstaff;a++)d[a]={ymin:0,ymax:0};for(a=0;a<_;a++)(l=(c=a_de[a]).dd)&&f_staff[l.func]&&null==c.m&&(func_tb[l.func](c),l.dd_en||cfmt.dynalign&&(c.up?c.y>d[c.st].ymax&&(d[c.st].ymax=c.y):c.y<d[c.st].ymin&&(d[c.st].ymin=c.y)));for(a=0;a<_;a++)(l=(c=a_de[a]).dd)&&!l.dd_en&&f_staff[l.func]&&(cfmt.dynalign?(i=c.up?d[c.st].ymax:d[c.st].ymin,c.y=i):i=c.y,c.up&&(i+=l.h),y_set(c.st,c.up,c.x,c.val,i));for(a=0;a<=nstaff;a++)d[a]={ymin:0,ymax:24};for(t=tsfirst;t;t=t.ts_next)if(t.a_gch){for(e||(e=t),f=null,$=0;$<t.a_gch.length&&!("g"==(u=t.a_gch[$]).type&&(f=u,u.y<0));$++);f&&(s=f.wh[0],f.y>=0?(i=y_get(t.st,!0,t.x,s))>d[t.st].ymax&&(d[t.st].ymax=i):(i=y_get(t.st,!1,t.x,s))<d[t.st].ymin&&(d[t.st].ymin=i))}if(e){for(a=0;a<=nstaff;a++)p=staff_tb[a].botbar,d[a].ymin>p-4&&(d[a].ymin=p-4),h=staff_tb[a].topbar,d[a].ymax<h+4&&(d[a].ymax=h+4);for(set_dscale(-1),t=e;t;t=t.ts_next)t.a_gch&&self.draw_gchord(t,d[t.st].ymin,d[t.st].ymax)}for(o=0;o<voice_tb.length;o++)!(r=voice_tb[o]).second&&r.sym&&m(r)}function draw_measnb(){var t,e,r,n,i,s,a,o,c,l=cur_sy;for(e=0;e<=nstaff&&!l.st_print[e];e++);if(!(e>nstaff)){if(set_dscale(e),1!=staff_tb[e].staffscale&&param_set_font("measurefont","* "+((o=get_font("measure").size)/staff_tb[e].staffscale).toString()),set_font("measure"),c=cwidf("0"),t=tsfirst,(r=gene.nbar)>1)if(0==cfmt.measurenb)a=!0,(i=y_get(e,!0,0,20))<staff_tb[e].topbar+14&&(i=staff_tb[e].topbar+14),xy_str(0,i,r.toString()),y_set(e,!0,0,20,i+gene.curfont.size+2);else if(r%cfmt.measurenb==0){for(;;t=t.ts_next){switch(t.type){case C.TIMESIG:case C.CLEF:case C.KEYSIG:case C.FMTCHG:case C.STBRK:continue}break}t.type==C.BAR&&t.bar_num||(t.prev&&(t=t.prev),n=t.x+t.wr,a=!0,s=c,r>=10&&(s*=r>=100?3:2),gene.curfont.box&&(s+=4),(i=y_get(e,!0,n,s))<staff_tb[e].topbar+6&&(i=staff_tb[e].topbar+6),xy_str(n,i+=2,r.toString()),gene.curfont.box&&(i+=2,s+=3),y_set(e,!0,n,s,i+=gene.curfont.size),t.ymx=i)}for(;t;t=t.ts_next){switch(t.type){case C.STAVES:for(l=t.sy,e=0;e<nstaff&&!l.st_print[e];e++);set_dscale(e);continue;default:continue;case C.BAR:if(!t.bar_num||t.bar_num<=1)continue}r=t.bar_num,0!=cfmt.measurenb&&r%cfmt.measurenb==0&&t.next&&!t.bar_mrep&&(a||(a=!0),s=c,r>=10&&(s*=r>=100?3:2),(i=y_get(e,!0,n=t.x-.4*s,s))<staff_tb[e].topbar+3&&(i=staff_tb[e].topbar+3),t.next.type==C.NOTE&&(t.next.stem>0?i<t.next.ys-gene.curfont.size&&(i=t.next.ys-gene.curfont.size):i<t.next.y&&(i=t.next.y)),i+=2,gene.curfont.box&&(i+=2,s+=3),xy_str(n,i,r.toString()),i+=gene.curfont.size,gene.curfont.box&&(i+=2),y_set(e,!0,n,s,i),t.ymx=i)}gene.nbar=r,o&&param_set_font("measurefont","* "+o.toString())}}function draw_partempo(t,e){var r,n,i,s,a,o,c=0,l=0,u=staff_tb[t].topbar+8,f=0,$=1,h=-100;for(r=tsfirst;r;r=r.ts_next)r.type!=C.TEMPO||r.invis||(i||(i=r),a=r.tempo_wh[0],0==r.time&&r.x>40&&(r.x=40),(o=y_get(t,!0,r.x-16,a))>u&&(u=o),h>=r.x-16&&!(f&$>>1)&&(f|=$),$<<=1,h=r.x-16+a);if(i)for(set_sscale(-1),set_font("tempo"),s=(o=2-(l=gene.curfont.size+8))-l,0!=f&&(l*=2),e<u+l&&(c=u+l-e),r=i;r;r=r.ts_next)if(r.type==C.TEMPO&&!r.invis)for((user.anno_start||user.anno_stop)&&(r.wl=16,r.wr=30,r.ymn=1&f?s:o,r.ymx=r.ymn+14,anno_start(r)),writempo(r,r.x-16,1&f?s:o),anno_stop(r),f>>=1;r.ts_next&&r.ts_next.type==C.TEMPO;)r=r.ts_next;for(u=staff_tb[t].topbar+6,r=tsfirst;r;r=r.ts_next)r.type!=C.PART||r.invis||(n||(n=r,set_font("parts"),s=gene.curfont.size+2),a=strwh(r.text)[0],u<(o=y_get(t,!0,r.x-10,a+3))&&(u=o));if(n)for(set_sscale(-1),gene.curfont.box&&(s+=2),e<u+s+l&&(c=u+s+l-e),r=n;r;r=r.ts_next)if(r.type==C.PART&&!r.invis)for(r.x-=10,(user.anno_start||user.anno_stop)&&(a=strwh(r.text)[0],r.wl=0,r.wr=a,r.ymn=-l-s,r.ymx=r.ymn+s,anno_start(r)),xy_str(r.x,2-l-s,r.text),anno_stop(r);r.ts_next&&r.ts_next.type==C.PART;)r=r.ts_next;return c}var STEM_MIN=16,STEM_MIN2=14,STEM_MIN3=12,STEM_MIN4=10,STEM_CH_MIN=14,STEM_CH_MIN2=10,STEM_CH_MIN3=9,STEM_CH_MIN4=9,BEAM_DEPTH=3.2,BEAM_OFFSET=.25,BEAM_SHIFT=5,BEAM_STUB=8,SLUR_SLOPE=.5,GSTEM=15,GSTEM_XOFF=2.3,cache;function b_pos(t,e,r,n){var i,s,a,o,c=t?3.5:BEAM_SHIFT,l=t?1.8:BEAM_DEPTH;function u(t){return 6*Math.round((t+12)/6)-12-t}if(e>0){if((s=n-(r-1)*c-l)>26)return 0;i=n}else{if((i=n+(r-1)*c+l)<-2)return 0;s=n}return(a=u(i-BEAM_OFFSET))*a>(o=u(s+BEAM_OFFSET))*o?o:a}function sym_dup(t){var e;for((t=clone(t)).invis=!0,delete t.extra,delete t.text,delete t.a_gch,delete t.a_ly,delete t.a_dd,t.notes=clone(t.notes),e=0;e<=t.nhd;e++)delete(t.notes[e]=clone(t.notes[e])).a_dcn;return t}var min_tb=[[STEM_MIN,STEM_MIN,STEM_MIN2,STEM_MIN3,STEM_MIN4,STEM_MIN4],[STEM_CH_MIN,STEM_CH_MIN,STEM_CH_MIN2,STEM_CH_MIN3,STEM_CH_MIN4,STEM_CH_MIN4]];function draw_beams(t){var e,r,n,i,s,a,o,c,l,u,f,$,h=t.s1,p=t.s2;function d(t,e,r,n,i,s){var a,o,c=i.s1,l=c.nflags;c.ntrem&&(l-=c.ntrem),c.trem2&&s>l&&(c.dur>=C.BLEN/2?(t=c.x+6,e=i.s2.x-6):c.dur<C.BLEN/4&&(t+=5,e-=6)),a=i.a*t+i.b-r,e-=t,e/=stv_g.scale,o=i.a*e*stv_g.scale,xypath(t,a,!0),output+="l"+e.toFixed(1)+" "+(-o).toFixed(1)+"v"+n.toFixed(1)+"l"+(-e).toFixed(1)+" "+o.toFixed(1)+'z"/>\n'}for(anno_start(h,"beam"),h.grace?(s=3.5,a=3.2,i=.29,o=1.8):(s=BEAM_SHIFT,a=BEAM_STUB,i=.34,o=BEAM_DEPTH),n=h.stem,h.stem!=p.stem&&h.nflags<p.nflags&&(n=p.stem),n<0&&(o=-o),d(h.xs-i,p.xs+i,0,o,t,1),c=0,e=h;e.type==C.NOTE&&e.stem!=n&&(e.ys=t.a*e.xs+t.b-staff_tb[e.st].y+s*(e.nflags-1)*e.stem-o),e!=p;e=e.next);for(h.feathered_beam&&(c=s/(p.xs-h.xs),s=h.feathered_beam>0?(c=-c)*h.xs:c*p.xs,c*=n),i=0,r=2;r<=t.nflags;r++)for(i+=s,0!=c&&(t.a+=c),e=h;;e=e.next)if(e.type!=C.NOTE||e.nflags<r){if(e==p)break}else if(e.trem1&&r>e.nflags-e.ntrem){if(d(($=e.dur>=C.BLEN/2?e.x:e.xs)-5,$+5,(i+2.5)*n,o,t,r),e==p)break}else{for(u=e;e!=p;){if((l=e.next).type==C.NOTE||l.type==C.REST)if(l.trem1){if(l.nflags-l.ntrem<r)break}else if(l.nflags<r)break;if(l.beam_br1||l.beam_br2&&r>2)break;e=l}for(f=e;f.type!=C.NOTE;)f=f.prev;if($=u.xs,u==f)if(u==h)$+=a;else if(u==p)$-=a;else if(u.beam_br1||u.beam_br2&&r>2)$+=a;else{for(l=u.next;l.type!=C.NOTE;)l=l.next;if(l.beam_br1||l.beam_br2&&r>2)$-=a;else{for(u=u.prev;u.type!=C.NOTE;)u=u.prev;u.nflags<l.nflags||u.nflags==l.nflags&&u.dots<l.dots?$+=a:$-=a}}if(d($,f.xs,i*n,o,t,r),e==p)break}h.tmp?unlksym(h):p.tmp&&unlksym(p),anno_stop(h,"beam")}function draw_lstaff(t){var e,r,n,i,s=cur_sy.nstaff,a=0;function o(t,e,r){for(var n,i,s,a;!cur_sy.st_print[e];){if(cur_sy.staves[e].flags&r)return;e++}for(n=i=e;cur_sy.st_print[n]&&(i=n),!(cur_sy.staves[n].flags&r);)n++;s=staff_tb[e].y+staff_tb[e].topbar*staff_tb[e].staffscale,a=staff_tb[i].y+staff_tb[i].botbar*staff_tb[i].staffscale,r&(CLOSE_BRACE|CLOSE_BRACE2)?out_brace(t,a,s-a):out_bracket(t,s,s-a)}for(e=0;(cur_sy.staves[e].flags&(OPEN_BRACE|OPEN_BRACKET)&&a++,!cur_sy.st_print[e])&&(cur_sy.staves[e].flags&(CLOSE_BRACE|CLOSE_BRACKET)&&a--,e!=s);e++);for(r=s;r>e&&!cur_sy.st_print[r];r--);if(e!=r||0!=a)for(n=staff_tb[r].y+staff_tb[r].botbar*staff_tb[r].staffscale,i=staff_tb[e].y+staff_tb[e].topbar*staff_tb[e].staffscale-n,xypath(t,n),output+="v"+(-i).toFixed(1)+'"/>\n',e=0;e<=s;e++)cur_sy.staves[e].flags&OPEN_BRACE&&o(t,e,CLOSE_BRACE),cur_sy.staves[e].flags&OPEN_BRACKET&&o(t,e,CLOSE_BRACKET),cur_sy.staves[e].flags&OPEN_BRACE2&&o(t-6,e,CLOSE_BRACE2),cur_sy.staves[e].flags&OPEN_BRACKET2&&o(t-6,e,CLOSE_BRACKET2)}function draw_meter(t,e){if(e.a_meter){var r,n,i=e.st,s=staff_tb[i],a=s.y;for("|||||"!=s.stafflines&&(a+=(s.topbar+s.botbar)/2-12),r=0;r<e.a_meter.length;r++)n=e.a_meter[r],t=e.x+e.x_meter[r],n.bot?out_XYAB('<g transform="translate(X,Y)" text-anchor="middle">\n\t<text y="-12">A</text>\n\t<text>B</text>\n</g>\n',t,a+6,m_gl(n.top),m_gl(n.bot)):out_XYAB('<text x="X" y="Y" text-anchor="middle">A</text>\n',t,a+12,m_gl(n.top))}}function draw_acc(t,e,r,n,i){if(n)if(n==i)r=-1==r?-2:2;else if(2*n!=i)return void xygl(t,e,"acc"+r+"_"+n+"_"+i);xygl(t,e,"acc"+r)}function set_hl(t,e,r,n,i){var s,a;for(e>=0?(a=t.hlu[e])||(a=t.hlu[e]=[]):(a=t.hld[-e])||(a=t.hld[-e]=[]),s=0;s<a.length&&!(r>=a[s][0]);s++);s==a.length?a.push([r,n,i]):r>a[s][0]?a.splice(++s,0,[r,n,i]):(n<a[s][1]&&(a[s][1]=n),i>a[s][2]&&(a[s][2]=i))}Abc.prototype.calculate_beam=function(t,e){var r,n,i,s,a,o,c,l,u,f,$,h,p,d,_,m,y,g,v,b,A,x,w;for(e.beam_st||(lkvsym(r=sym_dup(e),e),lktsym(r,e),r.x-=12,r.x>e.prev.x+12&&(r.x=e.prev.x+12),r.beam_st=!0,delete r.beam_end,r.tmp=!0,delete r.sls,e=r),s=a=0,l=u=!1,o=e.st,c=e.v,b=e.grace?GSTEM_XOFF:3.5,n=e;n.type!=C.NOTE||(n.nflags>a&&(a=n.nflags),s++,n.st!=o&&(l=!0),n.stem!=e.stem&&(u=!0),x||n.invis||n.stemless&&!n.trem2||(x=!0),!n.beam_end);n=n.next)if(!n.next){for(;n.type!=C.NOTE;n=n.prev);(r=sym_dup(n)).next=n.next,r.next&&(r.next.prev=r),n.next=r,r.prev=n,r.ts_next=n.ts_next,r.ts_next&&(r.ts_next.ts_prev=r),n.ts_next=r,r.ts_prev=n,delete r.beam_st,r.beam_end=!0,r.tmp=!0,delete r.sls,r.x+=12,r.x<realwidth-12&&(r.x=realwidth-12),n=r,s++;break}if(!x)return!1;if(t.s2=n,0==staff_tb[o].y){if(l)return!1}else if(!l)return t.s1=e,t.a=(e.ys-n.ys)/(e.xs-n.xs),t.b=e.ys-e.xs*t.a+staff_tb[o].y,t.nflags=a,!0;for(v=e,y=100,g=0,r=e;r.type!=C.NOTE||(1==(A=r.p_v.scale)&&(A=staff_tb[r.st].staffscale),r.stem>=0?(f=b+r.notes[0].shhd,r.notes[r.nhd].pit>g&&(g=r.notes[r.nhd].pit,v=r)):(f=-b+r.notes[r.nhd].shhd,r.notes[0].pit<y&&(y=r.notes[0].pit,v=r)),r.xs=r.x+f*A,r!=n);r=r.next);if(r.grace&&cfmt.flatbeams?p=0:!u&&s>=3&&v!=e&&v!=n&&(p=0),$=e.ys+staff_tb[o].y,null==p&&(p=(n.ys+staff_tb[n.st].y-$)/(n.xs-e.xs)),0!=p&&(p=cfmt.beamslope*p/(cfmt.beamslope+Math.abs(p))),d=($+n.ys+staff_tb[n.st].y)/2-p*(n.xs+e.xs)/2,m=0,r=e,u)h=.5*((e.grace?3.5:BEAM_SHIFT)*(a-1)+BEAM_DEPTH),e.stem!=n.stem&&e.nflags<n.nflags?d+=h*n.stem:d+=h*e.stem;else if(e.grace)for(;h=p*r.xs+d-staff_tb[r.st].y,_=GSTEM-2,r.stem>0?_-=h-3*(r.notes[r.nhd].pit-18):_+=h-3*(r.notes[0].pit-18),(_+=3*(r.nflags-1))>m&&(m=_),r!=n;r=r.next);else{for(var k=BEAM_DEPTH+BEAM_SHIFT*(a-1);r.ts_prev&&r.ts_prev.type==C.NOTE&&r.ts_prev.time==r.time&&r.ts_prev.x>e.xs;)r=r.ts_prev;for(;r&&r.time<=n.time;r=r.ts_next)if(!(r.type!=C.NOTE||r.invis||r.st!=o&&r.v!=c)){if(h=p*(f=r.v==c?r.xs:r.x)+d-staff_tb[r.st].y,r.v==c)_=min_tb[0==r.nhd?0:1][r.nflags],r.stem>0?(r.notes[r.nhd].pit>26&&(_-=2,r.notes[r.nhd].pit>28&&(_-=2)),_-=h-3*(r.notes[r.nhd].pit-18)):(r.notes[0].pit<18&&(_-=2,r.notes[0].pit<16&&(_-=2)),_-=3*(r.notes[0].pit-18)-h),_+=BEAM_DEPTH+BEAM_SHIFT*(r.nflags-1);else{if(e.stem>0)if(r.stem>0){if(r.ymn>h+4||r.ymx<h-k-2)continue;_=r.v>c?r.ymx-h:r.ymn+8-h}else _=r.ymx-h;else if(r.stem<0){if(r.ymx<h-4||r.ymn>h-k-2)continue;_=r.v<c?h-r.ymn:h-r.ymx+8}else _=h-r.ymn;_+=2+k}_>m&&(m=_)}}if(m>0&&(d+=e.stem*m),!l&&!u)for(r=e.next;;r=r.next){switch(r.type){case C.REST:if(!(i=r.ts_next)||i.st!=o||i.type!=C.NOTE&&i.type!=C.REST)break;case C.BAR:if(r.invis)break;case C.CLEF:$=p*r.x+d,e.stem>0?($=r.ymx-$+BEAM_DEPTH+BEAM_SHIFT*(a-1)+2)>0&&(d+=$):($=r.ymn-$-BEAM_DEPTH-BEAM_SHIFT*(a-1)-2)<0&&(d+=$);break;case C.GRACE:for(i=r.extra;i;i=i.next)$=p*i.x+d,e.stem>0?($=i.ymx-$+BEAM_DEPTH+BEAM_SHIFT*(a-1)+2)>0&&(d+=$):($=i.ymn-$-BEAM_DEPTH-BEAM_SHIFT*(a-1)-2)<0&&(d+=$)}if(r==n)break}for(0==p&&(d+=b_pos(e.grace,e.stem,a,d-staff_tb[o].y)),r=e;;r=r.next){switch(r.type){case C.NOTE:r.ys=p*r.xs+d-staff_tb[r.st].y,r.stem>0?(r.ymx=r.ys+2.5,r.ts_prev&&r.ts_prev.stem>0&&r.ts_prev.st==r.st&&r.ts_prev.ymn<r.ymx&&r.ts_prev.x==r.x&&0==r.notes[0].shhd&&(r.ts_prev.x-=3,r.ts_prev.xs-=3)):r.ymn=r.ys-2.5;break;case C.REST:if($=p*r.x+d-staff_tb[r.st].y,w=BEAM_DEPTH+BEAM_SHIFT*(a-1)+(r.head!=C.FULL?4:9),e.stem>0){if($-=w,0==e.multi&&$>12&&($=12),r.y<=$)break}else if($+=w,0==e.multi&&$<12&&($=12),r.y>=$)break;r.head!=C.FULL&&($=6*(($+3+12)/6|0)-12),r.y=$}if(r==n)break}return 0!=staff_tb[o].y&&(t.s1=e,t.a=p,t.b=d,t.nflags=a,!0)},Abc.prototype.draw_hl=function(t){var e,r,n,i,s=[],a=t.st,o=staff_tb[a];if(o.hll){for(e=0;e<=t.nhd;e++)i=t.notes[e],o.hlmap[i.pit-o.hll]||s.push([i.pit-18,i.shhd*stv_g.scale]);if(n=s.length){var c,l,u,f,$=o.stafflines,h=$.length-1,p=h,d=o.botline/6,_=d,m=t.grace?4:1.3*hw_tb[t.head];for(u=(i=t.notes[t.stem<0?t.nhd:0]).shhd,e=0;e<s.length;e++)f=s[e][0],c=(s[e][1]<u?s[e][1]:u)-m,l=(s[e][1]>u?s[e][1]:u)+m,f<2*_?(_=++f>>1,n--):f>2*p&&(p=f>>1,n--),set_hl(o,f>>1,t.x,c,l);for(c=u-m,l=u+m;++_<d;)set_hl(o,_,t.x,c,l);for(;--p>h;)set_hl(o,p,t.x,c,l);if(n){for(e=_,r=p;e>d&&"-"==$[e];)e--;for(;r<h&&"-"==$[r];)r++;for(;e<r;e++)"-"==$[e]&&set_hl(o,e,t.x,c,l)}}}};var sharp_cl=new Int8Array([24,9,15,21,6,12,18]),flat_cl=new Int8Array([12,18,24,9,15,21,6]),sharp1=new Int8Array([-9,12,-9,-9,12,-9]),sharp2=new Int8Array([12,-9,12,-9,12,-9]),flat1=new Int8Array([9,-12,9,-12,9,-12]),flat2=new Int8Array([-12,9,-12,9,-12,9]);function bar_cnv(t){switch(t){case"[":case"[]":return"";case"|:":case"|::":case"|:::":return"["+t;case":|":case"::|":case":::|":return t+"]";case"::":return cfmt.dblrepbar}return t}Abc.prototype.draw_keysig=function(t,e){if(!e.k_none&&!e.k_play){var r,n,i,s=e.k_old_sf,a=e.st,o=staff_tb[a].y,c=e.k_y_clef;for(1&c&&(c+=7),c/=2;c<0;)c+=7;if(c%=7,e.k_a_acc){if(e.k_a_acc.length){var l,u=e.k_a_acc[0].acc,f=100,$={st:a,nhd:0,notes:[{}]};for(r=0;r<e.k_a_acc.length;r++)l=e.k_a_acc[r],n=3*(e.k_y_clef+l.pit-18),0!=r&&(n>f+18||n<f-18)?t-=5.5:l.acc!=u&&(t+=3),u=l.acc,$.x=t,$.notes[0].pit=n/3+18,self.draw_hl($),f=n,draw_acc(t,o+n,l.acc,l.micro_n,l.micro_d),t+=5.5}}else{if((cfmt.cancelkey||0==e.k_sf)&&(0==e.k_sf||s*e.k_sf<0)){for(i=(n=sharp_cl[c])>9?sharp1:sharp2,r=0;r<s;r++)xygl(t,o+n,"acc3"),n+=i[r],t+=5.5;for(i=(n=flat_cl[c])<18?flat1:flat2,r=0;r>s;r--)xygl(t,o+n,"acc3"),n+=i[-r],t+=5.5;0!=e.k_sf&&(t+=3)}if(e.k_sf>0){for(i=(n=sharp_cl[c])>9?sharp1:sharp2,r=0;r<e.k_sf;r++)xygl(t,o+n,"acc1"),n+=i[r],t+=5.5;if(cfmt.cancelkey&&r<s)for(t+=2;r<s;r++)xygl(t,o+n,"acc3"),n+=i[r],t+=5.5}if(e.k_sf<0){for(i=(n=flat_cl[c])<18?flat1:flat2,r=0;r>e.k_sf;r--)xygl(t,o+n,"acc-1"),n+=i[-r],t+=5.5;if(cfmt.cancelkey&&r>s)for(t+=2;r>s;r--)xygl(t,o+n,"acc3"),n+=i[-r],t+=5.5}}}};var rest_tb=["r128","r64","r32","r16","r8","r4","r2","r1","r0","r00"];function draw_rest(t){var e,r,n,i,s,a,o,c=staff_tb[t.st];if(t.dur_orig==t.p_v.meter.wmeasure||t.rep_nb&&t.rep_nb>=0){for(t.dur<2*C.BLEN?t.nflags=-2:t.dur<4*C.BLEN?t.nflags=-3:t.nflags=-4,t.dots=0,e=t.ts_next;e&&e.time!=t.time+t.dur;)e=e.ts_next;for(i=e?e.x:realwidth,e=t;!e.seqst;)e=e.ts_prev;i=(i+(e=e.ts_prev).x)/2,t.a_dd&&deco_update(t,i-t.x),t.x=i}else i=t.x,t.notes[0].shhd&&(i+=t.notes[0].shhd*stv_g.scale);if(!t.invis){if(a=c.y,t.rep_nb)return set_sscale(t.st),anno_start(t),"|||||"==c.stafflines?a+=12:a+=(c.topbar+c.botbar)/2,t.rep_nb<0?xygl(i,a,"srep"):(xygl(i,a,"mrep"),t.rep_nb>2&&t.v==cur_sy.top_voice&&(set_font("annotation"),gene.curfont.box&&(gene.curfont.box=!1,o=!0),xy_str(i,a+c.topbar-9,t.rep_nb.toString(),"c"),o&&(gene.curfont.box=!0))),void anno_stop(t);if(set_scale(t),anno_start(t),t.notes[0].color&&set_color(t.notes[0].color),s=t.y,7==(r=5-t.nflags)&&12==s&&c.stafflines.length<=2&&(s-=6),xygl(i,s+a,t.notes[0].head||rest_tb[r]),r>=6){switch(n=s/6,r){default:switch(c.stafflines[n+1]){case"|":case"[":break;default:xygl(i,s+6+a,"hl1")}9==r&&(s-=6,n--);break;case 7:s+=6,n++;case 6:}switch(c.stafflines[n]){case"|":case"[":break;default:xygl(i,s+a,"hl1")}}if(t.dots)for(i+=8,s+=a+3,r=0;r<t.dots;r++)xygl(i,s,"dot"),i+=3.5;set_color(),anno_stop(t)}}function draw_gracenotes(t){var e,r,n,i,s,a,o,c,l,u,f,$,h,p,d,_,m,y={};for(d=t.extra;d&&(d.beam_st&&!d.beam_end&&self.calculate_beam(y,d)&&draw_beams(y),anno_start(d),draw_note(d,!y.s2),d==y.s2&&(y.s2=null),anno_stop(d),(d.sls||d.sl2)&&($=!0),d.next);d=d.next);if(t.sappo&&((d=t.extra).next?(i=.5*(d.next.x-d.x)+4,s=.5*(d.ys+d.next.ys)-d.y,d.stem>0?s-=1:s+=1):(i=9,s=d.stem>0?5:-5),out_acciac(x_head(d,m=d.notes[d.stem<0?0:d.nhd]),y_head(d,m),i,s,d.stem>0)),!t.p_v.ckey.k_bagpipe&&cfmt.graceslurs&&!$&&!t.tie_s&&t.next&&t.next.type==C.NOTE){if(_=d,(d.stem>=0||t.multi<0)&&d.notes[0].pit<=28||d.notes[0].pit<16){for(e=127,d=t.extra;d;d=d.next)d.y<e&&(e=d.y,_=d);r=_.x,n=_.y-5,t.extra!=_&&(r-=4,n+=1),c=(t=t.next).x-1,t.stem<0&&t.nflags>-2&&(c-=4),(h=.4*(c-r))>3&&(h=3),p=h,u=.2,f=.8,n>(l=3*(t.notes[0].pit-18)-5)+7?(r=_.x-1,n+=.5,l+=6.5,c=t.x-5.5,h=.8*(n-l),p=.2*(n-l),u=0):l>n+4&&(l=n+4,r=_.x+2,n=_.y-4)}else{for(e=-127,d=t.extra;d;d=d.next)d.y>e&&(e=d.y,_=d);r=_.x,n=_.y+5,t.extra!=_&&(r-=4,n-=1),c=(t=t.next).x-1,t.stem>=0&&t.nflags>-2&&(c-=2),(h=.4*(r-c))<-3&&(h=-3),p=h,u=.2,f=.8,n<(l=3*(t.notes[t.nhd].pit-18)+5)-7?(r=_.x-1,n-=.5,l-=6.5,c=t.x-5.5,h=.8*(n-l),p=.2*(n-l),u=0):l<n-4&&(l=n-4,r=_.x+2,n=_.y+4)}i=u*c+(1-u)*r-r,s=u*l+(1-u)*n-h-n,a=f*c+(1-f)*r-r,o=f*l+(1-f)*n-p-n,anno_start(t,"slur"),xypath(r,n+staff_tb[t.st].y),output+="c"+i.toFixed(1)+" "+(-s).toFixed(1)+" "+a.toFixed(1)+" "+(-o).toFixed(1)+" "+(c-r).toFixed(1)+" "+(-l+n).toFixed(1)+'"/>\n',anno_stop(t,"slur")}}function setdoty(t,e){var r,n,i;for(r=0;r<=t.nhd;r++)(i=3*(t.notes[r].pit-18))%6==0&&(t.dot_low?i-=3:i+=3),e[r]=i;for(r=0;r<t.nhd;r++)if(!(e[r+1]>e[r])){for(n=r;n>0&&!(e[n]>e[n-1]+6);)n--;if(3*(t.notes[n].pit-18)-e[n]<e[r+1]-3*(t.notes[r+1].pit-18))for(;n<=r;)e[n++]-=6;else e[r+1]=e[r]+6}}function x_head(t,e){return t.x+e.shhd*stv_g.scale}function y_head(t,e){return staff_tb[t.st].y+3*(e.pit-18)}function draw_basic_note(t,e,r,n){var i,s,a,o,c,l=!1,u=e.notes[r],f=staff_tb[e.st].y,$=3*(u.pit-18),h=t+u.shhd*stv_g.scale,p=$+f,d=identify_note(e,u.dur),_=d[0],m=d[1],y=d[2];if(u.invis);else if(e.grace)s="ghd",h-=4.5*stv_g.scale;else if(u.map&&u.map[0])i=e.head,(s=u.map[0][i])||(s=u.map[0][u.map[0].length-1]),(i=s.indexOf("/"))>=0&&(s=e.stem>=0?s.slice(0,i):s.slice(i+1));else if(e.type==C.CUSTOS)s="custos";else switch(_){case C.OVAL:s="HD";break;case C.OVALBARS:if(e.head!=C.SQUARE){s="HDD";break}case C.SQUARE:y>-4?s="breve":(s="longa",c=e.stem>0),tsnext||!e.next||e.next.type!=C.BAR||e.next.next||(m=0),h+=1;break;case C.EMPTY:s="Hd";break;default:s="hd"}if(null!=u.color&&(l=set_color(u.color)),s&&(c&&(g_open(h,p,0,1,-1),h=p=0),self.psxygl(h,p,s)||xygl(h,p,s),c&&g_close()),m)for(a=t+(7.7+e.xmx)*stv_g.scale,null==n[r]&&(n[r]=3*(e.notes[r].pit-18),0==(1&e.notes[r].pit)&&(n[r]+=3)),o=n[r]+f,i=u.dur/12>>5-y-m;m-- >0;)xygl(a,o,i&1<<m?"dot":"dot+"),a+=3.5;u.acc&&(t-=u.shac*stv_g.scale,e.grace?(g_open(t,$+f,0,.75),draw_acc(0,0,u.acc,u.micro_n,u.micro_d),g_close()):draw_acc(t,$+f,u.acc,u.micro_n,u.micro_d)),0!=l&&set_color(l)}function draw_note(t,e){var r,n,i,s,a,o,c,l,u=new Array(t.nhd+1);if(t.dots&&setdoty(t,u),o=x_head(t,l=t.notes[t.stem<0?t.nhd:0]),i=staff_tb[t.st].y,self.draw_hl(t),c=y_head(t,l),t.stemless?t.xstem&&(s=((r=t.ts_prev).stem>0?r.y:r.ys)-t.y,out_stem(o,c,s+=staff_tb[r.st].y-i)):(s=t.ys-t.y,a=t.nflags,t.ntrem&&(a-=t.ntrem),!e||a<=0?(t.nflags>0&&(t.stem>=0?s-=1:s+=1),out_stem(o,c,s,t.grace)):out_stem(o,c,s,t.grace,a,cfmt.straightflags)),e&&t.trem1){var f=t.ntrem||0,$=o;s=3*(t.notes[t.stem>0?t.nhd:0].pit-18),t.head==C.FULL||t.head==C.EMPTY?($+=(t.grace?GSTEM_XOFF:3.5)*t.stem,t.stem>0?s+=6+5.4*f:s-=11.4):t.stem>0?s+=5+5.4*f:s-=10.4,out_trem($,i+(s/=t.p_v.scale),f)}for(o=t.x,n=0;n<=t.nhd;n++)draw_basic_note(o,t,n,u)}function prev_scut(t){for(;t.prev;)if((t=t.prev).rbstart)return t;for(t=t.p_v.sym;t.type!=C.CLEF;)t=t.ts_prev;return t.next&&t.next.type==C.KEY&&(t=t.next),t.next&&t.next.type==C.METER?t.next:t}function slur_direction(t,e){var r,n,i,s,a,o;if(t.grace&&t.stem>0)return-1;if(o=e,s=(a=t).multi?a.multi:o.multi?o.multi:0)return s;for(r=t;;r=r.next){if(r.type==C.NOTE){if(!r.stemless){if(r.stem<0)return 1;n=!0}r.notes[0].pit<22&&(i=!0)}if(r.time==e.time)break}return n||i?-1:1}function slur_out(t,e,r,n,i,s,a){var o,c,l,u=.3;(c=n-e)<0&&(c=-c),(o=r-t)>40&&c/o<.7&&(u=.3+.002*(o-40))>.7&&(u=.7);var f=.5*(t+r),$=.5*(e+n),h=f+u*(t-f),p=$+u*(e-$)+s;h=t+.45*(h-t),p=e+.45*(p-e);var d=f+u*(r-f),_=$+u*(n-$)+s;d=r+.45*(d-r),_=n+.45*(_-n),c=2*i,(l=.2+.001*o)>.6&&(l=.6),l*=i,o*=.03;output+=a?'<path class="stroke" stroke-dasharray="5,5" d="M':'<path d="M',out_sxsy(t," ",e),output+="c"+((h-t)/stv_g.scale).toFixed(1)+" "+((e-p)/1).toFixed(1)+" "+((d-t)/stv_g.scale).toFixed(1)+" "+((e-_)/1).toFixed(1)+" "+((r-t)/stv_g.scale).toFixed(1)+" "+((e-n)/1).toFixed(1),a||(output+="\n\tv"+(-l).toFixed(1)+"c"+((d-o-r)/stv_g.scale).toFixed(1)+" "+((n+l-_-c)/1).toFixed(1)+" "+((h+o-r)/stv_g.scale).toFixed(1)+" "+((n+l-p-c)/1).toFixed(1)+" "+((t-r)/stv_g.scale).toFixed(1)+" "+((n-e)/1).toFixed(1)),output+='"/>\n'}function draw_slur(t,e,r){var n,i,s,a,o,c,l,u,f,$,h,p,d,_,m,y=r.ty,g=(7&y)==C.SL_ABOVE?1:-1,v=t.length,b=v-1,A=t[0],x=t[b],w=1,k=A.st,E=!1;for(set_dscale(A.st),n=1;n<v;n++)(i=t[n]).type!=C.NOTE&&i.type!=C.REST||(w++,i.st!=k&&(E=!0,i.st<k&&(k=i.st)));if(E&&error(2,A,"*** multi-staves slurs not treated yet"),a=A.x,A.notes&&A.notes[0].shhd&&(a+=A.notes[0].shhd),c=x.x,x.notes&&(c+=x.notes[0].shhd),e?(o=3*(e.pit-18)+2*g,a+=3):(o=g>0?A.ymx+2:A.ymn-2,A.type==C.NOTE&&(g>0?A.stem>0&&(a+=5,A.beam_end&&A.nflags>=-1&&!A.in_tuplet&&(A.nflags>0?(a+=2,o=A.ys-3):o=A.ys-6)):A.stem<0&&(a-=1,x.grace?o=A.y-8:A.beam_end&&A.nflags>=-1&&(!A.in_tuplet||A.ys<o+3)&&(A.nflags>0?(a+=2,o=A.ys+3):o=A.ys+6)))),r.is_note?(l=3*(r.note.pit-18)+2*g,c-=3):(l=g>0?x.ymx+2:x.ymn-2,x.type==C.NOTE&&(g>0?x.stem>0&&(c+=1,x.beam_st&&x.nflags>=-1&&!x.in_tuplet&&(l=x.ys-6)):x.stem<0&&(c-=5,x.beam_st&&x.nflags>=-1&&!x.in_tuplet&&(l=x.ys+6)))),A.type!=C.NOTE&&(o=l+1.2*g,(a=A.x+.5*A.wr)>c-12&&(a=c-12)),x.type!=C.NOTE&&(l=A.type==C.NOTE?o+1.2*g:o,A!=x&&(c=x.x-.3*x.wl)),w>=3&&((i=t[1]).type!=C.BAR&&i.x<a+48&&(g>0?o<(h=i.ymx-2)&&(o=h):o>(h=i.ymn+2)&&(o=h)),(i=t[b-1]).type!=C.BAR&&i.x>c-48&&(g>0?l<(h=i.ymx-2)&&(l=h):l>(h=i.ymn+2)&&(l=h))),(($=(l-o)/(c-a))>SLUR_SLOPE||$<-SLUR_SLOPE)&&(($=$>SLUR_SLOPE?SLUR_SLOPE:-SLUR_SLOPE)*g>0?o=l-$*(c-a):l=o+$*(c-a)),(h=l-o)>8?h=8:h<-8&&(h=-8),(p=h)<0&&(p=-p),_=.5*p,m=.3*h,h*g>0?(c-=_,l-=m):(a+=_,o+=m),A.grace&&(a=A.x-.5*GSTEM_XOFF),x.grace&&(c=x.x+1.5*GSTEM_XOFF),d=0,$=(l-o)/(c-a),A!=x&&A.v==x.v){for(f=o-$*a,n=1;n<b;n++)if((i=t[n]).st==k)switch(i.type){case C.NOTE:case C.REST:g>0?((h=3*(i.notes[i.nhd].pit-18)+6)<i.ymx&&(h=i.ymx),(h-=$*i.x+f)>d&&(d=h)):((h=3*(i.notes[0].pit-18)-6)>i.ymn&&(h=i.ymn),(h-=$*i.x+f)<d&&(d=h));break;case C.GRACE:for(s=i.extra;s;s=s.next)g>0?((h=3*(s.notes[s.nhd].pit-18)+6)<s.ymx&&(h=s.ymx),(h-=$*s.x+f)>d&&(d=h)):((h=3*(s.notes[0].pit-18)-6)>s.ymn&&(h=s.ymn),(h-=$*s.x+f)<d&&(d=h))}o+=.45*d,l+=.45*d,d*=.65}for(u=w>3?(.08*(c-a)+12)*g:(.03*(c-a)+8)*g,g>0?(u<3*d&&(u=3*d),u>40&&(u=40)):(u>3*d&&(u=3*d),u<-40&&(u=-40)),(h=l-o)<0&&(h=-h),g>0?u<.8*h&&(u=.8*h):u>-.8*h&&(u=-.8*h),slur_out(a,o,c,l,g,u*=cfmt.slurheight,y&C.SL_DOTTED),f=o-($=(l-o)/(_=c-a))*a,u>0?f+=4*Math.sqrt(u)-2:f-=4*Math.sqrt(-u)-2,n=0;n<b;n++)(i=t[n]).st==k&&(h=$*i.x+f,i.ymx<h?i.ymx=h:i.ymn>h&&(i.ymn=h),n==b-1?(_=c,x.sl1&&(_-=5),h-=u/3):_=t[n+1].x,0!=n?a=i.x:h-=u/3,y_set(k,g>0,a,_-=a,h))}function draw_slurs(t,e){var r,n,i,s,a,o;function c(t,n,i){var s,a,o,c,l=[],u=n.note.s;if(!(e&&u.time>e.time)){if(tsnext&&u.time>=tsnext.time){for(t.p_v.sls.push(n),u=t.p_v.s_next.prev;u.next;)u=u.next;(n=Object.create(n)).note={s:u}}switch(7&n.ty){case C.SL_ABOVE:c=1;break;case C.SL_BELOW:c=-1;break;default:c=t.v!=u.v?-1:slur_direction(t,u),n.ty&=-8,n.ty|=c>0?C.SL_ABOVE:C.SL_BELOW}if(t.v==u.v&&(a=t.v),a=cur_sy.voices[t.v]&&cur_sy.voices[u.v]?c*(cur_sy.voices[t.v].range<=cur_sy.voices[u.v].range?1:-1)>0?t.v:u.v:t.v>u.v?t.v:u.v,!r||u.grace&&t.v==u.v&&t.time==u.time)l.push(t),t=t.grace?t.next:t.ts_next;else{do{l.push(t),t=t.next}while(t);t=r.next}if(u.grace)if(t.grace)for(;l.push(t),t!=u;)t=t.next;else{for(s=u;s.prev;)s=s.prev;for(;t.v==a&&l.push(t),t.extra!=s;)t=t.ts_next;for(t=s;l.push(t),t!=u;)t=t.next}else for(;t&&(t.v==a&&l.push(t),t!=u);)t=t.ts_next;for(o=1;o<l.length-1;o++)((t=l[o]).sls||t.sl1)&&draw_slurs(t,e),t.tp&&draw_tuplet(t);return draw_slur(l,i,n),1}}for(;;){if(!t||t==e){if(!r||!(t=r.next)||t==e)break;r=null}if(t.type!=C.GRACE){if(t.sls){for(a=t.sls,t.sls=null,o=[],n=0;n<a.length;n++)c(t,a[n])||o.push(a[n]);o.length&&(t.sls=o)}if(t.sl1)for(i=0;i<=t.nhd;i++)if((s=t.notes[i]).sls){for(a=s.sls,s.sls=null,o=[],n=0;n<a.length;n++)c(t,a[n],s)||o.push(a[n]);o.length&&(s.sls=o)}t=t.next}else r=t,t=t.extra}}function draw_tuplet(t){var e,r,n,i,s,a,o,c,l,u,f,$,h,p,d,_,m,y,g=t.tp.shift();for(t.tp.length||delete t.tp,i=t.st,set_dscale(t.st),e=t;e;e=e.next)if(e.type==C.NOTE||e.type==C.REST){if((e.sls||e.sl1)&&draw_slurs(e),e.st<i&&(i=e.st),e.tp&&draw_tuplet(e),e.tpe)break}else if(e.type==C.GRACE)for(n=e.extra;n;n=n.next)(n.sls||n.sl1)&&draw_slurs(n);if(e){if(e.tpe--,1!=g.f[0]){if(!(m=g.f[3])){for(r=t;r.type!=C.NOTE;)r=r.next;m=r.stem>0?C.SL_ABOVE:C.SL_BELOW}if(t==e||2==g.f[1])s=!0;else if(1==g.f[1])s=!0,draw_slur([t,e],null,{ty:m});else if(2!=g.f[0]&&t.type==C.NOTE&&e.type==C.NOTE){for(s=!0,r=t;;r=r.next){if(r.type!=C.NOTE&&r.type!=C.REST){if(r.type==C.GRACE||r.type==C.SPACE)continue;s=!1;break}if(r==e)break;if(r.beam_end){s=!1;break}}if(s&&!t.beam_st&&!t.beam_br1&&!t.beam_br2)for(r=t.prev;r;r=r.prev)if(r.type==C.NOTE||r.type==C.REST){r.nflags>=t.nflags&&(s=!1);break}if(s&&!e.beam_end)for(r=e.next;r;r=r.next)if(r.type==C.NOTE||r.type==C.REST){!r.beam_br1&&!r.beam_br2&&r.nflags>=e.nflags&&(s=!1);break}}if(s){if(1==g.f[2])return;for(u=(e.x+t.x)/2,_=e.x-t.x,f=m==C.SL_ABOVE?y_get(i,1,u-_/2,_)+2:y_get(i,0,u-_/2,_)-10,t.stem*e.stem>0&&(t.stem>0?u+=1.5:u-=1.5),0==g.f[2]?out_bnum(u,f,g.p):out_bnum(u,f,g.p+":"+g.q),r=t;!(r.x>=u);r=r.next);m==C.SL_ABOVE?(f+=10,r.ymx<f&&(r.ymx=f),y_set(i,!0,u-3,6,f)):(r.ymn>f&&(r.ymn=f),y_set(i,!1,u-3,6,f))}else{if(a=t.x-4,e.dur>e.prev.dur){if(!(r=e.next)||r.time!=e.time+e.dur)for(r=e.ts_next;r&&!(r.seqst&&r.time>=e.time+e.dur);r=r.ts_next);o=r?r.x-r.wl-5:realwidth-6}else o=e.x+4,y=e.stem>=0?0:e.nhd,e.notes[y].shhd>0&&(o+=e.notes[y].shhd),e.st==i&&e.stem>0&&(o+=3.5);if(m==C.SL_ABOVE){if(t.st==e.st?c=l=staff_tb[i].topbar+4:(c=t.ymx,l=e.ymx),t.st==i){for(r=t;!r.dur;r=r.next);(f=y_get(i,1,r.x-4,8))>c&&(c=f),t.stem>0&&(a+=3)}if(e.st==i){for(r=e;!r.dur;r=r.prev);(f=y_get(i,1,r.x-4,8))>l&&(l=f)}for(u=.5*(a+o),f=.5*(c+l),_=(l-c)/(o-a),($=3*(e.notes[e.nhd].pit-t.notes[t.nhd].pit)/(o-a))>0?_<0?_=0:_>$&&(_=$):_>0?_=0:_<$&&(_=$),_*_<.1*.1&&(_=0),d=0,r=t;;r=r.next)if(r.dur&&r.st==i){if(h=f+(r.x-u)*_,(p=y_get(i,1,r.x-4,8)+2)-h>d&&(d=p-h),r==e)break}else if(r==e)break;for(c=(f+=d)+_*(a-u),l=f+_*(o-u),f+=8,r=t;;r=r.next)if(r.st==i){if(h=f+(r.x-u)*_,r.ymx<h&&(r.ymx=h),r==e)break;y_set(i,!0,r.x,r.next.x-r.x,h)}else if(r==e)break}else{if(t.stem<0&&(a-=2),t.st==i){for(r=t;!r.dur;r=r.next);c=y_get(i,0,r.x-4,8)}else c=0;if(e.st==i){for(r=e;!r.dur;r=r.prev);l=y_get(i,0,r.x-4,8)}else l=0;for(u=.5*(a+o),f=.5*(c+l),_=(l-c)/(o-a),($=3*(e.notes[0].pit-t.notes[0].pit)/(o-a))>0?_<0?_=0:_>$&&(_=$):_>0?_=0:_<$&&(_=$),_*_<.1*.1&&(_=0),d=0,r=t;;r=r.next)if(r.dur&&r.st==i){if(h=f+(r.x-u)*_,(p=y_get(i,0,r.x-4,8))-h<d&&(d=p-h),r==e)break}else if(r==e)break;for(c=(f+=d-10)+_*(a-u),l=f+_*(o-u),f-=2,r=t;;r=r.next){if(r.st==i){if(r==e)break;h=f+(r.x-u)*_,r.ymn>h&&(r.ymn=h),y_set(i,!1,r.x,r.next.x-r.x,h)}if(r==e)break}}1!=g.f[2]?(out_tubrn(a,c,o-a,l-c,m==C.SL_ABOVE,0==g.f[2]?g.p.toString():g.p+":"+g.q),m==C.SL_ABOVE?y_set(i,!0,u-3,6,h+2):y_set(i,!1,u-3,6,h)):out_tubr(a,c+4,o-a,l-c,m==C.SL_ABOVE)}}}else error(1,t,"No end of tuplet in this music line")}function draw_note_ties(t,e){var r,n,i,s,a,o=t.tie_n,c=2==e?t.pit:o.pit,l=(7&t.tie_ty)==C.SL_ABOVE?1:-1,u=t.s,f=u.st,$=o.s,h=$.x,p=t.shhd;for(r=0;r<u.nhd&&u.notes[r]!=t;r++);if(l>0?r<u.nhd&&c+1==u.notes[r+1].pit&&u.notes[r+1].shhd>p&&(p=u.notes[r+1].shhd):r>0&&c==u.notes[r-1].pit+1&&u.notes[r-1].shhd>p&&(p=u.notes[r-1].shhd),n=u.x+p,2!=e){for(r=0;r<$.nhd&&$.notes[r]!=o;r++);p=$.notes[r].shhd,l>0?r<$.nhd&&c+1==$.notes[r+1].pit&&$.notes[r+1].shhd<p&&(p=$.notes[r+1].shhd):r>0&&c==$.notes[r-1].pit+1&&$.notes[r-1].shhd<p&&(p=$.notes[r-1].shhd),h+=p}switch(e){case 0:c=1&t.pit?t.pit:o.pit;break;case 3:l=-l;case 1:(n=u.x)>h-20&&(n=h-20),c=o.pit,f=$.st;break;default:if(u!=$)h-=$.wl,$.type==C.BAR&&(h+=5);else{for(a=u.time+u.dur,i=u.ts_next;i&&!(i.time>a);i=i.ts_next);h=i?i.x:realwidth}h<n+16&&(h=n+16)}h-n>20?(n+=3.5,h-=3.5):(n+=1.5,h-=1.5),!u.dots||1&t.pit||!(l>0&&!u.dot_low||l<0&&u.dot_low)||(n+=5),slur_out(n,s=staff_tb[f].y+3*(c-18)+l,h,s,l,(.03*(h-n)+16)*l*cfmt.tieheight,t.tie_ty&C.SL_DOTTED)}function draw_ties(t,e,r){var n,i,s,a,o,c,l,u=[],f=t.nhd;if(2!=r){for(i=0;i<=f;i++)(a=t.notes[i]).tie_ty&&(a.s||(a.s=t),a.tie_n?draw_note_ties(a,r):u.push(a));if(u.length){for(c=t.time+t.dur,n=t.ts_next,1!=r&&(r=0);n&&n.time<c;)n=n.ts_next;for(;n&&n.time==c;)if(n.type==C.NOTE&&n.st==t.st){for(i=u.length;--i>=0;)for(l=(a=u[i]).opit||a.pit,s=n.nhd;s>=0;s--)if(((o=n.notes[s]).opit||o.pit)==l){a.tie_n=o,o.s||(o.s=n),draw_note_ties(a,r),u.splice(i,1);break}if(!u.length)break;n=n.ts_next}else n=n.ts_next;u.length&&error(1,t,"Bad tie")}}else for(i=0;i<=f;i++)(a=t.notes[i]).tie_ty&&(n=a.tie_n,a.tie_n={s:e||t},draw_note_ties(a,r),a.tie_n=n)}function draw_all_ties(t){var e,r,n,i,s,a,o,c;function l(t,e,r){if(t.type==C.GRACE)for(var n=t.extra;n;n=n.next)n.tie_s&&draw_ties(n,e,r);else draw_ties(t,e,r)}for(set_color((c=t.sym).color);;){for(r=c;r&&(!r.ti2||r==c&&c.prev||((e=r.ti2).x=r.x,n=e.next,e.next=r,e.st=r.st,e.time=r.time-e.dur,draw_ties(e,r,1),e.next=n),!r.tie_s);r=r.next);if(!r)break;if((n=r.tie_s).v==r.v)for(c=n,e=r;;){if(!e.next){n=e,e=null;break}if((e=e.next)==n)break}else{for(c=r.next,e=r;;){if(!e.ts_next){e=null;break}if((e=e.ts_next)==n)break}if(!e)for(n=r;n.next;)n=n.next}if(!e){l(r,n,2);break}for(s=r.time+e.dur,e=r.ts_next;e!=n;e=e.ts_next)if(e.st==r.st){if(e.time>s)break;if(e.type==C.CLEF){i=!0;break}}i||r.st!=n.st?(i=!1,o=.4*(n.x-r.x),a=n.x,n.x-=o,n.x>r.x+32&&(n.x=r.x+32),l(r,n,2),n.x=a,a=r.x,r.x+=o,r.x<n.x-24&&(r.x=n.x-24),draw_ties(r,n,3),r.x=a):l(r,n,n.type==C.NOTE?0:2)}}function draw_sym_near(){var t,e,r,n,i,s,a,o,c,l,u,f,$=output;for(output="",n=0;n<voice_tb.length;n++){var h={},p=!0;for(r=(t=voice_tb[n]).sym;r;r=r.next)switch(r.type){case C.GRACE:for(s=r.extra;s;s=s.next)s.beam_st&&!s.beam_end&&self.calculate_beam(h,s);break;case C.NOTE:(r.beam_st&&!r.beam_end||p&&!r.beam_st)&&(p=!1,self.calculate_beam(h,r))}}for(c=0;c<=nstaff;c++)for((e=staff_tb[c]).top||(e.top=new Float32Array(YSTEP),e.bot=new Float32Array(YSTEP)),o=0;o<YSTEP;o++)e.top[o]=0,e.bot[o]=24;for(set_tie_room(),draw_deco_near(),r=tsfirst;r;r=r.ts_next)if(!r.invis){switch(r.type){case C.GRACE:for(s=r.extra;s;s=s.next)y_set(r.st,!0,s.x-2,4,s.ymx+1),y_set(r.st,!1,s.x-2,4,s.ymn-1);continue;case C.MREST:y_set(r.st,!0,r.x+16,32,r.ymx+2);continue;default:y_set(r.st,!0,r.x-r.wl,r.wl+r.wr,r.ymx+2),y_set(r.st,!1,r.x-r.wl,r.wl+r.wr,r.ymn-2);continue;case C.NOTE:}r.stem>0?(r.stemless?(l=-5,a=10):r.beam_st?(l=3,a=r.beam_end?4:10):(l=-8,a=r.beam_end?11:16),y_set(r.st,!0,r.x+l,a,r.ymx),y_set(r.st,!1,r.x-r.wl,r.wl+r.wr,r.ymn)):(y_set(r.st,!0,r.x-r.wl,r.wl+r.wr,r.ymx),r.stemless?(l=-5,a=10):r.beam_st?(l=-6,a=r.beam_end?4:10):(l=-8,a=r.beam_end?5:16),l+=r.notes[0].shhd,y_set(r.st,!1,r.x+l,a,r.ymn)),r.notes[r.nhd].acc&&(i=r.y+8,r.ymx<i&&(r.ymx=i),y_set(r.st,!0,r.x,0,i)),r.notes[0].acc&&(i=r.y,1==r.notes[0].acc||3==r.notes[0].acc?i-=7:i-=5,r.ymn>i&&(r.ymn=i),y_set(r.st,!1,r.x,0,i))}for(draw_deco_note(),n=0;n<voice_tb.length;n++)if(r=(t=voice_tb[n]).sym)for(set_color(r.color),c=t.st;r;r=r.next)r.tp&&draw_tuplet(r),(r.sls||r.sl1)&&draw_slurs(r);for(set_color(),c=0;c<=nstaff;c++)for(u=(e=staff_tb[c]).topbar+2,f=e.botbar-2,o=0;o<YSTEP;o++)u>e.top[o]&&(e.top[o]=u),f<e.bot[o]&&(e.bot[o]=f);for(cfmt.measurenb>=0&&draw_measnb(),draw_deco_staff(),set_dscale(-1),n=0;n<voice_tb.length;n++)if((t=voice_tb[n]).have_ly){draw_all_lyrics();break}set_dscale(-1),output=$}function draw_vname(t){var e,r,n,i,s,a,o,c,l,u,f=[];for(n=cur_sy.nstaff;n>=0&&!cur_sy.st_print[n];n--);if(!(n<0)){for(i=0;i<voice_tb.length;i++)if((e=voice_tb[i]).sym&&cur_sy.voices[i]&&(n=cur_sy.voices[i].st,cur_sy.st_print[n])){if(e.new_name){c=2;break}e.snm&&(c=1)}if(c){for(i=0;i<voice_tb.length;i++)(e=voice_tb[i]).sym&&cur_sy.voices[i]&&(n=cur_sy.voices[i].st,cur_sy.st_print[n]&&(e.new_name&&delete e.new_name,(a=2==c?e.nm:e.snm)&&(f[n]?f[n]+="\\n"+a:f[n]=a)));if(0!=f.length)for(set_font("voice"),u=(l=gene.curfont.size)/2,t=.5*-t,n=0;n<f.length;n++)if(f[n])for(s=f[n].split("\\n"),o=staff_tb[n].y+.5*staff_tb[n].topbar*staff_tb[n].staffscale+u*(s.length-2),cur_sy.staves[n].flags&OPEN_BRACE&&cur_sy.staves[n+1].flags&CLOSE_BRACE&&!f[n+1]&&(o-=.5*(staff_tb[n].y-staff_tb[n+1].y)),r=0;r<s.length;r++)xy_str(t,o,a=s[r],"c"),o-=l}}}function set_staff(){var t,e,r,n,i,s,a,o,c,l,u,f,$=cur_sy;for(n=0;n<voice_tb.length;n++)1!=(u=voice_tb[n]).scale&&(u.scale_str='transform="scale('+u.scale.toFixed(2)+')"');for(e=0;e<=nstaff&&!gene.st_print[e];e++);if(i=0,e>nstaff)f=staff_tb[--e];else for(f=staff_tb[e],t=0;t<YSTEP;t++)i<(l=f.top[t])&&(i=l);if(i+=draw_partempo(e,i),!gene.st_print[e])return i;(i*=f.staffscale)<(s=.5*cfmt.staffsep+f.topbar*f.staffscale)&&(i=s),i<f.ann_top&&(i=f.ann_top),f.y=-i,r=e;var h=$.staves[r];for(e++;e<=nstaff;e++)if(gene.st_print[e]){if(f=staff_tb[e],s=h.sep||cfmt.sysstaffsep,o=h.maxsep||cfmt.maxsysstaffsep,a=0,f.staffscale==staff_tb[r].staffscale){for(t=0;t<YSTEP;t++)a<(l=f.top[t]-staff_tb[r].bot[t])&&(a=l);a*=f.staffscale}else for(t=0;t<YSTEP;t++)a<(l=f.top[t]*f.staffscale-staff_tb[r].bot[t]*staff_tb[r].staffscale)&&(a=l);for(a<(s+=f.topbar*f.staffscale)&&(a=s),a>(o+=f.topbar*f.staffscale)&&(a=o),i+=a,f.y=-i,r=e;!(h=$.staves[r]);)$=$.next}for(c=0,t=0;t<YSTEP;t++)c>(l=staff_tb[r].bot[t])&&(c=l);for(c>f.ann_bot&&(c=f.ann_bot),c*=staff_tb[r].staffscale,e=0;e<=nstaff;e++)a=(f=staff_tb[e]).y,1!=f.staffscale&&(f.scale_str='transform="translate(0,'+(posy-a).toFixed(1)+") scale("+f.staffscale.toFixed(2)+')"');if(0==c){for(e=nstaff;e>=0&&!gene.st_print[e];e--);if(e<0)return i}return(a=-c)<(s=.5*cfmt.staffsep)&&(a=s),a>(o=.5*cfmt.maxstaffsep)&&(a=o),i+a}function draw_systems(t){var e,r,n,i,s,a,o,c,l=[],u=[],f=[],$=[],h=[],p=[];function d(){var t,e,r,n,i=0;for(t=0;t<=cur_sy.nstaff;t++)l[t]<0?u[t]=f[t]=0:(e=staff_tb[t].staffscale,r=staff_tb[t].topbar*e,n=staff_tb[t].botbar*e,0==i&&(i=staff_tb[t].y+r),u[t]=staff_tb[t].y+n,f[t]=i-u[t],i=cur_sy.staves[t].flags&STOP_BAR?0:u[t])}function _(t,e,r){var n,i,s,a,o,c=0,l="",u=staff_tb[t].stafflines,f=u.length;if(/[\[|]/.test(u))if(n=r-e,set_sscale(t),i=n/stv_g.scale,cache&&cache.st_l==u&&cache.st_ws==(0|i))xygl(e,staff_tb[t].y,"stdef"+cfmt.fullsvg);else{for(s=0;s<f;s++,c-=6)if("."!=u[s]){for(a=0;s<f;s++,c-=6,a-=6){switch(u[s]){case".":case"-":continue;case o:l+="m-"+i.toFixed(1)+" "+a+"h"+i.toFixed(1),a=0;continue}null!=o&&(l+='"/>\n'),l+='<path class="'+("["==(o=u[s])?"slthW":"slW")+'" d="m0 '+c+"h"+i.toFixed(1),a=0}l+='"/>'}if(c=staff_tb[t].y,!cache&&n>get_lwidth()-10)return cache={st_l:u,st_ws:0|i},s="stdef"+cfmt.fullsvg,l.indexOf("<path",1)<0?glyphs[s]=l.replace("path",'path id="'+s+'"'):glyphs[s]='<g id="'+s+'">\n'+l+"\n</g>",void xygl(e,c,s);out_XYAB('<g transform="translate(X, Y)">\n'+l+"\n</g>\n",e,c)}}function m(t,e,r){var n,i,s,a=t.bar_type,o=t.st,c=staff_tb[o],l=t.x;if(0!=o&&t.ts_prev&&t.ts_prev.type!=C.BAR&&(r=c.topbar*c.staffscale),t.ymx=t.ymn+r,anno_start(t),t.color&&set_color(t.color),s=c.y+12,"|||||"!=c.stafflines&&(s+=(c.topbar+c.botbar)/2-12),t.bar_mrep)if(set_sscale(o),1==t.bar_mrep){for(i=t.prev;i.type!=C.REST;i=i.prev);xygl(i.x,s,"mrep")}else xygl(l,s,"mrep2"),t.v==cur_sy.top_voice&&xy_str(l,s+c.topbar-9,t.bar_mrep.toString(),"c");for("||:"==a&&(a="[|:"),n=a.length;--n>=0;){switch(a[n]){case"|":t.bar_dotted?(set_sscale(-1),out_XYAB('<path class="bW" stroke-dasharray="A,A" d="MX Yv-G"/>\n',l,e,(5*c.staffscale).toFixed(1),r)):t.color?out_XYAB('<path class="bW" d="MX Yv-F"/>\n',l,e,r):h.push(new Float32Array([l,e,r]));break;default:l-=3,t.color?out_XYAB('<path class="bthW" d="MX Yv-F"/>\n',l+1.5,e,r):p.push(new Float32Array([l+1.5,e,r]));break;case":":l-=2,set_sscale(o),xygl(l+1,s-12,"rdots")}l-=3}set_color(),anno_stop(t)}for(draw_vname(t),n=0;n<=nstaff;n++)l[n]=cur_sy.st_print[n]?0:-1;for(d(),draw_lstaff(0),e=tsfirst;e;e=e.ts_next){if(c&&e.time!=c){for(c=0,n=0;n<=nstaff;n++)cur_sy.st_print[n]||(l[n]=-1);d()}switch(e.type){case C.STAVES:if(!(o=e.ts_prev.type==C.BAR?e.ts_prev.x:0)){for(r=e.ts_next;r&&r.time==e.time;r=r.ts_next){switch(r.type){case C.BAR:case C.CLEF:case C.KEY:case C.METER:o=r.x;continue}break}r||(o=realwidth)}for(a=e.sy,n=0;n<=nstaff;n++)(i=l[n])<0?a.st_print[n]&&(l[n]=o||e.x-e.wl-2):a.st_print[n]&&a.staves[n].stafflines==cur_sy.staves[n].stafflines||(o?(s=o,c=e.time):(s=e.x-e.wl-2,l[n]=-1),_(n,i,s),a.st_print[n]&&(l[n]=s));cur_sy=a,d();continue;case C.BAR:if(e.second||e.invis||!e.bar_type)break;$.push([e,u[e.st],f[e.st]]);break;case C.STBRK:if(cur_sy.voices[e.v]&&0==cur_sy.voices[e.v].range&&e.xmx>14){for(var y=0,g=0;g<voice_tb.length;g++)cur_sy.voices[g]&&cur_sy.voices[g].range>0&&y++;for(r=e.ts_next;r&&r.type==C.STBRK;r=r.ts_next)y--;0==y&&draw_lstaff(e.x)}if(n=e.st,(i=l[n])>=0){if(!(r=e.prev))break;if(i>=(s=r.type==C.BAR?r.x:e.x-e.xmx))break;_(n,i,s),l[n]=e.x}}}for(n=0;n<=nstaff;n++)c&&!cur_sy.st_print[n]||(i=l[n])<0||i>=realwidth||_(n,i,realwidth);!function(){var t,e,r,n=$.length;for(set_font("annotation"),gene.curfont.box&&(gene.curfont.box=!1,r=!0),t=0;t<n;t++)m((e=$[t])[0],e[1],e[2]);if(r&&(gene.curfont.box=!0),set_sscale(-1),n=h.length){for(output+='<path class="bW" d="',t=0;t<n;t++)out_XYAB("MX Yv-F",(e=h[t])[0],e[1],e[2]);output+='"/>\n'}if(n=p.length){for(output+='<path class="bthW" d="',t=0;t<n;t++)out_XYAB("MX Yv-F",(e=p[t])[0],e[1],e[2]);output+='"/>\n'}}()}function draw_all_sym(){var t,e,r=voice_tb.length;for(e=0;e<r;e++)(t=voice_tb[e]).sym&&null!=t.sym.x&&(self.draw_symbols(t),draw_all_ties(t),set_color());draw_all_deco(),function(){var t,e;function r(t,r){var n,i,s,a,o,c,l=t.length;if(l)for(s=0;s<l;s++)if((i=t[s])&&i.length){for(a=sx(i[0][0]),output+='<path class="stroke" stroke-width="1" d="M'+a.toFixed(1)+" "+sy(e.y+r*s).toFixed(1),o=0;n=i.shift();)c=sx(n[0]),output+="m"+(c-a+n[1]-o).toFixed(1)+" 0h"+(-n[1]+n[2]).toFixed(1),a=c,o=n[2];output+='"/>\n'}}for(t=0;t<=nstaff;t++)(e=staff_tb[t]).hlu&&(set_sscale(t),r(e.hlu,6),r(e.hld,-6))}(),set_sscale(-1)}function set_tie_dir(t){for(var e,r,n,i,s,a;t;t=t.next)if(t.tie_s)if(0==t.multi){for(i=r=0,s=128,e=0;e<=t.nhd;e++)t.notes[e].tie_ty&&(r++,s<128&&t.notes[e].pit<=s+1&&i++,s=t.notes[e].pit);if(r<=1){for(n=t.stem<0?C.SL_ABOVE:C.SL_BELOW,e=0;e<=t.nhd;e++)if(a=t.notes[e].tie_ty){(7&a)==C.SL_AUTO&&(t.notes[e].tie_ty=a&C.SL_DOTTED|n);break}}else if(0!=i){for(s=128,e=0;e<=t.nhd;e++)if(t.notes[e].tie_ty){if(s<128&&t.notes[e].pit<=s+1){r=e;break}s=t.notes[e].pit}for(n=C.SL_BELOW,e=0;e<=t.nhd;e++)(a=t.notes[e].tie_ty)&&(r==e&&(n=C.SL_ABOVE),(7&a)==C.SL_AUTO&&(t.notes[e].tie_ty=a&C.SL_DOTTED|n))}else{if(1&r){for(r=(r-1)/2,n=C.SL_BELOW,e=0;e<=t.nhd;e++)(a=t.notes[e].tie_ty)&&(0==r&&t.notes[e].pit>=22&&(n=C.SL_ABOVE),(7&a)==C.SL_AUTO&&(t.notes[e].tie_ty=a&C.SL_DOTTED|n),0==r--&&(n=C.SL_ABOVE));continue}for(r/=2,n=C.SL_BELOW,e=0;e<=t.nhd;e++)(a=t.notes[e].tie_ty)&&((7&a)==C.SL_AUTO&&(t.notes[e].tie_ty=a&C.SL_DOTTED|n),0==--r&&(n=C.SL_ABOVE))}}else for(n=t.multi>0?C.SL_ABOVE:C.SL_BELOW,e=0;e<=t.nhd;e++)(7&(a=t.notes[e].tie_ty))==C.SL_AUTO&&(t.notes[e].tie_ty=a&C.SL_DOTTED|n)}function set_tie_room(){var t,e,r,n,i,s;for(r=0;r<voice_tb.length;r++)if((t=voice_tb[r].sym)&&(t=t.next))for(set_tie_dir(t);t;t=t.next)if(t.tie_s){if(t.notes[0].pit<20&&t.notes[0].tie_ty&&(7&t.notes[0].tie_ty)==C.SL_BELOW);else if(!(t.notes[t.nhd].pit>24&&t.notes[t.nhd].tie_ty&&(7&t.notes[t.nhd].tie_ty)==C.SL_ABOVE))continue;for(e=t.next;e&&e.type!=C.NOTE;)e=e.next;if(e){if(e.st!=t.st)continue;n=e.x-t.x-10}else n=realwidth-t.x-10;s=n<100?9:n<300?12:16,t.notes[t.nhd].pit>24&&(i=3*(t.notes[t.nhd].pit-18)+s,t.ymx<i&&(t.ymx=i),e&&e.ymx<i&&(e.ymx=i),y_set(t.st,!0,t.x+5,n,i)),t.notes[0].pit<20&&(i=3*(t.notes[0].pit-18)-s,t.ymn>i&&(t.ymn=i),e&&e.ymn>i&&(e.ymn=i),y_set(t.st,!1,t.x+5,n,i))}}Abc.prototype.draw_symbols=function(t){var e,r,n,i,s={};for(e=t.sym;e;e=e.next){if(e.invis)switch(e.type){case C.KEY:t.ckey=e;default:continue;case C.NOTE:}switch(i=e.st,r=e.x,set_color(e.color),e.type){case C.NOTE:set_scale(e),e.beam_st&&!e.beam_end&&self.calculate_beam(s,e)&&draw_beams(s),e.invis||(anno_start(e),draw_note(e,!s.s2),anno_stop(e)),e==s.s2&&(s.s2=null);break;case C.REST:if(!staff_tb[i].topbar)break;draw_rest(e);break;case C.BAR:break;case C.CLEF:if(e.time>=staff_tb[i].clef.time&&(staff_tb[i].clef=e),e.second||!staff_tb[i].topbar)break;set_color(),set_sscale(i),anno_start(e),n=staff_tb[i].y,e.clef_name?xygl(r,n+e.y,e.clef_name):e.clef_small?xygl(r,n+e.y,"s"+e.clef_type+"clef"):xygl(r,n+e.y,e.clef_type+"clef"),e.clef_octave&&(e.clef_octave>0?(n+=e.ymx-10,e.clef_small&&(n-=1)):(n+=e.ymn+6,e.clef_small&&(n+=1)),xygl(r-2,n,"oct")),anno_stop(e);break;case C.METER:if(t.meter=e,e.second||!staff_tb[e.st].topbar)break;set_color(),set_sscale(e.st),anno_start(e),draw_meter(r,e),anno_stop(e);break;case C.KEY:if(t.ckey=e,e.second||!staff_tb[e.st].topbar)break;set_color(),set_sscale(e.st),anno_start(e),self.draw_keysig(r,e),anno_stop(e);break;case C.MREST:set_scale(e),r+=32,anno_start(e),xygl(r,staff_tb[e.st].y+12,"mrest"),out_XYAB('<text style="font:bold 15px serif"\n\tx ="X" y="Y" text-anchor="middle">A</text>\n',r,staff_tb[e.st].y+28,e.nmes),anno_stop(e);break;case C.GRACE:set_scale(e),draw_gracenotes(e);break;case C.SPACE:case C.STBRK:break;case C.CUSTOS:set_scale(e),draw_note(e,0);break;case C.BLOCK:case C.PART:case C.REMARK:case C.STAVES:case C.TEMPO:break;default:error(2,e,"draw_symbols - Cannot draw symbol "+e.type)}}set_scale(t.sym)};var musicfont='url("data:application/octet-stream;base64,AAEAAAAOAIAAAwBgRkZUTYTd79wAAFggAAAAHEdERUYAFQAUAABYBAAAABxPUy8yWLxdCwAAAWgAAABWY21hcFxKS5kAAAQIAAADemN2dCAAIgKIAAAHhAAAAARnYXNw//8AAwAAV/wAAAAIZ2x5Zp276QgAAAiwAABGeGhlYWQPFh8MAAAA7AAAADZoaGVhCWn/GwAAASQAAAAkaG10eNzF+scAAAHAAAACSGxvY2GpopfcAAAHiAAAASZtYXhwANkBPQAAAUgAAAAgbmFtZbni4sIAAE8oAAADG3Bvc3Qtfw6AAABSRAAABbUAAQAAAAEAAI87udRfDzz1AAsEAAAAAADRlyIXAAAAANncuoH/OPzvBUsEiAAAAAgAAgAAAAAAAAABAAAEiPzvAFwEJf84/XQFSwABAAAAAAAAAAAAAAAAAAAAkgABAAAAkgEMAAUAAAAAAAIAAAABAAEAAABAAC4AAAAAAAEBhgGQAAUACAKZAswAAACPApkCzAAAAesAMwEJAAACAAUDAAAAAAAAAAAAARAAAAAAAAAAAAAAAFBmRWQAQAAA7LcDM/8zAFwEiAMRAAAAAQAAAAAAAAF2ACIAAAAAAVUAAAGQAAACWAAAAFcAAAFK/7ACE/+wANL/sAAjAAAAIwAAACMAAABkAAAEIwAABCUAAAHg/9wDXgB6AwsAAALSAAACv/+6AdYAAAMLAAADDgAAAyf/yADIAAABrgAAASIAAAGQAAABfAAAAZAAAAGQAAABgQAAAZAAAAGQAAABgQAAAZkACQGYAAkB9AAAAQQAFAEEAAoCawAkAhIAAAHCAAABSQAAAUAAAAFK//4BLAAAAjAAAAFKAAABSgAAAGQAAAFAAAABQAAAAUAAAAFAAAAAZAAAATYAAADmAAABNgAAATsAAAE7AAABOwAAATsAAAE7AAABOwAAATsAAAE7AAABOwAAATsAAAENAAAAyAAAAP8AAAELABQBbgAAAQ0AMgFu//UAqQAAAToAAAFA//0AUAAAAUAAAABkAAABGAAAAlgAAAC2AAAAggAAAIIAAAEsAAABLAAAAO4AAAD/AAABSQAAAY8AAAHYAAAB2AAAA1MAAAIz//ADIP/hAXv/tAG4/9sBFv9+ARP/2wDcAAAA6P/kAr//tAIz/7QCv/+0Ayv/2wFf/9sCaf9+AV//fgJp/34BXwAAAf0ABQG1AAABtQAAAkQADQJEAA0BGAAAATYAAAEs//8BLAAAAPoAAADIAAABGP84APoAAADIAAAEDQAAAhwADAH0AAAB9AAAAfQAAAH0AAAB9AAAAfQAAAB4AAAALQAAAhwAAAD6AAAA+v/oAcIAAAFIAAABQAAAAgoAAAIKAAAAZAAAAAAAAwAAAAMAAAAcAAEAAAAAAnQAAwABAAAAHAAEAlgAAACSAIAABgASAAAAIOAA4CTgMOA54EPgSOBQ4FzgYuBp4H3gjOCV4KTgqeCz4QHhueG74efh8uH04ffh+eH84gDiSeJk4oPkoOSi5KTkqOSs5MDkzuTq5O7lAeUl5S3lMeU55WflaeVt5YLl0OXi5hDmEuYU5hjmJOYw5lDmVekS6RXpGOkg6SXpXeoC6qTso+yl7Kfsqey3//8AAAAAACDgAOAi4DDgOOBD4EXgUOBc4GLgaeB64IDglOCg4Kngs+EB4bnhu+Hn4fLh9OH34fnh/OH+4kDiYOKA5KDkouSk5KjkrOTA5M7k4eTu5QDlIOUp5S/lOeVm5WnlbOWC5dDl4uYQ5hLmFOYY5iTmMOZQ5lXpEOkU6RjpIOkl6V3qAuqk7KLspeyn7Knst///AAP/5CAFH+Qf2R/SH8kfyB/BH7YfsR+rH5sfmR+SH4gfhB97Hy4edx52HkseQR5AHj4ePR47Hjod+x3lHcobrhutG6wbqRumG5Mbhht0G3EbYBtCGz8bPhs3GwsbChsIGvQapxqWGmkaaBpnGmQaWRpOGi8aKxdxF3AXbhdnF2MXLBaIFecT6hPpE+gT5xPaAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQYAAAMAAAAAAAAAAQIAAAACAAAAAAAAAAAAAAAAAAAAAQAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAiAogAAAAqACoAKgA2AD4AbgB8AIoAmACkALAAvgDcAVABrAIcAl4C6gN8A9wD8ASMBR4FdgW0BdYF6gY8BowGrAbyBzIHbAe4B/gIPgiYCKwI0gj4CSoJRgloCZQJqgnECfoKCAoUCiAKMgpOCnAKfgqSCqQKtAsACxALKgtEC3wLtAwCDE4MtA0WDZQODA4yDkwOfA6mDv4PJA9+D54P3BAEEBgQJBAyEEIQahCQEJwQqBC0EMAQ4hEIET4RjBHsEmASdhKcEsoTHhOSE+YUJhRqFMAWGhcmF+AYoBlwGgwa6hwGHQgdSh2OHdgd8h4WHioePh5uHn4ekB6sHsIe5h8WH/ggtCDcIPohLCFqIZwh3iHwIf4iGiI0IloifCKqIsQi7iMqIzwAAAACACIAAAEyAqoAAwAHAC6xAQAvPLIHBADtMrEGBdw8sgMCAO0yALEDAC88sgUEAO0ysgcGAfw8sgECAO0yMxEhESczESMiARDuzMwCqv1WIgJmAAABAAAAAAGRAZAAAwAAMREhEQGRAZD+cAABAAAAAAAAAAAAAAAAMQAAAQAAAAAAVwQDACAAABE1NjU0JyY1NDcGFRQXFhUUBxYVFAcGFRQXJjU0NzY1NDUjElc/FSVNTSUVP1cSIwIDAhhDNmA5NGY6MksiOWFNYRgYZkxgOSVKMjpmNDlgNkgAAf+w/+wBmgAUAAMAACchFSFQAer+FhQoAAAAAAH/sP/sAmIAFAADAAAnIRUhUAKy/U4UKAAAAAAB/7D/7AEiABQAAwAAJyEVIVABcv6OFCgAAAAAAQAAAAAAIwPoAAMAABEzESMjIwPo/BgAAQAAAfQAIwPoAAMAABEzESMjIwPo/gwAAQAAAvgAIwRWAAMAABE3ESMjIwRMCv6iAAAAAAIAAAFAAGQCngAHAA8AABIiJjQ2MhYUAiImNDYyFhRHKh0dKh0dKh0dKh0COh0qHR0q/ukdKh0dKgAAAAUAAAAABCQBrgAvADcAPwBHAFMAACE1Mx4BMzI2NTQnLgQ1NDYzMhYXNzMXIy4BIyIGFRQeAxceARUUBiMiJwcgIiY0NjIWFAQiJjQ2MhYUAREzMjY0JiMDNTMRIzUzMhYVFCMCTh4VTzIpO5QZGioWEVk9JCcZHh4HHg9KMB85ECIZMghOTVtPRS4jAZsqHR0qHf3qKh0dKh3+iSg8RkY83EZG3HGJ+qA8SyAhLSgHCBQUIxVDTQsOGZs6SCgbDxcPCQsCFTczOk4gIB0qHR0qHR0qHR0qAWn+mGGmYf56HgFoHmdr0gAFAAAAAAQkAa4AGgAiACoAMgA+AAAhIiY1NDYzMhYXNzMXByYjIgYUFjMyNjcXDgEyIiY0NjIWFAQiJjQ2MhYUAREzMjY0JiMDNTMRIzUzMhYVFCMDAmd1glolKRseHgghJF44NjY4Nk0RIxRZsSodHSod/eoqHR0qHf6JKDxGRjzcRkbccYn6a2dldwwSHqYEjG2YbUk+CkpRHSodHSodHSodHSoBaf6YYaZh/noeAWgeZ2vSAAAAA//cAAIB3gKzAAcADwBNAAAAIiY0NjIWFAQiJjQ2MhYUFzQ2MzIWFRQHFjMyNjU0LwEDJxMuATU0PgE3NjMyFhUUBiMiJjU0NyYjIgYVFB8BExcDHgEVFA4BBwYjIiYBniAYGCAY/n4gGBggGFsbFBMeLBcpJjYme88r0VpIHBMUJjMwOBsUEx4sFykmNiZ61CvVWkgcExQmMzA4AVIYIBgYIFQYIBgYINMSHBoRHQ4XLSYtJmX+3iABJUdxOBYtERETOCESHBoRHQ4XLSYtJmUBJh/+10dyOBYtERETOAAFAHr/NANeAlQAFwAbAB8AIwAnAAABMxUeARczFSMOAQcVIzUuAScjNTM+ATcRIxYXNxU2NyczJicHNQYHAdgoVXgHiooHeFUoVXgHiooHeFVwBWsoawVwcAVrKGsFAlSJCItgKGCLCImJCItgKGKJCP7lug7IyA66KLoOyMkOuwAAAAAEAAD9bwKnBIgACwBEAE4AYwAAAQYVFBc+ATU0Jw4BExcVFAYjIiY1NDYzMhYUBgcWMzI2PQEnBiMiJjU0Nz4GPwEmNTQ2NxYVFAYHFzYzMhYVFCc0JiMiBiMTPgEnDgEVFBYXLgE1NDcnDgEHHgEzMjcBbAcFSHU2OUJLF09NUl9AMi9BPy8tGC9AFxwNmNs6DSQgLh0xEhcWDWxJYlx5FBQLcYhOYlACBwIhW0HiNkYnHT0/phGPbAECoXkKFgNTNy0jWjGVSHINB177bOwDTFxTQS1IO1g3ARk8RgPpAsedhWYXMCUtGicOERCWZoyhBzrliKlfzwKcc866PmYB/p0SXfILRjEgQhIORUepLr1yl2eNowIAAgAA/fwC0gIAAGQAaAAAATI2NTQnJiMiBw4CByYnJicRIxEzETY3NjceAxcWMzI2NTQnJiMiBxYXFBYVFAYrASY1NDc2NzYzMhcWFxUUBgcGIyInBxc2MzIWFxYdAQYHBiMiJjU0NzMyFhUUBhUGBxYBMxEjAd4+Sg0aSUY8AgYKBCIaHi4cHC4eGiIGFAwZDyclMT0SJFIvMTINAjMhBUQFGlUnI15VNwhaSB8tND8iIj80QmYeKAg3Vl1MckQFITMCDzA1/k17e/4geEotLWxJBQ4bCmInKx/+BAQA/hEfKydiCyoXHQkbe0IxNmIaECgDDQQeKxkyFAtEGQ1PNFMSTm8cDRdLShc+LDlDElM0UE48MhkrHgQOBCYQHAPe/AAAAAP/uv2lAsMA/wAqADYAQgAANzQ2MzIWFxYVFAYHDgEHNjc+ATc2NTQmJy4BIyIGBz4BMzIWFRQHBiMiJgUiJjU0NjMyFhUUBiciJjU0NjMyFhUUBhOLZ1VrKy9GVWbPleWFMTQTChEdHDQzO2EWGCMbLj0nITEzRQKCFh0aFBUeGhoXGxwVFBwbHWKANDk+cn+6T2BNCD2FMWNQK2ZHUCMiF09GHhdBLzIgHlGKHBcWHB0VFh3yHhkVGhsUGR4AAAIAAP8GAXIA+gADAAcAADczEyMDMxMj3JQCltyUApb6/gwB9P4MAAAEAAD+CgIfA6oACQAgAGIAbQAAJRYXPgE1NCYjIgMCJw4BFRQXLgE1NDY3JicOAQceATMyFx4BHwEdARQjIiY1NDYzMhYVFAYHFjMyNjU0LwEGIyImNTQ3PgE3PgI3JjU0NjceARUUBgceARc2MzIXFhUUBwYDBhUUFz4BNTQnBgFJEwZNR1ZCDg0YASw5HyAqTDsFCXFVAQVtggMiAwYCAno2UzMoJTUxJxUiIywBDQkVjZkuDkweBSMnEg5ZQC8ZSWECCAQSCFw5MmM2ZAMGN14pX3XEWxJPMzZW/uABCxAJNCcpJhJBKThOED5aWnlTcX4aIEAXFxsHf0gxJDM3JCIoAQwzNQ8JjQGSimpRHFAYBCAhDcIHbn8TM2JbbYdMEW4kAkM2YncwGwNWHiI5JCV7M0YmJgACAAD+YwJCAZoAYwBnAAABMjY1NCcmIyIHDgEHJicmJxEjETMRNjc2Nx4DFxYzMjY1NCcmIyIHFhcUFhUUBisBJjU0NzY3NjMyFxYXFRQGBwYjIicHFzYzMhYXFh0BBgcGIyImNTQ3MzIWFRQGFQYHFgEzESMBfjI7ChU6ODACDAQdExglFhYlGBMdBBEKEwwgHScxDhxDJScoCgIqGgQ2BBVEIxhJRi0GSDoYJSsxGxs0KDVSGCAGLUZJPVs2BBoqAgwmK/6jYmL+gGA7JCRXOwUdC1IcIhn+agMz/nQZIhxSCCISFwgWYjUrKE4VDSACCwMYIhQoEAk1FQtAK0EOPloWChI8OxMyIy41D0ErQD8wKBQjGAMLAx8NFgMY/M0AAAAAA//I/h4CNgDMACYALwA7AAA3NDYzMhcWFRQHDgEHNjc2NzY1NCcuASMiBgc+ATMyFhUUBwYjIiYFIiY0NjIWFAYnIiY1NDYzMhYVFAYPcFKCPCN4Q8ZpwF5HHgktGC0gMFIKEhYWJTkgGSUsOQICEhcUIhgVFRIWFRIRFhUhTV5XM1rGbDtXBjNkSowvKWYzGhRCNhcNPCYoGhhTdRckFhciGMIYFBEUFRATGQAAAAADAAAAAADIAPAACQATACkAADcGFRQWMzI2NTQnIgYVFBc2NTQmByImNTQ2Ny4BNTQ2MzIWFRQHFhUUBlAjGxARFAIOEyAjEzAlNSMiEQwoHiQ2PCg0dxQdFB4bERaGEQ4XGQshDxTcKB4XGgsPExAaIiAcIxAgGyAmAAAAAgAA/wYBrgD6AAsAFAAAMxQWMzI2NTQmIyIGBzQ2MhYUBiImiiojIisnJiUoin20fX20fWJ4eWFldXZhZ5CR0pGSAAABAAD/BgEiAPoACQAAMTczERcVIzU3EWR9QfBB+v4+HhQUHgEsAAAAAQAA/wYBjwD6ADwAADcyFRQHDgMHNjMyFjMyNz4CMw4CBwYHBiMiJiMiBiMiNTQnPgU1NCciBzIWFRQGIyI1ND4Bx8gFDTZAbzYTIBtkHBgeBRAMAQEFBQEHEBopGnQVH1YCBwECLD5HPChTThocKTceTDxY+n4aDiEuHUQtDCMOAw0LBRYWAykOGCcmEAECIUU4PDI4GGIBNSUeHylnKDkZAAABAAD/BgF1APoAOQAANzIWFRQGIyImNTQ3NjMyFxYVFAYHHgEVFAcGIyImJyY0NjMyFhUUBiMWMzI2NTQmJyY0Nz4BNCYjImYbIichGzIfM1lGJkRGPT5RSyRNJ1cYIzIgIiolGww/JCtILhYWL0spJDyqHBcbIysjLxoqEyJILkQLC0UtQycTFhQdTC4hGxkeKTEnJjoIBCIECTdQMAAAAQAA/wYBkAD6ABEAAAUXIzc1IzU2NTMBMz8BETMVIwFFMsgy4ZOj/vuwAWNLS9EpKTEo8oD+jpaR/tkoAAAAAAEAAP8HAX4A+gAvAAAXNjMyFhUUBiMWMzI3PgE1NCcmIyIHEyEOASsBBzYzMhceARUUBw4CIyInLgE1NBIcIRsqIBwaJDEcEwkeHChOSAoBYgs1JdUGOUJTMSErQxZAKyU8KxAeXyAgFxwgIR4UHyA5HBo1ASIkOnkeHxVBJU8vEBACFAkyEiMAAAAAAgAA/wYBgQD6AAkALAAAFzI2NTQmIyIHFhMWFRQGIyImNTQ2MyYjIgYVPgIzMhYVFAYjIiYnPgEzMhbIKS0qKCwwB90bIxgeIhsQFjc1LxUYLR5MT3FIYWYBAWxbMD/SRSwiMCWeAZ8aJhkoHhsMHiN4XwsKCUA2RFmCeGmREgABAAD/BgGQAPsAKAAANyIOAwc3PggzMhYzMjY3DgQVIzY3Njc2NwYjIiZhFBoUCREFCgEMAgsFCwkNEAkvdSMaOxEbRRoeCIIBCBFoHi0RHiVgoQUOCRsGdAELAgkBBgEDASYXDkOnQVxCK0UbNocnOQooAAMAAP8GAYQA+gAOABwANAAAFw4BFRQWMzI2NTQuAzc+ATU0JiIGFRQeAwcuATU0NjcyFhUUBgceARUUBiMiJjU0Npo2LFgsKj8PIB0xPjMjRFIzChwSMXAxKWZKS2UqMDoydU1MdjkqGSQbHTApHw4XEg0TWhoiHB0wKCAPFxMKFT8YPDUzTQFGMic0Fxo6NTdKSDAkNQAAAgAA/wYBgQD6AAkALAAANyIGFRQWMzI3JgMmNTQ2MzIWFRQGIxYzMjY1DgIjIiY1NDYzMhYXDgEjIia5KS0qKCwwB90bIxgeIhsQFjc1LxUYLR5MT3FIYWYBAWxbMD/SRSwiMCWe/mEaJhkoHhsMHiN4XwsKCUA2RFmCeGmREgABAAn/CgGZAPkAMAAAJTAXNjU0JiMOARUUFxYzMjc2NxQeARUOAQciJyYnNCY1NDcyFhcWFRQGIyImNT4BMwEvEgQ8HzNAJyEwKygcKgkIG1VWTzs7BAHbJEARIiQcICkCIBqkAwUIFB4CYmqOMyoiGFgBBAMBVVABOTlmAisC5gIeFCckJTkuHBYmAAIACf6iAZkBXgA4AD8AACUwFzY1NCYjIgcRFjMyNzY3FB4BFQ4BByMVIzUmJyYnNCY1NDc1MxUyNjMyFhcWFRQGIyImNT4BMwMRBhUUFxYBLxIEPB8DEAwMKygcKgkIG1FVASM9LjsEAasjAwcDJEARIiQcICkCIBp6PScKpAMFCBQiBP5LBCIYWAEEAwFUUQFoawktOWYCKwLLGWlmAR4UJyQlOS4cFib+lwGWLpGOMw0AAAEAAP8GAfQA+gALAAA1MzUzFTMVIxUjNSPXRtfXRtcj19dG19cAAAABABT+BgDjAgAAEwAAExYHBicmAjU0Ejc2FxYHBgIVFBLcBw0JBUlra0kJCwYGPEZH/hYIBQMGVwEgfXwBIlYLBwYISf7niIb+5QAAAQAK/gIA3AH9ABMAABM2EjU0AicmNzYXFhIVFAIHBicmFDtHRjwJDAoHSWtrSQgLBv4WSQEbhogBGUkLBAQJVv7efH3+4FcJCQQAAAQAJP9WAkwAqgALAA8AEwAeAAAFNCYjIgYVFBYzMjY3MxEjATMRIyQUBiMiJjU0NjMyAahUPCA0Vz0hL3IyMv4KMjIB9XtmZXx5aGYgNU4nHzVLI+r+rAFU/qzmeEZJOT9DAAACAAD/JAISANwAAwAPAAA3FSE1JTMVITUzESM1IRUjHgHW/gweAdYeHv4qHkGCgps3N/5INzcAAAIAAP9/AcIAgQALABMAAAU0JiMiBhUUFjMyPgEUBiImNDYyAVFaNiA0XTchL3F9yH19yB40TycfNEwjdGxLS2xLAAAAAgAA/2wBSACUAA0AGwAAJSYjIgYVFBcWMzI2NTQ3FhUUBiMiJyY1NDYzMgEkDSU8lwYLJjyXEA9+SE8kD35IT0QXYSsKCRdhKwkXHh1DZ0MeHUNnAAAAAAEAAP95AUAAhwALAAAlFAYjIiY1NDYzMhYBQHlZMjx6WDI8KEZpOCdFajgAAf/+/28BTACRAAsAACc3FzcXBxcHJwcnNwIbjIwbhoYci4schnEgdnUgcHAhdXUhcAAAAAUAAP9qASwAlgAFAAsAEQAXAB8AABcHFjMyNy8BBhUUFz8BJiMiBx8BNjU0JwY0NjIWFAYilkcdKikfXUcdHVxIHykqHVxHHR3yWHxYWHwSSB0dWkkfKSodWEgdHVpIHykqHYV8WFh8WAAAAAEAAP8GAjAA+gADAAAVATMBAbh4/kf6AfT+DAABAAD/dAFKAIwAAwAAMTcXB6WlpYyMjAABAAD/dAFKAIwAAgAAFRsBpaWMARj+6AABAAD/zgBkADIABwAAFiImNDYyFhRHKh0dKh0yHSodHSoAAAABAAD/eQFAAqgADwAAESERFAYjIiY1NDYzMhcRIQFAeVkyPHpYMR/+3gKo/YBGaTgnRWocAcUAAAEAAP95AUACqAATAAARIREUBiMiJjU0NjMyFxEhNSE1IQFAeVkyPHpYMR/+3gEi/t4CqP2ARmk4J0VqHAEReDwAAAAAAQAAAjABQAKoAAMAABEhFSEBQP7AAqh4AAAAAAIAAAF8AUACqAADAAcAABEhFSERIRUhAUD+wAFA/sAB9HgBLHgAAAABAAD/2gBkAD4ABwAAFiImNDYyFhRHKh0dKh0mHSodHSoAAAABAAADAgE2A8AABQAAESEVIRUjATb+6B4DwB6gAAAAAAEAAAMqAOYEOAA5AAATIiY1NDYzMhYVFA8BFDMyNjU0JisBIjU0OwEyNjU0JiMiFRQWFRQjIiY1NDYzMhYVFA4BFRQWFRQGUCcpEA4PEgsMIRUkEQ8SFBQoFyUODhUCIQwSJSsjLSMjFDMDKh4YDhYQDBIHBw0qHw8ZDhAlFQ0TDQMICBwRDBUeIhoYIxMCASIPIy0AAAAAAQAAAwIBNgPAAAUAAAEVIzUhNQE2Hv7oA8C+oB4AAAABAAD87wE7AAAADwAAFTUzHgQVFAc2NTQmJx4GP1FQNy4SkXDv7zVwZWyJSWBpQUmP3yoAAQAAAAABOwMRAA8AADE1Mz4BNTQnFhUUDgMHHnCSEy43UFE/Bu8f4ZNHSGdeSIptZ3E1AAIAAP1EATwAAAAYACYAABkBMx4GFRQHFhUUBzY1NC4DIzUeAxc0NjU0LgMeBiczOzguHBITHgUpPkhAFglETVYVASk+SEH+qQFXGzkzNzo9SCUsKykrNjkZITdkRTQYqyRUQ10pBAwEN2VFMxkAAAACAAD//wE8ArwAGAAmAAAVETMyPgM1NCcWFRQHFhUUDgUHNTI+AzU0JjUOAx4WQEg+KQUeExIcLjg7MycGFkFIPikBFVZNRAEBVxg0RWQ3IRk5NispKywlSD06NzM5G6sZM0VlNwQMAyldQ1MAAAAAAwAA/SoBPACRABsAKQA3AAAZATMeBhUUBxYVFAcWFRQHNjU0LgIjNR4DFzQ2NTQuAiMnHgMXNDY1NC4CIx4GJzM7OC4cEhISEx4FPVdVHAlETVYVATxWVR0CCURNVhUBPFZVHf6QAgEbOTM3Oj1IJSwrJy0sKykrNjkZIUR3SCmpJFRBXSkEDQNEdkgpqyRTQl0pBA0DRHZIKQAAAwAA/1YBPAK9ABwAKQA2AAARMzI+AzU0JxYVFAcWFRQHFhUUDgUHIzcyPgI1NCY1DgMnMj4CNTQmNQ4DHhZASD4pBR4TEhISHC44OzMnBh4eHVVXPQEVVk1ECR1VVz0BFVZNRAFXGDRFZDchGTk2KykrLC0nKywlSD06NzM5G6opSXhEBAwEKV1DVIYpSXhEAw0EKV1DVAAEAAD9QgE8AVQAIAAuADwASgAAGQEzHgYVFAcWFRQHFhUUBxYVFAc2NTQuAyM1HgMXNDY1NC4DJx4DFzQ2NTQuAyceAxc0NjU0LgMeBiczOzguHBISEhISEx4FKT5IQBYJRE1WFQEpPkhBFglETVYVASk+SEEWCURNVhUBKT5IQf6oAqwbOTM3Oj1IJSwrJy0sKyctLCspKzY5GSE3ZEU0GKskVENdKQQMBDdlRTMZqyRUQ10pAw4DN2VFMxmrJFRDXSkEDAQ3ZUUzGQAEAAD+jgE8AqAAHwAsADkARgAAGQEzMj4CNTQnFhUUBxYVFAcWFRQHFhUUDgUHNTI+AjU0JjUOAycyPgI1NCY1DgMnMj4CNTQmNQ4DHhxVVz0FHhMSEhISEhwuODszJwYdVVc9ARVWTUQJHVVXPQEVVk1ECR1VVz0BFVZNRP6OAqwpSHdEIRk5NispKywtJyssLScrLCVIPTo3MzkbqilJeEQDDQQpXUNUhilJeEQDDQQpXUNUhilJeEQDDQQpXUNUAAAABQAA/VUBPAISACQAMgBAAE4AXAAAGQEzHgYVFAcWFRQHFhUUBxYVFAcWFRQHNjU0LgMjNR4DFzQ2NTQuAyceAxc0NjU0LgMnHgMXNDY1NC4DJx4DFzQ2NTQuAx4GJzM7OC4cEhISEhISEhMeBSk+SEAWCURNVhUBKT5IQRYJRE1WFQEpPkhBFglETVYVASk+SEEWCURNVhUBKT5IQf67A1cbOTM3Oj1IJSwrJy0sKyctLCsnLSwrKSs2ORkhN2RFNBirJFRDXSkDDQQ3ZUUzGaskVENdKQQMBDdlRTMZqyRUQ10pAw4DN2VFMxmrJFRDXSkEDAQ3ZUUzGQAABQAA/bwBPAJ5ACMAMAA9AEoAVwAAGQEzMj4CNTQnFhUUBxYVFAcWFRQHFhUUBxYVFA4FBzUyPgI1NCY1DgMnMj4CNTQmNQ4DJzI+AjU0JjUOAycyPgI1NCY1DgMeHFVXPQUeExISEhISEhIcLjg7MycGHVVXPQEVVk1ECR1VVz0BFVZNRAkdVVc9ARVWTUQJHVVXPQEVVk1E/bwDVylId0QhGTk2KykrLC0nKywtJyssLScrLCVIPTo3MzkbqilJeEQDDQQpXUNUhilJeEQDDQQpXUNUhilJeEQDDQQpXUNUhilJeEQDDQQpXUNUAAAAAgAA/2QA4QGwAAoAFgAANyIGHQE2NzY1NCY3MhYVFAcGIxEzETZnFCsiJisdByM5S1JEKCN6JhO5Dzg7LxsmJjIjSUxSAkz+vDQAAAIAAP6GAMUBegADAAwAABc3NQcRFTcRIzUHETcckJCpGawBZS2WLQFJ6DT9wOIzAkMBAAACAAD+mAD/AWgAAwAfAAA3FTc1AyM1BzU3NQc1NzUzFTc1MxU3FQcVNxUHFSM1B1NaWh41NTU1HlodNTU1NR1aRqcbp/43ow9cD6cPWg+onxyrow9cD6cPWg+onxwAAAABABT/hAELAHoAHgAAFzUmJwcwFSM1MzcnMCM1MxUWFzcwNTMVIwYHFzAzFcMoDDNIOTMzOUghEjRIOSETNDl8OyYNMztKMjJIOSIRMzlHIhE0SAAEAAD/agFsAbAADgAcACsAOgAANw4BHQEyNzY3NjU0JyYjNzIWFRQHBgcGIxEzETYXDgEdATI3Njc2NTQnJiM3MhYVFAcGBw4BIxEzETZOER4OHh8MBAoQERkdKwkYKzUvHxnRER0QHh0LBgsQDxYfKgsZKBY3Fh4bfQEeEMYpKzQNGR4UFSY5IRIgOTRAAkb+wTImAR0RxikvMBMTHBYVJjYkFhw+LxslAkb+wTIAAAIAMv9kAQ0BsAAKABYAADciBhUUFxYXNTQmJzIXETMRIicmNTQ2qxcgLi4aKjM6IyM6Uk85eiYbMEVCA8sSHiY0AUT9tFJQRSMyAAAE//X/agFsAbAADgAdACwAOwAANyMiBwYVFBcWFxYzNTQmJzIXETMRIiYnJicmNTQ2Fw4BHQEyNzY3NjU0JyYjNzIWFRQHBgcOASMRMxE2VwEREAoEDB8eDh4rMBkfFjcXKxgJK+kRHRAeHQsGCxAPFh8qCxkoFjcWHht9FRQeGQ00KynGEB4nMgE//bolGzQ5IBIhOSYBHRHGKS8wExMcFhUmNiQWHD4vGyUCRv7BMgAAAAABAAD+wACpAUAAEwAAEzMVNxUHFTcVBxUjNQc1NzUHNTdEHkdHR0ceRERERAFAog5cDn8OWg+oog5cDn8OWg8AAwAA/pgBOgFoACMAJwArAAA3NTMVNxUHFTcVBxUjNQcVIzUPASM1BzU3NQc1NzUzFTc1MxUDNQcVNxU3NekeMzMzMx49HjwBHjMzMzMePR4ePVs9wKieD1wPnw9aD7WqEqykEKieD1wPnw9aD7WqEqyk/v2eEZ+4nhGfAAH//QAAAT8A9AAYAAA3BiMiJjU0PwE2LwEmNTQ2MzIxFwUWFRQHEgIDBwkGzw4OzQgLBwECAR8ODgEBEAgKA0kHBk8DCwoSAWsGDg0FAAAAAQAAAAAAUABQAAkAADU0NjIWFAYjIiYXIhcXERAYKBEXFyIXGAAAAAEAAAAAAUAAKAADAAAxNSEVAUAoKAAAAAEAAAAAAGQBGAADAAAzAzMDKChkKAEY/ugAAAABAAAAAAEYATUABQAAMRsBIycHjIxBWFoBNf7LxsYAAAIAAAAAAlgBSgAOABkAADE0NjMyHgIVIy4BIgYHISImNDYzMhYVFAazeTlrVTMPC6LgogsBHBclJRcZIyOYsixRgE1uhoZuJDAkJBgZIwAAAQAAAAAAtgEtABcAABMyFhcWFRQHDgEjJyY1NDY1NCMuATU0NlYbGxAaMhlEEAYBRxQbKC0BLQwRHTA9PB0tAwECCGsTDwEmHB4xAAEAAP8GAIIA+gADAAA1MxEjgoL6/gwAAAEAAAAAAIIA+gADAAA1MxUjgoL6+gAAAAEAAP+DASwAAAADAAAxIRUhASz+1H0AAAEAAAAAASwAfQADAAA1IRUhASz+1H19AAEAAP5+AOsBhwATAAATFwcXJiMiBhUUFyY1NDYzMhcnNym9Z2wyNB8mOHg0JSIih2QBh+XZzy4kHTU0S00jLRW8tAAAAQAA/w0BAADAABYAADcOAiMiJjU0NjIWFRQHMjY3NjIXAyerAxkaEys3JjgpFyIzIQIVA5YwPAEHBCkoHyAeGR0bISwCAv5vEAAAAAEAAP4MAUgAwAAkAAAXBiMiJjU0NjMyFhUUBzI/AQYjIiY1NDYzMhYVFAcyNzYyFwMnqyghKzcnGxwpF0ELPDYYKzcnGxwpF0guAhUDxS3EDCgoICAfGR0bIsoMKSgfIB4ZHRtNAgL9bgwAAAEAAP4MAY8BwAA2AAA3BiMiJjU0NjMyFhUUBzI/ASIOASMiJjU0NjMyFhUUBzI3NjIXAScTBiMiJjU0NjMyFhUUBzI39igfKzcnGxwpFz8LOgEgHBMrNycbHCkXSC4BFgP+9C1VKCErNycbHCkXQQs8DCgoICAfGR0bIssJBCkoHyAeGR0bTQIC/G4MASQMKCggIB8ZHRsiAAAAAAEAAP0MAdoBwABFAAATBiMiJjU0NjMyFhUUBzI/AQYjIiY1NDYzMhYVFAcyPwEGIyImNTQ2MzIWFRQHMj8BIg4BIyImNTQ2MhYVFAcyNzYyFwEnqyghKzcnGxwpF0ELOighKzcnGxwpF0ELOigfKzcnGxwpFz8LOgEgHBMrNyY4KRdILgIVA/6pLf48DCgoICAfGR0bIsoMKCggIB8ZHRsiygwoKCAgHxkdGyLLCQQpKB8gHhkdG00CAvtuDAAAAAEAAP0MAhkCrgBWAAAlBiMiJjU0NjMyFhUUBzI/AQYjIiY1NDYzMhYVFAcyPwEiDgEjIiY1NDYzMhYVFAcyNzYyFwEnEwYjIiY1NDYzMhYVFAcyPwEGIyImNTQ2MzIWFRQHMjcBPyghKzcnGxwpF0ELNigfKzcnGxwpFz8LNAEgHBMrNycbHCkXSC4BFgP+ai1VKCErNycbHCkXQQs6KCErNycbHCkXQQs0DCgoICAfGR0bIsQMKCggIB8ZHRsixwkEKSgfIB4ZHRtNAgL6gAwBJAwoKCAgHxkdGyLIDCgoICAfGR0bIgABAAD/GgNSAOYACwAANTMVITUzESM1IRUjGQMgGRn84BnmfX3+NH19AAAAAAP/8P8GAiYA+gAHAA8AEwAANiImNDYyFhQAIiY0NjIWFAUBMwFQMiMjMiMBiDIjIzIj/dIBuH7+R0sjMiMjMv7PIzIjIzJaAfT+DAAE/+H/BgMHAPoABwAPABMAFwAANiImNDYyFhQAIiY0NjIWFAUBMwEzATMBQTIjIzIjAncyIyMyI/zjAbh7/kd5Abh7/kdLIzIjIzL+zyMyIyMyWgH0/gwB9P4MAAL/tP+IAXwBGAARADsAADcWMzI2NzY1NCcmIyIGBwYVFBciJwczMhQrASI0OwETNjU0IyIOAwcGJjc2NzYzMhYXPgEzMhYVFAbFAgUSMg4NDwIEEjULDycqGS00CwvhCwtLaAYLCAwPCxkKBRsFMQ8YJCMkBx0mIx4tWSgBNSQgJiUFATMcJyQpLiB6Hh4BHRIMDwcUEiwQCA8JWBAZExoeDzQwSWsAAAH/2//2Ab4BGABTAAA3BgcGKwEiPwE2JiMiBgcGJjc+AzMyFzYzMhc+ATMyFhUUDwEGFRQzMjc+BTc2FgcOAiMiJjU0PwE2NTQjIg8BBgcnBiY/ATY1NCMiB1AHCAQENQ0NQgQGCA0WJAUVBBQQIh8SNwskJC0JCykTGSQFLwQIAQQFCwcMAw0BBhUGEhctHxUZBTQBFRsIQQgPJg0IBEMBFRsIFREDARqnDQ8aOQgMCSUaMBIoKCgQGCMaCw99CwkOAgMJBg8FEgEJDQsfHxoWEw0NiAIEDhSrFgEBAQ8IqwIEDhQAAAAB/37/YAFeAbgAQQAAByImNTQ2MzIWFRQHBhUUMzI+BzcjIjU0OwE+ATMyFhUUBiMiJjU0NzY0IyIOBwczMhQrAQ4BMiAwFxMSFxIKGQsQDwsNCg4NFAo1ExFBFGk0IDAXExIXEgoZBwwKBwgFBgMGATYTEz8hdqAmIBoiFA8OCwcNDgYREyUkPDdVJxUTS18mIBoiFA8OCwYcBQsKFA0aDR4GKMXBAAAB/9sAAAETARMAKgAANz4BJiMiBg8BBgcGKwEiPwE2JiMiBgcGJjc+ATMyFhc2MzIWFRQjIiY1NNAFAwMFFCQJPwcIBAQ1DQ1CBAYIDhciBRUEITgiGx0EHyQaICsPG+cDBwQsGJwRAwEaow0PGjUIDAk8QBoNJx4ZNxYNFAAAAAEAAAAAANwBGAAxAAAzIiY1NDYyFhUUBxYzMjY1NC4CJyY1NDYzMhYVFAYjIiY1NDcmIyIGFRQeAhcWFRRQHjIVGhcQDBMWIQkLGAY6Ny0iNhYQDRYHDxEPGRESHgUwKxsQFhAMEhAQFhILDwcNBCUwIygkGBAYFA4DDhMRDQkTDBEDICtVAAAB/+T//ADnAQ8APAAAJwYuAT8BIgYjIiYOAQcGJyY3PgE3HgEzMjYzMhcWFA8BBhUUMzI2MzIXFjc2JyI1NDYzMhUUBisBLgEjIgoGCwEFsAUfDAMUDB8FDwQDCAwLAQ4vFSIrBAgFCweeAgIBDQYaIw0IBQckEg0mKB4dGCUIDgMECA0GwQYGAjIFDQsJEh4wAgEGCwEBEQenBgIDAxoKDg0DHQ4VNx4vAxgABf+0/4gFSwEYABsANQDZAPABCwAAJRYzMj4BNz4GNTQmJyYjIgYHDgIVFAUWMzI2Nz4FNTQmJyYjIgYHBhUUHgEXIicHMzIUKwEiNDsBEz4CNTQuAiMiDgMHBiY3Njc2MzIWFz4BMzIXPgEzMhYXPgEzMhc+ATMyFhc+ATMyFz4BMzIWFz4BMzIWFRQGIyInBzMyFCsBIjQ7ARM+AjU0JiMiBgcVFAYjIicHMzIUKwEiNDsBEz4CNTQmIyIGBxUUBiMiJwczMhQrASI0OwETND4DNDU0JiMiBgcVFAYlFjMyNjc+BDU0JicmIyIGBwYVFAUWMzI2Nz4GNTQmJyYjIg4BBwYVFBYCCgMEDB8eCQIDAgICAQEHCAMDEzQLBQcD/ssDBBIyDgIDAwMBAQcIAwMTNAsPBAcIFhktNAsL4QsLS2gBAwIBAgUDCAwPCxkKBRsFMQ8YJCMkBx0mIy8TEiIbIyQHHSYjLxMSIhsjJAcdJiMvExIiGyMkBx0mIx4ta0kWGS00CwvhCwtLaAEDAgUGDhQUa0kWGS00CwvhCwtLaAEDAgUGDhQUa0kWGS00CwvhCwtLaAECAQIFBg4UFGsDgwMEEjIOAgQDAwEHCAMDEzQLD/7LAwQSMg4CAwICAgEBBwgDAwwhHgcPCSgBGCoXBAoJCwoKCwUQFwMBMxwNGxgLKAcBNSQFCwwMDAwGEBcDATMcJiUMFA0qIHoeHgEdAggOBgMFBQIHFBIsEAgPCVgQGRMaHg8yHBYTGh4PMhwWExoeDzIcFhMaHg80MEdtIHoeHgEdAggOBgcIGCMBR20geh4eAR0CCA4GBwgYIwFHbSB6Hh4BHQEDBQUGBwMHCBgjAUdtKAE1JAYNDw4PBxAXAwEzHCYlKAcBNSQECgkLCgoLBRAXAwEYJRImJRIaAAAE/7T/iAQGARgAfQCYALQAzgAAISInBzMyFCsBIjQ7ARM+AjU0JiMiBgcVFAYjIicHMzIUKwEiNDsBEzQ+AzQ1NCYjIgYHFRQGIyInBzMyFCsBIjQ7ARM+AjU0LgIjIg4DBwYmNzY3NjMyFhc+ATMyFz4BMzIWFz4BMzIXPgEzMhYXPgEzMhYVFAYnFjMyNjc+BjU0JicmIyIOAQcGFRQWBRYzMj4BNz4GNTQmJyYjIgYHDgIVFAUWMzI2Nz4FNTQmJyYjIgYHBhUUHgEDUhYZLTQLC+ELC0toAQMCBQYOFBRrSRYZLTQLC+ELC0toAQIBAgUGDhQUa0kWGS00CwvhCwtLaAEDAgECBQMIDA8LGQoFGwUxDxgkIyQHHSYjLxMSIhsjJAcdJiMvExIiGyMkBx0mIx4ta0wDBBIyDgIDAgICAQEHCAMDDCEeBw8J/sIDBAwfHgkCAwICAgEBBwgDAxM0CwUHA/7LAwQSMg4CAwMDAQEHCAMDEzQLDwQHIHoeHgEdAggOBgcIGCMBR20geh4eAR0BAwUFBgcDBwgYIwFHbSB6Hh4BHQIIDgYDBQUCBxQSLBAIDwlYEBkTGh4PMhwWExoeDzIcFhMaHg80MEdtKAE1JAQKCQsKCgsFEBcDARglEiYlEhoDARgqFwQKCQsKCgsFEBcDATMcDRsYCygHATUkBQsMDAwMBhAXAwEzHCYlDBQNAAP/tP+IAsEBGABXAHEAjQAAMyInBzMyFCsBIjQ7ARM+AjU0LgIjIg4DBwYmNzY3NjMyFhc+ATMyFz4BMzIWFz4BMzIWFRQGIyInBzMyFCsBIjQ7ARM0PgM0NTQmIyIGBxUUBicWMzI2Nz4FNTQmJyYjIgYHBhUUHgEFFjMyPgE3PgY1NCYnJiMiBgcOAhUUyBYZLTQLC+ELC0toAQMCAQIFAwgMDwsZCgUbBTEPGCQjJAcdJiMvExIiGyMkBx0mIx4ta0kWGS00CwvhCwtLaAECAQIFBg4UFGtMAwQSMg4CAwMDAQEHCAMDEzQLDwQHAUoDBAwfHgkCAwICAgEBBwgDAxM0CwUHAyB6Hh4BHQIIDgYDBQUCBxQSLBAIDwlYEBkTGh4PMhwWExoeDzQwR20geh4eAR0BAwUFBgcDBwgYIwFHbSgBNSQFCwwMDAwGEBcDATMcJiUMFA0CARgqFwQKCQsKCgsFEBcDATMcDRsYCygAAAL/2/+IAysBGAB6AI8AACU2NzYzMhYXPgEzMhYVFAYjIicHMzIUKwEiNDsBEz4DNTQmIyIOAwcOASMiJjU0Nj8CNCMiDwEGBycGJj8BNjU0JiMiDwEGBwYrASI/ATYmIyIGBwYmNz4DMzIXNjMyFz4BMzIeAxUUDwEGFRQzMjc+ARcWMzI2Nz4BNTQmJyYjIgYHBhUUFgGtMRQYIiMkBx0mIx4ta0kWGS00CwvhCwtLaAEBAwEFBgcPEg4YCBo8LRUZAgM0ARUbCEEIDyYNCARDAQwJGwhEBwgEBDUNDUIEBggNFiQFFQQUECIfEjcLJCQtCQspEwoSDwsHBS8ECAIDDyXRAwQSMg4GBwcIAwMTNAsPCXdsGB0TGh4PNDBHbSB6Hh4BHQIFCQkFBwgNHxs1EDY4FRQGDQeIBg4UqxYBAQEPCKsDAwYIFKwRAwEapw0PGjkIDAklGjASKCgoEBgGCw8TCg0NfQsJDgIINTkBNSQPJhEQFwMBMxwmJRIaAAL/2/9gAxkBuABXAJ8AADcGBwYrASI/ATYmIyIGBwYmNz4DMzIXNjMyFz4BMzIeAxUUDwEGFRQzMjc+BTc2FgcOAiMiJjU0Nj8CNCMiDwEGBycGJj8BNjU0JiMiBxMiJjU0NjMyFhUUBwYVFDMyPgc3IyImNTQ2OwE+ATMyFhUUBiMiJjU0NzY0IyIOBwczMhYVFA4BKwEOAVAHCAQENQ0NQgQGCA0WJAUVBBQQIh8SNwskJC0JCykTChIPCwcFLwQIAgMFCwcMAw0BBhUGEhctHxUZAgM0ARUbCEEIDyYNCARDAQwJGwj1IDAXExIXEgoZCxAPCw0KDg0UCjUJCgkIQRRpNCAwFxMSFxIKGQcMCgcIBQYDBgE2CQsFCQY/IXYVEQMBGqcNDxo5CAwJJRowEigoKBAYBgsPEwoNDX0LCQ4CAwkGDwUSAQkNCx8fGhUUBg0HiAYOFKsWAQEBDwirAwMGCBT+nyYgGiIUDw4LBw0OBhETJSQ8N1UnDAkIC0tfJiAaIhQPDgsGHAULChQNGg0eBgwIBQkGxcEAAAAAAf9+/2ACaQG4AHsAACUjDgEjIiY1NDYzMhYVFAcGFRQzMj4HNyMiJjU0PgM7AT4BMzIWFRQGIyImNTQ3NjQjIgcGBxc+ATMyFhUUBiMiJjU0NzY0IyIOBwczMhYUBisBDgEjIiY1NDYzMhYVFAcGFRQzMj4HAV+bIXZfIDAXExIXEgoZCxAPCw0KDg0UCjUJCgEDBAYDQRRpNCAwFxMSFxIKGSYXAwGbFGk0IDAXExIXEgoZBwwKBwgFBgMGATYJCwsJPyF2XyAwFxMSFxIKGQsQDwsNCg8NFObFwSYgGiIUDw4LBw0OBhETJSQ8N1UnDAkDBQUEAktfJiAaIhQPDgsGHHMMBgFLXyYgGiIUDw4LBhwFCwoUDRoNHgYMEAzFwSYgGiIUDw4LBw0OBhETJSQ8N1UAAAAAAf9+/2ADdAG4ALMAABMzPgEzMhYVFAYjIiY1NDc2NCMiBwYHFz4BMzIWFRQGIyImNTQ3NjQjIg4HBzMyFhUUDgErAQ4BIyImNTQ2MzIWFRQHBhUUMzI+BzcjDgEjIiY1NDYzMhYVFAcGFRQzMj4HNyMOASMiJjU0NjMyFhUUBwYVFDMyPgc3IyImNTQ+AzsBPgEzMhYVFAYjIiY1NDc2NCMiDgIHBsycFGk0IDAXExIXEgoZJhcDAZsUaTQgMBcTEhcSChkHDAoHCAUGAwYBNgkKBAkGPyF2XyAwFxMSFxIKGQsQDwsNCg8NFAqbIXZfIDAXExIXEgoZCxAPCw0KDg0VCpshdl8gMBcTEhcSChkLEA8LDQoODRQKNQkKAQMEBgNBFGk0IDAXExIXEgoZDhUOCAYCAQ5LXyYgGiIUDw4LBhxzDAYBS18mIBoiFA8OCwYcBQsKFA0aDR4GDAgFCQbFwSYgGiIUDw4LBw0OBhETJSQ8N1UnxcEmIBoiFA8OCwcNDgYREyUkOzhVJ8XBJiAaIhQPDgsHDQ4GERMlJDw3VScMCQMFBQQCS18mIBoiFA8OCwYcEyciGwoAAf9+/2AEgAG4AOcAAAEXPgEzMhYVFAYjIiY1NDc2NCMiBwYHFz4BMzIWFRQGIyImNTQ3NjQjIg4HBzMyFhQGKwEOASMiJjU0NjMyFhUUBwYVFDMyPgc3Iw4BIyImNTQ2MzIWFRQHBhUUMzI+BzcjDgEjIiY1NDYzMhYVFAcGFRQzMj4HNyMOASMiJjU0NjMyFhUUBwYVFDMyPgc3IyImNTQ+AzsBPgEzMhYVFAYjIiY1NDc2NCMiBwYHFz4BMzIWFRQGIyImNTQ3NjQjIg4HAdicFGk0IDAXExIXEgoZJhcDAZsUaTQgMBcTEhcSChkHDAoHCAUGAwYBNgkKCgk/IXZfIDAXExIXEgoZCxAPCw0KDw0UCpshdl8gMBcTEhcSChkLEA8LDQoODRQKmyF2XyAwFxMSFxIKGQsQDwsNCg8NFAqbIXZfIDAXExIXEgoZCxAPCw0KDg0UCjUJCgEDBAYDQRRpNCAwFxMSFxIKGSYXAwGbFGk0IDAXExIXEgoZBwwKBwgFBgMGAQ8BS18mIBoiFA8OCwYccwwGAUtfJiAaIhQPDgsGHAULChQNGg0eBgwQDMXBJiAaIhQPDgsHDQ4GERMlJDw3VSfFwSYgGiIUDw4LBw0OBhETJSM8N1YnxcEmIBoiFA8OCwcNDgYREyUkPDdVJ8XBJiAaIhQPDgsHDQ4GERMlJDw3VScMCQMFBQQCS18mIBoiFA8OCwYccwwGAUtfJiAaIhQPDgsGHAUKCxMOGQ4dAAMAAP9gAt8BuAA3AHsAxQAAMyImNTQ2MzIWFRQHFjMyNjU0LgMnLgI1NDYzMhYVFAYjIi4BNTQ3JiMiBhUUHgIXHgEVFCUGLgE/AS4CIyIGIyIOAQcGJyY3PgE3HgEzMjYzMhYXFhQPAQ4BFRQeARcWPgEnLgE1NDYzMhUUBwYjIiMuAiMiBgUiJjU0NjMyFhUUBw4BHgEVFBYyPgc3IyIuATU0NjsBPgEzMhYVFAYjIiY1NDc2NCMiDgcHMzIWFAYrAQ4BUB4yEgwOFwwGGBYhAwwFFwMUGBQ3LSI2FhAIEAsFEA4PGRESHgUbFwEmBgsBBa4ECQoHBhwGBRASBRAFAwcLDAEYJQ4gKAcECwcLB5oCAhoqDQUJBQIDJBQMJiYSEwMDEiMYCAoS/r0gMBcTEhcSBAEBAgYWEA8LDQoODRQKNQYJBAkIQRRpNCAwFxMSFxIKGQcMCgcIBQYDBgE2CQoKCT8hdisbEBYNCxgMEhYSCQwNBA4CDRIeDyMtJBgQGAkPCggIFBENCRMMEQMSHxVaAwQIDQa/AgIBARgfBA0LCBMeLgQCAQgBAQERB6MDBQIHAwcLAwQNBggIFAsTNysUCQEIBgerJiAaIhQPDgsCBQQGAwgGBhETJSQ8N1UnBgkGCAtLXyYgGiIUDw4LBhwFCwoUDRoNHgYMEAzFwQAAAAIABf/7AfwBmgAJACwAAAEPAQYVFDMyNjcHDgEjIiY1ND8BIzUzPwEHNzIVNjMyFhUUBiImNTQ3Bg8BIwE2fzkCFBhEEgwpMh8iIgM3aXMWWSaYGSA1GB0YIBYJNxBCSAEJB7gIAxUXDygZFCQaCwuzIEoueAotKRwVEhsRDhITDyfYAAEAAP/9AbUA1AAvAAAlMjU0JwYiJjU+ATMyFhUUBwYjIi8BJiMiFRQXNjMyFhUUBgciJyY1NDc2MxYfARYBcC0aEBwUARcJJC0pFx4mHqIaES4ZEA8NFRQNHRgcKBYiKheiHDE5IBMQFg0OFjM1MyQVFXoSOiASEBcODxICGiItMyQTAhB6EwABAAD/zQG1AQMANgAAFyImNTQ3NjMWHwE1MxUXFjMyNjU0JwYjIjU+ATMyFhUUBwYjIi8BFSM1JyYjIgYVFBc2MzIVFE0gLSgWICgXLh5cIg8VHBYUEhwBDwkgLSkXHCQeLh5cIA8WHBUUExwDQyYzJBMCECRpgEcXKRwnEAwbDxVCJjMkFRUkbINHFigeJw8MHSAAAQANAAACRQDgAAsAADcnNxc3FzcXBycHJyIVjmV4ak0Wkml0aS4ZmXx8fFQXoXx8fAAAAAEADf/LAkUBEQATAAAlBycHJzcXNzUzFzcXNxcHJwcVIwEWQGlLFY5lFhsBRmpPFJJpGRtGRnxOGZl8F5Z7SnxVGKF8G5YAAAEAAAAAARgBGAALAAAzNSM1MzUzFTMVIxV7e3sie3t7Int7InsAAAABAAAAAAE2AXIACgAAMTU+BDczFAYkMUw0NA8ewDwHDys9b0mO2gAAAf//AAABLQCgAB0AADc+AjMyHgEXFjMyNzYWBw4CIyIuAScmIyIHBiYBCRApHBgmJg8JCh4YBA4CCBEpHBgkJRIHCB0dBQ1GGSEgITEKBiQGBwcZIh8hMQoEIwYIAAAAAQAAAAABLAEsAAcAADERIREjNSMVASwj5gEs/tS0tAABAAAAAAD6AcIABgAAMwMzGwEzA2lpKFVVKGkBwv6YAWj+PgACAAAAAADIAMgABwAPAAA2MjY0JiIGFBYiJjQ2MhYURT4sLD4sdFI7O1I7GSw+LCw+RTtSOztSAAH/OAAAAMgAyAALAAAjNDYyFhUjNCYiBhXIdqR2HmCUYFJ2dlJKYGBKAAAAAgAAAAAAtAEsAAcAFQAANjI2NCYiBhQXNS4BNTQ2MhYVFAYHFUseGxseGxgdKzdGNysdeDU2NTU2rWQINScoPDwoJzUIZAAAAgAAAAAAyAEsAA8AHwAANy4BNTQ2MhYVFAYHHQEjNTc+ATU0JiIGFRQWFz0BMxVUJDA7UjswJCAgGSIsPiwiGSBmBTglKTs7KSU4BQFlZRkGKRsfLCwfGykGAUlJAAAABAAA//wD9AJ/AIcAkQCdAKcAADc+ATU0LgEnLgE1ND4CPwIOARUUMzI3Fw4BIyImNTQ+AjMyFhUUBiMiJic3HgEzMjU0LgInBwYVFB4CFRQGDwEeAjM6ATMyNyY1NDc2MzIWFRQHBgceATMyNjU0NjcuAj0BHgEVFAYjIicGIyIuAScOASImJyYjIg4BBwYjIjU0NgUiJjQ2MzIWFAYlPgE1NCcmIyIGFRQFNjU0JicOARUUmDZFAQICA1IDBAUBAj1iaiAeHRoVKSUeLR8+cEh9cjIuHDYSGBEUFDMMHEAtGwkdIh0fEBAOKR8MAwgCECMhHCJMGyMKHTwTIBsWMUNdIIFeurRRQkEjJDwhMxYOLCggGxwaEgoUGQZaIQowA1wLExMLDBIR/g8zJAQFFRwuATxaFxI/MFoYPyAEBwcECHQiBQ4ODAQEpQRjLCM8DUIvJhohR0QsUTcwNTArDh4RMgoaIhoCQiQbHjYhLBUmTxQUCikaHjUoNSUuKyAhEzkwFxIqGVJfGSxZNAYBPLFrRl85OhUUEiYZFiAtCxUEOgcNOE8SGBISGBKALy8bBw4SOSsedAWBIkkVHVhEPwAAAAACAAwACgHTAc8ACgCPAAAlNCYjIgYUFjMyNicOASMiJjQ2MzIWFzY1NCcmIyImNDYzMhceARcWMzI1NCcuATU0NjMyFhUUBgcUMzI3PgE3NjMyFhUUBiMiBgcGFRQzMjYzMhYUBiMiJiMiBhUUFx4BFxYVFAYjIicuAScmIyIVFBYVFAYjIiY0NjU0IyIHDgEHBiMiJjU0NzYzMjc2NTQBFhgPEBUWDxAXiRkmDhkbGhkNKhglDBQYHRwZFxIQCwMUCxIUAQInHhQSGyMBFhANEQENDBoTHhsSGxUNECEbKw4cGx0ZDycUFxILFDgNDhkXExQMARMRChIqIBMSHSYXDQ4SAxESDBQaDQwWIxIN7hAUEyIWFQoBJRkqGyUCAxYOChMcKB0MCz4WDRgNCBcnDxcaGxYRIxkqEBM4Dw4bFBEjBgsODxYnHSgaJggKFgoSAwsNGRMbDgs5FQ8fHjATFBgaJDEXJA4SPQwHFhQYDg0SDQwaAAAAAwAA/wYB9AD6AAcADwAXAAA2FBYyNjQmIgI0NjIWFAYiNiImNDYyFhQteKp4eKqlktCSktCBMiMjMiNVqnh4qnj+y9CSktCSviMyIyMyAAACAAD/BgH0APoABwAPAAA2FBYyNjQmIgI0NjIWFAYiLXiqeHiqpZLQkpLQVap4eKp4/svQkpLQkgAAAAADAAD+ogH0AV4AEQAXAB0AABMzFR4BFRQGBxUjNS4BNTQ2NxkBDgEUFhc+ATQmJ+QtYIODYC1ghINhTmlpe01paU0BXmQKjmJhjwpkZQiPYmOOCP47AZgIdZ51CAh2nHYIAAAAAgAA/wYB0gD6ACEAKQAAJRYVFAcGIyInJiMiBhQWMzI3NjMyFxYVFAcGIyImNDYzMgIiJjQ2MhYUAc8CCwUGDQozd1V4eFV4MgYSBwMMA0CVaJKSaJR7MiMjMiOCBgQPBgMOX3iqeF8NAgcMBgZ4ktCS/sojMiMjMgAAAAEAAP8GAdIA+gAhAAAlFhUUBwYjIicmIyIGFBYzMjc2MzIXFhUUBwYjIiY0NjMyAc8CCwUGDQozd1V4eFV4MgYSBwMMA0CVaJKSaJSCBgQPBgMOX3iqeF8NAgcMBgZ4ktCSAAACAAD+ogHSAV4AJAAqAAAlFhcWFRQHBiMiJyYnETY3NjMyFxYVFAcGBxUjNS4BNTQ2NzUzAxEOARQWARGEOgILBQYNCi1mZS4GEgcDDAM8gi1ghINhLS1OaWn5Cm0GBA8GAw5UCv5oB1cNAgcMBgZwB2VlCI9iY44IZf3WAZgIdZ51AAABAAD/xAB4ADwABwAAFiImNDYyFhRVMiMjMiM8IzIjIzIAAAABAAD+ogAtAV4AAwAAExEjES0tAV79RAK8AAAAAgAA/RIBSgC+AAMADwAANxUhNSUzFSE1MxEjESEVIx4BDv7UHgEOHh7+8h5GjIx4MjL8VAJiMgABAAAAAAJWAXIACwAANTcXNxc3FwEnBycHiVRWUq8i/vxUVlM1Qblzc3HpFv6kdHRwRwAAAf/oAL0BEgE3ABcAACY+ATMyFjI3NjMyFRQOASMiJiIHBiMiNRgwIRwUVSgUAwcOMCEcFFUoFAQHDfYwET0UAwcMMBE9FAQIAAAAAAIAAP+JAcIAiwALABMAAAU0JiMiBhUUFjMyPgEUBiImNDYyAVFaNiA0XTchL3F9yH19yBQ0TycfNEwjdGxLS2xLAAAAAgAA/2wBSAKoAA0AHAAAJSYjIgYVFBcWMzI2NTQTMxEUBiMiJyY1NDYzMhcBJA0lPJcGCyY8lwIdfkhPJA9+SEAkRBdhKwoJF2ErCQJu/W5DZ0MeHUNnLQAAAAABAAD/eQFAAqgADQAAATMRFAYjIiY1NDYzMhcBIh55WTI8elgxHwKo/YBGaTgnRWocAAAAAQAA/3kCCgKoABoAAAERFAYjIiY1NDYzMhcRNTMeBBUUBzY1NAFAeVkyPHpYMR8eBi45OCUyEgG5/m9GaTgnRWocAU7vNVxHTnVJSHJBSe8AAAAAAgAA/3kCCwKoAB8AKAAAJTURMx4EFRQHFhUUBzY1NCYjERQGIyImNTQ2MzITHgEXNDY1NCYBIh4JMDg2IxUWIgV2OHlZMjx6WDE9DoUbAXZr5gFXJEc7QlgzJTIwJC5BGSFfnv7WRmk4J0VqAXY7ojUDDgNfnwAAAQAA/84AZAAyAAcAABYiJjQ2MhYURyodHSodMh0qHR0qAAAAAAAOAK4AAQAAAAAAAACDAQgAAQAAAAAAAQAHAZwAAQAAAAAAAgAHAbQAAQAAAAAAAwAgAf4AAQAAAAAABAAHAi8AAQAAAAAABQAJAksAAQAAAAAABgAHAmUAAwABBAkAAAEGAAAAAwABBAkAAQAOAYwAAwABBAkAAgAOAaQAAwABBAkAAwBAAbwAAwABBAkABAAOAh8AAwABBAkABQASAjcAAwABBAkABgAOAlUAQwBvAHAAeQByAGkAZwBoAHQAIABcADIANQAxACAAMgAwADEAOAAtADIAMAAxADkAIABKAGUAYQBuAC0ARgByAGEAbgBjAG8AaQBzACAATQBvAGkAbgBlAC4AIABUAGgAaQBzACAAZgBvAG4AdAAgAGkAcwAgAGwAaQBjAGUAbgBzAGUAZAAgAHUAbgBkAGUAcgAgAHQAaABlACAAUwBJAEwAIABPAHAAZQBuACAARgBvAG4AdAAgAEwAaQBjAGUAbgBzAGUAIABcACgAaAB0AHQAcAA6AC8ALwBzAGMAcgBpAHAAdABzAC4AcwBpAGwALgBvAHIAZwAvAE8ARgBMAFwAKQAuAABDb3B5cmlnaHQgXDI1MSAyMDE4LTIwMTkgSmVhbi1GcmFuY29pcyBNb2luZS4gVGhpcyBmb250IGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBTSUwgT3BlbiBGb250IExpY2Vuc2UgXChodHRwOi8vc2NyaXB0cy5zaWwub3JnL09GTFwpLgAAYQBiAGMAMgBzAHYAZwAAYWJjMnN2ZwAAUgBlAGcAdQBsAGEAcgAAUmVndWxhcgAARgBvAG4AdABGAG8AcgBnAGUAIAA6ACAAYQBiAGMAMgBzAHYAZwAgADoAIAAyADgALQAxADAALQAyADAAMQA5AABGb250Rm9yZ2UgOiBhYmMyc3ZnIDogMjgtMTAtMjAxOQAAYQBiAGMAMgBzAHYAZwAAYWJjMnN2ZwAAVgBlAHIAcwBpAG8AbgAgACAAAFZlcnNpb24gIAAAYQBiAGMAMgBzAHYAZwAAYWJjMnN2ZwAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkgAAAAEAAgECAAMBAwEEAQUBBgEHAQgBCQEKAQsBDAENAQ4BDwEQAREBEgETARQBFQEWARcBGAEZARoBGwEcAR0BHgEfASABIQEiASMBJAElASYBJwEoASkBKgErASwBLQEuAS8BMAExATIBMwE0ATUBNgE3ATgBOQE6ATsBPAE9AT4BPwFAAUEBQgFDAUQBRQFGAUcBSAFJAUoBSwFMAU0BTgFPAVABUQFSAVMBVAFVAVYBVwFYAVkBWgFbAVwBXQFeAV8BYAFhAWIBYwFkAWUBZgFnAWgBaQFqAWsBbAFtAW4BbwFwAXEBcgFzAXQBdQF2AXcBeAF5AXoBewF8AX0BfgF/AYABgQGCAYMBhAGFAYYBhwGIAYkBigGLAYwBjQGOAY8GLm5vZGVmB3VuaUUwMDAHdW5pRTAyMgd1bmlFMDIzB3VuaUUwMjQHdW5pRTAzMAd1bmlFMDM4B3VuaUUwMzkHdW5pRTA0Mwd1bmlFMDQ1B3VuaUUwNDYHdW5pRTA0Nwd1bmlFMDQ4B3VuaUUwNTAHdW5pRTA1Qwd1bmlFMDYyB3VuaUUwNjkHdW5pRTA3QQd1bmlFMDdCB3VuaUUwN0MHdW5pRTA3RAd1bmlFMDgwB3VuaUUwODEHdW5pRTA4Mgd1bmlFMDgzB3VuaUUwODQHdW5pRTA4NQd1bmlFMDg2B3VuaUUwODcHdW5pRTA4OAd1bmlFMDg5B3VuaUUwOEEHdW5pRTA4Qgd1bmlFMDhDB3VuaUUwOTQHdW5pRTA5NQd1bmlFMEEwB3VuaUUwQTEHdW5pRTBBMgd1bmlFMEEzB3VuaUUwQTQHdW5pRTBBOQd1bmlFMEIzB3VuaUUxMDEHdW5pRTFCOQd1bmlFMUJCB3VuaUUxRTcHdW5pRTFGMgd1bmlFMUY0B3VuaUUxRjcHdW5pRTFGOQd1bmlFMUZDB3VuaUUxRkUHdW5pRTFGRgd1bmlFMjAwB3VuaUUyNDAHdW5pRTI0MQd1bmlFMjQyB3VuaUUyNDMHdW5pRTI0NAd1bmlFMjQ1B3VuaUUyNDYHdW5pRTI0Nwd1bmlFMjQ4B3VuaUUyNDkHdW5pRTI2MAd1bmlFMjYxB3VuaUUyNjIHdW5pRTI2Mwd1bmlFMjY0B3VuaUUyODAHdW5pRTI4MQd1bmlFMjgyB3VuaUUyODMHdW5pRTRBMAd1bmlFNEEyB3VuaUU0QTQHdW5pRTRBOAd1bmlFNEFDB3VuaUU0QzAHdW5pRTRDRQd1bmlFNEUxB3VuaUU0RTIHdW5pRTRFMwd1bmlFNEU0B3VuaUU0RTUHdW5pRTRFNgd1bmlFNEU3B3VuaUU0RTgHdW5pRTRFOQd1bmlFNEVBB3VuaUU0RUUHdW5pRTUwMAd1bmlFNTAxB3VuaUU1MjAHdW5pRTUyMQd1bmlFNTIyB3VuaUU1MjMHdW5pRTUyNAd1bmlFNTI1B3VuaUU1MjkHdW5pRTUyQQd1bmlFNTJCB3VuaUU1MkMHdW5pRTUyRAd1bmlFNTJGB3VuaUU1MzAHdW5pRTUzMQd1bmlFNTM5B3VuaUU1NjYHdW5pRTU2Nwd1bmlFNTY5B3VuaUU1NkMHdW5pRTU2RAd1bmlFNTgyB3VuaUU1RDAHdW5pRTVFMgd1bmlFNjEwB3VuaUU2MTIHdW5pRTYxNAd1bmlFNjE4B3VuaUU2MjQHdW5pRTYzMAd1bmlFNjUwB3VuaUU2NTUHdW5pRTkxMAd1bmlFOTExB3VuaUU5MTIHdW5pRTkxNAd1bmlFOTE1B3VuaUU5MTgHdW5pRTkyMAd1bmlFOTI1B3VuaUU5NUQHdW5pRUEwMgd1bmlFQUE0B3VuaUVDQTIHdW5pRUNBMwd1bmlFQ0E1B3VuaUVDQTcHdW5pRUNBOQd1bmlFQ0I3AAAAAAAAAf//AAIAAQAAAAAAAAAMABQABAAAAAIAAAABAAAAAQAAAAAAAQAAAADZahNDAAAAANGXIhcAAAAA2dy6gQ==") format("truetype")',font_tb=[],font_st={},font_scale_tb={serif:1,serifBold:1,"sans-serif":1,"sans-serifBold":1,Palatino:1.1,monospace:1.35},fmt_lock={},cfmt={annotationfont:{name:"sans-serif",size:12},aligncomposer:1,beamslope:.4,breaklimit:.7,breakoneoln:!0,cancelkey:!0,composerfont:{name:"serif",style:"italic",size:14},composerspace:6,dblrepbar:":][:",decoerr:!0,dynalign:!0,footerfont:{name:"serif",size:16},fullsvg:"",gchordfont:{name:"sans-serif",size:12},gracespace:new Float32Array([4,8,11]),graceslurs:!0,headerfont:{name:"serif",size:16},historyfont:{name:"serif",size:16},hyphencont:!0,indent:0,infofont:{name:"serif",style:"italic",size:14},infoname:'R "Rhythm: "\nB "Book: "\nS "Source: "\nD "Discography: "\nN "Notes: "\nZ "Transcription: "\nH "History: "',infospace:0,keywarn:!0,leftmargin:1.4*CM,lineskipfac:1.1,linewarn:!0,maxshrink:.65,maxstaffsep:2e3,maxsysstaffsep:2e3,measurefont:{name:"serif",style:"italic",size:10},measurenb:-1,musicfont:{name:"music",src:musicfont,size:24},musicspace:6,partsfont:{name:"serif",size:15},parskipfac:.4,partsspace:8,pagewidth:21*CM,printmargin:0,rightmargin:1.4*CM,rbdbstop:!0,rbmax:4,rbmin:2,repeatfont:{name:"serif",size:13},scale:1,slurheight:1,staffsep:46,stemheight:21,stretchlast:.25,stretchstaff:!0,subtitlefont:{name:"serif",size:16},subtitlespace:3,sysstaffsep:34,tempofont:{name:"serif",weight:"bold",size:12},textfont:{name:"serif",size:16},textspace:14,tieheight:1,titlefont:{name:"serif",size:20},titlespace:6,titletrim:!0,topspace:22,tuplets:[0,0,0,0],vocalfont:{name:"serif",weight:"bold",size:13},vocalspace:10,voicefont:{name:"serif",weight:"bold",size:13},writefields:"CMOPQsTWw",wordsfont:{name:"serif",size:16},wordsspace:5};function get_bool(t){return!t||!/^(0|n|f)/i.test(t)}function get_font_scale(t){var e=info_split(t);if(!(e.length<=1)){var r=parseFloat(e[e.length-1]);isNaN(r)||r<=.5?syntax(1,"Bad scale value in %%font"):font_scale_tb[e[0]]=r}}function set_font_fac(t){var e=font_scale_tb[t.name];e||(e=1.1),t.swfac=t.size*e}function param_set_font(t,e){var r,n,i;if("-"==t[t.length-2]){if((n=t[t.length-1])<"1"||n>"9")return;t="u"+n+"font"}if(r=(r=cfmt[t])?{name:r.name,size:r.size,box:r.box}:{},cfmt[t]=r,(i=e.match(/\s+(no)?box(\s|$)/))&&(i[1]?r.box=!1:r.box=!0,e=e.replace(i[0],i[2])),(i=e.match(/\s+class=(.*?)(\s|$)/))&&(r.class=i[1],e=e.replace(i[0],i[2])),i=e.match(/\s+wadj=(.*?)(\s|$)/)){if("undefined"==typeof document)switch(i[1]){case"none":r.wadj="";break;case"space":r.wadj="spacing";break;case"glyph":r.wadj="spacingAndGlyphs";break;default:syntax(1,errs.bad_val,"%%"+t)}e=e.replace(i[0],i[2])}switch((i=e.match(/\s+([0-9.]+|\*)$/))&&("*"!=i[1]&&(r.size=Number(i[1])),e=e.replace(i[0],"")),(i=e.match(/[- ]?[nN]ormal/))&&(r.normal=!0,e=e.replace(i[0],"")),(i=e.match(/[- ]?[bB]old/))&&(r.weight="bold",e=e.replace(i[0],"")),(i=e.match(/[- ]?[iI]talic/))&&(r.style="italic",e=e.replace(i[0],"")),(i=e.match(/[- ]?[oO]blique/))&&(r.style="oblique",e=e.replace(i[0],"")),r.size?set_font_fac(r):r.swfac=0,e){case"":case"*":return;case"Times-Roman":case"Times":e="serif";break;case"Helvetica":e="sans-serif";break;case"Courier":e="monospace"}"("==e[3]&&(r.src=e,r.fid=font_tb.length,font_tb.push(r),e="ft"+r.fid),r.name=e}function get_unit(t){var e=t.toLowerCase().match(/([\d.]+)(.*)/);switch(e[1]=Number(e[1]),e[2]){case"cm":return e[1]*CM;case"in":return e[1]*IN;case"pt":return.75*e[1];case"px":case"":return e[1]}return NaN}function set_infoname(t){for(var e=cfmt.infoname.split("\n"),r=t[0],n=0;n<e.length;n++){if(e[n][0]==r)return 1==t.length?e.splice(n,1):e[n]=t,void(cfmt.infoname=e.join("\n"))}cfmt.infoname+="\n"+t}var textopt={align:"j",center:"c",fill:"f",justify:"j",ragged:"f",right:"r",skip:"s"};function get_textopt(t){return textopt[t]}var posval={above:C.SL_ABOVE,auto:0,below:C.SL_BELOW,down:C.SL_BELOW,hidden:C.SL_HIDDEN,opposite:C.SL_HIDDEN,under:C.SL_BELOW,up:C.SL_ABOVE};function set_pos(t,e){"ste"==(t=t.slice(0,3))&&(t="stm"),set_v_param("pos",t+" "+e)}function set_writefields(t){var e,r,n=t.split(/\s+/);if(get_bool(n[1]))for(r=0;r<n[0].length;r++)e=n[0][r],cfmt.writefields.indexOf(e)<0&&(cfmt.writefields+=e);else for(r=0;r<n[0].length;r++)e=n[0][r],cfmt.writefields.indexOf(e)>=0&&(cfmt.writefields=cfmt.writefields.replace(e,""))}function set_v_param(t,e){t=[t+"=",e],curvoice?set_kv_parm(t):memo_kv_parm("*",t)}function set_page(){img.chg&&(img.chg=!1,img.lm=cfmt.leftmargin-cfmt.printmargin,img.lm<0&&(img.lm=0),img.rm=cfmt.rightmargin-cfmt.printmargin,img.rm<0&&(img.rm=0),img.width=cfmt.pagewidth-2*cfmt.printmargin,img.width-img.lm-img.rm<100&&(error(0,void 0,"Bad staff width"),img.width=img.lm+img.rm+150),set_posx())}function st_font(t){var e=t.name,r="";return t.weight&&(r+=t.weight+" "),t.style&&(r+=t.style+" "),e.indexOf('"')<0&&e.indexOf(" ")>0&&(e='"'+e+'"'),r+t.size.toFixed(1)+"px "+e}function style_font(t){return"font:"+st_font(t)}function font_class(t){return t.class?"f"+t.fid+cfmt.fullsvg+" "+t.class:"f"+t.fid+cfmt.fullsvg}function use_font(t){t.used||(t.used=!0,null==t.fid&&(t.fid=font_tb.length,font_tb.push(t),t.swfac||set_font_fac(t)),font_style+="\n.f"+t.fid+cfmt.fullsvg+"{"+style_font(t)+"}",t.src&&(font_style+="\n@font-face{\n font-family:"+t.name+";\n src:"+t.src+"}"))}function get_font(t){var e,r,n,i;if(!(e=cfmt[t+="font"]))return syntax(1,"Unknown font $1","$"+t[1]),gene.curfont;if(!e.name||!e.size){if(r=Object.create(gene.curfont),e.name&&(r.name=e.name),e.normal?(r.weight&&(r.weight=null),r.style&&(r.style=null)):(e.weight&&(r.weight=e.weight),e.style&&(r.style=e.style)),e.class&&(r.class=e.class),e.size&&(r.size=e.size),i=st_font(r),null!=(n=font_st[i]))return font_tb[n];font_st[i]=font_tb.length,r.fid=r.used=void 0,e=r}return use_font(e),e}Abc.prototype.set_format=function(t,e){var r,n,i,s;if(/.+font(-[\d])?$/.test(t))param_set_font(t,e);else switch(t){case"aligncomposer":case"barsperstaff":case"infoline":case"measurenb":case"rbmax":case"rbmin":case"shiftunison":if(i=parseInt(e),isNaN(i)){syntax(1,"Bad integer value");break}cfmt[t]=i;break;case"microscale":if(r=parseInt(e),isNaN(r)||r<4||r>256||r%1){syntax(1,errs.bad_val,"%%"+t);break}set_v_param("uscale",r);break;case"bgcolor":case"fgcolor":case"dblrepbar":case"titleformat":cfmt[t]=e;break;case"beamslope":case"breaklimit":case"lineskipfac":case"maxshrink":case"pagescale":case"parskipfac":case"scale":case"slurheight":case"stemheight":case"stretchlast":case"tieheight":if(r=parseFloat(e),isNaN(r)){syntax(1,errs.bad_val,"%%"+t);break}switch(t){case"scale":r/=.75;case"pagescale":t="scale",img.chg=!0}cfmt[t]=r;break;case"annotationbox":case"gchordbox":case"measurebox":case"partsbox":cfmt[t.replace("box","font")].box=get_bool(e);break;case"bstemdown":case"breakoneoln":case"cancelkey":case"contbarnb":case"custos":case"decoerr":case"dynalign":case"flatbeams":case"graceslurs":case"graceword":case"hyphencont":case"keywarn":case"linewarn":case"quiet":case"rbdbstop":case"singleline":case"squarebreve":case"splittune":case"straightflags":case"stretchstaff":case"timewarn":case"titlecaps":case"titleleft":cfmt[t]=get_bool(e);break;case"chordnames":for(i=e.split(","),cfmt.chordnames={},s=0;s<i.length;s++)cfmt.chordnames["CDEFGAB"[s]]=i[s];break;case"composerspace":case"indent":case"infospace":case"maxstaffsep":case"maxsysstaffsep":case"musicspace":case"partsspace":case"staffsep":case"subtitlespace":case"sysstaffsep":case"textspace":case"titlespace":case"topspace":case"vocalspace":case"wordsspace":r=get_unit(e),isNaN(r)?syntax(1,errs.bad_val,"%%"+t):cfmt[t]=r;break;case"print-leftmargin":syntax(0,"$1 is deprecated - use %%printmargin instead","%%"+t),t="printmargin";case"printmargin":case"leftmargin":case"pagewidth":case"rightmargin":if(r=get_unit(e),isNaN(r)){syntax(1,errs.bad_val,"%%"+t);break}cfmt[t]=r,img.chg=!0;break;case"concert-score":"play"!=cfmt.sound&&(cfmt.sound="concert");break;case"writefields":set_writefields(e);break;case"dynamic":case"gchord":case"gstemdir":case"ornament":case"stemdir":case"vocal":case"volume":set_pos(t,e);break;case"font":get_font_scale(e);break;case"fullsvg":if(0!=parse.state){syntax(1,errs.not_in_tune,"%%fullsvg");break}cfmt[t]=e;break;case"gracespace":for(i=e.split(/\s+/),s=0;s<3;s++)if(isNaN(Number(i[s]))){syntax(1,errs.bad_val,"%%gracespace");break}for(s=0;s<3;s++)cfmt[t][s]=Number(i[s]);break;case"tuplets":cfmt[t]=e.split(/\s+/),(i=cfmt[t][3])&&posval[i]&&(cfmt[t][3]=posval[i]);break;case"infoname":set_infoname(e);break;case"notespacingfactor":if(r=parseFloat(e),isNaN(r)||r<1||r>2){syntax(1,errs.bad_val,"%%"+t);break}for(n=space_tb[s=5];--s>=0;)n/=r,space_tb[s]=n;for(n=space_tb[s=5];++s<space_tb.length;)n*=r,space_tb[s]=n;break;case"play":cfmt.sound="play";break;case"pos":set_pos((t=e.split(/\s+/))[0],t[1]);break;case"sounding-score":"play"!=cfmt.sound&&(cfmt.sound="sounding");break;case"staffwidth":if(i=get_unit(e),isNaN(i)){syntax(1,errs.bad_val,"%%"+t);break}if(i<100){syntax(1,"%%staffwidth too small");break}if((i=cfmt.pagewidth-i-cfmt.leftmargin)<2){syntax(1,"%%staffwidth too big");break}cfmt.rightmargin=i,img.chg=!0;break;case"textoption":cfmt[t]=get_textopt(e);break;case"titletrim":i=Number(e),isNaN(i)?cfmt[t]=get_bool(e):cfmt[t]=i;break;case"combinevoices":syntax(1,"%%combinevoices is deprecated - use %%voicecombine instead");break;case"voicemap":set_v_param("map",e);break;case"voicescale":set_v_param("scale",e);break;default:0==parse.state&&(cfmt[t]=e)}},Abc.prototype.style_font=style_font;var sav={},mac={},maci={},abc_utf={"=D":"","=H":"","=T":"","=d":"","=h":"","=t":"","/O":"","/o":"","/L":"","/l":"",vL:"",vl:"",vd:"",".i":"",AA:"",aa:"",AE:"",ae:"",DH:"",dh:"",OE:"",oe:"",ss:"",TH:"",th:""},oct_acc={1:"",2:"",3:"",4:"&#x1d12a;",5:"&#x1d12b;"};function cnv_escape(t){for(var e,r,n,i="",s=0;!((n=t.indexOf("\\",s))<0);){if(i+=t.slice(s,n),!(e=t[++n]))return i+"\\";switch(e){case"0":case"2":if("0"!=t[n+1])break;if(r=oct_acc[t[n+2]]){i+=r,s=n+3;continue}break;case"u":if(s=Number("0x"+t.slice(n+1,n+5)),isNaN(s)||s<32){i+=t[++n]+"",s=n+1;continue}i+=String.fromCharCode(s),s=n+5;continue;case"t":i+=" ",s=n+1;continue;default:if(r=abc_utf[t.slice(n,n+2)]){i+=r,s=n+2;continue}if(r=t[n+1],!/[A-Za-z]/.test(r))break;switch(e){case"`":i+=r+"",s=n+2;continue;case"'":i+=r+"",s=n+2;continue;case"^":i+=r+"",s=n+2;continue;case"~":i+=r+"",s=n+2;continue;case"=":i+=r+"",s=n+2;continue;case"_":i+=r+"",s=n+2;continue;case".":i+=r+"",s=n+2;continue;case'"':i+=r+"",s=n+2;continue;case"o":i+=r+"",s=n+2;continue;case"H":i+=r+"",s=n+2;continue;case"v":i+=r+"",s=n+2;continue;case"c":i+=r+"",s=n+2;continue;case";":i+=r+"",s=n+2;continue}}i+="\\"+e,s=n+1}return i+t.slice(s)}var include=0;function do_include(t){var e,r;user.read_file?include>2?syntax(1,"Too many include levels"):(e=user.read_file(t))?(include++,r=clone(parse),tosvg(t,e),r.state=parse.state,parse=r,include--):syntax(1,"Cannot read file '$1'",t):syntax(1,"No read_file support")}function tosvg(t,e,r,n){var i,s,a,o,c,l,u,f,$,h,p,d,_="\n";function m(){var t,i,a=e.indexOf("K:",r);return!(a<0)&&(a=e.indexOf("\n",a),!!parse.select.test(e.slice(parse.bol,a))||((t=/\n\w*\n/).lastIndex=a,i=t.exec(e),s=i?t.lastIndex:n,!1))}function y(t,e){return t?(t.indexOf("%")>=0&&(t=t.replace(/([^\\])%.*/,"$1").replace(/\\%/g,"%")),t=t.replace(/\s+$/,""),e&&t.indexOf("\\")>=0?cnv_escape(t):t):t}function g(){generate(),set_page(),info.W&&put_words(info.W),put_history(),parse.state=0,blk_flush(),cfmt=sav.cfmt,info=sav.info,char_tb=sav.char_tb,glovar=sav.glovar,maps=sav.maps,mac=sav.mac,maci=sav.maci,parse.tune_v_opts=null,parse.scores=null,init_tune(),img.chg=!0,set_page()}function v(t,r){var n,i;if("end"!=t){for(r?(parse.tune_v_opts||(parse.tune_v_opts={}),n=parse.tune_v_opts):(parse.voice_opts||(parse.voice_opts={}),n=parse.voice_opts),n[t]=[];i=++s,"%"==e[i];)if(s=e.indexOf("\n",s),e[i+1]==l){switch(i+=2,$=s<0?e.slice(i):e.slice(i,s),(h=$.match(/\S+/))[0]){default:n[t].push(y($,!0));continue;case"score":case"staves":case"tune":case"voice":i-=2}break}s=parse.eol=i-1}}function b(){var t,n,i,s,a=e.indexOf("K:",r);for(a in a=e.indexOf("\n",a),s=e.slice(parse.bol,a),parse.tune_opts)if(parse.tune_opts.hasOwnProperty(a)&&new RegExp(a).test(s)){for(t=parse.tune_opts[a],n=0;n<t.t_opts.length;n++)switch((i=t.t_opts[n]).match(/\S+/)[0]){case"score":case"staves":parse.scores||(parse.scores=[]),parse.scores.push(i);break;default:self.do_pscom(i)}if(t=t.v_opts)for(n in t)t.hasOwnProperty(n)&&(parse.tune_v_opts||(parse.tune_v_opts={}),parse.tune_v_opts[n]?parse.tune_v_opts[n]=parse.tune_v_opts[n].concat(t[n]):parse.tune_v_opts[n]=t[n])}}for(abc2svg.modules&&(abc2svg.modules.hooks.length||abc2svg.modules.g_hooks.length)&&set_hooks(),parse.file=e,parse.fname=t,null==r&&(r=0),n||(n=e.length);r<n;r=parse.eol+1){for(((s=e.indexOf("\n",r))<0||s>n)&&(s=n),parse.eol=s;;){switch(e[--s]){case" ":case"\t":continue}break}if(++s!=r){if(parse.istart=parse.bol=r,parse.iend=s,parse.line.index=0,c=e[r],l=e[r+1],"%"==c){if(parse.prefix.indexOf(l)<0)continue;"a"==e[r+2]&&"b"==e[r+3]&&"c"==e[r+4]&&" "==e[r+5]?(c=e[r+=6],l=e[r+1]):d=!0}else"I"==c&&":"==l&&(d=!0);if(d){if(d=!1,r+=2,$=e.slice(r,s),!(h=$.match(/([^\s]+)\s*(.*)/))||"%"==h[1][0])continue;switch(h[1]){case"abcm2ps":case"ss-pref":parse.prefix=h[2];continue;case"abc-include":do_include(y(h[2]));continue}if("begin"==h[1].slice(0,5)){if(p=h[1].substr(5),a="\n"+c+l+"end"+p,(i=e.indexOf(a,s))<0){syntax(1,"No $1 after %%$2",a.slice(1),h[1]),parse.eol=n;continue}self.do_begin_end(p,y(h[2]),e.slice(s+1,i).replace(new RegExp("^"+c+l,"gm"),"")),parse.eol=e.indexOf("\n",i+6),parse.eol<0&&(parse.eol=n);continue}switch(h[1]){case"select":if(0!=parse.state){syntax(1,errs.not_in_tune,"%%select");continue}if('"'==(o=y($.slice(7)))[0]&&(o=o.slice(1,-1)),!o){delete parse.select;continue}o=(o=o.replace(/\(/g,"\\(")).replace(/\)/g,"\\)"),parse.select=new RegExp(o,"m");continue;case"tune":if(0!=parse.state){syntax(1,errs.not_in_tune,"%%tune");continue}if(!(o=y(h[2]))){parse.tune_opts={};continue}if("end"==o)continue;for(parse.tune_opts||(parse.tune_opts={}),parse.tune_opts[o]=f={t_opts:[]};r=++s,"%"==e[r];)if(s=e.indexOf("\n",s),e[r+1]==l){switch(r+=2,$=s<0?e.slice(r):e.slice(r,s),(h=$.match(/([^\s]+)\s*(.*)/))[1]){case"tune":break;case"voice":v(y(h[2],!0),!0);continue;default:f.t_opts.push(y($,!0));continue}break}parse.tune_v_opts&&(f.v_opts=parse.tune_v_opts,parse.tune_v_opts=null),parse.eol=r-1;continue;case"voice":if(0!=parse.state){syntax(1,errs.not_in_tune,"%%voice");continue}if(!(o=y(h[2]))){parse.voice_opts=null;continue}v(o);continue}self.do_pscom(y($,!0))}else if(":"==l&&/[A-Za-z+]/.test(c)){for(r+=2;;){switch(e[r]){case" ":case"\t":r++;continue}break}if($=y(e.slice(r,s),!0),"+"==c){if(!u){syntax(1,"+: without previous info field");continue}_=" ",c=u}switch(c){case"X":if(0!=parse.state){syntax(1,errs.ignored,c);continue}if(parse.select&&!m()){(s=e.indexOf("\nX:",parse.eol))<0&&(s=n),parse.eol=s;continue}sav.cfmt=clone(cfmt),sav.info=clone(info,2),sav.char_tb=clone(char_tb),sav.glovar=clone(glovar),sav.maps=clone(maps,1),sav.mac=clone(mac),sav.maci=clone(maci),info.X=$,parse.state=1,blkdiv<1&&(blkdiv=1),parse.tune_opts&&b();continue;case"T":switch(parse.state){case 0:continue;case 1:case 2:null==info.T?info.T=$:info.T+="\n"+$;continue}new_block("title").text=$;continue;case"K":switch(parse.state){case 0:continue;case 1:info.K=$}do_info(c,$);continue;case"W":if(0==parse.state||cfmt.writefields.indexOf(c)<0)break;null==info.W?info.W=$:info.W+=_+$;break;case"m":if(parse.state>=2){syntax(1,errs.ignored,c);continue}if(!(h=$.match(/(.*?)[= ]+(.*)/))||!h[2]){syntax(1,errs.bad_val,"m:");continue}mac[h[1]]=h[2],maci[h[1][0]]=!0;break;case"s":if(3!=parse.state||cfmt.writefields.indexOf(c)<0)break;get_sym($," "==_);break;case"w":if(3!=parse.state||cfmt.writefields.indexOf(c)<0)break;if(get_lyrics($," "==_),"\\"==$.slice(-1)){_=" ",u=c;continue}break;case"|":if(parse.state<2)continue;parse.line.buffer=$,parse_music_line();continue;default:if("ABCDFGHNOSZ".indexOf(c)>=0){if(parse.state>=2){syntax(1,errs.ignored,c);continue}info[c]?info[c]+=_+$:info[c]=$;break}do_info(c,$);continue}_="\n",u=c}else{if(u=void 0,parse.state<2)continue;parse.line.buffer=y(e.slice(r,s),!0),parse_music_line()}}else 1==parse.state?(parse.istart=r,syntax(1,"Empty line in tune header - ignored")):parse.state>=2&&(g(),parse.select&&((s=e.indexOf("\nX:",parse.eol))<0&&(s=n),parse.eol=s))}include||(parse.state>=2&&g(),parse.state=0)}Abc.prototype.tosvg=tosvg;var gene,staff_tb,nstaff,tsnext,realwidth,insert_meter,spf_last,space_tb=new Float32Array([8.4,11.2,14.9,19.8,26.3,35,46.6,61.9,82.3,109.5]),smallest_duration,dx_tb=new Float32Array([10,10,11,13,15]),hw_tb=new Float32Array([4.7,5,6,7.2,7.5]),w_note=new Float32Array([3.5,3.7,5,6,7]);function identify_note(t,e){var r,n,i=0,s=e;for(s%12!=0&&error(1,t,"Invalid note duration $1",s),(s/=12)||error(1,t,"Note too short"),n=5;0!=s&&!(1&s);s>>=1,n--);for((s>>=1)+1&s&&error(0,t,"Non standard note duration $1",e);s>>i>0;)i++;if((n-=i)>=0)r=C.FULL;else switch(n){default:error(1,t,"Note too long"),n=-4;case-4:r=C.SQUARE;break;case-3:r=cfmt.squarebreve?C.SQUARE:C.OVALBARS;break;case-2:r=C.OVAL;break;case-1:r=C.EMPTY}return[r,i,n]}function set_head_shift(t){var e,r,n,i,s,a,o=dx_tb[t.head],c=t.stem,l=t.nhd;if(l){a=.78*o,t.grace&&(a*=.5),c>=0?(r=1,n=l+1,s=t.notes[0].pit):(a=-a,r=l-1,n=-1,s=t.notes[l].pit);var u=!1,f=0;for(e=r;e!=n;e+=c){if(i=t.notes[e].pit-s,s=t.notes[e].pit,!i){if(u){var $=t.notes[e].shhd=t.notes[e-c].shhd+a;f<$&&(f=$);continue}if(e+c!=n&&s+c==t.notes[e+c].pit){t.notes[e].shhd=-a,f<-a&&(f=-a);continue}}i<0&&(i=-i),i>3||i>=2&&t.head!=C.SQUARE?u=!1:(u=!u)&&(t.notes[e].shhd=a,f<a&&(f=a))}t.xmx=f}}function acc_shift(t,e){var r,n,i,s,a,o,c,l,u,f=t.length;for(r=f-1;--r>=0;)if((s=t[r].shhd)&&!(s>0))for(s=e-s,c=t[r].pit,n=f;--n>=0;)if(t[n].acc){if((l=t[n].pit)<c-3)break;l>c+3||t[n].shac<s&&(t[n].shac=s)}for(n=f;--n>=0;)if(t[n].acc){l=t[n].pit,(a=t[n].shac)||(a=(a=t[n].shhd)<0?e-a:e);break}if(!(n<0)){for(i=0;i<n;i++)if(t[i].acc){c=t[i].pit,(o=t[i].shac)||(o=(o=t[i].shhd)<0?e-o:e);break}if(n!=i){for(l>c+4?(a>o&&(o=a),t[n].shac=t[i].shac=o):(t[n].shac=a,t[i].shac=o=a+7),o+=7,r=n;--r>i;)if(u=t[r].acc){for((s=t[r].shac)<o&&(s=o),c=t[r].pit,n=f;--n>r;)t[n].acc&&((l=t[n].pit)>=c+4&&(l>c+4||u<0||t[n].acc<0)||s>t[n].shac-6&&(a=t[n].shac+7)>s&&(s=a));t[r].shac=s}}else t[n].shac=a}}function set_acc_shft(){var t,e,r,n,i,s,a,o;for(t=tsfirst;t;)if(t.type!=C.NOTE||t.invis)t=t.ts_next;else{for(i=t.st,s=t.time,n=!1,e=t;e&&(e.time==s&&e.type==C.NOTE&&e.st==i);e=e.ts_next)if(!n)for(r=0;r<=e.nhd;r++)if(e.notes[r].acc){n=!0;break}if(n){for(a=dx_tb[t.head],o=[];t!=e;t=t.ts_next)Array.prototype.push.apply(o,t.notes);o.sort(abc2svg.pitcmp),acc_shift(o,a)}else t=e}}function lkvsym(t,e){t.next=e,t.prev=e.prev,t.prev?t.prev.next=t:t.p_v.sym=t,e.prev=t}function lktsym(t,e){e?(t.ts_next=e,t.ts_prev=e.ts_prev,t.ts_prev&&(t.ts_prev.ts_next=t),e.ts_prev=t):t.ts_next=t.ts_prev=null,t.seqst=!t.ts_prev||t.ts_prev.type!=t.type,(t=t.ts_next)&&(t.seqst=t.ts_prev.type!=t.type)}function unlksym(t){t.next&&(t.next.prev=t.prev),t.prev?t.prev.next=t.next:t.p_v.sym=t.next,t.ts_next&&(t.seqst?t.ts_next.seqst?(t.ts_next.shrink+=t.shrink,t.ts_next.space+=t.space):(t.ts_next.seqst=!0,t.ts_next.shrink=t.shrink,t.ts_next.space=t.space):t.ts_next.seqst&&t.ts_prev&&t.ts_prev.seqst&&!w_tb[t.ts_prev.type]&&(t.ts_next.seqst=!1,t.shrink=t.ts_next.shrink,t.space=t.ts_next.space),t.ts_next.ts_prev=t.ts_prev),t.ts_prev&&(t.ts_prev.ts_next=t.ts_next),tsfirst==t&&(tsfirst=t.ts_next),tsnext==t&&(tsnext=t.ts_next)}function insert_clef(t,e,r){var n,i=t.p_v,s=t.st;for(t.type==C.BAR&&t.prev&&t.prev.type==C.BAR&&":"!=t.prev.bar_type[0]&&(t=t.prev),i.last_sym=t.prev,i.last_sym||(i.sym=null),i.time=t.time,(n=sym_add(i,C.CLEF)).next=t,t.prev=n,n.clef_type=e,n.clef_line=r,n.st=s,n.clef_small=!0,delete n.second,n.notes=[],n.notes[0]={pit:t.notes[0].pit},n.nhd=0;!t.seqst;)t=t.ts_prev;return lktsym(n,t),n}function set_float(){var t,e,r,n,i,s,a,o;for(n=0;n<voice_tb.length;n++)for(r=!1,e=(t=voice_tb[n]).st,i=t.sym;i;i=i.next){if(!i.floating){for(;i&&!i.floating;)i=i.next;if(!i)break;r=!1}if(i.dur)if(i.notes[0].pit>=19)r=!1;else if(i.notes[i.nhd].pit<=12)r=!0,i.st++;else{for(a=127,s=i.ts_prev;s&&(s.st==e&&s.v!=i.v);s=s.ts_prev)s.type==C.NOTE&&s.notes[0].pit<a&&(a=s.notes[0].pit);if(127!=a)if(i.notes[i.nhd].pit>a-3)r=!1;else{for(o=-127,s=i.ts_next;s&&(s.st==e+1&&s.v!=i.v);s=s.ts_next)s.type==C.NOTE&&s.notes[s.nhd].pit>o&&(o=s.notes[s.nhd].pit);if(-127!=o)if(i.notes[0].pit<o+3)r=!0,i.st++;else{if(a-=i.notes[i.nhd].pit,o=i.notes[0].pit-o,r){if(a<o-3){r=!1;continue}}else{if(a<o+3)continue;r=!0}i.st++}else r&&i.st++}else r&&i.st++}else r&&i.st++}}function set_graceoffs(t){var e,r,n,i,s=cfmt.gracespace[0],a=cfmt.gracespace[1],o=cfmt.gracespace[2],c=t.extra;for(t.prev&&t.prev.type==C.BAR&&(s-=3),i=s,c.beam_st=!0;;c=c.next){for(set_head_shift(c),acc_shift(c.notes,7),n=0,r=c.nhd;r>=0;r--)c.notes[r].shac>n&&(n=c.notes[r].shac);if(i+=n,c.x=i,c.nflags<=0&&(c.beam_st=!0,c.beam_end=!0),!(e=c.next)){c.beam_end=!0;break}e.nflags<=0&&(c.beam_end=!0),c.beam_end&&(e.beam_st=!0,i+=a/4),c.nflags<=0&&(i+=a/4),c.y>e.y+8&&(i-=1.5),i+=a}return(e=t.next)&&e.type==C.NOTE&&(c.y>=3*(e.notes[e.nhd].pit-18)?o-=1:c.beam_st&&c.y<3*(e.notes[e.nhd].pit-18)-4&&(o+=2)),i+=o}function set_w_chs(t){for(var e,r,n,i,s,a=0,o=0;t;t=t.ts_next)if(t.shrink&&(a+=t.shrink,o++),t.a_gch)for(e=0;e<t.a_gch.length;e++)if(!("g"!=(r=t.a_gch[e]).type||r.y<0)){if(n&&n>a+r.x)for(s=(n-a-r.x)/o;(i=i.ts_next).shrink&&(i.shrink+=s),i!=t;);i=t,n=r.wh[0],o=0,a=0;break}}function gchord_width(t,e,r){var n,i,s,a=0;for(s=0;s<t.a_gch.length;s++)switch((n=t.a_gch[s]).type){case"<":(i=n.wh[0]+e)>r&&(r=i);break;case">":(i=n.wh[0]+t.wr)>a&&(a=i)}return t.wr<a&&(t.wr=a),r}function time2space(t,e){var r,n,i;return smallest_duration>=C.BLEN/2?smallest_duration>=C.BLEN?e/=4:e/=2:!t.next&&e>=C.BLEN&&(e/=2),r=e>=C.BLEN/4?e<C.BLEN/2?5:e<C.BLEN?6:e<2*C.BLEN?7:e<4*C.BLEN?8:9:e>=C.BLEN/8?4:e>=C.BLEN/16?3:e>=C.BLEN/32?2:e>=C.BLEN/64?1:0,n=e-(C.BLEN/16/8<<r),i=space_tb[r],n&&(n<0?i=space_tb[0]*e/(C.BLEN/16/8):(r>=9&&(r=8),i+=(space_tb[r+1]-space_tb[r])*n/(C.BLEN/16/8<<r))),i}function set_space(t,e){var r,n,i,s;if(!(n=t.time-e)){switch(t.type){case C.MREST:return t.wl}return 0}if(t.ts_prev.type==C.MREST)return 71;for(r=time2space(t,n);!t.dur;){switch(t.type){case C.BAR:return.9*r-7;case C.CLEF:return r-t.wl-t.wr;case C.BLOCK:case C.PART:case C.REMARK:case C.STAVES:case C.TEMPO:if(!(t=t.ts_next))return r;continue}break}if(t.dur&&n<=C.BLEN/4)for(i=t;i;){if(!i.beam_st){r*=.9;break}if(!(i=i.ts_next)||i.seqst)break}if(t.type==C.NOTE&&t.nflags>=-1&&t.stem>0){for(s=!0,i=t.ts_prev;i&&i.time==e;i=i.ts_prev)if(i.type==C.NOTE&&(i.nflags<-1||i.stem>0)){s=!1;break}if(s){for(i=t.ts_next;i&&i.time==t.time;i=i.ts_next)if(i.type==C.NOTE&&(i.nflags<-1||i.stem<0)){s=!1;break}s&&(r*=.9)}}return r}function set_sp_tup(t,e){var r,n=t.time,i=e.time+e.dur-n,s=time2space(t,i/t.tp[0].q)*t.tp[0].q/i;do{t=t.ts_next}while(!t.seqst);do{e=e.ts_next}while(!e.seqst);for(r=t;r.dur&&r.dur*s<r.shrink&&(s=r.shrink/r.dur),r!=e;)r=r.ts_next;for(;t.seqst&&(t.space=(t.time-n)*s,n=t.time),t!=e;)t=t.ts_next}function add_end_bar(t){var e={type:C.BAR,bar_type:"|",fname:t.fname,istart:t.istart,iend:t.iend,v:t.v,p_v:t.p_v,st:t.st,dur:0,seqst:!0,invis:!0,time:t.time+t.dur/2,nhd:0,notes:[{pit:t.notes[0].pit}],wl:0,wr:0,prev:t,ts_prev:t,next:t.next,ts_next:t.ts_next,shrink:t.wr+3};return t.next&&(t.next.prev=e),t.ts_next&&(t.ts_next.ts_prev=e),t.next=t.ts_next=e,e.space=set_space(e,t.time),e}function set_allsymwidth(){var t,e,r,n,i,s,a=tsfirst,o=a,c=0,l=[],u=[],f=0;for(t=c,s=a.time;;){do{a.a_gch&&!i&&(i=a),self.set_width(a),null==l[n=a.st]&&(l[n]=0),null==u[n]&&(u[n]=0),(e=l[n]+u[n]+a.wl)>t&&(t=e),a=a.ts_next}while(a&&!a.seqst);if(o.shrink=t-c,f||(o.space=o.ts_prev?set_space(o,s):0),o.shrink||o.space||o.type!=C.CLEF||(delete o.seqst,o.time=s),s=o.time,!a)break;for(n=0;n<u.length;n++)u[n]=0;c=t;do{l[n=o.st]=c,o.wr>u[n]&&(u[n]=o.wr),o.tp&&(f||r||(r=o),f+=o.tp.length),o.tpe&&(f-=o.tpe),o=o.ts_next}while(!o.seqst)}for(;o.ts_next;)o=o.ts_next;if(o.type!=C.BAR&&add_end_bar(o),i&&set_w_chs(i),a=r)do{for(o=a,f=0;a.tp&&(f+=a.tp.length),a.tpe&&(f-=a.tpe),f;)a=a.ts_next;set_sp_tup(o,a);do{a=a.ts_next}while(a&&!a.tp)}while(a)}function to_rest(t){var e=clone(t);return e.prev.next=t.ts_prev=t.prev=e.ts_prev.ts_next=e,e.next=e.ts_next=t,t.seqst=!1,t.invis=t.play=!0,e.type=C.REST,delete e.in_tuplet,delete e.sl1,delete e.a_dd,delete e.a_gch,delete e.sls,e}function set_repeat(t){var e,r,n,i,s,a=t.repeat_n,o=t.repeat_k,c=t.st,l=t.v;if(t.repeat_n=0,a<0){for(n=a=-a,r=t.prev;r;r=r.prev)if(r.dur){if(--n<=0)break}else if(r.type==C.BAR)return void error(1,r,"Bar in repeat sequence");if(!r)return void error(1,t,errs.not_enough_n);for(s=t.time-r.time,n=o*a,e=t;e;e=e.next)if(e.dur){if(--n<=0)break}else if(e.type==C.BAR)return void error(1,e,"Bar in repeat sequence");if(!e||!e.next)return void error(1,t,errs.not_enough_n);for(e=t.prev;e!=r;e=e.prev)if(e.type==C.NOTE){e.beam_end=!0;break}for(i=o;--i>=0;){for(n=a,t.dur&&n--,e=t.ts_next;n>0;)e.st==c&&(e.invis=e.play=!0,e.seqst&&e.ts_next.seqst&&(e.seqst=!1),e.v==l&&e.dur&&n--),e=e.ts_next;for((t=to_rest(t)).dur=t.notes[0].dur=s,t.rep_nb=-1,t.beam_st=!0,self.set_width(t),t.head=C.SQUARE,t=e;t&&(t.st!=c||t.v!=l||!t.dur);t=t.ts_next);}}else{for(n=a,e=t.prev.prev;e&&(e.type!=C.BAR&&e.time!=tsfirst.time||!(--n<=0));e=e.prev);if(e){for(s=t.time-e.time,n=1==a?o:a,e=t;e&&!(e.type==C.BAR&&--n<=0);e=e.next);if(e){if(n=o,2==a&&n>1){if(!(e=e.next))return void error(1,t,errs.not_enough_m);e.repeat_n=a,e.repeat_k=--n}if(s/=a,2==a){for(r=t,e=t.ts_next;;e=e.ts_next)if(e.st==c)if(e.type!=C.BAR)e.invis=e.play=!0,e.seqst&&e.ts_next.seqst&&(e.seqst=!1);else if(e.v==l)break;for((r=to_rest(r)).dur=r.notes[0].dur=s,r.invis=!0,e.bar_mrep=2,e=(r=e.next).ts_next;;e=e.ts_next)if(e.st==c)if(e.type!=C.BAR)e.invis=e.play=!0,e.seqst&&e.ts_next.seqst&&(e.seqst=!1);else if(e.v==l)break;return(r=to_rest(r)).dur=r.notes[0].dur=s,r.invis=!0,void self.set_width(r)}for(r=t,i=o;--i>=0;){for(e=r.ts_next;;e=e.ts_next)if(e.st==c)if(e.type!=C.BAR)e.invis=e.play=!0,e.seqst&&e.ts_next.seqst&&(e.seqst=!1);else if(e.v==l)break;if((r=to_rest(r)).dur=r.notes[0].dur=s,r.beam_st=!0,1==o){r.rep_nb=1;break}r.rep_nb=o-i+1,r=e.next}}else error(1,t,errs.not_enough_m)}else error(1,t,errs.not_enough_m)}}function custos_add(t){for(var e,r,n,i=t;i.type!=C.NOTE;)if(!(i=i.next))return;for((e=t.p_v).last_sym=t.prev,e.time=t.time,(r=sym_add(e,C.CUSTOS)).next=t,t.prev=r,lktsym(r,t),r.shrink=t.shrink,r.shrink<12&&(r.shrink=12),r.space=i.space,r.wl=0,r.wr=4,r.nhd=i.nhd,r.notes=[],n=0;n<t.notes.length;n++)r.notes[n]={pit:i.notes[n].pit,shhd:0,dur:C.BLEN/4};r.stemless=!0}function set_nl(t){var e,r;function n(t){cfmt.custos&&1==voice_tb.length&&custos_add(t),t.nl=!0,(t=t.ts_prev).type!=C.BAR&&add_end_bar(t)}if((t=t.ts_prev).dur){for(r=t.time+t.dur;t;){if(!t.ts_next)return;if(t.time>=r)break;t=t.ts_next}t=t.ts_prev}switch((t=function(t){var e,r;for(e=t.ts_next;e;e=e.ts_next){switch(e.type){case C.KEY:if(!cfmt.keywarn||!e.k_a_acc&&!e.k_sf&&!e.k_old_sf||e.k_none||e.k_play)continue;case C.METER:if(e.type==C.METER&&!cfmt.timewarn)continue;case C.CLEF:if(lktsym(r=clone(e),t.ts_next),!r.prev)continue;for(t=r;;)if((r=r.ts_prev).v==t.v){t.next=r.next,t.prev=r,t.next.prev=t,r.next=t;break}t.type!=t.ts_prev.type&&(t.shrink=t.wl+t.prev.wr,t.space=t.ts_next.space,t.ts_next.space=0);continue}if(w_tb[e.type])break}return t}(t)).type){case C.CLEF:case C.BAR:case C.STAVES:break;case C.GRACE:if(!(t=t.next))return t;default:return function(t){if(!t.next)return n(t),t;for(t=t.ts_next;t;t=t.ts_next)if(t.seqst){n(t);break}return t}(t)}for(;t&&(!t.seqst||t.type==C.CLEF);t=t.ts_prev);for(e=0;;t=t.ts_next){if(!t)return t;if(t.seqst){if(e<0)break;switch(t.type){case C.STAVES:if(!t.ts_prev)return;if(t.ts_prev.type==C.BAR)break;for(;t.ts_next&&(0==w_tb[t.ts_next.type]||t.ts_next.type==C.CLEF);)t=t.ts_next;if(!t.ts_next||t.ts_next.type!=C.BAR)continue;t=t.ts_next;case C.BAR:if(e)break;e=1;continue;case C.STBRK:t.stbrk_forced?e=-1:unlksym(t);continue;case C.CLEF:if(e)break;continue;default:if(!e||t.prev&&t.prev.type==C.GRACE)continue}break}}return n(t),t}function get_ck_width(){var t=voice_tb[0];return self.set_width(t.clef),self.set_width(t.ckey),self.set_width(t.meter),[t.clef.wl+t.clef.wr+t.ckey.wl+t.ckey.wr,t.meter.wl+t.meter.wr]}function get_width(t,e){for(var r,n,i=0,s=0,a=1-cfmt.maxshrink;t!=e;)t.seqst&&(s+=r=t.shrink,(n=t.space)<r?i+=r:i+=r*cfmt.maxshrink+n*a,t.x=i),t=t.ts_next;return e&&(s+=e.wr),[i,s]}function set_lines(t,e,r,n){var i,s,a,o,c,l,u,f,$,h,p=e?e.ts_prev:null;if($=get_width(t,e),cfmt.keywarn&&e&&e.type==C.KEY&&!p.dur&&($[0]+=e.wr,$[1]+=e.wr),$[1]+n<r)return e&&(e=set_nl(e)),e;for(f=$[0]+n;;){if((h=Math.ceil(f/r))<=1)return e&&(e=set_nl(e)),e;for(s=i=t,u=(c=t.x-t.shrink-n)+r,l=c+f/h,c+=f/h*cfmt.breaklimit,t=t.ts_next;t!=e&&!(t.x&&(t.type==C.BAR&&(s=t),t.x>=c));t=t.ts_next);if(t==e)return e&&(e=set_nl(e)),e;for(a=null;t!=e;t=t.ts_next)if(o=t.x){if(o>u)break;if(t.type==C.BAR){if(!(o<l)){(!a||o-l<l-a.x)&&(a=t);break}a=t}}if(!a){var d=0,_=s.time;for(u-=8,t=s;t!=e;t=t.ts_next)if(t.beam_st&&d++,t.beam_end&&d>0&&d--,o=t.x){if(o+t.wr>=u)break;if(!d&&!t.in_tuplet)if((t.time-_)%(C.BLEN/4)!=0){if(a&&!(t.x<l)){if(a>l)break;if(l-a.x<t.x-l)break;a=t;break}a=t}else a=t}}if(!a)for(a=t=s;t!=e;t=t.ts_next)if(o=t.x){if(!(t.x<l)){if(a>l)break;if(l-a.x<t.x-l)break;a=t;break}a=t}for(t=a.ts_next;!t.seqst;)t=t.ts_next;if(t.nl)for(error(0,t,"Line split problem - adjust maxshrink and/or breaklimit"),h=2,t=t.ts_next;t!=e&&!(t.x&&--h<=0);t=t.ts_next);if(!(t=set_nl(t))||e&&t.time>=e.time)break;f-=t.x-i.x,n=0}return t}function cut_tune(t,e){var r,n,i=tsfirst;if(e&&(t-=n=set_indent(),e-=n),t-=(n=get_ck_width())[0],e+=n[1],cfmt.custos&&1==voice_tb.length&&(t-=12),cfmt.barsperstaff)for(n=cfmt.barsperstaff,r=i;r;r=r.ts_next)r.type!=C.BAR||!r.bar_num||--n>0||(r.ts_next&&(r.ts_next.soln=!0),n=cfmt.barsperstaff);for(r=i;i;i=i.ts_next){if(i.ts_next){if(!i.soln)continue;for(i.soln=!1;!i.seqst;)i=i.ts_prev}else i=null;if(!(r=set_lines(r,i,t,e)))break;i=r,e=0}}function set_yval(t){switch(t.type){case C.CLEF:if(t.second||t.invis){t.ymx=t.ymn=12;break}switch(t.y=6*(t.clef_line-1),t.clef_type){default:t.ymx=t.y+28,t.ymn=t.y-14;break;case"c":t.ymx=t.y+13,t.ymn=t.y-11;break;case"b":t.ymx=t.y+7,t.ymn=t.y-12}t.clef_small&&(t.ymx-=2,t.ymn+=2),t.ymx<26&&(t.ymx=26),t.ymn>-1&&(t.ymn=-1),t.clef_octave&&(t.clef_octave>0?t.ymx+=12:t.ymn-=12);break;case C.KEY:t.k_sf>2?t.ymx=34:t.k_sf>0?t.ymx=30:t.ymx=26,t.ymn=-2;break;default:t.ymx=24,t.ymn=0}}function set_ottava(){var t,e,r,n,i,s,a=nstaff+1,o=new Int16Array(new Array(2*a)),c=new Int8Array(new Array(a));function l(t,e,r){deco_cnv([(r?["15mb(","8vb(",null,"8va(","15ma("]:["15mb)","8vb)",null,"8va)","15ma)"])[2+e]],t)}for(e=0;e<=nstaff;e++)o[e]=0,c[e]=0;for(t=tsfirst;t;t=t.ts_next){if(e=t.st,null!=t.ottava)for(;t.ottava.length;)(s=t.ottava.shift())?0==c[e]++&&(l(t,s,!0),o[e]=7*-s):0==--c[e]&&(l(t,-o[e]/7),o[e]=0);switch(t.type){case C.REST:if(1==voice_tb.length)break;case C.NOTE:if((r=o[e])&&!t.p_v.ckey.k_drum)for(a=t.nhd;a>=0;a--)(n=t.notes[a]).opit||(n.opit=n.pit),n.pit+=r;break;case C.GRACE:for(i=t.extra;i;i=i.next)if((r=o[e])&&!t.p_v.ckey.k_drum)for(a=0;a<=i.nhd;a++)(n=i.notes[a]).opit||(n.opit=n.pit),n.pit+=r}}}function mrest_expand(){var t,e;function r(t){var e,r,n,i,s=t.nmes,a=t.dur/s;for(t.type=C.REST,t.dur=t.dur_orig=a,t.nflags=-2,n=t.next,i=t.time+a,r=e=t;--s>0;){for(delete(e=clone(n)).sol,lkvsym(e,n),e.time=i;r&&r.time<i;)r=r.ts_next;for(lktsym(e,r),delete(e=clone(t)).a_dd,lkvsym(e,n),e.time=i;r&&r.time<i;)r=r.ts_next;lktsym(e,r),i+=a,t=e}}for(t=tsfirst;t;t=t.ts_next)if(t.type==C.MREST){for(e=t.ts_next;!e.seqst&&e.type==C.MREST;)e=e.ts_next;if(e.type!=C.MREST)for(;t.type==C.MREST;)r(t),t=e.ts_next;else for(;t.ts_next&&!t.ts_next.seqst;)t=t.ts_next}}function set_auto_clef(t,e,r){var n,i,s,a,o,c;for(s=12,i=20,n=e;n&&(n.type!=C.STAVES||n==e);n=n.ts_next)if(n.st==t)if(n.type==C.NOTE)n.notes[0].pit<i?i=n.notes[0].pit:n.notes[n.nhd].pit>s&&(s=n.notes[n.nhd].pit);else if(n.type==C.CLEF){if("a"!=n.clef_type)break;unlksym(n)}if(i>=19||i>=13&&"b"!=r)return"t";if(s<=13||s<=19&&"t"!=r)return"b";"a"==r&&(r=(s+i)/2>=16?"t":"b");var l=r,u=n,f=null;for(n=e;n!=u&&(n.type!=C.STAVES||n==e);n=n.ts_next)if(n.st==t&&n.type==C.NOTE){if(a=n.time,"t"==l){if(n.notes[0].pit>12||n.notes[n.nhd].pit>20){n.notes[0].pit>20&&(f=n);continue}if((o=n.ts_prev)&&o.time==a&&o.st==t&&o.type==C.NOTE&&o.notes[0].pit>=19)continue;if((o=n.ts_next)&&o.st==t&&o.time==a&&o.type==C.NOTE&&o.notes[0].pit>=19)continue}else{if(n.notes[0].pit<12||n.notes[n.nhd].pit<20){n.notes[n.nhd].pit<12&&(f=n);continue}if((o=n.ts_prev)&&o.time==a&&o.st==t&&o.type==C.NOTE&&o.notes[0].pit<=13)continue;if((o=n.ts_next)&&o.st==t&&o.time==a&&o.type==C.NOTE&&o.notes[0].pit<=13)continue}if(f){for(c=n,o=n.ts_prev;o!=f;o=o.ts_prev)if(o.st==t){if(o.type==C.BAR&&o.v==n.v){c=":"!=o.bar_type[0]?o:o.next;break}o.type==C.NOTE&&o.beam_st&&!o.p_v.second&&(c=o)}c.time!=f.time?(f=n,(o=insert_clef(c,l="t"==l?"b":"t","t"==l?2:4)).clef_auto=!0):f=n}else l=r="t"==l?"b":"t",f=n}return r}function set_clefs(){var t,e,r,n,i,s,a,o,c,l=new Array(nstaff+1),u=cur_sy,f=[];for(staff_tb=new Array(nstaff+1),r=0;r<=nstaff;r++)l[r]={autoclef:!0},staff_tb[r]={output:"",sc_out:""};for(n=0;n<voice_tb.length;n++)i=voice_tb[n],u.voices[n]&&(r=u.voices[n].st,u.voices[n].second||(null!=i.staffnonote&&(u.staves[r].staffnonote=i.staffnonote),i.staffscale&&(u.staves[r].staffscale=i.staffscale),u.voices[n].sep&&(u.staves[r].sep=u.voices[n].sep),u.voices[n].maxsep&&(u.staves[r].maxsep=u.voices[n].maxsep),i.clef.clef_auto||(l[r].autoclef=!1)));for(n=0;n<voice_tb.length;n++)i=voice_tb[n],u.voices[n]&&!u.voices[n].second&&(r=u.voices[n].st,t=i.clef,l[r].autoclef&&(t.clef_type=set_auto_clef(r,tsfirst,t.clef_type),t.clef_line="t"==t.clef_type?2:4),l[r].clef=staff_tb[r].clef=t);for(r=0;r<=u.nstaff;r++)f[r]=3*(u.staves[r].stafflines.length-1);for(t=tsfirst;t;t=t.ts_next){switch(t.repeat_n&&set_repeat(t),t.type){case C.STAVES:for(u=t.sy,r=0;r<=nstaff;r++)l[r].autoclef=!0;for(n=0;n<voice_tb.length;n++)u.voices[n]&&(i=voice_tb[n],r=u.voices[n].st,u.voices[n].second||(null!=i.staffnonote&&(u.staves[r].staffnonote=i.staffnonote),i.staffscale&&(u.staves[r].staffscale=i.staffscale),u.voices[n].sep&&(u.staves[r].sep=u.voices[n].sep),u.voices[n].maxsep&&(u.staves[r].maxsep=u.voices[n].maxsep)),(e=i.clef).clef_auto||(l[r].autoclef=!1));for(r=0;r<=u.nstaff;r++)f[r]=3*(u.staves[r].stafflines.length-1);for(n=0;n<voice_tb.length;n++)if(u.voices[n]&&!u.voices[n].second)if(i=voice_tb[n],r=u.voices[n].st,(e=i.clef).clef_auto?o="t"==(a=set_auto_clef(r,t,l[r].clef?l[r].clef.clef_type:"a"))?2:4:(a=e.clef_type,o=e.clef_line),l[r].clef){if(a!=l[r].clef.clef_type||o!=l[r].clef.clef_line){for(s=t.ts_prev;s&&s.time==t.time&&(s.v!=n||s.st!=r);)s=s.ts_prev;if(!s||s.time!=t.time){for(s=t.ts_next;s&&(s.v!=n||s.st!=r);)s=s.ts_next;s&&s.time==t.time||(s=t)}s.type!=C.CLEF&&(s=insert_clef(s,a,o),e.clef_auto&&(s.clef_auto=!0)),l[r].clef=i.clef=s}}else e.clef_auto&&("a"!=e.type&&(i.clef=clone(i.clef)),i.clef.clef_type=a,i.clef.clef_line=o),staff_tb[r].clef=l[r].clef=i.clef;continue;default:t.mid=f[t.st];continue;case C.CLEF:}if("a"==t.clef_type&&(t.clef_type=set_auto_clef(t.st,t.ts_next,l[t.st].clef.clef_type),t.clef_line="t"==t.clef_type?2:4),(i=t.p_v).clef=t,t.second)unlksym(t);else{if(l[r=t.st].clef){if(t.clef_type==l[r].clef.clef_type&&t.clef_line==l[r].clef.clef_line)continue}else staff_tb[r].clef=t;l[r].clef=t}}for(u=cur_sy,n=0;n<voice_tb.length;n++)if(u.voices[n]&&(e=voice_tb[n].sym)&&127==e.notes[0].pit){switch(r=u.voices[n].st,staff_tb[r].clef.clef_type){default:c=22;break;case"c":c=16;break;case"b":c=10}for(t=e;t;t=t.next)t.notes[0].pit=c}}Abc.prototype.set_width=function(t){var e,r,n,i,s,a,o,c,l,u,f,$,h,p,d;if(t.play)t.wl=t.wr=0;else{switch(t.type){case C.NOTE:case C.REST:for(t.wr=a=hw_tb[t.head],t.xmx>0&&(t.wr+=t.xmx+4),e=t.prev;e&&0==w_tb[e.type];e=e.prev);if(e)switch(e.type){case C.BAR:case C.CLEF:case C.KEY:case C.METER:a+=3}for(n=0;n<=t.nhd;n++)(i=t.notes[n].shhd)<0&&a<5-i&&(a=5-i),t.notes[n].acc&&a<(d=t.notes[n].shac+(t.notes[n].micro?5.5:3.5))&&(a=d);if(e)switch(e.type){case C.BAR:case C.CLEF:case C.KEY:case C.METER:a-=3}if(t.a_dd&&(a+=deco_width(t)),t.beam_st&&t.beam_end&&t.stem>0&&t.nflags>0&&t.wr<t.xmx+9&&(t.wr=t.xmx+9),t.dots){if(null==t.wl)switch(t.head){case C.SQUARE:case C.OVALBARS:t.xmx+=3;break;case C.OVAL:t.xmx+=1}t.wr<t.xmx+8&&(t.wr=t.xmx+8),t.dots>=2&&(t.wr+=3.5*(t.dots-1))}if(t.trem2&&t.beam_end&&a<20&&(a=20),o=a,e)switch(e.type){case C.NOTE:e.stem>0&&t.stem<0&&o<7&&(o=7),(t.y>27&&e.y>27||t.y<-3&&e.y<-3)&&o<6&&(o=6),e.tie&&o<14&&(o=14);break;case C.CLEF:if(e.second||e.clef_small)break;o+=8;break;case C.KEY:o+=4}return t.a_gch&&(o=gchord_width(t,a,o)),t.a_ly&&(o=ly_width(t,o)),void(e&&e.type==C.GRACE?t.wl=a-4.5:t.wl=o);case C.SPACE:return i=t.width/2,t.wr=i,t.a_gch&&(i=gchord_width(t,i,i)),t.a_dd&&(i+=deco_width(t)),void(t.wl=i);case C.BAR:switch(l=t.bar_type){case"|":s=5;break;default:for(s=2+2.8*l.length,r=0;r<l.length;r++)switch(l[r]){case"[":case"]":s+=3;break;case":":s+=2}}for(t.wl=s,t.next&&t.next.type!=C.METER?t.wr=7:t.wr=5,e=t.prev;e;e=e.prev)if(0!=w_tb[e.type]){e.type==C.GRACE&&(t.wl-=8);break}return t.a_dd&&(t.wl+=deco_width(t)),void(t.text&&t.text.length<4&&t.next&&t.next.a_gch&&(set_font("repeat"),t.wr+=strwh(t.text)[0]+2));case C.CLEF:return t.invis?void(t.wl=t.wr=1):(t.wl=t.clef_small?9:12,void(t.wr=t.clef_small?7:12));case C.KEY:if(!t.k_a_acc&&!t.k_sf&&!t.k_old_sf||t.k_none||t.k_play)return void(t.wl=t.wr=0);if(t.wl=3,p=4,t.k_a_acc)for($=h=t.k_a_acc.length,h&&(f=t.k_a_acc[0].acc),r=1;r<h;r++)(c=t.k_a_acc[r]).pit>t.k_a_acc[r-1].pit+6||c.pit<t.k_a_acc[r-1].pit-6?$--:c.acc!=f&&(p+=3),f=c.acc;else($=t.k_sf)*(h=t.k_old_sf&&(cfmt.cancelkey||0==$)?t.k_old_sf:0)>=0?($<0&&($=-$),h<0&&(h=-h),h>$&&($=h)):(($-=h)<0&&($=-$),p+=3);return void(t.wr=5.5*$+p);case C.METER:for(o=0,t.x_meter=[],r=0;r<t.a_meter.length;r++)switch((u=t.a_meter[r]).top[0]){case"C":case"c":case"o":t.x_meter[r]=o+6,o+=12;break;case".":case"|":t.x_meter[r]=t.x_meter[r-1];break;default:for(s=0,u=!u.bot||u.top.length>u.bot.length?u.top:u.bot,n=0;n<u.length;n++)switch(u[n]){case"(":o+=4;case")":case"1":s+=4;break;default:s+=12}t.x_meter[r]=o+s/2,o+=s}return t.wl=0,void(t.wr=o+6);case C.MREST:return t.wl=6,void(t.wr=66);case C.GRACE:if(t.invis)break;return t.wl=set_graceoffs(t),t.wr=0,void(t.a_ly&&ly_width(t,o));case C.STBRK:return t.wl=t.xmx,void(t.next&&t.next.type==C.CLEF?(t.wr=2,delete t.next.clef_small):t.wr=8);case C.CUSTOS:return void(t.wl=t.wr=4);case C.TEMPO:tempo_build(t);break;case C.BLOCK:case C.PART:case C.REMARK:case C.STAVES:break;default:error(2,t,"set_width - Cannot set width for symbol $1",t.type)}t.wl=t.wr=0}};var delta_tb={t:-4,c:0,b:4,p:-6},rest_sp=[[18,18],[12,18],[12,12],[0,12],[6,8],[10,10],[6,4],[10,0],[10,4],[10,10]];function set_rest_offset(){var t,e,r,n,i,s,a,o,c,l,u,f=[],$=cur_sy;for(t=tsfirst;t;t=t.ts_next)if(!t.invis&&(t.type==C.STAVES&&($=t.sy),t.dur&&((s=f[t.v])||(s={},f[t.v]=s),s.s=t,s.st=t.st,s.end_time=t.time+t.dur,t.type==C.REST))){for(o=-127,a=127,i=l=!1,r=0;r<=f.length;r++)(s=f[r])&&s.s&&s.st==t.st&&r!=t.v&&(s.end_time<=t.time||(i=!0,e=s.s,$.voices[r].range<$.voices[t.v].range?e.time==t.time?e.ymn<a&&(a=e.ymn,e.dots&&(l=!0)):e.y<a&&(a=e.y):e.time==t.time?e.ymx>o&&(o=e.ymx,e.dots&&(l=!0)):e.y>o&&(o=e.y)));for(n=t.time+t.dur,e=t.ts_next;e&&!(e.time>=n);e=e.ts_next)e.st==t.st&&e.dur&&!e.invis&&(i=!0,$.voices[e.v].range<$.voices[t.v].range?e.time==t.time?e.ymn<a&&(a=e.ymn,e.dots&&(l=!0)):e.y<a&&(a=e.y):e.time==t.time?e.ymx>o&&(o=e.ymx,e.dots&&(l=!0)):e.y>o&&(o=e.y));if(i)if(127==a&&t.y<12&&(c=12-t.y,t.y+=c,t.ymx+=c,t.ymn+=c),-127==o&&t.y>12&&(c=t.y-12,t.y-=c,t.ymx-=c,t.ymn-=c),(c=a-t.ymx)<0){if(c=6*Math.ceil(-c/6),t.ymn-c>=o){t.y-=c,t.ymx-=c,t.ymn-=c;continue}u=l?15:10,t.notes[0].shhd=u,t.xmx=u}else if((c=o-t.ymn)>0){if(c=6*Math.ceil(c/6),t.ymx+c<=a){t.y+=c,t.ymx+=c,t.ymn+=c;continue}u=l?15:10,t.notes[0].shhd=u,t.xmx=u}else;else t.y=12,t.ymx=24,t.ymn=0}}function new_sym(t,e,r){t.p_v=e,t.v=e.v,t.st=e.st,t.time=r.time,e.last_sym&&(t.next=e.last_sym.next,t.next&&(t.next.prev=t),e.last_sym.next=t,t.prev=e.last_sym),e.last_sym=t,lktsym(t,r)}function init_music_line(){var t,e,r,n,i,s,a,o,c,l,u=voice_tb.length;for(i=0;i<u;i++)if(cur_sy.voices[i]){for((t=voice_tb[i]).second=cur_sy.voices[i].second,t.last_sym=t.sym,s=cur_sy.voices[i].st;s<nstaff&&!cur_sy.st_print[s];)s++;t.st=s,t.second||(staff_tb[s].key=t.ckey,staff_tb[s].meter=t.meter)}for(e=tsfirst;e;){switch(e.type){case C.CLEF:case C.KEY:case C.METER:switch(e.type){case C.CLEF:staff_tb[e.st].clef=e;break;case C.KEY:e.p_v.ckey=e;break;case C.METER:e.p_v.meter=e,insert_meter|=1}unlksym(e);case C.PART:case C.TEMPO:case C.BLOCK:case C.REMARK:e=e.ts_next;continue}break}for(n=tsfirst,i=0;i<u;i++)t=voice_tb[i],!cur_sy.voices[i]||cur_sy.voices[i].second&&!t.bar_start||(s=cur_sy.voices[i].st,staff_tb[s]&&staff_tb[s].clef&&((e=clone(staff_tb[s].clef)).v=i,e.p_v=t,e.st=s,e.time=tsfirst.time,e.prev=null,e.next=t.sym,e.next&&(e.next.prev=e),t.sym=t.last_sym=e,e.ts_next=n,e.ts_prev=n?n.ts_prev:null,e.ts_prev?(e.ts_prev.ts_next=e,delete e.seqst):tsfirst=e,n&&(n.ts_prev=e,n.type==C.CLEF&&delete n.seqst),delete e.clef_small,e.second=cur_sy.voices[i].second,cur_sy.st_print[s]||(e.invis=!0)));for(i=0;i<u;i++)cur_sy.voices[i]&&!cur_sy.voices[i].second&&cur_sy.st_print[cur_sy.voices[i].st]&&((r=(t=voice_tb[i]).ckey).k_sf||r.k_a_acc)&&(new_sym(e=clone(r),t,n),delete e.invis,e.k_old_sf=r.k_sf);if(1&insert_meter){for(i=0;i<u;i++)r=(t=voice_tb[i]).meter,cur_sy.voices[i]&&!cur_sy.voices[i].second&&cur_sy.st_print[cur_sy.voices[i].st]&&r.a_meter.length&&new_sym(e=clone(r),t,n);insert_meter&=-2}for(i=0;i<u;i++)(t=voice_tb[i]).sls.length&&(new_sym(e={type:C.BAR,fname:n.fname,bar_type:"|",dur:0,multi:0,invis:!0,sls:t.sls},t,n),t.sls=[]);for(i=0;i<u;i++)r=(t=voice_tb[i]).bar_start,t.bar_start=null,n&&n.v==i&&n.type==C.BAR?(t.last_sym=n,n=n.ts_next):r&&cur_sy.voices[i]&&cur_sy.st_print[cur_sy.voices[i].st]&&new_sym(r,t,n);for(self.set_pitch(n),(e=tsfirst).seqst=!0,l=0;;){r=e,c=o=0;do{self.set_width(e),(a=e.wl+l)>o&&(o=a),e.wr>c&&(c=e.wr),e=e.ts_next}while(e!=n&&!e.seqst);if(r.shrink=o,r.space=0,e==n)break;l=c}a=0;do{self.set_width(e),a<e.wl&&(a=e.wl),e=e.ts_next}while(e&&!e.seqst);n.shrink=c+a,n.space=0}function set_words(t){var e,r,n,i,s,a=!0,o=127;for(e=t.sym;e;e=e.next)if(e.type==C.NOTE){o=e.notes[0].pit;break}for(e=t.sym;e;e=e.next){switch(e.type){case C.MREST:a=!0;break;case C.BAR:e.bar_type=bar_cnv(e.bar_type),e.beam_on||(a=!0),!e.next&&e.prev&&e.prev.head==C.OVALBARS&&(e.prev.head=C.SQUARE);break;case C.GRACE:for(r=e.extra;r;r=r.next)r.notes.sort(abc2svg.pitcmp);break;case C.NOTE:case C.REST:if(s=identify_note(e,e.dur_orig),e.head=s[0],e.dots=s[1],e.nflags=s[2],e.nflags<=-2&&(e.stemless=!0),e.xstem&&(e.nflags=0),e.trem1&&(e.nflags>0?e.nflags+=e.ntrem:e.nflags=e.ntrem),e.next&&e.next.trem2)break;if(e.trem2){e.prev.trem2=!0,e.prev.nflags=--e.nflags,e.prev.head=++e.head,e.nflags>0?e.nflags+=e.ntrem:(e.nflags<=-2&&(e.stemless=!0,e.prev.stemless=!0),e.nflags=e.ntrem),e.prev.nflags=e.nflags;break}n=e.nflags,e.ntrem&&(n+=e.ntrem),e.type==C.REST&&e.beam_end&&(e.beam_end=!1,a=!0),(a||n<=0)&&(i&&(i.beam_end=!0,i=null),n<=0?(e.beam_st=!0,e.beam_end=!0):e.type==C.NOTE&&(e.beam_st=!0,a=!1)),e.beam_end&&(a=!0),e.type==C.NOTE&&(i=e)}if(e.type==C.NOTE)for(e.nhd&&e.notes.sort(abc2svg.pitcmp),o=e.notes[0].pit,r=e.prev;r&&r.type==C.REST;r=r.prev)r.notes[0].pit=o;else e.notes||(e.notes=[],e.notes[0]={},e.nhd=0),e.notes[0].pit=o}i&&(i.beam_end=!0)}function set_rb(t){for(var e,r,n=t.sym;n;)if(n.type==C.BAR&&n.rbstart&&!n.norepbra){for(r=0,e=null,n=n.next;n;n=n.next)if(n.type==C.BAR){if(r++,n.rbstop)break;if(!n.next){n.rbstop=2;break}if(r==cfmt.rbmin&&(e=n),r==cfmt.rbmax){e&&(n=e),n.rbstop=1;break}}}else n=n.next}Abc.prototype.set_pitch=function(t){var e,r,n,i,s,a=C.BLEN,o=nstaff+1,c=new Int16Array(new Array(2*o));for(n=0;n<=nstaff;n++)e=staff_tb[n].clef,c[n]=delta_tb[e.clef_type]+2*e.clef_line,e.clefpit&&(c[n]+=e.clefpit),cfmt.sound?e.clef_octave&&!e.clef_oct_transp&&(c[n]+=e.clef_octave):e.clef_oct_transp&&(c[n]-=e.clef_octave);for(e=tsfirst;e!=t;e=e.ts_next)switch(n=e.st,e.type){case C.CLEF:c[n]=delta_tb[e.clef_type]+2*e.clef_line,e.clefpit&&(c[n]+=e.clefpit),cfmt.sound?e.clef_octave&&!e.clef_oct_transp&&(c[n]+=e.clef_octave):e.clef_oct_transp&&(c[n]-=e.clef_octave),set_yval(e);break;case C.GRACE:for(r=e.extra;r;r=r.next){if((i=c[r.st])&&!e.p_v.ckey.k_drum)for(o=0;o<=r.nhd;o++)(s=r.notes[o]).opit=s.pit,s.pit+=i;r.ymn=3*(r.notes[0].pit-18)-2,r.ymx=3*(r.notes[r.nhd].pit-18)+2}set_yval(e);break;case C.KEY:e.k_y_clef=c[n];default:set_yval(e);break;case C.MREST:if(e.invis)break;e.y=12,e.ymx=39,e.ymn=-2;break;case C.REST:if(1==voice_tb.length){e.y=12,e.ymx=24,e.ymn=0;break}case C.NOTE:if((i=c[n])&&!e.p_v.ckey.k_drum)for(o=e.nhd;o>=0;o--)(s=e.notes[o]).opit=s.pit,s.pit+=i;e.type==C.NOTE?(e.ymx=3*(e.notes[e.nhd].pit-18)+4,e.ymn=3*(e.notes[0].pit-18)-4):(e.y=6*((e.notes[0].pit-18)/2|0),e.ymx=e.y+rest_sp[5-e.nflags][0],e.ymn=e.y-rest_sp[5-e.nflags][1]),e.dur<a&&(a=e.dur)}t||(smallest_duration=a)},Abc.prototype.set_stem_dir=function(){for(var t,e,r,n,i,s,a,o,c,l,u=[],f=tsfirst,$=cur_sy,h=$.nstaff;f;){for(n=0;n<=h;n++)u[n]=[];for(l=[],e=f;e&&e.type!=C.BAR;e=e.ts_next)if(e.type!=C.STAVES){if(!(e.type!=C.NOTE&&e.type!=C.REST||e.invis)){if((n=e.st)>h){var p="*** fatal set_stem_dir(): bad staff number "+n+" max "+h;throw error(2,null,p),new Error(p)}for((a=l[s=e.v])||(a={st1:-1,st2:-1},l[s]=a),a.st1<0?a.st1=n:a.st1!=n&&(n>a.st1?n>a.st2&&(a.st2=n):(a.st1>a.st2&&(a.st2=a.st1),a.st1=n)),o=u[n],i=$.voices[s].range,r=o.length;--r>=0&&(c=o[r]).v!=i;);if(r<0){for(c={v:i,ymx:0,ymn:24},r=0;r<o.length;r++)if(i<o[r].v){o.splice(r,0,c);break}r==o.length&&o.push(c)}e.type==C.NOTE&&(e.ymx>c.ymx&&(c.ymx=e.ymx),e.ymn<c.ymn&&(c.ymn=e.ymn),e.xstem&&(e.ts_prev.st!=n-1||e.ts_prev.type!=C.NOTE?(error(1,f,"Bad !xstem!"),e.xstem=!1):(e.ts_prev.multi=1,e.multi=1,e.stemless=!0)))}}else{if(e!=f)break;for($=f.sy,n=h;n<=$.nstaff;n++)u[n]=[];h=$.nstaff}for(;f!=e;f=f.ts_next)if(!f.multi){switch(f.type){default:continue;case C.REST:if(null!=f.combine&&f.combine<0||!f.ts_next||f.ts_next.type!=C.REST||f.ts_next.st!=f.st||f.time!=f.ts_next.time||f.dur!=f.ts_next.dur||f.a_dd&&f.ts_next.a_dd||f.a_gch&&f.ts_next.a_gch||f.invis)break;f.ts_next.a_dd&&(f.a_dd=f.ts_next.a_dd),f.ts_next.a_gch&&(f.a_gch=f.ts_next.a_gch),unlksym(f.ts_next);break;case C.NOTE:case C.GRACE:}if(n=f.st,a=l[s=f.v],o=u[n],a&&a.st2>=0)n==a.st1?f.multi=-1:n==a.st2&&(f.multi=1);else if(o.length<=1)f.floating&&(f.multi=n==voice_tb[s].st?-1:1);else{for(i=$.voices[s].range,r=o.length;--r>=0&&o[r].v!=i;);r<0||(r==o.length-1?f.multi=-1:(f.multi=1,0!=r&&r+2==o.length&&(o[r].ymn-cfmt.stemheight>o[r+1].ymx&&(f.multi=-1),t=f.ts_next,f.ts_prev&&f.ts_prev.time==f.time&&f.ts_prev.st==f.st&&f.notes[f.nhd].pit==f.ts_prev.notes[0].pit&&f.beam_st&&f.beam_end&&(!t||t.st!=f.st||t.time!=f.time)&&(f.multi=-1))))}}for(;f&&f.type==C.BAR;)f=f.ts_next}};var delpit=[0,-7,-14,0];function set_global(){var t,e,r,n,i;for(e=(i=cur_sy).nstaff;i=i.next;)i.nstaff>e&&(e=i.nstaff);for(nstaff=e,n=voice_tb.length,r=0;r<n;r++)set_words(t=voice_tb[r]),t.ckey=t.key,set_rb(t);set_float(),glovar.ottava&&"play"!=cfmt.sound&&set_ottava(),1!=n&&glovar.mrest_p&&mrest_expand(),set_clefs(),self.set_pitch(null)}function set_indent(t){var e,r,n,i,s,a,o,c,l=voice_tb.length,u=0;for(r=0;r<l;r++)if(i=voice_tb[r],cur_sy.voices[r]&&(e=cur_sy.voices[r].st,s=(t||i.new_name)&&i.nm?i.nm:i.snm))for(c||(set_font("voice"),c=gene.curfont),a=0;o=s.indexOf("\\n",a),(n=(n=strwh(o<0?s.slice(a):s.slice(a,o)))[0])>u&&(u=n),!(o<0);)a=o+1;for(c&&(u+=4*cwidf(" ")),n=.5,e=0;e<=cur_sy.nstaff;e++){if(cur_sy.staves[e].flags&(OPEN_BRACE2|OPEN_BRACKET2)){n=12;break}cur_sy.staves[e].flags&(OPEN_BRACE|OPEN_BRACKET)&&(n=6)}return u+=n,t&&(u+=cfmt.indent),u}function set_beams(t){var e,r,n,i,s,a,o,c,l,u=-1;for(e=t;e;e=e.next)if(e.type==C.NOTE){if(e.stem||0!=(e.stem=e.multi))e.beam_st&&!e.beam_end&&(n=!0);else if(o=e.mid/3+18,n)e.stem=u;else if(e.beam_st&&!e.beam_end){for(n=!0,s=c=0,r=e;r;r=r.next)if(r.type==C.NOTE){if(r.stem||r.multi){e.stem=r.stem||r.multi;break}for(s+=r.nhd+1,a=0;a<=r.nhd;a++)r.notes[a].pit>=o&&c++;if(r.beam_end)break}if(!e.stem)if((c*=2)>s)e.stem=-1;else if(c<s)e.stem=1;else{for(c=e.notes[e.nhd].pit,l=e.notes[0].pit,r=e.next;r&&(r.type!=C.NOTE||(r.notes[r.nhd].pit>c&&(c=r.notes[r.nhd].pit),r.notes[0].pit<l&&(l=r.notes[0].pit),!r.beam_end));r=r.next);r.beam_end&&(c+l<2*o?e.stem=1:c+l>2*o?e.stem=-1:cfmt.bstemdown&&(e.stem=-1))}e.stem||(e.stem=u)}else{if((s=(e.notes[e.nhd].pit+e.notes[0].pit)/2)==o){for(a=0;a<=e.nhd&&!(e.notes[a].pit>=o);a++);s=2*a<e.nhd?o-1:o+1}s<o?e.stem=1:s>o?e.stem=-1:cfmt.bstemdown?e.stem=-1:e.stem=u}if(e.beam_end&&(n=!1),u=e.stem,i){for(r=i.extra;r;r=r.next)r.stem=-u;i.stem=-u,i=null}}else{if(e.type!=C.GRACE)continue;if(2==(r=e.extra).stem){i=e;continue}for(e.stem||0!=(e.stem=e.multi)||(e.stem=1);r;r=r.next)r.stem=e.stem,r.multi=e.multi}}function same_head(t,e){var r,n,i,s,a,o,c,l,u,f,$;if(t.shiftunison&&t.shiftunison>=3)return!1;if((i=t.dur)>=C.BLEN)return!1;if((s=e.dur)>=C.BLEN)return!1;if(t.stemless&&e.stemless)return!1;if(t.dots!=e.dots&&(t.shiftunison&&1&t.shiftunison||t.dots*e.dots!=0))return!1;if(t.stem*e.stem>0)return!1;if(r=n=0,t.notes[0].pit>e.notes[0].pit){if(t.stem<0)return!1;for(;e.notes[n].pit!=t.notes[0].pit;)if(++n>e.nhd)return!1}else if(t.notes[0].pit<e.notes[0].pit){if(e.stem<0)return!1;for(;e.notes[0].pit!=t.notes[r].pit;)if(++r>t.nhd)return!1}if(e.notes[n].acc!=t.notes[r].acc)return!1;o=r,l=n,f=t.notes[r].shhd,$=e.notes[n].shhd;do{if(n++,++r>t.nhd)break;if(n>e.nhd)break;if(e.notes[n].acc!=t.notes[r].acc)return!1;f<t.notes[r].shhd&&(f=t.notes[r].shhd),$<e.notes[n].shhd&&($=e.notes[n].shhd)}while(e.notes[n].pit==t.notes[r].pit);if(r<=t.nhd){if(n<=e.nhd)return!1;if(e.stem>0)return!1}else if(n<=e.nhd&&t.stem>0)return!1;if(c=r,u=n,a=0,i!=s)if(i<s&&(i=s,s=t.dur),i<C.BLEN/2)e.dots?a=2:t.dots&&(a=1);else{if(!(s<C.BLEN/4))return!1;if(t.shiftunison&&2&t.shiftunison)return!1;a=e.dur>=C.BLEN/2?2:1}if(a||(a=t.p_v.scale<e.p_v.scale?2:1),1==a){for(n=l;n<u;n++)e.notes[n].invis=!0,delete e.notes[n].acc;for(n=0;n<=e.nhd;n++)e.notes[n].shhd+=f}else{for(r=o;r<c;r++)t.notes[r].invis=!0,delete t.notes[r].acc;for(r=0;r<=t.nhd;r++)t.notes[r].shhd+=$}return!0}function unison_acc(t,e,r,n){var i,s;if(e.notes[n].acc){for(s=2*w_note[t.head]+t.xmx+e.notes[n].shac+2,e.notes[n].micro&&(s+=2),t.dots&&(s+=6),i=0;i<=e.nhd;i++)e.notes[i].shhd+=s,e.notes[i].shac-=s;e.xmx+=s}else{for(s=2*w_note[e.head]+e.xmx+t.notes[r].shac+2,t.notes[r].micro&&(s+=2),e.dots&&(s+=6),i=0;i<=t.nhd;i++)t.notes[i].shhd+=s,t.notes[i].shac-=s;t.xmx+=s}}var MAXPIT=96;function set_left(t){var e,r,n,i,s=w_note[t.head],a=s,o=[];for(r=0;r<MAXPIT;r++)o.push(-100);if(t.nflags>-2)for(t.stem>0?(a=-a,r=2*t.notes[0].pit,n=2*(Math.ceil((t.ymx-2)/3)+18)):(r=2*(Math.ceil((t.ymn+2)/3)+18),n=2*t.notes[t.nhd].pit),r<0&&(r=0),n>=MAXPIT&&(n=MAXPIT-1);r<=n;)o[r++]=a;for(i=t.notes[t.stem>0?0:t.nhd].shhd,e=0;e<=t.nhd;e++)a=-t.notes[e].shhd+s+i,(r=2*t.notes[e].pit)<0?r=0:r>=MAXPIT-1&&(r=MAXPIT-2),a>o[r]&&(o[r]=a),t.head!=C.SQUARE&&(a-=1),a>o[r-1]&&(o[r-1]=a),a>o[r+1]&&(o[r+1]=a);return o}function set_right(t){var e,r,n,i,s,a=w_note[t.head],o=a,c=t.nflags>0&&t.beam_st&&t.beam_end,l=[];for(r=0;r<MAXPIT;r++)l.push(-100);if(t.nflags>-2)for(t.stem<0?(o=-o,r=2*(Math.ceil((t.ymn+2)/3)+18),n=2*t.notes[t.nhd].pit,i=r+4):(r=2*t.notes[0].pit,n=2*(Math.ceil((t.ymx-2)/3)+18)),r<0&&(r=0),n>MAXPIT&&(n=MAXPIT);r<n;)l[r++]=o;if(c)if(t.stem>0)for(r=0==t.xmx?2*t.notes[t.nhd].pit:2*t.notes[0].pit,(r+=4)<0&&(r=0);r<MAXPIT&&r<=n-4;r++)l[r]=11;else for((r=i)<0&&(r=0);r<MAXPIT&&r<=2*t.notes[0].pit-4;r++)l[r]=3.5;for(s=t.notes[t.stem>0?0:t.nhd].shhd,e=0;e<=t.nhd;e++)o=t.notes[e].shhd+a-s,(r=2*t.notes[e].pit)<0?r=0:r>=MAXPIT-1&&(r=MAXPIT-2),o>l[r]&&(l[r]=o),t.head!=C.SQUARE&&(o-=1),o>l[r-1]&&(l[r-1]=o),o>l[r+1]&&(l[r+1]=o);return l}function set_overlap(){var t,e,r,n,i,s,a,o,c,l,u,f,$,h,p,d,_,m,y,g,v,b,A,x=cur_sy;function w(){e=r,r=t,f=$,b=_,A=m,p=h}for(t=tsfirst;t;t=t.ts_next)if(t.type!=C.NOTE||t.invis)t.type==C.STAVES&&(x=t.sy);else{if(t.xstem&&t.ts_prev.stem<0)for(o=0;o<=t.nhd;o++)t.notes[o].shhd-=7,t.notes[o].shac+=16;for(r=t;r=r.ts_next;){if(r.time!=t.time){r=null;break}if(r.type==C.NOTE&&!r.invis&&r.st==t.st)break}if(r&&(e=t,x.voices[e.v].range<x.voices[r.v].range?r.dot_low=!0:e.dot_low=!0,!(e.ymn>r.ymx||e.ymx<r.ymn||same_head(e,r))))if(e.dots||r.dots||!(e.stem>0&&r.stem<0&&e.notes[0].pit==r.notes[r.nhd].pit+1||e.stem<0&&r.stem>0&&e.notes[e.nhd].pit+1==r.notes[0].pit)){if(m=set_right(e),y=set_left(r),(n=e.ts_prev)&&n.time==e.time&&n.st==e.st&&n.type==C.NOTE&&!n.invis)for(v=set_right(n),i=0;i<MAXPIT;i++)v[i]>m[i]&&(m[i]=v[i]);else n=null;for(f=-10,i=0;i<MAXPIT;i++)y[i]+m[i]>f&&(f=y[i]+m[i]);if(!(f<-3&&(!e.dots||!r.dots||!r.dot_low||e.stem>0||r.stem<0||e.notes[e.nhd].pit+2!=r.notes[0].pit||1&r.notes[0].pit))){if(g=set_right(r),_=set_left(e),n)for(v=set_left(n),i=0;i<MAXPIT;i++)v[i]>_[i]&&(_[i]=v[i]);for($=h=p=-100,i=0;i<MAXPIT;i++)_[i]+g[i]>$&&($=_[i]+g[i]),g[i]>p&&(p=g[i]),m[i]>h&&(h=m[i]);for(l=0,s=e.nhd,a=r.nhd;;){switch(u=e.notes[s].pit-r.notes[a].pit){case 0:if(e.notes[s].acc!=r.notes[a].acc&&!e.notes[s].acc&&!r.notes[a].acc){l=-1;break}r.notes[a].acc&&(e.notes[s].acc||(e.notes[s].acc=r.notes[a].acc),r.notes[a].acc=0),e.dots&&r.dots&&1&e.notes[s].pit&&(l=1);break;case-1:e.dots&&r.dots&&(1&e.notes[s].pit?(e.dot_low=!1,r.dot_low=!1):(e.dot_low=!0,r.dot_low=!0));break;case-2:if(e.dots&&r.dots&&!(1&e.notes[s].pit)){e.dot_low=!1,r.dot_low=!1;break}}if(l<0)break;if(u>=0&&--s<0)break;if(u<=0&&--a<0)break}if(l<0)unison_acc(e,r,s,a);else{if(c=0,e.dots?r.dots?l||(c=1):w():r.dots&&$+h<f+p&&(c=1),b=y,A=g,!n&&$+h<f+p&&w(),(f+=3)<0&&(f=0),o=e.stem>=0?0:e.nhd,f+=e.notes[o].shhd,o=r.stem>=0?0:r.nhd,f-=r.notes[o].shhd,e.dots)if(d=7.7+e.xmx+3.5*e.dots-3.5+3,c){if(d<f+p+r.xmx){for($=0,s=0;s<=e.nhd;s++)1&(i=e.notes[s].pit)||(e.dot_low?i--:i++),(i*=2)<1?i=1:i>=MAXPIT-1&&(i=MAXPIT-2),A[i]>$&&($=A[i]),A[i-1]+1>$&&($=A[i-1]=1),A[i+1]+1>$&&($=A[i+1]+1);$>4.5&&7.7+e.xmx+2<f+$+r.xmx&&(r.xmx=$+3-7.7)}}else{for($=-100,s=0;s<=e.nhd;s++)1&(i=e.notes[s].pit)||(e.dot_low?i--:i++),(i*=2)<1?i=1:i>=MAXPIT-1&&(i=MAXPIT-2),b[i]>$&&($=b[i]),b[i-1]+1>$&&($=b[i-1]+1),b[i+1]+1>$&&($=b[i+1]+1);d+$+2>f&&(f=d+$+2)}for(o=r.nhd;o>=0;o--)r.notes[o].shhd+=f;r.xmx+=f,c&&(e.xmx=r.xmx)}}}else{for(e.stem<0&&(e=r,r=t),f=e.notes[0].shhd+7,o=0;o<=r.nhd;o++)r.notes[o].shhd+=f;r.xmx+=f,e.xmx=r.xmx}}}function check_bar(t){var e,r,n,i,s=t.p_v;if(t.type!=C.BAR||!t.invis||(t=t.prev)){for(;t.type==C.CLEF||t.type==C.KEY||t.type==C.METER;)if(!(t=t.prev))return;if(t.type==C.BAR&&":"!=(e=t.bar_type)&&(":"==e.slice(-1)||null!=t.text)){for(i=s.s_next;!w_tb[i.type];)if(!(i=i.next))return;if(i.type==C.BAR)n=i;else{for((n=clone(t)).next=i,n.prev=i.prev,i==s.s_next?s.s_next=n:i.prev.next=n,i.prev=n;!i.seqst||i.time>n.time;)i=i.ts_prev;n.ts_next=i,n.ts_prev=i.ts_prev,i==tsnext?tsnext=n:i.ts_prev.ts_next=n,delete n.seqst,n!=tsnext&&i.ts_prev.type==C.BAR||(i.seqst?n.seqst=!0:(i.seqst=!0,i.shrink=n.wr+i.wl,i.space=0)),i.ts_prev=n}if(null!=t.text)return n.bar_type="",n.text=t.text,n.a_gch=t.a_gch,delete t.text,delete t.a_gch,!0;if(":"!=e[0])return"||:"==e?(n.bar_type="[|:",t.bar_type="||",!0):(n.bar_type=e,void(t.prev&&t.prev.type==C.BAR?unlksym(t):t.bar_type="|"));for(r=0;":"==e[r];)r++;if(r<e.length){for(t.bar_type=e.slice(0,r)+"|]",r=e.length-1;":"==e[r];)r--;n.bar_type="[|"+e.slice(r+1)}else r=e.length/2|0,t.bar_type=e.slice(0,r)+"|]",n.bar_type="[|"+e.slice(r);return!0}}}function sym_staff_move(t){for(var e=tsfirst;e&&!e.nl;e=e.ts_next)e.st==t&&e.type!=C.CLEF&&(e.st++,e.invis=!0)}Abc.prototype.set_stems=function(){var t,e,r,n,i,s,a,o,c,l,u;for(t=tsfirst;t;t=t.ts_next)if(t.type==C.NOTE){if(set_head_shift(t),o=t.nflags,t.beam_st&&!t.beam_end){for(t.feathered_beam&&(o=++t.nflags),e=t.next;e.type!=C.NOTE||(t.feathered_beam&&e.nflags++,!e.beam_end);e=e.next);e.nflags>o&&(o=e.nflags)}else if(!t.beam_st&&t.beam_end){for(e=t.prev;!e.beam_st;e=e.prev);e.nflags>o&&(o=e.nflags)}switch(n=cfmt.stemheight,o){case 2:n+=0;break;case 3:n+=4;break;case 4:n+=8;break;case 5:n+=12}1!=(i=t.p_v.scale)&&(n*=.5*(i+1)),s=3*(t.notes[0].pit-18),t.nhd>0?(n-=2,a=3*(t.notes[t.nhd].pit-18)):a=s,t.ntrem&&(n+=2*t.ntrem),t.stemless?(t.stem>=0?(t.y=s,t.ys=a):(t.ys=s,t.y=a),-4==o&&(s-=6),t.ymx=a+4,t.ymn=s-4):t.stem>=0?(t.notes[t.nhd].pit>26&&(o<=0||!t.beam_st||!t.beam_end)&&(n-=2,t.notes[t.nhd].pit>28&&(n-=2)),t.y=s,t.notes[0].tie&&(s-=3),t.ymn=s-4,t.ys=a+n,t.ys<t.mid&&(t.ys=t.mid),t.ymx=t.ys+2.5|0):(t.notes[0].pit<18&&(o<=0||!t.beam_st||!t.beam_end)&&(n-=2,t.notes[0].pit<16&&(n-=2)),t.ys=s-n,t.ys>t.mid&&(t.ys=t.mid),t.ymn=t.ys-2.5|0,t.y=a,t.notes[t.nhd].tie&&(a+=3),t.ymx=a+4)}else{if(t.type!=C.GRACE)continue;for(c=l=t.mid,r=t.extra;r;r=r.next)u=identify_note(t,r.dur),r.head=u[0],r.dots=u[1],r.nflags=u[2],n=GSTEM,r.nflags>1&&(n+=1.2*(r.nflags-1)),s=3*(r.notes[0].pit-18),a=3*(r.notes[r.nhd].pit-18),t.stem>=0?(r.y=s,r.ys=a+n,a=Math.round(r.ys)):(r.y=a,r.ys=s-n,s=Math.round(r.ys)),a+=2,(s-=2)<c?c=s:a>l&&(l=a),r.ymx=a,r.ymn=s;t.ymx=l,t.ymn=c}};var blocks=[];function block_gen(t){switch(t.subtype){case"leftmargin":case"rightmargin":case"pagescale":case"pagewidth":case"scale":case"staffwidth":blk_flush(),self.set_format(t.subtype,t.param);break;case"mc_start":multicol={posy:posy,maxy:posy,lmarg:cfmt.leftmargin,rmarg:cfmt.rightmargin};break;case"mc_new":if(!multicol){error(1,t,"%%multicol new without start");break}posy>multicol.maxy&&(multicol.maxy=posy),cfmt.leftmargin=multicol.lmarg,cfmt.rightmargin=multicol.rmarg,img.chg=!0,set_page(),posy=multicol.posy;break;case"mc_end":if(!multicol){error(1,t,"%%multicol new without start");break}posy<multicol.maxy&&(posy=multicol.maxy),cfmt.leftmargin=multicol.lmarg,cfmt.rightmargin=multicol.rmarg,multicol=void 0,blk_flush(),img.chg=!0,set_page();break;case"ml":blk_flush(),user.img_out(t.text);break;case"newpage":svg_flush(),blkdiv<0&&user.img_out("</div>"),blkdiv=2;break;case"sep":set_page(),vskip(t.sk1),output+='<path class="stroke"\n\td="M',out_sxsy((img.width-t.l)/2-img.lm," ",0),output+="h"+t.l.toFixed(1)+'"/>\n',vskip(t.sk2);break;case"text":write_text(t.text,t.opt);break;case"title":write_title(t.text,!0);break;case"vskip":vskip(t.sk)}}function set_piece(){var t,e,r,n,i,s,a=[],o=[],c=cur_sy;function l(t){var e=staff_tb[t],r=c.staves[t];e||(e=staff_tb[t]={}),e.y=0,e.stafflines=r.stafflines,e.staffscale=r.staffscale,e.ann_top=e.ann_bot=0}function u(){var t,e,r,n=c.staves.length;for(t=0;t<n;t++)if(c.staves[t].flags&(OPEN_BRACE|OPEN_BRACE2)){for(r=0,e=t;t<n&&(r|=a[t]?1:2,!(c.staves[t].flags&(CLOSE_BRACE|CLOSE_BRACE2)));)t++;if(3==r)for(;e<=t;)a[e]=!0,o[e++]=!0}}for(tsfirst.type==C.STAVES&&(t=tsfirst,(tsfirst=tsfirst.ts_next).ts_prev=null,t.seqst&&(tsfirst.seqst=!0),t.p_v.sym=t.next,t.next&&(t.next.prev=null)),nstaff=c.nstaff,r=0;r<=nstaff;r++)l(r);for(t=tsfirst;t&&!t.nl;t=t.ts_next){switch(t.type){case C.STAVES:for(u(),c.st_print=new Uint8Array(a),c=t.sy;nstaff<c.nstaff;)l(++nstaff);a=[];continue;case C.BLOCK:t.play||(blocks.push(t),unlksym(t));continue}if((r=t.st)>nstaff){switch(t.type){case C.CLEF:staff_tb[r].clef=t;break;case C.KEY:t.p_v.ckey=t;break;case C.METER:t.p_v.meter=t}unlksym(t)}else if(!a[r]){switch(t.type){default:continue;case C.BAR:if(t.bar_mrep||c.staves[r].staffnonote>1)break;continue;case C.GRACE:break;case C.NOTE:case C.REST:case C.SPACE:case C.MREST:if(c.staves[r].staffnonote>1)break;if(t.invis)continue;if(0!=c.staves[r].staffnonote||t.type==C.NOTE)break;continue}o[r]=a[r]=!0}}for(tsnext=t,u(),c.st_print=new Uint8Array(a),function(){var t,e,r,n,i;for(t=0;t<=nstaff;t++)if(e=staff_tb[t],o[t]){for(i=e.stafflines.length,e.topbar=6*(i-1),r=0;r<i-1;r++){switch(e.stafflines[r]){case".":case"-":continue}break}if(e.botline=e.botbar=6*r,r>=i-2){if("."==e.stafflines[r]){e.botbar-=12,e.topbar+=12;continue}e.botbar-=6,e.topbar+=6}for(e.hll=17+r,e.hlmap=new Int8Array(new Array(2*(i-r+1))),n=1;r<i;r++,n+=2)switch(e.stafflines[r]){case"|":case"[":e.hlmap[n-1]=1,e.hlmap[n]=1,e.hlmap[n+1]=1}e.hlu=[],e.hld=[]}else e.botbar=e.topbar=0}(),r=0;r<nstaff;r++)o[r]||sym_staff_move(r);if(o[nstaff]||(staff_tb[nstaff].topbar=0),init_music_line(),gene.st_print=new Uint8Array(o),tsnext)for(delete(t=tsnext).nl,t.ts_prev.ts_next=null,i=voice_tb.length,n=0;n<i;n++){if((e=voice_tb[n]).sym&&e.sym.time<=tsnext.time){for(t=tsnext.ts_prev;t;t=t.ts_prev)if(t.v==n){e.s_next=t.next,t.next=null,check_bar(t)&&(s=t.wl,self.set_width(t),t.shrink+=t.wl-s);break}if(t)continue}e.s_next=e.sym,e.sym=null}}function set_sym_line(){for(var t,e,r=voice_tb.length;--r>=0;)(t=voice_tb[r]).sym&&t.s_prev&&(t.sym.prev=t.s_prev),e=t.s_next,t.sym=e,e?(e.prev&&(e.prev.next=e),t.s_prev=e.prev,e.prev=null):t.s_prev=null}function set_posx(){posx=img.lm/cfmt.scale}function gen_init(){for(var t=tsfirst,e=t.time;t;t=t.ts_next){if(t.time!=e)return void set_page();switch(t.type){case C.NOTE:case C.REST:case C.MREST:case C.SPACE:return void set_page();default:continue;case C.STAVES:cur_sy=t.sy;continue;case C.BLOCK:if(t.play)continue;block_gen(t)}unlksym(t),t.p_v.s_next==t&&(t.p_v.s_next=t.next)}tsfirst=null}function reset_gen(){insert_meter=cfmt.writefields.indexOf("M")>=0?3:2}Abc.prototype.set_sym_glue=function(t){var e,r,n,i,s,a=0,o=0,c=0,l=0,u=0;for(e=tsfirst;e;e=e.ts_next)e.type!=C.GRACE||i||(i=e),e.seqst&&(a+=e.shrink,e.space?e.space<e.shrink?(u+=e.shrink,o+=e.shrink):o+=e.space:l+=e.shrink);if(o){if(n=!tsnext||tsnext.type==C.BLOCK&&!tsnext.play||blocks.length,a>=t){for(a>t&&error(1,e,"Line too much shrunk $1 $2 $3",a.toFixed(1),o.toFixed(1),t.toFixed(1)),c=0,e=tsfirst;e;e=e.ts_next)e.seqst&&(c+=e.shrink),e.x=c;spf_last=0}else if(n&&o+l>t*(1-cfmt.stretchlast)||!n&&(o+l>t||cfmt.stretchstaff)){o==u&&(o+=5);for(var f=4;--f>=0;){for(s=(t-l-u)/(o-u),o=0,u=0,c=0,e=tsfirst;e;e=e.ts_next)e.seqst&&(e.space?e.space*s<=e.shrink?(u+=e.shrink,o+=e.shrink,c+=e.shrink):(o+=e.space,c+=e.space*s):c+=e.shrink),e.x=c;if(Math.abs(c-t)<.1)break}spf_last=s}else for(spf_last<(s=(t-l-u)/o)&&(s=spf_last),e=tsfirst;e;e=e.ts_next)e.seqst&&(c+=e.space*s<=e.shrink?e.shrink:e.space*s),e.x=c;for(realwidth=c,e=i;e;e=e.ts_next)if(e.type==C.GRACE)for(c=e.gr_shift?e.prev.x+e.prev.wr:e.x-e.wl,r=e.extra;r;r=r.next)r.x+=c}else realwidth=0},Abc.prototype.output_music=function(){var t,e,r,n,i,s,a;if(gen_init(),tsfirst){for(set_global(),voice_tb.length>1&&self.set_stem_dir(),t=0;t<voice_tb.length;t++)set_beams(voice_tb[t].sym);for(self.set_stems(),voice_tb.length>1&&(set_rest_offset(),set_overlap()),set_acc_shft(),set_allsymwidth(),r=set_indent(!0),cfmt.singleline?(e=r+(t=get_ck_width())[0]+t[1]+get_width(tsfirst,null)[0],img.width=e*cfmt.scale+img.lm+img.rm+2):cut_tune(e=get_lwidth(),r),i=tsfirst,t=voice_tb.length;--t>=0;)voice_tb[t].osym=voice_tb[t].sym;for(spf_last=1.2;;){if(set_piece(),self.set_sym_glue(e-r),realwidth)for(r&&(posx+=r),draw_sym_near(),n=set_staff(),draw_systems(r),draw_all_sym(),delayed_update(),vskip(n),r&&(posx-=r,insert_meter&=-3);blocks.length;)block_gen(blocks.shift());if(blk_flush(),s&&(s.ts_next.ts_prev=s),!tsnext)break;if(tsnext.ts_prev.ts_next=tsfirst=tsnext,gen_init(),!tsfirst)break;s=tsfirst.ts_prev,tsfirst.ts_prev=null,set_sym_line(),e=get_lwidth(),r=set_indent()}for(tsfirst=i,t=voice_tb.length;--t>=0;)(a=voice_tb[t]).sym&&a.s_prev&&(a.sym.prev=a.s_prev),a.sym=a.osym}};var a_gch,a_dcn,multicol,maps={},qplet_tb=new Int8Array([0,1,3,2,3,0,2,0,3,0]),ntb="CDEFGABcdefgab";function set_ref(t){t.fname=parse.fname,t.istart=parse.istart,t.iend=parse.iend}function new_clef(t){var e={type:C.CLEF,clef_line:2,clef_type:"t",v:curvoice.v,p_v:curvoice,time:curvoice.time,dur:0},r=1;switch(set_ref(e),t[0]){case'"':r=t.indexOf('"',1),e.clef_name=t.slice(1,r),r++;break;case"a":if("u"==t[1]){e.clef_type="a",e.clef_auto=!0,r=4;break}r=4;case"C":e.clef_type="c",e.clef_line=3;break;case"b":r=4;case"F":e.clef_type="b",e.clef_line=4;break;case"n":r=4,e.invis=!0;break;case"t":if("e"==t[1]){e.clef_type="c",e.clef_line=4;break}r=6;case"G":break;case"p":r=4;case"P":e.clef_type="p",e.clef_line=3,curvoice.key.k_sf=0,curvoice.ckey.k_sf=0,curvoice.ckey.k_map=abc2svg.keys[7],curvoice.ckey.k_b40=2,curvoice.ckey.k_drum=!0;break;default:return void syntax(1,"Unknown clef '$1'",t)}if(t[r]>="1"&&t[r]<="9"&&(e.clef_line=Number(t[r]),r++),"8"!=t[r+1])return e;switch(t[r]){case"^":e.clef_oct_transp=!0;case"+":e.clef_octave=7;break;case"_":e.clef_oct_transp=!0;case"-":e.clef_octave=-7}return e}function get_interval(t,e){var r,n,i,s;for((n=new scanBuf).buffer=t,s=[],r=0;r<2;r++)if(i=n.buffer[n.index]?parse_acc_pit(n):null)s[r]=abc2svg.pab40(i.pit,i.acc);else{if(1!=r||!e)return void syntax(1,errs.bad_transp);s[r]=242}return s[1]-s[0]}function set_linebreak(t){var e,r;for(e=0;e<128;e++)"\n"==char_tb[e]&&(char_tb[e]=nil);for(t=t.split(/\s+/),e=0;e<t.length;e++){switch(r=t[e]){case"!":case"$":case"*":case";":case"?":case"@":break;case"<none>":continue;case"<EOL>":r="\n";break;default:syntax(1,"Bad value '$1' in %%linebreak - ignored",r);continue}char_tb[r.charCodeAt(0)]="\n"}}function set_user(t){var e,r,n,i=t.match(/(.)[= ]*(\[I:.+\]|".+"|!.+!)$/);if(i)if(r=i[1],n=i[2],"\\"==r[0]&&("t"==r[1]?r="\t":r[1]||(r=" ")),(e=r.charCodeAt(0))>=128)syntax(1,errs.not_ascii);else{switch(char_tb[e][0]){case"0":case"d":case"i":case" ":break;case'"':case"!":case"[":if(char_tb[e].length>1)break;default:return void syntax(1,"Bad user character '$1'",r)}switch(n){case"!beambreak!":n=" ";break;case"!ignore!":n="i";break;case"!nil!":case"!none!":n="d"}char_tb[e]=n}else syntax(1,'Lack of starting [, ! or " in U: / %%user')}function get_st_lines(t){if(t){if(/^[\]\[|.-]+$/.test(t))return t.replace(/\]/g,"[");var e=parseInt(t);switch(e){case 0:return"...";case 1:return"..|";case 2:return".||";case 3:return".|||"}if(!(isNaN(e)||e<0||e>16))return"||||||||||||||||".slice(0,e)}}function new_block(t){var e={type:C.BLOCK,subtype:t,dur:0};return 2==parse.state&&goto_tune(),"midi"!=t.slice(0,4)&&(curvoice=voice_tb[0]),sym_link(e),e}function set_kv_parm(t){curvoice.init||(curvoice.init=!0,info.V&&(info.V["*"]&&(t=info.V["*"].concat(t)),info.V[curvoice.id]&&(t=info.V[curvoice.id].concat(t)))),t.length&&self.set_vp(t)}function memo_kv_parm(t,e){e.length&&(info.V||(info.V={}),info.V[t]?Array.prototype.push.apply(info.V[t],e):info.V[t]=e)}function new_key(t){var e,r,n,i,s,a="FCGDAEB".indexOf(t[0])-1,o=0,c={type:C.KEY,dur:0};if(set_ref(c),e=1,a<-1)switch(t[0]){case"H":switch(t[1]){case"P":case"p":c.k_bagpipe=t[1],a="P"==t[1]?0:2,e++;break;default:syntax(1,"Unknown bagpipe-like key"),r=!0}break;case"P":syntax(1,"K:P is deprecated"),a=0,c.k_drum=!0,r=!0;break;case"n":if(0==t.indexOf("none")){a=0,c.k_none=!0,e=4;break}default:return c.k_map=[],c.k_mode=0,[c,info_split(t)]}if(!r){switch(t[e]){case"#":a+=7,e++;break;case"b":a-=7,e++}switch((t=t.slice(e).trim()).slice(0,3).toLowerCase()){default:if("m"!=t[0]||" "!=t[1]&&"\t"!=t[1]&&"\n"!=t[1]){r=!0;break}case"aeo":case"m":case"min":a-=3,o=5;break;case"dor":a-=2,o=1;break;case"ion":case"maj":break;case"loc":a-=5,o=6;break;case"lyd":a+=1,o=3;break;case"mix":a-=1,o=4;break;case"phr":a-=4,o=2}if(r||(t=t.replace(/\w+\s*/,"")),0==t.indexOf("exp ")&&((t=t.replace(/\w+\s*/,""))||syntax(1,"No accidental after 'exp'"),s=!0),"^"==(n=t[0])||"_"==n||"="==n){c.k_a_acc=[],(i=new scanBuf).buffer=t;do{var l=parse_acc_pit(i);if(!l)break;for(c.k_a_acc.push(l),n=t[i.index];" "==n;)n=t[++i.index]}while("^"==n||"_"==n||"="==n);s||function(t,e){var r,n,i,s,a,o=[],c=[],l=[],u=[];if(e>0)for(s=0;s<e;s++)o[s]=1,c[s]=[26,23,27,24,21,25,22][s];else for(s=0;s<-e;s++)o[s]=-1,c[s]=[22,25,21,24,20,23,26][s];for(i=t.k_a_acc.length,r=0;r<i;r++){for(a=t.k_a_acc[r],n=0;n<s;n++)if(c[n]==a.pit){o[n]=a.acc,a.micro_n&&(l[n]=a.micro_n,u[n]=a.micro_d);break}n==s&&(o[n]=a.acc,c[n]=a.pit,a.micro_n&&(l[n]=a.micro_n,u[n]=a.micro_d),s++)}for(r=0;r<s;r++)(a=t.k_a_acc[r])||(a=t.k_a_acc[r]={}),a.acc=o[r],a.pit=c[r],l[r]?(a.micro_n=l[r],a.micro_d=u[r]):(delete a.micro_n,delete a.micro_d)}(c,a),t=t.slice(i.index)}else s&&0==t.indexOf("none")&&(a=0,t=t.replace(/\w+\s*/,""))}if(c.k_sf=a,c.k_a_acc)for(c.k_map=[],e=c.k_a_acc.length;--e>=0;)l=c.k_a_acc[e],c.k_map[(l.pit+19)%7]=l.acc;else c.k_map=abc2svg.keys[a+7];return c.k_mode=o,c.k_b40=[1,24,7,30,13,36,19,2,25,8,31,14,37,20,3][a+7],[c,info_split(t)]}function new_meter(t){var e,r,n,i,s,a,o={type:C.METER,dur:0,a_meter:[]},c={},l=0,u=0;if(set_ref(o),0==t.indexOf("none"))u=4,s=1;else for(s=0;u<t.length&&"="!=t[u];){switch(t[u]){case"C":c.top=t[u++],l||(l=4,n=4);break;case"c":case"o":if(c.top=t[u++],!l)switch("c"==t[u-1]?(l=2,n=4):(l=3,n=4),t[u]){case"|":n/=2;break;case".":l*=3,n*=2}break;case".":case"|":l=0,c.top=t[u++];break;case"(":for("("==t[u+1]&&(a=!0,c.top=t[u++],o.a_meter.push(c),c={}),i=u+1;i<t.length&&")"!=t[i]&&"/"!=t[i];)i++;if(")"==t[i]&&"/"==t[i+1]){u++;continue}case")":a="("==t[u],c.top=t[u++],o.a_meter.push(c),c={};continue;default:if(t[u]<="0"||t[u]>"9")return void syntax(1,"Bad char '$1' in M:",t[u]);for(n=2,c.top=t[u++];;){for(;t[u]>="0"&&t[u]<="9";)c.top+=t[u++];if(")"==t[u]){if("/"!=t[u+1])break;u++}if("/"==t[u]){if(t[++u]<="0"||t[u]>"9")return void syntax(1,"Bad char '$1' in M:",t[u]);for(c.bot=t[u++];t[u]>="0"&&t[u]<="9";)c.bot+=t[u++];break}if(" "!=t[u]&&"+"!=t[u])break;if(u>=t.length||"("==t[u+1])break;c.top+=t[u++]}l=parseInt(c.top)}for(a||(c.bot&&(n=parseInt(c.bot)),s+=l*C.BLEN/n),o.a_meter.push(c),c={};" "==t[u];)u++;"+"==t[u]&&(c.top=t[u++],o.a_meter.push(c),c={})}if("="==t[u]){if(!(e=t.substring(++u).match(/^(\d+)\/(\d+)$/)))return void syntax(1,"Bad duration '$1' in M:",t.substring(u));s=C.BLEN*e[1]/e[2]}if(o.wmeasure=s,cfmt.writefields.indexOf("M")<0&&(o.a_meter=[]),3!=parse.state){if(info.M=t,glovar.meter=o,parse.state>=1)for(glovar.ulen||(s<=1||s>=3*C.BLEN/4?glovar.ulen=C.BLEN/8:glovar.ulen=C.BLEN/16),r=0;r<voice_tb.length;r++)voice_tb[r].meter=o,voice_tb[r].wmeasure=s}else curvoice.wmeasure=s,is_voice_sig()?(curvoice.meter=o,reset_gen()):sym_link(o)}function new_tempo(t){var e,r,n,i,s=t,a={type:C.TEMPO,dur:0};function o(t){var e,n,i=t.match(/(\d+)\/(\d+)/);if(i&&(n=Number(i[2]))&&!isNaN(n)&&!(n&n-1)&&(e=Number(i[1]),!isNaN(e)))return C.BLEN*e/n;syntax(1,"Invalid note duration $1",r)}if(set_ref(a),cfmt.writefields.indexOf("Q")<0&&(a.invis=!0),'"'==t[0]){if(!(r=t.match(/"([^"]*)"/)))return void syntax(1,"Unterminated string in Q:");a.tempo_str1=r[1],t=t.slice(r[0].length).replace(/^\s+/,"")}if('"'==t.slice(-1)&&(e=t.indexOf('"'),a.tempo_str2=t.slice(e+1,-1),t=t.slice(0,e).replace(/\s+$/,"")),(e=t.indexOf("="))>0){for(n=t.slice(0,e).split(/\s+/),t=t.slice(e+1).replace(/^\s+/,"");r=n.shift();){if(!(i=o(r)))return;a.tempo_notes||(a.tempo_notes=[]),a.tempo_notes.push(i)}if("ca. "==t.slice(0,4)&&(a.tempo_ca="ca. ",t=t.slice(4)),(e=t.indexOf("/"))>0){if(!(i=o(t)))return;a.new_beat=i}else if(a.tempo=Number(t),!a.tempo||isNaN(a.tempo))return void syntax(1,"Bad tempo value")}if(3!=parse.state){if(1==parse.state)return info.Q=s,void(glovar.tempo=a);goto_tune()}sym_link(a),glovar.tempo&&0==curvoice.time&&(glovar.tempo.invis=!0)}function do_info(t,e){var r,n,i,s;switch(t){case"I":self.do_pscom(e);break;case"L":if(2==parse.state&&goto_tune(),s=e.match(/^1\/(\d+)(=(\d+)\/(\d+))?$/)){if(!(n=Number(s[1]))||0!=(n&n-1))break;if(n=C.BLEN/n,s[2]){if(!(i=Number(s[4]))||0!=(i&i-1)){i=0;break}i=Number(s[3])/i*C.BLEN}else i=n}else"auto"==e&&(n=i=-1);if(!i){syntax(1,"Bad L: value");break}parse.state<2?glovar.ulen=n:(curvoice.ulen=n,curvoice.dur_fact=i/n);break;case"M":new_meter(e);break;case"U":set_user(e);break;case"P":if(0==parse.state)break;if(1==parse.state){info.P=e;break}2==parse.state&&goto_tune(),r={type:C.PART,text:e,dur:0},cfmt.writefields.indexOf(t)<0&&(r.invis=!0),sym_link(r);break;case"Q":if(0==parse.state)break;new_tempo(e);break;case"V":get_voice(e),3==parse.state&&(curvoice.ignore=!par_sy.voices[curvoice.v]);break;case"K":if(!parse.state)break;get_key(e);break;case"N":case"R":info[t]?info[t]+="\n"+e:info[t]=e;break;case"r":if(!user.keep_remark||3!=parse.state)break;sym_link(r={type:C.REMARK,text:e,dur:0});break;default:syntax(0,"'$1:' line ignored",t)}}function adjust_dur(t){var e,r,n,i,s;if((e=curvoice.last_sym)&&e.type!=C.MREST&&e.type!=C.BAR){for(;e.type!=C.BAR&&e.prev;)e=e.prev;if(r=e.time,n=curvoice.time-r,s=curvoice.wmeasure/n,0==r){for(;e&&!e.dur;)e=e.next;e&&e.type==C.REST&&e.invis&&(r+=e.dur*s,e.prev?e.prev.next=e.next:curvoice.sym=e.next,e.next&&(e.next.prev=e.prev),e=e.next)}if(curvoice.wmeasure!=n){for(;e;e=e.next)if(e.time=r,e.dur&&!e.grace&&(e.dur*=s,e.dur_orig*=s,r+=e.dur,e.type==C.NOTE||e.type==C.REST))for(i=0;i<=e.nhd;i++)e.notes[i].dur*=s;curvoice.time=t.time=r}}}function new_bar(t){var e,r,n,i=parse.line,s={type:C.BAR,fname:parse.fname,istart:parse.bol+i.index,dur:0,multi:0};for(t&&(s.bar_dotted=!0),vover&&vover.bar&&get_vover("|"),glovar.new_nbar&&(s.bar_num=glovar.new_nbar,glovar.new_nbar=0),n=i.char();;){switch(r=i.next_char()){case"|":case"[":case"]":case":":n+=r;continue}break}switch(":"==n[0]&&(1==n.length?(n="|",s.bar_dotted=!0):(s.rbstop=2,curvoice.tie_s&&(curvoice.tie_s.tie_s=s))),a_gch&&self.gch_build(s),a_dcn&&(deco_cnv(a_dcn,s),a_dcn=null),parse.ottava.length&&(e=s,curvoice.cst!=curvoice.st&&sym_link(e={type:C.SPACE,fname:parse.fname,istart:parse.bol+i.index,dur:0,multi:0,invis:!0,width:1}),e.ottava=parse.ottava,parse.ottava=[]),n.slice(-1)){case"[":if(/[0-9" ]/.test(r))break;n=n.slice(0,-1),i.index--,r="[";break;case":":s.rbstop=2}if(r>"0"&&r<="9"){for(s.text=r;r=i.next_char(),!("0123456789,.-".indexOf(r)<0);)s.text+=r;s.rbstop=2,s.rbstart=2}else if('"'==r&&"["==n.slice(-1)){for(s.text="";;){if(!(r=i.next_char()))return void syntax(1,"No end of repeat string");if('"'==r){i.index++;break}s.text+=r}s.rbstop=2,s.rbstart=2}if("]"==n[0]&&(s.rbstop=2,1!=n.length?n=n.slice(1):s.invis=!0),s.iend=parse.bol+i.index,s.rbstart&&curvoice.norepbra&&!curvoice.second&&(s.norepbra=!0),s.text)if("["==n.slice(-1)&&"["!=n&&(n=n.slice(0,-1)),"1"==s.text[0])curvoice.tie_s&&(curvoice.tie_s_rep=curvoice.tie_s),curvoice.acc_tie?curvoice.acc_tie_rep=curvoice.acc_tie.slice():curvoice.acc_tie_rep&&(curvoice.acc_tie_rep=null);else{if(curvoice.tie_s_rep){curvoice.tie_s=clone(curvoice.tie_s_rep),curvoice.tie_s.notes=clone(curvoice.tie_s.notes);for(var a=0;a<=curvoice.tie_s.nhd;a++)curvoice.tie_s.notes[a]=clone(curvoice.tie_s.notes[a]),curvoice.tie_s.notes[a].s=curvoice.tie_s}curvoice.acc_tie_rep&&(curvoice.acc_tie=curvoice.acc_tie_rep.slice())}if(curvoice.ulen<0&&adjust_dur(s),(e=curvoice.last_sym)&&e.time==curvoice.time&&("["==n||"|:"==n)){do{if(e.type==C.BAR)break;if(w_tb[e.type])break;e=e.prev}while(e);if(e&&e.type==C.BAR){if("["==n&&!e.text&&(0==curvoice.st||par_sy.staves[curvoice.st-1].flags&STOP_BAR||s.norepbra))return s.text&&(e.text=s.text),s.a_gch&&(e.a_gch=s.a_gch),s.norepbra&&(e.norepbra=s.norepbra),s.rbstart&&(e.rbstart=s.rbstart),void(s.rbstop&&(e.rbstop=s.rbstop));if(e.st==curvoice.st&&"|:"==n){if(":|"==e.bar_type)return e.bar_type="::",void(e.rbstop=2);if("||"==e.bar_type)return e.bar_type="||:",void(e.rbstop=2)}}}switch(n){case"[":s.rbstop=2;case"[]":case"[|]":s.invis=!0,n="[]";break;case":|:":case":||:":n="::";break;case"||":if(!cfmt.rbdbstop)break;case"[|":case"|]":s.rbstop=2}s.bar_type=n,curvoice.lyric_restart||(curvoice.lyric_restart=s),curvoice.sym_restart||(curvoice.sym_restart=s),sym_link(s),s.st=curvoice.st,s.rbstart&&!curvoice.norepbra&&curvoice.st>0&&!(par_sy.staves[curvoice.st-1].flags&STOP_BAR)&&(sym_link(e={type:C.BAR,fname:s.fname,istart:s.istart,iend:s.iend,bar_type:"[",multi:0,invis:!0,text:s.text,rbstart:2}),e.st=curvoice.st,delete s.text,s.rbstart=0),s.bar_dotted||s.invis||(curvoice.acc=[])}function parse_staves(t){var e,r,n=[],i=!1,s=0,a=0,o=0,c=0,l=0,u=t.match(/[^[\]|{}()*+\s]+|[^\s]/g);if(u){for(;r=u.shift();)switch(r){case"[":if(c||a+o>=2){syntax(1,errs.misplaced,"["),i=!0;break}s|=a+o==0?OPEN_BRACKET:OPEN_BRACKET2,o++,l<<=8,l|=OPEN_BRACKET;break;case"{":if(c||a||o>=2){syntax(1,errs.misplaced,"{"),i=!0;break}s|=o?OPEN_BRACE2:OPEN_BRACE,a++,l<<=8,l|=OPEN_BRACE;break;case"(":if(c){syntax(1,errs.misplaced,"("),i=!0;break}s|=OPEN_PARENTH,c++,l<<=8,l|=OPEN_PARENTH;break;case"*":!a||c||s&(OPEN_BRACE|OPEN_BRACE2)||(s|=FL_VOICE);break;case"+":s|=MASTER_VOICE;break;case"]":case"}":case")":syntax(1,"Bad voice ID in %%score"),i=!0;break;default:for(e=r;r=u.shift();){switch(r){case"]":if(!(l&OPEN_BRACKET)){syntax(1,errs.misplaced,"]"),i=!0;break}s|=a+--o==0?CLOSE_BRACKET:CLOSE_BRACKET2,l>>=8;continue;case"}":if(!(l&OPEN_BRACE)){syntax(1,errs.misplaced,"}"),i=!0;break}a--,s|=o?CLOSE_BRACE2:CLOSE_BRACE,s&=~FL_VOICE,l>>=8;continue;case")":if(!(l&OPEN_PARENTH)){syntax(1,errs.misplaced,")"),i=!0;break}c--,s|=CLOSE_PARENTH,l>>=8;continue;case"|":s|=STOP_BAR;continue}break}if(n.push([e,s]),s=0,!r)break;u.unshift(r)}if(0!=l&&(syntax(1,"'}', ')' or ']' missing in %%score"),i=!0),!i&&n.length)return n}else syntax(1,errs.bad_val,"%%score")}function info_split(t){if(!t)return[];var e=t.match(/=?[^\s"=]+=?|".+?"/g);return e||(syntax(1,"Unterminated string"),[])}Abc.prototype.set_vp=function(t){for(var e,r,n,i,s;r=t.shift();){if("="==r.slice(-1)&&!t.length){syntax(1,errs.bad_val,r);break}switch(r){case"clef=":e=t.shift();break;case"clefpitch=":if((r=t.shift())&&(i=ntb.indexOf(r[0]))>=0){switch(r[1]){case"'":i+=7;break;case",":i-=7,","==r[2]&&(i-=7)}s=4-i;break}syntax(1,errs.bad_val,r);break;case"octave=":case"uscale=":i=parseInt(t.shift()),isNaN(i)?syntax(1,errs.bad_val,r):curvoice[r.slice(0,-1)]=i;break;case"cue=":curvoice.scale="on"==t.shift()?.7:1;break;case"instrument=":(i=(r=t.shift()).indexOf("/"))<0?(i=0,curvoice.sndtran=get_interval("c"+r)):(curvoice.sndtran=get_interval("c"+r.slice(i+1)),i=get_interval(r.replace("/",""))),curvoice.transp=cfmt.sound?curvoice.sndtran:i;break;case"map=":curvoice.map=t.shift();break;case"name=":case"nm=":curvoice.nm=t.shift(),'"'==curvoice.nm[0]&&(curvoice.nm=curvoice.nm.slice(1,-1)),curvoice.new_name=!0;break;case"stem=":case"pos=":if(r="pos="==r?t.shift().split(" "):["stm",t.shift()],null==(i=posval[r[1]])){syntax(1,errs.bad_val,r[0]);break}n||(n={}),n[r[0]]=i;break;case"scale=":i=parseFloat(t.shift()),isNaN(i)||i<.6||i>1.5?syntax(1,errs.bad_val,"%%voicescale"):curvoice.scale=i;break;case"score=":if(r=t.shift(),cfmt.sound)break;curvoice.transp=get_interval(r,!0);break;case"shift=":curvoice.shift=curvoice.sndsh=get_interval(t.shift());break;case"sound=":curvoice.sndtran=get_interval(t.shift()),cfmt.sound&&(curvoice.transp=curvoice.sndtran);break;case"subname=":case"sname=":case"snm=":curvoice.snm=t.shift(),'"'==curvoice.snm[0]&&(curvoice.snm=curvoice.snm.slice(1,-1));break;case"stafflines=":null==(i=get_st_lines(t.shift()))?syntax(1,"Bad %%stafflines value"):null!=curvoice.st?par_sy.staves[curvoice.st].stafflines=i:curvoice.stafflines=i;break;case"staffnonote=":i=parseInt(t.shift()),isNaN(i)?syntax(1,"Bad %%staffnonote value"):curvoice.staffnonote=i;break;case"staffscale=":i=parseFloat(t.shift()),isNaN(i)||i<.3||i>2?syntax(1,"Bad %%staffscale value"):curvoice.staffscale=i;break;case"transpose=":null==(i=get_transp(t.shift()))?syntax(1,errs.bad_transp):(curvoice.sndtran=i,cfmt.sound&&(curvoice.transp=i));break;default:switch(r.slice(0,4)){case"treb":case"bass":case"alto":case"teno":case"perc":e=r;break;default:"GFC".indexOf(r[0])>=0?e=r:"="==r.slice(-1)&&t.shift()}}}if(n)for(r in curvoice.pos=clone(curvoice.pos),n)n.hasOwnProperty(r)&&(curvoice.pos[r]=n[r]);e&&(e=new_clef(e))&&(s&&(e.clefpit=s),get_clef(e))};var reg_dur=/(\d*)(\/*)(\d*)/g;function parse_dur(t){var e,r,n;return reg_dur.lastIndex=t.index,(e=reg_dur.exec(t.buffer))[0]?(r=e[1]||1,n=e[3]||1,e[3]||(n*=1<<e[2].length),t.index=reg_dur.lastIndex,[r,n]):[1,1]}function parse_acc_pit(t){var e,r,n,i,s,a,o=t.char();switch(o){case"^":"^"==(o=t.next_char())?(r=2,o=t.next_char()):r=1;break;case"=":r=3,o=t.next_char();break;case"_":"_"==(o=t.next_char())?(r=-2,o=t.next_char()):r=-1}if((r&&3!=r&&o>="1"&&o<="9"||"/"==o)&&(n=(a=parse_dur(t))[0],1==(i=a[1])?i=curvoice?curvoice.uscale:1:i*=2,o=t.char()),s=ntb.indexOf(o)+16,o=t.next_char(),!(s<16)){for(;"'"==o;)s+=7,o=t.next_char();for(;","==o;)s-=7,o=t.next_char();return e={pit:s,shhd:0,shac:0},r&&(e.acc=r,n&&(e.micro_n=n,e.micro_d=i)),e}syntax(1,"'$1' is not a note",t.buffer[t.index-1])}function set_map(t){var e=maps[curvoice.map],r=t.b40,n=r.toString();(e[n]||e[n="o"+(r%40).toString()]||(r+=2-curvoice.ckey.k_b40,e[n="k"+abc2svg.b40_p[r%40].toString()]||e[n="all"]))&&(t.map=e[n],t.map[1]&&(t.pit=t.map[1].pit,t.acc=t.map[1].acc),t.map[2]&&(t.color=t.map[2]),(n=t.map[3])&&(t.b40=n))}function parse_basic_note(t,e){var r,n=parse_acc_pit(t);if(n)return"0"==t.char()&&(parse.stemless=!0,t.index++),r=parse_dur(t),n.dur=e*r[0]/r[1],n}function parse_vpos(){var t=parse.line,e=0;switch("."!=t.buffer[t.index-1]||a_dcn||(e=C.SL_DOTTED),t.next_char()){case"'":return t.index++,e+C.SL_ABOVE;case",":return t.index++,e+C.SL_BELOW}return e+C.SL_AUTO}function slur_add(t,e){var r,n,i,s,a;for(r=curvoice.sls.length;--r>=0;)if(s=(i=curvoice.sls[r]).note,a=i.is_note,delete i.is_note,s.s!=t.s)return i.note=t,e&&(i.is_note=e),(n=a?s:s.s).sls||(n.sls=[]),n.sls.push(i),curvoice.sls.splice(r,1),a&&(s.s.sl1=!0),i.grace&&(i.grace.sl1=!0),void(t.s.grace&&(t.s.sl2=!0));if(t.grace)error(1,t.s,errs.bad_slur_end);else{for(n=t.s.prev;n;n=n.prev)if(n.type==C.BAR&&":"==n.bar_type[0]&&n.text)return n.sls||(n.sls=[]),n.sls.push({note:t,ty:C.SL_AUTO}),void(e&&(n.sls[n.sls.length-1].is_note=e));syntax(1,"End of slur without start")}}function tp_adj(t,e){var r=t.time;for(curvoice.time=r+(curvoice.time-r)*e;;){if(t.in_tuplet=!0,t.grace||(t.time=r,t.dur&&(t.dur=Math.round(t.dur*e),r+=t.dur)),!t.next){t.tpe?t.tpe++:t.tpe=1;break}t=t.next}}Abc.prototype.new_note=function(t,e){var r,n,i,s,a,o,c,l,u,f,$,h,p,d,_=[],m=parse.line,y=a_dcn;switch(!t&&curvoice.tie_s&&(c=curvoice.tie_s,curvoice.tie_s=null),a_dcn=null,parse.stemless=!1,(n={type:C.NOTE,fname:parse.fname,stem:0,multi:0,nhd:0,xmx:0}).istart=parse.bol+m.index,curvoice.color&&(n.color=curvoice.color),t?n.grace=!0:(a_gch&&self.gch_build(n),parse.repeat_n&&(n.repeat_n=parse.repeat_n,n.repeat_k=parse.repeat_k,parse.repeat_n=0)),s=m.char()){case"X":n.invis=!0;case"Z":if(n.type=C.MREST,s=m.next_char(),n.nmes=s>"0"&&s<="9"?m.get_int():1,n.dur=curvoice.wmeasure*n.nmes,curvoice.second)return void(curvoice.time+=n.dur);1==n.nmes?(n.type=C.REST,n.dur_orig=n.dur,n.notes=[{pit:18,dur:n.dur}]):glovar.mrest_p=!0;break;case"y":n.type=C.SPACE,n.invis=!0,n.dur=0,s=m.next_char(),n.width=s>="0"&&s<="9"?m.get_int():10,c&&(curvoice.tie_s=c);break;case"x":n.invis=!0;case"z":n.type=C.REST,m.index++,h=parse_dur(m),n.dur_orig=(curvoice.ulen<0?C.BLEN:curvoice.ulen)*h[0]/h[1],n.dur=n.dur_orig*curvoice.dur_fact,n.notes=[{pit:18,dur:n.dur_orig}];break;case"[":i=!0,s=m.next_char();default:for(curvoice.acc_tie&&(l=curvoice.acc_tie,curvoice.acc_tie=null),curvoice.uscale&&(n.uscale=curvoice.uscale),n.notes=[];;){if(i)for(;s;){if((u=s.charCodeAt(0))>=128)return void syntax(1,errs.not_ascii);switch((o=char_tb[u])[0]){case"(":_.push(parse_vpos()),s=m.char();continue;case"!":if(a_dcn||(a_dcn=[]),o.length>1)a_dcn.push(o.slice(1,-1));else{for(a="";;){if(!(s=m.next_char()))return void syntax(1,"No end of decoration");if("!"==s)break;a+=s}a_dcn.push(a)}s=m.next_char();continue}break}if(!(r=parse_basic_note(m,n.grace?C.BLEN/4:curvoice.ulen<0?C.BLEN:curvoice.ulen)))return;if(curvoice.octave&&(r.pit+=7*curvoice.octave),d=r.pit+19,(u=r.acc)?curvoice.acc[d]=u:(!(u=curvoice.acc[d])&&l&&(u=l[d]),u||(u=curvoice.ckey.k_map[d%7]||0)),r.b40=abc2svg.pab40(r.pit,u),curvoice.map&&maps[curvoice.map]&&set_map(r),_.length){for(;u=_.shift();)curvoice.sls.push({is_note:!0,note:r,ty:u});r.s=n}if(a_dcn&&(r.a_dcn=a_dcn,a_dcn=null),n.notes.push(r),!i)break;for(s=m.char();;){switch(s){case")":r.s=n,slur_add(r,!0),s=m.next_char();continue;case"-":r.tie_ty=parse_vpos(),r.s=n,curvoice.tie_s=n,(curvoice.acc[d]||l&&l[d])&&(curvoice.acc_tie||(curvoice.acc_tie=[]),curvoice.acc_tie[d]=curvoice.acc[d]||l[d]),s=m.char();continue;case".":switch(s=m.next_char()){case"-":case"(":continue}syntax(1,"Misplaced dot")}break}if("]"==s){for(m.index++,h=parse_dur(m),n.nhd=n.notes.length-1,u=0;u<=n.nhd;u++)(r=n.notes[u]).dur=r.dur*h[0]/h[1];break}}if(e.length)for(;u=e.shift();)n.notes[0].s=n,curvoice.sls.push({note:n.notes[0],ty:u}),t&&(curvoice.sls[curvoice.sls.length-1].grace=t);n.dur_orig=n.notes[0].dur,n.dur=n.notes[0].dur*curvoice.dur_fact}if(!n.grace||n.type==C.NOTE){if(n.notes){if(t){var g=curvoice.ckey.k_bagpipe?8:4;for(u=0;u<=n.nhd;u++)n.notes[u].dur/=g;n.dur/=g,n.dur_orig/=g,t.stem&&(n.stem=t.stem)}else{switch(curvoice.pos.stm){case C.SL_ABOVE:n.stem=1;break;case C.SL_BELOW:n.stem=-1;break;case C.SL_HIDDEN:n.stemless=!0}if(p=curvoice.brk_rhythm){if(curvoice.brk_rhythm=0,$=curvoice.last_note,p>0){for(f=2*p-1,n.dur=n.dur*f/p,n.dur_orig=n.dur_orig*f/p,u=0;u<=n.nhd;u++)n.notes[u].dur=n.notes[u].dur*f/p;for($.dur/=p,$.dur_orig/=p,u=0;u<=$.nhd;u++)$.notes[u].dur/=p}else{for(f=2*(p=-p)-1,n.dur/=p,n.dur_orig/=p,u=0;u<=n.nhd;u++)n.notes[u].dur/=p;for($.dur=$.dur*f/p,$.dur_orig=$.dur_orig*f/p,u=0;u<=$.nhd;u++)$.notes[u].dur=$.notes[u].dur*f/p}for(curvoice.time=$.time+$.dur,$=$.next;$;$=$.next)$.time=curvoice.time}}for(curvoice.last_note=n,s=m.char();;){switch(s){case"-":var v=parse_vpos();for(u=0;u<=n.nhd;u++)n.notes[u].tie_ty=v,n.notes[u].s=n;for(t?t.tie_s=curvoice.tie_s=t:curvoice.tie_s=n,u=0;u<=n.nhd;u++)d=(r=n.notes[u]).pit+19,(curvoice.acc[d]||l&&l[d])&&(curvoice.acc_tie||(curvoice.acc_tie=[]),curvoice.acc_tie[d]=curvoice.acc[d]||l[d]);s=m.char();continue;case")":n.notes[0].s=n,slur_add(n.notes[0]),s=m.next_char();continue;case".":if("-"!=m.buffer[m.index+1])break;s=m.next_char();continue}break}c&&function(t,e){var r,n,i;for(r=0;r<=t.nhd;r++){if(n=t.notes[r],i=abc2svg.b40m(n.b40),e.type!=C.GRACE){for(u=0;u<=e.nhd;u++)if(e.notes[u].tie_ty&&abc2svg.b40m(e.notes[u].b40)==i){e.notes[u].tie_n=n,n.s=t,e.tie_s=t;break}}else for($=e.extra;$;$=$.next)if($.notes[0].tie_ty&&abc2svg.b40m($.notes[0].b40)==i){$.tie_s=t,$.notes[0].tie_n=n,n.s=t,$.notes[0].s=$,e.tie_s=t;break}t.ti2=e}}(n,c)}return sym_link(n),cfmt.shiftunison&&(n.shiftunison=cfmt.shiftunison),t||(curvoice.lyric_restart||(curvoice.lyric_restart=n),curvoice.sym_restart||(curvoice.sym_restart=n)),y&&deco_cnv(y,n,n.prev),parse.ottava.length&&(n.ottava=parse.ottava,parse.ottava=[]),parse.stemless&&(n.stemless=!0),n.iend=parse.bol+m.index,n}syntax(1,errs.bad_grace)};var nil="0",char_tb=[nil,nil,nil,nil,nil,nil,nil,nil,nil," ","\n",nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil," ","!",'"',"i","\n",nil,"&",nil,"(",")","i",nil,nil,"-","!dot!",nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,"|","i","<","n","<","i","i","n","n","n","n","n","n","n","!fermata!","d","d","d","!emphasis!","!lowermordent!","d","!coda!","!uppermordent!","d","d","!segno!","!trill!","d","d","d","n","d","n","[","\\","|","n","n","i","n","n","n","n","n","n","n","d","d","d","d","d","d","d","d","d","d","d","d","d","!upbow!","!downbow!","d","n","n","n","{","|","}","!gmark!",nil],ottava={"8va(":1,"8va)":0,"15ma(":2,"15ma)":0,"8vb(":-1,"8vb)":0,"15mb(":-2,"15mb)":0};function parse_music_line(){var t,e,r,n,i,s=[],a=-1,o=[],c=parse.line;function l(t){var e,r,n;for(e=1,r=c.index+1;e<t.length;e++,r++)if(t[e]!=c.buffer[r]){if("n"!=t[e])return;if((n=ntb.indexOf(c.buffer[r]))<0)return;for(;"'"==c.buffer[r+1];)n+=7,r++;for(;","==c.buffer[r+1];)n-=7,r++}return c.index=r,n}function u(t){for(var e=ntb[t];t<0;)t+=7,e+=",";for(;t>14;)t-=7,e+="'";return e}function f(t,e){var r,n,i="",s=t.length;for(n=0;n<s;n++)i+=(r=t[n])>="h"&&r<="z"?u(e+r.charCodeAt(0)-"n".charCodeAt(0)):r;return i}function $(t,e,r){var n,i,s,a,o=c,l=parse.istart;if(parse.line=c=new scanBuf,parse.istart+=o.index,cfmt.writefields.indexOf("m")<0){for(c.buffer=t.replace("n",u(r)),a=curvoice.last_sym,i=curvoice.time,h(!0),a||(a=curvoice.sym),a=a.next;a;a=a.next)a.noplay=!0;for(n=curvoice.time,curvoice=clone_voice((s=curvoice).id+"-p"),par_sy.voices[curvoice.v]||(curvoice.second=!0,par_sy.voices[curvoice.v]={st:s.st,second:!0,range:curvoice.v}),curvoice.time=i,a=curvoice.last_sym,parse.line=c=new scanBuf,parse.istart+=o.index,c.buffer=r?f(e,r):e,h(!0),curvoice.time!=n&&syntax(1,"Bad length of the macro sequence"),a||(a=curvoice.sym);a;a=a.next)a.invis=a.play=!0;curvoice=s}else c.buffer=r?f(e,r):e,h(!0);parse.line=c=o,parse.istart=l}function h(u){for(var f,h,p,d,_,m,y,g;v=c.char();){if(curvoice.ignore){for(;;){for(;v&&"["!=v;)v=c.next_char();if(!v)break;if("V"==v&&":"==c.buffer[c.index+1])break;v=c.next_char()}if(!v)break}if("."==v)switch(c.buffer[c.index+1]){case"(":case"-":case"|":v=c.next_char()}if(!u&&maci[v]){for(p in y=0,mac)if(mac.hasOwnProperty(p)&&p[0]==v){if(p.indexOf("n")<0){if(c.buffer.indexOf(p,c.index)!=c.index)continue;c.index+=p.length}else if(!(y=l(p)))continue;$(p,mac[p],y),y=1;break}if(y)continue}if((f=v.charCodeAt(0))>=128){syntax(1,errs.not_ascii),c.index++;break}switch((h=char_tb[f])[0]){case" ":(d=curvoice.last_note)&&(d.beam_end=!0,t&&(t.gr_shift=!0));break;case"\n":if(cfmt.barsperstaff)break;par_sy.voices[curvoice.v]&&0==par_sy.voices[curvoice.v].range&&(curvoice.eoln=!0);break;case"&":if(t){syntax(1,errs.bad_grace);break}if(")"==(v=c.next_char())){get_vover(")");break}get_vover("&");continue;case"(":if((v=c.next_char())>"0"&&v<="9"){if(t){syntax(1,errs.bad_grace);break}var v,b=c.get_int(),A=qplet_tb[b],x=b;if(":"==(v=c.char())&&((v=c.next_char())>"0"&&v<="9"&&(A=c.get_int(),v=c.char()),":"==v)){if(!((v=c.next_char())>"0"&&v<="9")){syntax(1,"Invalid 'r' in tuplet");continue}x=c.get_int(),v=c.char()}0!=A&&null!=A||(A=curvoice.wmeasure%9==0?3:2),a<0&&(a=s.length),s.push({p:b,q:A,r:x,ro:x,f:cfmt.tuplets});continue}if("&"==v){if(t){syntax(1,errs.bad_grace);break}get_vover("(");break}c.index--,o.push(parse_vpos());continue;case")":if(d=curvoice.last_sym)switch(d.type){case C.SPACE:d.notes||(d.notes=[],d.notes[0]={});case C.NOTE:case C.REST:break;case C.GRACE:for(d=d.extra;d.next;d=d.next);break;default:d=null}if(!d){syntax(1,errs.bad_char,v);break}d.notes[0].s=d,slur_add(d.notes[0]);break;case"!":if(a_dcn||(a_dcn=[]),h.length>1)_=h.slice(1,-1);else{for(_="",m=c.index;(v=c.next_char())&&"!"!=v;)_+=v;if(!v){c.index=m,syntax(1,"No end of decoration");break}}null!=ottava[_]?(glovar.ottava=!0,parse.ottava.push(ottava[_])):a_dcn.push(_);break;case'"':if(t){syntax(1,errs.bad_grace);break}parse_gchord(h);break;case"[":if(h.length>1){self.do_pscom(h.slice(3,-1));break}var w=c.buffer[c.index+1];if('|[]: "'.indexOf(w)>=0||w>="1"&&w<="9"){if(t){syntax(1,errs.bar_grace);break}new_bar();continue}if(":"==c.buffer[c.index+2]){if(t){syntax(1,errs.bad_grace);break}if((m=c.buffer.indexOf("]",c.index+1))<0){syntax(1,"Lack of ']'");break}g=c.buffer.slice(c.index+3,m).trim(),parse.istart=parse.bol+c.index,parse.iend=parse.bol+ ++m,c.index=0,do_info(w,g),c.index=m;continue}case"n":if(!(d=self.new_note(t,o)))continue;if(t||!d.notes)continue;if(a>=0)d.tp=s.slice(a),a=-1,i&&(d.tp[0].s=i),i=d;else if(!i)continue;if(--(p=s[s.length-1]).r>0)continue;for(;;){if(tp_adj(i,p.q/p.p),m=p.ro,p.s&&(i=p.s),s.pop(),!s.length){i=null;break}if((p=s[s.length-1]).r-=m,p.r>0)break}continue;case"<":if(!curvoice.last_note){syntax(1,"No note before '<'");break}if(t){syntax(1,"Cannot have a broken rhythm in grace notes");break}for(y="<"==v?1:-1;"<"==v||">"==v;)y*=2,v=c.next_char();curvoice.brk_rhythm=y;continue;case"i":break;case"{":if(t){syntax(1,"'{' in grace note");break}switch(e=curvoice.last_note,curvoice.last_note=null,r=a_dcn,a_dcn=void 0,t={type:C.GRACE,fname:parse.fname,istart:parse.bol+c.index,dur:0,multi:0},curvoice.pos.gst){case C.SL_ABOVE:t.stem=1;break;case C.SL_BELOW:t.stem=-1;break;case C.SL_HIDDEN:t.stem=2}if(sym_link(t),"/"==(v=c.next_char())){t.sappo=!0;break}continue;case"|":if(t){syntax(1,errs.bar_grace);break}new_bar("."==c.buffer[c.index-1]);continue;case"}":if(d=curvoice.last_note,!t||!d){syntax(1,errs.bad_char,v);break}if(a_dcn&&syntax(1,"Decoration ignored"),t.extra=t.next,t.extra.prev=null,t.next=null,curvoice.last_sym=t,t=null,!d.prev&&!curvoice.ckey.k_bagpipe){for(m=0;m<=d.nhd;m++)d.notes[m].dur*=2;d.dur*=2,d.dur_orig*=2}curvoice.last_note=e,a_dcn=r;break;case"\\":if(!c.buffer[c.index+1]){n=!0;break}default:syntax(1,errs.bad_char,v)}c.index++}}if(3!=parse.state){if(2!=parse.state)return;goto_tune()}parse.tp&&(s=parse.tp,i=parse.tps,parse.tp=null),h(),s.length&&(parse.tp=s,parse.tps=i),t&&(syntax(1,"No end of grace note sequence"),curvoice.last_sym=t.prev,curvoice.last_note=e,t.prev&&(t.prev.next=null)),cfmt.breakoneoln&&curvoice.last_note&&(curvoice.last_note.beam_end=!0),n||cfmt.barsperstaff||"\n"==char_tb["\n".charCodeAt(0)]&&par_sy.voices[curvoice.v]&&0==par_sy.voices[curvoice.v].range&&(curvoice.eoln=!0)}var sw_tb=new Float32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.25,.333,.408,.5,.5,.833,.778,.333,.333,.333,.5,.564,.25,.564,.25,.278,.5,.5,.5,.5,.5,.5,.5,.5,.5,.5,.278,.278,.564,.564,.564,.444,.921,.722,.667,.667,.722,.611,.556,.722,.722,.333,.389,.722,.611,.889,.722,.722,.556,.722,.667,.556,.611,.722,.722,.944,.722,.722,.611,.333,.278,.333,.469,.5,.333,.444,.5,.444,.5,.444,.333,.5,.5,.278,.278,.5,.278,.778,.5,.5,.5,.5,.333,.389,.278,.5,.5,.722,.5,.5,.444,.48,.2,.48,.541,.5]),ssw_tb=new Float32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.278,.278,.355,.556,.556,.889,.667,.191,.333,.333,.389,.584,.278,.333,.278,.278,.556,.556,.556,.556,.556,.556,.556,.556,.556,.556,.278,.278,.584,.584,.584,.556,1.015,.667,.667,.722,.722,.667,.611,.778,.722,.278,.5,.667,.556,.833,.722,.778,.667,.778,.722,.667,.611,.722,.667,.944,.667,.667,.611,.278,.278,.278,.469,.556,.333,.556,.556,.5,.556,.556,.278,.556,.556,.222,.222,.5,.222,.833,.556,.556,.556,.556,.333,.5,.278,.556,.5,.722,.5,.5,.5,.334,.26,.334,.584,.512]),cw_tb=sw_tb;function cwid(t){var e=t.charCodeAt(0);if(e>=128){if(e>=768&&e<880)return 0;e=97}return cw_tb[e]}function cwidf(t){return cwid(t)*gene.curfont.swfac}var strwh="undefined"!=typeof document?(el=document.createElement("div"),el.style.position="absolute",el.style.top="-1000px",el.style.padding="0",document.body.appendChild(el),function(t){var e,r=gene.curfont,n=r.size,i=0,s=(t.length,0),a=0;for(el.style.font=style_font(r).slice(5),t=t.replace(/<|>|&[^&]*?;|&|  /g,function(t){switch(t){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";case"  ":return" "}return t});!((a=t.indexOf("$",a))<0);){if("0"==(e=t[a+1]))r=gene.deffont;else{if(!(e>="1"&&e<="9")){a++;continue}r=get_font("u"+e)}el.innerHTML=t.slice(s,a),i+=el.clientWidth,r.size>n&&(n=r.size),el.style.font=style_font(r).slice(5),s=a+=2}return el.innerHTML=t.slice(s),i+=el.clientWidth,gene.curfont=r,[i,n]}):function(t){var e,r,n,i=gene.curfont,s=i.swfac,a=i.size,o=0,c=t.length;for(e=0;e<c;e++){switch(n=t[e]){case"$":if("0"==(n=t[e+1]))i=gene.deffont;else{if(!(n>="1"&&n<="9")){n="$";break}i=get_font("u"+n)}e++,s=i.swfac,i.size>a&&(a=i.size);continue;case"&":(r=t.indexOf(";",e))>0&&r-e<10&&(e=r,n="a")}o+=cwid(n)*s}return gene.curfont=i,[o,a]},el;function set_font(t){"string"==typeof t&&(t=get_font(t)),cw_tb="sans"==t.name.slice(0,4)?ssw_tb:sw_tb,gene.curfont=gene.deffont=t}function out_str(t){var e,r=gene.curfont,n=r;output+=t.replace(/<|>|&[^&]*?;|&|  |\$./g,function(t){switch(t){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";case"  ":return" ";default:if("$"!=t[0])break;if("0"==t[1])e=gene.deffont;else{if(!(t[1]>="1"&&t[1]<="9"))break;e=get_font("u"+t[1])}return t="",e==n?t:(n!=r&&(t="</tspan>"),(n=e)==r?t:t+'<tspan\n\tclass="'+font_class(e)+'">')}return t}),n!=r&&(output+="</tspan>",gene.curfont=n)}function xy_str(t,e,r,n,i,s){switch(s||(s=strwh(r)),output+='<text class="'+font_class(gene.curfont),"j"!=n&&r.length>5&&gene.curfont.wadj&&(output+='" lengthAdjust="'+gene.curfont.wadj+'" textLength="'+s[0].toFixed(1)),output+='" x="',out_sxsy(t,'" y="',e+.2*s[1]),n){case"c":t-=s[0]/2,output+='" text-anchor="middle">';break;case"j":output+='" textLength="'+i.toFixed(1)+'">';break;case"r":t-=s[0],output+='" text-anchor="end">';break;default:output+='">'}out_str(r),output+="</text>\n",!i&&gene.curfont.box&&(output+='<rect class="stroke" x="',out_sxsy(t-2,'" y="',e+s[1]+1),output+='" width="'+(s[0]+4).toFixed(1)+'" height="'+(s[1]+2).toFixed(1)+'"/>\n')}function trim_title(t,e){var r;return cfmt.titletrim&&((r=t.lastIndexOf(", "))<0||t[r+2]<"A"||t[r+2]>"Z"?r=0:1==cfmt.titletrim?(r<t.length-7||t.indexOf(" ",r+3)>=0)&&(r=0):r<t.length-cfmt.titletrim-2&&(r=0),r&&(t=t.slice(r+2).trim()+" "+t.slice(0,r))),!e&&cfmt.writefields.indexOf("X")>=0&&(t=info.X+".  "+t),cfmt.titlecaps?t.toUpperCase():t}function get_lwidth(){return(img.width-img.lm-img.rm-2)/cfmt.scale}function write_title(t,e){var r,n;t&&(set_page(),t=trim_title(t,e),e?(set_font("subtitle"),r=cfmt.subtitlespace):(set_font("title"),r=cfmt.titlespace),vskip((n=strwh(t))[1]+r),cfmt.titleleft?xy_str(0,0,t,null,null,n):xy_str(get_lwidth()/2,0,t,"c",null,n))}function put_inf2r(t,e,r,n,i){if(!r){if(!n)return;r=n,n=null}xy_str(t,e,n?r+" ("+n+")":r,i)}function write_text(t,e){if("s"!=e){set_font("text"),set_page();var r,n,i,s,a,o,c,l,u,f,$=get_lwidth(),h=gene.curfont.size,p=h*cfmt.lineskipfac,d=h*cfmt.parskipfac;switch(e){default:switch(e){case"c":a=$/2;break;case"r":a=$;break;default:a=0}for(s=0,n=gene.curfont;;){if((i=t.indexOf("\n",s))<0){f=t.slice(s),r=strwh(f),gene.curfont=n,vskip(r[1]*cfmt.lineskipfac),xy_str(a,0,f,e,null,r),n=gene.curfont;break}if(i==s){for(vskip(d),blk_flush(),use_font(gene.curfont);"\n"==t[i+1];)vskip(p),i++;if(i==t.length)break}else f=t.slice(s,i),r=strwh(f),gene.curfont=n,vskip(r[1]*cfmt.lineskipfac),xy_str(a,0,f,e,null,r),n=gene.curfont;s=i+1}vskip(d),blk_flush();break;case"f":case"j":for(s=0;;){for(o=(o=(i=t.indexOf("\n\n",s))<0?t.slice(s):t.slice(s,i)).split(/\s+/),c=l=0,n=gene.curfont,s=0;s<o.length;s++)(c+=u=strwh(o[s])[0])>=$&&(f=o.slice(l,s).join(" "),gene.curfont=n,r=strwh(f),gene.curfont=n,vskip(r[1]*cfmt.lineskipfac),xy_str(0,0,f,e,$,r),n=gene.curfont,l=s,c=u),c+=cwidf(" ");if(0!=c&&(f=o.slice(l).join(" "),gene.curfont=n,r=strwh(f),gene.curfont=n,vskip(r[1]*cfmt.lineskipfac),xy_str(0,0,f,null,null,r)),vskip(d),blk_flush(),i<0)break;for(;"\n"==t[i+2];)vskip(p),i++;if(i==t.length)break;use_font(gene.curfont),s=i+2}}}}function put_words(t){var e,r,n,i,s,a,o,c,l,u,f,$=0,h=1;function p(t,e){var r,n,i=0;if("$"==t[i]&&t[i+1]>="0"&&t[i+1]<="9"&&(i+=2),n=0,r=i,t[i]>="0"&&t[i]<="9"||"."==t[i+1]){for(;i<t.length&&" "!=t[++i]&&":"!=t[i-1]&&"."!=t[i-1];);for(n=i;" "==t[i];)i++}0!=n&&xy_str(e,0,t.slice(r,n),"r"),i<t.length&&xy_str(e+5,0,t.slice(i),"l")}for(set_font("words"),vskip(cfmt.wordsspace),svg_flush(),i=(t=t.split("\n")).length,r=0;r<i;r++)if(e=t[r])e.length>$&&($=e.length);else{for(;r+1<i&&!t[r+1];)r++;h++}if(s=get_lwidth()/2,(a=$*cwidf("a"))<s){for(c=(o=(s-a)/2+10)+s,n=h>>1,r=0;r<i;r++)if(!(e=t[r])){for(--n<=0&&(l=r);r+1<i&&!t[r+1];)r++;if(n<=0){u=r+1;break}}h>>=1}else c=s-a/2+10,l=u=0;for(f=!0,r=0;r<l||u<i;r++,u++)vskip(cfmt.lineskipfac*gene.curfont.size),r<l&&((e=t[r])?p(e,o):use_font(gene.curfont)),u<i&&((e=t[u])?p(e,c):0==--h&&(r<l?h++:u<i-1&&(c=s-a/2+10,svg_flush()))),t[r+1]||t[u+1]?f=!0:f&&(svg_flush(),f=!1)}function put_history(){var t,e,r,n,i,s,a,o,c,l=cfmt.infoname.split("\n"),u=l.length;for(t=0;t<u;t++)if(r=l[t][0],!(cfmt.writefields.indexOf(r)<0)&&(n=info[r])){for(i||(i=!0,set_font("history"),vskip(cfmt.textspace),s=gene.curfont.size*cfmt.lineskipfac),'"'==(c=l[t].slice(2))[0]&&(c=c.slice(1,-1)),vskip(s),xy_str(0,0,c,null,null,o=strwh(c)),xy_str(a=o[0],0,(n=n.split("\n"))[0]),e=1;e<n.length;e++)vskip(s),xy_str(a,0,n[e]);vskip(.3*s),use_font(gene.curfont)}}var info_font_init={A:"info",C:"composer",O:"composer",P:"parts",Q:"tempo",R:"info",T:"title",X:"title"};function write_headform(t){for(var e,r,n,i,s,a,o,c={},l=clone(info_font_init),u={A:cfmt.infospace,C:cfmt.composerspace,O:cfmt.composerspace,R:cfmt.infospace},f={},$="",h=cfmt.titleformat,p=0,d=0;;){for(;" "==h[d];)d++;if(d>=h.length)break;if((e=h[d++])<"A"||e>"Z")if("+"==e){if(0==$.length||"+"==$.slice(-1))continue;$=$.slice(0,-1)+"+"}else","==e&&("+"==$.slice(-1)&&($=$.slice(0,-1)+"l"),$+="\n");else{if(c[e])f[e]++;else{if(!info[e])continue;c[e]=info[e].split("\n"),f[e]=1}switch($+=e,h[d]){case"-":$+="l",d++;break;case"0":$+="c",d++;break;case"1":$+="r",d++;break;default:$+="c"}}}"+"==$.slice(-1)&&($=$.slice(0,-1)+"l"),$+="\n";var _,m={l:cfmt.titlespace,c:cfmt.titlespace,r:cfmt.titlespace},y={l:0,c:.5*t,r:t},g={};for(h=$,d=0;;){for(g.l=g.c=g.r=a=0,p=d;"\n"!=(e=h[p++]);){if("+"==(i=h[p++]))i=h[p+1];else if(0!=g[i])continue;(_=c[e])&&((n=l[e])||(n="history"),o=1.1*(r=get_font(n)).size,u[e]&&(o+=u[e]),a<o&&(a=o),g[i]=o)}for(m.l+=a-g.l,m.c+=a-g.c,m.r+=a-g.r;"\n"!=(e=h[d++]);)if(i=h[d++],0!=c[e].length){if(_=c[e].shift(),"+"==i&&(f[e]--,e=h[d++],i=h[d++],c[e].length>0&&(_?_+=" "+c[e].shift():_=" "+c[e].shift())),(n=l[e])||(n="history"),o=1.1*(r=get_font(n)).size,u[e]&&(o+=u[e]),set_font(r),s=y[i],a=m[i]+o,"Q"==e?(self.set_width(glovar.tempo),glovar.tempo.invis||("l"!=i&&(tempo_build(glovar.tempo),w=glovar.tempo.tempo_wh[0],"c"==i&&(w*=.5),s-=w),writempo(glovar.tempo,s,-a))):_&&xy_str(s,-a,_,i),"T"==e&&(n=l.T="subtitle",u.T=cfmt.subtitlespace),f[e]<=1)for("T"==e&&(o=1.1*(r=get_font(n)).size,u[e]&&(o+=u[e]),set_font(r));c[e].length>0;)xy_str(s,-(a+=o),_=c[e].shift(),i);f[e]--,m[i]=a}if(m.c>m.l&&(m.l=m.c),m.r>m.l&&(m.l=m.r),d>=$.length)break;m.c=m.r=m.l}vskip(m.l)}function write_heading(){var t,e,r,n,i,s,a,o,c=get_lwidth();if(vskip(cfmt.topspace),cfmt.titleformat)return write_headform(c),void vskip(cfmt.musicspace);if(info.T&&cfmt.writefields.indexOf("T")>=0)for(t=0;;){if((e=info.T.indexOf("\n",t))<0){write_title(info.T.substring(t),0!=t);break}write_title(info.T.slice(t,e),0!=t),t=e+1}if(a=o=0,parse.ckey.k_bagpipe&&!cfmt.infoline&&cfmt.writefields.indexOf("R")>=0&&(s=info.R),s&&(set_font("composer"),xy_str(0,-cfmt.composerspace,s),a=cfmt.composerspace),r=info.A,cfmt.writefields.indexOf("C")>=0&&(n=info.C),cfmt.writefields.indexOf("O")>=0&&(i=info.O),n||i||cfmt.infoline){var l,u;if(set_font("composer"),vskip(cfmt.composerspace),cfmt.aligncomposer<0?(l=0,u=" "):0==cfmt.aligncomposer?(l=.5*c,u="c"):(l=c,u="r"),o=a,n||i){for(cfmt.aligncomposer>=0&&a!=o&&vskip(a-o),t=0;;){if(vskip(gene.curfont.size),(e=n?n.indexOf("\n",t):-1)<0){put_inf2r(l,0,n?n.substring(t):null,i,u);break}xy_str(l,0,n.slice(t,e),u),a+=gene.curfont.size,t=e+1}o>a&&vskip(o-a)}((s=s?null:info.R)||r)&&cfmt.infoline&&(set_font("info"),vskip(gene.curfont.size+cfmt.infospace),put_inf2r(c,0,s,r,"r"),a+=gene.curfont.size+cfmt.infospace)}else o=cfmt.composerspace;info.P&&cfmt.writefields.indexOf("P")>=0&&(set_font("parts"),(a=cfmt.partsspace+gene.curfont.size-a)>0&&(o+=a),o>.01&&vskip(o),xy_str(0,0,info.P),o=0),vskip(o+cfmt.musicspace)}var output="",style="\n.stroke{stroke:currentColor;fill:none}\n.bW{stroke:currentColor;fill:none;stroke-width:1}\n.bthW{stroke:currentColor;fill:none;stroke-width:3}\n.slW{stroke:currentColor;fill:none;stroke-width:.7}\n.slthW{stroke:currentColor;fill:none;stroke-width:1.5}\n.sW{stroke:currentColor;fill:none;stroke-width:.7}",font_style="",posx=cfmt.leftmargin/cfmt.scale,posy=0,img={width:cfmt.pagewidth,lm:cfmt.leftmargin,rm:cfmt.rightmargin},defined_glyph={},defs="",fulldefs="",stv_g={scale:1,dy:0,st:-1,v:-1,g:0},blkdiv=1,tgls={"mtr ":{x:0,y:0,c:" "},brace:{x:0,y:0,c:""},hl:{x:-4,y:0,c:""},hl1:{x:-6,y:0,c:""},ghl:{x:-4,y:0,c:""},lphr:{x:0,y:24,c:""},mphr:{x:0,y:24,c:""},sphr:{x:0,y:27,c:""},rdots:{x:-1,y:0,c:""},dsgn:{x:-4,y:-4,c:""},dcap:{x:-4,y:-4,c:""},sgno:{x:-6,y:0,c:""},coda:{x:-12,y:-6,c:""},tclef:{x:-8,y:0,c:""},cclef:{x:-8,y:0,c:""},bclef:{x:-8,y:0,c:""},pclef:{x:-6,y:0,c:""},spclef:{x:-6,y:0,c:""},stclef:{x:-8,y:0,c:""},scclef:{x:-8,y:0,c:""},sbclef:{x:-7,y:0,c:""},oct:{x:0,y:2,c:""},mtr0:{x:0,y:0,c:""},mtr1:{x:0,y:0,c:""},mtr2:{x:0,y:0,c:""},mtr3:{x:0,y:0,c:""},mtr4:{x:0,y:0,c:""},mtr5:{x:0,y:0,c:""},mtr6:{x:0,y:0,c:""},mtr7:{x:0,y:0,c:""},mtr8:{x:0,y:0,c:""},mtr9:{x:0,y:0,c:""},mtrC:{x:0,y:0,c:""},"mtr+":{x:0,y:0,c:""},"mtr(":{x:0,y:0,c:""},"mtr)":{x:0,y:0,c:""},HDD:{x:-7,y:0,c:""},breve:{x:-7,y:0,c:""},HD:{x:-5.2,y:0,c:""},Hd:{x:-3.8,y:0,c:""},hd:{x:-3.7,y:0,c:""},ghd:{x:2,y:0,c:"",sc:.66},pshhd:{x:-3.7,y:0,c:""},pfthd:{x:-3.7,y:0,c:""},x:{x:-3.7,y:0,c:""},"circle-x":{x:-3.7,y:0,c:""},srep:{x:-5,y:0,c:""},"dot+":{x:-5,y:0,sc:.7,c:""},diamond:{x:-4,y:0,c:""},triangle:{x:-4,y:0,c:""},dot:{x:-2,y:0,c:""},flu1:{x:-.3,y:0,c:""},fld1:{x:-.3,y:0,c:""},flu2:{x:-.3,y:0,c:""},fld2:{x:-.3,y:0,c:""},flu3:{x:-.3,y:3.5,c:""},fld3:{x:-.3,y:-4,c:""},flu4:{x:-.3,y:8,c:""},fld4:{x:-.3,y:-9,c:""},flu5:{x:-.3,y:12.5,c:""},fld5:{x:-.3,y:-14,c:""},"acc-1":{x:-1,y:0,c:""},acc3:{x:-1,y:0,c:""},acc1:{x:-2,y:0,c:""},acc2:{x:-3,y:0,c:""},"acc-2":{x:-3,y:0,c:""},"acc-1_1_4":{x:-2,y:0,c:""},"acc-1_3_4":{x:-3,y:0,c:""},acc1_1_4:{x:-1,y:0,c:""},acc1_3_4:{x:-3,y:0,c:""},accent:{x:-3,y:0,c:""},stc:{x:-1,y:-2,c:""},emb:{x:-4,y:-2,c:""},wedge:{x:-1,y:0,c:""},marcato:{x:-3,y:0,c:""},hld:{x:-7,y:0,c:""},brth:{x:0,y:0,c:""},r00:{x:-1.5,y:0,c:""},r0:{x:-1.5,y:0,c:""},r1:{x:-3.5,y:-6,c:""},r2:{x:-3.2,y:0,c:""},r4:{x:-3,y:0,c:""},r8:{x:-3,y:0,c:""},r16:{x:-4,y:0,c:""},r32:{x:-4,y:0,c:""},r64:{x:-4,y:0,c:""},r128:{x:-4,y:0,c:""},mrest:{x:-10,y:0,c:""},mrep:{x:-6,y:0,c:""},mrep2:{x:-9,y:0,c:""},p:{x:-4,y:-6,c:""},f:{x:-4,y:-6,c:""},pppp:{x:-4,y:-6,c:""},ppp:{x:-4,y:-6,c:""},pp:{x:-4,y:-6,c:""},mp:{x:-4,y:-6,c:""},mf:{x:-4,y:-6,c:""},ff:{x:-4,y:-6,c:""},fff:{x:-4,y:-6,c:""},ffff:{x:-4,y:-6,c:""},sfz:{x:-4,y:-6,c:""},trl:{x:-4,y:-4,c:""},turn:{x:-5,y:-4,c:""},turnx:{x:-5,y:-4,c:""},umrd:{x:-7,y:-2,c:""},lmrd:{x:-7,y:-2,c:""},dplus:{x:-4,y:10,c:""},sld:{x:-8,y:12,c:""},grm:{x:-2,y:0,c:""},dnb:{x:-4,y:0,c:""},upb:{x:-3,y:0,c:""},opend:{x:-2,y:0,c:""},roll:{x:0,y:0,c:""},thumb:{x:0,y:0,c:""},snap:{x:-2,y:0,c:""},ped:{x:-10,y:0,c:""},pedoff:{x:-5,y:0,c:""},mtro:{x:0,y:0,c:""},mtrc:{x:0,y:0,c:""},"mtr.":{x:0,y:0,c:""},"mtr|":{x:0,y:0,c:""},longa:{x:-3.7,y:0,c:""},custos:{x:-4,y:3,c:""},ltr:{x:2,y:6,c:""}},glyphs={};function m_gl(t){return t.replace(/[Cco]\||[co]\.|./g,function(t){return tgls["mtr"+t].c})}function def_use(t){var e,r,n;if(!defined_glyph[t])if(defined_glyph[t]=!0,n=glyphs[t]){for(r=0;!((e=n.indexOf('xlink:href="#',r))<0);)e+=13,r=n.indexOf('"',e),def_use(n.slice(e,r));defs+="\n"+n}else error(1,null,"Unknown glyph: '$1'",t)}function defs_add(t){var e,r,n,i,s,a=0;for(t=t.replace(/<!--.*?-->/g,"");!((s=t.indexOf("<",a))<0||(e=t.indexOf('id="',s))<0||(e+=4,(r=t.indexOf('"',e))<0)||(n=t.slice(e,r),(a=t.indexOf(">",r))<0));){if("/"==t[a-1])a++;else{if((e=t.indexOf(" ",s))<0)break;if(i=t.slice(s+1,e),(a=t.indexOf("</"+i+">",a))<0)break;a+=3+i.length}"<filter"==t.substr(s,7)?fulldefs+="\n"+t.slice(s,a):glyphs[n]=t.slice(s,a)}}function set_g(){stv_g.started&&(stv_g.started=!1,output+="</g>\n"),(1!=stv_g.scale||stv_g.color)&&(output+="<g ",1!=stv_g.scale&&(stv_g.st<0?output+=voice_tb[stv_g.v].scale_str:stv_g.v<0?output+=staff_tb[stv_g.st].scale_str:output+='transform="translate(0,'+(posy-stv_g.dy).toFixed(1)+") scale("+stv_g.scale.toFixed(2)+')"'),stv_g.color&&(1!=stv_g.scale&&(output+=" "),output+='color="'+stv_g.color+'" fill="'+stv_g.color+'"'),output+=">\n",stv_g.started=!0)}function set_color(t){if(t!=stv_g.color){var e=stv_g.color;return stv_g.color=t,set_g(),e}}function set_sscale(t){var e,r;t!=stv_g.st&&1!=stv_g.scale&&(stv_g.scale=0),e=t>=0?staff_tb[t].staffscale:1,r=t>=0&&1!=e?staff_tb[t].y:posy,e==stv_g.scale&&r==stv_g.dy||(stv_g.scale=e,stv_g.dy=r,stv_g.st=t,stv_g.v=-1,set_g())}function set_scale(t){var e,r=t.p_v.scale;1!=r?(e=posy,1!=staff_tb[t.st].staffscale&&(r*=staff_tb[t.st].staffscale,e=staff_tb[t.st].y),r==stv_g.scale&&stv_g.dy==posy||(stv_g.scale=r,stv_g.dy=e,stv_g.st=1==staff_tb[t.st].staffscale?-1:t.st,stv_g.v=t.v,set_g())):set_sscale(t.st)}function set_dscale(t,e){output&&(stv_g.st<0?staff_tb[0].output+=output:1==stv_g.scale?staff_tb[stv_g.st].output+=output:staff_tb[stv_g.st].sc_out+=output,output=""),stv_g.scale=t<0?1:e?1:staff_tb[t].staffscale,stv_g.st=t,stv_g.dy=0}function delayed_update(){var t;for(t=0;t<=nstaff;t++)staff_tb[t].sc_out&&(output+="<g "+staff_tb[t].scale_str+">\n"+staff_tb[t].sc_out+"</g>\n",staff_tb[t].sc_out=""),staff_tb[t].output&&(output+='<g transform="translate(0,'+(-staff_tb[t].y).toFixed(1)+')">\n'+staff_tb[t].output+"</g>\n",staff_tb[t].output="")}function anno_out(t,e,r){if(null!=t.istart){var n=t.type,i=t.ymx-t.ymn+4,s=t.wl||2,a=t.wr||2;t.grace&&(n=C.GRACE),r(e||abc2svg.sym_name[n],t.istart,t.iend,t.x-s-2,staff_tb[t.st].y+t.ymn+i-2,s+a+4,i,t)}}function a_start(t,e){anno_out(t,e,user.anno_start)}function a_stop(t,e){anno_out(t,e,user.anno_stop)}function empty_function(){}var anno_start=user.anno_start?a_start:empty_function,anno_stop=user.anno_stop?a_stop:empty_function;function out_XYAB(t,e,r,n,i){e=sx(e),r=sy(r),output+=t.replace(/X|Y|A|B|F|G/g,function(t){switch(t){case"X":return e.toFixed(1);case"Y":return r.toFixed(1);case"A":return n;case"B":return i;case"F":return n.toFixed(1);default:return i.toFixed(1)}})}function g_open(t,e,r,n,i){out_XYAB('<g transform="translate(X,Y',t,e),r&&(output+=") rotate("+r.toFixed(2)),n&&(output+=i?") scale("+n.toFixed(2)+", "+i.toFixed(2):") scale("+n.toFixed(2)),output+=')">\n',stv_g.g++}function g_close(){stv_g.g--,output+="</g>\n"}function sx(t){return stv_g.g?t:(t+posx)/stv_g.scale}function sy(t){return stv_g.g?-t:1==stv_g.scale?posy-t:stv_g.v>=0?(stv_g.dy-t)/voice_tb[stv_g.v].scale:stv_g.dy-t}function out_sxsy(t,e,r){t=sx(t),r=sy(r),output+=t.toFixed(1)+e+r.toFixed(1)}function xypath(t,e,r){out_XYAB(r?'<path d="mX Y':'<path class="stroke" d="mX Y',t,e)}function xygl(t,e,r){if(glyphs[r])def_use(r),out_XYAB('<use x="X" y="Y" xlink:href="#A"/>\n',t,e,r);else{var n=tgls[r];n?(t+=n.x*stv_g.scale,e-=n.y,n.sc?out_XYAB('<text transform="translate(X,Y) scale(A)">B</text>\n',t,e,n.sc,n.c):out_XYAB('<text x="X" y="Y">A</text>\n',t,e,n.c)):error(1,null,"no definition of $1",r)}}function out_acciac(t,e,r,n,i){i?(t-=1,e+=4):(t-=5,e-=4),out_XYAB('<path class="stroke" d="mX YlF G"/>\n',t,e,r,-n)}function out_bnum(t,e,r){out_XYAB('<text style="font:italic 12px serif"\n\tx="X" y="Y" text-anchor="middle">A</text>\n',t,e,r.toString())}function out_brace(t,e,r){e=posy-e,r/=24,output+='<text transform="translate('+(t+=posx-6).toFixed(1)+","+e.toFixed(1)+") scale(2.5,"+r.toFixed(2)+')">'+tgls.brace.c+"</text>\n"}function out_bracket(t,e,r){e=posy-e-3,r+=2,output+='<path d="m'+(t+=posx-5).toFixed(1)+" "+e.toFixed(1)+"\n\tc10.5 1 12 -4.5 12 -3.5c0 1 -3.5 5.5 -8.5 5.5\n\tv"+r.toFixed(1)+'\n\tc5 0 8.5 4.5 8.5 5.5c0 1 -1.5 -4.5 -12 -3.5"/>\n'}function out_hyph(t,e,r){var n,i=25+3*(r/20|0);out_XYAB('<path class="stroke" stroke-width="1.2"\n\tstroke-dasharray="5,A"\n\td="mX YhB"/>\n',t+=(r-i*(n=r>15?(r-15)/i|0:0)-5)/2,e+6,Math.round((i-5)/stv_g.scale),i*n+5)}function out_stem(t,e,r,n,i,s){var a=n?GSTEM_XOFF:3.5,o=-r;if(r<0&&(a=-a),t+=a*stv_g.scale,stv_g.v>=0&&(o/=voice_tb[stv_g.v].scale),out_XYAB('<path class="sW" d="mX YvF"/>\n',t,e,o),i){if(e+=r,r>0)if(s)if(output+='<path d="',n)for(;--i>=0;)out_XYAB("MX Yl3 1.5 0 2 -3 -1.5z\n",t,e),e-=3;else for(;--i>=0;)out_XYAB("MX Yl7 3.2 0 3.2 -7 -3.2z\n",t,e),e-=5.4;else{if(!n)return void xygl(t,e,"flu"+i);if(output+='<path d="',1==i)out_XYAB("MX Yc0.6 3.4 5.6 3.8 3 10\n\t1.2 -4.4 -1.4 -7 -3 -7\n",t,e);else for(;--i>=0;)out_XYAB("MX Yc1 3.2 5.6 2.8 3.2 8\n\t1.4 -4.8 -2.4 -5.4 -3.2 -5.2\n",t,e),e-=3.5}else if(s){if(output+='<path d="',!n)for(;--i>=0;)out_XYAB("MX Yl7 -3.2 0 -3.2 -7 3.2z\n",t,e),e+=5.4}else{if(!n)return void xygl(t,e,"fld"+i);if(output+='<path d="',1==i)out_XYAB("MX Yc0.6 -3.4 5.6 -3.8 3 -10\n\t1.2 4.4 -1.4 7 -3 7\n",t,e);else for(;--i>=0;)out_XYAB("MX Yc1 -3.2 5.6 -2.8 3.2 -8\n\t1.4 4.8 -2.4 5.4 -3.2 5.2\n",t,e),e+=3.5}output+='"/>\n'}}function out_trem(t,e,r){for(out_XYAB('<path d="mX Y\n\t',t-4.5,e);output+="l9 -3v3l-9 3z",!(--r<=0);)output+="m0 5.4";output+='"/>\n'}function out_tubr(t,e,r,n,i){var s=i?-3:3;e+=s,r/=stv_g.scale,output+='<path class="stroke" d="m',out_sxsy(t," ",e),output+="v"+s.toFixed(1)+"l"+r.toFixed(1)+" "+(-n).toFixed(1)+"v"+(-s).toFixed()+'"/>\n'}function out_tubrn(t,e,r,n,i,s){var a=10*s.length,o=i?-3:3;out_XYAB('<text style="font:italic 12px serif"\n\tx="X" y="Y" text-anchor="middle">A</text>\n',t+r/2,e+n/2,s),r/=stv_g.scale,i||(e+=6),output+='<path class="stroke" d="m',out_sxsy(t," ",e),output+="v"+o.toFixed(1)+"m"+r.toFixed(1)+" "+(-n).toFixed(1)+"v"+(-o).toFixed(1)+'"/>\n<path class="stroke" stroke-dasharray="'+((r-a)/2).toFixed(1)+" "+a.toFixed(1)+'" d="m',out_sxsy(t," ",e-o),output+="l"+r.toFixed(1)+" "+(-n).toFixed(1)+'"/>\n'}function out_wln(t,e,r){out_XYAB('<path class="stroke" stroke-width="0.8" d="mX YhF"/>\n',t,e+3,r)}Abc.prototype.out_svg=function(t){output+=t},Abc.prototype.sx=sx,Abc.prototype.sy=sy,Abc.prototype.sh=function(t){return stv_g.st<0?t/stv_g.scale:t},Abc.prototype.ax=function(t){return t+posx},Abc.prototype.ay=function(t){return stv_g.st<0?posy-t:posy+(stv_g.dy-t)*stv_g.scale-stv_g.dy},Abc.prototype.ah=function(t){return stv_g.st<0?t:t*stv_g.scale},Abc.prototype.out_sxsy=out_sxsy,Abc.prototype.xypath=xypath;var deco_str_style={crdc:{dx:0,dy:5,style:"font:italic 14px serif"},dacs:{dx:0,dy:3,style:"font:16px serif",anchor:' text-anchor="middle"'},fng:{dx:0,dy:1,style:"font-family:Bookman; font-size:8px",anchor:' text-anchor="middle"'},pf:{dx:0,dy:5,style:"font:italic bold 16px serif"},"@":{dx:0,dy:5,style:"font: 12px sans-serif"}};function out_deco_str(t,e,r,n){var i=deco_str_style[r];i?(t+=i.dx,e+=i.dy,i.def||(style+="\n."+r+" {"+i.style+"}",i.def=!0),out_XYAB('<text x="X" y="Y" class="A"B>',t,e,r,i.anchor||""),set_font("annotation"),out_str(n),output+="</text>\n"):xygl(t,e,r)}function out_arp(t,e,r){for(g_open(t,e,270),t=0,r=Math.ceil(r/6);--r>=0;)xygl(t,6,"ltr"),t+=6;g_close()}function out_cresc(t,e,r,n){out_XYAB('<path class="stroke"\n\td="mX YlA ',t+=r,e+5,r=-r),n.nost?output+="-2.2m0 -3.6l"+(-r).toFixed(1)+' -2.2"/>\n':output+="-4l"+(-r).toFixed(1)+' -4"/>\n'}function out_dim(t,e,r,n){out_XYAB('<path class="stroke"\n\td="mX YlA ',t,e+5,r),n.noen?output+="-2.2m0 -3.6l"+(-r).toFixed(1)+' -2.2"/>\n':output+="-4l"+(-r).toFixed(1)+' -4"/>\n'}function out_ltr(t,e,r){for(e+=4,r=Math.ceil(r/6);--r>=0;)xygl(t,e,"ltr"),t+=6}function out_lped(t,e,r,n){e+=4,n.nost||xygl(t,e,"ped"),n.noen||xygl(t+r+6,e,"pedoff")}function out_8va(t,e,r,n){n.nost?r-=5:(out_XYAB('<text x="X" y="Y" style="font:italic bold 12px serif">8<tspan dy="-4" style="font-size:10px">va</tspan></text>\n',t-8,e),t+=12,r-=12),out_XYAB('<path class="stroke" stroke-dasharray="6,6" d="mX YhF"/>\n',t,e+=6,r),n.noen||out_XYAB('<path class="stroke" d="mX Yv6"/>\n',t+r,e)}function out_8vb(t,e,r,n){n.nost?r-=5:(out_XYAB('<text x="X" y="Y" style="font:italic bold 12px serif">8<tspan dy="-4" style="font-size:10px">vb</tspan></text>\n',t-8,e),t+=4,r-=4),out_XYAB('<path class="stroke" stroke-dasharray="6,6" d="mX YhF"/>\n',t,e,r),n.noen||out_XYAB('<path class="stroke" d="mX Yv-6"/>\n',t+r,e)}function out_15ma(t,e,r,n){n.nost?r-=5:(out_XYAB('<text x="X" y="Y" style="font:italic bold 12px serif">15<tspan dy="-4" style="font-size:10px">ma</tspan></text>\n',t-10,e),t+=20,r-=20),out_XYAB('<path class="stroke" stroke-dasharray="6,6" d="mX YhF"/>\n',t,e+=6,r),n.noen||out_XYAB('<path class="stroke" d="mX Yv6"/>\n',t+r,e)}function out_15mb(t,e,r,n){n.nost?r-=5:(out_XYAB('<text x="X" y="Y" style="font:italic bold 12px serif">15<tspan dy="-4" style="font-size:10px">mb</tspan></text>\n',t-10,e),t+=7,r-=7),out_XYAB('<path class="stroke" stroke-dasharray="6,6" d="mX YhF"/>\n',t,e,r),n.noen||out_XYAB('<path class="stroke" d="mX Yv-6"/>\n',t+r,e)}var deco_val_tb={arp:out_arp,cresc:out_cresc,dim:out_dim,ltr:out_ltr,lped:out_lped,"8va":out_8va,"8vb":out_8vb,"15ma":out_15ma,"15mb":out_15mb};function out_deco_val(t,e,r,n,i){deco_val_tb[r]?deco_val_tb[r](t,e,n,i):error(1,null,"No function for decoration '$1'",r)}function out_glisq(t,e,r){var n=r.start,i=n.x,s=n.y+staff_tb[n.st].y,a=Math.atan2(s-e,t-i),o=a/Math.PI*180,c=(t-i)/Math.cos(a);for(g_open(i,s,o),(c=(c-(i=n.s.dots?13+n.s.xmx:8)-6)/6|0)<1&&(c=1);--c>=0;)xygl(i,0,"ltr"),i+=6;g_close()}function out_gliss(t,e,r){var n=r.start,i=n.x,s=n.y+staff_tb[n.st].y,a=-Math.atan2(e-s,t-i),o=a/Math.PI*180,c=(t-i)/Math.cos(a);g_open(i,s,o),c-=(i=n.s.dots?13+n.s.xmx:8)+8,xypath(i,0),output+="h"+c.toFixed(1)+'" stroke-width="1"/>\n',g_close()}var deco_l_tb={glisq:out_glisq,gliss:out_gliss},par_sy,cur_sy,voice_tb,curvoice,staves_found,vover,tsfirst;function out_deco_long(t,e,r){var n=r.dd.glyph;deco_l_tb[n]?deco_l_tb[n](t,e,r):error(1,null,"No function for decoration '$1'",n)}function tempo_note(t,e){var r,n=identify_note(t,e);switch(n[0]){case C.OVAL:r="";break;case C.EMPTY:r="";break;default:switch(n[2]){case 2:r="";break;case 1:r="";break;default:r=""}}return n[1]&&(r+='<tspan dx=".1em"></tspan>'),r}function tempo_build(t){var e,r,n,i=0,s=[];if(!t.tempo_str){if(cfmt.musicfont.used||get_font("music"),set_font("tempo"),t.tempo_str1&&(s.push(t.tempo_str1),i+=strwh(t.tempo_str1)[0]),t.tempo_notes){for(n=' dy="-.05em"',e=0;e<t.tempo_notes.length;e++)r=tempo_note(t,t.tempo_notes[e]),s.push('<tspan\nclass="'+font_class(cfmt.musicfont)+'" style="font-size:'+(1.3*gene.curfont.size).toFixed(1)+'px"'+n+">"+r+"</tspan>"),i+=(r.length>1?2:1)*gene.curfont.swfac,n="";s.push('<tspan dy=".065em">=</tspan>'),i+=cwidf("="),t.tempo_ca&&(s.push(t.tempo_ca),i+=strwh(t.tempo_ca)[0],t.tempo_ca.length+1),t.tempo?(s.push(t.tempo),i+=strwh(t.tempo.toString())[0]):(r=tempo_note(t,t.new_beat),s.push('<tspan\nclass="'+font_class(cfmt.musicfont)+'" style="font-size:'+(1.3*gene.curfont.size).toFixed(1)+'px" dy="-.05em">'+r+"</tspan>"),i+=(r.length>1?2:1)*gene.curfont.swfac,n="y")}t.tempo_str2&&(n?s.push('<tspan\n\tdy=".065em">'+t.tempo_str2+"</tspan>"):s.push(t.tempo_str2),i+=strwh(t.tempo_str2)[0]),t.tempo_str=s.join(" "),i+=cwidf(" ")*(s.length-1),t.tempo_wh=[i,13],n&&(t.tempo_dy=n)}}function writempo(t,e,r){var n;set_font("tempo"),gene.curfont.box&&(gene.curfont.box=!1,n=e),output+='<text class="'+font_class(gene.curfont)+'" x="',out_sxsy(e,'" y="',r+.2*gene.curfont.size),output+='">'+t.tempo_str+"</text>\n",n&&(gene.curfont.box=!0,bh=gene.curfont.size+4,output+='<rect class="stroke" x="',out_sxsy(n-2,'" y="',r+bh-1),output+='" width="'+(t.tempo_wh[0]+2).toFixed(1)+'" height="'+bh.toFixed(1)+'"/>\n'),t.invis=!0}function vskip(t){posy+=t}function svg_flush(){if(!multicol&&output&&user.img_out&&0!=posy){var t,e,r='<svg xmlns="http://www.w3.org/2000/svg" version="1.1"\n\txmlns:xlink="http://www.w3.org/1999/xlink"\n\tcolor="',n="";if(cfmt.fgcolor?r+=cfmt.fgcolor+'" fill="'+cfmt.fgcolor+'"':r+='black"',r+=' stroke-width=".7"',cfmt.bgcolor&&(r+=' style="background-color: '+cfmt.bgcolor+'"'),r+=' class="'+font_class(e=get_font("music"))+" tune"+tunes.length+'"\n',posy*=cfmt.scale,user.imagesize?r+=user.imagesize+' viewBox="0 0 '+img.width.toFixed(0)+" "+posy.toFixed(0)+'">\n':r+=' width="'+img.width.toFixed(0)+'px" height="'+posy.toFixed(0)+'px">\n',(style||font_style)&&(r+="<style>\n."+font_class(e)+" text,tspan{fill:currentColor}"+font_style+style+"\n</style>\n"),(defs+=fulldefs)&&(r+="<defs>"+defs+"\n</defs>\n"),1!=cfmt.scale&&(r+='<g class="g" transform="scale('+cfmt.scale.toFixed(2)+')">\n',n="</g>\n"),psvg&&psvg.ps_flush(!0),blkdiv>0&&(user.img_out(1==blkdiv?'<div class="nobrk">':'<div class="nobrk newpage">'),blkdiv=-1),user.img_out(r+output+n+"</svg>"),output="",font_style="",cfmt.fullsvg)for(defined_glyph={},t=0;t<font_tb.length;t++)font_tb[t].used=!1;else style="",fulldefs="";defs="",posy=0}}function blk_flush(){svg_flush(),blkdiv<0&&(!parse.state||cfmt.splittune)&&(user.img_out("</div>"),blkdiv=0)}function voice_filter(){var t;function e(t,e){var r,n=new RegExp(e);if(n.test(curvoice.id)||n.test(curvoice.nm))for(r=0;r<t.length;r++)self.do_pscom(t[r])}if(parse.voice_opts)for(t in parse.voice_opts)parse.voice_opts.hasOwnProperty(t)&&e(parse.voice_opts[t],t);if(parse.tune_v_opts)for(t in parse.tune_v_opts)parse.tune_v_opts.hasOwnProperty(t)&&e(parse.tune_v_opts[t],t)}function sym_link(t){t.fname||set_ref(t),parse.last_sym=t,t.prev=curvoice.last_sym,curvoice.last_sym?curvoice.last_sym.next=t:curvoice.sym=t,curvoice.last_sym=t,t.v=curvoice.v,t.p_v=curvoice,t.st=curvoice.cst,t.time=curvoice.time,t.dur&&!t.grace&&(curvoice.time+=t.dur),t.pos=curvoice.pos,curvoice.second&&(t.second=!0),curvoice.floating&&(t.floating=!0),curvoice.eoln&&(t.soln=!0,curvoice.eoln=!1)}function sym_add(t,e){var r,n={type:e,dur:0},i=curvoice;return curvoice=t,sym_link(n),curvoice=i,(r=n.prev)||(r=n.next),r&&(n.fname=r.fname,n.istart=r.istart,n.iend=r.iend),n}Abc.prototype.blk_flush=blk_flush;var w_tb=new Uint8Array([4,1,8,0,3,5,6,9,9,0,9,3,0,7,0,0,0,0]);function sort_all(){var t,e,r,n,i,s,a,o,c,l,u,f=voice_tb.length,$=[],h=[],p=cur_sy;for(e=0;e<f;e++)$.push(voice_tb[e].sym);for(o=f,-1,e=0;e<f;e++)p.voices[e]&&((s=p.voices[e].range)<o&&(o=s),h[s]=e,0);if(e=h[o],tsfirst=a=$[e])for($[e]=tsfirst.next,a.seqst=!0,l=!w_tb[a.type]||tsfirst.type==tsfirst.next;;){if(u&&l)for(p=u,u=null,-1,h=[],e=0;e<f;e++)p.voices[e]&&(h[s=p.voices[e].range]=e,0);for(i=r=1e6,s=0;s<f&&null!=(e=h[s]);s++)!(t=$[e])||t.time>r||(n=w_tb[t.type],t.time<r?(r=t.time,i=n):n<i&&(i=n));if(i>127)break;for(s=0;s<f&&null!=(e=h[s]);s++)if((t=$[e])&&t.time==r&&w_tb[t.type]==i){if(t.type==C.STAVES){for(u=t.sy,o=0;o<f&&null!=h[o];o++);for(c=0;c<f;c++)u.voices[c]&&!p.voices[c]&&(h[o++]=c)}l&&(l=0,t.seqst=!0),t.ts_prev=a,a.ts_next=t,a=t,$[e]=t.next}l=i}}function voice_adj(t){var e,r,n,i;function s(t){var e,r,n,i,s,a,o=t.dur,c=1;for(e=t;e&&(!e.beam_end&&e.next);e=e.next)c++;if(c<=1)delete t.feathered_beam;else{if(r=e,i=o/2,a=o/(c-1),n=t.time,t.feathered_beam>0)for(e=t,s=c-1;e!=r;e=e.next,s--)o=(a*s|0)+i,e.dur=o,e.time=n,n+=o;else for(e=t,s=0;e!=r;e=e.next,s++)o=(a*s|0)+i,e.dur=o,e.time=n,n+=o;e.dur=e.time+e.dur-n,e.time=n}}for((r=glovar.tempo)&&staves_found<=0&&(i=par_sy.top_voice,!(e=voice_tb[i]).sym||e.sym.type==C.TEMPO||e.sym.next&&e.sym.next.type==C.TEMPO||((r=clone(r)).v=i,r.p_v=e,r.st=e.st,r.time=0,r.prev=e.sym,r.next=e.sym.next,r.next&&(r.next.prev=r),e.sym.next=r)),i=0;i<voice_tb.length;i++){if(e=voice_tb[i],!t&&e.sls.length)for(;;){var a=e.sls.shift();if(!a)break;for(n=(r=a.note.s).next;n&&(!n.bar_type||":"!=n.bar_type[0]);n=n.next);n?(r.sls||(r.sls=[]),r.sls.push({ty:a.ty,note:{s:n}})):syntax(1,"Lack of ending slur(s)")}for(r=e.sym;r&&!(r.time>=staves_found);r=r.next);for(;r;r=r.next){switch(r.type){case C.GRACE:if(r.next&&r.next.type==C.BAR&&r.time--,!cfmt.graceword)continue;for(n=r.next;n;n=n.next){switch(n.type){case C.SPACE:continue;case C.NOTE:if(!n.a_ly)break;r.a_ly=n.a_ly,n.a_ly=null}break}continue}r.feathered_beam&&s(r)}}}function dupl_voice(){var t,e,r,n,i,s,a,o,c=voice_tb.length;for(a=0;a<c;a++)if(e=(t=voice_tb[a]).clone){for(t.clone=null,r=t.sym;r&&!(r.time>=staves_found);r=r.next);for(e.clef=clone(t.clef),curvoice=e;r;r=r.next)if(r.type!=C.STAVES){if(n=clone(r),r.notes)for(n.notes=[],o=0;o<=r.nhd;o++)n.notes.push(clone(r.notes[o]));if(sym_link(n),e.second?n.second=!0:delete n.second,e.floating?n.floating=!0:delete n.floating,delete n.a_ly,i=n.extra)for(s=clone(i),n.extra=s,(n=s).v=e.v,n.p_v=e,n.st=e.st,i=i.next;i;i=i.next){if(s=clone(i),i.notes)for(s.notes=[],o=0;o<=i.nhd;o++)s.notes.push(clone(i.notes[o]));n.next=s,s.prev=n,(n=s).v=e.v,n.p_v=e,n.st=e.st}}}}function new_syst(t){var e,r,n={voices:[],staves:[],top_voice:0};if(t)cur_sy=par_sy=n;else{for(r=0;r<voice_tb.length;r++)if(par_sy.voices[r]){e=par_sy.voices[r].st;var i=par_sy.staves[e],s=voice_tb[r];null!=s.staffnonote&&(i.staffnonote=s.staffnonote),s.staffscale&&(i.staffscale=s.staffscale)}for(e=0;e<par_sy.staves.length;e++)n.staves[e]=clone(par_sy.staves[e]),n.staves[e].flags=0;par_sy.next=n,par_sy=n}}function get_map(t){if(t){var e,r,n,i,s,a,o,c=info_split(t);if(c.length<3)syntax(1,not_enough_p);else{if("*"==(a=c[1])[0]||0==a.indexOf("all"))a="all";else if(0==a.indexOf("octave,")||0==a.indexOf("key,")?(o=a[0],a=(a=a.split(",")[1]).replace(/[,']*/,"").toUpperCase()):o="","k"==o)a="k"+ntb.indexOf(a);else{if((s=new scanBuf).buffer=a,!(r=parse_acc_pit(s)))return void syntax(1,"Bad note in %%map");a=o+abc2svg.pab40(r.pit,r.acc).toString()}if((n=maps[c[0]])||(maps[c[0]]=n={}),(i=n[a])||(n[a]=i=[]),c[2]){if(e=2,c[2].indexOf("=")<0){if("*"!=c[2][0]&&((s=new scanBuf).buffer=c[2],i[1]=parse_acc_pit(s)),!c[3])return;e++,c[3].indexOf("=")<0&&(i[0]=c[3].split(","),e++)}for(;e<c.length;e++)switch(c[e]){case"heads=":if(!c[++e]){syntax(1,not_enough_p);break}i[0]=c[e].split(",");break;case"print=":case"play=":if(!c[++e]){syntax(1,not_enough_p);break}(s=new scanBuf).buffer=c[e],r=parse_acc_pit(s),"r"==c[e-1][1]?i[1]=r:i[3]=abc2svg.pab40(r.pit,r.acc);break;case"color=":if(!c[++e]){syntax(1,not_enough_p);break}i[2]=c[e]}}}}}function set_transp(){var t,e,r;if(!curvoice.ckey.k_bagpipe&&!curvoice.ckey.k_drum){if(cfmt.transp&&curvoice.transp&&syntax(0,"Mix of old and new transposition syntaxes"),null==cfmt.transp&&null==curvoice.transp&&null==curvoice.shift||(e=(cfmt.transp||0)+(curvoice.transp||0)+(curvoice.shift||0)),null==curvoice.sndtran&&null==curvoice.sndsh||(r=(curvoice.sndtran||0)+(curvoice.sndsh||0)),null==e){if(null==r)return}else curvoice.vtransp=e;if(is_voice_sig())curvoice.key=t=clone(curvoice.okey);else for(t=curvoice.last_sym;t.type!=C.KEY;)if(!(t=t.prev)){t=curvoice.ckey;break}null!=e&&(t.k_transp=e),null!=r&&(t.k_sndtran=r),curvoice.ckey=clone(t),curvoice.key.k_none&&(t.k_sf=0)}}function note_transp(t,e,r){var n,i,s,a=r.pit,o=r.acc;if(!o&&e.k_a_acc&&(o=e.k_map[(a+19)%7]),s=abc2svg.pab40(a,o)+e.k_transp,r.pit=abc2svg.b40p(s),o||e.k_a_acc||e.k_none){if(n=abc2svg.b40a(s),o)e.k_a_acc&&e.k_map[(r.pit+19)%7]==n&&(n=0),n||(n=3);else if(e.k_none){if(acc_same_pitch(t,r.pit))return}else{if(!e.k_a_acc)return;if(acc_same_pitch(t,r.pit))return;e.k_map[(r.pit+19)%7]&&(n=3)}if((i=r.micro_d)&&o!=n)switch(a=r.micro_n,n){case 3:a>i/2?(a-=i/2,r.micro_n=a,n=o):n=-o;break;case 2:a>i/2?(r.pit+=1,a-=i/2):a+=i/2,n=o,r.micro_n=a;break;case-2:a>=i/2?(r.pit-=1,a-=i/2):a+=i/2,n=o,r.micro_n=a}r.acc=n}}function pit_adj(){for(var t,e,r,n,i,s=voice_tb.length;--s>=0;)if(null!=(e=voice_tb[s]).vtransp)for(e.key.k_transp?key_transp(n=e.key):n=null,r=e.sym;r;){if(!n)for(;r&&(r.type!=C.KEY||!r.k_transp);r=r.next);for(;r;r=r.next){switch(r.type){case C.GRACE:for(i=r.extra;i;i=i.next)for(t=0;t<=i.nhd;t++)note_transp(i,n,i.notes[t]);continue;case C.NOTE:for(t=0;t<=r.nhd;t++)note_transp(r,n,r.notes[t]);continue;case C.KEY:if(n&&(r.k_sf=n.k_sf),key_transp(r),!r.k_transp)break;n=r;default:continue}break}n=null}}function get_transp(t){if("0"==t[0])return 0;if("123456789-+".indexOf(t[0])>=0){var e=parseInt(t);return isNaN(e)||e<-36||e>36?void syntax(1,errs.bad_transp):40*(((e+=36)/12|0)-3)+("b"==t.slice(-1)?abc2svg.ifb40:abc2svg.isb40)[e%12]}}function generate(t){var e,r,n;if(parse.tp&&(syntax(1,"No end of tuplet"),(e=parse.tps)&&delete e.tp,delete parse.tp),vover&&(syntax(1,"No end of voice overlay"),get_vover(vover.bar?"|":")")),voice_tb.length&&(voice_adj(),dupl_voice(),sort_all(),tsfirst&&(self.set_bar_num(),pit_adj(),info.P&&(tsfirst.parts=info.P),user.get_abcmodel&&user.get_abcmodel(tsfirst,voice_tb,abc2svg.sym_name,info),user.img_out&&self.output_music(),tunes.push([tsfirst,voice_tb,info]),t))){for(voice_tb=Object.create(voice_tb),r=0;r<voice_tb.length;r++)(n=voice_tb[r]).time=0,n.sym=n.last_sym=null,delete n.have_ly,n.sls=[],n.hy_st=0,delete n.bar_start;staves_found=0}}function key_transp(t){if(!t.k_a_acc&&!t.k_none){var e,r=(t.k_b40+200+t.k_transp)%40;(e=abc2svg.b40k[r]-r)&&(t.k_transp>0?t.k_transp+=e:t.k_transp-=e,r+=e),t.k_b40=r;var n=abc2svg.b40sf[r];t.k_old_sf=t.k_sf,t.k_sf=n,t.k_map=abc2svg.keys[n+7]}}function acc_same_pitch(t,e){var r,n=t.time;for(t=t.prev;t;t=t.prev)switch(t.type){case C.BAR:if(t.time<n)return;for(;;){if(!(t=t.prev))return;if(t.type==C.NOTE){if(t.time+t.dur==n)break;return}if(t.time<n)return}for(r=0;r<=t.nhd;r++)if(t.notes[r].pit==e&&t.notes[r].tie_ty)return t.notes[r].acc;return;case C.NOTE:for(r=0;r<=t.nhd;r++)if(t.notes[r].pit==e)return t.notes[r].acc}}function get_staves(t,e){var r,n,i,s,a,o,c,l,u=parse_staves(e);if(u){voice_tb.length&&(voice_adj(!0),dupl_voice());var f=0,$=!0;for(o=0;o<voice_tb.length;o++)(n=voice_tb[o]).time>f&&(f=n.time),n.sym&&($=!1);if($||0==f&&staves_found<0)par_sy.staves=[],par_sy.voices=[];else{for(o=0;o<par_sy.voices.length;o++)if(par_sy.voices[o]){curvoice=voice_tb[o];break}curvoice.time=f,sym_link(r={type:C.STAVES,dur:0}),par_sy.nstaff=nstaff,new_syst(),r.sy=par_sy}for(staves_found=f,o=0;o<voice_tb.length;o++)delete(n=voice_tb[o]).second,delete n.ignore,delete n.floating;for(l=0,s=0;s<u.length;s++){if((n=new_voice(u[s][0])).time=f,o=n.v,0==s&&(par_sy.top_voice=n.v),par_sy.voices[o]){for(i=clone(n),par_sy.voices[voice_tb.length]=clone(par_sy.voices[o]),o=voice_tb.length,i.v=o,i.sym=i.last_sym=null,i.time=f,voice_tb.push(i),delete i.clone;n.clone;)n=n.clone;n.clone=i,n=i}else par_sy.voices[o]={};u[s][0]=n,par_sy.voices[o].range=l++}if("t"==t[1])for(s=0;s<u.length;s++)(a=u[s][1])&(OPEN_BRACE|OPEN_BRACE2)&&(a&(OPEN_BRACE|CLOSE_BRACE))!=(OPEN_BRACE|CLOSE_BRACE)&&(a&(OPEN_BRACE2|CLOSE_BRACE2))!=(OPEN_BRACE2|CLOSE_BRACE2)&&0==u[s+1][1]&&(a&OPEN_PARENTH||u[s+2][1]&OPEN_PARENTH||(u[s+2][1]&(CLOSE_BRACE|CLOSE_BRACE2)?u[s+1][1]|=FL_VOICE:0==u[s+2][1]&&u[s+3][1]&(CLOSE_BRACE|CLOSE_BRACE2)&&(u[s][1]|=OPEN_PARENTH,u[s+1][1]|=CLOSE_PARENTH,u[s+2][1]|=OPEN_PARENTH,u[s+3][1]|=CLOSE_PARENTH)));for(c=-1,s=0;s<u.length;s++)if(((a=u[s][1])&(OPEN_PARENTH|CLOSE_PARENTH))==(OPEN_PARENTH|CLOSE_PARENTH)&&(a&=~(OPEN_PARENTH|CLOSE_PARENTH),u[s][1]=a),n=u[s][0],a&FL_VOICE?(n.floating=!0,n.second=!0):(c++,par_sy.staves[c]||(par_sy.staves[c]={stafflines:"|||||",staffscale:1}),par_sy.staves[c].flags=0),o=n.v,n.st=n.cst=par_sy.voices[o].st=c,par_sy.staves[c].flags|=a,a&OPEN_PARENTH){for(i=n;s<u.length-1&&(o=(n=u[++s][0]).v,u[s][1]&MASTER_VOICE?(i.second=!0,i=n):n.second=!0,n.st=n.cst=par_sy.voices[o].st=c,!(u[s][1]&CLOSE_PARENTH)););par_sy.staves[c].flags|=u[s][1]}if(c<0&&(c=0),par_sy.nstaff=nstaff=c,"c"==t[1])for(c=0;c<nstaff;c++)par_sy.staves[c].flags^=STOP_BAR;for(o=0;o<voice_tb.length;o++)n=voice_tb[o],par_sy.voices[o]&&(par_sy.voices[o].second=n.second,!((c=n.st)>0)||n.norepbra||par_sy.staves[c-1].flags&STOP_BAR||(n.norepbra=!0));curvoice=parse.state>=2?voice_tb[par_sy.top_voice]:null}}function clone_voice(t){var e,r;for(e=0;e<voice_tb.length;e++)if((r=voice_tb[e]).id==t)return r;return(r=clone(curvoice)).v=voice_tb.length,r.id=t,r.sym=r.last_sym=null,r.key=clone(curvoice.key),delete r.nm,delete r.snm,delete r.new_name,delete r.lyric_restart,delete r.lyric_cont,delete r.ly_a_h,delete r.sym_restart,delete r.sym_cont,delete r.have_ly,delete r.tie_s,voice_tb.push(r),r}function get_vover(t){var e,r,n,i,s,a,o,c;parse.line;if("|"==t||")"==t)return curvoice.last_note?(curvoice.last_note.beam_end=!0,vover?(curvoice.time!=vover.p_voice.time&&(syntax(1,"Wrong duration in voice overlay"),curvoice.time>vover.p_voice.time&&(vover.p_voice.time=curvoice.time)),curvoice=vover.p_voice,void(vover=null)):void syntax(1,"Erroneous end of voice overlay")):void syntax(1,errs.nonote_vo);if("("==t)return vover?void syntax(1,"Voice overlay already started"):void(vover={p_voice:curvoice,time:curvoice.time});if(curvoice.last_note){if(curvoice.last_note.beam_end=!0,!(e=curvoice.voice_down)){e=clone_voice(curvoice.id+"o"),curvoice.voice_down=e,e.time=0,e.second=!0,o=e.v,par_sy.voices[o]={st:curvoice.st,second:!0};var l=null!=curvoice.clone?1:0;for(n=par_sy.voices[curvoice.v].range,a=0;a<par_sy.voices.length;a++)par_sy.voices[a]&&par_sy.voices[a].range>n&&(par_sy.voices[a].range+=l+1);par_sy.voices[o].range=n+1,l&&((r=clone_voice(e.id+"c")).second=!0,c=r.v,par_sy.voices[c]={second:!0,range:n+2},e.clone=r)}if(e.ulen=curvoice.ulen,e.dur_fact=curvoice.dur_fact,curvoice.uscale&&(e.uscale=curvoice.uscale),vover)curvoice!=vover.p_voice&&curvoice.time!=vover.p_voice.time&&(syntax(1,"Wrong duration in voice overlay"),curvoice.time>vover.p_voice.time&&(vover.p_voice.time=curvoice.time));else{for(vover={bar:!0,p_voice:curvoice},s=e.time,i=curvoice.last_sym;!(i.type==C.BAR||i.time<=s);i=i.prev);vover.time=i.time}e.time=vover.time,curvoice=e,vover.bar&&sym_link({type:C.BAR,bar_type:t,dur:0,multi:0})}else syntax(1,errs.nonote_vo)}function is_voice_sig(){var t;if(0!=curvoice.time)return!1;for(t=curvoice.last_sym;t;t=t.prev)if(0!=w_tb[t.type])return!1;return!0}function get_clef(t){if(is_voice_sig())curvoice.clef=t;else{sym_link(t),t.clef_small=!0;var e=t.prev;e&&e.type==C.BAR&&":"!=e.bar_type[0]&&(t.next=e,t.prev=e.prev,t.prev&&(t.prev.next=t),e.prev=t,e.next=null,curvoice.last_sym=e,t.soln&&(delete t.soln,curvoice.eoln=!0))}}function get_key(t){var e,r,n,i,s=new_key(t),a=s[0];switch(s=s[1],parse.state){case 1:for(null!=a.k_sf||a.k_a_acc||(a.k_sf=0,a.k_none=!0,a.k_map=abc2svg.keys[7]),e=0;e<voice_tb.length;e++)(r=voice_tb[e]).key=clone(a),r.okey=clone(a),r.ckey=clone(a);return parse.ckey=a,s.length&&memo_kv_parm("*",s),glovar.ulen||(glovar.ulen=C.BLEN/8),void(parse.state=2);case 2:goto_tune(!0)}if(s.length&&set_kv_parm(s),curvoice.ckey.k_bagpipe||curvoice.ckey.k_drum||null==cfmt.transp&&null==curvoice.transp&&null==curvoice.shift||(n=(cfmt.transp||0)+(curvoice.transp||0)+(curvoice.shift||0)),null==curvoice.sndtran&&null==curvoice.sndsh||(i=(curvoice.sndtran||0)+(curvoice.sndsh||0)),null==a.k_sf){if(!a.k_a_acc&&null==n){if(null==i)return;a.k_play=!0}a.k_sf=curvoice.okey.k_sf}curvoice.okey=clone(a),null!=n&&(curvoice.vtransp=n,a.k_transp=n),null!=i&&(a.k_sndtran=i),a.k_old_sf=curvoice.ckey.k_sf,a.k_b40||(a.k_b40=curvoice.ckey.k_b40),curvoice.ckey=a,is_voice_sig()?(curvoice.key=clone(a),a.k_none&&(curvoice.key.k_sf=0)):sym_link(a)}function new_voice(t){var e,r,n,i=voice_tb.length;if(1==i&&voice_tb[0].default&&(delete voice_tb[0].default,0==voice_tb[0].time))return(e=voice_tb[0]).id=t,cfmt.transp&&parse.state>=2&&(n=curvoice,curvoice=e,set_transp(),curvoice=n),e;for(r=0;r<i;r++)if((e=voice_tb[r]).id==t)return e;return e={v:r,id:t,time:0,new:!0,pos:{dyn:0,gch:0,gst:0,orn:0,stm:0,voc:0,vol:0},scale:1,ulen:glovar.ulen,dur_fact:1,key:clone(parse.ckey),ckey:clone(parse.ckey),okey:clone(parse.ckey),meter:clone(glovar.meter),wmeasure:glovar.meter.wmeasure,clef:{type:C.CLEF,clef_auto:!0,clef_type:"a",time:0},acc:[],sls:[],hy_st:0},voice_tb.push(e),e}function init_tune(){nstaff=-1,voice_tb=[],curvoice=null,new_syst(!0),staves_found=-1,gene={},a_de=[]}function do_cloning(t){for(var e,r,n=parse.file,i=parse.eol+1,s=i;;){if((r=n.indexOf("\n",s))<0){r=0;break}if(/%.*|\n.*|.:.|\[.:/.test(n.slice(r+1,r+4)))break;s=r+1}for(include++,tosvg(parse.fname,n,i,r),e=0;e<t.length;e++)get_voice(t[e]),tosvg(parse.fname,n,i,r);include--}function get_voice(t){var e,r,n=info_split(t),i=n.shift();if(i){if(i.indexOf(",")>0&&(i=(r=i.split(",")).shift()),parse.state<2)return n.length&&memo_kv_parm(i,n),void("*"!=i&&1==parse.state&&(curvoice=new_voice(i)));"*"!=i?(curvoice=new_voice(i),set_kv_parm(n),2==parse.state&&goto_tune(),set_transp(),e=curvoice.v,curvoice.new&&(delete curvoice.new,staves_found<0&&(curvoice.st=curvoice.cst=++nstaff,par_sy.nstaff=nstaff,par_sy.voices[e]={st:nstaff,range:e},par_sy.staves[nstaff]={stafflines:curvoice.stafflines||"|||||",staffscale:1})),!curvoice.filtered&&par_sy.voices[e]&&(parse.voice_opts||parse.tune_v_opts)&&(curvoice.filtered=!0,voice_filter()),r&&do_cloning(r)):syntax(1,"Cannot have V:* in tune body")}}function goto_tune(t){var e,r,n={type:C.STAVES,dur:0,sy:par_sy};for(set_page(),write_heading(),reset_gen(),glovar.new_nbar?(gene.nbar=glovar.new_nbar,glovar.new_nbar=0):gene.nbar=1,parse.state=3,voice_tb.length?curvoice||(curvoice=voice_tb[staves_found<0?0:par_sy.top_voice]):(get_voice("1"),curvoice.clef.istart=curvoice.key.istart,curvoice.clef.iend=curvoice.key.iend,curvoice.default=!0),curvoice.init||t||(set_kv_parm([]),set_transp()),e=0;e<voice_tb.length;e++)(r=voice_tb[e]).ulen=glovar.ulen,r.ckey.k_bagpipe&&!r.pos.stm&&(r.pos=clone(r.pos),r.pos.stm=C.SL_BELOW);if(staves_found<0){for(nstaff=voice_tb.length-1,e=0;e<=nstaff;e++)delete(r=voice_tb[e]).new,r.st=r.cst=e,par_sy.voices[e]={st:e,range:e},par_sy.staves[e]={stafflines:r.stafflines||"|||||",staffscale:1};par_sy.nstaff=nstaff}r=curvoice,curvoice=voice_tb[par_sy.top_voice],sym_link(n),curvoice=r}function get_sym(t,e){var r,n,i,s,a;if(!curvoice.ignore){if(e){if(!(r=curvoice.sym_cont))return void syntax(1,"+: symbol line without music")}else if(curvoice.sym_restart?(curvoice.sym_start=r=curvoice.sym_restart,curvoice.sym_restart=null):r=curvoice.sym_start,r||(r=curvoice.sym),!r)return void syntax(1,"s: without music");for(i=0;;){for(;" "==t[i]||"\t"==t[i];)i++;if(!(n=t[i]))break;switch(n){case"|":for(;r&&r.type!=C.BAR;)r=r.next;if(!r)return void syntax(1,"Not enough measure bars for symbol line");r=r.next,i++;continue;case"!":case'"':if(s=++i,(i=t.indexOf(n,s))<0){syntax(1,"!"==n?"No end of decoration":"No end of guitar chord"),i=t.length;continue}a=t.slice(s-1,i+1);break;case"*":break;default:if((a=n.charCodeAt(0))<128&&(a=char_tb[a]).length>1&&("!"==a[0]||'"'==a[0])){n=a[0];break}syntax(1,errs.bad_char,n)}for(;r&&(r.type!=C.NOTE||r.grace);)r=r.next;if(!r)return void syntax(1,"Too many elements in symbol line");switch(n){default:break;case"!":deco_cnv([a.slice(1,-1)],r,r.prev);break;case'"':a_gch=r.a_gch,parse_gchord(a),a_gch&&self.gch_build(r)}r=r.next,i++}curvoice.lyric_cont=r}}function get_lyrics(t,e){var r,n,i,s,a,o;if(!curvoice.ignore){if(curvoice.pos.voc!=C.SL_HIDDEN&&(curvoice.have_ly=!0),e){if(!(r=curvoice.lyric_cont))return void syntax(1,"+: lyric without music")}else if(set_font("vocal"),curvoice.lyric_restart?(curvoice.lyric_start=r=curvoice.lyric_restart,curvoice.lyric_restart=null,curvoice.lyric_line=0):(curvoice.lyric_line++,r=curvoice.lyric_start),r||(r=curvoice.sym),!r)return void syntax(1,"w: without music");for(i=t,s=0;;){for(;" "==i[s]||"\t"==i[s];)s++;if(!i[s])break;switch(a=parse.istart+s+2,i[s]){case"|":for(;r&&r.type!=C.BAR;)r=r.next;if(!r)return void syntax(1,"Not enough measure bars for lyric line");r=r.next,s++;continue;case"-":n="-\n";break;case"_":n="_\n";break;case"*":n="";break;default:if("\\"==i[s]&&s==i.length-1)return void(curvoice.lyric_cont=r);for(n="";i[s];){switch(i[s]){case"_":case"*":case"|":s--;case" ":case"\t":break;case"~":n+="",s++;continue;case"-":n+="\n";break;case"\\":n+=i[++s],s++;continue;default:n+=i[s++];continue}break}}for(;r&&(r.type!=C.NOTE||r.grace);)r=r.next;if(!r)return void syntax(1,"Too many words in lyric line");n&&r.pos.voc!=C.SL_HIDDEN&&(n.match(/^\$\d/)&&("0"==n[1]?set_font("vocal"):set_font("u"+n[1]),n=n.slice(2)),o={t:n,font:gene.curfont,wh:strwh(n),istart:a,iend:a+n.length},r.a_ly||(r.a_ly=[]),r.a_ly[curvoice.lyric_line]=o),r=r.next,s++}curvoice.lyric_cont=r}}function ly_width(t,e){var r,n,i,s,a,o,c,l,u,f,$,h=t.a_ly;for(s=0,c=0;c<h.length;c++)if(r=h[c])if("-\n"!=($=r.t)&&"_\n"!=$){for(o=r.wh[0],i=r.font.swfac,a=o+2*cwid(" ")*i,t.type==C.GRACE?f=t.wl:$[0]>="0"&&$[0]<="9"&&$.length>2||":"==$[1]||"("==$[0]||")"==$[0]?("("==$[0]?n=cwid("(")*i:(l=$.indexOf(""),set_font(r.font),n=l>0?strwh($.slice(0,l))[0]:.2*o),(f=.4*(o-n+2*cwid(" ")*i))>20&&(f=20),f+=n,r.t[0]>="0"&&r.t[0]<="9"&&f>s&&(s=f)):(f=.4*a)>20&&(f=20),r.shift=f,e<f&&(e=f),a-=f,f=2*cwid(" ")*i,u=t.next;u;u=u.next){switch(u.type){case C.NOTE:case C.REST:if(u.a_ly&&u.a_ly[c]){if("-\n"!=u.a_ly[c].t&&"_\n"!=u.a_ly[c].t)break;a-=f}else a-=9;if(a<=0)break;continue;case C.CLEF:case C.METER:case C.KEY:a-=10;continue;default:a-=5}break}a>t.wr&&(t.wr=a)}else r.shift=0;if(s>0)for(c=0;c<h.length;c++)(r=h[c])&&r.t[0]>="0"&&r.t[0]<="9"&&(r.shift=s);return e}function draw_lyric_line(t,e,r){var n,i,s,a,o,c,l,u,f,$;for(t.hy_st&1<<e&&(l=!0,t.hy_st&=~(1<<e)),a=t.sym;a.type==C.CLEF||a.type==C.KEY||a.type==C.METER;a=a.next);for(i=a.prev?a.prev.x:tsfirst.x,f=0;a;a=a.next)if(c=a.a_ly?a.a_ly[e]:null)c.font!=gene.curfont&&(gene.curfont=c.font),n=c.t,s=c.wh[0],$=c.shift,l&&("_\n"==n?n="-\n":"-\n"!=n&&(out_hyph(i,r,a.x-$-i),l=!1,i=a.x+a.wr)),u&&"_\n"!=n&&(out_wln(i+3,r,f-i+3),u=!1,i=a.x+a.wr),"-\n"!=n&&"_\n"!=n?(f=a.x-$,"\n"==n.slice(-1)&&(n=n.slice(0,-1),l=!0),(user.anno_start||user.anno_stop)&&(o={st:a.st,istart:c.istart,iend:c.iend,x:f,y:r,ymn:r,ymx:r+gene.curfont.size,wl:0,wr:s},anno_start(o,"lyrics")),xy_str(f,r,n,null,null,c.wh),anno_stop(o,"lyrics"),i=f+s):(0==f&&i>a.x-18&&(i=a.x-18),"-"==n[0]?l=!0:u=!0,f=a.x-$);else switch(a.type){case C.REST:case C.MREST:u&&(out_wln(i+3,r,f-i),u=!1,i=a.x+a.wr)}for(l&&(l=!1,(f=realwidth-10)<i+10&&(f=i+10),out_hyph(i,r,f-i),cfmt.hyphencont&&(t.hy_st|=1<<e)),t.s_next;a;a=a.next)if(a.type==C.NOTE){if(!a.a_ly)break;(c=a.a_ly[e])&&"_\n"==c.t&&(u=!0,(f=realwidth-15)<i+12&&(f=i+12));break}u&&(out_wln(i+3,r,f-i+3),u=!1)}function draw_lyrics(t,e,r,n,i){var s,a,o=staff_tb[t.st].staffscale;if(set_font("vocal"),i>0){for(n>-cfmt.vocalspace&&(n=-cfmt.vocalspace),n*=o,s=0;s<e;s++)draw_lyric_line(t,s,n-=1.1*r[s]);return(n-r[s-1]/6)/o}for(n<(a=staff_tb[t.st].topbar+cfmt.vocalspace)&&(n=a),n*=o,s=e;--s>=0;)draw_lyric_line(t,s,n),n+=1.1*r[s];return n/o}function draw_all_lyrics(){var t,e,r,n,i,s,a,o,c,l,u=new Array(nstaff+1),f=voice_tb.length,$=new Array(f),h=new Array(f),p=new Array(f),d=new Array(f),_=0,m=0,y=-1;for(r=0;r<f;r++)if((t=voice_tb[r]).sym){if(t.st!=y&&(_=0,m=0,y=t.st),n=0,t.have_ly){for($[r]||($[r]=[]),e=t.sym;e;e=e.next)if(c=e.a_ly){for(s=e.x,o=10,i=0;i<c.length;i++)if(l=c[i]){s-=l.shift,o=l.wh[0];break}for(_<(a=y_get(t.st,1,s,o))&&(_=a),m>(a=y_get(t.st,0,s,o))&&(m=a);n<c.length;)$[r][n++]=0;for(i=0;i<c.length;i++)(l=c[i])&&(!$[r][i]||l.font.size>$[r][i])&&($[r][i]=l.font.size)}}else _<(a=y_get(t.st,1,0,realwidth))&&(_=a),m>(a=y_get(t.st,0,0,realwidth))&&(m=a);u[y]||(u[y]={}),u[y].top=_,u[y].bot=m,h[r]=n,0!=n&&(t.pos.voc?p[r]=t.pos.voc==C.SL_ABOVE:voice_tb[r+1]&&voice_tb[r+1].st==y&&voice_tb[r+1].have_ly?p[r]=!0:p[r]=!1,p[r]?u[y].a=!0:u[y].b=!0)}for(i=0,r=0;r<f;r++)(t=voice_tb[r]).sym&&t.have_ly&&(p[r]?d[i++]=r:(set_dscale(y=t.st,!0),h[r]>0&&(u[y].bot=draw_lyrics(t,h[r],$[r],u[y].bot,1))));for(;--i>=0;)r=d[i],set_dscale(y=(t=voice_tb[r]).st,!0),u[y].top=draw_lyrics(t,h[r],$[r],u[y].top,-1);for(r=0;r<f;r++)if((t=voice_tb[r]).sym){if(u[y=t.st].a)for(_=u[y].top+2,e=t.sym.next;e;e=e.next)e.a_ly&&y_set(y,1,e.x-2,10,_);if(u[y].b)if(m=u[y].bot-2,h[t.v]>0)for(e=t.sym.next;e;e=e.next)e.a_ly&&y_set(y,0,e.x-2,10,m);else y_set(y,0,0,realwidth,m)}}function parse_gchord(t){var e,r,n,i,s,a,o,c,l=get_font("annotation"),u=l.size,f=parse.line;function $(){for(var t="";;){if(e=r[a++],"1234567890.-".indexOf(e)<0)return parseFloat(t);t+=e}}if(o=parse.bol+f.index,t.length>1)r=t.slice(1,-1),c=o+1;else{for(r="";;){if(!(e=f.next_char()))return void syntax(1,"No end of guitar chord");if('"'==e)break;"\\"==e&&(r+=e,e=f.next_char()),r+=e}c=parse.bol+f.index+1}if(curvoice.pos.gch!=C.SL_HIDDEN)for(l.box&&(u+=3),a=0,t="g";e=r[a];){switch(n={text:"",istart:o,iend:c,font:l},e){case"@":t=e,a++,i=$(),","!=e?(syntax(1,"',' lacking in annotation '@x,y'"),s=0):(s=$()," "!=e&&a--),n.x=i,n.y=s-u/2;break;case"^":case"_":case"<":case">":a++,t=e;break;default:switch(t){case"g":n.font=get_font("gchord");break;case"@":n.x=i,s-=u,n.y=s-u/2}}for(n.type=t;e=r[a];){switch(e){case"\\":if(!(e=r[++a])||"n"==e)break;n.text+="\\";default:n.text+=e,a++;continue;case"&":for(;;){switch(n.text+=e,e=r[++a]){default:continue;case";":case void 0:case"\\":}break}if(";"==e){a++,n.text+=e;continue}break;case";":}a++;break}a_gch||(a_gch=[]),a_gch.push(n)}}Abc.prototype.set_bar_num=function(){var t,e,r,n,i,s,a=cur_sy.top_voice,o=voice_tb[a].meter.wmeasure,c=gene.nbar;for(t=tsfirst;;t=t.ts_next){if(!t)return;switch(t.type){case C.METER:o=t.wmeasure;case C.CLEF:case C.KEY:case C.STBRK:continue;case C.BAR:if(t.bar_num){gene.nbar=t.bar_num;break}t.text&&!cfmt.contbarnb&&("1"==t.text[0]?c=gene.nbar:(gene.nbar=c,t.bar_num=gene.nbar))}break}if(n=t.time+o,0==t.time)for(e=t.ts_next;e;e=e.ts_next)if(e.type==C.BAR&&e.time){e.time<n&&(n=(t=e).time+o);break}for(i=gene.nbar;t;t=t.ts_next)switch(t.type){case C.METER:o=t.wmeasure,t.time<n&&(n=t.time+o);break;case C.MREST:for(i+=t.nmes-1;t.ts_next&&t.ts_next.type!=C.BAR;)t=t.ts_next;break;case C.BAR:if(t.time<n){t.text&&"1"==t.text[0]&&(c=i,s=n-t.time);break}r=t.time,e=t;do{if(e.dur)break;if(e.type==C.BAR&&e.text)break;e=e.next}while(e&&e.time==r);if(t.bar_num?i=t.bar_num:i++,e&&e.type==C.BAR&&e.text)if("1"==e.text[0])s=0,c=i;else if(cfmt.contbarnb||(i=c),s){cfmt.contbarnb&&i--,n=r+s;break}for(t.bar_num=i,n=r+o;t.ts_next&&!t.ts_next.seqst;)t=t.ts_next}cfmt.measurenb<0&&(gene.nbar=i)},Abc.prototype.do_pscom=function(t){var e,r,n,i,s,a,o,c;if((!curvoice||!curvoice.ignore)&&(i=t.match(/(\w|-)+/))){if(i=i[0]," lock"==(s=t.replace(i,"").trim()).slice(-5))fmt_lock[i]=!0,s=s.slice(0,-5).trim();else if(fmt_lock[i])return;switch(i){case"center":return parse.state>=2?((n=new_block("text")).text=s,void(n.opt="c")):void write_text(s,"c");case"clef":return void(parse.state>=2&&(2==parse.state&&goto_tune(),(n=new_clef(s))&&get_clef(n)));case"deco":return void deco_add(s);case"linebreak":return void set_linebreak(s);case"map":return void get_map(s);case"maxsysstaffsep":if(3==parse.state)return r=get_unit(s),isNaN(r)?void syntax(1,errs.bad_val,"%%maxsysstaffsep"):void(par_sy.voices[curvoice.v].maxsep=r);break;case"multicol":if(parse.state>=2){2==parse.state&&goto_tune(),curvoice=voice_tb[0],n=new_block("mc_"+s);break}switch(s){case"start":multicol={maxy:0,lmarg:cfmt.leftmargin,rmarg:cfmt.rightmargin};break;case"new":if(!multicol){syntax(1,"%%multicol new without start");break}posy>multicol.maxy&&(multicol.maxy=posy),cfmt.leftmargin=multicol.lmarg,cfmt.rightmargin=multicol.rmarg,img.chg=!0,set_page(),posy=0;break;case"end":if(!multicol){syntax(1,"%%multicol end without start");break}posy<multicol.maxy&&(posy=multicol.maxy),cfmt.leftmargin=multicol.lmarg,cfmt.rightmargin=multicol.rmarg,multicol=void 0,blk_flush(),img.chg=!0,set_page();break;default:syntax(1,"Unknown keyword '$1' in %%multicol",s)}return;case"ottava":if(3!=parse.state){if(2!=parse.state)return;goto_tune()}return a=parseInt(s),isNaN(a)||a<-2||a>2?void syntax(1,errs.bad_val,"%%ottava"):(glovar.ottava=!0,void parse.ottava.push(a));case"repbra":return void(parse.state>=2&&(2==parse.state&&goto_tune(),curvoice.norepbra=!get_bool(s)));case"repeat":if(3!=parse.state)return;if(!curvoice.last_sym)return void syntax(1,"%%repeat cannot start a tune");if(s.length){if(c=s.split(/\s+/),a=parseInt(c[0]),o=parseInt(c[1]),isNaN(a)||a<1||curvoice.last_sym.type==C.BAR&&a>2)return void syntax(1,"Incorrect 1st value in %%repeat");if(isNaN(o))o=1;else if(o<1)return void syntax(1,"Incorrect 2nd value in %%repeat")}else a=1,o=1;return parse.repeat_n=curvoice.last_sym.type==C.BAR?a:-a,void(parse.repeat_k=o);case"sep":var l,u,f,$;return set_page(),$=img.width-img.lm-img.rm,e=l=u=0,s&&(e=get_unit((f=s.split(/\s+/))[0]),f[1]&&(l=get_unit(f[1]),f[2]&&(u=get_unit(f[2]))),isNaN(e)||isNaN(l)||isNaN(u))?void syntax(1,errs.bad_val,"%%sep"):(e<1&&(e=14),l<1&&(l=e),u<1&&(u=90),parse.state>=2?((n=new_block(i)).x=($-u)/2/cfmt.scale,n.l=u/cfmt.scale,n.sk1=e,void(n.sk2=l)):(vskip(e),output+='<path class="stroke"\n\td="M',out_sxsy(($-u)/2/cfmt.scale," ",0),output+="h"+(u/cfmt.scale).toFixed(1)+'"/>\n',vskip(l),void blk_flush()));case"setbarnb":if(r=parseInt(s),isNaN(r)||r<1){syntax(1,"Bad %%setbarnb value");break}return 2==parse.state&&goto_tune(),void(glovar.new_nbar=r);case"staff":if(3!=parse.state){if(2!=parse.state)return;goto_tune()}return r=parseInt(s),isNaN(r)?void syntax(1,"Bad %%staff value '$1'",s):(h="+"==s[0]||"-"==s[0]?curvoice.cst+r:r-1)<0||h>nstaff?void syntax(1,"Bad %%staff number $1 (cur $2, max $3)",h,curvoice.cst,nstaff):(delete curvoice.floating,void(curvoice.cst=h));var h;case"staffbreak":if(3!=parse.state){if(2!=parse.state)return;goto_tune()}if(n={type:C.STBRK,dur:0},"f"==s.slice(-1)&&(n.stbrk_forced=!0,s=s.replace(/\sf$/,"")),s){if(r=get_unit(s),isNaN(r))return void syntax(1,errs.bad_val,"%%staffbreak");n.xmx=r}else n.xmx=14;return void sym_link(n);case"stafflines":case"staffscale":case"staffnonote":return void set_v_param(i,s);case"staves":case"score":if(0==parse.state)return;return void(parse.scores&&parse.scores.length>0?get_staves((i=(t=parse.scores.shift()).match(/([^\s]+)\s*(.*)/))[1],i[2]):get_staves(i,s));case"sysstaffsep":if(3==parse.state)return r=get_unit(s),isNaN(r)?void syntax(1,errs.bad_val,"%%sysstaffsep"):void(par_sy.voices[curvoice.v].sep=r);break;case"text":return parse.state>=2?((n=new_block(i)).text=s,void(n.opt=cfmt.textoption)):void write_text(s,cfmt.textoption);case"transpose":if(cfmt.sound)return;switch(r=get_transp(s),parse.state){case 0:cfmt.transp=0;case 1:case 2:return void(null==r?syntax(1,errs.bad_transp):cfmt.transp=(cfmt.transp||0)+r)}if(null==r&&null==(r=get_interval(s)))return void syntax(1,errs.bad_transp);for(n=curvoice.last_sym;n;n=n.prev){switch(n.type){case C.NOTE:(n=clone(curvoice.okey)).k_old_sf=curvoice.ckey.k_sf,sym_link(n);break;case C.KEY:break;default:continue}break}return void(curvoice.transp=r);case"tune":return;case"user":return void set_user(s);case"voicecolor":if(3!=parse.state){if(2!=parse.state)return;goto_tune()}return void(curvoice.color=s);case"vskip":return r=get_unit(s),isNaN(r)?void syntax(1,errs.bad_val,"%%vskip"):r<0?void syntax(1,"%%vskip cannot be negative"):parse.state>=2?void((n=new_block(i)).sk=r):void vskip(r);case"newpage":case"leftmargin":case"rightmargin":case"pagescale":case"pagewidth":case"printmargin":case"scale":case"staffwidth":if(parse.state>=2)return void((n=new_block(i)).param=s);if("newpage"==i)return blk_flush(),void(blkdiv=2)}self.set_format(i,s)}},Abc.prototype.do_begin_end=function(t,e,r){var n,i,s,a;switch(t){case"js":js_inject(r);break;case"ml":parse.state>=2?(a=new_block(t)).text=r:(blk_flush(),user.img_out&&user.img_out(r));break;case"svg":for(i=0;!((n=r.indexOf("<style",i))<0);){if(n=r.indexOf(">",n),(i=r.indexOf("</style>",n))<0){syntax(1,"No </style> in %%beginsvg sequence");break}style+=r.slice(n+1,i).replace(/\s+$/,"")}for(i=0;!((n=r.indexOf("<defs>\n",i))<0);){if((i=r.indexOf("</defs>",n))<0){syntax(1,"No </defs> in %%beginsvg sequence");break}defs_add(r.slice(n+6,i))}break;case"text":if((s=get_textopt(e))||(s=cfmt.textoption),r.indexOf("\\")>=0&&(r=cnv_escape(r)),parse.state>=2){(a=new_block(t)).text=r,a.opt=s;break}write_text(r,s)}};var note_names="CDEFGAB",acc_name=["bb","b","","#","##"],hook_init;function gch_tr1(t,e){var r,n,i,s,a,o,c=t.split("/");for(r=0;r<c.length;r++)if(!((n=(t=c[r]).search(/[ABCDEFG]/))<0)){for(a=n+1,s=0;"#"==t[a];)s++,a++;for(;"b"==t[a];)s--,a++;i=note_names.indexOf(t[n])+16,o=(abc2svg.pab40(i,s)+e+200)%40,o=abc2svg.b40k[o],c[r]=t.slice(0,n)+note_names[abc2svg.b40_p[o]]+acc_name[abc2svg.b40_a[o]+2]+t.slice(a)}return c.join("/")}function gch_transp(t){for(var e,r=t.a_gch.length;--r>=0;)"g"==(e=t.a_gch[r]).type&&(e.text=gch_tr1(e.text,curvoice.vtransp))}function set_hooks(){var t=abc2svg.modules.hooks,e=abc2svg.modules.g_hooks;function r(t){for(var e=0;e<t.length;e++)t[e](self)}hook_init?t.length&&(r(t),e.push.apply(e,t),abc2svg.modules.hooks=[]):(t.length&&(e.push.apply(e,t),abc2svg.modules.hooks=[]),r(e),hook_init=!0)}Abc.prototype.gch_build=function(t){var e,r,n,i,s=curvoice.pos.gch==C.SL_BELOW?-1:1,a=0,o=0,c=0,l=0;for(t.a_gch=a_gch,a_gch=null,curvoice.vtransp&&gch_transp(t),i=0;i<t.a_gch.length;i++){if("g"==(e=t.a_gch[i]).type)cfmt.chordnames&&(e.otext=e.text,e.text=e.text.replace(/A|B|C|D|E|F|G/g,function(t){return cfmt.chordnames[t]}),"H"==cfmt.chordnames.B&&(e.text=e.text.replace(/Hb/g,"Bb"))),e.text=e.text.replace(/##|#|=|bb|b|  /g,function(t){switch(t){case"##":return"&#x1d12a;";case"#":return"";case"=":return"";case"b":return"";case"  ":return" "}return"&#x1d12b;"});else if("@"==e.type&&!user.anno_start&&!user.anno_stop){e.wh=[0,0];continue}switch(set_font(e.font),r=strwh(e.text),e.wh=r,e.font.box&&(r[1]+=4),e.type){case"@":break;case"^":(n=.4*r[0])>8&&(n=8),e.x=-n,a-=r[1],e.y=a;break;case"_":(n=.4*r[0])>8&&(n=8),e.x=-n,o-=r[1],e.y=o;break;case"<":e.x=-(r[0]+6),c-=r[1],e.y=c+r[1]/2;break;case">":e.x=6,l-=r[1],e.y=l+r[1]/2;break;default:(n=.4*r[0])>8&&(n=8),e.x=-n,s<0?(o-=r[1],e.y=o):(a-=r[1],e.y=a)}}for(c/=2,l/=2,i=0;i<t.a_gch.length;i++)switch((e=t.a_gch[i]).type){case"^":e.y-=a;break;case"<":e.y-=c;break;case">":e.y-=l;break;case"g":s>0&&(e.y-=a)}},Abc.prototype.draw_gchord=function(t,e,r){var n,i,s,a,o,c,l,u,f,$,h=0,p=t.dur?3*((t.notes[t.nhd].pit+t.notes[0].pit>>1)-18):12;for(s=0;s<t.a_gch.length;s++)(n=t.a_gch[s]).wh[0]>h&&(h=n.wh[0]);for((f=y_get(t.st,1,t.x-3,h))<r&&(f=r),($=y_get(t.st,0,t.x-3,h))>e&&($=e),set_dscale(t.st),s=0;s<t.a_gch.length;s++){switch(use_font((n=t.a_gch[s]).font),set_font(n.font),u=n.font.size,l=n.font.box?2:0,h=n.wh[0],a=t.x+n.x,i=n.text,n.type){case"_":o=n.y+$,y_set(t.st,0,a,h,o-l);break;case"^":o=n.y+f+l,y_set(t.st,1,a,h,o+u+l);break;case"<":t.notes[0].acc&&(a-=t.notes[0].shac),o=n.y+p-u/2;break;case">":t.xmx&&(a+=t.xmx),t.dots&&(a+=1.5+3.5*t.dots),o=n.y+p-u/2;break;default:n.y>=0?(o=n.y+f+l,y_set(t.st,!0,a,h,o+u+l)):(o=n.y+$,y_set(t.st,!1,a,h,o-l));break;case"@":(o=n.y+p)>0?(c=o+u)>staff_tb[t.st].ann_top&&(staff_tb[t.st].ann_top=c):o<staff_tb[t.st].ann_bot&&(staff_tb[t.st].ann_bot=o)}user.anno_start&&user.anno_start("annot",n.istart,n.iend,a-2,o+u+2,h+4,u+4,t),xy_str(a,o,i,null,null,n.wh),user.anno_stop&&user.anno_stop("annot",n.istart,n.iend,a-2,o+u+2,h+4,u+4,t)}},init_tune(),Abc.prototype.add_style=function(t){style+=t},Abc.prototype.cfmt=function(){return cfmt},Abc.prototype.clone=clone,Abc.prototype.deco_cnv=deco_cnv,Abc.prototype.draw_note=draw_note,Abc.prototype.errs=errs,Abc.prototype.font_class=font_class,Abc.prototype.gch_tr1=gch_tr1,Abc.prototype.get_a_gch=function(){return a_gch},Abc.prototype.get_bool=get_bool,Abc.prototype.get_cur_sy=function(){return cur_sy},Abc.prototype.get_curvoice=function(){return curvoice},Abc.prototype.get_delta_tb=function(){return delta_tb},Abc.prototype.get_decos=function(){return decos},Abc.prototype.get_font=get_font,Abc.prototype.get_font_style=function(){return font_style},Abc.prototype.get_glyphs=function(){return glyphs},Abc.prototype.get_img=function(){return img},Abc.prototype.get_maps=function(){return maps},Abc.prototype.get_multi=function(){return multicol},Abc.prototype.get_newpage=function(){if(block.newpage)return block.newpage=!1,!0},Abc.prototype.get_posy=function(){var t=posy;return posy=0,t},Abc.prototype.get_staff_tb=function(){return staff_tb},Abc.prototype.get_top_v=function(){return par_sy.top_voice},Abc.prototype.get_tsfirst=function(){return tsfirst},Abc.prototype.get_unit=get_unit,Abc.prototype.get_voice_tb=function(){return voice_tb},Abc.prototype.goto_tune=goto_tune,Abc.prototype.info=function(){return info},Abc.prototype.new_block=new_block,Abc.prototype.out_arp=out_arp,Abc.prototype.out_deco_str=out_deco_str,Abc.prototype.out_deco_val=out_deco_val,Abc.prototype.out_ltr=out_ltr,Abc.prototype.param_set_font=param_set_font,Abc.prototype.parse=parse,Abc.prototype.psdeco=empty_function,Abc.prototype.psxygl=empty_function,Abc.prototype.set_cur_sy=function(t){cur_sy=t},Abc.prototype.set_dscale=set_dscale,Abc.prototype.set_font=set_font,Abc.prototype.set_hl=set_hl,Abc.prototype.set_scale=set_scale,Abc.prototype.set_tsfirst=function(t){tsfirst=t},Abc.prototype.set_v_param=set_v_param,Abc.prototype.strwh=strwh,Abc.prototype.stv_g=function(){return stv_g},Abc.prototype.svg_flush=svg_flush,Abc.prototype.syntax=syntax,Abc.prototype.tunes=tunes,Abc.prototype.unlksym=unlksym,Abc.prototype.use_font=use_font,Abc.prototype.xy_str=xy_str,Abc.prototype.xygl=xygl};var Abc=abc2svg.Abc;function AbcJSON(t){var e=Array((t||2)+1).join(" ");AbcJSON.prototype.gen_json=function(t,r,n,i){var s,a,o,c,l,u,f=e+e,$=f+e,h=$+e,p={next:!0,prev:!0,ts_next:!0,ts_prev:!0,extra:!0,note:!0,p_v:!0,s:!0,sn:!0,tie_s:!0,dd_st:!0,sym:!0,last_sym:!0,last_note:!0,lyric_restart:!0,sym_restart:!0,rep_p:!0,rep_v:!0,rep_s:!0},d=[];function _(t,r,n){var i,a,o,c=t+e;if(p[r])switch(r){case"extra":for(s+=u+t+'"extra": [',u="\n",a=n;a;a=a.next)_(c,null,a);s+="\n"+t+"]";break;case"tie_s":s+=u+t+'"ti1": true'}else{switch(s+=u+t,r&&(s+='"'+r.toString()+'": '),typeof n){case"undefined":s+="null";break;case"object":if(!n){s+="null";break}if(d.indexOf(n)>=0){s+="!!! to_json: loop in '"+r+"' !!!";break}if(d.push(n),Array.isArray(n)){if(0==n.length){s+="[]";break}for(u="[\n",o=n.length,i=0;i<o;i++)_(c,null,n[i]);s+="\n"+t+"]"}else{for(i in u="{\n",n)n.hasOwnProperty(i)&&_(c,i,n[i]);s+="\n"+t+"}"}d.pop();break;default:s+=JSON.stringify(n)}u=",\n"}}for(s="",u="{\n",_(e,"music_types",n),u=",\n"+e+'"music_type_ids": {\n',o=n.length,a=0;a<o;a++)n[a]&&(s+=u+f+'"'+n[a]+'": '+a,u=",\n");for(u="\n"+e+"},\n",_(e,"info",i),s+=",\n"+e+'"voices": [',c=0,u="\n";;){for(a in u+=f+"{\n"+$+'"voice_properties": {\n',r[c])r[c].hasOwnProperty(a)&&_(h,a,r[c][a]);if(s+="\n"+$+"},\n"+$+'"symbols": [',l=r[c].sym){for(u="\n";l;l=l.next)_(h,null,l);s+="\n"+$+"]\n"+f+"}"}else s+="]\n"+$+"}";if(u=",\n",!r[++c])break}return s+"\n"+e+"]\n}\n"}}function AbcMIDI(){var t=abc2svg.C;return{add:function(e,r){for(var n,i=r[0].temper,s=r.length;--s>=0;)(n=r[s]).sym&&(n.key.k_bagpipe&&(i=new Float32Array([2.37,1.37,1.49,1.41,1.53,2.35,1.35,1.19,1.39,1.51,1.62,1.55])),e=n.clef,a(n.sym,n.key.k_sndtran||0,e.clef_octave&&!e.clef_oct_transp?e.clef_octave/7*40:0));function a(e,r,n){var s,a,o=r+n;function c(t){var e=abc2svg.b40m(t.b40+o);i&&(!t.acc||t.acc|0==t.acc)&&(e+=i[e%12]),t.midi=e}for(;e;){switch(e.type){case t.CLEF:n=e.clef_octave&&!e.clef_oct_transp?e.clef_octave/7*40:0,o=n+r;break;case t.KEY:null!=e.k_sndtran&&(r=e.k_sndtran,o=n+r);break;case t.GRACE:for(a=e.extra;a;a=a.next)for(s=0;s<=a.nhd;s++)c(a.notes[s]);break;case t.NOTE:for(s=0;s<=e.nhd;s++)c(e.notes[s])}e=e.next}}}}}function AbcPlay(t){var e,r,n,i=t,s={},a=ToAudio(),o={clear:a.clear,add:a.add,set_sft:c,set_sfu:function(t){if(null==t)return i.sfu;i.sfu=t},set_speed:function(t){if(null==t)return i.speed;i.new_speed=t},set_vol:function(t){if(null==t)return i.gain;i.gain=t,n&&n.set_vol&&n.set_vol(t)},play:function(t,e,n){s.istart=t,s.i_iend=e,s.a_e=n,r?r.get_outputs(l):l()},stop:c};function c(){}function l(t){var a;if(t||(t=[]),(a=e.get_outputs())&&Array.prototype.push.apply(t,a),0!=t.length){if(1==t.length)a=0;else{a=-1;for(var c="Use",l=0;l<t.length;l++)c+="\n "+l+": "+t[l];var u=window.prompt(c,"0");if(u&&(a=Number(u),(isNaN(a)||a<0||a>=t.length)&&(a=-1)),!u||a<0)return void(i.onend&&i.onend())}n="sf2"==t[a]?e:r,o.play=n.play,o.stop=n.stop,n.set_output&&n.set_output(t[a]),o.play(s.istart,s.i_iend,s.a_e),s={}}else i.onend&&i.onend()}return i.gain=.7,i.speed=1,function(){try{if(!localStorage)return}catch(t){return}var t=localStorage.getItem("sfu");t&&(i.sfu=t),(t=localStorage.getItem("volume"))&&(i.gain=Number(t))}(),"function"==typeof Midi5&&(r=Midi5(i)),"function"==typeof Audio5&&(e=Audio5(i)),o}function ToAudio(){var t,e,r,n,i=abc2svg.C,s=AbcMIDI();return{clear:function(){var e=t;return t=null,e},add:function(a,o){var c,l,u,f,$,h,p,d,_=[],m=a;function y(){var e,r,n,i;for(t.push(new Float32Array([0,0,-1,121,0,1,0])),e=0;e<o.length;e++){if(i=(r=o[e]).instr||0,r.midictl){for(n=r.sym;n&&!n.dur;n=n.next);if(!n)continue;r.midictl.forEach(function(r,i){t.push(new Float32Array([n.istart,0,-1,i,r,1,e]))})}_[e]=i}}function g(t,e,r){var s,a,o=t.v,c=t.time+t.dur;for(t=t.ts_next;;t=t.ts_next){if(!t)return r;if(t==h){for(t=p;t&&t.v!=o;)t=t.ts_next;if(!t)return r;c=t.time}if(t.time!=c)return r;if(t.type==i.NOTE&&t.v==o)break}for(s=t.notes.length;--s>=0;)if((a=t.notes[s]).b40==e)return a.ti2=!0,r+=t.dur/n,a.tie_ty?g(t,e,r):r;return r}function v(t){var r,s,a,o,c,l=t.next;if(t.sappo)o=i.BLEN/16;else if(l&&l.type==i.NOTE||!t.prev||t.prev.type!=i.NOTE){for(l.ts_prev.ts_next=l.ts_next,l.ts_next.ts_prev=l.ts_prev,c=l.ts_next;c;c=c.ts_next)if(c.time!=l.time){l.ts_next=c,l.ts_prev=c.ts_prev,l.ts_prev.ts_next=l,c.ts_prev=l;break}o=(o=l.dur/12)&o-1==0?l.dur/2:l.dur/3,l.time+=o,l.dur-=o}else o=t.prev.dur/2;for(s=0,r=t.extra;r;r=r.next)r.type==i.NOTE&&s++;for(o/=s*n,a=e,r=t.extra;r;r=r.next)r.type==i.NOTE&&(b(r,a,o),a+=o)}function b(e,r,n){for(var i=0;i<=e.nhd;i++){var s=e.notes[i];s.ti2||t.push(new Float32Array([e.istart,r,_[e.v],s.midi,s.tie_ty?g(e,s.b40,n):n,1,e.v]))}}for(s.add(a,o),t?m.time<r&&(r=m.time):(t=[],r=e=0,n=i.BLEN/4*120/60),y();m;){if(m.tempo){for(f=0,l=m.tempo_notes.length,c=0;c<l;c++)f+=m.tempo_notes[c];n=f*m.tempo/60}switch((u=m.time-r)>0&&(e+=u/n,r=m.time),m.type){case i.BAR:if(!m.seqst)break;if(m==h)r=(m=p).time;else if(":"==m.bar_type[0]){p=m,h||(h=m),$?(m=$,n=d):(m=a,y()),r=m.time;break}":"==m.bar_type[m.bar_type.length-1]?($=m,h=null,d=n):m.text&&"1"==m.text[0]&&(h=m);break;case i.GRACE:0==m.time&&0==r&&(u=0,m.sappo?u=i.BLEN/16:m.next&&m.next.type==i.NOTE||(u=f/2),r-=u),v(m);break;case i.REST:case i.NOTE:f=m.dur,m.next&&m.next.type==i.GRACE&&(u=0,m.next.sappo?u=i.BLEN/16:m.next.next&&m.next.next.type==i.NOTE||(u=f/2),m.next.time-=u,f-=u),f/=n,m.type==i.NOTE?b(m,e,f):t.push(new Float32Array([m.istart,e,0,0,f,0,m.v]));break;case i.BLOCK:switch(m.subtype){case"midictl":t.push(new Float32Array([m.istart,e,-1,m.ctrl,m.val,1,m.v]));break;case"midiprog":_[m.v]=m.instr}}m=m.ts_next}}}}"object"==typeof module&&"object"==typeof exports&&(exports.abc2svg=abc2svg,exports.Abc=Abc),abc2svg.loadjs||(abc2svg.loadjs=function(t,e,r){r&&r()}),abc2svg.modules={ambitus:{fn:"ambitus-1.js"},begingrid:{fn:"grid3-1.js"},beginps:{fn:"psvg-1.js"},break:{fn:"break-1.js"},capo:{fn:"capo-1.js"},clip:{fn:"clip-1.js"},clairnote:{fn:"clair-1.js"},voicecombine:{fn:"combine-1.js"},diagram:{fn:"diag-1.js"},equalbars:{fn:"equalbars-1.js"},grid:{fn:"grid-1.js"},grid2:{fn:"grid2-1.js"},jianpu:{fn:"jianpu-1.js"},MIDI:{fn:"MIDI-1.js"},pageheight:{fn:"page-1.js"},percmap:{fn:"perc-1.js"},soloffs:{fn:"soloffs-1.js"},sth:{fn:"sth-1.js"},temperament:{fn:"temper-1.js"},nreq:0,hooks:[],g_hooks:[],load:function(t,e,r){function n(){0==--abc2svg.modules.nreq&&abc2svg.modules.cbf()}var i,s,a=this.nreq,o=t.match(/(^|\n)(%%|I:).+?\b/g);if(!o)return!0;for(this.cbf=e||function(){},this.errmsg=r||("object"==typeof user&&user.errmsg?user.errmsg:"function"==typeof abc2svg.printErr?abc2svg.printErr:"function"==typeof alert?function(t){alert(t)}:"object"==typeof console?console.log:function(){}),s=0;s<o.length;s++)(i=abc2svg.modules[o[s].replace(/\n?(%%|I:)/,"")])&&!i.loaded&&(i.loaded=!0,this.nreq++,abc2svg.loadjs(i.fn,n,function(){var t;t=i.fn,abc2svg.modules.errmsg("Error loading the module "+t),n()}));return this.nreq==a}},abc2svg.version="1.20.10",abc2svg.vdate="","object"==typeof module&&"object"==typeof exports&&(exports.AbcPlay=AbcPlay),"object"==typeof module&&"object"==typeof exports&&(exports.ToAudio=ToAudio);var abcsf2=[],root,factory;function Audio5(t){var e,r,n,i,s,a,o=t,c=function(){},l=function(){},u=[],f=[],$=0,h=[];o.instr_load||(o.instr_load=function(t,e,r){abc2svg.loadjs(o.sfu+"/"+t+".js",function(){e(function(t){var e,r,n,i,s=t.length,a=0;for(n=3*s/4,"="==t[s-1]&&("="==t[s-2]&&n--,n--,s-=4),i=new Uint8Array(n),e=0;e<s;e+=4)r=(p[t[e]]<<18)+(p[t[e+1]]<<12)+(p[t[e+2]]<<6)+p[t[e+3]],i[a++]=r>>16&255,i[a++]=r>>8&255,i[a++]=255&r;return s!=t.length&&(r=(p[t[e]]<<18)+(p[t[e+1]]<<12)+(p[t[e+2]]<<6)+p[t[e+3]],i[a++]=r>>16&255,a<n&&(i[a++]=r>>8&255)),i}(abcsf2[t]))},r)});var p=[];function d(t,e){var r,n=t.getChannelData(0);for(r=0;r<e.length;r++)n[r]=e[r]/196608}function _(t,n){$++,o.instr_load(t,function(e){var i=new sf2.Parser(e);i.parse(),function(t,e){var n,i,s,a,o,c,l=t.getInstruments()[0].info;for(f[e]=[],n=0;n<l.length;n++)if((s=l[n].generator).sampleID){i=s.sampleID.amount,o=t.sampleHeader[i].sampleRate,c=t.sample[i],(a={attack:Math.pow(2,(s.attackVolEnv?s.attackVolEnv.amount:-12e3)/1200),hold:Math.pow(2,(s.holdVolEnv?s.holdVolEnv.amount:-12e3)/1200),decay:Math.pow(2,(s.decayVolEnv?s.decayVolEnv.amount:-12e3)/1200)/3,sustain:s.sustainVolEnv?s.sustainVolEnv.amount/1e3:0,buffer:r.createBuffer(1,c.length,o)}).hold+=a.attack,a.decay+=a.hold,a.sustain>=.4?a.sustain=.01:a.sustain=1-a.sustain/.4,d(a.buffer,c),s.sampleModes&&1&s.sampleModes.amount&&(a.loopStart=t.sampleHeader[i].startLoop/o,a.loopEnd=t.sampleHeader[i].endLoop/o);var $=(s.scaleTuning?s.scaleTuning.amount:100)/100,h=(s.coarseTune?s.coarseTune.amount:0)+(s.fineTune?s.fineTune.amount:0)/100+t.sampleHeader[i].pitchCorrection/100-(s.overridingRootKey?s.overridingRootKey.amount:t.sampleHeader[i].originalPitch);for(j=s.keyRange.lo;j<=s.keyRange.hi;j++)f[e][j]=Math.pow(Math.pow(2,1/12),(j+h)*$),u[e][j]=a}}(i,t),0==--$&&g(n)},function(){e("could not find the instrument "+(t/128|0).toString()+"-"+(t%128).toString()),0==--$&&g(n)})}function m(t,e,i){var s,a=t[2],o=0|t[3],c=u[a][o],l=r.createBufferSource();if(c){if(l.buffer=c.buffer,c.loopStart&&(l.loop=!0,l.loopStart=c.loopStart,l.loopEnd=c.loopEnd),l.detune){var $=100*t[3]%100;$&&(l.detune.value=$)}l.playbackRate.value=f[a][o],s=r.createGain(),c.hold<.002?s.gain.setValueAtTime(1,e):(c.attack<.002?s.gain.setValueAtTime(1,e):(s.gain.setValueAtTime(0,e),s.gain.linearRampToValueAtTime(1,e+c.attack)),s.gain.setValueAtTime(1,e+c.hold)),s.gain.exponentialRampToValueAtTime(c.sustain,e+c.decay),l.connect(s),s.connect(n),l.start(e),l.stop(e+i)}}function y(t){var e,n,u,f,$;if(t&&(n=t[i]),!n||i>=s)c();else{for(o.new_speed&&(a=r.currentTime-(r.currentTime-a)*o.speed/o.new_speed,o.speed=o.new_speed,o.new_speed=0),h=[],u=(e=n[1]/o.speed)+3;;){if($=n[4]/o.speed,n[2]>=0){0!=n[5]&&m(n,e+a,$);var p=n[0];f=1e3*(e+a-r.currentTime),h.push(setTimeout(l,f,p,!0)),setTimeout(l,f+1e3*$,p,!1)}if(!(n=t[++i])||i>=s)return void setTimeout(c,1e3*(e+a-r.currentTime+$));if((e=n[1]/o.speed)>u)break}h.push(setTimeout(y,1e3*(e+a-r.currentTime)-300,t))}}function g(t){0!=s?0==$&&(n.connect(r.destination),a=r.currentTime+.2-t[i][1]*o.speed,y(t)):c()}return function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=t.length,r=0;r<e;r++)p[t[r]]=r;p["="]=0}(),o.sfu||(o.sfu="Scc1t2"),{get_outputs:function(){return window.AudioContext||window.webkitAudioContext?["sf2"]:null},play:function(t,a,f){var $,h;!f||t>=f.length?c():(o.onend&&(c=o.onend),o.onnote&&(l=o.onnote),e=o.errmsg||alert,n||((r=o.ac)||(o.ac=r=new(window.AudioContext||window.webkitAudioContext),/iPad|iPhone|iPod/.test(navigator.userAgent)&&($=r.createBuffer(1,1,22050),(h=r.createBufferSource()).buffer=$,h.connect(r.destination),h.noteOn(0))),(n=r.createGain()).gain.value=o.gain),s=a,i=t,function(t){var e,r,n,a,o=[];for(e=i;e<s&&(r=t[e]);e++)if(n=r[2],null==o[a=r[6]]&&(o[a]=0),n<0)switch(r[3]){case 0:o[a]=16383&o[a]|r[4]<<14;break;case 32:o[a]=2080895&o[a]|r[4]<<7;break;case 121:o=[]}else o[a]&&(n&=127,n|=o[a],r[2]=n),u[n]||(u[n]=[],_(n,t))}(f),g(f))},stop:function(){s=0,h.forEach(function(t){clearTimeout(t)}),y(),n&&(n.disconnect(),n=null)},set_vol:function(t){n&&(n.gain.value=t)}}}function AbcMIDI(){var t=abc2svg.C;return{add:function(e,r){for(var n,i=r[0].temper,s=r.length;--s>=0;)(n=r[s]).sym&&(n.key.k_bagpipe&&(i=new Float32Array([2.37,1.37,1.49,1.41,1.53,2.35,1.35,1.19,1.39,1.51,1.62,1.55])),e=n.clef,a(n.sym,n.key.k_sndtran||0,e.clef_octave&&!e.clef_oct_transp?e.clef_octave/7*40:0));function a(e,r,n){var s,a,o=r+n;function c(t){var e=abc2svg.b40m(t.b40+o);i&&(!t.acc||t.acc|0==t.acc)&&(e+=i[e%12]),t.midi=e}for(;e;){switch(e.type){case t.CLEF:n=e.clef_octave&&!e.clef_oct_transp?e.clef_octave/7*40:0,o=n+r;break;case t.KEY:null!=e.k_sndtran&&(r=e.k_sndtran,o=n+r);break;case t.GRACE:for(a=e.extra;a;a=a.next)for(s=0;s<=a.nhd;s++)c(a.notes[s]);break;case t.NOTE:for(s=0;s<=e.nhd;s++)c(e.notes[s])}e=e.next}}}}}function Midi5(t){var e,r,n,i,s,a=t,o=function(){},c=function(){},l=[],u=[],f=[];function $(t,e,n){var i=0|t[3],s=t[2],a=15&t[6],o=100*t[3]%100;128==u[a]&&(a=9),s!=l[a]&&(null==l[a]&&r.send(new Uint8Array([176+a,121,0])),l[a]=s,r.send(new Uint8Array([192+a,127&s]))),o&&Midi5.ma.sysexEnabled&&r.send(new Uint8Array([240,127,127,8,2,127&s,1,i,i,o/.78125,0,247]),e),r.send(new Uint8Array([144+a,i,127]),e),r.send(new Uint8Array([128+a,i,0]),e+n-20)}function h(t){var e,l,p,d,_,m;if(t&&(l=t[n]),!r||n>=i||!l)o();else{for(a.new_speed&&(s=window-performance.now()-(window.performance.now()-s)*a.speed/a.new_speed,a.speed=a.new_speed,a.new_speed=0),f=[],p=(e=l[1]/a.speed*1e3)+3e3;;){if(_=l[4]/a.speed*1e3,l[2]>=0)0!=l[5]&&$(l,e+s,_),d=e+s-window.performance.now(),f.push(setTimeout(c,d,l[0],!0)),setTimeout(c,d+_,l[0],!1);else switch(m=15&l[6],r.send(new Uint8Array([176+m,l[3],l[4]]),e+s),null==u[m]&&(u[m]=0),l[3]){case 0:u[m]=127&u[m]|l[4]<<7;break;case 32:u[m]=16256&u[m]|l[4];break;case 121:u=[]}if(!(l=t[++n])||n>=i)return void setTimeout(o,e+s-window.performance.now()+_);if((e=l[1]/a.speed*1e3)>p)break}f.push(setTimeout(h,e+s-window.performance.now()-300,t))}}function p(t){var r,n,i=[];if(Midi5.ma=t,t&&t.outputs.size>0)for(n=t.outputs.values();(r=n.next())&&!r.done;)i.push(r.value.name);e(i)}return{get_outputs:function(t){navigator.requestMIDIAccess?(e=t,navigator.requestMIDIAccess({sysex:!0}).then(p,function(t){navigator.requestMIDIAccess().then(p,function(t){e()})})):t()},set_output:function(t){var e,n;if(Midi5.ma)for(n=Midi5.ma.outputs.values();(e=n.next())&&!e.done;)if(e.value.name==t){r=e.value;break}},play:function(t,e,r){!r||t>=r.length?o():(a.onend&&(o=a.onend),a.onnote&&(c=a.onnote),i=e,n=t,l=[],s=window.performance.now()+200-r[n][1]*a.speed*1e3,h(r))},stop:function(){i=0,f.forEach(function(t){clearTimeout(t)}),h(),r&&r.clear&&r.clear()}}}function ToAudio(){return{add:function(t,e){var r,n,i,s,a,o,c=abc2svg.C,l=0,u=0,f=c.BLEN/4*120/60,$=t,h=[];function p(t){var e=t.v;switch(t.subtype){case"midictl":switch(t.ctrl){case 0:h[e]=16383&h[e]|t.val<<14;break;case 32:h[e]=2080895&h[e]|t.val<<7}break;case"midiprog":h[e]=-128&h[e]|t.instr}}function d(t){var e,r,n,i,s=t.next;for(t.sappo?i=c.BLEN/16:s&&s.type==c.NOTE||!t.prev||t.prev.type!=c.NOTE?(i=(i=s.dur/12)&i-1?s.dur/3:s.dur/2,s.time+=i,s.dur-=i):i=t.prev.dur/2,r=0,e=t.extra;e;e=e.next)r++;for(i/=r*f,n=l,e=t.extra;e;e=e.next)e.ptim=n,e.pdur=i,e.instr=h[t.v],n+=i}function _(t){var e,r=0,n=t.tempo_notes.length;for(e=0;e<n;e++)r+=t.tempo_notes[e];return r*t.tempo/60}function m(t,e,n){var i;for(e=e.match(/[1-8]-[2-9]|[1-9,.]|[^\s]+$/g);i=e.shift();)if("-"==i[1])for(r=i[0];r<=i[2];r++)t[r]=n;else i>="1"&&i<="9"?t[Number(i)]=n:","!=i&&t.push(n)}for(!function(t,e){var r,n=e[0].temper,i=e.length;function s(t,e,r){var i,s,a=e+r;function o(t){var e=abc2svg.b40m(t.b40+a);n&&(!t.acc||t.acc|0==t.acc)&&(e+=n[e%12]),t.midi=e}for(;t;){switch(t.type){case c.CLEF:r=t.clef_octave&&!t.clef_oct_transp?t.clef_octave/7*40:0,a=r+e;break;case c.KEY:null!=t.k_sndtran&&(e=t.k_sndtran,a=r+e);break;case c.GRACE:for(s=t.extra;s;s=s.next)for(i=0;i<=s.nhd;i++)o(s.notes[i]);break;case c.NOTE:for(i=0;i<=t.nhd;i++)o(t.notes[i])}t=t.next}}for(;--i>=0;)(r=e[i]).sym&&(r.key.k_bagpipe&&!n&&(n=new Float32Array([2.37,1.37,1.49,1.41,1.53,2.35,1.35,1.19,1.39,1.51,1.62,1.55])),t=r.clef,s(r.sym,r.key.k_sndtran||0,t.clef_octave&&!t.clef_oct_transp?t.clef_octave/7*40:0))}(t,e),$=t,a=f;t;)if(t.noplay)t=t.ts_next;else{switch((n=t.time-u)>0&&(l+=n/f,u=t.time),t.ptim=l,s=t.v,null==h[s]&&(h[s]=e[s].instr||0),t.type){case c.BAR:for(t.text&&o&&(m(o,t.text,t),f=a),":"==t.bar_type[0]&&(t.rep_p=$,o&&(t.rep_v=o)),":"==t.bar_type.slice(-1)?($=t,a=f,o=null):t.text&&"1"==t.text[0]&&!o&&(t.rep_s=o=[null],m(o,t.text,t),a=f);t.ts_next&&t.ts_next.type==c.BAR;)(t=t.ts_next).ptim=l;break;case c.BLOCK:p(t);break;case c.GRACE:0==t.time&&0==u&&(n=0,t.sappo?n=c.BLEN/16:t.next&&t.next.type==c.NOTE||(n=i/2),u-=n),d(t);break;case c.REST:case c.NOTE:i=t.dur,t.next&&t.next.type==c.GRACE&&(n=0,t.next.sappo?n=c.BLEN/16:t.next.next&&t.next.next.type==c.NOTE||(n=i/2),t.next.time-=n,i-=n),i/=f,t.pdur=i,t.instr=h[s];break;case c.TEMPO:t.tempo&&(f=_(t))}t=t.ts_next}}}}if(root=this,factory=function(t){"use strict";var e=t;return e.Parser=function(t,e){e=e||{},this.input=t,this.parserOptions=e.parserOptions},e.Parser.prototype.parse=function(){var t,r=new e.Riff.Parser(this.input,this.parserOptions);if(r.parse(),1!==r.chunkList.length)throw new Error("wrong chunk length");if(null===(t=r.getChunk(0)))throw new Error("chunk not found");this.parseRiffChunk(t),this.input=null},e.Parser.prototype.parseRiffChunk=function(t){var r,n,i=this.input,s=t.offset;if("RIFF"!==t.type)throw new Error("invalid chunk type:"+t.type);if("sfbk"!==(n=String.fromCharCode(i[s++],i[s++],i[s++],i[s++])))throw new Error("invalid signature:"+n);if((r=new e.Riff.Parser(i,{index:s,length:t.size-4})).parse(),3!==r.getNumberOfChunks())throw new Error("invalid sfbk structure");this.parseInfoList(r.getChunk(0)),this.parseSdtaList(r.getChunk(1)),this.parsePdtaList(r.getChunk(2))},e.Parser.prototype.parseInfoList=function(t){var r,n=this.input,i=t.offset;if("LIST"!==t.type)throw new Error("invalid chunk type:"+t.type);if("INFO"!==(r=String.fromCharCode(n[i++],n[i++],n[i++],n[i++])))throw new Error("invalid signature:"+r);new e.Riff.Parser(n,{index:i,length:t.size-4}).parse()},e.Parser.prototype.parseSdtaList=function(t){var r,n,i=this.input,s=t.offset;if("LIST"!==t.type)throw new Error("invalid chunk type:"+t.type);if("sdta"!==(n=String.fromCharCode(i[s++],i[s++],i[s++],i[s++])))throw new Error("invalid signature:"+n);if((r=new e.Riff.Parser(i,{index:s,length:t.size-4})).parse(),1!==r.chunkList.length)throw new Error("TODO");this.samplingData=r.getChunk(0)},e.Parser.prototype.parsePdtaList=function(t){var r,n,i=this.input,s=t.offset;if("LIST"!==t.type)throw new Error("invalid chunk type:"+t.type);if("pdta"!==(n=String.fromCharCode(i[s++],i[s++],i[s++],i[s++])))throw new Error("invalid signature:"+n);if((r=new e.Riff.Parser(i,{index:s,length:t.size-4})).parse(),9!==r.getNumberOfChunks())throw new Error("invalid pdta chunk");this.parsePhdr(r.getChunk(0)),this.parsePbag(r.getChunk(1)),this.parsePmod(r.getChunk(2)),this.parsePgen(r.getChunk(3)),this.parseInst(r.getChunk(4)),this.parseIbag(r.getChunk(5)),this.parseImod(r.getChunk(6)),this.parseIgen(r.getChunk(7)),this.parseShdr(r.getChunk(8))},e.Parser.prototype.parsePhdr=function(t){var e=this.input,r=t.offset,n=this.presetHeader=[],i=t.offset+t.size;if("phdr"!==t.type)throw new Error("invalid chunk type:"+t.type);for(;r<i;)n.push({presetName:String.fromCharCode.apply(null,e.subarray(r,r+=20)),preset:e[r++]|e[r++]<<8,bank:e[r++]|e[r++]<<8,presetBagIndex:e[r++]|e[r++]<<8,library:(e[r++]|e[r++]<<8|e[r++]<<16|e[r++]<<24)>>>0,genre:(e[r++]|e[r++]<<8|e[r++]<<16|e[r++]<<24)>>>0,morphology:(e[r++]|e[r++]<<8|e[r++]<<16|e[r++]<<24)>>>0})},e.Parser.prototype.parsePbag=function(t){var e=this.input,r=t.offset,n=this.presetZone=[],i=t.offset+t.size;if("pbag"!==t.type)throw new Error("invalid chunk type:"+t.type);for(;r<i;)n.push({presetGeneratorIndex:e[r++]|e[r++]<<8,presetModulatorIndex:e[r++]|e[r++]<<8})},e.Parser.prototype.parsePmod=function(t){if("pmod"!==t.type)throw new Error("invalid chunk type:"+t.type);this.presetZoneModulator=this.parseModulator(t)},e.Parser.prototype.parsePgen=function(t){if("pgen"!==t.type)throw new Error("invalid chunk type:"+t.type);this.presetZoneGenerator=this.parseGenerator(t)},e.Parser.prototype.parseInst=function(t){var e=this.input,r=t.offset,n=this.instrument=[],i=t.offset+t.size;if("inst"!==t.type)throw new Error("invalid chunk type:"+t.type);for(;r<i;)n.push({instrumentName:String.fromCharCode.apply(null,e.subarray(r,r+=20)),instrumentBagIndex:e[r++]|e[r++]<<8})},e.Parser.prototype.parseIbag=function(t){var e=this.input,r=t.offset,n=this.instrumentZone=[],i=t.offset+t.size;if("ibag"!==t.type)throw new Error("invalid chunk type:"+t.type);for(;r<i;)n.push({instrumentGeneratorIndex:e[r++]|e[r++]<<8,instrumentModulatorIndex:e[r++]|e[r++]<<8})},e.Parser.prototype.parseImod=function(t){if("imod"!==t.type)throw new Error("invalid chunk type:"+t.type);this.instrumentZoneModulator=this.parseModulator(t)},e.Parser.prototype.parseIgen=function(t){if("igen"!==t.type)throw new Error("invalid chunk type:"+t.type);this.instrumentZoneGenerator=this.parseGenerator(t)},e.Parser.prototype.parseShdr=function(t){var e,r,n,i,s,a,o,c,l,u,f=this.input,$=t.offset,h=this.sample=[],p=this.sampleHeader=[],d=t.offset+t.size;if("shdr"!==t.type)throw new Error("invalid chunk type:"+t.type);for(;$<d;){e=String.fromCharCode.apply(null,f.subarray($,$+=20)),r=f[$++]<<0|f[$++]<<8|f[$++]<<16|f[$++]<<24,n=f[$++]<<0|f[$++]<<8|f[$++]<<16|f[$++]<<24,i=f[$++]<<0|f[$++]<<8|f[$++]<<16|f[$++]<<24,s=f[$++]<<0|f[$++]<<8|f[$++]<<16|f[$++]<<24,a=f[$++]<<0|f[$++]<<8|f[$++]<<16|f[$++]<<24,o=f[$++],c=f[$++]<<24>>24,l=f[$++]|f[$++]<<8,u=f[$++]|f[$++]<<8;var _=new Int16Array(new Uint8Array(f.subarray(this.samplingData.offset+2*r,this.samplingData.offset+2*n)).buffer);if(i-=r,s-=r,a>0){var m=this.adjustSampleData(_,a);_=m.sample,a*=m.multiply,i*=m.multiply,s*=m.multiply}h.push(_),p.push({sampleName:e,startLoop:i,endLoop:s,sampleRate:a,originalPitch:o,pitchCorrection:c,sampleLink:l,sampleType:u})}},e.Parser.prototype.adjustSampleData=function(t,e){for(var r,n,i,s,a=1;e<22050;){for(r=new Int16Array(2*t.length),n=s=0,i=t.length;n<i;++n)r[s++]=t[n],r[s++]=t[n];t=r,a*=2,e*=2}return{sample:t,multiply:a}},e.Parser.prototype.parseModulator=function(t){for(var r,n,i=this.input,s=t.offset,a=t.offset+t.size,o=[];s<a;){if(s+=2,r=i[s++]|i[s++]<<8,void 0===(n=e.Parser.GeneratorEnumeratorTable[r]))o.push({type:n,value:{code:r,amount:i[s]|i[s+1]<<8<<16>>16,lo:i[s++],hi:i[s++]}});else switch(n){case"keyRange":case"velRange":case"keynum":case"velocity":o.push({type:n,value:{lo:i[s++],hi:i[s++]}});break;default:o.push({type:n,value:{amount:i[s++]|i[s++]<<8<<16>>16}})}s+=2,s+=2}return o},e.Parser.prototype.parseGenerator=function(t){for(var r,n,i=this.input,s=t.offset,a=t.offset+t.size,o=[];s<a;)if(r=i[s++]|i[s++]<<8,void 0!==(n=e.Parser.GeneratorEnumeratorTable[r]))switch(n){case"keynum":case"keyRange":case"velRange":case"velocity":o.push({type:n,value:{lo:i[s++],hi:i[s++]}});break;default:o.push({type:n,value:{amount:i[s++]|i[s++]<<8<<16>>16}})}else o.push({type:n,value:{code:r,amount:i[s]|i[s+1]<<8<<16>>16,lo:i[s++],hi:i[s++]}});return o},e.Parser.prototype.getInstruments=function(){var t,e,r,n,i,s,a,o=this.instrument,c=this.instrumentZone,l=[];for(n=0,i=o.length;n<i;++n){for(t=[],s=o[n].instrumentBagIndex,a=o[n+1]?o[n+1].instrumentBagIndex:c.length;s<a;++s)e=this.createInstrumentGenerator_(c,s),r=this.createInstrumentModulator_(c,s),t.push({generator:e.generator,modulator:r.modulator});l.push({name:o[n].instrumentName,info:t})}return l},e.Parser.prototype.createInstrumentGenerator_=function(t,e){return{generator:this.createBagModGen_(t,t[e].instrumentGeneratorIndex,t[e+1]?t[e+1].instrumentGeneratorIndex:this.instrumentZoneGenerator.length,this.instrumentZoneGenerator).modgen}},e.Parser.prototype.createInstrumentModulator_=function(t,e){return{modulator:this.createBagModGen_(t,t[e].presetModulatorIndex,t[e+1]?t[e+1].instrumentModulatorIndex:this.instrumentZoneModulator.length,this.instrumentZoneModulator).modgen}},e.Parser.prototype.createBagModGen_=function(t,e,r,n){var i,s,a,o={unknown:[],keyRange:{hi:127,lo:0}};for(s=e,a=r;s<a;++s)"unknown"===(i=n[s]).type?o.unknown.push(i.value):o[i.type]=i.value;return{modgen:o}},e.Parser.GeneratorEnumeratorTable=["startAddrsOffset","endAddrsOffset","startloopAddrsOffset","endloopAddrsOffset","startAddrsCoarseOffset","modLfoToPitch","vibLfoToPitch","modEnvToPitch","initialFilterFc","initialFilterQ","modLfoToFilterFc","modEnvToFilterFc","endAddrsCoarseOffset","modLfoToVolume",void 0,"chorusEffectsSend","reverbEffectsSend","pan",void 0,void 0,void 0,"delayModLFO","freqModLFO","delayVibLFO","freqVibLFO","delayModEnv","attackModEnv","holdModEnv","decayModEnv","sustainModEnv","releaseModEnv","keynumToModEnvHold","keynumToModEnvDecay","delayVolEnv","attackVolEnv","holdVolEnv","decayVolEnv","sustainVolEnv","releaseVolEnv","keynumToVolEnvHold","keynumToVolEnvDecay","instrument",void 0,"keyRange","velRange","startloopAddrsCoarseOffset","keynum","velocity","initialAttenuation",void 0,"endloopAddrsCoarseOffset","coarseTune","fineTune","sampleID","sampleModes",void 0,"scaleTuning","exclusiveClass","overridingRootKey"],e.Riff={},e.Riff.Parser=function(t,e){e=e||{},this.input=t,this.ip=e.index||0,this.length=e.length||t.length-this.ip,this.offset=this.ip,this.padding=void 0===e.padding||e.padding,this.bigEndian=void 0!==e.bigEndian&&e.bigEndian},e.Riff.Chunk=function(t,e,r){this.type=t,this.size=e,this.offset=r},e.Riff.Parser.prototype.parse=function(){var t=this.length+this.offset;for(this.chunkList=[];this.ip<t;)this.parseChunk()},e.Riff.Parser.prototype.parseChunk=function(){var t,r=this.input,n=this.ip;this.chunkList.push(new e.Riff.Chunk(String.fromCharCode(r[n++],r[n++],r[n++],r[n++]),t=this.bigEndian?r[n++]<<24|r[n++]<<16|r[n++]<<8|r[n++]:r[n++]|r[n++]<<8|r[n++]<<16|r[n++]<<24,n)),n+=t,1===(this.padding&&n-this.offset&1)&&n++,this.ip=n},e.Riff.Parser.prototype.getChunk=function(t){var e=this.chunkList[t];return void 0===e?null:e},e.Riff.Parser.prototype.getNumberOfChunks=function(){return this.chunkList.length},e},"object"==typeof exports?(root.sf2=exports,factory(exports)):"function"==typeof define&&define.amd?define(["exports"],function(t){return root.sf2=t,root.sf2,factory(t)}):(root.sf2={},factory(root.sf2)),!abc2svg)var abc2svg={};function isQuoted(t){return t.q}function quote(t){return t.q=!0,t}function unquote(t){return delete t.q,t}function Symbol(t){return this.nm=t,this}function isSymbol(t){return t&&t.constructor===Symbol}function symbolName(t){return t.nm}function isArray(t){return t&&t.constructor===Array}function inDs(t,e){for(var r=t.length-1;0<=r;--r)if(void 0!==t[r][e])return t[r];return!1}function member(t,e){return 0<=e.indexOf(t)}function PsParser(){var t=this;function e(){return t.I<t.N&&t.L[t.I]}function r(){return t.I<t.N&&t.L[t.I++]}function n(){for(;t.I<t.N&&member(t.L[t.I]," \t\n");)t.I++}function i(){var t=r();if(member(t,"()<>/% \t\n"))throw new Error("Symbol expected, got "+t);for(var n=member(t,"+-0123456789."),i="."==t,s=[t];e()&&!member(e(),"()<>[]{}/% \t\n");)t=r(),s.push(t),n&&!member(t,"0123456789")&&(i||"."!=t?n=!1:i=!0);return 1==(s=s.join("")).length&&member(s,"+-.")&&(n=!1),n?i?parseFloat(s):parseInt(s,10):new Symbol(s)}return PsParser.prototype.init=function(e){t.L=e,t.N=e.length,t.I=0,t.D=0},PsParser.prototype.peek=e,PsParser.prototype.token=function(){switch(n(),e()){case!1:return;case"%":return function(){for(;"%"==e();){for(;e()&&"\n"!=e();)r();n()}}();case"[":case"]":return new Symbol(r());case"{":return t.D++,new Symbol(r());case"}":return t.D--,new Symbol(r());case"/":return r(),quote(i());case"(":return function(){r();for(var t=[],n=1;0<n&&e();){var i=r();switch(i){case"(":n++;break;case")":--n<=0&&(i=!1);break;case"\\":switch(i=r()){case"(":case")":case"\\":break;case"n":i="\n";break;case"r":i="\r";break;case"t":i="\t";break;default:i=!1}}!1!==i&&t.push(i)}return t.join("")}();case"<":if(r(),"<"!=e())throw new Error("Encoded strings not implemented yet");return r(),new Symbol("<<");case">":if(r(),">"!=e())throw new Error("Unexpected >");return r(),new Symbol(">>");default:return i()}},this}function Ps0(t,e,r){function n(i,s){if(isSymbol(i)&&!isQuoted(i)){var a=symbolName(i),o=inDs(e,a);if(!o)throw new Error("bind error '"+a+"'");r.push([!1,o[a]])}else if(s&&isArray(i)&&isQuoted(i)){if(0<i.length){var c=i[0],l=quote(i.slice(1));0<l.length&&r.push([!1,l]),n(c,!1)}}else"function"==typeof i?i():t.push(i)}function i(){n(t.pop(),!1)}function s(){for(var e=r.pop(),i=(e.shift(),e.pop()),s=0;s<e.length;s++)t.push(e[s]);n(i,!0)}var a=new PsParser;return Ps0.prototype.run=n,Ps0.prototype.exec=i,Ps0.prototype.step=s,Ps0.prototype.parse=function(e){for(a.init(e);a.peek();){var n=a.token();if((n||0===n)&&(t.push(n),a.D<=0||isSymbol(n)&&(member(symbolName(n),"[]{}")||"<<"==symbolName(n)||">>"==symbolName(n))))for(i();0<r.length;)s()}return t},this}function Wps(t){var e=t,r=[],n={},i=[n],s=[],a=new Ps0(r,i,s);n.true=function(){r.push(!0)},n.false=function(){r.push(!1)},n.null=function(){r.push(null)},n.sub=function(){var t=r.pop();r.push(r.pop()-t)},n.mul=function(){r.push(r.pop()*r.pop())},n.div=function(){var t=r.pop();r.push(r.pop()/t)},n.mod=function(){var t=r.pop();r.push(r.pop()%t)};var o={};n.mark=function(){r.push(o)},n.counttomark=function(){for(var t=0,e=r.length-1;0<=e;e--){if(o===r[e])return r.push(t);t++}throw new Error("Mark not found")},n["<<"]=n.mark,n[">>"]=function(){for(var t={};0<r.length;){var e=r.pop();if(o===e)return r.push(t);t[r.pop()]=e}throw new Error("Mark not found")},n.exch=function(){var t=r.pop(),e=r.pop();r.push(t),r.push(e)},n.clear=function(){r.length=0},n.pop=function(){r.pop()},n.index=function(){r.push(r[r.length-2-r.pop()])},n.roll=function(){var t=r.pop(),e=r.pop(),n=[],i=[];t<0&&(t=e+t);for(var s=0;s<e;s++)s<t?n.unshift(r.pop()):i.unshift(r.pop());for(s=0;s<t;s++)r.push(n.shift());for(s=0;s<e-t;s++)r.push(i.shift())},n.copy=function(){var t=r.pop();if("object"==typeof t){var e=r.pop();for(var n in e)t[n]=e[n];r.push(t)}else for(e=r.length-t,n=0;n<t;n++)r.push(r[e+n])},n.length=function(){r.push(r.pop().length)},n.astore=function(){for(var t=r.pop(),e=t.length-1;0<=e;e--)t[e]=r.pop();r.push(t)},n.array=function(){r.push(new Array(r.pop()))},n.eq=function(){var t=r.pop(),e=r.pop();r.push(e==t)},n.lt=function(){var t=r.pop(),e=r.pop();r.push(e<t)},n.ifelse=function(){var t=r.pop(),e=r.pop(),n=r.pop();s.push([!1,!0===n?e:t])},n.and=function(){var t=r.pop(),e=r.pop();!0!==t&&!1!==t?r.push(t&e):r.push(1==t&&!0===e)},n.repeat=function t(){var e=r.pop(),n=r.pop();1<n&&s.push([!0,n-1,e,t]),0<n&&s.push([!1,e])},n.for=function t(){var e=r.pop(),n=r.pop(),i=r.pop(),a=r.pop();i<0?(n<=a+i&&s.push([!0,a+i,i,n,e,t]),n<=a&&s.push([!1,a,e])):(a+i<=n&&s.push([!0,a+i,i,n,e,t]),a<=n&&s.push([!1,a,e]))},n.exec=function(){s.push([!1,r.pop()])},n.cvx=function(){var t=r.pop();isSymbol(t)&&isQuoted(t)?r.push(unquote(t)):isArray(t)&&!isQuoted(t)?r.push(quote(t)):r.push(t)},n.dict=function(){r.pop(),r.push({})},n.get=function(){var t=r.pop(),e=r.pop();isSymbol(t)?r.push(e[symbolName(t)]):r.push(e[t])},n.getinterval=function(){for(var t=r.pop(),e=r.pop()+t,n=r.pop(),i=[];--t>=0;)i.push(n[e++]);r.push(i)},n.put=function(){var t=r.pop(),e=r.pop(),n=r.pop();isSymbol(e)?n[symbolName(e)]=t:n[e]=t},n.begin=function(){i.push(r.pop())},n.end=function(){i.pop()},n.currentdict=function(){r.push(i[i.length-1])},n.where=function(){var t=symbolName(r.pop()),e=inDs(i,t);e?(r.push(e),r.push(!0)):r.push(!1)},n.save=function(){for(var t=i.slice(),e=0;e<t.length;e++){var n=t[e],s={};for(var a in n)s[a]=n[a];t[e]=s}r.push(t)},n.restore=function(){for(var t=r.pop();0<i.length;)i.pop();for(;0<t.length;)i.unshift(t.pop())},n.type=function(){var t,e=r.pop();if(null===e)t="nulltype";else if(!0===e||!1===e)t="booleantype";else if(o===e)t="marktype";else if("string"==typeof e)t="stringtype";else if(isSymbol(e))t=isQuoted(e)?"nametype":"operatortype";else if("function"==typeof e)t="operatortype";else if(isArray(e))t="arraytype";else if("object"==typeof e)t="dicttype";else{if(1*e!=e)throw new Error("Undefined type '"+e+"'");t=e%1==0?"integertype":"realtype"}r.push(t)};return n[".strictBind"]=function(){!0===r.pop()},n.bind=function(){r.push(function t(e){if(isSymbol(e)&&!isQuoted(e))return e;if(isArray(e)&&isQuoted(e)){for(var r=e.length,n=[],i=0;i<r;i++){var s=e[i],a=t(s);n=isArray(s)?n.concat(isQuoted(s)?quote([a]):[a]):n.concat(a)}return quote(n)}return e}(r.pop()))},n["="]=function(){var t=r.pop();alert(t&&t.nm||t)},n["=="]=function(){alert(r.pop())},n.stack=function(){alert(r)},n.pstack=function(){alert(r)},n[".call"]=function(){for(var t=r.pop(),e=r.pop(),n=r.pop(),i=[],s=0;s<t;s++)i.unshift(r.pop());if(!n[e])throw new Error(".call: "+e+" undef");r.push(n[e].apply(n,i))},n[".call0"]=function(){for(var t=r.pop(),e=r.pop(),n=r.pop(),i=[],s=0;s<t;s++)i.unshift(r.pop());if(!n[e])throw new Error(".call0: "+e+" undef");n[e].apply(n,i)},n[".svg"]=function(){r.push(e)},n[".math"]=function(){r.push(Math)},n[".date"]=function(){r.push(new Date)},n[".window"]=function(){r.push(window)},n[".callback"]=function(){var t=r.pop();r.push(function(){for(a.run(t,!0);0<s.length;)a.step()})},n[".minv"]=function(){var t=r.pop(),e=t[0],n=t[1],i=t[2],s=t[3],a=t[4],o=t[5];r.push([s,n,i,e,i*o-s*a,n*a-e*o])},n[".mmul"]=function(){var t=r.pop(),e=r.pop(),n=e[0],i=e[1],s=e[2],a=e[3],o=e[4],c=e[5],l=t[0],u=t[1],f=t[2],$=t[3],h=t[4],p=t[5];r.push([n*l+i*f,n*u+i*$,s*l+a*f,s*u+a*$,o*l+c*f+h,o*u+c*$+p])},n[".xy"]=function(){var t=r.pop(),e=r.pop(),n=r.pop();r.push(t[0]*n+t[2]*e+t[4]),r.push(t[1]*n+t[3]*e+t[5])},n[".rgb"]=function(){var t=r.pop(),e=r.pop(),n=r.pop();r.push("rgb("+n+","+e+","+t+")")},n[".rgba"]=function(){var t=r.pop(),e=r.pop(),n=r.pop(),i=r.pop();r.push("rgba("+i+","+n+","+e+","+t+")")},Wps.prototype.parse=function(){var t=arguments;if(t.length)for(var e=0;e<t.length;e++)a.parse(t[e]);else a.parse(t);return r},this}function Psvg(t){var e,r,n="",i=t,s=new Wps(this),a=0,o={cx:0,cy:0,xoffs:0,yoffs:0,xscale:1,yscale:1,rotate:0,sin:0,cos:1,linewidth:.7,dash:""},c=[],l=0,u=0,f="";function $(){return m(0),[o.xoffs-o.xorig,o.yoffs-o.yorig]}function h(){if(e=!1,m(0),n+="<g",1!=o.xscale||1!=o.yscale||o.rotate){if(n+=' transform="',1==o.xscale&&1==o.yscale||(o.xscale==o.yscale?n+="scale("+o.xscale.toFixed(3)+")":n+="scale("+o.xscale.toFixed(3)+","+o.yscale.toFixed(3)+")"),o.rotate){if(o.xoffs||o.yoffs){var t,r=o.xoffs,i=o.yoffs,s=o.sin,c=o.cos;t=r*c-i*s,i=r*s+i*c,n+=" translate("+t.toFixed(1)+","+i.toFixed(1)+")",l=o.xoffs,u=o.yoffs,o.xoffs=0,o.yoffs=0}n+=" rotate("+o.rotate.toFixed(2)+")"}n+='"'}p(!1),o.rgb&&(n+=' style="color:'+o.rgb+'"'),n+=">\n",a=1}function p(t){var e=o.font_n;if(e){var r="",i=e.indexOf("Italic"),s=100,a=e.indexOf("Oblique"),c=e.indexOf("Bold"),l=0;c>0&&(r=' font-weight="bold"',s=c,l=2),(i>0||a>0)&&(i>0&&(r+=' font-style="italic"',i<s&&(s=i),l|=4),a>0&&(r+=' font-style="oblique"',a<s&&(s=a),l=8)),100!=s&&("-"==e[s-1]&&s--,e=e.slice(0,s)),t&&(!(2&l)&&f.indexOf("Bold")>=0&&(r+=' font-weight="normal"'),12&l||!(f.indexOf("Italic")>=0||f.indexOf("Oblique")>=0)||(r+=' font-style="normal"')),n+=' font-family="'+e+'"'+r+' font-size="'+o.font_s+'"'}}function d(){r||(m(1),o.px=o.cx,o.py=o.cy,r='<path d="m'+(o.xoffs+o.cx).toFixed(1)+" "+(o.yoffs-o.cy).toFixed(1)+"\n")}function _(){n+=r,r=""}function m(t){2==a&&(n+="</text>\n",a=1),0==t?a&&(a=0,n+="</g>\n",o.rotate&&(o.xoffs=l,o.yoffs=u,l=0,u=0)):e&&h()}function y(t){return t.length*o.font_s*.5}function g(t,e,n,i,s,a){var c,l,u,f;i>=360&&(i-=360),s>=360&&(s-=360),c=t+n*Math.cos(i*Math.PI/180),l=e+n*Math.sin(i*Math.PI/180),null!=o.cx?r?(c!=o.cx||l!=o.cy?r+="l":r+="m",r+=(c-o.cx).toFixed(1)+" "+(-(l-o.cy)).toFixed(1)):(o.cx=c,o.cy=l,d()):(r&&(r=""),o.cx=c,o.cy=l,d()),i==s?(s=180-i,u=t+n*Math.cos(s*Math.PI/180),f=e+n*Math.sin(s*Math.PI/180),r+="a"+n.toFixed(2)+" "+n.toFixed(2)+" 0 0 "+(a?"1 ":"0 ")+(u-c).toFixed(2)+" "+(l-f).toFixed(2)+" "+n.toFixed(2)+" "+n.toFixed(2)+" 0 0 "+(a?"1 ":"0 ")+(c-u).toFixed(2)+" "+(f-l).toFixed(2)+"\n",o.cx=c,o.cy=l):(u=t+n*Math.cos(s*Math.PI/180),f=e+n*Math.sin(s*Math.PI/180),r+="a"+n.toFixed(2)+" "+n.toFixed(2)+" 0 0 "+(a?"1 ":"0 ")+(u-c).toFixed(2)+" "+(l-f).toFixed(2)+"\n",o.cx=u,o.cy=f)}function v(t,e){d(),r+=0==t?"\tv"+(-e).toFixed(1)+"\n":0==e?"\th"+t.toFixed(1)+"\n":"\tl"+t.toFixed(1)+" "+(-e).toFixed(1)+"\n",o.cx+=t,o.cy+=e}function b(t){t&&m(0),n&&(i.out_svg(n),n="")}function A(t,e,r,n){return o.xorig=o.xoffs=i.sx(0),o.yorig=o.yoffs=i.sy(0),o.cx=0,o.cy=0,s.parse(n+(e/i.stv_g().scale).toFixed(1)+" "+r.toFixed(1)+" "+t),b(!0),!0}Psvg.prototype.strw=y,Psvg.prototype.arc=g,Psvg.prototype.arcn=function(t,e,r,n,i){g(t,e,r,n,i,!0)},Psvg.prototype.closepath=function(){r&&o.cx&&v(o.px-o.cx,o.py-o.cy)},Psvg.prototype.cx=function(){return o.cx},Psvg.prototype.cy=function(){return o.cy},Psvg.prototype.curveto=function(t,e,n,i,s,a){d(),r+="\tC"+(o.xoffs+t).toFixed(1)+" "+(o.yoffs-e).toFixed(1)+" "+(o.xoffs+n).toFixed(1)+" "+(o.yoffs-i).toFixed(1)+" "+(o.xoffs+s).toFixed(1)+" "+(o.yoffs-a).toFixed(1)+"\n",o.cx=s,o.cy=a},Psvg.prototype.eofill=function(){_(),n+='" fill-rule="evenodd" fill="currentColor"/>\n'},Psvg.prototype.fill=function(){_(),n+='" fill="currentColor"/>\n'},Psvg.prototype.gsave=function(){c.push(function(t){var e,r=new t.constructor;for(e in t)t.hasOwnProperty(e)&&(r[e]=t[e]);return r}(o))},Psvg.prototype.grestore=function(){o=c.pop(),e=!0},Psvg.prototype.lineto=function(t,e){d(),t==o.cx?r+="\tv"+(o.cy-e).toFixed(1)+"\n":e==o.cy?r+="\th"+(t-o.cx).toFixed(1)+"\n":r+="\tl"+(t-o.cx).toFixed(1)+" "+(o.cy-e).toFixed(1)+"\n",o.cx=t,o.cy=e},Psvg.prototype.moveto=function(t,e){o.cx=t,o.cy=e,r?r+="\tM"+(o.xoffs+o.cx).toFixed(1)+" "+(o.yoffs-o.cy).toFixed(1)+"\n":2==a&&(n+="</text>\n",a=1)},Psvg.prototype.newpath=function(){o.cx=o.cy=void 0},Psvg.prototype.rcurveto=function(t,e,n,i,s,a){d(),r+="\tc"+t.toFixed(1)+" "+(-e).toFixed(1)+" "+n.toFixed(1)+" "+(-i).toFixed(1)+" "+s.toFixed(1)+" "+(-a).toFixed(1)+"\n",o.cx+=s,o.cy+=a},Psvg.prototype.rlineto=v,Psvg.prototype.rmoveto=function(t,e){r?r+="\tm"+t.toFixed(1)+" "+(-e).toFixed(1)+"\n":2==a&&(n+="</text>\n",a=1),o.cx+=t,o.cy+=e},Psvg.prototype.rotate=function(t){m(0);var r,n=o.xoffs,i=o.yoffs,s=o.sin,a=o.cos;r=n*a-i*s,i=n*s+i*a,o.xoffs=r/o.xscale,o.yoffs=i/o.yscale,r=(n=o.cx)*a-(i=o.cy)*s,i=-n*s+i*a,o.cx=r/o.xscale,o.cy=i/o.yscale,t=360-t,o.rotate+=t,o.rotate>180?o.rotate-=360:o.rotate<=-180&&(o.rotate+=360),t=o.rotate*Math.PI/180,o.sin=s=Math.sin(t),o.cos=a=Math.cos(t),r=o.cx,o.cx=(r*a+o.cy*s)*o.xscale,o.cy=(-r*s+o.cy*a)*o.yscale,r=o.xoffs,o.xoffs=(r*a+o.yoffs*s)*o.xscale,o.yoffs=(-r*s+o.yoffs*a)*o.yscale,e=!0},Psvg.prototype.scale=function(t,r){o.xoffs/=t,o.yoffs/=r,o.cx/=t,o.cy/=r,o.xscale*=t,o.yscale*=r,e=!0},Psvg.prototype.selectfont=function(t,r){t=t.nm,0==r&&""==t||(o.font_n_old=o.font_n,o.font_n=t,o.font_s=r,e=!0)},Psvg.prototype.setdash=function(t,e){var r=t.length;if(0!=r){for(o.dash=' stroke-dashoffset="'+e+'"  stroke-dasharray="',0;o.dash+=t[0],0!=--r;)o.dash+=" ";o.dash+='"'}else o.dash=""},Psvg.prototype.setlinewidth=function(t){o.linewidth=t},Psvg.prototype.setrgbcolor=function(t,r,n){var i=16777216+(Math.floor(255*t)<<16)+(Math.floor(255*r)<<8)+Math.floor(255*n);(i=(i=i.toString(16)).replace("1","#"))!=o.rgb&&(o.rgb=i,e=!0)},Psvg.prototype.show=function(t){var r,i,s;e&&(2==a?r=!0:h()),i=o.cx,s=o.cy,r?(n+="<tspan\n\t",p(!0),n+=">"):2!=a&&(n+='<text x="'+(i+o.xoffs).toFixed(1)+'" y="'+(o.yoffs-s).toFixed(1)+'">',a=2),n+=t.replace(/<|>|&|  /g,function(t){switch(t){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";case"  ":return" "}}),r&&(n+="</tspan>"),o.cx=i+y(t)},Psvg.prototype.stroke=function(){_(),.7!=o.linewidth&&(n+='" stroke-width="'+o.linewidth.toFixed(1)),n+='" stroke="currentColor" fill="none"'+o.dash+"/>\n"},Psvg.prototype.translate=function(t,e){o.xoffs+=t,o.yoffs-=e,o.cx-=t,o.cy-=e},Psvg.prototype.arp=function(t,e,r){var n=$();b(),i.out_arp((e+n[0])*i.stv_g().scale,r-n[1],t)},Psvg.prototype.ltr=function(t,e,r){var n=$();b(),i.out_ltr((e+n[0])*i.stv_g().scale,r-n[1],t)},Psvg.prototype.xygl=function(t,e,r){var n=$();b(),i.xygl((t+n[0])*i.stv_g().scale,e-n[1],r)},Psvg.prototype.xygls=function(t,e,r,n){var s=$();b(),i.out_deco_str((e+s[0])*i.stv_g().scale,r-s[1],n,t)},Psvg.prototype.xyglv=function(t,e,r,n){var s=$();b(),i.out_deco_val((e+s[0])*i.stv_g().scale,r-s[1],n,t)},Psvg.prototype.y0=function(t){return t+i.get_staff_tb()[0].y},Psvg.prototype.y1=function(t){return t+i.get_staff_tb()[1].y},Psvg.prototype.ps_flush=b,Psvg.prototype.ps_eval=function(t){s.parse(t),b(!0)},Psvg.prototype.psdeco=function(t,e,r,n){var a,o,c,l,u=s.parse("/"+t+" where"),f=u.pop(),$=i.get_staff_tb();return!!f&&(l=0,n.defl.nost&&(l=1),n.defl.noen&&(l|=2),n.s.stem>=0&&(l|=4),u.pop(),c="/defl "+l+" def ",n.lden&&(c+=e.toFixed(1)+" "+r.toFixed(1)+" ",e=(o=n.start).x,r=o.y+$[o.st].y,e>n.x-20&&(e=n.x-20)),a=n.dd,n.has_val?c+=n.val+" ":a.str&&(c+="("+a.str+") ",r+=.2*a.h),A(t,e,r,c))},Psvg.prototype.psxygl=function(t,e,r){var n=s.parse("/"+r+" where");return!!n.pop()&&(n.pop(),A(r,t,e,"dlw "))},Psvg.prototype.svgcall=function(t,e,r,n,s){var a=$();b(),t((e+a[0])*i.stv_g().scale,r-a[1],n,s)},s.parse("currentdict/systemdict currentdict put\nsystemdict/{/mark cvx put\nsystemdict/[/mark cvx put\nsystemdict/]\n/counttomark cvx\n/array cvx\n/astore cvx\n/exch cvx\n/pop cvx\n5 array astore cvx put\nsystemdict/}/] cvx/cvx cvx 2 array astore cvx put\nsystemdict/def{currentdict 2 index 2 index put pop pop}put\n\n/maxlength 1000 def % TODO\n/.bdef{bind def}bind def\n/.xdef{exch def}.bdef\n/dup{0 index}.bdef\n/load{dup where pop exch get}.bdef\n/.ldef{load def}.bdef\n/if{{}ifelse}.bdef\n/cleartomark{array pop}.bdef\n/known{exch begin where{currentdict eq}{false}if end}.bdef\n/store{1 index where{3 1 roll put}{def}ifelse}.bdef\n/not{{false}{true}ifelse}.bdef\n%/.logand{{{true}{false}ifelse}{pop false}ifelse}.bdef\n%/and/.logand .ldef % TODO numeric and\n/.logor{{pop true}{{true}{false}ifelse}ifelse}.bdef\n/or/.logor .ldef % TODO numeric or\n/ne{eq not}.bdef\n/ge{lt not}.bdef\n/le{1 index 1 index eq 3 1 roll lt or}.bdef\n/gt{le not}.bdef\n/.repeat{1 1 4 2 roll for}.bdef\n\n%% math\n\n/floor{.math(floor)1 .call}.bdef\n\n/neg{0 exch sub}.bdef\n/add{neg sub}.bdef\n/idiv{div floor}.bdef\n\n/.pi{.math(PI)get}.bdef\n\n/abs{.math(abs)1 .call}.bdef\n%/.acos{.math(acos)1 .call}.bdef\n%/.asin{.math(asin)1 .call}.bdef\n/atan{.math(atan2)2 .call 180 mul .pi div}.bdef\n%/.atan2{.math(atan2)2 .call}.bdef\n%/ceiling{.math(ceil)1 .call}.bdef\n/cos{.pi mul 180 div .math(cos)1 .call}.bdef\n%/.exp{.math(exp)1 .call}.bdef\n%/log{.math(log)1 .call}.bdef\n%/.max{.math(max)2 .call}.bdef\n%/.min{.math(min)2 .call}.bdef\n%/.pow{.math(pow)2 .call}.bdef\n%/.random{.math(random)0 .call}.bdef\n%/rand{.random}.bdef % TODO follow spec\n%/round{.math(round)1 .call}.bdef\n%/sin{.math(sin)1 .call}.bdef\n%/sqrt{.math(sqrt)1 .call}.bdef\n%/.tan{.math(tan)1 .call}.bdef\n%/truncate{.math(truncate)1 .call}.bdef % TODO Math.truncate does not exist!\n\n% graphic\n/arc{.svg(arc)5 .call0}.bdef\n/arcn{.svg(arcn)5 .call0}.bdef\n/closepath{.svg(closepath)0 .call}.bdef\n/currentpoint{.svg(cx)0 .call .svg(cy)0 .call}.bdef\n/curveto{.svg(curveto)6 .call0}.bdef\n/eofill{.svg(eofill)0 .call0}.bdef\n/fill{.svg(fill)0 .call0}.bdef\n/grestore{.svg(grestore)0 .call0}.bdef\n/gsave{.svg(gsave)0 .call0}.bdef\n/lineto{.svg(lineto)2 .call0}.bdef\n/moveto{.svg(moveto)2 .call0}.bdef\n/newpath{.svg(newpath)0 .call0}.bdef\n/rcurveto{.svg(rcurveto)6 .call0}.bdef\n/rlineto{.svg(rlineto)2 .call0}.bdef\n/rmoveto{.svg(rmoveto)2 .call0}.bdef\n/rotate{.svg(rotate)1 .call0}.bdef\n/scale{.svg(scale)2 .call0}.bdef\n/selectfont{.svg(selectfont)2 .call0}.bdef\n/setdash{.svg(setdash)2 .call0}.bdef\n/setlinewidth{.svg(setlinewidth)1 .call0}.bdef\n/setrgbcolor{.svg(setrgbcolor)3 .call0}.bdef\n/show{.svg(show)1 .call0}.bdef\n/stroke{.svg(stroke)0 .call0}.bdef\n/stringwidth{.svg(strw)1 .call 1}.bdef\t\t%fixme: height KO\n/translate{.svg(translate)2 .call0}.bdef\n\n/setgray{255 mul dup dup setrgbcolor}.bdef\n% abcm2ps syms.c\n/!{bind def}bind def\n/T/translate load def\n/M/moveto load def\n/RM/rmoveto load def\n/L/lineto load def\n/RL/rlineto load def\n/C/curveto load def\n/RC/rcurveto load def\n/SLW/setlinewidth load def\n/defl 0 def\n/dlw{0.7 SLW}!\n/xymove{/x 2 index def/y 1 index def M}!\n/showc{dup stringwidth pop .5 mul neg 0 RM show}!\n%\n% abcm2ps internal glyphs\n/arp{.svg(arp)3 .call0}.bdef\n/ltr{.svg(ltr)3 .call0}.bdef\n/ft0{(acc-1).svg(xygl)3 .call0}.bdef\n/nt0{(acc3).svg(xygl)3 .call0}.bdef\n/sh0{(acc1).svg(xygl)3 .call0}.bdef\n/dsh0{(acc2).svg(xygl)3 .call0}.bdef\n/trl{(trl).svg(xygl)3 .call0}.bdef\n/lmrd{(lmrd).svg(xygl)3 .call0}.bdef\n/turn{(turn).svg(xygl)3 .call0}.bdef\n/umrd{(umrd).svg(xygl)3 .call0}.bdef\n/y0{.svg(y0)1 .call}.bdef\n/y1{.svg(y1)1 .call}.bdef\n")}abc2svg.play_next=function(t){function e(r,n,i){for(var s,a,o=abc2svg.C,c=r.v,l=r.time+r.dur;;){if(!(r=r.ts_next))return i;switch(r.type){case o.BAR:if(r.rep_p&&(t.repn||(l=(r=r.rep_p).time)),r.rep_s){if(!r.rep_s[t.repv+1])return i;l=(r=r.rep_s[t.repv+1]).time}for(;r.ts_next&&!r.ts_next.dur;)r=r.ts_next}if(r.time>l)return i;if(r.type==o.NOTE&&r.v==c)break}for(s=r.notes.length;--s>=0;)if((a=r.notes[s]).midi==n)return a.ti2=!0,i+=r.pdur/t.conf.speed,a.tie_ty?e(r,n,i):i;return i}function r(t,e,r){var n,i={subtype:"midictl",p_v:e.p_v};for(n in e.p_v.midictl)i.ctrl=n,i.val=e.p_v.midictl[n],t.midi_ctrl(t,i,r);for(i=e.p_v.sym;i!=e;i=i.next)"midictl"==i.subtype&&t.midi_ctrl(t,i,r);t.p_v[e.v]=!0}t.stime=t.get_time(t)+.3-t.s_cur.ptim*t.conf.speed,t.p_v=[],t.repv||(t.repv=1),function t(n){var i,s,a,o,c,l,u,f,$,h=abc2svg.C,p=n.s_cur;if(n.stop)n.onend&&n.onend(n.repv);else{for(;p.noplay;)if(!(p=p.ts_next)||p==n.s_end)return void(n.onend&&n.onend(n.repv));for(f=n.stime+p.ptim/n.conf.speed,n.conf.new_speed&&(i=n.get_time(n),n.stime=i-(i-n.stime)*n.conf.speed/n.conf.new_speed,n.conf.speed=n.conf.new_speed,n.conf.new_speed=0,f=n.stime+p.ptim/n.conf.speed),$=f+n.tgen,n.timouts=[];;){switch(n.p_v[p.v]||r(n,p,f),p.type){case h.BAR:if(":"==p.bar_type.slice(-1)&&(n.repv=1),p.rep_p){if(n.repv++,!n.repn&&(!p.rep_v||n.repv<p.rep_v.length)){for(n.stime+=(p.ptim-p.rep_p.ptim)/n.conf.speed,p=p.rep_p;p.ts_next&&p.ts_next.type==h.BAR;)p=p.ts_next;f=n.stime+p.ptim/n.conf.speed,n.repn=!0;break}n.repn=!1}if(p.rep_s){if(!(u=p.rep_s[n.repv])){p=n.s_end;break}n.stime+=(p.ptim-u.ptim)/n.conf.speed,p=u,f=n.stime+p.ptim/n.conf.speed,n.repn=!1}for(;p.ts_next&&p.ts_next.type==h.BAR;)p=p.ts_next;break;case h.BLOCK:"midictl"==p.subtype&&n.midi_ctrl(n,p,f);break;case h.GRACE:for(l=p.extra;l;l=l.next)for(i=l.pdur/n.conf.speed,o=0;o<=l.nhd;o++)c=l.notes[o],n.note_run(n,l,c.midi,f+l.ptim-p.ptim,i);break;case h.NOTE:for(i=p.pdur/n.conf.speed,o=0;o<=p.nhd;o++)(c=p.notes[o]).ti2||n.note_run(n,p,c.midi,f,c.tie_ty?e(p,c.midi,i):i);case h.REST:i=p.pdur/n.conf.speed,n.onnote&&(s=p.istart,a=1e3*(f-n.get_time(n)),n.timouts.push(setTimeout(n.onnote,a,s,!0)),setTimeout(n.onnote,a+1e3*i,s,!1))}for(;;){if(p==n.s_end||!p.ts_next)return n.onend&&setTimeout(n.onend,1e3*(f-n.get_time(n)+i),n.repv),void(n.s_cur=p);if(!(p=p.ts_next).noplay)break}if((f=n.stime+p.ptim/n.conf.speed)>$)break}n.s_cur=p,n.timouts.push(setTimeout(t,1e3*(f-n.get_time(n))-300,n))}}(t)},"object"==typeof module&&"object"==typeof exports&&(exports.ToAudio=ToAudio),abc2svg.sndmem=function(t){var e,r;for(e={conf:{speed:1},tgen:3600,get_time:function(t){return 0},midi_ctrl:function(t,e,r){t.a_e.push(new Float32Array([e.istart,0,-1,e.ctrl,e.val,1,e.v]))},note_run:function(t,e,r,n,i){t.a_e.push(new Float32Array([e.istart,n,e.instr,r,i,1,e.v]))},a_e:[]};r=t.tunes.shift();)e.stop=!1,e.s_end=null,e.s_cur=r[0],e.repn=!1,e.repv=0,abc2svg.play_next(e);return e.a_e},abc2svg.MIDI={do_midi:function(t){var e,r,n,i,s=t.split(/\s+/),a=this.get_curvoice();if(a){if(a.ignore)return;null==a.chn&&(a.chn=a.v<9?a.v:a.v+1)}switch(s[1]){case"channel":if(r=parseInt(s[2]),isNaN(r)||r<=0||r>16){this.syntax(1,this.errs.bad_val,"%%MIDI channel");break}if(9!=--r){3==this.parse.state?((n=this.new_block("midichn")).play=!0,n.chn=r):this.set_v_param("channel",r);break}abc2svg.MIDI.do_midi.call(this,"MIDI control 0 1"),abc2svg.MIDI.do_midi.call(this,"MIDI control 32 0");break;case"drummap":if(e=function(t){var e,r=0,n=0;switch(t[0]){case"^":"^"==t[++n]?(r=2,n++):r=1;break;case"=":n++;break;case"_":"_"==t[++n]?(r=-2,n++):r=-1}if(!((e="CDEFGABcdefgab".indexOf(t[n++])+16)<16)){for(;"'"==t[n];)e+=7,n++;for(;","==t[n];)e-=7,n++;return abc2svg.pab40(e,r).toString()}}(s[2]),r=function(t){var e=Number(t);if(!isNaN(e))return t=e/12|0,e%=12,40*t+abc2svg.isb40[e]+2}(s[3]),!e||!r){this.syntax(1,this.errs.bad_val,"%%MIDI drummap");break}(i=this.get_maps()).MIDIdrum||(i.MIDIdrum={}),i.MIDIdrum[e]||(i.MIDIdrum[e]=[]),i.MIDIdrum[e][3]=r,this.set_v_param("mididrum","MIDIdrum");break;case"program":if(null!=s[3]?(abc2svg.MIDI.do_midi.call(this,"MIDI channel "+s[2]),r=s[3]):r=s[2],r=parseInt(r),isNaN(r)||r<0||r>127)return void this.syntax(1,this.errs.bad_val,"%%MIDI program");3==this.parse.state?((n=this.new_block("midiprog")).play=!0,n.instr=r):this.set_v_param("instr",r);break;case"control":if(e=parseInt(s[2]),isNaN(e)||e<0||e>127)return void this.syntax(1,"Bad controller number in %%MIDI");if(r=parseInt(s[3]),isNaN(r)||r<0||r>127)return void this.syntax(1,"Bad controller value in %%MIDI");3==this.parse.state?((n=this.new_block("midictl")).play=!0,n.ctrl=e,n.val=r):this.set_v_param("midictl",s[2]+" "+s[3])}},set_vp:function(t,e){var r,n,i=this.get_curvoice();for(null==i.chn&&(i.chn=i.v<9?i.v:i.v+1),r=0;r<e.length;r++)switch(e[r]){case"channel=":i.chn=e[++r];break;case"instr=":i.instr=e[++r];break;case"midictl=":i.midictl||(i.midictl=[]),n=e[++r].split(" "),i.midictl[n[0]]=Number(n[1]);break;case"mididrum=":i.map||(i.map={}),i.map=e[++r]}t(e)},do_pscom:function(t,e){"MIDI "==e.slice(0,5)?abc2svg.MIDI.do_midi.call(this,e):t(e)},set_hooks:function(t){t.do_pscom=abc2svg.MIDI.do_pscom.bind(t,t.do_pscom),t.set_vp=abc2svg.MIDI.set_vp.bind(t,t.set_vp)}},abc2svg.modules.hooks.push(abc2svg.MIDI.set_hooks),abc2svg.modules.MIDI.loaded=!0,abc2svg.equalbars={output_music:function(t){this.equalbars_d=0,t()},set_fmt:function(t,e,r){"equalbars"==e?this.cfmt().equalbars=this.get_bool(r):t(e,r)},set_sym_glue:function(t,e){var r,n,i,s,a,o,c,l,u,$=abc2svg.C,h=[],p=this.get_tsfirst();if(t(e),this.cfmt().equalbars){for(n=p;n;n=n.ts_next){switch(n.type){default:continue;case $.GRACE:case $.MREST:case $.NOTE:case $.REST:case $.SPACE:}break}if(n){for(u=l=n.time,r=n;r.ts_next;r=r.ts_next)r.type==$.BAR&&r.seqst&&(h.push([r,r.time-l]),l=r.time);if(r.invis&&r.prev.type==$.KEY?h[h.length-1][0]=r:h.push([r,r.time-l]),e=r.x,l=r.time,r.dur&&(l+=r.dur),!((a=h.length)<=1))for(o=n.type==$.GRACE?n.extra.x:n.x,this.equalbars_d<o&&(this.equalbars_d=o),d=this.equalbars_d,i=(e-d)/(l-u),s=0;s<a;s++){for(r=h[s][0],f=i*h[s][1]/(r.x-o);n!=r;n=n.ts_next)if(n.type==$.GRACE)for(c=n.extra;c;c=c.next)c.x=d+(c.x-o)*f;else n.x&&(n.x=d+(n.x-o)*f);for(d+=i*h[s][1],o=n.x;n.x=d,(n=n.ts_next)&&!n.seqst;);if(!n)break}}}},set_hooks:function(t){t.output_music=abc2svg.equalbars.output_music.bind(t,t.output_music),t.set_format=abc2svg.equalbars.set_fmt.bind(t,t.set_format),t.set_sym_glue=abc2svg.equalbars.set_sym_glue.bind(t,t.set_sym_glue)}},abc2svg.modules.hooks.push(abc2svg.equalbars.set_hooks),abc2svg.modules.equalbars.loaded=!0,abc2svg.grid3={do_begin_end:function(t,e,r,n){var i,s,a,o,c,l,u=this,f=u.cfmt(),$=u.get_img(),h=[],p=[],d=[],_=0,m=0,y=0;if("grid"==e){for(2==u.parse.state&&u.goto_tune(),f.gridfont||u.param_set_font("gridfont","serif 16"),i=u.get_font("grid"),s=u.font_class(i),a=s+" mid",u.set_font("grid"),n=n.split("\n");c=n.shift();){for(c=c.match(/[|:]+|[^|:\s]+/g),p[_]=[],d[_]=[],l=-1;h=c.shift();)h.match(/[:|]+/)?(p[_][++l]=h,d[_][l]=[]):(d[_][l]||(p[_][++l]="|",d[_][l]=[]),"-"==h&&(h=""),d[_][l].push(h));for(d[_][l].length?p[_][++l]="|":d[_][l]=null,l>m&&(m=l),l=0;h=d[_][l++];)2==h.length&&(h[2]=h[1],h[1]=""),(o=u.strwh(h.join(""))[0])>y&&(y=o);_++}y+=u.strwh("  ")[0],t("ml",r,function(){var t,e,r,n,o,c,l,h,g,v,b,A,x="",w='<path class="stroke" stroke-width="1" d="M',k='" style="font-size:'+(.72*i.size).toFixed(1)+"px";function E(t,e,r,n){return'<text class="'+t+'" x="'+e.toFixed(1)+'" y="'+r.toFixed(1)+'">'+A[n]+"</text>\n"}function S(t,e,r,n,i){var s;return t.length>1?(s=w+(e-y/2).toFixed(1)+" "+n.toFixed(1)+"l"+y.toFixed(1)+" -"+i.toFixed(1)+'"/>\n',t[1]?s+=w+(e-y/2).toFixed(1)+" "+(n-i).toFixed(1)+"l"+(y/2).toFixed(1)+" "+(i/2).toFixed(1)+'"/>\n'+E(a+k,e-y/3,r,0)+E(a+k,e,r-.32*i,1):s+=E(a+k,e-.2*y,r-i/4,0),t.length>=3&&(t[3]?s+=w+e.toFixed(1)+" "+(n-i/2).toFixed(1)+"l"+(y/2).toFixed(1)+" "+(i/2).toFixed(1)+'"/>\n'+E(a+k,e,r+.3*i,2)+E(a+k,e+y/3,r,3):s+=E(a+k,e+.2*y,r+i/4,2))):s=E(a,e,r,0),s}for(c=2.1*i.size,y<1.4*c&&(y=1.4*c),o=y*m,v=1,g=1-.7*i.size,l=($.width-o)/2;b=d.shift();)for(g+=c,v+=c,h=l+y/2;A=b.shift();)x+=S(A,h,g,v,c),h+=y;for(e='<svg xmlns="http://www.w3.org/2000/svg" version="1.1"\n\txmlns:xlink="http://www.w3.org/1999/xlink"\n\tcolor="black" width="'+$.width.toFixed(0)+'px" height="'+(c*_+6).toFixed(0)+'px"',(t=f.bgcolor)&&(e+=' style="background-color: '+t+'"'),e+=">\n<style>\n.mid {text-anchor:middle}\n",f.fullsvg&&(e+=".stroke {stroke: currentColor; fill: none}\n."+s+"{"+u.style_font(i)+"}\n"),e+="</style>\n",e+='<path class="stroke" d="\n',g=1,t=0;t<=_;t++)e+="M"+l.toFixed(1)+" "+g.toFixed(1)+"h"+o.toFixed(1)+"\n",g+=c;for(h=l,t=0;t<=m;t++)e+="M"+h.toFixed(1)+" 1v"+(c*_).toFixed(1)+"\n",h+=y;for(e+='"/>\n',e+=x,g=1-.7*i.size;r=p.shift();)for(h=l,g+=c;n=r.shift();)":"==n[0]&&(e+='<text class="'+a+'" x="'+(h-5).toFixed(1)+'" y="'+g.toFixed(1)+'" style="font-weight:bold;font-size:'+(1.6*i.size).toFixed(1)+'px">:</text>\n'),":"==n.slice(-1)&&(e+='<text class="'+a+'" x="'+(h+5).toFixed(1)+'" y="'+g.toFixed(1)+'" style="font-weight:bold;font-size:'+(1.6*i.size).toFixed(1)+'px">:</text>\n'),h+=y;return e+"</svg>"}())}else t(e,r,n)},set_hooks:function(t){t.do_begin_end=abc2svg.grid3.do_begin_end.bind(t,t.do_begin_end)}},abc2svg.modules.hooks.push(abc2svg.grid3.set_hooks),abc2svg.modules.begingrid.loaded=!0,abc2svg.grid2={do_grid:function(){var t,e,r,n,i,s,a=this.get_voice_tb();for(e=0;e<a.length;e++)if((r=a[e]).grid2)for(r.clef.invis=!0,r.key.k_sf=r.key.k_a_acc=0,r.staffnonote=2,t=r.sym;t;t=t.next)if(delete t.a_dd,t.dur)if(t.invis=!0,delete t.sl1,delete t.tie_s,t.tf&&(t.tf[0]=1),t.a_gch){for(n=0;n<t.a_gch.length;n++)if(gch=t.a_gch[n],"g"==gch.type){i=t.a_gch;break}}else t.time==s&&(t.a_gch=i);else t.bar_type&&(s=t.time)},draw_chosym:function(t){var e,r;for(this.set_dscale(t.st),e=0;e<t.a_gch.length;e++)"g"==(r=t.a_gch[e]).type&&(this.use_font(r.font),this.set_font(r.font),this.xy_str(t.x+r.x,r.y+6,r.text))},draw_gchord:function(t,e,r,n){e.p_v.grid2?abc2svg.grid2.draw_chosym.call(this,e):t(e,r,n)},output_music:function(t){abc2svg.grid2.do_grid.call(this),t()},set_fmt:function(t,e,r){if("grid2"!=e)t(e,r);else{var n=this.get_curvoice();n&&(this.set_v_param("stafflines","..."),n.grid2=r)}},set_hooks:function(t){t.draw_gchord=abc2svg.grid2.draw_gchord.bind(t,t.draw_gchord),t.output_music=abc2svg.grid2.output_music.bind(t,t.output_music),t.set_format=abc2svg.grid2.set_fmt.bind(t,t.set_format)}},abc2svg.modules.hooks.push(abc2svg.grid2.set_hooks),abc2svg.modules.grid2.loaded=!0,abc2svg.grid={do_grid:function(){var t,e,r,n=abc2svg.C,i=this.get_tsfirst(),s=this.get_voice_tb(),a=this.cfmt(),o=a.grid;function c(t){var e=n.BLEN/4;return t.a_meter[0]&&"C"!=t.a_meter[0].top[0]&&t.a_meter[0].bot?(e=n.BLEN/t.a_meter[0].bot[0]|0,8==t.a_meter[0].bot[0]&&t.a_meter[0].top[0]%3==0&&(e=n.BLEN/8*3),e):e}var l,u,f,$,h,p,d,_,m,y,g,v,b,A=[],x=[],w=[];for(t=this.get_img(),u=c(s[0].meter),m=s[0].meter.wmeasure,a.gridfont||this.param_set_font("gridfont","serif 16"),_=this.get_font("grid"),e=this.font_class(_),r=e+" mid",this.set_font("grid"),f=h=d=v=0,A.push("|"),l=i;l;l=l.ts_next){for(;l.time>f;)h<3&&h++,f+=u;switch(l.type){case n.NOTE:case n.REST:if(l.a_gch)for($=0;$<l.a_gch.length;$++)if("g"==l.a_gch[$].type){w[h]||(w[h]=l.a_gch[$].text,(g=this.strwh(w[h])[0])>v&&(v=g),d++);break}break;case n.BAR:if(y=o.norep?"|":l.bar_type,l.time<m)w.length?(x.push(w),A.push(y)):A[0]=y;else{if(!l.bar_num)break;x.push(w),A.push(y)}for(w=[],f=l.time,h=0,y.indexOf(":")>=0&&(b=!0);l.ts_next&&l.ts_next.type==n.BAR;)l=l.ts_next;break;case n.METER:u=c(l),m=l.wmeasure}}if(0!=d)if(0!=w.length&&(A.push(""),x.push(w)),v+=this.strwh(b?"    ":"  ")[0],p=s[this.get_top_v()],l={type:n.BLOCK,subtype:"ml",dur:0,time:0,p_v:p,v:p.v,st:p.st,text:function(n,i,s,c){var l,u,f,$,h,p,d,_,m,y,g,v,b="",A=[],x=o.n,w='" style="font-size:'+(.72*s.size).toFixed(1)+"px";function k(t,e,n,i,s){var a="";return t.length>1?(a+='<path class="stroke" stroke-width="1" d="M'+(e-c/2).toFixed(1)+" "+i.toFixed(1)+"l"+c.toFixed(1)+" -"+s.toFixed(1)+'"/>\n',t[1]?(a+='<path class="stroke" stroke-width="1" d="M'+(e-c/2).toFixed(1)+" "+(i-s).toFixed(1)+"l"+(c/2).toFixed(1)+" "+(s/2).toFixed(1)+'"/>\n',a+='<text class="'+r+w+'" x="'+(e-c/3).toFixed(1)+'" y="'+n.toFixed(1)+'">'+t[0]+"</text>\n",a+='<text class="'+r+w+'" x="'+e.toFixed(1)+'" y="'+(n-s/3).toFixed(1)+'">'+t[1]+"</text>\n"):a+='<text class="'+r+w+'" x="'+(e-.2*c).toFixed(1)+'" y="'+(n-s/4).toFixed(1)+'">'+t[0]+"</text>\n",t.length>=3&&(t[3]?(a+='<path class="stroke" stroke-width="1" d="M'+e.toFixed(1)+" "+(i-s/2).toFixed(1)+"l"+(c/2).toFixed(1)+" "+(s/2).toFixed(1)+'"/>\n',a+='<text class="'+r+w+'" x="'+e.toFixed(1)+'" y="'+(n+s/3).toFixed(1)+'">'+t[2]+"</text>\n",a+='<text class="'+r+w+'" x="'+(e+c/3).toFixed(1)+'" y="'+n.toFixed(1)+'">'+t[3]+"</text>\n"):a+='<text class="'+r+w+'" x="'+(e+.2*c).toFixed(1)+'" y="'+(n+s/4).toFixed(1)+'">'+t[2]+"</text>\n")):a+='<text class="'+r+'" x="'+e.toFixed(1)+'" y="'+n.toFixed(1)+'">'+t[0]+"</text>\n",a}if(function(){var t,e,r="-";for(t=0;t<n.length;t++)(e=n[t])[0]||(e[0]=r),0!=e.length&&(1!=e.length?2!=e.length?3!=e.length?(e[2]||(e[2]=e[1]||e[0]),r=e[3]):r=e[2]:(e[2]=e[1],e[1]=null,r=e[2]):r=e[0])}(),o.ls)for(p=i,i=[],l=0;l<o.ls.length;l++)for(u=(f=(f=o.ls[l]).indexOf("-")<0?[f,f]:f.split("-"))[0]-1;u<f[1]&&n[u];u++)A.push(n[u]),i.push(p[u]);else A=n;for(x<0&&(x=-x),x<3&&(x=A.length%6==0?6:8),x>A.length&&(x=A.length),_=2*s.size,c<1.4*_&&(c=1.4*_),(d=c*x)>t.width&&(x/=2,d/=2),v=1,g=1-_/2+.3*s.size,$=0,m=(t.width-d)/2,l=0;l<A.length;l++)(0==l||o.repbrk&&(":"==i[l].slice(-1)||":"==i[l][0])||u>=x)&&(g+=_,v+=_,y=m+c/2,u=0,$++),u++,b+=k(A[l],y,g,v,_),y+=c;for(h='<svg xmlns="http://www.w3.org/2000/svg" version="1.1"\n\txmlns:xlink="http://www.w3.org/1999/xlink"\n\tcolor="black" width="'+t.width.toFixed(0)+'px" height="'+(_*$+6).toFixed(0)+'px"',(l=a.bgcolor)&&(h+=' style="background-color: '+l+'"'),h+=">\n<style>\n.mid {text-anchor:middle}\n",(a.fullsvg||o.nomusic)&&(h+=".stroke {stroke: currentColor; fill: none}\n."+e+" {"+this.style_font(s)+"}\n"),h+="</style>\n",h+='<path class="stroke" d="\n',g=1,l=0;l<=$;l++)h+="M"+m.toFixed(1)+" "+g.toFixed(1)+"h"+d.toFixed(1)+"\n",g+=_;for(y=m,l=0;l<=x;l++)h+="M"+y.toFixed(1)+" 1v"+(_*$).toFixed(1)+"\n",y+=c;for(h+='"/>\n',h+=b,g=1-_/2+.3*s.size,y=m,l=0;l<i.length;l++)":"==(p=i[l])[0]&&(h+='<text class="'+r+'" x="'+(y-5).toFixed(1)+'" y="'+g.toFixed(1)+'" style="font-weight:bold;font-size:'+(s.size+2).toFixed(1)+'px">:</text>\n'),(0==l||o.repbrk&&(":"==i[l].slice(-1)||":"==i[l][0])||u>=x)&&(g+=_,y=m,u=0),u++,":"==p.slice(-1)&&(h+='<text class="'+r+'" x="'+(y+5).toFixed(1)+'" y="'+g.toFixed(1)+'" style="font-weight:bold;font-size:'+(s.size+2).toFixed(1)+'px">:</text>\n'),y+=c;return h+"</svg>"}.call(this,x,A,_,v)},o.nomusic)this.set_tsfirst(l);else if(a.grid.n<0){for(var k=i;k.ts_next;k=k.ts_next);l.time=k.time,l.prev=p.last_sym,l.ts_prev=k,p.last_sym.next=l,k.ts_next=l}else l.time=0,l.next=p.sym,l.ts_next=i,i.ts_prev=l,this.set_tsfirst(l),p.sym.prev=l,p.sym=l},output_music:function(t){this.cfmt().grid&&abc2svg.grid.do_grid.call(this),t()},set_fmt:function(t,e,r){if("grid"!=e)t(e,r);else{r||(r="1"),r=r.split(/\s+/);var n={n:Number(r.shift())};if(isNaN(n.n)){if(r.length)return void this.syntax(1,this.errs.bad_val,"%%grid");n.n=1}for(;r.length;){var i=r.shift();"norepeat"==i?n.norep=!0:"nomusic"==i?n.nomusic=!0:"repbrk"==i?n.repbrk=!0:"include="==i.slice(0,8)&&(n.ls=i.slice(8).split(","))}this.cfmt().grid=n}},set_hooks:function(t){t.output_music=abc2svg.grid.output_music.bind(t,t.output_music),t.set_format=abc2svg.grid.set_fmt.bind(t,t.set_format)}},abc2svg.modules.hooks.push(abc2svg.grid.set_hooks),abc2svg.modules.grid.loaded=!0,abc2svg.combine={comb_v:function(){var t,e,r=abc2svg.C,n=[];function i(t){var e,n=t.ts_next;return!(!n||n.type!=r.NOTE&&n.type!=r.REST)&&(n.v!=t.v&&n.st==t.st&&n.time==t.time&&n.dur==t.dur&&(!(t.combine<=0&&n.type!=t.type)&&((!t.a_gch||!n.a_gch)&&(t.type==r.REST?!(t.type==n.type&&t.invis&&!n.invis):!n.a_ly&&(n.beam_st==t.beam_st&&n.beam_end==t.beam_end&&(e=n.nhd,!(t.combine<=1&&t.notes[0].pit<=n.notes[e].pit+1)))))))}function s(t,e){var n,i,s;for(s=0;s<=e.nhd;s++)e.notes[s].s=t;if(Array.prototype.push.apply(t.notes,e.notes),t.nhd=n=t.notes.length-1,t.notes.sort(abc2svg.pitcmp),t.combine>=3){for(s=n;s>0;s--)t.notes[s].pit==t.notes[s-1].pit&&t.notes[s].acc==t.notes[s-1].acc&&t.notes.splice(s,1);t.nhd=n=t.notes.length-1}t.ymx=3*(t.notes[n].pit-18)+4,t.ymn=3*(t.notes[0].pit-18)-4,(7&(i=t.notes[0].tie_ty))==r.SL_AUTO&&(t.notes[0].tie_ty=r.SL_BELOW|i&r.SL_DOTTED),(7&(i=t.notes[n].tie_ty))==r.SL_AUTO&&(t.notes[n].tie_ty=r.SL_ABOVE|i&r.SL_DOTTED)}function a(t){for(var e;t.nhd,(e=t.ts_next).nhd,t.type!=e.type?e.type!=r.REST&&(t=(e=t).ts_next):t.type==r.REST?t.invis&&!e.invis&&delete t.invis:(s.call(this,t,e),e.tie_s&&(t.tie_s=e.tie_s)),e.sls&&(t.sls?Array.prototype.push.apply(t.sls,e.sls):t.sls=e.sls),e.sl1&&(t.sl1=!0),e.a_gch&&(t.a_gch=e.a_gch),e.a_dd&&(t.a_dd?Array.prototype.push.apply(t.a_dd,e.a_dd):t.a_dd=e.a_dd),n.push({s:e,r:t}),this.unlksym(e),!t.in_tuplet&&i.call(this,t););}function o(t){for(var e=t.tie_s,r=n.length;--r>=0;)if(n[r].s==e){t.tie_s=n[r].r;break}}for(t=this.get_tsfirst();t;t=t.ts_next){switch(t.type){case r.REST:if(null==t.combine||t.combine<0)continue;i.call(this,t)&&a.call(this,t);continue;default:continue;case r.NOTE:if(null==t.combine||t.combine<=0)continue}if(t.beam_st)if(t.beam_end)i.call(this,t)&&a.call(this,t);else{for(e=t;;){if(!i.call(this,e)){e=null;break}if(e.beam_end)break;do{e=e.next}while(e.type!=r.NOTE&&e.type!=r.REST)}if(e)for(e=t;a.call(this,e),!e.beam_end;)do{e=e.next}while(e.type!=r.NOTE&&e.type!=r.REST)}}for(t=this.get_tsfirst();t;t=t.ts_next)t.tie_s&&o(t)},do_pscom:function(t,e){"voicecombine "==e.slice(0,13)?this.set_v_param("combine",e.split(/[ \t]/)[1]):t(e)},new_note:function(t,e,r){var n=this.get_curvoice(),i=t(e,r);return i&&i.notes&&null!=n.combine&&(i.combine=n.combine),i},set_stem_dir:function(t){t(),abc2svg.combine.comb_v.call(this)},set_vp:function(t,e){var r,n=this.get_curvoice();for(r=0;r<e.length;r++)if("combine="==e[r]){n.combine=e[r+1];break}t(e)},set_hooks:function(t){t.do_pscom=abc2svg.combine.do_pscom.bind(t,t.do_pscom),t.new_note=abc2svg.combine.new_note.bind(t,t.new_note),t.set_stem_dir=abc2svg.combine.set_stem_dir.bind(t,t.set_stem_dir),t.set_vp=abc2svg.combine.set_vp.bind(t,t.set_vp)}},abc2svg.modules.hooks.push(abc2svg.combine.set_hooks),abc2svg.modules.voicecombine.loaded=!0,abc2svg.clip={get_clip:function(t){var e=abc2svg.C;function r(t){var r,n=t.match(/(\d+)([a-z]?)(:\d+\/\d+)?/);if(n){if(n[2]&&(r=n[2].charCodeAt(0)-97),!n[3])return{m:n[1],t:0,sq:r};if((t=n[3].match(/:(\d+)\/(\d+)/))&&!(t[2]<1))return{m:n[1],t:t[1]*e.BLEN/t[2],sq:r}}}var n,i,s=t.split(/[ -]/);3==s.length?(n=s[1]?r(s[1]):{m:0,t:0},i=r(s[2]),n&&i?this.cfmt().clip=[n,i]:this.syntax(1,this.errs.bad_val,"%%clip")):this.syntax(1,this.errs.bad_val,"%%clip")},do_clip:function(){var t,e,r,n,i,s=abc2svg.C;function a(t,e){var r,n,i;if(e.m<=1){if(1==e.m){for(r=t;r&&(r.type!=s.BAR||0==r.time);r=r.ts_next);r.time<voice_tb[this.get_cur_sy().top_voice].meter.wmeasure&&(t=r)}}else{for(;t&&!(t.type==s.BAR&&t.bar_num>=e.m);t=t.ts_next);if(!t)return;if(e.sq){for(i=e.sq,t=t.ts_next;t&&(t.type!=s.BAR||t.bar_num!=e.m||0!=--i);t=t.ts_next);if(!t)return}}if(0==e.t)return t;for(n=t.time+e.t;t.time<n;)if(!(t=t.ts_next))return t;do{t=t.ts_prev}while(!t.seqst);return t}if(voice_tb=this.get_voice_tb(),cfmt=this.cfmt(),t=this.get_tsfirst(),cfmt.clip[0].m>0||cfmt.clip[0].t>0){if(!(t=a(t,cfmt.clip[0])))return void this.set_tsfirst(null);for(r=this.get_cur_sy(),e=this.get_tsfirst();e!=t;e=e.ts_next)switch(e.type){case s.CLEF:e.p_v.clef=e;break;case s.KEY:e.p_v.key=this.clone(e.as.u.key);break;case s.METER:e.p_v.meter=this.clone(e.as.u.meter);break;case s.STAVES:r=e.sy,this.set_cur_sy(r)}for(i=0;i<voice_tb.length;i++){for(n=voice_tb[i],e=t;e;e=e.ts_next)if(e.v==i){delete e.prev;break}n.sym=e}this.set_tsfirst(t),delete t.ts_prev}if(t=a(t,cfmt.clip[1])){do{if(!(t=t.ts_next))return}while(!t.seqst);for(i=0;i<voice_tb.length;i++){for(n=voice_tb[i],e=t.ts_prev;e;e=e.ts_prev)if(e.v==i){delete e.next;break}e||(n.sym=null)}delete t.ts_prev.ts_next}},do_pscom:function(t,e){"clip "==e.slice(0,5)?abc2svg.clip.get_clip.call(this,e):t(e)},set_bar_num:function(t){t(),this.cfmt().clip&&abc2svg.clip.do_clip.call(this)},set_hooks:function(t){t.do_pscom=abc2svg.clip.do_pscom.bind(t,t.do_pscom),t.set_bar_num=abc2svg.clip.set_bar_num.bind(t,t.set_bar_num)}},abc2svg.modules.hooks.push(abc2svg.clip.set_hooks),abc2svg.modules.clip.loaded=!0,abc2svg.psvg={do_begin_end:function(t,e,r,n){"ps"==e?"nosvg"!=r&&(this.psvg||(this.psvg=new Psvg(this)),this.psvg.ps_eval.call(this.psvg,n)):t(e,r,n)},psdeco:function(t,e,r,n,i){return!!this.psvg&&this.psvg.psdeco.call(this.psvg,e,r,n,i)},psxygl:function(t,e,r,n){return!!this.psvg&&this.psvg.psxygl.call(this.psvg,e,r,n)},set_hooks:function(t){t.do_begin_end=abc2svg.psvg.do_begin_end.bind(t,t.do_begin_end),t.psdeco=abc2svg.psvg.psdeco.bind(t,t.psdeco),t.psxygl=abc2svg.psvg.psxygl.bind(t,t.psxygl)}},abc2svg.modules.hooks.push(abc2svg.psvg.set_hooks),abc2svg.modules.beginps.loaded=!0,abc2svg.break={get_break:function(t){var e,r,i,s=abc2svg.C,a=t.split(/[ ,]/),o=this.cfmt();for(o.break||(o.break=[]),n=1;n<a.length;n++)(e=a[n].match(/(\d+)([a-z]?)(:\d+\/\d+)?/))?(e[2]&&(i=e[2].charCodeAt(0)-97),e[3]?!(r=e[3].match(/:(\d+)\/(\d+)/))||r[2]<1?this.syntax(1,"Bad denominator in %%break"):o.break.push({m:e[1],t:r[1]*s.BLEN/r[2],sq:i}):o.break.push({m:e[1],t:0,sq:i})):this.syntax(1,this.errs.bad_val,"%%break")},do_break:function(){var t,e,r,n,i,a=this.get_voice_tb();for(v=this.get_cur_sy().top_voice,s1=a[v].sym,cfmt=this.cfmt(),t=0;t<cfmt.break.length;t++){for(e=(n=cfmt.break[t]).m,s=s1;s&&s.bar_num!=e;s=s.next);if(s){if(n.sq){for(i=n.sq,s=s.ts_next;s&&(s.bar_num!=e||0!=--i);s=s.ts_next);if(!s)continue}if(r=n.t)for(r=s.time+r;s&&!(s.time>=r);s=s.next);else s=s.next;s&&(s.soln=!0)}}},do_pscom:function(t,e){"break "==e.slice(0,6)?abc2svg.break.get_break.call(this,e):t(e)},set_bar_num:function(t){t(),this.cfmt().break&&abc2svg.break.do_break.call(this)},set_hooks:function(t){t.do_pscom=abc2svg.break.do_pscom.bind(t,t.do_pscom),t.set_bar_num=abc2svg.break.set_bar_num.bind(t,t.set_bar_num)}},abc2svg.modules.hooks.push(abc2svg.break.set_hooks),abc2svg.modules.break.loaded=!0,abc2svg.ambitus={do_ambitus:function(){var t,e,r,n,i,s=abc2svg.C,a=this.get_voice_tb();for(e=0;e<a.length;e++)if(!(r=a[e]).second){for(n=100,i=-100,t=r.sym;t;t=t.next)t.type==s.NOTE&&(t.notes[t.nhd].pit>i&&(i=t.notes[t.nhd].pit),t.notes[0].pit<n&&(n=t.notes[0].pit));100!=n&&((t=r.clef).stem=1,t.head=s.FULL,t.stemless=!0,t.nhd=1,t.notes=[{dur:s.BLEN/4,pit:n,shhd:0},{dur:s.BLEN/4,pit:i,shhd:0}])}},draw_symbols:function(t,e){var r=this.get_staff_tb(),n=e.sym;null!=n.clef_type&&n.nhd>0&&(n.x-=26,this.set_scale(n),this.draw_note(n),n.notes[1].pit-n.notes[0].pit>4&&(this.xypath(n.x,3*(n.notes[1].pit-18)+r[n.st].y),this.out_svg("v"+(3*(n.notes[1].pit-n.notes[0].pit)).toFixed(1)+'" stroke-width=".6"/>\n')),n.x+=26,n.nhd=0,e.clef.nhd=0),t(e)},set_pitch:function(t,e){t(e),!e&&this.cfmt().ambitus&&abc2svg.ambitus.do_ambitus.call(this)},set_fmt:function(t,e,r){"ambitus"!=e?t(e,r):this.cfmt().ambitus=r},set_width:function(t,e){null!=e.clef_type&&e.nhd>0?(e.wl=40,e.wr=12):t(e)},set_hooks:function(t){t.draw_symbols=abc2svg.ambitus.draw_symbols.bind(t,t.draw_symbols),t.set_pitch=abc2svg.ambitus.set_pitch.bind(t,t.set_pitch),t.set_format=abc2svg.ambitus.set_fmt.bind(t,t.set_format),t.set_width=abc2svg.ambitus.set_width.bind(t,t.set_width)}},abc2svg.modules.hooks.push(abc2svg.ambitus.set_hooks),abc2svg.modules.ambitus.loaded=!0,abc2svg.temper={set_bar_num:function(t){if(t(),this.cfmt().temper){var e=this.get_voice_tb()[0];e.temper=new Float32Array(12);for(var r=0;r<12;r++)e.temper[r]=this.cfmt().temper[r]/100}},set_fmt:function(t,e,r){if("temperament"!=e)t(e,r);else{var n=new Float32Array(r.split(/ +/)),i=n.length;if(12==i){for(;--i>=0&&!isNaN(parseInt(n[i])););if(i<0)return void(this.cfmt().temper=n)}this.syntax(1,this.errs.bad_val,"%%temperament")}},set_hooks:function(t){t.set_bar_num=abc2svg.temper.set_bar_num.bind(t,t.set_bar_num),t.set_format=abc2svg.temper.set_fmt.bind(t,t.set_format)}},abc2svg.modules.hooks.push(abc2svg.temper.set_hooks),abc2svg.modules.temperament.loaded=!0,abc2svg.capo={gch_capo:function(t){for(var e,r,n=this.cfmt(),i=n.capo,s=0;;){if(!(e=t[s++]))return;if("g"==e.type)break}(r=Object.create(e)).capo=!1,r.text=this.gch_tr1(r.text,-abc2svg.ifb40[i%12]),this.capo_first||(this.capo_first=!0,r.text+="  (capo: "+i.toString()+")"),r.font=this.get_font(n.capofont?"capo":"annotation"),t.splice(s,0,r),e.capo=!0},gch_build:function(t,e){var r=this.get_a_gch();this.cfmt().capo&&r&&abc2svg.capo.gch_capo.call(this,r),t(e)},output_music:function(t){this.capo_first=!1,t()},set_fmt:function(t,e,r){"capo"!=e?t(e,r):this.cfmt().capo=r},set_hooks:function(t){t.gch_build=abc2svg.capo.gch_build.bind(t,t.gch_build),t.output_music=abc2svg.capo.output_music.bind(t,t.output_music),t.set_format=abc2svg.capo.set_fmt.bind(t,t.set_format)}},abc2svg.modules.hooks.push(abc2svg.capo.set_hooks),abc2svg.modules.capo.loaded=!0,abc2svg.sth={recal_beam:function(t,e){var r=this.get_staff_tb(),n=r[e.st].y,i=t.s2,s=r[i.st].y;for(e.sth&&(e.ys=e.sth),i.sth&&(i.ys=i.sth),t.a=(e.ys+n-i.ys-s)/(e.xs-i.xs),t.b=e.ys-e.xs*t.a+n;e.ys=t.a*e.xs+t.b-n,e.stem>0?e.ymx=e.ys+2.5:e.ymn=e.ys-2.5,(e=e.next)!=i;);},set_sth:function(){var t,e,r,n,i,s=this.get_voice_tb();for(r=0;r<s.length;r++)if(null==(i=s[r]).sth)for(n=[],t=i.sym;t;t=t.next)if(t.sth&&(n=t.sth,t.sth=null),!(0==n.length||t.nflags<=-2||t.stemless||!t.beam_st&&!t.beam_end)&&"*"!=(e=n.shift()))if("|"!=e)e=Number(e),!isNaN(e)&&e&&(t.stem>=0?(t.ys=t.y+e,t.ymx=t.ys+2.5|0):(t.ys=t.y-e,t.ymn=t.ys-2.5|0),t.sth=t.ys);else for(t=t.next;t&&!t.bar_type;t=t.next);},calculate_beam:function(t,e,r){var n=t(e,r);return n&&e.s2&&(r.sth||e.s2.sth)&&abc2svg.sth.recal_beam.call(this,e,r),n},new_note:function(t,e,r){var n=abc2svg.C,i=t(e,r),s=this.get_curvoice();return s.sth&&i&&i.type==n.NOTE&&(i.sth=s.sth,s.sth=null),i},set_fmt:function(t,e,r){if("sth"==e){var n=this.get_curvoice();return 2==this.parse.state&&this.goto_tune(),void(n&&(n.sth=r.split(/[ \t;-]+/)))}t(e,r)},set_stems:function(t){t(),abc2svg.sth.set_sth.call(this)},set_hooks:function(t){t.calculate_beam=abc2svg.sth.calculate_beam.bind(t,t.calculate_beam),t.new_note=abc2svg.sth.new_note.bind(t,t.new_note),t.set_format=abc2svg.sth.set_fmt.bind(t,t.set_format),t.set_stems=abc2svg.sth.set_stems.bind(t,t.set_stems)}},abc2svg.modules.hooks.push(abc2svg.sth.set_hooks),abc2svg.modules.sth.loaded=!0,abc2svg.soloffs={set_fmt:function(t,e,r){if("soloffs"!=e)t(e,r);else{var n,i,s=abc2svg.C,a=this.cfmt().soloffs={};for(r=r.split(/\s+/);r.length;)if(n=r.shift().split("="),i=Number(n[1]),!isNaN(i))switch(n[0]){case"part":a[s.PART]=i+10;break;case"tempo":a[s.TEMPO]=i+16;break;case"space":a[s.SPACE]=i}}},set_sym_glue:function(t,e){abc2svg.C;var r,n=this.get_tsfirst(),i=this.cfmt().soloffs;if(t(e),i)for(r=n;r&&!r.dur;r=r.ts_next)null!=i[r.type]&&(r.x=i[r.type])},set_hooks:function(t){t.set_sym_glue=abc2svg.soloffs.set_sym_glue.bind(t,t.set_sym_glue),t.set_format=abc2svg.soloffs.set_fmt.bind(t,t.set_format)}},abc2svg.modules.hooks.push(abc2svg.soloffs.set_hooks),abc2svg.modules.soloffs.loaded=!0,abc2svg.diag={do_diag:function(){var t,e,r,n=this.get_glyphs(),i=this.get_voice_tb();if(!n.fb){var s,a,o,c=this.get_decos();for(ns="CDEFGAB",ms=["","m","7","m7","maj7","sus4"],this.add_style("\n.diag {font:6px sans-serif}\n.frn {font:italic 7px sans-serif}"),s=0;s<ns.length;s++)for(a=0;a<ms.length;a++)c[o=ns[s]+ms[a]]="3 "+o+" 40 0 0";for(a=0;a<ms.length;a++)c[o="F"+ms[a]]="3 F#"+ms[a]+" 40 0 0";n.fb='<g id="fb">\n<path class="stroke" stroke-width="0.4" d="M-10 -34h20m0 6h-20m0 6h20m0 6h-20m0 6h20"/>\n<path class="stroke" stroke-width="0.5" d="M-10 -34v24m4 0v-24m4 0v24m4 0v-24m4 0v24m4 0v-24"/>\n</g>',n.nut='<path id="nut" class="stroke" stroke-width="1.6" d="M-10.2 -34.5h20.4"/>',n.barre='<path id="barre" class="stroke" stroke-width=".9" d="M-10.2 -31h20.4"/>',n.fr1='<text id="fr1" x="-20" y="-29" class="frn">fr1</text>',n.fr2='<text id="fr2" x="-20" y="-29" class="frn">fr2</text>',n.fr3='<text id="fr3" x="-20" y="-29" class="frn">fr3</text>',n.ddot='<circle id="ddot" class="fill" r="1.5"/>',n.C='<g id="C">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-8,-3,4" y="-36" class="diag">321</text>\n<use x="-6" y="-19" xlink:href="#ddot"/>\n<use x="-2" y="-25" xlink:href="#ddot"/>\n<use x="6" y="-31" xlink:href="#ddot"/>\n</g>',n.Cm='<g id="Cm">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr3"/>\n<use xlink:href="#fb"/>\n<text x="-4,0,4" y="-36" class="diag">342</text>\n<use x="2" y="-19" xlink:href="#ddot"/>\n<use x="-2" y="-19" xlink:href="#ddot"/>\n<use x="6" y="-25" xlink:href="#ddot"/>\n</g>',n.C7='<g id="C7">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-8,-4,0,4" y="-36" class="diag">3241</text>\n<use x="2" y="-19" xlink:href="#ddot"/>\n<use x="-6" y="-19" xlink:href="#ddot"/>\n<use x="-2" y="-25" xlink:href="#ddot"/>\n<use x="6" y="-31" xlink:href="#ddot"/>\n</g>',n.Cm7='<g id="Cm7">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr3"/>\n<use xlink:href="#fb"/>\n<text x="-12,-4,4" y="-36" class="diag">x32</text>\n<use x="-2" y="-19" xlink:href="#ddot"/>\n<use x="6" y="-25" xlink:href="#ddot"/>\n</g>',n.Cmaj7='<g id="Cmaj7">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-12,-8,-4" y="-36" class="diag">x21</text>\n<use x="-2" y="-25" xlink:href="#ddot"/>\n<use x="-6" y="-19" xlink:href="#ddot"/>\n</g>',n.Csus4='<g id="Csus4">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr3"/>\n<use xlink:href="#fb"/>\n<text x="-12,0,4" y="-36" class="diag">x34</text>\n<use x="6" y="-13" xlink:href="#ddot"/>\n<use x="2" y="-19" xlink:href="#ddot"/>\n</g>',n.D='<g id="D">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-12,0,4,8" y="-36" class="diag">x132</text>\n<use x="6" y="-19" xlink:href="#ddot"/>\n<use x="10" y="-25" xlink:href="#ddot"/>\n<use x="2" y="-25" xlink:href="#ddot"/>\n</g>',n.Dm='<g id="Dm">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-12,0,4,8" y="-36" class="diag">x231</text>\n<use x="6" y="-19" xlink:href="#ddot"/>\n<use x="2" y="-25" xlink:href="#ddot"/>\n<use x="10" y="-31" xlink:href="#ddot"/>\n</g>',n.D7='<g id="D7">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-12,0,4,8" y="-36" class="diag">x312</text>\n<use x="10" y="-25" xlink:href="#ddot"/>\n<use x="2" y="-25" xlink:href="#ddot"/>\n<use x="6" y="-31" xlink:href="#ddot"/>\n</g>',n.Dm7='<g id="Dm7">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-12,-8,0,4,8" y="-36" class="diag">xx211</text>\n<use x="2" y="-25" xlink:href="#ddot"/>\n<use x="10" y="-31" xlink:href="#ddot"/>\n<use x="6" y="-31" xlink:href="#ddot"/>\n</g>',n.Dmaj7='<g id="Dmaj7">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-12,-8,0,4,8" y="-36" class="diag">xx123</text>\n<use x="10" y="-25" xlink:href="#ddot"/>\n<use x="6" y="-25" xlink:href="#ddot"/>\n<use x="2" y="-25" xlink:href="#ddot"/>\n</g>',n.Dsus4='<g id="Dsus4">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-12,-8,0,4,8" y="-36" class="diag">xx123</text>\n<use x="10" y="-19" xlink:href="#ddot"/>\n<use x="6" y="-19" xlink:href="#ddot"/>\n<use x="2" y="-25" xlink:href="#ddot"/>\n</g>',n.E='<g id="E">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-8,-4,0" y="-36" class="diag">231</text>\n<use x="-2" y="-25" xlink:href="#ddot"/>\n<use x="-6" y="-25" xlink:href="#ddot"/>\n<use x="2" y="-31" xlink:href="#ddot"/>\n</g>',n.Em='<g id="Em">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-8,-4" y="-36" class="diag">23</text>\n<use x="-2" y="-25" xlink:href="#ddot"/>\n<use x="-6" y="-25" xlink:href="#ddot"/>\n</g>',n.E7='<g id="E7">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-8,0" y="-36" class="diag">21</text>\n<use x="2" y="-31" xlink:href="#ddot"/>\n<use x="-6" y="-25" xlink:href="#ddot"/>\n</g>',n.Em7='<g id="Em7">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-8" y="-36" class="diag">1</text>\n<use x="-6" y="-25" xlink:href="#ddot"/>\n</g>',n.Emaj7='<g id="Emaj7">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-8,-4,0" y="-36" class="diag">312</text>\n<use x="2" y="-31" xlink:href="#ddot"/>\n<use x="-2" y="-31" xlink:href="#ddot"/>\n<use x="-6" y="-25" xlink:href="#ddot"/>\n</g>',n.Esus4='<g id="Esus4">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-4,0" y="-36" class="diag">12</text>\n<use x="2" y="-25" xlink:href="#ddot"/>\n<use x="-2" y="-25" xlink:href="#ddot"/>\n</g>',n.F='<g id="F">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr1"/>\n<use xlink:href="#fb"/>\n<text x="-8,-4,0" y="-36" class="diag">342</text>\n<use x="-2" y="-19" xlink:href="#ddot"/>\n<use x="-6" y="-19" xlink:href="#ddot"/>\n<use x="2" y="-25" xlink:href="#ddot"/>\n</g>',n.Fm='<g id="Fm">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr1"/>\n<use xlink:href="#fb"/>\n<text x="-8,-4" y="-36" class="diag">34</text>\n<use x="-2" y="-19" xlink:href="#ddot"/>\n<use x="-6" y="-19" xlink:href="#ddot"/>\n</g>',n.F7='<g id="F7">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr1"/>\n<use xlink:href="#fb"/>\n<text x="-8,0" y="-36" class="diag">32</text>\n<use x="2" y="-25" xlink:href="#ddot"/>\n<use x="-6" y="-19" xlink:href="#ddot"/>\n</g>',n.Fm7='<g id="Fm7">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr1"/>\n<use xlink:href="#fb"/>\n<text x="-8" y="-36" class="diag">3</text>\n<use x="-6" y="-19" xlink:href="#ddot"/>\n</g>',n.Fmaj7='<g id="Fmaj7">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr1"/>\n<use xlink:href="#fb"/>\n<text x="-8,-4,0" y="-36" class="diag">423</text>\n<use x="2" y="-25" xlink:href="#ddot"/>\n<use x="-2" y="-25" xlink:href="#ddot"/>\n<use x="-6" y="-19" xlink:href="#ddot"/>\n</g>',n.Fsus4='<g id="Fsus4">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr1"/>\n<use xlink:href="#fb"/>\n<text x="-4,0" y="-36" class="diag">34</text>\n<use x="2" y="-19" xlink:href="#ddot"/>\n<use x="-2" y="-19" xlink:href="#ddot"/>\n</g>',n["F#"]='<g id="F#">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr2"/>\n<use xlink:href="#fb"/>\n<text x="-8,-4,0" y="-36" class="diag">342</text>\n<use x="-2" y="-19" xlink:href="#ddot"/>\n<use x="-6" y="-19" xlink:href="#ddot"/>\n<use x="2" y="-25" xlink:href="#ddot"/>\n</g>',n["F#m"]='<g id="F#m">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr2"/>\n<use xlink:href="#fb"/>\n<text x="-8,-4" y="-36" class="diag">34</text>\n<use x="-2" y="-19" xlink:href="#ddot"/>\n<use x="-6" y="-19" xlink:href="#ddot"/>\n</g>',n["F#7"]='<g id="F#7">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr2"/>\n<use xlink:href="#fb"/>\n<text x="-8,0" y="-36" class="diag">32</text>\n<use x="2" y="-25" xlink:href="#ddot"/>\n<use x="-6" y="-19" xlink:href="#ddot"/>\n</g>',n["F#m7"]='<g id="F#m7">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr2"/>\n<use xlink:href="#fb"/>\n<text x="-8" y="-36" class="diag">3</text>\n<use x="-6" y="-19" xlink:href="#ddot"/>\n</g>',n["F#maj7"]='<g id="F#maj7">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr2"/>\n<use xlink:href="#fb"/>\n<text x="-8,-4,0" y="-36" class="diag">423</text>\n<use x="2" y="-25" xlink:href="#ddot"/>\n<use x="-2" y="-25" xlink:href="#ddot"/>\n<use x="-6" y="-19" xlink:href="#ddot"/>\n</g>',n["F#sus4"]='<g id="F#sus4">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr2"/>\n<use xlink:href="#fb"/>\n<text x="-4,0" y="-36" class="diag">34</text>\n<use x="2" y="-19" xlink:href="#ddot"/>\n<use x="-2" y="-19" xlink:href="#ddot"/>\n</g>',n.G='<g id="G">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-12,-8,8" y="-36" class="diag">234</text>\n<use x="10" y="-19" xlink:href="#ddot"/>\n<use x="-10" y="-19" xlink:href="#ddot"/>\n<use x="-6" y="-25" xlink:href="#ddot"/>\n</g>',n.Gm='<g id="Gm">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr3"/>\n<use xlink:href="#fb"/>\n<text x="-8,-4" y="-36" class="diag">34</text>\n<use x="-2" y="-19" xlink:href="#ddot"/>\n<use x="-6" y="-19" xlink:href="#ddot"/>\n</g>',n.G7='<g id="G7">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-12,-8,8" y="-36" class="diag">321</text>\n<use x="-10" y="-19" xlink:href="#ddot"/>\n<use x="-6" y="-25" xlink:href="#ddot"/>\n<use x="10" y="-31" xlink:href="#ddot"/>\n</g>',n.Gm7='<g id="Gm7">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr3"/>\n<use xlink:href="#fb"/>\n<text x="-8" y="-36" class="diag">3</text>\n<use x="-6" y="-19" xlink:href="#ddot"/>\n</g>',n.Gmaj7='<g id="Gmaj7">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-12,-8,8" y="-36" class="diag">312</text>\n<use x="10" y="-25" xlink:href="#ddot"/>\n<use x="-6" y="-25" xlink:href="#ddot"/>\n<use x="-10" y="-19" xlink:href="#ddot"/>\n</g>',n.Gsus4='<g id="Gsus4">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr3"/>\n<use xlink:href="#fb"/>\n<text x="-4,0" y="-36" class="diag">34</text>\n<use x="2" y="-19" xlink:href="#ddot"/>\n<use x="-2" y="-19" xlink:href="#ddot"/>\n</g>',n.A='<g id="A">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-4,0,4" y="-36" class="diag">234</text>\n<use x="6" y="-25" xlink:href="#ddot"/>\n<use x="2" y="-25" xlink:href="#ddot"/>\n<use x="-2" y="-25" xlink:href="#ddot"/>\n</g>',n.Am='<g id="Am">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-4,0,4" y="-36" class="diag">231</text>\n<use x="2" y="-25" xlink:href="#ddot"/>\n<use x="-2" y="-25" xlink:href="#ddot"/>\n<use x="6" y="-31" xlink:href="#ddot"/>\n</g>',n.A7='<g id="A7">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-4,4" y="-36" class="diag">23</text>\n<use x="6" y="-25" xlink:href="#ddot"/>\n<use x="-2" y="-25" xlink:href="#ddot"/>\n</g>',n.Am7='<g id="Am7">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-4,4" y="-36" class="diag">21</text>\n<use x="6" y="-31" xlink:href="#ddot"/>\n<use x="-2" y="-25" xlink:href="#ddot"/>\n</g>',n.Amaj7='<g id="Amaj7">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-12,-4,0,4" y="-36" class="diag">x213</text>\n<use x="6" y="-25" xlink:href="#ddot"/>\n<use x="2" y="-31" xlink:href="#ddot"/>\n<use x="-2" y="-25" xlink:href="#ddot"/>\n</g>',n.Asus4='<g id="Asus4">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-12,0,4" y="-36" class="diag">x12</text>\n<use x="6" y="-19" xlink:href="#ddot"/>\n<use x="2" y="-25" xlink:href="#ddot"/>\n</g>',n.B='<g id="B">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr2"/>\n<use xlink:href="#fb"/>\n<text x="-4,0,4" y="-36" class="diag">234</text>\n<use x="6" y="-19" xlink:href="#ddot"/>\n<use x="2" y="-19" xlink:href="#ddot"/>\n<use x="-2" y="-19" xlink:href="#ddot"/>\n</g>',n.Bm='<g id="Bm">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr2"/>\n<use xlink:href="#fb"/>\n<text x="-4,0,4" y="-36" class="diag">341</text>\n<use x="6" y="-25" xlink:href="#ddot"/>\n<use x="2" y="-19" xlink:href="#ddot"/>\n<use x="-2" y="-19" xlink:href="#ddot"/>\n</g>',n.B7='<g id="B7">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-12,-8,-4,0,8" y="-36" class="diag">x2134</text>\n<use x="10" y="-25" xlink:href="#ddot"/>\n<use x="2" y="-25" xlink:href="#ddot"/>\n<use x="-6" y="-25" xlink:href="#ddot"/>\n<use x="-2" y="-31" xlink:href="#ddot"/>\n</g>',n.Bm7='<g id="Bm7">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr2"/>\n<use xlink:href="#fb"/>\n<text x="-12,0,8" y="-36" class="diag">x32</text>\n<use x="-2" y="-19" xlink:href="#ddot"/>\n<use x="6" y="-25" xlink:href="#ddot"/>\n</g>',n.Bmaj7='<g id="Bmaj7">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr2"/>\n<use xlink:href="#fb"/>\n<text x="-12,-4,0,4" y="-36" class="diag">x324</text>\n<use x="6" y="-19" xlink:href="#ddot"/>\n<use x="2" y="-25" xlink:href="#ddot"/>\n<use x="-2" y="-19" xlink:href="#ddot"/>\n</g>',n.Bsus4='<g id="Bsus4">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr2"/>\n<use xlink:href="#fb"/>\n<text x="-12,0,4" y="-36" class="diag">x34</text>\n<use x="6" y="-19" xlink:href="#ddot"/>\n<use x="2" y="-25" xlink:href="#ddot"/>\n</g>'}for(t=i[0].sym;t;t=t.next)if(t.a_gch)for(s=0;s<t.a_gch.length;s++)(e=t.a_gch[s])&&"g"==e.type&&!e.capo&&(r=e.otext||e.text,this.deco_cnv(r.split(/[ \t/]/,1),t,null))},output_music:function(t){this.cfmt().diag&&abc2svg.diag.do_diag.call(this),t()},set_fmt:function(t,e,r){"diagram"!=e?t(e,r):this.cfmt().diag=r},set_hooks:function(t){t.output_music=abc2svg.diag.output_music.bind(t,t.output_music),t.set_format=abc2svg.diag.set_fmt.bind(t,t.set_format)}},abc2svg.modules.hooks.push(abc2svg.diag.set_hooks),abc2svg.modules.diagram.loaded=!0,abc2svg.version=abc2svg.version+" Git: v1.20.10-37-gc7d7078",Opal.loaded(["./abc2svg-1.js"]),function(t){var e,r,n,i,s,a,o,c,l=t.top,u=[],f=t.nil,$=(t.const_get_qualified,t.const_get_relative),h=(t.breaker,t.slice,t.truthy),p=t.send,d=t.gvars,_=f;t.add_stubs(["$require","$[]","$>=","$length","$puts","$about_zupfnoter","$new","$exit","$mkdir_p","$first","$sort","$each","$clear_errors","$read","$message","$set_abc_input","$exist?","$parse","$apply_config","$load_music_model","$write","$to_json","$abc_model","$produce_pdfs","$basename","$join","$get_errors"]),global.window={document:{createElementNS:function(){return{}}}},global.navigator={},global.btoa=function(t){return Buffer.from(t).toString("base64")},global.atob=function(t){return Buffer.from(t,"base64").toString("binary")},jsPDF=require("../vendor/jspdf.node.debug.js"),Ajv=require("ajv"),neatJSON=require("./neatjson_js"),fs=require("fs"),glob=require("glob"),l.$require("opal"),l.$require("opal-platform"),l.$require("nodejs"),l.$require("nodejs/fileutils"),l.$require("vector2d"),l.$require("opal-neatjson"),l.$require("opal-ajv"),l.$require("consolelogger"),l.$require("harpnotes"),l.$require("abc_to_harpnotes_factory"),l.$require("abc2svg_to_harpnotes"),l.$require("opal-jspdf"),l.$require("opal-jszip"),l.$require("pdf_engine"),l.$require("init_conf"),l.$require("text_pane"),l.$require("command-controller"),l.$require("controller"),l.$require("controller-cli"),l.$require("confstack2"),l.$require("opal-abc2svg"),l.$require("version-prod"),l.$require("abc2svg-1.js"),n=h(e=$(u,"ARGV")["$[]"](0))?e:"*.abc",i=h(e=$(u,"ARGV")["$[]"](1))?e:".",s=$(u,"ARGV")["$[]"](2),h((o=$(u,"ARGV").$length(),c=2,"number"==typeof o&&"number"==typeof c?o>=c:o["$>="](c)))||(l.$puts('usage: node --max_old_space_size=4096 zupfnoter-cli.js "/tmp/zntest/*.abc" /tmp/xxxd'),l.$puts($(u,"CliController").$new().$about_zupfnoter()),l.$exit(0)),$(u,"FileUtils").$mkdir_p(i),l.$puts("processing "+$(u,"ARGV").$first()+" to "+i),_=$(u,"CliController").$new(),a=$(u,"Dir")["$[]"](n).$sort(),p(a,"each",[],((r=function(e){var n,a,o=r.$$s||this,c=f,l=f,m=f;null==d.log&&(d.log=f),null==e&&(e=f),d.log.$clear_errors();try{c=$(u,"File").$read(e)}catch(e){if(!t.rescue(e,[$(u,"Exception")]))throw e;l=e;try{o.$puts(l)}finally{t.pop_exception()}}return d.log.$message("processing: "+e),(_=$(u,"CliController").$new()).$set_abc_input(c),h($(u,"File")["$exist?"](s))&&(o.$puts("reading config"),m=$(u,"JSON").$parse($(u,"File").$read(s)),_.$apply_config(m)),_.$load_music_model(),$(u,"File").$write("x.json",_.$abc_model().$to_json()),a=_.$produce_pdfs("."),p(a,"each",[],((n=function(t,e){var r,s=n.$$s||this;null==t&&(t=f),null==e&&(e=f),r=i+"/"+t,s.$puts(t);var a=require("encoding").convert(e,"Latin-1");return fs.writeFileSync(r,a),f}).$$s=o,n.$$arity=2,n)),$(u,"File").$write(i+"/"+$(u,"File").$basename(e)+".err.log",d.log.$get_errors().$join("\n"))}).$$s=l,r.$$arity=1,r))}(Opal)},{"../vendor/jspdf.node.debug.js":88,"./neatjson_js":1,ajv:2,encoding:47,fs:void 0,glob:52,os:void 0,path:void 0,unxhr:85,util:void 0}],88:[function(t,e,r){"use strict";function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(r,"__esModule",{value:!0});var i,s,a,o,c,l,u,f,$,h,p,d,_,m,y,g,v=function(t){function r(e){if("object"!==n(e))throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var r={};this.subscribe=function(t,e,n){if(n=n||!1,"string"!=typeof t||"function"!=typeof e||"boolean"!=typeof n)throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");r.hasOwnProperty(t)||(r[t]={});var i=Math.random().toString(35);return r[t][i]=[e,!!n],i},this.unsubscribe=function(t){for(var e in r)if(r[e][t])return delete r[e][t],0===Object.keys(r[e]).length&&delete r[e],!0;return!1},this.publish=function(n){if(r.hasOwnProperty(n)){var i=Array.prototype.slice.call(arguments,1),s=[];for(var a in r[n]){var o=r[n][a];try{o[0].apply(e,i)}catch(e){t.console&&console.error("jsPDF PubSub Error",e.message,e)}o[1]&&s.push(a)}s.length&&s.forEach(this.unsubscribe)}},this.getTopics=function(){return r}}function i(e,s,a,o){var c={},l=[],u=1;"object"===n(e)&&(e=(c=e).orientation,s=c.unit||s,a=c.format||a,o=c.compress||c.compressPdf||o,l=c.filters||(!0===o?["FlateEncode"]:l),u="number"==typeof c.userUnit?Math.abs(c.userUnit):1),s=s||"mm",e=(""+(e||"P")).toLowerCase();var f=c.putOnlyUsedFonts||!0,$={},h={internal:{},__private__:{}};h.__private__.PubSub=r;var p="1.3",d=h.__private__.getPdfVersion=function(){return p},_=(h.__private__.setPdfVersion=function(t){p=t},{a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]}),m=(h.__private__.getPageFormats=function(){return _},h.__private__.getPageFormat=function(t){return _[t]});"string"==typeof a&&(a=m(a)),a=a||m("a4");var y,g=h.f2=h.__private__.f2=function(t){if(isNaN(t))throw new Error("Invalid argument passed to jsPDF.f2");return t.toFixed(2)},v=h.__private__.f3=function(t){if(isNaN(t))throw new Error("Invalid argument passed to jsPDF.f3");return t.toFixed(3)},b="00000000000000000000000000000000",A=h.__private__.getFileId=function(){return b},x=h.__private__.setFileId=function(t){return t=t||"12345678901234567890123456789012".split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),b=t};h.setFileId=function(t){return x(t),this},h.getFileId=function(){return A()};var w=h.__private__.convertDateToPDFDate=function(t){var e=t.getTimezoneOffset(),r=e<0?"+":"-",n=Math.floor(Math.abs(e/60)),i=Math.abs(e%60),s=[r,L(n),"'",L(i),"'"].join("");return["D:",t.getFullYear(),L(t.getMonth()+1),L(t.getDate()),L(t.getHours()),L(t.getMinutes()),L(t.getSeconds()),s].join("")},k=h.__private__.convertPDFDateToDate=function(t){var e=parseInt(t.substr(2,4),10),r=parseInt(t.substr(6,2),10)-1,n=parseInt(t.substr(8,2),10),i=parseInt(t.substr(10,2),10),s=parseInt(t.substr(12,2),10),a=parseInt(t.substr(14,2),10);parseInt(t.substr(16,2),10),parseInt(t.substr(20,2),10);return new Date(e,r,n,i,s,a,0)},E=h.__private__.setCreationDate=function(t){var e;if(void 0===t&&(t=new Date),"object"===n(t)&&"[object Date]"===Object.prototype.toString.call(t))e=w(t);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|\-0[0-9]|\-1[0-1])\'(0[0-9]|[1-5][0-9])\'?$/.test(t))throw new Error("Invalid argument passed to jsPDF.setCreationDate");e=t}return y=e},S=h.__private__.getCreationDate=function(t){var e=y;return"jsDate"===t&&(e=k(y)),e};h.setCreationDate=function(t){return E(t),this},h.getCreationDate=function(t){return S(t)};var N,I,C,O,B,M,P,F,L=h.__private__.padd2=function(t){return("0"+parseInt(t)).slice(-2)},T=!1,j=[],R=[],D=0,z=(h.__private__.setCustomOutputDestination=function(t){I=t},h.__private__.resetCustomOutputDestination=function(t){I=void 0},h.__private__.out=function(t){var e;return t="string"==typeof t?t:t.toString(),(e=void 0===I?T?j[N]:R:I).push(t),T||(D+=t.length+1),e}),U=h.__private__.write=function(t){return z(1===arguments.length?t.toString():Array.prototype.join.call(arguments," "))},q=h.__private__.getArrayBuffer=function(t){for(var e=t.length,r=new ArrayBuffer(e),n=new Uint8Array(r);e--;)n[e]=t.charCodeAt(e);return r},H=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]],Q=(h.__private__.getStandardFonts=function(t){return H},c.fontSize||16),Y=(h.__private__.setFontSize=h.setFontSize=function(t){return Q=t,this},h.__private__.getFontSize=h.getFontSize=function(){return Q}),G=c.R2L||!1,V=(h.__private__.setR2L=h.setR2L=function(t){return G=t,this},h.__private__.getR2L=h.getR2L=function(t){return G},h.__private__.setZoomMode=function(t){var e=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^\d*\.?\d*\%$/.test(t))C=t;else if(isNaN(t)){if(-1===e.indexOf(t))throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+t+'" is not recognized.');C=t}else C=parseInt(t,10)}),J=(h.__private__.getZoomMode=function(){return C},h.__private__.setPageMode=function(t){if(-1==[void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(t))throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+t+'" is not recognized.');O=t}),X=(h.__private__.getPageMode=function(){return O},h.__private__.setLayoutMode=function(t){if(-1==[void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(t))throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+t+'" is not recognized.');B=t}),W=(h.__private__.getLayoutMode=function(){return B},h.__private__.setDisplayMode=h.setDisplayMode=function(t,e,r){return V(t),X(e),J(r),this},{title:"",subject:"",author:"",keywords:"",creator:""}),K=(h.__private__.getDocumentProperty=function(t){if(-1===Object.keys(W).indexOf(t))throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return W[t]},h.__private__.getDocumentProperties=function(t){return W},h.__private__.setDocumentProperties=h.setProperties=h.setDocumentProperties=function(t){for(var e in W)W.hasOwnProperty(e)&&t[e]&&(W[e]=t[e]);return this},h.__private__.setDocumentProperty=function(t,e){if(-1===Object.keys(W).indexOf(t))throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return W[t]=e},0),Z=[],tt={},et={},rt=0,nt=[],it=[],st=new r(h),at=c.hotfixes||[],ot=h.__private__.newObject=function(){var t=ct();return lt(t,!0),t},ct=h.__private__.newObjectDeferred=function(){return Z[++K]=function(){return D},K},lt=function(t,e){return e="boolean"==typeof e&&e,Z[t]=D,e&&z(t+" 0 obj"),t},ut=h.__private__.newAdditionalObject=function(){var t={objId:ct(),content:""};return it.push(t),t},ft=ct(),$t=ct(),ht=h.__private__.decodeColorString=function(t){var e=t.split(" ");if(2===e.length&&("g"===e[1]||"G"===e[1])){var r=parseFloat(e[0]);e=[r,r,r,"r"]}for(var n="#",i=0;i<3;i++)n+=("0"+Math.floor(255*parseFloat(e[i])).toString(16)).slice(-2);return n},pt=h.__private__.encodeColorString=function(t){var e;"string"==typeof t&&(t={ch1:t});var r=t.ch1,i=t.ch2,s=t.ch3,a=t.ch4,o=(t.precision,"draw"===t.pdfColorType?["G","RG","K"]:["g","rg","k"]);if("string"==typeof r&&"#"!==r.charAt(0)){var c=new RGBColor(r);if(c.ok)r=c.toHex();else if(!/^\d*\.?\d*$/.test(r))throw new Error('Invalid color "'+r+'" passed to jsPDF.encodeColorString.')}if("string"==typeof r&&/^#[0-9A-Fa-f]{3}$/.test(r)&&(r="#"+r[1]+r[1]+r[2]+r[2]+r[3]+r[3]),"string"==typeof r&&/^#[0-9A-Fa-f]{6}$/.test(r)){var l=parseInt(r.substr(1),16);r=l>>16&255,i=l>>8&255,s=255&l}if(void 0===i||void 0===a&&r===i&&i===s)if("string"==typeof r)e=r+" "+o[0];else switch(t.precision){case 2:e=g(r/255)+" "+o[0];break;case 3:default:e=v(r/255)+" "+o[0]}else if(void 0===a||"object"===n(a)){if(a&&!isNaN(a.a)&&0===a.a)return e=["1.000","1.000","1.000",o[1]].join(" ");if("string"==typeof r)e=[r,i,s,o[1]].join(" ");else switch(t.precision){case 2:e=[g(r/255),g(i/255),g(s/255),o[1]].join(" ");break;default:case 3:e=[v(r/255),v(i/255),v(s/255),o[1]].join(" ")}}else if("string"==typeof r)e=[r,i,s,a,o[2]].join(" ");else switch(t.precision){case 2:e=[g(r/255),g(i/255),g(s/255),g(a/255),o[2]].join(" ");break;case 3:default:e=[v(r/255),v(i/255),v(s/255),v(a/255),o[2]].join(" ")}return e},dt=h.__private__.getFilters=function(){return l},_t=h.__private__.putStream=function(t){var e=(t=t||{}).data||"",r=t.filters||dt(),n=t.alreadyAppliedFilters||[],s=t.addLength1||!1,a=e.length,o={};!0===r&&(r=["FlateEncode"]);var c=t.additionalKeyValues||[],l=(o=void 0!==i.API.processDataByFilters?i.API.processDataByFilters(e,r):{data:e,reverseChain:[]}).reverseChain+(Array.isArray(n)?n.join(" "):n.toString());0!==o.data.length&&(c.push({key:"Length",value:o.data.length}),!0===s&&c.push({key:"Length1",value:a})),0!=l.length&&(l.split("/").length-1==1?c.push({key:"Filter",value:l}):c.push({key:"Filter",value:"["+l+"]"})),z("<<");for(var u=0;u<c.length;u++)z("/"+c[u].key+" "+c[u].value);z(">>"),0!==o.data.length&&(z("stream"),z(o.data),z("endstream"))},mt=h.__private__.putPage=function(t){t.mediaBox;var e=t.number,r=t.data,n=t.objId,i=t.contentsObjId;lt(n,!0);nt[N].mediaBox.topRightX,nt[N].mediaBox.bottomLeftX,nt[N].mediaBox.topRightY,nt[N].mediaBox.bottomLeftY;z("<</Type /Page"),z("/Parent "+t.rootDictionaryObjId+" 0 R"),z("/Resources "+t.resourceDictionaryObjId+" 0 R"),z("/MediaBox ["+parseFloat(g(t.mediaBox.bottomLeftX))+" "+parseFloat(g(t.mediaBox.bottomLeftY))+" "+g(nt[N].mediaBox.topRightX)+" "+g(nt[N].mediaBox.topRightY)+"]"),null!==t.cropBox&&z("/CropBox ["+g(t.cropBox.bottomLeftX)+" "+g(t.cropBox.bottomLeftY)+" "+g(t.cropBox.topRightX)+" "+g(t.cropBox.topRightY)+"]"),null!==t.bleedBox&&z("/BleedBox ["+g(t.bleedBox.bottomLeftX)+" "+g(t.bleedBox.bottomLeftY)+" "+g(t.bleedBox.topRightX)+" "+g(t.bleedBox.topRightY)+"]"),null!==t.trimBox&&z("/TrimBox ["+g(t.trimBox.bottomLeftX)+" "+g(t.trimBox.bottomLeftY)+" "+g(t.trimBox.topRightX)+" "+g(t.trimBox.topRightY)+"]"),null!==t.artBox&&z("/ArtBox ["+g(t.artBox.bottomLeftX)+" "+g(t.artBox.bottomLeftY)+" "+g(t.artBox.topRightX)+" "+g(t.artBox.topRightY)+"]"),"number"==typeof t.userUnit&&1!==t.userUnit&&z("/UserUnit "+t.userUnit),st.publish("putPage",{objId:n,pageContext:nt[e],pageNumber:e,page:r}),z("/Contents "+i+" 0 R"),z(">>"),z("endobj");var s=r.join("\n");return lt(i,!0),_t({data:s,filters:dt()}),z("endobj"),n},yt=h.__private__.putPages=function(){var t,e,r=[];for(t=1;t<=rt;t++)nt[t].objId=ct(),nt[t].contentsObjId=ct();for(t=1;t<=rt;t++)r.push(mt({number:t,data:j[t],objId:nt[t].objId,contentsObjId:nt[t].contentsObjId,mediaBox:nt[t].mediaBox,cropBox:nt[t].cropBox,bleedBox:nt[t].bleedBox,trimBox:nt[t].trimBox,artBox:nt[t].artBox,userUnit:nt[t].userUnit,rootDictionaryObjId:ft,resourceDictionaryObjId:$t}));lt(ft,!0),z("<</Type /Pages");var n="/Kids [";for(e=0;e<rt;e++)n+=r[e]+" 0 R ";z(n+"]"),z("/Count "+rt),z(">>"),z("endobj"),st.publish("postPutPages")},gt=function(){!function(){for(var t in tt)tt.hasOwnProperty(t)&&(!1===f||!0===f&&$.hasOwnProperty(t))&&(e=tt[t],st.publish("putFont",{font:e,out:z,newObject:ot,putStream:_t}),!0!==e.isAlreadyPutted&&(e.objectNumber=ot(),z("<<"),z("/Type /Font"),z("/BaseFont /"+e.postScriptName),z("/Subtype /Type1"),"string"==typeof e.encoding&&z("/Encoding /"+e.encoding),z("/FirstChar 32"),z("/LastChar 255"),z(">>"),z("endobj")));var e}(),st.publish("putResources"),lt($t,!0),z("<<"),function(){for(var t in z("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),z("/Font <<"),tt)tt.hasOwnProperty(t)&&(!1===f||!0===f&&$.hasOwnProperty(t))&&z("/"+t+" "+tt[t].objectNumber+" 0 R");z(">>"),z("/XObject <<"),st.publish("putXobjectDict"),z(">>")}(),z(">>"),z("endobj"),st.publish("postPutResources")},vt=function(t,e,r){et.hasOwnProperty(e)||(et[e]={}),et[e][r]=t},bt=function(t,e,r,n,i){i=i||!1;var s="F"+(Object.keys(tt).length+1).toString(10),a={id:s,postScriptName:t,fontName:e,fontStyle:r,encoding:n,isStandardFont:i,metadata:{}};return st.publish("addFont",{font:a,instance:this}),void 0!==s&&(tt[s]=a,vt(s,e,r)),s},At=h.__private__.pdfEscape=h.pdfEscape=function(t,e){return function(t,e){var r,n,i,s,a,o,c,l,u;if(i=(e=e||{}).sourceEncoding||"Unicode",a=e.outputEncoding,(e.autoencode||a)&&tt[M].metadata&&tt[M].metadata[i]&&tt[M].metadata[i].encoding&&(s=tt[M].metadata[i].encoding,!a&&tt[M].encoding&&(a=tt[M].encoding),!a&&s.codePages&&(a=s.codePages[0]),"string"==typeof a&&(a=s[a]),a)){for(c=!1,o=[],r=0,n=t.length;r<n;r++)(l=a[t.charCodeAt(r)])?o.push(String.fromCharCode(l)):o.push(t[r]),o[r].charCodeAt(0)>>8&&(c=!0);t=o.join("")}for(r=t.length;void 0===c&&0!==r;)t.charCodeAt(r-1)>>8&&(c=!0),r--;if(!c)return t;for(o=e.noBOM?[]:[254,255],r=0,n=t.length;r<n;r++){if((u=(l=t.charCodeAt(r))>>8)>>8)throw new Error("Character at position "+r+" of string '"+t+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");o.push(u),o.push(l-(u<<8))}return String.fromCharCode.apply(void 0,o)}(t,e).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},xt=h.__private__.beginPage=function(t,e){var r,n="string"==typeof e&&e.toLowerCase();if("string"==typeof t&&m(t.toLowerCase())&&(t=m(t.toLowerCase())[0],e=m(t.toLowerCase())[1]),Array.isArray(t)&&(e=t[1],t=t[0]),(isNaN(t)||isNaN(e))&&(t=a[0],e=a[1]),n){switch(n.substr(0,1)){case"l":e>t&&(n="s");break;case"p":t>e&&(n="s")}"s"===n&&(r=t,t=e,e=r)}(t>14400||e>14400)&&(console.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),t=Math.min(14400,t),e=Math.min(14400,e)),a=[t,e],T=!0,j[++rt]=[],nt[rt]={objId:0,contentsObjId:0,userUnit:Number(u),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(t),topRightY:Number(e)}},kt(rt)},wt=function(){xt.apply(this,arguments),Ht(qt),z(Kt),0!==ie&&z(ie+" J"),0!==ae&&z(ae+" j"),st.publish("addPage",{pageNumber:rt})},kt=function(t){t>0&&t<=rt&&(N=t)},Et=h.__private__.getNumberOfPages=h.getNumberOfPages=function(){return j.length-1},St=function(t,e,r){var n,i=void 0;return r=r||{},t=void 0!==t?t:tt[M].fontName,e=void 0!==e?e:tt[M].fontStyle,n=t.toLowerCase(),void 0!==et[n]&&void 0!==et[n][e]?i=et[n][e]:void 0!==et[t]&&void 0!==et[t][e]?i=et[t][e]:!1===r.disableWarning&&console.warn("Unable to look up font label for font '"+t+"', '"+e+"'. Refer to getFontList() for available fonts."),i||r.noFallback||null==(i=et.times[e])&&(i=et.times.normal),i},Nt=h.__private__.putInfo=function(){for(var t in ot(),z("<<"),z("/Producer (jsPDF "+i.version+")"),W)W.hasOwnProperty(t)&&W[t]&&z("/"+t.substr(0,1).toUpperCase()+t.substr(1)+" ("+At(W[t])+")");z("/CreationDate ("+y+")"),z(">>"),z("endobj")},It=h.__private__.putCatalog=function(t){var e=(t=t||{}).rootDictionaryObjId||ft;switch(ot(),z("<<"),z("/Type /Catalog"),z("/Pages "+e+" 0 R"),C||(C="fullwidth"),C){case"fullwidth":z("/OpenAction [3 0 R /FitH null]");break;case"fullheight":z("/OpenAction [3 0 R /FitV null]");break;case"fullpage":z("/OpenAction [3 0 R /Fit]");break;case"original":z("/OpenAction [3 0 R /XYZ null null 1]");break;default:var r=""+C;"%"===r.substr(r.length-1)&&(C=parseInt(C)/100),"number"==typeof C&&z("/OpenAction [3 0 R /XYZ null null "+g(C)+"]")}switch(B||(B="continuous"),B){case"continuous":z("/PageLayout /OneColumn");break;case"single":z("/PageLayout /SinglePage");break;case"two":case"twoleft":z("/PageLayout /TwoColumnLeft");break;case"tworight":z("/PageLayout /TwoColumnRight")}O&&z("/PageMode /"+O),st.publish("putCatalog"),z(">>"),z("endobj")},Ct=h.__private__.putTrailer=function(){z("trailer"),z("<<"),z("/Size "+(K+1)),z("/Root "+K+" 0 R"),z("/Info "+(K-1)+" 0 R"),z("/ID [ <"+b+"> <"+b+"> ]"),z(">>")},Ot=h.__private__.putHeader=function(){z("%PDF-"+p),z("%")},Bt=h.__private__.putXRef=function(){var t=1,e="0000000000";for(z("xref"),z("0 "+(K+1)),z("0000000000 65535 f "),t=1;t<=K;t++){"function"==typeof Z[t]?z((e+Z[t]()).slice(-10)+" 00000 n "):void 0!==Z[t]?z((e+Z[t]).slice(-10)+" 00000 n "):z("0000000000 00000 n ")}},Mt=h.__private__.buildDocument=function(){T=!1,K=0,D=0,R=[],Z=[],it=[],ft=ct(),$t=ct(),st.publish("buildDocument"),Ot(),yt(),function(){st.publish("putAdditionalObjects");for(var t=0;t<it.length;t++){var e=it[t];lt(e.objId,!0),z(e.content),z("endobj")}st.publish("postPutAdditionalObjects")}(),gt(),Nt(),It();var t=D;return Bt(),Ct(),z("startxref"),z(""+t),z("%%EOF"),T=!0,R.join("\n")},Pt=h.__private__.getBlob=function(t){return new Blob([q(t)],{type:"application/pdf"})},Ft=h.output=h.__private__.output=((F=function(e,r){r=r||{};var n=Mt();switch("string"==typeof r?r={filename:r}:r.filename=r.filename||"generated.pdf",e){case void 0:return n;case"save":h.save(r.filename);break;case"arraybuffer":return q(n);case"blob":return Pt(n);case"bloburi":case"bloburl":return t.URL&&t.URL.createObjectURL(Pt(n))||void 0;case"datauristring":case"dataurlstring":return"data:application/pdf;filename="+r.filename+";base64,"+btoa(n);case"dataurlnewwindow":var i='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring")+'"></iframe></body></html>',s=t.open();if(null!==s&&s.document.write(i),s||"undefined"==typeof safari)return s;case"datauri":case"dataurl":return t.document.location.href="data:application/pdf;filename="+r.filename+";base64,"+btoa(n);default:return null}}).foo=function(){try{return F.apply(this,arguments)}catch(n){var e=n.stack||"";~e.indexOf(" at ")&&(e=e.split(" at ")[1]);var r="Error in function "+e.split("\n")[0].split("<")[0]+": "+n.message;if(!t.console)throw new Error(r);t.console.error(r,n),t.alert&&alert(r)}},F.foo.bar=F,F.foo),Lt=function(t){return!0===Array.isArray(at)&&at.indexOf(t)>-1};switch(s){case"pt":P=1;break;case"mm":P=72/25.4;break;case"cm":P=72/2.54;break;case"in":P=72;break;case"px":P=1==Lt("px_scaling")?.75:96/72;break;case"pc":case"em":P=12;break;case"ex":P=6;break;default:throw new Error("Invalid unit: "+s)}E(),x();var Tt=h.__private__.getPageInfo=function(t){if(isNaN(t)||t%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:nt[t].objId,pageNumber:t,pageContext:nt[t]}},jt=h.__private__.getPageInfoByObjId=function(t){for(var e in nt)if(nt[e].objId===t)break;if(isNaN(t)||t%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");return Tt(e)},Rt=h.__private__.getCurrentPageInfo=function(){return{objId:nt[N].objId,pageNumber:N,pageContext:nt[N]}};h.addPage=function(){return wt.apply(this,arguments),this},h.setPage=function(){return kt.apply(this,arguments),this},h.insertPage=function(t){return this.addPage(),this.movePage(N,t),this},h.movePage=function(t,e){if(t>e){for(var r=j[t],n=nt[t],i=t;i>e;i--)j[i]=j[i-1],nt[i]=nt[i-1];j[e]=r,nt[e]=n,this.setPage(e)}else if(t<e){for(r=j[t],n=nt[t],i=t;i<e;i++)j[i]=j[i+1],nt[i]=nt[i+1];j[e]=r,nt[e]=n,this.setPage(e)}return this},h.deletePage=function(){return function(t){t>0&&t<=rt&&(j.splice(t,1),N>--rt&&(N=rt),this.setPage(N))}.apply(this,arguments),this};h.__private__.text=h.text=function(t,e,r,i){var s;"number"!=typeof t||"number"!=typeof e||"string"!=typeof r&&!Array.isArray(r)||(s=r,r=e,e=t,t=s);var a=arguments[3],o=arguments[4],c=arguments[5];if("object"===n(a)&&null!==a||("string"==typeof o&&(c=o,o=null),"string"==typeof a&&(c=a,a=null),"number"==typeof a&&(o=a,a=null),i={flags:a,angle:o,align:c}),(a=a||{}).noBOM=a.noBOM||!0,a.autoencode=a.autoencode||!0,isNaN(e)||isNaN(r)||null==t)throw new Error("Invalid arguments passed to jsPDF.text");if(0===t.length)return h;var l,u="",f="number"==typeof i.lineHeightFactor?i.lineHeightFactor:Ut,h=i.scope||this;function p(t){for(var e,r=t.concat(),n=[],i=r.length;i--;)"string"==typeof(e=r.shift())?n.push(e):Array.isArray(t)&&1===e.length?n.push(e[0]):n.push([e[0],e[1],e[2]]);return n}function d(t,e){var r;if("string"==typeof t)r=e(t)[0];else if(Array.isArray(t)){for(var n,i,s=t.concat(),a=[],o=s.length;o--;)"string"==typeof(n=s.shift())?a.push(e(n)[0]):Array.isArray(n)&&"string"===n[0]&&(i=e(n[0],n[1],n[2]),a.push([i[0],i[1],i[2]]));r=a}return r}var _=!1,m=!0;if("string"==typeof t)_=!0;else if(Array.isArray(t)){for(var y,b=t.concat(),A=[],x=b.length;x--;)("string"!=typeof(y=b.shift())||Array.isArray(y)&&"string"!=typeof y[0])&&(m=!1);_=m}if(!1===_)throw new Error('Type of text must be string or Array. "'+t+'" is not recognized.');var w=tt[M].encoding;"WinAnsiEncoding"!==w&&"StandardEncoding"!==w||(t=d(t,function(t,e,r){return[(n=t,n=n.split("\t").join(Array(i.TabLen||9).join(" ")),At(n,a)),e,r];var n})),"string"==typeof t&&(t=t.match(/[\r?\n]/)?t.split(/\r\n|\r|\n/g):[t]);var k=Q/h.internal.scaleFactor,E=k*(Ut-1);switch(i.baseline){case"bottom":r-=E;break;case"top":r+=k-E;break;case"hanging":r+=k-2*E;break;case"middle":r+=k/2-E}(U=i.maxWidth||0)>0&&("string"==typeof t?t=h.splitTextToSize(t,U):"[object Array]"===Object.prototype.toString.call(t)&&(t=h.splitTextToSize(t.join(" "),U)));var S={text:t,x:e,y:r,options:i,mutex:{pdfEscape:At,activeFontKey:M,fonts:tt,activeFontSize:Q}};st.publish("preProcessText",S),t=S.text;o=(i=S.options).angle;var N=h.internal.scaleFactor,I=[];if(o){o*=Math.PI/180;var C=Math.cos(o),O=Math.sin(o);I=[g(C),g(O),g(-1*O),g(C)]}void 0!==(D=i.charSpace)&&(u+=v(D*N)+" Tc\n");i.lang;var B=-1,P=void 0!==i.renderingMode?i.renderingMode:i.stroke,F=h.internal.getCurrentPageInfo().pageContext;switch(P){case 0:case!1:case"fill":B=0;break;case 1:case!0:case"stroke":B=1;break;case 2:case"fillThenStroke":B=2;break;case 3:case"invisible":B=3;break;case 4:case"fillAndAddForClipping":B=4;break;case 5:case"strokeAndAddPathForClipping":B=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":B=6;break;case 7:case"addToPathForClipping":B=7}var L=void 0!==F.usedRenderingMode?F.usedRenderingMode:-1;-1!==B?u+=B+" Tr\n":-1!==L&&(u+="0 Tr\n"),-1!==B&&(F.usedRenderingMode=B);c=i.align||"left";var T=Q*f,j=h.internal.pageSize.getWidth(),R=(N=h.internal.scaleFactor,tt[M]),D=i.charSpace||re,U=i.maxWidth||0,q=(a={},[]);if("[object Array]"===Object.prototype.toString.call(t)){var H,Y;A=p(t);"left"!==c&&(Y=A.map(function(t){return h.getStringUnitWidth(t,{font:R,charSpace:D,fontSize:Q})*Q/N}));var V,J=Math.max.apply(Math,Y),X=0;if("right"===c){e-=Y[0],t=[];var W=0;for(x=A.length;W<x;W++)J-Y[W],0===W?(V=Vt(e),H=Jt(r)):(V=(X-Y[W])*N,H=-T),t.push([A[W],V,H]),X=Y[W]}else if("center"===c){e-=Y[0]/2,t=[];for(W=0,x=A.length;W<x;W++)(J-Y[W])/2,0===W?(V=Vt(e),H=Jt(r)):(V=(X-Y[W])/2*N,H=-T),t.push([A[W],V,H]),X=Y[W]}else if("left"===c){t=[];for(W=0,x=A.length;W<x;W++)H=0===W?Jt(r):-T,V=0===W?Vt(e):0,t.push(A[W])}else{if("justify"!==c)throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');t=[];for(U=0!==U?U:j,W=0,x=A.length;W<x;W++)H=0===W?Jt(r):-T,V=0===W?Vt(e):0,W<x-1&&q.push(((U-Y[W])/(A[W].split(" ").length-1)*N).toFixed(2)),t.push([A[W],V,H])}}!0===("boolean"==typeof i.R2L?i.R2L:G)&&(t=d(t,function(t,e,r){return[t.split("").reverse().join(""),e,r]}));S={text:t,x:e,y:r,options:i,mutex:{pdfEscape:At,activeFontKey:M,fonts:tt,activeFontSize:Q}};st.publish("postProcessText",S),t=S.text,l=S.mutex.isHex;A=p(t);t=[];var K,Z,et,rt=0,nt=(x=A.length,"");for(W=0;W<x;W++)nt="",Array.isArray(A[W])?(K=parseFloat(A[W][1]),Z=parseFloat(A[W][2]),et=(l?"<":"(")+A[W][0]+(l?">":")"),rt=1):(K=Vt(e),Z=Jt(r),et=(l?"<":"(")+A[W]+(l?">":")")),void 0!==q&&void 0!==q[W]&&(nt=q[W]+" Tw\n"),0!==I.length&&0===W?t.push(nt+I.join(" ")+" "+K.toFixed(2)+" "+Z.toFixed(2)+" Tm\n"+et):1===rt||0===rt&&0===W?t.push(nt+K.toFixed(2)+" "+Z.toFixed(2)+" Td\n"+et):t.push(nt+et);t=0===rt?t.join(" Tj\nT* "):t.join(" Tj\n"),t+=" Tj\n";var it="BT\n/"+M+" "+Q+" Tf\n"+(Q*f).toFixed(2)+" TL\n"+te+"\n";return it+=u,it+=t,z(it+="ET"),$[M]=!0,h},h.__private__.lstext=h.lstext=function(t,e,r,n){return console.warn("jsPDF.lstext is deprecated"),this.text(t,e,r,{charSpace:n})},h.__private__.clip=h.clip=function(t){z("evenodd"===t?"W*":"W"),z("n")},h.__private__.clip_fixed=h.clip_fixed=function(t){console.log("clip_fixed is deprecated"),h.clip(t)};var Dt=h.__private__.isValidStyle=function(t){var e=!1;return-1!==[void 0,null,"S","F","DF","FD","f","f*","B","B*"].indexOf(t)&&(e=!0),e},zt=h.__private__.getStyle=function(t){var e="S";return"F"===t?e="f":"FD"===t||"DF"===t?e="B":"f"!==t&&"f*"!==t&&"B"!==t&&"B*"!==t||(e=t),e};h.__private__.line=h.line=function(t,e,r,n){if(isNaN(t)||isNaN(e)||isNaN(r)||isNaN(n))throw new Error("Invalid arguments passed to jsPDF.line");return this.lines([[r-t,n-e]],t,e)},h.__private__.lines=h.lines=function(t,e,r,n,i,s){var a,o,c,l,u,f,$,h,p,d,_,m;if("number"==typeof t&&(m=r,r=e,e=t,t=m),n=n||[1,1],s=s||!1,isNaN(e)||isNaN(r)||!Array.isArray(t)||!Array.isArray(n)||!Dt(i)||"boolean"!=typeof s)throw new Error("Invalid arguments passed to jsPDF.lines");for(z(v(Vt(e))+" "+v(Jt(r))+" m "),a=n[0],o=n[1],l=t.length,d=e,_=r,c=0;c<l;c++)2===(u=t[c]).length?(d=u[0]*a+d,_=u[1]*o+_,z(v(Vt(d))+" "+v(Jt(_))+" l")):(f=u[0]*a+d,$=u[1]*o+_,h=u[2]*a+d,p=u[3]*o+_,d=u[4]*a+d,_=u[5]*o+_,z(v(Vt(f))+" "+v(Jt($))+" "+v(Vt(h))+" "+v(Jt(p))+" "+v(Vt(d))+" "+v(Jt(_))+" c"));return s&&z(" h"),null!==i&&z(zt(i)),this},h.__private__.rect=h.rect=function(t,e,r,n,i){if(isNaN(t)||isNaN(e)||isNaN(r)||isNaN(n)||!Dt(i))throw new Error("Invalid arguments passed to jsPDF.rect");return z([g(Vt(t)),g(Jt(e)),g(r*P),g(-n*P),"re"].join(" ")),null!==i&&z(zt(i)),this},h.__private__.triangle=h.triangle=function(t,e,r,n,i,s,a){if(isNaN(t)||isNaN(e)||isNaN(r)||isNaN(n)||isNaN(i)||isNaN(s)||!Dt(a))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[r-t,n-e],[i-r,s-n],[t-i,e-s]],t,e,[1,1],a,!0),this},h.__private__.roundedRect=h.roundedRect=function(t,e,r,n,i,s,a){if(isNaN(t)||isNaN(e)||isNaN(r)||isNaN(n)||isNaN(i)||isNaN(s)||!Dt(a))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var o=4/3*(Math.SQRT2-1);return this.lines([[r-2*i,0],[i*o,0,i,s-s*o,i,s],[0,n-2*s],[0,s*o,-i*o,s,-i,s],[2*i-r,0],[-i*o,0,-i,-s*o,-i,-s],[0,2*s-n],[0,-s*o,i*o,-s,i,-s]],t+i,e,[1,1],a),this},h.__private__.ellipse=h.ellipse=function(t,e,r,n,i){if(isNaN(t)||isNaN(e)||isNaN(r)||isNaN(n)||!Dt(i))throw new Error("Invalid arguments passed to jsPDF.ellipse");var s=4/3*(Math.SQRT2-1)*r,a=4/3*(Math.SQRT2-1)*n;return z([g(Vt(t+r)),g(Jt(e)),"m",g(Vt(t+r)),g(Jt(e-a)),g(Vt(t+s)),g(Jt(e-n)),g(Vt(t)),g(Jt(e-n)),"c"].join(" ")),z([g(Vt(t-s)),g(Jt(e-n)),g(Vt(t-r)),g(Jt(e-a)),g(Vt(t-r)),g(Jt(e)),"c"].join(" ")),z([g(Vt(t-r)),g(Jt(e+a)),g(Vt(t-s)),g(Jt(e+n)),g(Vt(t)),g(Jt(e+n)),"c"].join(" ")),z([g(Vt(t+s)),g(Jt(e+n)),g(Vt(t+r)),g(Jt(e+a)),g(Vt(t+r)),g(Jt(e)),"c"].join(" ")),null!==i&&z(zt(i)),this},h.__private__.circle=h.circle=function(t,e,r,n){if(isNaN(t)||isNaN(e)||isNaN(r)||!Dt(n))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(t,e,r,r,n)};h.setFont=function(t,e){return M=St(t,e,{disableWarning:!1}),this},h.setFontStyle=h.setFontType=function(t){return M=St(void 0,t),this};h.__private__.getFontList=h.getFontList=function(){var t,e,r,n={};for(t in et)if(et.hasOwnProperty(t))for(e in n[t]=r=[],et[t])et[t].hasOwnProperty(e)&&r.push(e);return n};h.addFont=function(t,e,r,n){bt.call(this,t,e,r,n=n||"Identity-H")};var Ut,qt=c.lineWidth||.200025,Ht=h.__private__.setLineWidth=h.setLineWidth=function(t){return z((t*P).toFixed(2)+" w"),this},Qt=(h.__private__.setLineDash=i.API.setLineDash=function(t,e){if(t=t||[],e=e||0,isNaN(e)||!Array.isArray(t))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return t=t.map(function(t){return(t*P).toFixed(3)}).join(" "),e=parseFloat((e*P).toFixed(3)),z("["+t+"] "+e+" d"),this},h.__private__.getLineHeight=h.getLineHeight=function(){return Q*Ut}),Yt=(Qt=h.__private__.getLineHeight=h.getLineHeight=function(){return Q*Ut},h.__private__.setLineHeightFactor=h.setLineHeightFactor=function(t){return"number"==typeof(t=t||1.15)&&(Ut=t),this}),Gt=h.__private__.getLineHeightFactor=h.getLineHeightFactor=function(){return Ut};Yt(c.lineHeight);var Vt=h.__private__.getHorizontalCoordinate=function(t){return t*P},Jt=h.__private__.getVerticalCoordinate=function(t){return nt[N].mediaBox.topRightY-nt[N].mediaBox.bottomLeftY-t*P},Xt=h.__private__.getHorizontalCoordinateString=function(t){return g(t*P)},Wt=h.__private__.getVerticalCoordinateString=function(t){return g(nt[N].mediaBox.topRightY-nt[N].mediaBox.bottomLeftY-t*P)},Kt=c.strokeColor||"0 G",Zt=(h.__private__.getStrokeColor=h.getDrawColor=function(){return ht(Kt)},h.__private__.setStrokeColor=h.setDrawColor=function(t,e,r,n){return Kt=pt({ch1:t,ch2:e,ch3:r,ch4:n,pdfColorType:"draw",precision:2}),z(Kt),this},c.fillColor||"0 g"),te=(h.__private__.getFillColor=h.getFillColor=function(){return ht(Zt)},h.__private__.setFillColor=h.setFillColor=function(t,e,r,n){return Zt=pt({ch1:t,ch2:e,ch3:r,ch4:n,pdfColorType:"fill",precision:2}),z(Zt),this},c.textColor||"0 g"),ee=h.__private__.getTextColor=h.getTextColor=function(){return ht(te)},re=(h.__private__.setTextColor=h.setTextColor=function(t,e,r,n){return te=pt({ch1:t,ch2:e,ch3:r,ch4:n,pdfColorType:"text",precision:3}),this},c.charSpace||0),ne=h.__private__.getCharSpace=h.getCharSpace=function(){return re},ie=(h.__private__.setCharSpace=h.setCharSpace=function(t){if(isNaN(t))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return re=t,this},0);h.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2};h.__private__.setLineCap=h.setLineCap=function(t){var e=h.CapJoinStyles[t];if(void 0===e)throw new Error("Line cap style of '"+t+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return ie=e,z(e+" J"),this};var se,ae=0;h.__private__.setLineJoin=h.setLineJoin=function(t){var e=h.CapJoinStyles[t];if(void 0===e)throw new Error("Line join style of '"+t+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return ae=e,z(e+" j"),this},h.__private__.setMiterLimit=h.setMiterLimit=function(t){if(t=t||0,isNaN(t))throw new Error("Invalid argument passed to jsPDF.setMiterLimit");return se=parseFloat(g(t*P)),z(se+" M"),this};for(var oe in h.save=function(e,r){if(e=e||"generated.pdf",(r=r||{}).returnPromise=r.returnPromise||!1,!1!==r.returnPromise)return new Promise(function(r,n){try{var i=saveAs(Pt(Mt()),e);"function"==typeof saveAs.unload&&t.setTimeout&&setTimeout(saveAs.unload,911),r(i)}catch(t){n(t.message)}});saveAs(Pt(Mt()),e),"function"==typeof saveAs.unload&&t.setTimeout&&setTimeout(saveAs.unload,911)},i.API)i.API.hasOwnProperty(oe)&&("events"===oe&&i.API.events.length?function(t,e){var r,n,i;for(i=e.length-1;-1!==i;i--)r=e[i][0],n=e[i][1],t.subscribe.apply(t,[r].concat("function"==typeof n?[n]:n))}(st,i.API.events):h[oe]=i.API[oe]);return h.internal={pdfEscape:At,getStyle:zt,getFont:function(){return tt[St.apply(h,arguments)]},getFontSize:Y,getCharSpace:ne,getTextColor:ee,getLineHeight:Qt,getLineHeightFactor:Gt,write:U,getHorizontalCoordinate:Vt,getVerticalCoordinate:Jt,getCoordinateString:Xt,getVerticalCoordinateString:Wt,collections:{},newObject:ot,newAdditionalObject:ut,newObjectDeferred:ct,newObjectDeferredBegin:lt,getFilters:dt,putStream:_t,events:st,scaleFactor:P,pageSize:{getWidth:function(){return(nt[N].mediaBox.topRightX-nt[N].mediaBox.bottomLeftX)/P},setWidth:function(t){nt[N].mediaBox.topRightX=t*P+nt[N].mediaBox.bottomLeftX},getHeight:function(){return(nt[N].mediaBox.topRightY-nt[N].mediaBox.bottomLeftY)/P},setHeight:function(t){nt[N].mediaBox.topRightY=t*P+nt[N].mediaBox.bottomLeftY}},output:Ft,getNumberOfPages:Et,pages:j,out:z,f2:g,f3:v,getPageInfo:Tt,getPageInfoByObjId:jt,getCurrentPageInfo:Rt,getPDFVersion:d,hasHotfix:Lt},Object.defineProperty(h.internal.pageSize,"width",{get:function(){return(nt[N].mediaBox.topRightX-nt[N].mediaBox.bottomLeftX)/P},set:function(t){nt[N].mediaBox.topRightX=t*P+nt[N].mediaBox.bottomLeftX},enumerable:!0,configurable:!0}),Object.defineProperty(h.internal.pageSize,"height",{get:function(){return(nt[N].mediaBox.topRightY-nt[N].mediaBox.bottomLeftY)/P},set:function(t){nt[N].mediaBox.topRightY=t*P+nt[N].mediaBox.bottomLeftY},enumerable:!0,configurable:!0}),function(t){for(var e=0,r=H.length;e<r;e++){var n=bt(t[e][0],t[e][1],t[e][2],H[e][3],!0);$[n]=!0;var i=t[e][0].split("-");vt(n,i[0],i[1]||"")}st.publish("addFonts",{fonts:tt,dictionary:et})}(H),M="F1",wt(a,e),st.publish("initialized"),h}return i.API={events:[]},i.version="1.5.2","function"==typeof define&&define.amd?define("jsPDF",function(){return i}):void 0!==e&&e.exports?(e.exports=i,e.exports.jsPDF=i):t.jsPDF=i,i}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||"undefined"!=typeof global&&global||Function('return typeof this === "object" && this.content')()||Function("return this")());function b(t){var e,r,n,i,s,a=Math.floor,o=new Array(64),c=new Array(64),l=new Array(64),u=new Array(64),f=new Array(65535),$=new Array(65535),h=new Array(64),p=new Array(64),d=[],_=0,m=7,y=new Array(64),g=new Array(64),v=new Array(64),b=new Array(256),A=new Array(2048),x=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],w=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],k=[0,1,2,3,4,5,6,7,8,9,10,11],E=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],S=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],N=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],I=[0,1,2,3,4,5,6,7,8,9,10,11],C=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],O=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function B(t,e){for(var r=0,n=0,i=new Array,s=1;s<=16;s++){for(var a=1;a<=t[s];a++)i[e[n]]=[],i[e[n]][0]=r,i[e[n]][1]=s,n++,r++;r*=2}return i}function M(t){for(var e=t[0],r=t[1]-1;r>=0;)e&1<<r&&(_|=1<<m),r--,--m<0&&(255==_?(P(255),P(0)):P(_),m=7,_=0)}function P(t){d.push(t)}function F(t){P(t>>8&255),P(255&t)}function L(t,e,r,n,i){for(var s,a=i[0],o=i[240],c=function(t,e){var r,n,i,s,a,o,c,l,u,f,$=0;for(u=0;u<8;++u){r=t[$],n=t[$+1],i=t[$+2],s=t[$+3],a=t[$+4],o=t[$+5],c=t[$+6];var p=r+(l=t[$+7]),d=r-l,_=n+c,m=n-c,y=i+o,g=i-o,v=s+a,b=s-a,A=p+v,x=p-v,w=_+y,k=_-y;t[$]=A+w,t[$+4]=A-w;var E=.707106781*(k+x);t[$+2]=x+E,t[$+6]=x-E;var S=.382683433*((A=b+g)-(k=m+d)),N=.5411961*A+S,I=1.306562965*k+S,C=.707106781*(w=g+m),O=d+C,B=d-C;t[$+5]=B+N,t[$+3]=B-N,t[$+1]=O+I,t[$+7]=O-I,$+=8}for($=0,u=0;u<8;++u){r=t[$],n=t[$+8],i=t[$+16],s=t[$+24],a=t[$+32],o=t[$+40],c=t[$+48];var M=r+(l=t[$+56]),P=r-l,F=n+c,L=n-c,T=i+o,j=i-o,R=s+a,D=s-a,z=M+R,U=M-R,q=F+T,H=F-T;t[$]=z+q,t[$+32]=z-q;var Q=.707106781*(H+U);t[$+16]=U+Q,t[$+48]=U-Q;var Y=.382683433*((z=D+j)-(H=L+P)),G=.5411961*z+Y,V=1.306562965*H+Y,J=.707106781*(q=j+L),X=P+J,W=P-J;t[$+40]=W+G,t[$+24]=W-G,t[$+8]=X+V,t[$+56]=X-V,$++}for(u=0;u<64;++u)f=t[u]*e[u],h[u]=f>0?f+.5|0:f-.5|0;return h}(t,e),l=0;l<64;++l)p[x[l]]=c[l];var u=p[0]-r;r=p[0],0==u?M(n[0]):(M(n[$[s=32767+u]]),M(f[s]));for(var d=63;d>0&&0==p[d];d--);if(0==d)return M(a),r;for(var _,m=1;m<=d;){for(var y=m;0==p[m]&&m<=d;++m);var g=m-y;if(g>=16){_=g>>4;for(var v=1;v<=_;++v)M(o);g&=15}s=32767+p[m],M(i[(g<<4)+$[s]]),M(f[s]),m++}return 63!=d&&M(a),r}function T(t){if(t<=0&&(t=1),t>100&&(t=100),s!=t){(function(t){for(var e=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],r=0;r<64;r++){var n=a((e[r]*t+50)/100);n<1?n=1:n>255&&(n=255),o[x[r]]=n}for(var i=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],s=0;s<64;s++){var f=a((i[s]*t+50)/100);f<1?f=1:f>255&&(f=255),c[x[s]]=f}for(var $=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],h=0,p=0;p<8;p++)for(var d=0;d<8;d++)l[h]=1/(o[x[h]]*$[p]*$[d]*8),u[h]=1/(c[x[h]]*$[p]*$[d]*8),h++})(t<50?Math.floor(5e3/t):Math.floor(200-2*t)),s=t}}this.encode=function(t,s){(new Date).getTime();s&&T(s),d=new Array,_=0,m=7,F(65496),F(65504),F(16),P(74),P(70),P(73),P(70),P(0),P(1),P(1),P(0),F(1),F(1),P(0),P(0),function(){F(65499),F(132),P(0);for(var t=0;t<64;t++)P(o[t]);P(1);for(var e=0;e<64;e++)P(c[e])}(),function(t,e){F(65472),F(17),P(8),F(e),F(t),P(3),P(1),P(17),P(0),P(2),P(17),P(1),P(3),P(17),P(1)}(t.width,t.height),function(){F(65476),F(418),P(0);for(var t=0;t<16;t++)P(w[t+1]);for(var e=0;e<=11;e++)P(k[e]);P(16);for(var r=0;r<16;r++)P(E[r+1]);for(var n=0;n<=161;n++)P(S[n]);P(1);for(var i=0;i<16;i++)P(N[i+1]);for(var s=0;s<=11;s++)P(I[s]);P(17);for(var a=0;a<16;a++)P(C[a+1]);for(var o=0;o<=161;o++)P(O[o])}(),F(65498),F(12),P(3),P(1),P(0),P(2),P(17),P(3),P(17),P(0),P(63),P(0);var a=0,f=0,$=0;_=0,m=7,this.encode.displayName="_encode_";for(var h,p,b,x,B,j,R,D,z,U=t.data,q=t.width,H=t.height,Q=4*q,Y=0;Y<H;){for(h=0;h<Q;){for(j=B=Q*Y+h,R=-1,D=0,z=0;z<64;z++)j=B+(D=z>>3)*Q+(R=4*(7&z)),Y+D>=H&&(j-=Q*(Y+1+D-H)),h+R>=Q&&(j-=h+R-Q+4),p=U[j++],b=U[j++],x=U[j++],y[z]=(A[p]+A[b+256>>0]+A[x+512>>0]>>16)-128,g[z]=(A[p+768>>0]+A[b+1024>>0]+A[x+1280>>0]>>16)-128,v[z]=(A[p+1280>>0]+A[b+1536>>0]+A[x+1792>>0]>>16)-128;a=L(y,l,a,e,n),f=L(g,u,f,r,i),$=L(v,u,$,r,i),h+=32}Y+=8}if(m>=0){var G=[];G[1]=m+1,G[0]=(1<<m+1)-1,M(G)}return F(65497),new Uint8Array(d)},function(){(new Date).getTime();t||(t=50),function(){for(var t=String.fromCharCode,e=0;e<256;e++)b[e]=t(e)}(),e=B(w,k),r=B(N,I),n=B(E,S),i=B(C,O),function(){for(var t=1,e=2,r=1;r<=15;r++){for(var n=t;n<e;n++)$[32767+n]=r,f[32767+n]=[],f[32767+n][1]=r,f[32767+n][0]=n;for(var i=-(e-1);i<=-t;i++)$[32767+i]=r,f[32767+i]=[],f[32767+i][1]=r,f[32767+i][0]=e-1+i;t<<=1,e<<=1}}(),function(){for(var t=0;t<256;t++)A[t]=19595*t,A[t+256>>0]=38470*t,A[t+512>>0]=7471*t+32768,A[t+768>>0]=-11059*t,A[t+1024>>0]=-21709*t,A[t+1280>>0]=32768*t+8421375,A[t+1536>>0]=-27439*t,A[t+1792>>0]=-5329*t}(),T(t),(new Date).getTime()}()}window.tmp=v,function(t,e){var r,i=1,s=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},a=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},o=function(t){if(isNaN(t))throw new Error("Invalid argument passed to jsPDF.f2");return t.toFixed(2)},c=function(t){if(isNaN(t))throw new Error("Invalid argument passed to jsPDF.f2");return t.toFixed(5)};t.__acroform__={};var l=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},u=function(t){return t*i},f=function(t){return t/i},$=function(t){var e=new P,r=V.internal.getHeight(t)||0,n=V.internal.getWidth(t)||0;return e.BBox=[0,0,Number(o(n)),Number(o(r))],e},h=t.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|=1<<e},p=t.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&=~(1<<e)},d=t.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return 0==(t&1<<e)?0:1},_=t.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return d(t,e-1)},m=t.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return h(t,e-1)},y=t.__acroform__.clearBitForPdf=function(t,e,r){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return p(t,e-1)},g=t.__acroform__.calculateCoordinates=function(t){var e=this.internal.getHorizontalCoordinate,r=this.internal.getVerticalCoordinate,n=t[0],i=t[1],s=t[2],a=t[3],c={};return c.lowerLeft_X=e(n)||0,c.lowerLeft_Y=r(i+a)||0,c.upperRight_X=e(n+s)||0,c.upperRight_Y=r(i)||0,[Number(o(c.lowerLeft_X)),Number(o(c.lowerLeft_Y)),Number(o(c.upperRight_X)),Number(o(c.upperRight_Y))]},v=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],n=t.V||t.DV,i=b(t,n),s=r.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(r.__private__.encodeColorString(t.color)),e.push("/"+s+" "+o(i.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(i.text),e.push("ET"),e.push("Q"),e.push("EMC");var a=new $(t);return a.stream=e.join("\n"),a}},b=function(t,e){var n=t.maxFontSize||12,i=(t.fontName,{text:"",fontSize:""}),a=(e=")"==(e="("==e.substr(0,1)?e.substr(1):e).substr(e.length-1)?e.substr(0,e.length-1):e).split(" "),c=(r.__private__.encodeColorString(t.color),n),l=V.internal.getHeight(t)||0;l=l<0?-l:l;var u=V.internal.getWidth(t)||0;u=u<0?-u:u;var f=function(e,r,n){if(e+1<a.length){var i=r+" "+a[e+1];return A(i,t,n).width<=u-4}return!1};c++;t:for(;;){e="";var $=A("3",t,--c).height,h=t.multiline?l-c:(l-$)/2,p=-2,d=h+=2,_=0,m=0,y=0;if(c<=0){e="(...) Tj\n",e+="% Width of Text: "+A(e,t,c=12).width+", FieldWidth:"+u+"\n";break}y=A(a[0]+" ",t,c).width;var g="",v=0;for(var b in a)if(a.hasOwnProperty(b)){g=" "==(g+=a[b]+" ").substr(g.length-1)?g.substr(0,g.length-1):g;var x=parseInt(b);y=A(g+" ",t,c).width;var w=f(x,g,c),k=b>=a.length-1;if(w&&!k){g+=" ";continue}if(w||k){if(k)m=x;else if(t.multiline&&($+2)*(v+2)+2>l)continue t}else{if(!t.multiline)continue t;if(($+2)*(v+2)+2>l)continue t;m=x}for(var E="",S=_;S<=m;S++)E+=a[S]+" ";switch(E=" "==E.substr(E.length-1)?E.substr(0,E.length-1):E,y=A(E,t,c).width,t.textAlign){case"right":p=u-y-2;break;case"center":p=(u-y)/2;break;case"left":default:p=2}e+=o(p)+" "+o(d)+" Td\n",e+="("+s(E)+") Tj\n",e+=-o(p)+" 0 Td\n",d=-(c+2),y=0,_=m+1,v++,g=""}else;break}return i.text=e,i.fontSize=c,i},A=function(t,e,n){var i=r.internal.getFont(e.fontName,e.fontStyle),s=r.getStringUnitWidth(t,{font:i,fontSize:parseFloat(n),charSpace:0})*parseFloat(n);return{height:r.getStringUnitWidth("3",{font:i,fontSize:parseFloat(n),charSpace:0})*parseFloat(n)*1.5,width:s}},x={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},w=function(){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var t=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var e in t)if(t.hasOwnProperty(e)){var n=t[e];n.objId=void 0,n.hasAnnotation&&k.call(r,n)}},k=function(t){var e={type:"reference",object:t};void 0===r.internal.getPageInfo(t.page).pageContext.annotations.find(function(t){return t.type===e.type&&t.object===e.object})&&r.internal.getPageInfo(t.page).pageContext.annotations.push(e)},E=function(){if(void 0===r.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")},S=function(){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0},N=function(t){var e=!t;t||(r.internal.newObjectDeferredBegin(r.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),r.internal.acroformPlugin.acroFormDictionaryRoot.putStream());t=t||r.internal.acroformPlugin.acroFormDictionaryRoot.Kids;for(var i in t)if(t.hasOwnProperty(i)){var s=t[i],a=[],o=s.Rect;if(s.Rect&&(s.Rect=g.call(this,s.Rect)),r.internal.newObjectDeferredBegin(s.objId,!0),s.DA=V.createDefaultAppearanceStream(s),"object"===n(s)&&"function"==typeof s.getKeyValueListForStream&&(a=s.getKeyValueListForStream()),s.Rect=o,s.hasAppearanceStream&&!s.appearanceStreamContent){var c=v.call(this,s);a.push({key:"AP",value:"<</N "+c+">>"}),r.internal.acroformPlugin.xForms.push(c)}if(s.appearanceStreamContent){var l="";for(var u in s.appearanceStreamContent)if(s.appearanceStreamContent.hasOwnProperty(u)){var f=s.appearanceStreamContent[u];if(l+="/"+u+" ",l+="<<",Object.keys(f).length>=1||Array.isArray(f))for(var i in f){var $;if(f.hasOwnProperty(i))"function"==typeof($=f[i])&&($=$.call(this,s)),l+="/"+i+" "+$+" ",r.internal.acroformPlugin.xForms.indexOf($)>=0||r.internal.acroformPlugin.xForms.push($)}else"function"==typeof($=f)&&($=$.call(this,s)),l+="/"+i+" "+$,r.internal.acroformPlugin.xForms.indexOf($)>=0||r.internal.acroformPlugin.xForms.push($);l+=">>"}a.push({key:"AP",value:"<<\n"+l+">>"})}r.internal.putStream({additionalKeyValues:a}),r.internal.out("endobj")}e&&I.call(this,r.internal.acroformPlugin.xForms)},I=function(t){for(var e in t)if(t.hasOwnProperty(e)){var i=e,s=t[e];r.internal.newObjectDeferredBegin(s&&s.objId,!0),"object"===n(s)&&"function"==typeof s.putStream&&s.putStream(),delete t[i]}},C=function(){if(void 0!==this.internal&&(void 0===this.internal.acroformPlugin||!1===this.internal.acroformPlugin.isInitialized)){if(r=this,L.FieldNum=0,this.internal.acroformPlugin=JSON.parse(JSON.stringify(x)),this.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");i=r.internal.scaleFactor,r.internal.acroformPlugin.acroFormDictionaryRoot=new F,r.internal.acroformPlugin.acroFormDictionaryRoot._eventID=r.internal.events.subscribe("postPutResources",S),r.internal.events.subscribe("buildDocument",w),r.internal.events.subscribe("putCatalog",E),r.internal.events.subscribe("postPutPages",N),r.internal.acroformPlugin.isInitialized=!0}},O=t.__acroform__.arrayToPdfArray=function(t){if(Array.isArray(t)){for(var e="[",r=0;r<t.length;r++)switch(0!==r&&(e+=" "),n(t[r])){case"boolean":case"number":case"object":e+=t[r].toString();break;case"string":"/"!==t[r].substr(0,1)?e+="("+s(t[r].toString())+")":e+=t[r].toString()}return e+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")};var B=function(t){return(t=t||"").toString(),t="("+s(t)+")"},M=function(){var t;Object.defineProperty(this,"objId",{configurable:!0,get:function(){if(t||(t=r.internal.newObjectDeferred()),!t)throw new Error("AcroFormPDFObject: Couldn't create Object ID");return t},set:function(e){t=e}})};M.prototype.toString=function(){return this.objId+" 0 R"},M.prototype.putStream=function(){var t=this.getKeyValueListForStream();r.internal.putStream({data:this.stream,additionalKeyValues:t}),r.internal.out("endobj")},M.prototype.getKeyValueListForStream=function(){return function(t){var e=[],r=Object.getOwnPropertyNames(t).filter(function(t){return"content"!=t&&"appearanceStreamContent"!=t&&"_"!=t.substring(0,1)});for(var n in r)if(!1===Object.getOwnPropertyDescriptor(t,r[n]).configurable){var i=r[n],s=t[i];s&&(Array.isArray(s)?e.push({key:i,value:O(s)}):s instanceof M?e.push({key:i,value:s.objId+" 0 R"}):"function"!=typeof s&&e.push({key:i,value:s}))}return e}(this)};var P=function(){M.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writeable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writeable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writeable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,writeable:!0,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writeable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(e){t=e.trim()},get:function(){return t||null}})};l(P,M);var F=function(){M.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t)return"("+t+")"},set:function(e){t=e}})};l(F,M);var L=function t(){M.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(t){if(isNaN(t))throw new Error('Invalid value "'+t+'" for attribute F supplied.');e=t}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return Boolean(_(e,3))},set:function(t){!0===Boolean(t)?this.F=m(e,3):this.F=y(e,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(t){if(isNaN(t))throw new Error('Invalid value "'+t+'" for attribute Ff supplied.');r=t}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(0!==n.length)return n},set:function(t){n=void 0!==t?t:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:f(n[0])},set:function(t){n[0]=u(t)}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:f(n[1])},set:function(t){n[1]=u(t)}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:f(n[2])},set:function(t){n[2]=u(t)}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:f(n[3])},set:function(t){n[3]=u(t)}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(t){switch(t){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=t;break;default:throw new Error('Invalid value "'+t+'" for attribute FT supplied.')}}});var o=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!o||o.length<1){if(this instanceof H)return;o="FieldObject"+t.FieldNum++}return"("+s(o)+")"},set:function(t){o=t.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return o},set:function(t){o=t}});var c="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return c},set:function(t){c=t}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(t){l=t}});var $=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return f($)},set:function(t){$=u(t)}});var h=50;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return f(h)},set:function(t){h=u(t)}});var p="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return p},set:function(t){p=t}});var d="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!d||this instanceof H||this instanceof Y))return B(d)},set:function(t){t=t.toString(),d=t}});var g=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(g)return this instanceof z==!1?B(g):g},set:function(t){t=t.toString(),g=this instanceof z==!1?"("===t.substr(0,1)?a(t.substr(1,t.length-2)):a(t):t}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof z==!0?a(g.substr(1,g.length-1)):g},set:function(t){t=t.toString(),g=this instanceof z==!0?"/"+t:t}});var v=null;Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(v)return this instanceof z==!1?B(v):v},set:function(t){t=t.toString(),v=this instanceof z==!1?"("===t.substr(0,1)?a(t.substr(1,t.length-2)):a(t):t}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof z==!0?a(v.substr(1,v.length-1)):v},set:function(t){t=t.toString(),v=this instanceof z==!0?"/"+t:t}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var b,A=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,writeable:!0,get:function(){return A},set:function(t){t=Boolean(t),A=t}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,writeable:!0,get:function(){if(b)return b},set:function(t){b=t}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return Boolean(_(this.Ff,1))},set:function(t){!0===Boolean(t)?this.Ff=m(this.Ff,1):this.Ff=y(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return Boolean(_(this.Ff,2))},set:function(t){!0===Boolean(t)?this.Ff=m(this.Ff,2):this.Ff=y(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return Boolean(_(this.Ff,3))},set:function(t){!0===Boolean(t)?this.Ff=m(this.Ff,3):this.Ff=y(this.Ff,3)}});var x=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(null!==x)return x},set:function(t){if(-1===[0,1,2].indexOf(t))throw new Error('Invalid value "'+t+'" for attribute Q supplied.');x=t}}),Object.defineProperty(this,"textAlign",{get:function(){var t="left";switch(x){case 0:default:t="left";break;case 1:t="center";break;case 2:t="right"}return t},configurable:!0,enumerable:!0,set:function(t){switch(t){case"right":case 2:x=2;break;case"center":case 1:x=1;break;case"left":case 0:default:x=0}}})};l(L,M);var T=function(){L.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){t=e}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return O(e)},set:function(t){var r,n;n=[],"string"==typeof(r=t)&&(n=function(t,e,r){r||(r=1);for(var n,i=[];n=e.exec(t);)i.push(n[r]);return i}(r,/\((.*?)\)/g)),e=n}}),this.getOptions=function(){return e},this.setOptions=function(t){e=t,this.sort&&e.sort()},this.addOption=function(t){t=(t=t||"").toString(),e.push(t),this.sort&&e.sort()},this.removeOption=function(t,r){for(r=r||!1,t=(t=t||"").toString();-1!==e.indexOf(t)&&(e.splice(e.indexOf(t),1),!1!==r););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return Boolean(_(this.Ff,18))},set:function(t){!0===Boolean(t)?this.Ff=m(this.Ff,18):this.Ff=y(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return Boolean(_(this.Ff,19))},set:function(t){!0===this.combo&&(!0===Boolean(t)?this.Ff=m(this.Ff,19):this.Ff=y(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return Boolean(_(this.Ff,20))},set:function(t){!0===Boolean(t)?(this.Ff=m(this.Ff,20),e.sort()):this.Ff=y(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return Boolean(_(this.Ff,22))},set:function(t){!0===Boolean(t)?this.Ff=m(this.Ff,22):this.Ff=y(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return Boolean(_(this.Ff,23))},set:function(t){!0===Boolean(t)?this.Ff=m(this.Ff,23):this.Ff=y(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return Boolean(_(this.Ff,27))},set:function(t){!0===Boolean(t)?this.Ff=m(this.Ff,27):this.Ff=y(this.Ff,27)}}),this.hasAppearanceStream=!1};l(T,L);var j=function(){T.call(this),this.fontName="helvetica",this.combo=!1};l(j,T);var R=function(){j.call(this),this.combo=!0};l(R,j);var D=function(){R.call(this),this.edit=!0};l(D,R);var z=function(){L.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return Boolean(_(this.Ff,15))},set:function(t){!0===Boolean(t)?this.Ff=m(this.Ff,15):this.Ff=y(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return Boolean(_(this.Ff,16))},set:function(t){!0===Boolean(t)?this.Ff=m(this.Ff,16):this.Ff=y(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return Boolean(_(this.Ff,17))},set:function(t){!0===Boolean(t)?this.Ff=m(this.Ff,17):this.Ff=y(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return Boolean(_(this.Ff,26))},set:function(t){!0===Boolean(t)?this.Ff=m(this.Ff,26):this.Ff=y(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){if(0!==Object.keys(e).length){var t,r=[];for(t in r.push("<<"),e)r.push("/"+t+" ("+e[t]+")");return r.push(">>"),r.join("\n")}},set:function(t){"object"===n(t)&&(e=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(t){"string"==typeof t&&(e.CA=t)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(e){t="/"+e}})};l(z,L);var U=function(){z.call(this),this.pushButton=!0};l(U,z);var q=function(){z.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=void 0!==e?e:[]}})};l(q,z);var H=function(){var t,e;L.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(t){e=t}});var r,i={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var t,e=[];for(t in e.push("<<"),i)e.push("/"+t+" ("+i[t]+")");return e.push(">>"),e.join("\n")},set:function(t){"object"===n(t)&&(i=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return i.CA||""},set:function(t){"string"==typeof t&&(i.CA=t)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(t){r=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(t){r="/"+t}}),this.optionName=name,this.caption="l",this.appearanceState="Off",this._AppearanceType=V.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(name)};l(H,L),q.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t&&"getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var r=this.Kids[e];r.appearanceStreamContent=t.createAppearanceStream(r.optionName),r.caption=t.getCA()}},q.prototype.createOption=function(t){this.Kids.length;var e=new H;return e.Parent=this,e.optionName=t,this.Kids.push(e),J.call(this,e),e};var Q=function(){z.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=V.CheckBox.createAppearanceStream()};l(Q,z);var Y=function(){L.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return Boolean(_(this.Ff,13))},set:function(t){!0===Boolean(t)?this.Ff=m(this.Ff,13):this.Ff=y(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return Boolean(_(this.Ff,21))},set:function(t){!0===Boolean(t)?this.Ff=m(this.Ff,21):this.Ff=y(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return Boolean(_(this.Ff,23))},set:function(t){!0===Boolean(t)?this.Ff=m(this.Ff,23):this.Ff=y(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return Boolean(_(this.Ff,24))},set:function(t){!0===Boolean(t)?this.Ff=m(this.Ff,24):this.Ff=y(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return Boolean(_(this.Ff,25))},set:function(t){!0===Boolean(t)?this.Ff=m(this.Ff,25):this.Ff=y(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return Boolean(_(this.Ff,26))},set:function(t){!0===Boolean(t)?this.Ff=m(this.Ff,26):this.Ff=y(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};l(Y,L);var G=function(){Y.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return Boolean(_(this.Ff,14))},set:function(t){!0===Boolean(t)?this.Ff=m(this.Ff,14):this.Ff=y(this.Ff,14)}}),this.password=!0};l(G,Y);var V={CheckBox:{createAppearanceStream:function(){return{N:{On:V.CheckBox.YesNormal},D:{On:V.CheckBox.YesPushDown,Off:V.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=$(t),n=[],i=r.internal.getFont(t.fontName,t.fontStyle).id,s=r.__private__.encodeColorString(t.color),a=b(t,t.caption);return n.push("0.749023 g"),n.push("0 0 "+o(V.internal.getWidth(t))+" "+o(V.internal.getHeight(t))+" re"),n.push("f"),n.push("BMC"),n.push("q"),n.push("0 0 1 rg"),n.push("/"+i+" "+o(a.fontSize)+" Tf "+s),n.push("BT"),n.push(a.text),n.push("ET"),n.push("Q"),n.push("EMC"),e.stream=n.join("\n"),e},YesNormal:function(t){var e=$(t),n=r.internal.getFont(t.fontName,t.fontStyle).id,i=r.__private__.encodeColorString(t.color),s=[],a=V.internal.getHeight(t),c=V.internal.getWidth(t),l=b(t,t.caption);return s.push("1 g"),s.push("0 0 "+o(c)+" "+o(a)+" re"),s.push("f"),s.push("q"),s.push("0 0 1 rg"),s.push("0 0 "+o(c-1)+" "+o(a-1)+" re"),s.push("W"),s.push("n"),s.push("0 g"),s.push("BT"),s.push("/"+n+" "+o(l.fontSize)+" Tf "+i),s.push(l.text),s.push("ET"),s.push("Q"),e.stream=s.join("\n"),e},OffPushDown:function(t){var e=$(t),r=[];return r.push("0.749023 g"),r.push("0 0 "+o(V.internal.getWidth(t))+" "+o(V.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join("\n"),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:V.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=V.RadioButton.Circle.YesNormal,e.D[t]=V.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=$(t),r=[],n=V.internal.getWidth(t)<=V.internal.getHeight(t)?V.internal.getWidth(t)/4:V.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var i=V.internal.Bezier_C,s=Number((n*i).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+c(V.internal.getWidth(t)/2)+" "+c(V.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join("\n"),e},YesPushDown:function(t){var e=$(t),r=[],n=V.internal.getWidth(t)<=V.internal.getHeight(t)?V.internal.getWidth(t)/4:V.internal.getHeight(t)/4,i=(n=Number((.9*n).toFixed(5)),Number((2*n).toFixed(5))),s=Number((i*V.internal.Bezier_C).toFixed(5)),a=Number((n*V.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+c(V.internal.getWidth(t)/2)+" "+c(V.internal.getHeight(t)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),r.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),r.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),r.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+c(V.internal.getWidth(t)/2)+" "+c(V.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+a+" "+a+" "+n+" 0 "+n+" c"),r.push("-"+a+" "+n+" -"+n+" "+a+" -"+n+" 0 c"),r.push("-"+n+" -"+a+" -"+a+" -"+n+" 0 -"+n+" c"),r.push(a+" -"+n+" "+n+" -"+a+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join("\n"),e},OffPushDown:function(t){var e=$(t),r=[],n=V.internal.getWidth(t)<=V.internal.getHeight(t)?V.internal.getWidth(t)/4:V.internal.getHeight(t)/4,i=(n=Number((.9*n).toFixed(5)),Number((2*n).toFixed(5))),s=Number((i*V.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+c(V.internal.getWidth(t)/2)+" "+c(V.internal.getHeight(t)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),r.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),r.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),r.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join("\n"),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:V.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=V.RadioButton.Cross.YesNormal,e.D[t]=V.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=$(t),r=[],n=V.internal.calculateCross(t);return r.push("q"),r.push("1 1 "+o(V.internal.getWidth(t)-2)+" "+o(V.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push(o(n.x1.x)+" "+o(n.x1.y)+" m"),r.push(o(n.x2.x)+" "+o(n.x2.y)+" l"),r.push(o(n.x4.x)+" "+o(n.x4.y)+" m"),r.push(o(n.x3.x)+" "+o(n.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join("\n"),e},YesPushDown:function(t){var e=$(t),r=V.internal.calculateCross(t),n=[];return n.push("0.749023 g"),n.push("0 0 "+o(V.internal.getWidth(t))+" "+o(V.internal.getHeight(t))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+o(V.internal.getWidth(t)-2)+" "+o(V.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push(o(r.x1.x)+" "+o(r.x1.y)+" m"),n.push(o(r.x2.x)+" "+o(r.x2.y)+" l"),n.push(o(r.x4.x)+" "+o(r.x4.y)+" m"),n.push(o(r.x3.x)+" "+o(r.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join("\n"),e},OffPushDown:function(t){var e=$(t),r=[];return r.push("0.749023 g"),r.push("0 0 "+o(V.internal.getWidth(t))+" "+o(V.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join("\n"),e}}},createDefaultAppearanceStream:function(t){var e=r.internal.getFont(t.fontName,t.fontStyle).id,n=r.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+n}};V.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=V.internal.getWidth(t),r=V.internal.getHeight(t),n=Math.min(e,r);return{x1:{x:(e-n)/2,y:(r-n)/2+n},x2:{x:(e-n)/2+n,y:(r-n)/2},x3:{x:(e-n)/2,y:(r-n)/2},x4:{x:(e-n)/2+n,y:(r-n)/2+n}}}},V.internal.getWidth=function(t){var e=0;return"object"===n(t)&&(e=u(t.Rect[2])),e},V.internal.getHeight=function(t){var e=0;return"object"===n(t)&&(e=u(t.Rect[3])),e};var J=t.addField=function(t){if(C.call(this),!(t instanceof L))throw new Error("Invalid argument passed to jsPDF.addField.");return function(t){r.internal.acroformPlugin.printedOut&&(r.internal.acroformPlugin.printedOut=!1,r.internal.acroformPlugin.acroFormDictionaryRoot=null),r.internal.acroformPlugin.acroFormDictionaryRoot||C.call(r),r.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t)}.call(this,t),t.page=r.internal.getCurrentPageInfo().pageNumber,this};t.addButton=function(t){if(t instanceof z==!1)throw new Error("Invalid argument passed to jsPDF.addButton.");return J.call(this,t)},t.addTextField=function(t){if(t instanceof Y==!1)throw new Error("Invalid argument passed to jsPDF.addTextField.");return J.call(this,t)},t.addChoiceField=function(t){if(t instanceof T==!1)throw new Error("Invalid argument passed to jsPDF.addChoiceField.");return J.call(this,t)};"object"==n(e)&&void 0===e.ChoiceField&&void 0===e.ListBox&&void 0===e.ComboBox&&void 0===e.EditBox&&void 0===e.Button&&void 0===e.PushButton&&void 0===e.RadioButton&&void 0===e.CheckBox&&void 0===e.TextField&&void 0===e.PasswordField?(e.ChoiceField=T,e.ListBox=j,e.ComboBox=R,e.EditBox=D,e.Button=z,e.PushButton=U,e.RadioButton=q,e.CheckBox=Q,e.TextField=Y,e.PasswordField=G,e.AcroForm={Appearance:V}):console.warn("AcroForm-Classes are not populated into global-namespace, because the class-Names exist already."),t.AcroFormChoiceField=T,t.AcroFormListBox=j,t.AcroFormComboBox=R,t.AcroFormEditBox=D,t.AcroFormButton=z,t.AcroFormPushButton=U,t.AcroFormRadioButton=q,t.AcroFormCheckBox=Q,t.AcroFormTextField=Y,t.AcroFormPasswordField=G,t.AcroFormAppearance=V,t.AcroForm={ChoiceField:T,ListBox:j,ComboBox:R,EditBox:D,Button:z,PushButton:U,RadioButton:q,CheckBox:Q,TextField:Y,PasswordField:G,Appearance:V}}(v.API,"undefined"!=typeof window&&window||"undefined"!=typeof global&&global),function(t){var e={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},r=t.getImageFileTypeByImageData=function(r,n){var i,s;n=n||"UNKNOWN";var a,o,c,l="UNKNOWN";for(c in t.isArrayBufferView(r)&&(r=t.arrayBufferToBinaryString(r)),e)for(a=e[c],i=0;i<a.length;i+=1){for(o=!0,s=0;s<a[i].length;s+=1)if(void 0!==a[i][s]&&a[i][s]!==r.charCodeAt(s)){o=!1;break}if(!0===o){l=c;break}}return"UNKNOWN"===l&&"UNKNOWN"!==n&&(console.warn('FileType of Image not recognized. Processing image as "'+n+'".'),l=n),l},i=function t(e){for(var r=this.internal.newObject(),n=this.internal.write,i=this.internal.putStream,s=(0,this.internal.getFilters)();-1!==s.indexOf("FlateEncode");)s.splice(s.indexOf("FlateEncode"),1);e.n=r;var a=[];if(a.push({key:"Type",value:"/XObject"}),a.push({key:"Subtype",value:"/Image"}),a.push({key:"Width",value:e.w}),a.push({key:"Height",value:e.h}),e.cs===this.color_spaces.INDEXED?a.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(e.pal.length/3-1)+" "+("smask"in e?r+2:r+1)+" 0 R]"}):(a.push({key:"ColorSpace",value:"/"+e.cs}),e.cs===this.color_spaces.DEVICE_CMYK&&a.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),a.push({key:"BitsPerComponent",value:e.bpc}),"dp"in e&&a.push({key:"DecodeParms",value:"<<"+e.dp+">>"}),"trns"in e&&e.trns.constructor==Array){for(var o="",c=0,l=e.trns.length;c<l;c++)o+=e.trns[c]+" "+e.trns[c]+" ";a.push({key:"Mask",value:"["+o+"]"})}"smask"in e&&a.push({key:"SMask",value:r+1+" 0 R"});var u=void 0!==e.f?["/"+e.f]:void 0;if(i({data:e.data,additionalKeyValues:a,alreadyAppliedFilters:u}),n("endobj"),"smask"in e){var f="/Predictor "+e.p+" /Colors 1 /BitsPerComponent "+e.bpc+" /Columns "+e.w,$={w:e.w,h:e.h,cs:"DeviceGray",bpc:e.bpc,dp:f,data:e.smask};"f"in e&&($.f=e.f),t.call(this,$)}e.cs===this.color_spaces.INDEXED&&(this.internal.newObject(),i({data:this.arrayBufferToBinaryString(new Uint8Array(e.pal))}),n("endobj"))},s=function(){var t=this.internal.collections.addImage_images;for(var e in t)i.call(this,t[e])},a=function(){var t,e=this.internal.collections.addImage_images,r=this.internal.write;for(var n in e)r("/I"+(t=e[n]).i,t.n,"0","R")},o=function(e){return"function"==typeof t["process"+e.toUpperCase()]},c=function(t){return"object"===n(t)&&1===t.nodeType},l=function(e,r){if("IMG"===e.nodeName&&e.hasAttribute("src")){var n=""+e.getAttribute("src");if(0===n.indexOf("data:image/"))return unescape(n);var i=t.loadFile(n);if(void 0!==i)return btoa(i)}if("CANVAS"===e.nodeName){var s=e;return e.toDataURL("image/jpeg",1)}(s=document.createElement("canvas")).width=e.clientWidth||e.width,s.height=e.clientHeight||e.height;var a=s.getContext("2d");if(!a)throw"addImage requires canvas to be supported by browser.";return a.drawImage(e,0,0,s.width,s.height),s.toDataURL("png"==(""+r).toLowerCase()?"image/png":"image/jpeg")},u=function(t,e){var r;if(e)for(var n in e)if(t===e[n].alias){r=e[n];break}return r};t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"},t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"},t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},t.sHashCode=function(t){var e,r=0;if(0===(t=t||"").length)return r;for(e=0;e<t.length;e++)r=(r<<5)-r+t.charCodeAt(e),r|=0;return r},t.isString=function(t){return"string"==typeof t},t.validateStringAsBase64=function(t){(t=t||"").toString().trim();var e=!0;return 0===t.length&&(e=!1),t.length%4!=0&&(e=!1),!1===/^[A-Za-z0-9+\/]+$/.test(t.substr(0,t.length-2))&&(e=!1),!1===/^[A-Za-z0-9\/][A-Za-z0-9+\/]|[A-Za-z0-9+\/]=|==$/.test(t.substr(-2))&&(e=!1),e},t.extractInfoFromBase64DataURI=function(t){return/^data:([\w]+?\/([\w]+?));\S*;*base64,(.+)$/g.exec(t)},t.extractImageFromDataUrl=function(t){var e=(t=t||"").split("base64,"),r=null;if(2===e.length){var n=/^data:(\w*\/\w*);*(charset=[\w=-]*)*;*$/.exec(e[0]);Array.isArray(n)&&(r={mimeType:n[1],charset:n[2],data:e[1]})}return r},t.supportsArrayBuffer=function(){return"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array},t.isArrayBuffer=function(t){return!!this.supportsArrayBuffer()&&t instanceof ArrayBuffer},t.isArrayBufferView=function(t){return!!this.supportsArrayBuffer()&&("undefined"!=typeof Uint32Array&&(t instanceof Int8Array||t instanceof Uint8Array||"undefined"!=typeof Uint8ClampedArray&&t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array||t instanceof Float64Array))},t.binaryStringToUint8Array=function(t){for(var e=t.length,r=new Uint8Array(e),n=0;n<e;n++)r[n]=t.charCodeAt(n);return r},t.arrayBufferToBinaryString=function(t){if("function"==typeof atob)return atob(this.arrayBufferToBase64(t))},t.arrayBufferToBase64=function(t){for(var e,r="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=new Uint8Array(t),s=i.byteLength,a=s%3,o=s-a,c=0;c<o;c+=3)r+=n[(16515072&(e=i[c]<<16|i[c+1]<<8|i[c+2]))>>18]+n[(258048&e)>>12]+n[(4032&e)>>6]+n[63&e];return 1==a?r+=n[(252&(e=i[o]))>>2]+n[(3&e)<<4]+"==":2==a&&(r+=n[(64512&(e=i[o]<<8|i[o+1]))>>10]+n[(1008&e)>>4]+n[(15&e)<<2]+"="),r},t.createImageInfo=function(t,e,r,n,i,s,a,o,c,l,u,f,$){var h={alias:o,w:e,h:r,cs:n,bpc:i,i:a,data:t};return s&&(h.f=s),c&&(h.dp=c),l&&(h.trns=l),u&&(h.pal=u),f&&(h.smask=f),$&&(h.p=$),h},t.addImage=function(e,r,i,f,$,h,p,d,_){var m="";if("string"!=typeof r){var y=h;h=$,$=f,f=i,i=r,r=y}if("object"===n(e)&&!c(e)&&"imageData"in e){var g=e;e=g.imageData,r=g.format||r||"UNKNOWN",i=g.x||i||0,f=g.y||f||0,$=g.w||$,h=g.h||h,p=g.alias||p,d=g.compression||d,_=g.rotation||g.angle||_}var v=this.internal.getFilters();if(void 0===d&&-1!==v.indexOf("FlateEncode")&&(d="SLOW"),"string"==typeof e&&(e=unescape(e)),isNaN(i)||isNaN(f))throw console.error("jsPDF.addImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addImage");var b,A,x,w=function(){var t=this.internal.collections.addImage_images;return t||(this.internal.collections.addImage_images=t={},this.internal.events.subscribe("putResources",s),this.internal.events.subscribe("putXobjectDict",a)),t}.call(this);if(!((b=u(e,w))||(c(e)&&(e=l(e,r)),(null==(x=p)||0===x.length)&&(p=function(e){return"string"==typeof e?t.sHashCode(e):t.isArrayBufferView(e)?t.sHashCode(t.arrayBufferToBinaryString(e)):null}(e)),b=u(p,w)))){if(this.isString(e)&&(""!==(m=this.convertStringToImageData(e))?e=m:void 0!==(m=t.loadFile(e))&&(e=m)),r=this.getImageFileTypeByImageData(e,r),!o(r))throw new Error("addImage does not support files of type '"+r+"', please ensure that a plugin for '"+r+"' support is added.");if(this.supportsArrayBuffer()&&(e instanceof Uint8Array||(A=e,e=this.binaryStringToUint8Array(e))),!(b=this["process"+r.toUpperCase()](e,function(t){var e=0;return t&&(e=Object.keys?Object.keys(t).length:function(t){var e=0;for(var r in t)t.hasOwnProperty(r)&&e++;return e}(t)),e}(w),p,function(e){return e&&"string"==typeof e&&(e=e.toUpperCase()),e in t.image_compression?e:t.image_compression.NONE}(d),A)))throw new Error("An unknown error occurred whilst processing the image")}return function(t,e,r,n,i,s,a,o){var c=function(t,e,r){return t||e||(t=-96,e=-96),t<0&&(t=-1*r.w*72/t/this.internal.scaleFactor),e<0&&(e=-1*r.h*72/e/this.internal.scaleFactor),0===t&&(t=e*r.w/r.h),0===e&&(e=t*r.h/r.w),[t,e]}.call(this,r,n,i),l=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString;if(r=c[0],n=c[1],a[s]=i,o){o*=Math.PI/180;var f=Math.cos(o),$=Math.sin(o),h=function(t){return t.toFixed(4)},p=[h(f),h($),h(-1*$),h(f),0,0,"cm"]}this.internal.write("q"),o?(this.internal.write([1,"0","0",1,l(t),u(e+n),"cm"].join(" ")),this.internal.write(p.join(" ")),this.internal.write([l(r),"0","0",l(n),"0","0","cm"].join(" "))):this.internal.write([l(r),"0","0",l(n),l(t),u(e+n),"cm"].join(" ")),this.internal.write("/I"+i.i+" Do"),this.internal.write("Q")}.call(this,i,f,$,h,b,b.i,w,_),this},t.convertStringToImageData=function(e){var r,n="";if(this.isString(e)){var i;r=null!==(i=this.extractImageFromDataUrl(e))?i.data:e;try{n=atob(r)}catch(e){throw t.validateStringAsBase64(r)?new Error("atob-Error in jsPDF.convertStringToImageData "+e.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertStringToImageData ")}}return n};var f=function(t,e){return t.subarray(e,e+5)};t.processJPEG=function(t,e,n,i,s,a){var o,c=this.decode.DCT_DECODE;if(!this.isString(t)&&!this.isArrayBuffer(t)&&!this.isArrayBufferView(t))return null;if(this.isString(t)&&(o=function(t){var e;if("JPEG"!==r(t))throw new Error("getJpegSize requires a binary string jpeg file");for(var n=256*t.charCodeAt(4)+t.charCodeAt(5),i=4,s=t.length;i<s;){if(i+=n,255!==t.charCodeAt(i))throw new Error("getJpegSize could not find the size of the image");if(192===t.charCodeAt(i+1)||193===t.charCodeAt(i+1)||194===t.charCodeAt(i+1)||195===t.charCodeAt(i+1)||196===t.charCodeAt(i+1)||197===t.charCodeAt(i+1)||198===t.charCodeAt(i+1)||199===t.charCodeAt(i+1))return e=256*t.charCodeAt(i+5)+t.charCodeAt(i+6),[256*t.charCodeAt(i+7)+t.charCodeAt(i+8),e,t.charCodeAt(i+9)];i+=2,n=256*t.charCodeAt(i)+t.charCodeAt(i+1)}}(t)),this.isArrayBuffer(t)&&(t=new Uint8Array(t)),this.isArrayBufferView(t)&&(o=function(t){if(65496!=(t[0]<<8|t[1]))throw new Error("Supplied data is not a JPEG");for(var e,r=t.length,n=(t[4]<<8)+t[5],i=4;i<r;){if(n=((e=f(t,i+=n))[2]<<8)+e[3],(192===e[1]||194===e[1])&&255===e[0]&&n>7)return{width:((e=f(t,i+5))[2]<<8)+e[3],height:(e[0]<<8)+e[1],numcomponents:e[4]};i+=2}throw new Error("getJpegSizeFromBytes could not find the size of the image")}(t),t=s||this.arrayBufferToBinaryString(t)),void 0===a)switch(o.numcomponents){case 1:a=this.color_spaces.DEVICE_GRAY;break;case 4:a=this.color_spaces.DEVICE_CMYK;break;default:case 3:a=this.color_spaces.DEVICE_RGB}return this.createImageInfo(t,o.width,o.height,a,8,c,e,n)},t.processJPG=function(){return this.processJPEG.apply(this,arguments)},t.getImageProperties=function(e){var r,n,i="";if(c(e)&&(e=l(e)),this.isString(e)&&(""!==(i=this.convertStringToImageData(e))?e=i:void 0!==(i=t.loadFile(e))&&(e=i)),n=this.getImageFileTypeByImageData(e),!o(n))throw new Error("addImage does not support files of type '"+n+"', please ensure that a plugin for '"+n+"' support is added.");if(this.supportsArrayBuffer()&&(e instanceof Uint8Array||(e=this.binaryStringToUint8Array(e))),!(r=this["process"+n.toUpperCase()](e)))throw new Error("An unknown error occurred whilst processing the image");return{fileType:n,width:r.w,height:r.h,colorSpace:r.cs,compressionMode:r.f,bitsPerComponent:r.bpc}}}(v.API),function(t){v.API.events.push(["addPage",function(t){this.internal.getPageInfo(t.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(t){for(var e=this.internal.getPageInfoByObjId(t.objId),r=t.pageContext.annotations,n=function(t){if(void 0!==t&&""!=t)return!0},i=!1,s=0;s<r.length&&!i;s++){switch((c=r[s]).type){case"link":if(n(c.options.url)||n(c.options.pageNumber)){i=!0;break}case"reference":case"text":case"freetext":i=!0}}if(0!=i){this.internal.write("/Annots [");this.internal.pageSize.height;var a=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString;for(s=0;s<r.length;s++){var c;switch((c=r[s]).type){case"reference":this.internal.write(" "+c.object.objId+" 0 R ");break;case"text":var l=this.internal.newAdditionalObject(),u=this.internal.newAdditionalObject(),f=c.title||"Note";_="<</Type /Annot /Subtype /Text "+(h="/Rect ["+a(c.bounds.x)+" "+o(c.bounds.y+c.bounds.h)+" "+a(c.bounds.x+c.bounds.w)+" "+o(c.bounds.y)+"] ")+"/Contents ("+c.contents+")",_+=" /Popup "+u.objId+" 0 R",_+=" /P "+e.objId+" 0 R",_+=" /T ("+f+") >>",l.content=_;var $=l.objId+" 0 R";_="<</Type /Annot /Subtype /Popup "+(h="/Rect ["+a(c.bounds.x+30)+" "+o(c.bounds.y+c.bounds.h)+" "+a(c.bounds.x+c.bounds.w+30)+" "+o(c.bounds.y)+"] ")+" /Parent "+$,c.open&&(_+=" /Open true"),_+=" >>",u.content=_,this.internal.write(l.objId,"0 R",u.objId,"0 R");break;case"freetext":var h="/Rect ["+a(c.bounds.x)+" "+o(c.bounds.y)+" "+a(c.bounds.x+c.bounds.w)+" "+o(c.bounds.y+c.bounds.h)+"] ",p=c.color||"#000000";_="<</Type /Annot /Subtype /FreeText "+h+"/Contents ("+c.contents+")",_+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+p+")",_+=" /Border [0 0 0]",_+=" >>",this.internal.write(_);break;case"link":if(c.options.name){var d=this.annotations._nameMap[c.options.name];c.options.pageNumber=d.page,c.options.top=d.y}else c.options.top||(c.options.top=0);h="/Rect ["+a(c.x)+" "+o(c.y)+" "+a(c.x+c.w)+" "+o(c.y+c.h)+"] ";var _="";if(c.options.url)_="<</Type /Annot /Subtype /Link "+h+"/Border [0 0 0] /A <</S /URI /URI ("+c.options.url+") >>";else if(c.options.pageNumber){switch(_="<</Type /Annot /Subtype /Link "+h+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(c.options.pageNumber).objId+" 0 R",c.options.magFactor=c.options.magFactor||"XYZ",c.options.magFactor){case"Fit":_+=" /Fit]";break;case"FitH":_+=" /FitH "+c.options.top+"]";break;case"FitV":c.options.left=c.options.left||0,_+=" /FitV "+c.options.left+"]";break;case"XYZ":default:var m=o(c.options.top);c.options.left=c.options.left||0,void 0===c.options.zoom&&(c.options.zoom=0),_+=" /XYZ "+c.options.left+" "+m+" "+c.options.zoom+"]"}}""!=_&&(_+=" >>",this.internal.write(_))}}this.internal.write("]")}}]),t.createAnnotation=function(t){var e=this.internal.getCurrentPageInfo();switch(t.type){case"link":this.link(t.bounds.x,t.bounds.y,t.bounds.w,t.bounds.h,t);break;case"text":case"freetext":e.pageContext.annotations.push(t)}},t.link=function(t,e,r,n,i){this.internal.getCurrentPageInfo().pageContext.annotations.push({x:t,y:e,w:r,h:n,options:i,type:"link"})},t.textWithLink=function(t,e,r,n){var i=this.getTextWidth(t),s=this.internal.getLineHeight()/this.internal.scaleFactor;return this.text(t,e,r),r+=.2*s,this.link(e,r-s,i,s,n),i},t.getTextWidth=function(t){var e=this.internal.getFontSize();return this.getStringUnitWidth(t)*e/this.internal.scaleFactor}}(v.API),function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];t.__arabicParser__={};var s=t.__arabicParser__.isInArabicSubstitutionA=function(t){return void 0!==e[t.charCodeAt(0)]},a=t.__arabicParser__.isArabicLetter=function(t){return"string"==typeof t&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(t)},o=t.__arabicParser__.isArabicEndLetter=function(t){return a(t)&&s(t)&&e[t.charCodeAt(0)].length<=2},c=t.__arabicParser__.isArabicAlfLetter=function(t){return a(t)&&i.indexOf(t.charCodeAt(0))>=0},l=(t.__arabicParser__.arabicLetterHasIsolatedForm=function(t){return a(t)&&s(t)&&e[t.charCodeAt(0)].length>=1},t.__arabicParser__.arabicLetterHasFinalForm=function(t){return a(t)&&s(t)&&e[t.charCodeAt(0)].length>=2}),u=(t.__arabicParser__.arabicLetterHasInitialForm=function(t){return a(t)&&s(t)&&e[t.charCodeAt(0)].length>=3},t.__arabicParser__.arabicLetterHasMedialForm=function(t){return a(t)&&s(t)&&4==e[t.charCodeAt(0)].length}),f=t.__arabicParser__.resolveLigatures=function(t){var e=0,n=r,i=0,s="",a=0;for(e=0;e<t.length;e+=1)void 0!==n[t.charCodeAt(e)]?(a++,"number"==typeof(n=n[t.charCodeAt(e)])&&(i=-1!==(i=$(t.charAt(e),t.charAt(e-a),t.charAt(e+1)))?i:0,s+=String.fromCharCode(n),n=r,a=0),e===t.length-1&&(n=r,s+=t.charAt(e-(a-1)),e-=a-1,a=0)):(n=r,s+=t.charAt(e-a),e-=a,a=0);return s},$=(t.__arabicParser__.isArabicDiacritic=function(t){return void 0!==t&&void 0!==n[t.charCodeAt(0)]},t.__arabicParser__.getCorrectForm=function(t,e,r){return a(t)?!1===s(t)?-1:!l(t)||!a(e)&&!a(r)||!a(r)&&o(e)||o(t)&&!a(e)||o(t)&&c(e)||o(t)&&o(e)?0:u(t)&&a(e)&&!o(e)&&a(r)&&l(r)?3:o(t)||!a(r)?1:2:-1}),h=t.__arabicParser__.processArabic=t.processArabic=function(t){var r=0,n=0,i=0,s="",o="",c="",l=(t=t||"").split("\\s+"),u=[];for(r=0;r<l.length;r+=1){for(u.push(""),n=0;n<l[r].length;n+=1)s=l[r][n],o=l[r][n-1],c=l[r][n+1],a(s)?(i=$(s,o,c),u[r]+=-1!==i?String.fromCharCode(e[s.charCodeAt(0)][i]):s):u[r]+=s;u[r]=f(u[r])}return u.join(" ")};t.events.push(["preProcessText",function(t){var e=t.text,r=(t.x,t.y,t.options||{}),n=(t.mutex,r.lang,[]);if("[object Array]"===Object.prototype.toString.call(e)){var i=0;for(n=[],i=0;i<e.length;i+=1)"[object Array]"===Object.prototype.toString.call(e[i])?n.push([h(e[i][0]),e[i][1],e[i][2]]):n.push([h(e[i])]);t.text=n}else t.text=h(e)}])}(v.API),v.API.autoPrint=function(t){var e;switch((t=t||{}).variant=t.variant||"non-conform",t.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})}return this},function(t){var e=function(){var t=void 0;Object.defineProperty(this,"pdf",{get:function(){return t},set:function(e){t=e}});var e=150;Object.defineProperty(this,"width",{get:function(){return e},set:function(t){e=isNaN(t)||!1===Number.isInteger(t)||t<0?150:t,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=e+1)}});var r=300;Object.defineProperty(this,"height",{get:function(){return r},set:function(t){r=isNaN(t)||!1===Number.isInteger(t)||t<0?300:t,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=r+1)}});var n=[];Object.defineProperty(this,"childNodes",{get:function(){return n},set:function(t){n=t}});var i={};Object.defineProperty(this,"style",{get:function(){return i},set:function(t){i=t}}),Object.defineProperty(this,"parentNode",{get:function(){return!1}})};e.prototype.getContext=function(t,e){var r;if("2d"!==(t=t||"2d"))return null;for(r in e)this.pdf.context2d.hasOwnProperty(r)&&(this.pdf.context2d[r]=e[r]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])}(v.API),i=v.API,a={x:void 0,y:void 0,w:void 0,h:void 0,ln:void 0},o=1,c=function(t,e,r,n,i){a={x:t,y:e,w:r,h:n,ln:i}},l=function(){return a},u={left:0,top:0,bottom:0},i.setHeaderFunction=function(t){s=t},i.getTextDimensions=function(t,e){var r=this.table_font_size||this.internal.getFontSize(),n=(this.internal.getFont().fontStyle,(e=e||{}).scaleFactor||this.internal.scaleFactor),i=0,s=0,a=0;if("string"==typeof t)0!=(i=this.getStringUnitWidth(t)*r)&&(s=1);else{if("[object Array]"!==Object.prototype.toString.call(t))throw new Error("getTextDimensions expects text-parameter to be of type String or an Array of Strings.");for(var o=0;o<t.length;o++)i<(a=this.getStringUnitWidth(t[o])*r)&&(i=a);0!==i&&(s=t.length)}return{w:i/=n,h:Math.max((s*r*this.getLineHeightFactor()-r*(this.getLineHeightFactor()-1))/n,0)}},i.cellAddPage=function(){var t=this.margins||u;this.addPage(),c(t.left,t.top,void 0,void 0),o+=1},i.cellInitialize=function(){a={x:void 0,y:void 0,w:void 0,h:void 0,ln:void 0},o=1},i.cell=function(t,e,r,n,i,s,a){var o=l(),f=!1;if(void 0!==o.ln)if(o.ln===s)t=o.x+o.w,e=o.y;else{var $=this.margins||u;o.y+o.h+n+13>=this.internal.pageSize.getHeight()-$.bottom&&(this.cellAddPage(),f=!0,this.printHeaders&&this.tableHeaderRow&&this.printHeaderRow(s,!0)),e=l().y+l().h,f&&(e=23)}if(void 0!==i[0])if(this.printingHeaderRow?this.rect(t,e,r,n,"FD"):this.rect(t,e,r,n),"right"===a){i instanceof Array||(i=[i]);for(var h=0;h<i.length;h++){var p=i[h],d=this.getStringUnitWidth(p)*this.internal.getFontSize();this.text(p,t+r-d-3,e+this.internal.getLineHeight()*(h+1))}}else this.text(i,t+3,e+this.internal.getLineHeight());return c(t,e,r,n,s),this},i.arrayMax=function(t,e){var r,n,i,s=t[0];for(r=0,n=t.length;r<n;r+=1)i=t[r],e?-1===e(s,i)&&(s=i):i>s&&(s=i);return s},i.table=function(t,e,r,n,s){if(!r)throw"No data for PDF table";var c,l,f,$,h,p,d,_,m,y,g=[],v=[],b={},A={},x=[],w=[],k=!1,E=!0,S=12,N=u;if(N.width=this.internal.pageSize.getWidth(),s&&(!0===s.autoSize&&(k=!0),!1===s.printHeaders&&(E=!1),s.fontSize&&(S=s.fontSize),s.css&&void 0!==s.css["font-size"]&&(S=16*s.css["font-size"]),s.margins&&(N=s.margins)),this.lnMod=0,a={x:void 0,y:void 0,w:void 0,h:void 0,ln:void 0},o=1,this.printHeaders=E,this.margins=N,this.setFontSize(S),this.table_font_size=S,null==n)g=Object.keys(r[0]);else if(n[0]&&"string"!=typeof n[0])for(l=0,f=n.length;l<f;l+=1)c=n[l],g.push(c.name),v.push(c.prompt),A[c.name]=c.width*(19.049976/25.4);else g=n;if(k)for(y=function(t){return t[c]},l=0,f=g.length;l<f;l+=1){for(b[c=g[l]]=r.map(y),x.push(this.getTextDimensions(v[l]||c,{scaleFactor:1}).w),d=0,$=(p=b[c]).length;d<$;d+=1)h=p[d],x.push(this.getTextDimensions(h,{scaleFactor:1}).w);A[c]=i.arrayMax(x),x=[]}if(E){var I=this.calculateLineHeight(g,A,v.length?v:g);for(l=0,f=g.length;l<f;l+=1)c=g[l],w.push([t,e,A[c],I,String(v.length?v[l]:c)]);this.setTableHeaderRow(w),this.printHeaderRow(1,!1)}for(l=0,f=r.length;l<f;l+=1)for(_=r[l],I=this.calculateLineHeight(g,A,_),d=0,m=g.length;d<m;d+=1)c=g[d],this.cell(t,e,A[c],I,_[c],l+2,c.align);return this.lastCellPos=a,this.table_x=t,this.table_y=e,this},i.calculateLineHeight=function(t,e,r){for(var n,i=0,s=0;s<t.length;s++){r[n=t[s]]=this.splitTextToSize(String(r[n]),e[n]-3);var a=this.internal.getLineHeight()*r[n].length+3;a>i&&(i=a)}return i},i.setTableHeaderRow=function(t){this.tableHeaderRow=t},i.printHeaderRow=function(t,e){if(!this.tableHeaderRow)throw"Property tableHeaderRow does not exist.";var r,n,i,a;if(this.printingHeaderRow=!0,void 0!==s){var l=s(this,o);c(l[0],l[1],l[2],l[3],-1)}this.setFontStyle("bold");var u=[];for(i=0,a=this.tableHeaderRow.length;i<a;i+=1)this.setFillColor(200,200,200),r=this.tableHeaderRow[i],e&&(this.margins.top=13,r[1]=this.margins&&this.margins.top||0,u.push(r)),n=[].concat(r),this.cell.apply(this,n.concat(t));u.length>0&&this.setTableHeaderRow(u),this.setFontStyle("normal"),this.printingHeaderRow=!1},function(t,e){var r,i,s,a,o,c=function(t){return t=t||{},this.isStrokeTransparent=t.isStrokeTransparent||!1,this.strokeOpacity=t.strokeOpacity||1,this.strokeStyle=t.strokeStyle||"#000000",this.fillStyle=t.fillStyle||"#000000",this.isFillTransparent=t.isFillTransparent||!1,this.fillOpacity=t.fillOpacity||1,this.font=t.font||"10px sans-serif",this.textBaseline=t.textBaseline||"alphabetic",this.textAlign=t.textAlign||"left",this.lineWidth=t.lineWidth||1,this.lineJoin=t.lineJoin||"miter",this.lineCap=t.lineCap||"butt",this.path=t.path||[],this.transform=void 0!==t.transform?t.transform.clone():new F,this.globalCompositeOperation=t.globalCompositeOperation||"normal",this.globalAlpha=t.globalAlpha||1,this.clip_path=t.clip_path||[],this.currentPoint=t.currentPoint||new M,this.miterLimit=t.miterLimit||10,this.lastPoint=t.lastPoint||new M,this.ignoreClearRect="boolean"!=typeof t.ignoreClearRect||t.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new l(this),r=this.internal.f2,this.internal.f3,i=this.internal.getCoordinateString,s=this.internal.getVerticalCoordinateString,a=this.internal.getHorizontalCoordinate,o=this.internal.getVerticalCoordinate}]);var l=function(t){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}}),Object.defineProperty(this,"pdf",{get:function(){return t}});var e=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return e},set:function(t){e=Boolean(t)}});var r=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return r},set:function(t){r=Boolean(t)}});var n=0;Object.defineProperty(this,"posX",{get:function(){return n},set:function(t){isNaN(t)||(n=t)}});var i=0;Object.defineProperty(this,"posY",{get:function(){return i},set:function(t){isNaN(t)||(i=t)}});var s=!1;Object.defineProperty(this,"autoPaging",{get:function(){return s},set:function(t){s=Boolean(t)}});var a=0;Object.defineProperty(this,"lastBreak",{get:function(){return a},set:function(t){a=t}});var o=[];Object.defineProperty(this,"pageBreaks",{get:function(){return o},set:function(t){o=t}});var l=new c;Object.defineProperty(this,"ctx",{get:function(){return l},set:function(t){t instanceof c&&(l=t)}}),Object.defineProperty(this,"path",{get:function(){return l.path},set:function(t){l.path=t}});var f=[];Object.defineProperty(this,"ctxStack",{get:function(){return f},set:function(t){f=t}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(t){var e;e=u(t),this.ctx.fillStyle=e.style,this.ctx.isFillTransparent=0===e.a,this.ctx.fillOpacity=e.a,this.pdf.setFillColor(e.r,e.g,e.b,{a:e.a}),this.pdf.setTextColor(e.r,e.g,e.b,{a:e.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(t){var e=u(t);this.ctx.strokeStyle=e.style,this.ctx.isStrokeTransparent=0===e.a,this.ctx.strokeOpacity=e.a,0===e.a?this.pdf.setDrawColor(255,255,255):(e.a,this.pdf.setDrawColor(e.r,e.g,e.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(t){-1!==["butt","round","square"].indexOf(t)&&(this.ctx.lineCap=t,this.pdf.setLineCap(t))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(t){isNaN(t)||(this.ctx.lineWidth=t,this.pdf.setLineWidth(t))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(t){-1!==["bevel","round","miter"].indexOf(t)&&(this.ctx.lineJoin=t,this.pdf.setLineJoin(t))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(t){isNaN(t)||(this.ctx.miterLimit=t,this.pdf.setMiterLimit(t))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(t){this.ctx.textBaseline=t}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(t){-1!==["right","end","center","left","start"].indexOf(t)&&(this.ctx.textAlign=t)}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(t){var e;if(this.ctx.font=t,null!==(e=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(t))){var r=e[1],n=(e[2],e[3]),i=e[4],s=e[5],a=e[6];i="px"===s?Math.floor(parseFloat(i)):"em"===s?Math.floor(parseFloat(i)*this.pdf.getFontSize()):Math.floor(parseFloat(i)),this.pdf.setFontSize(i);var o="";("bold"===n||parseInt(n,10)>=700||"bold"===r)&&(o="bold"),"italic"===r&&(o+="italic"),0===o.length&&(o="normal");for(var c="",l=a.toLowerCase().replace(/"|'/g,"").split(/\s*,\s*/),u={arial:"Helvetica",verdana:"Helvetica",helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",courier:"Courier",times:"Times",cursive:"Times",fantasy:"Times",serif:"Times"},f=0;f<l.length;f++){if(void 0!==this.pdf.internal.getFont(l[f],o,{noFallback:!0,disableWarning:!0})){c=l[f];break}if("bolditalic"===o&&void 0!==this.pdf.internal.getFont(l[f],"bold",{noFallback:!0,disableWarning:!0}))c=l[f],o="bold";else if(void 0!==this.pdf.internal.getFont(l[f],"normal",{noFallback:!0,disableWarning:!0})){c=l[f],o="normal";break}}if(""===c)for(f=0;f<l.length;f++)if(u[l[f]]){c=u[l[f]];break}c=""===c?"Times":c,this.pdf.setFont(c,o)}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(t){this.ctx.globalCompositeOperation=t}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(t){this.ctx.globalAlpha=t}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(t){this.ctx.ignoreClearRect=Boolean(t)}})};l.prototype.fill=function(){_.call(this,"fill",!1)},l.prototype.stroke=function(){_.call(this,"stroke",!1)},l.prototype.beginPath=function(){this.path=[{type:"begin"}]},l.prototype.moveTo=function(t,e){if(isNaN(t)||isNaN(e))throw console.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var r=this.ctx.transform.applyToPoint(new M(t,e));this.path.push({type:"mt",x:r.x,y:r.y}),this.ctx.lastPoint=new M(t,e)},l.prototype.closePath=function(){var t=new M(0,0),e=0;for(e=this.path.length-1;-1!==e;e--)if("begin"===this.path[e].type&&"object"===n(this.path[e+1])&&"number"==typeof this.path[e+1].x){t=new M(this.path[e+1].x,this.path[e+1].y),this.path.push({type:"lt",x:t.x,y:t.y});break}"object"===n(this.path[e+2])&&"number"==typeof this.path[e+2].x&&this.path.push(JSON.parse(JSON.stringify(this.path[e+2]))),this.path.push({type:"close"}),this.ctx.lastPoint=new M(t.x,t.y)},l.prototype.lineTo=function(t,e){if(isNaN(t)||isNaN(e))throw console.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var r=this.ctx.transform.applyToPoint(new M(t,e));this.path.push({type:"lt",x:r.x,y:r.y}),this.ctx.lastPoint=new M(r.x,r.y)},l.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),_.call(this,null,!0)},l.prototype.quadraticCurveTo=function(t,e,r,n){if(isNaN(r)||isNaN(n)||isNaN(t)||isNaN(e))throw console.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var i=this.ctx.transform.applyToPoint(new M(r,n)),s=this.ctx.transform.applyToPoint(new M(t,e));this.path.push({type:"qct",x1:s.x,y1:s.y,x:i.x,y:i.y}),this.ctx.lastPoint=new M(i.x,i.y)},l.prototype.bezierCurveTo=function(t,e,r,n,i,s){if(isNaN(i)||isNaN(s)||isNaN(t)||isNaN(e)||isNaN(r)||isNaN(n))throw console.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var a=this.ctx.transform.applyToPoint(new M(i,s)),o=this.ctx.transform.applyToPoint(new M(t,e)),c=this.ctx.transform.applyToPoint(new M(r,n));this.path.push({type:"bct",x1:o.x,y1:o.y,x2:c.x,y2:c.y,x:a.x,y:a.y}),this.ctx.lastPoint=new M(a.x,a.y)},l.prototype.arc=function(t,e,r,n,i,s){if(isNaN(t)||isNaN(e)||isNaN(r)||isNaN(n)||isNaN(i))throw console.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(s=Boolean(s),!this.ctx.transform.isIdentity){var a=this.ctx.transform.applyToPoint(new M(t,e));t=a.x,e=a.y;var o=this.ctx.transform.applyToPoint(new M(0,r)),c=this.ctx.transform.applyToPoint(new M(0,0));r=Math.sqrt(Math.pow(o.x-c.x,2)+Math.pow(o.y-c.y,2))}Math.abs(i-n)>=2*Math.PI&&(n=0,i=2*Math.PI),this.path.push({type:"arc",x:t,y:e,radius:r,startAngle:n,endAngle:i,counterclockwise:s})},l.prototype.arcTo=function(t,e,r,n,i){throw new Error("arcTo not implemented.")},l.prototype.rect=function(t,e,r,n){if(isNaN(t)||isNaN(e)||isNaN(r)||isNaN(n))throw console.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(t,e),this.lineTo(t+r,e),this.lineTo(t+r,e+n),this.lineTo(t,e+n),this.lineTo(t,e),this.lineTo(t+r,e),this.lineTo(t,e)},l.prototype.fillRect=function(t,e,r,n){if(isNaN(t)||isNaN(e)||isNaN(r)||isNaN(n))throw console.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!f.call(this)){var i={};"butt"!==this.lineCap&&(i.lineCap=this.lineCap,this.lineCap="butt"),"miter"!==this.lineJoin&&(i.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(t,e,r,n),this.fill(),i.hasOwnProperty("lineCap")&&(this.lineCap=i.lineCap),i.hasOwnProperty("lineJoin")&&(this.lineJoin=i.lineJoin)}},l.prototype.strokeRect=function(t,e,r,n){if(isNaN(t)||isNaN(e)||isNaN(r)||isNaN(n))throw console.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");$.call(this)||(this.beginPath(),this.rect(t,e,r,n),this.stroke())},l.prototype.clearRect=function(t,e,r,n){if(isNaN(t)||isNaN(e)||isNaN(r)||isNaN(n))throw console.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(t,e,r,n))},l.prototype.save=function(t){t="boolean"!=typeof t||t;for(var e=this.pdf.internal.getCurrentPageInfo().pageNumber,r=0;r<this.pdf.internal.getNumberOfPages();r++)this.pdf.setPage(r+1),this.pdf.internal.out("q");if(this.pdf.setPage(e),t){this.ctx.fontSize=this.pdf.internal.getFontSize();var n=new c(this.ctx);this.ctxStack.push(this.ctx),this.ctx=n}},l.prototype.restore=function(t){t="boolean"!=typeof t||t;for(var e=this.pdf.internal.getCurrentPageInfo().pageNumber,r=0;r<this.pdf.internal.getNumberOfPages();r++)this.pdf.setPage(r+1),this.pdf.internal.out("Q");this.pdf.setPage(e),t&&0!==this.ctxStack.length&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin)},l.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var u=function(t){var e,r,n,i;!0===t.isCanvasGradient&&(t=t.getColor());var s=new RGBColor(t);if(!t)return{r:0,g:0,b:0,a:0,style:t};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(t))e=0,r=0,n=0,i=0;else{var a=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(t);null!==a?(e=parseInt(a[1]),r=parseInt(a[2]),n=parseInt(a[3]),i=1):null!==(a=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d\.]+)\s*\)/.exec(t))?(e=parseInt(a[1]),r=parseInt(a[2]),n=parseInt(a[3]),i=parseFloat(a[4])):(i=1,"#"!==t.charAt(0)&&(t=s.ok?s.toHex():"#000000"),4===t.length?(e=t.substring(1,2),e+=e,r=t.substring(2,3),r+=r,n=t.substring(3,4),n+=n):(e=t.substring(1,3),r=t.substring(3,5),n=t.substring(5,7)),e=parseInt(e,16),r=parseInt(r,16),n=parseInt(n,16))}return{r:e,g:r,b:n,a:i,style:t}},f=function(){return this.ctx.isFillTransparent||0==this.globalAlpha},$=function(){return Boolean(this.ctx.isStrokeTransparent||0==this.globalAlpha)};l.prototype.fillText=function(t,e,r,n){if(isNaN(e)||isNaN(r)||"string"!=typeof t)throw console.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(n=isNaN(n)?void 0:n,!f.call(this)){r=y.call(this,r);var i=I(this.ctx.transform.rotation),s=this.ctx.transform.scaleX;x.call(this,{text:t,x:e,y:r,scale:s,angle:i,align:this.textAlign,maxWidth:n})}},l.prototype.strokeText=function(t,e,r,n){if(isNaN(e)||isNaN(r)||"string"!=typeof t)throw console.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!$.call(this)){n=isNaN(n)?void 0:n,r=y.call(this,r);var i=I(this.ctx.transform.rotation),s=this.ctx.transform.scaleX;x.call(this,{text:t,x:e,y:r,scale:s,renderingMode:"stroke",angle:i,align:this.textAlign,maxWidth:n})}},l.prototype.measureText=function(t){if("string"!=typeof t)throw console.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var e=this.pdf,r=this.pdf.internal.scaleFactor,n=e.internal.getFontSize(),i=e.getStringUnitWidth(t)*n/e.internal.scaleFactor;return new function(t){var e=(t=t||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return e}}),this}({width:i*=Math.round(96*r/72*1e4)/1e4})},l.prototype.scale=function(t,e){if(isNaN(t)||isNaN(e))throw console.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var r=new F(t,0,0,e,0,0);this.ctx.transform=this.ctx.transform.multiply(r)},l.prototype.rotate=function(t){if(isNaN(t))throw console.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var e=new F(Math.cos(t),Math.sin(t),-Math.sin(t),Math.cos(t),0,0);this.ctx.transform=this.ctx.transform.multiply(e)},l.prototype.translate=function(t,e){if(isNaN(t)||isNaN(e))throw console.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var r=new F(1,0,0,1,t,e);this.ctx.transform=this.ctx.transform.multiply(r)},l.prototype.transform=function(t,e,r,n,i,s){if(isNaN(t)||isNaN(e)||isNaN(r)||isNaN(n)||isNaN(i)||isNaN(s))throw console.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var a=new F(t,e,r,n,i,s);this.ctx.transform=this.ctx.transform.multiply(a)},l.prototype.setTransform=function(t,e,r,n,i,s){t=isNaN(t)?1:t,e=isNaN(e)?0:e,r=isNaN(r)?0:r,n=isNaN(n)?1:n,i=isNaN(i)?0:i,s=isNaN(s)?0:s,this.ctx.transform=new F(t,e,r,n,i,s)},l.prototype.drawImage=function(t,e,r,n,i,s,a,o,c){var l=this.pdf.getImageProperties(t),u=1,f=1,$=1,p=1;void 0!==n&&void 0!==o&&($=o/n,p=c/i,u=l.width/n*o/n,f=l.height/i*c/i),void 0===s&&(s=e,a=r,e=0,r=0),void 0!==n&&void 0===o&&(o=n,c=i),void 0===n&&void 0===o&&(o=l.width,c=l.height);var _=this.ctx.transform.decompose(),y=I(_.rotate.shx);_.scale.sx,_.scale.sy;for(var g,v=new F,b=((v=(v=(v=v.multiply(_.translate)).multiply(_.skew)).multiply(_.scale)).applyToPoint(new M(o,c)),v.applyToRectangle(new P(s-e*$,a-r*p,n*u,i*f))),A=h.call(this,b),x=[],w=0;w<A.length;w+=1)-1===x.indexOf(A[w])&&x.push(A[w]);if(x.sort(),this.autoPaging)for(var k=x[0],E=x[x.length-1],S=k;S<E+1;S++){if(this.pdf.setPage(S),0!==this.ctx.clip_path.length){var N=this.path;g=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=d(g,this.posX,-1*this.pdf.internal.pageSize.height*(S-1)+this.posY),m.call(this,"fill",!0),this.path=N}var C=JSON.parse(JSON.stringify(b));C=d([C],this.posX,-1*this.pdf.internal.pageSize.height*(S-1)+this.posY)[0],this.pdf.addImage(t,"jpg",C.x,C.y,C.w,C.h,null,null,y)}else this.pdf.addImage(t,"jpg",b.x,b.y,b.w,b.h,null,null,y)};var h=function(t,e,r){var n=[];switch(e=e||this.pdf.internal.pageSize.width,r=r||this.pdf.internal.pageSize.height,t.type){default:case"mt":case"lt":n.push(Math.floor((t.y+this.posY)/r)+1);break;case"arc":n.push(Math.floor((t.y+this.posY-t.radius)/r)+1),n.push(Math.floor((t.y+this.posY+t.radius)/r)+1);break;case"qct":var i=O(this.ctx.lastPoint.x,this.ctx.lastPoint.y,t.x1,t.y1,t.x,t.y);n.push(Math.floor(i.y/r)+1),n.push(Math.floor((i.y+i.h)/r)+1);break;case"bct":var s=B(this.ctx.lastPoint.x,this.ctx.lastPoint.y,t.x1,t.y1,t.x2,t.y2,t.x,t.y);n.push(Math.floor(s.y/r)+1),n.push(Math.floor((s.y+s.h)/r)+1);break;case"rect":n.push(Math.floor((t.y+this.posY)/r)+1),n.push(Math.floor((t.y+t.h+this.posY)/r)+1)}for(var a=0;a<n.length;a+=1)for(;this.pdf.internal.getNumberOfPages()<n[a];)p.call(this);return n},p=function(){var t=this.fillStyle,e=this.strokeStyle,r=this.font,n=this.lineCap,i=this.lineWidth,s=this.lineJoin;this.pdf.addPage(),this.fillStyle=t,this.strokeStyle=e,this.font=r,this.lineCap=n,this.lineWidth=i,this.lineJoin=s},d=function(t,e,r){for(var n=0;n<t.length;n++)switch(t[n].type){case"bct":t[n].x2+=e,t[n].y2+=r;case"qct":t[n].x1+=e,t[n].y1+=r;case"mt":case"lt":case"arc":default:t[n].x+=e,t[n].y+=r}return t},_=function(t,e){for(var r,n,i=this.fillStyle,s=this.strokeStyle,a=(this.font,this.lineCap),o=this.lineWidth,c=this.lineJoin,l=JSON.parse(JSON.stringify(this.path)),u=JSON.parse(JSON.stringify(this.path)),f=[],$=0;$<u.length;$++)if(void 0!==u[$].x)for(var _=h.call(this,u[$]),y=0;y<_.length;y+=1)-1===f.indexOf(_[y])&&f.push(_[y]);for($=0;$<f.length;$++)for(;this.pdf.internal.getNumberOfPages()<f[$];)p.call(this);if(f.sort(),this.autoPaging){var g=f[0],v=f[f.length-1];for($=g;$<v+1;$++){if(this.pdf.setPage($),this.fillStyle=i,this.strokeStyle=s,this.lineCap=a,this.lineWidth=o,this.lineJoin=c,0!==this.ctx.clip_path.length){var b=this.path;r=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=d(r,this.posX,-1*this.pdf.internal.pageSize.height*($-1)+this.posY),m.call(this,t,!0),this.path=b}n=JSON.parse(JSON.stringify(l)),this.path=d(n,this.posX,-1*this.pdf.internal.pageSize.height*($-1)+this.posY),!1!==e&&0!==$||m.call(this,t,e)}}else m.call(this,t,e);this.path=l},m=function(t,e){if(("stroke"!==t||e||!$.call(this))&&("stroke"===t||e||!f.call(this))){var r=[];this.ctx.globalAlpha;this.ctx.fillOpacity<1&&this.ctx.fillOpacity;for(var n,i=this.path,s=0;s<i.length;s++){var a=i[s];switch(a.type){case"begin":r.push({begin:!0});break;case"close":r.push({close:!0});break;case"mt":r.push({start:a,deltas:[],abs:[]});break;case"lt":var o=r.length;if(!isNaN(i[s-1].x)){var c=[a.x-i[s-1].x,a.y-i[s-1].y];if(o>0)for(;o>=0;o--)if(!0!==r[o-1].close&&!0!==r[o-1].begin){r[o-1].deltas.push(c),r[o-1].abs.push(a);break}}break;case"bct":c=[a.x1-i[s-1].x,a.y1-i[s-1].y,a.x2-i[s-1].x,a.y2-i[s-1].y,a.x-i[s-1].x,a.y-i[s-1].y];r[r.length-1].deltas.push(c);break;case"qct":var l=i[s-1].x+2/3*(a.x1-i[s-1].x),u=i[s-1].y+2/3*(a.y1-i[s-1].y),h=a.x+2/3*(a.x1-a.x),p=a.y+2/3*(a.y1-a.y),d=a.x,_=a.y;c=[l-i[s-1].x,u-i[s-1].y,h-i[s-1].x,p-i[s-1].y,d-i[s-1].x,_-i[s-1].y];r[r.length-1].deltas.push(c);break;case"arc":r.push({deltas:[],abs:[],arc:!0}),Array.isArray(r[r.length-1].abs)&&r[r.length-1].abs.push(a)}}n=e?null:"stroke"===t?"stroke":"fill";for(s=0;s<r.length;s++){if(r[s].arc)for(var m=r[s].abs,y=0;y<m.length;y++){var A=m[y];if(void 0!==A.startAngle){var x=I(A.startAngle),E=I(A.endAngle),S=A.x,N=A.y;g.call(this,S,N,A.radius,x,E,A.counterclockwise,n,e)}else w.call(this,A.x,A.y)}if(!r[s].arc&&!0!==r[s].close&&!0!==r[s].begin){S=r[s].start.x,N=r[s].start.y;k.call(this,r[s].deltas,S,N,null,null)}}n&&v.call(this,n),e&&b.call(this)}},y=function(t){var e=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,r=e*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return t-r;case"top":return t+e-r;case"hanging":return t+e-2*r;case"middle":return t+e/2-r;case"ideographic":return t;case"alphabetic":default:return t}};l.prototype.createLinearGradient=function(){var t=function(){};return t.colorStops=[],t.addColorStop=function(t,e){this.colorStops.push([t,e])},t.getColor=function(){return 0===this.colorStops.length?"#000000":this.colorStops[0][1]},t.isCanvasGradient=!0,t},l.prototype.createPattern=function(){return this.createLinearGradient()},l.prototype.createRadialGradient=function(){return this.createLinearGradient()};var g=function(t,e,r,n,i,s,a,o){this.pdf.internal.scaleFactor;for(var c=C(n),l=C(i),u=S.call(this,r,c,l,s),f=0;f<u.length;f++){var $=u[f];0===f&&A.call(this,$.x1+t,$.y1+e),E.call(this,t,e,$.x2,$.y2,$.x3,$.y3,$.x4,$.y4)}o?b.call(this):v.call(this,a)},v=function(t){switch(t){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},b=function(){this.pdf.clip()},A=function(t,e){this.pdf.internal.out(i(t)+" "+s(e)+" m")},x=function(t){var e;switch(t.align){case"right":case"end":e="right";break;case"center":e="center";break;case"left":case"start":default:e="left"}var r=this.ctx.transform.applyToPoint(new M(t.x,t.y)),n=this.ctx.transform.decompose(),i=new F;i=(i=(i=i.multiply(n.translate)).multiply(n.skew)).multiply(n.scale);for(var s,a=this.pdf.getTextDimensions(t.text),o=this.ctx.transform.applyToRectangle(new P(t.x,t.y,a.w,a.h)),c=i.applyToRectangle(new P(t.x,t.y-a.h,a.w,a.h)),l=h.call(this,c),u=[],f=0;f<l.length;f+=1)-1===u.indexOf(l[f])&&u.push(l[f]);if(u.sort(),!0===this.autoPaging)for(var $=u[0],p=u[u.length-1],_=$;_<p+1;_++){if(this.pdf.setPage(_),0!==this.ctx.clip_path.length){var y=this.path;s=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=d(s,this.posX,-1*this.pdf.internal.pageSize.height*(_-1)+this.posY),m.call(this,"fill",!0),this.path=y}var g=JSON.parse(JSON.stringify(o));if(g=d([g],this.posX,-1*this.pdf.internal.pageSize.height*(_-1)+this.posY)[0],t.scale>=.01){var v=this.pdf.internal.getFontSize();this.pdf.setFontSize(v*t.scale)}this.pdf.text(t.text,g.x,g.y,{angle:t.angle,align:e,renderingMode:t.renderingMode,maxWidth:t.maxWidth}),t.scale>=.01&&this.pdf.setFontSize(v)}else{if(t.scale>=.01){v=this.pdf.internal.getFontSize();this.pdf.setFontSize(v*t.scale)}this.pdf.text(t.text,r.x+this.posX,r.y+this.posY,{angle:t.angle,align:e,renderingMode:t.renderingMode,maxWidth:t.maxWidth}),t.scale>=.01&&this.pdf.setFontSize(v)}},w=function(t,e,r,n){r=r||0,n=n||0,this.pdf.internal.out(i(t+r)+" "+s(e+n)+" l")},k=function(t,e,r){return this.pdf.lines(t,e,r,null,null)},E=function(t,e,n,i,s,c,l,u){this.pdf.internal.out([r(a(n+t)),r(o(i+e)),r(a(s+t)),r(o(c+e)),r(a(l+t)),r(o(u+e)),"c"].join(" "))},S=function(t,e,r,n){var i=2*Math.PI,s=e;(s<i||s>i)&&(s%=i);var a=r;(a<i||a>i)&&(a%=i);for(var o=[],c=Math.PI/2,l=n?-1:1,u=e,f=Math.min(i,Math.abs(a-s));f>1e-5;){var $=u+l*Math.min(f,c);o.push(N.call(this,t,u,$)),f-=Math.abs($-u),u=$}return o},N=function(t,e,r){var n=(r-e)/2,i=t*Math.cos(n),s=t*Math.sin(n),a=i,o=-s,c=a*a+o*o,l=c+a*i+o*s,u=4/3*(Math.sqrt(2*c*l)-l)/(a*s-o*i),f=a-u*o,$=o+u*a,h=f,p=-$,d=n+e,_=Math.cos(d),m=Math.sin(d);return{x1:t*Math.cos(e),y1:t*Math.sin(e),x2:f*_-$*m,y2:f*m+$*_,x3:h*_-p*m,y3:h*m+p*_,x4:t*Math.cos(r),y4:t*Math.sin(r)}},I=function(t){return 180*t/Math.PI},C=function(t){return t*Math.PI/180},O=function(t,e,r,n,i,s){var a=t+.5*(r-t),o=e+.5*(n-e),c=i+.5*(r-i),l=s+.5*(n-s),u=Math.min(t,i,a,c),f=Math.max(t,i,a,c),$=Math.min(e,s,o,l),h=Math.max(e,s,o,l);return new P(u,$,f-u,h-$)},B=function(t,e,r,n,i,s,a,o){for(var c,l,u,f,$,h,p,d,_,m,y,g,v,b=r-t,A=n-e,x=i-r,w=s-n,k=a-i,E=o-s,S=0;S<41;S++)d=(h=(l=t+(c=S/40)*b)+c*((f=r+c*x)-l))+c*(f+c*(i+c*k-f)-h),_=(p=(u=e+c*A)+c*(($=n+c*w)-u))+c*($+c*(s+c*E-$)-p),0==S?(m=d,y=_,g=d,v=_):(m=Math.min(m,d),y=Math.min(y,_),g=Math.max(g,d),v=Math.max(v,_));return new P(Math.round(m),Math.round(y),Math.round(g-m),Math.round(v-y))},M=function(t,e){var r=t||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return r},set:function(t){isNaN(t)||(r=parseFloat(t))}});var n=e||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return n},set:function(t){isNaN(t)||(n=parseFloat(t))}});var i="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return i},set:function(t){i=t.toString()}}),this},P=function(t,e,r,n){M.call(this,t,e),this.type="rect";var i=r||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return i},set:function(t){isNaN(t)||(i=parseFloat(t))}});var s=n||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return s},set:function(t){isNaN(t)||(s=parseFloat(t))}}),this},F=function(t,e,r,n,i,s){var a=[];return Object.defineProperty(this,"sx",{get:function(){return a[0]},set:function(t){a[0]=Math.round(1e5*t)/1e5}}),Object.defineProperty(this,"shy",{get:function(){return a[1]},set:function(t){a[1]=Math.round(1e5*t)/1e5}}),Object.defineProperty(this,"shx",{get:function(){return a[2]},set:function(t){a[2]=Math.round(1e5*t)/1e5}}),Object.defineProperty(this,"sy",{get:function(){return a[3]},set:function(t){a[3]=Math.round(1e5*t)/1e5}}),Object.defineProperty(this,"tx",{get:function(){return a[4]},set:function(t){a[4]=Math.round(1e5*t)/1e5}}),Object.defineProperty(this,"ty",{get:function(){return a[5]},set:function(t){a[5]=Math.round(1e5*t)/1e5}}),Object.defineProperty(this,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(this,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(this,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(this,"isIdentity",{get:function(){return 1===this.sx&&(0===this.shy&&(0===this.shx&&(1===this.sy&&(0===this.tx&&0===this.ty))))}}),this.sx=isNaN(t)?1:t,this.shy=isNaN(e)?0:e,this.shx=isNaN(r)?0:r,this.sy=isNaN(n)?1:n,this.tx=isNaN(i)?0:i,this.ty=isNaN(s)?0:s,this};F.prototype.multiply=function(t){var e=t.sx*this.sx+t.shy*this.shx,r=t.sx*this.shy+t.shy*this.sy,n=t.shx*this.sx+t.sy*this.shx,i=t.shx*this.shy+t.sy*this.sy,s=t.tx*this.sx+t.ty*this.shx+this.tx,a=t.tx*this.shy+t.ty*this.sy+this.ty;return new F(e,r,n,i,s,a)},F.prototype.decompose=function(){var t=this.sx,e=this.shy,r=this.shx,n=this.sy,i=this.tx,s=this.ty,a=Math.sqrt(t*t+e*e),o=(t/=a)*r+(e/=a)*n;r-=t*o,n-=e*o;var c=Math.sqrt(r*r+n*n);return o/=c,t*(n/=c)<e*(r/=c)&&(t=-t,e=-e,o=-o,a=-a),{scale:new F(a,0,0,c,0,0),translate:new F(1,0,0,1,i,s),rotate:new F(t,e,-e,t,0,0),skew:new F(1,0,o,1,0,0)}},F.prototype.applyToPoint=function(t){var e=t.x*this.sx+t.y*this.shx+this.tx,r=t.x*this.shy+t.y*this.sy+this.ty;return new M(e,r)},F.prototype.applyToRectangle=function(t){var e=this.applyToPoint(t),r=this.applyToPoint(new M(t.x+t.w,t.y+t.h));return new P(e.x,e.y,r.x-e.x,r.y-e.y)},F.prototype.clone=function(){var t=this.sx,e=this.shy,r=this.shx,n=this.sy,i=this.tx,s=this.ty;return new F(t,e,r,n,i,s)}}(v.API,"undefined"!=typeof self&&self||"undefined"!=typeof window&&window||"undefined"!=typeof global&&global||Function('return typeof this === "object" && this.content')()||Function("return this")()),function(t){var e=function(t){var e,r,n,i,s,a,o,c,l,u;for(/[^\x00-\xFF]/.test(t),r=[],n=0,i=(t+=e="\0\0\0\0".slice(t.length%4||4)).length;i>n;n+=4)0!==(s=(t.charCodeAt(n)<<24)+(t.charCodeAt(n+1)<<16)+(t.charCodeAt(n+2)<<8)+t.charCodeAt(n+3))?(a=(s=((s=((s=((s=(s-(u=s%85))/85)-(l=s%85))/85)-(c=s%85))/85)-(o=s%85))/85)%85,r.push(a+33,o+33,c+33,l+33,u+33)):r.push(122);return function(t,e){for(var r=e;r>0;r--)t.pop()}(r,e.length),String.fromCharCode.apply(String,r)+"~>"},r=function(t){var e,r,n,i,s,a=String,o="length",c=255,l="charCodeAt",u="slice",f="replace";for(t[u](-2),t=t[u](0,-2)[f](/\s/g,"")[f]("z","!!!!!"),n=[],i=0,s=(t+=e="uuuuu"[u](t[o]%5||5))[o];s>i;i+=5)r=52200625*(t[l](i)-33)+614125*(t[l](i+1)-33)+7225*(t[l](i+2)-33)+85*(t[l](i+3)-33)+(t[l](i+4)-33),n.push(c&r>>24,c&r>>16,c&r>>8,c&r);return function(t,e){for(var r=e;r>0;r--)t.pop()}(n,e[o]),a.fromCharCode.apply(a,n)},n=function(t){for(var e="",r=0;r<t.length;r+=1)e+=("0"+t.charCodeAt(r).toString(16)).slice(-2);return e+=">"},i=function(t){var e=new RegExp(/^([0-9A-Fa-f]{2})+$/);if(-1!==(t=t.replace(/\s/g,"")).indexOf(">")&&(t=t.substr(0,t.indexOf(">"))),t.length%2&&(t+="0"),!1===e.test(t))return"";for(var r="",n=0;n<t.length;n+=2)r+=String.fromCharCode("0x"+(t[n]+t[n+1]));return r},s=function(e,r){r=Object.assign({predictor:1,colors:1,bitsPerComponent:8,columns:1},r);for(var n,i,s=[],a=e.length;a--;)s[a]=e.charCodeAt(a);return n=t.adler32cs.from(e),(i=new Deflater(6)).append(new Uint8Array(s)),e=i.flush(),(s=new Uint8Array(e.length+6)).set(new Uint8Array([120,156])),s.set(e,2),s.set(new Uint8Array([255&n,n>>8&255,n>>16&255,n>>24&255]),e.length+2),e=String.fromCharCode.apply(null,s)};t.processDataByFilters=function(t,a){var o=0,c=t||"",l=[];for("string"==typeof(a=a||[])&&(a=[a]),o=0;o<a.length;o+=1)switch(a[o]){case"ASCII85Decode":case"/ASCII85Decode":c=r(c),l.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":c=e(c),l.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":c=i(c),l.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":c=n(c),l.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":c=s(c),l.push("/FlateDecode");break;default:throw'The filter: "'+a[o]+'" is not implemented'}return{data:c,reverseChain:l.reverse().join(" ")}}}(v.API),function(t){t.loadFile=function(t,e,r){var n;e=e||!0,r=r||function(){};try{n=function(t,e,r){var n=new XMLHttpRequest,i=[],s=0,a=function(t){var e=t.length,r=String.fromCharCode;for(s=0;s<e;s+=1)i.push(r(255&t.charCodeAt(s)));return i.join("")};if(n.open("GET",t,!e),n.overrideMimeType("text/plain; charset=x-user-defined"),!1===e&&(n.onload=function(){return a(this.responseText)}),n.send(null),200===n.status)return e?a(n.responseText):void 0;console.warn('Unable to load file "'+t+'"')}(t,e)}catch(t){n=void 0}return n},t.loadImageFile=t.loadFile}(v.API),function(t,e){var r=function(t){var e=n(t);return"undefined"===e?"undefined":"string"===e||t instanceof String?"string":"number"===e||t instanceof Number?"number":"function"===e||t instanceof Function?"function":t&&t.constructor===Array?"array":t&&1===t.nodeType?"element":"object"===e?"object":"unknown"},i=function(t,e){var r=document.createElement(t);if(e.className&&(r.className=e.className),e.innerHTML){r.innerHTML=e.innerHTML;for(var n=r.getElementsByTagName("script"),i=n.length;i-- >0;null)n[i].parentNode.removeChild(n[i])}for(var s in e.style)r.style[s]=e.style[s];return r},s=function t(e){var r=Object.assign(t.convert(Promise.resolve()),JSON.parse(JSON.stringify(t.template))),n=t.convert(Promise.resolve(),r);return n=(n=n.setProgress(1,t,1,[t])).set(e)};(s.prototype=Object.create(Promise.prototype)).constructor=s,s.convert=function(t,e){return t.__proto__=e||s.prototype,t},s.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{}}},s.prototype.from=function(t,e){return this.then(function(){switch(e=e||function(t){switch(r(t)){case"string":return"string";case"element":return"canvas"===t.nodeName.toLowerCase?"canvas":"element";default:return"unknown"}}(t)){case"string":return this.set({src:i("div",{innerHTML:t})});case"element":return this.set({src:t});case"canvas":return this.set({canvas:t});case"img":return this.set({img:t});default:return this.error("Unknown source type.")}})},s.prototype.to=function(t){switch(t){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},s.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var t={position:"relative",display:"inline-block",width:Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:"white"},e=function t(e,r){for(var n=3===e.nodeType?document.createTextNode(e.nodeValue):e.cloneNode(!1),i=e.firstChild;i;i=i.nextSibling)!0!==r&&1===i.nodeType&&"SCRIPT"===i.nodeName||n.appendChild(t(i,r));return 1===e.nodeType&&("CANVAS"===e.nodeName?(n.width=e.width,n.height=e.height,n.getContext("2d").drawImage(e,0,0)):"TEXTAREA"!==e.nodeName&&"SELECT"!==e.nodeName||(n.value=e.value),n.addEventListener("load",function(){n.scrollTop=e.scrollTop,n.scrollLeft=e.scrollLeft},!0)),n}(this.prop.src,this.opt.html2canvas.javascriptEnabled);"BODY"===e.tagName&&(t.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=i("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=i("div",{className:"html2pdf__container",style:t}),this.prop.container.appendChild(e),this.prop.container.firstChild.appendChild(i("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},s.prototype.toCanvas=function(){var t=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(t).then(function(){var t=Object.assign({},this.opt.html2canvas);if(delete t.onrendered,this.isHtml2CanvasLoaded())return html2canvas(this.prop.container,t)}).then(function(t){(this.opt.html2canvas.onrendered||function(){})(t),this.prop.canvas=t,document.body.removeChild(this.prop.overlay)})},s.prototype.toContext2d=function(){var t=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(t).then(function(){var t=this.opt.jsPDF,e=Object.assign({async:!0,allowTaint:!0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete e.onrendered,t.context2d.autoPaging=!0,t.context2d.posX=this.opt.x,t.context2d.posY=this.opt.y,e.windowHeight=e.windowHeight||0,e.windowHeight=0==e.windowHeight?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):e.windowHeight,this.isHtml2CanvasLoaded())return html2canvas(this.prop.container,e)}).then(function(t){(this.opt.html2canvas.onrendered||function(){})(t),this.prop.canvas=t,document.body.removeChild(this.prop.overlay)})},s.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var t=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=t})},s.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},s.prototype.output=function(t,e,r){return"img"===(r=r||"pdf").toLowerCase()||"image"===r.toLowerCase()?this.outputImg(t,e):this.outputPdf(t,e)},s.prototype.outputPdf=function(t,e){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(t,e)})},s.prototype.outputImg=function(t,e){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(t){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+t+'" is not supported.'}})},s.prototype.isHtml2CanvasLoaded=function(){var t=void 0!==e.html2canvas;return t||console.error("html2canvas not loaded."),t},s.prototype.save=function(t){if(this.isHtml2CanvasLoaded())return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(t?{filename:t}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},s.prototype.doCallback=function(t){if(this.isHtml2CanvasLoaded())return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},s.prototype.set=function(t){if("object"!==r(t))return this;var e=Object.keys(t||{}).map(function(e){if(e in s.template.prop)return function(){this.prop[e]=t[e]};switch(e){case"margin":return this.setMargin.bind(this,t.margin);case"jsPDF":return function(){return this.opt.jsPDF=t.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,t.pageSize);default:return function(){this.opt[e]=t[e]}}},this);return this.then(function(){return this.thenList(e)})},s.prototype.get=function(t,e){return this.then(function(){var r=t in s.template.prop?this.prop[t]:this.opt[t];return e?e(r):r})},s.prototype.setMargin=function(t){return this.then(function(){switch(r(t)){case"number":t=[t,t,t,t];case"array":if(2===t.length&&(t=[t[0],t[1],t[0],t[1]]),4===t.length)break;default:return this.error("Invalid margin array.")}this.opt.margin=t}).then(this.setPageSize)},s.prototype.setPageSize=function(t){function e(t,e){return Math.floor(t*e/72*96)}return this.then(function(){(t=t||v.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(t.inner={width:t.width-this.opt.margin[1]-this.opt.margin[3],height:t.height-this.opt.margin[0]-this.opt.margin[2]},t.inner.px={width:e(t.inner.width,t.k),height:e(t.inner.height,t.k)},t.inner.ratio=t.inner.height/t.inner.width),this.prop.pageSize=t})},s.prototype.setProgress=function(t,e,r,n){return null!=t&&(this.progress.val=t),null!=e&&(this.progress.state=e),null!=r&&(this.progress.n=r),null!=n&&(this.progress.stack=n),this.progress.ratio=this.progress.val/this.progress.state,this},s.prototype.updateProgress=function(t,e,r,n){return this.setProgress(t?this.progress.val+t:null,e||null,r?this.progress.n+r:null,n?this.progress.stack.concat(n):null)},s.prototype.then=function(t,e){var r=this;return this.thenCore(t,e,function(t,e){return r.updateProgress(null,null,1,[t]),Promise.prototype.then.call(this,function(e){return r.updateProgress(null,t),e}).then(t,e).then(function(t){return r.updateProgress(1),t})})},s.prototype.thenCore=function(t,e,r){r=r||Promise.prototype.then;t&&(t=t.bind(this)),e&&(e=e.bind(this));var n=-1!==Promise.toString().indexOf("[native code]")&&"Promise"===Promise.name?this:s.convert(Object.assign({},this),Promise.prototype),i=r.call(n,t,e);return s.convert(i,this.__proto__)},s.prototype.thenExternal=function(t,e){return Promise.prototype.then.call(this,t,e)},s.prototype.thenList=function(t){var e=this;return t.forEach(function(t){e=e.thenCore(t)}),e},s.prototype.catch=function(t){t&&(t=t.bind(this));var e=Promise.prototype.catch.call(this,t);return s.convert(e,this)},s.prototype.catchExternal=function(t){return Promise.prototype.catch.call(this,t)},s.prototype.error=function(t){return this.then(function(){throw new Error(t)})},s.prototype.using=s.prototype.set,s.prototype.saveAs=s.prototype.save,s.prototype.export=s.prototype.output,s.prototype.run=s.prototype.then,v.getPageSize=function(t,e,r){if("object"===n(t)){var i=t;t=i.orientation,e=i.unit||e,r=i.format||r}e=e||"mm",r=r||"a4",t=(""+(t||"P")).toLowerCase();var s=(""+r).toLowerCase(),a={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(e){case"pt":var o=1;break;case"mm":o=72/25.4;break;case"cm":o=72/2.54;break;case"in":o=72;break;case"px":o=.75;break;case"pc":case"em":o=12;break;case"ex":o=6;break;default:throw"Invalid unit: "+e}if(a.hasOwnProperty(s))var c=a[s][1]/o,l=a[s][0]/o;else try{c=r[1],l=r[0]}catch(t){throw new Error("Invalid format: "+r)}if("p"===t||"portrait"===t){if(t="p",l>c){var u=l;l=c,c=u}}else{if("l"!==t&&"landscape"!==t)throw"Invalid orientation: "+t;if(t="l",c>l){u=l;l=c,c=u}}return{width:l,height:c,unit:e,k:o}},t.html=function(t,e){(e=e||{}).callback=e.callback||function(){},e.html2canvas=e.html2canvas||{},e.html2canvas.canvas=e.html2canvas.canvas||this.canvas,e.jsPDF=e.jsPDF||this;e.jsPDF;var r=new s(e);return e.worker?r:r.from(t).doCallback()}}(v.API,"undefined"!=typeof window&&window||"undefined"!=typeof global&&global),v.API.addJS=function(t){return h=t,this.internal.events.subscribe("postPutResources",function(t){f=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(f+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),$=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+h+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){void 0!==f&&void 0!==$&&this.internal.out("/Names <</JavaScript "+f+" 0 R>>")}),this},function(t){t.events.push(["postPutResources",function(){var t=this,e=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var r=t.outline.render().split(/\r\n/),n=0;n<r.length;n++){var i=r[n],s=e.exec(i);if(null!=s){var a=s[1];t.internal.newObjectDeferredBegin(a,!1)}t.internal.write(i)}if(this.outline.createNamedDestinations){var o=this.internal.pages.length,c=[];for(n=0;n<o;n++){var l=t.internal.newObject();c.push(l);var u=t.internal.getPageInfo(n+1);t.internal.write("<< /D["+u.objId+" 0 R /XYZ null null null]>> endobj")}var f=t.internal.newObject();t.internal.write("<< /Names [ ");for(n=0;n<c.length;n++)t.internal.write("(page_"+(n+1)+")"+c[n]+" 0 R");t.internal.write(" ] >>","endobj");t.internal.newObject();t.internal.write("<< /Dests "+f+" 0 R"),t.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+namesOid+" 0 R"))}]),t.events.push(["initialized",function(){var t=this;t.outline={createNamedDestinations:!1,root:{children:[]}},t.outline.add=function(t,e,r){var n={title:e,options:r,children:[]};return null==t&&(t=this.root),t.children.push(n),n},t.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=t,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},t.outline.genIds_r=function(e){e.id=t.internal.newObjectDeferred();for(var r=0;r<e.children.length;r++)this.genIds_r(e.children[r])},t.outline.renderRoot=function(t){this.objStart(t),this.line("/Type /Outlines"),t.children.length>0&&(this.line("/First "+this.makeRef(t.children[0])),this.line("/Last "+this.makeRef(t.children[t.children.length-1]))),this.line("/Count "+this.count_r({count:0},t)),this.objEnd()},t.outline.renderItems=function(e){this.ctx.pdf.internal.getCoordinateString;for(var r=this.ctx.pdf.internal.getVerticalCoordinateString,n=0;n<e.children.length;n++){var i=e.children[n];this.objStart(i),this.line("/Title "+this.makeString(i.title)),this.line("/Parent "+this.makeRef(e)),n>0&&this.line("/Prev "+this.makeRef(e.children[n-1])),n<e.children.length-1&&this.line("/Next "+this.makeRef(e.children[n+1])),i.children.length>0&&(this.line("/First "+this.makeRef(i.children[0])),this.line("/Last "+this.makeRef(i.children[i.children.length-1])));var s=this.count=this.count_r({count:0},i);if(s>0&&this.line("/Count "+s),i.options&&i.options.pageNumber){var a=t.internal.getPageInfo(i.options.pageNumber);this.line("/Dest ["+a.objId+" 0 R /XYZ 0 "+r(0)+" 0]")}this.objEnd()}for(n=0;n<e.children.length;n++){i=e.children[n];this.renderItems(i)}},t.outline.line=function(t){this.ctx.val+=t+"\r\n"},t.outline.makeRef=function(t){return t.id+" 0 R"},t.outline.makeString=function(e){return"("+t.internal.pdfEscape(e)+")"},t.outline.objStart=function(t){this.ctx.val+="\r\n"+t.id+" 0 obj\r\n<<\r\n"},t.outline.objEnd=function(t){this.ctx.val+=">> \r\nendobj\r\n"},t.outline.count_r=function(t,e){for(var r=0;r<e.children.length;r++)t.count++,this.count_r(t,e.children[r]);return t.count}}])}(v.API),function(t){var e=function(){var t="function"==typeof Deflater;if(!t)throw new Error("requires deflate.js for compression");return t},r=function(e,r,a,f){var $=5,h=c;switch(f){case t.image_compression.FAST:$=3,h=o;break;case t.image_compression.MEDIUM:$=6,h=l;break;case t.image_compression.SLOW:$=9,h=u}e=s(e,r,a,h);var p=new Uint8Array(n($)),d=i(e),_=new Deflater($),m=_.append(e),y=_.flush(),g=p.length+m.length+y.length,v=new Uint8Array(g+4);return v.set(p),v.set(m,p.length),v.set(y,p.length+m.length),v[g++]=d>>>24&255,v[g++]=d>>>16&255,v[g++]=d>>>8&255,v[g++]=255&d,t.arrayBufferToBinaryString(v)},n=function(t,e){var r=Math.LOG2E*Math.log(32768)-8<<4|8,n=r<<8;return n|=Math.min(3,(e-1&255)>>1)<<6,n|=0,[r,255&(n+=31-n%31)]},i=function(t,e){for(var r,n=1,i=0,s=t.length,a=0;s>0;){s-=r=s>e?e:s;do{i+=n+=t[a++]}while(--r);n%=65521,i%=65521}return(i<<16|n)>>>0},s=function(t,e,r,n){for(var i,s,a,o=t.length/e,c=new Uint8Array(t.length+o),l=$(),u=0;u<o;u++){if(a=u*e,i=t.subarray(a,a+e),n)c.set(n(i,r,s),a+u);else{for(var f=0,p=l.length,d=[];f<p;f++)d[f]=l[f](i,r,s);var _=h(d.concat());c.set(d[_],a+u)}s=i}return c},a=function(t,e,r){var n=Array.apply([],t);return n.unshift(0),n},o=function(t,e,r){var n,i=[],s=0,a=t.length;for(i[0]=1;s<a;s++)n=t[s-e]||0,i[s+1]=t[s]-n+256&255;return i},c=function(t,e,r){var n,i=[],s=0,a=t.length;for(i[0]=2;s<a;s++)n=r&&r[s]||0,i[s+1]=t[s]-n+256&255;return i},l=function(t,e,r){var n,i,s=[],a=0,o=t.length;for(s[0]=3;a<o;a++)n=t[a-e]||0,i=r&&r[a]||0,s[a+1]=t[a]+256-(n+i>>>1)&255;return s},u=function(t,e,r){var n,i,s,a,o=[],c=0,l=t.length;for(o[0]=4;c<l;c++)n=t[c-e]||0,i=r&&r[c]||0,s=r&&r[c-e]||0,a=f(n,i,s),o[c+1]=t[c]-a+256&255;return o},f=function(t,e,r){var n=t+e-r,i=Math.abs(n-t),s=Math.abs(n-e),a=Math.abs(n-r);return i<=s&&i<=a?t:s<=a?e:r},$=function(){return[a,o,c,l,u]},h=function(t){for(var e,r,n,i=0,s=t.length;i<s;)((e=p(t[i].slice(1)))<r||!r)&&(r=e,n=i),i++;return n},p=function(t){for(var e=0,r=t.length,n=0;e<r;)n+=Math.abs(t[e++]);return n};t.processPNG=function(n,i,s,a,o){var c,l,u,f,$,h,p=this.color_spaces.DEVICE_RGB,d=this.decode.FLATE_DECODE,_=8;if(this.isArrayBuffer(n)&&(n=new Uint8Array(n)),this.isArrayBufferView(n)){if("function"!=typeof PNG||"function"!=typeof w)throw new Error("PNG support requires png.js and zlib.js");if(n=(c=new PNG(n)).imgData,_=c.bits,p=c.colorSpace,f=c.colors,-1!==[4,6].indexOf(c.colorType)){if(8===c.bits)for(var m,y=(C=32==c.pixelBitlength?new Uint32Array(c.decodePixels().buffer):16==c.pixelBitlength?new Uint16Array(c.decodePixels().buffer):new Uint8Array(c.decodePixels().buffer)).length,g=new Uint8Array(y*c.colors),v=new Uint8Array(y),b=c.pixelBitlength-c.bits,A=0,x=0;A<y;A++){for(k=C[A],m=0;m<b;)g[x++]=k>>>m&255,m+=c.bits;v[A]=k>>>m&255}if(16===c.bits){y=(C=new Uint32Array(c.decodePixels().buffer)).length,g=new Uint8Array(y*(32/c.pixelBitlength)*c.colors),v=new Uint8Array(y*(32/c.pixelBitlength));for(var k,E=c.colors>1,S=(A=0,x=0,0);A<y;)k=C[A++],g[x++]=k>>>0&255,E&&(g[x++]=k>>>16&255,k=C[A++],g[x++]=k>>>0&255),v[S++]=k>>>16&255;_=8}a!==t.image_compression.NONE&&e()?(n=r(g,c.width*c.colors,c.colors,a),h=r(v,c.width,1,a)):(n=g,h=v,d=null)}if(3===c.colorType&&(p=this.color_spaces.INDEXED,$=c.palette,c.transparency.indexed)){var N=c.transparency.indexed,I=0;for(A=0,y=N.length;A<y;++A)I+=N[A];if((I/=255)===y-1&&-1!==N.indexOf(0))u=[N.indexOf(0)];else if(I!==y){var C=c.decodePixels();for(v=new Uint8Array(C.length),A=0,y=C.length;A<y;A++)v[A]=N[C[A]];h=r(v,c.width,1)}}var O=function(e){var r;switch(e){case t.image_compression.FAST:r=11;break;case t.image_compression.MEDIUM:r=13;break;case t.image_compression.SLOW:r=14;break;default:r=12}return r}(a);return l=d===this.decode.FLATE_DECODE?"/Predictor "+O+" /Colors "+f+" /BitsPerComponent "+_+" /Columns "+c.width:"/Colors "+f+" /BitsPerComponent "+_+" /Columns "+c.width,(this.isArrayBuffer(n)||this.isArrayBufferView(n))&&(n=this.arrayBufferToBinaryString(n)),(h&&this.isArrayBuffer(h)||this.isArrayBufferView(h))&&(h=this.arrayBufferToBinaryString(h)),this.createImageInfo(n,c.width,c.height,p,_,d,i,s,l,u,$,h,O)}throw new Error("Unsupported PNG image data, try using JPEG instead.")}}(v.API),function(t){t.processGIF89A=function(e,r,n,i,s){var a=new GifReader(e),o=a.width,c=a.height,l=[];a.decodeAndBlitFrameRGBA(0,l);var u={data:l,width:o,height:c},f=new b(100).encode(u,100);return t.processJPEG.call(this,f,r,n,i)},t.processGIF87A=t.processGIF89A}(v.API),function(t){t.processBMP=function(e,r,n,i,s){var a=new A(e,!1),o=a.width,c=a.height,l={data:a.getData(),width:o,height:c},u=new b(100).encode(l,100);return t.processJPEG.call(this,u,r,n,i)}}(v.API),v.API.setLanguage=function(t){return void 0===this.internal.languageSettings&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),void 0!=={af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"FYRO Macedonian",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]&&(this.internal.languageSettings.languageCode=t,!1===this.internal.languageSettings.isSubscribed&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},p=v.API,d=p.getCharWidthsArray=function(t,e){var r,n,i,s=(e=e||{}).font||this.internal.getFont(),a=e.fontSize||this.internal.getFontSize(),o=e.charSpace||this.internal.getCharSpace(),c=e.widths?e.widths:s.metadata.Unicode.widths,l=c.fof?c.fof:1,u=e.kerning?e.kerning:s.metadata.Unicode.kerning,f=u.fof?u.fof:1,$=0,h=c[0]||l,p=[];for(r=0,n=t.length;r<n;r++)i=t.charCodeAt(r),"function"==typeof s.metadata.widthOfString?p.push((s.metadata.widthOfGlyph(s.metadata.characterToGlyph(i))+o*(1e3/a)||0)/1e3):p.push((c[i]||h)/l+(u[i]&&u[i][$]||0)/f),$=i;return p},_=p.getArraySum=function(t){for(var e=t.length,r=0;e;)r+=t[--e];return r},m=p.getStringUnitWidth=function(t,e){var r=(e=e||{}).fontSize||this.internal.getFontSize(),n=e.font||this.internal.getFont(),i=e.charSpace||this.internal.getCharSpace();return"function"==typeof n.metadata.widthOfString?n.metadata.widthOfString(t,r,i)/r:_(d.apply(this,arguments))},y=function(t,e,r,n){for(var i=[],s=0,a=t.length,o=0;s!==a&&o+e[s]<r;)o+=e[s],s++;i.push(t.slice(0,s));var c=s;for(o=0;s!==a;)o+e[s]>n&&(i.push(t.slice(c,s)),o=0,c=s),o+=e[s],s++;return c!==s&&i.push(t.slice(c,s)),i},g=function(t,e,r){r||(r={});var n,i,s,a,o,c,l=[],u=[l],f=r.textIndent||0,$=0,h=0,p=t.split(" "),g=d.apply(this,[" ",r])[0];if(c=-1===r.lineIndent?p[0].length+2:r.lineIndent||0){var v=Array(c).join(" "),b=[];p.map(function(t){(t=t.split(/\s*\n/)).length>1?b=b.concat(t.map(function(t,e){return(e&&t.length?"\n":"")+t})):b.push(t[0])}),p=b,c=m.apply(this,[v,r])}for(s=0,a=p.length;s<a;s++){var A=0;if(n=p[s],c&&"\n"==n[0]&&(n=n.substr(1),A=1),i=d.apply(this,[n,r]),f+$+(h=_(i))>e||A){if(h>e){for(o=y.apply(this,[n,i,e-(f+$),e]),l.push(o.shift()),l=[o.pop()];o.length;)u.push([o.shift()]);h=_(i.slice(n.length-(l[0]?l[0].length:0)))}else l=[n];u.push(l),f=h+c,$=g}else l.push(n),f+=$+h,$=g}if(c)var x=function(t,e){return(e?v:"")+t.join(" ")};else x=function(t){return t.join(" ")};return u.map(x)},p.splitTextToSize=function(t,e,r){var n,i=(r=r||{}).fontSize||this.internal.getFontSize(),s=function(t){var e={0:1},r={};if(t.widths&&t.kerning)return{widths:t.widths,kerning:t.kerning};var n=this.internal.getFont(t.fontName,t.fontStyle);return n.metadata.Unicode?{widths:n.metadata.Unicode.widths||e,kerning:n.metadata.Unicode.kerning||r}:{font:n.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}.call(this,r);n=Array.isArray(t)?t:t.split(/\r?\n/);var a=1*this.internal.scaleFactor*e/i;s.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/i:0,s.lineIndent=r.lineIndent;var o,c,l=[];for(o=0,c=n.length;o<c;o++)l=l.concat(g.apply(this,[n[o],a,s]));return l},function(t){var e=function(t){for(var e={},r=0;r<"klmnopqrstuvwxyz".length;r++)e["klmnopqrstuvwxyz"[r]]="0123456789abcdef"[r];var n,i,s,a,o={},c=1,l=o,u=[],f="",$="",h=t.length-1;for(r=1;r!=h;)a=t[r],r+=1,"'"==a?n?(s=n.join(""),n=void 0):n=[]:n?n.push(a):"{"==a?(u.push([l,s]),l={},s=void 0):"}"==a?((i=u.pop())[0][i[1]]=l,s=void 0,l=i[0]):"-"==a?c=-1:void 0===s?e.hasOwnProperty(a)?(f+=e[a],s=parseInt(f,16)*c,c=1,f=""):f+=a:e.hasOwnProperty(a)?($+=e[a],l[s]=parseInt($,16)*c,c=1,s=void 0,$=""):$+=a;return o},r={codePages:["WinAnsiEncoding"],WinAnsiEncoding:e("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},n={Unicode:{Courier:r,"Courier-Bold":r,"Courier-BoldOblique":r,"Courier-Oblique":r,Helvetica:r,"Helvetica-Bold":r,"Helvetica-BoldOblique":r,"Helvetica-Oblique":r,"Times-Roman":r,"Times-Bold":r,"Times-BoldItalic":r,"Times-Italic":r}},i={Unicode:{"Courier-Oblique":e("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":e("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":e("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:e("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":e("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":e("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:e("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:e("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":e("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:e("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":e("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":e("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":e("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":e("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(t){var e,r,s,a=t.font;(e=i.Unicode[a.postScriptName])&&((r=a.metadata.Unicode?a.metadata.Unicode:a.metadata.Unicode={}).widths=e.widths,r.kerning=e.kerning),(s=n.Unicode[a.postScriptName])&&((r=a.metadata.Unicode?a.metadata.Unicode:a.metadata.Unicode={}).encoding=s,s.codePages&&s.codePages.length&&(a.encoding=s.codePages[0]))}])}(v.API),function(t,e){t.API.events.push(["addFont",function(e){var r=e.font,n=e.instance;if(void 0!==n&&n.existsFileInVFS(r.postScriptName))r.metadata=t.API.TTFFont.open(r.postScriptName,r.fontName,n.getFileFromVFS(r.postScriptName),r.encoding),r.metadata.Unicode=r.metadata.Unicode||{encoding:{},kerning:{},widths:[]},r.metadata.glyIdsUsed=[0];else if(!1===r.isStandardFont)throw new Error("Font does not exist in FileInVFS, import fonts or remove declaration doc.addFont('"+r.postScriptName+"').")}])}(v,"undefined"!=typeof self&&self||"undefined"!=typeof global&&global||"undefined"!=typeof window&&window||Function("return this")()),function(t){t.addSvg=function(t,e,r,n,i){if(void 0===e||void 0===r)throw new Error("addSVG needs values for 'x' and 'y'");function s(t){for(var e=parseFloat(t[1]),r=parseFloat(t[2]),n=[],i=3,s=t.length;i<s;)"c"===t[i]?(n.push([parseFloat(t[i+1]),parseFloat(t[i+2]),parseFloat(t[i+3]),parseFloat(t[i+4]),parseFloat(t[i+5]),parseFloat(t[i+6])]),i+=7):"l"===t[i]?(n.push([parseFloat(t[i+1]),parseFloat(t[i+2])]),i+=3):i+=1;return[e,r,n]}var a=function(t,e){var r=(e.contentWindow||e.contentDocument).document;return r.write(t),r.close(),r.getElementsByTagName("svg")[0]}(t,function(t){var e=t.createElement("iframe");return function(t,e){var r=e.createElement("style");r.type="text/css",r.styleSheet?r.styleSheet.cssText=t:r.appendChild(e.createTextNode(t)),e.getElementsByTagName("head")[0].appendChild(r)}(".jsPDF_sillysvg_iframe {display:none;position:absolute;}",t),e.name="childframe",e.setAttribute("width",0),e.setAttribute("height",0),e.setAttribute("frameborder","0"),e.setAttribute("scrolling","no"),e.setAttribute("seamless","seamless"),e.setAttribute("class","jsPDF_sillysvg_iframe"),t.body.appendChild(e),e}(document)),o=[1,1],c=parseFloat(a.getAttribute("width")),l=parseFloat(a.getAttribute("height"));c&&l&&(n&&i?o=[n/c,i/l]:n?o=[n/c,n/c]:i&&(o=[i/l,i/l]));var u,f,$,h,p=a.childNodes;for(u=0,f=p.length;u<f;u++)($=p[u]).tagName&&"PATH"===$.tagName.toUpperCase()&&((h=s($.getAttribute("d").split(" ")))[0]=h[0]*o[0]+e,h[1]=h[1]*o[1]+r,this.lines.call(this,h[2],h[0],h[1],o));return this},t.addSVG=t.addSvg,t.addSvgAsImage=function(t,e,r,n,i,s,a,o){if(isNaN(e)||isNaN(r))throw console.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(i))throw console.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=n,c.height=i;var l=c.getContext("2d");return l.fillStyle="#fff",l.fillRect(0,0,c.width,c.height),canvg(c,t,{ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0}),this.addImage(c.toDataURL("image/jpeg",1),e,r,n,i,a,o),this}}(v.API),v.API.putTotalPages=function(t){var e,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),r=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var i=0;i<this.internal.pages[n].length;i++)this.internal.pages[n][i]=this.internal.pages[n][i].replace(e,r);return this},v.API.viewerPreferences=function(t,e){var r;t=t||{},e=e||!1;var i,s,a={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(a),c=[],l=0,u=0,f=0,$=!0;function h(t,e){var r,n=!1;for(r=0;r<t.length;r+=1)t[r]===e&&(n=!0);return n}if(void 0===this.internal.viewerpreferences&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(a)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,"reset"===t||!0===e){var p=o.length;for(f=0;f<p;f+=1)r[o[f]].value=r[o[f]].defaultValue,r[o[f]].explicitSet=!1}if("object"===n(t))for(i in t)if(s=t[i],h(o,i)&&void 0!==s){if("boolean"===r[i].type&&"boolean"==typeof s)r[i].value=s;else if("name"===r[i].type&&h(r[i].valueSet,s))r[i].value=s;else if("integer"===r[i].type&&Number.isInteger(s))r[i].value=s;else if("array"===r[i].type){for(l=0;l<s.length;l+=1)if($=!0,1===s[l].length&&"number"==typeof s[l][0])c.push(String(s[l]-1));else if(s[l].length>1){for(u=0;u<s[l].length;u+=1)"number"!=typeof s[l][u]&&($=!1);!0===$&&c.push([s[l][0]-1,s[l][1]-1].join(" "))}r[i].value="["+c.join(" ")+"]"}else r[i].value=r[i].defaultValue;r[i].explicitSet=!0}return!1===this.internal.viewerpreferences.isSubscribed&&(this.internal.events.subscribe("putCatalog",function(){var t,e=[];for(t in r)!0===r[t].explicitSet&&("name"===r[t].type?e.push("/"+t+" /"+r[t].value):e.push("/"+t+" "+r[t].value));0!==e.length&&this.internal.write("/ViewerPreferences\n<<\n"+e.join("\n")+"\n>>")}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(t){var e="",r="",n="";t.addMetadata=function(t,i){return r=i||"http://jspdf.default.namespaceuri/",e=t,this.internal.events.subscribe("postPutResources",function(){if(e){var t='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+r+'"><jspdf:metadata>',i=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),s=unescape(encodeURIComponent(t)),a=unescape(encodeURIComponent(e)),o=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),l=s.length+a.length+o.length+i.length+c.length;n=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+l+" >>"),this.internal.write("stream"),this.internal.write(i+s+a+o+c),this.internal.write("endstream"),this.internal.write("endobj")}else n=""}),this.internal.events.subscribe("putCatalog",function(){n&&this.internal.write("/Metadata "+n+" 0 R")}),this}}(v.API),function(t,e){var r=t.API;var n=r.pdfEscape16=function(t,e){for(var r,n=e.metadata.Unicode.widths,i=["","0","00","000","0000"],s=[""],a=0,o=t.length;a<o;++a){if(r=e.metadata.characterToGlyph(t.charCodeAt(a)),e.metadata.glyIdsUsed.push(r),e.metadata.toUnicode[r]=t.charCodeAt(a),-1==n.indexOf(r)&&(n.push(r),n.push([parseInt(e.metadata.widthOfGlyph(r),10)])),"0"==r)return s.join("");r=r.toString(16),s.push(i[4-r.length],r)}return s.join("")},i=function(t){var e,r,n,i,s,a,o;for(s="/CIDInit /ProcSet findresource begin\n12 dict begin\nbegincmap\n/CIDSystemInfo <<\n  /Registry (Adobe)\n  /Ordering (UCS)\n  /Supplement 0\n>> def\n/CMapName /Adobe-Identity-UCS def\n/CMapType 2 def\n1 begincodespacerange\n<0000><ffff>\nendcodespacerange",n=[],a=0,o=(r=Object.keys(t).sort(function(t,e){return t-e})).length;a<o;a++)e=r[a],n.length>=100&&(s+="\n"+n.length+" beginbfchar\n"+n.join("\n")+"\nendbfchar",n=[]),i=("0000"+t[e].toString(16)).slice(-4),e=("0000"+(+e).toString(16)).slice(-4),n.push("<"+e+"><"+i+">");return n.length&&(s+="\n"+n.length+" beginbfchar\n"+n.join("\n")+"\nendbfchar\n"),s+="endcmap\nCMapName currentdict /CMap defineresource pop\nend\nend"};r.events.push(["putFont",function(e){!function(e,r,n,s){if(e.metadata instanceof t.API.TTFFont&&"Identity-H"===e.encoding){for(var a=e.metadata.Unicode.widths,o=e.metadata.subset.encode(e.metadata.glyIdsUsed,1),c="",l=0;l<o.length;l++)c+=String.fromCharCode(o[l]);var u=n();s({data:c,addLength1:!0}),r("endobj");var f=n();s({data:i(e.metadata.toUnicode),addLength1:!0}),r("endobj");var $=n();r("<<"),r("/Type /FontDescriptor"),r("/FontName /"+e.fontName),r("/FontFile2 "+u+" 0 R"),r("/FontBBox "+t.API.PDFObject.convert(e.metadata.bbox)),r("/Flags "+e.metadata.flags),r("/StemV "+e.metadata.stemV),r("/ItalicAngle "+e.metadata.italicAngle),r("/Ascent "+e.metadata.ascender),r("/Descent "+e.metadata.decender),r("/CapHeight "+e.metadata.capHeight),r(">>"),r("endobj");var h=n();r("<<"),r("/Type /Font"),r("/BaseFont /"+e.fontName),r("/FontDescriptor "+$+" 0 R"),r("/W "+t.API.PDFObject.convert(a)),r("/CIDToGIDMap /Identity"),r("/DW 1000"),r("/Subtype /CIDFontType2"),r("/CIDSystemInfo"),r("<<"),r("/Supplement 0"),r("/Registry (Adobe)"),r("/Ordering ("+e.encoding+")"),r(">>"),r(">>"),r("endobj"),e.objectNumber=n(),r("<<"),r("/Type /Font"),r("/Subtype /Type0"),r("/ToUnicode "+f+" 0 R"),r("/BaseFont /"+e.fontName),r("/Encoding /"+e.encoding),r("/DescendantFonts ["+h+" 0 R]"),r(">>"),r("endobj"),e.isAlreadyPutted=!0}}(e.font,e.out,e.newObject,e.putStream)}]);r.events.push(["putFont",function(e){!function(e,r,n,s){if(e.metadata instanceof t.API.TTFFont&&"WinAnsiEncoding"===e.encoding){e.metadata.Unicode.widths;for(var a=e.metadata.rawData,o="",c=0;c<a.length;c++)o+=String.fromCharCode(a[c]);var l=n();s({data:o,addLength1:!0}),r("endobj");var u=n();s({data:i(e.metadata.toUnicode),addLength1:!0}),r("endobj");var f=n();for(r("<<"),r("/Descent "+e.metadata.decender),r("/CapHeight "+e.metadata.capHeight),r("/StemV "+e.metadata.stemV),r("/Type /FontDescriptor"),r("/FontFile2 "+l+" 0 R"),r("/Flags 96"),r("/FontBBox "+t.API.PDFObject.convert(e.metadata.bbox)),r("/FontName /"+e.fontName),r("/ItalicAngle "+e.metadata.italicAngle),r("/Ascent "+e.metadata.ascender),r(">>"),r("endobj"),e.objectNumber=n(),c=0;c<e.metadata.hmtx.widths.length;c++)e.metadata.hmtx.widths[c]=parseInt(e.metadata.hmtx.widths[c]*(1e3/e.metadata.head.unitsPerEm));r("<</Subtype/TrueType/Type/Font/ToUnicode "+u+" 0 R/BaseFont/"+e.fontName+"/FontDescriptor "+f+" 0 R/Encoding/"+e.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(e.metadata.hmtx.widths)+">>"),r("endobj"),e.isAlreadyPutted=!0}}(e.font,e.out,e.newObject,e.putStream)}]);var s=function(t){var e,r,i=t.text||"",s=t.x,a=t.y,o=t.options||{},c=t.mutex||{},l=c.pdfEscape,u=c.activeFontKey,f=c.fonts,$=(c.activeFontSize,""),h=0,p="",d=f[r=u].encoding;if("Identity-H"!==f[r].encoding)return{text:i,x:s,y:a,options:o,mutex:c};for(p=i,r=u,"[object Array]"===Object.prototype.toString.call(i)&&(p=i[0]),h=0;h<p.length;h+=1)f[r].metadata.hasOwnProperty("cmap")&&(e=f[r].metadata.cmap.unicode.codeMap[p[h].charCodeAt(0)]),e?$+=p[h]:p[h].charCodeAt(0)<256&&f[r].metadata.hasOwnProperty("Unicode")?$+=p[h]:$+="";var _="";return parseInt(r.slice(1))<14||"WinAnsiEncoding"===d?_=function(t){for(var e="",r=0;r<t.length;r++)e+=""+t.charCodeAt(r).toString(16);return e}(l($,r)):"Identity-H"===d&&(_=n($,f[r])),c.isHex=!0,{text:_,x:s,y:a,options:o,mutex:c}};r.events.push(["postProcessText",function(t){var e=t.text||"",r=t.x,n=t.y,i=t.options,a=t.mutex,o=(i.lang,[]),c={text:e,x:r,y:n,options:i,mutex:a};if("[object Array]"===Object.prototype.toString.call(e)){var l=0;for(l=0;l<e.length;l+=1)"[object Array]"===Object.prototype.toString.call(e[l])&&3===e[l].length?o.push([s(Object.assign({},c,{text:e[l][0]})).text,e[l][1],e[l][2]]):o.push(s(Object.assign({},c,{text:e[l]})).text);t.text=o}else t.text=s(Object.assign({},c,{text:e})).text}])}(v,"undefined"!=typeof self&&self||"undefined"!=typeof global&&global||"undefined"!=typeof window&&window||Function("return this")()),function(t){var e=function(t){return void 0!==t&&(void 0===t.vFS&&(t.vFS={}),!0)};t.existsFileInVFS=function(t){return!!e(this.internal)&&void 0!==this.internal.vFS[t]},t.addFileToVFS=function(t,r){return e(this.internal),this.internal.vFS[t]=r,this},t.getFileFromVFS=function(t){return e(this.internal),void 0!==this.internal.vFS[t]?this.internal.vFS[t]:null}}(v.API),function(t,e){t.API.adler32cs=function(){var t="function"==typeof ArrayBuffer&&"function"==typeof Uint8Array,e=t?function(t){return t instanceof ArrayBuffer||!1}:function(){return!1},r=function(t){return unescape(encodeURIComponent(t))},n=function(t,e){for(var r=65535&t,n=t>>>16,i=0,s=e.length;i<s;i++)r=(r+(255&e.charCodeAt(i)))%65521,n=(n+r)%65521;return(n<<16|r)>>>0},i=function(t,e){for(var r=65535&t,n=t>>>16,i=0,s=e.length;i<s;i++)r=(r+e[i])%65521,n=(n+r)%65521;return(n<<16|r)>>>0},s={},a=s.Adler32=(u=function(t){if(!(this instanceof u))throw new TypeError("Constructor cannot called be as a function.");if(!isFinite(t=null==t?1:+t))throw new Error("First arguments needs to be a finite number.");this.checksum=t>>>0},f=u.prototype={},f.constructor=u,u.from=((o=function(t){if(!(this instanceof u))throw new TypeError("Constructor cannot called be as a function.");if(null==t)throw new Error("First argument needs to be a string.");this.checksum=n(1,t.toString())}).prototype=f,o),u.fromUtf8=((c=function(t){if(!(this instanceof u))throw new TypeError("Constructor cannot called be as a function.");if(null==t)throw new Error("First argument needs to be a string.");var e=r(t.toString());this.checksum=n(1,e)}).prototype=f,c),t&&(u.fromBuffer=((l=function(t){if(!(this instanceof u))throw new TypeError("Constructor cannot called be as a function.");if(!e(t))throw new Error("First argument needs to be ArrayBuffer.");var r=new Uint8Array(t);return this.checksum=i(1,r)}).prototype=f,l)),f.update=function(t){if(null==t)throw new Error("First argument needs to be a string.");return t=t.toString(),this.checksum=n(this.checksum,t)},f.updateUtf8=function(t){if(null==t)throw new Error("First argument needs to be a string.");var e=r(t.toString());return this.checksum=n(this.checksum,e)},t&&(f.updateBuffer=function(t){if(!e(t))throw new Error("First argument needs to be ArrayBuffer.");var r=new Uint8Array(t);return this.checksum=i(this.checksum,r)}),f.clone=function(){return new a(this.checksum)},u);var o,c,l,u,f;s.from=function(t){if(null==t)throw new Error("First argument needs to be a string.");return n(1,t.toString())},s.fromUtf8=function(t){if(null==t)throw new Error("First argument needs to be a string.");var e=r(t.toString());return n(1,e)},t&&(s.fromBuffer=function(t){if(!e(t))throw new Error("First argument need to be ArrayBuffer.");var r=new Uint8Array(t);return i(1,r)});return s}()}(v),function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(t){var r,n,i,s,a,o,c,l=e,u=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],f=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],$={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},h={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},p=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],d=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),_=!1,m=0;this.__bidiEngine__={};var y=function(t){var e=t.charCodeAt(),r=e>>8,n=h[r];return void 0!==n?l[256*n+(255&e)]:252===r||253===r?"AL":d.test(r)?"L":8===r?"R":"N"},g=function(t){for(var e,r=0;r<t.length;r++){if("L"===(e=y(t.charAt(r))))return!1;if("R"===e)return!0}return!1},v=function(t,e,a,o){var c,l,u,f,$=e[o];switch($){case"L":case"R":_=!1;break;case"N":case"AN":break;case"EN":_&&($="AN");break;case"AL":_=!0,$="R";break;case"WS":$="N";break;case"CS":o<1||o+1>=e.length||"EN"!==(c=a[o-1])&&"AN"!==c||"EN"!==(l=e[o+1])&&"AN"!==l?$="N":_&&(l="AN"),$=l===c?l:"N";break;case"ES":$="EN"===(c=o>0?a[o-1]:"B")&&o+1<e.length&&"EN"===e[o+1]?"EN":"N";break;case"ET":if(o>0&&"EN"===a[o-1]){$="EN";break}if(_){$="N";break}for(u=o+1,f=e.length;u<f&&"ET"===e[u];)u++;$=u<f&&"EN"===e[u]?"EN":"N";break;case"NSM":if(i&&!s){for(f=e.length,u=o+1;u<f&&"NSM"===e[u];)u++;if(u<f){var h=t[o],p=h>=1425&&h<=2303||64286===h;if(c=e[u],p&&("R"===c||"AL"===c)){$="R";break}}}$=o<1||"B"===(c=e[o-1])?"N":a[o-1];break;case"B":_=!1,r=!0,$=m;break;case"S":n=!0,$="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":_=!1;break;case"BN":$="N"}return $},b=function(t,e,r){var n=t.split("");return r&&A(n,r,{hiLevel:m}),n.reverse(),e&&e.reverse(),n.join("")},A=function(t,e,i){var s,a,o,c,l,h=-1,p=t.length,d=0,g=[],b=m?f:u,A=[];for(_=!1,r=!1,n=!1,a=0;a<p;a++)A[a]=y(t[a]);for(o=0;o<p;o++){if(l=d,g[o]=v(t,A,g,o),s=240&(d=b[l][$[g[o]]]),d&=15,e[o]=c=b[d][5],s>0)if(16===s){for(a=h;a<o;a++)e[a]=1;h=-1}else h=-1;if(b[d][6])-1===h&&(h=o);else if(h>-1){for(a=h;a<o;a++)e[a]=c;h=-1}"B"===A[o]&&(e[o]=0),i.hiLevel|=c}n&&function(t,e,r){for(var n=0;n<r;n++)if("S"===t[n]){e[n]=m;for(var i=n-1;i>=0&&"WS"===t[i];i--)e[i]=m}}(A,e,p)},x=function(t,e,n,i,s){if(!(s.hiLevel<t)){if(1===t&&1===m&&!r)return e.reverse(),void(n&&n.reverse());for(var a,o,c,l,u=e.length,f=0;f<u;){if(i[f]>=t){for(c=f+1;c<u&&i[c]>=t;)c++;for(l=f,o=c-1;l<o;l++,o--)a=e[l],e[l]=e[o],e[o]=a,n&&(a=n[l],n[l]=n[o],n[o]=a);f=c}f++}}},w=function(t,e,r){var n=t.split(""),i={hiLevel:m};return r||(r=[]),A(n,r,i),function(t,e,r){if(0!==r.hiLevel&&c)for(var n,i=0;i<t.length;i++)1===e[i]&&(n=p.indexOf(t[i]))>=0&&(t[i]=p[n+1])}(n,r,i),x(2,n,e,r,i),x(1,n,e,r,i),n.join("")};return this.__bidiEngine__.doBidiReorder=function(t,e,r){if(function(t,e){if(e)for(var r=0;r<t.length;r++)e[r]=r;void 0===s&&(s=g(t)),void 0===o&&(o=g(t))}(t,e),i||!a||o)if(i&&a&&s^o)m=s?1:0,t=b(t,e,r);else if(!i&&a&&o)m=s?1:0,t=w(t,e,r),t=b(t,e);else if(!i||s||a||o){if(i&&!a&&s^o)t=b(t,e),s?(m=0,t=w(t,e,r)):(m=1,t=w(t,e,r),t=b(t,e));else if(i&&s&&!a&&o)m=1,t=w(t,e,r),t=b(t,e);else if(!i&&!a&&s^o){var n=c;s?(m=1,t=w(t,e,r),m=0,c=!1,t=w(t,e,r),c=n):(m=0,t=w(t,e,r),t=b(t,e),m=1,c=!1,t=w(t,e,r),c=n,t=b(t,e))}}else m=0,t=w(t,e,r);else m=s?1:0,t=w(t,e,r);return t},this.__bidiEngine__.setOptions=function(t){t&&(i=t.isInputVisual,a=t.isOutputVisual,s=t.isInputRtl,o=t.isOutputRtl,c=t.isSymmetricSwapping)},this.__bidiEngine__.setOptions(t),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(t){var e=t.text,n=(t.x,t.y,t.options||{}),i=(t.mutex,n.lang,[]);if("[object Array]"===Object.prototype.toString.call(e)){var s=0;for(i=[],s=0;s<e.length;s+=1)"[object Array]"===Object.prototype.toString.call(e[s])?i.push([r.doBidiReorder(e[s][0]),e[s][1],e[s][2]]):i.push([r.doBidiReorder(e[s])]);t.text=i}else t.text=r.doBidiReorder(e)}])}(v);try{e.exports=b}catch(t){}function A(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,-1===["BM","BA","CI","CP","IC","PT"].indexOf(this.flag))throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}A.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,16===this.bitPP&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=0===this.colors?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:i,green:n,blue:r,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},A.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(t){console.log("bit decode error:"+t)}},A.prototype.bit1=function(){var t=Math.ceil(this.width/8),e=t%4,r=this.height>=0?this.height-1:-this.height;for(r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<t;i++)for(var s=this.datav.getUint8(this.pos++,!0),a=n*this.width*4+8*i*4,o=0;o<8&&8*i+o<this.width;o++){var c=this.palette[s>>7-o&1];this.data[a+4*o]=c.blue,this.data[a+4*o+1]=c.green,this.data[a+4*o+2]=c.red,this.data[a+4*o+3]=255}0!=e&&(this.pos+=4-e)}},A.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<t;i++){var s=this.datav.getUint8(this.pos++,!0),a=n*this.width*4+2*i*4,o=s>>4,c=15&s,l=this.palette[o];if(this.data[a]=l.blue,this.data[a+1]=l.green,this.data[a+2]=l.red,this.data[a+3]=255,2*i+1>=this.width)break;l=this.palette[c],this.data[a+4]=l.blue,this.data[a+4+1]=l.green,this.data[a+4+2]=l.red,this.data[a+4+3]=255}0!=e&&(this.pos+=4-e)}},A.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var i=this.datav.getUint8(this.pos++,!0),s=r*this.width*4+4*n;if(i<this.palette.length){var a=this.palette[i];this.data[s]=a.red,this.data[s+1]=a.green,this.data[s+2]=a.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}0!=t&&(this.pos+=4-t)}},A.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<this.width;i++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var a=(s&e)/e*255|0,o=(s>>5&e)/e*255|0,c=(s>>10&e)/e*255|0,l=s>>15?255:0,u=n*this.width*4+4*i;this.data[u]=c,this.data[u+1]=o,this.data[u+2]=a,this.data[u+3]=l}this.pos+=t}},A.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,s=0;s<this.width;s++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(a&e)/e*255|0,c=(a>>5&r)/r*255|0,l=(a>>11)/e*255|0,u=i*this.width*4+4*s;this.data[u]=l,this.data[u+1]=c,this.data[u+2]=o,this.data[u+3]=255}this.pos+=t}},A.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=e*this.width*4+4*r;this.data[a]=s,this.data[a+1]=i,this.data[a+2]=n,this.data[a+3]=255}this.pos+=this.width%4}},A.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*r;this.data[o]=s,this.data[o+1]=i,this.data[o+2]=n,this.data[o+3]=a}},A.prototype.getData=function(){return this.data};try{e.exports=function(t){var e=new A(t);return{data:e.getData(),width:e.width,height:e.height}}}catch(t){}window.tmp=A,function(t){var e=15,r=30,n=19,i=256,s=i+1+29,a=2*s+1,o=256,c=16,l=17,u=18,f=16,$=-1,h=1,p=2,d=0,_=0,m=1,y=3,g=4,v=0,b=1,A=2,x=-2,w=-3,k=-5,E=[0,1,2,3,4,4,5,5,6,6,6,6,7,7,7,7,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,0,0,16,17,18,18,19,19,20,20,20,20,21,21,21,21,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29];function S(){var t=this;function r(t,e){var r=0;do{r|=1&t,t>>>=1,r<<=1}while(--e>0);return r>>>1}t.build_tree=function(n){var i,s,o,c=t.dyn_tree,l=t.stat_desc.static_tree,u=t.stat_desc.elems,f=-1;for(n.heap_len=0,n.heap_max=a,i=0;i<u;i++)0!==c[2*i]?(n.heap[++n.heap_len]=f=i,n.depth[i]=0):c[2*i+1]=0;for(;n.heap_len<2;)c[2*(o=n.heap[++n.heap_len]=f<2?++f:0)]=1,n.depth[o]=0,n.opt_len--,l&&(n.static_len-=l[2*o+1]);for(t.max_code=f,i=Math.floor(n.heap_len/2);i>=1;i--)n.pqdownheap(c,i);o=u;do{i=n.heap[1],n.heap[1]=n.heap[n.heap_len--],n.pqdownheap(c,1),s=n.heap[1],n.heap[--n.heap_max]=i,n.heap[--n.heap_max]=s,c[2*o]=c[2*i]+c[2*s],n.depth[o]=Math.max(n.depth[i],n.depth[s])+1,c[2*i+1]=c[2*s+1]=o,n.heap[1]=o++,n.pqdownheap(c,1)}while(n.heap_len>=2);n.heap[--n.heap_max]=n.heap[1],function(r){var n,i,s,o,c,l,u=t.dyn_tree,f=t.stat_desc.static_tree,$=t.stat_desc.extra_bits,h=t.stat_desc.extra_base,p=t.stat_desc.max_length,d=0;for(o=0;o<=e;o++)r.bl_count[o]=0;for(u[2*r.heap[r.heap_max]+1]=0,n=r.heap_max+1;n<a;n++)(o=u[2*u[2*(i=r.heap[n])+1]+1]+1)>p&&(o=p,d++),u[2*i+1]=o,i>t.max_code||(r.bl_count[o]++,c=0,i>=h&&(c=$[i-h]),l=u[2*i],r.opt_len+=l*(o+c),f&&(r.static_len+=l*(f[2*i+1]+c)));if(0!==d){do{for(o=p-1;0===r.bl_count[o];)o--;r.bl_count[o]--,r.bl_count[o+1]+=2,r.bl_count[p]--,d-=2}while(d>0);for(o=p;0!==o;o--)for(i=r.bl_count[o];0!==i;)(s=r.heap[--n])>t.max_code||(u[2*s+1]!=o&&(r.opt_len+=(o-u[2*s+1])*u[2*s],u[2*s+1]=o),i--)}}(n),function(t,n,i){var s,a,o,c=[],l=0;for(s=1;s<=e;s++)c[s]=l=l+i[s-1]<<1;for(a=0;a<=n;a++)0!==(o=t[2*a+1])&&(t[2*a]=r(c[o]++,o))}(c,t.max_code,n.bl_count)}}function N(t,e,r,n,i){this.static_tree=t,this.extra_bits=e,this.extra_base=r,this.elems=n,this.max_length=i}S._length_code=[0,1,2,3,4,5,6,7,8,8,9,9,10,10,11,11,12,12,12,12,13,13,13,13,14,14,14,14,15,15,15,15,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,28],S.base_length=[0,1,2,3,4,5,6,7,8,10,12,14,16,20,24,28,32,40,48,56,64,80,96,112,128,160,192,224,0],S.base_dist=[0,1,2,3,4,6,8,12,16,24,32,48,64,96,128,192,256,384,512,768,1024,1536,2048,3072,4096,6144,8192,12288,16384,24576],S.d_code=function(t){return t<256?E[t]:E[256+(t>>>7)]},S.extra_lbits=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],S.extra_dbits=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],S.extra_blbits=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],S.bl_order=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],N.static_ltree=[12,8,140,8,76,8,204,8,44,8,172,8,108,8,236,8,28,8,156,8,92,8,220,8,60,8,188,8,124,8,252,8,2,8,130,8,66,8,194,8,34,8,162,8,98,8,226,8,18,8,146,8,82,8,210,8,50,8,178,8,114,8,242,8,10,8,138,8,74,8,202,8,42,8,170,8,106,8,234,8,26,8,154,8,90,8,218,8,58,8,186,8,122,8,250,8,6,8,134,8,70,8,198,8,38,8,166,8,102,8,230,8,22,8,150,8,86,8,214,8,54,8,182,8,118,8,246,8,14,8,142,8,78,8,206,8,46,8,174,8,110,8,238,8,30,8,158,8,94,8,222,8,62,8,190,8,126,8,254,8,1,8,129,8,65,8,193,8,33,8,161,8,97,8,225,8,17,8,145,8,81,8,209,8,49,8,177,8,113,8,241,8,9,8,137,8,73,8,201,8,41,8,169,8,105,8,233,8,25,8,153,8,89,8,217,8,57,8,185,8,121,8,249,8,5,8,133,8,69,8,197,8,37,8,165,8,101,8,229,8,21,8,149,8,85,8,213,8,53,8,181,8,117,8,245,8,13,8,141,8,77,8,205,8,45,8,173,8,109,8,237,8,29,8,157,8,93,8,221,8,61,8,189,8,125,8,253,8,19,9,275,9,147,9,403,9,83,9,339,9,211,9,467,9,51,9,307,9,179,9,435,9,115,9,371,9,243,9,499,9,11,9,267,9,139,9,395,9,75,9,331,9,203,9,459,9,43,9,299,9,171,9,427,9,107,9,363,9,235,9,491,9,27,9,283,9,155,9,411,9,91,9,347,9,219,9,475,9,59,9,315,9,187,9,443,9,123,9,379,9,251,9,507,9,7,9,263,9,135,9,391,9,71,9,327,9,199,9,455,9,39,9,295,9,167,9,423,9,103,9,359,9,231,9,487,9,23,9,279,9,151,9,407,9,87,9,343,9,215,9,471,9,55,9,311,9,183,9,439,9,119,9,375,9,247,9,503,9,15,9,271,9,143,9,399,9,79,9,335,9,207,9,463,9,47,9,303,9,175,9,431,9,111,9,367,9,239,9,495,9,31,9,287,9,159,9,415,9,95,9,351,9,223,9,479,9,63,9,319,9,191,9,447,9,127,9,383,9,255,9,511,9,0,7,64,7,32,7,96,7,16,7,80,7,48,7,112,7,8,7,72,7,40,7,104,7,24,7,88,7,56,7,120,7,4,7,68,7,36,7,100,7,20,7,84,7,52,7,116,7,3,8,131,8,67,8,195,8,35,8,163,8,99,8,227,8],N.static_dtree=[0,5,16,5,8,5,24,5,4,5,20,5,12,5,28,5,2,5,18,5,10,5,26,5,6,5,22,5,14,5,30,5,1,5,17,5,9,5,25,5,5,5,21,5,13,5,29,5,3,5,19,5,11,5,27,5,7,5,23,5],N.static_l_desc=new N(N.static_ltree,S.extra_lbits,i+1,s,e),N.static_d_desc=new N(N.static_dtree,S.extra_dbits,0,r,e),N.static_bl_desc=new N(null,S.extra_blbits,0,n,7);var I=9,C=8;function O(t,e,r,n,i){this.good_length=t,this.max_lazy=e,this.nice_length=r,this.max_chain=n,this.func=i}var B=0,M=1,P=2,F=[new O(0,0,0,0,B),new O(4,4,8,4,M),new O(4,5,16,8,M),new O(4,6,32,32,M),new O(4,4,16,16,P),new O(8,16,32,32,P),new O(8,16,128,128,P),new O(8,32,128,256,P),new O(32,128,258,1024,P),new O(32,258,258,4096,P)],L=["need dictionary","stream end","","","stream error","data error","","buffer error","",""],T=0,j=1,R=2,D=3,z=32,U=42,q=113,H=666,Q=8,Y=0,G=1,V=2,J=3,X=258,W=X+J+1;function K(t,e,r,n){var i=t[2*e],s=t[2*r];return i<s||i==s&&n[e]<=n[r]}function Z(){var t,e,a,E,O,Z,tt,et,rt,nt,it,st,at,ot,ct,lt,ut,ft,$t,ht,pt,dt,_t,mt,yt,gt,vt,bt,At,xt,wt,kt,Et,St,Nt,It,Ct,Ot,Bt,Mt,Pt,Ft=this,Lt=new S,Tt=new S,jt=new S;function Rt(){var t;for(t=0;t<s;t++)wt[2*t]=0;for(t=0;t<r;t++)kt[2*t]=0;for(t=0;t<n;t++)Et[2*t]=0;wt[2*o]=1,Ft.opt_len=Ft.static_len=0,It=Ot=0}function Dt(t,e){var r,n,i=-1,s=t[1],a=0,o=7,f=4;for(0===s&&(o=138,f=3),t[2*(e+1)+1]=65535,r=0;r<=e;r++)n=s,s=t[2*(r+1)+1],++a<o&&n==s||(a<f?Et[2*n]+=a:0!==n?(n!=i&&Et[2*n]++,Et[2*c]++):a<=10?Et[2*l]++:Et[2*u]++,a=0,i=n,0===s?(o=138,f=3):n==s?(o=6,f=3):(o=7,f=4))}function zt(t){Ft.pending_buf[Ft.pending++]=t}function Ut(t){zt(255&t),zt(t>>>8&255)}function qt(t,e){var r,n=e;Pt>f-n?(Ut(Mt|=(r=t)<<Pt&65535),Mt=r>>>f-Pt,Pt+=n-f):(Mt|=t<<Pt&65535,Pt+=n)}function Ht(t,e){var r=2*t;qt(65535&e[r],65535&e[r+1])}function Qt(t,e){var r,n,i=-1,s=t[1],a=0,o=7,f=4;for(0===s&&(o=138,f=3),r=0;r<=e;r++)if(n=s,s=t[2*(r+1)+1],!(++a<o&&n==s)){if(a<f)do{Ht(n,Et)}while(0!=--a);else 0!==n?(n!=i&&(Ht(n,Et),a--),Ht(c,Et),qt(a-3,2)):a<=10?(Ht(l,Et),qt(a-3,3)):(Ht(u,Et),qt(a-11,7));a=0,i=n,0===s?(o=138,f=3):n==s?(o=6,f=3):(o=7,f=4)}}function Yt(){16==Pt?(Ut(Mt),Mt=0,Pt=0):Pt>=8&&(zt(255&Mt),Mt>>>=8,Pt-=8)}function Gt(t,e){var n,s,a;if(Ft.pending_buf[Ct+2*It]=t>>>8&255,Ft.pending_buf[Ct+2*It+1]=255&t,Ft.pending_buf[St+It]=255&e,It++,0===t?wt[2*e]++:(Ot++,t--,wt[2*(S._length_code[e]+i+1)]++,kt[2*S.d_code(t)]++),0==(8191&It)&&vt>2){for(n=8*It,s=pt-ut,a=0;a<r;a++)n+=kt[2*a]*(5+S.extra_dbits[a]);if(n>>>=3,Ot<Math.floor(It/2)&&n<Math.floor(s/2))return!0}return It==Nt-1}function Vt(t,e){var r,n,s,a,c=0;if(0!==It)do{r=Ft.pending_buf[Ct+2*c]<<8&65280|255&Ft.pending_buf[Ct+2*c+1],n=255&Ft.pending_buf[St+c],c++,0===r?Ht(n,t):(Ht((s=S._length_code[n])+i+1,t),0!==(a=S.extra_lbits[s])&&qt(n-=S.base_length[s],a),r--,Ht(s=S.d_code(r),e),0!==(a=S.extra_dbits[s])&&qt(r-=S.base_dist[s],a))}while(c<It);Ht(o,t),Bt=t[2*o+1]}function Jt(){Pt>8?Ut(Mt):Pt>0&&zt(255&Mt),Mt=0,Pt=0}function Xt(t,e,r){qt((Y<<1)+(r?1:0),3),function(t,e,r){Jt(),Bt=8,r&&(Ut(e),Ut(~e)),Ft.pending_buf.set(et.subarray(t,t+e),Ft.pending),Ft.pending+=e}(t,e,!0)}function Wt(t,e,r){var i,s,a=0;vt>0?(Lt.build_tree(Ft),Tt.build_tree(Ft),a=function(){var t;for(Dt(wt,Lt.max_code),Dt(kt,Tt.max_code),jt.build_tree(Ft),t=n-1;t>=3&&0===Et[2*S.bl_order[t]+1];t--);return Ft.opt_len+=3*(t+1)+5+5+4,t}(),i=Ft.opt_len+3+7>>>3,(s=Ft.static_len+3+7>>>3)<=i&&(i=s)):i=s=e+5,e+4<=i&&-1!=t?Xt(t,e,r):s==i?(qt((G<<1)+(r?1:0),3),Vt(N.static_ltree,N.static_dtree)):(qt((V<<1)+(r?1:0),3),function(t,e,r){var n;for(qt(t-257,5),qt(e-1,5),qt(r-4,4),n=0;n<r;n++)qt(Et[2*S.bl_order[n]+1],3);Qt(wt,t-1),Qt(kt,e-1)}(Lt.max_code+1,Tt.max_code+1,a+1),Vt(wt,kt)),Rt(),r&&Jt()}function Kt(e){Wt(ut>=0?ut:-1,pt-ut,e),ut=pt,t.flush_pending()}function Zt(){var e,r,n,i;do{if(0===(i=rt-_t-pt)&&0===pt&&0===_t)i=O;else if(-1==i)i--;else if(pt>=O+O-W){et.set(et.subarray(O,O+O),0),dt-=O,pt-=O,ut-=O,n=e=at;do{r=65535&it[--n],it[n]=r>=O?r-O:0}while(0!=--e);n=e=O;do{r=65535&nt[--n],nt[n]=r>=O?r-O:0}while(0!=--e);i+=O}if(0===t.avail_in)return;e=t.read_buf(et,pt+_t,i),(_t+=e)>=J&&(st=((st=255&et[pt])<<lt^255&et[pt+1])&ct)}while(_t<W&&0!==t.avail_in)}function te(t){var e,r,n=yt,i=pt,s=mt,a=pt>O-W?pt-(O-W):0,o=xt,c=tt,l=pt+X,u=et[i+s-1],f=et[i+s];mt>=At&&(n>>=2),o>_t&&(o=_t);do{if(et[(e=t)+s]==f&&et[e+s-1]==u&&et[e]==et[i]&&et[++e]==et[i+1]){i+=2,e++;do{}while(et[++i]==et[++e]&&et[++i]==et[++e]&&et[++i]==et[++e]&&et[++i]==et[++e]&&et[++i]==et[++e]&&et[++i]==et[++e]&&et[++i]==et[++e]&&et[++i]==et[++e]&&i<l);if(r=X-(l-i),i=l-X,r>s){if(dt=t,s=r,r>=o)break;u=et[i+s-1],f=et[i+s]}}}while((t=65535&nt[t&c])>a&&0!=--n);return s<=_t?s:_t}function ee(t){return t.total_in=t.total_out=0,t.msg=null,Ft.pending=0,Ft.pending_out=0,e=q,E=_,Lt.dyn_tree=wt,Lt.stat_desc=N.static_l_desc,Tt.dyn_tree=kt,Tt.stat_desc=N.static_d_desc,jt.dyn_tree=Et,jt.stat_desc=N.static_bl_desc,Mt=0,Pt=0,Bt=8,Rt(),function(){var t;for(rt=2*O,it[at-1]=0,t=0;t<at-1;t++)it[t]=0;gt=F[vt].max_lazy,At=F[vt].good_length,xt=F[vt].nice_length,yt=F[vt].max_chain,pt=0,ut=0,_t=0,ft=mt=J-1,ht=0,st=0}(),v}Ft.depth=[],Ft.bl_count=[],Ft.heap=[],wt=[],kt=[],Et=[],Ft.pqdownheap=function(t,e){for(var r=Ft.heap,n=r[e],i=e<<1;i<=Ft.heap_len&&(i<Ft.heap_len&&K(t,r[i+1],r[i],Ft.depth)&&i++,!K(t,n,r[i],Ft.depth));)r[e]=r[i],e=i,i<<=1;r[e]=n},Ft.deflateInit=function(t,e,r,n,i,s){return n||(n=Q),i||(i=C),s||(s=d),t.msg=null,e==$&&(e=6),i<1||i>I||n!=Q||r<9||r>15||e<0||e>9||s<0||s>p?x:(t.dstate=Ft,tt=(O=1<<(Z=r))-1,ct=(at=1<<(ot=i+7))-1,lt=Math.floor((ot+J-1)/J),et=new Uint8Array(2*O),nt=[],it=[],Nt=1<<i+6,Ft.pending_buf=new Uint8Array(4*Nt),a=4*Nt,Ct=Math.floor(Nt/2),St=3*Nt,vt=e,bt=s,ee(t))},Ft.deflateEnd=function(){return e!=U&&e!=q&&e!=H?x:(Ft.pending_buf=null,it=null,nt=null,et=null,Ft.dstate=null,e==q?w:v)},Ft.deflateParams=function(t,e,r){var n=v;return e==$&&(e=6),e<0||e>9||r<0||r>p?x:(F[vt].func!=F[e].func&&0!==t.total_in&&(n=t.deflate(m)),vt!=e&&(gt=F[vt=e].max_lazy,At=F[vt].good_length,xt=F[vt].nice_length,yt=F[vt].max_chain),bt=r,n)},Ft.deflateSetDictionary=function(t,r,n){var i,s=n,a=0;if(!r||e!=U)return x;if(s<J)return v;for(s>O-W&&(a=n-(s=O-W)),et.set(r.subarray(a,a+s),0),pt=s,ut=s,st=((st=255&et[0])<<lt^255&et[1])&ct,i=0;i<=s-J;i++)st=(st<<lt^255&et[i+(J-1)])&ct,nt[i&tt]=it[st],it[st]=i;return v},Ft.deflate=function(r,n){var i,s,c,l,u,f;if(n>g||n<0)return x;if(!r.next_out||!r.next_in&&0!==r.avail_in||e==H&&n!=g)return r.msg=L[A-x],x;if(0===r.avail_out)return r.msg=L[A-k],k;if(t=r,l=E,E=n,e==U&&(s=Q+(Z-8<<4)<<8,(c=(vt-1&255)>>1)>3&&(c=3),s|=c<<6,0!==pt&&(s|=z),e=q,zt((f=s+=31-s%31)>>8&255),zt(255&f)),0!==Ft.pending){if(t.flush_pending(),0===t.avail_out)return E=-1,v}else if(0===t.avail_in&&n<=l&&n!=g)return t.msg=L[A-k],k;if(e==H&&0!==t.avail_in)return r.msg=L[A-k],k;if(0!==t.avail_in||0!==_t||n!=_&&e!=H){switch(u=-1,F[vt].func){case B:u=function(e){var r,n=65535;for(n>a-5&&(n=a-5);;){if(_t<=1){if(Zt(),0===_t&&e==_)return T;if(0===_t)break}if(pt+=_t,_t=0,r=ut+n,(0===pt||pt>=r)&&(_t=pt-r,pt=r,Kt(!1),0===t.avail_out))return T;if(pt-ut>=O-W&&(Kt(!1),0===t.avail_out))return T}return Kt(e==g),0===t.avail_out?e==g?R:T:e==g?D:j}(n);break;case M:u=function(e){for(var r,n=0;;){if(_t<W){if(Zt(),_t<W&&e==_)return T;if(0===_t)break}if(_t>=J&&(st=(st<<lt^255&et[pt+(J-1)])&ct,n=65535&it[st],nt[pt&tt]=it[st],it[st]=pt),0!==n&&(pt-n&65535)<=O-W&&bt!=p&&(ft=te(n)),ft>=J)if(r=Gt(pt-dt,ft-J),_t-=ft,ft<=gt&&_t>=J){ft--;do{st=(st<<lt^255&et[++pt+(J-1)])&ct,n=65535&it[st],nt[pt&tt]=it[st],it[st]=pt}while(0!=--ft);pt++}else pt+=ft,ft=0,st=((st=255&et[pt])<<lt^255&et[pt+1])&ct;else r=Gt(0,255&et[pt]),_t--,pt++;if(r&&(Kt(!1),0===t.avail_out))return T}return Kt(e==g),0===t.avail_out?e==g?R:T:e==g?D:j}(n);break;case P:u=function(e){for(var r,n,i=0;;){if(_t<W){if(Zt(),_t<W&&e==_)return T;if(0===_t)break}if(_t>=J&&(st=(st<<lt^255&et[pt+(J-1)])&ct,i=65535&it[st],nt[pt&tt]=it[st],it[st]=pt),mt=ft,$t=dt,ft=J-1,0!==i&&mt<gt&&(pt-i&65535)<=O-W&&(bt!=p&&(ft=te(i)),ft<=5&&(bt==h||ft==J&&pt-dt>4096)&&(ft=J-1)),mt>=J&&ft<=mt){n=pt+_t-J,r=Gt(pt-1-$t,mt-J),_t-=mt-1,mt-=2;do{++pt<=n&&(st=(st<<lt^255&et[pt+(J-1)])&ct,i=65535&it[st],nt[pt&tt]=it[st],it[st]=pt)}while(0!=--mt);if(ht=0,ft=J-1,pt++,r&&(Kt(!1),0===t.avail_out))return T}else if(0!==ht){if((r=Gt(0,255&et[pt-1]))&&Kt(!1),pt++,_t--,0===t.avail_out)return T}else ht=1,pt++,_t--}return 0!==ht&&(r=Gt(0,255&et[pt-1]),ht=0),Kt(e==g),0===t.avail_out?e==g?R:T:e==g?D:j}(n)}if(u!=R&&u!=D||(e=H),u==T||u==R)return 0===t.avail_out&&(E=-1),v;if(u==j){if(n==m)qt(G<<1,3),Ht(o,N.static_ltree),Yt(),1+Bt+10-Pt<9&&(qt(G<<1,3),Ht(o,N.static_ltree),Yt()),Bt=7;else if(Xt(0,0,!1),n==y)for(i=0;i<at;i++)it[i]=0;if(t.flush_pending(),0===t.avail_out)return E=-1,v}}return n!=g?v:b}}function tt(){this.next_in_index=0,this.next_out_index=0,this.avail_in=0,this.total_in=0,this.avail_out=0,this.total_out=0}tt.prototype={deflateInit:function(t,r){return this.dstate=new Z,r||(r=e),this.dstate.deflateInit(this,t,r)},deflate:function(t){return this.dstate?this.dstate.deflate(this,t):x},deflateEnd:function(){if(!this.dstate)return x;var t=this.dstate.deflateEnd();return this.dstate=null,t},deflateParams:function(t,e){return this.dstate?this.dstate.deflateParams(this,t,e):x},deflateSetDictionary:function(t,e){return this.dstate?this.dstate.deflateSetDictionary(this,t,e):x},read_buf:function(t,e,r){var n=this.avail_in;return n>r&&(n=r),0===n?0:(this.avail_in-=n,t.set(this.next_in.subarray(this.next_in_index,this.next_in_index+n),e),this.next_in_index+=n,this.total_in+=n,n)},flush_pending:function(){var t=this.dstate.pending;t>this.avail_out&&(t=this.avail_out),0!==t&&(this.next_out.set(this.dstate.pending_buf.subarray(this.dstate.pending_out,this.dstate.pending_out+t),this.next_out_index),this.next_out_index+=t,this.dstate.pending_out+=t,this.total_out+=t,this.avail_out-=t,this.dstate.pending-=t,0===this.dstate.pending&&(this.dstate.pending_out=0))}};var et=t.zip||t;et.Deflater=et._jzlib_Deflater=function(t){var e=new tt,r=_,n=new Uint8Array(512),i=t?t.level:$;void 0===i&&(i=$),e.deflateInit(i),e.next_out=n,this.append=function(t,i){var s,a=[],o=0,c=0,l=0;if(t.length){e.next_in_index=0,e.next_in=t,e.avail_in=t.length;do{if(e.next_out_index=0,e.avail_out=512,e.deflate(r)!=v)throw new Error("deflating: "+e.msg);e.next_out_index&&(512==e.next_out_index?a.push(new Uint8Array(n)):a.push(new Uint8Array(n.subarray(0,e.next_out_index)))),l+=e.next_out_index,i&&e.next_in_index>0&&e.next_in_index!=o&&(i(e.next_in_index),o=e.next_in_index)}while(e.avail_in>0||0===e.avail_out);return s=new Uint8Array(l),a.forEach(function(t){s.set(t,c),c+=t.length}),s}},this.flush=function(){var t,r,i=[],s=0,a=0;do{if(e.next_out_index=0,e.avail_out=512,(t=e.deflate(g))!=b&&t!=v)throw new Error("deflating: "+e.msg);512-e.avail_out>0&&i.push(new Uint8Array(n.subarray(0,e.next_out_index))),a+=e.next_out_index}while(e.avail_in>0||0===e.avail_out);return e.deflateEnd(),r=new Uint8Array(a),i.forEach(function(t){r.set(t,s),s+=t.length}),r}}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||"undefined"!=typeof global&&global||Function('return typeof this === "object" && this.content')()||Function("return this")()),function(t){function r(t){var e;this.ok=!1,"#"==t.charAt(0)&&(t=t.substr(1,6)),t=(t=t.replace(/ /g,"")).toLowerCase();var r={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};for(var n in r)t==n&&(t=r[n]);for(var i=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(t){return[parseInt(t[1]),parseInt(t[2]),parseInt(t[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}}],s=0;s<i.length;s++){var a=i[s].re,o=i[s].process,c=a.exec(t);c&&(e=o(c),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var t=this.r.toString(16),e=this.g.toString(16),r=this.b.toString(16);return 1==t.length&&(t="0"+t),1==e.length&&(e="0"+e),1==r.length&&(r="0"+r),"#"+t+e+r}}"undefined"!=typeof define&&define.amd?define("RGBColor",function(){return r}):void 0!==e&&e.exports&&(e.exports=r),t.RGBColor=r}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||"undefined"!=typeof global&&global||Function('return typeof this === "object" && this.content')()||Function("return this")()),function(t){var e="+".charCodeAt(0),r="/".charCodeAt(0),n="0".charCodeAt(0),i="a".charCodeAt(0),s="A".charCodeAt(0),a="-".charCodeAt(0),o="_".charCodeAt(0),c=function(t){var c=t.charCodeAt(0);return c===e||c===a?62:c===r||c===o?63:c<n?-1:c<n+10?c-n+26+26:c<s+26?c-s:c<i+26?c-i+26:void 0};t.API.TTFFont=function(){function t(t,e,r){var n;if(this.rawData=t,n=this.contents=new u(t),this.contents.pos=4,"ttcf"===n.readString(4)){if(!e)throw new Error("Must specify a font name for TTC files.");throw new Error("Font "+e+" not found in TTC file.")}n.pos=0,this.parse(),this.subset=new I(this),this.registerTTF()}return t.open=function(e,r,n,i){return new t(function(t){var e,r,n,i,s,a;if(t.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var o=t.length;s="="===t.charAt(o-2)?2:"="===t.charAt(o-1)?1:0,a=new Uint8Array(3*t.length/4-s),n=s>0?t.length-4:t.length;var l=0;function u(t){a[l++]=t}for(e=0,r=0;e<n;e+=4,r+=3)u((16711680&(i=c(t.charAt(e))<<18|c(t.charAt(e+1))<<12|c(t.charAt(e+2))<<6|c(t.charAt(e+3))))>>16),u((65280&i)>>8),u(255&i);return 2===s?u(255&(i=c(t.charAt(e))<<2|c(t.charAt(e+1))>>4)):1===s&&(u((i=c(t.charAt(e))<<10|c(t.charAt(e+1))<<4|c(t.charAt(e+2))>>2)>>8&255),u(255&i)),a}(n),r,i)},t.prototype.parse=function(){return this.directory=new f(this.contents),this.head=new p(this),this.name=new b(this),this.cmap=new _(this),this.toUnicode=new Map,this.hhea=new m(this),this.maxp=new A(this),this.hmtx=new x(this),this.post=new g(this),this.os2=new y(this),this.loca=new N(this),this.glyf=new k(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var t,e,r,n,i;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=function(){var e,r,n,i;for(i=[],e=0,r=(n=this.bbox).length;e<r;e++)t=n[e],i.push(Math.round(t*this.scaleFactor));return i}.call(this),this.stemV=0,this.post.exists?(r=255&(n=this.post.italic_angle),!0&(e=n>>16)&&(e=-(1+(65535^e))),this.italicAngle=+(e+"."+r)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=1===(i=this.familyClass)||2===i||3===i||4===i||5===i||7===i,this.isScript=10===this.familyClass,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),0!==this.italicAngle&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(t){var e;return(null!=(e=this.cmap.unicode)?e.codeMap[t]:void 0)||0},t.prototype.widthOfGlyph=function(t){var e;return e=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*e},t.prototype.widthOfString=function(t,e,r){var n,i,s,a,o;for(s=0,i=a=0,o=(t=""+t).length;0<=o?a<o:a>o;i=0<=o?++a:--a)n=t.charCodeAt(i),s+=this.widthOfGlyph(this.characterToGlyph(n))+r*(1e3/e)||0;return s*(e/1e3)},t.prototype.lineHeight=function(t,e){var r;return null==e&&(e=!1),r=e?this.lineGap:0,(this.ascender+r-this.decender)/1e3*t},t}();var l,u=function(){function t(t){this.data=null!=t?t:[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(t){return this.data[this.pos++]=t},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},t.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},t.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},t.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},t.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},t.prototype.readString=function(t){var e,r,n;for(r=[],e=n=0;0<=t?n<t:n>t;e=0<=t?++n:--n)r[e]=String.fromCharCode(this.readByte());return r.join("")},t.prototype.writeString=function(t){var e,r,n,i;for(i=[],e=r=0,n=t.length;0<=n?r<n:r>n;e=0<=n?++r:--r)i.push(this.writeByte(t.charCodeAt(e)));return i},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(t){return this.writeInt16(t)},t.prototype.readLongLong=function(){var t,e,r,n,i,s,a,o;return t=this.readByte(),e=this.readByte(),r=this.readByte(),n=this.readByte(),i=this.readByte(),s=this.readByte(),a=this.readByte(),o=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^e)+1099511627776*(255^r)+4294967296*(255^n)+16777216*(255^i)+65536*(255^s)+256*(255^a)+(255^o)+1):72057594037927940*t+281474976710656*e+1099511627776*r+4294967296*n+16777216*i+65536*s+256*a+o},t.prototype.writeLongLong=function(t){var e,r;return e=Math.floor(t/4294967296),r=4294967295&t,this.writeByte(e>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e),this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(t){return this.writeInt32(t)},t.prototype.read=function(t){var e,r;for(e=[],r=0;0<=t?r<t:r>t;0<=t?++r:--r)e.push(this.readByte());return e},t.prototype.write=function(t){var e,r,n,i;for(i=[],r=0,n=t.length;r<n;r++)e=t[r],i.push(this.writeByte(e));return i},t}(),f=function(){var t;function e(t){var e,r,n;for(this.scalarType=t.readInt(),this.tableCount=t.readShort(),this.searchRange=t.readShort(),this.entrySelector=t.readShort(),this.rangeShift=t.readShort(),this.tables={},r=0,n=this.tableCount;0<=n?r<n:r>n;0<=n?++r:--r)e={tag:t.readString(4),checksum:t.readInt(),offset:t.readInt(),length:t.readInt()},this.tables[e.tag]=e}return e.prototype.encode=function(e){var r,n,i,s,a,o,c,l,f,$,h,p,d;for(d in h=Object.keys(e).length,o=Math.log(2),f=16*Math.floor(Math.log(h)/o),s=Math.floor(f/o),l=16*h-f,(n=new u).writeInt(this.scalarType),n.writeShort(h),n.writeShort(f),n.writeShort(s),n.writeShort(l),i=16*h,c=n.pos+i,a=null,p=[],e)for($=e[d],n.writeString(d),n.writeInt(t($)),n.writeInt(c),n.writeInt($.length),p=p.concat($),"head"===d&&(a=c),c+=$.length;c%4;)p.push(0),c++;return n.write(p),r=2981146554-t(n.data),n.pos=a+8,n.writeUInt32(r),n.data},t=function(t){var e,r,n,i;for(t=w.call(t);t.length%4;)t.push(0);for(r=new u(t),e=0,n=0,i=t.length;n<i;n+=4)e+=r.readUInt32();return 4294967295&e},e}(),$={}.hasOwnProperty,h=function(t,e){for(var r in e)$.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};l=function(){function t(t){var e;this.file=t,e=this.file.directory.tables[this.tag],this.exists=!!e,e&&(this.offset=e.offset,this.length=e.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t}();var p=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,l),e.prototype.tag="head",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},e.prototype.encode=function(t){var e;return(e=new u).writeInt(this.version),e.writeInt(this.revision),e.writeInt(this.checkSumAdjustment),e.writeInt(this.magicNumber),e.writeShort(this.flags),e.writeShort(this.unitsPerEm),e.writeLongLong(this.created),e.writeLongLong(this.modified),e.writeShort(this.xMin),e.writeShort(this.yMin),e.writeShort(this.xMax),e.writeShort(this.yMax),e.writeShort(this.macStyle),e.writeShort(this.lowestRecPPEM),e.writeShort(this.fontDirectionHint),e.writeShort(t),e.writeShort(this.glyphDataFormat),e.data},e}(),d=function(){function t(t,e){var r,n,i,s,a,o,c,l,u,f,$,h,p,d,_,m,y,g;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=e+t.readInt(),u=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=3===this.platformID&&1===this.encodingID&&4===this.format||0===this.platformID&&4===this.format,this.codeMap={},this.format){case 0:for(o=_=0;_<256;o=++_)this.codeMap[o]=t.readByte();break;case 4:for($=t.readUInt16(),f=$/2,t.pos+=6,i=function(){var e,r;for(r=[],o=e=0;0<=f?e<f:e>f;o=0<=f?++e:--e)r.push(t.readUInt16());return r}(),t.pos+=2,p=function(){var e,r;for(r=[],o=e=0;0<=f?e<f:e>f;o=0<=f?++e:--e)r.push(t.readUInt16());return r}(),c=function(){var e,r;for(r=[],o=e=0;0<=f?e<f:e>f;o=0<=f?++e:--e)r.push(t.readUInt16());return r}(),l=function(){var e,r;for(r=[],o=e=0;0<=f?e<f:e>f;o=0<=f?++e:--e)r.push(t.readUInt16());return r}(),n=(this.length-t.pos+this.offset)/2,a=function(){var e,r;for(r=[],o=e=0;0<=n?e<n:e>n;o=0<=n?++e:--e)r.push(t.readUInt16());return r}(),o=m=0,g=i.length;m<g;o=++m)for(d=i[o],r=y=h=p[o];h<=d?y<=d:y>=d;r=h<=d?++y:--y)0===l[o]?s=r+c[o]:0!==(s=a[l[o]/2+(r-h)-(f-o)]||0)&&(s+=c[o]),this.codeMap[r]=65535&s}t.pos=u}return t.encode=function(t,e){var r,n,i,s,a,o,c,l,f,$,h,p,d,_,m,y,g,v,b,A,x,w,k,E,S,N,I,C,O,B,M,P,F,L,T,j,R,D,z,U,q,H,Q,Y,G,V;switch(C=new u,s=Object.keys(t).sort(function(t,e){return t-e}),e){case"macroman":for(d=0,_=function(){var t,e;for(e=[],p=t=0;t<256;p=++t)e.push(0);return e}(),y={0:0},i={},O=0,F=s.length;O<F;O++)null==y[Q=t[n=s[O]]]&&(y[Q]=++d),i[n]={old:t[n],new:y[t[n]]},_[n]=y[t[n]];return C.writeUInt16(1),C.writeUInt16(0),C.writeUInt32(12),C.writeUInt16(0),C.writeUInt16(262),C.writeUInt16(0),C.write(_),{charMap:i,subtable:C.data,maxGlyphID:d+1};case"unicode":for(N=[],f=[],g=0,y={},r={},m=c=null,B=0,L=s.length;B<L;B++)null==y[b=t[n=s[B]]]&&(y[b]=++g),r[n]={old:b,new:y[b]},a=y[b]-n,null!=m&&a===c||(m&&f.push(m),N.push(n),c=a),m=n;for(m&&f.push(m),f.push(65535),N.push(65535),E=2*(k=N.length),w=2*Math.pow(Math.log(k)/Math.LN2,2),$=Math.log(w/2)/Math.LN2,x=2*k-w,o=[],A=[],h=[],p=M=0,T=N.length;M<T;p=++M){if(S=N[p],l=f[p],65535===S){o.push(0),A.push(0);break}if(S-(I=r[S].new)>=32768)for(o.push(0),A.push(2*(h.length+k-p)),n=P=S;S<=l?P<=l:P>=l;n=S<=l?++P:--P)h.push(r[n].new);else o.push(I-S),A.push(0)}for(C.writeUInt16(3),C.writeUInt16(1),C.writeUInt32(12),C.writeUInt16(4),C.writeUInt16(16+8*k+2*h.length),C.writeUInt16(0),C.writeUInt16(E),C.writeUInt16(w),C.writeUInt16($),C.writeUInt16(x),q=0,j=f.length;q<j;q++)n=f[q],C.writeUInt16(n);for(C.writeUInt16(0),H=0,R=N.length;H<R;H++)n=N[H],C.writeUInt16(n);for(Y=0,D=o.length;Y<D;Y++)a=o[Y],C.writeUInt16(a);for(G=0,z=A.length;G<z;G++)v=A[G],C.writeUInt16(v);for(V=0,U=h.length;V<U;V++)d=h[V],C.writeUInt16(d);return{charMap:r,subtable:C.data,maxGlyphID:g+1}}},t}(),_=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,l),e.prototype.tag="cmap",e.prototype.parse=function(t){var e,r,n;for(t.pos=this.offset,this.version=t.readUInt16(),r=t.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=r?n<r:n>r;0<=r?++n:--n)e=new d(t,this.offset),this.tables.push(e),e.isUnicode&&null==this.unicode&&(this.unicode=e);return!0},e.encode=function(t,e){var r,n;return null==e&&(e="macroman"),r=d.encode(t,e),(n=new u).writeUInt16(0),n.writeUInt16(1),r.table=n.data.concat(r.subtable),r},e}(),m=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,l),e.prototype.tag="hhea",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},e}(),y=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,l),e.prototype.tag="OS/2",e.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var e,r;for(r=[],e=0;e<10;++e)r.push(t.readByte());return r}(),this.charRange=function(){var e,r;for(r=[],e=0;e<4;++e)r.push(t.readInt());return r}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var e,r;for(r=[],e=0;e<2;++e)r.push(t.readInt());return r}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},e}(),g=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,l),e.prototype.tag="post",e.prototype.parse=function(t){var e,r,n,i;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:break;case 131072:for(r=t.readUInt16(),this.glyphNameIndex=[],n=0;0<=r?n<r:n>r;0<=r?++n:--n)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],i=[];t.pos<this.offset+this.length;)e=t.readByte(),i.push(this.names.push(t.readString(e)));return i;case 151552:return r=t.readUInt16(),this.offsets=t.read(r);case 196608:break;case 262144:return this.map=function(){var e,r,n;for(n=[],e=0,r=this.file.maxp.numGlyphs;0<=r?e<r:e>r;0<=r?++e:--e)n.push(t.readUInt32());return n}.call(this)}},e}(),v=function(){return function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID}}(),b=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,l),e.prototype.tag="name",e.prototype.parse=function(t){var e,r,n,i,s,a,o,c,l,u,f,$;for(t.pos=this.offset,t.readShort(),e=t.readShort(),a=t.readShort(),r=[],i=l=0;0<=e?l<e:l>e;i=0<=e?++l:--l)r.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+a+t.readShort()});for(o={},i=u=0,f=r.length;u<f;i=++u)n=r[i],t.pos=n.offset,c=t.readString(n.length),s=new v(c,n),null==o[$=n.nameID]&&(o[$]=[]),o[n.nameID].push(s);this.strings=o,this.copyright=o[0],this.fontFamily=o[1],this.fontSubfamily=o[2],this.uniqueSubfamily=o[3],this.fontName=o[4],this.version=o[5];try{this.postscriptName=o[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch(t){this.postscriptName=o[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=o[7],this.manufacturer=o[8],this.designer=o[9],this.description=o[10],this.vendorUrl=o[11],this.designerUrl=o[12],this.license=o[13],this.licenseUrl=o[14],this.preferredFamily=o[15],this.preferredSubfamily=o[17],this.compatibleFull=o[18],this.sampleText=o[19]},e}(),A=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,l),e.prototype.tag="maxp",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},e}(),x=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,l),e.prototype.tag="hmtx",e.prototype.parse=function(t){var e,r,n,i,s,a,o;for(t.pos=this.offset,this.metrics=[],i=0,a=this.file.hhea.numberOfMetrics;0<=a?i<a:i>a;0<=a?++i:--i)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(r=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var e,n;for(n=[],e=0;0<=r?e<r:e>r;0<=r?++e:--e)n.push(t.readInt16());return n}(),this.widths=function(){var t,e,r,i;for(i=[],t=0,e=(r=this.metrics).length;t<e;t++)n=r[t],i.push(n.advance);return i}.call(this),e=this.widths[this.widths.length-1],o=[],s=0;0<=r?s<r:s>r;0<=r?++s:--s)o.push(this.widths.push(e));return o},e.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},e}(),w=[].slice,k=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,l),e.prototype.tag="glyf",e.prototype.parse=function(t){return this.cache={}},e.prototype.glyphFor=function(t){var e,r,n,i,s,a,o,c,l,f;return(t=t)in this.cache?this.cache[t]:(i=this.file.loca,e=this.file.contents,r=i.indexOf(t),0===(n=i.lengthOf(t))?this.cache[t]=null:(e.pos=this.offset+r,s=(a=new u(e.read(n))).readShort(),c=a.readShort(),f=a.readShort(),o=a.readShort(),l=a.readShort(),this.cache[t]=-1===s?new S(a,c,f,o,l):new E(a,s,c,f,o,l),this.cache[t]))},e.prototype.encode=function(t,e,r){var n,i,s,a,o;for(s=[],i=[],a=0,o=e.length;a<o;a++)n=t[e[a]],i.push(s.length),n&&(s=s.concat(n.encode(r)));return i.push(s.length),{table:s,offsets:i}},e}(),E=function(){function t(t,e,r,n,i,s){this.raw=t,this.numberOfContours=e,this.xMin=r,this.yMin=n,this.xMax=i,this.yMax=s,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t}(),S=function(){var t,e,r,n,i;function s(s,a,o,c,l){var u,f;for(this.raw=s,this.xMin=a,this.yMin=o,this.xMax=c,this.yMax=l,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],u=this.raw;f=u.readShort(),this.glyphOffsets.push(u.pos),this.glyphIDs.push(u.readShort()),f&e;)u.pos+=f&t?4:2,f&i?u.pos+=8:f&r?u.pos+=4:f&n&&(u.pos+=2)}return t=1,n=8,e=32,r=64,i=128,s.prototype.encode=function(t){var e,r,n,i,s;for(r=new u(w.call(this.raw.data)),e=n=0,i=(s=this.glyphIDs).length;n<i;e=++n)s[e],r.pos=this.glyphOffsets[e];return r.data},s}(),N=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,l),e.prototype.tag="loca",e.prototype.parse=function(t){var e;return t.pos=this.offset,e=this.file.head.indexToLocFormat,this.offsets=0===e?function(){var e,r,n;for(n=[],e=0,r=this.length;e<r;e+=2)n.push(2*t.readUInt16());return n}.call(this):function(){var e,r,n;for(n=[],e=0,r=this.length;e<r;e+=4)n.push(t.readUInt32());return n}.call(this)},e.prototype.indexOf=function(t){return this.offsets[t]},e.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},e.prototype.encode=function(t,e){for(var r=new Uint32Array(this.offsets.length),n=0,i=0,s=0;s<r.length;++s)if(r[s]=n,i<e.length&&e[i]==s){++i,r[s]=n;var a=this.offsets[s],o=this.offsets[s+1]-a;o>0&&(n+=o)}for(var c=new Array(4*r.length),l=0;l<r.length;++l)c[4*l+3]=255&r[l],c[4*l+2]=(65280&r[l])>>8,c[4*l+1]=(16711680&r[l])>>16,c[4*l]=(4278190080&r[l])>>24;return c},e}(),I=function(){function t(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var t,e,r,n,i;for(e in n=this.font.cmap.tables[0].codeMap,t={},i=this.subset)r=i[e],t[e]=n[r];return t},t.prototype.glyphsFor=function(t){var e,r,n,i,s,a,o;for(n={},s=0,a=t.length;s<a;s++)n[i=t[s]]=this.font.glyf.glyphFor(i);for(i in e=[],n)(null!=(r=n[i])?r.compound:void 0)&&e.push.apply(e,r.glyphIDs);if(e.length>0)for(i in o=this.glyphsFor(e))r=o[i],n[i]=r;return n},t.prototype.encode=function(t,e){var r,n,i,s,a,o,c,l,u,f,$,h,p,d,m;for(n in r=_.encode(this.generateCmap(),"unicode"),s=this.glyphsFor(t),$={0:0},m=r.charMap)$[(o=m[n]).old]=o.new;for(h in f=r.maxGlyphID,s)h in $||($[h]=f++);return l=function(t){var e,r;for(e in r={},t)r[t[e]]=e;return r}($),u=Object.keys(l).sort(function(t,e){return t-e}),p=function(){var t,e,r;for(r=[],t=0,e=u.length;t<e;t++)a=u[t],r.push(l[a]);return r}(),i=this.font.glyf.encode(s,p,$),c=this.font.loca.encode(i.offsets,p),d={cmap:this.font.cmap.raw(),glyf:i.table,loca:c,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(e)},this.font.os2.exists&&(d["OS/2"]=this.font.os2.raw()),this.font.directory.encode(d)},t}();t.API.PDFObject=function(){var t;function e(){}return t=function(t,e){return(Array(e+1).join("0")+t).slice(-e)},e.convert=function(r){var n,i,s,a;if(Array.isArray(r))return"["+function(){var t,i,s;for(s=[],t=0,i=r.length;t<i;t++)n=r[t],s.push(e.convert(n));return s}().join(" ")+"]";if("string"==typeof r)return"/"+r;if(null!=r?r.isString:void 0)return"("+r+")";if(r instanceof Date)return"(D:"+t(r.getUTCFullYear(),4)+t(r.getUTCMonth(),2)+t(r.getUTCDate(),2)+t(r.getUTCHours(),2)+t(r.getUTCMinutes(),2)+t(r.getUTCSeconds(),2)+"Z)";if("[object Object]"==={}.toString.call(r)){for(i in s=["<<"],r)a=r[i],s.push("/"+i+" "+e.convert(a));return s.push(">>"),s.join("\n")}return""+r},e}()}(v),function(t){var e;e=function(){var e,r,n;function i(t){var e,r,n,i,s,a,o,c,l,u,f,$,h,p;for(this.data=t,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},a=null;;){switch(e=this.readUInt32(),l=function(){var t,e;for(e=[],t=0;t<4;++t)e.push(String.fromCharCode(this.data[this.pos++]));return e}.call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(e);break;case"fcTL":a&&this.animation.frames.push(a),this.pos+=4,a={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},s=this.readUInt16(),i=this.readUInt16()||100,a.delay=1e3*s/i,a.disposeOp=this.data[this.pos++],a.blendOp=this.data[this.pos++],a.data=[];break;case"IDAT":case"fdAT":for("fdAT"===l&&(this.pos+=4,e-=4),t=(null!=a?a.data:void 0)||this.imgData,$=0;0<=e?$<e:$>e;0<=e?++$:--$)t.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(n=this.palette.length/3,this.transparency.indexed=this.read(e),this.transparency.indexed.length>n)throw new Error("More transparent colors than palette size");if((u=n-this.transparency.indexed.length)>0)for(h=0;0<=u?h<u:h>u;0<=u?++h:--h)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(e)[0];break;case 2:this.transparency.rgb=this.read(e)}break;case"tEXt":o=(f=this.read(e)).indexOf(0),c=String.fromCharCode.apply(String,f.slice(0,o)),this.text[c]=String.fromCharCode.apply(String,f.slice(o+1));break;case"IEND":return a&&this.animation.frames.push(a),this.colors=function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}.call(this),this.hasAlphaChannel=4===(p=this.colorType)||6===p,r=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*r,this.colorSpace=function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}.call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=e}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}i.load=function(t,e,r){var n;return"function"==typeof e&&(r=e),(n=new XMLHttpRequest).open("GET",t,!0),n.responseType="arraybuffer",n.onload=function(){var t;return t=new i(new Uint8Array(n.response||n.mozResponseArrayBuffer)),"function"==typeof(null!=e?e.getContext:void 0)&&t.render(e),"function"==typeof r?r(t):void 0},n.send(null)},i.prototype.read=function(t){var e,r;for(r=[],e=0;0<=t?e<t:e>t;0<=t?++e:--e)r.push(this.data[this.pos++]);return r},i.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},i.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},i.prototype.decodePixels=function(t){var e=this.pixelBitlength/8,r=new Uint8Array(this.width*this.height*e),n=0,i=this;if(null==t&&(t=this.imgData),0===t.length)return new Uint8Array(0);function s(s,a,o,c){var l,u,f,$,h,p,d,_,m,y,g,v,b,A,x,w,k,E,S,N,I,C=Math.ceil((i.width-s)/o),O=Math.ceil((i.height-a)/c),B=i.width==C&&i.height==O;for(A=e*C,v=B?r:new Uint8Array(A*O),p=t.length,b=0,u=0;b<O&&n<p;){switch(t[n++]){case 0:for($=k=0;k<A;$=k+=1)v[u++]=t[n++];break;case 1:for($=E=0;E<A;$=E+=1)l=t[n++],h=$<e?0:v[u-e],v[u++]=(l+h)%256;break;case 2:for($=S=0;S<A;$=S+=1)l=t[n++],f=($-$%e)/e,x=b&&v[(b-1)*A+f*e+$%e],v[u++]=(x+l)%256;break;case 3:for($=N=0;N<A;$=N+=1)l=t[n++],f=($-$%e)/e,h=$<e?0:v[u-e],x=b&&v[(b-1)*A+f*e+$%e],v[u++]=(l+Math.floor((h+x)/2))%256;break;case 4:for($=I=0;I<A;$=I+=1)l=t[n++],f=($-$%e)/e,h=$<e?0:v[u-e],0===b?x=w=0:(x=v[(b-1)*A+f*e+$%e],w=f&&v[(b-1)*A+(f-1)*e+$%e]),d=h+x-w,_=Math.abs(d-h),y=Math.abs(d-x),g=Math.abs(d-w),m=_<=y&&_<=g?h:y<=g?x:w,v[u++]=(l+m)%256;break;default:throw new Error("Invalid filter algorithm: "+t[n-1])}if(!B){var M=((a+b*c)*i.width+s)*e,P=b*A;for($=0;$<C;$+=1){for(var F=0;F<e;F+=1)r[M++]=v[P++];M+=(o-1)*e}}b++}}return t=(t=new w(t)).getBytes(),1==i.interlaceMethod?(s(0,0,8,8),s(4,0,8,8),s(0,4,4,8),s(2,0,4,4),s(0,2,2,4),s(1,0,2,2),s(0,1,1,2)):s(0,0,1,1),r},i.prototype.decodePalette=function(){var t,e,r,n,i,s,a,o,c;for(r=this.palette,s=this.transparency.indexed||[],i=new Uint8Array((s.length||0)+r.length),n=0,r.length,t=0,e=a=0,o=r.length;a<o;e=a+=3)i[n++]=r[e],i[n++]=r[e+1],i[n++]=r[e+2],i[n++]=null!=(c=s[t++])?c:255;return i},i.prototype.copyToImageData=function(t,e){var r,n,i,s,a,o,c,l,u,f,$;if(n=this.colors,u=null,r=this.hasAlphaChannel,this.palette.length&&(u=null!=($=this._decodedPalette)?$:this._decodedPalette=this.decodePalette(),n=4,r=!0),l=(i=t.data||t).length,a=u||e,s=o=0,1===n)for(;s<l;)c=u?4*e[s/4]:o,f=a[c++],i[s++]=f,i[s++]=f,i[s++]=f,i[s++]=r?a[c++]:255,o=c;else for(;s<l;)c=u?4*e[s/4]:o,i[s++]=a[c++],i[s++]=a[c++],i[s++]=a[c++],i[s++]=r?a[c++]:255,o=c},i.prototype.decode=function(){var t;return t=new Uint8Array(this.width*this.height*4),this.copyToImageData(t,this.decodePixels()),t};try{r=t.document.createElement("canvas"),n=r.getContext("2d")}catch(t){return-1}return e=function(t){var e;return n.width=t.width,n.height=t.height,n.clearRect(0,0,t.width,t.height),n.putImageData(t,0,0),(e=new Image).src=r.toDataURL(),e},i.prototype.decodeFrames=function(t){var r,n,i,s,a,o,c,l;if(this.animation){for(l=[],n=a=0,o=(c=this.animation.frames).length;a<o;n=++a)r=c[n],i=t.createImageData(r.width,r.height),s=this.decodePixels(new Uint8Array(r.data)),this.copyToImageData(i,s),r.imageData=i,l.push(r.image=e(i));return l}},i.prototype.renderFrame=function(t,e){var r,n,i;return r=(n=this.animation.frames)[e],i=n[e-1],0===e&&t.clearRect(0,0,this.width,this.height),1===(null!=i?i.disposeOp:void 0)?t.clearRect(i.xOffset,i.yOffset,i.width,i.height):2===(null!=i?i.disposeOp:void 0)&&t.putImageData(i.imageData,i.xOffset,i.yOffset),0===r.blendOp&&t.clearRect(r.xOffset,r.yOffset,r.width,r.height),t.drawImage(r.image,r.xOffset,r.yOffset)},i.prototype.animate=function(t){var e,r,n,i,s,a,o=this;return r=0,a=this.animation,i=a.numFrames,n=a.frames,s=a.numPlays,(e=function(){var a,c;if(a=r++%i,c=n[a],o.renderFrame(t,a),i>1&&r/i<s)return o.animation._timeout=setTimeout(e,c.delay)})()},i.prototype.stopAnimation=function(){var t;return clearTimeout(null!=(t=this.animation)?t._timeout:void 0)},i.prototype.render=function(t){var e,r;return t._png&&t._png.stopAnimation(),t._png=this,t.width=this.width,t.height=this.height,e=t.getContext("2d"),this.animation?(this.decodeFrames(e),this.animate(e)):(r=e.createImageData(this.width,this.height),this.copyToImageData(r,this.decodePixels()),e.putImageData(r,0,0))},i}(),t.PNG=e}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||"undefined"!=typeof global&&global||Function('return typeof this === "object" && this.content')()||Function("return this")());var x=function(){function t(){this.pos=0,this.bufferLength=0,this.eof=!1,this.buffer=null}return t.prototype={ensureBuffer:function(t){var e=this.buffer,r=e?e.byteLength:0;if(t<r)return e;for(var n=512;n<t;)n<<=1;for(var i=new Uint8Array(n),s=0;s<r;++s)i[s]=e[s];return this.buffer=i},getByte:function(){for(var t=this.pos;this.bufferLength<=t;){if(this.eof)return null;this.readBlock()}return this.buffer[this.pos++]},getBytes:function(t){var e=this.pos;if(t){this.ensureBuffer(e+t);for(var r=e+t;!this.eof&&this.bufferLength<r;)this.readBlock();var n=this.bufferLength;r>n&&(r=n)}else{for(;!this.eof;)this.readBlock();r=this.bufferLength}return this.pos=r,this.buffer.subarray(e,r)},lookChar:function(){for(var t=this.pos;this.bufferLength<=t;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos])},getChar:function(){for(var t=this.pos;this.bufferLength<=t;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos++])},makeSubStream:function(t,e,r){for(var n=t+e;this.bufferLength<=n&&!this.eof;)this.readBlock();return new Stream(this.buffer,t,e,r)},skip:function(t){t||(t=1),this.pos+=t},reset:function(){this.pos=0}},t}(),w=function(){if("undefined"!=typeof Uint32Array){var t=new Uint32Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),e=new Uint32Array([3,4,5,6,7,8,9,10,65547,65549,65551,65553,131091,131095,131099,131103,196643,196651,196659,196667,262211,262227,262243,262259,327811,327843,327875,327907,258,258,258]),r=new Uint32Array([1,2,3,4,65541,65543,131081,131085,196625,196633,262177,262193,327745,327777,393345,393409,459009,459137,524801,525057,590849,591361,657409,658433,724993,727041,794625,798721,868353,876545]),n=[new Uint32Array([459008,524368,524304,524568,459024,524400,524336,590016,459016,524384,524320,589984,524288,524416,524352,590048,459012,524376,524312,589968,459028,524408,524344,590032,459020,524392,524328,59e4,524296,524424,524360,590064,459010,524372,524308,524572,459026,524404,524340,590024,459018,524388,524324,589992,524292,524420,524356,590056,459014,524380,524316,589976,459030,524412,524348,590040,459022,524396,524332,590008,524300,524428,524364,590072,459009,524370,524306,524570,459025,524402,524338,590020,459017,524386,524322,589988,524290,524418,524354,590052,459013,524378,524314,589972,459029,524410,524346,590036,459021,524394,524330,590004,524298,524426,524362,590068,459011,524374,524310,524574,459027,524406,524342,590028,459019,524390,524326,589996,524294,524422,524358,590060,459015,524382,524318,589980,459031,524414,524350,590044,459023,524398,524334,590012,524302,524430,524366,590076,459008,524369,524305,524569,459024,524401,524337,590018,459016,524385,524321,589986,524289,524417,524353,590050,459012,524377,524313,589970,459028,524409,524345,590034,459020,524393,524329,590002,524297,524425,524361,590066,459010,524373,524309,524573,459026,524405,524341,590026,459018,524389,524325,589994,524293,524421,524357,590058,459014,524381,524317,589978,459030,524413,524349,590042,459022,524397,524333,590010,524301,524429,524365,590074,459009,524371,524307,524571,459025,524403,524339,590022,459017,524387,524323,589990,524291,524419,524355,590054,459013,524379,524315,589974,459029,524411,524347,590038,459021,524395,524331,590006,524299,524427,524363,590070,459011,524375,524311,524575,459027,524407,524343,590030,459019,524391,524327,589998,524295,524423,524359,590062,459015,524383,524319,589982,459031,524415,524351,590046,459023,524399,524335,590014,524303,524431,524367,590078,459008,524368,524304,524568,459024,524400,524336,590017,459016,524384,524320,589985,524288,524416,524352,590049,459012,524376,524312,589969,459028,524408,524344,590033,459020,524392,524328,590001,524296,524424,524360,590065,459010,524372,524308,524572,459026,524404,524340,590025,459018,524388,524324,589993,524292,524420,524356,590057,459014,524380,524316,589977,459030,524412,524348,590041,459022,524396,524332,590009,524300,524428,524364,590073,459009,524370,524306,524570,459025,524402,524338,590021,459017,524386,524322,589989,524290,524418,524354,590053,459013,524378,524314,589973,459029,524410,524346,590037,459021,524394,524330,590005,524298,524426,524362,590069,459011,524374,524310,524574,459027,524406,524342,590029,459019,524390,524326,589997,524294,524422,524358,590061,459015,524382,524318,589981,459031,524414,524350,590045,459023,524398,524334,590013,524302,524430,524366,590077,459008,524369,524305,524569,459024,524401,524337,590019,459016,524385,524321,589987,524289,524417,524353,590051,459012,524377,524313,589971,459028,524409,524345,590035,459020,524393,524329,590003,524297,524425,524361,590067,459010,524373,524309,524573,459026,524405,524341,590027,459018,524389,524325,589995,524293,524421,524357,590059,459014,524381,524317,589979,459030,524413,524349,590043,459022,524397,524333,590011,524301,524429,524365,590075,459009,524371,524307,524571,459025,524403,524339,590023,459017,524387,524323,589991,524291,524419,524355,590055,459013,524379,524315,589975,459029,524411,524347,590039,459021,524395,524331,590007,524299,524427,524363,590071,459011,524375,524311,524575,459027,524407,524343,590031,459019,524391,524327,589999,524295,524423,524359,590063,459015,524383,524319,589983,459031,524415,524351,590047,459023,524399,524335,590015,524303,524431,524367,590079]),9],i=[new Uint32Array([327680,327696,327688,327704,327684,327700,327692,327708,327682,327698,327690,327706,327686,327702,327694,0,327681,327697,327689,327705,327685,327701,327693,327709,327683,327699,327691,327707,327687,327703,327695,0]),5];return a.prototype=Object.create(x.prototype),a.prototype.getBits=function(t){for(var e,r=this.codeSize,n=this.codeBuf,i=this.bytes,a=this.bytesPos;r<t;)void 0===(e=i[a++])&&s("Bad encoding in flate stream"),n|=e<<r,r+=8;return e=n&(1<<t)-1,this.codeBuf=n>>t,this.codeSize=r-=t,this.bytesPos=a,e},a.prototype.getCode=function(t){for(var e=t[0],r=t[1],n=this.codeSize,i=this.codeBuf,a=this.bytes,o=this.bytesPos;n<r;){var c;void 0===(c=a[o++])&&s("Bad encoding in flate stream"),i|=c<<n,n+=8}var l=e[i&(1<<r)-1],u=l>>16,f=65535&l;return(0==n||n<u||0==u)&&s("Bad encoding in flate stream"),this.codeBuf=i>>u,this.codeSize=n-u,this.bytesPos=o,f},a.prototype.generateHuffmanTable=function(t){for(var e=t.length,r=0,n=0;n<e;++n)t[n]>r&&(r=t[n]);for(var i=1<<r,s=new Uint32Array(i),a=1,o=0,c=2;a<=r;++a,o<<=1,c<<=1)for(var l=0;l<e;++l)if(t[l]==a){var u=0,f=o;for(n=0;n<a;++n)u=u<<1|1&f,f>>=1;for(n=u;n<i;n+=c)s[n]=a<<16|l;++o}return[s,r]},a.prototype.readBlock=function(){function a(t,e,r,n,i){for(var s=t.getBits(r)+n;s-- >0;)e[p++]=i}var o=this.getBits(3);if(1&o&&(this.eof=!0),0!=(o>>=1)){var c,l;if(1==o)c=n,l=i;else if(2==o){for(var u=this.getBits(5)+257,f=this.getBits(5)+1,$=this.getBits(4)+4,h=Array(t.length),p=0;p<$;)h[t[p++]]=this.getBits(3);for(var d=this.generateHuffmanTable(h),_=0,m=(p=0,u+f),y=new Array(m);p<m;){var g=this.getCode(d);16==g?a(this,y,2,3,_):17==g?a(this,y,3,3,_=0):18==g?a(this,y,7,11,_=0):y[p++]=_=g}c=this.generateHuffmanTable(y.slice(0,u)),l=this.generateHuffmanTable(y.slice(u,m))}else s("Unknown block type in flate stream");for(var v=(B=this.buffer)?B.length:0,b=this.bufferLength;;){var A=this.getCode(c);if(A<256)b+1>=v&&(v=(B=this.ensureBuffer(b+1)).length),B[b++]=A;else{if(256==A)return void(this.bufferLength=b);var x=(A=e[A-=257])>>16;x>0&&(x=this.getBits(x));_=(65535&A)+x;A=this.getCode(l),(x=(A=r[A])>>16)>0&&(x=this.getBits(x));var w=(65535&A)+x;b+_>=v&&(v=(B=this.ensureBuffer(b+_)).length);for(var k=0;k<_;++k,++b)B[b]=B[b-w]}}}else{var E,S=this.bytes,N=this.bytesPos;void 0===(E=S[N++])&&s("Bad block header in flate stream");var I=E;void 0===(E=S[N++])&&s("Bad block header in flate stream"),I|=E<<8,void 0===(E=S[N++])&&s("Bad block header in flate stream");var C=E;void 0===(E=S[N++])&&s("Bad block header in flate stream"),(C|=E<<8)!=(65535&~I)&&s("Bad uncompressed block length in flate stream"),this.codeBuf=0,this.codeSize=0;var O=this.bufferLength,B=this.ensureBuffer(O+I),M=O+I;this.bufferLength=M;for(var P=O;P<M;++P){if(void 0===(E=S[N++])){this.eof=!0;break}B[P]=E}this.bytesPos=N}},a}function s(t){throw new Error(t)}function a(t){var e=0,r=t[e++],n=t[e++];-1!=r&&-1!=n||s("Invalid header in flate stream"),8!=(15&r)&&s("Unknown compression method in flate stream"),((r<<8)+n)%31!=0&&s("Bad FCHECK in flate stream"),32&n&&s("FDICT bit set in flate stream"),this.bytes=t,this.bytesPos=2,this.codeSize=0,this.codeBuf=0,x.call(this)}}();window.tmp=w,r.default=v;var k=r.default;r.rewire=function(t){r.default=t},r.restore=function(){r.default=k},e.exports=v},{}]},{},[87]);