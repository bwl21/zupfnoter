<<<<<<< HEAD
!function t(e,r,n){function a(o,s){if(!r[o]){if(!e[o]){var c="function"==typeof require&&require;if(!s&&c)return c(o,!0);if(i)return i(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var u=r[o]={exports:{}};e[o][0].call(u.exports,function(t){var r=e[o][1][t];return a(r||t)},u,u.exports,t,e,r,n)}return r[o].exports}for(var i="function"==typeof require&&require,o=0;o<n.length;o++)a(n[o]);return a}({1:[function(t,e,r){!function(t){function e(t,e){function r(t,r){if(null===t||void 0===t)return r+"null";if("number"==typeof t){return r+(t===+t&&t!==(0|t)&&"decimals"in e?t.toFixed(e.decimals):t+"")}if(t instanceof Array){if(!t.length)return r+"[]";var f=t.map(function(t){return u(t,"")}),$=r+"["+i+f.join(s)+i+"]";if(!1===e.wrap||$.length<=e.wrap)return $;if(e.short){var _=r+" "+i;return f=t.map(function(t){return u(t,_)}),f[0]=f[0].replace(_,r+"["+i),f[f.length-1]=f[f.length-1]+i+"]",f.join(",\n")}var _=r+e.indent;return r+"[\n"+t.map(function(t){return u(t,_)}).join(",\n")+"\n"+(e.indentLast?_:r)+"]"}if(t instanceof Object){var d=[],p=0,h=e.sort||e.sorted;for(var g in t){var m=d[p++]=[g,t[g]];!0===h?m[2]=g:"function"==typeof h&&(m[2]=h(g,t[g],t))}if(!d.length)return r+"{}";h&&(d=d.sort(function(t,e){return t=t[2],e=e[2],t<e?-1:t>e?1:0}));var v=d.map(function(t){return[JSON.stringify(t[0]),u(t[1],"")]});e.sorted&&(v=v.sort(function(t,e){return t=t[0],e=e[0],t<e?-1:t>e?1:0})),v=v.map(function(t){return t.join(c)}).join(s);var $=r+"{"+o+v+o+"}";if(!1===e.wrap||$.length<e.wrap)return $;if(e.short){if(v=d.map(function(t){return[r+" "+o+JSON.stringify(t[0]),t[1]]}),v[0][0]=v[0][0].replace(r+" ",r+"{"),e.aligned){for(var y=0,p=v.length;p--;)v[p][0].length>y&&(y=v[p][0].length);for(var b=n(" ",y),p=v.length;p--;)v[p][0]=a(b,v[p][0])}for(var p=v.length;p--;){var g=v[p][0],w=v[p][1],_=n(" ",(g+l).length),$=g+l+u(w,"");v[p]=!1===e.wrap||$.length<=e.wrap||!w||"object"!=typeof w?$:g+l+u(w,_).replace(/^\s+/,"")}return v.join(",\n")+o+"}"}var v=[],p=0;for(var g in t){var m=v[p++]=[r+e.indent+JSON.stringify(g),t[g]];!0===h?m[2]=g:"function"==typeof h&&(m[2]=h(g,t[g],t))}if(h&&(v=v.sort(function(t,e){return t=t[2],e=e[2],t<e?-1:t>e?1:0})),e.aligned){for(var y=0,p=v.length;p--;)v[p][0].length>y&&(y=v[p][0].length);for(var b=n(" ",y),p=v.length;p--;)v[p][0]=a(b,v[p][0])}for(var _=r+e.indent,p=v.length;p--;){var g=v[p][0],w=v[p][1],$=g+l+u(w,"");v[p]=!1===e.wrap||$.length<=e.wrap||!w||"object"!=typeof w?$:g+l+u(w,_).replace(/^\s+/,"")}return r+"{\n"+v.join(",\n")+"\n"+(e.indentLast?_:r)+"}"}return r+JSON.stringify(t)}function n(t,e){for(var r="";;){if(1&e&&(r+=t),!(e>>=1))break;t+=t}return r}function a(t,e){return(e+t).substring(0,t.length)}e=e||{},"wrap"in e||(e.wrap=80),1==e.wrap&&(e.wrap=-1),"indent"in e||(e.indent="  "),"arrayPadding"in e||(e.arrayPadding="padding"in e?e.padding:0),"objectPadding"in e||(e.objectPadding="padding"in e?e.padding:0),"beforeComma"in e||(e.beforeComma="aroundComma"in e?e.aroundComma:0),"afterComma"in e||(e.afterComma="aroundComma"in e?e.aroundComma:0),"beforeColon"in e||(e.beforeColon="aroundColon"in e?e.aroundColon:0),"afterColon"in e||(e.afterColon="aroundColon"in e?e.aroundColon:0),"beforeColon1"in e||(e.beforeColon1="aroundColon1"in e?e.aroundColon1:"beforeColon"in e?e.beforeColon:0),"afterColon1"in e||(e.afterColon1="aroundColon1"in e?e.aroundColon1:"afterColon"in e?e.afterColon:0),"beforeColonN"in e||(e.beforeColonN="aroundColonN"in e?e.aroundColonN:"beforeColon"in e?e.beforeColon:0),"afterColonN"in e||(e.afterColonN="aroundColonN"in e?e.aroundColonN:"afterColon"in e?e.afterColon:0);var i=n(" ",e.arrayPadding),o=n(" ",e.objectPadding),s=n(" ",e.beforeComma)+","+n(" ",e.afterComma),c=n(" ",e.beforeColon1)+":"+n(" ",e.afterColon1),l=n(" ",e.beforeColonN)+":"+n(" ",e.afterColonN),u=function(){var t=new Map;return function(e,n){var a=t.get(e);return a||t.set(e,a={}),a[n]||(a[n]=r(e,n)),a[n]}}();return u(t,"")}t.neatJSON=e,e.version="0.8.3"}(void 0===r?this:r)},{}],2:[function(t,e,r){"use strict";function n(t){return m.test(t)}function a(e){function r(t,e){var r;if("string"==typeof t){if(!(r=A(t)))throw new Error('no schema with key or ref "'+t+'"')}else{var n=C(t);r=n.validate||I(n)}var a=r(e);return!0===r.$async?"*"==M._opts.async?p(a):a:(M.errors=r.errors,a)}function h(t,e){var r=C(t,void 0,e);return r.validate||I(r)}function y(t,e,r,n){if(Array.isArray(t))for(var a=0;a<t.length;a++)y(t[a],void 0,r,n);else e=o.normalizeId(e||t.id),L(e),M._schemas[e]=C(t,r,n,!0)}function b(t,e,r){y(t,e,r,!0)}function w(t,e){var a=t.$schema||M._opts.defaultMeta||x(),i=M._formats.uri;M._formats.uri="function"==typeof i?n:m;var o;try{o=r(a,t)}finally{M._formats.uri=i}if(!o&&e){var s="schema is invalid: "+O();if("log"!=M._opts.validateSchema)throw new Error(s);console.error(s)}return o}function x(){var t=M._opts.meta;return M._opts.defaultMeta="object"==typeof t?t.id||t:M._opts.v5?$.META_SCHEMA_ID:g,M._opts.defaultMeta}function A(t){var e=E(t);switch(typeof e){case"object":return e.validate||I(e);case"string":return A(e);case"undefined":return k(t)}}function k(t){var e=o.schema.call(M,{schema:{}},t);if(e){var r=e.schema,n=e.root,a=e.baseId,s=i.call(M,r,n,void 0,a);return M._fragments[t]=new c({ref:t,fragment:!0,schema:r,root:n,baseId:a,validate:s}),s}}function E(t){return t=o.normalizeId(t),M._schemas[t]||M._refs[t]||M._fragments[t]}function S(t){if(t instanceof RegExp)return N(M._schemas,t),void N(M._refs,t);switch(typeof t){case"undefined":return N(M._schemas),N(M._refs),void M._cache.clear();case"string":var e=E(t);return e&&M._cache.del(e.jsonStr),delete M._schemas[t],void delete M._refs[t];case"object":var r=l(t);M._cache.del(r);var n=t.id;n&&(n=o.normalizeId(n),delete M._schemas[n],delete M._refs[n])}}function N(t,e){for(var r in t){var n=t[r];n.meta||e&&!e.test(r)||(M._cache.del(n.jsonStr),delete t[r])}}function C(t,e,r,n){if("object"!=typeof t)throw new Error("schema should be object");var a=l(t),i=M._cache.get(a);if(i)return i;n=n||!1!==M._opts.addUsedSchema;var s=o.normalizeId(t.id);s&&n&&L(s);var u,f=!1!==M._opts.validateSchema&&!e;f&&!(u=t.id&&t.id==t.$schema)&&w(t,!0);var $=o.ids.call(M,t),_=new c({id:s,schema:t,localRefs:$,jsonStr:a,meta:r});return"#"!=s[0]&&n&&(M._refs[s]=_),M._cache.put(a,_),f&&u&&w(t,!0),_}function I(t,e){function r(){var e=t.validate,n=e.apply(null,arguments);return r.errors=e.errors,n}if(t.compiling)return t.validate=r,r.schema=t.schema,r.errors=null,r.root=e||r,!0===t.schema.$async&&(r.$async=!0),r;t.compiling=!0;var n;t.meta&&(n=M._opts,M._opts=M._metaOpts);var a;try{a=i.call(M,t.schema,e,t.localRefs)}finally{t.compiling=!1,t.meta&&(M._opts=n)}return t.validate=a,t.refs=a.refs,t.refVal=a.refVal,t.root=a.root,a}function O(t,e){if(!(t=t||M.errors))return"No errors";e=e||{};for(var r=void 0===e.separator?", ":e.separator,n=void 0===e.dataVar?"data":e.dataVar,a="",i=0;i<t.length;i++){var o=t[i];o&&(a+=n+o.dataPath+" "+o.message+r)}return a.slice(0,-r.length)}function P(t,e){"string"==typeof e&&(e=new RegExp(e)),M._formats[t]=e}function L(t){if(M._schemas[t]||M._refs[t])throw new Error('schema with key or id "'+t+'" already exists')}if(!(this instanceof a))return new a(e);var M=this;e=this._opts=_.copy(e)||{},this._schemas={},this._refs={},this._fragments={},this._formats=u(e.format),this._cache=e.cache||new s,this._loadingSchemas={},this._compilations=[],this.RULES=f(),this.validate=r,this.compile=h,this.addSchema=y,this.addMetaSchema=b,this.validateSchema=w,this.getSchema=A,this.removeSchema=S,this.addFormat=P,this.errorsText=O,this._addSchema=C,this._compile=I,e.loopRequired=e.loopRequired||1/0,(e.async||e.transpile)&&d.setup(e),!0===e.beautify&&(e.beautify={indent_size:2}),"property"==e.errorDataPath&&(e._errorDataPathProperty=!0),this._metaOpts=function(){for(var t=_.copy(M._opts),e=0;e<v.length;e++)delete t[v[e]];return t}(),e.formats&&function(){for(var t in M._opts.formats)P(t,M._opts.formats[t])}(),function(){!1!==M._opts.meta&&(b(t("./refs/json-schema-draft-04.json"),g,!0),M._refs["http://json-schema.org/schema"]=g)}(),e.v5&&$.enable(this),"object"==typeof e.meta&&b(e.meta),function(){var t=M._opts.schemas;if(t)if(Array.isArray(t))y(t);else for(var e in t)y(t[e],e)}()}var i=t("./compile"),o=t("./compile/resolve"),s=t("./cache"),c=t("./compile/schema_obj"),l=t("json-stable-stringify"),u=t("./compile/formats"),f=t("./compile/rules"),$=t("./v5"),_=t("./compile/util"),d=t("./async"),p=t("co");e.exports=a,a.prototype.compileAsync=d.compile;var h=t("./keyword");a.prototype.addKeyword=h.add,a.prototype.getKeyword=h.get,a.prototype.removeKeyword=h.remove,a.ValidationError=t("./compile/validation_error");var g="http://json-schema.org/draft-04/schema",m=/^(?:(?:[a-z][a-z0-9+-.]*:)?\/\/)?[^\s]*$/i,v=["removeAdditional","useDefaults","coerceTypes"]},{"./async":3,"./cache":4,"./compile":8,"./compile/formats":7,"./compile/resolve":9,"./compile/rules":10,"./compile/schema_obj":11,"./compile/util":13,"./compile/validation_error":14,"./keyword":39,"./refs/json-schema-draft-04.json":40,"./v5":42,co:45,"json-stable-stringify":78}],3:[function(t,e,r){"use strict";function n(t,e){!1!==e&&(e=!0);var r,a=t.async,i=t.transpile;switch(typeof i){case"string":var o=p[i];if(!o)throw new Error("bad transpiler: "+i);return t._transpileFunc=o(t,e);case"undefined":case"boolean":if("string"==typeof a){if(!(r=d[a]))throw new Error("bad async mode: "+a);return t.transpile=r(t,e)}for(var s=0;s<h.length;s++){var c=h[s];if(n(c,!1))return _.copy(c,t),t.transpile}throw new Error("generators, nodent and regenerator are not available");case"function":return t._transpileFunc=t.transpile;default:throw new Error("bad transpiler: "+i)}}function a(t,e){try{return new Function("(function*(){})()")(),!0}catch(t){if(e)throw new Error("generators not supported")}}function i(t,e){try{return new Function("(async function(){})()")(),!0}catch(t){if(e)throw new Error("es7 async functions not supported")}}function o(e,r){try{if(!f){f=t("regenerator"),f.runtime()}return e.async&&!0!==e.async||(e.async="es7"),s}catch(t){if(r)throw new Error("regenerator not available")}}function s(t){return f.compile(t).code}function c(e,r){try{if(!$){$=t("nodent")({log:!1,dontInstallRequireHook:!0})}return"es7"!=e.async&&(e.async&&!0!==e.async&&console.warn("nodent transpiles only es7 async functions"),e.async="es7"),l}catch(t){if(r)throw new Error("nodent not available")}}function l(t){return $.compile(t,"",{promises:!0,sourcemap:!1}).code}function u(t,e){function r(t,e,n){function i(t,r){if(!n)return e(t,r);setTimeout(function(){e(t,r)})}var o;try{o=a.compile(t)}catch(n){return void(n.missingSchema?function(n){function i(n,i){if(n)return e(n);if(!a._refs[o]&&!a._schemas[o])try{a.addSchema(i,o)}catch(t){return void e(t)}r(t,e)}var o=n.missingSchema;if(a._refs[o]||a._schemas[o])return e(new Error("Schema "+o+" is loaded but "+n.missingRef+" cannot be resolved"));var s=a._loadingSchemas[o];s?"function"==typeof s?a._loadingSchemas[o]=[s,i]:s[s.length]=i:(a._loadingSchemas[o]=i,a._opts.loadSchema(o,function(t,e){var r=a._loadingSchemas[o];if(delete a._loadingSchemas[o],"function"==typeof r)r(t,e);else for(var n=0;n<r.length;n++)r[n](t,e)}))}(n):i(n))}i(null,o)}var n,a=this;try{n=this._addSchema(t)}catch(t){return void setTimeout(function(){e(t)})}if(n.validate)setTimeout(function(){e(null,n.validate)});else{if("function"!=typeof this._opts.loadSchema)throw new Error("options.loadSchema should be a function");r(t,e,!0)}}e.exports={setup:n,compile:u};var f,$,_=t("./compile/util"),d={"*":a,"co*":a,es7:i},p={nodent:c,regenerator:o},h=[{async:"co*"},{async:"es7",transpile:"nodent"},{async:"co*",transpile:"regenerator"}]},{"./compile/util":13}],4:[function(t,e,r){"use strict";var n=e.exports=function(){this._cache={}};n.prototype.put=function(t,e){this._cache[t]=e},n.prototype.get=function(t){return this._cache[t]},n.prototype.del=function(t){delete this._cache[t]},n.prototype.clear=function(){this._cache={}}},{}],5:[function(t,e,r){"use strict";e.exports={$ref:t("../dotjs/ref"),allOf:t("../dotjs/allOf"),anyOf:t("../dotjs/anyOf"),dependencies:t("../dotjs/dependencies"),enum:t("../dotjs/enum"),format:t("../dotjs/format"),items:t("../dotjs/items"),maximum:t("../dotjs/_limit"),minimum:t("../dotjs/_limit"),maxItems:t("../dotjs/_limitItems"),minItems:t("../dotjs/_limitItems"),maxLength:t("../dotjs/_limitLength"),minLength:t("../dotjs/_limitLength"),maxProperties:t("../dotjs/_limitProperties"),minProperties:t("../dotjs/_limitProperties"),multipleOf:t("../dotjs/multipleOf"),not:t("../dotjs/not"),oneOf:t("../dotjs/oneOf"),pattern:t("../dotjs/pattern"),properties:t("../dotjs/properties"),required:t("../dotjs/required"),uniqueItems:t("../dotjs/uniqueItems"),validate:t("../dotjs/validate")}},{"../dotjs/_limit":16,"../dotjs/_limitItems":17,"../dotjs/_limitLength":18,"../dotjs/_limitProperties":19,"../dotjs/allOf":20,"../dotjs/anyOf":21,"../dotjs/dependencies":24,"../dotjs/enum":25,"../dotjs/format":26,"../dotjs/items":27,"../dotjs/multipleOf":28,"../dotjs/not":29,"../dotjs/oneOf":30,"../dotjs/pattern":31,"../dotjs/properties":33,"../dotjs/ref":34,"../dotjs/required":35,"../dotjs/uniqueItems":37,"../dotjs/validate":38}],6:[function(t,e,r){"use strict";e.exports=function t(e,r){if(e===r)return!0;var n,a=Array.isArray(e),i=Array.isArray(r);if(a&&i){if(e.length!=r.length)return!1;for(n=0;n<e.length;n++)if(!t(e[n],r[n]))return!1;return!0}if(a!=i)return!1;if(e&&r&&"object"==typeof e&&"object"==typeof r){var o=Object.keys(e);if(o.length!==Object.keys(r).length)return!1;var s=e instanceof Date,c=r instanceof Date;if(s&&c)return e.getTime()==r.getTime();if(s!=c)return!1;var l=e instanceof RegExp,u=r instanceof RegExp;if(l&&u)return e.toString()==r.toString();if(l!=u)return!1;for(n=0;n<o.length;n++)if(!Object.prototype.hasOwnProperty.call(r,o[n]))return!1;for(n=0;n<o.length;n++)if(!t(e[o[n]],r[o[n]]))return!1;return!0}return!1}},{}],7:[function(t,e,r){"use strict";function n(t){t="full"==t?"full":"fast";var e=_.copy(n[t]);for(var r in n.compare)e[r]={validate:e[r],compare:n.compare[r]};return e}function a(t){var e=t.match(d);if(!e)return!1;var r=+e[1],n=+e[2];return r>=1&&r<=12&&n>=1&&n<=p[r]}function i(t,e){var r=t.match(h);if(!r)return!1;var n=r[1],a=r[2],i=r[3],o=r[5];return n<=23&&a<=59&&i<=59&&(!e||o)}function o(t){var e=t.split(w);return 2==e.length&&a(e[0])&&i(e[1],!0)}function s(t){return t.length<=255&&g.test(t)}function c(t){return x.test(t)&&m.test(t)}function l(t){try{return new RegExp(t),!0}catch(t){return!1}}function u(t,e){if(t&&e)return t>e?1:t<e?-1:t===e?0:void 0}function f(t,e){if(t&&e&&(t=t.match(h),e=e.match(h),t&&e))return t=t[1]+t[2]+t[3]+(t[4]||""),e=e[1]+e[2]+e[3]+(e[4]||""),t>e?1:t<e?-1:t===e?0:void 0}function $(t,e){if(t&&e){t=t.split(w),e=e.split(w);var r=u(t[0],e[0]);if(void 0!==r)return r||f(t[1],e[1])}}var _=t("./util"),d=/^\d\d\d\d-(\d\d)-(\d\d)$/,p=[0,31,29,31,30,31,30,31,31,30,31,30,31],h=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d:\d\d)?$/i,g=/^[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*$/i,m=/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@\/?]|%[0-9a-f]{2})*)?(?:\#(?:[a-z0-9\-._~!$&'()*+,;=:@\/?]|%[0-9a-f]{2})*)?$/i,v=/^(?:urn\:uuid\:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,y=/^(?:\/(?:[^~\/]|~0|~1)*)*$|^\#(?:\/(?:[a-z0-9_\-\.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,b=/^(?:0|[1-9][0-9]*)(?:\#|(?:\/(?:[^~\/]|~0|~1)*)*)$/;e.exports=n,n.fast={date:/^\d\d\d\d-[0-1]\d-[0-3]\d$/,time:/^[0-2]\d:[0-5]\d:[0-5]\d(?:\.\d+)?(?:z|[+-]\d\d:\d\d)?$/i,"date-time":/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s][0-2]\d:[0-5]\d:[0-5]\d(?:\.\d+)?(?:z|[+-]\d\d:\d\d)$/i,uri:/^(?:[a-z][a-z0-9+-.]*)?(?:\:|\/)\/?[^\s]*$/i,email:/^[a-z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i,hostname:g,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:l,uuid:v,"json-pointer":y,"relative-json-pointer":b},n.full={date:a,time:i,"date-time":o,uri:c,email:/^[a-z0-9!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&''*+\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:s,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:l,uuid:v,"json-pointer":y,"relative-json-pointer":b},n.compare={date:u,time:f,"date-time":$};var w=/t|\s/i,x=/\/|\:/},{"./util":13}],8:[function(t,e,r){"use strict";function n(){if(void 0===_){try{_=t("js-beautify").js_beautify}catch(t){_=!1}}}function a(t,e,r,s){function x(){var t=U.validate,e=t.apply(null,arguments);return x.errors=t.errors,e}function A(t,r,i,o){var s=!r||r&&r.schema==t;if(r.schema!=e.schema)return a.call(P,t,r,i,o);var h=!0===t.$async;h&&!L.transpile&&g.setup(L);var x=m({isTop:!0,schema:t,isRoot:s,baseId:o,root:r,schemaPath:"",errSchemaPath:"#",errorPath:'""',RULES:G,validate:m,util:p,resolve:d,resolveRef:k,usePattern:C,useDefault:I,useCustomRule:O,opts:L,formats:H,self:P});x=$(M,u)+$(B,c)+$(F,l)+$(q,f)+x,L.beautify&&(n(),_?x=_(x,L.beautify):console.error('"npm install js-beautify" to use beautify option'));var A,E,S=L._transpileFunc;try{E=h&&S?S(x):x;A=new Function("self","RULES","formats","root","refVal","defaults","customRules","co","equal","ucs2length","ValidationError",E)(P,G,H,e,M,F,q,v,b,y,w),M[0]=A}catch(t){throw console.error("Error compiling schema, function code:",E),t}return A.schema=t,A.errors=null,A.refs=T,A.refVal=M,A.root=s?A:r,h&&(A.$async=!0),D&&(A.sourceCode=x),!0===L.sourceCode&&(A.source={patterns:B,defaults:F}),A}function k(t,n,i){n=d.url(t,n);var o,s,c=T[n];if(void 0!==c)return o=M[c],s="refVal["+c+"]",N(o,s);if(!i&&e.refs){var l=e.refs[n];if(void 0!==l)return o=e.refVal[l],s=E(n,o),N(o,s)}s=E(n);var u=d.call(P,A,e,n);if(!u){var f=r&&r[n];f&&(u=d.inlineRef(f,L.inlineRefs)?f:a.call(P,f,e,r,t))}return u?(S(n,u),N(u,s)):void 0}function E(t,e){var r=M.length;return M[r]=e,T[t]=r,"refVal"+r}function S(t,e){var r=T[t];M[r]=e}function N(t,e){return"object"==typeof t?{code:e,schema:t,inline:!0}:{code:e,$async:t&&t.$async}}function C(t){var e=j[t];return void 0===e&&(e=j[t]=B.length,B[e]=t),"pattern"+e}function I(t){switch(typeof t){case"boolean":case"number":return""+t;case"string":return p.toQuotedString(t);case"object":if(null===t)return"null";var e=h(t),r=R[e];return void 0===r&&(r=R[e]=F.length,F[r]=t),"default"+r}}function O(t,e,r,n){var a=t.definition.validateSchema;if(a&&!1!==P._opts.validateSchema){if(!a(e)){var i="keyword schema is invalid: "+P.errorsText(a.errors);if("log"!=P._opts.validateSchema)throw new Error(i);console.error(i)}}var o,s=t.definition.compile,c=t.definition.inline,l=t.definition.macro;s?o=s.call(P,e,r,n):l?(o=l.call(P,e,r,n),!1!==L.validateSchema&&P.validateSchema(o,!0)):o=c?c.call(P,n,t.keyword,e,r):t.definition.validate;var u=q.length;return q[u]=o,{code:"customRule"+u,validate:o}}var P=this,L=this._opts,M=[void 0],T={},B=[],j={},F=[],R={},q=[],D=!1!==L.sourceCode;e=e||{schema:t,refVal:M,refs:T};var z=i.call(this,t,e,s),U=this._compilations[z.index];if(z.compiling)return U.callValidate=x;var H=this._formats,G=this.RULES;try{var Y=A(t,e,r,s);U.validate=Y;var V=U.callValidate;return V&&(V.schema=Y.schema,V.errors=null,V.refs=Y.refs,V.refVal=Y.refVal,V.root=Y.root,V.$async=Y.$async,D&&(V.sourceCode=Y.sourceCode)),Y}finally{o.call(this,t,e,s)}}function i(t,e,r){var n=s.call(this,t,e,r);return n>=0?{index:n,compiling:!0}:(n=this._compilations.length,this._compilations[n]={schema:t,root:e,baseId:r},{index:n,compiling:!1})}function o(t,e,r){var n=s.call(this,t,e,r);n>=0&&this._compilations.splice(n,1)}function s(t,e,r){for(var n=0;n<this._compilations.length;n++){var a=this._compilations[n];if(a.schema==t&&a.root==e&&a.baseId==r)return n}return-1}function c(t,e){return"var pattern"+t+" = new RegExp("+p.toQuotedString(e[t])+");"}function l(t){return"var default"+t+" = defaults["+t+"];"}function u(t,e){return e[t]?"var refVal"+t+" = refVal["+t+"];":""}function f(t){return"var customRule"+t+" = customRules["+t+"];"}function $(t,e){if(!t.length)return"";for(var r="",n=0;n<t.length;n++)r+=e(n,t);return r}var _,d=t("./resolve"),p=t("./util"),h=t("json-stable-stringify"),g=t("../async"),m=t("../dotjs/validate"),v=t("co"),y=p.ucs2length,b=t("./equal"),w=t("./validation_error");e.exports=a},{"../async":3,"../dotjs/validate":38,"./equal":6,"./resolve":9,"./util":13,"./validation_error":14,co:45,"json-stable-stringify":78}],9:[function(t,e,r){"use strict";function n(t,e,r){var i=this._refs[r];if("string"==typeof i){if(!this._refs[i])return n.call(this,t,e,i);i=this._refs[i]}if((i=i||this._schemas[r])instanceof m)return s(i.schema,this._opts.inlineRefs)?i.schema:i.validate||this._compile(i);var o,c,l,u=a.call(this,e,r);return u&&(o=u.schema,e=u.root,l=u.baseId),o instanceof m?c=o.validate||t.call(this,o.schema,e,void 0,l):o&&(c=s(o,this._opts.inlineRefs)?o:t.call(this,o,e,void 0,l)),c}function a(t,e){var r=p.parse(e,!1,!0),n=f(r),a=u(t.schema.id);if(n!==a){var s=$(n),c=this._refs[s];if("string"==typeof c)return i.call(this,t,c,r);if(c instanceof m)c.validate||this._compile(c),t=c;else{if(!((c=this._schemas[s])instanceof m))return;if(c.validate||this._compile(c),s==$(e))return{schema:c,root:t,baseId:a};t=c}if(!t.schema)return;a=u(t.schema.id)}return o.call(this,r,a,t.schema,t)}function i(t,e,r){var n=a.call(this,t,e);if(n){var i=n.schema,s=n.baseId;return t=n.root,i.id&&(s=_(s,i.id)),o.call(this,r,s,i,t)}}function o(t,e,r,n){if(t.hash=t.hash||"","#/"==t.hash.slice(0,2)){for(var i=t.hash.split("/"),o=1;o<i.length;o++){var s=i[o];if(s){if(s=g.unescapeFragment(s),!(r=r[s]))break;if(r.id&&!v[s]&&(e=_(e,r.id)),r.$ref){var c=_(e,r.$ref),l=a.call(this,n,c);l&&(r=l.schema,n=l.root,e=l.baseId)}}}return r&&r!=n.schema?{schema:r,root:n,baseId:e}:void 0}}function s(t,e){return!1!==e&&(void 0===e||!0===e?c(t):e?l(t)<=e:void 0)}function c(t){var e;if(Array.isArray(t)){for(var r=0;r<t.length;r++)if("object"==typeof(e=t[r])&&!c(e))return!1}else for(var n in t){if("$ref"==n)return!1;if("object"==typeof(e=t[n])&&!c(e))return!1}return!0}function l(t){var e,r=0;if(Array.isArray(t)){for(var n=0;n<t.length;n++)if(e=t[n],"object"==typeof e&&(r+=l(e)),r==1/0)return 1/0}else for(var a in t){if("$ref"==a)return 1/0;if(y[a])r++;else if(e=t[a],"object"==typeof e&&(r+=l(e)+1),r==1/0)return 1/0}return r}function u(t,e){return!1!==e&&(t=$(t)),f(p.parse(t,!1,!0))}function f(t){var e=t.protocol||"//"==t.href.slice(0,2)?"//":"";return(t.protocol||"")+e+(t.host||"")+(t.path||"")+"#"}function $(t){return t?t.replace(b,""):""}function _(t,e){return e=$(e),p.resolve(t,e)}function d(t){function e(t,r,a){if(Array.isArray(t))for(var i=0;i<t.length;i++)e.call(this,t[i],r+"/"+i,a);else if(t&&"object"==typeof t){if("string"==typeof t.id){var o=a=a?p.resolve(a,t.id):t.id;o=$(o);var s=this._refs[o];if("string"==typeof s&&(s=this._refs[s]),s&&s.schema){if(!h(t,s.schema))throw new Error('id "'+o+'" resolves to more than one schema')}else if(o!=$(r))if("#"==o[0]){if(n[o]&&!h(t,n[o]))throw new Error('id "'+o+'" resolves to more than one schema');n[o]=t}else this._refs[o]=r}for(var c in t)e.call(this,t[c],r+"/"+g.escapeFragment(c),a)}}var r=$(t.id),n={};return e.call(this,t,u(r,!1),r),n}var p=t("url"),h=t("./equal"),g=t("./util"),m=t("./schema_obj");e.exports=n,n.normalizeId=$,n.fullPath=u,n.url=_,n.ids=d,n.inlineRef=s,n.schema=a;var v=g.toHash(["properties","patternProperties","enum","dependencies","definitions"]),y=g.toHash(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum"]),b=/#\/?$/},{"./equal":6,"./schema_obj":11,"./util":13,url:void 0}],10:[function(t,e,r){"use strict";var n=t("./_rules"),a=t("./util").toHash;e.exports=function(){var t=[{type:"number",rules:["maximum","minimum","multipleOf"]},{type:"string",rules:["maxLength","minLength","pattern","format"]},{type:"array",rules:["maxItems","minItems","uniqueItems","items"]},{type:"object",rules:["maxProperties","minProperties","required","dependencies","properties"]},{rules:["$ref","enum","not","anyOf","oneOf","allOf"]}],e=["type","additionalProperties","patternProperties"],r=["additionalItems","$schema","id","title","description","default"],i=["number","integer","string","array","object","boolean","null"];return t.all=a(e),t.forEach(function(r){r.rules=r.rules.map(function(r){return e.push(r),t.all[r]={keyword:r,code:n[r]}})}),t.keywords=a(e.concat(r)),t.types=a(i),t.custom={},t}},{"./_rules":5,"./util":13}],11:[function(t,e,r){"use strict";function n(t){a.copy(t,this)}var a=t("./util");e.exports=n},{"./util":13}],12:[function(t,e,r){"use strict";e.exports=function(t){for(var e,r=0,n=t.length,a=0;a<n;)r++,(e=t.charCodeAt(a++))>=55296&&e<=56319&&a<n&&56320==(64512&(e=t.charCodeAt(a)))&&a++;return r}},{}],13:[function(t,e,r){"use strict";function n(t,e){e=e||{};for(var r in t)e[r]=t[r];return e}function a(t,e,r){var n=r?" !== ":" === ",a=r?" || ":" && ",i=r?"!":"",o=r?"":"!";switch(t){case"null":return e+n+"null";case"array":return i+"Array.isArray("+e+")";case"object":return"("+i+e+a+"typeof "+e+n+'"object"'+a+o+"Array.isArray("+e+"))";case"integer":return"(typeof "+e+n+'"number"'+a+o+"("+e+" % 1)"+a+e+n+e+")";default:return"typeof "+e+n+'"'+t+'"'}}function i(t,e){switch(t.length){case 1:return a(t[0],e,!0);default:var r="",n=s(t);n.array&&n.object&&(r=n.null?"(":"(!"+e+" || ",r+="typeof "+e+' !== "object")',delete n.null,delete n.array,delete n.object),n.number&&delete n.integer;for(var i in n)r+=(r?" && ":"")+a(i,e,!0);return r}}function o(t,e){if(Array.isArray(e)){for(var r=[],n=0;n<e.length;n++){var a=e[n];k[a]?r[r.length]=a:"array"===t&&"array"===a&&(r[r.length]=a)}if(r.length)return r}else{if(k[e])return[e];if("array"===t&&"array"===e)return["array"]}}function s(t){for(var e={},r=0;r<t.length;r++)e[t[r]]=!0;return e}function c(t){return"number"==typeof t?"["+t+"]":E.test(t)?"."+t:"['"+l(t)+"']"}function l(t){return t.replace(S,"\\$&").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\f/g,"\\f").replace(/\t/g,"\\t")}function u(t,e){e+="[^0-9]";var r=t.match(new RegExp(e,"g"));return r?r.length:0}function f(t,e,r){return e+="([^0-9])",r=r.replace(/\$/g,"$$$$"),t.replace(new RegExp(e,"g"),r+"$1")}function $(t){return t.replace(N,"").replace(C,"").replace(I,"if (!($1))")}function _(t,e){var r=t.match(O);return r&&2===r.length?e?t.replace(L,"").replace(B,j):t.replace(P,"").replace(M,T):t}function d(t,e){for(var r in t)if(e[r])return!0}function p(t,e,r){for(var n in t)if(n!=r&&e[n])return!0}function h(t){return"'"+l(t)+"'"}function g(t,e,r,n){return y(t,r?"'/' + "+e+(n?"":".replace(/~/g, '~0').replace(/\\//g, '~1')"):n?"'[' + "+e+" + ']'":"'[\\'' + "+e+" + '\\']'")}function m(t,e,r){return y(t,h(r?"/"+x(e):c(e)))}function v(t,e,r){var n,a,i,o;if(""===t)return"rootData";if("/"==t[0]){if(!F.test(t))throw new Error("Invalid JSON-pointer: "+t);a=t,i="rootData"}else{if(!(o=t.match(R)))throw new Error("Invalid JSON-pointer: "+t);if(n=+o[1],"#"==(a=o[2])){if(n>=e)throw new Error("Cannot access property/index "+n+" levels up, current level is "+e);return r[e-n]}if(n>e)throw new Error("Cannot access data "+n+" levels up, current level is "+e);if(i="data"+(e-n||""),!a)return i}for(var s=i,l=a.split("/"),u=0;u<l.length;u++){var f=l[u];f&&(i+=c(A(f)),s+=" && "+i)}return s}function y(t,e){return'""'==t?e:(t+" + "+e).replace(/' \+ '/g,"")}function b(t){return A(decodeURIComponent(t))}function w(t){return encodeURIComponent(x(t))}function x(t){return t.replace(/~/g,"~0").replace(/\//g,"~1")}function A(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}e.exports={copy:n,checkDataType:a,checkDataTypes:i,coerceToTypes:o,toHash:s,getProperty:c,escapeQuotes:l,ucs2length:t("./ucs2length"),varOccurences:u,varReplace:f,cleanUpCode:$,cleanUpVarErrors:_,schemaHasRules:d,schemaHasRulesExcept:p,stableStringify:t("json-stable-stringify"),toQuotedString:h,getPathExpr:g,getPath:m,getData:v,unescapeFragment:b,escapeFragment:w,escapeJsonPointer:x};var k=s(["string","number","integer","boolean","null"]),E=/^[a-z$_][a-z$_0-9]*$/i,S=/'|\\/g,N=/else\s*{\s*}/g,C=/if\s*\([^)]+\)\s*\{\s*\}(?!\s*else)/g,I=/if\s*\(([^)]+)\)\s*\{\s*\}\s*else(?!\s*if)/g,O=/[^v\.]errors/g,P=/var errors = 0;|var vErrors = null;|validate.errors = vErrors;/g,L=/var errors = 0;|var vErrors = null;/g,M="return errors === 0;",T="validate.errors = null; return true;",B=/if \(errors === 0\) return true;\s*else throw new ValidationError\(vErrors\);/,j="return true;",F=/^\/(?:[^~]|~0|~1)*$/,R=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/},{"./ucs2length":12,"json-stable-stringify":78}],14:[function(t,e,r){"use strict";function n(t){this.message="validation failed",this.errors=t,
this.ajv=this.validation=!0}e.exports=n,n.prototype=Object.create(Error.prototype),n.prototype.constructor=n},{}],15:[function(t,e,r){"use strict";e.exports=function(t,e){var r,n=" ",a=t.level,i=t.dataLevel,o=t.schema[e],s=t.schemaPath+t.util.getProperty(e),c=t.errSchemaPath+"/"+e,l=!t.opts.allErrors,u="data"+(i||""),f="valid"+a;if(n+="var "+f+" = undefined;",!1===t.opts.format)return n+=" "+f+" = true; ";var $=t.schema.format,_=t.opts.v5&&$.$data,d="";if(_){var p=t.util.getData($.$data,i,t.dataPathArr),h="format"+a,g="compare"+a;n+=" var "+h+" = formats["+p+"] , "+g+" = "+h+" && "+h+".compare;"}else{var h=t.formats[$];if(!h||!h.compare)return n+="  "+f+" = true; ";var g="formats"+t.util.getProperty($)+".compare"}var m,v="formatMaximum"==e,y="formatExclusive"+(v?"Maximum":"Minimum"),b=t.schema[y],w=t.opts.v5&&b&&b.$data,x=v?"<":">",A="result"+a,k=t.opts.v5&&o&&o.$data;if(k?(n+=" var schema"+a+" = "+t.util.getData(o.$data,i,t.dataPathArr)+"; ",m="schema"+a):m=o,w){var E=t.util.getData(b.$data,i,t.dataPathArr),S="exclusive"+a,N="op"+a,C="' + "+N+" + '";n+=" var schemaExcl"+a+" = "+E+"; ",E="schemaExcl"+a,n+=" if (typeof "+E+" != 'boolean' && "+E+" !== undefined) { "+f+" = false; ";var r=y,I=I||[];I.push(n),n="",!1!==t.createErrors?(n+=" { keyword: '"+(r||"_formatExclusiveLimit")+"' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(c)+" , params: {} ",!1!==t.opts.messages&&(n+=" , message: '"+y+" should be boolean' "),t.opts.verbose&&(n+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+u+" "),n+=" } "):n+=" {} ";var O=n;n=I.pop(),!t.compositeRule&&l?t.async?n+=" throw new ValidationError(["+O+"]); ":n+=" validate.errors = ["+O+"]; return false; ":n+=" var err = "+O+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" }  ",l&&(d+="}",n+=" else { "),k&&(n+=" if ("+m+" === undefined) "+f+" = true; else if (typeof "+m+" != 'string') "+f+" = false; else { ",d+="}"),_&&(n+=" if (!"+g+") "+f+" = true; else { ",d+="}"),n+=" var "+A+" = "+g+"("+u+",  ",n+=k?""+m:""+t.util.toQuotedString(o),n+=" ); if ("+A+" === undefined) "+f+" = false; var "+S+" = "+E+" === true; if ("+f+" === undefined) { "+f+" = "+S+" ? "+A+" "+x+" 0 : "+A+" "+x+"= 0; } if (!"+f+") var op"+a+" = "+S+" ? '"+x+"' : '"+x+"=';"}else{var S=!0===b,C=x;S||(C+="=");var N="'"+C+"'";k&&(n+=" if ("+m+" === undefined) "+f+" = true; else if (typeof "+m+" != 'string') "+f+" = false; else { ",d+="}"),_&&(n+=" if (!"+g+") "+f+" = true; else { ",d+="}"),n+=" var "+A+" = "+g+"("+u+",  ",n+=k?""+m:""+t.util.toQuotedString(o),n+=" ); if ("+A+" === undefined) "+f+" = false; if ("+f+" === undefined) "+f+" = "+A+" "+x,S||(n+="="),n+=" 0;"}n+=d+"if (!"+f+") { ";var r=e,I=I||[];I.push(n),n="",!1!==t.createErrors?(n+=" { keyword: '"+(r||"_formatLimit")+"' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(c)+" , params: { comparison: "+N+", limit:  ",n+=k?""+m:""+t.util.toQuotedString(o),n+=" , exclusive: "+S+" } ",!1!==t.opts.messages&&(n+=" , message: 'should be "+C+' "',n+=k?"' + "+m+" + '":""+t.util.escapeQuotes(o),n+="\"' "),t.opts.verbose&&(n+=" , schema:  ",n+=k?"validate.schema"+s:""+t.util.toQuotedString(o),n+="         , parentSchema: validate.schema"+t.schemaPath+" , data: "+u+" "),n+=" } "):n+=" {} ";var O=n;return n=I.pop(),!t.compositeRule&&l?t.async?n+=" throw new ValidationError(["+O+"]); ":n+=" validate.errors = ["+O+"]; return false; ":n+=" var err = "+O+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+="}"}},{}],16:[function(t,e,r){"use strict";e.exports=function(t,e){var r,n,a=" ",i=t.level,o=t.dataLevel,s=t.schema[e],c=t.schemaPath+t.util.getProperty(e),l=t.errSchemaPath+"/"+e,u=!t.opts.allErrors,f="data"+(o||""),$=t.opts.v5&&s&&s.$data;$?(a+=" var schema"+i+" = "+t.util.getData(s.$data,o,t.dataPathArr)+"; ",n="schema"+i):n=s;var _="maximum"==e,d=_?"exclusiveMaximum":"exclusiveMinimum",p=t.schema[d],h=t.opts.v5&&p&&p.$data,g=_?"<":">",m=_?">":"<";if(h){var v=t.util.getData(p.$data,o,t.dataPathArr),y="exclusive"+i,b="op"+i,w="' + "+b+" + '";a+=" var schemaExcl"+i+" = "+v+"; ",v="schemaExcl"+i,a+=" var exclusive"+i+"; if (typeof "+v+" != 'boolean' && typeof "+v+" != 'undefined') { ";var r=d,x=x||[];x.push(a),a="",!1!==t.createErrors?(a+=" { keyword: '"+(r||"_exclusiveLimit")+"' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(l)+" , params: {} ",!1!==t.opts.messages&&(a+=" , message: '"+d+" should be boolean' "),t.opts.verbose&&(a+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+f+" "),a+=" } "):a+=" {} ";var A=a;a=x.pop(),!t.compositeRule&&u?t.async?a+=" throw new ValidationError(["+A+"]); ":a+=" validate.errors = ["+A+"]; return false; ":a+=" var err = "+A+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",a+=" } else if( ",$&&(a+=" ("+n+" !== undefined && typeof "+n+" != 'number') || "),a+=" ((exclusive"+i+" = "+v+" === true) ? "+f+" "+m+"= "+n+" : "+f+" "+m+" "+n+") || "+f+" !== "+f+") { var op"+i+" = exclusive"+i+" ? '"+g+"' : '"+g+"=';"}else{var y=!0===p,w=g;y||(w+="=");var b="'"+w+"'";a+=" if ( ",$&&(a+=" ("+n+" !== undefined && typeof "+n+" != 'number') || "),a+=" "+f+" "+m,y&&(a+="="),a+=" "+n+" || "+f+" !== "+f+") {"}var r=e,x=x||[];x.push(a),a="",!1!==t.createErrors?(a+=" { keyword: '"+(r||"_limit")+"' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(l)+" , params: { comparison: "+b+", limit: "+n+", exclusive: "+y+" } ",!1!==t.opts.messages&&(a+=" , message: 'should be "+w+" ",a+=$?"' + "+n:s+"'"),t.opts.verbose&&(a+=" , schema:  ",a+=$?"validate.schema"+c:""+s,a+="         , parentSchema: validate.schema"+t.schemaPath+" , data: "+f+" "),a+=" } "):a+=" {} ";var A=a;return a=x.pop(),!t.compositeRule&&u?t.async?a+=" throw new ValidationError(["+A+"]); ":a+=" validate.errors = ["+A+"]; return false; ":a+=" var err = "+A+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",a+=" } ",u&&(a+=" else { "),a}},{}],17:[function(t,e,r){"use strict";e.exports=function(t,e){var r,n,a=" ",i=t.level,o=t.dataLevel,s=t.schema[e],c=t.schemaPath+t.util.getProperty(e),l=t.errSchemaPath+"/"+e,u=!t.opts.allErrors,f="data"+(o||""),$=t.opts.v5&&s&&s.$data;$?(a+=" var schema"+i+" = "+t.util.getData(s.$data,o,t.dataPathArr)+"; ",n="schema"+i):n=s;var _="maxItems"==e?">":"<";a+="if ( ",$&&(a+=" ("+n+" !== undefined && typeof "+n+" != 'number') || "),a+=" "+f+".length "+_+" "+n+") { ";var r=e,d=d||[];d.push(a),a="",!1!==t.createErrors?(a+=" { keyword: '"+(r||"_limitItems")+"' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(l)+" , params: { limit: "+n+" } ",!1!==t.opts.messages&&(a+=" , message: 'should NOT have ",a+="maxItems"==e?"more":"less",a+=" than ",a+=$?"' + "+n+" + '":""+s,a+=" items' "),t.opts.verbose&&(a+=" , schema:  ",a+=$?"validate.schema"+c:""+s,a+="         , parentSchema: validate.schema"+t.schemaPath+" , data: "+f+" "),a+=" } "):a+=" {} ";var p=a;return a=d.pop(),!t.compositeRule&&u?t.async?a+=" throw new ValidationError(["+p+"]); ":a+=" validate.errors = ["+p+"]; return false; ":a+=" var err = "+p+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",a+="} ",u&&(a+=" else { "),a}},{}],18:[function(t,e,r){"use strict";e.exports=function(t,e){var r,n,a=" ",i=t.level,o=t.dataLevel,s=t.schema[e],c=t.schemaPath+t.util.getProperty(e),l=t.errSchemaPath+"/"+e,u=!t.opts.allErrors,f="data"+(o||""),$=t.opts.v5&&s&&s.$data;$?(a+=" var schema"+i+" = "+t.util.getData(s.$data,o,t.dataPathArr)+"; ",n="schema"+i):n=s;var _="maxLength"==e?">":"<";a+="if ( ",$&&(a+=" ("+n+" !== undefined && typeof "+n+" != 'number') || "),!1===t.opts.unicode?a+=" "+f+".length ":a+=" ucs2length("+f+") ",a+=" "+_+" "+n+") { ";var r=e,d=d||[];d.push(a),a="",!1!==t.createErrors?(a+=" { keyword: '"+(r||"_limitLength")+"' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(l)+" , params: { limit: "+n+" } ",!1!==t.opts.messages&&(a+=" , message: 'should NOT be ",a+="maxLength"==e?"longer":"shorter",a+=" than ",a+=$?"' + "+n+" + '":""+s,a+=" characters' "),t.opts.verbose&&(a+=" , schema:  ",a+=$?"validate.schema"+c:""+s,a+="         , parentSchema: validate.schema"+t.schemaPath+" , data: "+f+" "),a+=" } "):a+=" {} ";var p=a;return a=d.pop(),!t.compositeRule&&u?t.async?a+=" throw new ValidationError(["+p+"]); ":a+=" validate.errors = ["+p+"]; return false; ":a+=" var err = "+p+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",a+="} ",u&&(a+=" else { "),a}},{}],19:[function(t,e,r){"use strict";e.exports=function(t,e){var r,n,a=" ",i=t.level,o=t.dataLevel,s=t.schema[e],c=t.schemaPath+t.util.getProperty(e),l=t.errSchemaPath+"/"+e,u=!t.opts.allErrors,f="data"+(o||""),$=t.opts.v5&&s&&s.$data;$?(a+=" var schema"+i+" = "+t.util.getData(s.$data,o,t.dataPathArr)+"; ",n="schema"+i):n=s;var _="maxProperties"==e?">":"<";a+="if ( ",$&&(a+=" ("+n+" !== undefined && typeof "+n+" != 'number') || "),a+=" Object.keys("+f+").length "+_+" "+n+") { ";var r=e,d=d||[];d.push(a),a="",!1!==t.createErrors?(a+=" { keyword: '"+(r||"_limitProperties")+"' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(l)+" , params: { limit: "+n+" } ",!1!==t.opts.messages&&(a+=" , message: 'should NOT have ",a+="maxProperties"==e?"more":"less",a+=" than ",a+=$?"' + "+n+" + '":""+s,a+=" properties' "),t.opts.verbose&&(a+=" , schema:  ",a+=$?"validate.schema"+c:""+s,a+="         , parentSchema: validate.schema"+t.schemaPath+" , data: "+f+" "),a+=" } "):a+=" {} ";var p=a;return a=d.pop(),!t.compositeRule&&u?t.async?a+=" throw new ValidationError(["+p+"]); ":a+=" validate.errors = ["+p+"]; return false; ":a+=" var err = "+p+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",a+="} ",u&&(a+=" else { "),a}},{}],20:[function(t,e,r){"use strict";e.exports=function(t,e){var r=" ",n=t.schema[e],a=t.schemaPath+t.util.getProperty(e),i=t.errSchemaPath+"/"+e,o=!t.opts.allErrors,s=t.util.copy(t),c="";s.level++;var l="valid"+s.level,u=s.baseId,f=!0,$=n;if($)for(var _,d=-1,p=$.length-1;d<p;)_=$[d+=1],t.util.schemaHasRules(_,t.RULES.all)&&(f=!1,s.schema=_,s.schemaPath=a+"["+d+"]",s.errSchemaPath=i+"/"+d,r+="  "+t.validate(s)+" ",s.baseId=u,o&&(r+=" if ("+l+") { ",c+="}"));return o&&(r+=f?" if (true) { ":" "+c.slice(0,-1)+" "),r=t.util.cleanUpCode(r)}},{}],21:[function(t,e,r){"use strict";e.exports=function(t,e){var r=" ",n=t.level,a=t.dataLevel,i=t.schema[e],o=t.schemaPath+t.util.getProperty(e),s=t.errSchemaPath+"/"+e,c=!t.opts.allErrors,l="data"+(a||""),u="valid"+n,f="errs__"+n,$=t.util.copy(t),_="";$.level++;var d="valid"+$.level;if(i.every(function(e){return t.util.schemaHasRules(e,t.RULES.all)})){var p=$.baseId;r+=" var "+f+" = errors; var "+u+" = false;  ";var h=t.compositeRule;t.compositeRule=$.compositeRule=!0;var g=i;if(g)for(var m,v=-1,y=g.length-1;v<y;)m=g[v+=1],$.schema=m,$.schemaPath=o+"["+v+"]",$.errSchemaPath=s+"/"+v,r+="  "+t.validate($)+" ",$.baseId=p,r+=" "+u+" = "+u+" || "+d+"; if (!"+u+") { ",_+="}";t.compositeRule=$.compositeRule=h,r+=" "+_+" if (!"+u+") {  var err =   ",!1!==t.createErrors?(r+=" { keyword: 'anyOf' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(s)+" , params: {} ",!1!==t.opts.messages&&(r+=" , message: 'should match some schema in anyOf' "),t.opts.verbose&&(r+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } else {  errors = "+f+"; if (vErrors !== null) { if ("+f+") vErrors.length = "+f+"; else vErrors = null; } ",t.opts.allErrors&&(r+=" } "),r=t.util.cleanUpCode(r)}else c&&(r+=" if (true) { ");return r}},{}],22:[function(t,e,r){"use strict";e.exports=function(t,e){var r=" ",n=t.level,a=t.dataLevel,i=t.schema[e],o=t.schemaPath+t.util.getProperty(e),s=t.errSchemaPath+"/"+e,c=!t.opts.allErrors,l="data"+(a||""),u="valid"+n,f=t.opts.v5&&i&&i.$data;f&&(r+=" var schema"+n+" = "+t.util.getData(i.$data,a,t.dataPathArr)+"; "),f||(r+=" var schema"+n+" = validate.schema"+o+";"),r+="var "+u+" = equal("+l+", schema"+n+"); if (!"+u+") {   ";var $=$||[];$.push(r),r="",!1!==t.createErrors?(r+=" { keyword: 'constant' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(s)+" , params: {} ",!1!==t.opts.messages&&(r+=" , message: 'should be equal to constant' "),t.opts.verbose&&(r+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ";var _=r;return r=$.pop(),!t.compositeRule&&c?t.async?r+=" throw new ValidationError(["+_+"]); ":r+=" validate.errors = ["+_+"]; return false; ":r+=" var err = "+_+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" }"}},{}],23:[function(t,e,r){"use strict";e.exports=function(t,e){var r,n,a=" ",i=t.level,o=t.dataLevel,s=t.schema[e],c=t.schemaPath+t.util.getProperty(e),l=t.errSchemaPath+"/"+e,u=!t.opts.allErrors,f="data"+(o||""),$="valid"+i,_="errs__"+i,d=t.opts.v5&&s&&s.$data;d?(a+=" var schema"+i+" = "+t.util.getData(s.$data,o,t.dataPathArr)+"; ",n="schema"+i):n=s;var p,h,g,m,v,y=this,b="definition"+i,w=y.definition;if(d&&w.$data){v="keywordValidate"+i;var x=w.validateSchema;a+=" var "+b+" = RULES.custom['"+e+"'].definition; var "+v+" = "+b+".validate;"}else m=t.useCustomRule(y,s,t.schema,t),n="validate.schema"+c,v=m.code,p=w.compile,h=w.inline,g=w.macro;var A=v+".errors",k="i"+i,E="ruleErr"+i,S=w.async;if(S&&!t.async)throw new Error("async keyword in sync schema");if(h||g||(a+=A+" = null;"),a+="var "+_+" = errors;var "+$+";",x&&(a+=" "+$+" = "+b+".validateSchema("+n+"); if ("+$+") {"),h)w.statements?a+=" "+m.validate+" ":a+=" "+$+" = "+m.validate+"; ";else if(g){var N=t.util.copy(t);N.level++;var C="valid"+N.level;N.schema=m.validate,N.schemaPath="";var I=t.compositeRule;t.compositeRule=N.compositeRule=!0;var O=t.validate(N).replace(/validate\.schema/g,v);t.compositeRule=N.compositeRule=I,a+=" "+O}else{var P=P||[];P.push(a),a="",a+="  "+v+".call( ",t.opts.passContext?a+="this":a+="self",p||!1===w.schema?a+=" , "+f+" ":a+=" , "+n+" , "+f+" , validate.schema"+t.schemaPath+" ",a+=" , (dataPath || '')",'""'!=t.errorPath&&(a+=" + "+t.errorPath);var L=o?"data"+(o-1||""):"parentData",M=o?t.dataPathArr[o]:"parentDataProperty";a+=" , "+L+" , "+M+" , rootData )  ";var T=a;a=P.pop(),!1===w.errors?(a+=" "+$+" = ",S&&(a+=""+t.yieldAwait),a+=T+"; "):S?(A="customErrors"+i,a+=" var "+A+" = null; try { "+$+" = "+t.yieldAwait+T+"; } catch (e) { "+$+" = false; if (e instanceof ValidationError) "+A+" = e.errors; else throw e; } "):a+=" "+A+" = null; "+$+" = "+T+"; "}if(w.modifying&&(a+=" "+f+" = "+L+"["+M+"];"),x&&(a+=" }"),w.valid)u&&(a+=" if (true) { ");else{a+=" if ( ",void 0===w.valid?(a+=" !",a+=g?""+C:""+$):a+=" "+!w.valid+" ",a+=") { ",r=y.keyword;var P=P||[];P.push(a),a="";var P=P||[];P.push(a),a="",!1!==t.createErrors?(a+=" { keyword: '"+(r||"custom")+"' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(l)+" , params: { keyword: '"+y.keyword+"' } ",!1!==t.opts.messages&&(a+=" , message: 'should pass \""+y.keyword+"\" keyword validation' "),t.opts.verbose&&(a+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+f+" "),a+=" } "):a+=" {} ";var B=a;a=P.pop(),!t.compositeRule&&u?t.async?a+=" throw new ValidationError(["+B+"]); ":a+=" validate.errors = ["+B+"]; return false; ":a+=" var err = "+B+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";var j=a;a=P.pop(),h?w.errors?"full"!=w.errors&&(a+="  for (var "+k+"="+_+"; "+k+"<errors; "+k+"++) { var "+E+" = vErrors["+k+"]; if ("+E+".dataPath === undefined) "+E+".dataPath = (dataPath || '') + "+t.errorPath+"; if ("+E+".schemaPath === undefined) { "+E+'.schemaPath = "'+l+'"; } ',t.opts.verbose&&(a+=" "+E+".schema = "+n+"; "+E+".data = "+f+"; "),a+=" } "):!1===w.errors?a+=" "+j+" ":(a+=" if ("+_+" == errors) { "+j+" } else {  for (var "+k+"="+_+"; "+k+"<errors; "+k+"++) { var "+E+" = vErrors["+k+"]; if ("+E+".dataPath === undefined) "+E+".dataPath = (dataPath || '') + "+t.errorPath+"; if ("+E+".schemaPath === undefined) { "+E+'.schemaPath = "'+l+'"; } ',t.opts.verbose&&(a+=" "+E+".schema = "+n+"; "+E+".data = "+f+"; "),a+=" } } "):g?(a+="   var err =   ",!1!==t.createErrors?(a+=" { keyword: '"+(r||"custom")+"' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(l)+" , params: { keyword: '"+y.keyword+"' } ",!1!==t.opts.messages&&(a+=" , message: 'should pass \""+y.keyword+"\" keyword validation' "),t.opts.verbose&&(a+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+f+" "),a+=" } "):a+=" {} ",a+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!t.compositeRule&&u&&(t.async?a+=" throw new ValidationError(vErrors); ":a+=" validate.errors = vErrors; return false; ")):!1===w.errors?a+=" "+j+" ":(a+=" if (Array.isArray("+A+")) { if (vErrors === null) vErrors = "+A+"; else vErrors = vErrors.concat("+A+"); errors = vErrors.length;  for (var "+k+"="+_+"; "+k+"<errors; "+k+"++) { var "+E+" = vErrors["+k+"]; if ("+E+".dataPath === undefined) "+E+".dataPath = (dataPath || '') + "+t.errorPath+";  "+E+'.schemaPath = "'+l+'";  ',t.opts.verbose&&(a+=" "+E+".schema = "+n+"; "+E+".data = "+f+"; "),a+=" } } else { "+j+" } "),a+=" } ",u&&(a+=" else { ")}return a}},{}],24:[function(t,e,r){"use strict";e.exports=function(t,e){var r=" ",n=t.level,a=t.dataLevel,i=t.schema[e],o=t.schemaPath+t.util.getProperty(e),s=t.errSchemaPath+"/"+e,c=!t.opts.allErrors,l="data"+(a||""),u="errs__"+n,f=t.util.copy(t),$="";f.level++;var _="valid"+f.level,d={},p={};for(v in i){var h=i[v],g=Array.isArray(h)?p:d;g[v]=h}r+="var "+u+" = errors;";var m=t.errorPath;r+="var missing"+n+";";for(var v in p){if(g=p[v],r+=" if ("+l+t.util.getProperty(v)+" !== undefined ",c){r+=" && ( ";var y=g;if(y)for(var b,w=-1,x=y.length-1;w<x;){b=y[w+=1],w&&(r+=" || ");var A=t.util.getProperty(b);r+=" ( "+l+A+" === undefined && (missing"+n+" = "+t.util.toQuotedString(t.opts.jsonPointers?b:A)+") ) "}r+=")) {  ";var k="missing"+n,E="' + "+k+" + '";t.opts._errorDataPathProperty&&(t.errorPath=t.opts.jsonPointers?t.util.getPathExpr(m,k,!0):m+" + "+k);var S=S||[];S.push(r),r="",!1!==t.createErrors?(r+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(s)+" , params: { property: '"+t.util.escapeQuotes(v)+"', missingProperty: '"+E+"', depsCount: "+g.length+", deps: '"+t.util.escapeQuotes(1==g.length?g[0]:g.join(", "))+"' } ",!1!==t.opts.messages&&(r+=" , message: 'should have ",1==g.length?r+="property "+t.util.escapeQuotes(g[0]):r+="properties "+t.util.escapeQuotes(g.join(", ")),r+=" when property "+t.util.escapeQuotes(v)+" is present' "),t.opts.verbose&&(r+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ";var N=r;r=S.pop(),!t.compositeRule&&c?t.async?r+=" throw new ValidationError(["+N+"]); ":r+=" validate.errors = ["+N+"]; return false; ":r+=" var err = "+N+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else{r+=" ) { ";var C=g;if(C)for(var I,O=-1,P=C.length-1;O<P;){I=C[O+=1];var A=t.util.getProperty(I),E=t.util.escapeQuotes(I);t.opts._errorDataPathProperty&&(t.errorPath=t.util.getPath(m,I,t.opts.jsonPointers)),r+=" if ("+l+A+" === undefined) {  var err =   ",!1!==t.createErrors?(r+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(s)+" , params: { property: '"+t.util.escapeQuotes(v)+"', missingProperty: '"+E+"', depsCount: "+g.length+", deps: '"+t.util.escapeQuotes(1==g.length?g[0]:g.join(", "))+"' } ",!1!==t.opts.messages&&(r+=" , message: 'should have ",1==g.length?r+="property "+t.util.escapeQuotes(g[0]):r+="properties "+t.util.escapeQuotes(g.join(", ")),r+=" when property "+t.util.escapeQuotes(v)+" is present' "),t.opts.verbose&&(r+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}r+=" }   ",c&&($+="}",r+=" else { ")}t.errorPath=m;var L=f.baseId;for(var v in d){var h=d[v];t.util.schemaHasRules(h,t.RULES.all)&&(r+=" "+_+" = true; if ("+l+t.util.getProperty(v)+" !== undefined) { ",f.schema=h,f.schemaPath=o+t.util.getProperty(v),f.errSchemaPath=s+"/"+t.util.escapeFragment(v),r+="  "+t.validate(f)+" ",f.baseId=L,r+=" }  ",c&&(r+=" if ("+_+") { ",$+="}"))}return c&&(r+="   "+$+" if ("+u+" == errors) {"),r=t.util.cleanUpCode(r)}},{}],25:[function(t,e,r){"use strict";e.exports=function(t,e){var r=" ",n=t.level,a=t.dataLevel,i=t.schema[e],o=t.schemaPath+t.util.getProperty(e),s=t.errSchemaPath+"/"+e,c=!t.opts.allErrors,l="data"+(a||""),u="valid"+n,f=t.opts.v5&&i&&i.$data;f&&(r+=" var schema"+n+" = "+t.util.getData(i.$data,a,t.dataPathArr)+"; ");var $="i"+n,_="schema"+n;f||(r+=" var "+_+" = validate.schema"+o+";"),r+="var "+u+";",f&&(r+=" if (schema"+n+" === undefined) "+u+" = true; else if (!Array.isArray(schema"+n+")) "+u+" = false; else {"),r+=u+" = false;for (var "+$+"=0; "+$+"<"+_+".length; "+$+"++) if (equal("+l+", "+_+"["+$+"])) { "+u+" = true; break; }",f&&(r+="  }  "),r+=" if (!"+u+") {   ";var d=d||[];d.push(r),r="",!1!==t.createErrors?(r+=" { keyword: 'enum' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(s)+" , params: { allowedValues: schema"+n+" } ",!1!==t.opts.messages&&(r+=" , message: 'should be equal to one of the allowed values' "),t.opts.verbose&&(r+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ";var p=r;return r=d.pop(),!t.compositeRule&&c?t.async?r+=" throw new ValidationError(["+p+"]); ":r+=" validate.errors = ["+p+"]; return false; ":r+=" var err = "+p+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" }",c&&(r+=" else { "),r}},{}],26:[function(t,e,r){"use strict";e.exports=function(t,e){var r=" ",n=t.level,a=t.dataLevel,i=t.schema[e],o=t.schemaPath+t.util.getProperty(e),s=t.errSchemaPath+"/"+e,c=!t.opts.allErrors,l="data"+(a||"");if(!1===t.opts.format)return c&&(r+=" if (true) { "),r;var u,f=t.opts.v5&&i&&i.$data;f?(r+=" var schema"+n+" = "+t.util.getData(i.$data,a,t.dataPathArr)+"; ",u="schema"+n):u=i;var $=t.opts.unknownFormats,_=Array.isArray($);if(f){var d="format"+n;r+=" var "+d+" = formats["+u+"]; var isObject"+n+" = typeof "+d+" == 'object' && !("+d+" instanceof RegExp) && "+d+".validate; if (isObject"+n+") { ",t.async&&(r+=" var async"+n+" = "+d+".async; "),r+=" "+d+" = "+d+".validate; } if (  ",f&&(r+=" ("+u+" !== undefined && typeof "+u+" != 'string') || "),r+=" (",(!0===$||_)&&(r+=" ("+u+" && !"+d+" ",_&&(r+=" && self._opts.unknownFormats.indexOf("+u+") == -1 "),r+=") || "),r+=" ("+d+" && !(typeof "+d+" == 'function' ? ",t.async?r+=" (async"+n+" ? "+t.yieldAwait+" "+d+"("+l+") : "+d+"("+l+")) ":r+=" "+d+"("+l+") ",r+=" : "+d+".test("+l+"))))) {"}else{var d=t.formats[i];if(!d){if(!0===$||_&&-1==$.indexOf(i))throw new Error('unknown format "'+i+'" is used in schema at path "'+t.errSchemaPath+'"');return _||(console.warn('unknown format "'+i+'" ignored in schema at path "'+t.errSchemaPath+'"'),"ignore"!==$&&console.warn("In the next major version it will throw exception. See option unknownFormats for more information")),c&&(r+=" if (true) { "),r}var p="object"==typeof d&&!(d instanceof RegExp)&&d.validate;if(p){var h=!0===d.async;d=d.validate}if(h){if(!t.async)throw new Error("async format in sync schema");var g="formats"+t.util.getProperty(i)+".validate";r+=" if (!("+t.yieldAwait+" "+g+"("+l+"))) { "}else{r+=" if (! ";var g="formats"+t.util.getProperty(i);p&&(g+=".validate"),r+="function"==typeof d?" "+g+"("+l+") ":" "+g+".test("+l+") ",r+=") { "}}var m=m||[];m.push(r),r="",!1!==t.createErrors?(r+=" { keyword: 'format' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(s)+" , params: { format:  ",r+=f?""+u:""+t.util.toQuotedString(i),r+="  } ",!1!==t.opts.messages&&(r+=" , message: 'should match format \"",r+=f?"' + "+u+" + '":""+t.util.escapeQuotes(i),r+="\"' "),t.opts.verbose&&(r+=" , schema:  ",r+=f?"validate.schema"+o:""+t.util.toQuotedString(i),r+="         , parentSchema: validate.schema"+t.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ";var v=r;return r=m.pop(),!t.compositeRule&&c?t.async?r+=" throw new ValidationError(["+v+"]); ":r+=" validate.errors = ["+v+"]; return false; ":r+=" var err = "+v+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } ",c&&(r+=" else { "),r}},{}],27:[function(t,e,r){"use strict";e.exports=function(t,e){var r=" ",n=t.level,a=t.dataLevel,i=t.schema[e],o=t.schemaPath+t.util.getProperty(e),s=t.errSchemaPath+"/"+e,c=!t.opts.allErrors,l="data"+(a||""),u="valid"+n,f="errs__"+n,$=t.util.copy(t),_="";$.level++;var d="valid"+$.level,p="i"+n,h=$.dataLevel=t.dataLevel+1,g="data"+h,m=t.baseId;if(r+="var "+f+" = errors;var "+u+";",Array.isArray(i)){var v=t.schema.additionalItems;if(!1===v){r+=" "+u+" = "+l+".length <= "+i.length+"; ";var y=s;s=t.errSchemaPath+"/additionalItems",r+="  if (!"+u+") {   ";var b=b||[];b.push(r),r="",!1!==t.createErrors?(r+=" { keyword: 'additionalItems' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(s)+" , params: { limit: "+i.length+" } ",!1!==t.opts.messages&&(r+=" , message: 'should NOT have more than "+i.length+" items' "),t.opts.verbose&&(r+=" , schema: false , parentSchema: validate.schema"+t.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ";var w=r;r=b.pop(),!t.compositeRule&&c?t.async?r+=" throw new ValidationError(["+w+"]); ":r+=" validate.errors = ["+w+"]; return false; ":r+=" var err = "+w+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } ",s=y,c&&(_+="}",r+=" else { ")}var x=i;if(x)for(var A,k=-1,E=x.length-1;k<E;)if(A=x[k+=1],t.util.schemaHasRules(A,t.RULES.all)){r+=" "+d+" = true; if ("+l+".length > "+k+") { ";var S=l+"["+k+"]";$.schema=A,$.schemaPath=o+"["+k+"]",$.errSchemaPath=s+"/"+k,$.errorPath=t.util.getPathExpr(t.errorPath,k,t.opts.jsonPointers,!0),$.dataPathArr[h]=k;var N=t.validate($);$.baseId=m,t.util.varOccurences(N,g)<2?r+=" "+t.util.varReplace(N,g,S)+" ":r+=" var "+g+" = "+S+"; "+N+" ",r+=" }  ",c&&(r+=" if ("+d+") { ",_+="}")}if("object"==typeof v&&t.util.schemaHasRules(v,t.RULES.all)){$.schema=v,$.schemaPath=t.schemaPath+".additionalItems",$.errSchemaPath=t.errSchemaPath+"/additionalItems",r+=" "+d+" = true; if ("+l+".length > "+i.length+") {  for (var "+p+" = "+i.length+"; "+p+" < "+l+".length; "+p+"++) { ",$.errorPath=t.util.getPathExpr(t.errorPath,p,t.opts.jsonPointers,!0);var S=l+"["+p+"]";$.dataPathArr[h]=p;var N=t.validate($);$.baseId=m,t.util.varOccurences(N,g)<2?r+=" "+t.util.varReplace(N,g,S)+" ":r+=" var "+g+" = "+S+"; "+N+" ",c&&(r+=" if (!"+d+") break; "),r+=" } }  ",c&&(r+=" if ("+d+") { ",_+="}")}}else if(t.util.schemaHasRules(i,t.RULES.all)){$.schema=i,$.schemaPath=o,$.errSchemaPath=s,r+="  for (var "+p+" = 0; "+p+" < "+l+".length; "+p+"++) { ",$.errorPath=t.util.getPathExpr(t.errorPath,p,t.opts.jsonPointers,!0);var S=l+"["+p+"]";$.dataPathArr[h]=p;var N=t.validate($);$.baseId=m,t.util.varOccurences(N,g)<2?r+=" "+t.util.varReplace(N,g,S)+" ":r+=" var "+g+" = "+S+"; "+N+" ",c&&(r+=" if (!"+d+") break; "),r+=" }  ",c&&(r+=" if ("+d+") { ",_+="}")}return c&&(r+=" "+_+" if ("+f+" == errors) {"),r=t.util.cleanUpCode(r)}},{}],28:[function(t,e,r){"use strict";e.exports=function(t,e){var r,n=" ",a=t.level,i=t.dataLevel,o=t.schema[e],s=t.schemaPath+t.util.getProperty(e),c=t.errSchemaPath+"/"+e,l=!t.opts.allErrors,u="data"+(i||""),f=t.opts.v5&&o&&o.$data;f?(n+=" var schema"+a+" = "+t.util.getData(o.$data,i,t.dataPathArr)+"; ",r="schema"+a):r=o,n+="var division"+a+";if (",f&&(n+=" "+r+" !== undefined && ( typeof "+r+" != 'number' || "),n+=" (division"+a+" = "+u+" / "+r+", ",t.opts.multipleOfPrecision?n+=" Math.abs(Math.round(division"+a+") - division"+a+") > 1e-"+t.opts.multipleOfPrecision+" ":n+=" division"+a+" !== parseInt(division"+a+") ",n+=" ) ",f&&(n+="  )  "),n+=" ) {   ";var $=$||[];$.push(n),n="",!1!==t.createErrors?(n+=" { keyword: 'multipleOf' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(c)+" , params: { multipleOf: "+r+" } ",!1!==t.opts.messages&&(n+=" , message: 'should be multiple of ",n+=f?"' + "+r:o+"'"),t.opts.verbose&&(n+=" , schema:  ",n+=f?"validate.schema"+s:""+o,n+="         , parentSchema: validate.schema"+t.schemaPath+" , data: "+u+" "),n+=" } "):n+=" {} ";var _=n;return n=$.pop(),!t.compositeRule&&l?t.async?n+=" throw new ValidationError(["+_+"]); ":n+=" validate.errors = ["+_+"]; return false; ":n+=" var err = "+_+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+="} ",l&&(n+=" else { "),n}},{}],29:[function(t,e,r){"use strict";e.exports=function(t,e){var r=" ",n=t.level,a=t.dataLevel,i=t.schema[e],o=t.schemaPath+t.util.getProperty(e),s=t.errSchemaPath+"/"+e,c=!t.opts.allErrors,l="data"+(a||""),u="errs__"+n,f=t.util.copy(t);f.level++;var $="valid"+f.level;if(t.util.schemaHasRules(i,t.RULES.all)){f.schema=i,f.schemaPath=o,f.errSchemaPath=s,r+=" var "+u+" = errors;  ";var _=t.compositeRule;t.compositeRule=f.compositeRule=!0,f.createErrors=!1;var d;f.opts.allErrors&&(d=f.opts.allErrors,f.opts.allErrors=!1),r+=" "+t.validate(f)+" ",f.createErrors=!0,d&&(f.opts.allErrors=d),t.compositeRule=f.compositeRule=_,r+=" if ("+$+") {   ";var p=p||[];p.push(r),r="",!1!==t.createErrors?(r+=" { keyword: 'not' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(s)+" , params: {} ",!1!==t.opts.messages&&(r+=" , message: 'should NOT be valid' "),t.opts.verbose&&(r+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ";var h=r;r=p.pop(),!t.compositeRule&&c?t.async?r+=" throw new ValidationError(["+h+"]); ":r+=" validate.errors = ["+h+"]; return false; ":r+=" var err = "+h+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } else {  errors = "+u+"; if (vErrors !== null) { if ("+u+") vErrors.length = "+u+"; else vErrors = null; } ",t.opts.allErrors&&(r+=" } ")}else r+="  var err =   ",!1!==t.createErrors?(r+=" { keyword: 'not' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(s)+" , params: {} ",!1!==t.opts.messages&&(r+=" , message: 'should NOT be valid' "),t.opts.verbose&&(r+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",c&&(r+=" if (false) { ");return r}},{}],30:[function(t,e,r){"use strict";e.exports=function(t,e){var r=" ",n=t.level,a=t.dataLevel,i=t.schema[e],o=t.schemaPath+t.util.getProperty(e),s=t.errSchemaPath+"/"+e,c=!t.opts.allErrors,l="data"+(a||""),u="valid"+n,f="errs__"+n,$=t.util.copy(t),_="";$.level++;var d="valid"+$.level;r+="var "+f+" = errors;var prevValid"+n+" = false;var "+u+" = false;";var p=$.baseId,h=t.compositeRule;t.compositeRule=$.compositeRule=!0;var g=i;if(g)for(var m,v=-1,y=g.length-1;v<y;)m=g[v+=1],t.util.schemaHasRules(m,t.RULES.all)?($.schema=m,$.schemaPath=o+"["+v+"]",$.errSchemaPath=s+"/"+v,r+="  "+t.validate($)+" ",$.baseId=p):r+=" var "+d+" = true; ",v&&(r+=" if ("+d+" && prevValid"+n+") "+u+" = false; else { ",_+="}"),r+=" if ("+d+") "+u+" = prevValid"+n+" = true;";t.compositeRule=$.compositeRule=h,r+=_+"if (!"+u+") {   ";var b=b||[];b.push(r),r="",
!1!==t.createErrors?(r+=" { keyword: 'oneOf' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(s)+" , params: {} ",!1!==t.opts.messages&&(r+=" , message: 'should match exactly one schema in oneOf' "),t.opts.verbose&&(r+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ";var w=r;return r=b.pop(),!t.compositeRule&&c?t.async?r+=" throw new ValidationError(["+w+"]); ":r+=" validate.errors = ["+w+"]; return false; ":r+=" var err = "+w+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+="} else {  errors = "+f+"; if (vErrors !== null) { if ("+f+") vErrors.length = "+f+"; else vErrors = null; }",t.opts.allErrors&&(r+=" } "),r}},{}],31:[function(t,e,r){"use strict";e.exports=function(t,e){var r,n=" ",a=t.level,i=t.dataLevel,o=t.schema[e],s=t.schemaPath+t.util.getProperty(e),c=t.errSchemaPath+"/"+e,l=!t.opts.allErrors,u="data"+(i||""),f=t.opts.v5&&o&&o.$data;f?(n+=" var schema"+a+" = "+t.util.getData(o.$data,i,t.dataPathArr)+"; ",r="schema"+a):r=o;var $=f?"(new RegExp("+r+"))":t.usePattern(o);n+="if ( ",f&&(n+=" ("+r+" !== undefined && typeof "+r+" != 'string') || "),n+=" !"+$+".test("+u+") ) {   ";var _=_||[];_.push(n),n="",!1!==t.createErrors?(n+=" { keyword: 'pattern' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(c)+" , params: { pattern:  ",n+=f?""+r:""+t.util.toQuotedString(o),n+="  } ",!1!==t.opts.messages&&(n+=" , message: 'should match pattern \"",n+=f?"' + "+r+" + '":""+t.util.escapeQuotes(o),n+="\"' "),t.opts.verbose&&(n+=" , schema:  ",n+=f?"validate.schema"+s:""+t.util.toQuotedString(o),n+="         , parentSchema: validate.schema"+t.schemaPath+" , data: "+u+" "),n+=" } "):n+=" {} ";var d=n;return n=_.pop(),!t.compositeRule&&l?t.async?n+=" throw new ValidationError(["+d+"]); ":n+=" validate.errors = ["+d+"]; return false; ":n+=" var err = "+d+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+="} ",l&&(n+=" else { "),n}},{}],32:[function(t,e,r){"use strict";e.exports=function(t,e){var r=" ",n=t.level,a=t.dataLevel,i=t.schema[e],o=t.schemaPath+t.util.getProperty(e),s=t.errSchemaPath+"/"+e,c=!t.opts.allErrors,l="data"+(a||""),u="valid"+n,f="key"+n,$="patternMatched"+n,_="",d=t.opts.ownProperties;r+="var "+u+" = true;";var p=i;if(p)for(var h,g=-1,m=p.length-1;g<m;){h=p[g+=1],r+=" var "+$+" = false; for (var "+f+" in "+l+") {  ",d&&(r+=" if (!Object.prototype.hasOwnProperty.call("+l+", "+f+")) continue; "),r+=" "+$+" = "+t.usePattern(h)+".test("+f+"); if ("+$+") break; } ";var v=t.util.escapeQuotes(h);r+=" if (!"+$+") { "+u+" = false;  var err =   ",!1!==t.createErrors?(r+=" { keyword: 'patternRequired' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(s)+" , params: { missingPattern: '"+v+"' } ",!1!==t.opts.messages&&(r+=" , message: 'should have property matching pattern \\'"+v+"\\'' "),t.opts.verbose&&(r+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; }   ",c&&(_+="}",r+=" else { ")}return r+=""+_}},{}],33:[function(t,e,r){"use strict";e.exports=function(t,e){var r=" ",n=t.level,a=t.dataLevel,i=t.schema[e],o=t.schemaPath+t.util.getProperty(e),s=t.errSchemaPath+"/"+e,c=!t.opts.allErrors,l="data"+(a||""),u="valid"+n,f="errs__"+n,$=t.util.copy(t),_="";$.level++;var d="valid"+$.level,p="key"+n,h=$.dataLevel=t.dataLevel+1,g="data"+h,m=Object.keys(i||{}),v=t.schema.patternProperties||{},y=Object.keys(v),b=t.schema.additionalProperties,w=m.length||y.length,x=!1===b,A="object"==typeof b&&Object.keys(b).length,k=t.opts.removeAdditional,E=x||A||k,S=t.opts.ownProperties,N=t.baseId,C=t.schema.required;if(C&&(!t.opts.v5||!C.$data)&&C.length<t.opts.loopRequired)var I=t.util.toHash(C);if(t.opts.v5)var O=t.schema.patternGroups||{},P=Object.keys(O);if(r+="var "+f+" = errors;var "+d+" = true;",E){if(r+=" for (var "+p+" in "+l+") {  ",S&&(r+=" if (!Object.prototype.hasOwnProperty.call("+l+", "+p+")) continue; "),w){if(r+=" var isAdditional"+n+" = !(false ",m.length)if(m.length>5)r+=" || validate.schema"+o+"["+p+"] ";else{var L=m;if(L)for(var M,T=-1,B=L.length-1;T<B;)M=L[T+=1],r+=" || "+p+" == "+t.util.toQuotedString(M)+" "}if(y.length){var j=y;if(j)for(var F,R=-1,q=j.length-1;R<q;)F=j[R+=1],r+=" || "+t.usePattern(F)+".test("+p+") "}if(t.opts.v5&&P&&P.length){var D=P;if(D)for(var z,R=-1,U=D.length-1;R<U;)z=D[R+=1],r+=" || "+t.usePattern(z)+".test("+p+") "}r+=" ); if (isAdditional"+n+") { "}if("all"==k)r+=" delete "+l+"["+p+"]; ";else{var H=t.errorPath,G="' + "+p+" + '";if(t.opts._errorDataPathProperty&&(t.errorPath=t.util.getPathExpr(t.errorPath,p,t.opts.jsonPointers)),x)if(k)r+=" delete "+l+"["+p+"]; ";else{r+=" "+d+" = false; ";var Y=s;s=t.errSchemaPath+"/additionalProperties";var V=V||[];V.push(r),r="",!1!==t.createErrors?(r+=" { keyword: 'additionalProperties' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(s)+" , params: { additionalProperty: '"+G+"' } ",!1!==t.opts.messages&&(r+=" , message: 'should NOT have additional properties' "),t.opts.verbose&&(r+=" , schema: false , parentSchema: validate.schema"+t.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ";var Q=r;r=V.pop(),!t.compositeRule&&c?t.async?r+=" throw new ValidationError(["+Q+"]); ":r+=" validate.errors = ["+Q+"]; return false; ":r+=" var err = "+Q+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",s=Y,c&&(r+=" break; ")}else if(A)if("failing"==k){r+=" var "+f+" = errors;  ";var X=t.compositeRule;t.compositeRule=$.compositeRule=!0,$.schema=b,$.schemaPath=t.schemaPath+".additionalProperties",$.errSchemaPath=t.errSchemaPath+"/additionalProperties",$.errorPath=t.opts._errorDataPathProperty?t.errorPath:t.util.getPathExpr(t.errorPath,p,t.opts.jsonPointers);var J=l+"["+p+"]";$.dataPathArr[h]=p;var W=t.validate($);$.baseId=N,t.util.varOccurences(W,g)<2?r+=" "+t.util.varReplace(W,g,J)+" ":r+=" var "+g+" = "+J+"; "+W+" ",r+=" if (!"+d+") { errors = "+f+"; if (validate.errors !== null) { if (errors) validate.errors.length = errors; else validate.errors = null; } delete "+l+"["+p+"]; }  ",t.compositeRule=$.compositeRule=X}else{$.schema=b,$.schemaPath=t.schemaPath+".additionalProperties",$.errSchemaPath=t.errSchemaPath+"/additionalProperties",$.errorPath=t.opts._errorDataPathProperty?t.errorPath:t.util.getPathExpr(t.errorPath,p,t.opts.jsonPointers);var J=l+"["+p+"]";$.dataPathArr[h]=p;var W=t.validate($);$.baseId=N,t.util.varOccurences(W,g)<2?r+=" "+t.util.varReplace(W,g,J)+" ":r+=" var "+g+" = "+J+"; "+W+" ",c&&(r+=" if (!"+d+") break; ")}t.errorPath=H}w&&(r+=" } "),r+=" }  ",c&&(r+=" if ("+d+") { ",_+="}")}var K=t.opts.useDefaults&&!t.compositeRule;if(m.length){var Z=m;if(Z)for(var M,tt=-1,et=Z.length-1;tt<et;){M=Z[tt+=1];var rt=i[M];if(t.util.schemaHasRules(rt,t.RULES.all)){var nt=t.util.getProperty(M),J=l+nt,at=K&&void 0!==rt.default;$.schema=rt,$.schemaPath=o+nt,$.errSchemaPath=s+"/"+t.util.escapeFragment(M),$.errorPath=t.util.getPath(t.errorPath,M,t.opts.jsonPointers),$.dataPathArr[h]=t.util.toQuotedString(M);var W=t.validate($);if($.baseId=N,t.util.varOccurences(W,g)<2){W=t.util.varReplace(W,g,J);var it=J}else{var it=g;r+=" var "+g+" = "+J+"; "}if(at)r+=" "+W+" ";else{if(I&&I[M]){r+=" if ("+it+" === undefined) { "+d+" = false; ";var H=t.errorPath,Y=s,ot=t.util.escapeQuotes(M);t.opts._errorDataPathProperty&&(t.errorPath=t.util.getPath(H,M,t.opts.jsonPointers)),s=t.errSchemaPath+"/required";var V=V||[];V.push(r),r="",!1!==t.createErrors?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(s)+" , params: { missingProperty: '"+ot+"' } ",!1!==t.opts.messages&&(r+=" , message: '",t.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+ot+"\\'",r+="' "),t.opts.verbose&&(r+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ";var Q=r;r=V.pop(),!t.compositeRule&&c?t.async?r+=" throw new ValidationError(["+Q+"]); ":r+=" validate.errors = ["+Q+"]; return false; ":r+=" var err = "+Q+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",s=Y,t.errorPath=H,r+=" } else { "}else r+=c?" if ("+it+" === undefined) { "+d+" = true; } else { ":" if ("+it+" !== undefined) { ";r+=" "+W+" } "}}c&&(r+=" if ("+d+") { ",_+="}")}}var st=y;if(st)for(var F,ct=-1,lt=st.length-1;ct<lt;){F=st[ct+=1];var rt=v[F];if(t.util.schemaHasRules(rt,t.RULES.all)){$.schema=rt,$.schemaPath=t.schemaPath+".patternProperties"+t.util.getProperty(F),$.errSchemaPath=t.errSchemaPath+"/patternProperties/"+t.util.escapeFragment(F),r+=" for (var "+p+" in "+l+") {  ",S&&(r+=" if (!Object.prototype.hasOwnProperty.call("+l+", "+p+")) continue; "),r+=" if ("+t.usePattern(F)+".test("+p+")) { ",$.errorPath=t.util.getPathExpr(t.errorPath,p,t.opts.jsonPointers);var J=l+"["+p+"]";$.dataPathArr[h]=p;var W=t.validate($);$.baseId=N,t.util.varOccurences(W,g)<2?r+=" "+t.util.varReplace(W,g,J)+" ":r+=" var "+g+" = "+J+"; "+W+" ",c&&(r+=" if (!"+d+") break; "),r+=" } ",c&&(r+=" else "+d+" = true; "),r+=" }  ",c&&(r+=" if ("+d+") { ",_+="}")}}if(t.opts.v5){var ut=P;if(ut)for(var z,ft=-1,$t=ut.length-1;ft<$t;){z=ut[ft+=1];var _t=O[z],rt=_t.schema;if(t.util.schemaHasRules(rt,t.RULES.all)){$.schema=rt,$.schemaPath=t.schemaPath+".patternGroups"+t.util.getProperty(z)+".schema",$.errSchemaPath=t.errSchemaPath+"/patternGroups/"+t.util.escapeFragment(z)+"/schema",r+=" var pgPropCount"+n+" = 0; for (var "+p+" in "+l+") {  ",S&&(r+=" if (!Object.prototype.hasOwnProperty.call("+l+", "+p+")) continue; "),r+=" if ("+t.usePattern(z)+".test("+p+")) { pgPropCount"+n+"++; ",$.errorPath=t.util.getPathExpr(t.errorPath,p,t.opts.jsonPointers);var J=l+"["+p+"]";$.dataPathArr[h]=p;var W=t.validate($);$.baseId=N,t.util.varOccurences(W,g)<2?r+=" "+t.util.varReplace(W,g,J)+" ":r+=" var "+g+" = "+J+"; "+W+" ",c&&(r+=" if (!"+d+") break; "),r+=" } ",c&&(r+=" else "+d+" = true; "),r+=" }  ",c&&(r+=" if ("+d+") { ",_+="}");var dt=_t.minimum,pt=_t.maximum;if(void 0!==dt||void 0!==pt){r+=" var "+u+" = true; ";var Y=s;if(void 0!==dt){var ht=dt,gt="minimum",mt="less";r+=" "+u+" = pgPropCount"+n+" >= "+dt+"; ",s=t.errSchemaPath+"/patternGroups/minimum",r+="  if (!"+u+") {   ";var V=V||[];V.push(r),r="",!1!==t.createErrors?(r+=" { keyword: 'patternGroups' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(s)+" , params: { reason: '"+gt+"', limit: "+ht+", pattern: '"+t.util.escapeQuotes(z)+"' } ",!1!==t.opts.messages&&(r+=" , message: 'should NOT have "+mt+" than "+ht+' properties matching pattern "'+t.util.escapeQuotes(z)+"\"' "),t.opts.verbose&&(r+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ";var Q=r;r=V.pop(),!t.compositeRule&&c?t.async?r+=" throw new ValidationError(["+Q+"]); ":r+=" validate.errors = ["+Q+"]; return false; ":r+=" var err = "+Q+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } ",void 0!==pt&&(r+=" else ")}if(void 0!==pt){var ht=pt,gt="maximum",mt="more";r+=" "+u+" = pgPropCount"+n+" <= "+pt+"; ",s=t.errSchemaPath+"/patternGroups/maximum",r+="  if (!"+u+") {   ";var V=V||[];V.push(r),r="",!1!==t.createErrors?(r+=" { keyword: 'patternGroups' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(s)+" , params: { reason: '"+gt+"', limit: "+ht+", pattern: '"+t.util.escapeQuotes(z)+"' } ",!1!==t.opts.messages&&(r+=" , message: 'should NOT have "+mt+" than "+ht+' properties matching pattern "'+t.util.escapeQuotes(z)+"\"' "),t.opts.verbose&&(r+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ";var Q=r;r=V.pop(),!t.compositeRule&&c?t.async?r+=" throw new ValidationError(["+Q+"]); ":r+=" validate.errors = ["+Q+"]; return false; ":r+=" var err = "+Q+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } "}s=Y,c&&(r+=" if ("+u+") { ",_+="}")}}}}return c&&(r+=" "+_+" if ("+f+" == errors) {"),r=t.util.cleanUpCode(r)}},{}],34:[function(t,e,r){"use strict";e.exports=function(t,e){var r,n,a=" ",i=t.level,o=t.dataLevel,s=t.schema[e],c=t.errSchemaPath+"/"+e,l=!t.opts.allErrors,u="data"+(o||""),f="valid"+i;if("#"==s||"#/"==s)t.isRoot?(r=t.async,n="validate"):(r=!0===t.root.schema.$async,n="root.refVal[0]");else{var $=t.resolveRef(t.baseId,s,t.isRoot);if(void 0===$){var _="can't resolve reference "+s+" from id "+t.baseId;if("fail"==t.opts.missingRefs){console.log(_);var d=d||[];d.push(a),a="",!1!==t.createErrors?(a+=" { keyword: '$ref' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(c)+" , params: { ref: '"+t.util.escapeQuotes(s)+"' } ",!1!==t.opts.messages&&(a+=" , message: 'can\\'t resolve reference "+t.util.escapeQuotes(s)+"' "),t.opts.verbose&&(a+=" , schema: "+t.util.toQuotedString(s)+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+u+" "),a+=" } "):a+=" {} ";var p=a;a=d.pop(),!t.compositeRule&&l?t.async?a+=" throw new ValidationError(["+p+"]); ":a+=" validate.errors = ["+p+"]; return false; ":a+=" var err = "+p+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",l&&(a+=" if (false) { ")}else{if("ignore"!=t.opts.missingRefs){var h=new Error(_);throw h.missingRef=t.resolve.url(t.baseId,s),h.missingSchema=t.resolve.normalizeId(t.resolve.fullPath(h.missingRef)),h}console.log(_),l&&(a+=" if (true) { ")}}else if($.inline){var g=t.util.copy(t);g.level++;var m="valid"+g.level;g.schema=$.schema,g.schemaPath="",g.errSchemaPath=s;var v=t.validate(g).replace(/validate\.schema/g,$.code);a+=" "+v+" ",l&&(a+=" if ("+m+") { ")}else r=!0===$.$async,n=$.code}if(n){var d=d||[];d.push(a),a="",t.opts.passContext?a+=" "+n+".call(this, ":a+=" "+n+"( ",a+=" "+u+", (dataPath || '')",'""'!=t.errorPath&&(a+=" + "+t.errorPath);a+=" , "+(o?"data"+(o-1||""):"parentData")+" , "+(o?t.dataPathArr[o]:"parentDataProperty")+", rootData)  ";var y=a;if(a=d.pop(),r){if(!t.async)throw new Error("async schema referenced by sync schema");a+=" try { ",l&&(a+="var "+f+" ="),a+=" "+t.yieldAwait+" "+y+"; } catch (e) { if (!(e instanceof ValidationError)) throw e; if (vErrors === null) vErrors = e.errors; else vErrors = vErrors.concat(e.errors); errors = vErrors.length; } ",l&&(a+=" if ("+f+") { ")}else a+=" if (!"+y+") { if (vErrors === null) vErrors = "+n+".errors; else vErrors = vErrors.concat("+n+".errors); errors = vErrors.length; } ",l&&(a+=" else { ")}return a}},{}],35:[function(t,e,r){"use strict";e.exports=function(t,e){var r=" ",n=t.level,a=t.dataLevel,i=t.schema[e],o=t.schemaPath+t.util.getProperty(e),s=t.errSchemaPath+"/"+e,c=!t.opts.allErrors,l="data"+(a||""),u="valid"+n,f=t.opts.v5&&i&&i.$data;f&&(r+=" var schema"+n+" = "+t.util.getData(i.$data,a,t.dataPathArr)+"; ");var $="schema"+n;if(!f)if(i.length<t.opts.loopRequired&&t.schema.properties&&Object.keys(t.schema.properties).length){var _=[],d=i;if(d)for(var p,h=-1,g=d.length-1;h<g;){p=d[h+=1];var m=t.schema.properties[p];m&&t.util.schemaHasRules(m,t.RULES.all)||(_[_.length]=p)}}else var _=i;if(f||_.length){var v=t.errorPath,y=f||_.length>=t.opts.loopRequired;if(c)if(r+=" var missing"+n+"; ",y){f||(r+=" var "+$+" = validate.schema"+o+"; ");var b="i"+n,w="schema"+n+"["+b+"]",x="' + "+w+" + '";t.opts._errorDataPathProperty&&(t.errorPath=t.util.getPathExpr(v,w,t.opts.jsonPointers)),r+=" var "+u+" = true; ",f&&(r+=" if (schema"+n+" === undefined) "+u+" = true; else if (!Array.isArray(schema"+n+")) "+u+" = false; else {"),r+=" for (var "+b+" = 0; "+b+" < "+$+".length; "+b+"++) { "+u+" = "+l+"["+$+"["+b+"]] !== undefined; if (!"+u+") break; } ",f&&(r+="  }  "),r+="  if (!"+u+") {   ";var A=A||[];A.push(r),r="",!1!==t.createErrors?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(s)+" , params: { missingProperty: '"+x+"' } ",!1!==t.opts.messages&&(r+=" , message: '",t.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+x+"\\'",r+="' "),t.opts.verbose&&(r+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ";var k=r;r=A.pop(),!t.compositeRule&&c?t.async?r+=" throw new ValidationError(["+k+"]); ":r+=" validate.errors = ["+k+"]; return false; ":r+=" var err = "+k+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } else { "}else{r+=" if ( ";var E=_;if(E)for(var S,b=-1,N=E.length-1;b<N;){S=E[b+=1],b&&(r+=" || ");var C=t.util.getProperty(S);r+=" ( "+l+C+" === undefined && (missing"+n+" = "+t.util.toQuotedString(t.opts.jsonPointers?S:C)+") ) "}r+=") {  ";var w="missing"+n,x="' + "+w+" + '";t.opts._errorDataPathProperty&&(t.errorPath=t.opts.jsonPointers?t.util.getPathExpr(v,w,!0):v+" + "+w);var A=A||[];A.push(r),r="",!1!==t.createErrors?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(s)+" , params: { missingProperty: '"+x+"' } ",!1!==t.opts.messages&&(r+=" , message: '",t.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+x+"\\'",r+="' "),t.opts.verbose&&(r+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ";var k=r;r=A.pop(),!t.compositeRule&&c?t.async?r+=" throw new ValidationError(["+k+"]); ":r+=" validate.errors = ["+k+"]; return false; ":r+=" var err = "+k+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } else { "}else if(y){f||(r+=" var "+$+" = validate.schema"+o+"; ");var b="i"+n,w="schema"+n+"["+b+"]",x="' + "+w+" + '";t.opts._errorDataPathProperty&&(t.errorPath=t.util.getPathExpr(v,w,t.opts.jsonPointers)),f&&(r+=" if ("+$+" && !Array.isArray("+$+")) {  var err =   ",!1!==t.createErrors?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(s)+" , params: { missingProperty: '"+x+"' } ",!1!==t.opts.messages&&(r+=" , message: '",t.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+x+"\\'",r+="' "),t.opts.verbose&&(r+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } else if ("+$+" !== undefined) { "),r+=" for (var "+b+" = 0; "+b+" < "+$+".length; "+b+"++) { if ("+l+"["+$+"["+b+"]] === undefined) {  var err =   ",!1!==t.createErrors?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(s)+" , params: { missingProperty: '"+x+"' } ",!1!==t.opts.messages&&(r+=" , message: '",t.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+x+"\\'",r+="' "),t.opts.verbose&&(r+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } } ",f&&(r+="  }  ")}else{var I=_;if(I)for(var O,P=-1,L=I.length-1;P<L;){O=I[P+=1];var C=t.util.getProperty(O),x=t.util.escapeQuotes(O);t.opts._errorDataPathProperty&&(t.errorPath=t.util.getPath(v,O,t.opts.jsonPointers)),r+=" if ("+l+C+" === undefined) {  var err =   ",!1!==t.createErrors?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(s)+" , params: { missingProperty: '"+x+"' } ",!1!==t.opts.messages&&(r+=" , message: '",t.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+x+"\\'",r+="' "),t.opts.verbose&&(r+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}t.errorPath=v}else c&&(r+=" if (true) {");return r}},{}],36:[function(t,e,r){"use strict";e.exports=function(t,e){var r=" ",n=t.level,a=t.dataLevel,i=t.schema[e],o=t.schemaPath+t.util.getProperty(e),s=t.errSchemaPath+"/"+e,c=!t.opts.allErrors,l="data"+(a||""),u="valid"+n,f="errs__"+n,$=t.util.copy(t),_="";$.level++;var d,p="valid"+$.level,h="ifPassed"+t.level,g=$.baseId;r+="var "+h+";";var m=i;if(m)for(var v,y=-1,b=m.length-1;y<b;){if(v=m[y+=1],y&&!d&&(r+=" if (!"+h+") { ",_+="}"),v.if&&t.util.schemaHasRules(v.if,t.RULES.all)){r+=" var "+f+" = errors;   ";var w=t.compositeRule;if(t.compositeRule=$.compositeRule=!0,$.createErrors=!1,$.schema=v.if,$.schemaPath=o+"["+y+"].if",$.errSchemaPath=s+"/"+y+"/if",r+="  "+t.validate($)+" ",$.baseId=g,$.createErrors=!0,t.compositeRule=$.compositeRule=w,r+=" "+h+" = "+p+"; if ("+h+") {  ","boolean"==typeof v.then){if(!1===v.then){var x=x||[];x.push(r),r="",!1!==t.createErrors?(r+=" { keyword: 'switch' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(s)+" , params: { caseIndex: "+y+" } ",!1!==t.opts.messages&&(r+=" , message: 'should pass \"switch\" keyword validation' "),t.opts.verbose&&(r+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ";var A=r;r=x.pop(),!t.compositeRule&&c?t.async?r+=" throw new ValidationError(["+A+"]); ":r+=" validate.errors = ["+A+"]; return false; ":r+=" var err = "+A+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}r+=" var "+p+" = "+v.then+"; "}else $.schema=v.then,$.schemaPath=o+"["+y+"].then",$.errSchemaPath=s+"/"+y+"/then",r+="  "+t.validate($)+" ",$.baseId=g;r+="  } else {  errors = "+f+"; if (vErrors !== null) { if ("+f+") vErrors.length = "+f+"; else vErrors = null; } } "}else if(r+=" "+h+" = true;  ","boolean"==typeof v.then){if(!1===v.then){var x=x||[];x.push(r),r="",!1!==t.createErrors?(r+=" { keyword: 'switch' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(s)+" , params: { caseIndex: "+y+" } ",!1!==t.opts.messages&&(r+=" , message: 'should pass \"switch\" keyword validation' "),t.opts.verbose&&(r+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ";var A=r;r=x.pop(),!t.compositeRule&&c?t.async?r+=" throw new ValidationError(["+A+"]); ":r+=" validate.errors = ["+A+"]; return false; ":r+=" var err = "+A+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}r+=" var "+p+" = "+v.then+"; "}else $.schema=v.then,$.schemaPath=o+"["+y+"].then",$.errSchemaPath=s+"/"+y+"/then",r+="  "+t.validate($)+" ",$.baseId=g;d=v.continue}return r+=_+"var "+u+" = "+p+"; ",r=t.util.cleanUpCode(r)}},{}],37:[function(t,e,r){"use strict";e.exports=function(t,e){var r,n=" ",a=t.level,i=t.dataLevel,o=t.schema[e],s=t.schemaPath+t.util.getProperty(e),c=t.errSchemaPath+"/"+e,l=!t.opts.allErrors,u="data"+(i||""),f="valid"+a,$=t.opts.v5&&o&&o.$data;if($?(n+=" var schema"+a+" = "+t.util.getData(o.$data,i,t.dataPathArr)+"; ",r="schema"+a):r=o,(o||$)&&!1!==t.opts.uniqueItems){$&&(n+=" var "+f+"; if ("+r+" === false || "+r+" === undefined) "+f+" = true; else if (typeof "+r+" != 'boolean') "+f+" = false; else { "),n+=" var "+f+" = true; if ("+u+".length > 1) { var i = "+u+".length, j; outer: for (;i--;) { for (j = i; j--;) { if (equal("+u+"[i], "+u+"[j])) { "+f+" = false; break outer; } } } } ",$&&(n+="  }  "),n+=" if (!"+f+") {   ";var _=_||[];_.push(n),n="",!1!==t.createErrors?(n+=" { keyword: 'uniqueItems' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(c)+" , params: { i: i, j: j } ",!1!==t.opts.messages&&(n+=" , message: 'should NOT have duplicate items (items ## ' + j + ' and ' + i + ' are identical)' "),t.opts.verbose&&(n+=" , schema:  ",n+=$?"validate.schema"+s:""+o,n+="         , parentSchema: validate.schema"+t.schemaPath+" , data: "+u+" "),n+=" } "):n+=" {} ";var d=n;n=_.pop(),!t.compositeRule&&l?t.async?n+=" throw new ValidationError(["+d+"]); ":n+=" validate.errors = ["+d+"]; return false; ":n+=" var err = "+d+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } ",l&&(n+=" else { ")}else l&&(n+=" if (true) { ");return n}},{}],38:[function(t,e,r){"use strict";e.exports=function(t,e){function r(e){return void 0!==t.schema[e.keyword]||"properties"==e.keyword&&(!1===t.schema.additionalProperties||"object"==typeof t.schema.additionalProperties||t.schema.patternProperties&&Object.keys(t.schema.patternProperties).length||t.opts.v5&&t.schema.patternGroups&&Object.keys(t.schema.patternGroups).length)}var n="",a=!0===t.schema.$async;if(t.isTop){var i=t.isTop,o=t.level=0,s=t.dataLevel=0,c="data";if(t.rootId=t.resolve.fullPath(t.root.schema.id),t.baseId=t.baseId||t.rootId,a){t.async=!0;var l="es7"==t.opts.async;t.yieldAwait=l?"await":"yield"}delete t.isTop,t.dataPathArr=[void 0],n+=" var validate = ",a?l?n+=" (async function ":("co*"==t.opts.async&&(n+="co.wrap"),n+="(function* "):n+=" (function ",n+=" (data, dataPath, parentData, parentDataProperty, rootData) { 'use strict'; var vErrors = null; ",n+=" var errors = 0;     ",n+=" if (rootData === undefined) rootData = data;"}else{var o=t.level,s=t.dataLevel,c="data"+(s||"");if(t.schema.id&&(t.baseId=t.resolve.url(t.baseId,t.schema.id)),a&&!t.async)throw new Error("async schema in sync schema");n+=" var errs_"+o+" = errors;"}var u="valid"+o,f=!t.opts.allErrors,$="",_="",d=t.schema.type,p=Array.isArray(d);if(d&&t.opts.coerceTypes){var h=t.util.coerceToTypes(t.opts.coerceTypes,d);if(h){var g=t.schemaPath+".type",m=t.errSchemaPath+"/type",v=p?"checkDataTypes":"checkDataType";n+=" if ("+t.util[v](d,c,!0)+") {  ";var y="dataType"+o,b="coerced"+o;n+=" var "+y+" = typeof "+c+"; ","array"==t.opts.coerceTypes&&(n+=" if ("+y+" == 'object' && Array.isArray("+c+")) "+y+" = 'array'; "),n+=" var "+b+" = undefined; ";var w="",x=h;if(x)for(var A,k=-1,E=x.length-1;k<E;)A=x[k+=1],k&&(n+=" if ("+b+" === undefined) { ",w+="}"),"array"==t.opts.coerceTypes&&"array"!=A&&(n+=" if ("+y+" == 'array' && "+c+".length == 1) { "+b+" = "+c+" = "+c+"[0]; "+y+" = typeof "+c+";  } "),"string"==A?n+=" if ("+y+" == 'number' || "+y+" == 'boolean') "+b+" = '' + "+c+"; else if ("+c+" === null) "+b+" = ''; ":"number"==A||"integer"==A?(n+=" if ("+y+" == 'boolean' || "+c+" === null || ("+y+" == 'string' && "+c+" && "+c+" == +"+c+" ","integer"==A&&(n+=" && !("+c+" % 1)"),n+=")) "+b+" = +"+c+"; "):"boolean"==A?n+=" if ("+c+" === 'false' || "+c+" === 0 || "+c+" === null) "+b+" = false; else if ("+c+" === 'true' || "+c+" === 1) "+b+" = true; ":"null"==A?n+=" if ("+c+" === '' || "+c+" === 0 || "+c+" === false) "+b+" = null; ":"array"==t.opts.coerceTypes&&"array"==A&&(n+=" if ("+y+" == 'string' || "+y+" == 'number' || "+y+" == 'boolean' || "+c+" == null) "+b+" = ["+c+"]; ");n+=" "+w+" if ("+b+" === undefined) {   ";var S=S||[];S.push(n),n="",!1!==t.createErrors?(n+=" { keyword: 'type' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(m)+" , params: { type: '",n+=p?""+d.join(","):""+d,n+="' } ",!1!==t.opts.messages&&(n+=" , message: 'should be ",n+=p?""+d.join(","):""+d,n+="' "),t.opts.verbose&&(n+=" , schema: validate.schema"+g+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+c+" "),n+=" } "):n+=" {} ";var N=n;n=S.pop(),!t.compositeRule&&f?t.async?n+=" throw new ValidationError(["+N+"]); ":n+=" validate.errors = ["+N+"]; return false; ":n+=" var err = "+N+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } else {  ";var C=s?"data"+(s-1||""):"parentData",I=s?t.dataPathArr[s]:"parentDataProperty";n+=" "+c+" = "+b+"; ",s||(n+="if ("+C+" !== undefined)"),n+=" "+C+"["+I+"] = "+b+"; } } "}}var O;if(t.schema.$ref&&(O=t.util.schemaHasRulesExcept(t.schema,t.RULES.all,"$ref"))){if("fail"==t.opts.extendRefs)throw new Error('$ref: validation keywords used in schema at path "'+t.errSchemaPath+'"');"ignore"==t.opts.extendRefs?(O=!1,console.log('$ref: keywords ignored in schema at path "'+t.errSchemaPath+'"')):!0!==t.opts.extendRefs&&console.log('$ref: all keywords used in schema at path "'+t.errSchemaPath+'". It will change in the next major version, see issue #260. Use option { extendRefs: true } to keep current behaviour')}if(t.schema.$ref&&!O)n+=" "+t.RULES.all.$ref.code(t,"$ref")+" ",f&&(n+=" } if (errors === ",n+=i?"0":"errs_"+o,n+=") { ",_+="}");else{var P=t.RULES;if(P)for(var L,M=-1,T=P.length-1;M<T;)if(L=P[M+=1],function(t){for(var e=0;e<t.rules.length;e++)if(r(t.rules[e]))return!0}(L)){if(L.type&&(n+=" if ("+t.util.checkDataType(L.type,c)+") { "),t.opts.useDefaults&&!t.compositeRule)if("object"==L.type&&t.schema.properties){var B=t.schema.properties,j=Object.keys(B),F=j;if(F)for(var R,q=-1,D=F.length-1;q<D;){R=F[q+=1];var z=B[R];if(void 0!==z.default){var U=c+t.util.getProperty(R);n+="  if ("+U+" === undefined) "+U+" = ","shared"==t.opts.useDefaults?n+=" "+t.useDefault(z.default)+" ":n+=" "+JSON.stringify(z.default)+" ",n+="; "}}}else if("array"==L.type&&Array.isArray(t.schema.items)){var H=t.schema.items;if(H)for(var z,k=-1,G=H.length-1;k<G;)if(z=H[k+=1],void 0!==z.default){var U=c+"["+k+"]";n+="  if ("+U+" === undefined) "+U+" = ","shared"==t.opts.useDefaults?n+=" "+t.useDefault(z.default)+" ":n+=" "+JSON.stringify(z.default)+" ",n+="; "}}var Y=L.rules;if(Y)for(var V,Q=-1,X=Y.length-1;Q<X;)V=Y[Q+=1],r(V)&&(n+=" "+V.code(t,V.keyword)+" ",f&&($+="}"));if(f&&(n+=" "+$+" ",$=""),L.type&&(n+=" } ",d&&d===L.type&&!h)){var J=!0;n+=" else { ";var g=t.schemaPath+".type",m=t.errSchemaPath+"/type",S=S||[];S.push(n),n="",!1!==t.createErrors?(n+=" { keyword: 'type' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(m)+" , params: { type: '",n+=p?""+d.join(","):""+d,n+="' } ",!1!==t.opts.messages&&(n+=" , message: 'should be ",n+=p?""+d.join(","):""+d,n+="' "),t.opts.verbose&&(n+=" , schema: validate.schema"+g+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+c+" "),n+=" } "):n+=" {} ";var N=n;n=S.pop(),!t.compositeRule&&f?t.async?n+=" throw new ValidationError(["+N+"]); ":n+=" validate.errors = ["+N+"]; return false; ":n+=" var err = "+N+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } "}f&&(n+=" if (errors === ",n+=i?"0":"errs_"+o,n+=") { ",_+="}")}}if(d&&!J&&!h){var g=t.schemaPath+".type",m=t.errSchemaPath+"/type",v=p?"checkDataTypes":"checkDataType";n+=" if ("+t.util[v](d,c,!0)+") {   ";var S=S||[];S.push(n),n="",!1!==t.createErrors?(n+=" { keyword: 'type' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(m)+" , params: { type: '",n+=p?""+d.join(","):""+d,n+="' } ",!1!==t.opts.messages&&(n+=" , message: 'should be ",n+=p?""+d.join(","):""+d,n+="' "),t.opts.verbose&&(n+=" , schema: validate.schema"+g+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+c+" "),n+=" } "):n+=" {} ";var N=n;n=S.pop(),!t.compositeRule&&f?t.async?n+=" throw new ValidationError(["+N+"]); ":n+=" validate.errors = ["+N+"]; return false; ":n+=" var err = "+N+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" }"}return f&&(n+=" "+_+" "),i?(a?(n+=" if (errors === 0) return true;           ",n+=" else throw new ValidationError(vErrors); "):(n+=" validate.errors = vErrors; ",n+=" return errors === 0;       "),n+=" }); return validate;"):n+=" var "+u+" = errors === errs_"+o+";",n=t.util.cleanUpCode(n),i&&f&&(n=t.util.cleanUpVarErrors(n,a)),n}},{}],39:[function(t,e,r){"use strict";function n(t,e){function r(t,e,r){for(var n,i=0;i<a.length;i++){var o=a[i];if(o.type==e){n=o;break}}n||(n={type:e,rules:[]},a.push(n));var c={keyword:t,definition:r,custom:!0,code:s};n.rules.push(c),a.custom[t]=c}function n(t){if(!a.types[t])throw new Error("Unknown type "+t)}var a=this.RULES
;if(a.keywords[t])throw new Error("Keyword "+t+" is already defined");if(!o.test(t))throw new Error("Keyword "+t+" is not a valid identifier");if(e){if(e.macro&&void 0!==e.valid)throw new Error('"valid" option cannot be used with macro keywords');var i=e.type;if(Array.isArray(i)){var c,l=i.length;for(c=0;c<l;c++)n(i[c]);for(c=0;c<l;c++)r(t,i[c],e)}else i&&n(i),r(t,i,e);var u=!0===e.$data&&this._opts.v5;if(u&&!e.validate)throw new Error('$data support: "validate" function is not defined');var f=e.metaSchema;f&&(u&&(f={anyOf:[f,{$ref:"https://raw.githubusercontent.com/epoberezkin/ajv/master/lib/refs/json-schema-v5.json#/definitions/$data"}]}),e.validateSchema=this.compile(f,!0))}a.keywords[t]=a.all[t]=!0}function a(t){var e=this.RULES.custom[t];return e?e.definition:this.RULES.keywords[t]||!1}function i(t){var e=this.RULES;delete e.keywords[t],delete e.all[t],delete e.custom[t];for(var r=0;r<e.length;r++)for(var n=e[r].rules,a=0;a<n.length;a++)if(n[a].keyword==t){n.splice(a,1);break}}var o=/^[a-z_$][a-z0-9_$\-]*$/i,s=t("./dotjs/custom");e.exports={add:n,get:a,remove:i}},{"./dotjs/custom":23}],40:[function(t,e,r){e.exports={id:"http://json-schema.org/draft-04/schema#",$schema:"http://json-schema.org/draft-04/schema#",description:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},positiveInteger:{type:"integer",minimum:0},positiveIntegerDefault0:{allOf:[{$ref:"#/definitions/positiveInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},minItems:1,uniqueItems:!0}},type:"object",properties:{id:{type:"string",format:"uri"},$schema:{type:"string",format:"uri"},title:{type:"string"},description:{type:"string"},default:{},multipleOf:{type:"number",minimum:0,exclusiveMinimum:!0},maximum:{type:"number"},exclusiveMaximum:{type:"boolean",default:!1},minimum:{type:"number"},exclusiveMinimum:{type:"boolean",default:!1},maxLength:{$ref:"#/definitions/positiveInteger"},minLength:{$ref:"#/definitions/positiveIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{anyOf:[{type:"boolean"},{$ref:"#"}],default:{}},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:{}},maxItems:{$ref:"#/definitions/positiveInteger"},minItems:{$ref:"#/definitions/positiveIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},maxProperties:{$ref:"#/definitions/positiveInteger"},minProperties:{$ref:"#/definitions/positiveIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{anyOf:[{type:"boolean"},{$ref:"#"}],default:{}},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},enum:{type:"array",minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},dependencies:{exclusiveMaximum:["maximum"],exclusiveMinimum:["minimum"]},default:{}}},{}],41:[function(t,e,r){e.exports={id:"https://raw.githubusercontent.com/epoberezkin/ajv/master/lib/refs/json-schema-v5.json#",$schema:"http://json-schema.org/draft-04/schema#",description:"Core schema meta-schema (v5 proposals)",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},positiveInteger:{type:"integer",minimum:0},positiveIntegerDefault0:{allOf:[{$ref:"#/definitions/positiveInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},minItems:1,uniqueItems:!0},$data:{type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1}},type:"object",properties:{id:{type:"string",format:"uri"},$schema:{type:"string",format:"uri"},title:{type:"string"},description:{type:"string"},default:{},multipleOf:{anyOf:[{type:"number",minimum:0,exclusiveMinimum:!0},{$ref:"#/definitions/$data"}]},maximum:{anyOf:[{type:"number"},{$ref:"#/definitions/$data"}]},exclusiveMaximum:{anyOf:[{type:"boolean",default:!1},{$ref:"#/definitions/$data"}]},minimum:{anyOf:[{type:"number"},{$ref:"#/definitions/$data"}]},exclusiveMinimum:{anyOf:[{type:"boolean",default:!1},{$ref:"#/definitions/$data"}]},maxLength:{anyOf:[{$ref:"#/definitions/positiveInteger"},{$ref:"#/definitions/$data"}]},minLength:{anyOf:[{$ref:"#/definitions/positiveIntegerDefault0"},{$ref:"#/definitions/$data"}]},pattern:{anyOf:[{type:"string",format:"regex"},{$ref:"#/definitions/$data"}]},additionalItems:{anyOf:[{type:"boolean"},{$ref:"#"},{$ref:"#/definitions/$data"}],default:{}},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:{}},maxItems:{anyOf:[{$ref:"#/definitions/positiveInteger"},{$ref:"#/definitions/$data"}]},minItems:{anyOf:[{$ref:"#/definitions/positiveIntegerDefault0"},{$ref:"#/definitions/$data"}]},uniqueItems:{anyOf:[{type:"boolean",default:!1},{$ref:"#/definitions/$data"}]},maxProperties:{anyOf:[{$ref:"#/definitions/positiveInteger"},{$ref:"#/definitions/$data"}]},minProperties:{anyOf:[{$ref:"#/definitions/positiveIntegerDefault0"},{$ref:"#/definitions/$data"}]},required:{anyOf:[{$ref:"#/definitions/stringArray"},{$ref:"#/definitions/$data"}]},additionalProperties:{anyOf:[{type:"boolean"},{$ref:"#"},{$ref:"#/definitions/$data"}],default:{}},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},enum:{anyOf:[{type:"array",minItems:1,uniqueItems:!0},{$ref:"#/definitions/$data"}]},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"},format:{anyOf:[{type:"string"},{$ref:"#/definitions/$data"}]},formatMaximum:{anyOf:[{type:"string"},{$ref:"#/definitions/$data"}]},formatMinimum:{anyOf:[{type:"string"},{$ref:"#/definitions/$data"}]},formatExclusiveMaximum:{anyOf:[{type:"boolean",default:!1},{$ref:"#/definitions/$data"}]},formatExclusiveMinimum:{anyOf:[{type:"boolean",default:!1},{$ref:"#/definitions/$data"}]},constant:{anyOf:[{},{$ref:"#/definitions/$data"}]},contains:{$ref:"#"},patternGroups:{type:"object",additionalProperties:{type:"object",required:["schema"],properties:{maximum:{anyOf:[{$ref:"#/definitions/positiveInteger"},{$ref:"#/definitions/$data"}]},minimum:{anyOf:[{$ref:"#/definitions/positiveIntegerDefault0"},{$ref:"#/definitions/$data"}]},schema:{$ref:"#"}},additionalProperties:!1},default:{}},switch:{type:"array",items:{required:["then"],properties:{if:{$ref:"#"},then:{anyOf:[{type:"boolean"},{$ref:"#"}]},continue:{type:"boolean"}},additionalProperties:!1,dependencies:{continue:["if"]}}}},dependencies:{exclusiveMaximum:["maximum"],exclusiveMinimum:["minimum"],formatMaximum:["format"],formatMinimum:["format"],formatExclusiveMaximum:["formatMaximum"],formatExclusiveMinimum:["formatMinimum"]},default:{}}},{}],42:[function(t,e,r){"use strict";function n(e){function r(t,r,a){var i={inline:a||n[t],statements:!0,errors:"full"};r&&(i.type=r),e.addKeyword(t,i)}var n={switch:t("./dotjs/switch"),constant:t("./dotjs/constant"),_formatLimit:t("./dotjs/_formatLimit"),patternRequired:t("./dotjs/patternRequired")};if(!1!==e._opts.meta){var o=t("./refs/json-schema-v5.json");e.addMetaSchema(o,i)}r("constant"),e.addKeyword("contains",{type:"array",macro:a}),r("formatMaximum","string",n._formatLimit),r("formatMinimum","string",n._formatLimit),e.addKeyword("formatExclusiveMaximum"),e.addKeyword("formatExclusiveMinimum"),e.addKeyword("patternGroups"),r("patternRequired","object"),r("switch")}function a(t){return{not:{items:{not:t}}}}var i="https://raw.githubusercontent.com/epoberezkin/ajv/master/lib/refs/json-schema-v5.json";e.exports={enable:n,META_SCHEMA_ID:i}},{"./dotjs/_formatLimit":15,"./dotjs/constant":22,"./dotjs/patternRequired":32,"./dotjs/switch":36,"./refs/json-schema-v5.json":41}],43:[function(t,e,r){"use strict";function n(t,e,r){t instanceof RegExp&&(t=a(t,r)),e instanceof RegExp&&(e=a(e,r));var n=i(t,e,r);return n&&{start:n[0],end:n[1],pre:r.slice(0,n[0]),body:r.slice(n[0]+t.length,n[1]),post:r.slice(n[1]+e.length)}}function a(t,e){var r=e.match(t);return r?r[0]:null}function i(t,e,r){var n,a,i,o,s,c=r.indexOf(t),l=r.indexOf(e,c+1),u=c;if(c>=0&&l>0){for(n=[],i=r.length;u>=0&&!s;)u==c?(n.push(u),c=r.indexOf(t,u+1)):1==n.length?s=[n.pop(),l]:(a=n.pop(),a<i&&(i=a,o=l),l=r.indexOf(e,u+1)),u=c<l&&c>=0?c:l;n.length&&(s=[i,o])}return s}e.exports=n,n.range=i},{}],44:[function(t,e,r){function n(t){return parseInt(t,10)==t?parseInt(t,10):t.charCodeAt(0)}function a(t){return t.split("\\\\").join(p).split("\\{").join(h).split("\\}").join(g).split("\\,").join(m).split("\\.").join(v)}function i(t){return t.split(p).join("\\").split(h).join("{").split(g).join("}").split(m).join(",").split(v).join(".")}function o(t){if(!t)return[""];var e=[],r=d("{","}",t);if(!r)return t.split(",");var n=r.pre,a=r.body,i=r.post,s=n.split(",");s[s.length-1]+="{"+a+"}";var c=o(i);return i.length&&(s[s.length-1]+=c.shift(),s.push.apply(s,c)),e.push.apply(e,s),e}function s(t){return t?("{}"===t.substr(0,2)&&(t="\\{\\}"+t.substr(2)),$(a(t),!0).map(i)):[]}function c(t){return"{"+t+"}"}function l(t){return/^-?0\d/.test(t)}function u(t,e){return t<=e}function f(t,e){return t>=e}function $(t,e){var r=[],a=d("{","}",t);if(!a||/\$$/.test(a.pre))return[t];var i=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(a.body),s=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(a.body),p=i||s,h=a.body.indexOf(",")>=0;if(!p&&!h)return a.post.match(/,.*\}/)?(t=a.pre+"{"+a.body+g+a.post,$(t)):[t];var m;if(p)m=a.body.split(/\.\./);else if(m=o(a.body),1===m.length&&(m=$(m[0],!1).map(c),1===m.length)){var v=a.post.length?$(a.post,!1):[""];return v.map(function(t){return a.pre+m[0]+t})}var y,b=a.pre,v=a.post.length?$(a.post,!1):[""];if(p){var w=n(m[0]),x=n(m[1]),A=Math.max(m[0].length,m[1].length),k=3==m.length?Math.abs(n(m[2])):1,E=u;x<w&&(k*=-1,E=f);var S=m.some(l);y=[];for(var N=w;E(N,x);N+=k){var C;if(s)"\\"===(C=String.fromCharCode(N))&&(C="");else if(C=String(N),S){var I=A-C.length;if(I>0){var O=new Array(I+1).join("0");C=N<0?"-"+O+C.slice(1):O+C}}y.push(C)}}else y=_(m,function(t){return $(t,!1)});for(var P=0;P<y.length;P++)for(var L=0;L<v.length;L++){var M=b+y[P]+v[L];(!e||p||M)&&r.push(M)}return r}var _=t("concat-map"),d=t("balanced-match");e.exports=s;var p="\0SLASH"+Math.random()+"\0",h="\0OPEN"+Math.random()+"\0",g="\0CLOSE"+Math.random()+"\0",m="\0COMMA"+Math.random()+"\0",v="\0PERIOD"+Math.random()+"\0"},{"balanced-match":43,"concat-map":46}],45:[function(t,e,r){function n(t){var e=this,r=$.call(arguments,1);return new Promise(function(n,i){function o(e){var r;try{r=t.next(e)}catch(t){return i(t)}l(r)}function s(e){var r;try{r=t.throw(e)}catch(t){return i(t)}l(r)}function l(t){if(t.done)return n(t.value);var r=a.call(e,t.value);return r&&c(r)?r.then(o,s):s(new TypeError('You may only yield a function, promise, generator, array, or object, but the following object was passed: "'+String(t.value)+'"'))}if("function"==typeof t&&(t=t.apply(e,r)),!t||"function"!=typeof t.next)return n(t);o()})}function a(t){return t?c(t)?t:u(t)||l(t)?n.call(this,t):"function"==typeof t?i.call(this,t):Array.isArray(t)?o.call(this,t):f(t)?s.call(this,t):t:t}function i(t){var e=this;return new Promise(function(r,n){t.call(e,function(t,e){if(t)return n(t);arguments.length>2&&(e=$.call(arguments,1)),r(e)})})}function o(t){return Promise.all(t.map(a,this))}function s(t){for(var e=new t.constructor,r=Object.keys(t),n=[],i=0;i<r.length;i++){var o=r[i],s=a.call(this,t[o]);s&&c(s)?function(t,r){e[r]=void 0,n.push(t.then(function(t){e[r]=t}))}(s,o):e[o]=t[o]}return Promise.all(n).then(function(){return e})}function c(t){return"function"==typeof t.then}function l(t){return"function"==typeof t.next&&"function"==typeof t.throw}function u(t){var e=t.constructor;return!!e&&("GeneratorFunction"===e.name||"GeneratorFunction"===e.displayName||l(e.prototype))}function f(t){return Object==t.constructor}var $=Array.prototype.slice;e.exports=n.default=n.co=n,n.wrap=function(t){function e(){return n.call(this,t.apply(this,arguments))}return e.__generatorFunction__=t,e}},{}],46:[function(t,e,r){e.exports=function(t,e){for(var r=[],a=0;a<t.length;a++){var i=e(t[a],a);n(i)?r.push.apply(r,i):r.push(i)}return r};var n=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},{}],47:[function(t,e,r){"use strict";function n(t,e,r,n){r=o(r||"UTF-8"),e=o(e||"UTF-8"),t=t||"";var s;if("UTF-8"!==r&&"string"==typeof t&&(t=new Buffer(t,"binary")),r===e)s="string"==typeof t?new Buffer(t):t;else if(c&&!n)try{s=a(t,e,r)}catch(n){console.error(n);try{s=i(t,e,r)}catch(e){console.error(e),s=t}}else try{s=i(t,e,r)}catch(e){console.error(e),s=t}return"string"==typeof s&&(s=new Buffer(s,"utf-8")),s}function a(t,e,r){var n,a;return a=new c(r,e+"//TRANSLIT//IGNORE"),n=a.convert(t),n.slice(0,n.length)}function i(t,e,r){return"UTF-8"===e?s.decode(t,r):"UTF-8"===r?s.encode(t,e):s.encode(s.decode(t,r),e)}function o(t){return(t||"").toString().trim().replace(/^latin[\-_]?(\d+)$/i,"ISO-8859-$1").replace(/^win(?:dows)?[\-_]?(\d+)$/i,"WINDOWS-$1").replace(/^utf[\-_]?(\d+)$/i,"UTF-$1").replace(/^ks_c_5601\-1987$/i,"CP949").replace(/^us[\-_]?ascii$/i,"ASCII").toUpperCase()}var s=t("iconv-lite"),c=t("./iconv-loader");e.exports.convert=n},{"./iconv-loader":48,"iconv-lite":73}],48:[function(t,e,r){"use strict";var n,a;try{n="iconv",a=t(n).Iconv}catch(t){}e.exports=a},{}],49:[function(t,e,r){function n(t){return t&&"realpath"===t.syscall&&("ELOOP"===t.code||"ENOMEM"===t.code||"ENAMETOOLONG"===t.code)}function a(t,e,r){if($)return l(t,e,r);"function"==typeof e&&(r=e,e=null),l(t,e,function(a,i){n(a)?_.realpath(t,e,r):r(a,i)})}function i(t,e){if($)return u(t,e);try{return u(t,e)}catch(r){if(n(r))return _.realpathSync(t,e);throw r}}function o(){c.realpath=a,c.realpathSync=i}function s(){c.realpath=l,c.realpathSync=u}e.exports=a,a.realpath=a,a.sync=i,a.realpathSync=i,a.monkeypatch=o,a.unmonkeypatch=s;var c=t("fs"),l=c.realpath,u=c.realpathSync,f=process.version,$=/^v[0-5]\./.test(f),_=t("./old.js")},{"./old.js":50,fs:void 0}],50:[function(t,e,r){function n(){function t(t){t&&(n.message=t.message,t=n,e(t))}function e(t){if(t){if(process.throwDeprecation)throw t;if(!process.noDeprecation){var e="fs: missing callback "+(t.stack||t.message);process.traceDeprecation?console.trace(e):console.error(e)}}}var r;if(c){var n=new Error;r=t}else r=e;return r}function a(t){return"function"==typeof t?t:n()}var i=t("path"),o="win32"===process.platform,s=t("fs"),c=process.env.NODE_DEBUG&&/fs/.test(process.env.NODE_DEBUG);i.normalize;if(o)var l=/(.*?)(?:[\/\\]+|$)/g;else var l=/(.*?)(?:[\/]+|$)/g;if(o)var u=/^(?:[a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/][^\\\/]+)?[\\\/]*/;else var u=/^[\/]*/;r.realpathSync=function(t,e){function r(){var e=u.exec(t);n=e[0].length,a=e[0],c=e[0],f="",o&&!d[c]&&(s.lstatSync(c),d[c]=!0)}if(t=i.resolve(t),e&&Object.prototype.hasOwnProperty.call(e,t))return e[t];var n,a,c,f,$=t,_={},d={};for(r();n<t.length;){l.lastIndex=n;var p=l.exec(t);if(f=a,a+=p[0],c=f+p[1],n=l.lastIndex,!(d[c]||e&&e[c]===c)){var h;if(e&&Object.prototype.hasOwnProperty.call(e,c))h=e[c];else{var g=s.lstatSync(c);if(!g.isSymbolicLink()){d[c]=!0,e&&(e[c]=c);continue}var m=null;if(!o){var v=g.dev.toString(32)+":"+g.ino.toString(32);_.hasOwnProperty(v)&&(m=_[v])}null===m&&(s.statSync(c),m=s.readlinkSync(c)),h=i.resolve(f,m),e&&(e[c]=h),o||(_[v]=m)}t=i.resolve(h,t.slice(n)),r()}}return e&&(e[$]=t),t},r.realpath=function(t,e,r){function n(){var e=u.exec(t);d=e[0].length,p=e[0],h=e[0],g="",o&&!y[h]?s.lstat(h,function(t){if(t)return r(t);y[h]=!0,c()}):process.nextTick(c)}function c(){if(d>=t.length)return e&&(e[m]=t),r(null,t);l.lastIndex=d;var n=l.exec(t);return g=p,p+=n[0],h=g+n[1],d=l.lastIndex,y[h]||e&&e[h]===h?process.nextTick(c):e&&Object.prototype.hasOwnProperty.call(e,h)?_(e[h]):s.lstat(h,f)}function f(t,n){if(t)return r(t);if(!n.isSymbolicLink())return y[h]=!0,e&&(e[h]=h),process.nextTick(c);if(!o){var a=n.dev.toString(32)+":"+n.ino.toString(32);if(v.hasOwnProperty(a))return $(null,v[a],h)}s.stat(h,function(t){if(t)return r(t);s.readlink(h,function(t,e){o||(v[a]=e),$(t,e)})})}function $(t,n,a){if(t)return r(t);var o=i.resolve(g,n);e&&(e[a]=o),_(o)}function _(e){t=i.resolve(e,t.slice(d)),n()}if("function"!=typeof r&&(r=a(e),e=null),t=i.resolve(t),e&&Object.prototype.hasOwnProperty.call(e,t))return process.nextTick(r.bind(null,null,e[t]));var d,p,h,g,m=t,v={},y={};n()}},{fs:void 0,path:void 0}],51:[function(t,e,r){function n(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function a(t,e){return t.toLowerCase().localeCompare(e.toLowerCase())}function i(t,e){return t.localeCompare(e)}function o(t,e){t.ignore=e.ignore||[],Array.isArray(t.ignore)||(t.ignore=[t.ignore]),t.ignore.length&&(t.ignore=t.ignore.map(s))}function s(t){var e=null;if("/**"===t.slice(-3)){var r=t.replace(/(\/\*\*)+$/,"");e=new g(r,{dot:!0})}return{matcher:new g(t,{dot:!0}),gmatcher:e}}function c(t,e,r){if(r||(r={}),r.matchBase&&-1===e.indexOf("/")){if(r.noglobstar)throw new Error("base matching requires globstar");e="**/"+e}t.silent=!!r.silent,t.pattern=e,t.strict=!1!==r.strict,t.realpath=!!r.realpath,t.realpathCache=r.realpathCache||Object.create(null),t.follow=!!r.follow,t.dot=!!r.dot,t.mark=!!r.mark,t.nodir=!!r.nodir,t.nodir&&(t.mark=!0),t.sync=!!r.sync,t.nounique=!!r.nounique,t.nonull=!!r.nonull,t.nosort=!!r.nosort,t.nocase=!!r.nocase,t.stat=!!r.stat,t.noprocess=!!r.noprocess,t.absolute=!!r.absolute,t.maxLength=r.maxLength||1/0,t.cache=r.cache||Object.create(null),t.statCache=r.statCache||Object.create(null),t.symlinks=r.symlinks||Object.create(null),o(t,r),t.changedCwd=!1;var a=process.cwd();n(r,"cwd")?(t.cwd=d.resolve(r.cwd),t.changedCwd=t.cwd!==a):t.cwd=a,t.root=r.root||d.resolve(t.cwd,"/"),t.root=d.resolve(t.root),"win32"===process.platform&&(t.root=t.root.replace(/\\/g,"/")),t.cwdAbs=h(t.cwd)?t.cwd:f(t,t.cwd),"win32"===process.platform&&(t.cwdAbs=t.cwdAbs.replace(/\\/g,"/")),t.nomount=!!r.nomount,r.nonegate=!0,r.nocomment=!0,t.minimatch=new g(e,r),t.options=t.minimatch.options}function l(t){for(var e=t.nounique,r=e?[]:Object.create(null),n=0,o=t.matches.length;n<o;n++){var s=t.matches[n];if(s&&0!==Object.keys(s).length){var c=Object.keys(s);e?r.push.apply(r,c):c.forEach(function(t){r[t]=!0})}else if(t.nonull){var l=t.minimatch.globSet[n];e?r.push(l):r[l]=!0}}if(e||(r=Object.keys(r)),t.nosort||(r=r.sort(t.nocase?a:i)),t.mark){for(var n=0;n<r.length;n++)r[n]=t._mark(r[n]);t.nodir&&(r=r.filter(function(e){var r=!/\/$/.test(e),n=t.cache[e]||t.cache[f(t,e)];return r&&n&&(r="DIR"!==n&&!Array.isArray(n)),r}))}t.ignore.length&&(r=r.filter(function(e){return!$(t,e)})),t.found=r}function u(t,e){var r=f(t,e),n=t.cache[r],a=e;if(n){var i="DIR"===n||Array.isArray(n),o="/"===e.slice(-1);if(i&&!o?a+="/":!i&&o&&(a=a.slice(0,-1)),a!==e){var s=f(t,a);t.statCache[s]=t.statCache[r],t.cache[s]=t.cache[r]}}return a}function f(t,e){var r=e;return r="/"===e.charAt(0)?d.join(t.root,e):h(e)||""===e?e:t.changedCwd?d.resolve(t.cwd,e):d.resolve(e),"win32"===process.platform&&(r=r.replace(/\\/g,"/")),r}function $(t,e){return!!t.ignore.length&&t.ignore.some(function(t){return t.matcher.match(e)||!(!t.gmatcher||!t.gmatcher.match(e))})}function _(t,e){return!!t.ignore.length&&t.ignore.some(function(t){return!(!t.gmatcher||!t.gmatcher.match(e))})}r.alphasort=i,r.alphasorti=a,r.setopts=c,r.ownProp=n,r.makeAbs=f,r.finish=l,r.mark=u,r.isIgnored=$,r.childrenIgnored=_;var d=t("path"),p=t("minimatch"),h=t("path-is-absolute"),g=p.Minimatch},{minimatch:82,path:void 0,"path-is-absolute":84}],52:[function(t,e,r){function n(t,e,r){if("function"==typeof e&&(r=e,e={}),e||(e={}),e.sync){if(r)throw new TypeError("callback provided to sync glob");return p(t,e)}return new i(t,e,r)}function a(t,e){if(null===e||"object"!=typeof e)return t;for(var r=Object.keys(e),n=r.length;n--;)t[r[n]]=e[r[n]];return t}function i(t,e,r){function n(){--o._processing<=0&&(s?process.nextTick(function(){o._finish()}):o._finish())}if("function"==typeof e&&(r=e,e=null),e&&e.sync){if(r)throw new TypeError("callback provided to sync glob");return new x(t,e)}if(!(this instanceof i))return new i(t,e,r);g(this,t,e),this._didRealPath=!1;var a=this.minimatch.set.length;this.matches=new Array(a),"function"==typeof r&&(r=w(r),this.on("error",r),this.on("end",function(t){r(null,t)}));var o=this;if(this._processing=0,this._emitQueue=[],this._processQueue=[],this.paused=!1,this.noprocess)return this;if(0===a)return n();for(var s=!0,c=0;c<a;c++)this._process(this.minimatch.set[c],c,!1,n);s=!1}function o(t,e,r){return function(n,a){n?t._readdirError(e,n,r):t._readdirEntries(e,a,r)}}e.exports=n;var s=t("fs"),c=t("fs.realpath"),l=t("minimatch"),u=(l.Minimatch,t("inherits")),f=t("events").EventEmitter,$=t("path"),_=t("assert"),d=t("path-is-absolute"),p=t("./sync.js"),h=t("./common.js"),g=(h.alphasort,h.alphasorti,h.setopts),m=h.ownProp,v=t("inflight"),y=(t("util"),h.childrenIgnored),b=h.isIgnored,w=t("once");n.sync=p;var x=n.GlobSync=p.GlobSync;n.glob=n,n.hasMagic=function(t,e){var r=a({},e);r.noprocess=!0;var n=new i(t,r),o=n.minimatch.set;if(!t)return!1;if(o.length>1)return!0;for(var s=0;s<o[0].length;s++)if("string"!=typeof o[0][s])return!0;return!1},n.Glob=i,u(i,f),i.prototype._finish=function(){if(_(this instanceof i),!this.aborted){if(this.realpath&&!this._didRealpath)return this._realpath();h.finish(this),this.emit("end",this.found)}},i.prototype._realpath=function(){function t(){0==--e&&r._finish()}if(!this._didRealpath){this._didRealpath=!0;var e=this.matches.length;if(0===e)return this._finish();for(var r=this,n=0;n<this.matches.length;n++)this._realpathSet(n,t)}},i.prototype._realpathSet=function(t,e){var r=this.matches[t];if(!r)return e();var n=Object.keys(r),a=this,i=n.length;if(0===i)return e();var o=this.matches[t]=Object.create(null);n.forEach(function(r,n){r=a._makeAbs(r),c.realpath(r,a.realpathCache,function(n,s){n?"stat"===n.syscall?o[r]=!0:a.emit("error",n):o[s]=!0,0==--i&&(a.matches[t]=o,e())})})},i.prototype._mark=function(t){return h.mark(this,t)},i.prototype._makeAbs=function(t){return h.makeAbs(this,t)},i.prototype.abort=function(){this.aborted=!0,this.emit("abort")},i.prototype.pause=function(){this.paused||(this.paused=!0,this.emit("pause"))},i.prototype.resume=function(){if(this.paused){if(this.emit("resume"),this.paused=!1,this._emitQueue.length){var t=this._emitQueue.slice(0);this._emitQueue.length=0;for(var e=0;e<t.length;e++){var r=t[e];this._emitMatch(r[0],r[1])}}if(this._processQueue.length){var n=this._processQueue.slice(0);this._processQueue.length=0;for(var e=0;e<n.length;e++){var a=n[e];this._processing--,this._process(a[0],a[1],a[2],a[3])}}}},i.prototype._process=function(t,e,r,n){if(_(this instanceof i),_("function"==typeof n),!this.aborted){if(this._processing++,this.paused)return void this._processQueue.push([t,e,r,n]);for(var a=0;"string"==typeof t[a];)a++;var o;switch(a){case t.length:return void this._processSimple(t.join("/"),e,n);case 0:o=null;break;default:o=t.slice(0,a).join("/")}var s,c=t.slice(a);null===o?s=".":d(o)||d(t.join("/"))?(o&&d(o)||(o="/"+o),s=o):s=o;var u=this._makeAbs(s);if(y(this,s))return n();c[0]===l.GLOBSTAR?this._processGlobStar(o,s,u,c,e,r,n):this._processReaddir(o,s,u,c,e,r,n)}},i.prototype._processReaddir=function(t,e,r,n,a,i,o){var s=this;this._readdir(r,i,function(c,l){return s._processReaddir2(t,e,r,n,a,i,l,o)})},i.prototype._processReaddir2=function(t,e,r,n,a,i,o,s){if(!o)return s();for(var c=n[0],l=!!this.minimatch.negate,u=c._glob,f=this.dot||"."===u.charAt(0),_=[],d=0;d<o.length;d++){var p=o[d];if("."!==p.charAt(0)||f){var h;h=l&&!t?!p.match(c):p.match(c),h&&_.push(p)}}var g=_.length;if(0===g)return s();if(1===n.length&&!this.mark&&!this.stat){this.matches[a]||(this.matches[a]=Object.create(null));for(var d=0;d<g;d++){var p=_[d];t&&(p="/"!==t?t+"/"+p:t+p),"/"!==p.charAt(0)||this.nomount||(p=$.join(this.root,p)),this._emitMatch(a,p)}return s()}n.shift();for(var d=0;d<g;d++){var p=_[d];t&&(p="/"!==t?t+"/"+p:t+p),this._process([p].concat(n),a,i,s)}s()},i.prototype._emitMatch=function(t,e){if(!this.aborted&&!b(this,e)){if(this.paused)return void this._emitQueue.push([t,e]);var r=d(e)?e:this._makeAbs(e);if(this.mark&&(e=this._mark(e)),this.absolute&&(e=r),!this.matches[t][e]){if(this.nodir){var n=this.cache[r];if("DIR"===n||Array.isArray(n))return}this.matches[t][e]=!0;var a=this.statCache[r];a&&this.emit("stat",e,a),this.emit("match",e)}}},i.prototype._readdirInGlobStar=function(t,e){function r(r,n){if(r&&"ENOENT"===r.code)return e();var i=n&&n.isSymbolicLink();a.symlinks[t]=i,i||!n||n.isDirectory()?a._readdir(t,!1,e):(a.cache[t]="FILE",e())}if(!this.aborted){if(this.follow)return this._readdir(t,!1,e);var n="lstat\0"+t,a=this,i=v(n,r);i&&s.lstat(t,i)}},i.prototype._readdir=function(t,e,r){if(!this.aborted&&(r=v("readdir\0"+t+"\0"+e,r))){if(e&&!m(this.symlinks,t))return this._readdirInGlobStar(t,r);if(m(this.cache,t)){var n=this.cache[t];if(!n||"FILE"===n)return r();if(Array.isArray(n))return r(null,n)}s.readdir(t,o(this,t,r))}},i.prototype._readdirEntries=function(t,e,r){if(!this.aborted){if(!this.mark&&!this.stat)for(var n=0;n<e.length;n++){var a=e[n];a="/"===t?t+a:t+"/"+a,this.cache[a]=!0}return this.cache[t]=e,r(null,e)}},i.prototype._readdirError=function(t,e,r){if(!this.aborted){switch(e.code){case"ENOTSUP":case"ENOTDIR":var n=this._makeAbs(t);if(this.cache[n]="FILE",n===this.cwdAbs){var a=new Error(e.code+" invalid cwd "+this.cwd);a.path=this.cwd,a.code=e.code,this.emit("error",a),this.abort()}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(t)]=!1;break;default:this.cache[this._makeAbs(t)]=!1,this.strict&&(this.emit("error",e),this.abort()),this.silent||console.error("glob error",e)}return r()}},i.prototype._processGlobStar=function(t,e,r,n,a,i,o){var s=this;this._readdir(r,i,function(c,l){s._processGlobStar2(t,e,r,n,a,i,l,o)})},i.prototype._processGlobStar2=function(t,e,r,n,a,i,o,s){if(!o)return s();var c=n.slice(1),l=t?[t]:[],u=l.concat(c);this._process(u,a,!1,s);var f=this.symlinks[r],$=o.length;if(f&&i)return s();for(var _=0;_<$;_++){if("."!==o[_].charAt(0)||this.dot){var d=l.concat(o[_],c);this._process(d,a,!0,s);var p=l.concat(o[_],n);this._process(p,a,!0,s)}}s()},i.prototype._processSimple=function(t,e,r){var n=this;this._stat(t,function(a,i){n._processSimple2(t,e,a,i,r)})},i.prototype._processSimple2=function(t,e,r,n,a){if(this.matches[e]||(this.matches[e]=Object.create(null)),!n)return a();if(t&&d(t)&&!this.nomount){var i=/[\/\\]$/.test(t);"/"===t.charAt(0)?t=$.join(this.root,t):(t=$.resolve(this.root,t),i&&(t+="/"))}"win32"===process.platform&&(t=t.replace(/\\/g,"/")),this._emitMatch(e,t),a()},i.prototype._stat=function(t,e){function r(r,a){if(a&&a.isSymbolicLink())return s.stat(n,function(r,i){r?l._stat2(t,n,null,a,e):l._stat2(t,n,r,i,e)});l._stat2(t,n,r,a,e)}var n=this._makeAbs(t),a="/"===t.slice(-1);if(t.length>this.maxLength)return e();if(!this.stat&&m(this.cache,n)){var i=this.cache[n];if(Array.isArray(i)&&(i="DIR"),!a||"DIR"===i)return e(null,i);if(a&&"FILE"===i)return e()}var o=this.statCache[n];if(void 0!==o){if(!1===o)return e(null,o);var c=o.isDirectory()?"DIR":"FILE";return a&&"FILE"===c?e():e(null,c,o)}var l=this,u=v("stat\0"+n,r);u&&s.lstat(n,u)},i.prototype._stat2=function(t,e,r,n,a){if(r&&("ENOENT"===r.code||"ENOTDIR"===r.code))return this.statCache[e]=!1,a();var i="/"===t.slice(-1);if(this.statCache[e]=n,"/"===e.slice(-1)&&n&&!n.isDirectory())return a(null,!1,n);var o=!0;return n&&(o=n.isDirectory()?"DIR":"FILE"),this.cache[e]=this.cache[e]||o,i&&"FILE"===o?a():a(null,o,n)}},{"./common.js":51,"./sync.js":53,assert:void 0,events:void 0,fs:void 0,"fs.realpath":49,inflight:75,inherits:76,minimatch:82,once:83,path:void 0,"path-is-absolute":84,util:void 0}],53:[function(t,e,r){function n(t,e){if("function"==typeof e||3===arguments.length)throw new TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");return new a(t,e).found}function a(t,e){if(!t)throw new Error("must provide pattern");if("function"==typeof e||3===arguments.length)throw new TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");if(!(this instanceof a))return new a(t,e);if($(this,t,e),this.noprocess)return this;var r=this.minimatch.set.length;this.matches=new Array(r);for(var n=0;n<r;n++)this._process(this.minimatch.set[n],n,!1);this._finish()}e.exports=n,n.GlobSync=a;var i=t("fs"),o=t("fs.realpath"),s=t("minimatch"),c=(s.Minimatch,t("./glob.js").Glob,t("util"),t("path")),l=t("assert"),u=t("path-is-absolute"),f=t("./common.js"),$=(f.alphasort,f.alphasorti,f.setopts),_=f.ownProp,d=f.childrenIgnored,p=f.isIgnored;a.prototype._finish=function(){if(l(this instanceof a),this.realpath){var t=this;this.matches.forEach(function(e,r){var n=t.matches[r]=Object.create(null);for(var a in e)try{a=t._makeAbs(a);var i=o.realpathSync(a,t.realpathCache);n[i]=!0}catch(e){if("stat"!==e.syscall)throw e;n[t._makeAbs(a)]=!0}})}f.finish(this)},a.prototype._process=function(t,e,r){l(this instanceof a);for(var n=0;"string"==typeof t[n];)n++;var i;switch(n){case t.length:return void this._processSimple(t.join("/"),e);case 0:i=null;break;default:i=t.slice(0,n).join("/")}var o,c=t.slice(n);null===i?o=".":u(i)||u(t.join("/"))?(i&&u(i)||(i="/"+i),o=i):o=i;var f=this._makeAbs(o);if(!d(this,o)){c[0]===s.GLOBSTAR?this._processGlobStar(i,o,f,c,e,r):this._processReaddir(i,o,f,c,e,r)}},a.prototype._processReaddir=function(t,e,r,n,a,i){var o=this._readdir(r,i);if(o){for(var s=n[0],l=!!this.minimatch.negate,u=s._glob,f=this.dot||"."===u.charAt(0),$=[],_=0;_<o.length;_++){var d=o[_];if("."!==d.charAt(0)||f){var p;p=l&&!t?!d.match(s):d.match(s),p&&$.push(d)}}var h=$.length;if(0!==h)if(1!==n.length||this.mark||this.stat){n.shift();for(var _=0;_<h;_++){var g,d=$[_];g=t?[t,d]:[d],this._process(g.concat(n),a,i)}}else{this.matches[a]||(this.matches[a]=Object.create(null));for(var _=0;_<h;_++){var d=$[_];t&&(d="/"!==t.slice(-1)?t+"/"+d:t+d),"/"!==d.charAt(0)||this.nomount||(d=c.join(this.root,d)),this._emitMatch(a,d)}}}},a.prototype._emitMatch=function(t,e){if(!p(this,e)){var r=this._makeAbs(e);if(this.mark&&(e=this._mark(e)),this.absolute&&(e=r),!this.matches[t][e]){if(this.nodir){var n=this.cache[r];if("DIR"===n||Array.isArray(n))return}this.matches[t][e]=!0,this.stat&&this._stat(e)}}},a.prototype._readdirInGlobStar=function(t){if(this.follow)return this._readdir(t,!1);var e,r;try{r=i.lstatSync(t)}catch(t){if("ENOENT"===t.code)return null}var n=r&&r.isSymbolicLink();return this.symlinks[t]=n,n||!r||r.isDirectory()?e=this._readdir(t,!1):this.cache[t]="FILE",e},a.prototype._readdir=function(t,e){if(e&&!_(this.symlinks,t))return this._readdirInGlobStar(t);if(_(this.cache,t)){var r=this.cache[t];if(!r||"FILE"===r)return null;if(Array.isArray(r))return r}try{return this._readdirEntries(t,i.readdirSync(t))}catch(e){return this._readdirError(t,e),null}},a.prototype._readdirEntries=function(t,e){if(!this.mark&&!this.stat)for(var r=0;r<e.length;r++){var n=e[r];n="/"===t?t+n:t+"/"+n,this.cache[n]=!0}return this.cache[t]=e,e},a.prototype._readdirError=function(t,e){switch(e.code){case"ENOTSUP":case"ENOTDIR":var r=this._makeAbs(t);if(this.cache[r]="FILE",
r===this.cwdAbs){var n=new Error(e.code+" invalid cwd "+this.cwd);throw n.path=this.cwd,n.code=e.code,n}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(t)]=!1;break;default:if(this.cache[this._makeAbs(t)]=!1,this.strict)throw e;this.silent||console.error("glob error",e)}},a.prototype._processGlobStar=function(t,e,r,n,a,i){var o=this._readdir(r,i);if(o){var s=n.slice(1),c=t?[t]:[],l=c.concat(s);this._process(l,a,!1);var u=o.length;if(!this.symlinks[r]||!i)for(var f=0;f<u;f++){var $=o[f];if("."!==$.charAt(0)||this.dot){var _=c.concat(o[f],s);this._process(_,a,!0);var d=c.concat(o[f],n);this._process(d,a,!0)}}}},a.prototype._processSimple=function(t,e){var r=this._stat(t);if(this.matches[e]||(this.matches[e]=Object.create(null)),r){if(t&&u(t)&&!this.nomount){var n=/[\/\\]$/.test(t);"/"===t.charAt(0)?t=c.join(this.root,t):(t=c.resolve(this.root,t),n&&(t+="/"))}"win32"===process.platform&&(t=t.replace(/\\/g,"/")),this._emitMatch(e,t)}},a.prototype._stat=function(t){var e=this._makeAbs(t),r="/"===t.slice(-1);if(t.length>this.maxLength)return!1;if(!this.stat&&_(this.cache,e)){var n=this.cache[e];if(Array.isArray(n)&&(n="DIR"),!r||"DIR"===n)return n;if(r&&"FILE"===n)return!1}var a=this.statCache[e];if(!a){var o;try{o=i.lstatSync(e)}catch(t){if(t&&("ENOENT"===t.code||"ENOTDIR"===t.code))return this.statCache[e]=!1,!1}if(o&&o.isSymbolicLink())try{a=i.statSync(e)}catch(t){a=o}else a=o}this.statCache[e]=a;var n=!0;return a&&(n=a.isDirectory()?"DIR":"FILE"),this.cache[e]=this.cache[e]||n,(!r||"FILE"!==n)&&n},a.prototype._mark=function(t){return f.mark(this,t)},a.prototype._makeAbs=function(t){return f.makeAbs(this,t)}},{"./common.js":51,"./glob.js":52,assert:void 0,fs:void 0,"fs.realpath":49,minimatch:82,path:void 0,"path-is-absolute":84,util:void 0}],54:[function(t,e,r){"use strict";function n(t,e){if(this.encodingName=t.encodingName,!t)throw new Error("DBCS codec is called without the data.");if(!t.table)throw new Error("Encoding '"+this.encodingName+"' has no data.");var r=t.table();this.decodeTables=[],this.decodeTables[0]=f.slice(0),this.decodeTableSeq=[];for(var n=0;n<r.length;n++)this._addDecodeChunk(r[n]);this.defaultCharUnicode=e.defaultCharUnicode,this.encodeTable=[],this.encodeTableSeq=[];var a={};if(t.encodeSkipVals)for(var n=0;n<t.encodeSkipVals.length;n++){var i=t.encodeSkipVals[n];if("number"==typeof i)a[i]=!0;else for(var o=i.from;o<=i.to;o++)a[o]=!0}if(this._fillEncodeTable(0,0,a),t.encodeAdd)for(var s in t.encodeAdd)Object.prototype.hasOwnProperty.call(t.encodeAdd,s)&&this._setEncodeChar(s.charCodeAt(0),t.encodeAdd[s]);if(this.defCharSB=this.encodeTable[0][e.defaultCharSingleByte.charCodeAt(0)],this.defCharSB===c&&(this.defCharSB=this.encodeTable[0]["?"]),this.defCharSB===c&&(this.defCharSB="?".charCodeAt(0)),"function"==typeof t.gb18030){this.gb18030=t.gb18030();for(var $=this.decodeTables.length,_=this.decodeTables[$]=f.slice(0),d=this.decodeTables.length,p=this.decodeTables[d]=f.slice(0),n=129;n<=254;n++)for(var h=u-this.decodeTables[0][n],g=this.decodeTables[h],o=48;o<=57;o++)g[o]=u-$;for(var n=129;n<=254;n++)_[n]=u-d;for(var n=48;n<=57;n++)p[n]=l}}function a(t,e){this.leadSurrogate=-1,this.seqObj=void 0,this.encodeTable=e.encodeTable,this.encodeTableSeq=e.encodeTableSeq,this.defaultCharSingleByte=e.defCharSB,this.gb18030=e.gb18030}function i(t,e){this.nodeIdx=0,this.prevBuf=new s(0),this.decodeTables=e.decodeTables,this.decodeTableSeq=e.decodeTableSeq,this.defaultCharUnicode=e.defaultCharUnicode,this.gb18030=e.gb18030}function o(t,e){if(t[0]>e)return-1;for(var r=0,n=t.length;r<n-1;){var a=r+Math.floor((n-r+1)/2);t[a]<=e?r=a:n=a}return r}var s=t("buffer").Buffer;r._dbcs=n;for(var c=-1,l=-2,u=-1e3,f=new Array(256),$=0;$<256;$++)f[$]=c;n.prototype.encoder=a,n.prototype.decoder=i,n.prototype._getDecodeTrieNode=function(t){for(var e=[];t>0;t>>=8)e.push(255&t);0==e.length&&e.push(0);for(var r=this.decodeTables[0],n=e.length-1;n>0;n--){var a=r[e[n]];if(a==c)r[e[n]]=u-this.decodeTables.length,this.decodeTables.push(r=f.slice(0));else{if(!(a<=u))throw new Error("Overwrite byte in "+this.encodingName+", addr: "+t.toString(16));r=this.decodeTables[u-a]}}return r},n.prototype._addDecodeChunk=function(t){var e=parseInt(t[0],16),r=this._getDecodeTrieNode(e);e&=255;for(var n=1;n<t.length;n++){var a=t[n];if("string"==typeof a)for(var i=0;i<a.length;){var o=a.charCodeAt(i++);if(55296<=o&&o<56320){var s=a.charCodeAt(i++);if(!(56320<=s&&s<57344))throw new Error("Incorrect surrogate pair in "+this.encodingName+" at chunk "+t[0]);r[e++]=65536+1024*(o-55296)+(s-56320)}else if(4080<o&&o<=4095){for(var c=4095-o+2,l=[],u=0;u<c;u++)l.push(a.charCodeAt(i++));r[e++]=-10-this.decodeTableSeq.length,this.decodeTableSeq.push(l)}else r[e++]=o}else{if("number"!=typeof a)throw new Error("Incorrect type '"+typeof a+"' given in "+this.encodingName+" at chunk "+t[0]);for(var f=r[e-1]+1,i=0;i<a;i++)r[e++]=f++}}if(e>255)throw new Error("Incorrect chunk in "+this.encodingName+" at addr "+t[0]+": too long"+e)},n.prototype._getEncodeBucket=function(t){var e=t>>8;return void 0===this.encodeTable[e]&&(this.encodeTable[e]=f.slice(0)),this.encodeTable[e]},n.prototype._setEncodeChar=function(t,e){var r=this._getEncodeBucket(t),n=255&t;r[n]<=-10?this.encodeTableSeq[-10-r[n]][-1]=e:r[n]==c&&(r[n]=e)},n.prototype._setEncodeSequence=function(t,e){var r,n=t[0],a=this._getEncodeBucket(n),i=255&n;a[i]<=-10?r=this.encodeTableSeq[-10-a[i]]:(r={},a[i]!==c&&(r[-1]=a[i]),a[i]=-10-this.encodeTableSeq.length,this.encodeTableSeq.push(r));for(var o=1;o<t.length-1;o++){var s=r[n];"object"==typeof s?r=s:(r=r[n]={},void 0!==s&&(r[-1]=s))}n=t[t.length-1],r[n]=e},n.prototype._fillEncodeTable=function(t,e,r){for(var n=this.decodeTables[t],a=0;a<256;a++){var i=n[a],o=e+a;r[o]||(i>=0?this._setEncodeChar(i,o):i<=u?this._fillEncodeTable(u-i,o<<8,r):i<=-10&&this._setEncodeSequence(this.decodeTableSeq[-10-i],o))}},a.prototype.write=function(t){for(var e=new s(t.length*(this.gb18030?4:3)),r=this.leadSurrogate,n=this.seqObj,a=-1,i=0,l=0;;){if(-1===a){if(i==t.length)break;var u=t.charCodeAt(i++)}else{var u=a;a=-1}if(55296<=u&&u<57344)if(u<56320){if(-1===r){r=u;continue}r=u,u=c}else-1!==r?(u=65536+1024*(r-55296)+(u-56320),r=-1):u=c;else-1!==r&&(a=u,u=c,r=-1);var f=c;if(void 0!==n&&u!=c){var $=n[u];if("object"==typeof $){n=$;continue}"number"==typeof $?f=$:void 0==$&&void 0!==($=n[-1])&&(f=$,a=u),n=void 0}else if(u>=0){var _=this.encodeTable[u>>8];if(void 0!==_&&(f=_[255&u]),f<=-10){n=this.encodeTableSeq[-10-f];continue}if(f==c&&this.gb18030){var d=o(this.gb18030.uChars,u);if(-1!=d){var f=this.gb18030.gbChars[d]+(u-this.gb18030.uChars[d]);e[l++]=129+Math.floor(f/12600),f%=12600,e[l++]=48+Math.floor(f/1260),f%=1260,e[l++]=129+Math.floor(f/10),f%=10,e[l++]=48+f;continue}}}f===c&&(f=this.defaultCharSingleByte),f<256?e[l++]=f:f<65536?(e[l++]=f>>8,e[l++]=255&f):(e[l++]=f>>16,e[l++]=f>>8&255,e[l++]=255&f)}return this.seqObj=n,this.leadSurrogate=r,e.slice(0,l)},a.prototype.end=function(){if(-1!==this.leadSurrogate||void 0!==this.seqObj){var t=new s(10),e=0;if(this.seqObj){var r=this.seqObj[-1];void 0!==r&&(r<256?t[e++]=r:(t[e++]=r>>8,t[e++]=255&r)),this.seqObj=void 0}return-1!==this.leadSurrogate&&(t[e++]=this.defaultCharSingleByte,this.leadSurrogate=-1),t.slice(0,e)}},a.prototype.findIdx=o,i.prototype.write=function(t){var e,r=new s(2*t.length),n=this.nodeIdx,a=this.prevBuf,i=this.prevBuf.length,f=-this.prevBuf.length;i>0&&(a=s.concat([a,t.slice(0,10)]));for(var $=0,_=0;$<t.length;$++){var d=$>=0?t[$]:a[$+i],e=this.decodeTables[n][d];if(e>=0);else if(e===c)$=f,e=this.defaultCharUnicode.charCodeAt(0);else if(e===l){var p=f>=0?t.slice(f,$+1):a.slice(f+i,$+1+i),h=12600*(p[0]-129)+1260*(p[1]-48)+10*(p[2]-129)+(p[3]-48),g=o(this.gb18030.gbChars,h);e=this.gb18030.uChars[g]+h-this.gb18030.gbChars[g]}else{if(e<=u){n=u-e;continue}if(!(e<=-10))throw new Error("iconv-lite internal error: invalid decoding table value "+e+" at "+n+"/"+d);for(var m=this.decodeTableSeq[-10-e],v=0;v<m.length-1;v++)e=m[v],r[_++]=255&e,r[_++]=e>>8;e=m[m.length-1]}if(e>65535){e-=65536;var y=55296+Math.floor(e/1024);r[_++]=255&y,r[_++]=y>>8,e=56320+e%1024}r[_++]=255&e,r[_++]=e>>8,n=0,f=$+1}return this.nodeIdx=n,this.prevBuf=f>=0?t.slice(f):a.slice(f+i),r.slice(0,_).toString("ucs2")},i.prototype.end=function(){for(var t="";this.prevBuf.length>0;){t+=this.defaultCharUnicode;var e=this.prevBuf.slice(1);this.prevBuf=new s(0),this.nodeIdx=0,e.length>0&&(t+=this.write(e))}return this.nodeIdx=0,t}},{buffer:void 0}],55:[function(t,e,r){"use strict";e.exports={shiftjis:{type:"_dbcs",table:function(){return t("./tables/shiftjis.json")},encodeAdd:{"":92,"":126},encodeSkipVals:[{from:60736,to:63808}]},csshiftjis:"shiftjis",mskanji:"shiftjis",sjis:"shiftjis",windows31j:"shiftjis",ms31j:"shiftjis",xsjis:"shiftjis",windows932:"shiftjis",ms932:"shiftjis",932:"shiftjis",cp932:"shiftjis",eucjp:{type:"_dbcs",table:function(){return t("./tables/eucjp.json")},encodeAdd:{"":92,"":126}},gb2312:"cp936",gb231280:"cp936",gb23121980:"cp936",csgb2312:"cp936",csiso58gb231280:"cp936",euccn:"cp936",windows936:"cp936",ms936:"cp936",936:"cp936",cp936:{type:"_dbcs",table:function(){return t("./tables/cp936.json")}},gbk:{type:"_dbcs",table:function(){return t("./tables/cp936.json").concat(t("./tables/gbk-added.json"))}},xgbk:"gbk",isoir58:"gbk",gb18030:{type:"_dbcs",table:function(){return t("./tables/cp936.json").concat(t("./tables/gbk-added.json"))},gb18030:function(){return t("./tables/gb18030-ranges.json")},encodeSkipVals:[128],encodeAdd:{"":41699}},chinese:"gb18030",windows949:"cp949",ms949:"cp949",949:"cp949",cp949:{type:"_dbcs",table:function(){return t("./tables/cp949.json")}},cseuckr:"cp949",csksc56011987:"cp949",euckr:"cp949",isoir149:"cp949",korean:"cp949",ksc56011987:"cp949",ksc56011989:"cp949",ksc5601:"cp949",windows950:"cp950",ms950:"cp950",950:"cp950",cp950:{type:"_dbcs",table:function(){return t("./tables/cp950.json")}},big5:"big5hkscs",big5hkscs:{type:"_dbcs",table:function(){return t("./tables/cp950.json").concat(t("./tables/big5-added.json"))},encodeSkipVals:[41676]},cnbig5:"big5hkscs",csbig5:"big5hkscs",xxbig5:"big5hkscs"}},{"./tables/big5-added.json":61,"./tables/cp936.json":62,"./tables/cp949.json":63,"./tables/cp950.json":64,"./tables/eucjp.json":65,"./tables/gb18030-ranges.json":66,"./tables/gbk-added.json":67,"./tables/shiftjis.json":68}],56:[function(t,e,r){"use strict";for(var n=[t("./internal"),t("./utf16"),t("./utf7"),t("./sbcs-codec"),t("./sbcs-data"),t("./sbcs-data-generated"),t("./dbcs-codec"),t("./dbcs-data")],a=0;a<n.length;a++){var e=n[a];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}},{"./dbcs-codec":54,"./dbcs-data":55,"./internal":57,"./sbcs-codec":58,"./sbcs-data":60,"./sbcs-data-generated":59,"./utf16":69,"./utf7":70}],57:[function(t,e,r){"use strict";function n(t,e){this.enc=t.encodingName,this.bomAware=t.bomAware,"base64"===this.enc?this.encoder=o:"cesu8"===this.enc&&(this.enc="utf8",this.encoder=s,""!==new l("eda0bdedb2a9","hex").toString()&&(this.decoder=c,this.defaultCharUnicode=e.defaultCharUnicode))}function a(t,e){u.call(this,e.enc)}function i(t,e){this.enc=e.enc}function o(t,e){this.prevStr=""}function s(t,e){}function c(t,e){this.acc=0,this.contBytes=0,this.accBytes=0,this.defaultCharUnicode=e.defaultCharUnicode}var l=t("buffer").Buffer;e.exports={utf8:{type:"_internal",bomAware:!0},cesu8:{type:"_internal",bomAware:!0},unicode11utf8:"utf8",ucs2:{type:"_internal",bomAware:!0},utf16le:"ucs2",binary:{type:"_internal"},base64:{type:"_internal"},hex:{type:"_internal"},_internal:n},n.prototype.encoder=i,n.prototype.decoder=a;var u=t("string_decoder").StringDecoder;u.prototype.end||(u.prototype.end=function(){}),a.prototype=u.prototype,i.prototype.write=function(t){return new l(t,this.enc)},i.prototype.end=function(){},o.prototype.write=function(t){t=this.prevStr+t;var e=t.length-t.length%4;return this.prevStr=t.slice(e),t=t.slice(0,e),new l(t,"base64")},o.prototype.end=function(){return new l(this.prevStr,"base64")},s.prototype.write=function(t){for(var e=new l(3*t.length),r=0,n=0;n<t.length;n++){var a=t.charCodeAt(n);a<128?e[r++]=a:a<2048?(e[r++]=192+(a>>>6),e[r++]=128+(63&a)):(e[r++]=224+(a>>>12),e[r++]=128+(a>>>6&63),e[r++]=128+(63&a))}return e.slice(0,r)},s.prototype.end=function(){},c.prototype.write=function(t){for(var e=this.acc,r=this.contBytes,n=this.accBytes,a="",i=0;i<t.length;i++){var o=t[i];128!=(192&o)?(r>0&&(a+=this.defaultCharUnicode,r=0),o<128?a+=String.fromCharCode(o):o<224?(e=31&o,r=1,n=1):o<240?(e=15&o,r=2,n=1):a+=this.defaultCharUnicode):r>0?(e=e<<6|63&o,r--,n++,0===r&&(a+=2===n&&e<128&&e>0?this.defaultCharUnicode:3===n&&e<2048?this.defaultCharUnicode:String.fromCharCode(e))):a+=this.defaultCharUnicode}return this.acc=e,this.contBytes=r,this.accBytes=n,a},c.prototype.end=function(){var t=0;return this.contBytes>0&&(t+=this.defaultCharUnicode),t}},{buffer:void 0,string_decoder:void 0}],58:[function(t,e,r){"use strict";function n(t,e){if(!t)throw new Error("SBCS codec is called without the data.");if(!t.chars||128!==t.chars.length&&256!==t.chars.length)throw new Error("Encoding '"+t.type+"' has incorrect 'chars' (must be of len 128 or 256)");if(128===t.chars.length){for(var r="",n=0;n<128;n++)r+=String.fromCharCode(n);t.chars=r+t.chars}this.decodeBuf=new o(t.chars,"ucs2");var a=new o(65536);a.fill(e.defaultCharSingleByte.charCodeAt(0));for(var n=0;n<t.chars.length;n++)a[t.chars.charCodeAt(n)]=n;this.encodeBuf=a}function a(t,e){this.encodeBuf=e.encodeBuf}function i(t,e){this.decodeBuf=e.decodeBuf}var o=t("buffer").Buffer;r._sbcs=n,n.prototype.encoder=a,n.prototype.decoder=i,a.prototype.write=function(t){for(var e=new o(t.length),r=0;r<t.length;r++)e[r]=this.encodeBuf[t.charCodeAt(r)];return e},a.prototype.end=function(){},i.prototype.write=function(t){for(var e=this.decodeBuf,r=new o(2*t.length),n=0,a=0,i=0;i<t.length;i++)n=2*t[i],a=2*i,r[a]=e[n],r[a+1]=e[n+1];return r.toString("ucs2")},i.prototype.end=function(){}},{buffer:void 0}],59:[function(t,e,r){"use strict";e.exports={437:"cp437",737:"cp737",775:"cp775",850:"cp850",852:"cp852",855:"cp855",856:"cp856",857:"cp857",858:"cp858",860:"cp860",861:"cp861",862:"cp862",863:"cp863",864:"cp864",865:"cp865",866:"cp866",869:"cp869",874:"windows874",922:"cp922",1046:"cp1046",1124:"cp1124",1125:"cp1125",1129:"cp1129",1133:"cp1133",1161:"cp1161",1162:"cp1162",1163:"cp1163",1250:"windows1250",1251:"windows1251",1252:"windows1252",1253:"windows1253",1254:"windows1254",1255:"windows1255",1256:"windows1256",1257:"windows1257",1258:"windows1258",28591:"iso88591",28592:"iso88592",28593:"iso88593",28594:"iso88594",28595:"iso88595",28596:"iso88596",28597:"iso88597",28598:"iso88598",28599:"iso88599",28600:"iso885910",28601:"iso885911",28603:"iso885913",28604:"iso885914",28605:"iso885915",28606:"iso885916",windows874:{type:"_sbcs",chars:""},win874:"windows874",cp874:"windows874",windows1250:{type:"_sbcs",chars:""},win1250:"windows1250",cp1250:"windows1250",windows1251:{type:"_sbcs",chars:""},win1251:"windows1251",cp1251:"windows1251",windows1252:{type:"_sbcs",chars:""},win1252:"windows1252",cp1252:"windows1252",windows1253:{type:"_sbcs",chars:""},win1253:"windows1253",cp1253:"windows1253",windows1254:{type:"_sbcs",chars:""},win1254:"windows1254",cp1254:"windows1254",windows1255:{type:"_sbcs",chars:""},win1255:"windows1255",cp1255:"windows1255",windows1256:{type:"_sbcs",chars:""},win1256:"windows1256",cp1256:"windows1256",windows1257:{type:"_sbcs",chars:""},win1257:"windows1257",cp1257:"windows1257",windows1258:{type:"_sbcs",chars:""},win1258:"windows1258",cp1258:"windows1258",iso88591:{type:"_sbcs",chars:""},cp28591:"iso88591",iso88592:{type:"_sbcs",chars:""},cp28592:"iso88592",iso88593:{type:"_sbcs",chars:""},cp28593:"iso88593",iso88594:{type:"_sbcs",chars:""},cp28594:"iso88594",iso88595:{type:"_sbcs",chars:""},cp28595:"iso88595",iso88596:{type:"_sbcs",chars:""},cp28596:"iso88596",iso88597:{type:"_sbcs",chars:""},cp28597:"iso88597",iso88598:{type:"_sbcs",chars:""},cp28598:"iso88598",iso88599:{type:"_sbcs",chars:""},cp28599:"iso88599",iso885910:{type:"_sbcs",chars:""},cp28600:"iso885910",iso885911:{type:"_sbcs",chars:""},cp28601:"iso885911",iso885913:{type:"_sbcs",chars:""},cp28603:"iso885913",iso885914:{type:"_sbcs",chars:""},cp28604:"iso885914",iso885915:{type:"_sbcs",chars:""},cp28605:"iso885915",iso885916:{type:"_sbcs",chars:""},cp28606:"iso885916",cp437:{type:"_sbcs",chars:""},ibm437:"cp437",csibm437:"cp437",cp737:{type:"_sbcs",chars:""},ibm737:"cp737",csibm737:"cp737",cp775:{type:"_sbcs",chars:""},ibm775:"cp775",csibm775:"cp775",cp850:{type:"_sbcs",chars:""},ibm850:"cp850",csibm850:"cp850",cp852:{type:"_sbcs",chars:""},ibm852:"cp852",csibm852:"cp852",cp855:{type:"_sbcs",chars:""},ibm855:"cp855",csibm855:"cp855",cp856:{type:"_sbcs",chars:""},ibm856:"cp856",csibm856:"cp856",cp857:{type:"_sbcs",chars:""},ibm857:"cp857",csibm857:"cp857",cp858:{type:"_sbcs",chars:""},ibm858:"cp858",csibm858:"cp858",cp860:{type:"_sbcs",chars:""},ibm860:"cp860",csibm860:"cp860",cp861:{type:"_sbcs",chars:""},ibm861:"cp861",csibm861:"cp861",cp862:{type:"_sbcs",chars:""},ibm862:"cp862",csibm862:"cp862",cp863:{type:"_sbcs",chars:""},ibm863:"cp863",csibm863:"cp863",cp864:{type:"_sbcs",chars:"\0\b\t\n\v\f\r !\"#$&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~"},ibm864:"cp864",csibm864:"cp864",cp865:{type:"_sbcs",chars:""},ibm865:"cp865",csibm865:"cp865",cp866:{type:"_sbcs",chars:""},ibm866:"cp866",csibm866:"cp866",cp869:{type:"_sbcs",chars:""},ibm869:"cp869",csibm869:"cp869",cp922:{type:"_sbcs",chars:""},ibm922:"cp922",csibm922:"cp922",cp1046:{type:"_sbcs",chars:""},ibm1046:"cp1046",csibm1046:"cp1046",cp1124:{type:"_sbcs",chars:""},ibm1124:"cp1124",csibm1124:"cp1124",cp1125:{type:"_sbcs",chars:""},ibm1125:"cp1125",csibm1125:"cp1125",cp1129:{type:"_sbcs",chars:""},ibm1129:"cp1129",csibm1129:"cp1129",cp1133:{type:"_sbcs",chars:""},ibm1133:"cp1133",csibm1133:"cp1133",cp1161:{type:"_sbcs",chars:""},ibm1161:"cp1161",csibm1161:"cp1161",cp1162:{type:"_sbcs",chars:""},ibm1162:"cp1162",csibm1162:"cp1162",cp1163:{type:"_sbcs",chars:""},ibm1163:"cp1163",csibm1163:"cp1163",maccroatian:{type:"_sbcs",chars:""},maccyrillic:{type:"_sbcs",chars:""},macgreek:{type:"_sbcs",chars:""},maciceland:{type:"_sbcs",chars:""},macroman:{type:"_sbcs",chars:""},macromania:{type:"_sbcs",chars:""},macthai:{type:"_sbcs",chars:"\ufeff"},macturkish:{type:"_sbcs",chars:""},macukraine:{type:"_sbcs",chars:""},koi8r:{type:"_sbcs",chars:""},koi8u:{type:"_sbcs",chars:""},koi8ru:{type:"_sbcs",chars:""},koi8t:{type:"_sbcs",chars:""},armscii8:{type:"_sbcs",chars:")(.,-"},rk1048:{type:"_sbcs",chars:""},tcvn:{type:"_sbcs",chars:"\0\b\t\n\v\f\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~"},georgianacademy:{type:"_sbcs",chars:""},georgianps:{type:"_sbcs",chars:""},pt154:{type:"_sbcs",chars:""},viscii:{type:"_sbcs",chars:"\0\b\t\n\v\f\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~"},iso646cn:{type:"_sbcs",chars:"\0\b\t\n\v\f\r !\"#%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}"},iso646jp:{type:"_sbcs",chars:"\0\b\t\n\v\f\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[]^_`abcdefghijklmnopqrstuvwxyz{|}"},hproman8:{type:"_sbcs",chars:""},macintosh:{type:"_sbcs",chars:""},ascii:{type:"_sbcs",chars:""},tis620:{type:"_sbcs",chars:""}}},{}],60:[function(t,e,r){"use strict";e.exports={10029:"maccenteuro",maccenteuro:{type:"_sbcs",chars:""},808:"cp808",ibm808:"cp808",cp808:{type:"_sbcs",chars:""},ascii8bit:"ascii",usascii:"ascii",ansix34:"ascii",ansix341968:"ascii",ansix341986:"ascii",csascii:"ascii",cp367:"ascii",ibm367:"ascii",isoir6:"ascii",iso646us:"ascii",iso646irv:"ascii",us:"ascii",latin1:"iso88591",latin2:"iso88592",latin3:"iso88593",latin4:"iso88594",latin5:"iso88599",latin6:"iso885910",latin7:"iso885913",latin8:"iso885914",latin9:"iso885915",latin10:"iso885916",csisolatin1:"iso88591",csisolatin2:"iso88592",csisolatin3:"iso88593",csisolatin4:"iso88594",csisolatincyrillic:"iso88595",csisolatinarabic:"iso88596",csisolatingreek:"iso88597",csisolatinhebrew:"iso88598",csisolatin5:"iso88599",csisolatin6:"iso885910",l1:"iso88591",l2:"iso88592",l3:"iso88593",l4:"iso88594",l5:"iso88599",l6:"iso885910",l7:"iso885913",l8:"iso885914",l9:"iso885915",l10:"iso885916",isoir14:"iso646jp",isoir57:"iso646cn",isoir100:"iso88591",isoir101:"iso88592",isoir109:"iso88593",isoir110:"iso88594",isoir144:"iso88595",isoir127:"iso88596",isoir126:"iso88597",isoir138:"iso88598",isoir148:"iso88599",isoir157:"iso885910",isoir166:"tis620",isoir179:"iso885913",isoir199:"iso885914",isoir203:"iso885915",isoir226:"iso885916",cp819:"iso88591",ibm819:"iso88591",cyrillic:"iso88595",arabic:"iso88596",arabic8:"iso88596",ecma114:"iso88596",asmo708:"iso88596",greek:"iso88597",greek8:"iso88597",ecma118:"iso88597",elot928:"iso88597",hebrew:"iso88598",hebrew8:"iso88598",turkish:"iso88599",turkish8:"iso88599",thai:"iso885911",thai8:"iso885911",celtic:"iso885914",celtic8:"iso885914",isoceltic:"iso885914",tis6200:"tis620",tis62025291:"tis620",tis62025330:"tis620",10000:"macroman",10006:"macgreek",10007:"maccyrillic",10079:"maciceland",10081:"macturkish",cspc8codepage437:"cp437",cspc775baltic:"cp775",cspc850multilingual:"cp850",cspcp852:"cp852",cspc862latinhebrew:"cp862",cpgr:"cp869",msee:"cp1250",mscyrl:"cp1251",msansi:"cp1252",msgreek:"cp1253",msturk:"cp1254",mshebr:"cp1255",msarab:"cp1256",winbaltrim:"cp1257",cp20866:"koi8r",20866:"koi8r",ibm878:"koi8r",cskoi8r:"koi8r",cp21866:"koi8u",21866:"koi8u",ibm1168:"koi8u",strk10482002:"rk1048",tcvn5712:"tcvn",tcvn57121:"tcvn",gb198880:"iso646cn",cn:"iso646cn",csiso14jisc6220ro:"iso646jp",
jisc62201969ro:"iso646jp",jp:"iso646jp",cshproman8:"hproman8",r8:"hproman8",roman8:"hproman8",xroman8:"hproman8",ibm1051:"hproman8",mac:"macintosh",csmacintosh:"macintosh"}},{}],61:[function(t,e,r){e.exports=[["8740",""],["8767",""],["87a1",""],["8840","",4,""],["88a1",""],["8940",""],["8943",""],["8946",""],["894c",""],["89a1",""],["89ab",""],["89b0",""],["89b5",""],["89c1",""],["89c5",""],["8a40",""],["8a43",""],["8a64",""],["8a76",""],["8aa1",""],["8aac",""],["8ab2",""],["8abb",""],["8ac9",""],["8ace",""],["8adf",""],["8af6",""],["8b40",""],["8b55",""],["8ba1",""],["8bde",""],["8c40",""],["8ca1",""],["8ca7",""],["8cc9",""],["8cce",""],["8ce6",""],["8d40",""],["8d42",""],["8da1",""],["8e40",""],["8ea1",""],["8f40",""],["8fa1",""],["9040",""],["90a1",""],["9140",""],["91a1",""],["9240",""],["92a1",""],["9340",""],["93a1",""],["9440",""],["94a1",""],["9540",""],["95a1",""],["9640",""],["96a1",""],["9740",""],["97a1",""],["9840",""],["98a1",""],["9940",""],["99a1",""],["9a40",""],["9aa1",""],["9b40",""],["9b62",""],["9ba1",""],["9c40",""],["9ca1",""],["9d40",""],["9da1",""],["9e40",""],["9ea1",""],["9ead",""],["9ec5",""],["9ef5",""],["9f40",""],["9f4f",""],["9fa1",""],["9fae",""],["9fb2",""],["9fc1",""],["9fc9",""],["9fdb",""],["9fe7",""],["9feb",""],["9ff0",""],["a040",""],["a055",""],["a058",""],["a05b",""],["a063",""],["a073",""],["a0a1",""],["a0a6",""],["a0ae",""],["a0b0",""],["a0d4",""],["a0e2",""],["a3c0","",31,""],["c6a1","",9,"",9,"",9,"",23],["c740","",58,""],["c7a1","",81,"",5,"",4],["c840","",26,"",25,""],["c8a1",""],["c8cd",""],["c8f5",""],["f9fe",""],["fa40",""],["faa1",""],["fb40",""],["fba1",""],["fc40",""],["fca1",""],["fd40",""],["fda1",""],["fe40",""],["fea1",""]]},{}],62:[function(t,e,r){e.exports=[["0","\0",127,""],["8140","",5,"",9,"",6,""],["8180","",6,"",4,"",4,"",5,""],["8240","",4,"",8,"",4,"",11],["8280","",10,"",4,"",7,"",5,"",8,"",20,"",4,"",6,""],["8340","",17,"",5,"",10,"",4,"",9,""],["8380","",5,"",13,"",28,"",4,"",4,"",5],["8440","",5,"",5,""],["8480","",9,"",4,"",6,"",6,"",9,"",5,"",10,"",7,""],["8540","",9,""],["8580","",4,"",6,"",4,"",4,"",7,""],["8640","",4,"",5,"",4,"",5,""],["8680","",4,"",4,"",5,"",6,"",8,"",4,"",4,"",4,""],["8740","",7,"",11,"",4,"",4],["8780","",7,"",6,"",14,"",10,"",6,"",12,"",8,"",5,"",6],["8840","",9,"",4,"",4,""],["8880","",4,"",6,"",8,"",6,"",7,"",4,"",4,"",7],["8940","",5,"",6,"",4,"",5,"",4,"",16,""],["8980","",4,"",4,"",7,"",17,"",10,"",13,"",5,"",7,"",4,""],["8a40","",4,"",12,""],["8a80","",5,"",6,"",4,"",11,"",6,"",4,"",4,"",9,"",5],["8b40","",8,"",17,"",6,"",13,""],["8b80","",4,"",4,"",5,"",4,"",4,"",22,"",11,"",25,"",7,"",6],["8c40","",7,""],["8c80","",8,"",4,"",6,"",6,"",6,"",4,"",4,"",4],["8d40","",5,"",5,"",5,"",6,"",9,"",4],["8d80","",5,"",4,"",4,"",4,"",7,"",7,"",10,"",10,"",12,"",21,""],["8e40","",21,"",12,"",6,"",12,""],["8e80","",4,"",7,"",4,"",4,"",5,"",6,"",4,"",14,"",4,"",4,"",6],["8f40","",5,"",11,"",8,""],["8f80","",6,"",14,"",5,"",5,"",4,""],["9040","",4,"",4,"",6,""],["9080","",7,"",4,"",4,"",4,"",4,"",18,"",6],["9140","",6,"",6,"",18,"",4,""],["9180","",6,"",8,"",9,"",5,"",4,"",4,"",16,"",13,"",8,"",5,"",4,""],["9240","",6,"",5,""],["9280","",5,"",7,"",6,""],["9340","",6,"",4,"",4,"",5,""],["9380","",5,"",4,"",6,"",4,"",7,"",9,"",6,"",8,"",4,"",6,""],["9440","",24,"",7,"",7,"",4,"",8],["9480","",4,"",4,"",14,"",7,"",7,""],["9540","",4,"",4,"",6,""],["9580","",4,"",4,"",8,"",4,"",4,"",25,"",7,"",5,""],["9640","",5,"",4,""],["9680","",7,"",9,"",7,"",4,"",6,"",6,"",5],["9740","",7,"",8,"",7,"",9,""],["9780","",6,"",5,"",4,"",9,"",4,"",11,"",7,"",16,""],["9840","",4,"",5,"",9,""],["9880","",7,"",5,"",11,"",9,"",9,"",11,"",5,"",5,"",6,"",4,"",7,"",6,""],["9940","",4,"",10,"",6,"",8,"",4,"",7,"",5],["9980","",114,"",6],["9a40","",11,"",7,"",13,""],["9a80","",4,"",7,"",7,"",6,"",4,"",4,"",7,"",6,"",4,"",4,""],["9b40","",4,""],["9b80","",5,"",4,"",4,"",5,""],["9c40","",7,""],["9c80","",7,"",7,"",10,"",14,"",4,"",6,"",5],["9d40","",7,"",4,"",9,"",6,""],["9d80","",9,"",5,"",6,"",12,"",4,"",10,"",5,"",5,"",6,"",10,""],["9e40","",7,"",32,"",7,"",6,"",6],["9e80","",9,"",17,"",13,"",11,"",12,"",12,""],["9f40","",6,"",10,"",4,"",10,"",7,""],["9f80","",13,"",12,"",4,"",4,"",5,"",4,"",4,"",6,"",5,"",8,"",9,"",4],["a040","",9,"",5,"",9,"",11,"",19],["a080","",9,"",6,"",4,"",11,"",11,"",6,""],["a1a1","",7,""],["a2a1","",9],["a2b1","",19,"",19,"",9],["a2e5","",9],["a2f1","",11],["a3a1","",88,""],["a4a1","",82],["a5a1","",85],["a6a1","",16,"",6],["a6c1","",16,"",6],["a6e0",""],["a6ee",""],["a6f4",""],["a7a1","",5,"",25],["a7d1","",5,"",25],["a840","",35,"",6],["a880","",7,""],["a8a1",""],["a8bd",""],["a8c0",""],["a8c5","",36],["a940","",8,""],["a959",""],["a95c",""],["a960","",9,"",8],["a980","",4,""],["a996",""],["a9a4","",75],["aa40","",5,"",5,"",8],["aa80","",7,"",10,""],["ab40","",11,"",4,"",5,"",4],["ab80","",6,"",4],["ac40","",10,"",8,"",5,"",4,"",11],["ac80","",6,"",12,"",4,""],["ad40","",10,"",7,"",15,"",12],["ad80","",9,"",8,"",6,""],["ae40","",6,"",7,"",4,""],["ae80","",7,"",6,"",4,""],["af40","",4,""],["af80",""],["b040","",6,"",5,"",4,"",6,"",7,""],["b080","",7,"",8,"",9,""],["b140","",4,"",7,"",10,""],["b180","",4,"",7,"",7,""],["b240","",11,"",5,"",11,"",4],["b280","",12,"",8,"",4,""],["b340","",5,""],["b380","",11,"",7,"",6,""],["b440","",7,"",9],["b480","",4,"",5,"",6,""],["b540","",5,"",9,"",4,"",14,"",4,"",8,""],["b580","",6,"",4,""],["b640","",6,"",11,"",10,"",4,"",5,""],["b680","",6,"",4,""],["b740","",14,"",5,"",9,"",4,"",16],["b780","",6,""],["b840","",4,"",10,"",10,"",9,"",5,""],["b880","",4,""],["b940","",5,"",10,"",6,""],["b980","",7,""],["ba40","",4,"",4,"",7,"",5,""],["ba80","",4,"",5,"",12,"",5,""],["bb40","",9,"",36,"",5,"",9],["bb80","",6,"",4,""],["bc40","",6,"",6,"",5,"",7,"",13,"",5],["bc80","",14,"",6,""],["bd40","",54,"",7],["bd80","",32,""],["be40","",12,"",6,"",42],["be80","",32,""],["bf40","",62],["bf80","",4,"",4,"",21,""],["c040","",35,"",23,""],["c080","",6,"",9,""],["c140","",4,"",7,"",4,"",4,"",6,""],["c180","",4,"",4,"",5,""],["c240","",6,"",5,""],["c280","",13,"",5,"",11,""],["c340","",5,"",4,"",6,""],["c380","",12,"",4,""],["c440","",5,"",4,"",4,"",5,"",4,""],["c480","",7,"",5,"",6,""],["c540","",14,"",4,"",5,"",4,"",5,""],["c580","",7,"",7,""],["c640",""],["c680","",4,"",9,""],["c740","",4,"",4,"",6,"",6,"",6,""],["c780",""],["c840","",4,"",5,"",5,"",7,"",5,"",7,""],["c880","",6,"",4,"",4,""],["c940","",4,"",7,"",12,""],["c980","",4,"",4,"",10,""],["ca40","",8,"",8,"",9,"",4,"",10],["ca80","",4,"",8,""],["cb40","",6,"",10,"",6,"",5,"",6,"",6,"",4,""],["cb80","",5,"",6,"",14,""],["cc40","",4,"",10,"",15,"",13,""],["cc80","",11,"",4,"",7,""],["cd40","",6,"",6,"",4,"",5,"",4,"",4,""],["cd80",""],["ce40","",6,"",5,"",7,""],["ce80","",4,"",6,"",4,""],["cf40","",4,"",4,"",6,"",9],["cf80","",5,"",7,"",4,""],["d040","",13,"",5,"",5,"",5,"",6,""],["d080","",4,"",4,"",5,""],["d140","",4,"",4,"",6,"",5],["d180","",4,"",4,"",4,""],["d240","",8,"",24,"",5,"",19,""],["d280","",26,""],["d340","",30,"",6],["d380","",4,"",5,"",21,""],["d440","",31,"",8,"",21],["d480","",25,"",6,""],["d540","",7,"",7,"",46],["d580","",32,""],["d640","",34,"",27],["d680","",30,""],["d740","",31,"",4,"",25],["d780","",24,""],["d840","",8,"",7,"",5,"",6,"",6,"",6,""],["d880","",6,"",20,""],["d940","",62],["d980","",32,""],["da40","",14,"",8,"",4,"",9,""],["da80","",12,""],["db40","",6,"",7,"",4,""],["db80","",4,"",5,"",11,""],["dc40","",4,"",6,"",6,"",11,"",6,"",7],["dc80","",10,"",21,""],["dd40","",62],["dd80","",32,""],["de40","",32,""],["de80","",4,""],["df40","",5,"",4,"",4,"",5,"",4,"",6,""],["df80","",4,""],["e040","",19,""],["e080","",10,"",6,"",8,""],["e140","",4,"",6,"",5,"",5,""],["e180","",10,"",9,"",8,""],["e240","",62],["e280","",32,"",5,""],["e340","",45,"",16],["e380","",7,"",24,""],["e440","",5,"",24,"",31],["e480","",32,""],["e540","",51,"",10],["e580","",31,""],["e640","",34,"",27],["e680","",29,""],["e740","",7,"",54],["e780","",32,"",6,"",4,""],["e840","",14,"",43,""],["e880","",20,""],["e940","",7,"",42],["e980","",32,""],["ea40","",27,"",6,""],["ea80","",4,"",12,""],["eb40","",9,"",7,"",9,"",6,""],["eb80","",4,""],["ec40","",8,"",4,"",18,"",7],["ec80","",4,"",7,"",4,"",4,""],["ed40","",6,"",46],["ed80","",4,"",23,""],["ee40","",62],["ee80","",32,"",4,"",6,""],["ef40","",5,"",37,"",4],["ef80","",30,"",4,"",8,""],["f040","",4,"",28,"",26],["f080","",9,"",12,"",4,"",6,""],["f140","",10,"",47],["f180","",32,""],["f240","",62],["f280","",32,""],["f340","",17,"",6,"",4,""],["f380","",8,"",6,""],["f440","",5,"",10,"",10,"",7,"",5],["f480","",32,""],["f540","",62],["f580","",32,""],["f640","",62],["f680","",32,"",5,"",5,"",4,"",7,""],["f740","",62],["f780","",4,"",4,""],["f840","",62],["f880","",32],["f940","",62],["f980","",32],["fa40","",62],["fa80","",32],["fb40","",27,"",9,""],["fb80","",5,"",8,"",5,""],["fc40","",8,"",4,"",8,"",6],["fc80","",4,"",5,"",8,""],["fd40","",4,"",4,"",10,"",38],["fd80","",5,"",11,"",4,""],["fe40",""]]},{}],63:[function(t,e,r){
e.exports=[["0","\0",127],["8141","",4,"",6,""],["8161","",9,"",5,""],["8181","",18,"",4,"",6,"",5,"",6,"",7,"",7,"",4,"",4,""],["8241","",7,"",5],["8261","",6,"",5,""],["8281","",7,"",7,"",4,"",10,"",5,"",17,"",7,"",6,"",7,"",18],["8341","",5,"",5,"",7],["8361","",18,""],["8381","",4,"",6,"",5,"",5,"",46,"",6,"",5,"",8],["8441","",5,"",8],["8461","",18],["8481","",7,"",6,"",5,"",10,"",5,"",18,"",5,"",6,"",5,"",26,""],["8541","",5,"",4,"",6,"",4],["8561","",5,"",5,"",6,""],["8581","",6,"",6,"",9,"",26,"",29,"",6,"",5,""],["8641","",6,"",5,""],["8661","",6,"",10],["8681","",22,"",4,"",6,"",5,"",6,"",22,"",4,""],["8741","",9,"",15],["8761","",18,""],["8781","",5,"",7,"",7,"",5,"",6,"",5,"",18,"",6,"",26,"",6,"",4],["8841","",4,"",5,"",6,"",4],["8861","",4,""],["8881","",15,"",4,"",6,"",5,"",54,""],["8941","",6,"",5,""],["8961","",10,"",5,""],["8981","",21,"",18,"",18,"",6,"",6,"",7,"",15],["8a41","",10,"",6,""],["8a61","",4,"",18,""],["8a81","",4,"",19,"",5,"",7,"",5,"",6,"",5,"",4,"",5,"",26,""],["8b41","",5,"",4,"",6,""],["8b61","",6,"",8],["8b81","",52,"",4,"",6,"",5,"",18,"",18],["8c41","",15,"",4],["8c61","",6,"",5,"",6,"",5],["8c81","",12,"",26,"",50,"",5,"",16],["8d41","",16,"",8],["8d61","",17,""],["8d81","",4,"",33,"",6,"",7,"",6,"",9,"",6,"",5,"",6,""],["8e41","",6,"",5,"",8],["8e61","",4,"",19],["8e81","",13,"",6,"",4,"",6,"",5,"",6,"",5,"",11,"",7,"",6,"",5,"",7],["8f41","",7,"",17],["8f61","",7,"",6,"",4],["8f81","",5,"",7,"",5,"",6,"",5,"",18,"",6,"",26,"",6,"",5],["9041","",6,"",5,""],["9061","",5,"",15],["9081","",12,"",6,"",5,"",4,"",6,"",4,"",5,"",11,"",33,""],["9141","",6,"",5],["9161","",9,"",5],["9181","",20,"",4,"",5,"",14,"",33,"",7,"",5,"",6],["9241","",7,"",4,""],["9261","",7,"",7,"",4],["9281","",21,"",18,"",6,"",7,"",6,"",35,""],["9341","",4,""],["9361","",6,"",8],["9381","",37,"",4,"",4,"",6,"",5,"",7,"",22,""],["9441","",5,"",5,"",8],["9461","",5,"",6,"",12],["9481","",5,"",6,"",6,"",9,"",22,"",4,"",6,"",10,"",6,"",24],["9541","",11,"",5,""],["9561","",6,"",5,""],["9581","",6,"",35,"",4,"",4,"",4,"",6,"",5,"",13,"",14],["9641","",23,""],["9661","",6,"",5,"",8],["9681","",10,"",5,"",13,"",33,"",6,"",44],["9741","",16,"",8],["9761","",17,"",7],["9781","",11,"",5,"",6,"",89,""],["9841","",16,"",5,""],["9861","",6,"",15],["9881","",21,"",6,"",5,"",4,"",6,"",5,"",6,"",5,"",6,"",5,""],["9941","",6,"",5,""],["9961","",6,"",5,""],["9981","",8,"",5,"",4,"",11,"",5,"",6,"",6,"",6,"",7,"",6,"",5,""],["9a41","",16],["9a61","",6,"",6,""],["9a81","",4,"",6,"",5,"",5,"",6,"",5,"",5,"",33,"",5,"",6,""],["9b41","",6,"",8],["9b61","",17,"",7],["9b81","",25,"",4,"",5,"",50,"",22,""],["9c41","",4,"",5,"",5],["9c61","",8,"",6,"",9],["9c81","",8,"",6,"",6,"",9,"",26,"",6,"",5,"",18,"",6,"",12],["9d41","",13,"",8],["9d61","",25],["9d81","",8,"",5,"",9,"",6,"",10,"",6,"",5,"",6,"",5,""],["9e41","",7,"",9,""],["9e61","",4,"",6,""],["9e81","",6,"",6,"",6,"",5,"",10,"",5,"",6,"",5,"",6,""],["9f41","",5,"",4,"",5,""],["9f61","",6,"",5,""],["9f81","",4,"",5,"",6,"",5,"",6,"",4,"",6,"",7,"",4,"",4,""],["a041","",5,"",6,""],["a061","",5,"",13],["a081","",4,"",4,"",4,"",6,"",5,"",6,"",5,"",26,"",4,"",5,"",7,""],["a141","",18,""],["a161","",6,"",5,""],["a181","",14,"",5,"",4,"",9,""],["a241","",5,"",18],["a261","",6,"",18],["a281","",7,"",6,"",7,""],["a341","",6,"",10,""],["a361","",6,"",16],["a381","",16,"",4,"",58,"",32,""],["a441","",5,""],["a461","",5,"",12],["a481","",28,"",93],["a541","",4,"",6,"",5,""],["a561","",17,"",5,""],["a581","",16,"",14,"",9],["a5b0","",9],["a5c1","",16,"",6],["a5e1","",16,"",6],["a641","",19,""],["a661","",5,"",5,"",6],["a681","",6,"",18,"",7],["a741","",4,"",6,"",7],["a761","",22,""],["a781","",6,"",5,"",7,"",9,"",9,"",4,"",5,"",4,""],["a841","",10,"",14],["a861","",18,"",6],["a881","",19,"",11,""],["a8a6",""],["a8a8",""],["a8b1","",27,"",25,"",14,""],["a941","",14,"",10],["a961","",18],["a981","",14,"",6,"",27,"",25,"",14,""],["aa41","",6,"",4,""],["aa61","",4,"",5,"",6,""],["aa81","",29,"",82],["ab41","",6,"",5,""],["ab61","",6,"",5,"",5],["ab81","",8,"",6,"",12,"",85],["ac41","",5,"",6,""],["ac61","",11,"",4],["ac81","",28,"",5,"",25],["acd1","",5,"",25],["ad41","",6,"",5,"",7],["ad61","",6,"",10,""],["ad81","",5,"",18,""],["ae41","",5,"",16],["ae61","",5,"",6,"",4],["ae81","",6,"",5,""],["af41","",19],["af61","",13,"",5,""],["af81","",5,"",6,"",5,""],["b041","",5,"",5,"",12],["b061","",5,"",19],["b081","",13,"",6,"",5,"",7,"",4,""],["b141","",6,"",5,""],["b161","",6,"",5,"",11],["b181","",14,"",6,""],["b241","",6,"",5,""],["b261","",18,"",5,""],["b281","",5,"",18,"",6,""],["b341","",19,""],["b361","",5,"",5,"",5],["b381","",5,"",5,"",19,"",4,""],["b441","",5,"",6,"",5],["b461","",6,"",10,""],["b481","",6,"",18,"",4,"",4,""],["b541","",14,"",5],["b561","",5,"",5,"",4],["b581","",6,"",5,"",11,""],["b641","",7,"",17],["b661","",15,""],["b681","",5,"",6,"",5,""],["b741","",13,"",6,""],["b761","",20,""],["b781","",6,"",14,""],["b841","",7,"",17],["b861","",8,"",13],["b881","",5,"",24,"",4,""],["b941","",6,"",5,""],["b961","",14,"",6,""],["b981","",22,"",4,"",4,""],["ba41","",5,"",6,""],["ba61","",5,"",4,"",5],["ba81","",6,"",9,""],["bb41","",4,"",5,"",4,""],["bb61","",6,"",5,""],["bb81","",31,""],["bc41","",17,""],["bc61","",5,"",6,""],["bc81","",4,"",6,"",5,"",5,"",4,""],["bd41","",7,"",7,""],["bd61","",5,"",13],["bd81","",5,"",25,""],["be41","",7,"",14],["be61","",7,"",7,""],["be81","",4,"",4,"",5,"",8,"",6,""],["bf41","",10,"",14],["bf61","",18,""],["bf81","",5,"",7,"",6,"",5,""],["c041","",5,"",6,"",5],["c061","",25],["c081","",6,"",5,"",7,""],["c141","",5,"",6,""],["c161","",19,""],["c181","",31,""],["c241","",4,"",5,""],["c261","",4,"",5,"",6,""],["c281","",5,"",7,"",9,""],["c341","",4],["c361","",4,"",5,"",11],["c381","",5,"",7,"",5,""],["c441","",7,"",7,""],["c461","",5,"",4],["c481","",5,"",11,""],["c541","",6,"",5,""],["c561","",6,"",5,"",4],["c581","",6,"",5,""],["c641","",6,"",5],["c6a1",""],["c7a1",""],["c8a1",""],["caa1",""],["cba1",""],["cca1",""],["cda1",""],["cea1",""],["cfa1",""],["d0a1",""],["d1a1","",5,"",4,""],["d2a1","",4,"",5,"",10,"",7,"",5,""],["d3a1",""],["d4a1",""],["d5a1",""],["d6a1",""],["d7a1",""],["d8a1",""],["d9a1",""],["daa1",""],["dba1",""],["dca1",""],["dda1",""],["dea1",""],["dfa1",""],["e0a1",""],["e1a1",""],["e2a1",""],["e3a1",""],["e4a1",""],["e5a1",""],["e6a1",""],["e7a1",""],["e8a1",""],["e9a1",""],["eaa1",""],["eba1",""],["eca1",""],["eda1",""],["eea1",""],["efa1",""],["f0a1",""],["f1a1",""],["f2a1",""],["f3a1",""],["f4a1",""],["f5a1",""],["f6a1",""],["f7a1",""],["f8a1",""],["f9a1",""],["faa1",""],["fba1",""],["fca1",""],["fda1",""]]},{}],64:[function(t,e,r){
e.exports=[["0","\0",127],["a140",""],["a1a1","",4,""],["a240","",7,""],["a2a1","",9,"",9,"",8,"",25,"",21],["a340","",16,"",6,"",16,"",6,"",10],["a3a1","",25,""],["a3e1",""],["a440",""],["a4a1",""],["a540",""],["a5a1",""],["a640",""],["a6a1",""],["a740",""],["a7a1",""],["a840",""],["a8a1",""],["a940",""],["a9a1",""],["aa40",""],["aaa1",""],["ab40",""],["aba1",""],["ac40",""],["aca1",""],["ad40",""],["ada1",""],["ae40",""],["aea1",""],["af40",""],["afa1",""],["b040",""],["b0a1",""],["b140",""],["b1a1",""],["b240",""],["b2a1",""],["b340",""],["b3a1",""],["b440",""],["b4a1",""],["b540",""],["b5a1",""],["b640",""],["b6a1",""],["b740",""],["b7a1",""],["b840",""],["b8a1",""],["b940",""],["b9a1",""],["ba40",""],["baa1",""],["bb40",""],["bba1",""],["bc40",""],["bca1",""],["bd40",""],["bda1",""],["be40",""],["bea1",""],["bf40",""],["bfa1",""],["c040",""],["c0a1",""],["c140",""],["c1a1",""],["c240",""],["c2a1",""],["c340",""],["c3a1",""],["c440",""],["c4a1",""],["c540",""],["c5a1",""],["c640",""],["c940",""],["c9a1",""],["ca40",""],["caa1",""],["cb40",""],["cba1",""],["cc40",""],["cca1",""],["cd40",""],["cda1",""],["ce40",""],["cea1",""],["cf40",""],["cfa1",""],["d040",""],["d0a1",""],["d140",""],["d1a1",""],["d240",""],["d2a1",""],["d340",""],["d3a1",""],["d440",""],["d4a1",""],["d540",""],["d5a1",""],["d640",""],["d6a1",""],["d740",""],["d7a1",""],["d840",""],["d8a1",""],["d940",""],["d9a1",""],["da40",""],["daa1",""],["db40",""],["dba1",""],["dc40",""],["dca1",""],["dd40",""],["dda1",""],["de40",""],["dea1",""],["df40",""],["dfa1",""],["e040",""],["e0a1",""],["e140",""],["e1a1",""],["e240",""],["e2a1",""],["e340",""],["e3a1",""],["e440",""],["e4a1",""],["e540",""],["e5a1",""],["e640",""],["e6a1",""],["e740",""],["e7a1",""],["e840",""],["e8a1",""],["e940",""],["e9a1",""],["ea40",""],["eaa1",""],["eb40",""],["eba1",""],["ec40",""],["eca1",""],["ed40",""],["eda1",""],["ee40",""],["eea1",""],["ef40",""],["efa1",""],["f040",""],["f0a1",""],["f140",""],["f1a1",""],["f240",""],["f2a1",""],["f340",""],["f3a1",""],["f440",""],["f4a1",""],["f540",""],["f5a1",""],["f640",""],["f6a1",""],["f740",""],["f7a1",""],["f840",""],["f8a1",""],["f940",""],["f9a1",""]]},{}],65:[function(t,e,r){e.exports=[["0","\0",127],["8ea1","",62],["a1a1","",9,""],["a2a1",""],["a2ba",""],["a2ca",""],["a2dc",""],["a2f2",""],["a2fe",""],["a3b0","",9],["a3c1","",25],["a3e1","",25],["a4a1","",82],["a5a1","",85],["a6a1","",16,"",6],["a6c1","",16,"",6],["a7a1","",5,"",25],["a7d1","",5,"",25],["a8a1",""],["ada1","",19,"",9],["adc0",""],["addf","",4,""],["b0a1",""],["b1a1",""],["b2a1",""],["b3a1",""],["b4a1",""],["b5a1",""],["b6a1",""],["b7a1",""],["b8a1",""],["b9a1",""],["baa1",""],["bba1",""],["bca1",""],["bda1",""],["bea1",""],["bfa1",""],["c0a1",""],["c1a1",""],["c2a1",""],["c3a1",""],["c4a1",""],["c5a1",""],["c6a1",""],["c7a1",""],["c8a1",""],["c9a1",""],["caa1",""],["cba1",""],["cca1",""],["cda1",""],["cea1",""],["cfa1",""],["d0a1",""],["d1a1",""],["d2a1",""],["d3a1",""],["d4a1",""],["d5a1",""],["d6a1",""],["d7a1",""],["d8a1",""],["d9a1",""],["daa1",""],["dba1",""],["dca1",""],["dda1",""],["dea1",""],["dfa1",""],["e0a1",""],["e1a1",""],["e2a1",""],["e3a1",""],["e4a1",""],["e5a1",""],["e6a1",""],["e7a1",""],["e8a1",""],["e9a1",""],["eaa1",""],["eba1",""],["eca1",""],["eda1",""],["eea1",""],["efa1",""],["f0a1",""],["f1a1",""],["f2a1",""],["f3a1",""],["f4a1",""],["f9a1",""],["faa1",""],["fba1",""],["fca1",""],["fcf1","",9,""],["8fa2af",""],["8fa2c2",""],["8fa2eb",""],["8fa6e1",""],["8fa6e7",""],["8fa6e9",""],["8fa6ec",""],["8fa6f1",""],["8fa7c2","",10,""],["8fa7f2","",10,""],["8fa9a1",""],["8fa9a4",""],["8fa9a6",""],["8fa9a8",""],["8fa9ab",""],["8fa9af",""],["8fa9c1",""],["8faaa1",""],["8faaba",""],["8faba1",""],["8fabbd",""],["8fabc5",""],["8fb0a1",""],["8fb1a1",""],["8fb2a1","",4,""],["8fb3a1",""],["8fb4a1",""],["8fb5a1",""],["8fb6a1","",5,"",4,""],["8fb7a1","",4,""],["8fb8a1",""],["8fb9a1",""],["8fbaa1","",4,""],["8fbba1",""],["8fbca1","",4,""],["8fbda1","",4,""],["8fbea1","",4,""],["8fbfa1",""],["8fc0a1",""],["8fc1a1",""],["8fc2a1",""],["8fc3a1","",4,""],["8fc4a1",""],["8fc5a1",""],["8fc6a1",""],["8fc7a1",""],["8fc8a1",""],["8fc9a1","",4,"",4,""],["8fcaa1",""],["8fcba1",""],["8fcca1","",9,""],["8fcda1","",5,""],["8fcea1","",6,""],["8fcfa1",""],["8fd0a1",""],["8fd1a1",""],["8fd2a1","",5],["8fd3a1",""],["8fd4a1","",4,""],["8fd5a1",""],["8fd6a1",""],["8fd7a1",""],["8fd8a1",""],["8fd9a1","",4,"",6,""],["8fdaa1","",4,""],["8fdba1","",6,""],["8fdca1","",4,""],["8fdda1","",4,""],["8fdea1","",4,""],["8fdfa1",""],["8fe0a1",""],["8fe1a1","",4,""],["8fe2a1",""],["8fe3a1","",5,"",4,""],["8fe4a1","",4,""],["8fe5a1","",4,""],["8fe6a1",""],["8fe7a1",""],["8fe8a1","",4,""],["8fe9a1","",4],["8feaa1","",4,""],["8feba1","",4,""],["8feca1",""],["8feda1","",4,"",4,""]]},{}],66:[function(t,e,r){e.exports={
uChars:[128,165,169,178,184,216,226,235,238,244,248,251,253,258,276,284,300,325,329,334,364,463,465,467,469,471,473,475,477,506,594,610,712,716,730,930,938,962,970,1026,1104,1106,8209,8215,8218,8222,8231,8241,8244,8246,8252,8365,8452,8454,8458,8471,8482,8556,8570,8596,8602,8713,8720,8722,8726,8731,8737,8740,8742,8748,8751,8760,8766,8777,8781,8787,8802,8808,8816,8854,8858,8870,8896,8979,9322,9372,9548,9588,9616,9622,9634,9652,9662,9672,9676,9680,9702,9735,9738,9793,9795,11906,11909,11913,11917,11928,11944,11947,11951,11956,11960,11964,11979,12284,12292,12312,12319,12330,12351,12436,12447,12535,12543,12586,12842,12850,12964,13200,13215,13218,13253,13263,13267,13270,13384,13428,13727,13839,13851,14617,14703,14801,14816,14964,15183,15471,15585,16471,16736,17208,17325,17330,17374,17623,17997,18018,18212,18218,18301,18318,18760,18811,18814,18820,18823,18844,18848,18872,19576,19620,19738,19887,40870,59244,59336,59367,59413,59417,59423,59431,59437,59443,59452,59460,59478,59493,63789,63866,63894,63976,63986,64016,64018,64021,64025,64034,64037,64042,65074,65093,65107,65112,65127,65132,65375,65510,65536],gbChars:[0,36,38,45,50,81,89,95,96,100,103,104,105,109,126,133,148,172,175,179,208,306,307,308,309,310,311,312,313,341,428,443,544,545,558,741,742,749,750,805,819,820,7922,7924,7925,7927,7934,7943,7944,7945,7950,8062,8148,8149,8152,8164,8174,8236,8240,8262,8264,8374,8380,8381,8384,8388,8390,8392,8393,8394,8396,8401,8406,8416,8419,8424,8437,8439,8445,8482,8485,8496,8521,8603,8936,8946,9046,9050,9063,9066,9076,9092,9100,9108,9111,9113,9131,9162,9164,9218,9219,11329,11331,11334,11336,11346,11361,11363,11366,11370,11372,11375,11389,11682,11686,11687,11692,11694,11714,11716,11723,11725,11730,11736,11982,11989,12102,12336,12348,12350,12384,12393,12395,12397,12510,12553,12851,12962,12973,13738,13823,13919,13933,14080,14298,14585,14698,15583,15847,16318,16434,16438,16481,16729,17102,17122,17315,17320,17402,17418,17859,17909,17911,17915,17916,17936,17939,17961,18664,18703,18814,18962,19043,33469,33470,33471,33484,33485,33490,33497,33501,33505,33513,33520,33536,33550,37845,37921,37948,38029,38038,38064,38065,38066,38069,38075,38076,38078,39108,39109,39113,39114,39115,39116,39265,39394,189e3]}},{}],67:[function(t,e,r){e.exports=[["a140","",62],["a180","",32],["a240","",62],["a280","",32],["a2ab","",5],["a2e3",""],["a2ef",""],["a2fd",""],["a340","",62],["a380","",31,""],["a440","",62],["a480","",32],["a4f4","",10],["a540","",62],["a580","",32],["a5f7","",7],["a640","",62],["a680","",32],["a6b9","",7],["a6d9","",6],["a6ec",""],["a6f3",""],["a6f6","",8],["a740","",62],["a780","",32],["a7c2","",14],["a7f2","",12],["a896","",10],["a8bc",""],["a8bf",""],["a8c1",""],["a8ea","",20],["a958",""],["a95b",""],["a95d",""],["a989","",11],["a997","",12],["a9f0","",14],["aaa1","",93],["aba1","",93],["aca1","",93],["ada1","",93],["aea1","",93],["afa1","",93],["d7fa","",4],["f8a1","",93],["f9a1","",93],["faa1","",93],["fba1","",93],["fca1","",93],["fda1","",93],["fe50",""],["fe80","",6,"",93]]},{}],68:[function(t,e,r){e.exports=[["0","\0",128],["a1","",62],["8140","",9,""],["8180",""],["81b8",""],["81c8",""],["81da",""],["81f0",""],["81fc",""],["824f","",9],["8260","",25],["8281","",25],["829f","",82],["8340","",62],["8380","",22],["839f","",16,"",6],["83bf","",16,"",6],["8440","",5,"",25],["8470","",5,"",7],["8480","",17],["849f",""],["8740","",19,"",9],["875f",""],["877e",""],["8780","",4,""],["889f",""],["8940",""],["8980",""],["8a40",""],["8a80",""],["8b40",""],["8b80",""],["8c40",""],["8c80",""],["8d40",""],["8d80",""],["8e40",""],["8e80",""],["8f40",""],["8f80",""],["9040",""],["9080",""],["9140",""],["9180",""],["9240",""],["9280",""],["9340",""],["9380",""],["9440",""],["9480",""],["9540",""],["9580",""],["9640",""],["9680",""],["9740",""],["9780",""],["9840",""],["989f",""],["9940",""],["9980",""],["9a40",""],["9a80",""],["9b40",""],["9b80",""],["9c40",""],["9c80",""],["9d40",""],["9d80",""],["9e40",""],["9e80",""],["9f40",""],["9f80",""],["e040",""],["e080",""],["e140",""],["e180",""],["e240",""],["e280",""],["e340",""],["e380",""],["e440",""],["e480",""],["e540",""],["e580",""],["e640",""],["e680",""],["e740",""],["e780",""],["e840",""],["e880",""],["e940",""],["e980",""],["ea40",""],["ea80",""],["ed40",""],["ed80",""],["ee40",""],["ee80",""],["eeef","",9,""],["f040","",62],["f080","",124],["f140","",62],["f180","",124],["f240","",62],["f280","",124],["f340","",62],["f380","",124],["f440","",62],["f480","",124],["f540","",62],["f580","",124],["f640","",62],["f680","",124],["f740","",62],["f780","",124],["f840","",62],["f880","",124],["f940",""],["fa40","",9,"",9,""],["fa80",""],["fb40",""],["fb80",""],["fc40",""]]},{}],69:[function(t,e,r){"use strict";function n(){}function a(){}function i(){this.overflowByte=-1}function o(t,e){this.iconv=e}function s(t,e){t=t||{},void 0===t.addBOM&&(t.addBOM=!0),this.encoder=e.iconv.getEncoder("utf-16le",t)}function c(t,e){this.decoder=null,this.initialBytes=[],this.initialBytesLen=0,this.options=t||{},this.iconv=e.iconv}function l(t,e){var r=e||"utf-16le";if(t.length>=2)if(254==t[0]&&255==t[1])r="utf-16be";else if(255==t[0]&&254==t[1])r="utf-16le";else{for(var n=0,a=0,i=Math.min(t.length-t.length%2,64),o=0;o<i;o+=2)0===t[o]&&0!==t[o+1]&&a++,0!==t[o]&&0===t[o+1]&&n++;a>n?r="utf-16be":a<n&&(r="utf-16le")}return r}var u=t("buffer").Buffer;r.utf16be=n,n.prototype.encoder=a,n.prototype.decoder=i,n.prototype.bomAware=!0,a.prototype.write=function(t){for(var e=new u(t,"ucs2"),r=0;r<e.length;r+=2){var n=e[r];e[r]=e[r+1],e[r+1]=n}return e},a.prototype.end=function(){},i.prototype.write=function(t){if(0==t.length)return"";var e=new u(t.length+1),r=0,n=0;for(-1!==this.overflowByte&&(e[0]=t[0],e[1]=this.overflowByte,r=1,n=2);r<t.length-1;r+=2,n+=2)e[n]=t[r+1],e[n+1]=t[r];return this.overflowByte=r==t.length-1?t[t.length-1]:-1,e.slice(0,n).toString("ucs2")},i.prototype.end=function(){},r.utf16=o,o.prototype.encoder=s,o.prototype.decoder=c,s.prototype.write=function(t){return this.encoder.write(t)},s.prototype.end=function(){return this.encoder.end()},c.prototype.write=function(t){if(!this.decoder){if(this.initialBytes.push(t),this.initialBytesLen+=t.length,this.initialBytesLen<16)return"";var t=u.concat(this.initialBytes),e=l(t,this.options.defaultEncoding);this.decoder=this.iconv.getDecoder(e,this.options),this.initialBytes.length=this.initialBytesLen=0}return this.decoder.write(t)},c.prototype.end=function(){if(!this.decoder){var t=u.concat(this.initialBytes),e=l(t,this.options.defaultEncoding);this.decoder=this.iconv.getDecoder(e,this.options);var r=this.decoder.write(t),n=this.decoder.end();return n?r+n:r}return this.decoder.end()}},{buffer:void 0}],70:[function(t,e,r){"use strict";function n(t,e){this.iconv=e}function a(t,e){this.iconv=e.iconv}function i(t,e){this.iconv=e.iconv,this.inBase64=!1,this.base64Accum=""}function o(t,e){this.iconv=e}function s(t,e){this.iconv=e.iconv,this.inBase64=!1,this.base64Accum=new l(6),this.base64AccumIdx=0}function c(t,e){this.iconv=e.iconv,this.inBase64=!1,this.base64Accum=""}var l=t("buffer").Buffer;r.utf7=n,r.unicode11utf7="utf7",n.prototype.encoder=a,n.prototype.decoder=i,n.prototype.bomAware=!0;var u=/[^A-Za-z0-9'\(\),-\.\/:\? \n\r\t]+/g;a.prototype.write=function(t){return new l(t.replace(u,function(t){return"+"+("+"===t?"":this.iconv.encode(t,"utf16-be").toString("base64").replace(/=+$/,""))+"-"}.bind(this)))},a.prototype.end=function(){};for(var f=/[A-Za-z0-9\/+]/,$=[],_=0;_<256;_++)$[_]=f.test(String.fromCharCode(_));var d="+".charCodeAt(0),p="-".charCodeAt(0),h="&".charCodeAt(0);i.prototype.write=function(t){for(var e="",r=0,n=this.inBase64,a=this.base64Accum,i=0;i<t.length;i++)if(n){if(!$[t[i]]){if(i==r&&t[i]==p)e+="+";else{var o=a+t.slice(r,i).toString();e+=this.iconv.decode(new l(o,"base64"),"utf16-be")}t[i]!=p&&i--,r=i+1,n=!1,a=""}}else t[i]==d&&(e+=this.iconv.decode(t.slice(r,i),"ascii"),r=i+1,n=!0);if(n){var o=a+t.slice(r).toString(),s=o.length-o.length%8;a=o.slice(s),o=o.slice(0,s),e+=this.iconv.decode(new l(o,"base64"),"utf16-be")}else e+=this.iconv.decode(t.slice(r),"ascii");return this.inBase64=n,this.base64Accum=a,e},i.prototype.end=function(){var t="";return this.inBase64&&this.base64Accum.length>0&&(t=this.iconv.decode(new l(this.base64Accum,"base64"),"utf16-be")),this.inBase64=!1,this.base64Accum="",t},r.utf7imap=o,o.prototype.encoder=s,o.prototype.decoder=c,o.prototype.bomAware=!0,s.prototype.write=function(t){for(var e=this.inBase64,r=this.base64Accum,n=this.base64AccumIdx,a=new l(5*t.length+10),i=0,o=0;o<t.length;o++){var s=t.charCodeAt(o);32<=s&&s<=126?(e&&(n>0&&(i+=a.write(r.slice(0,n).toString("base64").replace(/\//g,",").replace(/=+$/,""),i),n=0),a[i++]=p,e=!1),e||(a[i++]=s,s===h&&(a[i++]=p))):(e||(a[i++]=h,e=!0),e&&(r[n++]=s>>8,r[n++]=255&s,n==r.length&&(i+=a.write(r.toString("base64").replace(/\//g,","),i),n=0)))}return this.inBase64=e,this.base64AccumIdx=n,a.slice(0,i)},s.prototype.end=function(){var t=new l(10),e=0;return this.inBase64&&(this.base64AccumIdx>0&&(e+=t.write(this.base64Accum.slice(0,this.base64AccumIdx).toString("base64").replace(/\//g,",").replace(/=+$/,""),e),this.base64AccumIdx=0),t[e++]=p,this.inBase64=!1),t.slice(0,e)};var g=$.slice();g[",".charCodeAt(0)]=!0,c.prototype.write=function(t){for(var e="",r=0,n=this.inBase64,a=this.base64Accum,i=0;i<t.length;i++)if(n){if(!g[t[i]]){if(i==r&&t[i]==p)e+="&";else{var o=a+t.slice(r,i).toString().replace(/,/g,"/");e+=this.iconv.decode(new l(o,"base64"),"utf16-be")}t[i]!=p&&i--,r=i+1,n=!1,a=""}}else t[i]==h&&(e+=this.iconv.decode(t.slice(r,i),"ascii"),r=i+1,n=!0);if(n){var o=a+t.slice(r).toString().replace(/,/g,"/"),s=o.length-o.length%8;a=o.slice(s),o=o.slice(0,s),e+=this.iconv.decode(new l(o,"base64"),"utf16-be")}else e+=this.iconv.decode(t.slice(r),"ascii");return this.inBase64=n,this.base64Accum=a,e},c.prototype.end=function(){var t="";return this.inBase64&&this.base64Accum.length>0&&(t=this.iconv.decode(new l(this.base64Accum,"base64"),"utf16-be")),this.inBase64=!1,this.base64Accum="",t}},{buffer:void 0}],71:[function(t,e,r){"use strict";function n(t,e){this.encoder=t,this.addBOM=!0}function a(t,e){this.decoder=t,this.pass=!1,this.options=e||{}}r.PrependBOM=n,n.prototype.write=function(t){return this.addBOM&&(t="\ufeff"+t,this.addBOM=!1),this.encoder.write(t)},n.prototype.end=function(){return this.encoder.end()},r.StripBOM=a,a.prototype.write=function(t){var e=this.decoder.write(t);return this.pass||!e?e:("\ufeff"===e[0]&&(e=e.slice(1),"function"==typeof this.options.stripBOM&&this.options.stripBOM()),this.pass=!0,e)},a.prototype.end=function(){return this.decoder.end()}},{}],72:[function(t,e,r){"use strict";var n=t("buffer").Buffer;e.exports=function(e){var r=void 0;e.supportsNodeEncodingsExtension=!(new n(0)instanceof Uint8Array),e.extendNodeEncodings=function(){if(!r){if(r={},!e.supportsNodeEncodingsExtension)return console.error("ACTION NEEDED: require('iconv-lite').extendNodeEncodings() is not supported in your version of Node"),void console.error("See more info at https://github.com/ashtuchkin/iconv-lite/wiki/Node-v4-compatibility");var a={hex:!0,utf8:!0,"utf-8":!0,ascii:!0,binary:!0,base64:!0,ucs2:!0,"ucs-2":!0,utf16le:!0,"utf-16le":!0};n.isNativeEncoding=function(t){return t&&a[t.toLowerCase()]};var i=t("buffer").SlowBuffer;if(r.SlowBufferToString=i.prototype.toString,i.prototype.toString=function(t,a,i){return t=String(t||"utf8").toLowerCase(),n.isNativeEncoding(t)?r.SlowBufferToString.call(this,t,a,i):(void 0===a&&(a=0),void 0===i&&(i=this.length),e.decode(this.slice(a,i),t))},r.SlowBufferWrite=i.prototype.write,i.prototype.write=function(t,a,i,o){if(isFinite(a))isFinite(i)||(o=i,i=void 0);else{var s=o;o=a,a=i,i=s}a=+a||0;var c=this.length-a;if(i?(i=+i)>c&&(i=c):i=c,o=String(o||"utf8").toLowerCase(),n.isNativeEncoding(o))return r.SlowBufferWrite.call(this,t,a,i,o);if(t.length>0&&(i<0||a<0))throw new RangeError("attempt to write beyond buffer bounds");var l=e.encode(t,o);return l.length<i&&(i=l.length),l.copy(this,a,0,i),i},r.BufferIsEncoding=n.isEncoding,n.isEncoding=function(t){return n.isNativeEncoding(t)||e.encodingExists(t)},r.BufferByteLength=n.byteLength,n.byteLength=i.byteLength=function(t,a){return a=String(a||"utf8").toLowerCase(),n.isNativeEncoding(a)?r.BufferByteLength.call(this,t,a):e.encode(t,a).length},r.BufferToString=n.prototype.toString,n.prototype.toString=function(t,a,i){return t=String(t||"utf8").toLowerCase(),n.isNativeEncoding(t)?r.BufferToString.call(this,t,a,i):(void 0===a&&(a=0),void 0===i&&(i=this.length),e.decode(this.slice(a,i),t))},r.BufferWrite=n.prototype.write,n.prototype.write=function(t,a,i,o){var s=a,c=i,l=o;if(isFinite(a))isFinite(i)||(o=i,i=void 0);else{var u=o;o=a,a=i,i=u}if(o=String(o||"utf8").toLowerCase(),n.isNativeEncoding(o))return r.BufferWrite.call(this,t,s,c,l);a=+a||0;var f=this.length-a;if(i?(i=+i)>f&&(i=f):i=f,t.length>0&&(i<0||a<0))throw new RangeError("attempt to write beyond buffer bounds");var $=e.encode(t,o);return $.length<i&&(i=$.length),$.copy(this,a,0,i),i},e.supportsStreams){var o=t("stream").Readable;r.ReadableSetEncoding=o.prototype.setEncoding,o.prototype.setEncoding=function(t,r){this._readableState.decoder=e.getDecoder(t,r),this._readableState.encoding=t},o.prototype.collect=e._collect}}},e.undoExtendNodeEncodings=function(){if(e.supportsNodeEncodingsExtension){if(!r)throw new Error("require('iconv-lite').undoExtendNodeEncodings(): Nothing to undo; extendNodeEncodings() is not called.");delete n.isNativeEncoding;var a=t("buffer").SlowBuffer;if(a.prototype.toString=r.SlowBufferToString,a.prototype.write=r.SlowBufferWrite,n.isEncoding=r.BufferIsEncoding,n.byteLength=r.BufferByteLength,n.prototype.toString=r.BufferToString,n.prototype.write=r.BufferWrite,e.supportsStreams){var i=t("stream").Readable;i.prototype.setEncoding=r.ReadableSetEncoding,delete i.prototype.collect}r=void 0}}}},{buffer:void 0,stream:void 0}],73:[function(t,e,r){"use strict";var n=t("buffer").Buffer,a=t("./bom-handling"),i=e.exports;i.encodings=null,i.defaultCharUnicode="",i.defaultCharSingleByte="?",i.encode=function(t,e,r){t=""+(t||"");var a=i.getEncoder(e,r),o=a.write(t),s=a.end();return s&&s.length>0?n.concat([o,s]):o},i.decode=function(t,e,r){"string"==typeof t&&(i.skipDecodeWarning||(console.error("Iconv-lite warning: decode()-ing strings is deprecated. Refer to https://github.com/ashtuchkin/iconv-lite/wiki/Use-Buffers-when-decoding"),i.skipDecodeWarning=!0),t=new n(""+(t||""),"binary"));var a=i.getDecoder(e,r),o=a.write(t),s=a.end();return s?o+s:o},i.encodingExists=function(t){try{return i.getCodec(t),!0}catch(t){return!1}},i.toEncoding=i.encode,i.fromEncoding=i.decode,i._codecDataCache={},i.getCodec=function(e){i.encodings||(i.encodings=t("../encodings"));for(var r=(""+e).toLowerCase().replace(/[^0-9a-z]|:\d{4}$/g,""),n={};;){var a=i._codecDataCache[r];if(a)return a;var o=i.encodings[r];switch(typeof o){case"string":r=o;break;case"object":for(var s in o)n[s]=o[s];n.encodingName||(n.encodingName=r),r=o.type;break;case"function":return n.encodingName||(n.encodingName=r),a=new o(n,i),i._codecDataCache[n.encodingName]=a,a;default:throw new Error("Encoding not recognized: '"+e+"' (searched as: '"+r+"')")}}},i.getEncoder=function(t,e){var r=i.getCodec(t),n=new r.encoder(e,r);return r.bomAware&&e&&e.addBOM&&(n=new a.PrependBOM(n,e)),n},i.getDecoder=function(t,e){var r=i.getCodec(t),n=new r.decoder(e,r);return!r.bomAware||e&&!1===e.stripBOM||(n=new a.StripBOM(n,e)),n};var o="undefined"!=typeof process&&process.versions&&process.versions.node;if(o){var s=o.split(".").map(Number);(s[0]>0||s[1]>=10)&&t("./streams")(i),t("./extend-node")(i)}},{"../encodings":56,"./bom-handling":71,"./extend-node":72,"./streams":74,buffer:void 0}],74:[function(t,e,r){"use strict";function n(t,e){this.conv=t,e=e||{},e.decodeStrings=!1,o.call(this,e)}function a(t,e){this.conv=t,e=e||{},e.encoding=this.encoding="utf8",o.call(this,e)}var i=t("buffer").Buffer,o=t("stream").Transform;e.exports=function(t){t.encodeStream=function(e,r){return new n(t.getEncoder(e,r),r)},t.decodeStream=function(e,r){return new a(t.getDecoder(e,r),r)},t.supportsStreams=!0,t.IconvLiteEncoderStream=n,t.IconvLiteDecoderStream=a,t._collect=a.prototype.collect},n.prototype=Object.create(o.prototype,{constructor:{value:n}}),n.prototype._transform=function(t,e,r){if("string"!=typeof t)return r(new Error("Iconv encoding stream needs strings as its input."));try{var n=this.conv.write(t);n&&n.length&&this.push(n),r()}catch(t){r(t)}},n.prototype._flush=function(t){try{var e=this.conv.end();e&&e.length&&this.push(e),t()}catch(e){t(e)}},n.prototype.collect=function(t){var e=[];return this.on("error",t),this.on("data",function(t){e.push(t)}),this.on("end",function(){t(null,i.concat(e))}),this},a.prototype=Object.create(o.prototype,{constructor:{value:a}}),a.prototype._transform=function(t,e,r){if(!i.isBuffer(t))return r(new Error("Iconv decoding stream needs buffers as its input."));try{var n=this.conv.write(t);n&&n.length&&this.push(n,this.encoding),r()}catch(t){r(t)}},a.prototype._flush=function(t){try{var e=this.conv.end();e&&e.length&&this.push(e,this.encoding),t()}catch(e){t(e)}},a.prototype.collect=function(t){var e="";return this.on("error",t),this.on("data",function(t){e+=t}),this.on("end",function(){t(null,e)}),this}},{buffer:void 0,stream:void 0}],75:[function(t,e,r){function n(t,e){return s[t]?(s[t].push(e),null):(s[t]=[e],a(t))}function a(t){return c(function e(){var r=s[t],n=r.length,a=i(arguments);try{for(var o=0;o<n;o++)r[o].apply(null,a)}finally{r.length>n?(r.splice(0,n),process.nextTick(function(){e.apply(null,a)})):delete s[t]}})}function i(t){for(var e=t.length,r=[],n=0;n<e;n++)r[n]=t[n];return r}var o=t("wrappy"),s=Object.create(null),c=t("once");e.exports=o(n)},{once:83,wrappy:85}],76:[function(t,e,r){try{var n=t("util");if("function"!=typeof n.inherits)throw"";e.exports=n.inherits}catch(r){e.exports=t("./inherits_browser.js")}},{"./inherits_browser.js":77,util:void 0}],77:[function(t,e,r){"function"==typeof Object.create?e.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(t,e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}},{}],78:[function(t,e,r){var n="undefined"!=typeof JSON?JSON:t("jsonify");e.exports=function(t,e){e||(e={}),"function"==typeof e&&(e={cmp:e});var r=e.space||"";"number"==typeof r&&(r=Array(r+1).join(" "));var o="boolean"==typeof e.cycles&&e.cycles,s=e.replacer||function(t,e){return e},c=e.cmp&&function(t){return function(e){return function(r,n){var a={key:r,value:e[r]},i={key:n,value:e[n]};return t(a,i)}}}(e.cmp),l=[];return function t(e,u,f,$){var _=r?"\n"+new Array($+1).join(r):"",d=r?": ":":";if(f&&f.toJSON&&"function"==typeof f.toJSON&&(f=f.toJSON()),void 0!==(f=s.call(e,u,f))){if("object"!=typeof f||null===f)return n.stringify(f);if(a(f)){for(var p=[],h=0;h<f.length;h++){var g=t(f,h,f[h],$+1)||n.stringify(null);p.push(_+r+g)}return"["+p.join(",")+_+"]"}if(-1!==l.indexOf(f)){if(o)return n.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}l.push(f);for(var m=i(f).sort(c&&c(f)),p=[],h=0;h<m.length;h++){var u=m[h],v=t(f,u,f[u],$+1);if(v){var y=n.stringify(u)+d+v;p.push(_+r+y)}}return l.splice(l.indexOf(f),1),"{"+p.join(",")+_+"}"}}({"":t},"",t,0)};var a=Array.isArray||function(t){return"[object Array]"==={}.toString.call(t)},i=Object.keys||function(t){var e=Object.prototype.hasOwnProperty||function(){return!0},r=[];for(var n in t)e.call(t,n)&&r.push(n);return r}},{jsonify:79}],79:[function(t,e,r){r.parse=t("./lib/parse"),r.stringify=t("./lib/stringify")},{"./lib/parse":80,"./lib/stringify":81}],80:[function(t,e,r){var n,a,i,o,s={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},c=function(t){throw{name:"SyntaxError",message:t,at:n,text:i}},l=function(t){return t&&t!==a&&c("Expected '"+t+"' instead of '"+a+"'"),a=i.charAt(n),n+=1,a},u=function(){var t,e="";for("-"===a&&(e="-",l("-"));a>="0"&&a<="9";)e+=a,l();if("."===a)for(e+=".";l()&&a>="0"&&a<="9";)e+=a;if("e"===a||"E"===a)for(e+=a,l(),"-"!==a&&"+"!==a||(e+=a,l());a>="0"&&a<="9";)e+=a,l();if(t=+e,isFinite(t))return t;c("Bad number")},f=function(){var t,e,r,n="";if('"'===a)for(;l();){if('"'===a)return l(),n;if("\\"===a)if(l(),"u"===a){for(r=0,e=0;e<4&&(t=parseInt(l(),16),isFinite(t));e+=1)r=16*r+t;n+=String.fromCharCode(r)}else{if("string"!=typeof s[a])break;n+=s[a]}else n+=a}c("Bad string")},$=function(){for(;a&&a<=" ";)l()},_=function(){switch(a){case"t":return l("t"),l("r"),l("u"),l("e"),!0;case"f":return l("f"),l("a"),l("l"),l("s"),l("e"),!1;case"n":return l("n"),l("u"),l("l"),l("l"),null}c("Unexpected '"+a+"'")},d=function(){var t=[];if("["===a){if(l("["),$(),"]"===a)return l("]"),t;for(;a;){if(t.push(o()),$(),"]"===a)return l("]"),t;l(","),$()}}c("Bad array")},p=function(){var t,e={};if("{"===a){if(l("{"),$(),"}"===a)return l("}"),e;for(;a;){if(t=f(),$(),l(":"),Object.hasOwnProperty.call(e,t)&&c('Duplicate key "'+t+'"'),e[t]=o(),$(),"}"===a)return l("}"),e;l(","),$()}}c("Bad object")};o=function(){switch($(),a){case"{":return p();case"[":return d();case'"':return f();case"-":return u();default:return a>="0"&&a<="9"?u():_()}},e.exports=function(t,e){var r;return i=t,n=0,a=" ",r=o(),$(),a&&c("Syntax error"),"function"==typeof e?function t(r,n){var a,i,o=r[n];if(o&&"object"==typeof o)for(a in o)Object.prototype.hasOwnProperty.call(o,a)&&(i=t(o,a),void 0!==i?o[a]=i:delete o[a]);return e.call(r,n,o)}({"":r},""):r}},{}],81:[function(t,e,r){function n(t){return c.lastIndex=0,c.test(t)?'"'+t.replace(c,function(t){var e=l[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}function a(t,e){var r,c,l,u,f,$=i,_=e[t];switch(_&&"object"==typeof _&&"function"==typeof _.toJSON&&(_=_.toJSON(t)),"function"==typeof s&&(_=s.call(e,t,_)),typeof _){case"string":return n(_);case"number":return isFinite(_)?String(_):"null";case"boolean":case"null":return String(_);case"object":if(!_)return"null";if(i+=o,f=[],"[object Array]"===Object.prototype.toString.apply(_)){for(u=_.length,r=0;r<u;r+=1)f[r]=a(r,_)||"null";return l=0===f.length?"[]":i?"[\n"+i+f.join(",\n"+i)+"\n"+$+"]":"["+f.join(",")+"]",i=$,l}if(s&&"object"==typeof s)for(u=s.length,r=0;r<u;r+=1)"string"==typeof(c=s[r])&&(l=a(c,_))&&f.push(n(c)+(i?": ":":")+l);else for(c in _)Object.prototype.hasOwnProperty.call(_,c)&&(l=a(c,_))&&f.push(n(c)+(i?": ":":")+l);return l=0===f.length?"{}":i?"{\n"+i+f.join(",\n"+i)+"\n"+$+"}":"{"+f.join(",")+"}",i=$,l}}var i,o,s,c=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,l={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};e.exports=function(t,e,r){var n;if(i="",o="","number"==typeof r)for(n=0;n<r;n+=1)o+=" ";else"string"==typeof r&&(o=r);if(s=e,e&&"function"!=typeof e&&("object"!=typeof e||"number"!=typeof e.length))throw new Error("JSON.stringify");return a("",{"":t})}},{}],82:[function(t,e,r){function n(t,e){return e=e||{},function(r,n,a){return i(r,t,e)}}function a(t,e){t=t||{},e=e||{};var r={};return Object.keys(e).forEach(function(t){r[t]=e[t]}),Object.keys(t).forEach(function(e){r[e]=t[e]}),r}function i(t,e,r){if("string"!=typeof e)throw new TypeError("glob pattern string required");return r||(r={}),!(!r.nocomment&&"#"===e.charAt(0))&&(""===e.trim()?""===t:new o(e,r).match(t))}function o(t,e){if(!(this instanceof o))return new o(t,e);if("string"!=typeof t)throw new TypeError("glob pattern string required");e||(e={}),t=t.trim(),"/"!==p.sep&&(t=t.split(p.sep).join("/")),this.options=e,this.set=[],this.pattern=t,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.make()}function s(){if(!this._made){var t=this.pattern,e=this.options;if(!e.nocomment&&"#"===t.charAt(0))return void(this.comment=!0);if(!t)return void(this.empty=!0);this.parseNegate();var r=this.globSet=this.braceExpand();e.debug&&(this.debug=console.error),this.debug(this.pattern,r),r=this.globParts=r.map(function(t){return t.split(A)}),this.debug(this.pattern,r),r=r.map(function(t,e,r){return t.map(this.parse,this)},this),this.debug(this.pattern,r),r=r.filter(function(t){return-1===t.indexOf(!1)}),this.debug(this.pattern,r),this.set=r}}function c(){var t=this.pattern,e=!1,r=this.options,n=0;if(!r.nonegate){for(var a=0,i=t.length;a<i&&"!"===t.charAt(a);a++)e=!e,n++;n&&(this.pattern=t.substr(n)),this.negate=e}}function l(t,e){
if(e||(e=this instanceof o?this.options:{}),void 0===(t=void 0===t?this.pattern:t))throw new TypeError("undefined pattern");return e.nobrace||!t.match(/\{.*\}/)?[t]:g(t)}function u(t,e){function r(){if(a){switch(a){case"*":o+=y,s=!0;break;case"?":o+=v,s=!0;break;default:o+="\\"+a}g.debug("clearStateChar %j %j",a,o),a=!1}}if(t.length>65536)throw new TypeError("pattern is too long");var n=this.options;if(!n.noglobstar&&"**"===t)return h;if(""===t)return"";for(var a,i,o="",s=!!n.nocase,c=!1,l=[],u=[],f=!1,$=-1,d=-1,p="."===t.charAt(0)?"":n.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",g=this,b=0,w=t.length;b<w&&(i=t.charAt(b));b++)if(this.debug("%s\t%s %s %j",t,b,o,i),c&&x[i])o+="\\"+i,c=!1;else switch(i){case"/":return!1;case"\\":r(),c=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s\t%s %s %j <-- stateChar",t,b,o,i),f){this.debug("  in class"),"!"===i&&b===d+1&&(i="^"),o+=i;continue}g.debug("call clearStateChar %j",a),r(),a=i,n.noext&&r();continue;case"(":if(f){o+="(";continue}if(!a){o+="\\(";continue}l.push({type:a,start:b-1,reStart:o.length,open:m[a].open,close:m[a].close}),o+="!"===a?"(?:(?!(?:":"(?:",this.debug("plType %j %j",a,o),a=!1;continue;case")":if(f||!l.length){o+="\\)";continue}r(),s=!0;var A=l.pop();o+=A.close,"!"===A.type&&u.push(A),A.reEnd=o.length;continue;case"|":if(f||!l.length||c){o+="\\|",c=!1;continue}r(),o+="|";continue;case"[":if(r(),f){o+="\\"+i;continue}f=!0,d=b,$=o.length,o+=i;continue;case"]":if(b===d+1||!f){o+="\\"+i,c=!1;continue}if(f){var E=t.substring(d+1,b);try{RegExp("["+E+"]")}catch(t){var S=this.parse(E,k);o=o.substr(0,$)+"\\["+S[0]+"\\]",s=s||S[1],f=!1;continue}}s=!0,f=!1,o+=i;continue;default:r(),c?c=!1:!x[i]||"^"===i&&f||(o+="\\"),o+=i}for(f&&(E=t.substr(d+1),S=this.parse(E,k),o=o.substr(0,$)+"\\["+S[0],s=s||S[1]),A=l.pop();A;A=l.pop()){var N=o.slice(A.reStart+A.open.length);this.debug("setting tail",o,A),N=N.replace(/((?:\\{2}){0,64})(\\?)\|/g,function(t,e,r){return r||(r="\\"),e+e+r+"|"}),this.debug("tail=%j\n   %s",N,N,A,o);var C="*"===A.type?y:"?"===A.type?v:"\\"+A.type;s=!0,o=o.slice(0,A.reStart)+C+"\\("+N}r(),c&&(o+="\\\\");var I=!1;switch(o.charAt(0)){case".":case"[":case"(":I=!0}for(var O=u.length-1;O>-1;O--){var P=u[O],L=o.slice(0,P.reStart),M=o.slice(P.reStart,P.reEnd-8),T=o.slice(P.reEnd-8,P.reEnd),B=o.slice(P.reEnd);T+=B;var j=L.split("(").length-1,F=B;for(b=0;b<j;b++)F=F.replace(/\)[+*?]?/,"");B=F;var R="";""===B&&e!==k&&(R="$");o=L+M+B+R+T}if(""!==o&&s&&(o="(?=.)"+o),I&&(o=p+o),e===k)return[o,s];if(!s)return _(t);var q=n.nocase?"i":"";try{var D=new RegExp("^"+o+"$",q)}catch(t){return new RegExp("$.")}return D._glob=t,D._src=o,D}function f(){if(this.regexp||!1===this.regexp)return this.regexp;var t=this.set;if(!t.length)return this.regexp=!1,this.regexp;var e=this.options,r=e.noglobstar?y:e.dot?b:w,n=e.nocase?"i":"",a=t.map(function(t){return t.map(function(t){return t===h?r:"string"==typeof t?d(t):t._src}).join("\\/")}).join("|");a="^(?:"+a+")$",this.negate&&(a="^(?!"+a+").*$");try{this.regexp=new RegExp(a,n)}catch(t){this.regexp=!1}return this.regexp}function $(t,e){if(this.debug("match",t,this.pattern),this.comment)return!1;if(this.empty)return""===t;if("/"===t&&e)return!0;var r=this.options;"/"!==p.sep&&(t=t.split(p.sep).join("/")),t=t.split(A),this.debug(this.pattern,"split",t);var n=this.set;this.debug(this.pattern,"set",n);var a,i;for(i=t.length-1;i>=0&&!(a=t[i]);i--);for(i=0;i<n.length;i++){var o=n[i],s=t;r.matchBase&&1===o.length&&(s=[a]);if(this.matchOne(s,o,e))return!!r.flipNegate||!this.negate}return!r.flipNegate&&this.negate}function _(t){return t.replace(/\\(.)/g,"$1")}function d(t){return t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}e.exports=i,i.Minimatch=o;var p={sep:"/"};try{p=t("path")}catch(t){}var h=i.GLOBSTAR=o.GLOBSTAR={},g=t("brace-expansion"),m={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},v="[^/]",y=v+"*?",b="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",w="(?:(?!(?:\\/|^)\\.).)*?",x=function(t){return t.split("").reduce(function(t,e){return t[e]=!0,t},{})}("().*{}+?[]^$\\!"),A=/\/+/;i.filter=n,i.defaults=function(t){if(!t||!Object.keys(t).length)return i;var e=i,r=function(r,n,i){return e.minimatch(r,n,a(t,i))};return r.Minimatch=function(r,n){return new e.Minimatch(r,a(t,n))},r},o.defaults=function(t){return t&&Object.keys(t).length?i.defaults(t).Minimatch:o},o.prototype.debug=function(){},o.prototype.make=s,o.prototype.parseNegate=c,i.braceExpand=function(t,e){return l(t,e)},o.prototype.braceExpand=l,o.prototype.parse=u;var k={};i.makeRe=function(t,e){return new o(t,e||{}).makeRe()},o.prototype.makeRe=f,i.match=function(t,e,r){r=r||{};var n=new o(e,r);return t=t.filter(function(t){return n.match(t)}),n.options.nonull&&!t.length&&t.push(e),t},o.prototype.match=$,o.prototype.matchOne=function(t,e,r){var n=this.options;this.debug("matchOne",{this:this,file:t,pattern:e}),this.debug("matchOne",t.length,e.length);for(var a=0,i=0,o=t.length,s=e.length;a<o&&i<s;a++,i++){this.debug("matchOne loop");var c=e[i],l=t[a];if(this.debug(e,c,l),!1===c)return!1;if(c===h){this.debug("GLOBSTAR",[e,c,l]);var u=a,f=i+1;if(f===s){for(this.debug("** at the end");a<o;a++)if("."===t[a]||".."===t[a]||!n.dot&&"."===t[a].charAt(0))return!1;return!0}for(;u<o;){var $=t[u];if(this.debug("\nglobstar while",t,u,e,f,$),this.matchOne(t.slice(u),e.slice(f),r))return this.debug("globstar found match!",u,o,$),!0;if("."===$||".."===$||!n.dot&&"."===$.charAt(0)){this.debug("dot detected!",t,u,e,f);break}this.debug("globstar swallow a segment, and continue"),u++}return!(!r||(this.debug("\n>>> no match, partial?",t,u,e,f),u!==o))}var _;if("string"==typeof c?(_=n.nocase?l.toLowerCase()===c.toLowerCase():l===c,this.debug("string match",c,l,_)):(_=l.match(c),this.debug("pattern match",c,l,_)),!_)return!1}if(a===o&&i===s)return!0;if(a===o)return r;if(i===s){return a===o-1&&""===t[a]}throw new Error("wtf?")}},{"brace-expansion":44,path:void 0}],83:[function(t,e,r){function n(t){var e=function(){return e.called?e.value:(e.called=!0,e.value=t.apply(this,arguments))};return e.called=!1,e}function a(t){var e=function(){if(e.called)throw new Error(e.onceError);return e.called=!0,e.value=t.apply(this,arguments)},r=t.name||"Function wrapped with `once`";return e.onceError=r+" shouldn't be called more than once",e.called=!1,e}var i=t("wrappy");e.exports=i(n),e.exports.strict=i(a),n.proto=n(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return n(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return a(this)},configurable:!0})})},{wrappy:85}],84:[function(t,e,r){"use strict";function n(t){return"/"===t.charAt(0)}function a(t){var e=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/,r=e.exec(t),n=r[1]||"",a=Boolean(n&&":"!==n.charAt(1));return Boolean(r[2]||a)}e.exports="win32"===process.platform?a:n,e.exports.posix=n,e.exports.win32=a},{}],85:[function(t,e,r){function n(t,e){function r(){for(var e=new Array(arguments.length),r=0;r<e.length;r++)e[r]=arguments[r];var n=t.apply(this,e),a=e[e.length-1];return"function"==typeof n&&n!==a&&Object.keys(a).forEach(function(t){n[t]=a[t]}),n}if(t&&e)return n(t)(e);if("function"!=typeof t)throw new TypeError("need wrapper function");return Object.keys(t).forEach(function(e){r[e]=t[e]}),r}e.exports=n},{}],86:[function(require,module,exports){function AbcJSON(t){var e=Array((t||2)+1).join(" ");AbcJSON.prototype.gen_json=function(t,r,n,a){function i(t,r,n){var a,s,l=t+e;if(p[r]){if("extra"==r){for(o+=f+t+'"extra": [',f="\n",s=n;s;s=s.next)i(l,null,s);o+="\n"+t+"]"}}else{switch(o+=f+t,r&&(o+='"'+r.toString()+'": '),typeof n){case"undefined":o+="null";break;case"object":if(!n){o+="null";break}if(Array.isArray(n)){if(0==n.length){o+="[]";break}for(f="[\n",c=n.length,a=0;a<c;a++)i(l,null,n[a]);o+="\n"+t+"]"}else{f="{\n";for(a in n)n.hasOwnProperty(a)&&i(l,a,n[a]);o+="\n"+t+"}"}break;default:o+=JSON.stringify(n)}f=",\n"}}var o,s,c,l,u,f,$=e+e,_=$+e,d=_+e,p={next:!0,prev:!0,ts_next:!0,ts_prev:!0,extra:!0,p_v:!0,dd_st:!0};for(o="",f="{\n",i(e,"music_types",n),f=",\n"+e+'"music_type_ids": {\n',c=n.length,s=0;s<c;s++)n[s]&&(o+=f+$+'"'+n[s]+'": '+s,f=",\n");for(f="\n"+e+"},\n",i(e,"info",a),o+=",\n"+e+'"voices": [',l=0,f="\n";;){f+=$+"{\n"+_+'"voice_properties": {\n';for(s in r[l])r[l].hasOwnProperty(s)&&i(d,s,r[l][s]);if(o+="\n"+_+"},\n"+_+'"symbols": [',u=r[l].sym){for(f="\n";u;u=u.next)i(d,null,u);o+="\n"+_+"]\n"+$+"}"}else o+="]\n"+_+"}";if(f=",\n",!r[++l])break}return o+"\n"+e+"]\n}\n"}}function AbcMIDI(){var t=abc2svg.C;AbcMIDI.prototype.add=function(e,r){function n(){for(var t=0;t<10;t++)for(var e=0;e<7;e++)f[7*t+e]=u[e]}function a(t){for(var e=0;e<7;e++)u[e]=0;switch(t.k_sf){case 7:u[6]=1;case 6:u[2]=1;case 5:u[5]=1;case 4:u[1]=1;case 3:u[4]=1;case 2:u[0]=1;case 1:u[3]=1;break;case-7:u[3]=-1;case-6:u[0]=-1;case-5:u[4]=-1;case-4:u[1]=-1;case-3:u[5]=-1;case-2:u[2]=-1;case-1:u[6]=-1}n()}function i(t,e){return e&&(f[t]=3==e?0:e),12*(t/7|0)+l[t%7]+(o[t]||f[t])}var o,s,c,l=new Int8Array([0,2,4,5,7,9,11]),u=new Int8Array(7),f=new Int8Array(70);for(s=0;s<r.length;s++)r[s].sym&&(e=r[s].clef,c=!e.clef_octave||e.clef_oct_transp?0:e.clef_octave,a(r[s].key),function(e){var s,l,u,$,_=r[e].sym,d=_.time,p=[],h=[];for(o=[];_;){switch(_.time>d&&(n(),d=_.time),_.dur&&(d=_.time+_.dur),_.type){case t.BAR:if(_.text)if("1"==_.text[0])for(h=[],rep_tie_time=[],s=0;s<o.length;s++)h[s]=o[s];else if(0!=h.length)for(o=[],p=[],s=0;s<h.length;s++)o[s]=h[s],p[s]=_.time;_.invis||n();break;case t.CLEF:c=!_.clef_octave||_.clef_oct_transp?0:_.clef_octave;break;case t.GRACE:for(l=_.extra;l;l=l.next)if(!l.type==t.NOTE)for(s=0;s<=l.nhd;s++)$=l.notes[s],u=$.apit+19+c,$.midi=i(u,$.acc);break;case t.KEY:a(_);break;case t.NOTE:for(s=0;s<=_.nhd;s++)$=_.notes[s],u=$.apit+19+c,o[u]&&_.time>p[u]&&(delete o[u],delete p[u]),$.midi=i(u,$.acc),$.ti1&&(o[u]=f[u],p[u]=_.time+_.dur)}_=_.next}}(s))}}function AbcPlay(t){function e(){}function r(t,e,r){var a,i=l.get_outputs();if(1==i.length)a=0;else{a=-1;var o=window.prompt("Use \n0: "+i[0]+"\n1: "+i[1]+"?","0");if(o&&(a=Number(o),(isNaN(a)||a<0||a>=i.length)&&(a=-1)),!o||a<0)return void(s.onend&&s.onend())}n(i[a]),l.play(t,e,r)}function n(t){(o="sf2"==t?a:i)&&(l.play=o.play,l.stop=o.stop,o.set_output&&o.set_output(t))}var a,i,o,s=t,c=ToAudio(),l={get_outputs:function(){var t,e=[];return i&&(t=i.get_outputs())&&(e=t),a&&(t=a.get_outputs())&&(e=e.concat(t)),e},set_output:n,clear:c.clear,add:c.add,set_sft:e,set_sfu:function(t){if(void 0==t)return s.sfu;s.sfu=t},set_speed:function(t){if(void 0==t)return s.speed;s.new_speed=t},set_vol:function(t){if(void 0==t)return s.gain;s.gain=t,o&&o.set_vol&&o.set_vol(t)},play:r,stop:e};return s.gain=.7,s.speed=1,function(){try{if(!localStorage)return}catch(t){return}var t=localStorage.getItem("sfu");t&&(s.sfu=t),(t=localStorage.getItem("volume"))&&(s.gain=Number(t))}(),"function"==typeof Midi5&&(i=Midi5(s)),"function"==typeof Audio5&&(a=Audio5(s)),l}function ToAudio(){var t,e,r,n,a=abc2svg.C,i=new Uint8Array([0,2,4,5,7,9,11]);return{clear:function(){var e=t;return t=null,e},add:function(o,s){function c(){var t,e,r,n;for(d=s[0].temper,S=new Int8Array(s.length),t=0;t<s.length;t++)e=s[t],n=e.instr||0,e.midictl&&(e.midictl[32]&&(n+=128*e.midictl[32]),e.midictl[0]&&(n+=128*e.midictl[0]*128)),I[t]=n,r=e.clef,S[t]=!r.clef_octave||r.clef_oct_transp?0:r.clef_octave,N[t]=new Float32Array(70),C[t]=new Float32Array(70),e.key.v=t,l(e.key)}function l(t){var e,r;if(t.k_bagpipe)r=new Float32Array([2.37,1.49,1.53,2.35,1.19,1.51,1.55]);else switch(r=new Float32Array(7),t.k_sf){case 7:r[6]=1;case 6:r[2]=1;case 5:r[5]=1;case 4:r[1]=1;case 3:r[4]=1;case 2:r[0]=1;case 1:r[3]=1;break;case-7:r[3]=-1;case-6:r[0]=-1;case-5:r[4]=-1;case-4:r[1]=-1;case-3:r[5]=-1;case-2:r[2]=-1;case-1:r[6]=-1}for(e=0;e<10;e++)N[t.v].set(r,7*e);C[t.v].set(N[t.v])}function u(t,e){var r=t.notes[e],n=r.apit+19,a=r.acc;return S[t.v]&&(n+=S[t.v]),a?(3==a?a=0:r.micro_n&&(a=(a<0?-r.micro_n:r.micro_n)/r.micro_d*2),_[n]=a):a=_[n],n=12*(n/7|0)+i[n%7]+a,!d||a|0!=a?n:n+d[n%12]}function f(t,e,r){var i,o=t.time+t.dur,s=e.apit,c=s+19;e.acc;for(S[t.v]&&(c+=S[t.v]),t=t.next;;t=t.next){if(!t)return r;if(t==w){var l=t.v;for(t=x.ts_next;t&&t.v!=l;)t=t.ts_next;if(!t)return r;o=t.time}if(t.time!=o)return r;if(t.type==a.NOTE)break}for(i=t.notes.length,p=0;p<i;p++)if(e=t.notes[p],e.apit==s)return r+=t.dur/n,e.ti2=!0,e.ti1?f(t,e,r):r;return r}function $(e,r,n){for(var a=0;a<=e.nhd;a++){var i=e.notes[a];i.ti2||t.push(new Float32Array([e.istart,r,I[e.v],u(e,a),i.ti1?f(e,i,n):n,1,e.v]))}}var _,d,p,h,g,m,v,y,b,w,x,A,k,E,S,N=[],C=[],I=[],O=o;for(c(),t?O.time<r&&(r=rep_st_t=O.time):(t=[],r=rep_st_t=e=0,n=a.BLEN/4*120/60);O;){if(O.tempo){for(m=0,h=O.tempo_notes.length,p=0;p<h;p++)m+=O.tempo_notes[p];n=m*O.tempo/60}switch(g=O.time-r,g>0&&(e+=g/n,r=O.time),O==w&&(O=x,r=O.time),_=C[O.v],O.type){case a.BAR:if(O.v!=y)break;if(":"==O.bar_type[0]){if(O.bar_type="|"+O.bar_type.slice(1),x=O,w||(w=O),b){for(O=b,v=0;v<s.length;v++)C[v].set(k[v]),S[v]=A[v];n=E}else O=o,c();r=O.time;break}if(!O.invis)for(v=0;v<s.length;v++)C[v].set(N[v]);if(":"==O.bar_type[O.bar_type.length-1]){for(b=O,w=null,v=0;v<s.length;v++)k||(k=[]),k[v]||(k[v]=new Float32Array(70)),k[v].set(C[v]),A||(A=[]),A[v]=S[v];E=n;break}O.text&&"1"==O.text[0]&&(w=O);break;case a.CLEF:S[O.v]=!O.clef_octave||O.clef_oct_transp?0:O.clef_octave;break;case a.GRACE:0==O.time&&0==r&&(g=0,O.sappo?g=a.BLEN/16:O.next&&O.next.type==a.NOTE||(g=m/2),r-=g),function(t){var r,i,o,s,c,l=t.next;if(t.sappo)s=a.BLEN/16;else if(l&&l.type==a.NOTE||!t.prev||t.prev.type!=a.NOTE){for(l.ts_prev.ts_next=l.ts_next,l.ts_next.ts_prev=l.ts_prev,c=l.ts_next;c;c=c.ts_next)if(c.time!=l.time){l.ts_next=c,l.ts_prev=c.ts_prev,l.ts_prev.ts_next=l,c.ts_prev=l;break}s=l.dots?1==l.dots?l.dur/3:2*l.dur/7:l.dur/2,l.time+=s,l.dur-=s}else s=t.prev.dur/2;for(i=0,r=t.extra;r;r=r.next)r.type==a.NOTE&&i++;for(s/=i*n,o=e,r=t.extra;r;r=r.next)r.type==a.NOTE&&($(r,o,s),o+=s)}(O);break;case a.KEY:l(O);break;case a.REST:case a.NOTE:m=O.dur,O.next&&O.next.type==a.GRACE&&(g=0,O.next.sappo?g=a.BLEN/16:O.next.next&&O.next.next.type==a.NOTE||(g=m/2),O.next.time-=g,m-=g),m/=n,O.type==a.NOTE?$(O,e,m):t.push(new Float32Array([O.istart,e,0,0,m,0,O.v]));break;case a.STAVES:y=O.sy.top_voice}O=O.ts_next}}}}function Audio5(t){function e(t){var e,r,n,a,i=t.length,o=0;for(n=3*i/4,"="==t[i-1]&&("="==t[i-2]&&n--,n--,i-=4),a=new Uint8Array(n),e=0;e<i;e+=4)r=(b[t[e]]<<18)+(b[t[e+1]]<<12)+(b[t[e+2]]<<6)+b[t[e+3]],a[o++]=r>>16&255,a[o++]=r>>8&255,a[o++]=255&r;return i!=t.length&&(r=(b[t[e]]<<18)+(b[t[e+1]]<<12)+(b[t[e+2]]<<6)+b[t[e+3]],a[o++]=r>>16&255,o<n&&(a[o++]=r>>8&255)),a}function r(t,e){var r,n=t.getChannelData(0);for(r=0;r<e.length;r++)n[r]=e[r]/196608}function n(t,e){var n,a,i,o,s,c,u=t.getInstruments()[0].info;for(v[e]=[],n=0;n<u.length;n++)if(i=u[n].generator,i.sampleID){a=i.sampleID.amount,s=t.sampleHeader[a].sampleRate,c=t.sample[a],o={attack:Math.pow(2,(i.attackVolEnv?i.attackVolEnv.amount:-12e3)/1200),hold:Math.pow(2,(i.holdVolEnv?i.holdVolEnv.amount:-12e3)/1200),decay:Math.pow(2,(i.decayVolEnv?i.decayVolEnv.amount:-12e3)/1200)/3,sustain:i.sustainVolEnv?i.sustainVolEnv.amount/1e3:0,buffer:l.createBuffer(1,c.length,s)},o.hold+=o.attack,o.decay+=o.hold,o.sustain>=.4?o.sustain=.01:o.sustain=1-o.sustain/.4,r(o.buffer,c),i.sampleModes&&1&i.sampleModes.amount&&(o.loopStart=t.sampleHeader[a].startLoop/s,o.loopEnd=t.sampleHeader[a].endLoop/s);var f=(i.scaleTuning?i.scaleTuning.amount:100)/100,$=(i.coarseTune?i.coarseTune.amount:0)+(i.fineTune?i.fineTune.amount:0)/100+t.sampleHeader[a].pitchCorrection/100-(i.overridingRootKey?i.overridingRootKey.amount:t.sampleHeader[a].originalPitch);for(j=i.keyRange.lo;j<=i.keyRange.hi;j++)v[e][j]=Math.pow(Math.pow(2,1/12),(j+$)*f),m[e][j]=o}}function a(t){y++,abc2svg.loadjs(d.sfu+"/"+t+".js",function(){var r=new sf2.Parser(e(abcsf2[t]));r.parse(),n(r,t),y--},function(){g("could not find the instrument "+(t/128|0).toString()+"-"+(t%128).toString()),y--})}function i(t){var e,r,n;for(e=f;(r=t[e])&&!(f>=$);e++)n=r[2],m[n]||(m[n]=[],a(n))}function o(t,e,r){var n,a=t[2],i=0|t[3],o=m[a][i],s=l.createBufferSource();if(o){if(s.buffer=o.buffer,o.loopStart&&(s.loop=!0,s.loopStart=o.loopStart,s.loopEnd=o.loopEnd),s.detune){var c=100*t[3]%100;c&&(s.detune.value=c)}s.playbackRate.value=v[a][i],n=l.createGain(),o.hold<.002?n.gain.setValueAtTime(1,e):(o.attack<.002?n.gain.setValueAtTime(1,e):(n.gain.setValueAtTime(0,e),n.gain.linearRampToValueAtTime(1,e+o.attack)),n.gain.setValueAtTime(1,e+o.hold)),n.gain.exponentialRampToValueAtTime(o.sustain,e+o.decay),s.connect(n),n.connect(u),s.start(e),s.stop(e+r)}}function s(t){var e,r,n,a,i;if(!(r=t[f])||f>=$)return void p();for(d.new_speed&&(_=l.currentTime-(l.currentTime-_)*d.speed/d.new_speed,d.speed=d.new_speed,d.new_speed=0),e=r[1]/d.speed,n=e+3;;){i=r[4]/d.speed,0!=r[5]&&o(r,e+_,i);var c=r[0];if(a=1e3*(e+_-l.currentTime),setTimeout(h,a,c,!0),setTimeout(h,a+1e3*i,c,!1),!(r=t[++f])||f>=$)return void setTimeout(p,1e3*(e+_-l.currentTime+i));if((e=r[1]/d.speed)>n)break}setTimeout(s,1e3*(e+_-l.currentTime)-300,t)}function c(t){return 0==$?void p():0!=y?void setTimeout(c,300,t):(u.connect(l.destination),_=l.currentTime+.2-t[f][1]*d.speed,void s(t))}var l,u,f,$,_,d=t,p=d.onend||function(){},h=d.onnote||function(){},g=d.errmsg||alert,m=[],v=[],y=0,b=[];return function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=t.length,r=0;r<e;r++)b[t[r]]=r;b["="]=0}(),d.sfu||(d.sfu="Scc1t2"),{get_outputs:function(){return window.AudioContext||window.webkitAudioContext?["sf2"]:null},play:function(t,e,r){if(!r||t>=r.length)return void p();u||(l=d.ac,l||(d.ac=l=new(window.AudioContext||window.webkitAudioContext)),u=l.createGain(),u.gain.value=d.gain),$=e,f=t,i(r),c(r)},stop:function(){$=0,u&&(u.disconnect(),u=null)},set_vol:function(t){u&&(u.gain.value=t)}}}function Midi5(t){function e(t,e,r){var a=0|t[3],i=t[2],o=15&t[6],r=100*t[3]%100;i!=u[o]&&(u[o]=i,n.send(new Uint8Array([176+o,0,i>>14&127,176+o,32,i>>7&127,192+o,127&i]))),r&&Midi5.ma.sysexEnabled&&n.send(new Uint8Array([240,127,127,8,2,127&i,1,a,a,r/.78125,0,247]),e),n.send(new Uint8Array([144+o,a,127]),e),n.send(new Uint8Array([128+o,a,64]),e+r-20)}function r(t){var u,f,$,_,d;if(f=t[a],!n||a>=i||!f)return void c();for(s.new_speed&&(o=window-performance.now()-(window.performance.now()-o)*s.speed/s.new_speed,s.speed=s.new_speed,s.new_speed=0),u=f[1]/s.speed*1e3,$=u+3e3;;){if(d=f[4]/s.speed*1e3,0!=f[5]&&e(f,u+o,d),_=u+o-window.performance.now(),setTimeout(l,_,f[0],!0),setTimeout(l,_+d,f[0],!1),!(f=t[++a])||a>=i)return void setTimeout(c,u+o-window.performance.now()+d);if((u=f[1]/s.speed*1e3)>$)break}setTimeout(r,u+o-window.performance.now()-300,t)}var n,a,i,o,s=t,c=s.onend||function(){},l=s.onnote||function(){},u=[];return{get_outputs:function(){if(Midi5.ma&&(n=Midi5.ma.outputs.values().next().value),n)return[n.name]},set_output:function(t){},play:function(t,e,n){if(!n||t>=n.length)return void c();i=e,a=t,o=window.performance.now()+200-n[a][1]*s.speed*1e3,r(n)},stop:function(){i=0,n&&n.clear&&n.clear()}}}function onMIDISuccess(t){Midi5.ma=t}function onMIDIFailure1(t){navigator.requestMIDIAccess().then(onMIDISuccess,onMIDIFailure2)}function onMIDIFailure2(t){}function isQuoted(t){return t.q}function quote(t){return t.q=!0,t}function unquote(t){return delete t.q,t}function Symbol(t){return this.nm=t,this}function isSymbol(t){return t&&t.constructor===Symbol}function symbolName(t){return t.nm}function isArray(t){return t&&t.constructor===Array}function inDs(t,e){for(var r=t.length-1;0<=r;--r)if(void 0!==t[r][e])return t[r];return!1}function member(t,e){return 0<=e.indexOf(t)}function PsParser(){function t(t){c.L=t,c.N=t.length,c.I=0,c.D=0}function e(){return c.I<c.N&&c.L[c.I]}function r(){return c.I<c.N&&c.L[c.I++]}function n(){for(;c.I<c.N&&member(c.L[c.I]," \t\n");)c.I++}function a(){for(;"%"==e();){for(;e()&&"\n"!=e();)r();n()}}function i(){r();for(var t=[],n=1;0<n&&e();){var a=r();switch(a){case"(":n++;break;case")":n--,n<=0&&(a=!1);break;case"\\":switch(a=r()){case"(":case")":case"\\":break;case"n":a="\n";break;case"r":a="\r";break;case"t":a="\t";break;default:a=!1}}!1!==a&&t.push(a)}return t.join("")}function o(){var t=r();if(member(t,"()<>/% \t\n"))throw new Error("Symbol expected, got "+t);for(var n=member(t,"+-0123456789."),a="."==t,i=[t];e()&&!member(e(),"()<>[]{}/% \t\n");)t=r(),i.push(t),n&&!member(t,"0123456789")&&(a||"."!=t?n=!1:a=!0);return i=i.join(""),1==i.length&&member(i,"+-.")&&(n=!1),n?a?parseFloat(i):parseInt(i,10):new Symbol(i)}function s(){switch(n(),e()){case!1:return;case"%":return a();case"[":case"]":return new Symbol(r());case"{":return c.D++,new Symbol(r());case"}":return c.D--,new Symbol(r());case"/":r();return quote(o());case"(":return i();case"<":if(r(),"<"!=e())throw new Error("Encoded strings not implemented yet");return r(),new Symbol("<<");case">":if(r(),">"!=e())throw new Error("Unexpected >");return r(),new Symbol(">>");default:return o()}}var c=this;return PsParser.prototype.init=t,PsParser.prototype.peek=e,PsParser.prototype.token=s,this}function Ps0(t,e,r){function n(a,i){if(isSymbol(a)&&!isQuoted(a)){var o=symbolName(a),s=inDs(e,o);if(!s)throw new Error("bind error '"+o+"'");r.push([!1,s[o]])}else if(i&&isArray(a)&&isQuoted(a)){if(0<a.length){var c=a[0],l=quote(a.slice(1));0<l.length&&r.push([!1,l]),n(c,!1)}}else"function"==typeof a?a():t.push(a)}function a(){n(t.pop(),!1)}function i(){for(var e=r.pop(),a=(e.shift(),e.pop()),i=0;i<e.length;i++)t.push(e[i]);n(a,!0)}function o(e){for(s.init(e);s.peek();){var n=s.token();if((n||0===n)&&(t.push(n),s.D<=0||isSymbol(n)&&(member(symbolName(n),"[]{}")||"<<"==symbolName(n)||">>"==symbolName(n))))for(a();0<r.length;)i()}return t}var s=new PsParser;return Ps0.prototype.run=n,Ps0.prototype.exec=a,Ps0.prototype.step=i,Ps0.prototype.parse=o,this}function Wps(t){function e(t){if(isSymbol(t)&&!isQuoted(t))return t;if(isArray(t)&&isQuoted(t)){for(var r=t.length,n=[],a=0;a<r;a++){var i=t[a],o=e(i);n=isArray(i)?n.concat(isQuoted(i)?quote([o]):[o]):n.concat(o)}return quote(n)}return t}function r(){var t=arguments;if(t.length)for(var e=0;e<t.length;e++)c.parse(t[e]);else c.parse(t);return a}var n=t,a=[],i={},o=[i],s=[],c=new Ps0(a,o,s);i.true=function(){a.push(!0)},i.false=function(){a.push(!1)},i.null=function(){a.push(null)},i.sub=function(){var t=a.pop();a.push(a.pop()-t)},i.mul=function(){a.push(a.pop()*a.pop())},i.div=function(){var t=a.pop();a.push(a.pop()/t)},i.mod=function(){var t=a.pop();a.push(a.pop()%t)};var l={};i.mark=function(){a.push(l)},i.counttomark=function(){for(var t=0,e=a.length-1;0<=e;e--){if(l===a[e])return a.push(t);t++}throw new Error("Mark not found")},i["<<"]=i.mark,i[">>"]=function(){for(var t={};0<a.length;){var e=a.pop();if(l===e)return a.push(t);t[a.pop()]=e}throw new Error("Mark not found")},i.exch=function(){var t=a.pop(),e=a.pop();a.push(t),a.push(e)},i.clear=function(){a.length=0},i.pop=function(){a.pop()},i.index=function(){a.push(a[a.length-2-a.pop()])},i.roll=function(){var t=a.pop(),e=a.pop(),r=[],n=[];t<0&&(t=e+t);for(var i=0;i<e;i++)i<t?r.unshift(a.pop()):n.unshift(a.pop());for(i=0;i<t;i++)a.push(r.shift());for(i=0;i<e-t;i++)a.push(n.shift())},i.copy=function(){var t=a.pop();if("object"==typeof t){var e=a.pop();for(var r in e)t[r]=e[r];a.push(t)}else for(var e=a.length-t,r=0;r<t;r++)a.push(a[e+r])},i.length=function(){a.push(a.pop().length)},i.astore=function(){for(var t=a.pop(),e=t.length,r=e-1;0<=r;r--)t[r]=a.pop();a.push(t)},i.array=function(){a.push(new Array(a.pop()))},i.eq=function(){var t=a.pop(),e=a.pop();a.push(e==t)},i.lt=function(){var t=a.pop(),e=a.pop();a.push(e<t)},i.ifelse=function(){var t=a.pop(),e=a.pop(),r=a.pop();s.push([!1,!0===r?e:t])},i.and=function(){var t=a.pop(),e=a.pop();if(!0===t||!1===t)return void a.push(1==t&&!0===e);a.push(t&e)},i.repeat=function t(){var e=a.pop(),r=a.pop();1<r&&s.push([!0,r-1,e,t]),0<r&&s.push([!1,e])},i.for=function t(){var e=a.pop(),r=a.pop(),n=a.pop(),i=a.pop();n<0?(r<=i+n&&s.push([!0,i+n,n,r,e,t]),r<=i&&s.push([!1,i,e])):(i+n<=r&&s.push([!0,i+n,n,r,e,t]),i<=r&&s.push([!1,i,e]))},i.exec=function(){s.push([!1,a.pop()])},i.cvx=function(){var t=a.pop();isSymbol(t)&&isQuoted(t)?a.push(unquote(t)):isArray(t)&&!isQuoted(t)?a.push(quote(t)):a.push(t)},i.dict=function(){a.pop(),a.push({})},i.get=function(){var t=a.pop(),e=a.pop();isSymbol(t)?a.push(e[symbolName(t)]):a.push(e[t])},i.getinterval=function(){for(var t=a.pop(),e=a.pop()+t,r=a.pop(),n=[];--t>=0;)n.push(r[e++]);a.push(n)},i.put=function(){var t=a.pop(),e=a.pop(),r=a.pop();isSymbol(e)?r[symbolName(e)]=t:r[e]=t},i.begin=function(){o.push(a.pop())},i.end=function(){o.pop()},i.currentdict=function(){a.push(o[o.length-1])},i.where=function(){var t=symbolName(a.pop()),e=inDs(o,t);e?(a.push(e),a.push(!0)):a.push(!1)},i.save=function(){for(var t=o.slice(),e=0;e<t.length;e++){var r=t[e],n={};for(var i in r)n[i]=r[i];t[e]=n}a.push(t)},i.restore=function(){for(var t=a.pop();0<o.length;)o.pop();for(;0<t.length;)o.unshift(t.pop())},i.type=function(){var t,e=a.pop();if(null===e)t="nulltype";else if(!0===e||!1===e)t="booleantype";else if(l===e)t="marktype";else if("string"==typeof e)t="stringtype";else if(isSymbol(e))t=isQuoted(e)?"nametype":"operatortype";else if("function"==typeof e)t="operatortype";else if(isArray(e))t="arraytype";else if("object"==typeof e)t="dicttype";else{if(1*e!=e)throw new Error("Undefined type '"+e+"'");t=e%1==0?"integertype":"realtype"}a.push(t)};var u=!0;return i[".strictBind"]=function(){u=!0===a.pop()},i.bind=function(){a.push(e(a.pop()))},i["="]=function(){var t=a.pop();alert(t&&t.nm||t)},i["=="]=function(){alert(a.pop())},i.stack=function(){alert(a)},i.pstack=function(){alert(a)},i[".call"]=function(){for(var t=a.pop(),e=a.pop(),r=a.pop(),n=[],i=0;i<t;i++)n.unshift(a.pop());if(!r[e])throw new Error(".call: "+e+" undef");a.push(r[e].apply(r,n))},i[".call0"]=function(){for(var t=a.pop(),e=a.pop(),r=a.pop(),n=[],i=0;i<t;i++)n.unshift(a.pop());if(!r[e])throw new Error(".call0: "+e+" undef");r[e].apply(r,n)},i[".svg"]=function(){a.push(n)},i[".math"]=function(){a.push(Math)},i[".date"]=function(){a.push(new Date)},i[".window"]=function(){a.push(window)},i[".callback"]=function(){var t=a.pop();a.push(function(){for(c.run(t,!0);0<s.length;)c.step()})},i[".minv"]=function(){var t=a.pop(),e=t[0],r=t[1],n=t[2],i=t[3],o=t[4],s=t[5];a.push([i,r,n,e,n*s-i*o,r*o-e*s])},i[".mmul"]=function(){var t=a.pop(),e=a.pop(),r=e[0],n=e[1],i=e[2],o=e[3],s=e[4],c=e[5],l=t[0],u=t[1],f=t[2],$=t[3],_=t[4],d=t[5];a.push([r*l+n*f,r*u+n*$,i*l+o*f,i*u+o*$,s*l+c*f+_,s*u+c*$+d])},i[".xy"]=function(){var t=a.pop(),e=a.pop(),r=a.pop();a.push(t[0]*r+t[2]*e+t[4]),a.push(t[1]*r+t[3]*e+t[5])},i[".rgb"]=function(){var t=a.pop(),e=a.pop(),r=a.pop();a.push("rgb("+r+","+e+","+t+")")},i[".rgba"]=function(){var t=a.pop(),e=a.pop(),r=a.pop(),n=a.pop();a.push("rgba("+n+","+r+","+e+","+t+")")},Wps.prototype.parse=r,this}function Psvg(t){function e(){return s(0),[v.xoffs-v.xorig,v.yoffs-v.yorig]}function r(){if(_=!1,s(0),p+="<g",1!=v.xscale||1!=v.yscale||v.rotate){if(p+=' transform="',1==v.xscale&&1==v.yscale||(v.xscale==v.yscale?p+="scale("+v.xscale.toFixed(3)+")":p+="scale("+v.xscale.toFixed(3)+","+v.yscale.toFixed(3)+")"),v.rotate){if(v.xoffs||v.yoffs){var t,e=v.xoffs,r=v.yoffs,n=v.sin,i=v.cos;t=e*i-r*n,r=e*n+r*i,p+=" translate("+t.toFixed(2)+","+r.toFixed(2)+")",b=v.xoffs,w=v.yoffs,v.xoffs=0,v.yoffs=0}p+=" rotate("+v.rotate.toFixed(2)+")"}p+='"'}a(!1),v.rgb&&(p+=' style="color:'+v.rgb+'"'),p+=">\n",m=1}function n(t){var e,r=new t.constructor;for(e in t)t.hasOwnProperty(e)&&(r[e]=t[e]);return r}function a(t){var e=v.font_n;if(e){var r="",n=e.indexOf("Italic"),a=100,i=e.indexOf("Oblique"),o=e.indexOf("Bold"),s=0;o>0&&(r=' font-weight="bold"',a=o,s=2),(n>0||i>0)&&(n>0&&(r+=' font-style="italic"',n<a&&(a=n),s|=4),i>0&&(r+=' font-style="oblique"',i<a&&(a=i),s=8)),100!=a&&("-"==e[a-1]&&a--,e=e.slice(0,a)),t&&(!(2&s)&&x.indexOf("Bold")>=0&&(r+=' font-weight="normal"'),12&s||!(x.indexOf("Italic")>=0||x.indexOf("Oblique")>=0)||(r+=' font-style="normal"')),p+=' font-family="'+e+'"'+r+' font-size="'+v.font_s+'"'}}function i(){d||(s(1),v.px=v.cx,v.py=v.cy,d='<path d="m'+(v.xoffs+v.cx).toFixed(2)+" "+(v.yoffs-v.cy).toFixed(2)+"\n")}function o(){p+=d,d=""}function s(t){2==m&&(p+="</text>\n",m=1),0==t?m&&(m=0,p+="</g>\n",v.rotate&&(v.xoffs=b,v.yoffs=w,b=0,w=0)):_&&r()}function c(t){return t.length*v.font_s*.5}function l(t,e,r,n,a,o){var s,c,l,u;n>=360&&(n-=360),a>=360&&(a-=360),s=t+r*Math.cos(n*Math.PI/180),c=e+r*Math.sin(n*Math.PI/180),void 0!=v.cx?d?(s!=v.cx||c!=v.cy?d+="l":d+="m",d+=(s-v.cx).toFixed(2)+" "+(-(c-v.cy)).toFixed(2)):(v.cx=s,v.cy=c,i()):(d&&(d=""),v.cx=s,v.cy=c,i()),n==a?(a=180-n,l=t+r*Math.cos(a*Math.PI/180),u=e+r*Math.sin(a*Math.PI/180),d+="a"+r.toFixed(2)+" "+r.toFixed(2)+" 0 0 "+(o?"1 ":"0 ")+(l-s).toFixed(2)+" "+(c-u).toFixed(2)+" "+r.toFixed(2)+" "+r.toFixed(2)+" 0 0 "+(o?"1 ":"0 ")+(s-l).toFixed(2)+" "+(u-c).toFixed(2)+"\n",v.cx=s,v.cy=c):(l=t+r*Math.cos(a*Math.PI/180),u=e+r*Math.sin(a*Math.PI/180),d+="a"+r.toFixed(2)+" "+r.toFixed(2)+" 0 0 "+(o?"1 ":"0 ")+(l-s).toFixed(2)+" "+(c-u).toFixed(2)+"\n",v.cx=l,v.cy=u)}function u(t,e){i(),d+=0==t?"\tv"+(-e).toFixed(2)+"\n":0==e?"\th"+t.toFixed(2)+"\n":"\tl"+t.toFixed(2)+" "+(-e).toFixed(2)+"\n",v.cx+=t,v.cy+=e}function f(t){t&&s(0),p&&(h.out_svg(p),p="")}function $(t,e,r,n){return v.xorig=v.xoffs=h.sx(0),v.yorig=v.yoffs=h.sy(0),v.cx=0,v.cy=0,g.parse(n+(e/h.stv_g().scale).toFixed(2)+" "+r.toFixed(2)+" "+t),f(!0),!0}var _,d,p="",h=t,g=new Wps(this),m=0,v={cx:0,cy:0,xoffs:0,yoffs:0,xscale:1,yscale:1,rotate:0,sin:0,cos:1,linewidth:.7,dash:""},y=[],b=0,w=0,x="";Psvg.prototype.strw=c,Psvg.prototype.arc=l,Psvg.prototype.arcn=function(t,e,r,n,a){l(t,e,r,n,a,!0)},Psvg.prototype.closepath=function(){d&&v.cx&&u(v.px-v.cx,v.py-v.cy)},Psvg.prototype.cx=function(){return v.cx},Psvg.prototype.cy=function(){return v.cy},Psvg.prototype.curveto=function(t,e,r,n,a,o){i(),d+="\tC"+(v.xoffs+t).toFixed(2)+" "+(v.yoffs-e).toFixed(2)+" "+(v.xoffs+r).toFixed(2)+" "+(v.yoffs-n).toFixed(2)+" "+(v.xoffs+a).toFixed(2)+" "+(v.yoffs-o).toFixed(2)+"\n",v.cx=a,v.cy=o},Psvg.prototype.eofill=function(){o(),p+='" fill-rule="evenodd" fill="currentColor"/>\n'},Psvg.prototype.fill=function(){o(),p+='" fill="currentColor"/>\n'},Psvg.prototype.gsave=function(){y.push(n(v))},Psvg.prototype.grestore=function(){v=y.pop(),_=!0},Psvg.prototype.lineto=function(t,e){i(),t==v.cx?d+="\tv"+(v.cy-e).toFixed(2)+"\n":e==v.cy?d+="\th"+(t-v.cx).toFixed(2)+"\n":d+="\tl"+(t-v.cx).toFixed(2)+" "+(v.cy-e).toFixed(2)+"\n",v.cx=t,v.cy=e},Psvg.prototype.moveto=function(t,e){v.cx=t,v.cy=e,d?d+="\tM"+(v.xoffs+v.cx).toFixed(2)+" "+(v.yoffs-v.cy).toFixed(2)+"\n":2==m&&(p+="</text>\n",m=1)},Psvg.prototype.newpath=function(){v.cx=v.cy=void 0},Psvg.prototype.rcurveto=function(t,e,r,n,a,o){i(),d+="\tc"+t.toFixed(2)+" "+(-e).toFixed(2)+" "+r.toFixed(2)+" "+(-n).toFixed(2)+" "+a.toFixed(2)+" "+(-o).toFixed(2)+"\n",v.cx+=a,v.cy+=o},Psvg.prototype.rlineto=u,Psvg.prototype.rmoveto=function(t,e){d?d+="\tm"+t.toFixed(2)+" "+(-e).toFixed(2)+"\n":2==m&&(p+="</text>\n",m=1),v.cx+=t,v.cy+=e},Psvg.prototype.rotate=function(t){s(0);var e,r=v.xoffs,n=v.yoffs,a=v.sin,i=v.cos;e=r*i-n*a,n=r*a+n*i,v.xoffs=e/v.xscale,v.yoffs=n/v.yscale,r=v.cx,n=v.cy,e=r*i-n*a,n=-r*a+n*i,v.cx=e/v.xscale,v.cy=n/v.yscale,t=360-t,v.rotate+=t,v.rotate>180?v.rotate-=360:v.rotate<=-180&&(v.rotate+=360),t=v.rotate*Math.PI/180,v.sin=a=Math.sin(t),v.cos=i=Math.cos(t),e=v.cx,v.cx=(e*i+v.cy*a)*v.xscale,v.cy=(-e*a+v.cy*i)*v.yscale,e=v.xoffs,v.xoffs=(e*i+v.yoffs*a)*v.xscale,v.yoffs=(-e*a+v.yoffs*i)*v.yscale,_=!0},Psvg.prototype.scale=function(t,e){v.xoffs/=t,v.yoffs/=e,v.cx/=t,v.cy/=e,v.xscale*=t,v.yscale*=e,_=!0},Psvg.prototype.selectfont=function(t,e){t=t.nm,0==e&&""==t||(v.font_n_old=v.font_n,v.font_n=t,v.font_s=e,_=!0)},
Psvg.prototype.setdash=function(t,e){var r,n=t.length;if(0==n)return void(v.dash="");for(v.dash=' stroke-dashoffset="'+e+'"  stroke-dasharray="',r=0;;){if(v.dash+=t[r],0==--n)break;v.dash+=" "}v.dash+='"'},Psvg.prototype.setlinewidth=function(t){v.linewidth=t},Psvg.prototype.setrgbcolor=function(t,e,r){var n=16777216+(Math.floor(255*t)<<16)+(Math.floor(255*e)<<8)+Math.floor(255*r);n=n.toString(16),(n=n.replace("1","#"))!=v.rgb&&(v.rgb=n,_=!0)},Psvg.prototype.show=function(t){var e,n,i;_&&(2==m?e=!0:r()),n=v.cx,i=v.cy,e?(p+="<tspan\n\t",a(!0),p+=">"):2!=m&&(p+='<text x="'+(n+v.xoffs).toFixed(2)+'" y="'+(v.yoffs-i).toFixed(2)+'">',m=2),p+=t.replace(/<|>|&|  /g,function(t){switch(t){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";case"  ":return" "}}),e&&(p+="</tspan>"),v.cx=n+c(t)},Psvg.prototype.stroke=function(){o(),.7!=v.linewidth&&(p+='" stroke-width="'+v.linewidth.toFixed(2)),p+='" stroke="currentColor" fill="none"'+v.dash+"/>\n"},Psvg.prototype.translate=function(t,e){v.xoffs+=t,v.yoffs-=e,v.cx-=t,v.cy-=e},Psvg.prototype.arp=function(t,r,n){var a=e();f(),h.out_arp((r+a[0])*h.stv_g().scale,n-a[1],t)},Psvg.prototype.ltr=function(t,r,n){var a=e();f(),h.out_ltr((r+a[0])*h.stv_g().scale,n-a[1],t)},Psvg.prototype.xygl=function(t,r,n){var a=e();f(),h.xygl((t+a[0])*h.stv_g().scale,r-a[1],n)},Psvg.prototype.xygls=function(t,r,n,a){var i=e();f(),h.out_deco_str((r+i[0])*h.stv_g().scale,n-i[1],a,t)},Psvg.prototype.xyglv=function(t,r,n,a){var i=e();f(),h.out_deco_val((r+i[0])*h.stv_g().scale,n-i[1],a,t)},Psvg.prototype.y0=function(t){return t+h.get_staff_tb()[0].y},Psvg.prototype.y1=function(t){return t+h.get_staff_tb()[1].y},Psvg.prototype.ps_flush=f,Psvg.prototype.ps_eval=function(t){g.parse(t),f()},Psvg.prototype.psdeco=function(t,e,r,n){var a,i,o,s,c=g.parse("/"+t+" where"),l=c.pop(),u=h.get_staff_tb();return!!l&&(s=0,n.defl.nost&&(s=1),n.defl.noen&&(s|=2),n.s.stem>=0&&(s|=4),c.pop(),o="/defl "+s+" def ",n.lden&&(o+=e.toFixed(2)+" "+r.toFixed(2)+" ",i=n.start,e=i.x,r=i.y+u[i.st].y,e>n.x-20&&(e=n.x-20)),a=n.dd,n.has_val?o+=n.val+" ":a.str&&(o+="("+a.str+") ",r+=.2*a.h),$(t,e,r,o))},Psvg.prototype.psxygl=function(t,e,r){var n=g.parse("/"+r+" where");return!!n.pop()&&(n.pop(),$(r,t,e,"dlw "))},Psvg.prototype.svgcall=function(t,r,n,a,i){var o=e();f(),t((r+o[0])*h.stv_g().scale,n-o[1],a,i)},g.parse("currentdict/systemdict currentdict put\nsystemdict/{/mark cvx put\nsystemdict/[/mark cvx put\nsystemdict/]\n/counttomark cvx\n/array cvx\n/astore cvx\n/exch cvx\n/pop cvx\n5 array astore cvx put\nsystemdict/}/] cvx/cvx cvx 2 array astore cvx put\nsystemdict/def{currentdict 2 index 2 index put pop pop}put\n\n/maxlength 1000 def % TODO\n/.bdef{bind def}bind def\n/.xdef{exch def}.bdef\n/dup{0 index}.bdef\n/load{dup where pop exch get}.bdef\n/.ldef{load def}.bdef\n/if{{}ifelse}.bdef\n/cleartomark{array pop}.bdef\n/known{exch begin where{currentdict eq}{false}if end}.bdef\n/store{1 index where{3 1 roll put}{def}ifelse}.bdef\n/not{{false}{true}ifelse}.bdef\n%/.logand{{{true}{false}ifelse}{pop false}ifelse}.bdef\n%/and/.logand .ldef % TODO numeric and\n/.logor{{pop true}{{true}{false}ifelse}ifelse}.bdef\n/or/.logor .ldef % TODO numeric or\n/ne{eq not}.bdef\n/ge{lt not}.bdef\n/le{1 index 1 index eq 3 1 roll lt or}.bdef\n/gt{le not}.bdef\n/.repeat{1 1 4 2 roll for}.bdef\n\n%% math\n\n/floor{.math(floor)1 .call}.bdef\n\n/neg{0 exch sub}.bdef\n/add{neg sub}.bdef\n/idiv{div floor}.bdef\n\n/.pi{.math(PI)get}.bdef\n\n/abs{.math(abs)1 .call}.bdef\n%/.acos{.math(acos)1 .call}.bdef\n%/.asin{.math(asin)1 .call}.bdef\n/atan{.math(atan2)2 .call 180 mul .pi div}.bdef\n%/.atan2{.math(atan2)2 .call}.bdef\n%/ceiling{.math(ceil)1 .call}.bdef\n/cos{.pi mul 180 div .math(cos)1 .call}.bdef\n%/.exp{.math(exp)1 .call}.bdef\n%/log{.math(log)1 .call}.bdef\n%/.max{.math(max)2 .call}.bdef\n%/.min{.math(min)2 .call}.bdef\n%/.pow{.math(pow)2 .call}.bdef\n%/.random{.math(random)0 .call}.bdef\n%/rand{.random}.bdef % TODO follow spec\n%/round{.math(round)1 .call}.bdef\n%/sin{.math(sin)1 .call}.bdef\n%/sqrt{.math(sqrt)1 .call}.bdef\n%/.tan{.math(tan)1 .call}.bdef\n%/truncate{.math(truncate)1 .call}.bdef % TODO Math.truncate does not exist!\n\n% graphic\n/arc{.svg(arc)5 .call0}.bdef\n/arcn{.svg(arcn)5 .call0}.bdef\n/closepath{.svg(closepath)0 .call}.bdef\n/currentpoint{.svg(cx)0 .call .svg(cy)0 .call}.bdef\n/curveto{.svg(curveto)6 .call0}.bdef\n/eofill{.svg(eofill)0 .call0}.bdef\n/fill{.svg(fill)0 .call0}.bdef\n/grestore{.svg(grestore)0 .call0}.bdef\n/gsave{.svg(gsave)0 .call0}.bdef\n/lineto{.svg(lineto)2 .call0}.bdef\n/moveto{.svg(moveto)2 .call0}.bdef\n/newpath{.svg(newpath)0 .call0}.bdef\n/rcurveto{.svg(rcurveto)6 .call0}.bdef\n/rlineto{.svg(rlineto)2 .call0}.bdef\n/rmoveto{.svg(rmoveto)2 .call0}.bdef\n/rotate{.svg(rotate)1 .call0}.bdef\n/scale{.svg(scale)2 .call0}.bdef\n/selectfont{.svg(selectfont)2 .call0}.bdef\n/setdash{.svg(setdash)2 .call0}.bdef\n/setlinewidth{.svg(setlinewidth)1 .call0}.bdef\n/setrgbcolor{.svg(setrgbcolor)3 .call0}.bdef\n/show{.svg(show)1 .call0}.bdef\n/stroke{.svg(stroke)0 .call0}.bdef\n/stringwidth{.svg(strw)1 .call 1}.bdef\t\t%fixme: height KO\n/translate{.svg(translate)2 .call0}.bdef\n\n/setgray{255 mul dup dup setrgbcolor}.bdef\n% abcm2ps syms.c\n/!{bind def}bind def\n/T/translate load def\n/M/moveto load def\n/RM/rmoveto load def\n/L/lineto load def\n/RL/rlineto load def\n/C/curveto load def\n/RC/rcurveto load def\n/SLW/setlinewidth load def\n/defl 0 def\n/dlw{0.7 SLW}!\n/xymove{/x 2 index def/y 1 index def M}!\n/showc{dup stringwidth pop .5 mul neg 0 RM show}!\n%\n% abcm2ps internal glyphs\n/arp{.svg(arp)3 .call0}.bdef\n/ltr{.svg(ltr)3 .call0}.bdef\n/ft0{(acc-1).svg(xygl)3 .call0}.bdef\n/nt0{(acc3).svg(xygl)3 .call0}.bdef\n/sh0{(acc1).svg(xygl)3 .call0}.bdef\n/dsh0{(acc2).svg(xygl)3 .call0}.bdef\n/trl{(trl).svg(xygl)3 .call0}.bdef\n/lmrd{(lmrd).svg(xygl)3 .call0}.bdef\n/turn{(turn).svg(xygl)3 .call0}.bdef\n/umrd{(umrd).svg(xygl)3 .call0}.bdef\n/y0{.svg(y0)1 .call}.bdef\n/y1{.svg(y1)1 .call}.bdef\n")}navigator={},function(t){function e(){}function r(){}function n(){}function a(){}function i(){}function o(t,e){if(t)return t.$$const[e]}function s(t,e){var r,n,a;if(0!==t.length)for(r=0,n=t.length;r<n;r++)if(null!=(a=t[r].$$const[e]))return a}function c(t,e){var r,n,a;if(null!=t)for(a=y.ancestors(t),r=0,n=a.length;r<n;r++)if(a[r].$$const&&w.call(a[r].$$const,e))return a[r].$$const[e]}function l(t,e){if(null==t||t.$$is_module)return c(g,e)}function u(t,e,r){if(!r)return(t||g).$const_missing(e)}function f(t,e){var r,n,a=e.$instance_methods();for(r=a.length-1;r>=0;r--)n="$"+a[r],y.bridge_method(t,e,n,e.$$proto[n])}function $(t,e){var r=e.$__id__();b[r]||(b[r]=[]),b[r].push(t)}var _,d=this;if("undefined"!=typeof global&&(d=global),"undefined"!=typeof window&&(d=window),_="object"==typeof d.console?d.console:null==d.console?d.console={}:{},"log"in _||(_.log=function(){}),"warn"in _||(_.warn=_.log),void 0!==this.Opal)return _.warn("Opal already loaded. Loading twice can cause troubles, please fix your setup."),this.Opal;var p,h,g,m,v,y=this.Opal={},b={};y.global=d,d.Opal=y,y.config={missing_require_severity:"error",unsupported_features_severity:"warning",enable_stack_trace:!0};var w=Object.hasOwnProperty,x=(y.slice=Array.prototype.slice,4);y.uid=function(){return x+=2},y.id=function(t){return t.$$is_number?2*t+1:t.$$id||(t.$$id=y.uid())},y.gvars={},y.exit=function(t){y.gvars.DEBUG&&_.log("Exited with status "+t)},y.exceptions=[],y.pop_exception=function(){y.gvars["!"]=y.exceptions.pop()||p},y.inspect=function(e){return e===t?"undefined":null===e?"null":e.$$class?e.$inspect():e.toString()},y.truthy=function(t){return t!==p&&null!=t&&(!t.$$is_boolean||1==t)},y.falsy=function(t){return t===p||null==t||t.$$is_boolean&&0==t},y.const_get_local=function(t,e,r){var n;if(null!=t){if("::"===t&&(t=g),!t.$$is_a_module)throw new y.TypeError(t.toString()+" is not a class/module");return null!=(n=o(t,e))?n:(n=u(t,e,r),null!=n?n:void 0)}},y.const_get_qualified=function(t,e,r){var n,a,i,s=y.const_cache_version;if(null!=t){if("::"===t&&(t=g),!t.$$is_a_module)throw new y.TypeError(t.toString()+" is not a class/module");return null==(a=t.$$const_cache)&&(a=t.$$const_cache=Object.create(null)),i=a[e],null==i||i[0]!==s?(null!=(n=o(t,e))||(n=c(t,e)),a[e]=[s,n]):n=i[1],null!=n?n:u(t,e,r)}},y.const_cache_version=1,y.const_get_relative=function(t,e,r){var n,a,i,f=t[0],$=y.const_cache_version;return null==(a=t.$$const_cache)&&(a=t.$$const_cache=Object.create(null)),i=a[e],null==i||i[0]!==$?(null!=(n=o(f,e))||null!=(n=s(t,e))||null!=(n=c(f,e))||(n=l(f,e)),a[e]=[$,n]):n=i[1],null!=n?n:u(f,e,r)},y.const_set=function(t,e,r){return null!=t&&"::"!==t||(t=g),r.$$is_a_module&&(null!=r.$$name&&r.$$name!==p||(r.$$name=e),null==r.$$base_module&&(r.$$base_module=t)),t.$$const=t.$$const||Object.create(null),t.$$const[e]=r,y.const_cache_version++,t===g&&(y[e]=r),r},y.constants=function(t,e){null==e&&(e=!0);var r,n,a,i,o=[t],s={};for(e&&(o=o.concat(y.ancestors(t))),e&&t.$$is_module&&(o=o.concat([y.Object]).concat(y.ancestors(y.Object))),n=0,a=o.length;n<a&&(r=o[n],t===g||r!=g);n++)for(i in r.$$const)s[i]=!0;return Object.keys(s)},y.const_remove=function(t,e){if(y.const_cache_version++,null!=t.$$const[e]){var r=t.$$const[e];return delete t.$$const[e],r}if(null!=t.$$autoload&&null!=t.$$autoload[e])return delete t.$$autoload[e],p;throw y.NameError.$new("constant "+t+"::"+t.$name()+" not defined")},y.klass=function(t,e,r,n){var a,i,s;if(null==t&&(t=g),t.$$is_class||t.$$is_module||(t=t.$$class),"function"==typeof e&&(i=e,e=g),a=o(t,r)){if(!a.$$is_class)throw y.TypeError.$new(r+" is not a class");if(e&&a.$$super!==e)throw y.TypeError.$new("superclass mismatch for class "+r);return a}return null==e&&(e=g),s=i||y.boot_class_alloc(r,n,e),a=y.setup_class_object(r,s,e.$$name,e.constructor),a.$$super=e,a.$$parent=e,y.const_set(t,r,a),t[r]=a,i?y.bridge(a,s):e.$inherited&&e.$inherited(a),a},y.boot_class_alloc=function(t,e,r){if(r){var n=function(){};n.prototype=r.$$proto||r.prototype,e.prototype=new n}return t&&(e.displayName=t+"_alloc"),e.prototype.constructor=e,e},y.setup_module_or_class=function(t){t.$$id=y.uid(),t.$$is_a_module=!0,t.$$inc=[],t.$$name=p,t.$$const=Object.create(null),t.$$cvars=Object.create(null)},y.setup_class_object=function(t,e,r,n){var a=function(){};a.prototype=n.prototype,a.displayName=r;var i=function(){};i.prototype=new a;var o=new i;return y.setup_module_or_class(o),o.$$alloc=e,o.$$name=t||p,i.displayName="#<Class:"+(t||"#<Class:"+o.$$id+">")+">",o.$$proto=e.prototype,o.$$proto.$$class=o,o.constructor=i,o.$$is_class=!0,o.$$class=v,o},y.module=function(t,e){var r;if(null==t&&(t=g),t.$$is_class||t.$$is_module||(t=t.$$class),r=o(t,e),null==r&&t===g&&(r=c(g,e)),r){if(!r.$$is_module&&r!==g)throw y.TypeError.$new(e+" is not a module")}else r=y.module_allocate(m),y.const_set(t,e,r);return r},y.module_initialize=function(t,e){if(e!==p){var r=e.$$s;e.$$s=null,e.call(t),e.$$s=r}return p},y.module_allocate=function(t){var e=function(){};e.prototype=t.$$alloc.prototype;var r=function(){};r.prototype=new e;var n=new r,a={};return y.setup_module_or_class(n),n.$$included_in=[],r.displayName="#<Class:#<Module:"+n.$$id+">>",n.$$proto=a,n.constructor=r,n.$$is_module=!0,n.$$class=m,n.$$super=t,n.$$parent=t,n},y.get_singleton_class=function(t){return t.$$meta?t.$$meta:t.$$is_class||t.$$is_module?y.build_class_singleton_class(t):y.build_object_singleton_class(t)},y.build_class_singleton_class=function(t){var e,r,n;return t.$$meta?t.$$meta:(e=t.constructor,r=t===h?v:y.build_class_singleton_class(t.$$super),n=y.setup_class_object(null,e,r.$$name,r.constructor),n.$$super=r,n.$$parent=r,n.$$is_singleton=!0,n.$$singleton_of=t,t.$$meta=n)},y.build_object_singleton_class=function(t){var e=t.$$class,r="#<Class:#<"+e.$$name+":"+e.$$id+">>",n=y.boot_class_alloc(r,function(){},e),a=y.setup_class_object(r,n,e.$$name,e.constructor);return a.$$super=e,a.$$parent=e,a.$$class=e.$$class,a.$$proto=t,a.$$is_singleton=!0,a.$$singleton_of=t,t.$$meta=a},y.class_variables=function(t){var e,r=y.ancestors(t),n=r.length,a={};for(e=n-1;e>=0;e--){var i=r[e];for(var o in i.$$cvars)a[o]=i.$$cvars[o]}return a},y.class_variable_set=function(t,e,r){var n,a=y.ancestors(t),i=a.length;for(n=i-2;n>=0;n--){var o=a[n];if(w.call(o.$$cvars,e))return o.$$cvars[e]=r,r}return t.$$cvars[e]=r,r},y.bridge_method=function(t,e,r,n){var a,i,o,s;for(a=t.$$bridge.$ancestors(),i=0,s=a.length;i<s&&(o=a[i],!w.call(o.$$proto,r)||!o.$$proto[r]||o.$$proto[r].$$donated||o.$$proto[r].$$stub||o===e);i++)if(o===e){t.prototype[r]=n;break}},y.bridge_methods=function(t,e){var r,n=b[t.$__id__()],a=e.$__id__();if(n)for(b[a]=n.slice(),r=n.length-1;r>=0;r--)f(n[r],e)},y.has_cyclic_dep=function t(e,r,n,a){var i,o,s;for(i=r.length-1;i>=0;i--)if(s=r[i],o=s.$$id,!a[o]){if(a[o]=!0,o===e)return!0;if(t(e,s[n],n,a))return!0}return!1},y.append_features=function(t,e){var r,n,a;for(a=e.$$inc.length-1;a>=0;a--)if(e.$$inc[a]===t)return;if(!e.$$is_class&&y.has_cyclic_dep(e.$$id,[t],"$$inc",{}))throw y.ArgumentError.$new("cyclic include detected");for(y.const_cache_version++,e.$$inc.push(t),t.$$included_in.push(e),y.bridge_methods(e,t),r={$$name:t.$$name,$$proto:t.$$proto,$$parent:e.$$parent,$$module:t,$$iclass:!0},e.$$parent=r,n=t.$instance_methods(),a=n.length-1;a>=0;a--)y.update_includer(t,e,"$"+n[a])},y.stubs={},y.bridge=function(t,r){if(r.$$bridge)throw y.ArgumentError.$new("already bridged");y.stub_subscribers.push(r.prototype);for(var n in y.stubs)n in r.prototype||(r.prototype[n]=y.stub_for(n));r.prototype.$$class=t,r.$$bridge=t;for(var a=t.$ancestors(),i=a.length-1;i>=0;i--)$(r,a[i]),f(r,a[i]);for(var o in e.prototype){var s=e.prototype[s];!s||!s.$$stub||o in r.prototype||(r.prototype[o]=s)}return t},y.update_includer=function(t,e,r){var n,a,i,o,s,c,l,u;if(i=t.$$proto[r],n=e.$$proto,a=n[r],!n.hasOwnProperty(r)||a.$$donated||a.$$stub)if(n.hasOwnProperty(r)&&!a.$$stub){for(o=e.$$inc,s=0,c=o.length;s<c;s++)o[s]===a.$$donated&&(l=s),o[s]===t&&(u=s);l<=u&&(n[r]=i,n[r].$$donated=t)}else n[r]=i,n[r].$$donated=t;else;e.$$included_in&&y.update_includers(e,r)},y.update_includers=function(t,e){var r,n,a,i;if(i=t.$$included_in)for(r=0,n=i.length;r<n;r++)a=i[r],y.update_includer(t,a,e)},y.ancestors=function(t){for(var e,r,n,a,i=t,o=[];i;){for(o.push(i),r=i.$$inc.length-1;r>=0;r--)for(e=y.ancestors(i.$$inc[r]),n=0,a=e.length;n<a;n++)o.push(e[n]);i=i.$$is_singleton&&i.$$singleton_of.$$is_module?i.$$singleton_of.$$super:i.$$is_class?i.$$super:null}return o},y.add_stubs=function(t){var e,r,n,a,i,o=y.stub_subscribers,s=t.length,c=o.length,l=y.stubs;for(r=0;r<s;r++)if(a=t[r],!l.hasOwnProperty(a))for(l[a]=!0,i=y.stub_for(a),n=0;n<c;n++)e=o[n],a in e||(e[a]=i)},y.stub_subscribers=[e.prototype],y.add_stub_for=function(t,e){var r=y.stub_for(e);t[e]=r},y.stub_for=function(t){function e(){this.$method_missing.$$p=e.$$p,e.$$p=null;for(var r=new Array(arguments.length),n=0,a=r.length;n<a;n++)r[n]=arguments[n];return this.$method_missing.apply(this,[t.slice(1)].concat(r))}return e.$$stub=!0,e},y.ac=function(t,e,r,n){var a="";throw r.$$is_class||r.$$is_module?a+=r.$$name+".":a+=r.$$class.$$name+"#",a+=n,y.ArgumentError.$new("["+a+"] wrong number of arguments("+t+" for "+e+")")},y.block_ac=function(t,e,r){var n="`block in "+r+"'";throw y.ArgumentError.$new(n+": wrong number of arguments ("+t+" for "+e+")")},y.find_super_dispatcher=function(t,e,r,n,a){var i,o;if(i=a?t.$$is_class||t.$$is_module?a.$$super:t.$$class.$$proto:y.find_obj_super_dispatcher(t,e,r),o=i["$"+e],!n&&o.$$stub&&y.Kernel.$method_missing===t.$method_missing)throw y.NoMethodError.$new("super: no superclass method `"+e+"' for "+t,e);return o},y.find_iter_super_dispatcher=function(t,e,r,n,a){var i=e;if(!r)throw y.RuntimeError.$new("super called outside of method");if(a&&r.$$define_meth)throw y.RuntimeError.$new("implicit argument passing of super from method defined by define_method() is not supported. Specify all arguments explicitly");return r.$$def&&(i=r.$$jsid),y.find_super_dispatcher(t,i,r,n)},y.find_obj_super_dispatcher=function(t,e,r){var n=t.$$meta||t.$$class;if(!(n=y.find_owning_class(n,r)))throw new Error("could not find current class for super()");return y.find_super_func(n,"$"+e,r)},y.find_owning_class=function(t,e){for(var r=e.$$owner;t&&(!t.$$iclass||t.$$module!==e.$$donated)&&(!t.$$iclass||t.$$module!==r)&&(!r.$$is_singleton||t!==r.$$singleton_of.$$class)&&t!==r;)t=t.$$parent;return t},y.find_super_func=function(t,e,r){for(var n=t.$$parent;n;){var a=n.$$proto[e];if(a&&a!==r)break;n=n.$$parent}return n.$$proto},y.ret=function(t){throw y.returner.$v=t,y.returner},y.brk=function(t,e){throw e.$v=t,e},y.new_brk=function(){return new Error("unexpected break")},y.yield1=function(t,e){if("function"!=typeof t)throw y.LocalJumpError.$new("no block given");var r=t.$$has_top_level_mlhs_arg,n=t.$$has_trailing_comma_in_args;return(t.length>1||(r||n)&&1===t.length)&&(e=y.to_ary(e)),(t.length>1||n&&1===t.length)&&e.$$is_array?t.apply(null,e):t(e)},y.yieldX=function(t,e){if("function"!=typeof t)throw y.LocalJumpError.$new("no block given");if(t.length>1&&1===e.length&&e[0].$$is_array)return t.apply(null,e[0]);if(!e.$$is_array){for(var r=new Array(e.length),n=0,a=r.length;n<a;n++)r[n]=e[n];return t.apply(null,r)}return t.apply(null,e)},y.rescue=function(t,e){for(var r=0;r<e.length;r++){var n=e[r];if(n.$$is_array){var a=y.rescue(t,n);if(a)return a}else{if(n===y.JS.Error)return n;if(n["$==="](t))return n}}return null},y.is_a=function(t,e){if(t.$$meta===e||t.$$class===e)return!0;if(t.$$is_number&&e.$$is_number_class)return!0;var r,n,a=y.ancestors(t.$$is_class?y.get_singleton_class(t):t.$$meta||t.$$class);for(r=0,n=a.length;r<n;r++)if(a[r]===e)return!0;return!1},y.to_hash=function(t){if(t.$$is_hash)return t;if(t["$respond_to?"]("to_hash",!0)){var e=t.$to_hash();if(e.$$is_hash)return e;throw y.TypeError.$new("Can't convert "+t.$$class+" to Hash ("+t.$$class+"#to_hash gives "+e.$$class+")")}throw y.TypeError.$new("no implicit conversion of "+t.$$class+" into Hash")},y.to_ary=function(t){if(t.$$is_array)return t;if(t["$respond_to?"]("to_ary",!0)){var e=t.$to_ary();if(e===p)return[t];if(e.$$is_array)return e;throw y.TypeError.$new("Can't convert "+t.$$class+" to Array ("+t.$$class+"#to_ary gives "+e.$$class+")")}return[t]},y.to_a=function(t){if(t.$$is_array)return t.slice();if(t["$respond_to?"]("to_a",!0)){var e=t.$to_a();if(e===p)return[t];if(e.$$is_array)return e;throw y.TypeError.$new("Can't convert "+t.$$class+" to Array ("+t.$$class+"#to_a gives "+e.$$class+")")}return[t]},y.extract_kwargs=function(t){var e=t[t.length-1];return null!=e&&e["$respond_to?"]("to_hash",!0)?(Array.prototype.splice.call(t,t.length-1,1),e.$to_hash()):y.hash2([],{})},y.kwrestargs=function(t,e){var r=[],n={},a=null,i=t.$$smap;for(a in i)e[a]||(r.push(a),n[a]=i[a]);return y.hash2(r,n)},y.send=function(t,e,r,n){var a="string"==typeof e?t["$"+e]:e;return null!=a?(a.$$p=n,a.apply(t,r)):t.$method_missing.apply(t,[e].concat(r))},y.def=function(t,e,r){t.$$eval||!t.$$is_class&&!t.$$is_module?y.defs(t,e,r):y.defn(t,e,r)},y.defn=function(t,e,r){t.$$proto[e]=r,r.$$owner=t,null==r.displayName&&(r.displayName=e.substr(1)),t.$$is_module&&(y.update_includers(t,e),t.$$module_function&&y.defs(t,e,r));var n=t.$__id__&&!t.$__id__.$$stub&&b[t.$__id__()];if(n)for(var a=n.length-1;a>=0;a--)y.bridge_method(n[a],t,e,r);var i=t.$$singleton_of;return!t.$method_added||t.$method_added.$$stub||i?i&&i.$singleton_method_added&&!i.$singleton_method_added.$$stub&&i.$singleton_method_added(e.substr(1)):t.$method_added(e.substr(1)),p},y.defs=function(t,e,r){y.defn(y.get_singleton_class(t),e,r)},y.rdef=function(t,e){if(!w.call(t.$$proto,e))throw y.NameError.$new("method '"+e.substr(1)+"' not defined in "+t.$name());delete t.$$proto[e],t.$$is_singleton?t.$$proto.$singleton_method_removed&&!t.$$proto.$singleton_method_removed.$$stub&&t.$$proto.$singleton_method_removed(e.substr(1)):t.$method_removed&&!t.$method_removed.$$stub&&t.$method_removed(e.substr(1))},y.udef=function(t,e){if(!t.$$proto[e]||t.$$proto[e].$$stub)throw y.NameError.$new("method '"+e.substr(1)+"' not defined in "+t.$name());y.add_stub_for(t.$$proto,e),t.$$is_singleton?t.$$proto.$singleton_method_undefined&&!t.$$proto.$singleton_method_undefined.$$stub&&t.$$proto.$singleton_method_undefined(e.substr(1)):t.$method_undefined&&!t.$method_undefined.$$stub&&t.$method_undefined(e.substr(1))},y.alias=function(t,e,r){var n,a="$"+e,i="$"+r,o=t.$$proto["$"+r];if(t.$$eval)return y.alias(y.get_singleton_class(t),e,r);if("function"!=typeof o||o.$$stub){for(var s=t.$$super;"function"!=typeof o&&s;)o=s[i],s=s.$$super;if("function"!=typeof o||o.$$stub)throw y.NameError.$new("undefined method `"+r+"' for class `"+t.$name()+"'")}return o.$$alias_of&&(o=o.$$alias_of),n=function(){var t,e,r,a=n.$$p;for(t=new Array(arguments.length),e=0,r=arguments.length;e<r;e++)t[e]=arguments[e];return null!=a&&(n.$$p=null),y.send(this,o,t,a)},n.displayName=e,n.length=o.length,n.$$arity=o.$$arity,n.$$parameters=o.$$parameters,n.$$source_location=o.$$source_location,n.$$alias_of=o,n.$$alias_name=e,y.defn(t,a,n),t},y.alias_native=function(t,e,r){var n="$"+e,a=t.$$proto[r];if("function"!=typeof a||a.$$stub)throw y.NameError.$new("undefined native method `"+r+"' for class `"+t.$name()+"'");return y.defn(t,n,a),t},y.hash_init=function(t){t.$$smap=Object.create(null),t.$$map=Object.create(null),t.$$keys=[]},y.hash_clone=function(t,e){e.$$none=t.$$none,e.$$proc=t.$$proc;for(var r,n,a=0,i=t.$$keys,o=t.$$smap,s=i.length;a<s;a++)r=i[a],r.$$is_string?n=o[r]:(n=r.value,r=r.key),y.hash_put(e,r,n)},y.hash_put=function(e,r,n){if(r.$$is_string)return w.call(e.$$smap,r)||e.$$keys.push(r),void(e.$$smap[r]=n);var a,i,o;if(a=e.$$by_identity?y.id(r):r.$hash(),!w.call(e.$$map,a))return i={key:r,key_hash:a,value:n},e.$$keys.push(i),void(e.$$map[a]=i);for(i=e.$$map[a];i;){if(r===i.key||r["$eql?"](i.key)){o=t,i.value=n;break}o=i,i=i.next}o&&(i={key:r,key_hash:a,value:n},e.$$keys.push(i),o.next=i)},y.hash_get=function(t,e){if(e.$$is_string){if(w.call(t.$$smap,e))return t.$$smap[e]}else{var r,n;if(r=t.$$by_identity?y.id(e):e.$hash(),w.call(t.$$map,r))for(n=t.$$map[r];n;){if(e===n.key||e["$eql?"](n.key))return n.value;n=n.next}}},y.hash_delete=function(t,e){var r,n,a=t.$$keys,i=a.length;if(e.$$is_string){if(!w.call(t.$$smap,e))return;for(r=0;r<i;r++)if(a[r]===e){a.splice(r,1);break}return n=t.$$smap[e],delete t.$$smap[e],n}var o=e.$hash();if(w.call(t.$$map,o))for(var s,c=t.$$map[o];c;){if(e===c.key||e["$eql?"](c.key)){for(n=c.value,r=0;r<i;r++)if(a[r]===c){a.splice(r,1);break}return s&&c.next?s.next=c.next:s?delete s.next:c.next?t.$$map[o]=c.next:delete t.$$map[o],n}s=c,c=c.next}},y.hash_rehash=function(e){for(var r,n,a,i=0,o=e.$$keys.length;i<o;i++)if(!e.$$keys[i].$$is_string&&(r=e.$$keys[i].key.$hash())!==e.$$keys[i].key_hash){for(n=e.$$map[e.$$keys[i].key_hash],a=t;n;){if(n===e.$$keys[i]){a&&n.next?a.next=n.next:a?delete a.next:n.next?e.$$map[e.$$keys[i].key_hash]=n.next:delete e.$$map[e.$$keys[i].key_hash];break}a=n,n=n.next}if(e.$$keys[i].key_hash=r,w.call(e.$$map,r)){for(n=e.$$map[r],a=t;n;){if(n===e.$$keys[i]){a=t;break}a=n,n=n.next}a&&(a.next=e.$$keys[i])}else e.$$map[r]=e.$$keys[i]}},y.hash=function(){var t,e,r,n,a,i,o=arguments.length;if(1===o&&arguments[0].$$is_hash)return arguments[0];if(e=new y.Hash.$$alloc,y.hash_init(e),1===o&&arguments[0].$$is_array){for(t=arguments[0],n=t.length,r=0;r<n;r++){if(2!==t[r].length)throw y.ArgumentError.$new("value not of length 2: "+t[r].$inspect());a=t[r][0],i=t[r][1],y.hash_put(e,a,i)}return e}if(1===o){t=arguments[0];for(a in t)w.call(t,a)&&(i=t[a],y.hash_put(e,a,i));return e}if(o%2!=0)throw y.ArgumentError.$new("odd number of arguments for Hash");for(r=0;r<o;r+=2)a=arguments[r],i=arguments[r+1],y.hash_put(e,a,i);return e},y.hash2=function(t,e){var r=new y.Hash.$$alloc;return r.$$smap=e,r.$$map=Object.create(null),r.$$keys=t,r},y.range=function(t,e,r){var n=new y.Range.$$alloc;return n.begin=t,n.end=e,n.excl=r,n},y.ivar=function(t){return"constructor"===t||"displayName"===t||"__count__"===t||"__noSuchMethod__"===t||"__parent__"===t||"__proto__"===t||"hasOwnProperty"===t||"valueOf"===t?t+"$":t},y.escape_regexp=function(t){return t.replace(/([-[\]\/{}()*+?.^$\\| ])/g,"\\$1").replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r").replace(/[\f]/g,"\\f").replace(/[\t]/g,"\\t")},y.modules={},y.loaded_features=["corelib/runtime"],y.current_dir=".",y.require_table={"corelib/runtime":!0},y.normalize=function(t){var e,r,n=[];"."!==y.current_dir&&(t=y.current_dir.replace(/\/*$/,"/")+t),t=t.replace(/^\.\//,""),t=t.replace(/\.(rb|opal|js)$/,""),e=t.split("/");for(var a=0,i=e.length;a<i;a++)""!==(r=e[a])&&(".."===r?n.pop():n.push(r));return n.join("/")},y.loaded=function(t){var e,r,n;for(e=0,r=t.length;e<r;e++){if(n=y.normalize(t[e]),y.require_table[n])return;y.loaded_features.push(n),y.require_table[n]=!0}},y.load=function(t){t=y.normalize(t),y.loaded([t]);var e=y.modules[t];if(e)e(y);else{var r=y.config.missing_require_severity,n="cannot load such file -- "+t;"error"===r?y.LoadError?y.LoadError.$new(n):function(){throw n}():"warning"===r&&_.warn("WARNING: LoadError: "+n)}return!0},y.require=function(t){return t=y.normalize(t),!y.require_table[t]&&y.load(t)},y.boot_class_alloc("BasicObject",e),y.boot_class_alloc("Object",r,e),y.boot_class_alloc("Module",a,r),y.boot_class_alloc("Class",n,a),y.BasicObject=h=y.setup_class_object("BasicObject",e,"Class",n),y.Object=g=y.setup_class_object("Object",r,"BasicObject",h.constructor),y.Module=m=y.setup_class_object("Module",a,"Object",g.constructor),y.Class=v=y.setup_class_object("Class",n,"Module",m.constructor),h.$$const.BasicObject=h,y.const_set(g,"BasicObject",h),y.const_set(g,"Object",g),y.const_set(g,"Module",m),y.const_set(g,"Class",v),h.$$class=v,g.$$class=v,m.$$class=v,v.$$class=v,h.$$super=null,g.$$super=h,m.$$super=g,v.$$super=m,h.$$parent=null,g.$$parent=h,m.$$parent=g,v.$$parent=m,g.$$proto.toString=function(){var t=this.$to_s();return t.$$is_string&&"object"==typeof t?t.valueOf():t},g.$$proto.$require=y.require,y.top=new g.$$alloc,y.klass(g,g,"NilClass",i),p=y.nil=new i,p.$$id=4,p.call=p.apply=function(){throw y.LocalJumpError.$new("no block given")},y.breaker=new Error("unexpected break (old)"),y.returner=new Error("unexpected return"),TypeError.$$super=Error}.call(this),Opal.loaded(["corelib/runtime"]),Opal.modules["corelib/helpers"]=function(t){var e=(t.top,[]),r=t.nil,n=(t.breaker,t.slice,t.module),a=t.truthy;return t.add_stubs(["$new","$class","$===","$respond_to?","$raise","$type_error","$__send__","$coerce_to","$nil?","$<=>","$coerce_to!","$!=","$[]","$upcase"]),function(e,i){var o,s,c,l,u,f,$,_,d,p,h,g,m,v,y,b=o=n(e,"Opal"),w=(b.$$proto,[b].concat(i));t.defs(b,"$bridge",s=function(e,r){return t.bridge(e,r)},s.$$arity=2),t.defs(b,"$type_error",c=function(e,n,i,o){var s;return null==i&&(i=r),null==o&&(o=r),a(a(s=i)?o:s)?t.const_get_relative(w,"TypeError").$new("can't convert "+e.$class()+" into "+n+" ("+e.$class()+"#"+i+" gives "+o.$class()):t.const_get_relative(w,"TypeError").$new("no implicit conversion of "+e.$class()+" into "+n)},c.$$arity=-3),t.defs(b,"$coerce_to",l=function(t,e,r){var n=this;return a(e["$==="](t))?t:(a(t["$respond_to?"](r))||n.$raise(n.$type_error(t,e)),t.$__send__(r))},l.$$arity=3),t.defs(b,"$coerce_to!",u=function(t,e,n){var i=this,o=r;return o=i.$coerce_to(t,e,n),a(e["$==="](o))||i.$raise(i.$type_error(t,e,n,o)),o},u.$$arity=3),t.defs(b,"$coerce_to?",f=function(t,e,n){var i=this,o=r;return a(t["$respond_to?"](n))?(o=i.$coerce_to(t,e,n),a(o["$nil?"]())?r:(a(e["$==="](o))||i.$raise(i.$type_error(t,e,n,o)),o)):r},f.$$arity=3),t.defs(b,"$try_convert",$=function(t,e,n){return a(e["$==="](t))?t:a(t["$respond_to?"](n))?t.$__send__(n):r},$.$$arity=3),t.defs(b,"$compare",_=function(e,n){var i=this,o=r;return o=e["$<=>"](n),a(o===r)&&i.$raise(t.const_get_relative(w,"ArgumentError"),"comparison of "+e.$class()+" with "+n.$class()+" failed"),o},_.$$arity=2),t.defs(b,"$destructure",d=function(t){if(1==t.length)return t[0];if(t.$$is_array)return t;for(var e=new Array(t.length),r=0,n=e.length;r<n;r++)e[r]=t[r];return e},d.$$arity=1),t.defs(b,"$respond_to?",p=function(t,e){return!(null==t||!t.$$class)&&t["$respond_to?"](e)},p.$$arity=2),t.defs(b,"$inspect_obj",h=function(e){return t.inspect(e)},h.$$arity=1),t.defs(b,"$instance_variable_name!",g=function(e){var r=this;return e=t.const_get_relative(w,"Opal")["$coerce_to!"](e,t.const_get_relative(w,"String"),"to_str"),a(/^@[a-zA-Z_][a-zA-Z0-9_]*?$/.test(e))||r.$raise(t.const_get_relative(w,"NameError").$new("'"+e+"' is not allowed as an instance variable name",e)),e},g.$$arity=1),t.defs(b,"$class_variable_name!",m=function(e){var r=this;return e=t.const_get_relative(w,"Opal")["$coerce_to!"](e,t.const_get_relative(w,"String"),"to_str"),a(e.length<3||"@@"!==e.slice(0,2))&&r.$raise(t.const_get_relative(w,"NameError").$new("`"+e+"' is not allowed as a class variable name",e)),e},m.$$arity=1),t.defs(b,"$const_name!",v=function(e){var r=this;return e=t.const_get_relative(w,"Opal")["$coerce_to!"](e,t.const_get_relative(w,"String"),"to_str"),a(e["$[]"](0)["$!="](e["$[]"](0).$upcase()))&&r.$raise(t.const_get_relative(w,"NameError"),"wrong constant name "+e),e},v.$$arity=1),t.defs(b,"$pristine",y=function(t,e){var n,a=arguments.length,i=a-1;i<0&&(i=0),n=new Array(i);for(var o=1;o<a;o++)n[o-1]=arguments[o];for(var s,c,l=n.length-1;l>=0;l--)s=n[l],(c=t.$$proto["$"+s])&&!c.$$stub&&(c.$$pristine=!0);return r},y.$$arity=-2)}(e[0],e)},Opal.modules["corelib/module"]=function(Opal){function $rb_lt(t,e){return"number"==typeof t&&"number"==typeof e?t<e:t["$<"](e)}function $rb_gt(t,e){return"number"==typeof t&&"number"==typeof e?t>e:t["$>"](e)}function $rb_plus(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}var self=Opal.top,$nesting=[],nil=Opal.nil,$breaker=Opal.breaker,$slice=Opal.slice,$klass=Opal.klass,$truthy=Opal.truthy,$send=Opal.send,$range=Opal.range,$hash2=Opal.hash2;return Opal.add_stubs(["$===","$raise","$equal?","$<","$>","$nil?","$attr_reader","$attr_writer","$class_variable_name!","$new","$const_name!","$=~","$inject","$split","$const_get","$==","$!","$start_with?","$to_proc","$lambda","$bind","$call","$class","$append_features","$included","$name","$cover?","$size","$merge","$compile","$proc","$+","$to_s","$__id__","$constants","$include?","$copy_class_variables","$copy_constants"]),function($base,$super,$parent_nesting){function $Module(){}var self=$Module=$klass($base,$super,"Module",$Module),def=self.$$proto,$nesting=[self].concat($parent_nesting),TMP_Module_allocate_1,TMP_Module_initialize_2,TMP_Module_$eq$eq$eq_3,TMP_Module_$lt_4,TMP_Module_$lt$eq_5,TMP_Module_$gt_6,TMP_Module_$gt$eq_7,TMP_Module_$lt$eq$gt_8,TMP_Module_alias_method_9,TMP_Module_alias_native_10,TMP_Module_ancestors_11,TMP_Module_append_features_12,TMP_Module_attr_accessor_13,TMP_Module_attr_reader_14,TMP_Module_attr_writer_15,TMP_Module_autoload_16,TMP_Module_class_variables_17,TMP_Module_class_variable_get_18,TMP_Module_class_variable_set_19,TMP_Module_class_variable_defined$q_20,TMP_Module_remove_class_variable_21,TMP_Module_constants_22,TMP_Module_constants_23,TMP_Module_nesting_24,TMP_Module_const_defined$q_25,TMP_Module_const_get_27,TMP_Module_const_missing_28,TMP_Module_const_set_29,TMP_Module_public_constant_30,TMP_Module_define_method_31,TMP_Module_remove_method_33,TMP_Module_singleton_class$q_34,TMP_Module_include_35,TMP_Module_included_modules_36,TMP_Module_include$q_37,TMP_Module_instance_method_38,TMP_Module_instance_methods_39,TMP_Module_included_40,TMP_Module_extended_41,TMP_Module_method_added_42,TMP_Module_method_removed_43,TMP_Module_method_undefined_44,TMP_Module_module_eval_45,TMP_Module_module_exec_47,TMP_Module_method_defined$q_48,TMP_Module_module_function_49,TMP_Module_name_50,TMP_Module_remove_const_51,TMP_Module_to_s_52,TMP_Module_undef_method_53,TMP_Module_instance_variables_54,TMP_Module_dup_55,TMP_Module_copy_class_variables_56,TMP_Module_copy_constants_57
;return Opal.defs(self,"$allocate",TMP_Module_allocate_1=function(){var t=this;return Opal.module_allocate(t)},TMP_Module_allocate_1.$$arity=0),Opal.defn(self,"$initialize",TMP_Module_initialize_2=function(){var t=this,e=TMP_Module_initialize_2.$$p,r=e||nil;return e&&(TMP_Module_initialize_2.$$p=null),Opal.module_initialize(t,r)},TMP_Module_initialize_2.$$arity=0),Opal.defn(self,"$===",TMP_Module_$eq$eq$eq_3=function(t){var e=this;return!$truthy(null==t)&&Opal.is_a(t,e)},TMP_Module_$eq$eq$eq_3.$$arity=1),Opal.defn(self,"$<",TMP_Module_$lt_4=function(t){var e=this;$truthy(Opal.const_get_relative($nesting,"Module")["$==="](t))||e.$raise(Opal.const_get_relative($nesting,"TypeError"),"compared with non class/module");var r,n,a,i=e;if(i===t)return!1;for(n=0,r=Opal.ancestors(e),a=r.length;n<a;n++)if(r[n]===t)return!0;for(n=0,r=Opal.ancestors(t),a=r.length;n<a;n++)if(r[n]===e)return!1;return nil},TMP_Module_$lt_4.$$arity=1),Opal.defn(self,"$<=",TMP_Module_$lt$eq_5=function(t){var e,r=this;return $truthy(e=r["$equal?"](t))?e:$rb_lt(r,t)},TMP_Module_$lt$eq_5.$$arity=1),Opal.defn(self,"$>",TMP_Module_$gt_6=function(t){var e=this;return $truthy(Opal.const_get_relative($nesting,"Module")["$==="](t))||e.$raise(Opal.const_get_relative($nesting,"TypeError"),"compared with non class/module"),$rb_lt(t,e)},TMP_Module_$gt_6.$$arity=1),Opal.defn(self,"$>=",TMP_Module_$gt$eq_7=function(t){var e,r=this;return $truthy(e=r["$equal?"](t))?e:$rb_gt(r,t)},TMP_Module_$gt$eq_7.$$arity=1),Opal.defn(self,"$<=>",TMP_Module_$lt$eq$gt_8=function(t){var e=this,r=nil;return e===t?0:$truthy(Opal.const_get_relative($nesting,"Module")["$==="](t))?(r=$rb_lt(e,t),$truthy(r["$nil?"]())?nil:$truthy(r)?-1:1):nil},TMP_Module_$lt$eq$gt_8.$$arity=1),Opal.defn(self,"$alias_method",TMP_Module_alias_method_9=function(t,e){var r=this;return Opal.alias(r,t,e),r},TMP_Module_alias_method_9.$$arity=2),Opal.defn(self,"$alias_native",TMP_Module_alias_native_10=function(t,e){var r=this;return null==e&&(e=t),Opal.alias_native(r,t,e),r},TMP_Module_alias_native_10.$$arity=-2),Opal.defn(self,"$ancestors",TMP_Module_ancestors_11=function(){var t=this;return Opal.ancestors(t)},TMP_Module_ancestors_11.$$arity=0),Opal.defn(self,"$append_features",TMP_Module_append_features_12=function(t){var e=this;return Opal.append_features(e,t),e},TMP_Module_append_features_12.$$arity=1),Opal.defn(self,"$attr_accessor",TMP_Module_attr_accessor_13=function(t){var e,r=this,n=arguments.length,a=n-0;a<0&&(a=0),e=new Array(a);for(var i=0;i<n;i++)e[i-0]=arguments[i];return $send(r,"attr_reader",Opal.to_a(e)),$send(r,"attr_writer",Opal.to_a(e))},TMP_Module_attr_accessor_13.$$arity=-1),Opal.alias(self,"attr","attr_accessor"),Opal.defn(self,"$attr_reader",TMP_Module_attr_reader_14=function(t){var e,r=this,n=arguments.length,a=n-0;a<0&&(a=0),e=new Array(a);for(var i=0;i<n;i++)e[i-0]=arguments[i];for(var o=r.$$proto,s=e.length-1;s>=0;s--){var c=e[s],l="$"+c,u=Opal.ivar(c),f=function(t){return function(){return null==this[t]?nil:this[t]}}(u);o[u]=nil,f.$$parameters=[],f.$$arity=0,r.$$is_singleton?o.constructor.prototype[l]=f:Opal.defn(r,l,f)}return nil},TMP_Module_attr_reader_14.$$arity=-1),Opal.defn(self,"$attr_writer",TMP_Module_attr_writer_15=function(t){var e,r=this,n=arguments.length,a=n-0;a<0&&(a=0),e=new Array(a);for(var i=0;i<n;i++)e[i-0]=arguments[i];for(var o=r.$$proto,s=e.length-1;s>=0;s--){var c=e[s],l="$"+c+"=",u=Opal.ivar(c),f=function(t){return function(e){return this[t]=e}}(u);f.$$parameters=[["req"]],f.$$arity=1,o[u]=nil,r.$$is_singleton?o.constructor.prototype[l]=f:Opal.defn(r,l,f)}return nil},TMP_Module_attr_writer_15.$$arity=-1),Opal.defn(self,"$autoload",TMP_Module_autoload_16=function(t,e){var r=this;return null==r.$$autoload&&(r.$$autoload={}),Opal.const_cache_version++,r.$$autoload[t]=e,nil},TMP_Module_autoload_16.$$arity=2),Opal.defn(self,"$class_variables",TMP_Module_class_variables_17=function(){var t=this;return Object.keys(Opal.class_variables(t))},TMP_Module_class_variables_17.$$arity=0),Opal.defn(self,"$class_variable_get",TMP_Module_class_variable_get_18=function(t){var e=this;t=Opal.const_get_relative($nesting,"Opal")["$class_variable_name!"](t);var r=Opal.class_variables(e)[t];return null==r&&e.$raise(Opal.const_get_relative($nesting,"NameError").$new("uninitialized class variable "+t+" in "+e,t)),r},TMP_Module_class_variable_get_18.$$arity=1),Opal.defn(self,"$class_variable_set",TMP_Module_class_variable_set_19=function(t,e){var r=this;return t=Opal.const_get_relative($nesting,"Opal")["$class_variable_name!"](t),Opal.class_variable_set(r,t,e)},TMP_Module_class_variable_set_19.$$arity=2),Opal.defn(self,"$class_variable_defined?",TMP_Module_class_variable_defined$q_20=function(t){var e=this;return t=Opal.const_get_relative($nesting,"Opal")["$class_variable_name!"](t),Opal.class_variables(e).hasOwnProperty(t)},TMP_Module_class_variable_defined$q_20.$$arity=1),Opal.defn(self,"$remove_class_variable",TMP_Module_remove_class_variable_21=function(t){var e=this;if(t=Opal.const_get_relative($nesting,"Opal")["$class_variable_name!"](t),Opal.hasOwnProperty.call(e.$$cvars,t)){var r=e.$$cvars[t];return delete e.$$cvars[t],r}e.$raise(Opal.const_get_relative($nesting,"NameError").$new("cannot remove "+t+" for "+e))},TMP_Module_remove_class_variable_21.$$arity=1),Opal.defn(self,"$constants",TMP_Module_constants_22=function(t){var e=this;return null==t&&(t=!0),Opal.constants(e,t)},TMP_Module_constants_22.$$arity=-1),Opal.defs(self,"$constants",TMP_Module_constants_23=function(t){var e=this;if(null==t){var r,n,a,i=(e.$$nesting||[]).concat(Opal.Object),o={};for(n=0,a=i.length;n<a;n++)for(r in i[n].$$const)o[r]=!0;return Object.keys(o)}return Opal.constants(e,t)},TMP_Module_constants_23.$$arity=-1),Opal.defs(self,"$nesting",TMP_Module_nesting_24=function(){return this.$$nesting||[]},TMP_Module_nesting_24.$$arity=0),Opal.defn(self,"$const_defined?",TMP_Module_const_defined$q_25=function(t,e){var r=this;null==e&&(e=!0),t=Opal.const_get_relative($nesting,"Opal")["$const_name!"](t),$truthy(t["$=~"](Opal.const_get_qualified(Opal.const_get_relative($nesting,"Opal"),"CONST_NAME_REGEXP")))||r.$raise(Opal.const_get_relative($nesting,"NameError").$new("wrong constant name "+t,t));var n,a,i,o=[r];for(e&&(o=o.concat(Opal.ancestors(r)),r.$$is_module&&(o=o.concat([Opal.Object]).concat(Opal.ancestors(Opal.Object)))),a=0,i=o.length;a<i;a++)if(n=o[a],null!=n.$$const[t])return!0;return!1},TMP_Module_const_defined$q_25.$$arity=-2),Opal.defn(self,"$const_get",TMP_Module_const_get_27=function(t,e){var r,n=this;return null==e&&(e=!0),t=Opal.const_get_relative($nesting,"Opal")["$const_name!"](t),0===t.indexOf("::")&&"::"!==t&&(t=t.slice(2)),$truthy(-1!=t.indexOf("::")&&"::"!=t)?$send(t.$split("::"),"inject",[n],(r=function(t,e){r.$$s;return null==t&&(t=nil),null==e&&(e=nil),t.$const_get(e)},r.$$s=n,r.$$arity=2,r)):($truthy(t["$=~"](Opal.const_get_qualified(Opal.const_get_relative($nesting,"Opal"),"CONST_NAME_REGEXP")))||n.$raise(Opal.const_get_relative($nesting,"NameError").$new("wrong constant name "+t,t)),e?Opal.const_get_relative([n],t):Opal.const_get_local(n,t))},TMP_Module_const_get_27.$$arity=-2),Opal.defn(self,"$const_missing",TMP_Module_const_missing_28=function(t){var e=this,r=nil;if(e.$$autoload){var n=e.$$autoload[t];if(n)return e.$require(n),e.$const_get(t)}return r=function(){return e["$=="](Opal.const_get_relative($nesting,"Object"))?t:e+"::"+t}(),e.$raise(Opal.const_get_relative($nesting,"NameError").$new("uninitialized constant "+r,t))},TMP_Module_const_missing_28.$$arity=1),Opal.defn(self,"$const_set",TMP_Module_const_set_29=function(t,e){var r,n=this;return t=Opal.const_get_relative($nesting,"Opal")["$const_name!"](t),$truthy($truthy(r=t["$=~"](Opal.const_get_qualified(Opal.const_get_relative($nesting,"Opal"),"CONST_NAME_REGEXP"))["$!"]())?r:t["$start_with?"]("::"))&&n.$raise(Opal.const_get_relative($nesting,"NameError").$new("wrong constant name "+t,t)),Opal.const_set(n,t,e),e},TMP_Module_const_set_29.$$arity=2),Opal.defn(self,"$public_constant",TMP_Module_public_constant_30=function(t){return nil},TMP_Module_public_constant_30.$$arity=1),Opal.defn(self,"$define_method",TMP_Module_define_method_31=function(t,e){var r,n,a=this,i=TMP_Module_define_method_31.$$p,o=i||nil,s=nil;i&&(TMP_Module_define_method_31.$$p=null),$truthy(void 0===e&&o===nil)&&a.$raise(Opal.const_get_relative($nesting,"ArgumentError"),"tried to create a Proc object without a block"),o=$truthy(r=o)?r:function(){return s=e,Opal.const_get_relative($nesting,"Proc")["$==="](s)?e:Opal.const_get_relative($nesting,"Method")["$==="](s)?e.$to_proc().$$unbound:Opal.const_get_relative($nesting,"UnboundMethod")["$==="](s)?$send(a,"lambda",[],(n=function(t){var r,a=n.$$s||this,i=nil,o=arguments.length,s=o-0;s<0&&(s=0),r=new Array(s);for(var c=0;c<o;c++)r[c-0]=arguments[c];return i=e.$bind(a),$send(i,"call",Opal.to_a(r))},n.$$s=a,n.$$arity=-1,n)):a.$raise(Opal.const_get_relative($nesting,"TypeError"),"wrong argument type "+o.$class()+" (expected Proc/Method)")}();var c="$"+t;return o.$$jsid=t,o.$$s=null,o.$$def=o,o.$$define_meth=!0,Opal.defn(a,c,o),t},TMP_Module_define_method_31.$$arity=-2),Opal.defn(self,"$remove_method",TMP_Module_remove_method_33=function(t){var e,r=this,n=arguments.length,a=n-0;a<0&&(a=0),e=new Array(a);for(var i=0;i<n;i++)e[i-0]=arguments[i];for(var o=0,s=e.length;o<s;o++)Opal.rdef(r,"$"+e[o]);return r},TMP_Module_remove_method_33.$$arity=-1),Opal.defn(self,"$singleton_class?",TMP_Module_singleton_class$q_34=function(){return!!this.$$is_singleton},TMP_Module_singleton_class$q_34.$$arity=0),Opal.defn(self,"$include",TMP_Module_include_35=function(t){var e,r=this,n=arguments.length,a=n-0;a<0&&(a=0),e=new Array(a);for(var i=0;i<n;i++)e[i-0]=arguments[i];for(var o=e.length-1;o>=0;o--){var s=e[o];s.$$is_module||r.$raise(Opal.const_get_relative($nesting,"TypeError"),"wrong argument type "+s.$class()+" (expected Module)"),s.$append_features(r),s.$included(r)}return r},TMP_Module_include_35.$$arity=-1),Opal.defn(self,"$included_modules",TMP_Module_included_modules_36=function(){var t,e=this,r=function(t){for(var e=[],n=0,a=t.$$inc.length;n<a;n++){var i=t.$$inc[n];e.push(i),e=e.concat(r(i))}return e};if(t=r(e),e.$$is_class)for(var n=e;n;n=n.$$super)t=t.concat(r(n));return t},TMP_Module_included_modules_36.$$arity=0),Opal.defn(self,"$include?",TMP_Module_include$q_37=function(t){var e=this;t.$$is_module||e.$raise(Opal.const_get_relative($nesting,"TypeError"),"wrong argument type "+t.$class()+" (expected Module)");var r,n,a,i=Opal.ancestors(e);for(r=0,n=i.length;r<n;r++)if((a=i[r])===t&&a!==e)return!0;return!1},TMP_Module_include$q_37.$$arity=1),Opal.defn(self,"$instance_method",TMP_Module_instance_method_38=function(t){var e=this,r=e.$$proto["$"+t];return r&&!r.$$stub||e.$raise(Opal.const_get_relative($nesting,"NameError").$new("undefined method `"+t+"' for class `"+e.$name()+"'",t)),Opal.const_get_relative($nesting,"UnboundMethod").$new(e,r.$$owner||e,r,t)},TMP_Module_instance_method_38.$$arity=1),Opal.defn(self,"$instance_methods",TMP_Module_instance_methods_39=function(t){var e=this;null==t&&(t=!0);var r,n=[],a=e.$$proto;for(var i in a)if("$"===i.charAt(0)&&"$"!==i.charAt(1)&&"function"==typeof(r=a[i])&&!r.$$stub){if(!e.$$is_module){if(e!==Opal.BasicObject&&r===Opal.BasicObject.$$proto[i])continue;if(!t&&!a.hasOwnProperty(i))continue;if(!t&&r.$$donated)continue}n.push(i.substr(1))}return n},TMP_Module_instance_methods_39.$$arity=-1),Opal.defn(self,"$included",TMP_Module_included_40=function(t){return nil},TMP_Module_included_40.$$arity=1),Opal.defn(self,"$extended",TMP_Module_extended_41=function(t){return nil},TMP_Module_extended_41.$$arity=1),Opal.defn(self,"$method_added",TMP_Module_method_added_42=function(t){return nil},TMP_Module_method_added_42.$$arity=-1),Opal.defn(self,"$method_removed",TMP_Module_method_removed_43=function(t){return nil},TMP_Module_method_removed_43.$$arity=-1),Opal.defn(self,"$method_undefined",TMP_Module_method_undefined_44=function(t){return nil},TMP_Module_method_undefined_44.$$arity=-1),Opal.defn(self,"$module_eval",TMP_Module_module_eval_45=function $$module_eval($a_rest){var $b,TMP_46,self=this,args,$iter=TMP_Module_module_eval_45.$$p,block=$iter||nil,string=nil,file=nil,_lineno=nil,default_eval_options=nil,compiling_options=nil,compiled=nil,$args_len=arguments.length,$rest_len=$args_len-0;$rest_len<0&&($rest_len=0),args=new Array($rest_len);for(var $arg_idx=0;$arg_idx<$args_len;$arg_idx++)args[$arg_idx-0]=arguments[$arg_idx];$iter&&(TMP_Module_module_eval_45.$$p=null),$truthy($truthy($b=block["$nil?"]())?!!Opal.compile:$b)?($truthy($range(1,3,!1)["$cover?"](args.$size()))||Opal.const_get_relative($nesting,"Kernel").$raise(Opal.const_get_relative($nesting,"ArgumentError"),"wrong number of arguments (0 for 1..3)"),$b=[].concat(Opal.to_a(args)),string=null==$b[0]?nil:$b[0],file=null==$b[1]?nil:$b[1],_lineno=null==$b[2]?nil:$b[2],default_eval_options=$hash2(["file","eval"],{file:$truthy($b=file)?$b:"(eval)",eval:!0}),compiling_options=Opal.hash({arity_check:!1}).$merge(default_eval_options),compiled=Opal.const_get_relative($nesting,"Opal").$compile(string,compiling_options),block=$send(Opal.const_get_relative($nesting,"Kernel"),"proc",[],(TMP_46=function(){var self=TMP_46.$$s||this;return function(self){return eval(compiled)}(self)},TMP_46.$$s=self,TMP_46.$$arity=0,TMP_46))):$truthy($rb_gt(args.$size(),0))&&Opal.const_get_relative($nesting,"Kernel").$raise(Opal.const_get_relative($nesting,"ArgumentError"),$rb_plus("wrong number of arguments ("+args.$size()+" for 0)","\n\n  NOTE:If you want to enable passing a String argument please add \"require 'opal-parser'\" to your script\n"));var old=block.$$s,result;return block.$$s=null,result=block.apply(self,[self]),block.$$s=old,result},TMP_Module_module_eval_45.$$arity=-1),Opal.alias(self,"class_eval","module_eval"),Opal.defn(self,"$module_exec",TMP_Module_module_exec_47=function(t){var e,r=this,n=TMP_Module_module_exec_47.$$p,a=n||nil,i=arguments.length,o=i-0;o<0&&(o=0),e=new Array(o);for(var s=0;s<i;s++)e[s-0]=arguments[s];n&&(TMP_Module_module_exec_47.$$p=null),a===nil&&r.$raise(Opal.const_get_relative($nesting,"LocalJumpError"),"no block given");var c,l=a.$$s;return a.$$s=null,c=a.apply(r,e),a.$$s=l,c},TMP_Module_module_exec_47.$$arity=-1),Opal.alias(self,"class_exec","module_exec"),Opal.defn(self,"$method_defined?",TMP_Module_method_defined$q_48=function(t){var e=this,r=e.$$proto["$"+t];return!!r&&!r.$$stub},TMP_Module_method_defined$q_48.$$arity=1),Opal.defn(self,"$module_function",TMP_Module_module_function_49=function(t){var e,r=this,n=arguments.length,a=n-0;a<0&&(a=0),e=new Array(a);for(var i=0;i<n;i++)e[i-0]=arguments[i];if(0===e.length)r.$$module_function=!0;else for(var o=0,s=e.length;o<s;o++){var c=e[o],l="$"+c,u=r.$$proto[l];Opal.defs(r,l,u)}return r},TMP_Module_module_function_49.$$arity=-1),Opal.defn(self,"$name",TMP_Module_name_50=function(){var t=this;if(t.$$full_name)return t.$$full_name;for(var e=[],r=t;r;){if(r.$$name===nil||null==r.$$name)return nil;if(e.unshift(r.$$name),(r=r.$$base_module)===Opal.Object)break}return 0===e.length?nil:t.$$full_name=e.join("::")},TMP_Module_name_50.$$arity=0),Opal.defn(self,"$remove_const",TMP_Module_remove_const_51=function(t){var e=this;return Opal.const_remove(e,t)},TMP_Module_remove_const_51.$$arity=1),Opal.defn(self,"$to_s",TMP_Module_to_s_52=function(){var t,e=this;return $truthy(t=Opal.Module.$name.call(e))?t:"#<"+(e.$$is_module?"Module":"Class")+":0x"+e.$__id__().$to_s(16)+">"},TMP_Module_to_s_52.$$arity=0),Opal.defn(self,"$undef_method",TMP_Module_undef_method_53=function(t){var e,r=this,n=arguments.length,a=n-0;a<0&&(a=0),e=new Array(a);for(var i=0;i<n;i++)e[i-0]=arguments[i];for(var o=0,s=e.length;o<s;o++)Opal.udef(r,"$"+e[o]);return r},TMP_Module_undef_method_53.$$arity=-1),Opal.defn(self,"$instance_variables",TMP_Module_instance_variables_54=function(){var t=this,e=nil;Opal.Module.$$nesting=$nesting,e=t.$constants();var r=[];for(var n in t)t.hasOwnProperty(n)&&"$"!==n.charAt(0)&&"constructor"!==n&&!e["$include?"](n)&&r.push("@"+n);return r},TMP_Module_instance_variables_54.$$arity=0),Opal.defn(self,"$dup",TMP_Module_dup_55=function(){var t=this,e=TMP_Module_dup_55.$$p,r=nil,n=nil,a=nil,i=nil;for(e&&(TMP_Module_dup_55.$$p=null),a=0,i=arguments.length,n=new Array(i);a<i;a++)n[a]=arguments[a];return r=$send(t,Opal.find_super_dispatcher(t,"dup",TMP_Module_dup_55,!1),n,e),r.$copy_class_variables(t),r.$copy_constants(t),r},TMP_Module_dup_55.$$arity=0),Opal.defn(self,"$copy_class_variables",TMP_Module_copy_class_variables_56=function(t){var e=this;for(var r in t.$$cvars)e.$$cvars[r]=t.$$cvars[r]},TMP_Module_copy_class_variables_56.$$arity=1),Opal.defn(self,"$copy_constants",TMP_Module_copy_constants_57=function(t){var e,r=this,n=t.$$const;for(e in n)Opal.const_set(r,e,n[e])},TMP_Module_copy_constants_57.$$arity=1),nil&&"copy_constants"}($nesting[0],null,$nesting)},Opal.modules["corelib/class"]=function(t){var e=t.top,r=[],n=t.nil,a=(t.breaker,t.slice,t.klass),i=t.send;return t.add_stubs(["$require","$initialize_copy","$allocate","$name","$to_s"]),e.$require("corelib/module"),function(e,r,o){function s(){}var c,l,u,f,$,_,d,p=s=a(e,null,"Class",s),h=(p.$$proto,[p].concat(o));return t.defs(p,"$new",c=function(e){var r=c.$$p,a=r||n;if(null==e&&(e=t.const_get_relative(h,"Object")),r&&(c.$$p=null),!e.$$is_class)throw t.TypeError.$new("superclass must be a Class");var i=t.boot_class_alloc(null,function(){},e),o=t.setup_class_object(null,i,e.$$name,e.constructor);return o.$$super=e,o.$$parent=e,e.$inherited(o),t.module_initialize(o,a),o},c.$$arity=-1),t.defn(p,"$allocate",l=function(){var e=this,r=new e.$$alloc;return r.$$id=t.uid(),r},l.$$arity=0),t.defn(p,"$inherited",u=function(t){return n},u.$$arity=1),t.defn(p,"$initialize_dup",f=function(t){var e=this;e.$initialize_copy(t),e.$$name=null,e.$$full_name=null},f.$$arity=1),t.defn(p,"$new",$=function(e){var r,a=this,i=$.$$p,o=i||n,s=arguments.length,c=s-0;c<0&&(c=0),r=new Array(c);for(var l=0;l<s;l++)r[l-0]=arguments[l];i&&($.$$p=null);var u=a.$allocate();return t.send(u,u.$initialize,r,o),u},$.$$arity=-1),t.defn(p,"$superclass",_=function(){return this.$$super||n},_.$$arity=0),t.defn(p,"$to_s",d=function(){var e=this,r=d.$$p;r&&(d.$$p=null);var n=e.$$singleton_of;return n&&(n.$$is_class||n.$$is_module)?"#<Class:"+n.$name()+">":n?"#<Class:#<"+n.$$class.$name()+":0x"+t.id(n).$to_s(16)+">>":i(e,t.find_super_dispatcher(e,"to_s",d,!1),[],null)},d.$$arity=0),n&&"to_s"}(r[0],0,r)},Opal.modules["corelib/basic_object"]=function(Opal){function $rb_gt(t,e){return"number"==typeof t&&"number"==typeof e?t>e:t["$>"](e)}var self=Opal.top,$nesting=[],nil=Opal.nil,$breaker=Opal.breaker,$slice=Opal.slice,$klass=Opal.klass,$truthy=Opal.truthy,$range=Opal.range,$hash2=Opal.hash2,$send=Opal.send;return Opal.add_stubs(["$==","$!","$nil?","$cover?","$size","$raise","$merge","$compile","$proc","$>","$new","$inspect"]),function($base,$super,$parent_nesting){function $BasicObject(){}var self=$BasicObject=$klass($base,$super,"BasicObject",$BasicObject),def=self.$$proto,$nesting=[self].concat($parent_nesting),TMP_BasicObject_initialize_1,TMP_BasicObject_$eq$eq_2,TMP_BasicObject_eql$q_3,TMP_BasicObject___id___4,TMP_BasicObject___send___5,TMP_BasicObject_$B_6,TMP_BasicObject_$B$eq_7,TMP_BasicObject_instance_eval_8,TMP_BasicObject_instance_exec_10,TMP_BasicObject_singleton_method_added_11,TMP_BasicObject_singleton_method_removed_12,TMP_BasicObject_singleton_method_undefined_13,TMP_BasicObject_method_missing_14;return Opal.defn(self,"$initialize",TMP_BasicObject_initialize_1=function(t){return nil},TMP_BasicObject_initialize_1.$$arity=-1),Opal.defn(self,"$==",TMP_BasicObject_$eq$eq_2=function(t){return this===t},TMP_BasicObject_$eq$eq_2.$$arity=1),Opal.defn(self,"$eql?",TMP_BasicObject_eql$q_3=function(t){return this["$=="](t)},TMP_BasicObject_eql$q_3.$$arity=1),Opal.alias(self,"equal?","=="),Opal.defn(self,"$__id__",TMP_BasicObject___id___4=function(){var t=this;return t.$$id||(t.$$id=Opal.uid())},TMP_BasicObject___id___4.$$arity=0),Opal.defn(self,"$__send__",TMP_BasicObject___send___5=function(t,e){var r,n=this,a=TMP_BasicObject___send___5.$$p,i=a||nil,o=arguments.length,s=o-1;s<0&&(s=0),r=new Array(s);for(var c=1;c<o;c++)r[c-1]=arguments[c];a&&(TMP_BasicObject___send___5.$$p=null);var l=n["$"+t];return l?(i!==nil&&(l.$$p=i),l.apply(n,r)):(i!==nil&&(n.$method_missing.$$p=i),n.$method_missing.apply(n,[t].concat(r)))},TMP_BasicObject___send___5.$$arity=-2),Opal.defn(self,"$!",TMP_BasicObject_$B_6=function(){return!1},TMP_BasicObject_$B_6.$$arity=0),Opal.defn(self,"$!=",TMP_BasicObject_$B$eq_7=function(t){return this["$=="](t)["$!"]()},TMP_BasicObject_$B$eq_7.$$arity=1),Opal.defn(self,"$instance_eval",TMP_BasicObject_instance_eval_8=function $$instance_eval($a_rest){var $b,TMP_9,self=this,args,$iter=TMP_BasicObject_instance_eval_8.$$p,block=$iter||nil,string=nil,file=nil,_lineno=nil,default_eval_options=nil,compiling_options=nil,compiled=nil,$args_len=arguments.length,$rest_len=$args_len-0;$rest_len<0&&($rest_len=0),args=new Array($rest_len);for(var $arg_idx=0;$arg_idx<$args_len;$arg_idx++)args[$arg_idx-0]=arguments[$arg_idx];$iter&&(TMP_BasicObject_instance_eval_8.$$p=null),$truthy($truthy($b=block["$nil?"]())?!!Opal.compile:$b)?($truthy($range(1,3,!1)["$cover?"](args.$size()))||Opal.const_get_qualified("::","Kernel").$raise(Opal.const_get_qualified("::","ArgumentError"),"wrong number of arguments (0 for 1..3)"),$b=[].concat(Opal.to_a(args)),string=null==$b[0]?nil:$b[0],file=null==$b[1]?nil:$b[1],_lineno=null==$b[2]?nil:$b[2],default_eval_options=$hash2(["file","eval"],{file:$truthy($b=file)?$b:"(eval)",eval:!0}),compiling_options=Opal.hash({arity_check:!1}).$merge(default_eval_options),compiled=Opal.const_get_qualified("::","Opal").$compile(string,compiling_options),block=$send(Opal.const_get_qualified("::","Kernel"),"proc",[],(TMP_9=function(){var self=TMP_9.$$s||this;return function(self){return eval(compiled)}(self)},TMP_9.$$s=self,TMP_9.$$arity=0,TMP_9))):$truthy($rb_gt(args.$size(),0))&&Opal.const_get_qualified("::","Kernel").$raise(Opal.const_get_qualified("::","ArgumentError"),"wrong number of arguments ("+args.$size()+" for 0)");var old=block.$$s,result;if(block.$$s=null,self.$$is_class||self.$$is_module){self.$$eval=!0;try{result=block.call(self,self)}finally{self.$$eval=!1}}else result=block.call(self,self);return block.$$s=old,result},TMP_BasicObject_instance_eval_8.$$arity=-1),Opal.defn(self,"$instance_exec",TMP_BasicObject_instance_exec_10=function(t){var e,r=this,n=TMP_BasicObject_instance_exec_10.$$p,a=n||nil,i=arguments.length,o=i-0;o<0&&(o=0),e=new Array(o);for(var s=0;s<i;s++)e[s-0]=arguments[s];n&&(TMP_BasicObject_instance_exec_10.$$p=null),$truthy(a)||Opal.const_get_qualified("::","Kernel").$raise(Opal.const_get_qualified("::","ArgumentError"),"no block given");var c,l=a.$$s;if(a.$$s=null,r.$$is_class||r.$$is_module){r.$$eval=!0;try{c=a.apply(r,e)}finally{r.$$eval=!1}}else c=a.apply(r,e);return a.$$s=l,c},TMP_BasicObject_instance_exec_10.$$arity=-1),Opal.defn(self,"$singleton_method_added",TMP_BasicObject_singleton_method_added_11=function(t){return nil},TMP_BasicObject_singleton_method_added_11.$$arity=-1),Opal.defn(self,"$singleton_method_removed",TMP_BasicObject_singleton_method_removed_12=function(t){return nil},TMP_BasicObject_singleton_method_removed_12.$$arity=-1),Opal.defn(self,"$singleton_method_undefined",TMP_BasicObject_singleton_method_undefined_13=function(t){return nil},TMP_BasicObject_singleton_method_undefined_13.$$arity=-1),Opal.defn(self,"$method_missing",TMP_BasicObject_method_missing_14=function(t,e){var r,n=this,a=TMP_BasicObject_method_missing_14.$$p,i=arguments.length,o=i-1;o<0&&(o=0),r=new Array(o);for(var s=1;s<i;s++)r[s-1]=arguments[s];return a&&(TMP_BasicObject_method_missing_14.$$p=null),Opal.const_get_qualified("::","Kernel").$raise(Opal.const_get_qualified("::","NoMethodError").$new(function(){return $truthy(n.$inspect&&!n.$inspect.$$stub)?"undefined method `"+t+"' for "+n.$inspect()+":"+n.$$class:"undefined method `"+t+"' for "+n.$$class}(),t))},TMP_BasicObject_method_missing_14.$$arity=-2),nil&&"method_missing"}($nesting[0],null,$nesting)},Opal.modules["corelib/kernel"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t>e:t["$>"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t<=e:t["$<="](e)}var n=(t.top,[]),a=t.nil,i=(t.breaker,t.slice,t.module),o=t.truthy,s=t.gvars,c=t.hash2,l=t.send,u=t.klass;return t.add_stubs(["$raise","$new","$inspect","$!","$=~","$==","$object_id","$class","$coerce_to?","$<<","$allocate","$copy_instance_variables","$copy_singleton_methods","$initialize_clone","$initialize_copy","$define_method","$singleton_class","$to_proc","$initialize_dup","$for","$>","$size","$pop","$call","$coerce_to","$append_features","$extended","$length","$respond_to?","$[]","$nil?","$to_a","$to_int","$fetch","$Integer","$Float","$to_ary","$to_str","$to_s","$__id__","$instance_variable_name!","$coerce_to!","$===","$enum_for","$result","$print","$format","$puts","$each","$<=","$empty?","$exception","$kind_of?","$rand","$respond_to_missing?","$try_convert!","$expand_path","$join","$start_with?","$srand","$new_seed","$sym","$arg","$open","$include"]),function(n,u){var f,$,_,d,p,h,g,m,v,y,b,w,x,A,k,E,S,N,C,I,O,P,L,M,T,B,j,F,R,q,D,z,U,H,G,Y,V,Q,X,J,W,K,Z,tt,et,rt,nt,at,it,ot,st,ct,lt,ut,ft,$t,_t,dt,pt,ht,gt,mt,vt,yt,bt,wt=f=i(n,"Kernel"),xt=(wt.$$proto,[wt].concat(u));t.defn(wt,"$method_missing",$=function(e,r){var n,a=this,i=$.$$p,o=arguments.length,s=o-1;s<0&&(s=0),n=new Array(s);for(var c=1;c<o;c++)n[c-1]=arguments[c];return i&&($.$$p=null),a.$raise(t.const_get_relative(xt,"NoMethodError").$new("undefined method `"+e+"' for "+a.$inspect(),e,n))},$.$$arity=-2),t.defn(wt,"$=~",_=function(t){return!1},_.$$arity=1),t.defn(wt,"$!~",d=function(t){return this["$=~"](t)["$!"]()},d.$$arity=1),t.defn(wt,"$===",p=function(t){var e,r=this;return o(e=r.$object_id()["$=="](t.$object_id()))?e:r["$=="](t)},p.$$arity=1),t.defn(wt,"$<=>",h=function(t){var e=this;e.$$comparable=!0;var r=e["$=="](t);return r&&r!==a?0:a},h.$$arity=1),t.defn(wt,"$method",g=function(e){var r=this,n=r["$"+e];return n&&!n.$$stub||r.$raise(t.const_get_relative(xt,"NameError").$new("undefined method `"+e+"' for class `"+r.$class()+"'",e)),t.const_get_relative(xt,"Method").$new(r,n.$$owner||r.$class(),n,e)},g.$$arity=1),t.defn(wt,"$methods",m=function(e){var r=this;null==e&&(e=!0);var n=[];for(var i in r)if("$"==i[0]&&"function"==typeof r[i]){if((0==e||e===a)&&!t.hasOwnProperty.call(r,i))continue;void 0===r[i].$$stub&&n.push(i.substr(1))}return n},m.$$arity=-1),t.alias(wt,"public_methods","methods"),t.defn(wt,"$Array",v=function(e){var r;return e===a?[]:e.$$is_array?e:(r=t.const_get_relative(xt,"Opal")["$coerce_to?"](e,t.const_get_relative(xt,"Array"),"to_ary"))!==a?r:(r=t.const_get_relative(xt,"Opal")["$coerce_to?"](e,t.const_get_relative(xt,"Array"),"to_a"),r!==a?r:[e])},v.$$arity=1),t.defn(wt,"$at_exit",y=function(){var t,e=y.$$p,r=e||a;return null==s.__at_exit__&&(s.__at_exit__=a),e&&(y.$$p=null),s.__at_exit__=o(t=s.__at_exit__)?t:[],s.__at_exit__["$<<"](r)},y.$$arity=0),t.defn(wt,"$caller",b=function(t){var e,r=arguments.length,n=r-0;n<0&&(n=0),e=new Array(n);for(var a=0;a<r;a++)e[a-0]=arguments[a];return[]},b.$$arity=-1),t.defn(wt,"$class",w=function(){return this.$$class},w.$$arity=0),t.defn(wt,"$copy_instance_variables",x=function(t){var e,r,n,a=this,i=Object.keys(t);for(e=0,r=i.length;e<r;e++)n=i[e],"$"!==n.charAt(0)&&t.hasOwnProperty(n)&&(a[n]=t[n])},x.$$arity=1),t.defn(wt,"$copy_singleton_methods",A=function(e){var r,n=this;if(e.hasOwnProperty("$$meta")){var a=t.get_singleton_class(e).$$proto,i=t.get_singleton_class(n).$$proto;for(r in a)"$"===r.charAt(0)&&a.hasOwnProperty(r)&&(i[r]=a[r])}for(r in e)"$"===r.charAt(0)&&"$"!==r.charAt(1)&&e.hasOwnProperty(r)&&(n[r]=e[r])},A.$$arity=1),t.defn(wt,"$clone",k=function(e){var r,n=this,i=a;if(null==e||!e.$$is_hash){if(null!=e)throw t.ArgumentError.$new("expected kwargs");e=c([],{})}return r=e.$$smap.freeze,null==r&&(r=!0),i=n.$class().$allocate(),i.$copy_instance_variables(n),i.$copy_singleton_methods(n),i.$initialize_clone(n),i},k.$$arity=-1),t.defn(wt,"$initialize_clone",E=function(t){return this.$initialize_copy(t)},E.$$arity=1),t.defn(wt,"$define_singleton_method",S=function(t,e){var r=this,n=S.$$p,i=n||a;return n&&(S.$$p=null),l(r.$singleton_class(),"define_method",[t,e],i.$to_proc())},S.$$arity=-2),t.defn(wt,"$dup",N=function(){var t=this,e=a;return e=t.$class().$allocate(),e.$copy_instance_variables(t),e.$initialize_dup(t),e},N.$$arity=0),t.defn(wt,"$initialize_dup",C=function(t){return this.$initialize_copy(t)},C.$$arity=1),t.defn(wt,"$enum_for",I=function(e,r){var n,i=this,o=I.$$p,s=o||a;null==e&&(e="each");var c=arguments.length,u=c-1;u<0&&(u=0),n=new Array(u);for(var f=1;f<c;f++)n[f-1]=arguments[f];return o&&(I.$$p=null),l(t.const_get_relative(xt,"Enumerator"),"for",[i,e].concat(t.to_a(n)),s.$to_proc())},I.$$arity=-1),t.alias(wt,"to_enum","enum_for"),t.defn(wt,"$equal?",O=function(t){return this===t},O.$$arity=1),t.defn(wt,"$exit",P=function(r){var n,i=a;for(null==s.__at_exit__&&(s.__at_exit__=a),null==r&&(r=!0),s.__at_exit__=o(n=s.__at_exit__)?n:[];o(e(s.__at_exit__.$size(),0));)i=s.__at_exit__.$pop(),i.$call();return r=r.$$is_boolean?r?0:1:t.const_get_relative(xt,"Opal").$coerce_to(r,t.const_get_relative(xt,"Integer"),"to_int"),t.exit(r),a},P.$$arity=-1),t.defn(wt,"$extend",L=function(e){var r,n=this,a=arguments.length,i=a-0;i<0&&(i=0),r=new Array(i);for(var o=0;o<a;o++)r[o-0]=arguments[o];for(var s=n.$singleton_class(),c=r.length-1;c>=0;c--){var l=r[c];l.$$is_module||n.$raise(t.const_get_relative(xt,"TypeError"),"wrong argument type "+l.$class()+" (expected Module)"),l.$append_features(s),l.$extended(n)}return n},L.$$arity=-1),t.defn(wt,"$format",M=function(e,r){function n(){T&D&&p.$raise(t.const_get_relative(xt,"ArgumentError"),"flag after width"),T&z&&p.$raise(t.const_get_relative(xt,"ArgumentError"),"flag after precision")}function i(){T&D&&p.$raise(t.const_get_relative(xt,"ArgumentError"),"width given twice"),T&z&&p.$raise(t.const_get_relative(xt,"ArgumentError"),"width after precision")}function c(e){return e>=d.length&&p.$raise(t.const_get_relative(xt,"ArgumentError"),"too few arguments"),d[e]}function l(){switch(q){case-1:p.$raise(t.const_get_relative(xt,"ArgumentError"),"unnumbered("+R+") mixed with numbered");case-2:p.$raise(t.const_get_relative(xt,"ArgumentError"),"unnumbered("+R+") mixed with named")}return q=R++,c(q-1)}function u(e){return q>0&&p.$raise(t.const_get_relative(xt,"ArgumentError"),"numbered("+e+") after unnumbered("+q+")"),-2===q&&p.$raise(t.const_get_relative(xt,"ArgumentError"),"numbered("+e+") after named"),e<1&&p.$raise(t.const_get_relative(xt,"ArgumentError"),"invalid index - "+e+"$"),q=-1,c(e-1)}function f(){return void 0===M?l():M}function $(r){for(var n,a="";;b++){if(b===F&&p.$raise(t.const_get_relative(xt,"ArgumentError"),"malformed format string - %*[0-9]"),e.charCodeAt(b)<48||e.charCodeAt(b)>57)return b--,n=parseInt(a,10)||0,n>2147483647&&p.$raise(t.const_get_relative(xt,"ArgumentError"),r+" too big"),n;a+=e.charAt(b)}}function _(t){var r,n=$(t);return"$"===e.charAt(b+1)?(b++,r=u(n)):r=l(),r.$to_int()}var d,p=this,h=a;null==s.DEBUG&&(s.DEBUG=a);var g=arguments.length,m=g-1;m<0&&(m=0),d=new Array(m);for(var v=1;v<g;v++)d[v-1]=arguments[v];o(d.$length()["$=="](1)?d["$[]"](0)["$respond_to?"]("to_ary"):d.$length()["$=="](1))&&(h=t.const_get_relative(xt,"Opal")["$coerce_to?"](d["$[]"](0),t.const_get_relative(xt,"Array"),"to_ary"),o(h["$nil?"]())||(d=h.$to_a()));var y,b,w,x,A,k,E,S,N,C,I,O,P,L,M,T,B="",j=0,F=e.length,R=1,q=0,D=32,z=128;for(b=e.indexOf("%");-1!==b;b=e.indexOf("%",b)){switch(x=void 0,T=0,k=-1,E=-1,M=void 0,y=b,b++,e.charAt(b)){case"%":j=b;case"":case"\n":case"\0":b++;continue}t:for(;b<F;b++)switch(e.charAt(b)){case" ":n(),T|=16;continue t;case"#":n(),T|=1;continue t;case"+":n(),T|=4
;continue t;case"-":n(),T|=2;continue t;case"0":n(),T|=8;continue t;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":if(S=$("width"),"$"===e.charAt(b+1)){if(b+2===F){x="%",b++;break t}void 0!==M&&p.$raise(t.const_get_relative(xt,"ArgumentError"),"value given twice - %"+S+"$"),M=u(S),b++}else i(),T|=D,k=S;continue t;case"<":case"{":for(C="<"===e.charAt(b)?">":"}",N="",b++;;b++){if(b===F&&p.$raise(t.const_get_relative(xt,"ArgumentError"),"malformed name - unmatched parenthesis"),e.charAt(b)===C){if(q>0&&p.$raise(t.const_get_relative(xt,"ArgumentError"),"named "+N+" after unnumbered("+q+")"),-1===q&&p.$raise(t.const_get_relative(xt,"ArgumentError"),"named "+N+" after numbered"),q=-2,void 0!==d[0]&&d[0].$$is_hash||p.$raise(t.const_get_relative(xt,"ArgumentError"),"one hash required"),M=d[0].$fetch(N),">"===C)continue t;if(x=M.toString(),-1!==E&&(x=x.slice(0,E)),2&T)for(;x.length<k;)x+=" ";else for(;x.length<k;)x=" "+x;break t}N+=e.charAt(b)}case"*":b++,i(),T|=D,k=_("width"),k<0&&(T|=2,k=-k);continue t;case".":if(T&z&&p.$raise(t.const_get_relative(xt,"ArgumentError"),"precision given twice"),T|=64|z,E=0,b++,"*"===e.charAt(b)){b++,E=_("precision"),E<0&&(T&=-65);continue t}E=$("precision");continue t;case"d":case"i":case"u":if((w=p.$Integer(f()))>=0){for(x=w.toString();x.length<E;)x="0"+x;if(2&T)for((4&T||16&T)&&(x=(4&T?"+":" ")+x);x.length<k;)x+=" ";else if(8&T&&-1===E){for(;x.length<k-(4&T||16&T?1:0);)x="0"+x;(4&T||16&T)&&(x=(4&T?"+":" ")+x)}else for((4&T||16&T)&&(x=(4&T?"+":" ")+x);x.length<k;)x=" "+x}else{for(x=(-w).toString();x.length<E;)x="0"+x;if(2&T)for(x="-"+x;x.length<k;)x+=" ";else if(8&T&&-1===E){for(;x.length<k-1;)x="0"+x;x="-"+x}else for(x="-"+x;x.length<k;)x=" "+x}break t;case"b":case"B":case"o":case"x":case"X":switch(e.charAt(b)){case"b":case"B":I=2,O="0b",P=/^1+/,L="1";break;case"o":I=8,O="0",P=/^3?7+/,L="7";break;case"x":case"X":I=16,O="0x",P=/^f+/,L="f"}if((w=p.$Integer(f()))>=0){for(x=w.toString(I);x.length<E;)x="0"+x;if(2&T)for((4&T||16&T)&&(x=(4&T?"+":" ")+x),1&T&&0!==w&&(x=O+x);x.length<k;)x+=" ";else if(8&T&&-1===E){for(;x.length<k-(4&T||16&T?1:0)-(1&T&&0!==w?O.length:0);)x="0"+x;1&T&&0!==w&&(x=O+x),(4&T||16&T)&&(x=(4&T?"+":" ")+x)}else for(1&T&&0!==w&&(x=O+x),(4&T||16&T)&&(x=(4&T?"+":" ")+x);x.length<k;)x=" "+x}else if(4&T||16&T){for(x=(-w).toString(I);x.length<E;)x="0"+x;if(2&T)for(1&T&&(x=O+x),x="-"+x;x.length<k;)x+=" ";else if(8&T&&-1===E){for(;x.length<k-1-(1&T?2:0);)x="0"+x;1&T&&(x=O+x),x="-"+x}else for(1&T&&(x=O+x),x="-"+x;x.length<k;)x=" "+x}else{for(x=(w>>>0).toString(I).replace(P,L);x.length<E-2;)x=L+x;if(2&T)for(x=".."+x,1&T&&(x=O+x);x.length<k;)x+=" ";else if(8&T&&-1===E){for(;x.length<k-2-(1&T?O.length:0);)x=L+x;x=".."+x,1&T&&(x=O+x)}else for(x=".."+x,1&T&&(x=O+x);x.length<k;)x=" "+x}e.charAt(b)===e.charAt(b).toUpperCase()&&(x=x.toUpperCase());break t;case"f":case"e":case"E":case"g":case"G":if((w=p.$Float(f()))>=0||isNaN(w)){if(w===1/0)x="Inf";else switch(e.charAt(b)){case"f":x=w.toFixed(-1===E?6:E);break;case"e":case"E":x=w.toExponential(-1===E?6:E);break;case"g":case"G":x=w.toExponential(),A=parseInt(x.split("e")[1],10),A<-4||A>=(-1===E?6:E)||(x=w.toPrecision(-1===E?1&T?6:void 0:E))}if(2&T)for((4&T||16&T)&&(x=(4&T?"+":" ")+x);x.length<k;)x+=" ";else if(8&T&&w!==1/0&&!isNaN(w)){for(;x.length<k-(4&T||16&T?1:0);)x="0"+x;(4&T||16&T)&&(x=(4&T?"+":" ")+x)}else for((4&T||16&T)&&(x=(4&T?"+":" ")+x);x.length<k;)x=" "+x}else{if(w===-1/0)x="Inf";else switch(e.charAt(b)){case"f":x=(-w).toFixed(-1===E?6:E);break;case"e":case"E":x=(-w).toExponential(-1===E?6:E);break;case"g":case"G":x=(-w).toExponential(),A=parseInt(x.split("e")[1],10),A<-4||A>=(-1===E?6:E)||(x=(-w).toPrecision(-1===E?1&T?6:void 0:E))}if(2&T)for(x="-"+x;x.length<k;)x+=" ";else if(8&T&&w!==-1/0){for(;x.length<k-1;)x="0"+x;x="-"+x}else for(x="-"+x;x.length<k;)x=" "+x}e.charAt(b)!==e.charAt(b).toUpperCase()||w===1/0||w===-1/0||isNaN(w)||(x=x.toUpperCase()),x=x.replace(/([eE][-+]?)([0-9])$/,"$10$2");break t;case"a":case"A":p.$raise(t.const_get_relative(xt,"NotImplementedError"),"`A` and `a` format field types are not implemented in Opal yet");case"c":if(w=f(),w["$respond_to?"]("to_ary")&&(w=w.$to_ary()[0]),x=w["$respond_to?"]("to_str")?w.$to_str():String.fromCharCode(t.const_get_relative(xt,"Opal").$coerce_to(w,t.const_get_relative(xt,"Integer"),"to_int")),1!==x.length&&p.$raise(t.const_get_relative(xt,"ArgumentError"),"%c requires a character"),2&T)for(;x.length<k;)x+=" ";else for(;x.length<k;)x=" "+x;break t;case"p":if(x=f().$inspect(),-1!==E&&(x=x.slice(0,E)),2&T)for(;x.length<k;)x+=" ";else for(;x.length<k;)x=" "+x;break t;case"s":if(x=f().$to_s(),-1!==E&&(x=x.slice(0,E)),2&T)for(;x.length<k;)x+=" ";else for(;x.length<k;)x=" "+x;break t;default:p.$raise(t.const_get_relative(xt,"ArgumentError"),"malformed format string - %"+e.charAt(b))}void 0===x&&p.$raise(t.const_get_relative(xt,"ArgumentError"),"malformed format string - %"),B+=e.slice(j,y)+x,j=b+1}return s.DEBUG&&q>=0&&R<d.length&&p.$raise(t.const_get_relative(xt,"ArgumentError"),"too many arguments for format string"),B+e.slice(j)},M.$$arity=-2),t.defn(wt,"$hash",T=function(){return this.$__id__()},T.$$arity=0),t.defn(wt,"$initialize_copy",B=function(t){return a},B.$$arity=1),t.defn(wt,"$inspect",j=function(){return this.$to_s()},j.$$arity=0),t.defn(wt,"$instance_of?",F=function(e){var r=this;return e.$$is_class||e.$$is_module||r.$raise(t.const_get_relative(xt,"TypeError"),"class or module required"),r.$$class===e},F.$$arity=1),t.defn(wt,"$instance_variable_defined?",R=function(e){var r=this;return e=t.const_get_relative(xt,"Opal")["$instance_variable_name!"](e),t.hasOwnProperty.call(r,e.substr(1))},R.$$arity=1),t.defn(wt,"$instance_variable_get",q=function(e){var r=this;e=t.const_get_relative(xt,"Opal")["$instance_variable_name!"](e);var n=r[t.ivar(e.substr(1))];return null==n?a:n},q.$$arity=1),t.defn(wt,"$instance_variable_set",D=function(e,r){var n=this;return e=t.const_get_relative(xt,"Opal")["$instance_variable_name!"](e),n[t.ivar(e.substr(1))]=r},D.$$arity=2),t.defn(wt,"$remove_instance_variable",z=function(e){var r=this;e=t.const_get_relative(xt,"Opal")["$instance_variable_name!"](e);var n,a=t.ivar(e.substr(1));return r.hasOwnProperty(a)?(n=r[a],delete r[a],n):r.$raise(t.const_get_relative(xt,"NameError"),"instance variable "+e+" not defined")},z.$$arity=1),t.defn(wt,"$instance_variables",U=function(){var t,e=this,r=[];for(var n in e)e.hasOwnProperty(n)&&"$"!==n.charAt(0)&&(t="$"===n.substr(-1)?n.slice(0,n.length-1):n,r.push("@"+t));return r},U.$$arity=0),t.defn(wt,"$Integer",H=function(e,r){var n,i,o,s=this;return e.$$is_string?"0"===e?0:(void 0===r?r=0:(1===(r=t.const_get_relative(xt,"Opal").$coerce_to(r,t.const_get_relative(xt,"Integer"),"to_int"))||r<0||r>36)&&s.$raise(t.const_get_relative(xt,"ArgumentError"),"invalid radix "+r),i=e.toLowerCase(),i=i.replace(/(\d)_(?=\d)/g,"$1"),i=i.replace(/^(\s*[+-]?)(0[bodx]?)/,function(n,a,i){switch(i){case"0b":if(0===r||2===r)return r=2,a;case"0":case"0o":if(0===r||8===r)return r=8,a;case"0d":if(0===r||10===r)return r=10,a;case"0x":if(0===r||16===r)return r=16,a}s.$raise(t.const_get_relative(xt,"ArgumentError"),'invalid value for Integer(): "'+e+'"')}),r=0===r?10:r,o="0-"+(r<=10?r-1:"9a-"+String.fromCharCode(r-11+97)),new RegExp("^\\s*[+-]?["+o+"]+\\s*$").test(i)||s.$raise(t.const_get_relative(xt,"ArgumentError"),'invalid value for Integer(): "'+e+'"'),n=parseInt(i,r),isNaN(n)&&s.$raise(t.const_get_relative(xt,"ArgumentError"),'invalid value for Integer(): "'+e+'"'),n):(void 0!==r&&s.$raise(t.const_get_relative(xt,"ArgumentError"),"base specified for non string value"),e===a&&s.$raise(t.const_get_relative(xt,"TypeError"),"can't convert nil into Integer"),e.$$is_number?((e===1/0||e===-1/0||isNaN(e))&&s.$raise(t.const_get_relative(xt,"FloatDomainError"),e),Math.floor(e)):e["$respond_to?"]("to_int")&&(n=e.$to_int())!==a?n:t.const_get_relative(xt,"Opal")["$coerce_to!"](e,t.const_get_relative(xt,"Integer"),"to_i"))},H.$$arity=-2),t.defn(wt,"$Float",G=function(e){var r,n=this;return e===a&&n.$raise(t.const_get_relative(xt,"TypeError"),"can't convert nil into Float"),e.$$is_string?(r=e.toString(),r=r.replace(/(\d)_(?=\d)/g,"$1"),/^\s*[-+]?0[xX][0-9a-fA-F]+\s*$/.test(r)?n.$Integer(r):(/^\s*[-+]?[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?\s*$/.test(r)||n.$raise(t.const_get_relative(xt,"ArgumentError"),'invalid value for Float(): "'+e+'"'),parseFloat(r))):t.const_get_relative(xt,"Opal")["$coerce_to!"](e,t.const_get_relative(xt,"Float"),"to_f")},G.$$arity=1),t.defn(wt,"$Hash",Y=function(e){var r;return o(o(r=e["$nil?"]())?r:e["$=="]([]))?c([],{}):o(t.const_get_relative(xt,"Hash")["$==="](e))?e:t.const_get_relative(xt,"Opal")["$coerce_to!"](e,t.const_get_relative(xt,"Hash"),"to_hash")},Y.$$arity=1),t.defn(wt,"$is_a?",V=function(e){var r=this;return e.$$is_class||e.$$is_module||r.$raise(t.const_get_relative(xt,"TypeError"),"class or module required"),t.is_a(r,e)},V.$$arity=1),t.defn(wt,"$itself",Q=function(){return this},Q.$$arity=0),t.alias(wt,"kind_of?","is_a?"),t.defn(wt,"$lambda",X=function(){var t=X.$$p,e=t||a;return t&&(X.$$p=null),e.$$is_lambda=!0,e},X.$$arity=0),t.defn(wt,"$load",J=function(e){return e=t.const_get_relative(xt,"Opal")["$coerce_to!"](e,t.const_get_relative(xt,"String"),"to_str"),t.load(e)},J.$$arity=1),t.defn(wt,"$loop",W=function(){var e,r=this,n=W.$$p,i=n||a,s=a;if(n&&(W.$$p=null),i===a)return l(r,"enum_for",["loop"],(e=function(){e.$$s;return t.const_get_qualified(t.const_get_relative(xt,"Float"),"INFINITY")},e.$$s=r,e.$$arity=0,e));for(;o(!0);)try{t.yieldX(i,[])}catch(e){if(!t.rescue(e,[t.const_get_relative(xt,"StopIteration")]))throw e;s=e;try{return s.$result()}finally{t.pop_exception()}}return r},W.$$arity=0),t.defn(wt,"$nil?",K=function(){return!1},K.$$arity=0),t.alias(wt,"object_id","__id__"),t.defn(wt,"$printf",Z=function(r){var n,i=this,s=arguments.length,c=s-0;c<0&&(c=0),n=new Array(c);for(var u=0;u<s;u++)n[u-0]=arguments[u];return o(e(n.$length(),0))&&i.$print(l(i,"format",t.to_a(n))),a},Z.$$arity=-1),t.defn(wt,"$proc",tt=function(){var e=this,r=tt.$$p,n=r||a;return r&&(tt.$$p=null),o(n)||e.$raise(t.const_get_relative(xt,"ArgumentError"),"tried to create Proc object without a block"),n.$$is_lambda=!1,n},tt.$$arity=0),t.defn(wt,"$puts",et=function(e){var r;null==s.stdout&&(s.stdout=a);var n=arguments.length,i=n-0;i<0&&(i=0),r=new Array(i);for(var o=0;o<n;o++)r[o-0]=arguments[o];return l(s.stdout,"puts",t.to_a(r))},et.$$arity=-1),t.defn(wt,"$p",rt=function(t){var e,n,i=this,c=arguments.length,u=c-0;u<0&&(u=0),n=new Array(u);for(var f=0;f<c;f++)n[f-0]=arguments[f];return l(n,"each",[],(e=function(t){e.$$s;return null==s.stdout&&(s.stdout=a),null==t&&(t=a),s.stdout.$puts(t.$inspect())},e.$$s=i,e.$$arity=1,e)),o(r(n.$length(),1))?n["$[]"](0):n},rt.$$arity=-1),t.defn(wt,"$print",nt=function(e){var r;null==s.stdout&&(s.stdout=a);var n=arguments.length,i=n-0;i<0&&(i=0),r=new Array(i);for(var o=0;o<n;o++)r[o-0]=arguments[o];return l(s.stdout,"print",t.to_a(r))},nt.$$arity=-1),t.defn(wt,"$warn",at=function(e){var r,n;null==s.VERBOSE&&(s.VERBOSE=a),null==s.stderr&&(s.stderr=a);var i=arguments.length,c=i-0;c<0&&(c=0),n=new Array(c);for(var u=0;u<i;u++)n[u-0]=arguments[u];return o(o(r=s.VERBOSE["$nil?"]())?r:n["$empty?"]())?a:l(s.stderr,"puts",t.to_a(n))},at.$$arity=-1),t.defn(wt,"$raise",it=function(e,r,n){if(null==s["!"]&&(s["!"]=a),null==r&&(r=a),null==n&&(n=a),null==e&&s["!"]!==a)throw s["!"];throw null==e?e=t.const_get_relative(xt,"RuntimeError").$new():e.$$is_string?e=t.const_get_relative(xt,"RuntimeError").$new(e):e.$$is_class&&e["$respond_to?"]("exception")?e=e.$exception(r):e["$kind_of?"](t.const_get_relative(xt,"Exception"))||(e=t.const_get_relative(xt,"TypeError").$new("exception class/object expected")),s["!"]!==a&&t.exceptions.push(s["!"]),s["!"]=e,e},it.$$arity=-1),t.alias(wt,"fail","raise"),t.defn(wt,"$rand",ot=function(e){return void 0===e?t.const_get_qualified(t.const_get_relative(xt,"Random"),"DEFAULT").$rand():(e.$$is_number&&(e<0&&(e=Math.abs(e)),e%1!=0&&(e=e.$to_i()),0===e&&(e=void 0)),t.const_get_qualified(t.const_get_relative(xt,"Random"),"DEFAULT").$rand(e))},ot.$$arity=-1),t.defn(wt,"$respond_to?",st=function(t,e){var r=this;if(null==e&&(e=!1),o(r["$respond_to_missing?"](t,e)))return!0;var n=r["$"+t];return"function"==typeof n&&!n.$$stub},st.$$arity=-2),t.defn(wt,"$respond_to_missing?",ct=function(t,e){return null==e&&(e=!1),!1},ct.$$arity=-2),t.defn(wt,"$require",lt=function(e){return e=t.const_get_relative(xt,"Opal")["$coerce_to!"](e,t.const_get_relative(xt,"String"),"to_str"),t.require(e)},lt.$$arity=1),t.defn(wt,"$require_relative",ut=function(e){return t.const_get_relative(xt,"Opal")["$try_convert!"](e,t.const_get_relative(xt,"String"),"to_str"),e=t.const_get_relative(xt,"File").$expand_path(t.const_get_relative(xt,"File").$join(t.current_file,"..",e)),t.require(e)},ut.$$arity=1),t.defn(wt,"$require_tree",ft=function(e){var r=[];e=t.const_get_relative(xt,"File").$expand_path(e),"."===(e=t.normalize(e))&&(e="");for(var n in t.modules)n["$start_with?"](e)&&r.push([n,t.require(n)]);return r},ft.$$arity=1),t.alias(wt,"send","__send__"),t.alias(wt,"public_send","__send__"),t.defn(wt,"$singleton_class",$t=function(){var e=this;return t.get_singleton_class(e)},$t.$$arity=0),t.defn(wt,"$sleep",_t=function(e){var r=this;null==e&&(e=a),e===a&&r.$raise(t.const_get_relative(xt,"TypeError"),"can't convert NilClass into time interval"),e.$$is_number||r.$raise(t.const_get_relative(xt,"TypeError"),"can't convert "+e.$class()+" into time interval"),e<0&&r.$raise(t.const_get_relative(xt,"ArgumentError"),"time interval must be positive");for(var n=t.global.performance?function(){return performance.now()}:function(){return new Date},i=n();n()-i<=1e3*e;);return e},_t.$$arity=-1),t.alias(wt,"sprintf","format"),t.defn(wt,"$srand",dt=function(e){return null==e&&(e=t.const_get_relative(xt,"Random").$new_seed()),t.const_get_relative(xt,"Random").$srand(e)},dt.$$arity=-1),t.defn(wt,"$String",pt=function(e){var r;return o(r=t.const_get_relative(xt,"Opal")["$coerce_to?"](e,t.const_get_relative(xt,"String"),"to_str"))?r:t.const_get_relative(xt,"Opal")["$coerce_to!"](e,t.const_get_relative(xt,"String"),"to_s")},pt.$$arity=1),t.defn(wt,"$tap",ht=function(){var e=this,r=ht.$$p,n=r||a;return r&&(ht.$$p=null),t.yield1(n,e),e},ht.$$arity=0),t.defn(wt,"$to_proc",gt=function(){return this},gt.$$arity=0),t.defn(wt,"$to_s",mt=function(){var t=this;return"#<"+t.$class()+":0x"+t.$__id__().$to_s(16)+">"},mt.$$arity=0),t.defn(wt,"$catch",vt=function(e){var r=this,n=vt.$$p,i=n||a,o=a;n&&(vt.$$p=null);try{return t.yieldX(i,[])}catch(n){if(!t.rescue(n,[t.const_get_relative(xt,"UncaughtThrowError")]))throw n;o=n;try{return o.$sym()["$=="](e)?o.$arg():r.$raise()}finally{t.pop_exception()}}},vt.$$arity=1),t.defn(wt,"$throw",yt=function(e){var r,n=this,a=arguments.length,i=a-0;i<0&&(i=0),r=new Array(i);for(var o=0;o<a;o++)r[o-0]=arguments[o];return n.$raise(t.const_get_relative(xt,"UncaughtThrowError").$new(r))},yt.$$arity=-1),t.defn(wt,"$open",bt=function(e){var r,n=bt.$$p,i=n||a,o=arguments.length,s=o-0;s<0&&(s=0),r=new Array(s);for(var c=0;c<o;c++)r[c-0]=arguments[c];return n&&(bt.$$p=null),l(t.const_get_relative(xt,"File"),"open",t.to_a(r),i.$to_proc())},bt.$$arity=-1)}(n[0],n),function(e,r,n){function a(){}var i=a=u(e,null,"Object",a),o=(i.$$proto,[i].concat(n));return i.$include(t.const_get_relative(o,"Kernel"))}(n[0],0,n)},Opal.modules["corelib/error"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t>e:t["$>"](e)}var n=(t.top,[]),a=t.nil,i=(t.breaker,t.slice,t.klass),o=t.send,s=t.truthy,c=t.module;return t.add_stubs(["$new","$clone","$to_s","$empty?","$class","$+","$attr_reader","$[]","$>","$length","$inspect"]),function(e,r,n){function c(){}var l,u,f,$,_,d,p,h,g=c=i(e,r,"Exception",c),m=g.$$proto,v=[g].concat(n);m.message=a;var y=t.const_get_relative(v,"Kernel").$raise;t.defs(g,"$new",l=function(e){var r,n=this,i=arguments.length,o=i-0;o<0&&(o=0),r=new Array(o);for(var s=0;s<i;s++)r[s-0]=arguments[s];var c=r.length>0?r[0]:a,l=new n.$$alloc(c);return l.name=n.$$name,l.message=c,t.send(l,l.$initialize,r),t.config.enable_stack_trace&&Error.captureStackTrace&&Error.captureStackTrace(l,y),l},l.$$arity=-1),t.defs(g,"$exception",u=function(e){var r,n=this,a=arguments.length,i=a-0;i<0&&(i=0),r=new Array(i);for(var s=0;s<a;s++)r[s-0]=arguments[s];return o(n,"new",t.to_a(r))},u.$$arity=-1),t.defn(g,"$initialize",f=function(t){var e,r=this,n=arguments.length,i=n-0;i<0&&(i=0),e=new Array(i);for(var o=0;o<n;o++)e[o-0]=arguments[o];return r.message=e.length>0?e[0]:a},f.$$arity=-1),t.defn(g,"$backtrace",$=function(){var t=this,e=t.stack;return"string"==typeof e?e.split("\n").slice(0,15):e?e.slice(0,15):[]},$.$$arity=0),t.defn(g,"$exception",_=function(t){var e=this;if(null==t&&(t=a),t===a||e===t)return e;var r=e.$clone();return r.message=t,r},_.$$arity=-1),t.defn(g,"$message",d=function(){return this.$to_s()},d.$$arity=0),t.defn(g,"$inspect",p=function(){var t=this,e=a;return e=t.$to_s(),s(e["$empty?"]())?t.$class().$to_s():"#<"+t.$class().$to_s()+": "+t.$to_s()+">"},p.$$arity=0),t.defn(g,"$to_s",h=function(){var t,e,r=this;return s(t=s(e=r.message)?r.message.$to_s():e)?t:r.$class().$to_s()},h.$$arity=0)}(n[0],Error,n),function(t,e,r){function n(){}var a=n=i(t,e,"ScriptError",n);a.$$proto,[a].concat(r)}(n[0],t.const_get_relative(n,"Exception"),n),function(t,e,r){function n(){}var a=n=i(t,e,"SyntaxError",n);a.$$proto,[a].concat(r)}(n[0],t.const_get_relative(n,"ScriptError"),n),function(t,e,r){function n(){}var a=n=i(t,e,"LoadError",n);a.$$proto,[a].concat(r)}(n[0],t.const_get_relative(n,"ScriptError"),n),function(t,e,r){function n(){}var a=n=i(t,e,"NotImplementedError",n);a.$$proto,[a].concat(r)}(n[0],t.const_get_relative(n,"ScriptError"),n),function(t,e,r){function n(){}var a=n=i(t,e,"SystemExit",n);a.$$proto,[a].concat(r)}(n[0],t.const_get_relative(n,"Exception"),n),function(t,e,r){function n(){}var a=n=i(t,e,"NoMemoryError",n);a.$$proto,[a].concat(r)}(n[0],t.const_get_relative(n,"Exception"),n),function(t,e,r){function n(){}var a=n=i(t,e,"SignalException",n);a.$$proto,[a].concat(r)}(n[0],t.const_get_relative(n,"Exception"),n),function(t,e,r){function n(){}var a=n=i(t,e,"Interrupt",n);a.$$proto,[a].concat(r)}(n[0],t.const_get_relative(n,"Exception"),n),function(t,e,r){function n(){}var a=n=i(t,e,"SecurityError",n);a.$$proto,[a].concat(r)}(n[0],t.const_get_relative(n,"Exception"),n),function(t,e,r){function n(){}var a=n=i(t,e,"StandardError",n);a.$$proto,[a].concat(r)}(n[0],t.const_get_relative(n,"Exception"),n),function(t,e,r){function n(){}var a=n=i(t,e,"ZeroDivisionError",n);a.$$proto,[a].concat(r)}(n[0],t.const_get_relative(n,"StandardError"),n),function(t,e,r){function n(){}var a=n=i(t,e,"NameError",n);a.$$proto,[a].concat(r)}(n[0],t.const_get_relative(n,"StandardError"),n),function(t,e,r){function n(){}var a=n=i(t,e,"NoMethodError",n);a.$$proto,[a].concat(r)}(n[0],t.const_get_relative(n,"NameError"),n),function(t,e,r){function n(){}var a=n=i(t,e,"RuntimeError",n);a.$$proto,[a].concat(r)}(n[0],t.const_get_relative(n,"StandardError"),n),function(t,e,r){function n(){}var a=n=i(t,e,"LocalJumpError",n);a.$$proto,[a].concat(r)}(n[0],t.const_get_relative(n,"StandardError"),n),function(t,e,r){function n(){}var a=n=i(t,e,"TypeError",n);a.$$proto,[a].concat(r)}(n[0],t.const_get_relative(n,"StandardError"),n),function(t,e,r){function n(){}var a=n=i(t,e,"ArgumentError",n);a.$$proto,[a].concat(r)}(n[0],t.const_get_relative(n,"StandardError"),n),function(t,e,r){function n(){}var a=n=i(t,e,"IndexError",n);a.$$proto,[a].concat(r)}(n[0],t.const_get_relative(n,"StandardError"),n),function(t,e,r){function n(){}var a=n=i(t,e,"StopIteration",n);a.$$proto,[a].concat(r)}(n[0],t.const_get_relative(n,"IndexError"),n),function(t,e,r){function n(){}var a=n=i(t,e,"KeyError",n);a.$$proto,[a].concat(r)}(n[0],t.const_get_relative(n,"IndexError"),n),function(t,e,r){function n(){}var a=n=i(t,e,"RangeError",n);a.$$proto,[a].concat(r)}(n[0],t.const_get_relative(n,"StandardError"),n),function(t,e,r){function n(){}var a=n=i(t,e,"FloatDomainError",n);a.$$proto,[a].concat(r)}(n[0],t.const_get_relative(n,"RangeError"),n),function(t,e,r){function n(){}var a=n=i(t,e,"IOError",n);a.$$proto,[a].concat(r)}(n[0],t.const_get_relative(n,"StandardError"),n),function(t,e,r){function n(){}var a=n=i(t,e,"SystemCallError",n);a.$$proto,[a].concat(r)}(n[0],t.const_get_relative(n,"StandardError"),n),function(r,n){var l,u=l=c(r,"Errno"),f=(u.$$proto,[u].concat(n));!function(r,n,c){function l(){}var u,f=l=i(r,n,"EINVAL",l);f.$$proto,[f].concat(c);t.defs(f,"$new",u=function(r){var n=this,i=u.$$p,c=a;return null==r&&(r=a),i&&(u.$$p=null),c="Invalid argument",s(r)&&(c=e(c," - "+r)),o(n,t.find_super_dispatcher(n,"new",u,!1,l),[c],null)},u.$$arity=-1)}(f[0],t.const_get_relative(f,"SystemCallError"),f)}(n[0],n),function(e,n,c){function l(){}var u,f=l=i(e,n,"UncaughtThrowError",l),$=f.$$proto;[f].concat(c);$.sym=a,f.$attr_reader("sym","arg"),t.defn(f,"$initialize",u=function(e){var n=this,a=u.$$p;return a&&(u.$$p=null),n.sym=e["$[]"](0),s(r(e.$length(),1))&&(n.arg=e["$[]"](1)),o(n,t.find_super_dispatcher(n,"initialize",u,!1),["uncaught throw "+n.sym.$inspect()],null)},u.$$arity=1)}(n[0],t.const_get_relative(n,"ArgumentError"),n),function(e,r,n){function s(){}var c,l=s=i(e,null,"NameError",s);l.$$proto,[l].concat(n);l.$attr_reader("name"),t.defn(l,"$initialize",c=function(e,r){var n=this,i=c.$$p;return null==r&&(r=a),i&&(c.$$p=null),o(n,t.find_super_dispatcher(n,"initialize",c,!1),[e],null),n.name=r},c.$$arity=-2)}(n[0],0,n),function(e,r,n){function s(){}var c,l=s=i(e,null,"NoMethodError",s);l.$$proto,[l].concat(n);l.$attr_reader("args"),t.defn(l,"$initialize",c=function(e,r,n){var i=this,s=c.$$p;return null==r&&(r=a),null==n&&(n=[]),s&&(c.$$p=null),o(i,t.find_super_dispatcher(i,"initialize",c,!1),[e,r],null),i.args=n},c.$$arity=-2)}(n[0],0,n),function(t,e,r){function n(){}var a=n=i(t,null,"StopIteration",n);a.$$proto,[a].concat(r);a.$attr_reader("result")}(n[0],0,n),function(t,e){var r,n=r=c(t,"JS"),a=(n.$$proto,[n].concat(e));!function(t,e,r){function n(){}var a=n=i(t,null,"Error",n);a.$$proto,[a].concat(r)}(a[0],0,a)}(n[0],n)},Opal.modules["corelib/constants"]=function(t){var e=(t.top,[]);t.nil,t.breaker,t.slice;return t.const_set(e[0],"RUBY_PLATFORM","opal"),t.const_set(e[0],"RUBY_ENGINE","opal"),t.const_set(e[0],"RUBY_VERSION","2.4.5"),t.const_set(e[0],"RUBY_ENGINE_VERSION","0.11.4"),t.const_set(e[0],"RUBY_RELEASE_DATE","2018-11-07"),t.const_set(e[0],"RUBY_PATCHLEVEL",0),t.const_set(e[0],"RUBY_REVISION",0),t.const_set(e[0],"RUBY_COPYRIGHT","opal - Copyright (C) 2013-2015 Adam Beynon"),t.const_set(e[0],"RUBY_DESCRIPTION","opal "+t.const_get_relative(e,"RUBY_ENGINE_VERSION")+" ("+t.const_get_relative(e,"RUBY_RELEASE_DATE")+" revision "+t.const_get_relative(e,"RUBY_REVISION")+")")},Opal.modules["opal/base"]=function(t){var e=t.top;t.nil,t.breaker,t.slice;return t.add_stubs(["$require"]),e.$require("corelib/runtime"),e.$require("corelib/helpers"),e.$require("corelib/module"),e.$require("corelib/class"),e.$require("corelib/basic_object"),e.$require("corelib/kernel"),e.$require("corelib/error"),e.$require("corelib/constants")},Opal.modules["corelib/nil"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t>e:t["$>"](e)}var r=(t.top,[]),n=t.nil,a=(t.breaker,t.slice,t.klass),i=t.hash2,o=t.truthy;return t.add_stubs(["$raise","$name","$new","$>","$length","$Rational"]),function(r,s,c){function l(){}var u,f,$,_,d,p,h,g,m,v,y,b,w,x,A,k,E,S,N=l=a(r,null,"NilClass",l),C=N.$$proto,I=[N].concat(c);C.$$meta=N,function(e,r){var n,a=(e.$$proto,[e].concat(r));t.defn(e,"$allocate",n=function(){var e=this;return e.$raise(t.const_get_relative(a,"TypeError"),"allocator undefined for "+e.$name())},n.$$arity=0),t.udef(e,"$new")}(t.get_singleton_class(N),I),t.defn(N,"$!",u=function(){return!0},u.$$arity=0),t.defn(N,"$&",f=function(t){return!1},f.$$arity=1),t.defn(N,"$|",$=function(t){return!1!==t&&t!==n},$.$$arity=1),t.defn(N,"$^",_=function(t){return!1!==t&&t!==n},_.$$arity=1),t.defn(N,"$==",d=function(t){return t===n},d.$$arity=1),t.defn(N,"$dup",p=function(){return n},p.$$arity=0),t.defn(N,"$clone",h=function(e){var r;if(null==e||!e.$$is_hash){if(null!=e)throw t.ArgumentError.$new("expected kwargs");e=i([],{})}return r=e.$$smap.freeze,null==r&&(r=!0),n},h.$$arity=-1),t.defn(N,"$inspect",g=function(){return"nil"},g.$$arity=0),t.defn(N,"$nil?",m=function(){return!0},m.$$arity=0),t.defn(N,"$singleton_class",v=function(){return t.const_get_relative(I,"NilClass")},v.$$arity=0),t.defn(N,"$to_a",y=function(){return[]},y.$$arity=0),t.defn(N,"$to_h",b=function(){return t.hash()},b.$$arity=0),t.defn(N,"$to_i",w=function(){return 0},w.$$arity=0),t.alias(N,"to_f","to_i"),t.defn(N,"$to_s",x=function(){return""},x.$$arity=0),t.defn(N,"$to_c",A=function(){return t.const_get_relative(I,"Complex").$new(0,0)},A.$$arity=0),t.defn(N,"$rationalize",k=function(r){var n,a=this,i=arguments.length,s=i-0;s<0&&(s=0),n=new Array(s);for(var c=0;c<i;c++)n[c-0]=arguments[c];return o(e(n.$length(),1))&&a.$raise(t.const_get_relative(I,"ArgumentError")),a.$Rational(0,1)},k.$$arity=-1),t.defn(N,"$to_r",E=function(){return this.$Rational(0,1)},E.$$arity=0),t.defn(N,"$instance_variables",S=function(){return[]},S.$$arity=0)}(r[0],0,r),t.const_set(r[0],"NIL",n)},Opal.modules["corelib/boolean"]=function(t){var e=(t.top,[]),r=t.nil,n=(t.breaker,t.slice,t.klass),a=t.hash2;return t.add_stubs(["$raise","$name"]),function(e,i,o){function s(){}var c,l,u,f,$,_,d,p,h,g,m=s=n(e,i,"Boolean",s),v=m.$$proto,y=[m].concat(o);v.$$is_boolean=!0,v.$$meta=m,function(e,r){var n,a=(e.$$proto,[e].concat(r));t.defn(e,"$allocate",n=function(){var e=this;return e.$raise(t.const_get_relative(a,"TypeError"),"allocator undefined for "+e.$name())},n.$$arity=0),t.udef(e,"$new")}(t.get_singleton_class(m),y),t.defn(m,"$__id__",c=function(){return this.valueOf()?2:0},c.$$arity=0),t.alias(m,"object_id","__id__"),t.defn(m,"$!",l=function(){return 1!=this},l.$$arity=0),t.defn(m,"$&",u=function(t){return 1==this&&!1!==t&&t!==r},u.$$arity=1),t.defn(m,"$|",f=function(t){return 1==this||!1!==t&&t!==r},f.$$arity=1),t.defn(m,"$^",$=function(t){return 1==this?!1===t||t===r:!1!==t&&t!==r},$.$$arity=1),t.defn(m,"$==",_=function(t){return 1==this===t.valueOf()},_.$$arity=1),t.alias(m,"equal?","=="),t.alias(m,"eql?","=="),t.defn(m,"$singleton_class",d=function(){return t.const_get_relative(y,"Boolean")},d.$$arity=0),t.defn(m,"$to_s",p=function(){return 1==this?"true":"false"},p.$$arity=0),t.defn(m,"$dup",h=function(){return this},h.$$arity=0),t.defn(m,"$clone",g=function(e){var r,n=this;if(null==e||!e.$$is_hash){if(null!=e)throw t.ArgumentError.$new("expected kwargs");e=a([],{})}return r=e.$$smap.freeze,null==r&&(r=!0),n},g.$$arity=-1)}(e[0],Boolean,e),t.const_set(e[0],"TrueClass",t.const_get_relative(e,"Boolean")),t.const_set(e[0],"FalseClass",t.const_get_relative(e,"Boolean")),t.const_set(e[0],"TRUE",!0),t.const_set(e[0],"FALSE",!1)},Opal.modules["corelib/comparable"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t>e:t["$>"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t<e:t["$<"](e)}var n=(t.top,[]),a=t.nil,i=(t.breaker,t.slice,t.module),o=t.truthy;return t.add_stubs(["$===","$>","$<","$equal?","$<=>","$normalize","$raise","$class"]),function(n,s){var c,l,u,f,$,_,d,p,h,g=c=i(n,"Comparable"),m=(g.$$proto,[g].concat(s));t.defs(g,"$normalize",l=function(n){return o(t.const_get_relative(m,"Integer")["$==="](n))?n:o(e(n,0))?1:o(r(n,0))?-1:0},l.$$arity=1),t.defn(g,"$==",u=function(e){var r=this,n=a;try{return!!o(r["$equal?"](e))||r["$<=>"]!=t.Kernel["$<=>"]&&(r.$$comparable?(delete r.$$comparable,!1):!!o(n=r["$<=>"](e))&&0==t.const_get_relative(m,"Comparable").$normalize(n))}catch(e){if(!t.rescue(e,[t.const_get_relative(m,"StandardError")]))throw e;try{return!1}finally{t.pop_exception()}}},u.$$arity=1),t.defn(g,"$>",f=function(e){var r=this,n=a;return o(n=r["$<=>"](e))||r.$raise(t.const_get_relative(m,"ArgumentError"),"comparison of "+r.$class()+" with "+e.$class()+" failed"),t.const_get_relative(m,"Comparable").$normalize(n)>0},f.$$arity=1),t.defn(g,"$>=",$=function(e){var r=this,n=a;return o(n=r["$<=>"](e))||r.$raise(t.const_get_relative(m,"ArgumentError"),"comparison of "+r.$class()+" with "+e.$class()+" failed"),t.const_get_relative(m,"Comparable").$normalize(n)>=0},$.$$arity=1),t.defn(g,"$<",_=function(e){var r=this,n=a;return o(n=r["$<=>"](e))||r.$raise(t.const_get_relative(m,"ArgumentError"),"comparison of "+r.$class()+" with "+e.$class()+" failed"),t.const_get_relative(m,"Comparable").$normalize(n)<0},_.$$arity=1),t.defn(g,"$<=",d=function(e){var r=this,n=a;return o(n=r["$<=>"](e))||r.$raise(t.const_get_relative(m,"ArgumentError"),"comparison of "+r.$class()+" with "+e.$class()+" failed"),t.const_get_relative(m,"Comparable").$normalize(n)<=0},d.$$arity=1),t.defn(g,"$between?",p=function(t,n){var a=this;return!r(a,t)&&!e(a,n)},p.$$arity=2),t.defn(g,"$clamp",h=function(n,i){var s=this,c=a;return c=n["$<=>"](i),o(c)||s.$raise(t.const_get_relative(m,"ArgumentError"),"comparison of "+n.$class()+" with "+i.$class()+" failed"),o(e(t.const_get_relative(m,"Comparable").$normalize(c),0))&&s.$raise(t.const_get_relative(m,"ArgumentError"),"min argument must be smaller than max argument"),o(r(t.const_get_relative(m,"Comparable").$normalize(s["$<=>"](n)),0))?n:o(e(t.const_get_relative(m,"Comparable").$normalize(s["$<=>"](i)),0))?i:s},h.$$arity=2)}(n[0],n)},Opal.modules["corelib/regexp"]=function(t){var e=(t.top,[]),r=t.nil,n=(t.breaker,t.slice,t.klass),a=t.send,i=t.truthy,o=t.gvars;return t.add_stubs(["$nil?","$[]","$raise","$escape","$options","$to_str","$new","$join","$coerce_to!","$!","$match","$coerce_to?","$begin","$coerce_to","$call","$=~","$attr_reader","$===","$inspect","$to_a"]),function(t,e,r){function a(){}var i=a=n(t,e,"RegexpError",a);i.$$proto,[i].concat(r)}(e[0],t.const_get_relative(e,"StandardError"),e),function(e,s,c){function l(){}var u,f,$,_,d,p,h,g,m,v,y=l=n(e,s,"Regexp",l),b=y.$$proto,w=[y].concat(c);t.const_set(w[0],"IGNORECASE",1),t.const_set(w[0],"MULTILINE",4),b.$$is_regexp=!0,function(e,n){var s,c,l,u,f,$=(e.$$proto,[e].concat(n));t.defn(e,"$allocate",s=function(){var e=this,n=s.$$p,i=r,o=r,c=r,l=r;for(n&&(s.$$p=null),c=0,l=arguments.length,o=new Array(l);c<l;c++)o[c]=arguments[c];return i=a(e,t.find_super_dispatcher(e,"allocate",s,!1),o,n),i.uninitialized=!0,i},s.$$arity=0),t.defn(e,"$escape",c=function(e){return t.escape_regexp(e)},c.$$arity=1),t.defn(e,"$last_match",l=function(t){return null==o["~"]&&(o["~"]=r),null==t&&(t=r),i(t["$nil?"]())?o["~"]:o["~"]["$[]"](t)},l.$$arity=-1),t.alias(e,"quote","escape"),t.defn(e,"$union",u=function(e){var r,n=this,a=arguments.length,i=a-0;i<0&&(i=0),r=new Array(i);for(var o=0;o<a;o++)r[o-0]=arguments[o];var s,c,l,u,f;if(0==r.length)return/(?!)/;s=r[0].$$is_array,r.length>1&&s&&n.$raise(t.const_get_relative($,"TypeError"),"no implicit conversion of Array into String"),s&&(r=r[0]),u=void 0,c=[];for(var _=0;_<r.length;_++)l=r[_],l.$$is_string?c.push(n.$escape(l)):l.$$is_regexp?(f=l.$options(),void 0!=u&&u!=f&&n.$raise(t.const_get_relative($,"TypeError"),"All expressions must use the same options"),u=f,c.push("("+l.source+")")):c.push(n.$escape(l.$to_str()));return n.$new(c.$join("|"),u)},u.$$arity=-1),t.defn(e,"$new",f=function(e,r){var n=this;if(e.$$is_regexp)return new RegExp(e);if(e=t.const_get_relative($,"Opal")["$coerce_to!"](e,t.const_get_relative($,"String"),"to_str"),"\\"===e.charAt(e.length-1)&&"\\"!==e.charAt(e.length-2)&&n.$raise(t.const_get_relative($,"RegexpError"),"too short escape sequence: /"+e+"/"),void 0===r||r["$!"]())return new RegExp(e);if(r.$$is_number){var a="";t.const_get_relative($,"IGNORECASE")&r&&(a+="i"),t.const_get_relative($,"MULTILINE")&r&&(a+="m"),r=a}else r="i";return new RegExp(e,r)},f.$$arity=-2)
}(t.get_singleton_class(y),w),t.defn(y,"$==",u=function(t){var e=this;return t.constructor==RegExp&&e.toString()===t.toString()},u.$$arity=1),t.defn(y,"$===",f=function(e){return this.$match(t.const_get_relative(w,"Opal")["$coerce_to?"](e,t.const_get_relative(w,"String"),"to_str"))!==r},f.$$arity=1),t.defn(y,"$=~",$=function(t){var e,n=this;return null==o["~"]&&(o["~"]=r),i(e=n.$match(t))?o["~"].$begin(0):e},$.$$arity=1),t.alias(y,"eql?","=="),t.defn(y,"$inspect",_=function(){var t=this,e=/^\/(.*)\/([^\/]*)$/,r=t.toString(),n=e.exec(r);if(n){for(var a=n[1],i=n[2],o=a.split(""),s=o.length,c=!1,l="",u=0;u<s;u++){var f=o[u];c||"/"!=f||(l=l.concat("\\")),l=l.concat(f),c="\\"==f&&!c}return"/"+l+"/"+i}return r},_.$$arity=0),t.defn(y,"$match",d=function(e,n){var a=this,i=d.$$p,s=i||r;if(null==o["~"]&&(o["~"]=r),i&&(d.$$p=null),a.uninitialized&&a.$raise(t.const_get_relative(w,"TypeError"),"uninitialized Regexp"),n=void 0===n?0:t.const_get_relative(w,"Opal").$coerce_to(n,t.const_get_relative(w,"Integer"),"to_int"),e===r)return o["~"]=r;if(e=t.const_get_relative(w,"Opal").$coerce_to(e,t.const_get_relative(w,"String"),"to_str"),n<0&&(n+=e.length)<0)return o["~"]=r;var c=a.source,l="g";a.multiline&&(c=c.replace(".","[\\s\\S]"),l+="m");for(var u,f=new RegExp(c,l+(a.ignoreCase?"i":""));;){if(null===(u=f.exec(e)))return o["~"]=r;if(u.index>=n)return o["~"]=t.const_get_relative(w,"MatchData").$new(f,u),s===r?o["~"]:s.$call(o["~"]);f.lastIndex=u.index+1}},d.$$arity=-2),t.defn(y,"$match?",p=function(e,n){var a=this;if(a.uninitialized&&a.$raise(t.const_get_relative(w,"TypeError"),"uninitialized Regexp"),n=void 0===n?0:t.const_get_relative(w,"Opal").$coerce_to(n,t.const_get_relative(w,"Integer"),"to_int"),e===r)return!1;if(e=t.const_get_relative(w,"Opal").$coerce_to(e,t.const_get_relative(w,"String"),"to_str"),n<0&&(n+=e.length)<0)return!1;var i=a.source,o="g";a.multiline&&(i=i.replace(".","[\\s\\S]"),o+="m");var s;return!(null===(s=new RegExp(i,o+(a.ignoreCase?"i":"")).exec(e))||s.index<n)},p.$$arity=-2),t.defn(y,"$~",h=function(){var t=this;return null==o._&&(o._=r),t["$=~"](o._)},h.$$arity=0),t.defn(y,"$source",g=function(){return this.source},g.$$arity=0),t.defn(y,"$options",m=function(){var e=this;e.uninitialized&&e.$raise(t.const_get_relative(w,"TypeError"),"uninitialized Regexp");var r=0;return e.multiline&&(r|=t.const_get_relative(w,"MULTILINE")),e.ignoreCase&&(r|=t.const_get_relative(w,"IGNORECASE")),r},m.$$arity=0),t.defn(y,"$casefold?",v=function(){return this.ignoreCase},v.$$arity=0),t.alias(y,"to_s","source")}(e[0],RegExp,e),function(e,s,c){function l(){}var u,f,$,_,d,p,h,g,m,v,y,b,w=l=n(e,null,"MatchData",l),x=w.$$proto,A=[w].concat(c);return x.matches=r,w.$attr_reader("post_match","pre_match","regexp","string"),t.defn(w,"$initialize",u=function(t,e){var n=this;o["~"]=n,n.regexp=t,n.begin=e.index,n.string=e.input,n.pre_match=e.input.slice(0,e.index),n.post_match=e.input.slice(e.index+e[0].length),n.matches=[];for(var a=0,i=e.length;a<i;a++){var s=e[a];null==s?n.matches.push(r):n.matches.push(s)}},u.$$arity=2),t.defn(w,"$[]",f=function(e){var r,n=this,i=arguments.length,o=i-0;o<0&&(o=0),r=new Array(o);for(var s=0;s<i;s++)r[s-0]=arguments[s];return a(n.matches,"[]",t.to_a(r))},f.$$arity=-1),t.defn(w,"$offset",$=function(e){var r=this;return 0!==e&&r.$raise(t.const_get_relative(A,"ArgumentError"),"MatchData#offset only supports 0th element"),[r.begin,r.begin+r.matches[e].length]},$.$$arity=1),t.defn(w,"$==",_=function(e){var r,n,a,o,s=this;return!!i(t.const_get_relative(A,"MatchData")["$==="](e))&&(i(r=i(n=i(a=i(o=s.string==e.string)?s.regexp.toString()==e.regexp.toString():o)?s.pre_match==e.pre_match:a)?s.post_match==e.post_match:n)?s.begin==e.begin:r)},_.$$arity=1),t.alias(w,"eql?","=="),t.defn(w,"$begin",d=function(e){var r=this;return 0!==e&&r.$raise(t.const_get_relative(A,"ArgumentError"),"MatchData#begin only supports 0th element"),r.begin},d.$$arity=1),t.defn(w,"$end",p=function(e){var r=this;return 0!==e&&r.$raise(t.const_get_relative(A,"ArgumentError"),"MatchData#end only supports 0th element"),r.begin+r.matches[e].length},p.$$arity=1),t.defn(w,"$captures",h=function(){return this.matches.slice(1)},h.$$arity=0),t.defn(w,"$inspect",g=function(){for(var t=this,e="#<MatchData "+t.matches[0].$inspect(),r=1,n=t.matches.length;r<n;r++)e+=" "+r+":"+t.matches[r].$inspect();return e+">"},g.$$arity=0),t.defn(w,"$length",m=function(){return this.matches.length},m.$$arity=0),t.alias(w,"size","length"),t.defn(w,"$to_a",v=function(){return this.matches},v.$$arity=0),t.defn(w,"$to_s",y=function(){return this.matches[0]},y.$$arity=0),t.defn(w,"$values_at",b=function(e){var n,a=this,i=arguments.length,o=i-0;o<0&&(o=0),n=new Array(o);for(var s=0;s<i;s++)n[s-0]=arguments[s];var c,l,u,f=[];for(c=0;c<n.length;c++)n[c].$$is_range&&(l=n[c].$to_a(),l.unshift(c,1),Array.prototype.splice.apply(n,l)),u=t.const_get_relative(A,"Opal")["$coerce_to!"](n[c],t.const_get_relative(A,"Integer"),"to_int"),u<0&&(u+=a.matches.length)<0?f.push(r):f.push(a.matches[u]);return f},b.$$arity=-1),r&&"values_at"}(e[0],0,e)},Opal.modules["corelib/string"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t/e:t["$/"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}var n=t.top,a=[],i=t.nil,o=(t.breaker,t.slice,t.klass),s=t.truthy,c=t.send,l=t.gvars;return t.add_stubs(["$require","$include","$coerce_to?","$coerce_to","$raise","$===","$format","$to_s","$respond_to?","$to_str","$<=>","$==","$=~","$new","$empty?","$ljust","$ceil","$/","$+","$rjust","$floor","$to_a","$each_char","$to_proc","$coerce_to!","$copy_singleton_methods","$initialize_clone","$initialize_dup","$enum_for","$size","$chomp","$[]","$to_i","$each_line","$class","$match","$captures","$proc","$succ","$escape"]),n.$require("corelib/comparable"),n.$require("corelib/regexp"),function(n,a,u){function f(){}function $(e){function r(t,e){if(0===t.length)return e;var r,n,a="",i=t.length;for(r=0;r<i;r++)n=t.charAt(r),-1!==e.indexOf(n)&&(a+=n);return a}var n,a,i,o,s,c,l="",u="";for(n=0,a=e.length;n<a;n++)i=t.const_get_relative(Ct,"Opal").$coerce_to(e[n],t.const_get_relative(Ct,"String"),"to_str"),o="^"===i.charAt(0)&&i.length>1,i=function(e){var r,n,a,i,o,s,c="",l=e.length;for(r=0;r<l;r++)if("-"===(n=e.charAt(r))&&r>0&&r<l-1&&!a){for(i=e.charCodeAt(r-1),o=e.charCodeAt(r+1),i>o&&St.$raise(t.const_get_relative(Ct,"ArgumentError"),'invalid range "'+i+"-"+o+'" in string transliteration'),s=i+1;s<o+1;s++)c+=String.fromCharCode(s);a=!0,r++}else a="\\"===n,c+=n;return c}(o?i.slice(1):i),o?u=r(u,i):l=r(l,i);if(l.length>0&&u.length>0){for(c="",n=0,a=l.length;n<a;n++)s=l.charAt(n),-1===u.indexOf(s)&&(c+=s);l=c,u=""}return l.length>0?"["+t.const_get_relative(Ct,"Regexp").$escape(l)+"]":u.length>0?"[^"+t.const_get_relative(Ct,"Regexp").$escape(u)+"]":null}var _,d,p,h,g,m,v,y,b,w,x,A,k,E,S,N,C,I,O,P,L,M,T,B,j,F,R,q,D,z,U,H,G,Y,V,Q,X,J,W,K,Z,tt,et,rt,nt,at,it,ot,st,ct,lt,ut,ft,$t,_t,dt,pt,ht,gt,mt,vt,yt,bt,wt,xt,At,kt,Et,St=f=o(n,a,"String",f),Nt=St.$$proto,Ct=[St].concat(u);Nt.length=i,St.$include(t.const_get_relative(Ct,"Comparable")),Nt.$$is_string=!0,t.defn(St,"$__id__",_=function(){return this.toString()},_.$$arity=0),t.alias(St,"object_id","__id__"),t.defs(St,"$try_convert",d=function(e){return t.const_get_relative(Ct,"Opal")["$coerce_to?"](e,t.const_get_relative(Ct,"String"),"to_str")},d.$$arity=1),t.defs(St,"$new",p=function(e){return null==e&&(e=""),e=t.const_get_relative(Ct,"Opal").$coerce_to(e,t.const_get_relative(Ct,"String"),"to_str"),new String(e)},p.$$arity=-1),t.defn(St,"$initialize",h=function(e){var r=this;return void 0===e?r:r.$raise(t.const_get_relative(Ct,"NotImplementedError"),"Mutable strings are not supported in Opal.")},h.$$arity=-1),t.defn(St,"$%",g=function(e){var r=this;return s(t.const_get_relative(Ct,"Array")["$==="](e))?c(r,"format",[r].concat(t.to_a(e))):r.$format(r,e)},g.$$arity=1),t.defn(St,"$*",m=function(e){var r=this;if(e=t.const_get_relative(Ct,"Opal").$coerce_to(e,t.const_get_relative(Ct,"Integer"),"to_int"),e<0&&r.$raise(t.const_get_relative(Ct,"ArgumentError"),"negative argument"),0===e)return"";var n="",a=r.toString();for(a.length*e>=1<<28&&r.$raise(t.const_get_relative(Ct,"RangeError"),"multiply count must not overflow maximum string size");1==(1&e)&&(n+=a),0!==(e>>>=1);)a+=a;return n},m.$$arity=1),t.defn(St,"$+",v=function(e){var r=this;return e=t.const_get_relative(Ct,"Opal").$coerce_to(e,t.const_get_relative(Ct,"String"),"to_str"),r+e.$to_s()},v.$$arity=1),t.defn(St,"$<=>",y=function(t){var e=this;if(s(t["$respond_to?"]("to_str")))return t=t.$to_str().$to_s(),e>t?1:e<t?-1:0;var r=t["$<=>"](e);return r===i?i:r>0?-1:r<0?1:0},y.$$arity=1),t.defn(St,"$==",b=function(e){var r=this;return e.$$is_string?r.toString()===e.toString():!!t.const_get_relative(Ct,"Opal")["$respond_to?"](e,"to_str")&&e["$=="](r)},b.$$arity=1),t.alias(St,"eql?","=="),t.alias(St,"===","=="),t.defn(St,"$=~",w=function(e){var r=this;return e.$$is_string&&r.$raise(t.const_get_relative(Ct,"TypeError"),"type mismatch: String given"),e["$=~"](r)},w.$$arity=1),t.defn(St,"$[]",x=function(e,r){var n,a=this,o=a.length;if(e.$$is_range)return n=e.excl,r=t.const_get_relative(Ct,"Opal").$coerce_to(e.end,t.const_get_relative(Ct,"Integer"),"to_int"),e=t.const_get_relative(Ct,"Opal").$coerce_to(e.begin,t.const_get_relative(Ct,"Integer"),"to_int"),Math.abs(e)>o?i:(e<0&&(e+=o),r<0&&(r+=o),n||(r+=1),r-=e,r<0&&(r=0),a.substr(e,r));if(e.$$is_string)return null!=r&&a.$raise(t.const_get_relative(Ct,"TypeError")),-1!==a.indexOf(e)?e:i;if(e.$$is_regexp){var s=a.match(e);return null===s?(l["~"]=i,i):(l["~"]=t.const_get_relative(Ct,"MatchData").$new(e,s),null==r?s[0]:(r=t.const_get_relative(Ct,"Opal").$coerce_to(r,t.const_get_relative(Ct,"Integer"),"to_int"),r<0&&-r<s.length?s[r+=s.length]:r>=0&&r<s.length?s[r]:i))}return e=t.const_get_relative(Ct,"Opal").$coerce_to(e,t.const_get_relative(Ct,"Integer"),"to_int"),e<0&&(e+=o),null==r?e>=o||e<0?i:a.substr(e,1):(r=t.const_get_relative(Ct,"Opal").$coerce_to(r,t.const_get_relative(Ct,"Integer"),"to_int"),r<0?i:e>o||e<0?i:a.substr(e,r))},x.$$arity=-2),t.alias(St,"byteslice","[]"),t.defn(St,"$capitalize",A=function(){var t=this;return t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()},A.$$arity=0),t.defn(St,"$casecmp",k=function(e){var r=this;e=t.const_get_relative(Ct,"Opal").$coerce_to(e,t.const_get_relative(Ct,"String"),"to_str").$to_s();var n=/^[\x00-\x7F]*$/;return n.test(r)&&n.test(e)&&(r=r.toLowerCase(),e=e.toLowerCase()),r["$<=>"](e)},k.$$arity=1),t.defn(St,"$center",E=function(n,a){var i=this;if(null==a&&(a=" "),n=t.const_get_relative(Ct,"Opal").$coerce_to(n,t.const_get_relative(Ct,"Integer"),"to_int"),a=t.const_get_relative(Ct,"Opal").$coerce_to(a,t.const_get_relative(Ct,"String"),"to_str").$to_s(),s(a["$empty?"]())&&i.$raise(t.const_get_relative(Ct,"ArgumentError"),"zero width padding"),s(n<=i.length))return i;var o=i.$ljust(e(r(n,i.length),2).$ceil(),a);return i.$rjust(e(r(n,i.length),2).$floor(),a)+o.slice(i.length)},E.$$arity=-2),t.defn(St,"$chars",S=function(){var t=this,e=S.$$p,r=e||i;return e&&(S.$$p=null),s(r)?c(t,"each_char",[],r.$to_proc()):t.$each_char().$to_a()},S.$$arity=0),t.defn(St,"$chomp",N=function(e){var r=this;if(null==l["/"]&&(l["/"]=i),null==e&&(e=l["/"]),s(e===i||0===r.length))return r;if("\n"===(e=t.const_get_relative(Ct,"Opal")["$coerce_to!"](e,t.const_get_relative(Ct,"String"),"to_str").$to_s()))return r.replace(/\r?\n?$/,"");if(""===e)return r.replace(/(\r?\n)+$/,"");if(r.length>e.length){if(r.substr(r.length-e.length,e.length)===e)return r.substr(0,r.length-e.length)}return r},N.$$arity=-1),t.defn(St,"$chop",C=function(){var t=this,e=t.length;return e<=1?"":"\n"===t.charAt(e-1)&&"\r"===t.charAt(e-2)?t.substr(0,e-2):t.substr(0,e-1)},C.$$arity=0),t.defn(St,"$chr",I=function(){return this.charAt(0)},I.$$arity=0),t.defn(St,"$clone",O=function(){var t=this,e=i;return e=t.slice(),e.$copy_singleton_methods(t),e.$initialize_clone(t),e},O.$$arity=0),t.defn(St,"$dup",P=function(){var t=this,e=i;return e=t.slice(),e.$initialize_dup(t),e},P.$$arity=0),t.defn(St,"$count",L=function(e){var r,n=this,a=arguments.length,i=a-0;i<0&&(i=0),r=new Array(i);for(var o=0;o<a;o++)r[o-0]=arguments[o];0===r.length&&n.$raise(t.const_get_relative(Ct,"ArgumentError"),"ArgumentError: wrong number of arguments (0 for 1+)");var s=$(r);return null===s?0:n.length-n.replace(new RegExp(s,"g"),"").length},L.$$arity=-1),t.defn(St,"$delete",M=function(e){var r,n=this,a=arguments.length,i=a-0;i<0&&(i=0),r=new Array(i);for(var o=0;o<a;o++)r[o-0]=arguments[o];0===r.length&&n.$raise(t.const_get_relative(Ct,"ArgumentError"),"ArgumentError: wrong number of arguments (0 for 1+)");var s=$(r);return null===s?n:n.replace(new RegExp(s,"g"),"")},M.$$arity=-1),t.defn(St,"$downcase",T=function(){return this.toLowerCase()},T.$$arity=0),t.defn(St,"$each_char",B=function(){var e,r=this,n=B.$$p,a=n||i;if(n&&(B.$$p=null),a===i)return c(r,"enum_for",["each_char"],(e=function(){return(e.$$s||this).$size()},e.$$s=r,e.$$arity=0,e));for(var o=0,s=r.length;o<s;o++)t.yield1(a,r.charAt(o));return r},B.$$arity=0),t.defn(St,"$each_line",j=function(e){var r=this,n=j.$$p,a=n||i;if(null==l["/"]&&(l["/"]=i),null==e&&(e=l["/"]),n&&(j.$$p=null),a===i)return r.$enum_for("each_line",e);if(e===i)return t.yield1(a,r),r;e=t.const_get_relative(Ct,"Opal").$coerce_to(e,t.const_get_relative(Ct,"String"),"to_str");var o,s,c,u,f,$,_;if(0===e.length){for(o=r.split(/(\n{2,})/),s=0,c=o.length;s<c;s+=2)(o[s]||o[s+1])&&t.yield1(a,(o[s]||"")+(o[s+1]||""));return r}for(f=r.$chomp(e),$=r.length!=f.length,_=f.split(e),s=0,u=_.length;s<u;s++)s<u-1||$?t.yield1(a,_[s]+e):t.yield1(a,_[s]);return r},j.$$arity=-1),t.defn(St,"$empty?",F=function(){return 0===this.length},F.$$arity=0),t.defn(St,"$end_with?",R=function(e){var r,n=this,a=arguments.length,i=a-0;i<0&&(i=0),r=new Array(i);for(var o=0;o<a;o++)r[o-0]=arguments[o];for(var s=0,c=r.length;s<c;s++){var l=t.const_get_relative(Ct,"Opal").$coerce_to(r[s],t.const_get_relative(Ct,"String"),"to_str").$to_s();if(n.length>=l.length&&n.substr(n.length-l.length,l.length)==l)return!0}return!1},R.$$arity=-1),t.alias(St,"eql?","=="),t.alias(St,"equal?","==="),t.defn(St,"$gsub",q=function(e,r){var n=this,a=q.$$p,o=a||i;if(a&&(q.$$p=null),void 0===r&&o===i)return n.$enum_for("gsub",e);var s,c,u="",f=i,$=0;for(e.$$is_regexp?e=new RegExp(e.source,"gm"+(e.ignoreCase?"i":"")):(e=t.const_get_relative(Ct,"Opal").$coerce_to(e,t.const_get_relative(Ct,"String"),"to_str"),e=new RegExp(e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gm"));;){if(null===(s=e.exec(n))){l["~"]=i,u+=n.slice($);break}f=t.const_get_relative(Ct,"MatchData").$new(e,s),void 0===r?c=o(s[0]):r.$$is_hash?c=r["$[]"](s[0]).$to_s():(r.$$is_string||(r=t.const_get_relative(Ct,"Opal").$coerce_to(r,t.const_get_relative(Ct,"String"),"to_str")),c=r.replace(/([\\]+)([0-9+&`'])/g,function(t,e,r){if(e.length%2==0)return t;switch(r){case"+":for(var a=s.length-1;a>0;a--)if(void 0!==s[a])return e.slice(1)+s[a];return"";case"&":return e.slice(1)+s[0];case"`":return e.slice(1)+n.slice(0,s.index);case"'":return e.slice(1)+n.slice(s.index+s[0].length);default:return e.slice(1)+(s[r]||"")}}).replace(/\\\\/g,"\\")),e.lastIndex===s.index?(u+=c+n.slice($,s.index+1),e.lastIndex+=1):u+=n.slice($,s.index)+c,$=e.lastIndex}return l["~"]=f,u},q.$$arity=-2),t.defn(St,"$hash",D=function(){return this.toString()},D.$$arity=0),t.defn(St,"$hex",z=function(){return this.$to_i(16)},z.$$arity=0),t.defn(St,"$include?",U=function(e){var r=this;return e.$$is_string||(e=t.const_get_relative(Ct,"Opal").$coerce_to(e,t.const_get_relative(Ct,"String"),"to_str")),-1!==r.indexOf(e)},U.$$arity=1),t.defn(St,"$index",H=function(e,r){var n,a,o,s=this;if(void 0===r)r=0;else if((r=t.const_get_relative(Ct,"Opal").$coerce_to(r,t.const_get_relative(Ct,"Integer"),"to_int"))<0&&(r+=s.length)<0)return i;if(e.$$is_regexp)for(o=new RegExp(e.source,"gm"+(e.ignoreCase?"i":""));;){if(null===(a=o.exec(s))){l["~"]=i,n=-1;break}if(a.index>=r){l["~"]=t.const_get_relative(Ct,"MatchData").$new(o,a),n=a.index;break}o.lastIndex=a.index+1}else e=t.const_get_relative(Ct,"Opal").$coerce_to(e,t.const_get_relative(Ct,"String"),"to_str"),n=0===e.length&&r>s.length?-1:s.indexOf(e,r);return-1===n?i:n},H.$$arity=-2),t.defn(St,"$inspect",G=function(){var t=this,e=/[\\\"\x00-\x1f\u007F-\u009F\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,r={"":"\\a","":"\\e","\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r","\v":"\\v",'"':'\\"',"\\":"\\\\"};return'"'+t.replace(e,function(t){return r[t]||"\\u"+("0000"+t.charCodeAt(0).toString(16).toUpperCase()).slice(-4)}).replace(/\#[\$\@\{]/g,"\\$&")+'"'},G.$$arity=0),t.defn(St,"$intern",Y=function(){return this},Y.$$arity=0),t.defn(St,"$lines",V=function(t){var e=this,r=V.$$p,n=r||i,a=i;return null==l["/"]&&(l["/"]=i),null==t&&(t=l["/"]),r&&(V.$$p=null),a=c(e,"each_line",[t],n.$to_proc()),s(n)?e:a.$to_a()},V.$$arity=-1),t.defn(St,"$length",Q=function(){return this.length},Q.$$arity=0),t.defn(St,"$ljust",X=function(e,r){var n=this;if(null==r&&(r=" "),e=t.const_get_relative(Ct,"Opal").$coerce_to(e,t.const_get_relative(Ct,"Integer"),"to_int"),r=t.const_get_relative(Ct,"Opal").$coerce_to(r,t.const_get_relative(Ct,"String"),"to_str").$to_s(),s(r["$empty?"]())&&n.$raise(t.const_get_relative(Ct,"ArgumentError"),"zero width padding"),s(e<=n.length))return n;var a=-1,i="";for(e-=n.length;++a<e;)i+=r;return n+i.slice(0,e)},X.$$arity=-2),t.defn(St,"$lstrip",J=function(){return this.replace(/^\s*/,"")},J.$$arity=0),t.defn(St,"$ascii_only?",W=function(){var t=this;return t.match(/[ -~\n]*/)[0]===t},W.$$arity=0),t.defn(St,"$match",K=function(e,r){var n,a=this,o=K.$$p,l=o||i;return o&&(K.$$p=null),s(s(n=t.const_get_relative(Ct,"String")["$==="](e))?n:e["$respond_to?"]("to_str"))&&(e=t.const_get_relative(Ct,"Regexp").$new(e.$to_str())),s(t.const_get_relative(Ct,"Regexp")["$==="](e))||a.$raise(t.const_get_relative(Ct,"TypeError"),"wrong argument type "+e.$class()+" (expected Regexp)"),c(e,"match",[a,r],l.$to_proc())},K.$$arity=-2),t.defn(St,"$next",Z=function(){var t=this,e=t.length;if(0===e)return"";for(var r,n=t,a=t.search(/[a-zA-Z0-9]/),i=!1;e--;){if((r=t.charCodeAt(e))>=48&&r<=57||r>=65&&r<=90||r>=97&&r<=122)switch(r){case 57:i=!0,r=48;break;case 90:i=!0,r=65;break;case 122:i=!0,r=97;break;default:i=!1,r+=1}else-1===a?255===r?(i=!0,r=0):(i=!1,r+=1):i=!0;if(n=n.slice(0,e)+String.fromCharCode(r)+n.slice(e+1),i&&(0===e||e===a)){switch(r){case 65:case 97:break;default:r+=1}n=0===e?String.fromCharCode(r)+n:n.slice(0,e)+String.fromCharCode(r)+n.slice(e),i=!1}if(!i)break}return n},Z.$$arity=0),t.defn(St,"$oct",tt=function(){var t,e=this,r=e,n=8;return/^\s*_/.test(r)?0:(r=r.replace(/^(\s*[+-]?)(0[bodx]?)(.+)$/i,function(t,e,r,a){switch(a.charAt(0)){case"+":case"-":return t;case"0":if("x"===a.charAt(1)&&"0x"===r)return t}switch(r){case"0b":n=2;break;case"0":case"0o":n=8;break;case"0d":n=10;break;case"0x":n=16}return e+a}),t=parseInt(r.replace(/_(?!_)/g,""),n),isNaN(t)?0:t)},tt.$$arity=0),t.defn(St,"$ord",et=function(){return this.charCodeAt(0)},et.$$arity=0),t.defn(St,"$partition",rt=function(e){var r,n,a=this;return e.$$is_regexp?(n=e.exec(a),null===n?r=-1:(t.const_get_relative(Ct,"MatchData").$new(e,n),e=n[0],r=n.index)):(e=t.const_get_relative(Ct,"Opal").$coerce_to(e,t.const_get_relative(Ct,"String"),"to_str"),r=a.indexOf(e)),-1===r?[a,"",""]:[a.slice(0,r),a.slice(r,r+e.length),a.slice(r+e.length)]},rt.$$arity=1),t.defn(St,"$reverse",nt=function(){return this.split("").reverse().join("")},nt.$$arity=0),t.defn(St,"$rindex",at=function(e,r){var n,a,o,s,c=this;if(void 0===r)r=c.length;else if((r=t.const_get_relative(Ct,"Opal").$coerce_to(r,t.const_get_relative(Ct,"Integer"),"to_int"))<0&&(r+=c.length)<0)return i;if(e.$$is_regexp){for(a=null,o=new RegExp(e.source,"gm"+(e.ignoreCase?"i":""));;){if(null===(s=o.exec(c))||s.index>r)break;a=s,o.lastIndex=a.index+1}null===a?(l["~"]=i,n=-1):(t.const_get_relative(Ct,"MatchData").$new(o,a),n=a.index)}else e=t.const_get_relative(Ct,"Opal").$coerce_to(e,t.const_get_relative(Ct,"String"),"to_str"),n=c.lastIndexOf(e,r);return-1===n?i:n},at.$$arity=-2),t.defn(St,"$rjust",it=function(e,r){var n=this;if(null==r&&(r=" "),e=t.const_get_relative(Ct,"Opal").$coerce_to(e,t.const_get_relative(Ct,"Integer"),"to_int"),r=t.const_get_relative(Ct,"Opal").$coerce_to(r,t.const_get_relative(Ct,"String"),"to_str").$to_s(),s(r["$empty?"]())&&n.$raise(t.const_get_relative(Ct,"ArgumentError"),"zero width padding"),s(e<=n.length))return n;var a=Math.floor(e-n.length),i=Math.floor(a/r.length),o=Array(i+1).join(r),c=a-o.length;return o+r.slice(0,c)+n},it.$$arity=-2),t.defn(St,"$rpartition",ot=function(e){var r,n,a,i,o=this;if(e.$$is_regexp){for(n=null,a=new RegExp(e.source,"gm"+(e.ignoreCase?"i":""));;){if(null===(i=a.exec(o)))break;n=i,a.lastIndex=n.index+1}null===n?r=-1:(t.const_get_relative(Ct,"MatchData").$new(a,n),e=n[0],r=n.index)}else e=t.const_get_relative(Ct,"Opal").$coerce_to(e,t.const_get_relative(Ct,"String"),"to_str"),r=o.lastIndexOf(e);return-1===r?["","",o]:[o.slice(0,r),o.slice(r,r+e.length),o.slice(r+e.length)]},ot.$$arity=1),t.defn(St,"$rstrip",st=function(){return this.replace(/[\s\u0000]*$/,"")},st.$$arity=0),t.defn(St,"$scan",ct=function(e){var r=this,n=ct.$$p,a=n||i;n&&(ct.$$p=null);var o,s=[],c=i;for(e.$$is_regexp?e=new RegExp(e.source,"gm"+(e.ignoreCase?"i":"")):(e=t.const_get_relative(Ct,"Opal").$coerce_to(e,t.const_get_relative(Ct,"String"),"to_str"),e=new RegExp(e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gm"));null!=(o=e.exec(r));)c=t.const_get_relative(Ct,"MatchData").$new(e,o),a===i?1==o.length?s.push(o[0]):s.push(c.$captures()):1==o.length?a(o[0]):a.call(r,c.$captures()),e.lastIndex===o.index&&(e.lastIndex+=1);return l["~"]=c,a!==i?r:s},ct.$$arity=1),t.alias(St,"size","length"),t.alias(St,"slice","[]"),t.defn(St,"$split",lt=function(e,r){var n,a=this;if(null==l[";"]&&(l[";"]=i),0===a.length)return[];if(void 0===r)r=0;else if(1===(r=t.const_get_relative(Ct,"Opal")["$coerce_to!"](r,t.const_get_relative(Ct,"Integer"),"to_int")))return[a];void 0!==e&&e!==i||(e=s(n=l[";"])?n:" ");var o,c,u,f=[],$=a.toString(),_=0;if(e.$$is_regexp?e=new RegExp(e.source,"gm"+(e.ignoreCase?"i":"")):(e=t.const_get_relative(Ct,"Opal").$coerce_to(e,t.const_get_relative(Ct,"String"),"to_str").$to_s()," "===e?(e=/\s+/gm,$=$.replace(/^\s+/,"")):e=new RegExp(e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gm")),f=$.split(e),1===f.length&&f[0]===$)return f;for(;-1!==(c=f.indexOf(void 0));)f.splice(c,1);if(0===r){for(;""===f[f.length-1];)f.length-=1;return f}if(o=e.exec($),r<0){if(null!==o&&""===o[0]&&-1===e.source.indexOf("(?="))for(c=0,u=o.length;c<u;c++)f.push("");return f}if(null!==o&&""===o[0])return f.splice(r-1,f.length-1,f.slice(r-1).join("")),f;if(r>=f.length)return f;for(c=0;null!==o&&(c++,_=e.lastIndex,c+1!==r);)o=e.exec($);return f.splice(r-1,f.length-1,$.slice(_)),f},lt.$$arity=-1),t.defn(St,"$squeeze",ut=function(t){var e,r=this,n=arguments.length,a=n-0;a<0&&(a=0),e=new Array(a);for(var i=0;i<n;i++)e[i-0]=arguments[i];if(0===e.length)return r.replace(/(.)\1+/g,"$1");var o=$(e);return null===o?r:r.replace(new RegExp("("+o+")\\1+","g"),"$1")},ut.$$arity=-1),t.defn(St,"$start_with?",ft=function(e){var r,n=this,a=arguments.length,i=a-0;i<0&&(i=0),r=new Array(i);for(var o=0;o<a;o++)r[o-0]=arguments[o];for(var s=0,c=r.length;s<c;s++){var l=t.const_get_relative(Ct,"Opal").$coerce_to(r[s],t.const_get_relative(Ct,"String"),"to_str").$to_s();if(0===n.indexOf(l))return!0}return!1},ft.$$arity=-1),t.defn(St,"$strip",$t=function(){return this.replace(/^\s*/,"").replace(/[\s\u0000]*$/,"")},$t.$$arity=0),t.defn(St,"$sub",_t=function(e,r){var n=this,a=_t.$$p,o=a||i;a&&(_t.$$p=null),e.$$is_regexp||(e=t.const_get_relative(Ct,"Opal").$coerce_to(e,t.const_get_relative(Ct,"String"),"to_str"),e=new RegExp(e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")));var s=e.exec(n);return null===s?(l["~"]=i,n.toString()):(t.const_get_relative(Ct,"MatchData").$new(e,s),void 0===r?(o===i&&n.$raise(t.const_get_relative(Ct,"ArgumentError"),"wrong number of arguments (1 for 2)"),n.slice(0,s.index)+o(s[0])+n.slice(s.index+s[0].length)):r.$$is_hash?n.slice(0,s.index)+r["$[]"](s[0]).$to_s()+n.slice(s.index+s[0].length):(r=t.const_get_relative(Ct,"Opal").$coerce_to(r,t.const_get_relative(Ct,"String"),"to_str"),r=r.replace(/([\\]+)([0-9+&`'])/g,function(t,e,r){if(e.length%2==0)return t;switch(r){case"+":for(var a=s.length-1;a>0;a--)if(void 0!==s[a])return e.slice(1)+s[a];return"";case"&":return e.slice(1)+s[0];case"`":return e.slice(1)+n.slice(0,s.index);case"'":return e.slice(1)+n.slice(s.index+s[0].length);default:return e.slice(1)+(s[r]||"")}}).replace(/\\\\/g,"\\"),n.slice(0,s.index)+r+n.slice(s.index+s[0].length)))},_t.$$arity=-2),t.alias(St,"succ","next"),t.defn(St,"$sum",dt=function(e){var r=this;null==e&&(e=16),e=t.const_get_relative(Ct,"Opal").$coerce_to(e,t.const_get_relative(Ct,"Integer"),"to_int");for(var n=0,a=r.length,i=0;i<a;i++)n+=r.charCodeAt(i);return e<=0?n:n&Math.pow(2,e)-1},dt.$$arity=-1),t.defn(St,"$swapcase",pt=function(){var t=this,e=t.replace(/([a-z]+)|([A-Z]+)/g,function(t,e,r){return e?t.toUpperCase():t.toLowerCase()});return t.constructor===String?e:t.$class().$new(e)},pt.$$arity=0),t.defn(St,"$to_f",ht=function(){var t=this;if("_"===t.charAt(0))return 0;var e=parseFloat(t.replace(/_/g,""));return isNaN(e)||e==1/0||e==-1/0?0:e},ht.$$arity=0),t.defn(St,"$to_i",gt=function(e){var r=this;null==e&&(e=10);var n,a=r.toLowerCase(),i=t.const_get_relative(Ct,"Opal").$coerce_to(e,t.const_get_relative(Ct,"Integer"),"to_int");return(1===i||i<0||i>36)&&r.$raise(t.const_get_relative(Ct,"ArgumentError"),"invalid radix "+i),/^\s*_/.test(a)?0:(a=a.replace(/^(\s*[+-]?)(0[bodx]?)(.+)$/,function(t,e,r,n){switch(n.charAt(0)){case"+":case"-":return t;case"0":if("x"===n.charAt(1)&&"0x"===r&&(0===i||16===i))return t}switch(r){case"0b":if(0===i||2===i)return i=2,e+n;break;case"0":case"0o":if(0===i||8===i)return i=8,e+n;break;case"0d":if(0===i||10===i)return i=10,e+n;break;case"0x":if(0===i||16===i)return i=16,e+n}return t}),n=parseInt(a.replace(/_(?!_)/g,""),i),isNaN(n)?0:n)},gt.$$arity=-1),t.defn(St,"$to_proc",mt=function(){var e,r=this,n=i;return n=r.valueOf(),c(r,"proc",[],(e=function(r){var a,o,s=e.$$s||this;(a=e.$$p||i)&&(e.$$p=null);var c=arguments.length,l=c-0;l<0&&(l=0),o=new Array(l);for(var u=0;u<c;u++)o[u-0]=arguments[u];0===o.length&&s.$raise(t.const_get_relative(Ct,"ArgumentError"),"no receiver given");var f=o.shift();return null==f&&(f=i),t.send(f,n,o,a)},e.$$s=r,e.$$arity=-1,e))},mt.$$arity=0),t.defn(St,"$to_s",vt=function(){return this.toString()},vt.$$arity=0),t.alias(St,"to_str","to_s"),t.alias(St,"to_sym","intern"),t.defn(St,"$tr",yt=function(e,r){var n=this;if(e=t.const_get_relative(Ct,"Opal").$coerce_to(e,t.const_get_relative(Ct,"String"),"to_str").$to_s(),r=t.const_get_relative(Ct,"Opal").$coerce_to(r,t.const_get_relative(Ct,"String"),"to_str").$to_s(),0==e.length||e===r)return n;var a,i,o,s,c,l,u,f={},$=e.split(""),_=$.length,d=r.split(""),p=d.length,h=!1,g=null;"^"===$[0]&&$.length>1&&(h=!0,$.shift(),g=d[p-1],_-=1);var m=[],v=null;for(i=!1,a=0;a<_;a++)if(s=$[a],null==v)v=s,m.push(s);else if("-"===s)"-"===v?(m.push("-"),m.push("-")):a==_-1?m.push("-"):i=!0;else if(i){for(c=v.charCodeAt(0),l=s.charCodeAt(0),c>l&&n.$raise(t.const_get_relative(Ct,"ArgumentError"),'invalid range "'+String.fromCharCode(c)+"-"+String.fromCharCode(l)+'" in string transliteration'),o=c+1;o<l;o++)m.push(String.fromCharCode(o));m.push(s),i=null,v=null}else m.push(s);if($=m,_=$.length,h)for(a=0;a<_;a++)f[$[a]]=!0;else{if(p>0){var y=[],b=null;for(i=!1,a=0;a<p;a++)if(s=d[a],null==b)b=s,y.push(s);else if("-"===s)"-"===b?(y.push("-"),y.push("-")):a==p-1?y.push("-"):i=!0;else if(i){for(c=b.charCodeAt(0),l=s.charCodeAt(0),c>l&&n.$raise(t.const_get_relative(Ct,"ArgumentError"),'invalid range "'+String.fromCharCode(c)+"-"+String.fromCharCode(l)+'" in string transliteration'),o=c+1;o<l;o++)y.push(String.fromCharCode(o));y.push(s),i=null,b=null}else y.push(s);d=y,p=d.length}var w=_-p;if(w>0){var x=p>0?d[p-1]:"";for(a=0;a<w;a++)d.push(x)}for(a=0;a<_;a++)f[$[a]]=d[a]}var A="";for(a=0,u=n.length;a<u;a++){s=n.charAt(a);var k=f[s];A+=h?null==k?g:s:null!=k?k:s}return A},yt.$$arity=2),t.defn(St,"$tr_s",bt=function(e,r){var n=this;if(e=t.const_get_relative(Ct,"Opal").$coerce_to(e,t.const_get_relative(Ct,"String"),"to_str").$to_s(),r=t.const_get_relative(Ct,"Opal").$coerce_to(r,t.const_get_relative(Ct,"String"),"to_str").$to_s(),0==e.length)return n;var a,i,o,s,c,l,u,f={},$=e.split(""),_=$.length,d=r.split(""),p=d.length,h=!1,g=null;"^"===$[0]&&$.length>1&&(h=!0,$.shift(),g=d[p-1],_-=1);var m=[],v=null;for(i=!1,a=0;a<_;a++)if(s=$[a],null==v)v=s,m.push(s);else if("-"===s)"-"===v?(m.push("-"),m.push("-")):a==_-1?m.push("-"):i=!0;else if(i){for(c=v.charCodeAt(0),l=s.charCodeAt(0),c>l&&n.$raise(t.const_get_relative(Ct,"ArgumentError"),'invalid range "'+String.fromCharCode(c)+"-"+String.fromCharCode(l)+'" in string transliteration'),o=c+1;o<l;o++)m.push(String.fromCharCode(o));m.push(s),i=null,v=null}else m.push(s);if($=m,_=$.length,h)for(a=0;a<_;a++)f[$[a]]=!0;else{if(p>0){var y=[];for(i=!1,a=0;a<p;a++)if(s=d[a],null==v)v=s,y.push(s);else if("-"===s)a==p-1?y.push("-"):i=!0;else if(i){for(c=v.charCodeAt(0),l=s.charCodeAt(0),c>l&&n.$raise(t.const_get_relative(Ct,"ArgumentError"),'invalid range "'+String.fromCharCode(c)+"-"+String.fromCharCode(l)+'" in string transliteration'),o=c+1;o<l;o++)y.push(String.fromCharCode(o));y.push(s),i=null,v=null}else y.push(s);d=y,p=d.length}var b=_-p;if(b>0){var w=p>0?d[p-1]:"";for(a=0;a<b;a++)d.push(w)}for(a=0;a<_;a++)f[$[a]]=d[a]}var x="",A=null;for(a=0,u=n.length;a<u;a++){s=n.charAt(a);var k=f[s];h?null==k?null==A&&(x+=g,A=!0):(x+=s,A=null):null!=k?null!=A&&A===k||(x+=k,A=k):(x+=s,A=null)}return x},bt.$$arity=2),t.defn(St,"$upcase",wt=function(){return this.toUpperCase()},wt.$$arity=0),t.defn(St,"$upto",xt=function(e,r){var n=this,a=xt.$$p,o=a||i;if(null==r&&(r=!1),a&&(xt.$$p=null),o===i)return n.$enum_for("upto",e,r);e=t.const_get_relative(Ct,"Opal").$coerce_to(e,t.const_get_relative(Ct,"String"),"to_str");var s,c,l=n.toString();if(1===l.length&&1===e.length)for(s=l.charCodeAt(0),c=e.charCodeAt(0);s<=c&&(!r||s!==c);)o(String.fromCharCode(s)),s+=1;else if(parseInt(l,10).toString()===l&&parseInt(e,10).toString()===e)for(s=parseInt(l,10),c=parseInt(e,10);s<=c&&(!r||s!==c);)o(s.toString()),s+=1;else for(;l.length<=e.length&&l<=e&&(!r||l!==e);)o(l),l=l.$succ();return n},xt.$$arity=-2),t.defn(St,"$instance_variables",At=function(){return[]},At.$$arity=0),t.defs(St,"$_load",kt=function(e){var r,n=this,a=arguments.length,i=a-0;i<0&&(i=0),r=new Array(i);for(var o=0;o<a;o++)r[o-0]=arguments[o];return c(n,"new",t.to_a(r))},kt.$$arity=-1),t.defn(St,"$unpack",Et=function(e){function r(t){var e,r,n=t.length,a=[];for(e=0;e<n;e++)r=t.charCodeAt(e),a.push(r);return a}var n=this,a=i;return function(){return a=e,"U*"["$==="](a)||"C*"["$==="](a)?r(n):n.$raise(t.const_get_relative(Ct,"NotImplementedError"))}()},Et.$$arity=1)}(a[0],String,a),t.const_set(a[0],"Symbol",t.const_get_relative(a,"String"))},Opal.modules["corelib/enumerable"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t>e:t["$>"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t*e:t["$*"](e)}function n(t,e){return"number"==typeof t&&"number"==typeof e?t<e:t["$<"](e)}function a(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}function i(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}function o(t,e){return"number"==typeof t&&"number"==typeof e?t/e:t["$/"](e)}var s=(t.top,[]),c=t.nil,l=(t.breaker,t.slice,t.module),u=t.send,f=t.truthy,$=t.falsy,_=t.hash2
;return t.add_stubs(["$each","$destructure","$to_enum","$enumerator_size","$new","$yield","$raise","$slice_when","$!","$enum_for","$flatten","$map","$warn","$proc","$==","$nil?","$respond_to?","$coerce_to!","$>","$*","$coerce_to","$try_convert","$<","$+","$-","$ceil","$/","$size","$===","$<<","$[]","$[]=","$inspect","$__send__","$<=>","$first","$reverse","$sort","$to_proc","$compare","$call","$dup","$to_a","$lambda","$sort!","$map!","$has_key?","$values","$zip"]),function(s,d){var p,h,g,m,v,y,b,w,x,A,k,E,S,N,C,I,O,P,L,M,T,B,j,F,R,q,D,z,U,H,G,Y,V,Q,X,J,W,K,Z,tt,et,rt,nt,at,it,ot,st,ct,lt,ut=p=l(s,"Enumerable"),ft=(ut.$$proto,[ut].concat(d));t.defn(ut,"$all?",h=function(){try{var e,r,n=this,a=h.$$p,i=a||c;return a&&(h.$$p=null),i!==c?u(n,"each",[],(e=function(r){var n,a=(e.$$s,arguments.length),o=a-0;o<0&&(o=0),n=new Array(o);for(var s=0;s<a;s++)n[s-0]=arguments[s];if(f(t.yieldX(i,t.to_a(n))))return c;t.ret(!1)},e.$$s=n,e.$$arity=-1,e)):u(n,"each",[],(r=function(e){var n,a=(r.$$s,arguments.length),i=a-0;i<0&&(i=0),n=new Array(i);for(var o=0;o<a;o++)n[o-0]=arguments[o];if(f(t.const_get_relative(ft,"Opal").$destructure(n)))return c;t.ret(!1)},r.$$s=n,r.$$arity=-1,r)),!0}catch(e){if(e===t.returner)return e.$v;throw e}},h.$$arity=0),t.defn(ut,"$any?",g=function(){try{var e,r,n=this,a=g.$$p,i=a||c;return a&&(g.$$p=null),i!==c?u(n,"each",[],(e=function(r){var n,a=(e.$$s,arguments.length),o=a-0;o<0&&(o=0),n=new Array(o);for(var s=0;s<a;s++)n[s-0]=arguments[s];if(!f(t.yieldX(i,t.to_a(n))))return c;t.ret(!0)},e.$$s=n,e.$$arity=-1,e)):u(n,"each",[],(r=function(e){var n,a=(r.$$s,arguments.length),i=a-0;i<0&&(i=0),n=new Array(i);for(var o=0;o<a;o++)n[o-0]=arguments[o];if(!f(t.const_get_relative(ft,"Opal").$destructure(n)))return c;t.ret(!0)},r.$$s=n,r.$$arity=-1,r)),!1}catch(e){if(e===t.returner)return e.$v;throw e}},g.$$arity=0),t.defn(ut,"$chunk",m=function(){var e,r,n=this,a=m.$$p,i=a||c;return a&&(m.$$p=null),i===c?u(n,"to_enum",["chunk"],(e=function(){return(e.$$s||this).$enumerator_size()},e.$$s=n,e.$$arity=0,e)):u(t.const_get_qualified("::","Enumerator"),"new",[],(r=function(e){function n(){s.length>0&&e.$yield(o,s)}var a=r.$$s||this;null==e&&(e=c);var o=c,s=[];a.$each.$$p=function(e){var r=t.yield1(i,e);r===c?(n(),s=[],o=c):(o===c||o===r?s.push(e):(n(),s=[e]),o=r)},a.$each(),n()},r.$$s=n,r.$$arity=1,r))},m.$$arity=0),t.defn(ut,"$chunk_while",v=function(){var e,r=this,n=v.$$p,a=n||c;return n&&(v.$$p=null),a!==c||r.$raise(t.const_get_relative(ft,"ArgumentError"),"no block given"),u(r,"slice_when",[],(e=function(r,n){e.$$s;return null==r&&(r=c),null==n&&(n=c),t.yieldX(a,[r,n])["$!"]()},e.$$s=r,e.$$arity=2,e))},v.$$arity=0),t.defn(ut,"$collect",y=function(){var e,r=this,n=y.$$p,a=n||c;if(n&&(y.$$p=null),a===c)return u(r,"enum_for",["collect"],(e=function(){return(e.$$s||this).$enumerator_size()},e.$$s=r,e.$$arity=0,e));var i=[];return r.$each.$$p=function(){var e=t.yieldX(a,arguments);i.push(e)},r.$each(),i},y.$$arity=0),t.defn(ut,"$collect_concat",b=function(){var e,r,n=this,a=b.$$p,i=a||c;return a&&(b.$$p=null),i===c?u(n,"enum_for",["collect_concat"],(e=function(){return(e.$$s||this).$enumerator_size()},e.$$s=n,e.$$arity=0,e)):u(n,"map",[],(r=function(e){r.$$s;return null==e&&(e=c),t.yield1(i,e)},r.$$s=n,r.$$arity=1,r)).$flatten(1)},b.$$arity=0),t.defn(ut,"$count",w=function(e){var r,n,a,i=this,o=w.$$p,s=o||c,l=c;return o&&(w.$$p=null),l=0,null!=e&&s!==c&&i.$warn("warning: given block not used"),f(null!=e)?s=u(i,"proc",[],(r=function(n){var a,i=(r.$$s,arguments.length),o=i-0;o<0&&(o=0),a=new Array(o);for(var s=0;s<i;s++)a[s-0]=arguments[s];return t.const_get_relative(ft,"Opal").$destructure(a)["$=="](e)},r.$$s=i,r.$$arity=-1,r)):f(s["$nil?"]())&&(s=u(i,"proc",[],(n=function(){n.$$s;return!0},n.$$s=i,n.$$arity=0,n))),u(i,"each",[],(a=function(e){var r,n=(a.$$s,arguments.length),i=n-0;i<0&&(i=0),r=new Array(i);for(var o=0;o<n;o++)r[o-0]=arguments[o];return f(t.yieldX(s,r))?l++:c},a.$$s=i,a.$$arity=-1,a)),l},w.$$arity=-1),t.defn(ut,"$cycle",x=function(n){var a,i=this,o=x.$$p,s=o||c;if(null==n&&(n=c),o&&(x.$$p=null),s===c)return u(i,"enum_for",["cycle",n],(a=function(){var i=a.$$s||this;return n["$=="](c)?f(i["$respond_to?"]("size"))?t.const_get_qualified(t.const_get_relative(ft,"Float"),"INFINITY"):c:(n=t.const_get_relative(ft,"Opal")["$coerce_to!"](n,t.const_get_relative(ft,"Integer"),"to_int"),f(e(n,0))?r(i.$enumerator_size(),n):0)},a.$$s=i,a.$$arity=0,a));if(f(n["$nil?"]()));else if(n=t.const_get_relative(ft,"Opal")["$coerce_to!"](n,t.const_get_relative(ft,"Integer"),"to_int"),f(n<=0))return c;var l,$,_=[];if(i.$each.$$p=function(){var e=t.const_get_relative(ft,"Opal").$destructure(arguments);t.yield1(s,e);_.push(e)},i.$each(),0===_.length)return c;if(n===c)for(;;)for(l=0,$=_.length;l<$;l++)t.yield1(s,_[l]);else for(;n>1;){for(l=0,$=_.length;l<$;l++)t.yield1(s,_[l]);n--}},x.$$arity=-1),t.defn(ut,"$detect",A=function(e){try{var r,n=this,a=A.$$p,i=a||c;return a&&(A.$$p=null),i===c?n.$enum_for("detect",e):(u(n,"each",[],(r=function(e){var n,a=(r.$$s,c),o=arguments.length,s=o-0;s<0&&(s=0),n=new Array(s);for(var l=0;l<o;l++)n[l-0]=arguments[l];if(a=t.const_get_relative(ft,"Opal").$destructure(n),!f(t.yield1(i,a)))return c;t.ret(a)},r.$$s=n,r.$$arity=-1,r)),void 0!==e?"function"==typeof e?e():e:c)}catch(e){if(e===t.returner)return e.$v;throw e}},A.$$arity=-1),t.defn(ut,"$drop",k=function(e){var r=this;e=t.const_get_relative(ft,"Opal").$coerce_to(e,t.const_get_relative(ft,"Integer"),"to_int"),f(e<0)&&r.$raise(t.const_get_relative(ft,"ArgumentError"),"attempt to drop negative size");var n=[],a=0;return r.$each.$$p=function(){e<=a&&n.push(t.const_get_relative(ft,"Opal").$destructure(arguments)),a++},r.$each(),n},k.$$arity=1),t.defn(ut,"$drop_while",E=function(){var e=this,r=E.$$p,n=r||c;if(r&&(E.$$p=null),n===c)return e.$enum_for("drop_while");var a=[],i=!0;return e.$each.$$p=function(){var e=t.const_get_relative(ft,"Opal").$destructure(arguments);if(i){var r=t.yield1(n,e);$(r)&&(i=!1,a.push(e))}else a.push(e)},e.$each(),a},E.$$arity=0),t.defn(ut,"$each_cons",S=function(e){var r,o=this,s=S.$$p,l=s||c;if(s&&(S.$$p=null),f(1!=arguments.length)&&o.$raise(t.const_get_relative(ft,"ArgumentError"),"wrong number of arguments ("+arguments.length+" for 1)"),e=t.const_get_relative(ft,"Opal").$try_convert(e,t.const_get_relative(ft,"Integer"),"to_int"),f(e<=0)&&o.$raise(t.const_get_relative(ft,"ArgumentError"),"invalid size"),l===c)return u(o,"enum_for",["each_cons",e],(r=function(){var t,o=r.$$s||this,s=c;return s=o.$enumerator_size(),f(s["$nil?"]())?c:f(f(t=s["$=="](0))?t:n(s,e))?0:a(i(s,e),1)},r.$$s=o,r.$$arity=0,r));var $=[],_=c;return o.$each.$$p=function(){var r=t.const_get_relative(ft,"Opal").$destructure(arguments);$.push(r),$.length>e&&$.shift(),$.length==e&&t.yield1(l,$.slice(0,e))},o.$each(),_},S.$$arity=1),t.defn(ut,"$each_entry",N=function(e){var r,n,a=this,i=N.$$p,o=i||c,s=arguments.length,l=s-0;l<0&&(l=0),n=new Array(l);for(var f=0;f<s;f++)n[f-0]=arguments[f];return i&&(N.$$p=null),o===c?u(a,"to_enum",["each_entry"].concat(t.to_a(n)),(r=function(){return(r.$$s||this).$enumerator_size()},r.$$s=a,r.$$arity=0,r)):(a.$each.$$p=function(){var e=t.const_get_relative(ft,"Opal").$destructure(arguments);t.yield1(o,e)},a.$each.apply(a,n),a)},N.$$arity=-1),t.defn(ut,"$each_slice",C=function(e){var r,n=this,a=C.$$p,i=a||c;if(a&&(C.$$p=null),e=t.const_get_relative(ft,"Opal").$coerce_to(e,t.const_get_relative(ft,"Integer"),"to_int"),f(e<=0)&&n.$raise(t.const_get_relative(ft,"ArgumentError"),"invalid slice size"),i===c)return u(n,"enum_for",["each_slice",e],(r=function(){var t=r.$$s||this;return f(t["$respond_to?"]("size"))?o(t.$size(),e).$ceil():c},r.$$s=n,r.$$arity=0,r));var s=[];return n.$each.$$p=function(){var r=t.const_get_relative(ft,"Opal").$destructure(arguments);s.push(r),s.length===e&&(t.yield1(i,s),s=[])},n.$each(),s.length>0&&t.yield1(i,s),c},C.$$arity=1),t.defn(ut,"$each_with_index",I=function(e){var r,n,a=this,i=I.$$p,o=i||c,s=arguments.length,l=s-0;l<0&&(l=0),n=new Array(l);for(var f=0;f<s;f++)n[f-0]=arguments[f];if(i&&(I.$$p=null),o===c)return u(a,"enum_for",["each_with_index"].concat(t.to_a(n)),(r=function(){return(r.$$s||this).$enumerator_size()},r.$$s=a,r.$$arity=0,r));var $=0;return a.$each.$$p=function(){var e=t.const_get_relative(ft,"Opal").$destructure(arguments);o(e,$),$++},a.$each.apply(a,n),a},I.$$arity=-1),t.defn(ut,"$each_with_object",O=function(e){var r,n=this,a=O.$$p,i=a||c;if(a&&(O.$$p=null),i===c)return u(n,"enum_for",["each_with_object",e],(r=function(){return(r.$$s||this).$enumerator_size()},r.$$s=n,r.$$arity=0,r));return n.$each.$$p=function(){var r=t.const_get_relative(ft,"Opal").$destructure(arguments);i(r,e)},n.$each(),e},O.$$arity=1),t.defn(ut,"$entries",P=function(e){var r,n=this,a=arguments.length,i=a-0;i<0&&(i=0),r=new Array(i);for(var o=0;o<a;o++)r[o-0]=arguments[o];var s=[];return n.$each.$$p=function(){s.push(t.const_get_relative(ft,"Opal").$destructure(arguments))},n.$each.apply(n,r),s},P.$$arity=-1),t.alias(ut,"find","detect"),t.defn(ut,"$find_all",L=function(){var e,r=this,n=L.$$p,a=n||c;if(n&&(L.$$p=null),a===c)return u(r,"enum_for",["find_all"],(e=function(){return(e.$$s||this).$enumerator_size()},e.$$s=r,e.$$arity=0,e));var i=[];return r.$each.$$p=function(){var e=t.const_get_relative(ft,"Opal").$destructure(arguments),r=t.yield1(a,e);f(r)&&i.push(e)},r.$each(),i},L.$$arity=0),t.defn(ut,"$find_index",M=function(e){try{var r,n,a=this,i=M.$$p,o=i||c,s=c;return i&&(M.$$p=null),f(void 0===e&&o===c)?a.$enum_for("find_index"):(null!=e&&o!==c&&a.$warn("warning: given block not used"),s=0,f(null!=e)?u(a,"each",[],(r=function(n){var a,i=(r.$$s,arguments.length),o=i-0;o<0&&(o=0),a=new Array(o);for(var c=0;c<i;c++)a[c-0]=arguments[c];return t.const_get_relative(ft,"Opal").$destructure(a)["$=="](e)&&t.ret(s),s+=1},r.$$s=a,r.$$arity=-1,r)):u(a,"each",[],(n=function(e){var r,a=(n.$$s,arguments.length),i=a-0;i<0&&(i=0),r=new Array(i);for(var c=0;c<a;c++)r[c-0]=arguments[c];return f(t.yieldX(o,t.to_a(r)))&&t.ret(s),s+=1},n.$$s=a,n.$$arity=-1,n)),c)}catch(e){if(e===t.returner)return e.$v;throw e}},M.$$arity=-1),t.defn(ut,"$first",T=function(e){try{var r,n,a=this,i=c,o=c;return f(void 0===e)?u(a,"each",[],(r=function(e){r.$$s;null==e&&(e=c),t.ret(e)},r.$$s=a,r.$$arity=1,r)):(i=[],e=t.const_get_relative(ft,"Opal").$coerce_to(e,t.const_get_relative(ft,"Integer"),"to_int"),f(e<0)&&a.$raise(t.const_get_relative(ft,"ArgumentError"),"attempt to take negative size"),f(0==e)?[]:(o=0,u(a,"each",[],(n=function(r){var a,s=(n.$$s,arguments.length),l=s-0;l<0&&(l=0),a=new Array(l);for(var u=0;u<s;u++)a[u-0]=arguments[u];if(i.push(t.const_get_relative(ft,"Opal").$destructure(a)),!f(e<=++o))return c;t.ret(i)},n.$$s=a,n.$$arity=-1,n)),i))}catch(e){if(e===t.returner)return e.$v;throw e}},T.$$arity=-1),t.alias(ut,"flat_map","collect_concat"),t.defn(ut,"$grep",B=function(e){var r=this,n=B.$$p,a=n||c;n&&(B.$$p=null);var i=[];return r.$each.$$p=a!==c?function(){var r=t.const_get_relative(ft,"Opal").$destructure(arguments),n=e["$==="](r);f(n)&&(n=t.yield1(a,r),i.push(n))}:function(){var r=t.const_get_relative(ft,"Opal").$destructure(arguments),n=e["$==="](r);f(n)&&i.push(r)},r.$each(),i},B.$$arity=1),t.defn(ut,"$grep_v",j=function(e){var r=this,n=j.$$p,a=n||c;n&&(j.$$p=null);var i=[];return r.$each.$$p=a!==c?function(){var r=t.const_get_relative(ft,"Opal").$destructure(arguments),n=e["$==="](r);$(n)&&(n=t.yield1(a,r),i.push(n))}:function(){var r=t.const_get_relative(ft,"Opal").$destructure(arguments),n=e["$==="](r);$(n)&&i.push(r)},r.$each(),i},j.$$arity=1),t.defn(ut,"$group_by",F=function(){var e,r,n=this,a=F.$$p,o=a||c,s=c,l=c;if(a&&(F.$$p=null),o===c)return u(n,"enum_for",["group_by"],(e=function(){return(e.$$s||this).$enumerator_size()},e.$$s=n,e.$$arity=0,e));s=t.const_get_relative(ft,"Hash").$new();return n.$each.$$p=function(){var e=t.const_get_relative(ft,"Opal").$destructure(arguments),n=t.yield1(o,e);(f(r=s["$[]"](n))?r:(l=[n,[]],u(s,"[]=",t.to_a(l)),l[i(l.length,1)]))["$<<"](e)},n.$each(),s},F.$$arity=0),t.defn(ut,"$include?",R=function(e){try{var r,n=this;return u(n,"each",[],(r=function(n){var a,i=(r.$$s,arguments.length),o=i-0;o<0&&(o=0),a=new Array(o);for(var s=0;s<i;s++)a[s-0]=arguments[s];if(!t.const_get_relative(ft,"Opal").$destructure(a)["$=="](e))return c;t.ret(!0)},r.$$s=n,r.$$arity=-1,r)),!1}catch(e){if(e===t.returner)return e.$v;throw e}},R.$$arity=1),t.defn(ut,"$inject",q=function(e,r){var n=this,a=q.$$p,i=a||c;a&&(q.$$p=null);var o=e;return i!==c&&void 0===r?n.$each.$$p=function(){var e=t.const_get_relative(ft,"Opal").$destructure(arguments);if(void 0===o)return void(o=e);e=t.yieldX(i,[o,e]),o=e}:(void 0===r&&(t.const_get_relative(ft,"Symbol")["$==="](e)||n.$raise(t.const_get_relative(ft,"TypeError"),e.$inspect()+" is not a Symbol"),r=e,o=void 0),n.$each.$$p=function(){var e=t.const_get_relative(ft,"Opal").$destructure(arguments);if(void 0===o)return void(o=e);o=o.$__send__(r,e)}),n.$each(),void 0==o?c:o},q.$$arity=-1),t.defn(ut,"$lazy",D=function(){var e,r=this;return u(t.const_get_qualified(t.const_get_relative(ft,"Enumerator"),"Lazy"),"new",[r,r.$enumerator_size()],(e=function(r,n){var a,i=(e.$$s,arguments.length),o=i-1;o<0&&(o=0),a=new Array(o);for(var s=1;s<i;s++)a[s-1]=arguments[s];return null==r&&(r=c),u(r,"yield",t.to_a(a))},e.$$s=r,e.$$arity=-2,e))},D.$$arity=0),t.defn(ut,"$enumerator_size",z=function(){var t=this;return f(t["$respond_to?"]("size"))?t.$size():c},z.$$arity=0),t.alias(ut,"map","collect"),t.defn(ut,"$max",U=function(e){var r=this,n=U.$$p,a=n||c;if(n&&(U.$$p=null),void 0===e||e===c){var i,o;return r.$each.$$p=function(){var e=t.const_get_relative(ft,"Opal").$destructure(arguments);if(void 0===i)return void(i=e);o=a!==c?t.yieldX(a,[e,i]):e["$<=>"](i),o===c&&r.$raise(t.const_get_relative(ft,"ArgumentError"),"comparison failed"),o>0&&(i=e)},r.$each(),void 0===i?c:i}return e=t.const_get_relative(ft,"Opal").$coerce_to(e,t.const_get_relative(ft,"Integer"),"to_int"),u(r,"sort",[],a.$to_proc()).$reverse().$first(e)},U.$$arity=-1),t.defn(ut,"$max_by",H=function(){var e,r=this,n=H.$$p,a=n||c;if(n&&(H.$$p=null),!f(a))return u(r,"enum_for",["max_by"],(e=function(){return(e.$$s||this).$enumerator_size()},e.$$s=r,e.$$arity=0,e));var i,o;return r.$each.$$p=function(){var e=t.const_get_relative(ft,"Opal").$destructure(arguments),r=t.yield1(a,e);if(void 0===i)return i=e,void(o=r);r["$<=>"](o)>0&&(i=e,o=r)},r.$each(),void 0===i?c:i},H.$$arity=0),t.alias(ut,"member?","include?"),t.defn(ut,"$min",G=function(){var e=this,r=G.$$p,n=r||c;r&&(G.$$p=null);var a;return e.$each.$$p=n!==c?function(){var r=t.const_get_relative(ft,"Opal").$destructure(arguments);if(void 0===a)return void(a=r);var i=n(r,a);i===c&&e.$raise(t.const_get_relative(ft,"ArgumentError"),"comparison failed"),i<0&&(a=r)}:function(){var e=t.const_get_relative(ft,"Opal").$destructure(arguments);if(void 0===a)return void(a=e);t.const_get_relative(ft,"Opal").$compare(e,a)<0&&(a=e)},e.$each(),void 0===a?c:a},G.$$arity=0),t.defn(ut,"$min_by",Y=function(){var e,r=this,n=Y.$$p,a=n||c;if(n&&(Y.$$p=null),!f(a))return u(r,"enum_for",["min_by"],(e=function(){return(e.$$s||this).$enumerator_size()},e.$$s=r,e.$$arity=0,e));var i,o;return r.$each.$$p=function(){var e=t.const_get_relative(ft,"Opal").$destructure(arguments),r=t.yield1(a,e);if(void 0===i)return i=e,void(o=r);r["$<=>"](o)<0&&(i=e,o=r)},r.$each(),void 0===i?c:i},Y.$$arity=0),t.defn(ut,"$minmax",V=function(){var e,r,n=this,a=V.$$p,i=a||c;a&&(V.$$p=null),i=f(e=i)?e:u(n,"proc",[],(r=function(t,e){r.$$s;return null==t&&(t=c),null==e&&(e=c),t["$<=>"](e)},r.$$s=n,r.$$arity=2,r));var o=c,s=c,l=!0;return n.$each.$$p=function(){var e=t.const_get_relative(ft,"Opal").$destructure(arguments);if(l)o=s=e,l=!1;else{var r=i.$call(o,e);r===c?n.$raise(t.const_get_relative(ft,"ArgumentError"),"comparison failed"):r>0&&(o=e);var a=i.$call(s,e);a===c?n.$raise(t.const_get_relative(ft,"ArgumentError"),"comparison failed"):a<0&&(s=e)}},n.$each(),[o,s]},V.$$arity=0),t.defn(ut,"$minmax_by",Q=function(){var e=this,r=Q.$$p;return r&&(Q.$$p=null),e.$raise(t.const_get_relative(ft,"NotImplementedError"))},Q.$$arity=0),t.defn(ut,"$none?",X=function(){try{var e,r,n=this,a=X.$$p,i=a||c;return a&&(X.$$p=null),i!==c?u(n,"each",[],(e=function(r){var n,a=(e.$$s,arguments.length),o=a-0;o<0&&(o=0),n=new Array(o);for(var s=0;s<a;s++)n[s-0]=arguments[s];if(!f(t.yieldX(i,t.to_a(n))))return c;t.ret(!1)},e.$$s=n,e.$$arity=-1,e)):u(n,"each",[],(r=function(e){var n,a=(r.$$s,arguments.length),i=a-0;i<0&&(i=0),n=new Array(i);for(var o=0;o<a;o++)n[o-0]=arguments[o];if(!f(t.const_get_relative(ft,"Opal").$destructure(n)))return c;t.ret(!1)},r.$$s=n,r.$$arity=-1,r)),!0}catch(e){if(e===t.returner)return e.$v;throw e}},X.$$arity=0),t.defn(ut,"$one?",J=function(){try{var r,n,i=this,o=J.$$p,s=o||c,l=c;return o&&(J.$$p=null),l=0,s!==c?u(i,"each",[],(r=function(n){var i,o=(r.$$s,arguments.length),u=o-0;u<0&&(u=0),i=new Array(u);for(var $=0;$<o;$++)i[$-0]=arguments[$];return f(t.yieldX(s,t.to_a(i)))?(l=a(l,1),f(e(l,1))?void t.ret(!1):c):c},r.$$s=i,r.$$arity=-1,r)):u(i,"each",[],(n=function(r){var i,o=(n.$$s,arguments.length),s=o-0;s<0&&(s=0),i=new Array(s);for(var u=0;u<o;u++)i[u-0]=arguments[u];return f(t.const_get_relative(ft,"Opal").$destructure(i))?(l=a(l,1),f(e(l,1))?void t.ret(!1):c):c},n.$$s=i,n.$$arity=-1,n)),l["$=="](1)}catch(e){if(e===t.returner)return e.$v;throw e}},J.$$arity=0),t.defn(ut,"$partition",W=function(){var e,r=this,n=W.$$p,a=n||c;if(n&&(W.$$p=null),a===c)return u(r,"enum_for",["partition"],(e=function(){return(e.$$s||this).$enumerator_size()},e.$$s=r,e.$$arity=0,e));var i=[],o=[];return r.$each.$$p=function(){var e=t.const_get_relative(ft,"Opal").$destructure(arguments),r=t.yield1(a,e);f(r)?i.push(e):o.push(e)},r.$each(),[i,o]},W.$$arity=0),t.alias(ut,"reduce","inject"),t.defn(ut,"$reject",K=function(){var e,r=this,n=K.$$p,a=n||c;if(n&&(K.$$p=null),a===c)return u(r,"enum_for",["reject"],(e=function(){return(e.$$s||this).$enumerator_size()},e.$$s=r,e.$$arity=0,e));var i=[];return r.$each.$$p=function(){var e=t.const_get_relative(ft,"Opal").$destructure(arguments),r=t.yield1(a,e);$(r)&&i.push(e)},r.$each(),i},K.$$arity=0),t.defn(ut,"$reverse_each",Z=function(){var e,r=this,n=Z.$$p,a=n||c;if(n&&(Z.$$p=null),a===c)return u(r,"enum_for",["reverse_each"],(e=function(){return(e.$$s||this).$enumerator_size()},e.$$s=r,e.$$arity=0,e));var i=[];r.$each.$$p=function(){i.push(arguments)},r.$each();for(var o=i.length-1;o>=0;o--)t.yieldX(a,i[o]);return i},Z.$$arity=0),t.alias(ut,"select","find_all"),t.defn(ut,"$slice_before",tt=function(e){var r,n=this,a=tt.$$p,i=a||c;return a&&(tt.$$p=null),f(void 0===e&&i===c)&&n.$raise(t.const_get_relative(ft,"ArgumentError"),"both pattern and block are given"),f(void 0!==e&&i!==c||arguments.length>1)&&n.$raise(t.const_get_relative(ft,"ArgumentError"),"wrong number of arguments ("+arguments.length+" expected 1)"),u(t.const_get_relative(ft,"Enumerator"),"new",[],(r=function(n){var a=r.$$s||this;null==n&&(n=c);var o=[];a.$each.$$p=i!==c?void 0===e?function(){var e=t.const_get_relative(ft,"Opal").$destructure(arguments),r=t.yield1(i,e);f(r)&&o.length>0&&(n["$<<"](o),o=[]),o.push(e)}:function(){var r=t.const_get_relative(ft,"Opal").$destructure(arguments),a=i(r,e.$dup());f(a)&&o.length>0&&(n["$<<"](o),o=[]),o.push(r)}:function(){var r=t.const_get_relative(ft,"Opal").$destructure(arguments),a=e["$==="](r);f(a)&&o.length>0&&(n["$<<"](o),o=[]),o.push(r)},a.$each(),o.length>0&&n["$<<"](o)},r.$$s=n,r.$$arity=1,r))},tt.$$arity=-1),t.defn(ut,"$slice_after",et=function(e){var r,n,a=this,i=et.$$p,o=i||c;return i&&(et.$$p=null),f(void 0===e&&o===c)&&a.$raise(t.const_get_relative(ft,"ArgumentError"),"both pattern and block are given"),f(void 0!==e&&o!==c||arguments.length>1)&&a.$raise(t.const_get_relative(ft,"ArgumentError"),"wrong number of arguments ("+arguments.length+" expected 1)"),f(void 0!==e)&&(o=u(a,"proc",[],(r=function(t){r.$$s;return null==t&&(t=c),e["$==="](t)},r.$$s=a,r.$$arity=1,r))),u(t.const_get_relative(ft,"Enumerator"),"new",[],(n=function(e){var r=n.$$s||this;null==e&&(e=c);var a;r.$each.$$p=function(){var r=t.const_get_relative(ft,"Opal").$destructure(arguments),n=t.yield1(o,r);null==a&&(a=[]),f(n)?(a.push(r),e.$yield(a),a=null):a.push(r)},r.$each(),null!=a&&e.$yield(a)},n.$$s=a,n.$$arity=1,n))},et.$$arity=-1),t.defn(ut,"$slice_when",rt=function(){var e,r=this,n=rt.$$p,a=n||c;return n&&(rt.$$p=null),a!==c||r.$raise(t.const_get_relative(ft,"ArgumentError"),"wrong number of arguments (0 for 1)"),u(t.const_get_relative(ft,"Enumerator"),"new",[],(e=function(r){var n=e.$$s||this;null==r&&(r=c);var i=c,o=c;n.$each_cons.$$p=function(){var e=t.const_get_relative(ft,"Opal").$destructure(arguments),n=e[0],s=e[1],l=t.yieldX(a,[n,s]);o=s,i===c&&(i=[]),f(l)?(i.push(n),r.$yield(i),i=[]):i.push(n)},n.$each_cons(2),i!==c&&(i.push(o),r.$yield(i))},e.$$s=r,e.$$arity=1,e))},rt.$$arity=0),t.defn(ut,"$sort",nt=function(){var t,e=this,r=nt.$$p,n=r||c,a=c;return r&&(nt.$$p=null),a=e.$to_a(),n!==c||(n=u(e,"lambda",[],(t=function(e,r){t.$$s;return null==e&&(e=c),null==r&&(r=c),e["$<=>"](r)},t.$$s=e,t.$$arity=2,t))),u(a,"sort",[],n.$to_proc())},nt.$$arity=0),t.defn(ut,"$sort_by",at=function(){var e,r,n,a,i=this,o=at.$$p,s=o||c,l=c;return o&&(at.$$p=null),s===c?u(i,"enum_for",["sort_by"],(e=function(){return(e.$$s||this).$enumerator_size()},e.$$s=i,e.$$arity=0,e)):(l=u(i,"map",[],(r=function(){var e=(r.$$s,c);return e=t.const_get_relative(ft,"Opal").$destructure(arguments),[t.yield1(s,e),e]},r.$$s=i,r.$$arity=0,r)),u(l,"sort!",[],(n=function(t,e){n.$$s;return null==t&&(t=c),null==e&&(e=c),t[0]["$<=>"](e[0])},n.$$s=i,n.$$arity=2,n)),u(l,"map!",[],(a=function(t){a.$$s;return null==t&&(t=c),t[1]},a.$$s=i,a.$$arity=1,a)))},at.$$arity=0),t.defn(ut,"$sum",it=function(e){var r,n=this,i=it.$$p,o=i||c,s=c;return null==e&&(e=0),i&&(it.$$p=null),s=e,u(n,"each",[],(r=function(e){var n,i=(r.$$s,c),l=arguments.length,f=l-0;f<0&&(f=0),n=new Array(f);for(var $=0;$<l;$++)n[$-0]=arguments[$];return i=o!==c?u(o,"call",t.to_a(n)):t.const_get_relative(ft,"Opal").$destructure(n),s=a(s,i)},r.$$s=n,r.$$arity=-1,r)),s},it.$$arity=-1),t.defn(ut,"$take",ot=function(t){return this.$first(t)},ot.$$arity=1),t.defn(ut,"$take_while",st=function(){try{var e,r=this,n=st.$$p,a=n||c,i=c;return n&&(st.$$p=null),f(a)?(i=[],u(r,"each",[],(e=function(r){var n,o=(e.$$s,c),s=arguments.length,l=s-0;l<0&&(l=0),n=new Array(l);for(var u=0;u<s;u++)n[u-0]=arguments[u];return o=t.const_get_relative(ft,"Opal").$destructure(n),f(t.yield1(a,o))||t.ret(i),i.push(o)},e.$$s=r,e.$$arity=-1,e))):r.$enum_for("take_while")}catch(e){if(e===t.returner)return e.$v;throw e}},st.$$arity=0),t.defn(ut,"$uniq",ct=function(){var e,r=this,n=ct.$$p,a=n||c,o=c;return n&&(ct.$$p=null),o=_([],{}),u(r,"each",[],(e=function(r){var n,s=(e.$$s,c),l=c,$=c,_=arguments.length,d=_-0;d<0&&(d=0),n=new Array(d);for(var p=0;p<_;p++)n[p-0]=arguments[p];return s=t.const_get_relative(ft,"Opal").$destructure(n),l=function(){return a!==c?a.$call(s):s}(),f(o["$has_key?"](l))?c:($=[l,s],u(o,"[]=",t.to_a($)),$[i($.length,1)])},e.$$s=r,e.$$arity=-1,e)),o.$values()},ct.$$arity=0),t.alias(ut,"to_a","entries"),t.defn(ut,"$zip",lt=function(e){var r,n=this,a=lt.$$p,i=arguments.length,o=i-0;o<0&&(o=0),r=new Array(o);for(var s=0;s<i;s++)r[s-0]=arguments[s];return a&&(lt.$$p=null),u(n.$to_a(),"zip",t.to_a(r))},lt.$$arity=-1)}(s[0],s)},Opal.modules["corelib/enumerator"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t<e:t["$<"](e)}var n=t.top,a=[],i=t.nil,o=t.breaker,s=t.slice,c=t.klass,l=t.truthy,u=t.send,f=t.falsy;return t.add_stubs(["$require","$include","$allocate","$new","$to_proc","$coerce_to","$nil?","$empty?","$+","$class","$__send__","$===","$call","$enum_for","$size","$destructure","$inspect","$[]","$raise","$yield","$each","$enumerator_size","$respond_to?","$try_convert","$<","$for"]),n.$require("corelib/enumerable"),function(n,a,$){function _(){}var d,p,h,g,m,v,y=_=c(n,null,"Enumerator",_),b=y.$$proto,w=[y].concat($);return b.size=b.args=b.object=b.method=i,y.$include(t.const_get_relative(w,"Enumerable")),b.$$is_enumerator=!0,t.defs(y,"$for",d=function(t,e,r){var n,a=this,o=d.$$p,s=o||i;null==e&&(e="each");var c=arguments.length,l=c-2;l<0&&(l=0),n=new Array(l);for(var u=2;u<c;u++)n[u-2]=arguments[u];o&&(d.$$p=null);var f=a.$allocate();return f.object=t,f.size=s,f.method=e,f.args=n,f},d.$$arity=-2),t.defn(y,"$initialize",p=function(e){var r=this,n=p.$$p,a=n||i;return n&&(p.$$p=null),l(a)?(r.object=u(t.const_get_relative(w,"Generator"),"new",[],a.$to_proc()),r.method="each",r.args=[],r.size=arguments[0]||i,l(r.size)?r.size=t.const_get_relative(w,"Opal").$coerce_to(r.size,t.const_get_relative(w,"Integer"),"to_int"):i):(r.object=arguments[0],r.method=arguments[1]||"each",r.args=s.call(arguments,2),r.size=i)},p.$$arity=-1),t.defn(y,"$each",h=function(r){var n,a,o=this,s=h.$$p,c=s||i,f=arguments.length,$=f-0;$<0&&($=0),a=new Array($);for(var _=0;_<f;_++)a[_-0]=arguments[_];return s&&(h.$$p=null),l(l(n=c["$nil?"]())?a["$empty?"]():n)?o:(a=e(o.args,a),l(c["$nil?"]())?u(o.$class(),"new",[o.object,o.method].concat(t.to_a(a))):u(o.object,"__send__",[o.method].concat(t.to_a(a)),c.$to_proc()))},h.$$arity=-1),t.defn(y,"$size",g=function(){var e=this;return l(t.const_get_relative(w,"Proc")["$==="](e.size))?u(e.size,"call",t.to_a(e.args)):e.size},g.$$arity=0),t.defn(y,"$with_index",m=function(e){var r,n=this,a=m.$$p,o=a||i;if(null==e&&(e=0),a&&(m.$$p=null),e=l(e)?t.const_get_relative(w,"Opal").$coerce_to(e,t.const_get_relative(w,"Integer"),"to_int"):0,!l(o))return u(n,"enum_for",["with_index",e],(r=function(){return(r.$$s||this).$size()},r.$$s=n,r.$$arity=0,r));var s=e;return n.$each.$$p=function(){var e=t.const_get_relative(w,"Opal").$destructure(arguments),r=o(e,s);return s++,r},n.$each()},m.$$arity=-1),t.alias(y,"with_object","each_with_object"),t.defn(y,"$inspect",v=function(){var r=this,n=i;return n="#<"+r.$class()+": "+r.object.$inspect()+":"+r.method,l(r.args["$empty?"]())||(n=e(n,"("+r.args.$inspect()["$[]"](t.const_get_relative(w,"Range").$new(1,-2))+")")),e(n,">")},v.$$arity=0),function(e,r,n){function a(){}var s,f,$=a=c(e,null,"Generator",a),_=$.$$proto,d=[$].concat(n);_.block=i,$.$include(t.const_get_relative(d,"Enumerable")),t.defn($,"$initialize",s=function(){var e=this,r=s.$$p,n=r||i;return r&&(s.$$p=null),l(n)||e.$raise(t.const_get_relative(d,"LocalJumpError"),"no block given"),e.block=n},s.$$arity=0),t.defn($,"$each",f=function(e){var r,n=this,a=f.$$p,s=a||i,c=i,l=arguments.length,$=l-0;$<0&&($=0),r=new Array($);for(var _=0;_<l;_++)r[_-0]=arguments[_];a&&(f.$$p=null),c=u(t.const_get_relative(d,"Yielder"),"new",[],s.$to_proc());try{r.unshift(c),t.yieldX(n.block,r)}catch(t){if(t===o)return o.$v;throw t}return n},f.$$arity=-1)}(w[0],0,w),function(e,r,n){function a(){}var s,l,f,$=a=c(e,null,"Yielder",a),_=$.$$proto;[$].concat(n);_.block=i,t.defn($,"$initialize",s=function(){var t=this,e=s.$$p,r=e||i;return e&&(s.$$p=null),t.block=r},s.$$arity=0),t.defn($,"$yield",l=function(e){var r,n=this,a=arguments.length,i=a-0;i<0&&(i=0),r=new Array(i);for(var s=0;s<a;s++)r[s-0]=arguments[s];var c=t.yieldX(n.block,r);if(c===o)throw o;return c},l.$$arity=-1),t.defn($,"$<<",f=function(e){var r,n=this,a=arguments.length,i=a-0;i<0&&(i=0),r=new Array(i);for(var o=0;o<a;o++)r[o-0]=arguments[o];return u(n,"yield",t.to_a(r)),n},f.$$arity=-1)}(w[0],0,w),function(n,a,o){function s(){}var $,_,d,p,h,g,m,v,y,b,w,x,A,k=s=c(n,a,"Lazy",s),E=k.$$proto,S=[k].concat(o);return E.enumerator=i,function(t,e,r){function n(){}var a=n=c(t,e,"StopLazyError",n);a.$$proto,[a].concat(r)}(S[0],t.const_get_relative(S,"Exception"),S),t.defn(k,"$initialize",$=function(e,r){var n,a=this,o=$.$$p,s=o||i;return null==r&&(r=i),o&&($.$$p=null),s!==i||a.$raise(t.const_get_relative(S,"ArgumentError"),"tried to call lazy new without a block"),a.enumerator=e,u(a,t.find_super_dispatcher(a,"initialize",$,!1),[r],(n=function(r,a){var o,c,l=n.$$s||this,f=arguments.length,$=f-1;$<0&&($=0),o=new Array($);for(var _=1;_<f;_++)o[_-1]=arguments[_];null==r&&(r=i);try{return u(e,"each",t.to_a(o),(c=function(e){var n,a=(c.$$s,arguments.length),i=a-0;i<0&&(i=0),n=new Array(i);for(var o=0;o<a;o++)n[o-0]=arguments[o];n.unshift(r),t.yieldX(s,n)},c.$$s=l,c.$$arity=-1,c))}catch(e){if(!t.rescue(e,[t.const_get_relative(S,"Exception")]))throw e;try{return i}finally{t.pop_exception()}}},n.$$s=a,n.$$arity=-2,n))},$.$$arity=-2),t.alias(k,"force","to_a"),t.defn(k,"$lazy",_=function(){return this},_.$$arity=0),t.defn(k,"$collect",d=function(){var e,r=this,n=d.$$p,a=n||i;return n&&(d.$$p=null),l(a)||r.$raise(t.const_get_relative(S,"ArgumentError"),"tried to call lazy map without a block"),u(t.const_get_relative(S,"Lazy"),"new",[r,r.$enumerator_size()],(e=function(r,n){var o,s=(e.$$s,arguments.length),c=s-1;c<0&&(c=0),o=new Array(c);for(var l=1;l<s;l++)o[l-1]=arguments[l];null==r&&(r=i);var u=t.yieldX(a,o);r.$yield(u)},e.$$s=r,e.$$arity=-2,e))},d.$$arity=0),t.defn(k,"$collect_concat",p=function(){var e,r=this,n=p.$$p,a=n||i;return n&&(p.$$p=null),l(a)||r.$raise(t.const_get_relative(S,"ArgumentError"),"tried to call lazy map without a block"),u(t.const_get_relative(S,"Lazy"),"new",[r,i],(e=function(r,n){var o,s,c,l=e.$$s||this,f=arguments.length,$=f-1;$<0&&($=0),o=new Array($);for(var _=1;_<f;_++)o[_-1]=arguments[_];null==r&&(r=i);var d=t.yieldX(a,o);if(d["$respond_to?"]("force")&&d["$respond_to?"]("each"))u(d,"each",[],(s=function(t){s.$$s;return null==t&&(t=i),r.$yield(t)},s.$$s=l,s.$$arity=1,s));else{t.const_get_relative(S,"Opal").$try_convert(d,t.const_get_relative(S,"Array"),"to_ary")===i?r.$yield(d):u(d,"each",[],(c=function(t){c.$$s;return null==t&&(t=i),r.$yield(t)},c.$$s=l,c.$$arity=1,c))}},e.$$s=r,e.$$arity=-2,e))},p.$$arity=0),t.defn(k,"$drop",h=function(n){var a,o=this,s=i,c=i,f=i;return n=t.const_get_relative(S,"Opal").$coerce_to(n,t.const_get_relative(S,"Integer"),"to_int"),l(r(n,0))&&o.$raise(t.const_get_relative(S,"ArgumentError"),"attempt to drop negative size"),s=o.$enumerator_size(),c=function(){return l(t.const_get_relative(S,"Integer")["$==="](s))&&l(r(n,s))?n:s}(),f=0,u(t.const_get_relative(S,"Lazy"),"new",[o,c],(a=function(o,s){var c,$=(a.$$s,arguments.length),_=$-1;_<0&&(_=0),c=new Array(_);for(var d=1;d<$;d++)c[d-1]=arguments[d];return null==o&&(o=i),l(r(f,n))?f=e(f,1):u(o,"yield",t.to_a(c))},a.$$s=o,a.$$arity=-2,a))},h.$$arity=1),t.defn(k,"$drop_while",g=function(){var e,r=this,n=g.$$p,a=n||i,o=i;return n&&(g.$$p=null),l(a)||r.$raise(t.const_get_relative(S,"ArgumentError"),"tried to call lazy drop_while without a block"),o=!0,u(t.const_get_relative(S,"Lazy"),"new",[r,i],(e=function(r,n){var s,c=(e.$$s,arguments.length),$=c-1;$<0&&($=0),s=new Array($);for(var _=1;_<c;_++)s[_-1]=arguments[_];if(null==r&&(r=i),!l(o))return u(r,"yield",t.to_a(s));var d=t.yieldX(a,s);f(d)&&(o=!1,u(r,"yield",t.to_a(s)))},e.$$s=r,e.$$arity=-2,e))},g.$$arity=0),t.defn(k,"$enum_for",m=function(e,r){var n,a=this,o=m.$$p,s=o||i;null==e&&(e="each");var c=arguments.length,l=c-1;l<0&&(l=0),n=new Array(l);for(var f=1;f<c;f++)n[f-1]=arguments[f];return o&&(m.$$p=null),u(a.$class(),"for",[a,e].concat(t.to_a(n)),s.$to_proc())},m.$$arity=-1),t.defn(k,"$find_all",v=function(){var e,r=this,n=v.$$p,a=n||i;return n&&(v.$$p=null),l(a)||r.$raise(t.const_get_relative(S,"ArgumentError"),"tried to call lazy select without a block"),u(t.const_get_relative(S,"Lazy"),"new",[r,i],(e=function(r,n){var o,s=(e.$$s,arguments.length),c=s-1;c<0&&(c=0),o=new Array(c);for(var f=1;f<s;f++)o[f-1]=arguments[f];null==r&&(r=i);var $=t.yieldX(a,o);l($)&&u(r,"yield",t.to_a(o))},e.$$s=r,e.$$arity=-2,e))},v.$$arity=0),t.alias(k,"flat_map","collect_concat"),t.defn(k,"$grep",y=function(e){var r,n,a=this,o=y.$$p,s=o||i;return o&&(y.$$p=null),l(s)?u(t.const_get_relative(S,"Lazy"),"new",[a,i],(r=function(n,a){var o,c=(r.$$s,arguments.length),u=c-1;u<0&&(u=0),o=new Array(u);for(var f=1;f<c;f++)o[f-1]=arguments[f]
;null==n&&(n=i);var $=t.const_get_relative(S,"Opal").$destructure(o),_=e["$==="]($);l(_)&&(_=t.yield1(s,$),n.$yield(t.yield1(s,$)))},r.$$s=a,r.$$arity=-2,r)):u(t.const_get_relative(S,"Lazy"),"new",[a,i],(n=function(r,a){var o,s=(n.$$s,arguments.length),c=s-1;c<0&&(c=0),o=new Array(c);for(var u=1;u<s;u++)o[u-1]=arguments[u];null==r&&(r=i);var f=t.const_get_relative(S,"Opal").$destructure(o),$=e["$==="](f);l($)&&r.$yield(f)},n.$$s=a,n.$$arity=-2,n))},y.$$arity=1),t.alias(k,"map","collect"),t.alias(k,"select","find_all"),t.defn(k,"$reject",b=function(){var e,r=this,n=b.$$p,a=n||i;return n&&(b.$$p=null),l(a)||r.$raise(t.const_get_relative(S,"ArgumentError"),"tried to call lazy reject without a block"),u(t.const_get_relative(S,"Lazy"),"new",[r,i],(e=function(r,n){var o,s=(e.$$s,arguments.length),c=s-1;c<0&&(c=0),o=new Array(c);for(var l=1;l<s;l++)o[l-1]=arguments[l];null==r&&(r=i);var $=t.yieldX(a,o);f($)&&u(r,"yield",t.to_a(o))},e.$$s=r,e.$$arity=-2,e))},b.$$arity=0),t.defn(k,"$take",w=function(n){var a,o=this,s=i,c=i,f=i;return n=t.const_get_relative(S,"Opal").$coerce_to(n,t.const_get_relative(S,"Integer"),"to_int"),l(r(n,0))&&o.$raise(t.const_get_relative(S,"ArgumentError"),"attempt to take negative size"),s=o.$enumerator_size(),c=function(){return l(t.const_get_relative(S,"Integer")["$==="](s))&&l(r(n,s))?n:s}(),f=0,u(t.const_get_relative(S,"Lazy"),"new",[o,c],(a=function(o,s){var c,$=a.$$s||this,_=arguments.length,d=_-1;d<0&&(d=0),c=new Array(d);for(var p=1;p<_;p++)c[p-1]=arguments[p];return null==o&&(o=i),l(r(f,n))?(u(o,"yield",t.to_a(c)),f=e(f,1)):$.$raise(t.const_get_relative(S,"StopLazyError"))},a.$$s=o,a.$$arity=-2,a))},w.$$arity=1),t.defn(k,"$take_while",x=function(){var e,r=this,n=x.$$p,a=n||i;return n&&(x.$$p=null),l(a)||r.$raise(t.const_get_relative(S,"ArgumentError"),"tried to call lazy take_while without a block"),u(t.const_get_relative(S,"Lazy"),"new",[r,i],(e=function(r,n){var o,s=e.$$s||this,c=arguments.length,f=c-1;f<0&&(f=0),o=new Array(f);for(var $=1;$<c;$++)o[$-1]=arguments[$];null==r&&(r=i);var _=t.yieldX(a,o);l(_)?u(r,"yield",t.to_a(o)):s.$raise(t.const_get_relative(S,"StopLazyError"))},e.$$s=r,e.$$arity=-2,e))},x.$$arity=0),t.alias(k,"to_enum","enum_for"),t.defn(k,"$inspect",A=function(){var t=this;return"#<"+t.$class()+": "+t.enumerator.$inspect()+">"},A.$$arity=0),i&&"inspect"}(w[0],y,w)}(a[0],0,a)},Opal.modules["corelib/numeric"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t*e:t["$*"](e)}function n(t,e){return"number"==typeof t&&"number"==typeof e?t<e:t["$<"](e)}function a(t,e){return"number"==typeof t&&"number"==typeof e?t/e:t["$/"](e)}function i(t,e){return"number"==typeof t&&"number"==typeof e?t>e:t["$>"](e)}var o=t.top,s=[],c=t.nil,l=(t.breaker,t.slice,t.klass),u=t.truthy,f=t.hash2;return t.add_stubs(["$require","$include","$instance_of?","$class","$Float","$coerce","$===","$raise","$__send__","$equal?","$-","$*","$div","$<","$-@","$ceil","$to_f","$denominator","$to_r","$==","$floor","$/","$%","$Complex","$zero?","$numerator","$abs","$arg","$coerce_to!","$round","$to_i","$truncate","$>"]),o.$require("corelib/comparable"),function(o,s,$){function _(){}var d,p,h,g,m,v,y,b,w,x,A,k,E,S,N,C,I,O,P,L,M,T,B,j,F,R,q,D,z,U,H,G,Y,V,Q,X=_=l(o,null,"Numeric",_),J=(X.$$proto,[X].concat($));return X.$include(t.const_get_relative(J,"Comparable")),t.defn(X,"$coerce",d=function(t){var e=this;return u(t["$instance_of?"](e.$class()))?[t,e]:[e.$Float(t),e.$Float(e)]},d.$$arity=1),t.defn(X,"$__coerced__",p=function(e,r){var n,a,i=this,o=c,s=c,l=c;try{a=r.$coerce(i),n=t.to_ary(a),o=null==n[0]?c:n[0],s=null==n[1]?c:n[1]}catch(n){if(!t.rescue(n,[t.const_get_relative(J,"StandardError")]))throw n;try{l=e,"+"["$==="](l)||"-"["$==="](l)||"*"["$==="](l)||"/"["$==="](l)||"%"["$==="](l)||"&"["$==="](l)||"|"["$==="](l)||"^"["$==="](l)||"**"["$==="](l)?i.$raise(t.const_get_relative(J,"TypeError"),r.$class()+" can't be coerce into Numeric"):(">"["$==="](l)||">="["$==="](l)||"<"["$==="](l)||"<="["$==="](l)||"<=>"["$==="](l))&&i.$raise(t.const_get_relative(J,"ArgumentError"),"comparison of "+i.$class()+" with "+r.$class()+" failed")}finally{t.pop_exception()}}return o.$__send__(e,s)},p.$$arity=2),t.defn(X,"$<=>",h=function(t){return u(this["$equal?"](t))?0:c},h.$$arity=1),t.defn(X,"$+@",g=function(){return this},g.$$arity=0),t.defn(X,"$-@",m=function(){return e(0,this)},m.$$arity=0),t.defn(X,"$%",v=function(t){var n=this;return e(n,r(t,n.$div(t)))},v.$$arity=1),t.defn(X,"$abs",y=function(){var t=this;return n(t,0)?t["$-@"]():t},y.$$arity=0),t.defn(X,"$abs2",b=function(){var t=this;return r(t,t)},b.$$arity=0),t.defn(X,"$angle",w=function(){return n(this,0)?t.const_get_qualified(t.const_get_relative(J,"Math"),"PI"):0},w.$$arity=0),t.alias(X,"arg","angle"),t.defn(X,"$ceil",x=function(){return this.$to_f().$ceil()},x.$$arity=0),t.defn(X,"$conj",A=function(){return this},A.$$arity=0),t.alias(X,"conjugate","conj"),t.defn(X,"$denominator",k=function(){return this.$to_r().$denominator()},k.$$arity=0),t.defn(X,"$div",E=function(e){var r=this;return e["$=="](0)&&r.$raise(t.const_get_relative(J,"ZeroDivisionError"),"divided by o"),a(r,e).$floor()},E.$$arity=1),t.defn(X,"$divmod",S=function(t){var e=this;return[e.$div(t),e["$%"](t)]},S.$$arity=1),t.defn(X,"$fdiv",N=function(t){return a(this.$to_f(),t)},N.$$arity=1),t.defn(X,"$floor",C=function(){return this.$to_f().$floor()},C.$$arity=0),t.defn(X,"$i",I=function(){var t=this;return t.$Complex(0,t)},I.$$arity=0),t.defn(X,"$imag",O=function(){return 0},O.$$arity=0),t.alias(X,"imaginary","imag"),t.defn(X,"$integer?",P=function(){return!1},P.$$arity=0),t.alias(X,"magnitude","abs"),t.alias(X,"modulo","%"),t.defn(X,"$nonzero?",L=function(){var t=this;return u(t["$zero?"]())?c:t},L.$$arity=0),t.defn(X,"$numerator",M=function(){return this.$to_r().$numerator()},M.$$arity=0),t.alias(X,"phase","arg"),t.defn(X,"$polar",T=function(){var t=this;return[t.$abs(),t.$arg()]},T.$$arity=0),t.defn(X,"$quo",B=function(e){var r=this;return a(t.const_get_relative(J,"Opal")["$coerce_to!"](r,t.const_get_relative(J,"Rational"),"to_r"),e)},B.$$arity=1),t.defn(X,"$real",j=function(){return this},j.$$arity=0),t.defn(X,"$real?",F=function(){return!0},F.$$arity=0),t.defn(X,"$rect",R=function(){return[this,0]},R.$$arity=0),t.alias(X,"rectangular","rect"),t.defn(X,"$round",q=function(t){return this.$to_f().$round(t)},q.$$arity=-1),t.defn(X,"$to_c",D=function(){var t=this;return t.$Complex(t,0)},D.$$arity=0),t.defn(X,"$to_int",z=function(){return this.$to_i()},z.$$arity=0),t.defn(X,"$truncate",U=function(){return this.$to_f().$truncate()},U.$$arity=0),t.defn(X,"$zero?",H=function(){return this["$=="](0)},H.$$arity=0),t.defn(X,"$positive?",G=function(){return i(this,0)},G.$$arity=0),t.defn(X,"$negative?",Y=function(){return n(this,0)},Y.$$arity=0),t.defn(X,"$dup",V=function(){return this},V.$$arity=0),t.defn(X,"$clone",Q=function(e){var r,n=this;if(null==e||!e.$$is_hash){if(null!=e)throw t.ArgumentError.$new("expected kwargs");e=f([],{})}return r=e.$$smap.freeze,null==r&&(r=!0),n},Q.$$arity=-1),c&&"clone"}(s[0],0,s)},Opal.modules["corelib/array"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t>e:t["$>"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t*e:t["$*"](e)}function n(t,e){return"number"==typeof t&&"number"==typeof e?t>=e:t["$>="](e)}function a(t,e){return"number"==typeof t&&"number"==typeof e?t<e:t["$<"](e)}function i(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}var o=t.top,s=[],c=t.nil,l=(t.breaker,t.slice,t.klass),u=t.truthy,f=t.hash2,$=t.send,_=t.gvars;return t.add_stubs(["$require","$include","$to_a","$warn","$raise","$replace","$respond_to?","$to_ary","$coerce_to","$coerce_to?","$===","$join","$to_str","$class","$hash","$<=>","$==","$object_id","$inspect","$enum_for","$bsearch_index","$to_proc","$coerce_to!","$>","$*","$enumerator_size","$empty?","$size","$map","$equal?","$dup","$each","$[]","$dig","$eql?","$length","$begin","$end","$exclude_end?","$flatten","$__id__","$to_s","$new","$!","$>=","$**","$delete_if","$reverse","$rotate","$rand","$at","$keep_if","$shuffle!","$<","$sort","$sort_by","$!=","$times","$[]=","$-","$<<","$values","$kind_of?","$last","$first","$upto","$reject","$pristine"]),o.$require("corelib/enumerable"),o.$require("corelib/numeric"),function(o,s,d){function p(){}function h(e,r){return r.$$name===t.Array?e:r.$allocate().$replace(e.$to_a())}function g(e,r){var n,a,i,o,s=e.length;return n=r.excl,a=t.Opal.$coerce_to(r.begin,t.Integer,"to_int"),i=t.Opal.$coerce_to(r.end,t.Integer,"to_int"),a<0&&(a+=s)<0?c:a>s?c:i<0&&(i+=s)<0?[]:(n||(i+=1),o=e.slice(a,i),h(o,e.$class()))}function m(e,r,n){var a,i=e.length;return(r=t.Opal.$coerce_to(r,t.Integer,"to_int"))<0&&(r+=i)<0?c:void 0===n?r>=i||r<0?c:e[r]:(n=t.Opal.$coerce_to(n,t.Integer,"to_int"))<0||r>i||r<0?c:(a=e.slice(r,r+n),h(a,e.$class()))}function v(t,e){return t===e||0===e?1:e>0&&t>e?v(t-1,e-1)+v(t-1,e):0}function y(t,e){for(var r=e>=0?1:0;e;)r*=t,t--,e--;return r}var b,w,x,A,k,E,S,N,C,I,O,P,L,M,T,B,j,F,R,q,D,z,U,H,G,Y,V,Q,X,J,W,K,Z,tt,et,rt,nt,at,it,ot,st,ct,lt,ut,ft,$t,_t,dt,pt,ht,gt,mt,vt,yt,bt,wt,xt,At,kt,Et,St,Nt,Ct,It,Ot,Pt,Lt,Mt,Tt,Bt,jt,Ft,Rt,qt,Dt,zt,Ut,Ht,Gt,Yt,Vt,Qt,Xt,Jt,Wt,Kt,Zt,te,ee,re,ne=p=l(o,s,"Array",p),ae=ne.$$proto,ie=[ne].concat(d);return ne.$include(t.const_get_relative(ie,"Enumerable")),ae.$$is_array=!0,t.defs(ne,"$[]",b=function(t){var e,r=this,n=arguments.length,a=n-0;a<0&&(a=0),e=new Array(a);for(var i=0;i<n;i++)e[i-0]=arguments[i];return h(e,r)},b.$$arity=-1),t.defn(ne,"$initialize",w=function(e,r){var n=this,a=w.$$p,i=a||c;if(null==e&&(e=c),null==r&&(r=c),a&&(w.$$p=null),r!==c&&i!==c&&n.$warn("warning: block supersedes default value argument"),e>t.const_get_qualified(t.const_get_relative(ie,"Integer"),"MAX")&&n.$raise(t.const_get_relative(ie,"ArgumentError"),"array size too big"),arguments.length>2&&n.$raise(t.const_get_relative(ie,"ArgumentError"),"wrong number of arguments ("+arguments.length+" for 0..2)"),0===arguments.length)return n.splice(0,n.length),n;if(1===arguments.length){if(e.$$is_array)return n.$replace(e.$to_a()),n;if(e["$respond_to?"]("to_ary"))return n.$replace(e.$to_ary()),n}e=t.const_get_relative(ie,"Opal").$coerce_to(e,t.const_get_relative(ie,"Integer"),"to_int"),e<0&&n.$raise(t.const_get_relative(ie,"ArgumentError"),"negative array size"),n.splice(0,n.length);var o,s;if(i===c)for(o=0;o<e;o++)n.push(r);else for(o=0,s;o<e;o++)s=i(o),n[o]=s;return n},w.$$arity=-1),t.defs(ne,"$try_convert",x=function(e){return t.const_get_relative(ie,"Opal")["$coerce_to?"](e,t.const_get_relative(ie,"Array"),"to_ary")},x.$$arity=1),t.defn(ne,"$&",A=function(e){var r=this;e=u(t.const_get_relative(ie,"Array")["$==="](e))?e.$to_a():t.const_get_relative(ie,"Opal").$coerce_to(e,t.const_get_relative(ie,"Array"),"to_ary").$to_a();var n,a,i,o=[],s=f([],{});for(n=0,a=e.length;n<a;n++)t.hash_put(s,e[n],!0);for(n=0,a=r.length;n<a;n++)i=r[n],void 0!==t.hash_delete(s,i)&&o.push(i);return o},A.$$arity=1),t.defn(ne,"$|",k=function(e){var r=this;e=u(t.const_get_relative(ie,"Array")["$==="](e))?e.$to_a():t.const_get_relative(ie,"Opal").$coerce_to(e,t.const_get_relative(ie,"Array"),"to_ary").$to_a();var n,a,i=f([],{});for(n=0,a=r.length;n<a;n++)t.hash_put(i,r[n],!0);for(n=0,a=e.length;n<a;n++)t.hash_put(i,e[n],!0);return i.$keys()},k.$$arity=1),t.defn(ne,"$*",E=function(e){var r=this;if(u(e["$respond_to?"]("to_str")))return r.$join(e.$to_str());e=t.const_get_relative(ie,"Opal").$coerce_to(e,t.const_get_relative(ie,"Integer"),"to_int"),u(e<0)&&r.$raise(t.const_get_relative(ie,"ArgumentError"),"negative argument");for(var n=[],a=r.$to_a(),i=0;i<e;i++)n=n.concat(a);return h(n,r.$class())},E.$$arity=1),t.defn(ne,"$+",S=function(e){var r=this;return e=u(t.const_get_relative(ie,"Array")["$==="](e))?e.$to_a():t.const_get_relative(ie,"Opal").$coerce_to(e,t.const_get_relative(ie,"Array"),"to_ary").$to_a(),r.concat(e)},S.$$arity=1),t.defn(ne,"$-",N=function(e){var r=this;if(e=u(t.const_get_relative(ie,"Array")["$==="](e))?e.$to_a():t.const_get_relative(ie,"Opal").$coerce_to(e,t.const_get_relative(ie,"Array"),"to_ary").$to_a(),u(0===r.length))return[];if(u(0===e.length))return r.slice();var n,a,i,o=[],s=f([],{});for(n=0,a=e.length;n<a;n++)t.hash_put(s,e[n],!0);for(n=0,a=r.length;n<a;n++)i=r[n],void 0===t.hash_get(s,i)&&o.push(i);return o},N.$$arity=1),t.defn(ne,"$<<",C=function(t){var e=this;return e.push(t),e},C.$$arity=1),t.defn(ne,"$<=>",I=function(e){var r=this;if(u(t.const_get_relative(ie,"Array")["$==="](e)))e=e.$to_a();else{if(!u(e["$respond_to?"]("to_ary")))return c;e=e.$to_ary().$to_a()}if(r.$hash()===e.$hash())return 0;for(var n=Math.min(r.length,e.length),a=0;a<n;a++){var i=r[a]["$<=>"](e[a]);if(0!==i)return i}return r.length["$<=>"](e.length)},I.$$arity=1),t.defn(ne,"$==",O=function(e){function r(e,n){var i,o,s,c;if(e===n)return!0;if(!n.$$is_array)return!!t.const_get_relative(ie,"Opal")["$respond_to?"](n,"to_ary")&&n["$=="](e);if(e.constructor!==Array&&(e=e.$to_a()),n.constructor!==Array&&(n=n.$to_a()),e.length!==n.length)return!1;for(a[e.$object_id()]=!0,i=0,o=e.length;i<o;i++)if(s=e[i],c=n[i],s.$$is_array){if(c.$$is_array&&c.length!==s.length)return!1;if(!a.hasOwnProperty(s.$object_id())&&!r(s,c))return!1}else if(!s["$=="](c))return!1;return!0}var n=this,a={};return r(n,e)},O.$$arity=1),t.defn(ne,"$[]",P=function(t,e){var r=this;return t.$$is_range?g(r,t):m(r,t,e)},P.$$arity=-2),t.defn(ne,"$[]=",L=function(e,r,n){var a,i=this,o=c,s=c,l=i.length;if(u(t.const_get_relative(ie,"Range")["$==="](e))){o=u(t.const_get_relative(ie,"Array")["$==="](r))?r.$to_a():u(r["$respond_to?"]("to_ary"))?r.$to_ary().$to_a():[r];var f=e.excl,$=t.const_get_relative(ie,"Opal").$coerce_to(e.begin,t.const_get_relative(ie,"Integer"),"to_int"),_=t.const_get_relative(ie,"Opal").$coerce_to(e.end,t.const_get_relative(ie,"Integer"),"to_int");if($<0&&($+=l)<0&&i.$raise(t.const_get_relative(ie,"RangeError"),e.$inspect()+" out of range"),_<0&&(_+=l),f||(_+=1),$>l)for(a=l;a<$;a++)i[a]=c;return _<0?i.splice.apply(i,[$,0].concat(o)):i.splice.apply(i,[$,_-$].concat(o)),r}u(void 0===n)?s=1:(s=r,r=n,o=u(t.const_get_relative(ie,"Array")["$==="](r))?r.$to_a():u(r["$respond_to?"]("to_ary"))?r.$to_ary().$to_a():[r]);var d;if(e=t.const_get_relative(ie,"Opal").$coerce_to(e,t.const_get_relative(ie,"Integer"),"to_int"),s=t.const_get_relative(ie,"Opal").$coerce_to(s,t.const_get_relative(ie,"Integer"),"to_int"),e<0&&(d=e,(e+=l)<0&&i.$raise(t.const_get_relative(ie,"IndexError"),"index "+d+" too small for array; minimum "+-i.length)),s<0&&i.$raise(t.const_get_relative(ie,"IndexError"),"negative length ("+s+")"),e>l)for(a=l;a<e;a++)i[a]=c;return void 0===n?i[e]=r:i.splice.apply(i,[e,s].concat(o)),r},L.$$arity=-3),t.defn(ne,"$any?",M=function(){var e=this,r=M.$$p,n=c,a=c,i=c;for(r&&(M.$$p=null),a=0,i=arguments.length,n=new Array(i);a<i;a++)n[a]=arguments[a];return 0!==e.length&&$(e,t.find_super_dispatcher(e,"any?",M,!1),n,r)},M.$$arity=0),t.defn(ne,"$assoc",T=function(t){for(var e,r=this,n=0,a=r.length;n<a;n++)if(e=r[n],e.length&&e[0]["$=="](t))return e;return c},T.$$arity=1),t.defn(ne,"$at",B=function(e){var r=this;return e=t.const_get_relative(ie,"Opal").$coerce_to(e,t.const_get_relative(ie,"Integer"),"to_int"),e<0&&(e+=r.length),e<0||e>=r.length?c:r[e]},B.$$arity=1),t.defn(ne,"$bsearch_index",j=function(){var e=this,r=j.$$p,n=r||c;if(r&&(j.$$p=null),n===c)return e.$enum_for("bsearch_index");for(var a,i,o,s=0,l=e.length,u=!1,f=c;s<l;){if(a=s+Math.floor((l-s)/2),i=e[a],!0===(o=t.yield1(n,i)))f=a,u=!0;else if(!1===o||o===c)u=!1;else if(o.$$is_number){if(0===o)return a;u=o<0}else e.$raise(t.const_get_relative(ie,"TypeError"),"wrong argument type "+o.$class()+" (must be numeric, true, false or nil)");u?l=a:s=a+1}return f},j.$$arity=0),t.defn(ne,"$bsearch",F=function(){var t=this,e=F.$$p,r=e||c,n=c;return e&&(F.$$p=null),r===c?t.$enum_for("bsearch"):(n=$(t,"bsearch_index",[],r.$to_proc()),null!=n&&n.$$is_number?t[n]:n)},F.$$arity=0),t.defn(ne,"$cycle",R=function(n){var a,i,o=this,s=R.$$p,l=s||c;if(null==n&&(n=c),s&&(R.$$p=null),l===c)return $(o,"enum_for",["cycle",n],(a=function(){var i=a.$$s||this;return n["$=="](c)?t.const_get_qualified(t.const_get_relative(ie,"Float"),"INFINITY"):(n=t.const_get_relative(ie,"Opal")["$coerce_to!"](n,t.const_get_relative(ie,"Integer"),"to_int"),u(e(n,0))?r(i.$enumerator_size(),n):0)},a.$$s=o,a.$$arity=0,a));if(u(u(i=o["$empty?"]())?i:n["$=="](0)))return c;var f,_;if(n===c)for(;;)for(f=0,_=o.length;f<_;f++)t.yield1(l,o[f]);else{if((n=t.const_get_relative(ie,"Opal")["$coerce_to!"](n,t.const_get_relative(ie,"Integer"),"to_int"))<=0)return o;for(;n>0;){for(f=0,_=o.length;f<_;f++)t.yield1(l,o[f]);n--}}return o},R.$$arity=-1),t.defn(ne,"$clear",q=function(){var t=this;return t.splice(0,t.length),t},q.$$arity=0),t.defn(ne,"$count",D=function(e){var r,n=this,a=D.$$p,i=a||c,o=c,s=c,l=c;for(null==e&&(e=c),a&&(D.$$p=null),s=0,l=arguments.length,o=new Array(l);s<l;s++)o[s]=arguments[s];return u(u(r=e)?r:i)?$(n,t.find_super_dispatcher(n,"count",D,!1),o,a):n.$size()},D.$$arity=-1),t.defn(ne,"$initialize_copy",z=function(t){return this.$replace(t)},z.$$arity=1),t.defn(ne,"$collect",U=function(){var e,r=this,n=U.$$p,a=n||c;if(n&&(U.$$p=null),a===c)return $(r,"enum_for",["collect"],(e=function(){return(e.$$s||this).$size()},e.$$s=r,e.$$arity=0,e));for(var i=[],o=0,s=r.length;o<s;o++){var l=t.yield1(a,r[o]);i.push(l)}return i},U.$$arity=0),t.defn(ne,"$collect!",H=function(){var e,r=this,n=H.$$p,a=n||c;if(n&&(H.$$p=null),a===c)return $(r,"enum_for",["collect!"],(e=function(){return(e.$$s||this).$size()},e.$$s=r,e.$$arity=0,e));for(var i=0,o=r.length;i<o;i++){var s=t.yield1(a,r[i]);r[i]=s}return r},H.$$arity=0),t.defn(ne,"$combination",G=function(e){var r,n=this,a=G.$$p,i=a||c,o=c;if(a&&(G.$$p=null),o=t.const_get_relative(ie,"Opal")["$coerce_to!"](e,t.const_get_relative(ie,"Integer"),"to_int"),i===c)return $(n,"enum_for",["combination",o],(r=function(){return v((r.$$s||this).length,o)},r.$$s=n,r.$$arity=0,r));var s,l,u,f,_,d,p;if(0===o)t.yield1(i,[]);else if(1===o)for(s=0,l=n.length;s<l;s++)t.yield1(i,[n[s]]);else if(o===n.length)t.yield1(i,n.slice());else if(o>=0&&o<n.length){for(u=[],s=0;s<=o+1;s++)u.push(0);for(f=[],_=0,d=!1,u[0]=-1;!d;){for(f[_]=n[u[_+1]];_<o-1;)_++,p=u[_+1]=u[_]+1,f[_]=n[p];t.yield1(i,f.slice()),_++;do{d=0===_,u[_]++,_--}while(u[_+1]+o===n.length+_+1)}}return n},G.$$arity=1),t.defn(ne,"$repeated_combination",Y=function(e){function r(e,n,a,i){if(a.length==e){var s=a.slice();return void t.yield1(o,s)}for(var c=n;c<i.length;c++)a.push(i[c]),r(e,c,a,i),a.pop()}var n,a=this,i=Y.$$p,o=i||c,s=c;return i&&(Y.$$p=null),s=t.const_get_relative(ie,"Opal")["$coerce_to!"](e,t.const_get_relative(ie,"Integer"),"to_int"),o===c?$(a,"enum_for",["repeated_combination",s],(n=function(){return v((n.$$s||this).length+s-1,s)},n.$$s=a,n.$$arity=0,n)):(s>=0&&r(s,0,[],a),a)},Y.$$arity=1),t.defn(ne,"$compact",V=function(){for(var t,e=this,r=[],n=0,a=e.length;n<a;n++)(t=e[n])!==c&&r.push(t);return r},V.$$arity=0),t.defn(ne,"$compact!",Q=function(){for(var t=this,e=t.length,r=0,n=t.length;r<n;r++)t[r]===c&&(t.splice(r,1),n--,r--);return t.length===e?c:t},Q.$$arity=0),t.defn(ne,"$concat",X=function(e){var r,n,a,i=this,o=arguments.length,s=o-0;s<0&&(s=0),a=new Array(s);for(var l=0;l<o;l++)a[l-0]=arguments[l];return a=$(a,"map",[],(r=function(e){var n=r.$$s||this;return null==e&&(e=c),e=u(t.const_get_relative(ie,"Array")["$==="](e))?e.$to_a():t.const_get_relative(ie,"Opal").$coerce_to(e,t.const_get_relative(ie,"Array"),"to_ary").$to_a(),u(e["$equal?"](n))&&(e=e.$dup()),e},r.$$s=i,r.$$arity=1,r)),$(a,"each",[],(n=function(t){var e=n.$$s||this;null==t&&(t=c);for(var r=0,a=t.length;r<a;r++)e.push(t[r])},n.$$s=i,n.$$arity=1,n)),i},X.$$arity=-1),t.defn(ne,"$delete",J=function(e){var r=this,n=J.$$p,a=n||c;n&&(J.$$p=null);for(var i=r.length,o=0,s=i;o<s;o++)r[o]["$=="](e)&&(r.splice(o,1),s--,o--);return r.length===i?a!==c?t.yieldX(a,[]):c:e},J.$$arity=1),t.defn(ne,"$delete_at",W=function(e){var r=this;if(e=t.const_get_relative(ie,"Opal").$coerce_to(e,t.const_get_relative(ie,"Integer"),"to_int"),e<0&&(e+=r.length),e<0||e>=r.length)return c;var n=r[e];return r.splice(e,1),n},W.$$arity=1),t.defn(ne,"$delete_if",K=function(){var t,e=this,r=K.$$p,n=r||c;if(r&&(K.$$p=null),n===c)return $(e,"enum_for",["delete_if"],(t=function(){return(t.$$s||this).$size()},t.$$s=e,t.$$arity=0,t));for(var a,i=0,o=e.length;i<o;i++)!1!==(a=n(e[i]))&&a!==c&&(e.splice(i,1),o--,i--);return e},K.$$arity=0),t.defn(ne,"$dig",Z=function(e,r){var n,a=this,i=c,o=arguments.length,s=o-1;s<0&&(s=0),n=new Array(s);for(var l=1;l<o;l++)n[l-1]=arguments[l];return(i=a["$[]"](e))===c||0===n.length?i:(u(i["$respond_to?"]("dig"))||a.$raise(t.const_get_relative(ie,"TypeError"),i.$class()+" does not have #dig method"),$(i,"dig",t.to_a(n)))},Z.$$arity=-2),t.defn(ne,"$drop",tt=function(e){var r=this;return e<0&&r.$raise(t.const_get_relative(ie,"ArgumentError")),r.slice(e)},tt.$$arity=1),t.defn(ne,"$dup",et=function(){var e=this,r=et.$$p,n=c,a=c,i=c;for(r&&(et.$$p=null),a=0,i=arguments.length,n=new Array(i);a<i;a++)n[a]=arguments[a];return e.$$class===t.Array&&e.$$class.$allocate.$$pristine&&e.$copy_instance_variables.$$pristine&&e.$initialize_dup.$$pristine?e.slice(0):$(e,t.find_super_dispatcher(e,"dup",et,!1),n,r)},et.$$arity=0),t.defn(ne,"$each",rt=function(){var e,r=this,n=rt.$$p,a=n||c;if(n&&(rt.$$p=null),a===c)return $(r,"enum_for",["each"],(e=function(){return(e.$$s||this).$size()},e.$$s=r,e.$$arity=0,e));for(var i=0,o=r.length;i<o;i++){t.yield1(a,r[i])}return r},rt.$$arity=0),t.defn(ne,"$each_index",nt=function(){var e,r=this,n=nt.$$p,a=n||c;if(n&&(nt.$$p=null),a===c)return $(r,"enum_for",["each_index"],(e=function(){return(e.$$s||this).$size()},e.$$s=r,e.$$arity=0,e));for(var i=0,o=r.length;i<o;i++){t.yield1(a,i)}return r},nt.$$arity=0),t.defn(ne,"$empty?",at=function(){return 0===this.length},at.$$arity=0),t.defn(ne,"$eql?",it=function(t){function e(t,r){var a,i,o,s;if(!r.$$is_array)return!1;if(r=r.$to_a(),t.length!==r.length)return!1;for(n[t.$object_id()]=!0,a=0,i=t.length;a<i;a++)if(o=t[a],s=r[a],o.$$is_array){if(s.$$is_array&&s.length!==o.length)return!1;if(!n.hasOwnProperty(o.$object_id())&&!e(o,s))return!1}else if(!o["$eql?"](s))return!1;return!0}var r=this,n={};return e(r,t)},it.$$arity=1),t.defn(ne,"$fetch",ot=function(e,r){var n=this,a=ot.$$p,i=a||c;a&&(ot.$$p=null);var o=e;return e=t.const_get_relative(ie,"Opal").$coerce_to(e,t.const_get_relative(ie,"Integer"),"to_int"),e<0&&(e+=n.length),e>=0&&e<n.length?n[e]:(i!==c&&null!=r&&n.$warn("warning: block supersedes default value argument"),i!==c?i(o):null!=r?r:void(0===n.length?n.$raise(t.const_get_relative(ie,"IndexError"),"index "+o+" outside of array bounds: 0...0"):n.$raise(t.const_get_relative(ie,"IndexError"),"index "+o+" outside of array bounds: -"+n.length+"..."+n.length)))},ot.$$arity=-2),t.defn(ne,"$fill",st=function(e){var r,n,a,i=this,o=st.$$p,s=o||c,l=c,f=c,$=c,_=c,d=c,p=arguments.length,h=p-0;h<0&&(h=0),a=new Array(h);for(var g=0;g<p;g++)a[g-0]=arguments[g];o&&(st.$$p=null);var m,v;if(u(s)?(u(a.length>2)&&i.$raise(t.const_get_relative(ie,"ArgumentError"),"wrong number of arguments ("+a.$length()+" for 0..2)"),n=a,r=t.to_ary(n),l=null==r[0]?c:r[0],f=null==r[1]?c:r[1]):(u(0==a.length)?i.$raise(t.const_get_relative(ie,"ArgumentError"),"wrong number of arguments (0 for 1..3)"):u(a.length>3)&&i.$raise(t.const_get_relative(ie,"ArgumentError"),"wrong number of arguments ("+a.$length()+" for 1..3)"),n=a,r=t.to_ary(n),$=null==r[0]?c:r[0],l=null==r[1]?c:r[1],f=null==r[2]?c:r[2]),u(t.const_get_relative(ie,"Range")["$==="](l))){if(u(f)&&i.$raise(t.const_get_relative(ie,"TypeError"),"length invalid with range"),_=t.const_get_relative(ie,"Opal").$coerce_to(l.$begin(),t.const_get_relative(ie,"Integer"),"to_int"),u(_<0)&&(_+=this.length),u(_<0)&&i.$raise(t.const_get_relative(ie,"RangeError"),l.$inspect()+" out of range"),d=t.const_get_relative(ie,"Opal").$coerce_to(l.$end(),t.const_get_relative(ie,"Integer"),"to_int"),u(d<0)&&(d+=this.length),u(l["$exclude_end?"]())||(d+=1),u(d<=_))return i}else if(u(l))if(_=t.const_get_relative(ie,"Opal").$coerce_to(l,t.const_get_relative(ie,"Integer"),"to_int"),u(_<0)&&(_+=this.length),u(_<0)&&(_=0),u(f)){if(d=t.const_get_relative(ie,"Opal").$coerce_to(f,t.const_get_relative(ie,"Integer"),"to_int"),u(0==d))return i;d+=_}else d=this.length;else _=0,d=this.length;if(u(_>this.length))for(m=this.length;m<d;m++)i[m]=c;if(u(d>this.length)&&(this.length=d),u(s))for(this.length;_<d;_++)v=s(_),i[_]=v;else for(this.length;_<d;_++)i[_]=$;return i},st.$$arity=-1),t.defn(ne,"$first",ct=function(e){var r=this;return null==e?0===r.length?c:r[0]:(e=t.const_get_relative(ie,"Opal").$coerce_to(e,t.const_get_relative(ie,"Integer"),"to_int"),e<0&&r.$raise(t.const_get_relative(ie,"ArgumentError"),"negative array size"),r.slice(0,e))},ct.$$arity=-1),t.defn(ne,"$flatten",lt=function(e){function r(e,a){var i,o,s,l,u=[];for(e=e.$to_a(),i=0,o=e.length;i<o;i++)if(s=e[i],t.const_get_relative(ie,"Opal")["$respond_to?"](s,"to_ary"))if((l=s.$to_ary())!==c)switch(l.$$is_array||n.$raise(t.const_get_relative(ie,"TypeError")),l===n&&n.$raise(t.const_get_relative(ie,"ArgumentError")),a){case void 0:u=u.concat(r(l));break;case 0:u.push(l);break;default:u.push.apply(u,r(l,a-1))}else u.push(s);else u.push(s);return u}var n=this;return void 0!==e&&(e=t.const_get_relative(ie,"Opal").$coerce_to(e,t.const_get_relative(ie,"Integer"),"to_int")),h(r(n,e),n.$class())},lt.$$arity=-1),t.defn(ne,"$flatten!",ut=function(t){var e=this,r=e.$flatten(t);if(e.length==r.length){for(var n=0,a=e.length;n<a&&e[n]===r[n];n++);if(n==a)return c}return e.$replace(r),e},ut.$$arity=-1),t.defn(ne,"$hash",ft=function(){var e,r,n,a=this,i=void 0===t.hash_ids,o=["A"],s=a.$object_id();try{if(i&&(t.hash_ids=Object.create(null)),t.hash_ids[s])return"self";for(n in t.hash_ids)if(e=t.hash_ids[n],a["$eql?"](e))return"self";for(t.hash_ids[s]=a,r=0;r<a.length;r++)e=a[r],o.push(e.$hash());return o.join(",")}finally{i&&(t.hash_ids=void 0)}},ft.$$arity=0),t.defn(ne,"$include?",$t=function(t){for(var e=this,r=0,n=e.length;r<n;r++)if(e[r]["$=="](t))return!0;return!1},$t.$$arity=1),t.defn(ne,"$index",_t=function(t){var e=this,r=_t.$$p,n=r||c;r&&(_t.$$p=null);var a,i,o;if(null!=t&&n!==c&&e.$warn("warning: given block not used"),null!=t){for(a=0,i=e.length;a<i;a++)if(e[a]["$=="](t))return a}else{if(n===c)return e.$enum_for("index");for(a=0,i=e.length;a<i;a++)if(!1!==(o=n(e[a]))&&o!==c)return a}return c},_t.$$arity=-1),t.defn(ne,"$insert",dt=function(e,r){var n,a=this,i=arguments.length,o=i-1;o<0&&(o=0),n=new Array(o);for(var s=1;s<i;s++)n[s-1]=arguments[s];if(e=t.const_get_relative(ie,"Opal").$coerce_to(e,t.const_get_relative(ie,"Integer"),"to_int"),n.length>0){if(e<0&&(e+=a.length+1)<0&&a.$raise(t.const_get_relative(ie,"IndexError"),e+" is out of bounds"),e>a.length)for(var l=a.length;l<e;l++)a.push(c);a.splice.apply(a,[e,0].concat(n))}return a},dt.$$arity=-2),t.defn(ne,"$inspect",pt=function(){for(var t=this,e=[],r=t.$__id__(),n=0,a=t.length;n<a;n++){var i=t["$[]"](n);i.$__id__()===r?e.push("[...]"):e.push(i.$inspect())}return"["+e.join(", ")+"]"},pt.$$arity=0),t.defn(ne,"$join",ht=function(e){var r=this;if(null==_[","]&&(_[","]=c),null==e&&(e=c),u(0===r.length))return"";u(e===c)&&(e=_[","]);var n,a,i,o,s=[];for(n=0,a=r.length;n<a;n++)i=r[n],t.const_get_relative(ie,"Opal")["$respond_to?"](i,"to_str")&&(o=i.$to_str())!==c?s.push(o.$to_s()):t.const_get_relative(ie,"Opal")["$respond_to?"](i,"to_ary")&&(o=i.$to_ary(),o===r&&r.$raise(t.const_get_relative(ie,"ArgumentError")),o!==c)?s.push(o.$join(e)):t.const_get_relative(ie,"Opal")["$respond_to?"](i,"to_s")&&(o=i.$to_s())!==c?s.push(o):r.$raise(t.const_get_relative(ie,"NoMethodError").$new(t.inspect(i)+" doesn't respond to #to_str, #to_ary or #to_s","to_str"));return e===c?s.join(""):s.join(t.const_get_relative(ie,"Opal")["$coerce_to!"](e,t.const_get_relative(ie,"String"),"to_str").$to_s())},ht.$$arity=-1),t.defn(ne,"$keep_if",gt=function(){var t,e=this,r=gt.$$p,n=r||c;if(r&&(gt.$$p=null),n===c)return $(e,"enum_for",["keep_if"],(t=function(){return(t.$$s||this).$size()},t.$$s=e,t.$$arity=0,t));for(var a,i=0,o=e.length;i<o;i++)!1!==(a=n(e[i]))&&a!==c||(e.splice(i,1),o--,i--);return e},gt.$$arity=0),t.defn(ne,"$last",mt=function(e){var r=this;return null==e?0===r.length?c:r[r.length-1]:(e=t.const_get_relative(ie,"Opal").$coerce_to(e,t.const_get_relative(ie,"Integer"),"to_int"),e<0&&r.$raise(t.const_get_relative(ie,"ArgumentError"),"negative array size"),e>r.length&&(e=r.length),r.slice(r.length-e,r.length))},mt.$$arity=-1),t.defn(ne,"$length",vt=function(){return this.length},vt.$$arity=0),t.alias(ne,"map","collect"),t.alias(ne,"map!","collect!"),t.defn(ne,"$permutation",yt=function(e){var r,n=this,a=yt.$$p,i=a||c,o=c,s=c;if(a&&(yt.$$p=null),i===c)return $(n,"enum_for",["permutation",e],(r=function(){var t=r.$$s||this;return y(t.length,void 0===e?t.length:e)},r.$$s=n,r.$$arity=0,r));var l,u,f;if((e=void 0===e?n.length:t.const_get_relative(ie,"Opal").$coerce_to(e,t.const_get_relative(ie,"Integer"),"to_int"))<0||n.length<e);else if(0===e)t.yield1(i,[]);else if(1===e)for(var _=0;_<n.length;_++)t.yield1(i,[n[_]]);else o=t.const_get_relative(ie,"Array").$new(e),s=t.const_get_relative(ie,"Array").$new(n.length,!1),l=function(e,r,a,i,o){n=this;for(var s=0;s<n.length;s++)if(i["$[]"](s)["$!"]())if(r[a]=s,a<e-1)i[s]=!0,l.call(n,e,r,a+1,i,o),i[s]=!1;else{f=[];for(var c=0;c<r.length;c++)f.push(n[r[c]]);t.yield1(o,f)}},i!==c?(u=n.slice(),l.call(u,e,o,0,s,i)):l.call(n,e,o,0,s,i);return n},yt.$$arity=-1),t.defn(ne,"$repeated_permutation",bt=function(e){function r(e,n,a){if(n.length==e){var i=n.slice();return void t.yield1(s,i)}for(var o=0;o<a.length;o++)n.push(a[o]),r(e,n,a),n.pop()}var a,i=this,o=bt.$$p,s=o||c,l=c;return o&&(bt.$$p=null),l=t.const_get_relative(ie,"Opal")["$coerce_to!"](e,t.const_get_relative(ie,"Integer"),"to_int"),s===c?$(i,"enum_for",["repeated_permutation",l],(a=function(){var t=a.$$s||this;return u(n(l,0))?t.$size()["$**"](l):0},a.$$s=i,a.$$arity=0,a)):(r(l,[],i.slice()),i)},bt.$$arity=1),t.defn(ne,"$pop",wt=function(e){var r=this;return u(void 0===e)?u(0===r.length)?c:r.pop():(e=t.const_get_relative(ie,"Opal").$coerce_to(e,t.const_get_relative(ie,"Integer"),"to_int"),u(e<0)&&r.$raise(t.const_get_relative(ie,"ArgumentError"),"negative array size"),u(0===r.length)?[]:u(e>r.length)?r.splice(0,r.length):r.splice(r.length-e,r.length))},wt.$$arity=-1),t.defn(ne,"$product",xt=function(e){var r,n=this,a=xt.$$p,i=a||c,o=arguments.length,s=o-0;s<0&&(s=0),r=new Array(s);for(var l=0;l<o;l++)r[l-0]=arguments[l];a&&(xt.$$p=null);var u,f,$,_,d=i!==c?null:[],p=r.length+1,h=new Array(p),g=new Array(p),m=new Array(p),v=1;for(m[0]=n,u=1;u<p;u++)m[u]=t.const_get_relative(ie,"Opal").$coerce_to(r[u-1],t.const_get_relative(ie,"Array"),"to_ary");for(u=0;u<p;u++){if(0===(_=m[u].length))return d||n;v*=_,v>2147483647&&n.$raise(t.const_get_relative(ie,"RangeError"),"too big to product"),g[u]=_,h[u]=0}t:for(;;){for($=[],u=0;u<p;u++)$.push(m[u][h[u]]);for(d?d.push($):t.yield1(i,$),f=p-1,h[f]++;h[f]===g[f];){if(h[f]=0,--f<0)break t;h[f]++}}return d||n},xt.$$arity=-1),t.defn(ne,"$push",At=function(t){var e,r=this,n=arguments.length,a=n-0;a<0&&(a=0),e=new Array(a);for(var i=0;i<n;i++)e[i-0]=arguments[i];for(var o=0,s=e.length;o<s;o++)r.push(e[o]);return r},At.$$arity=-1),t.defn(ne,"$rassoc",kt=function(t){for(var e,r=this,n=0,a=r.length;n<a;n++)if(e=r[n],e.length&&void 0!==e[1]&&e[1]["$=="](t))return e;return c},kt.$$arity=1),t.defn(ne,"$reject",Et=function(){var t,e=this,r=Et.$$p,n=r||c;if(r&&(Et.$$p=null),n===c)return $(e,"enum_for",["reject"],(t=function(){return(t.$$s||this).$size()},t.$$s=e,t.$$arity=0,t));for(var a,i=[],o=0,s=e.length;o<s;o++)!1!==(a=n(e[o]))&&a!==c||i.push(e[o]);return i},Et.$$arity=0),t.defn(ne,"$reject!",St=function(){var t,e=this,r=St.$$p,n=r||c,a=c;return r&&(St.$$p=null),
n===c?$(e,"enum_for",["reject!"],(t=function(){return(t.$$s||this).$size()},t.$$s=e,t.$$arity=0,t)):(a=e.$length(),$(e,"delete_if",[],n.$to_proc()),e.$length()["$=="](a)?c:e)},St.$$arity=0),t.defn(ne,"$replace",Nt=function(e){var r=this;return e=u(t.const_get_relative(ie,"Array")["$==="](e))?e.$to_a():t.const_get_relative(ie,"Opal").$coerce_to(e,t.const_get_relative(ie,"Array"),"to_ary").$to_a(),r.splice(0,r.length),r.push.apply(r,e),r},Nt.$$arity=1),t.defn(ne,"$reverse",Ct=function(){return this.slice(0).reverse()},Ct.$$arity=0),t.defn(ne,"$reverse!",It=function(){return this.reverse()},It.$$arity=0),t.defn(ne,"$reverse_each",Ot=function(){var t,e=this,r=Ot.$$p,n=r||c;return r&&(Ot.$$p=null),n===c?$(e,"enum_for",["reverse_each"],(t=function(){return(t.$$s||this).$size()},t.$$s=e,t.$$arity=0,t)):($(e.$reverse(),"each",[],n.$to_proc()),e)},Ot.$$arity=0),t.defn(ne,"$rindex",Pt=function(t){var e=this,r=Pt.$$p,n=r||c;r&&(Pt.$$p=null);var a,i;if(null!=t&&n!==c&&e.$warn("warning: given block not used"),null!=t){for(a=e.length-1;a>=0&&!(a>=e.length);a--)if(e[a]["$=="](t))return a}else if(n!==c){for(a=e.length-1;a>=0&&!(a>=e.length);a--)if(!1!==(i=n(e[a]))&&i!==c)return a}else if(null==t)return e.$enum_for("rindex");return c},Pt.$$arity=-1),t.defn(ne,"$rotate",Lt=function(e){var r=this;null==e&&(e=1),e=t.const_get_relative(ie,"Opal").$coerce_to(e,t.const_get_relative(ie,"Integer"),"to_int");var n,a,i,o;return 1===r.length?r.slice():0===r.length?[]:(n=r.slice(),a=e%n.length,i=n.slice(a),o=n.slice(0,a),i.concat(o))},Lt.$$arity=-1),t.defn(ne,"$rotate!",Mt=function(e){var r=this,n=c;return null==e&&(e=1),0===r.length||1===r.length?r:(e=t.const_get_relative(ie,"Opal").$coerce_to(e,t.const_get_relative(ie,"Integer"),"to_int"),n=r.$rotate(e),r.$replace(n))},Mt.$$arity=-1),function(e,r,n){function a(){}var i,o,s=a=l(e,null,"SampleRandom",a),f=s.$$proto,$=[s].concat(n);f.rng=c,t.defn(s,"$initialize",i=function(t){return this.rng=t},i.$$arity=1),t.defn(s,"$rand",o=function(e){var r=this,n=c;return n=t.const_get_relative($,"Opal").$coerce_to(r.rng.$rand(e),t.const_get_relative($,"Integer"),"to_int"),u(n<0)&&r.$raise(t.const_get_relative($,"RangeError"),"random value must be >= 0"),u(n<e)||r.$raise(t.const_get_relative($,"RangeError"),"random value must be less than Array size"),n},o.$$arity=1)}(ie[0],0,ie),t.defn(ne,"$sample",Tt=function(e,r){var n,a=this,i=c,o=c;if(u(void 0===e))return a.$at(t.const_get_relative(ie,"Kernel").$rand(a.length));if(u(void 0===r)?u(i=t.const_get_relative(ie,"Opal")["$coerce_to?"](e,t.const_get_relative(ie,"Hash"),"to_hash"))?(r=i,e=c):(r=c,e=t.const_get_relative(ie,"Opal").$coerce_to(e,t.const_get_relative(ie,"Integer"),"to_int")):(e=t.const_get_relative(ie,"Opal").$coerce_to(e,t.const_get_relative(ie,"Integer"),"to_int"),r=t.const_get_relative(ie,"Opal").$coerce_to(r,t.const_get_relative(ie,"Hash"),"to_hash")),u(u(n=e)?e<0:n)&&a.$raise(t.const_get_relative(ie,"ArgumentError"),"count must be greater than 0"),u(r)&&(o=r["$[]"]("random")),o=u(u(n=o)?o["$respond_to?"]("rand"):n)?t.const_get_relative(ie,"SampleRandom").$new(o):t.const_get_relative(ie,"Kernel"),!u(e))return a[o.$rand(a.length)];var s,l,f,$,_,d,p,h;switch(e>a.length&&(e=a.length),e){case 0:return[];case 1:return[a[o.$rand(a.length)]];case 2:return $=o.$rand(a.length),_=o.$rand(a.length),$===_&&(_=0===$?$+1:$-1),[a[$],a[_]];default:if(a.length/e>3){for(s=!1,l=0,f=t.const_get_relative(ie,"Array").$new(e),$=1,f[0]=o.$rand(a.length);$<e;){for(d=o.$rand(a.length),_=0;_<$;){for(;d===f[_];){if(++l>100){s=!0;break}d=o.$rand(a.length)}if(s)break;_++}if(s)break;f[$]=d,$++}if(!s){for($=0;$<e;)f[$]=a[f[$]],$++;return f}}f=a.slice();for(var g=0;g<e;g++)p=o.$rand(a.length),h=f[g],f[g]=f[p],f[p]=h;return e===a.length?f:f["$[]"](0,e)}},Tt.$$arity=-1),t.defn(ne,"$select",Bt=function(){var e,r=this,n=Bt.$$p,a=n||c;if(n&&(Bt.$$p=null),a===c)return $(r,"enum_for",["select"],(e=function(){return(e.$$s||this).$size()},e.$$s=r,e.$$arity=0,e));for(var i,o,s=[],l=0,u=r.length;l<u;l++)i=r[l],!1!==(o=t.yield1(a,i))&&o!==c&&s.push(i);return s},Bt.$$arity=0),t.defn(ne,"$select!",jt=function(){var t,e=this,r=jt.$$p,n=r||c;if(r&&(jt.$$p=null),n===c)return $(e,"enum_for",["select!"],(t=function(){return(t.$$s||this).$size()},t.$$s=e,t.$$arity=0,t));var a=e.length;return $(e,"keep_if",[],n.$to_proc()),e.length===a?c:e},jt.$$arity=0),t.defn(ne,"$shift",Ft=function(e){var r=this;return u(void 0===e)?u(0===r.length)?c:r.shift():(e=t.const_get_relative(ie,"Opal").$coerce_to(e,t.const_get_relative(ie,"Integer"),"to_int"),u(e<0)&&r.$raise(t.const_get_relative(ie,"ArgumentError"),"negative array size"),u(0===r.length)?[]:r.splice(0,e))},Ft.$$arity=-1),t.alias(ne,"size","length"),t.defn(ne,"$shuffle",Rt=function(t){return this.$dup().$to_a()["$shuffle!"](t)},Rt.$$arity=-1),t.defn(ne,"$shuffle!",qt=function(e){var r,n,a,i=this,o=i.length;for(void 0!==e&&(e=t.const_get_relative(ie,"Opal")["$coerce_to?"](e,t.const_get_relative(ie,"Hash"),"to_hash"))!==c&&(e=e["$[]"]("random"))!==c&&e["$respond_to?"]("rand")&&(r=e);o;)r?(n=r.$rand(o).$to_int(),n<0&&i.$raise(t.const_get_relative(ie,"RangeError"),"random number too small "+n),n>=o&&i.$raise(t.const_get_relative(ie,"RangeError"),"random number too big "+n)):n=i.$rand(o),a=i[--o],i[o]=i[n],i[n]=a;return i},qt.$$arity=-1),t.alias(ne,"slice","[]"),t.defn(ne,"$slice!",Dt=function(e,r){var n=this,a=c,i=c,o=c,s=c,l=c;if(a=c,u(void 0===r))if(u(t.const_get_relative(ie,"Range")["$==="](e))){i=e,a=n["$[]"](i),o=t.const_get_relative(ie,"Opal").$coerce_to(i.$begin(),t.const_get_relative(ie,"Integer"),"to_int"),s=t.const_get_relative(ie,"Opal").$coerce_to(i.$end(),t.const_get_relative(ie,"Integer"),"to_int"),o<0&&(o+=n.length),s<0?s+=n.length:s>=n.length&&(s=n.length-1,i.excl&&(s+=1));var f=s-o;i.excl?s-=1:f+=1,o<n.length&&o>=0&&s<n.length&&s>=0&&f>0&&n.splice(o,f)}else{if(l=t.const_get_relative(ie,"Opal").$coerce_to(e,t.const_get_relative(ie,"Integer"),"to_int"),l<0&&(l+=n.length),l<0||l>=n.length)return c;a=n[l],0===l?n.shift():n.splice(l,1)}else{if(l=t.const_get_relative(ie,"Opal").$coerce_to(e,t.const_get_relative(ie,"Integer"),"to_int"),(r=t.const_get_relative(ie,"Opal").$coerce_to(r,t.const_get_relative(ie,"Integer"),"to_int"))<0)return c;a=n["$[]"](l,r),l<0&&(l+=n.length),l+r>n.length&&(r=n.length-l),l<n.length&&l>=0&&n.splice(l,r)}return a},Dt.$$arity=-2),t.defn(ne,"$sort",zt=function(){var r=this,n=zt.$$p,i=n||c;return n&&(zt.$$p=null),u(r.length>1)?(i===c&&(i=function(t,e){return t["$<=>"](e)}),r.slice().sort(function(n,o){var s=i(n,o);return s===c&&r.$raise(t.const_get_relative(ie,"ArgumentError"),"comparison of "+n.$inspect()+" with "+o.$inspect()+" failed"),e(s,0)?1:a(s,0)?-1:0})):r},zt.$$arity=0),t.defn(ne,"$sort!",Ut=function(){var t=this,e=Ut.$$p,r=e||c;e&&(Ut.$$p=null);var n;n=r!==c?$(t.slice(),"sort",[],r.$to_proc()):t.slice().$sort(),t.length=0;for(var a=0,i=n.length;a<i;a++)t.push(n[a]);return t},Ut.$$arity=0),t.defn(ne,"$sort_by!",Ht=function(){var t,e=this,r=Ht.$$p,n=r||c;return r&&(Ht.$$p=null),n===c?$(e,"enum_for",["sort_by!"],(t=function(){return(t.$$s||this).$size()},t.$$s=e,t.$$arity=0,t)):e.$replace($(e,"sort_by",[],n.$to_proc()))},Ht.$$arity=0),t.defn(ne,"$take",Gt=function(e){var r=this;return e<0&&r.$raise(t.const_get_relative(ie,"ArgumentError")),r.slice(0,e)},Gt.$$arity=1),t.defn(ne,"$take_while",Yt=function(){var t=this,e=Yt.$$p,r=e||c;e&&(Yt.$$p=null);for(var n,a,i=[],o=0,s=t.length;o<s;o++){if(n=t[o],!1===(a=r(n))||a===c)return i;i.push(n)}return i},Yt.$$arity=0),t.defn(ne,"$to_a",Vt=function(){return this},Vt.$$arity=0),t.alias(ne,"to_ary","to_a"),t.defn(ne,"$to_h",Qt=function(){var e,r,n,a,i=this,o=i.length,s=f([],{});for(e=0;e<o;e++)r=t.const_get_relative(ie,"Opal")["$coerce_to?"](i[e],t.const_get_relative(ie,"Array"),"to_ary"),r.$$is_array||i.$raise(t.const_get_relative(ie,"TypeError"),"wrong element type "+r.$class()+" at "+e+" (expected array)"),2!==r.length&&i.$raise(t.const_get_relative(ie,"ArgumentError"),"wrong array length at "+e+" (expected 2, was "+r.$length()+")"),n=r[0],a=r[1],t.hash_put(s,n,a);return s},Qt.$$arity=0),t.alias(ne,"to_s","inspect"),t.defn(ne,"$transpose",Xt=function(){var e,r=this,n=c,a=c;return u(r["$empty?"]())?[]:(n=[],a=c,$(r,"each",[],(e=function(r){var o,s,l=e.$$s||this;return null==r&&(r=c),r=u(t.const_get_relative(ie,"Array")["$==="](r))?r.$to_a():t.const_get_relative(ie,"Opal").$coerce_to(r,t.const_get_relative(ie,"Array"),"to_ary").$to_a(),a=u(o=a)?o:r.length,u(r.length["$!="](a))&&l.$raise(t.const_get_relative(ie,"IndexError"),"element size differs ("+r.length+" should be "+a+")"),$(r.length,"times",[],(s=function(e){var a,o=(s.$$s,c),l=c;return null==e&&(e=c),o=u(a=n["$[]"](e))?a:(l=[e,[]],$(n,"[]=",t.to_a(l)),l[i(l.length,1)]),o["$<<"](r.$at(e))},s.$$s=l,s.$$arity=1,s))},e.$$s=r,e.$$arity=1,e)),n)},Xt.$$arity=0),t.defn(ne,"$uniq",Jt=function(){var e=this,r=Jt.$$p,n=r||c;r&&(Jt.$$p=null);var a,i,o,s,l=f([],{});if(n===c)for(a=0,i=e.length;a<i;a++)o=e[a],void 0===t.hash_get(l,o)&&t.hash_put(l,o,o);else for(a=0,i=e.length;a<i;a++)o=e[a],s=t.yield1(n,o),void 0===t.hash_get(l,s)&&t.hash_put(l,s,o);return h(l.$values(),e.$class())},Jt.$$arity=0),t.defn(ne,"$uniq!",Wt=function(){var e=this,r=Wt.$$p,n=r||c;r&&(Wt.$$p=null);var a,i,o,s,l=e.length,u=f([],{});for(a=0,i=l;a<i;a++)o=e[a],s=n===c?o:t.yield1(n,o),void 0!==t.hash_get(u,s)?(e.splice(a,1),i--,a--):t.hash_put(u,s,o);return e.length===l?c:e},Wt.$$arity=0),t.defn(ne,"$unshift",Kt=function(t){var e,r=this,n=arguments.length,a=n-0;a<0&&(a=0),e=new Array(a);for(var i=0;i<n;i++)e[i-0]=arguments[i];for(var o=e.length-1;o>=0;o--)r.unshift(e[o]);return r},Kt.$$arity=-1),t.defn(ne,"$values_at",Zt=function(e){var r,n,a=this,i=c,o=arguments.length,s=o-0;s<0&&(s=0),n=new Array(s);for(var l=0;l<o;l++)n[l-0]=arguments[l];return i=[],$(n,"each",[],(r=function(e){var n,a=r.$$s||this,o=c,s=c,l=c;return null==e&&(e=c),u(e["$kind_of?"](t.const_get_relative(ie,"Range")))?(o=t.const_get_relative(ie,"Opal").$coerce_to(e.$last(),t.const_get_relative(ie,"Integer"),"to_int"),(s=t.const_get_relative(ie,"Opal").$coerce_to(e.$first(),t.const_get_relative(ie,"Integer"),"to_int"))<0?(s+=a.length,c):(o<0&&(o+=a.length),e["$exclude_end?"]()&&o--,o<s?c:$(s,"upto",[o],(n=function(t){var e=n.$$s||this;return null==t&&(t=c),i["$<<"](e.$at(t))},n.$$s=a,n.$$arity=1,n)))):(l=t.const_get_relative(ie,"Opal").$coerce_to(e,t.const_get_relative(ie,"Integer"),"to_int"),i["$<<"](a.$at(l)))},r.$$s=a,r.$$arity=1,r)),i},Zt.$$arity=-1),t.defn(ne,"$zip",te=function(e){var r,n,a=this,i=te.$$p,o=i||c,s=arguments.length,l=s-0;l<0&&(l=0),n=new Array(l);for(var f=0;f<s;f++)n[f-0]=arguments[f];i&&(te.$$p=null);var $,_,d,p,h,g=[],m=a.length;for(p=0,h=n.length;p<h;p++)_=n[p],_.$$is_array||(_.$$is_enumerator?_.$size()===1/0?n[p]=_.$take(m):n[p]=_.$to_a():n[p]=(u(r=t.const_get_relative(ie,"Opal")["$coerce_to?"](_,t.const_get_relative(ie,"Array"),"to_ary"))?r:t.const_get_relative(ie,"Opal")["$coerce_to!"](_,t.const_get_relative(ie,"Enumerator"),"each")).$to_a());for(d=0;d<m;d++){for($=[a[d]],p=0,h=n.length;p<h;p++)_=n[p][d],null==_&&(_=c),$[p+1]=_;g[d]=$}if(o!==c){for(d=0;d<m;d++)o(g[d]);return c}return g},te.$$arity=-1),t.defs(ne,"$inherited",ee=function(t){t.$$proto.$to_a=function(){return this.slice(0,this.length)}},ee.$$arity=1),t.defn(ne,"$instance_variables",re=function(){var e,r=this,n=re.$$p,a=c,i=c,o=c;for(n&&(re.$$p=null),i=0,o=arguments.length,a=new Array(o);i<o;i++)a[i]=arguments[i];return $($(r,t.find_super_dispatcher(r,"instance_variables",re,!1),a,n),"reject",[],(e=function(t){var r;e.$$s;return null==t&&(t=c),u(r=/^@\d+$/.test(t))?r:t["$=="]("@length")},e.$$s=r,e.$$arity=1,e))},re.$$arity=0),t.const_get_relative(ie,"Opal").$pristine(ne,"allocate","copy_instance_variables","initialize_dup")}(s[0],Array,s)},Opal.modules["corelib/hash"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t>=e:t["$>="](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t>e:t["$>"](e)}function n(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}var a=t.top,i=[],o=t.nil,s=(t.breaker,t.slice,t.klass),c=t.send,l=t.hash2,u=t.truthy;return t.add_stubs(["$require","$include","$coerce_to?","$[]","$merge!","$allocate","$raise","$coerce_to!","$each","$fetch","$>=","$>","$==","$compare_by_identity","$lambda?","$abs","$arity","$call","$enum_for","$size","$respond_to?","$class","$dig","$inspect","$map","$to_proc","$flatten","$eql?","$default","$dup","$default_proc","$default_proc=","$-","$default=","$alias_method","$proc"]),a.$require("corelib/enumerable"),function(a,i,f){function $(){}var _,d,p,h,g,m,v,y,b,w,x,A,k,E,S,N,C,I,O,P,L,M,T,B,j,F,R,q,D,z,U,H,G,Y,V,Q,X,J,W,K,Z,tt,et,rt,nt,at,it,ot,st,ct,lt,ut,ft,$t,_t,dt,pt,ht,gt,mt=$=s(a,null,"Hash",$),vt=mt.$$proto,yt=[mt].concat(f);mt.$include(t.const_get_relative(yt,"Enumerable")),vt.$$is_hash=!0,t.defs(mt,"$[]",_=function(e){var r,n=this,a=arguments.length,i=a-0;i<0&&(i=0),r=new Array(i);for(var s=0;s<a;s++)r[s-0]=arguments[s];var c,l,u=r.length;if(1===u){if((c=t.const_get_relative(yt,"Opal")["$coerce_to?"](r["$[]"](0),t.const_get_relative(yt,"Hash"),"to_hash"))!==o)return n.$allocate()["$merge!"](c);for(r=t.const_get_relative(yt,"Opal")["$coerce_to?"](r["$[]"](0),t.const_get_relative(yt,"Array"),"to_ary"),r===o&&n.$raise(t.const_get_relative(yt,"ArgumentError"),"odd number of arguments for Hash"),u=r.length,c=n.$allocate(),l=0;l<u;l++)if(r[l].$$is_array)switch(r[l].length){case 1:c.$store(r[l][0],o);break;case 2:c.$store(r[l][0],r[l][1]);break;default:n.$raise(t.const_get_relative(yt,"ArgumentError"),"invalid number of elements ("+r[l].length+" for 1..2)")}return c}for(u%2!=0&&n.$raise(t.const_get_relative(yt,"ArgumentError"),"odd number of arguments for Hash"),c=n.$allocate(),l=0;l<u;l+=2)c.$store(r[l],r[l+1]);return c},_.$$arity=-1),t.defs(mt,"$allocate",d=function(){var e=this,r=new e.$$alloc;return t.hash_init(r),r.$$none=o,r.$$proc=o,r},d.$$arity=0),t.defs(mt,"$try_convert",p=function(e){return t.const_get_relative(yt,"Opal")["$coerce_to?"](e,t.const_get_relative(yt,"Hash"),"to_hash")},p.$$arity=1),t.defn(mt,"$initialize",h=function(e){var r=this,n=h.$$p,a=n||o;return n&&(h.$$p=null),void 0!==e&&a!==o&&r.$raise(t.const_get_relative(yt,"ArgumentError"),"wrong number of arguments (1 for 0)"),r.$$none=void 0===e?o:e,r.$$proc=a,r},h.$$arity=-1),t.defn(mt,"$==",g=function(e){var r=this;if(r===e)return!0;if(!e.$$is_hash)return!1;if(r.$$keys.length!==e.$$keys.length)return!1;for(var n,a,i,o=0,s=r.$$keys,c=s.length;o<c;o++)if(n=s[o],n.$$is_string?(a=r.$$smap[n],i=e.$$smap[n]):(a=n.value,i=t.hash_get(e,n.key)),void 0===i||!a["$eql?"](i))return!1;return!0},g.$$arity=1),t.defn(mt,"$>=",m=function(e){var r,n=this,a=o;return e=t.const_get_relative(yt,"Opal")["$coerce_to!"](e,t.const_get_relative(yt,"Hash"),"to_hash"),!(n.$$keys.length<e.$$keys.length)&&(a=!0,c(e,"each",[],(r=function(t,e){var n=r.$$s||this,i=o;if(null==t&&(t=o),null==e&&(e=o),null==(i=n.$fetch(t,null))||i!==e)return void(a=!1)},r.$$s=n,r.$$arity=2,r)),a)},m.$$arity=1),t.defn(mt,"$>",v=function(r){var n=this;return r=t.const_get_relative(yt,"Opal")["$coerce_to!"](r,t.const_get_relative(yt,"Hash"),"to_hash"),!(n.$$keys.length<=r.$$keys.length)&&e(n,r)},v.$$arity=1),t.defn(mt,"$<",y=function(e){var n=this;return e=t.const_get_relative(yt,"Opal")["$coerce_to!"](e,t.const_get_relative(yt,"Hash"),"to_hash"),r(e,n)},y.$$arity=1),t.defn(mt,"$<=",b=function(r){var n=this;return r=t.const_get_relative(yt,"Opal")["$coerce_to!"](r,t.const_get_relative(yt,"Hash"),"to_hash"),e(r,n)},b.$$arity=1),t.defn(mt,"$[]",w=function(e){var r=this,n=t.hash_get(r,e);return void 0!==n?n:r.$default(e)},w.$$arity=1),t.defn(mt,"$[]=",x=function(e,r){var n=this;return t.hash_put(n,e,r),r},x.$$arity=2),t.defn(mt,"$assoc",A=function(t){for(var e,r=this,n=0,a=r.$$keys,i=a.length;n<i;n++)if(e=a[n],e.$$is_string){if(e["$=="](t))return[e,r.$$smap[e]]}else if(e.key["$=="](t))return[e.key,e.value];return o},A.$$arity=1),t.defn(mt,"$clear",k=function(){var e=this;return t.hash_init(e),e},k.$$arity=0),t.defn(mt,"$clone",E=function(){var e=this,r=new e.$$class.$$alloc;return t.hash_init(r),t.hash_clone(e,r),r},E.$$arity=0),t.defn(mt,"$compact",S=function(){for(var e,r,n=this,a=t.hash(),i=0,s=n.$$keys,c=s.length;i<c;i++)e=s[i],e.$$is_string?r=n.$$smap[e]:(r=e.value,e=e.key),r!==o&&t.hash_put(a,e,r);return a},S.$$arity=0),t.defn(mt,"$compact!",N=function(){for(var e,r,n=this,a=!1,i=0,s=n.$$keys,c=s.length;i<c;i++)e=s[i],e.$$is_string?r=n.$$smap[e]:(r=e.value,e=e.key),r===o&&void 0!==t.hash_delete(n,e)&&(a=!0,c--,i--);return a?n:o},N.$$arity=0),t.defn(mt,"$compare_by_identity",C=function(){var e,r,n,a,i=this,o=i.$$keys;if(i.$$by_identity)return i;if(0===i.$$keys.length)return i.$$by_identity=!0,i;for(a=l([],{}).$compare_by_identity(),e=0,r=o.length;e<r;e++)n=o[e],n.$$is_string||(n=n.key),t.hash_put(a,n,t.hash_get(i,n));return i.$$by_identity=!0,i.$$map=a.$$map,i.$$smap=a.$$smap,i},C.$$arity=0),t.defn(mt,"$compare_by_identity?",I=function(){return!0===this.$$by_identity},I.$$arity=0),t.defn(mt,"$default",O=function(t){var e=this;return void 0!==t&&e.$$proc!==o&&void 0!==e.$$proc?e.$$proc.$call(e,t):void 0===e.$$none?o:e.$$none},O.$$arity=-1),t.defn(mt,"$default=",P=function(t){var e=this;return e.$$proc=o,e.$$none=t,t},P.$$arity=1),t.defn(mt,"$default_proc",L=function(){var t=this;return void 0!==t.$$proc?t.$$proc:o},L.$$arity=0),t.defn(mt,"$default_proc=",M=function(e){var r=this,n=e;return n!==o&&(n=t.const_get_relative(yt,"Opal")["$coerce_to!"](n,t.const_get_relative(yt,"Proc"),"to_proc"),n["$lambda?"]()&&2!==n.$arity().$abs()&&r.$raise(t.const_get_relative(yt,"TypeError"),"default_proc takes two arguments")),r.$$none=o,r.$$proc=n,e},M.$$arity=1),t.defn(mt,"$delete",T=function(e){var r=this,n=T.$$p,a=n||o;n&&(T.$$p=null);var i=t.hash_delete(r,e);return void 0!==i?i:a!==o?a.$call(e):o},T.$$arity=1),t.defn(mt,"$delete_if",B=function(){var e,r=this,n=B.$$p,a=n||o;if(n&&(B.$$p=null),!u(a))return c(r,"enum_for",["delete_if"],(e=function(){return(e.$$s||this).$size()},e.$$s=r,e.$$arity=0,e));for(var i,s,l,f=0,$=r.$$keys,_=$.length;f<_;f++)i=$[f],i.$$is_string?s=r.$$smap[i]:(s=i.value,i=i.key),!1!==(l=a(i,s))&&l!==o&&void 0!==t.hash_delete(r,i)&&(_--,f--);return r},B.$$arity=0),t.alias(mt,"dup","clone"),t.defn(mt,"$dig",j=function(e,r){var n,a=this,i=o,s=arguments.length,l=s-1;l<0&&(l=0),n=new Array(l);for(var f=1;f<s;f++)n[f-1]=arguments[f];return(i=a["$[]"](e))===o||0===n.length?i:(u(i["$respond_to?"]("dig"))||a.$raise(t.const_get_relative(yt,"TypeError"),i.$class()+" does not have #dig method"),c(i,"dig",t.to_a(n)))},j.$$arity=-2),t.defn(mt,"$each",F=function(){var e,r=this,n=F.$$p,a=n||o;if(n&&(F.$$p=null),!u(a))return c(r,"enum_for",["each"],(e=function(){return(e.$$s||this).$size()},e.$$s=r,e.$$arity=0,e));for(var i,s,l=0,f=r.$$keys,$=f.length;l<$;l++)i=f[l],i.$$is_string?s=r.$$smap[i]:(s=i.value,i=i.key),t.yield1(a,[i,s]);return r},F.$$arity=0),t.defn(mt,"$each_key",R=function(){var t,e=this,r=R.$$p,n=r||o;if(r&&(R.$$p=null),!u(n))return c(e,"enum_for",["each_key"],(t=function(){return(t.$$s||this).$size()},t.$$s=e,t.$$arity=0,t));for(var a,i=0,s=e.$$keys,l=s.length;i<l;i++)a=s[i],n(a.$$is_string?a:a.key);return e},R.$$arity=0),t.alias(mt,"each_pair","each"),t.defn(mt,"$each_value",q=function(){var t,e=this,r=q.$$p,n=r||o;if(r&&(q.$$p=null),!u(n))return c(e,"enum_for",["each_value"],(t=function(){return(t.$$s||this).$size()},t.$$s=e,t.$$arity=0,t));for(var a,i=0,s=e.$$keys,l=s.length;i<l;i++)a=s[i],n(a.$$is_string?e.$$smap[a]:a.value);return e},q.$$arity=0),t.defn(mt,"$empty?",D=function(){return 0===this.$$keys.length},D.$$arity=0),t.alias(mt,"eql?","=="),t.defn(mt,"$fetch",z=function(e,r){var n=this,a=z.$$p,i=a||o;a&&(z.$$p=null);var s=t.hash_get(n,e);return void 0!==s?s:i!==o?i(e):void 0!==r?r:n.$raise(t.const_get_relative(yt,"KeyError"),"key not found: "+e.$inspect())},z.$$arity=-2),t.defn(mt,"$fetch_values",U=function(t){var e,r,n=this,a=U.$$p,i=a||o,s=arguments.length,l=s-0;l<0&&(l=0),r=new Array(l);for(var u=0;u<s;u++)r[u-0]=arguments[u];return a&&(U.$$p=null),c(r,"map",[],(e=function(t){var r=e.$$s||this;return null==t&&(t=o),c(r,"fetch",[t],i.$to_proc())},e.$$s=n,e.$$arity=1,e))},U.$$arity=-1),t.defn(mt,"$flatten",H=function(e){var r=this;null==e&&(e=1),e=t.const_get_relative(yt,"Opal")["$coerce_to!"](e,t.const_get_relative(yt,"Integer"),"to_int");for(var n,a,i=[],o=0,s=r.$$keys,c=s.length;o<c;o++)if(n=s[o],n.$$is_string?a=r.$$smap[n]:(a=n.value,n=n.key),i.push(n),a.$$is_array){if(1===e){i.push(a);continue}i=i.concat(a.$flatten(e-2))}else i.push(a);return i},H.$$arity=-1),t.defn(mt,"$has_key?",G=function(e){var r=this;return void 0!==t.hash_get(r,e)},G.$$arity=1),t.defn(mt,"$has_value?",Y=function(t){for(var e,r=this,n=0,a=r.$$keys,i=a.length;n<i;n++)if(e=a[n],(e.$$is_string?r.$$smap[e]:e.value)["$=="](t))return!0;return!1},Y.$$arity=1),t.defn(mt,"$hash",V=function(){var e,r,n=this,a=void 0===t.hash_ids,i=n.$object_id(),o=["Hash"];try{if(a&&(t.hash_ids=Object.create(null)),t[i])return"self";for(e in t.hash_ids)if(r=t.hash_ids[e],n["$eql?"](r))return"self";t.hash_ids[i]=n;for(var s=0,c=n.$$keys,l=c.length;s<l;s++)e=c[s],e.$$is_string?o.push([e,n.$$smap[e].$hash()]):o.push([e.key_hash,e.value.$hash()]);return o.sort().join()}finally{a&&(t.hash_ids=void 0)}},V.$$arity=0),t.alias(mt,"include?","has_key?"),t.defn(mt,"$index",Q=function(t){for(var e,r,n=this,a=0,i=n.$$keys,s=i.length;a<s;a++)if(e=i[a],e.$$is_string?r=n.$$smap[e]:(r=e.value,e=e.key),r["$=="](t))return e;return o},Q.$$arity=1),t.defn(mt,"$indexes",X=function(e){var r,n=this,a=arguments.length,i=a-0;i<0&&(i=0),r=new Array(i);for(var o=0;o<a;o++)r[o-0]=arguments[o];for(var s,c,l=[],u=0,f=r.length;u<f;u++)s=r[u],c=t.hash_get(n,s),void 0!==c?l.push(c):l.push(n.$default());return l},X.$$arity=-1),t.alias(mt,"indices","indexes");var bt;return t.defn(mt,"$inspect",J=function(){var t=this,e=void 0===bt,r=t.$object_id(),n=[];try{if(e&&(bt={}),bt.hasOwnProperty(r))return"{...}";bt[r]=!0;for(var a,i,o=0,s=t.$$keys,c=s.length;o<c;o++)a=s[o],a.$$is_string?i=t.$$smap[a]:(i=a.value,a=a.key),n.push(a.$inspect()+"=>"+i.$inspect());return"{"+n.join(", ")+"}"}finally{e&&(bt=void 0)}},J.$$arity=0),t.defn(mt,"$invert",W=function(){for(var e,r,n=this,a=t.hash(),i=0,o=n.$$keys,s=o.length;i<s;i++)e=o[i],e.$$is_string?r=n.$$smap[e]:(r=e.value,e=e.key),t.hash_put(a,r,e);return a},W.$$arity=0),t.defn(mt,"$keep_if",K=function(){var e,r=this,n=K.$$p,a=n||o;if(n&&(K.$$p=null),!u(a))return c(r,"enum_for",["keep_if"],(e=function(){return(e.$$s||this).$size()},e.$$s=r,e.$$arity=0,e));for(var i,s,l,f=0,$=r.$$keys,_=$.length;f<_;f++)i=$[f],i.$$is_string?s=r.$$smap[i]:(s=i.value,i=i.key),!1!==(l=a(i,s))&&l!==o||void 0!==t.hash_delete(r,i)&&(_--,f--);return r},K.$$arity=0),t.alias(mt,"key","index"),t.alias(mt,"key?","has_key?"),t.defn(mt,"$keys",Z=function(){for(var t,e=this,r=[],n=0,a=e.$$keys,i=a.length;n<i;n++)t=a[n],t.$$is_string?r.push(t):r.push(t.key);return r},Z.$$arity=0),t.defn(mt,"$length",tt=function(){return this.$$keys.length},tt.$$arity=0),t.alias(mt,"member?","has_key?"),t.defn(mt,"$merge",et=function(t){var e=this,r=et.$$p,n=r||o;return r&&(et.$$p=null),c(e.$dup(),"merge!",[t],n.$to_proc())},et.$$arity=1),t.defn(mt,"$merge!",rt=function(e){var r=this,n=rt.$$p,a=n||o;n&&(rt.$$p=null),e.$$is_hash||(e=t.const_get_relative(yt,"Opal")["$coerce_to!"](e,t.const_get_relative(yt,"Hash"),"to_hash"));var i,s,c,l,u=e.$$keys,f=u.length;if(a===o){for(i=0;i<f;i++)s=u[i],s.$$is_string?l=e.$$smap[s]:(l=s.value,s=s.key),t.hash_put(r,s,l);return r}for(i=0;i<f;i++)s=u[i],s.$$is_string?l=e.$$smap[s]:(l=s.value,s=s.key),c=t.hash_get(r,s),void 0!==c?t.hash_put(r,s,a(s,c,l)):t.hash_put(r,s,l);return r},rt.$$arity=1),t.defn(mt,"$rassoc",nt=function(t){for(var e,r,n=this,a=0,i=n.$$keys,s=i.length;a<s;a++)if(e=i[a],e.$$is_string?r=n.$$smap[e]:(r=e.value,e=e.key),r["$=="](t))return[e,r];return o},nt.$$arity=1),t.defn(mt,"$rehash",at=function(){var e=this;return t.hash_rehash(e),e},at.$$arity=0),t.defn(mt,"$reject",it=function(){var e,r=this,n=it.$$p,a=n||o;if(n&&(it.$$p=null),!u(a))return c(r,"enum_for",["reject"],(e=function(){return(e.$$s||this).$size()},e.$$s=r,e.$$arity=0,e));for(var i,s,l,f=t.hash(),$=0,_=r.$$keys,d=_.length;$<d;$++)i=_[$],i.$$is_string?s=r.$$smap[i]:(s=i.value,i=i.key),!1!==(l=a(i,s))&&l!==o||t.hash_put(f,i,s);return f},it.$$arity=0),t.defn(mt,"$reject!",ot=function(){var e,r=this,n=ot.$$p,a=n||o;if(n&&(ot.$$p=null),!u(a))return c(r,"enum_for",["reject!"],(e=function(){return(e.$$s||this).$size()},e.$$s=r,e.$$arity=0,e));for(var i,s,l,f=!1,$=0,_=r.$$keys,d=_.length;$<d;$++)i=_[$],i.$$is_string?s=r.$$smap[i]:(s=i.value,i=i.key),!1!==(l=a(i,s))&&l!==o&&void 0!==t.hash_delete(r,i)&&(f=!0,d--,$--);return f?r:o},ot.$$arity=0),t.defn(mt,"$replace",st=function(e){var r=this,a=o;e=t.const_get_relative(yt,"Opal")["$coerce_to!"](e,t.const_get_relative(yt,"Hash"),"to_hash"),t.hash_init(r);for(var i,s,l=0,f=e.$$keys,$=f.length;l<$;l++)i=f[l],i.$$is_string?s=e.$$smap[i]:(s=i.value,i=i.key),t.hash_put(r,i,s);return u(e.$default_proc())?(a=[e.$default_proc()],c(r,"default_proc=",t.to_a(a)),a[n(a.length,1)]):(a=[e.$default()],c(r,"default=",t.to_a(a)),a[n(a.length,1)]),r},st.$$arity=1),t.defn(mt,"$select",ct=function(){var e,r=this,n=ct.$$p,a=n||o;if(n&&(ct.$$p=null),!u(a))return c(r,"enum_for",["select"],(e=function(){return(e.$$s||this).$size()},e.$$s=r,e.$$arity=0,e));for(var i,s,l,f=t.hash(),$=0,_=r.$$keys,d=_.length;$<d;$++)i=_[$],i.$$is_string?s=r.$$smap[i]:(s=i.value,i=i.key),!1!==(l=a(i,s))&&l!==o&&t.hash_put(f,i,s);return f},ct.$$arity=0),t.defn(mt,"$select!",lt=function(){var e,r=this,n=lt.$$p,a=n||o;if(n&&(lt.$$p=null),!u(a))return c(r,"enum_for",["select!"],(e=function(){return(e.$$s||this).$size()},e.$$s=r,e.$$arity=0,e));for(var i,s,l,f=o,$=0,_=r.$$keys,d=_.length;$<d;$++)i=_[$],i.$$is_string?s=r.$$smap[i]:(s=i.value,i=i.key),!1!==(l=a(i,s))&&l!==o||(void 0!==t.hash_delete(r,i)&&(d--,$--),f=r);return f},lt.$$arity=0),t.defn(mt,"$shift",ut=function(){var e,r=this,n=r.$$keys;return n.length>0?(e=n[0],e=e.$$is_string?e:e.key,[e,t.hash_delete(r,e)]):r.$default(o)},ut.$$arity=0),t.alias(mt,"size","length"),mt.$alias_method("store","[]="),t.defn(mt,"$to_a",ft=function(){for(var t,e,r=this,n=[],a=0,i=r.$$keys,o=i.length;a<o;a++)t=i[a],t.$$is_string?e=r.$$smap[t]:(e=t.value,t=t.key),n.push([t,e]);return n},ft.$$arity=0),t.defn(mt,"$to_h",$t=function(){var e=this;if(e.$$class===t.Hash)return e;var r=new t.Hash.$$alloc;return t.hash_init(r),t.hash_clone(e,r),r},$t.$$arity=0),t.defn(mt,"$to_hash",_t=function(){return this},_t.$$arity=0),t.defn(mt,"$to_proc",dt=function(){var e,r=this;return c(r,"proc",[],(e=function(r){var n=e.$$s||this;return null==r&&n.$raise(t.const_get_relative(yt,"ArgumentError"),"no key given"),n["$[]"](r)},e.$$s=r,e.$$arity=-1,e))},dt.$$arity=0),t.alias(mt,"to_s","inspect"),t.defn(mt,"$transform_values",pt=function(){var e,r=this,n=pt.$$p,a=n||o;if(n&&(pt.$$p=null),!u(a))return c(r,"enum_for",["transform_values"],(e=function(){return(e.$$s||this).$size()},e.$$s=r,e.$$arity=0,e));for(var i,s,l=t.hash(),f=0,$=r.$$keys,_=$.length;f<_;f++)i=$[f],i.$$is_string?s=r.$$smap[i]:(s=i.value,i=i.key),s=t.yield1(a,s),t.hash_put(l,i,s);return l},pt.$$arity=0),t.defn(mt,"$transform_values!",ht=function(){var e,r=this,n=ht.$$p,a=n||o;if(n&&(ht.$$p=null),!u(a))return c(r,"enum_for",["transform_values!"],(e=function(){return(e.$$s||this).$size()},e.$$s=r,e.$$arity=0,e));for(var i,s,l=0,f=r.$$keys,$=f.length;l<$;l++)i=f[l],i.$$is_string?s=r.$$smap[i]:(s=i.value,i=i.key),s=t.yield1(a,s),t.hash_put(r,i,s);return r},ht.$$arity=0),t.alias(mt,"update","merge!"),t.alias(mt,"value?","has_value?"),t.alias(mt,"values_at","indexes"),t.defn(mt,"$values",gt=function(){for(var t,e=this,r=[],n=0,a=e.$$keys,i=a.length;n<i;n++)t=a[n],t.$$is_string?r.push(e.$$smap[t]):r.push(t.value);return r},gt.$$arity=0),o&&"values"}(i[0],0,i)},Opal.modules["corelib/number"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t>e:t["$>"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t<e:t["$<"](e)}function n(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}function a(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}function i(t,e){return"number"==typeof t&&"number"==typeof e?t/e:t["$/"](e)}function o(t,e){return"number"==typeof t&&"number"==typeof e?t*e:t["$*"](e)}function s(t,e){return"number"==typeof t&&"number"==typeof e?t<=e:t["$<="](e)}function c(t,e){return"number"==typeof t&&"number"==typeof e?t>=e:t["$>="](e)}var l=t.top,u=[],f=t.nil,$=(t.breaker,t.slice,t.klass),_=t.truthy,d=t.send,p=t.hash2;return t.add_stubs(["$require","$bridge","$raise","$name","$class","$Float","$respond_to?","$coerce_to!","$__coerced__","$===","$!","$>","$**","$new","$<","$to_f","$==","$nan?","$infinite?","$enum_for","$+","$-","$gcd","$lcm","$/","$frexp","$to_i","$ldexp","$rationalize","$*","$<<","$to_r","$-@","$size","$<=","$>=","$<=>","$compare","$empty?"]),l.$require("corelib/numeric"),function(l,u,h){function g(){}var m,v,y,b,w,x,A,k,E,S,N,C,I,O,P,L,M,T,B,j,F,R,q,D,z,U,H,G,Y,V,Q,X,J,W,K,Z,tt,et,rt,nt,at,it,ot,st,ct,lt,ut,ft,$t,_t,dt,pt,ht,gt,mt,vt,yt,bt,wt,xt,At,kt,Et,St,Nt,Ct=g=$(l,u,"Number",g),It=(Ct.$$proto,[Ct].concat(h));t.const_get_relative(It,"Opal").$bridge(Ct,Number),Number.prototype.$$is_number=!0,Ct.$$is_number_class=!0,function(e,r){var n,a=(e.$$proto,[e].concat(r));t.defn(e,"$allocate",n=function(){var e=this;return e.$raise(t.const_get_relative(a,"TypeError"),"allocator undefined for "+e.$name())},n.$$arity=0),t.udef(e,"$new")}(t.get_singleton_class(Ct),It),t.defn(Ct,"$coerce",m=function(e){var r=this;if(e===f)r.$raise(t.const_get_relative(It,"TypeError"),"can't convert "+e.$class()+" into Float");else{if(e.$$is_string)return[r.$Float(e),r];if(e["$respond_to?"]("to_f"))return[t.const_get_relative(It,"Opal")["$coerce_to!"](e,t.const_get_relative(It,"Float"),"to_f"),r];if(e.$$is_number)return[e,r];r.$raise(t.const_get_relative(It,"TypeError"),"can't convert "+e.$class()+" into Float")}},m.$$arity=1),t.defn(Ct,"$__id__",v=function(){return 2*this+1},v.$$arity=0),t.alias(Ct,"object_id","__id__"),t.defn(Ct,"$+",y=function(t){var e=this;return t.$$is_number?e+t:e.$__coerced__("+",t)},y.$$arity=1),t.defn(Ct,"$-",b=function(t){var e=this;return t.$$is_number?e-t:e.$__coerced__("-",t)},b.$$arity=1),t.defn(Ct,"$*",w=function(t){var e=this;return t.$$is_number?e*t:e.$__coerced__("*",t)},w.$$arity=1),t.defn(Ct,"$/",x=function(t){var e=this;return t.$$is_number?e/t:e.$__coerced__("/",t)},x.$$arity=1),t.alias(Ct,"fdiv","/"),t.defn(Ct,"$%",A=function(e){var r=this;return e.$$is_number?e==-1/0?e:0!=e?e<0||r<0?(r%e+e)%e:r%e:void r.$raise(t.const_get_relative(It,"ZeroDivisionError"),"divided by 0"):r.$__coerced__("%",e)},A.$$arity=1),t.defn(Ct,"$&",k=function(t){var e=this;return t.$$is_number?e&t:e.$__coerced__("&",t)},k.$$arity=1),t.defn(Ct,"$|",E=function(t){var e=this;return t.$$is_number?e|t:e.$__coerced__("|",t)},E.$$arity=1),t.defn(Ct,"$^",S=function(t){var e=this;return t.$$is_number?e^t:e.$__coerced__("^",t)},S.$$arity=1),t.defn(Ct,"$<",N=function(t){var e=this;return t.$$is_number?e<t:e.$__coerced__("<",t)},N.$$arity=1),t.defn(Ct,"$<=",C=function(t){var e=this;return t.$$is_number?e<=t:e.$__coerced__("<=",t)},C.$$arity=1),t.defn(Ct,"$>",I=function(t){var e=this;return t.$$is_number?e>t:e.$__coerced__(">",t)},I.$$arity=1),t.defn(Ct,"$>=",O=function(t){var e=this;return t.$$is_number?e>=t:e.$__coerced__(">=",t)},O.$$arity=1);var Ot=function(t,e){return e.$$is_number?isNaN(t)||isNaN(e)?f:t>e?1:t<e?-1:0:t.$__coerced__("<=>",e)};t.defn(Ct,"$<=>",P=function(e){var r=this;try{return Ot(r,e)}catch(e){if(!t.rescue(e,[t.const_get_relative(It,"ArgumentError")]))throw e;try{return f}finally{t.pop_exception()}}},P.$$arity=1),t.defn(Ct,"$<<",L=function(e){var r=this;return e=t.const_get_relative(It,"Opal")["$coerce_to!"](e,t.const_get_relative(It,"Integer"),"to_int"),e>0?r<<e:r>>-e},L.$$arity=1),
t.defn(Ct,"$>>",M=function(e){var r=this;return e=t.const_get_relative(It,"Opal")["$coerce_to!"](e,t.const_get_relative(It,"Integer"),"to_int"),e>0?r>>e:r<<-e},M.$$arity=1),t.defn(Ct,"$[]",T=function(e){var r=this;return e=t.const_get_relative(It,"Opal")["$coerce_to!"](e,t.const_get_relative(It,"Integer"),"to_int"),e<0?0:e>=32?r<0?1:0:r>>e&1},T.$$arity=1),t.defn(Ct,"$+@",B=function(){return+this},B.$$arity=0),t.defn(Ct,"$-@",j=function(){return-this},j.$$arity=0),t.defn(Ct,"$~",F=function(){return~this},F.$$arity=0),t.defn(Ct,"$**",R=function(n){var a,i,o=this;return _(t.const_get_relative(It,"Integer")["$==="](n))?_(_(a=t.const_get_relative(It,"Integer")["$==="](o)["$!"]())?a:e(n,0))?Math.pow(o,n):t.const_get_relative(It,"Rational").$new(o,1)["$**"](n):_((a=r(o,0))?_(i=t.const_get_relative(It,"Float")["$==="](n))?i:t.const_get_relative(It,"Rational")["$==="](n):r(o,0))?t.const_get_relative(It,"Complex").$new(o,0)["$**"](n.$to_f()):_(null!=n.$$is_number)?Math.pow(o,n):o.$__coerced__("**",n)},R.$$arity=1),t.defn(Ct,"$===",q=function(t){var e=this;return t.$$is_number?e.valueOf()===t.valueOf():!!t["$respond_to?"]("==")&&t["$=="](e)},q.$$arity=1),t.defn(Ct,"$==",D=function(t){var e=this;return t.$$is_number?e.valueOf()===t.valueOf():!!t["$respond_to?"]("==")&&t["$=="](e)},D.$$arity=1),t.defn(Ct,"$abs",z=function(){var t=this;return Math.abs(t)},z.$$arity=0),t.defn(Ct,"$abs2",U=function(){var t=this;return Math.abs(t*t)},U.$$arity=0),t.defn(Ct,"$angle",H=function(){var t=this;return _(t["$nan?"]())?t:0==t?1/t>0?0:Math.PI:t<0?Math.PI:0},H.$$arity=0),t.alias(Ct,"arg","angle"),t.alias(Ct,"phase","angle"),t.defn(Ct,"$bit_length",G=function(){var e=this;if(_(t.const_get_relative(It,"Integer")["$==="](e))||e.$raise(t.const_get_relative(It,"NoMethodError").$new("undefined method `bit_length` for "+e+":Float","bit_length")),0===e||-1===e)return 0;for(var r=0,n=e<0?~e:e;0!=n;)r+=1,n>>>=1;return r},G.$$arity=0),t.defn(Ct,"$ceil",Y=function(){var t=this;return Math.ceil(t)},Y.$$arity=0),t.defn(Ct,"$chr",V=function(t){var e=this;return String.fromCharCode(e)},V.$$arity=-1),t.defn(Ct,"$denominator",Q=function(){var e,r=this,n=Q.$$p,a=f,i=f,o=f;for(n&&(Q.$$p=null),i=0,o=arguments.length,a=new Array(o);i<o;i++)a[i]=arguments[i];return _(_(e=r["$nan?"]())?e:r["$infinite?"]())?1:d(r,t.find_super_dispatcher(r,"denominator",Q,!1),a,n)},Q.$$arity=0),t.defn(Ct,"$downto",X=function(r){var i,o=this,s=X.$$p,c=s||f;if(s&&(X.$$p=null),c===f)return d(o,"enum_for",["downto",r],(i=function(){var o=i.$$s||this;return _(t.const_get_relative(It,"Numeric")["$==="](r))||o.$raise(t.const_get_relative(It,"ArgumentError"),"comparison of "+o.$class()+" with "+r.$class()+" failed"),_(e(r,o))?0:n(a(o,r),1)},i.$$s=o,i.$$arity=0,i));r.$$is_number||o.$raise(t.const_get_relative(It,"ArgumentError"),"comparison of "+o.$class()+" with "+r.$class()+" failed");for(var l=o;l>=r;l--)c(l);return o},X.$$arity=1),t.alias(Ct,"eql?","=="),t.defn(Ct,"$equal?",J=function(t){var e,r=this;return _(e=r["$=="](t))?e:isNaN(r)&&isNaN(t)},J.$$arity=1),t.defn(Ct,"$even?",W=function(){return this%2==0},W.$$arity=0),t.defn(Ct,"$floor",K=function(){var t=this;return Math.floor(t)},K.$$arity=0),t.defn(Ct,"$gcd",Z=function(e){var r=this;_(t.const_get_relative(It,"Integer")["$==="](e))||r.$raise(t.const_get_relative(It,"TypeError"),"not an integer");for(var n=Math.abs(r),a=Math.abs(e);n>0;){var i=n;n=a%n,a=i}return a},Z.$$arity=1),t.defn(Ct,"$gcdlcm",tt=function(t){var e=this;return[e.$gcd(),e.$lcm()]},tt.$$arity=1),t.defn(Ct,"$integer?",et=function(){return this%1==0},et.$$arity=0),t.defn(Ct,"$is_a?",rt=function(e){var r=this,n=rt.$$p,a=f,i=f,o=f;for(n&&(rt.$$p=null),i=0,o=arguments.length,a=new Array(o);i<o;i++)a[i]=arguments[i];return!!_(e["$=="](t.const_get_relative(It,"Fixnum"))?t.const_get_relative(It,"Integer")["$==="](r):e["$=="](t.const_get_relative(It,"Fixnum")))||(!!_(e["$=="](t.const_get_relative(It,"Integer"))?t.const_get_relative(It,"Integer")["$==="](r):e["$=="](t.const_get_relative(It,"Integer")))||(!!_(e["$=="](t.const_get_relative(It,"Float"))?t.const_get_relative(It,"Float")["$==="](r):e["$=="](t.const_get_relative(It,"Float")))||d(r,t.find_super_dispatcher(r,"is_a?",rt,!1),a,n)))},rt.$$arity=1),t.alias(Ct,"kind_of?","is_a?"),t.defn(Ct,"$instance_of?",nt=function(e){var r=this,n=nt.$$p,a=f,i=f,o=f;for(n&&(nt.$$p=null),i=0,o=arguments.length,a=new Array(o);i<o;i++)a[i]=arguments[i];return!!_(e["$=="](t.const_get_relative(It,"Fixnum"))?t.const_get_relative(It,"Integer")["$==="](r):e["$=="](t.const_get_relative(It,"Fixnum")))||(!!_(e["$=="](t.const_get_relative(It,"Integer"))?t.const_get_relative(It,"Integer")["$==="](r):e["$=="](t.const_get_relative(It,"Integer")))||(!!_(e["$=="](t.const_get_relative(It,"Float"))?t.const_get_relative(It,"Float")["$==="](r):e["$=="](t.const_get_relative(It,"Float")))||d(r,t.find_super_dispatcher(r,"instance_of?",nt,!1),a,n)))},nt.$$arity=1),t.defn(Ct,"$lcm",at=function(e){var r=this;return _(t.const_get_relative(It,"Integer")["$==="](e))||r.$raise(t.const_get_relative(It,"TypeError"),"not an integer"),0==r||0==e?0:Math.abs(r*e/r.$gcd(e))},at.$$arity=1),t.alias(Ct,"magnitude","abs"),t.alias(Ct,"modulo","%"),t.defn(Ct,"$next",it=function(){return this+1},it.$$arity=0),t.defn(Ct,"$nonzero?",ot=function(){var t=this;return 0==t?f:t},ot.$$arity=0),t.defn(Ct,"$numerator",st=function(){var e,r=this,n=st.$$p,a=f,i=f,o=f;for(n&&(st.$$p=null),i=0,o=arguments.length,a=new Array(o);i<o;i++)a[i]=arguments[i];return _(_(e=r["$nan?"]())?e:r["$infinite?"]())?r:d(r,t.find_super_dispatcher(r,"numerator",st,!1),a,n)},st.$$arity=0),t.defn(Ct,"$odd?",ct=function(){return this%2!=0},ct.$$arity=0),t.defn(Ct,"$ord",lt=function(){return this},lt.$$arity=0),t.defn(Ct,"$pred",ut=function(){return this-1},ut.$$arity=0),t.defn(Ct,"$quo",ft=function(e){var r=this,n=ft.$$p,a=f,o=f,s=f;for(n&&(ft.$$p=null),o=0,s=arguments.length,a=new Array(s);o<s;o++)a[o]=arguments[o];return _(t.const_get_relative(It,"Integer")["$==="](r))?d(r,t.find_super_dispatcher(r,"quo",ft,!1),a,n):i(r,e)},ft.$$arity=1),t.defn(Ct,"$rationalize",$t=function(e){var r,n,i=this,s=f,c=f;return arguments.length>1&&i.$raise(t.const_get_relative(It,"ArgumentError"),"wrong number of arguments ("+arguments.length+" for 0..1)"),_(t.const_get_relative(It,"Integer")["$==="](i))?t.const_get_relative(It,"Rational").$new(i,1):_(i["$infinite?"]())?i.$raise(t.const_get_relative(It,"FloatDomainError"),"Infinity"):_(i["$nan?"]())?i.$raise(t.const_get_relative(It,"FloatDomainError"),"NaN"):_(null==e)?(n=t.const_get_relative(It,"Math").$frexp(i),r=t.to_ary(n),s=null==r[0]?f:r[0],c=null==r[1]?f:r[1],s=t.const_get_relative(It,"Math").$ldexp(s,t.const_get_qualified(t.const_get_relative(It,"Float"),"MANT_DIG")).$to_i(),c=a(c,t.const_get_qualified(t.const_get_relative(It,"Float"),"MANT_DIG")),t.const_get_relative(It,"Rational").$new(o(2,s),1["$<<"](a(1,c))).$rationalize(t.const_get_relative(It,"Rational").$new(1,1["$<<"](a(1,c))))):i.$to_r().$rationalize(e)},$t.$$arity=-1),t.defn(Ct,"$round",_t=function(o){var l,u,$=this,d=f;if(_(t.const_get_relative(It,"Integer")["$==="]($))){if(_(null==o))return $;if(_(_(l=t.const_get_relative(It,"Float")["$==="](o))?o["$infinite?"]():l)&&$.$raise(t.const_get_relative(It,"RangeError"),"Infinity"),o=t.const_get_relative(It,"Opal")["$coerce_to!"](o,t.const_get_relative(It,"Integer"),"to_int"),_(r(o,t.const_get_qualified(t.const_get_relative(It,"Integer"),"MIN")))&&$.$raise(t.const_get_relative(It,"RangeError"),"out of bounds"),_(o>=0))return $;if(.415241*(o=o["$-@"]())-.125>$.$size())return 0;var p=Math.pow(10,o),h=Math.floor((Math.abs(h)+p/2)/p)*p;return $<0?-h:h}if(_(_(l=$["$nan?"]())?null==o:l)&&$.$raise(t.const_get_relative(It,"FloatDomainError"),"NaN"),o=t.const_get_relative(It,"Opal")["$coerce_to!"](o||0,t.const_get_relative(It,"Integer"),"to_int"),_(s(o,0)))_($["$nan?"]())?$.$raise(t.const_get_relative(It,"RangeError"),"NaN"):_($["$infinite?"]())&&$.$raise(t.const_get_relative(It,"FloatDomainError"),"Infinity");else{if(o["$=="](0))return Math.round($);if(_(_(l=$["$nan?"]())?l:$["$infinite?"]()))return $}return u=t.const_get_relative(It,"Math").$frexp($),l=t.to_ary(u),null==l[0]?f:l[0],d=null==l[1]?f:l[1],_(c(o,a(n(t.const_get_qualified(t.const_get_relative(It,"Float"),"DIG"),2),function(){return _(e(d,0))?i(d,4):a(i(d,3),1)}())))?$:_(r(o,function(){return _(e(d,0))?n(i(d,3),1):i(d,4)}()["$-@"]()))?0:Math.round($*Math.pow(10,o))/Math.pow(10,o)},_t.$$arity=-1),t.defn(Ct,"$step",dt=function(e,r,n){function a(){void 0!==l&&($=l),void 0===$&&($=f),_===f&&h.$raise(t.const_get_relative(It,"TypeError"),"step must be numeric"),0===_&&h.$raise(t.const_get_relative(It,"ArgumentError"),"step can't be 0"),void 0!==u&&(_=u),_!==f&&null!=_||(_=1);var e=_["$<=>"](0);e===f&&h.$raise(t.const_get_relative(It,"TypeError"),"0 can't be coerced into "+_.$class()),$!==f&&null!=$||($=e>0?t.const_get_qualified(t.const_get_relative(It,"Float"),"INFINITY"):t.const_get_qualified(t.const_get_relative(It,"Float"),"INFINITY")["$-@"]()),t.const_get_relative(It,"Opal").$compare(h,$)}function i(){if(_>0&&h>$||_<0&&h<$)return 0;if(_===1/0||_===-1/0)return 1;var e=Math.abs,r=Math.floor,n=(e(h)+e($)+e($-h))/e(_)*t.const_get_qualified(t.const_get_relative(It,"Float"),"EPSILON");return n===1/0||n===-1/0?0:(n>.5&&(n=.5),r(($-h)/_+n)+1)}function o(){if(a(),0===_)return 1/0;if(_%1!=0)return i();if(_>0&&h>$||_<0&&h<$)return 0;var t=Math.ceil,e=Math.abs;return t((e(h-$)+1)/e(_))}var s,c,l,u,$,_,h=this,g=dt.$$p,m=g||f,v=f,y=f;if(c=t.slice.call(arguments,0,arguments.length),null==(n=t.extract_kwargs(c))||!n.$$is_hash){if(null!=n)throw t.ArgumentError.$new("expected kwargs");n=p([],{})}if(l=n.$$smap.to,u=n.$$smap.by,0<c.length&&($=c.splice(0,1)[0]),0<c.length&&(_=c.splice(0,1)[0]),g&&(dt.$$p=null),void 0!==$&&void 0!==l&&h.$raise(t.const_get_relative(It,"ArgumentError"),"to is given twice"),void 0!==_&&void 0!==u&&h.$raise(t.const_get_relative(It,"ArgumentError"),"step is given twice"),m===f)return v=[],y=p([],{}),void 0!==$&&v.push($),void 0!==_&&v.push(_),void 0!==l&&t.hash_put(y,"to",l),void 0!==u&&t.hash_put(y,"by",u),y["$empty?"]()||v.push(y),d(h,"enum_for",["step"].concat(t.to_a(v)),(s=function(){s.$$s;return o()},s.$$s=h,s.$$arity=0,s));if(a(),0===_)for(;;)m(h);if(h%1!=0||$%1!=0||_%1!=0){var b=i();if(b>0)if(_===1/0||_===-1/0)m(h);else{var w,x=0;if(_>0)for(;x<b;)w=x*_+h,$<w&&(w=$),m(w),x+=1;else for(;x<b;)w=x*_+h,$>w&&(w=$),m(w),x+=1}}else{var A=h;if(_>0)for(;A<=$;)m(A),A+=_;else for(;A>=$;)m(A),A+=_}return h},dt.$$arity=-1),t.alias(Ct,"succ","next"),t.defn(Ct,"$times",pt=function(){var t,e=this,r=pt.$$p,n=r||f;if(r&&(pt.$$p=null),!_(n))return d(e,"enum_for",["times"],(t=function(){return t.$$s||this},t.$$s=e,t.$$arity=0,t));for(var a=0;a<e;a++)n(a);return e},pt.$$arity=0),t.defn(Ct,"$to_f",ht=function(){return this},ht.$$arity=0),t.defn(Ct,"$to_i",gt=function(){var t=this;return parseInt(t,10)},gt.$$arity=0),t.alias(Ct,"to_int","to_i"),t.defn(Ct,"$to_r",mt=function(){var e,r,n=this,i=f,s=f;return _(t.const_get_relative(It,"Integer")["$==="](n))?t.const_get_relative(It,"Rational").$new(n,1):(r=t.const_get_relative(It,"Math").$frexp(n),e=t.to_ary(r),i=null==e[0]?f:e[0],s=null==e[1]?f:e[1],i=t.const_get_relative(It,"Math").$ldexp(i,t.const_get_qualified(t.const_get_relative(It,"Float"),"MANT_DIG")).$to_i(),s=a(s,t.const_get_qualified(t.const_get_relative(It,"Float"),"MANT_DIG")),o(i,t.const_get_qualified(t.const_get_relative(It,"Float"),"RADIX")["$**"](s)).$to_r())},mt.$$arity=0),t.defn(Ct,"$to_s",vt=function(n){var a,i=this;return null==n&&(n=10),_(_(a=r(n,2))?a:e(n,36))&&i.$raise(t.const_get_relative(It,"ArgumentError"),"base must be between 2 and 36"),i.toString(n)},vt.$$arity=-1),t.alias(Ct,"truncate","to_i"),t.alias(Ct,"inspect","to_s"),t.defn(Ct,"$divmod",yt=function(e){var r,n=this,a=yt.$$p,i=f,o=f,s=f;for(a&&(yt.$$p=null),o=0,s=arguments.length,i=new Array(s);o<s;o++)i[o]=arguments[o];return _(_(r=n["$nan?"]())?r:e["$nan?"]())?n.$raise(t.const_get_relative(It,"FloatDomainError"),"NaN"):_(n["$infinite?"]())?n.$raise(t.const_get_relative(It,"FloatDomainError"),"Infinity"):d(n,t.find_super_dispatcher(n,"divmod",yt,!1),i,a)},yt.$$arity=1),t.defn(Ct,"$upto",bt=function(e){var i,o=this,s=bt.$$p,c=s||f;if(s&&(bt.$$p=null),c===f)return d(o,"enum_for",["upto",e],(i=function(){var o=i.$$s||this;return _(t.const_get_relative(It,"Numeric")["$==="](e))||o.$raise(t.const_get_relative(It,"ArgumentError"),"comparison of "+o.$class()+" with "+e.$class()+" failed"),_(r(e,o))?0:n(a(e,o),1)},i.$$s=o,i.$$arity=0,i));e.$$is_number||o.$raise(t.const_get_relative(It,"ArgumentError"),"comparison of "+o.$class()+" with "+e.$class()+" failed");for(var l=o;l<=e;l++)c(l);return o},bt.$$arity=1),t.defn(Ct,"$zero?",wt=function(){return 0==this},wt.$$arity=0),t.defn(Ct,"$size",xt=function(){return 4},xt.$$arity=0),t.defn(Ct,"$nan?",At=function(){var t=this;return isNaN(t)},At.$$arity=0),t.defn(Ct,"$finite?",kt=function(){var t=this;return t!=1/0&&t!=-1/0&&!isNaN(t)},kt.$$arity=0),t.defn(Ct,"$infinite?",Et=function(){var t=this;return t==1/0?1:t==-1/0?-1:f},Et.$$arity=0),t.defn(Ct,"$positive?",St=function(){var t=this;return 0!=t&&(t==1/0||1/t>0)},St.$$arity=0),t.defn(Ct,"$negative?",Nt=function(){var t=this;return t==-1/0||1/t<0},Nt.$$arity=0)}(u[0],t.const_get_relative(u,"Numeric"),u),t.const_set(u[0],"Fixnum",t.const_get_relative(u,"Number")),function(e,r,n){function a(){}var i=a=$(e,r,"Integer",a),o=(i.$$proto,[i].concat(n));i.$$is_number_class=!0,function(e,r){var n,a,i=(e.$$proto,[e].concat(r));t.defn(e,"$allocate",n=function(){var e=this;return e.$raise(t.const_get_relative(i,"TypeError"),"allocator undefined for "+e.$name())},n.$$arity=0),t.udef(e,"$new"),t.defn(e,"$===",a=function(t){return!!t.$$is_number&&t%1==0},a.$$arity=1)}(t.get_singleton_class(i),o),t.const_set(o[0],"MAX",Math.pow(2,30)-1),t.const_set(o[0],"MIN",-Math.pow(2,30))}(u[0],t.const_get_relative(u,"Numeric"),u),function(e,r,n){function a(){}var i=a=$(e,r,"Float",a),o=(i.$$proto,[i].concat(n));return i.$$is_number_class=!0,function(e,r){var n,a,i=(e.$$proto,[e].concat(r));t.defn(e,"$allocate",n=function(){var e=this;return e.$raise(t.const_get_relative(i,"TypeError"),"allocator undefined for "+e.$name())},n.$$arity=0),t.udef(e,"$new"),t.defn(e,"$===",a=function(t){return!!t.$$is_number},a.$$arity=1)}(t.get_singleton_class(i),o),t.const_set(o[0],"INFINITY",1/0),t.const_set(o[0],"MAX",Number.MAX_VALUE),t.const_set(o[0],"MIN",Number.MIN_VALUE),t.const_set(o[0],"NAN",NaN),t.const_set(o[0],"DIG",15),t.const_set(o[0],"MANT_DIG",53),t.const_set(o[0],"RADIX",2),t.const_set(o[0],"EPSILON",Number.EPSILON||2.220446049250313e-16)}(u[0],t.const_get_relative(u,"Numeric"),u)},Opal.modules["corelib/range"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t<=e:t["$<="](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t<e:t["$<"](e)}function n(t,e){return"number"==typeof t&&"number"==typeof e?t>e:t["$>"](e)}function a(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}function i(t,e){return"number"==typeof t&&"number"==typeof e?t/e:t["$/"](e)}function o(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}function s(t,e){return"number"==typeof t&&"number"==typeof e?t*e:t["$*"](e)}function c(t,e){return"number"==typeof t&&"number"==typeof e?t>=e:t["$>="](e)}var l=t.top,u=[],f=t.nil,$=(t.breaker,t.slice,t.klass),_=t.truthy,d=t.send;return t.add_stubs(["$require","$include","$attr_reader","$raise","$<=>","$include?","$<=","$<","$enum_for","$upto","$to_proc","$respond_to?","$class","$succ","$!","$==","$===","$exclude_end?","$eql?","$begin","$end","$last","$to_a","$>","$-","$abs","$to_i","$coerce_to!","$ceil","$/","$size","$loop","$+","$*","$>=","$each_with_index","$%","$bsearch","$inspect","$[]","$hash"]),l.$require("corelib/enumerable"),function(l,u,p){function h(){}var g,m,v,y,b,w,x,A,k,E,S,N,C,I,O,P,L,M,T=h=$(l,null,"Range",h),B=T.$$proto,j=[T].concat(p);return B.begin=B.end=B.excl=f,T.$include(t.const_get_relative(j,"Enumerable")),B.$$is_range=!0,T.$attr_reader("begin","end"),t.defn(T,"$initialize",g=function(e,r,n){var a=this;return null==n&&(n=!1),_(a.begin)&&a.$raise(t.const_get_relative(j,"NameError"),"'initialize' called twice"),_(e["$<=>"](r))||a.$raise(t.const_get_relative(j,"ArgumentError"),"bad value for range"),a.begin=e,a.end=r,a.excl=n},g.$$arity=-3),t.defn(T,"$==",m=function(t){var e=this;return!!t.$$is_range&&(e.excl===t.excl&&e.begin==t.begin&&e.end==t.end)},m.$$arity=1),t.defn(T,"$===",v=function(t){return this["$include?"](t)},v.$$arity=1),t.defn(T,"$cover?",y=function(t){var n,a=this,i=f,o=f;return i=a.begin["$<=>"](t),!!_(_(n=i)?e(i,0):n)&&(o=t["$<=>"](a.end),_(a.excl)?_(n=o)?r(o,0):n:_(n=o)?e(o,0):n)},y.$$arity=1),t.defn(T,"$each",b=function(){var e,n=this,a=b.$$p,i=a||f,o=f,s=f;if(a&&(b.$$p=null),i===f)return n.$enum_for("each");var c,l;if(n.begin.$$is_number&&n.end.$$is_number){for(n.begin%1==0&&n.end%1==0||n.$raise(t.const_get_relative(j,"TypeError"),"can't iterate from Float"),c=n.begin,l=n.end+function(){return _(n.excl)?0:1}();c<l;c++)i(c);return n}if(n.begin.$$is_string&&n.end.$$is_string)return d(n.begin,"upto",[n.end,n.excl],i.$to_proc()),n;for(o=n.begin,s=n.end,_(o["$respond_to?"]("succ"))||n.$raise(t.const_get_relative(j,"TypeError"),"can't iterate from "+o.$class());_(r(o["$<=>"](s),0));)t.yield1(i,o),o=o.$succ();return _(_(e=n.excl["$!"]())?o["$=="](s):e)&&t.yield1(i,o),n},b.$$arity=0),t.defn(T,"$eql?",w=function(e){var r,n,a=this;return!!_(t.const_get_relative(j,"Range")["$==="](e))&&(_(r=_(n=a.excl["$==="](e["$exclude_end?"]()))?a.begin["$eql?"](e.$begin()):n)?a.end["$eql?"](e.$end()):r)},w.$$arity=1),t.defn(T,"$exclude_end?",x=function(){return this.excl},x.$$arity=0),t.defn(T,"$first",A=function(e){var r=this,n=A.$$p,a=f,i=f,o=f;for(n&&(A.$$p=null),i=0,o=arguments.length,a=new Array(o);i<o;i++)a[i]=arguments[i];return _(null==e)?r.begin:d(r,t.find_super_dispatcher(r,"first",A,!1),a,n)},A.$$arity=-1),t.alias(T,"include?","cover?"),t.defn(T,"$last",k=function(t){var e=this;return _(null==t)?e.end:e.$to_a().$last(t)},k.$$arity=-1),t.defn(T,"$max",E=function(){var e,r=this,a=E.$$p,i=a||f,o=f,s=f,c=f;for(a&&(E.$$p=null),s=0,c=arguments.length,o=new Array(c);s<c;s++)o[s]=arguments[s];return i!==f?d(r,t.find_super_dispatcher(r,"max",E,!1),o,a):_(n(r.begin,r.end))?f:_(_(e=r.excl)?r.begin["$=="](r.end):e)?f:r.excl?r.end-1:r.end},E.$$arity=0),t.alias(T,"member?","cover?"),t.defn(T,"$min",S=function(){var e,r=this,a=S.$$p,i=a||f,o=f,s=f,c=f;for(a&&(S.$$p=null),s=0,c=arguments.length,o=new Array(c);s<c;s++)o[s]=arguments[s];return i!==f?d(r,t.find_super_dispatcher(r,"min",S,!1),o,a):_(n(r.begin,r.end))?f:_(_(e=r.excl)?r.begin["$=="](r.end):e)?f:r.begin},S.$$arity=0),t.defn(T,"$size",N=function(){var e,n=this,i=f,o=f,s=f;return i=n.begin,o=n.end,_(n.excl)&&(o=a(o,1)),_(_(e=t.const_get_relative(j,"Numeric")["$==="](i))?t.const_get_relative(j,"Numeric")["$==="](o):e)?_(r(o,i))?0:(s=t.const_get_qualified(t.const_get_relative(j,"Float"),"INFINITY"),_(_(e=s["$=="](i.$abs()))?e:o.$abs()["$=="](s))?s:(Math.abs(o-i)+1).$to_i()):f},N.$$arity=0),t.defn(T,"$step",C=function(e){function r(){e.$$is_number||(e=t.const_get_relative(j,"Opal")["$coerce_to!"](e,t.const_get_relative(j,"Integer"),"to_int")),e<0?p.$raise(t.const_get_relative(j,"ArgumentError"),"step can't be negative"):0===e&&p.$raise(t.const_get_relative(j,"ArgumentError"),"step can't be 0")}function a(){if(!p.begin["$respond_to?"]("succ"))return f;if(p.begin.$$is_string&&p.end.$$is_string)return f;if(e%1==0)return i(p.$size(),e).$ceil();var r,n=p.begin,a=p.end,o=Math.abs,s=Math.floor,c=(o(n)+o(a)+o(a-n))/o(e)*t.const_get_qualified(t.const_get_relative(j,"Float"),"EPSILON");return c>.5&&(c=.5),p.excl?(r=s((a-n)/e-c))*e+n<a&&r++:r=s((a-n)/e+c)+1,r}var l,u,$,p=this,h=C.$$p,g=h||f,m=f;return null==e&&(e=1),h&&(C.$$p=null),g===f?d(p,"enum_for",["step",e],(l=function(){l.$$s;return r(),a()},l.$$s=p,l.$$arity=0,l)):(r(),_(p.begin.$$is_number&&p.end.$$is_number)?(m=0,function(){var r=t.new_brk();try{d(p,"loop",[],(u=function(){var a=u.$$s||this,i=f;return null==a.begin&&(a.begin=f),null==a.excl&&(a.excl=f),null==a.end&&(a.end=f),i=o(a.begin,s(m,e)),_(a.excl)?_(c(i,a.end))&&t.brk(f,r):_(n(i,a.end))&&t.brk(f,r),t.yield1(g,i),m=o(m,1)},u.$$s=p,u.$$brk=r,u.$$arity=0,u))}catch(t){if(t===r)return t.$v;throw t}}()):(p.begin.$$is_string&&p.end.$$is_string&&e%1!=0&&p.$raise(t.const_get_relative(j,"TypeError"),"no implicit conversion to float from string"),d(p,"each_with_index",[],($=function(r,n){$.$$s;return null==r&&(r=f),null==n&&(n=f),n["$%"](e)["$=="](0)?t.yield1(g,r):f},$.$$s=p,$.$$arity=2,$))),p)},C.$$arity=-1),t.defn(T,"$bsearch",I=function(){var e=this,r=I.$$p,n=r||f;return r&&(I.$$p=null),n===f?e.$enum_for("bsearch"):(_(e.begin.$$is_number&&e.end.$$is_number)||e.$raise(t.const_get_relative(j,"TypeError"),"can't do binary search for "+e.begin.$class()),d(e.$to_a(),"bsearch",[],n.$to_proc()))},I.$$arity=0),t.defn(T,"$to_s",O=function(){var t=this;return""+t.begin+function(){return _(t.excl)?"...":".."}()+t.end},O.$$arity=0),t.defn(T,"$inspect",P=function(){var t=this;return""+t.begin.$inspect()+function(){return _(t.excl)?"...":".."}()+t.end.$inspect()},P.$$arity=0),t.defn(T,"$marshal_load",L=function(t){var e=this;return e.begin=t["$[]"]("begin"),e.end=t["$[]"]("end"),e.excl=t["$[]"]("excl")},L.$$arity=1),t.defn(T,"$hash",M=function(){var t=this;return[t.begin,t.end,t.excl].$hash()},M.$$arity=0),f&&"hash"}(u[0],0,u)},Opal.modules["corelib/proc"]=function(t){var e=(t.top,[]),r=t.nil,n=(t.breaker,t.slice),a=t.klass,i=t.truthy;return t.add_stubs(["$raise","$coerce_to!"]),function(e,o,s){function c(){}var l,u,f,$,_,d,p,h,g,m,v=c=a(e,o,"Proc",c),y=v.$$proto,b=[v].concat(s);return y.$$is_proc=!0,y.$$is_lambda=!1,t.defs(v,"$new",l=function(){var e=this,n=l.$$p,a=n||r;return n&&(l.$$p=null),i(a)||e.$raise(t.const_get_relative(b,"ArgumentError"),"tried to create a Proc object without a block"),a},l.$$arity=0),t.defn(v,"$call",u=function(e){var n,a=this,i=u.$$p,o=i||r,s=arguments.length,c=s-0;c<0&&(c=0),n=new Array(c);for(var l=0;l<s;l++)n[l-0]=arguments[l];i&&(u.$$p=null),o!==r&&(a.$$p=o);var f,$=a.$$brk;if($)try{f=a.$$is_lambda?a.apply(null,n):t.yieldX(a,n)}catch(t){if(t===$)return $.$v;throw t}else f=a.$$is_lambda?a.apply(null,n):t.yieldX(a,n);return f},u.$$arity=-1),t.alias(v,"[]","call"),t.alias(v,"===","call"),t.alias(v,"yield","call"),t.defn(v,"$to_proc",f=function(){return this},f.$$arity=0),t.defn(v,"$lambda?",$=function(){return!!this.$$is_lambda},$.$$arity=0),t.defn(v,"$arity",_=function(){var t=this;return t.$$is_curried?-1:t.$$arity},_.$$arity=0),t.defn(v,"$source_location",d=function(){return this.$$is_curried,r},d.$$arity=0),t.defn(v,"$binding",p=function(){var e=this;return e.$$is_curried&&e.$raise(t.const_get_relative(b,"ArgumentError"),"Can't create Binding"),r},p.$$arity=0),t.defn(v,"$parameters",h=function(){var t=this;if(t.$$is_curried)return[["rest"]];if(t.$$parameters){if(t.$$is_lambda)return t.$$parameters;var e,r,n=[];for(e=0,r=t.$$parameters.length;e<r;e++){var a=t.$$parameters[e];"req"===a[0]&&(a=["opt",a[1]]),n.push(a)}return n}return[]},h.$$arity=0),t.defn(v,"$curry",g=function(e){function r(){var i,o=n.call(arguments),s=o.length;return s>e&&a.$$is_lambda&&!a.$$is_curried&&a.$raise(t.const_get_relative(b,"ArgumentError"),"wrong number of arguments ("+s+" for "+e+")"),s>=e?a.$call.apply(a,o):(i=function(){return r.apply(null,o.concat(n.call(arguments)))},i.$$is_lambda=a.$$is_lambda,i.$$is_curried=!0,i)}var a=this;return void 0===e?e=a.length:(e=t.const_get_relative(b,"Opal")["$coerce_to!"](e,t.const_get_relative(b,"Integer"),"to_int"),a.$$is_lambda&&e!==a.length&&a.$raise(t.const_get_relative(b,"ArgumentError"),"wrong number of arguments ("+e+" for "+a.length+")")),r.$$is_lambda=a.$$is_lambda,r.$$is_curried=!0,r},g.$$arity=-1),t.defn(v,"$dup",m=function(){var t=this,e=t.$$original_proc||t,r=function(){return e.apply(this,arguments)};for(var n in t)t.hasOwnProperty(n)&&(r[n]=t[n]);return r},m.$$arity=0),t.alias(v,"clone","dup")}(e[0],Function,e)},Opal.modules["corelib/method"]=function(t){var e=(t.top,[]),r=t.nil,n=(t.breaker,t.slice,t.klass),a=t.truthy;return t.add_stubs(["$attr_reader","$arity","$new","$class","$join","$source_location","$raise"]),function(e,i,o){function s(){}var c,l,u,f,$,_,d,p,h,g=s=n(e,null,"Method",s),m=g.$$proto,v=[g].concat(o);m.method=m.receiver=m.owner=m.name=r,g.$attr_reader("owner","receiver","name"),t.defn(g,"$initialize",c=function(t,e,r,n){var a=this;return a.receiver=t,a.owner=e,a.name=n,a.method=r},c.$$arity=4),t.defn(g,"$arity",l=function(){return this.method.$arity()},l.$$arity=0),t.defn(g,"$parameters",u=function(){return this.method.$$parameters},u.$$arity=0),t.defn(g,"$source_location",f=function(){var t;return a(t=this.method.$$source_location)?t:["(eval)",0]},f.$$arity=0),t.defn(g,"$comments",$=function(){var t;return a(t=this.method.$$comments)?t:[]},$.$$arity=0),t.defn(g,"$call",_=function(t){var e,n=this,a=_.$$p,i=a||r,o=arguments.length,s=o-0;s<0&&(s=0),e=new Array(s);for(var c=0;c<o;c++)e[c-0]=arguments[c];return a&&(_.$$p=null),n.method.$$p=i,n.method.apply(n.receiver,e)},_.$$arity=-1),t.alias(g,"[]","call"),t.defn(g,"$unbind",d=function(){var e=this;return t.const_get_relative(v,"UnboundMethod").$new(e.receiver.$class(),e.owner,e.method,e.name)},d.$$arity=0),t.defn(g,"$to_proc",p=function(){var t=this,e=t.$call.bind(t);return e.$$unbound=t.method,e.$$is_lambda=!0,e},p.$$arity=0),t.defn(g,"$inspect",h=function(){var t=this;return"#<"+t.$class()+": "+t.receiver.$class()+"#"+t.name+" (defined in "+t.owner+" in "+t.$source_location().$join(":")+")>"},h.$$arity=0)}(e[0],0,e),function(e,i,o){function s(){}var c,l,u,f,$,_,d,p=s=n(e,null,"UnboundMethod",s),h=p.$$proto,g=[p].concat(o);return h.method=h.owner=h.name=h.source=r,p.$attr_reader("source","owner","name"),t.defn(p,"$initialize",c=function(t,e,r,n){var a=this;return a.source=t,a.owner=e,a.method=r,a.name=n},c.$$arity=4),t.defn(p,"$arity",l=function(){return this.method.$arity()},l.$$arity=0),t.defn(p,"$parameters",u=function(){return this.method.$$parameters},u.$$arity=0),t.defn(p,"$source_location",f=function(){var t;return a(t=this.method.$$source_location)?t:["(eval)",0]},f.$$arity=0),t.defn(p,"$comments",$=function(){var t;return a(t=this.method.$$comments)?t:[]},$.$$arity=0),t.defn(p,"$bind",_=function(e){var r=this;if(r.owner.$$is_module||t.is_a(e,r.owner))return t.const_get_relative(g,"Method").$new(e,r.owner,r.method,r.name);r.$raise(t.const_get_relative(g,"TypeError"),"can't bind singleton method to a different class (expected "+e+".kind_of?("+r.owner+" to be true)")},_.$$arity=1),t.defn(p,"$inspect",d=function(){var t=this;return"#<"+t.$class()+": "+t.source+"#"+t.name+" (defined in "+t.owner+" in "+t.$source_location().$join(":")+")>"},d.$$arity=0),r&&"inspect"}(e[0],0,e)},Opal.modules["corelib/variables"]=function(t){var e=(t.top,[]),r=t.nil,n=(t.breaker,t.slice,t.gvars),a=t.hash2;return t.add_stubs(["$new"]),n["&"]=n["~"]=n["`"]=n["'"]=r,n.LOADED_FEATURES=n['"']=t.loaded_features,n.LOAD_PATH=n[":"]=[],n["/"]="\n",n[","]=r,t.const_set(e[0],"ARGV",[]),t.const_set(e[0],"ARGF",t.const_get_relative(e,"Object").$new()),t.const_set(e[0],"ENV",a([],{})),n.VERBOSE=!1,n.DEBUG=!1,n.SAFE=0},Opal.modules["opal/regexp_anchors"]=function(t){var e=(t.top,[]),r=t.nil,n=(t.breaker,t.slice,t.module);return t.add_stubs(["$==","$new"]),function(e,a){var i,o=i=n(e,"Opal"),s=(o.$$proto,[o].concat(a));t.const_set(s[0],"REGEXP_START",function(){return t.const_get_relative(s,"RUBY_ENGINE")["$=="]("opal")?"^":r}()),t.const_set(s[0],"REGEXP_END",function(){return t.const_get_relative(s,"RUBY_ENGINE")["$=="]("opal")?"$":r}()),t.const_set(s[0],"FORBIDDEN_STARTING_IDENTIFIER_CHARS","\\u0001-\\u002F\\u003A-\\u0040\\u005B-\\u005E\\u0060\\u007B-\\u007F"),t.const_set(s[0],"FORBIDDEN_ENDING_IDENTIFIER_CHARS","\\u0001-\\u0020\\u0022-\\u002F\\u003A-\\u003E\\u0040\\u005B-\\u005E\\u0060\\u007B-\\u007F"),t.const_set(s[0],"INLINE_IDENTIFIER_REGEXP",t.const_get_relative(s,"Regexp").$new("[^"+t.const_get_relative(s,"FORBIDDEN_STARTING_IDENTIFIER_CHARS")+"]*[^"+t.const_get_relative(s,"FORBIDDEN_ENDING_IDENTIFIER_CHARS")+"]")),t.const_set(s[0],"FORBIDDEN_CONST_NAME_CHARS","\\u0001-\\u0020\\u0021-\\u002F\\u003B-\\u003F\\u0040\\u005B-\\u005E\\u0060\\u007B-\\u007F"),t.const_set(s[0],"CONST_NAME_REGEXP",t.const_get_relative(s,"Regexp").$new(t.const_get_relative(s,"REGEXP_START")+"(::)?[A-Z][^"+t.const_get_relative(s,"FORBIDDEN_CONST_NAME_CHARS")+"]*"+t.const_get_relative(s,"REGEXP_END")))}(e[0],e)},Opal.modules["opal/mini"]=function(t){var e=t.top;t.nil,t.breaker,t.slice;return t.add_stubs(["$require"]),e.$require("opal/base"),e.$require("corelib/nil"),e.$require("corelib/boolean"),e.$require("corelib/string"),e.$require("corelib/comparable"),e.$require("corelib/enumerable"),e.$require("corelib/enumerator"),e.$require("corelib/array"),e.$require("corelib/hash"),e.$require("corelib/number"),e.$require("corelib/range"),e.$require("corelib/proc"),e.$require("corelib/method"),e.$require("corelib/regexp"),e.$require("corelib/variables"),e.$require("opal/regexp_anchors")},Opal.modules["corelib/string/inheritance"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t*e:t["$*"](e)}function n(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}var a=t.top,i=[],o=t.nil,s=(t.breaker,t.slice,t.klass),c=t.send,l=t.truthy,u=t.gvars;return t.add_stubs(["$require","$new","$allocate","$initialize","$to_proc","$__send__","$class","$clone","$respond_to?","$==","$to_s","$inspect","$+","$*","$map","$split","$enum_for","$each_line","$to_a","$%","$-"]),a.$require("corelib/string"),function(e,r,n){function a(){}var i,c=a=s(e,null,"String",a),l=(c.$$proto,[c].concat(n));t.defs(c,"$inherited",i=function(e){var r=o;r=t.const_get_relative(l,"Class").$new(t.const_get_qualified(t.const_get_relative(l,"String"),"Wrapper")),e.$$proto=r.$$proto,e.$$proto.$$class=e,e.$$alloc=r.$$alloc,e.$$parent=t.const_get_qualified(t.const_get_relative(l,"String"),"Wrapper"),e.$allocate=r.$allocate,e.$new=r.$new},i.$$arity=1)}(i[0],0,i),function(a,i,f){function $(){}var _,d,p,h,g,m,v,y,b,w,x,A,k,E,S,N,C,I,O=$=s(a,null,"Wrapper",$),P=O.$$proto;[O].concat(f);return P.literal=o,P.$$is_string=!0,t.defs(O,"$allocate",_=function(e){var r=this,n=_.$$p,a=o;return null==e&&(e=""),n&&(_.$$p=null),a=c(r,t.find_super_dispatcher(r,"allocate",_,!1,$),[],null),a.literal=e,a},_.$$arity=-1),t.defs(O,"$new",d=function(e){var r,n=this,a=d.$$p,i=a||o,s=o,l=arguments.length,u=l-0;u<0&&(u=0),r=new Array(u);for(var f=0;f<l;f++)r[f-0]=arguments[f];return a&&(d.$$p=null),s=n.$allocate(),c(s,"initialize",t.to_a(r),i.$to_proc()),s},d.$$arity=-1),t.defs(O,"$[]",p=function(t){var e,r=this,n=arguments.length,a=n-0;a<0&&(a=0),e=new Array(a);for(var i=0;i<n;i++)e[i-0]=arguments[i];return r.$allocate(e)},p.$$arity=-1),t.defn(O,"$initialize",h=function(t){var e=this;return null==t&&(t=""),e.literal=t},h.$$arity=-1),t.defn(O,"$method_missing",g=function(e){var r,n=this,a=g.$$p,i=a||o,s=o,u=arguments.length,f=u-0;f<0&&(f=0),r=new Array(f);for(var $=0;$<u;$++)r[$-0]=arguments[$];return a&&(g.$$p=null),s=c(n.literal,"__send__",t.to_a(r),i.$to_proc()),l(null!=s.$$is_string)?l(s==n.literal)?n:n.$class().$allocate(s):s},g.$$arity=-1),t.defn(O,"$initialize_copy",m=function(t){return this.literal=t.literal.$clone()},m.$$arity=1),t.defn(O,"$respond_to?",v=function(e,r){var n,a=this,i=v.$$p,s=o,u=o,f=o;for(i&&(v.$$p=null),u=0,f=arguments.length,s=new Array(f);u<f;u++)s[u]=arguments[u];return l(n=c(a,t.find_super_dispatcher(a,"respond_to?",v,!1),s,i))?n:a.literal["$respond_to?"](e)},v.$$arity=-2),t.defn(O,"$==",y=function(t){return this.literal["$=="](t)},y.$$arity=1),t.alias(O,"eql?","=="),t.alias(O,"===","=="),t.defn(O,"$to_s",b=function(){return this.literal.$to_s()},b.$$arity=0),t.alias(O,"to_str","to_s"),
t.defn(O,"$inspect",w=function(){return this.literal.$inspect()},w.$$arity=0),t.defn(O,"$+",x=function(t){return e(this.literal,t)},x.$$arity=1),t.defn(O,"$*",A=function(t){var e=this,n=r(e.literal,t);return n.$$is_string?e.$class().$allocate(n):n},A.$$arity=1),t.defn(O,"$split",k=function(t,e){var r,n=this;return c(n.literal.$split(t,e),"map",[],(r=function(t){var e=r.$$s||this;return null==t&&(t=o),e.$class().$allocate(t)},r.$$s=n,r.$$arity=1,r))},k.$$arity=-1),t.defn(O,"$replace",E=function(t){return this.literal=t},E.$$arity=1),t.defn(O,"$each_line",S=function(e){var r,n=this,a=S.$$p,i=a||o;return null==u["/"]&&(u["/"]=o),null==e&&(e=u["/"]),a&&(S.$$p=null),i===o?n.$enum_for("each_line",e):c(n.literal,"each_line",[e],(r=function(e){var n=r.$$s||this;return null==e&&(e=o),t.yield1(i,n.$class().$allocate(e))},r.$$s=n,r.$$arity=1,r))},S.$$arity=-1),t.defn(O,"$lines",N=function(t){var e=this,r=N.$$p,n=r||o,a=o;return null==u["/"]&&(u["/"]=o),null==t&&(t=u["/"]),r&&(N.$$p=null),a=c(e,"each_line",[t],n.$to_proc()),l(n)?e:a.$to_a()},N.$$arity=-1),t.defn(O,"$%",C=function(t){return this.literal["$%"](t)},C.$$arity=1),t.defn(O,"$instance_variables",I=function(){var e=this,r=I.$$p,a=o,i=o,s=o;for(r&&(I.$$p=null),i=0,s=arguments.length,a=new Array(s);i<s;i++)a[i]=arguments[i];return n(c(e,t.find_super_dispatcher(e,"instance_variables",I,!1),a,r),["@literal"])},I.$$arity=0),o&&"instance_variables"}(t.const_get_relative(i,"String"),0,i)},Opal.modules["corelib/string/encoding"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}var r,n,a,i,o,s=t.top,c=[],l=t.nil,u=(t.breaker,t.slice,t.klass),f=t.truthy,$=t.send,_=t.hash2;return t.add_stubs(["$require","$+","$[]","$new","$to_proc","$each","$const_set","$sub","$==","$default_external","$upcase","$raise","$attr_accessor","$attr_reader","$register","$length","$bytes","$to_a","$each_byte","$bytesize","$enum_for","$force_encoding","$dup","$coerce_to!","$find","$getbyte"]),s.$require("corelib/string"),function(r,n,a){function i(){}var o,s,c,d,p,h,g,m,v,y,b=i=u(r,null,"Encoding",i),w=b.$$proto,x=[b].concat(a);w.ascii=w.dummy=w.name=l,b.$$register={},t.defs(b,"$register",o=function(r,n){var a,i,s=this,c=o.$$p,u=c||l,d=l,p=l,h=l;return null==n&&(n=_([],{})),c&&(o.$$p=null),d=e([r],f(a=n["$[]"]("aliases"))?a:[]),p=$(t.const_get_relative(x,"Class"),"new",[s],u.$to_proc()).$new(r,d,!!f(a=n["$[]"]("ascii"))&&a,!!f(a=n["$[]"]("dummy"))&&a),h=s.$$register,$(d,"each",[],(i=function(t){var e=i.$$s||this;return null==t&&(t=l),e.$const_set(t.$sub("-","_"),p),h["$$"+t]=p},i.$$s=s,i.$$arity=1,i))},o.$$arity=-2),t.defs(b,"$find",s=function(e){var r,n=this,a=l,i=l;return e["$=="]("default_external")?n.$default_external():(a=n.$$register,i=f(r=a["$$"+e])?r:a["$$"+e.$upcase()],f(i)||n.$raise(t.const_get_relative(x,"ArgumentError"),"unknown encoding name - "+e),i)},s.$$arity=1),function(t,e){t.$$proto,[t].concat(e);t.$attr_accessor("default_external")}(t.get_singleton_class(b),x),b.$attr_reader("name","names"),t.defn(b,"$initialize",c=function(t,e,r,n){var a=this;return a.name=t,a.names=e,a.ascii=r,a.dummy=n},c.$$arity=4),t.defn(b,"$ascii_compatible?",d=function(){return this.ascii},d.$$arity=0),t.defn(b,"$dummy?",p=function(){return this.dummy},p.$$arity=0),t.defn(b,"$to_s",h=function(){return this.name},h.$$arity=0),t.defn(b,"$inspect",g=function(){var t=this;return"#<Encoding:"+t.name+function(){return f(t.dummy)?" (dummy)":l}()+">"},g.$$arity=0),t.defn(b,"$each_byte",m=function(e){return this.$raise(t.const_get_relative(x,"NotImplementedError"))},m.$$arity=-1),t.defn(b,"$getbyte",v=function(e){return this.$raise(t.const_get_relative(x,"NotImplementedError"))},v.$$arity=-1),t.defn(b,"$bytesize",y=function(e){return this.$raise(t.const_get_relative(x,"NotImplementedError"))},y.$$arity=-1),function(t,e,r){function n(){}var a=n=u(t,e,"EncodingError",n);a.$$proto,[a].concat(r)}(x[0],t.const_get_relative(x,"StandardError"),x),function(t,e,r){function n(){}var a=n=u(t,e,"CompatibilityError",n);a.$$proto,[a].concat(r)}(x[0],t.const_get_relative(x,"EncodingError"),x)}(c[0],0,c),$(t.const_get_relative(c,"Encoding"),"register",["UTF-8",_(["aliases","ascii"],{aliases:["CP65001"],ascii:!0})],(r=function(){var e,n,a=r.$$s||this;return t.def(a,"$each_byte",e=function(r){var n=e.$$p,a=n||l;n&&(e.$$p=null);for(var i=0,o=r.length;i<o;i++){var s=r.charCodeAt(i);if(s<=127)t.yield1(a,s);else for(var c=encodeURIComponent(r.charAt(i)).substr(1).split("%"),u=0,f=c.length;u<f;u++)t.yield1(a,parseInt(c[u],16))}},e.$$arity=1),t.def(a,"$bytesize",n=function(t){return t.$bytes().$length()},n.$$arity=1),l&&"bytesize"},r.$$s=s,r.$$arity=0,r)),$(t.const_get_relative(c,"Encoding"),"register",["UTF-16LE"],(n=function(){var e,r,a=n.$$s||this;return t.def(a,"$each_byte",e=function(r){var n=e.$$p,a=n||l;n&&(e.$$p=null);for(var i=0,o=r.length;i<o;i++){var s=r.charCodeAt(i);t.yield1(a,255&s),t.yield1(a,s>>8)}},e.$$arity=1),t.def(a,"$bytesize",r=function(t){return t.$bytes().$length()},r.$$arity=1),l&&"bytesize"},n.$$s=s,n.$$arity=0,n)),$(t.const_get_relative(c,"Encoding"),"register",["UTF-16BE"],(a=function(){var e,r,n=a.$$s||this;return t.def(n,"$each_byte",e=function(r){var n=e.$$p,a=n||l;n&&(e.$$p=null);for(var i=0,o=r.length;i<o;i++){var s=r.charCodeAt(i);t.yield1(a,s>>8),t.yield1(a,255&s)}},e.$$arity=1),t.def(n,"$bytesize",r=function(t){return t.$bytes().$length()},r.$$arity=1),l&&"bytesize"},a.$$s=s,a.$$arity=0,a)),$(t.const_get_relative(c,"Encoding"),"register",["UTF-32LE"],(i=function(){var e,r,n=i.$$s||this;return t.def(n,"$each_byte",e=function(r){var n=e.$$p,a=n||l;n&&(e.$$p=null);for(var i=0,o=r.length;i<o;i++){var s=r.charCodeAt(i);t.yield1(a,255&s),t.yield1(a,s>>8)}},e.$$arity=1),t.def(n,"$bytesize",r=function(t){return t.$bytes().$length()},r.$$arity=1),l&&"bytesize"},i.$$s=s,i.$$arity=0,i)),$(t.const_get_relative(c,"Encoding"),"register",["ASCII-8BIT",_(["aliases","ascii","dummy"],{aliases:["BINARY","US-ASCII","ASCII"],ascii:!0,dummy:!0})],(o=function(){var e,r,n=o.$$s||this;return t.def(n,"$each_byte",e=function(r){var n=e.$$p,a=n||l;n&&(e.$$p=null);for(var i=0,o=r.length;i<o;i++){var s=r.charCodeAt(i);t.yield1(a,255&s),t.yield1(a,s>>8)}},e.$$arity=1),t.def(n,"$bytesize",r=function(t){return t.$bytes().$length()},r.$$arity=1),l&&"bytesize"},o.$$s=s,o.$$arity=0,o)),function(e,r,n){function a(){}var i,o,s,c,f,_,d,p,h=a=u(e,null,"String",a),g=h.$$proto,m=[h].concat(n);return g.encoding=l,String.prototype.encoding=t.const_get_qualified(t.const_get_relative(m,"Encoding"),"UTF_16LE"),t.defn(h,"$bytes",i=function(){return this.$each_byte().$to_a()},i.$$arity=0),t.defn(h,"$bytesize",o=function(){var t=this;return t.encoding.$bytesize(t)},o.$$arity=0),t.defn(h,"$each_byte",s=function(){var t=this,e=s.$$p,r=e||l;return e&&(s.$$p=null),r===l?t.$enum_for("each_byte"):($(t.encoding,"each_byte",[t],r.$to_proc()),t)},s.$$arity=0),t.defn(h,"$encode",c=function(t){return this.$dup().$force_encoding(t)},c.$$arity=1),t.defn(h,"$encoding",f=function(){return this.encoding},f.$$arity=0),t.defn(h,"$force_encoding",_=function(e){var r=this;return e===r.encoding?r:(e=t.const_get_relative(m,"Opal")["$coerce_to!"](e,t.const_get_relative(m,"String"),"to_s"),(e=t.const_get_relative(m,"Encoding").$find(e))===r.encoding?r:(r.encoding=e,r))},_.$$arity=1),t.defn(h,"$getbyte",d=function(t){var e=this;return e.encoding.$getbyte(e,t)},d.$$arity=1),t.defn(h,"$valid_encoding?",p=function(){return!0},p.$$arity=0),l&&"valid_encoding?"}(c[0],0,c)},Opal.modules["corelib/math"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t/e:t["$/"](e)}var n=(t.top,[]),a=(t.nil,t.breaker,t.slice,t.module),i=t.truthy;return t.add_stubs(["$new","$raise","$Float","$type_error","$Integer","$module_function","$checked","$float!","$===","$gamma","$-","$integer!","$/","$infinite?"]),function(n,o){var s,c,l,u,f,$,_,d,p,h,g,m,v,y,b,w,x,A,k,E,S,N,C,I,O,P,L,M,T,B,j=s=a(n,"Math"),F=(j.$$proto,[j].concat(o));t.const_set(F[0],"E",Math.E),t.const_set(F[0],"PI",Math.PI),t.const_set(F[0],"DomainError",t.const_get_relative(F,"Class").$new(t.const_get_relative(F,"StandardError"))),t.defs(j,"$checked",c=function(e,r){var n,a=this,i=arguments.length,o=i-1;o<0&&(o=0),n=new Array(o);for(var s=1;s<i;s++)n[s-1]=arguments[s];if(isNaN(n[0])||2==n.length&&isNaN(n[1]))return NaN;var c=Math[e].apply(null,n);return isNaN(c)&&a.$raise(t.const_get_relative(F,"DomainError"),'Numerical argument is out of domain - "'+e+'"'),c},c.$$arity=-2),t.defs(j,"$float!",l=function(e){var r=this;try{return r.$Float(e)}catch(n){if(!t.rescue(n,[t.const_get_relative(F,"ArgumentError")]))throw n;try{return r.$raise(t.const_get_relative(F,"Opal").$type_error(e,t.const_get_relative(F,"Float")))}finally{t.pop_exception()}}},l.$$arity=1),t.defs(j,"$integer!",u=function(e){var r=this;try{return r.$Integer(e)}catch(n){if(!t.rescue(n,[t.const_get_relative(F,"ArgumentError")]))throw n;try{return r.$raise(t.const_get_relative(F,"Opal").$type_error(e,t.const_get_relative(F,"Integer")))}finally{t.pop_exception()}}},u.$$arity=1),j.$module_function(),t.defn(j,"$acos",f=function(e){return t.const_get_relative(F,"Math").$checked("acos",t.const_get_relative(F,"Math")["$float!"](e))},f.$$arity=1),i(void 0!==Math.acosh)||(Math.acosh=function(t){return Math.log(t+Math.sqrt(t*t-1))}),t.defn(j,"$acosh",$=function(e){return t.const_get_relative(F,"Math").$checked("acosh",t.const_get_relative(F,"Math")["$float!"](e))},$.$$arity=1),t.defn(j,"$asin",_=function(e){return t.const_get_relative(F,"Math").$checked("asin",t.const_get_relative(F,"Math")["$float!"](e))},_.$$arity=1),i(void 0!==Math.asinh)||(Math.asinh=function(t){return Math.log(t+Math.sqrt(t*t+1))}),t.defn(j,"$asinh",d=function(e){return t.const_get_relative(F,"Math").$checked("asinh",t.const_get_relative(F,"Math")["$float!"](e))},d.$$arity=1),t.defn(j,"$atan",p=function(e){return t.const_get_relative(F,"Math").$checked("atan",t.const_get_relative(F,"Math")["$float!"](e))},p.$$arity=1),t.defn(j,"$atan2",h=function(e,r){return t.const_get_relative(F,"Math").$checked("atan2",t.const_get_relative(F,"Math")["$float!"](e),t.const_get_relative(F,"Math")["$float!"](r))},h.$$arity=2),i(void 0!==Math.atanh)||(Math.atanh=function(t){return.5*Math.log((1+t)/(1-t))}),t.defn(j,"$atanh",g=function(e){return t.const_get_relative(F,"Math").$checked("atanh",t.const_get_relative(F,"Math")["$float!"](e))},g.$$arity=1),i(void 0!==Math.cbrt)||(Math.cbrt=function(t){if(0==t)return 0;if(t<0)return-Math.cbrt(-t);for(var e=t,r=0;e<.125;)e*=8,r--;for(;e>1;)e*=.125,r++;for(e=(-.46946116*e+1.072302)*e+.3812513;r<0;)e*=.5,r++;for(;r>0;)e*=2,r--;return e=2/3*e+1/3*t/(e*e),e=2/3*e+1/3*t/(e*e),e=2/3*e+1/3*t/(e*e),e=2/3*e+1/3*t/(e*e)}),t.defn(j,"$cbrt",m=function(e){return t.const_get_relative(F,"Math").$checked("cbrt",t.const_get_relative(F,"Math")["$float!"](e))},m.$$arity=1),t.defn(j,"$cos",v=function(e){return t.const_get_relative(F,"Math").$checked("cos",t.const_get_relative(F,"Math")["$float!"](e))},v.$$arity=1),i(void 0!==Math.cosh)||(Math.cosh=function(t){return(Math.exp(t)+Math.exp(-t))/2}),t.defn(j,"$cosh",y=function(e){return t.const_get_relative(F,"Math").$checked("cosh",t.const_get_relative(F,"Math")["$float!"](e))},y.$$arity=1),i(void 0!==Math.erf)||(Math.erf=function(t){var e=1;t<0&&(e=-1),t=Math.abs(t);var r=1/(1+.3275911*t);return e*(1-((((1.061405429*r-1.453152027)*r+1.421413741)*r-.284496736)*r+.254829592)*r*Math.exp(-t*t))}),t.defn(j,"$erf",b=function(e){return t.const_get_relative(F,"Math").$checked("erf",t.const_get_relative(F,"Math")["$float!"](e))},b.$$arity=1),i(void 0!==Math.erfc)||(Math.erfc=function(t){var e=Math.abs(t),r=1/(.5*e+1),n=.17087277*r-.82215223,a=r*n+1.48851587,i=r*a-1.13520398,o=r*i+.27886807,s=r*o-.18628806,c=r*s+.09678418,l=r*c+.37409196,u=r*l+1.00002368,f=r*u,$=-e*e-1.26551223+f,_=r*Math.exp($);return t<0?2-_:_}),t.defn(j,"$erfc",w=function(e){return t.const_get_relative(F,"Math").$checked("erfc",t.const_get_relative(F,"Math")["$float!"](e))},w.$$arity=1),t.defn(j,"$exp",x=function(e){return t.const_get_relative(F,"Math").$checked("exp",t.const_get_relative(F,"Math")["$float!"](e))},x.$$arity=1),t.defn(j,"$frexp",A=function(e){if(e=t.const_get_relative(F,"Math")["$float!"](e),isNaN(e))return[NaN,0];var r=Math.floor(Math.log(Math.abs(e))/Math.log(2))+1;return[e/Math.pow(2,r),r]},A.$$arity=1),t.defn(j,"$gamma",k=function(r){var n=this;r=t.const_get_relative(F,"Math")["$float!"](r);var a,i,o,s,c,l,u,f,$,_=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22];if(isNaN(r))return NaN;if(0===r&&1/r<0)return-1/0;if(-1!==r&&r!==-1/0||n.$raise(t.const_get_relative(F,"DomainError"),'Numerical argument is out of domain - "gamma"'),t.const_get_relative(F,"Integer")["$==="](r)){if(r<=0)return isFinite(r)?1/0:NaN;if(r>171)return 1/0;for(s=r-2,c=r-1;s>1;)c*=s,s--;return 0==c&&(c=1),c}if(r<.5)return Math.PI/(Math.sin(Math.PI*r)*t.const_get_relative(F,"Math").$gamma(e(1,r)));if(r>=171.35)return 1/0;if(r>85)return l=r*r,u=l*r,f=u*r,$=f*r,Math.sqrt(2*Math.PI/r)*Math.pow(r/Math.E,r)*(1+1/(12*r)+1/(288*l)-139/(51840*u)-571/(2488320*f)+163879/(209018880*$)+5246819/(75246796800*$*r));for(r-=1,o=_[0],a=1;a<_.length;++a)o+=_[a]/(r+a);return i=r+4.7421875+.5,Math.sqrt(2*Math.PI)*Math.pow(i,r+.5)*Math.exp(-i)*o},k.$$arity=1),i(void 0!==Math.hypot)||(Math.hypot=function(t,e){return Math.sqrt(t*t+e*e)}),t.defn(j,"$hypot",E=function(e,r){return t.const_get_relative(F,"Math").$checked("hypot",t.const_get_relative(F,"Math")["$float!"](e),t.const_get_relative(F,"Math")["$float!"](r))},E.$$arity=2),t.defn(j,"$ldexp",S=function(e,r){var n=this;return e=t.const_get_relative(F,"Math")["$float!"](e),r=t.const_get_relative(F,"Math")["$integer!"](r),isNaN(r)&&n.$raise(t.const_get_relative(F,"RangeError"),"float NaN out of range of integer"),e*Math.pow(2,r)},S.$$arity=2),t.defn(j,"$lgamma",N=function(e){return-1==e?[1/0,1]:[Math.log(Math.abs(t.const_get_relative(F,"Math").$gamma(e))),t.const_get_relative(F,"Math").$gamma(e)<0?-1:1]},N.$$arity=1),t.defn(j,"$log",C=function(e,n){var a=this;return i(t.const_get_relative(F,"String")["$==="](e))&&a.$raise(t.const_get_relative(F,"Opal").$type_error(e,t.const_get_relative(F,"Float"))),i(null==n)?t.const_get_relative(F,"Math").$checked("log",t.const_get_relative(F,"Math")["$float!"](e)):(i(t.const_get_relative(F,"String")["$==="](n))&&a.$raise(t.const_get_relative(F,"Opal").$type_error(n,t.const_get_relative(F,"Float"))),r(t.const_get_relative(F,"Math").$checked("log",t.const_get_relative(F,"Math")["$float!"](e)),t.const_get_relative(F,"Math").$checked("log",t.const_get_relative(F,"Math")["$float!"](n))))},C.$$arity=-2),i(void 0!==Math.log10)||(Math.log10=function(t){return Math.log(t)/Math.LN10}),t.defn(j,"$log10",I=function(e){var r=this;return i(t.const_get_relative(F,"String")["$==="](e))&&r.$raise(t.const_get_relative(F,"Opal").$type_error(e,t.const_get_relative(F,"Float"))),t.const_get_relative(F,"Math").$checked("log10",t.const_get_relative(F,"Math")["$float!"](e))},I.$$arity=1),i(void 0!==Math.log2)||(Math.log2=function(t){return Math.log(t)/Math.LN2}),t.defn(j,"$log2",O=function(e){var r=this;return i(t.const_get_relative(F,"String")["$==="](e))&&r.$raise(t.const_get_relative(F,"Opal").$type_error(e,t.const_get_relative(F,"Float"))),t.const_get_relative(F,"Math").$checked("log2",t.const_get_relative(F,"Math")["$float!"](e))},O.$$arity=1),t.defn(j,"$sin",P=function(e){return t.const_get_relative(F,"Math").$checked("sin",t.const_get_relative(F,"Math")["$float!"](e))},P.$$arity=1),i(void 0!==Math.sinh)||(Math.sinh=function(t){return(Math.exp(t)-Math.exp(-t))/2}),t.defn(j,"$sinh",L=function(e){return t.const_get_relative(F,"Math").$checked("sinh",t.const_get_relative(F,"Math")["$float!"](e))},L.$$arity=1),t.defn(j,"$sqrt",M=function(e){return t.const_get_relative(F,"Math").$checked("sqrt",t.const_get_relative(F,"Math")["$float!"](e))},M.$$arity=1),t.defn(j,"$tan",T=function(e){return e=t.const_get_relative(F,"Math")["$float!"](e),i(e["$infinite?"]())?t.const_get_qualified(t.const_get_relative(F,"Float"),"NAN"):t.const_get_relative(F,"Math").$checked("tan",t.const_get_relative(F,"Math")["$float!"](e))},T.$$arity=1),i(void 0!==Math.tanh)||(Math.tanh=function(t){return t==1/0?1:t==-1/0?-1:(Math.exp(t)-Math.exp(-t))/(Math.exp(t)+Math.exp(-t))}),t.defn(j,"$tanh",B=function(e){return t.const_get_relative(F,"Math").$checked("tanh",t.const_get_relative(F,"Math")["$float!"](e))},B.$$arity=1)}(n[0],n)},Opal.modules["corelib/complex"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t*e:t["$*"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}function n(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}function a(t,e){return"number"==typeof t&&"number"==typeof e?t/e:t["$/"](e)}function i(t,e){return"number"==typeof t&&"number"==typeof e?t>e:t["$>"](e)}var o=t.top,s=[],c=t.nil,l=(t.breaker,t.slice,t.klass),u=t.truthy,f=t.module;return t.add_stubs(["$require","$===","$real?","$raise","$new","$*","$cos","$sin","$attr_reader","$class","$==","$real","$imag","$Complex","$-@","$+","$__coerced__","$-","$nan?","$/","$conj","$abs2","$quo","$polar","$exp","$log","$>","$!=","$divmod","$**","$hypot","$atan2","$lcm","$denominator","$to_s","$numerator","$abs","$arg","$rationalize","$to_f","$to_i","$to_r","$inspect","$positive?","$zero?","$infinite?"]),o.$require("corelib/numeric"),function(o,s,f){function $(){}var _,d,p,h,g,m,v,y,b,w,x,A,k,E,S,N,C,I,O,P,L,M,T,B,j,F,R,q,D,z=$=l(o,s,"Complex",$),U=z.$$proto,H=[z].concat(f);U.real=U.imag=c,t.defs(z,"$rect",_=function(e,r){var n,a,i,o=this;return null==r&&(r=0),u(u(n=u(a=u(i=t.const_get_relative(H,"Numeric")["$==="](e))?e["$real?"]():i)?t.const_get_relative(H,"Numeric")["$==="](r):a)?r["$real?"]():n)||o.$raise(t.const_get_relative(H,"TypeError"),"not a real"),o.$new(e,r)},_.$$arity=-2),function(e,r){e.$$proto,[e].concat(r);t.alias(e,"rectangular","rect")}(t.get_singleton_class(z),H),t.defs(z,"$polar",d=function(r,n){var a,i,o,s=this;return null==n&&(n=0),u(u(a=u(i=u(o=t.const_get_relative(H,"Numeric")["$==="](r))?r["$real?"]():o)?t.const_get_relative(H,"Numeric")["$==="](n):i)?n["$real?"]():a)||s.$raise(t.const_get_relative(H,"TypeError"),"not a real"),s.$new(e(r,t.const_get_relative(H,"Math").$cos(n)),e(r,t.const_get_relative(H,"Math").$sin(n)))},d.$$arity=-2),z.$attr_reader("real","imag"),t.defn(z,"$initialize",p=function(t,e){var r=this;return null==e&&(e=0),r.real=t,r.imag=e},p.$$arity=-2),t.defn(z,"$coerce",h=function(e){var r,n=this;return u(t.const_get_relative(H,"Complex")["$==="](e))?[e,n]:u(u(r=t.const_get_relative(H,"Numeric")["$==="](e))?e["$real?"]():r)?[t.const_get_relative(H,"Complex").$new(e,0),n]:n.$raise(t.const_get_relative(H,"TypeError"),e.$class()+" can't be coerced into Complex")},h.$$arity=1),t.defn(z,"$==",g=function(e){var r,n=this;return u(t.const_get_relative(H,"Complex")["$==="](e))?(r=n.real["$=="](e.$real()))?n.imag["$=="](e.$imag()):n.real["$=="](e.$real()):u(u(r=t.const_get_relative(H,"Numeric")["$==="](e))?e["$real?"]():r)?(r=n.real["$=="](e))?n.imag["$=="](0):n.real["$=="](e):e["$=="](n)},g.$$arity=1),t.defn(z,"$-@",m=function(){var t=this;return t.$Complex(t.real["$-@"](),t.imag["$-@"]())},m.$$arity=0),t.defn(z,"$+",v=function(e){var n,a=this;return u(t.const_get_relative(H,"Complex")["$==="](e))?a.$Complex(r(a.real,e.$real()),r(a.imag,e.$imag())):u(u(n=t.const_get_relative(H,"Numeric")["$==="](e))?e["$real?"]():n)?a.$Complex(r(a.real,e),a.imag):a.$__coerced__("+",e)},v.$$arity=1),t.defn(z,"$-",y=function(e){var r,a=this;return u(t.const_get_relative(H,"Complex")["$==="](e))?a.$Complex(n(a.real,e.$real()),n(a.imag,e.$imag())):u(u(r=t.const_get_relative(H,"Numeric")["$==="](e))?e["$real?"]():r)?a.$Complex(n(a.real,e),a.imag):a.$__coerced__("-",e)},y.$$arity=1),t.defn(z,"$*",b=function(a){var i,o=this;return u(t.const_get_relative(H,"Complex")["$==="](a))?o.$Complex(n(e(o.real,a.$real()),e(o.imag,a.$imag())),r(e(o.real,a.$imag()),e(o.imag,a.$real()))):u(u(i=t.const_get_relative(H,"Numeric")["$==="](a))?a["$real?"]():i)?o.$Complex(e(o.real,a),e(o.imag,a)):o.$__coerced__("*",a)},b.$$arity=1),t.defn(z,"$/",w=function(r){var n,i,o,s,c=this;return u(t.const_get_relative(H,"Complex")["$==="](r))?u(u(n=u(i=u(o=u(s=t.const_get_relative(H,"Number")["$==="](c.real))?c.real["$nan?"]():s)?o:u(s=t.const_get_relative(H,"Number")["$==="](c.imag))?c.imag["$nan?"]():s)?i:u(o=t.const_get_relative(H,"Number")["$==="](r.$real()))?r.$real()["$nan?"]():o)?n:u(i=t.const_get_relative(H,"Number")["$==="](r.$imag()))?r.$imag()["$nan?"]():i)?t.const_get_relative(H,"Complex").$new(t.const_get_qualified(t.const_get_relative(H,"Float"),"NAN"),t.const_get_qualified(t.const_get_relative(H,"Float"),"NAN")):a(e(c,r.$conj()),r.$abs2()):u(u(n=t.const_get_relative(H,"Numeric")["$==="](r))?r["$real?"]():n)?c.$Complex(c.real.$quo(r),c.imag.$quo(r)):c.$__coerced__("/",r)},w.$$arity=1),t.defn(z,"$**",x=function(o){var s,l,f,$,_=this,d=c,p=c,h=c,g=c,m=c,v=c,y=c,b=c,w=c,x=c,A=c;if(o["$=="](0))return t.const_get_relative(H,"Complex").$new(1,0);if(u(t.const_get_relative(H,"Complex")["$==="](o)))return l=_.$polar(),s=t.to_ary(l),d=null==s[0]?c:s[0],p=null==s[1]?c:s[1],h=o.$real(),g=o.$imag(),m=t.const_get_relative(H,"Math").$exp(n(e(h,t.const_get_relative(H,"Math").$log(d)),e(g,p))),v=r(e(p,h),e(g,t.const_get_relative(H,"Math").$log(d))),t.const_get_relative(H,"Complex").$polar(m,v);if(u(t.const_get_relative(H,"Integer")["$==="](o))){if(u(i(o,0))){for(y=_,b=y,w=n(o,1);u(w["$!="](0));){for(;u(($=w.$divmod(2),f=t.to_ary($),x=null==f[0]?c:f[0],A=null==f[1]?c:f[1],A["$=="](0)));)y=_.$Complex(n(e(y.$real(),y.$real()),e(y.$imag(),y.$imag())),e(e(2,y.$real()),y.$imag())),w=x;b=e(b,y),w=n(w,1)}return b}return a(t.const_get_relative(H,"Rational").$new(1,1),_)["$**"](o["$-@"]())}return u(u(s=t.const_get_relative(H,"Float")["$==="](o))?s:t.const_get_relative(H,"Rational")["$==="](o))?(l=_.$polar(),s=t.to_ary(l),d=null==s[0]?c:s[0],p=null==s[1]?c:s[1],t.const_get_relative(H,"Complex").$polar(d["$**"](o),e(p,o))):_.$__coerced__("**",o)},x.$$arity=1),t.defn(z,"$abs",A=function(){var e=this;return t.const_get_relative(H,"Math").$hypot(e.real,e.imag)},A.$$arity=0),t.defn(z,"$abs2",k=function(){var t=this;return r(e(t.real,t.real),e(t.imag,t.imag))},k.$$arity=0),t.defn(z,"$angle",E=function(){var e=this;return t.const_get_relative(H,"Math").$atan2(e.imag,e.real)},E.$$arity=0),t.alias(z,"arg","angle"),t.defn(z,"$conj",S=function(){var t=this;return t.$Complex(t.real,t.imag["$-@"]())},S.$$arity=0),t.alias(z,"conjugate","conj"),t.defn(z,"$denominator",N=function(){var t=this;return t.real.$denominator().$lcm(t.imag.$denominator())},N.$$arity=0),t.alias(z,"divide","/"),t.defn(z,"$eql?",C=function(e){var r,n,a=this;return u(r=u(n=t.const_get_relative(H,"Complex")["$==="](e))?a.real.$class()["$=="](a.imag.$class()):n)?a["$=="](e):r},C.$$arity=1),t.defn(z,"$fdiv",I=function(e){var r=this;return u(t.const_get_relative(H,"Numeric")["$==="](e))||r.$raise(t.const_get_relative(H,"TypeError"),e.$class()+" can't be coerced into Complex"),a(r,e)},I.$$arity=1),t.defn(z,"$hash",O=function(){var t=this;return"Complex:"+t.real+":"+t.imag},O.$$arity=0),t.alias(z,"imaginary","imag"),t.defn(z,"$inspect",P=function(){return"("+this.$to_s()+")"},P.$$arity=0),t.alias(z,"magnitude","abs"),t.udef(z,"$negative?"),t.defn(z,"$numerator",L=function(){var t=this,r=c;return r=t.$denominator(),t.$Complex(e(t.real.$numerator(),a(r,t.real.$denominator())),e(t.imag.$numerator(),a(r,t.imag.$denominator())))},L.$$arity=0),t.alias(z,"phase","arg"),t.defn(z,"$polar",M=function(){var t=this;return[t.$abs(),t.$arg()]},M.$$arity=0),t.udef(z,"$positive?"),t.alias(z,"quo","/"),t.defn(z,"$rationalize",T=function(e){var r=this;return arguments.length>1&&r.$raise(t.const_get_relative(H,"ArgumentError"),"wrong number of arguments ("+arguments.length+" for 0..1)"),u(r.imag["$!="](0))&&r.$raise(t.const_get_relative(H,"RangeError"),"can't' convert "+r+" into Rational"),r.$real().$rationalize(e)},T.$$arity=-1),t.defn(z,"$real?",B=function(){return!1},B.$$arity=0),t.defn(z,"$rect",j=function(){var t=this;return[t.real,t.imag]},j.$$arity=0),t.alias(z,"rectangular","rect"),t.defn(z,"$to_f",F=function(){var e=this;return e.imag["$=="](0)||e.$raise(t.const_get_relative(H,"RangeError"),"can't convert "+e+" into Float"),e.real.$to_f()},F.$$arity=0),t.defn(z,"$to_i",R=function(){var e=this;return e.imag["$=="](0)||e.$raise(t.const_get_relative(H,"RangeError"),"can't convert "+e+" into Integer"),e.real.$to_i()},R.$$arity=0),t.defn(z,"$to_r",q=function(){var e=this;return e.imag["$=="](0)||e.$raise(t.const_get_relative(H,"RangeError"),"can't convert "+e+" into Rational"),e.real.$to_r()},q.$$arity=0),t.defn(z,"$to_s",D=function(){var e,n,a,i=this,o=c;return o=i.real.$inspect(),o=u(u(e=u(n=u(a=t.const_get_relative(H,"Number")["$==="](i.imag))?i.imag["$nan?"]():a)?n:i.imag["$positive?"]())?e:i.imag["$zero?"]())?r(o,"+"):r(o,"-"),o=r(o,i.imag.$abs().$inspect()),u(u(e=t.const_get_relative(H,"Number")["$==="](i.imag))?u(n=i.imag["$nan?"]())?n:i.imag["$infinite?"]():e)&&(o=r(o,"*")),r(o,"i")},D.$$arity=0),t.const_set(H[0],"I",z.$new(0,1))}(s[0],t.const_get_relative(s,"Numeric"),s),function(e,r){var n,a,i=n=f(e,"Kernel"),o=(i.$$proto,[i].concat(r));t.defn(i,"$Complex",a=function(e,r){return null==r&&(r=c),u(r)?t.const_get_relative(o,"Complex").$new(e,r):t.const_get_relative(o,"Complex").$new(e,0)},a.$$arity=-2)}(s[0],s)},Opal.modules["corelib/rational"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t<e:t["$<"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t/e:t["$/"](e)}function n(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}function a(t,e){return"number"==typeof t&&"number"==typeof e?t*e:t["$*"](e)}function i(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}function o(t,e){return"number"==typeof t&&"number"==typeof e?t>e:t["$>"](e)}function s(t,e){return"number"==typeof t&&"number"==typeof e?t<=e:t["$<="](e)}var c=t.top,l=[],u=t.nil,f=(t.breaker,t.slice,t.klass),$=t.truthy,_=t.module;return t.add_stubs(["$require","$to_i","$==","$raise","$<","$-@","$new","$gcd","$/","$nil?","$===","$reduce","$to_r","$equal?","$!","$coerce_to!","$attr_reader","$to_f","$numerator","$denominator","$<=>","$-","$*","$__coerced__","$+","$Rational","$>","$**","$abs","$ceil","$with_precision","$floor","$to_s","$<=","$truncate","$send","$convert"]),c.$require("corelib/numeric"),function(c,l,_){function d(){}var p,h,g,m,v,y,b,w,x,A,k,E,S,N,C,I,O,P,L,M,T,B,j,F,R,q,D=d=f(c,l,"Rational",d),z=D.$$proto,U=[D].concat(_);z.num=z.den=u,t.defs(D,"$reduce",p=function(n,a){var i=this,o=u;if(n=n.$to_i(),a=a.$to_i(),a["$=="](0))i.$raise(t.const_get_relative(U,"ZeroDivisionError"),"divided by 0");else if($(e(a,0)))n=n["$-@"](),a=a["$-@"]();else if(a["$=="](1))return i.$new(n,a);return o=n.$gcd(a),i.$new(r(n,o),r(a,o))},p.$$arity=2),t.defs(D,"$convert",h=function(e,n){var a,i,o=this;return $($(a=e["$nil?"]())?a:n["$nil?"]())&&o.$raise(t.const_get_relative(U,"TypeError"),"cannot convert nil into Rational"),$($(a=t.const_get_relative(U,"Integer")["$==="](e))?t.const_get_relative(U,"Integer")["$==="](n):a)?o.$reduce(e,n):($($(a=$(i=t.const_get_relative(U,"Float")["$==="](e))?i:t.const_get_relative(U,"String")["$==="](e))?a:t.const_get_relative(U,"Complex")["$==="](e))&&(e=e.$to_r()),$($(a=$(i=t.const_get_relative(U,"Float")["$==="](n))?i:t.const_get_relative(U,"String")["$==="](n))?a:t.const_get_relative(U,"Complex")["$==="](n))&&(n=n.$to_r()),$($(a=n["$equal?"](1))?t.const_get_relative(U,"Integer")["$==="](e)["$!"]():a)?t.const_get_relative(U,"Opal")["$coerce_to!"](e,t.const_get_relative(U,"Rational"),"to_r"):$($(a=t.const_get_relative(U,"Numeric")["$==="](e))?t.const_get_relative(U,"Numeric")["$==="](n):a)?r(e,n):o.$reduce(e,n))},h.$$arity=2),D.$attr_reader("numerator","denominator"),t.defn(D,"$initialize",g=function(t,e){var r=this;return r.num=t,r.den=e},g.$$arity=2),t.defn(D,"$numerator",m=function(){return this.num},m.$$arity=0),t.defn(D,"$denominator",v=function(){return this.den},v.$$arity=0),t.defn(D,"$coerce",y=function(e){var r=this,n=u;return function(){return n=e,t.const_get_relative(U,"Rational")["$==="](n)?[e,r]:t.const_get_relative(U,"Integer")["$==="](n)?[e.$to_r(),r]:t.const_get_relative(U,"Float")["$==="](n)?[e,r.$to_f()]:u}()},y.$$arity=1),t.defn(D,"$==",b=function(e){var r,n=this,a=u;return function(){return a=e,t.const_get_relative(U,"Rational")["$==="](a)?(r=n.num["$=="](e.$numerator()))?n.den["$=="](e.$denominator()):n.num["$=="](e.$numerator()):t.const_get_relative(U,"Integer")["$==="](a)?(r=n.num["$=="](e))?n.den["$=="](1):n.num["$=="](e):t.const_get_relative(U,"Float")["$==="](a)?n.$to_f()["$=="](e):e["$=="](n)}()},b.$$arity=1),t.defn(D,"$<=>",w=function(e){var r=this,i=u;return function(){return i=e,t.const_get_relative(U,"Rational")["$==="](i)?n(a(r.num,e.$denominator()),a(r.den,e.$numerator()))["$<=>"](0):t.const_get_relative(U,"Integer")["$==="](i)?n(r.num,a(r.den,e))["$<=>"](0):t.const_get_relative(U,"Float")["$==="](i)?r.$to_f()["$<=>"](e):r.$__coerced__("<=>",e)}()},w.$$arity=1),t.defn(D,"$+",x=function(e){var r=this,n=u,o=u,s=u;return function(){return n=e,t.const_get_relative(U,"Rational")["$==="](n)?(o=i(a(r.num,e.$denominator()),a(r.den,e.$numerator())),s=a(r.den,e.$denominator()),r.$Rational(o,s)):t.const_get_relative(U,"Integer")["$==="](n)?r.$Rational(i(r.num,a(e,r.den)),r.den):t.const_get_relative(U,"Float")["$==="](n)?i(r.$to_f(),e):r.$__coerced__("+",e)}()},x.$$arity=1),t.defn(D,"$-",A=function(e){var r=this,i=u,o=u,s=u;return function(){return i=e,t.const_get_relative(U,"Rational")["$==="](i)?(o=n(a(r.num,e.$denominator()),a(r.den,e.$numerator())),s=a(r.den,e.$denominator()),r.$Rational(o,s)):t.const_get_relative(U,"Integer")["$==="](i)?r.$Rational(n(r.num,a(e,r.den)),r.den):t.const_get_relative(U,"Float")["$==="](i)?n(r.$to_f(),e):r.$__coerced__("-",e)}()},A.$$arity=1),t.defn(D,"$*",k=function(e){var r=this,n=u,i=u,o=u;return function(){return n=e,t.const_get_relative(U,"Rational")["$==="](n)?(i=a(r.num,e.$numerator()),o=a(r.den,e.$denominator()),r.$Rational(i,o)):t.const_get_relative(U,"Integer")["$==="](n)?r.$Rational(a(r.num,e),r.den):t.const_get_relative(U,"Float")["$==="](n)?a(r.$to_f(),e):r.$__coerced__("*",e)}()},k.$$arity=1),t.defn(D,"$/",E=function(e){var n=this,i=u,o=u,s=u;return function(){return i=e,t.const_get_relative(U,"Rational")["$==="](i)?(o=a(n.num,e.$denominator()),s=a(n.den,e.$numerator()),n.$Rational(o,s)):t.const_get_relative(U,"Integer")["$==="](i)?e["$=="](0)?r(n.$to_f(),0):n.$Rational(n.num,a(n.den,e)):t.const_get_relative(U,"Float")["$==="](i)?r(n.$to_f(),e):n.$__coerced__("/",e)}()},E.$$arity=1),t.defn(D,"$**",S=function(r){var n,a=this,i=u;return function(){return i=r,t.const_get_relative(U,"Integer")["$==="](i)?$((n=a["$=="](0))?e(r,0):a["$=="](0))?t.const_get_qualified(t.const_get_relative(U,"Float"),"INFINITY"):$(o(r,0))?a.$Rational(a.num["$**"](r),a.den["$**"](r)):$(e(r,0))?a.$Rational(a.den["$**"](r["$-@"]()),a.num["$**"](r["$-@"]())):a.$Rational(1,1):t.const_get_relative(U,"Float")["$==="](i)?a.$to_f()["$**"](r):t.const_get_relative(U,"Rational")["$==="](i)?r["$=="](0)?a.$Rational(1,1):r.$denominator()["$=="](1)?$(e(r,0))?a.$Rational(a.den["$**"](r.$numerator().$abs()),a.num["$**"](r.$numerator().$abs())):a.$Rational(a.num["$**"](r.$numerator()),a.den["$**"](r.$numerator())):$((n=a["$=="](0))?e(r,0):a["$=="](0))?a.$raise(t.const_get_relative(U,"ZeroDivisionError"),"divided by 0"):a.$to_f()["$**"](r):a.$__coerced__("**",r)}()},S.$$arity=1),t.defn(D,"$abs",N=function(){var t=this;return t.$Rational(t.num.$abs(),t.den.$abs())},N.$$arity=0),
t.defn(D,"$ceil",C=function(t){var e=this;return null==t&&(t=0),t["$=="](0)?r(e.num["$-@"](),e.den)["$-@"]().$ceil():e.$with_precision("ceil",t)},C.$$arity=-1),t.alias(D,"divide","/"),t.defn(D,"$floor",I=function(t){var e=this;return null==t&&(t=0),t["$=="](0)?r(e.num["$-@"](),e.den)["$-@"]().$floor():e.$with_precision("floor",t)},I.$$arity=-1),t.defn(D,"$hash",O=function(){var t=this;return"Rational:"+t.num+":"+t.den},O.$$arity=0),t.defn(D,"$inspect",P=function(){return"("+this.$to_s()+")"},P.$$arity=0),t.alias(D,"quo","/"),t.defn(D,"$rationalize",L=function(e){var a=this;if(arguments.length>1&&a.$raise(t.const_get_relative(U,"ArgumentError"),"wrong number of arguments ("+arguments.length+" for 0..1)"),null==e)return a;for(var o,c,l,u,f,$=e.$abs(),_=n(a,$),d=i(a,$),p=0,h=1,g=1,m=0;;){if(l=_.$ceil(),s(l,d))break;u=l-1,o=u*h+p,c=u*m+g,f=r(1,n(d,u)),d=r(1,n(_,u)),_=f,p=h,g=m,h=o,m=c}return a.$Rational(l*h+p,l*m+g)},L.$$arity=-1),t.defn(D,"$round",M=function(t){var n=this,o=u,s=u,c=u;return null==t&&(t=0),t["$=="](0)?n.num["$=="](0)?0:n.den["$=="](1)?n.num:(o=i(a(n.num.$abs(),2),n.den),s=a(n.den,2),c=r(o,s).$truncate(),$(e(n.num,0))?c["$-@"]():c):n.$with_precision("round",t)},M.$$arity=-1),t.defn(D,"$to_f",T=function(){var t=this;return r(t.num,t.den)},T.$$arity=0),t.defn(D,"$to_i",B=function(){return this.$truncate()},B.$$arity=0),t.defn(D,"$to_r",j=function(){return this},j.$$arity=0),t.defn(D,"$to_s",F=function(){var t=this;return t.num+"/"+t.den},F.$$arity=0),t.defn(D,"$truncate",R=function(t){var r=this;return null==t&&(t=0),t["$=="](0)?$(e(r.num,0))?r.$ceil():r.$floor():r.$with_precision("truncate",t)},R.$$arity=-1),t.defn(D,"$with_precision",q=function(n,i){var o=this,s=u,c=u;return $(t.const_get_relative(U,"Integer")["$==="](i))||o.$raise(t.const_get_relative(U,"TypeError"),"not an Integer"),s=10["$**"](i),c=a(o,s),$(e(i,1))?r(c.$send(n),s).$to_i():o.$Rational(c.$send(n),s)},q.$$arity=2)}(l[0],t.const_get_relative(l,"Numeric"),l),function(e,r){var n,a,i=n=_(e,"Kernel"),o=(i.$$proto,[i].concat(r));t.defn(i,"$Rational",a=function(e,r){return null==r&&(r=1),t.const_get_relative(o,"Rational").$convert(e,r)},a.$$arity=-2)}(l[0],l)},Opal.modules["corelib/time"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t>e:t["$>"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t<e:t["$<"](e)}function n(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}function a(t,e){return"number"==typeof t&&"number"==typeof e?t/e:t["$/"](e)}function i(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}function o(t,e){return"number"==typeof t&&"number"==typeof e?t<=e:t["$<="](e)}var s=t.top,c=[],l=t.nil,u=(t.breaker,t.slice),f=t.klass,$=t.truthy,_=t.range;return t.add_stubs(["$require","$include","$===","$raise","$coerce_to!","$respond_to?","$to_str","$to_i","$new","$<=>","$to_f","$nil?","$>","$<","$strftime","$year","$month","$day","$+","$round","$/","$-","$copy_instance_variables","$initialize_dup","$is_a?","$zero?","$wday","$utc?","$mon","$yday","$hour","$min","$sec","$rjust","$ljust","$zone","$to_s","$[]","$cweek_cyear","$isdst","$<=","$!=","$==","$ceil"]),s.$require("corelib/comparable"),function(s,c,d){function p(){}function h(e,r,n,a,i,o){if(e=e.$$is_string?parseInt(e,10):t.const_get_relative(ot,"Opal")["$coerce_to!"](e,t.const_get_relative(ot,"Integer"),"to_int"),r===l)r=1;else if(!r.$$is_number)if(r["$respond_to?"]("to_str"))switch(r=r.$to_str(),r.toLowerCase()){case"jan":r=1;break;case"feb":r=2;break;case"mar":r=3;break;case"apr":r=4;break;case"may":r=5;break;case"jun":r=6;break;case"jul":r=7;break;case"aug":r=8;break;case"sep":r=9;break;case"oct":r=10;break;case"nov":r=11;break;case"dec":r=12;break;default:r=r.$to_i()}else r=t.const_get_relative(ot,"Opal")["$coerce_to!"](r,t.const_get_relative(ot,"Integer"),"to_int");return(r<1||r>12)&&it.$raise(t.const_get_relative(ot,"ArgumentError"),"month out of range: "+r),r-=1,n=n===l?1:n.$$is_string?parseInt(n,10):t.const_get_relative(ot,"Opal")["$coerce_to!"](n,t.const_get_relative(ot,"Integer"),"to_int"),(n<1||n>31)&&it.$raise(t.const_get_relative(ot,"ArgumentError"),"day out of range: "+n),a=a===l?0:a.$$is_string?parseInt(a,10):t.const_get_relative(ot,"Opal")["$coerce_to!"](a,t.const_get_relative(ot,"Integer"),"to_int"),(a<0||a>24)&&it.$raise(t.const_get_relative(ot,"ArgumentError"),"hour out of range: "+a),i=i===l?0:i.$$is_string?parseInt(i,10):t.const_get_relative(ot,"Opal")["$coerce_to!"](i,t.const_get_relative(ot,"Integer"),"to_int"),(i<0||i>59)&&it.$raise(t.const_get_relative(ot,"ArgumentError"),"min out of range: "+i),o===l?o=0:o.$$is_number||(o=o.$$is_string?parseInt(o,10):t.const_get_relative(ot,"Opal")["$coerce_to!"](o,t.const_get_relative(ot,"Integer"),"to_int")),(o<0||o>60)&&it.$raise(t.const_get_relative(ot,"ArgumentError"),"sec out of range: "+o),[e,r,n,a,i,o]}var g,m,v,y,b,w,x,A,k,E,S,N,C,I,O,P,L,M,T,B,j,F,R,q,D,z,U,H,G,Y,V,Q,X,J,W,K,Z,tt,et,rt,nt,at,it=p=f(s,c,"Time",p),ot=(it.$$proto,[it].concat(d));it.$include(t.const_get_relative(ot,"Comparable"));var st=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],ct=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],lt=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],ut=["January","February","March","April","May","June","July","August","September","October","November","December"];return t.defs(it,"$at",g=function(e,r){var n,a=this;return t.const_get_relative(ot,"Time")["$==="](e)?(void 0!==r&&a.$raise(t.const_get_relative(ot,"TypeError"),"can't convert Time into an exact number"),n=new Date(e.getTime()),n.is_utc=e.is_utc,n):(e.$$is_number||(e=t.const_get_relative(ot,"Opal")["$coerce_to!"](e,t.const_get_relative(ot,"Integer"),"to_int")),void 0===r?new Date(1e3*e):(r.$$is_number||(r=t.const_get_relative(ot,"Opal")["$coerce_to!"](r,t.const_get_relative(ot,"Integer"),"to_int")),new Date(1e3*e+r/1e3)))},g.$$arity=-2),t.defs(it,"$new",m=function(e,r,n,a,i,o,s){var c=this;null==r&&(r=l),null==n&&(n=l),null==a&&(a=l),null==i&&(i=l),null==o&&(o=l),null==s&&(s=l);var u,f;return void 0===e?new Date:(s!==l&&c.$raise(t.const_get_relative(ot,"ArgumentError"),"Opal does not support explicitly specifying UTC offset for Time"),u=h(e,r,n,a,i,o),e=u[0],r=u[1],n=u[2],a=u[3],i=u[4],o=u[5],f=new Date(e,r,n,a,i,0,1e3*o),e<100&&f.setFullYear(e),f)},m.$$arity=-1),t.defs(it,"$local",v=function(t,e,r,n,a,i,o,s,c,f){null==e&&(e=l),null==r&&(r=l),null==n&&(n=l),null==a&&(a=l),null==i&&(i=l),null==o&&(o=l),null==s&&(s=l),null==c&&(c=l),null==f&&(f=l);var $,_;return 10===arguments.length&&($=u.call(arguments),t=$[5],e=$[4],r=$[3],n=$[2],a=$[1],i=$[0]),$=h(t,e,r,n,a,i),t=$[0],e=$[1],r=$[2],n=$[3],a=$[4],i=$[5],_=new Date(t,e,r,n,a,0,1e3*i),t<100&&_.setFullYear(t),_},v.$$arity=-2),t.defs(it,"$gm",y=function(t,e,r,n,a,i,o,s,c,f){null==e&&(e=l),null==r&&(r=l),null==n&&(n=l),null==a&&(a=l),null==i&&(i=l),null==o&&(o=l),null==s&&(s=l),null==c&&(c=l),null==f&&(f=l);var $,_;return 10===arguments.length&&($=u.call(arguments),t=$[5],e=$[4],r=$[3],n=$[2],a=$[1],i=$[0]),$=h(t,e,r,n,a,i),t=$[0],e=$[1],r=$[2],n=$[3],a=$[4],i=$[5],_=new Date(Date.UTC(t,e,r,n,a,0,1e3*i)),t<100&&_.setUTCFullYear(t),_.is_utc=!0,_},y.$$arity=-2),function(e,r){e.$$proto,[e].concat(r);t.alias(e,"mktime","local"),t.alias(e,"utc","gm")}(t.get_singleton_class(it),ot),t.defs(it,"$now",b=function(){return this.$new()},b.$$arity=0),t.defn(it,"$+",w=function(e){var r=this;$(t.const_get_relative(ot,"Time")["$==="](e))&&r.$raise(t.const_get_relative(ot,"TypeError"),"time + time?"),e.$$is_number||(e=t.const_get_relative(ot,"Opal")["$coerce_to!"](e,t.const_get_relative(ot,"Integer"),"to_int"));var n=new Date(r.getTime()+1e3*e);return n.is_utc=r.is_utc,n},w.$$arity=1),t.defn(it,"$-",x=function(e){var r=this;if($(t.const_get_relative(ot,"Time")["$==="](e)))return(r.getTime()-e.getTime())/1e3;e.$$is_number||(e=t.const_get_relative(ot,"Opal")["$coerce_to!"](e,t.const_get_relative(ot,"Integer"),"to_int"));var n=new Date(r.getTime()-1e3*e);return n.is_utc=r.is_utc,n},x.$$arity=1),t.defn(it,"$<=>",A=function(n){var a=this,i=l;return $(t.const_get_relative(ot,"Time")["$==="](n))?a.$to_f()["$<=>"](n.$to_f()):(i=n["$<=>"](a),$(i["$nil?"]())?l:$(e(i,0))?-1:$(r(i,0))?1:0)},A.$$arity=1),t.defn(it,"$==",k=function(e){var r,n=this;return $(r=t.const_get_relative(ot,"Time")["$==="](e))?n.$to_f()===e.$to_f():r},k.$$arity=1),t.defn(it,"$asctime",E=function(){return this.$strftime("%a %b %e %H:%M:%S %Y")},E.$$arity=0),t.alias(it,"ctime","asctime"),t.defn(it,"$day",S=function(){var t=this;return t.is_utc?t.getUTCDate():t.getDate()},S.$$arity=0),t.defn(it,"$yday",N=function(){var e=this,r=l,o=l,s=l;return r=t.const_get_relative(ot,"Time").$new(e.$year()).$to_i(),o=t.const_get_relative(ot,"Time").$new(e.$year(),e.$month(),e.$day()).$to_i(),s=86400,n(a(i(o,r),s).$round(),1)},N.$$arity=0),t.defn(it,"$isdst",C=function(){var t=this,e=new Date(t.getFullYear(),0,1),r=new Date(t.getFullYear(),6,1);return t.getTimezoneOffset()<Math.max(e.getTimezoneOffset(),r.getTimezoneOffset())},C.$$arity=0),t.alias(it,"dst?","isdst"),t.defn(it,"$dup",I=function(){var t=this,e=l;return e=new Date(t.getTime()),e.$copy_instance_variables(t),e.$initialize_dup(t),e},I.$$arity=0),t.defn(it,"$eql?",O=function(e){var r,n=this;return $(r=e["$is_a?"](t.const_get_relative(ot,"Time")))?n["$<=>"](e)["$zero?"]():r},O.$$arity=1),t.defn(it,"$friday?",P=function(){return 5==this.$wday()},P.$$arity=0),t.defn(it,"$hash",L=function(){return"Time:"+this.getTime()},L.$$arity=0),t.defn(it,"$hour",M=function(){var t=this;return t.is_utc?t.getUTCHours():t.getHours()},M.$$arity=0),t.defn(it,"$inspect",T=function(){var t=this;return $(t["$utc?"]())?t.$strftime("%Y-%m-%d %H:%M:%S UTC"):t.$strftime("%Y-%m-%d %H:%M:%S %z")},T.$$arity=0),t.alias(it,"mday","day"),t.defn(it,"$min",B=function(){var t=this;return t.is_utc?t.getUTCMinutes():t.getMinutes()},B.$$arity=0),t.defn(it,"$mon",j=function(){var t=this;return(t.is_utc?t.getUTCMonth():t.getMonth())+1},j.$$arity=0),t.defn(it,"$monday?",F=function(){return 1==this.$wday()},F.$$arity=0),t.alias(it,"month","mon"),t.defn(it,"$saturday?",R=function(){return 6==this.$wday()},R.$$arity=0),t.defn(it,"$sec",q=function(){var t=this;return t.is_utc?t.getUTCSeconds():t.getSeconds()},q.$$arity=0),t.defn(it,"$succ",D=function(){var t=this,e=new Date(t.getTime()+1e3);return e.is_utc=t.is_utc,e},D.$$arity=0),t.defn(it,"$usec",z=function(){return 1e3*this.getMilliseconds()},z.$$arity=0),t.defn(it,"$zone",U=function(){var t,e=this,r=e.toString();return t=-1==r.indexOf("(")?r.match(/[A-Z]{3,4}/)[0]:r.match(/\((.+)\)(?:\s|$)/)[1],"GMT"==t&&/(GMT\W*\d{4})/.test(r)?RegExp.$1:t},U.$$arity=0),t.defn(it,"$getgm",H=function(){var t=this,e=new Date(t.getTime());return e.is_utc=!0,e},H.$$arity=0),t.alias(it,"getutc","getgm"),t.defn(it,"$gmtime",G=function(){var t=this;return t.is_utc=!0,t},G.$$arity=0),t.alias(it,"utc","gmtime"),t.defn(it,"$gmt?",Y=function(){return!0===this.is_utc},Y.$$arity=0),t.defn(it,"$gmt_offset",V=function(){return 60*-this.getTimezoneOffset()},V.$$arity=0),t.defn(it,"$strftime",Q=function(t){var e=this;return t.replace(/%([\-_#^0]*:{0,2})(\d+)?([EO]*)(.)/g,function(t,r,n,a,i){var o="",s=-1!==r.indexOf("0"),c=-1===r.indexOf("-"),l=-1!==r.indexOf("_"),u=-1!==r.indexOf("^"),f=-1!==r.indexOf("#"),$=(r.match(":")||[]).length;switch(n=parseInt(n,10),s&&l&&(r.indexOf("0")<r.indexOf("_")?s=!1:l=!1),i){case"Y":o+=e.$year();break;case"C":s=!l,o+=Math.round(e.$year()/100);break;case"y":s=!l,o+=e.$year()%100;break;case"m":s=!l,o+=e.$mon();break;case"B":o+=ut[e.$mon()-1];break;case"b":case"h":l=!s,o+=lt[e.$mon()-1];break;case"d":s=!l,o+=e.$day();break;case"e":l=!s,o+=e.$day();break;case"j":o+=e.$yday();break;case"H":s=!l,o+=e.$hour();break;case"k":l=!s,o+=e.$hour();break;case"I":s=!l,o+=e.$hour()%12||12;break;case"l":l=!s,o+=e.$hour()%12||12;break;case"P":o+=e.$hour()>=12?"pm":"am";break;case"p":o+=e.$hour()>=12?"PM":"AM";break;case"M":s=!l,o+=e.$min();break;case"S":s=!l,o+=e.$sec();break;case"L":s=!l,n=isNaN(n)?3:n,o+=e.getMilliseconds();break;case"N":n=isNaN(n)?9:n,o+=e.getMilliseconds().toString().$rjust(3,"0"),o=o.$ljust(n,"0");break;case"z":var d=e.getTimezoneOffset(),p=Math.floor(Math.abs(d)/60),h=Math.abs(d)%60;o+=d<0?"+":"-",o+=p<10?"0":"",o+=p,$>0&&(o+=":"),o+=h<10?"0":"",o+=h,$>1&&(o+=":00");break;case"Z":o+=e.$zone();break;case"A":o+=st[e.$wday()];break;case"a":o+=ct[e.$wday()];break;case"u":o+=e.$wday()+1;break;case"w":o+=e.$wday();break;case"V":o+=e.$cweek_cyear()["$[]"](0).$to_s().$rjust(2,"0");break;case"G":o+=e.$cweek_cyear()["$[]"](1);break;case"g":o+=e.$cweek_cyear()["$[]"](1)["$[]"](_(-2,-1,!1));break;case"s":o+=e.$to_i();break;case"n":o+="\n";break;case"t":o+="\t";break;case"%":o+="%";break;case"c":o+=e.$strftime("%a %b %e %T %Y");break;case"D":case"x":o+=e.$strftime("%m/%d/%y");break;case"F":o+=e.$strftime("%Y-%m-%d");break;case"v":o+=e.$strftime("%e-%^b-%4Y");break;case"r":o+=e.$strftime("%I:%M:%S %p");break;case"R":o+=e.$strftime("%H:%M");break;case"T":case"X":o+=e.$strftime("%H:%M:%S");break;default:return t}return u&&(o=o.toUpperCase()),f&&(o=o.replace(/[A-Z]/,function(t){t.toLowerCase()}).replace(/[a-z]/,function(t){t.toUpperCase()})),c&&(s||l)&&(o=o.$rjust(isNaN(n)?2:n,l?" ":"0")),o})},Q.$$arity=1),t.defn(it,"$sunday?",X=function(){return 0==this.$wday()},X.$$arity=0),t.defn(it,"$thursday?",J=function(){return 4==this.$wday()},J.$$arity=0),t.defn(it,"$to_a",W=function(){var t=this;return[t.$sec(),t.$min(),t.$hour(),t.$day(),t.$month(),t.$year(),t.$wday(),t.$yday(),t.$isdst(),t.$zone()]},W.$$arity=0),t.defn(it,"$to_f",K=function(){return this.getTime()/1e3},K.$$arity=0),t.defn(it,"$to_i",Z=function(){var t=this;return parseInt(t.getTime()/1e3,10)},Z.$$arity=0),t.alias(it,"to_s","inspect"),t.defn(it,"$tuesday?",tt=function(){return 2==this.$wday()},tt.$$arity=0),t.alias(it,"tv_sec","to_i"),t.alias(it,"tv_usec","usec"),t.alias(it,"utc?","gmt?"),t.alias(it,"gmtoff","gmt_offset"),t.alias(it,"utc_offset","gmt_offset"),t.defn(it,"$wday",et=function(){var t=this;return t.is_utc?t.getUTCDay():t.getDay()},et.$$arity=0),t.defn(it,"$wednesday?",rt=function(){return 3==this.$wday()},rt.$$arity=0),t.defn(it,"$year",nt=function(){var t=this;return t.is_utc?t.getUTCFullYear():t.getFullYear()},nt.$$arity=0),t.defn(it,"$cweek_cyear",at=function(){var e,r=this,s=l,c=l,u=l,f=l,_=l,d=l,p=l;return s=t.const_get_relative(ot,"Time").$new(r.$year(),1,1),c=s.$wday(),0,u=r.$year(),$($(e=o(c,4))?c["$!="](0):e)?f=i(c,1):(f=i(i(c,7),1),f["$=="](-8)&&(f=-1)),_=a(n(r.$yday(),f),7).$ceil(),$(o(_,0))?t.const_get_relative(ot,"Time").$new(i(r.$year(),1),12,31).$cweek_cyear():(_["$=="](53)&&(d=t.const_get_relative(ot,"Time").$new(r.$year(),12,31),p=d.$wday(),$($(e=o(p,3))?p["$!="](0):e)&&(_=1,u=n(u,1))),[_,u])},at.$$arity=0),l&&"cweek_cyear"}(c[0],Date,c)},Opal.modules["corelib/struct"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t>e:t["$>"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}function n(t,e){return"number"==typeof t&&"number"==typeof e?t<e:t["$<"](e)}function a(t,e){return"number"==typeof t&&"number"==typeof e?t>=e:t["$>="](e)}function i(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}var o=t.top,s=[],c=t.nil,l=(t.breaker,t.slice,t.klass),u=t.truthy,f=t.send,$=t.hash2;return t.add_stubs(["$require","$include","$const_name!","$unshift","$map","$coerce_to!","$new","$each","$define_struct_attribute","$allocate","$initialize","$module_eval","$to_proc","$const_set","$==","$raise","$<<","$members","$define_method","$instance_eval","$>","$length","$class","$each_with_index","$[]","$[]=","$-","$hash","$===","$<","$-@","$size","$>=","$include?","$to_sym","$instance_of?","$__id__","$eql?","$enum_for","$name","$+","$join","$each_pair","$inspect","$inject","$flatten","$to_a","$respond_to?","$dig"]),o.$require("corelib/enumerable"),function(o,s,_){function d(){}var p,h,g,m,v,y,b,w,x,A,k,E,S,N,C,I,O,P,L,M=d=l(o,null,"Struct",d),T=(M.$$proto,[M].concat(_));return M.$include(t.const_get_relative(T,"Enumerable")),t.defs(M,"$new",p=function(e,r){var n,a,i,o=this,s=p.$$p,l=s||c,$=c,_=arguments.length,d=_-1;d<0&&(d=0),i=new Array(d);for(var h=1;h<_;h++)i[h-1]=arguments[h];if(s&&(p.$$p=null),u(e))try{e=t.const_get_relative(T,"Opal")["$const_name!"](e)}catch(r){if(!t.rescue(r,[t.const_get_relative(T,"TypeError"),t.const_get_relative(T,"NameError")]))throw r;try{i.$unshift(e),e=c}finally{t.pop_exception()}}return f(i,"map",[],(n=function(e){n.$$s;return null==e&&(e=c),t.const_get_relative(T,"Opal")["$coerce_to!"](e,t.const_get_relative(T,"String"),"to_str")},n.$$s=o,n.$$arity=1,n)),$=f(t.const_get_relative(T,"Class"),"new",[o],(a=function(){var e,r=a.$$s||this;return f(i,"each",[],(e=function(t){var r=e.$$s||this;return null==t&&(t=c),r.$define_struct_attribute(t)},e.$$s=r,e.$$arity=1,e)),function(e,r){var n;e.$$proto,[e].concat(r);return t.defn(e,"$new",n=function(e){var r,n=this,a=c,i=arguments.length,o=i-0;o<0&&(o=0),r=new Array(o);for(var s=0;s<i;s++)r[s-0]=arguments[s];return a=n.$allocate(),a.$$data={},f(a,"initialize",t.to_a(r)),a},n.$$arity=-1),t.alias(e,"[]","new")}(t.get_singleton_class(r),T)},a.$$s=o,a.$$arity=0,a)),u(l)&&f($,"module_eval",[],l.$to_proc()),u(e)&&t.const_get_relative(T,"Struct").$const_set(e,$),$},p.$$arity=-2),t.defs(M,"$define_struct_attribute",h=function(e){var r,n,a=this;return a["$=="](t.const_get_relative(T,"Struct"))&&a.$raise(t.const_get_relative(T,"ArgumentError"),"you cannot define attributes to the Struct class"),a.$members()["$<<"](e),f(a,"define_method",[e],(r=function(){return(r.$$s||this).$$data[e]},r.$$s=a,r.$$arity=0,r)),f(a,"define_method",[e+"="],(n=function(t){var r=n.$$s||this;return null==t&&(t=c),r.$$data[e]=t},n.$$s=a,n.$$arity=1,n))},h.$$arity=1),t.defs(M,"$members",g=function(){var e,r=this;return null==r.members&&(r.members=c),r["$=="](t.const_get_relative(T,"Struct"))&&r.$raise(t.const_get_relative(T,"ArgumentError"),"the Struct class has no members"),r.members=u(e=r.members)?e:[]},g.$$arity=0),t.defs(M,"$inherited",m=function(t){var e,r=this,n=c;return null==r.members&&(r.members=c),n=r.members,f(t,"instance_eval",[],(e=function(){return(e.$$s||this).members=n},e.$$s=r,e.$$arity=0,e))},m.$$arity=1),t.defn(M,"$initialize",v=function(n){var a,i,o=this,s=arguments.length,l=s-0;l<0&&(l=0),i=new Array(l);for(var $=0;$<s;$++)i[$-0]=arguments[$];return u(e(i.$length(),o.$class().$members().$length()))&&o.$raise(t.const_get_relative(T,"ArgumentError"),"struct size differs"),f(o.$class().$members(),"each_with_index",[],(a=function(e,n){var o=a.$$s||this,s=c;return null==e&&(e=c),null==n&&(n=c),s=[e,i["$[]"](n)],f(o,"[]=",t.to_a(s)),s[r(s.length,1)]},a.$$s=o,a.$$arity=2,a))},v.$$arity=-1),t.defn(M,"$members",y=function(){return this.$class().$members()},y.$$arity=0),t.defn(M,"$hash",b=function(){var e=this;return t.const_get_relative(T,"Hash").$new(e.$$data).$hash()},b.$$arity=0),t.defn(M,"$[]",w=function(e){var r=this;return u(t.const_get_relative(T,"Integer")["$==="](e))?(u(n(e,r.$class().$members().$size()["$-@"]()))&&r.$raise(t.const_get_relative(T,"IndexError"),"offset "+e+" too small for struct(size:"+r.$class().$members().$size()+")"),u(a(e,r.$class().$members().$size()))&&r.$raise(t.const_get_relative(T,"IndexError"),"offset "+e+" too large for struct(size:"+r.$class().$members().$size()+")"),e=r.$class().$members()["$[]"](e)):u(t.const_get_relative(T,"String")["$==="](e))?r.$$data.hasOwnProperty(e)||r.$raise(t.const_get_relative(T,"NameError").$new("no member '"+e+"' in struct",e)):r.$raise(t.const_get_relative(T,"TypeError"),"no implicit conversion of "+e.$class()+" into Integer"),e=t.const_get_relative(T,"Opal")["$coerce_to!"](e,t.const_get_relative(T,"String"),"to_str"),r.$$data[e]},w.$$arity=1),t.defn(M,"$[]=",x=function(e,r){var i=this;return u(t.const_get_relative(T,"Integer")["$==="](e))?(u(n(e,i.$class().$members().$size()["$-@"]()))&&i.$raise(t.const_get_relative(T,"IndexError"),"offset "+e+" too small for struct(size:"+i.$class().$members().$size()+")"),u(a(e,i.$class().$members().$size()))&&i.$raise(t.const_get_relative(T,"IndexError"),"offset "+e+" too large for struct(size:"+i.$class().$members().$size()+")"),e=i.$class().$members()["$[]"](e)):u(t.const_get_relative(T,"String")["$==="](e))?u(i.$class().$members()["$include?"](e.$to_sym()))||i.$raise(t.const_get_relative(T,"NameError").$new("no member '"+e+"' in struct",e)):i.$raise(t.const_get_relative(T,"TypeError"),"no implicit conversion of "+e.$class()+" into Integer"),e=t.const_get_relative(T,"Opal")["$coerce_to!"](e,t.const_get_relative(T,"String"),"to_str"),i.$$data[e]=r},x.$$arity=2),t.defn(M,"$==",A=function(e){function r(e,n){var o,s,c;a[e.$__id__()]=!0,i[n.$__id__()]=!0;for(o in e.$$data)if(s=e.$$data[o],c=n.$$data[o],t.const_get_relative(T,"Struct")["$==="](s)){if(!(a.hasOwnProperty(s.$__id__())&&i.hasOwnProperty(c.$__id__())||r(s,c)))return!1}else if(!s["$=="](c))return!1;return!0}var n=this;if(!u(e["$instance_of?"](n.$class())))return!1;var a={},i={};return r(n,e)},A.$$arity=1),t.defn(M,"$eql?",k=function(e){function r(e,n){var o,s,c;a[e.$__id__()]=!0,i[n.$__id__()]=!0;for(o in e.$$data)if(s=e.$$data[o],c=n.$$data[o],t.const_get_relative(T,"Struct")["$==="](s)){if(!(a.hasOwnProperty(s.$__id__())&&i.hasOwnProperty(c.$__id__())||r(s,c)))return!1}else if(!s["$eql?"](c))return!1;return!0}var n=this;if(!u(e["$instance_of?"](n.$class())))return!1;var a={},i={};return r(n,e)},k.$$arity=1),t.defn(M,"$each",E=function(){var e,r,n=this,a=E.$$p,i=a||c;return a&&(E.$$p=null),i===c?f(n,"enum_for",["each"],(e=function(){return(e.$$s||this).$size()},e.$$s=n,e.$$arity=0,e)):(f(n.$class().$members(),"each",[],(r=function(e){var n=r.$$s||this;return null==e&&(e=c),t.yield1(i,n["$[]"](e))},r.$$s=n,r.$$arity=1,r)),n)},E.$$arity=0),t.defn(M,"$each_pair",S=function(){var e,r,n=this,a=S.$$p,i=a||c;return a&&(S.$$p=null),i===c?f(n,"enum_for",["each_pair"],(e=function(){return(e.$$s||this).$size()},e.$$s=n,e.$$arity=0,e)):(f(n.$class().$members(),"each",[],(r=function(e){var n=r.$$s||this;return null==e&&(e=c),t.yield1(i,[e,n["$[]"](e)])},r.$$s=n,r.$$arity=1,r)),n)},S.$$arity=0),t.defn(M,"$length",N=function(){return this.$class().$members().$length()},N.$$arity=0),t.alias(M,"size","length"),t.defn(M,"$to_a",C=function(){var t,e=this;return f(e.$class().$members(),"map",[],(t=function(e){var r=t.$$s||this;return null==e&&(e=c),r["$[]"](e)},t.$$s=e,t.$$arity=1,t))},C.$$arity=0),t.alias(M,"values","to_a"),t.defn(M,"$inspect",I=function(){var e,r,n=this,a=c;return a="#<struct ",u(u(e=t.const_get_relative(T,"Struct")["$==="](n))?n.$class().$name():e)&&(a=i(a,n.$class()+" ")),a=i(a,f(n.$each_pair(),"map",[],(r=function(t,e){r.$$s;return null==t&&(t=c),null==e&&(e=c),t+"="+e.$inspect()},r.$$s=n,r.$$arity=2,r)).$join(", ")),a=i(a,">")},I.$$arity=0),t.alias(M,"to_s","inspect"),t.defn(M,"$to_h",O=function(){var e,n=this;return f(n.$class().$members(),"inject",[$([],{})],(e=function(n,a){var i=e.$$s||this,o=c;return null==n&&(n=c),null==a&&(a=c),o=[a,i["$[]"](a)],f(n,"[]=",t.to_a(o)),o[r(o.length,1)],n},e.$$s=n,e.$$arity=2,e))},O.$$arity=0),t.defn(M,"$values_at",P=function(e){var r,n,a=this,i=arguments.length,o=i-0;o<0&&(o=0),n=new Array(o);for(var s=0;s<i;s++)n[s-0]=arguments[s];n=f(n,"map",[],(r=function(t){r.$$s;return null==t&&(t=c),t.$$is_range?t.$to_a():t},r.$$s=a,r.$$arity=1,r)).$flatten();for(var l=[],u=0,$=n.length;u<$;u++)n[u].$$is_number||a.$raise(t.const_get_relative(T,"TypeError"),"no implicit conversion of "+n[u].$class()+" into Integer"),l.push(a["$[]"](n[u]));return l},P.$$arity=-1),t.defn(M,"$dig",L=function(e,r){var n,a=this,i=c,o=arguments.length,s=o-1;s<0&&(s=0),n=new Array(s);for(var l=1;l<o;l++)n[l-1]=arguments[l];return(i=u(e.$$is_string&&a.$$data.hasOwnProperty(e))?a.$$data[e]||c:c)===c||0===n.length?i:(u(i["$respond_to?"]("dig"))||a.$raise(t.const_get_relative(T,"TypeError"),i.$class()+" does not have #dig method"),f(i,"dig",t.to_a(n)))},L.$$arity=-2),c&&"dig"}(s[0],0,s)},Opal.modules["corelib/io"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}var r=(t.top,[]),n=t.nil,a=(t.breaker,t.slice,t.klass),i=t.module,o=t.send,s=t.gvars,c=t.truthy,l=n;t.add_stubs(["$attr_accessor","$size","$write","$join","$map","$String","$empty?","$concat","$chomp","$getbyte","$getc","$raise","$new","$write_proc=","$-","$extend"]),function(e,r,l){function u(){}var f,$,_,d,p=u=a(e,null,"IO",u),h=p.$$proto,g=[p].concat(l);h.tty=h.closed=n,t.const_set(g[0],"SEEK_SET",0),t.const_set(g[0],"SEEK_CUR",1),t.const_set(g[0],"SEEK_END",2),t.defn(p,"$tty?",f=function(){return this.tty},f.$$arity=0),t.defn(p,"$closed?",$=function(){return this.closed},$.$$arity=0),p.$attr_accessor("write_proc"),t.defn(p,"$write",_=function(t){return this.write_proc(t),t.$size()},_.$$arity=1),p.$attr_accessor("sync","tty"),t.defn(p,"$flush",d=function(){return n},d.$$arity=0),function(e,r){var a,l,u,f,$=a=i(e,"Writable");$.$$proto,[$].concat(r);t.defn($,"$<<",l=function(t){var e=this;return e.$write(t),e},l.$$arity=1),t.defn($,"$print",u=function(t){var e,r,a=this;null==s[","]&&(s[","]=n);var i=arguments.length,c=i-0;c<0&&(c=0),r=new Array(c);for(var l=0;l<i;l++)r[l-0]=arguments[l];return a.$write(o(r,"map",[],(e=function(t){var r=e.$$s||this;return null==t&&(t=n),r.$String(t)},e.$$s=a,e.$$arity=1,e)).$join(s[","])),n},u.$$arity=-1),t.defn($,"$puts",f=function(t){var e,r,a=this,i=n;null==s["/"]&&(s["/"]=n);var l=arguments.length,u=l-0;u<0&&(u=0),r=new Array(u);for(var f=0;f<l;f++)r[f-0]=arguments[f];return i=s["/"],c(r["$empty?"]())?a.$write(s["/"]):a.$write(o(r,"map",[],(e=function(t){var r=e.$$s||this;return null==t&&(t=n),r.$String(t).$chomp()},e.$$s=a,e.$$arity=1,e)).$concat([n]).$join(i)),n},f.$$arity=-1)}(g[0],g),function(e,r){var a,o,c,l,u,f=a=i(e,"Readable"),$=(f.$$proto,[f].concat(r));t.defn(f,"$readbyte",o=function(){return this.$getbyte()},o.$$arity=0),t.defn(f,"$readchar",c=function(){return this.$getc()},c.$$arity=0),t.defn(f,"$readline",l=function(e){var r=this;return null==s["/"]&&(s["/"]=n),null==e&&(e=s["/"]),r.$raise(t.const_get_relative($,"NotImplementedError"))},l.$$arity=-1),t.defn(f,"$readpartial",u=function(e,r){var a=this;return null==r&&(r=n),a.$raise(t.const_get_relative($,"NotImplementedError"))},u.$$arity=-2)}(g[0],g)}(r[0],0,r),t.const_set(r[0],"STDERR",s.stderr=t.const_get_relative(r,"IO").$new()),t.const_set(r[0],"STDIN",s.stdin=t.const_get_relative(r,"IO").$new()),t.const_set(r[0],"STDOUT",s.stdout=t.const_get_relative(r,"IO").$new());var u=t.global.console;return l=["object"==typeof process&&"object"==typeof process.stdout?function(t){process.stdout.write(t)}:function(t){u.log(t)}],o(t.const_get_relative(r,"STDOUT"),"write_proc=",t.to_a(l)),l[e(l.length,1)],l=["object"==typeof process&&"object"==typeof process.stderr?function(t){process.stderr.write(t)}:function(t){u.warn(t)}],o(t.const_get_relative(r,"STDERR"),"write_proc=",t.to_a(l)),l[e(l.length,1)],t.const_get_relative(r,"STDOUT").$extend(t.const_get_qualified(t.const_get_relative(r,"IO"),"Writable")),t.const_get_relative(r,"STDERR").$extend(t.const_get_qualified(t.const_get_relative(r,"IO"),"Writable"))},Opal.modules["corelib/main"]=function(t){var e,r,n=t.top,a=[];t.nil,t.breaker,t.slice;return t.add_stubs(["$include"]),t.defs(n,"$to_s",e=function(){return"main"},e.$$arity=0),t.defs(n,"$include",r=function(e){return t.const_get_relative(a,"Object").$include(e)},r.$$arity=1)},Opal.modules["corelib/dir"]=function(t){var e=(t.top,[]),r=t.nil,n=(t.breaker,t.slice,t.klass),a=t.truthy;return t.add_stubs(["$[]"]),function(e,i,o){function s(){}var c=s=n(e,null,"Dir",s),l=(c.$$proto,[c].concat(o));return function(e,n){var i,o,s,c=(e.$$proto,[e].concat(n));return t.defn(e,"$chdir",i=function(e){var n=i.$$p,a=n||r,o=r;return n&&(i.$$p=null),function(){try{return o=t.current_dir,t.current_dir=e,t.yieldX(a,[])}finally{t.current_dir=o}}()},i.$$arity=1),t.defn(e,"$pwd",o=function(){return t.current_dir||"."},o.$$arity=0),t.alias(e,"getwd","pwd"),t.defn(e,"$home",s=function(){var e;return a(e=t.const_get_relative(c,"ENV")["$[]"]("HOME"))?e:"."},s.$$arity=0),r&&"home"}(t.get_singleton_class(c),l)}(e[0],0,e)},Opal.modules["corelib/file"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}var n=(t.top,[]),a=t.nil,i=(t.breaker,t.slice,t.klass),o=t.truthy,s=t.range,c=t.send;return t.add_stubs(["$home","$raise","$start_with?","$+","$sub","$pwd","$split","$unshift","$join","$respond_to?","$coerce_to!","$basename","$empty?","$rindex","$[]","$nil?","$==","$-","$length","$gsub","$find","$=~","$map","$each_with_index","$flatten","$reject","$end_with?"]),function(n,l,u){function f(){}var $=f=i(n,l,"File",f),_=($.$$proto,[$].concat(u)),d=a;return t.const_set(_[0],"Separator",t.const_set(_[0],"SEPARATOR","/")),t.const_set(_[0],"ALT_SEPARATOR",a),t.const_set(_[0],"PATH_SEPARATOR",":"),t.const_set(_[0],"FNM_SYSCASE",0),d=/^[a-zA-Z]:(?:\\|\/)/,function(n,i){function l(e){return o(e["$respond_to?"]("to_path"))&&(e=e.$to_path()),e=t.const_get_relative(y,"Opal")["$coerce_to!"](e,t.const_get_relative(y,"String"),"to_str")}function u(){return t.const_get_relative(y,"ALT_SEPARATOR")===a?t.escape_regexp(t.const_get_relative(y,"SEPARATOR")):t.escape_regexp(e(t.const_get_relative(y,"SEPARATOR"),t.const_get_relative(y,"ALT_SEPARATOR")))}var f,$,_,p,h,g,m,v,y=(n.$$proto,[n].concat(i));return t.defn(n,"$expand_path",f=function(r,n){var i=this,s=a,c=a,l=a,f=a,$=a,_=a,p=a,h=a,g=a,m=a,v=a;null==n&&(n=a),s=t.const_get_relative(y,"SEPARATOR"),c=u(),l=[],o("~"===r[0]||n&&"~"===n[0])&&(f=t.const_get_relative(y,"Dir").$home(),o(f)||i.$raise(t.const_get_relative(y,"ArgumentError"),"couldn't find HOME environment -- expanding `~'"),o(f["$start_with?"](s))||i.$raise(t.const_get_relative(y,"ArgumentError"),"non-absolute home"),f=e(f,s),$=new RegExp("^\\~(?:"+s+"|$)"),r=r.$sub($,f),o(n)&&(n=n.$sub($,f))),o(n)||(n=t.const_get_relative(y,"Dir").$pwd()),_=r.substr(0,s.length)===s||d.test(r),p=n.substr(0,s.length)===s||d.test(n),o(_)?(h=r.$split(new RegExp("["+c+"]")),g=d.test(r)?"":r.$sub(new RegExp("^(["+c+"]+).*$"),"\\1"),m=!0):(h=e(n.$split(new RegExp("["+c+"]")),r.$split(new RegExp("["+c+"]"))),g=d.test(n)?"":n.$sub(new RegExp("^(["+c+"]+).*$"),"\\1"),m=p);for(var b,w=0,x=h.length;w<x;w++)(b=h[w])===a||""===b&&(0===l.length||m)||"."===b&&(0===l.length||m)||(".."===b?l.pop():l.push(b));return m||"."===h[0]||l.$unshift("."),v=l.$join(s),o(m)&&(v=e(g,v)),v},f.$$arity=-2),t.alias(n,"realpath","expand_path"),t.defn(n,"$dirname",$=function(t){var e=a;e=u(),t=l(t);var r=t.match(new RegExp("^["+e+"]"));return t=t.replace(new RegExp("["+e+"]+$"),""),t=t.replace(new RegExp("[^"+e+"]+$"),""),t=t.replace(new RegExp("["+e+"]+$"),""),""===t?r?"/":".":t},$.$$arity=1),t.defn(n,"$basename",_=function(e,r){var n=a;return null==r&&(r=a),n=u(),e=l(e),0==e.length?e:(r=r!==a?t.const_get_relative(y,"Opal")["$coerce_to!"](r,t.const_get_relative(y,"String"),"to_str"):null,e=e.replace(new RegExp("(.)["+n+"]*$"),"$1"),e=e.replace(new RegExp("^(?:.*["+n+"])?([^"+n+"]+)$"),"$1"),".*"===r?e=e.replace(/\.[^\.]+$/,""):null!==r&&(r=t.escape_regexp(r),e=e.replace(new RegExp(r+"$"),"")),e)},_.$$arity=-2),t.defn(n,"$extname",p=function(n){var i,c=this,u=a,f=a;return n=l(n),u=c.$basename(n),o(u["$empty?"]())?"":(f=u["$[]"](s(1,-1,!1)).$rindex("."),o(o(i=f["$nil?"]())?i:e(f,1)["$=="](r(u.$length(),1)))?"":u["$[]"](t.Range.$new(e(f,1),-1,!1)))},p.$$arity=1),t.defn(n,"$exist?",h=function(e){return null!=t.modules[e]},h.$$arity=1),t.alias(n,"exists?","exist?"),t.defn(n,"$directory?",g=function(e){var r,n=this,i=a;i=[];for(var o in t.modules)i.push(o);return e=e.$gsub(new RegExp("(^."+t.const_get_relative(y,"SEPARATOR")+"+|"+t.const_get_relative(y,"SEPARATOR")+"+$)")),c(i,"find",[],(r=function(t){r.$$s;return null==t&&(t=a),t["$=~"](new RegExp("^"+e))},r.$$s=n,r.$$arity=1,r))},g.$$arity=1),t.defn(n,"$join",m=function(r){
var n,i,s,l,u=this,f=a,$=arguments.length,_=$-0;_<0&&(_=0),l=new Array(_);for(var d=0;d<$;d++)l[d-0]=arguments[d];return l.$length()["$=="](0)?"":(f="",l=c(l.$flatten().$each_with_index(),"map",[],(n=function(r,i){n.$$s;return null==r&&(r=a),null==i&&(i=a),o(i["$=="](0)?r["$empty?"]():i["$=="](0))?t.const_get_relative(y,"SEPARATOR"):o(l.$length()["$=="](e(i,1))?r["$empty?"]():l.$length()["$=="](e(i,1)))?t.const_get_relative(y,"SEPARATOR"):r},n.$$s=u,n.$$arity=2,n)),l=c(l,"reject",[],(i=function(t){i.$$s;return null==t&&(t=a),t["$empty?"]()},i.$$s=u,i.$$arity=1,i)),c(l,"each_with_index",[],(s=function(r,n){var i,c=(s.$$s,a);return null==r&&(r=a),null==n&&(n=a),c=l["$[]"](e(n,1)),o(c["$nil?"]())?f=""+f+r:(o(o(i=r["$end_with?"](t.const_get_relative(y,"SEPARATOR")))?c["$start_with?"](t.const_get_relative(y,"SEPARATOR")):i)&&(r=r.$sub(new RegExp(t.const_get_relative(y,"SEPARATOR")+"+$"),"")),f=o(o(i=r["$end_with?"](t.const_get_relative(y,"SEPARATOR")))?i:c["$start_with?"](t.const_get_relative(y,"SEPARATOR")))?""+f+r:""+f+r+t.const_get_relative(y,"SEPARATOR"))},s.$$s=u,s.$$arity=2,s)),f)},m.$$arity=-1),t.defn(n,"$split",v=function(e){return e.$split(t.const_get_relative(y,"SEPARATOR"))},v.$$arity=1),a&&"split"}(t.get_singleton_class($),_)}(n[0],t.const_get_relative(n,"IO"),n)},Opal.modules["corelib/process"]=function(t){var e=(t.top,[]),r=t.nil,n=(t.breaker,t.slice,t.klass),a=t.truthy;return t.add_stubs(["$const_set","$size","$<<","$__register_clock__","$to_f","$now","$new","$[]","$raise"]),function(e,i,o){function s(){}var c,l,u,f,$=s=n(e,null,"Process",s),_=($.$$proto,[$].concat(o)),d=r;if($.__clocks__=[],t.defs($,"$__register_clock__",c=function(t,e){var n=this;return null==n.__clocks__&&(n.__clocks__=r),n.$const_set(t,n.__clocks__.$size()),n.__clocks__["$<<"](e)},c.$$arity=2),$.$__register_clock__("CLOCK_REALTIME",function(){return Date.now()}),d=!1,t.global.performance)d=function(){return performance.now()};else if(t.global.process&&process.hrtime){var p=process.hrtime();d=function(){var t=process.hrtime(p),e=t[1]/1e3|0;return 1e3*t[0]+e/1e3}}a(d)&&$.$__register_clock__("CLOCK_MONOTONIC",d),t.defs($,"$pid",l=function(){return 0},l.$$arity=0),t.defs($,"$times",u=function(){var e=r;return e=t.const_get_relative(_,"Time").$now().$to_f(),t.const_get_qualified(t.const_get_relative(_,"Benchmark"),"Tms").$new(e,e,e,e,e)},u.$$arity=0),t.defs($,"$clock_gettime",f=function(e,n){var i=this,o=r;null==i.__clocks__&&(i.__clocks__=r),null==n&&(n="float_second"),a(o=i.__clocks__["$[]"](e))||i.$raise(t.const_get_qualified(t.const_get_relative(_,"Errno"),"EINVAL"),"clock_gettime("+e+") "+i.__clocks__["$[]"](e));var s=o();switch(n){case"float_second":return s/1e3;case"float_millisecond":return s/1;case"float_microsecond":return 1e3*s;case"second":return s/1e3|0;case"millisecond":return s/1|0;case"microsecond":return 1e3*s|0;case"nanosecond":return 1e6*s|0;default:i.$raise(t.const_get_relative(_,"ArgumentError"),"unexpected unit: "+n)}},f.$$arity=-2)}(e[0],0,e),function(e,a,i){function o(){}var s,c=o=n(e,null,"Signal",o);c.$$proto,[c].concat(i);t.defs(c,"$trap",s=function(t){return r},s.$$arity=-1)}(e[0],0,e),function(e,a,i){function o(){}var s,c=o=n(e,null,"GC",o);c.$$proto,[c].concat(i);return t.defs(c,"$start",s=function(){return r},s.$$arity=0)}(e[0],0,e)},Opal.modules["corelib/random/seedrandom"]=function(t){var e=(t.top,[]),r=(t.nil,t.breaker,t.slice,t.klass);return function(t,e,n){function a(){}var i=a=r(t,null,"Random",a);i.$$proto,[i].concat(n);!function(t,e){function r(r,l,u){var g=[];l=1==l?{entropy:!0}:l||{};var m=o(i(l.entropy?[r,c(t)]:null==r?s():r,3),g),v=new n(g),y=function(){for(var t=v.g($),e=d,r=0;t<p;)t=(t+r)*f,e*=f,r=v.g(1);for(;t>=h;)t/=2,e/=2,r>>>=1;return(t+r)/e};return y.int32=function(){return 0|v.g(4)},y.quick=function(){return v.g(4)/4294967296},y.double=y,o(c(v.S),t),(l.pass||u||function(t,r,n,i){return i&&(i.S&&a(i,v),t.state=function(){return a(v,{})}),n?(e[_]=t,r):t})(y,m,"global"in l?l.global:this==e,l.state)}function n(t){var e,r=t.length,n=this,a=0,i=n.i=n.j=0,o=n.S=[];for(r||(t=[r++]);a<f;)o[a]=a++;for(a=0;a<f;a++)o[a]=o[i=g&i+t[a%r]+(e=o[a])],o[i]=e;(n.g=function(t){for(var e,r=0,a=n.i,i=n.j,o=n.S;t--;)e=o[a=g&a+1],r=r*f+o[g&(o[a]=o[i=g&i+e])+(o[i]=e)];return n.i=a,n.j=i,r})(f)}function a(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function i(t,e){var r,n=[],a=typeof t;if(e&&"object"==a)for(r in t)if(t.hasOwnProperty(r))try{n.push(i(t[r],e-1))}catch(t){}return n.length?n:"string"==a?t:t+"\0"}function o(t,e){for(var r,n=t+"",a=0;a<n.length;)e[g&a]=g&(r^=19*e[g&a])+n.charCodeAt(a++);return c(e)}function s(){try{if(l)return c(l.randomBytes(f));var e=new Uint8Array(f);return(u.crypto||u.msCrypto).getRandomValues(e),c(e)}catch(e){var r=u.navigator,n=r&&r.plugins;return[+new Date,u,n,u.screen,c(t)]}}function c(t){return String.fromCharCode.apply(0,t)}var l,u=this,f=256,$=6,_="random",d=e.pow(f,$),p=e.pow(2,52),h=2*p,g=f-1;if(e["seed"+_]=r,o(e.random(),t),"object"==typeof module&&module.exports){module.exports=r;try{l=require("crypto")}catch(t){}}else"function"==typeof define&&define.amd&&define("seekrandom",function(){return r})}([],Math)}(e[0],0,e)},Opal.modules["corelib/random"]=function(t){var e=t.top,r=[],n=t.nil,a=(t.breaker,t.slice,t.klass),i=t.truthy,o=t.send;return t.add_stubs(["$require","$attr_reader","$coerce_to!","$reseed","$new_seed","$rand","$seed","$new","$===","$==","$state","$encode","$join","$map","$times","$chr","$raise"]),e.$require("corelib/random/seedrandom.js"),function(e,r,s){function c(){}var l,u,f,$,_,d,p,h,g=c=a(e,null,"Random",c),m=(g.$$proto,[g].concat(s));g.$attr_reader("seed","state"),t.defn(g,"$initialize",l=function(e){var r=this;return null==e&&(e=t.const_get_relative(m,"Random").$new_seed()),e=t.const_get_relative(m,"Opal")["$coerce_to!"](e,t.const_get_relative(m,"Integer"),"to_int"),r.state=e,r.$reseed(e)},l.$$arity=-1),t.defn(g,"$reseed",u=function(t){var e=this;return e.seed=t,e.$rng=new Math.seedrandom(t)},u.$$arity=1);var v=new Math.seedrandom("opal",{entropy:!0});return t.defs(g,"$new_seed",f=function(){return Math.abs(v.int32())},f.$$arity=0),t.defs(g,"$rand",$=function(e){return t.const_get_relative(m,"DEFAULT").$rand(e)},$.$$arity=-1),t.defs(g,"$srand",_=function(e){var r=n;return null==e&&(e=t.const_get_relative(m,"Random").$new_seed()),e=t.const_get_relative(m,"Opal")["$coerce_to!"](e,t.const_get_relative(m,"Integer"),"to_int"),r=t.const_get_relative(m,"DEFAULT").$seed(),t.const_get_relative(m,"DEFAULT").$reseed(e),r},_.$$arity=-1),t.const_set(m[0],"DEFAULT",g.$new(g.$new_seed())),t.defn(g,"$==",d=function(e){var r=this;return!!i(t.const_get_relative(m,"Random")["$==="](e))&&(r.$seed()["$=="](e.$seed())?r.$state()["$=="](e.$state()):r.$seed()["$=="](e.$seed()))},d.$$arity=1),t.defn(g,"$bytes",p=function(e){var r,n=this;return e=t.const_get_relative(m,"Opal")["$coerce_to!"](e,t.const_get_relative(m,"Integer"),"to_int"),o(e.$times(),"map",[],(r=function(){return(r.$$s||this).$rand(255).$chr()},r.$$s=n,r.$$arity=0,r)).$join().$encode(t.const_get_qualified(t.const_get_relative(m,"Encoding"),"ASCII_8BIT"))},p.$$arity=1),t.defn(g,"$rand",h=function(e){function r(){return i.state++,i.$rng.quick()}function a(){return Math.floor(r()*e)}var i=this;return null==e?r():e.$$is_range?function(){var t=e.begin,r=e.end;if(t===n||r===n)return n;var a=r-t;return a<0?n:0===a?t:(r%1!=0||t%1!=0||e.excl||a++,i.$rand(a)+t)}():e.$$is_number?(e<=0&&i.$raise(t.const_get_relative(m,"ArgumentError"),"invalid argument - "+e),e%1==0?a():r()*e):(e=t.const_get_relative(m,"Opal")["$coerce_to!"](e,t.const_get_relative(m,"Integer"),"to_int"),e<=0&&i.$raise(t.const_get_relative(m,"ArgumentError"),"invalid argument - "+e),a())},h.$$arity=-1),n&&"rand"}(r[0],0,r)},Opal.modules["corelib/unsupported"]=function(t){function e(e){switch(t.config.unsupported_features_severity){case"error":t.const_get_relative(o,"Kernel").$raise(t.const_get_relative(o,"NotImplementedError"),e);break;case"warning":r(e)}}function r(t){u[t]||(u[t]=!0,i.$warn(t))}var n,a,i=t.top,o=[],s=t.nil,c=(t.breaker,t.slice,t.klass),l=t.module;t.add_stubs(["$raise","$warn","$%"]);var u={};return function(e,r,n){function a(){}var i,o,s,l,u,f,$,_,d,p,h,g,m,v,y,b,w,x,A=a=c(e,null,"String",a),k=(A.$$proto,[A].concat(n)),E="String#%s not supported. Mutable String methods are not supported in Opal.";t.defn(A,"$<<",i=function(e){return this.$raise(t.const_get_relative(k,"NotImplementedError"),E["$%"]("<<"))},i.$$arity=-1),t.defn(A,"$capitalize!",o=function(e){return this.$raise(t.const_get_relative(k,"NotImplementedError"),E["$%"]("capitalize!"))},o.$$arity=-1),t.defn(A,"$chomp!",s=function(e){return this.$raise(t.const_get_relative(k,"NotImplementedError"),E["$%"]("chomp!"))},s.$$arity=-1),t.defn(A,"$chop!",l=function(e){return this.$raise(t.const_get_relative(k,"NotImplementedError"),E["$%"]("chop!"))},l.$$arity=-1),t.defn(A,"$downcase!",u=function(e){return this.$raise(t.const_get_relative(k,"NotImplementedError"),E["$%"]("downcase!"))},u.$$arity=-1),t.defn(A,"$gsub!",f=function(e){return this.$raise(t.const_get_relative(k,"NotImplementedError"),E["$%"]("gsub!"))},f.$$arity=-1),t.defn(A,"$lstrip!",$=function(e){return this.$raise(t.const_get_relative(k,"NotImplementedError"),E["$%"]("lstrip!"))},$.$$arity=-1),t.defn(A,"$next!",_=function(e){return this.$raise(t.const_get_relative(k,"NotImplementedError"),E["$%"]("next!"))},_.$$arity=-1),t.defn(A,"$reverse!",d=function(e){return this.$raise(t.const_get_relative(k,"NotImplementedError"),E["$%"]("reverse!"))},d.$$arity=-1),t.defn(A,"$slice!",p=function(e){return this.$raise(t.const_get_relative(k,"NotImplementedError"),E["$%"]("slice!"))},p.$$arity=-1),t.defn(A,"$squeeze!",h=function(e){return this.$raise(t.const_get_relative(k,"NotImplementedError"),E["$%"]("squeeze!"))},h.$$arity=-1),t.defn(A,"$strip!",g=function(e){return this.$raise(t.const_get_relative(k,"NotImplementedError"),E["$%"]("strip!"))},g.$$arity=-1),t.defn(A,"$sub!",m=function(e){return this.$raise(t.const_get_relative(k,"NotImplementedError"),E["$%"]("sub!"))},m.$$arity=-1),t.defn(A,"$succ!",v=function(e){return this.$raise(t.const_get_relative(k,"NotImplementedError"),E["$%"]("succ!"))},v.$$arity=-1),t.defn(A,"$swapcase!",y=function(e){return this.$raise(t.const_get_relative(k,"NotImplementedError"),E["$%"]("swapcase!"))},y.$$arity=-1),t.defn(A,"$tr!",b=function(e){return this.$raise(t.const_get_relative(k,"NotImplementedError"),E["$%"]("tr!"))},b.$$arity=-1),t.defn(A,"$tr_s!",w=function(e){return this.$raise(t.const_get_relative(k,"NotImplementedError"),E["$%"]("tr_s!"))},w.$$arity=-1),t.defn(A,"$upcase!",x=function(e){return this.$raise(t.const_get_relative(k,"NotImplementedError"),E["$%"]("upcase!"))},x.$$arity=-1)}(o[0],0,o),function(r,n){var a,i,o,s=a=l(r,"Kernel"),c=(s.$$proto,[s].concat(n),"Object freezing is not supported by Opal");t.defn(s,"$freeze",i=function(){var t=this;return e(c),t},i.$$arity=0),t.defn(s,"$frozen?",o=function(){return e(c),!1},o.$$arity=0)}(o[0],o),function(r,n){var a,i,o,s,c=a=l(r,"Kernel"),u=(c.$$proto,[c].concat(n),"Object tainting is not supported by Opal");t.defn(c,"$taint",i=function(){var t=this;return e(u),t},i.$$arity=0),t.defn(c,"$untaint",o=function(){var t=this;return e(u),t},o.$$arity=0),t.defn(c,"$tainted?",s=function(){return e(u),!1},s.$$arity=0)}(o[0],o),function(e,r,n){function a(){}var i,o,l,u,f=a=c(e,null,"Module",a);f.$$proto,[f].concat(n);t.defn(f,"$public",i=function(t){var e,r=this,n=arguments.length,a=n-0;a<0&&(a=0),e=new Array(a);for(var i=0;i<n;i++)e[i-0]=arguments[i];return 0===e.length&&(r.$$module_function=!1),s},i.$$arity=-1),t.alias(f,"private","public"),t.alias(f,"protected","public"),t.alias(f,"nesting","public"),t.defn(f,"$private_class_method",o=function(t){return this},o.$$arity=-1),t.alias(f,"public_class_method","private_class_method"),t.defn(f,"$private_method_defined?",l=function(t){return!1},l.$$arity=1),t.defn(f,"$private_constant",u=function(t){return s},u.$$arity=-1),t.alias(f,"protected_method_defined?","private_method_defined?"),t.alias(f,"public_instance_methods","instance_methods"),t.alias(f,"public_method_defined?","method_defined?")}(o[0],0,o),function(e,r){var n,a,i=n=l(e,"Kernel");i.$$proto,[i].concat(r);t.defn(i,"$private_methods",a=function(t){return[]},a.$$arity=-1),t.alias(i,"private_instance_methods","private_methods")}(o[0],o),function(e,r){var n,a,i=n=l(e,"Kernel"),o=(i.$$proto,[i].concat(r));t.defn(i,"$eval",a=function(e){return this.$raise(t.const_get_relative(o,"NotImplementedError"),"To use Kernel#eval, you must first require 'opal-parser'. See https://github.com/opal/opal/blob/"+t.const_get_relative(o,"RUBY_ENGINE_VERSION")+"/docs/opal_parser.md for details.")},a.$$arity=-1)}(o[0],o),t.defs(i,"$public",n=function(t){return s},n.$$arity=-1),t.defs(i,"$private",a=function(t){return s},a.$$arity=-1)},Opal.modules.opal=function(t){var e=t.top;t.nil,t.breaker,t.slice;return t.add_stubs(["$require"]),e.$require("opal/base"),e.$require("opal/mini"),e.$require("corelib/string/inheritance"),e.$require("corelib/string/encoding"),e.$require("corelib/math"),e.$require("corelib/complex"),e.$require("corelib/rational"),e.$require("corelib/time"),e.$require("corelib/struct"),e.$require("corelib/io"),e.$require("corelib/main"),e.$require("corelib/dir"),e.$require("corelib/file"),e.$require("corelib/process"),e.$require("corelib/random"),e.$require("corelib/unsupported")},Opal.modules["opal-platform"]=function(t){var e=(t.top,[]),r=t.nil,n=(t.breaker,t.slice,t.truthy),a=r,i=r,o=r;return"undefined"!=typeof document,a="undefined"!=typeof process&&process.versions&&process.versions.node,i="undefined"!=typeof Java&&Java.type,o="undefined"!=typeof navigator&&/\bHeadlessChrome\//.test(navigator.userAgent),function(){return n(i)?t.const_set(e[0],"OPAL_PLATFORM","nashorn"):n(a)?t.const_set(e[0],"OPAL_PLATFORM","nodejs"):n(o)?t.const_set(e[0],"OPAL_PLATFORM","headless-chrome"):t.const_set(e[0],"OPAL_PLATFORM",r)}()},Opal.modules["nodejs/kernel"]=function(t){var e,r,n=(t.top,[]),a=t.nil,i=(t.breaker,t.slice,t.module);return t.add_stubs(["$to_str","$new","$to_s"]),t.exit=process.exit,function(e,r){var n,a,o,s=n=i(e,"Kernel"),c=(s.$$proto,[s].concat(r));t.const_set(c[0],"NODE_REQUIRE",require),t.defn(s,"$caller",a=function(t){var e,r=arguments.length,n=r-0;n<0&&(n=0),e=new Array(n);for(var a=0;a<r;a++)e[a-0]=arguments[a];var i;try{throw Error("my error")}catch(t){i=t.stack}return i.$split("\n").slice(3)},a.$$arity=-1),t.defn(s,"$node_require",o=function(e){return t.const_get_relative(c,"NODE_REQUIRE")(e.$to_str())},o.$$arity=1)}(n[0],n),t.const_set(n[0],"ARGV",process.argv.slice(2)),t.const_set(n[0],"ENV",t.const_get_relative(n,"Object").$new()),t.defs(t.const_get_relative(n,"ENV"),"$[]=",e=function(t,e){return process.env[t.$to_s()]=e.$to_s()},e.$$arity=2),t.defs(t.const_get_relative(n,"ENV"),"$[]",r=function(t){return process.env[t]||a},r.$$arity=1)},Opal.modules["nodejs/file"]=function(t){function e(e){switch(t.config.unsupported_features_severity){case"error":t.const_get_relative(i,"Kernel").$raise(t.const_get_relative(i,"NotImplementedError"),e);break;case"warning":r(e)}}function r(t){u[t]||(u[t]=!0,a.$warn(t))}function n(e){try{return e()}catch(e){if(f.indexOf(e.code)>=0){var r=t.const_get_relative(i,"Errno").$const_get(e.code);throw r.$new(e.message)}throw e}}var a=t.top,i=[],o=t.nil,s=(t.breaker,t.slice,t.klass),c=t.truthy;t.add_stubs(["$raise","$warn","$const_get","$new","$const_defined?","$const_set","$include","$node_require","$size","$respond_to?","$path","$join","$call","$exist?","$realpath","$!=","$close","$match","$gsub","$attr_reader"]);for(var l,u={},f=["EACCES","EISDIR","EMFILE","ENOENT","EPERM"],$=0,_=f.length;$<_;$++)l=f[$],t.const_get_relative(i,"Errno")["$const_defined?"](l)||t.const_get_relative(i,"Errno").$const_set(l,t.const_get_relative(i,"Class").$new(t.const_get_relative(i,"SystemCallError")));return function(r,a,i){function l(){}var u,f,$,_,d,p,h,g,m,v,y,b,w,x,A,k,E,S=l=s(r,a,"File",l),N=S.$$proto,C=[S].concat(i);null==S.__fs__&&(S.__fs__=o),null==S.__path__&&(S.__path__=o),N.fd=N.path=o,S.$include(t.const_get_qualified(t.const_get_qualified("::","IO"),"Writable")),S.$include(t.const_get_qualified(t.const_get_qualified("::","IO"),"Readable")),S.__fs__=S.$node_require("fs"),S.__path__=S.$node_require("path");var I=S.__fs__,O=S.__path__;c(O.sep!==t.const_get_relative(C,"Separator"))&&t.const_set(C[0],"ALT_SEPARATOR",O.sep),t.defs(S,"$read",u=function(t){return n(function(){return I.readFileSync(t).toString()})},u.$$arity=1),t.defs(S,"$write",f=function(t,e){return n(function(){return I.writeFileSync(t,e)}),e.$size()},f.$$arity=2),t.defs(S,"$exist?",$=function(t){return c(t["$respond_to?"]("path"))&&(t=t.$path()),n(function(){return I.existsSync(t)})},$.$$arity=1),t.defs(S,"$realpath",_=function(t,e,r){var a=this,i=_.$$p,s=i||o;return null==e&&(e=o),null==r&&(r=o),i&&(_.$$p=null),c(e)&&(t=a.$join(e,t)),s!==o?void 0:n(function(){return I.realpathSync(t,r)})},_.$$arity=-2),t.defs(S,"$join",d=function(t){var e,r=arguments.length,n=r-0;n<0&&(n=0),e=new Array(n);for(var a=0;a<r;a++)e[a-0]=arguments[a];return O.join.apply(O,e)},d.$$arity=-1),t.defs(S,"$directory?",p=function(t){var e=this,r=o,a=o;return!!c(e["$exist?"](t))&&(r=n(function(){return!!I.lstatSync(t).isDirectory()}),c(r)||(a=e.$realpath(t),c(a["$!="](t))&&(r=n(function(){return!!I.lstatSync(a).isDirectory()}))),r)},p.$$arity=1),t.defs(S,"$file?",h=function(t){var e=this,r=o,a=o;return!!c(e["$exist?"](t))&&(r=n(function(){return!!I.lstatSync(t).isFile()}),c(r)||(a=e.$realpath(t),c(a["$!="](t))&&(r=n(function(){return!!I.lstatSync(a).isFile()}))),r)},h.$$arity=1),t.defs(S,"$readable?",g=function(t){return!!c(this["$exist?"](t))&&"\n      try {\n        __fs__.accessSync(path, __fs__.R_OK);\n        return true;\n      } catch (error) {\n        return false;\n      }\n    "},g.$$arity=1),t.defs(S,"$size",m=function(t){return n(function(){return I.lstatSync(t).size})},m.$$arity=1),t.defs(S,"$open",v=function(e,r){var n=this,a=v.$$p,i=a||o,s=o;return null==r&&(r="r"),a&&(v.$$p=null),s=n.$new(e,r),i!==o?function(){try{return t.yield1(i,s)}finally{s.$close()}}():s},v.$$arity=-2),t.defs(S,"$stat",y=function(e){return c(e["$respond_to?"]("path"))&&(e=e.$path()),t.const_get_qualified(t.const_get_relative(C,"File"),"Stat").$new(e)},y.$$arity=1),t.defs(S,"$mtime",b=function(t){return n(function(){return I.statSync(t).mtime})},b.$$arity=1),t.defn(S,"$initialize",w=function(t,r){var a=this,i=o,s=o;return null==r&&(r="r"),i=/b/,s=/:(.*)/,c(r.$match(i))&&e("Binary flag (b) is unsupported by Node.js openSync method, removing flag."),r=r.$gsub(i,""),c(r.$match(s))&&e("Encoding flag (:encoding) is unsupported by Node.js openSync method, removing flag."),r=r.$gsub(s,""),a.path=t,a.flags=r,a.fd=n(function(){return I.openSync(t,r)})},w.$$arity=-2),S.$attr_reader("path"),t.defn(S,"$write",x=function(t){var e=this;n(function(){return I.writeSync(e.fd,t)})},x.$$arity=1),t.defn(S,"$flush",A=function(){var t=this;n(function(){return I.fsyncSync(t.fd)})},A.$$arity=0),t.defn(S,"$close",k=function(){var t=this;n(function(){return I.closeSync(t.fd)})},k.$$arity=0),t.defn(S,"$mtime",E=function(){var t=this;return n(function(){return I.statSync(t.path).mtime})},E.$$arity=0)}(i[0],t.const_get_relative(i,"IO"),i),function(e,r,a){function i(){}var c,l,u,f=i=s(e,null,"Stat",i),$=f.$$proto;[f].concat(a);null==f.__fs__&&(f.__fs__=o),$.path=o,f.__fs__=f.$node_require("fs");var _=f.__fs__;return t.defn(f,"$initialize",c=function(t){return this.path=t},c.$$arity=1),t.defn(f,"$file?",l=function(){var t=this;return n(function(){return _.statSync(t.path).isFile()})},l.$$arity=0),t.defn(f,"$mtime",u=function(){var t=this;return n(function(){return _.statSync(t.path).mtime})},u.$$arity=0),o&&"mtime"}(t.const_get_relative(i,"File"),0,i)},Opal.modules["nodejs/dir"]=function(t){var e=(t.top,[]),r=t.nil,n=(t.breaker,t.slice,t.klass);return t.add_stubs(["$node_require"]),function(e,a,i){function o(){}var s=o=n(e,null,"Dir",o),c=(s.$$proto,[s].concat(i));null==s.__glob__&&(s.__glob__=r),null==s.__fs__&&(s.__fs__=r),s.__glob__=s.$node_require("glob"),s.__fs__=s.$node_require("fs");var l=s.__glob__,u=s.__fs__;return function(e,r){var n,a,i,o;e.$$proto,[e].concat(r);return t.defn(e,"$[]",n=function(t){return l.sync(t)},n.$$arity=1),t.defn(e,"$pwd",a=function(){return process.cwd()},a.$$arity=0),t.defn(e,"$mkdir",i=function(t){return u.mkdirSync(t)},i.$$arity=1),t.defn(e,"$entries",o=function(t){for(var e=[],r=u.readdirSync(t),n=0,a=r.length;n<a;n++)e.push(r[n]);return e},o.$$arity=1),t.alias(e,"getwd","pwd")}(t.get_singleton_class(s),c)}(e[0],0,e)},Opal.modules["nodejs/io"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}function r(e){try{return e()}catch(e){if("EACCES"===e.code||"EISDIR"===e.code||"EMFILE"===e.code||"ENOENT"===e.code||"EPERM"===e.code)throw t.IOError.$new(e.message);throw e}}var n,a,i=t.top,o=[],s=t.nil,c=(t.breaker,t.slice,t.klass),l=t.truthy,u=t.gvars,f=t.send,$=s;return t.add_stubs(["$node_require","$attr_reader","$write","$read","$size","$to_enum","$chomp","$each_line","$lambda","$write_proc=","$-","$tty="]),function(e,n,a){function i(){}var o,f,$,_,d,p,h=i=c(e,null,"IO",i),g=h.$$proto,m=[h].concat(a);null==h.__fs__&&(h.__fs__=s),g.eof=g.path=s,h.__fs__=h.$node_require("fs");var v=h.__fs__;h.$attr_reader("eof"),h.$attr_reader("lineno"),t.defn(h,"$initialize",o=function(){var t=this;return t.eof=!1,t.lineno=0},o.$$arity=0),t.defs(h,"$write",f=function(e,r){return t.const_get_relative(m,"File").$write(e,r)},f.$$arity=2),t.defs(h,"$read",$=function(e){return t.const_get_relative(m,"File").$read(e)},$.$$arity=1),t.defn(h,"$read",_=function(){var t=this,e=s;return l(t.eof)?"":(e=r(function(){return v.readFileSync(t.path).toString()}),t.eof=!0,t.lineno=e.$size(),e)},_.$$arity=0),t.defn(h,"$each_line",d=function(e){var r=this,n=d.$$p,a=n||s,i=s;if(null==u["/"]&&(u["/"]=s),null==e&&(e=u["/"]),n&&(d.$$p=null),l(r.eof))return function(){return a!==s?r:[].$to_enum()}();if(a!==s){i=t.const_get_relative(m,"File").$read(r.path),r.eof=!1,r.lineno=0;for(var o=i.$chomp(),c=i.length!=o.length,f=o.split(e),$=0,_=f.length;$<_;$++)r.lineno+=1,$<_-1||c?t.yield1(a,f[$]+e):t.yield1(a,f[$]);return r.eof=!0,r}return r.$read().$each_line()},d.$$arity=-1),t.defs(h,"$binread",p=function(t){return r(function(){return v.readFileSync(t).toString("binary")})},p.$$arity=1)}(o[0],0,o),$=[f(i,"lambda",[],(n=function(t){n.$$s;return null==t&&(t=s),process.stdout.write(t)},n.$$s=i,n.$$arity=1,n))],f(t.const_get_relative(o,"STDOUT"),"write_proc=",t.to_a($)),$[e($.length,1)],$=[f(i,"lambda",[],(a=function(t){a.$$s;return null==t&&(t=s),process.stderr.write(t)},a.$$s=i,a.$$arity=1,a))],f(t.const_get_relative(o,"STDERR"),"write_proc=",t.to_a($)),$[e($.length,1)],$=[!0],f(t.const_get_relative(o,"STDOUT"),"tty=",t.to_a($)),$[e($.length,1)],$=[!0],f(t.const_get_relative(o,"STDERR"),"tty=",t.to_a($)),$[e($.length,1)]},Opal.modules.nodejs=function(t){var e=t.top,r=[],n=(t.nil,t.breaker,t.slice,t.module);return t.add_stubs(["$require"]),function(t,e){var r,a=r=n(t,"NodeJS");a.$$proto,[a].concat(e)}(r[0],r),e.$require("nodejs/kernel"),e.$require("nodejs/file"),e.$require("nodejs/dir"),e.$require("nodejs/io")},Opal.modules["nodejs/fileutils"]=function(t){var e=(t.top,[]),r=t.nil,n=(t.breaker,t.slice,t.module),a=t.truthy,i=t.send;return t.add_stubs(["$extend","$===","$raise","$each","$Array","$directory?","$join","$basename"]),function(e,o){var s,c,l,u,f,$,_=s=n(e,"FileUtils"),d=(_.$$proto,[_].concat(o));_.$extend(_);var p=t.const_get_relative(d,"File").__fs__;t.defn(_,"$chmod",c=function(e,n){var o,s=this;return a(t.const_get_relative(d,"String")["$==="](e))&&s.$raise(t.const_get_relative(d,"NotImplementedError"),"symbolic mode is not supported, use numeric mode"),i(s.$Array(n),"each",[],(o=function(t){o.$$s;return null==t&&(t=r),p.chmodSync(e,t)},o.$$s=s,o.$$arity=1,o))},c.$$arity=2),t.defn(_,"$cp",l=function(e,r){return a(t.const_get_relative(d,"File")["$directory?"](r))&&(r=t.const_get_relative(d,"File").$join(r,t.const_get_relative(d,"File").$basename(e))),p.writeFileSync(r,p.readFileSync(e))},l.$$arity=2),t.defn(_,"$rm",u=function(t){return p.unlinkSync(t)},u.$$arity=1),t.defn(_,"$mkdir_p",f=function(e){return!!a(t.const_get_relative(d,"File")["$directory?"](e))||p.mkdirSync(e)},f.$$arity=1),t.alias(_,"mkpath","mkdir_p"),t.alias(_,"makedirs","mkdir_p"),t.defn(_,"$mv",$=function(e,r){return a(t.const_get_relative(d,"File")["$directory?"](r))&&(r=t.const_get_relative(d,"File").$join(r,t.const_get_relative(d,"File").$basename(e))),p.renameSync(e,r)},$.$$arity=2)}(e[0],e)},Opal.modules["vector2d/calculations"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t*e:t["$*"](e)}function n(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}var a=(t.top,[]),i=t.nil,o=(t.breaker,t.slice,t.klass),s=t.module,c=t.truthy;return t.add_stubs(["$-","$*","$x","$y","$+","$normalized?","$normalize","$acos","$dot_product","$calculate_each","$sqrt","$squared_distance","$coerce","$class","$cross_product","$angle_between","$private","$new","$send"]),function(a,l,u){function f(){}var $=f=o(a,null,"Vector2d",f),_=($.$$proto,[$].concat(u));return function(a,o){var l,u,f,$,_,d,p,h,g,m,v,y=l=s(a,"Calculations"),b=(y.$$proto,[y].concat(o));!function(a,o){var l,u,f,$,_=l=s(a,"ClassMethods"),d=(_.$$proto,[_].concat(o));t.defn(_,"$cross_product",u=function(t,n){return e(r(t.$x(),n.$y()),r(t.$y(),n.$x()))},u.$$arity=2),t.defn(_,"$dot_product",f=function(t,e){return n(r(t.$x(),e.$x()),r(t.$y(),e.$y()))},f.$$arity=2),t.defn(_,"$angle_between",$=function(e,r){var n=this,a=i,o=i;return a=function(){return c(e["$normalized?"]())?e:e.$normalize()}(),o=function(){return c(r["$normalized?"]())?r:r.$normalize()}(),t.const_get_relative(d,"Math").$acos(n.$dot_product(a,o))},$.$$arity=2)}(b[0],b),t.defn(y,"$*",u=function(t){return this.$calculate_each("*",t)},u.$$arity=1),t.defn(y,"$/",f=function(t){return this.$calculate_each("/",t)},f.$$arity=1),t.defn(y,"$+",$=function(t){return this.$calculate_each("+",t)},$.$$arity=1),t.defn(y,"$-",_=function(t){return this.$calculate_each("-",t)},_.$$arity=1),t.defn(y,"$distance",d=function(e){var r=this;return t.const_get_relative(b,"Math").$sqrt(r.$squared_distance(e))},d.$$arity=1),t.defn(y,"$squared_distance",p=function(a){var o,s,c=this,l=i,u=i,f=i;return s=c.$coerce(a),o=t.to_ary(s),l=null==o[0]?i:o[0],null==o[1]?i:o[1],u=e(l.$x(),c.$x()),f=e(l.$y(),c.$y()),n(r(u,u),r(f,f))},p.$$arity=1),t.defn(y,"$dot_product",h=function(e){var r,n,a=this,o=i;return n=a.$coerce(e),r=t.to_ary(n),o=null==r[0]?i:r[0],null==r[1]?i:r[1],a.$class().$dot_product(a,o)},h.$$arity=1),t.defn(y,"$cross_product",g=function(e){var r,n,a=this,o=i;return n=a.$coerce(e),r=t.to_ary(n),o=null==r[0]?i:r[0],null==r[1]?i:r[1],a.$class().$cross_product(a,o)},g.$$arity=1),t.defn(y,"$angle_between",m=function(e){var r,n,a=this,o=i;return n=a.$coerce(e),r=t.to_ary(n),o=null==r[0]?i:r[0],null==r[1]?i:r[1],a.$class().$angle_between(a,o)},m.$$arity=1),y.$private(),t.defn(y,"$calculate_each",v=function(e,r){var n,a,o=this,s=i;return a=o.$coerce(r),n=t.to_ary(a),s=null==n[0]?i:n[0],null==n[1]?i:n[1],o.$class().$new(o.$x().$send(e,s.$x()),o.$y().$send(e,s.$y()))},v.$$arity=2)}(_[0],_)}(a[0],0,a)},Opal.modules["vector2d/coercions"]=function(t){var e=(t.top,[]),r=t.nil,n=(t.breaker,t.slice,t.klass),a=t.module,i=t.hash2;return t.add_stubs(["$===","$parse","$raise","$class","$x","$y","$new","$to_i","$to_f"]),function(e,o,s){function c(){}var l=c=n(e,null,"Vector2d",c),u=(l.$$proto,[l].concat(s));return function(e,n){var o,s,c,l,u,f,$,_,d=o=a(e,"Coercions"),p=(d.$$proto,[d].concat(n));t.defn(d,"$coerce",s=function(e){var n=this,a=r;return function(){return a=e,t.const_get_relative(p,"Vector2d")["$==="](a)?[e,n]:t.const_get_relative(p,"Array")["$==="](a)||t.const_get_relative(p,"Numeric")["$==="](a)||t.const_get_relative(p,"String")["$==="](a)||t.const_get_relative(p,"Hash")["$==="](a)?[t.const_get_relative(p,"Vector2d").$parse(e),n]:n.$raise(t.const_get_relative(p,"TypeError"),n.$class()+" can't be coerced into "+e.$class())}()},s.$$arity=1),t.defn(d,"$inspect",c=function(){var t=this;return"Vector2d("+t.$x()+","+t.$y()+")"},c.$$arity=0),t.defn(d,"$to_a",l=function(){var t=this;return[t.$x(),t.$y()]},l.$$arity=0),t.defn(d,"$to_hash",u=function(){var t=this;return i(["x","y"],{x:t.$x(),y:t.$y()})},u.$$arity=0),t.defn(d,"$to_i_vector",f=function(){var t=this;return t.$class().$new(t.$x().$to_i(),t.$y().$to_i())},f.$$arity=0),t.defn(d,"$to_f_vector",$=function(){var t=this;return t.$class().$new(t.$x().$to_f(),t.$y().$to_f())},$.$$arity=0),t.defn(d,"$to_s",_=function(){var t=this;return t.$x()+"x"+t.$y()},_.$$arity=0)}(u[0],u)}(e[0],0,e)},Opal.modules["vector2d/fitting"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t>e:t["$>"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t/e:t["$/"](e)}function n(t,e){return"number"==typeof t&&"number"==typeof e?t*e:t["$*"](e)}function a(t,e){return"number"==typeof t&&"number"==typeof e?t<e:t["$<"](e)}var i=(t.top,[]),o=t.nil,s=(t.breaker,t.slice,t.klass),c=t.module,l=t.truthy;return t.add_stubs(["$coerce","$>","$x","$y","$fit","$/","$to_f_vector","$*","$==","$<","$alias_method"]),function(i,u,f){function $(){}var _=$=s(i,null,"Vector2d",$),d=(_.$$proto,[_].concat(f));return function(i,s){var u,f,$,_,d=u=c(i,"Fitting");d.$$proto,[d].concat(s);t.defn(d,"$contain",f=function(r){var n,a,i=this,s=o;return a=i.$coerce(r),n=t.to_ary(a),s=null==n[0]?o:n[0],null==n[1]?o:n[1],l(l(n=e(s.$x(),i.$x()))?n:e(s.$y(),i.$y()))?r.$fit(i):r},f.$$arity=1),t.defn(d,"$fit",$=function(i){var s,c,u=this,f=o,$=o;return c=u.$coerce(i),s=t.to_ary(c),f=null==s[0]?o:s[0],null==s[1]?o:s[1],$=r(f.$to_f_vector(),u),n(u,function(){return l(l(s=$.$y()["$=="](0))?s:l(c=e($.$x(),0))?a($.$x(),$.$y()):c)?$.$x():$.$y()}())},$.$$arity=1),d.$alias_method("constrain_both","fit"),t.defn(d,"$fit_either",_=function(i){var s,c,u=this,f=o,$=o;return c=u.$coerce(i),s=t.to_ary(c),f=null==s[0]?o:s[0],null==s[1]?o:s[1],$=r(f.$to_f_vector(),u),l(l(s=e($.$x(),0))?e($.$y(),0):s)?($=function(){return l(a($.$x(),$.$y()))?$.$y():$.$x()}(),n(u,$)):u.$fit(f)},_.$$arity=1),d.$alias_method("constrain_one","fit_either")}(d[0],d)}(i[0],0,i)},Opal.modules["vector2d/properties"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t/e:t["$/"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}function n(t,e){return"number"==typeof t&&"number"==typeof e?t*e:t["$*"](e)}var a=(t.top,[]),i=(t.nil,t.breaker,t.slice,t.klass),o=t.module;return t.add_stubs(["$atan2","$y","$x","$abs","$/","$to_f","$sqrt","$squared_length","$+","$*","$==","$length"]),function(a,s,c){function l(){}var u=l=i(a,null,"Vector2d",l),f=(u.$$proto,[u].concat(c));return function(a,i){var s,c,l,u,f,$,_=s=o(a,"Properties"),d=(_.$$proto,[_].concat(i));t.defn(_,"$angle",c=function(){var e=this;return t.const_get_relative(d,"Math").$atan2(e.$y(),e.$x())},c.$$arity=0),t.defn(_,"$aspect_ratio",l=function(){var t=this;return e(t.$x().$to_f(),t.$y().$to_f()).$abs()},l.$$arity=0),t.defn(_,"$length",u=function(){var e=this;return t.const_get_relative(d,"Math").$sqrt(e.$squared_length())},u.$$arity=0),t.defn(_,"$squared_length",f=function(){var t=this;return r(n(t.$x(),t.$x()),n(t.$y(),t.$y()))},f.$$arity=0),t.defn(_,"$normalized?",$=function(){return this.$length().$to_f()["$=="](1)},$.$$arity=0)}(f[0],f)}(a[0],0,a)},Opal.modules["vector2d/transformations"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t*e:t["$*"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t/e:t["$/"](e)}function n(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}function a(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}var i=(t.top,[]),o=(t.nil,t.breaker,
t.slice,t.klass),s=t.module;return t.add_stubs(["$new","$class","$ceil","$x","$y","$floor","$resize","$-@","$*","$/","$length","$-","$cos","$sin","$+","$round","$min"]),function(i,c,l){function u(){}var f=u=o(i,null,"Vector2d",u),$=(f.$$proto,[f].concat(l));return function(i,o){var c,l,u,f,$,_,d,p,h,g,m=c=s(i,"Transformations"),v=(m.$$proto,[m].concat(o));t.defn(m,"$ceil",l=function(){var t=this;return t.$class().$new(t.$x().$ceil(),t.$y().$ceil())},l.$$arity=0),t.defn(m,"$floor",u=function(){var t=this;return t.$class().$new(t.$x().$floor(),t.$y().$floor())},u.$$arity=0),t.defn(m,"$normalize",f=function(){return this.$resize(1)},f.$$arity=0),t.defn(m,"$perpendicular",$=function(){var e=this;return t.const_get_relative(v,"Vector2d").$new(e.$y()["$-@"](),e.$x())},$.$$arity=0),t.defn(m,"$resize",_=function(t){var n=this;return e(n,r(t,n.$length()))},_.$$arity=1),t.defn(m,"$reverse",d=function(){var t=this;return t.$class().$new(t.$x()["$-@"](),t.$y()["$-@"]())},d.$$arity=0),t.defn(m,"$rotate",p=function(r){var i=this;return t.const_get_relative(v,"Vector2d").$new(n(e(i.$x(),t.const_get_relative(v,"Math").$cos(r)),e(i.$y(),t.const_get_relative(v,"Math").$sin(r))),a(e(i.$x(),t.const_get_relative(v,"Math").$sin(r)),e(i.$y(),t.const_get_relative(v,"Math").$cos(r))))},p.$$arity=1),t.defn(m,"$round",h=function(t){var e=this;return null==t&&(t=0),e.$class().$new(e.$x().$round(t),e.$y().$round(t))},h.$$arity=-1),t.defn(m,"$truncate",g=function(t){var e=this;return e.$resize([t,e.$length()].$min())},g.$$arity=1)}($[0],$)}(i[0],0,i)},Opal.modules["vector2d/version"]=function(t){var e=(t.top,[]),r=(t.nil,t.breaker,t.slice,t.klass);return function(e,n,a){function i(){}var o=i=r(e,null,"Vector2d",i),s=(o.$$proto,[o].concat(a));return t.const_set(s[0],"VERSION","2.1.0")}(e[0],0,e)},Opal.modules.vector2d=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}var r,n=t.top,a=[],i=t.nil,o=(t.breaker,t.slice,t.klass),s=t.truthy,c=t.send;return t.add_stubs(["$require","$extend","$include","$nil?","$parse_single_arg","$new","$private","$===","$parse","$parse_str","$parse_hash","$dup","$has_key?","$[]","$[]=","$-","$=~","$map","$split","$to_proc","$raise","$attr_reader","$x","$y"]),n.$require("vector2d/calculations"),n.$require("vector2d/coercions"),n.$require("vector2d/fitting"),n.$require("vector2d/properties"),n.$require("vector2d/transformations"),n.$require("vector2d/version"),function(r,n,a){function l(){}var u,f,$=l=o(r,null,"Vector2d",l),_=($.$$proto,[$].concat(a));$.$extend(t.const_get_qualified(t.const_get_qualified(t.const_get_relative(_,"Vector2d"),"Calculations"),"ClassMethods")),$.$include(t.const_get_qualified(t.const_get_relative(_,"Vector2d"),"Calculations")),$.$include(t.const_get_qualified(t.const_get_relative(_,"Vector2d"),"Coercions")),$.$include(t.const_get_qualified(t.const_get_relative(_,"Vector2d"),"Fitting")),$.$include(t.const_get_qualified(t.const_get_relative(_,"Vector2d"),"Properties")),$.$include(t.const_get_qualified(t.const_get_relative(_,"Vector2d"),"Transformations")),function(r,n){var a,o,l,u,f=(r.$$proto,[r].concat(n));t.defn(r,"$parse",a=function(t,e){var r=this;return null==e&&(e=i),s(e["$nil?"]())?r.$parse_single_arg(t):r.$new(t,e)},a.$$arity=-2),r.$private(),t.defn(r,"$parse_single_arg",o=function(e){var r=this,n=i;return function(){return n=e,t.const_get_relative(f,"Vector2d")["$==="](n)?e:t.const_get_relative(f,"Array")["$==="](n)?c(r,"parse",t.to_a(e)):t.const_get_relative(f,"String")["$==="](n)?r.$parse_str(e):t.const_get_relative(f,"Hash")["$==="](n)?r.$parse_hash(e.$dup()):r.$new(e,e)}()},o.$$arity=1),t.defn(r,"$parse_hash",l=function(r){var n=this,a=i;return s(r["$has_key?"]("x"))&&(s(r["$[]"]("x"))||(a=["x",r["$[]"]("x")],c(r,"[]=",t.to_a(a)),a[e(a.length,1)])),s(r["$has_key?"]("y"))&&(s(r["$[]"]("y"))||(a=["y",r["$[]"]("y")],c(r,"[]=",t.to_a(a)),a[e(a.length,1)])),n.$new(r["$[]"]("x"),r["$[]"]("y"))},l.$$arity=1),t.defn(r,"$parse_str",u=function(e){var r=this;return s(e["$=~"](/^[\s]*[\d\.]*[\s]*x[\s]*[\d\.]*[\s]*$/))?c(r,"new",t.to_a(c(e.$split("x"),"map",[],"to_f".$to_proc()))):r.$raise(t.const_get_relative(f,"ArgumentError"),"not a valid string input")},u.$$arity=1)}(t.get_singleton_class($),_),$.$attr_reader("x","y"),t.defn($,"$initialize",u=function(t,e){var r,n=this;return r=[t,e],n.x=r[0],n.y=r[1],r},u.$$arity=2),t.defn($,"$==",f=function(t){var e,r=this;return s(e=t.$x()["$==="](r.$x()))?t.$y()["$==="](r.$y()):e},f.$$arity=1)}(a[0],0,a),t.defn(t.Object,"$Vector2d",r=function(e){var r,n=arguments.length,i=n-0;i<0&&(i=0),r=new Array(i);for(var o=0;o<n;o++)r[o-0]=arguments[o];return c(t.const_get_relative(a,"Vector2d"),"parse",t.to_a(r))},r.$$arity=-1),i&&"Vector2d"},Opal.modules.json=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}var r=(t.top,[]),n=t.nil,a=(t.breaker,t.slice,t.module),i=t.klass,o=t.send,s=t.truthy,c=t.hash2;return t.add_stubs(["$raise","$new","$push","$[]=","$-","$[]","$create_id","$json_create","$const_get","$attr_accessor","$create_id=","$===","$parse","$generate","$from_object","$merge","$to_json","$responds_to?","$to_io","$write","$to_s","$to_a","$strftime"]),function(r,l){function u(e){try{return JSON.parse(e)}catch(e){y.$raise(t.const_get_qualified(t.const_get_relative(b,"JSON"),"ParserError"),e.message)}}function f(r,a){var i,s,c,l,u,$;switch(typeof r){case"string":case"number":return r;case"boolean":return!!r;case"null":return n;case"object":if(!r)return n;if(r.$$is_array){for(s=a.array_class.$new(),l=0,u=r.length;l<u;l++)s.$push(f(r[l],a));return s}c=a.object_class.$new();for($ in r)x.call(r,$)&&(w=[$,f(r[$],a)],o(c,"[]=",t.to_a(w)),w[e(w.length,1)]);return a.parse||(i=c["$[]"](t.const_get_relative(b,"JSON").$create_id()))==n?c:t.const_get_qualified("::","Object").$const_get(i).$json_create(c)}}var $,_,d,p,h,g,m,v,y=$=a(r,"JSON"),b=(y.$$proto,[y].concat(l)),w=n;!function(t,e,r){function n(){}var a=n=i(t,e,"JSONError",n);a.$$proto,[a].concat(r)}(b[0],t.const_get_relative(b,"StandardError"),b),function(t,e,r){function n(){}var a=n=i(t,e,"ParserError",n);a.$$proto,[a].concat(r)}(b[0],t.const_get_relative(b,"JSONError"),b);var x=t.hasOwnProperty;!function(t,e){t.$$proto,[t].concat(e);t.$attr_accessor("create_id")}(t.get_singleton_class(y),b),w=["json_class"],o(y,"create_id=",t.to_a(w)),w[e(w.length,1)],t.defs(y,"$[]",_=function(e,r){var n=this;return null==r&&(r=c([],{})),s(t.const_get_relative(b,"String")["$==="](e))?n.$parse(e,r):n.$generate(e,r)},_.$$arity=-2),t.defs(y,"$parse",d=function(t,e){var r=this;return null==e&&(e=c([],{})),r.$from_object(u(t),e.$merge(c(["parse"],{parse:!0})))},d.$$arity=-2),t.defs(y,"$parse!",p=function(t,e){var r=this;return null==e&&(e=c([],{})),r.$parse(t,e)},p.$$arity=-2),t.defs(y,"$load",h=function(t,e){var r=this;return null==e&&(e=c([],{})),r.$from_object(u(t),e)},h.$$arity=-2),t.defs(y,"$from_object",g=function(r,a){var i=n;return null==a&&(a=c([],{})),s(a["$[]"]("object_class"))||(i=["object_class",t.const_get_relative(b,"Hash")],o(a,"[]=",t.to_a(i)),i[e(i.length,1)]),s(a["$[]"]("array_class"))||(i=["array_class",t.const_get_relative(b,"Array")],o(a,"[]=",t.to_a(i)),i[e(i.length,1)]),f(r,a.$$smap)},g.$$arity=-2),t.defs(y,"$generate",m=function(t,e){return null==e&&(e=c([],{})),t.$to_json(e)},m.$$arity=-2),t.defs(y,"$dump",v=function(t,e,r){var a=this,i=n;return null==e&&(e=n),null==r&&(r=n),i=a.$generate(t),s(e)?(s(e["$responds_to?"]("to_io"))&&(e=e.$to_io()),e.$write(i),e):i},v.$$arity=-2)}(r[0],r),function(e,r,n){function a(){}var o,s=a=i(e,null,"Object",a);s.$$proto,[s].concat(n);t.defn(s,"$to_json",o=function(){return this.$to_s().$to_json()},o.$$arity=0)}(r[0],0,r),function(e,r){var n,i,o=n=a(e,"Enumerable");o.$$proto,[o].concat(r);t.defn(o,"$to_json",i=function(){return this.$to_a().$to_json()},i.$$arity=0)}(r[0],r),function(e,r,n){function a(){}var o,s=a=i(e,null,"Array",a);s.$$proto,[s].concat(n);t.defn(s,"$to_json",o=function(){for(var t=this,e=[],r=0,n=t.length;r<n;r++)e.push(t[r].$to_json());return"["+e.join(", ")+"]"},o.$$arity=0)}(r[0],0,r),function(e,r,n){function a(){}var o,s=a=i(e,null,"Boolean",a);s.$$proto,[s].concat(n);t.defn(s,"$to_json",o=function(){return 1==this?"true":"false"},o.$$arity=0)}(r[0],0,r),function(e,r,n){function a(){}var o,s=a=i(e,null,"Hash",a);s.$$proto,[s].concat(n);t.defn(s,"$to_json",o=function(){for(var t,e,r=this,n=[],a=0,i=r.$$keys,o=i.length;a<o;a++)t=i[a],t.$$is_string?e=r.$$smap[t]:(e=t.value,t=t.key),n.push(t.$to_s().$to_json()+":"+e.$to_json());return"{"+n.join(", ")+"}"},o.$$arity=0)}(r[0],0,r),function(e,r,n){function a(){}var o,s=a=i(e,null,"NilClass",a);s.$$proto,[s].concat(n);t.defn(s,"$to_json",o=function(){return"null"},o.$$arity=0)}(r[0],0,r),function(e,r,n){function a(){}var o,s=a=i(e,null,"Numeric",a);s.$$proto,[s].concat(n);t.defn(s,"$to_json",o=function(){return this.toString()},o.$$arity=0)}(r[0],0,r),function(e,r,n){function a(){}var o=a=i(e,null,"String",a);o.$$proto,[o].concat(n);t.alias(o,"to_json","inspect")}(r[0],0,r),function(e,r,n){function a(){}var o,s=a=i(e,null,"Time",a);s.$$proto,[s].concat(n);t.defn(s,"$to_json",o=function(){return this.$strftime("%FT%T%z").$to_json()},o.$$arity=0)}(r[0],0,r),function(e,r,a){function o(){}var s,c,l=o=i(e,null,"Date",o);l.$$proto,[l].concat(a);return t.defn(l,"$to_json",s=function(){return this.$to_s().$to_json()},s.$$arity=0),t.defn(l,"$as_json",c=function(){return this.$to_s()},c.$$arity=0),n&&"as_json"}(r[0],0,r)},Opal.modules["opal-neatjson"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}var r=t.top,n=[],a=t.nil,i=(t.breaker,t.slice,t.truthy),o=t.module,s=t.gvars,c=t.send,l=t.hash2;return t.add_stubs(["$==","$require","$has_key?","$lambda","$[]","$[]=","$-","$to_n"]),i(t.const_get_relative(n,"RUBY_ENGINE")["$=="]("opal"))?(r.$require("json"),function(r,n){var u,f,$=u=o(r,"JSON"),_=($.$$proto,[$].concat(n));t.const_get_relative(_,"OPAL_PLATFORM")["$=="]("nodejs"),s.neatJSON=neatJSON,t.defs($,"$neat_generate",f=function(r,n){var o,u=this,f=a;return null==s.neatJSON&&(s.neatJSON=a),null==n&&(n=l(["explicit_sort"],{explicit_sort:[]})),i(n["$has_key?"]("explicit_sort"))&&(f=["sort",c(u,"lambda",[],(o=function(t,e,r){var s;o.$$s;return null==t&&(t=a),null==e&&(e=a),null==r&&(r=a),i(s=n["$[]"]("explicit_sort")["$[]"](t))?s:"_9999_"+t},o.$$s=u,o.$$arity=3,o))],c(n,"[]=",t.to_a(f)),f[e(f.length,1)]),s.neatJSON(JSON.parse(JSON.stringify(r.$to_n())),n.$to_n())},f.$$arity=-2)}(n[0],n)):a},Opal.modules["opal-ajv"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t>e:t["$>"](e)}function n(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}var a=(t.top,[]),i=t.nil,o=(t.breaker,t.slice,t.module),s=t.klass,c=t.truthy,l=t.send,u=t.range,f=t.gvars,$=t.hash2,_=t.hash;return t.add_stubs(["$==","$add_schema","$_schema","$to_n","$each","$start_with?","$gsub","$[]","$push","$error","$new","$strict=","$-","$get","$keys","$validate","$validate_filenameparts","$select","$include?","$map","$keep_if","$group_by","$>","$length","$empty?","$+","$t","$join"]),function(a,d){var p,h=p=o(a,"Ajv"),g=(h.$$proto,[h].concat(d));!function(a,o,d){function p(){}var h,g,m,v,y,b,w=p=s(a,null,"JsonValidator",p),x=w.$$proto,A=[w].concat(d);x.root=i,t.defn(w,"$initialize",h=function(){var e=this,r=i;return r=i,r=(t.const_get_relative(A,"OPAL_PLATFORM")["$=="]("nodejs"),Ajv),e.root=r({allErrors:!0,jsonPointers:!0,extendRefs:!0}),e.$add_schema(e.$_schema(),"zupfnoter")},h.$$arity=0),t.defn(w,"$add_schema",g=function(t,e){return this.root.addSchema(t.$to_n(),e),i},g.$$arity=2),t.defn(w,"$validate",m=function(t,e){var r,n=this,a=i,o=i,s=i;return a=!1,a=n.root.validate(t,e.$to_n()),o=[],c(a)||(s=n.root.errors,l(s,"each",[],(r=function(t){var e=(r.$$s,i),n=i;return null==f.log&&(f.log=i),null==t&&(t=i),e=t.dataPath,c(e["$start_with?"]("/"))&&(e=e["$[]"](u(1,-1,!1)).$gsub("/",".")),o.$push(e),n=e+": "+t.message+"\n"+JSON.stringify(t.params,null," "),f.log.$error(n)},r.$$s=n,r.$$arity=1,r))),o},m.$$arity=2),t.defn(w,"$validate_conf",v=function(r){var n,a=this,o=i,s=i,c=i;return o=t.const_get_relative(A,"Confstack").$new(),s=[!1],l(o,"strict=",t.to_a(s)),s[e(s.length,1)],o.$push(r.$get()),c=o.$get("extract.0"),l(o.$get("extract").$keys(),"each",[],(n=function(t){n.$$s;return null==t&&(t=i),o.$push($(["extract"],{extract:_(t,c)}))},n.$$s=a,n.$$arity=1,n)),o.$push($(["extract"],{extract:r.$get("extract")})),o.$get(),a.$validate("zupfnoter",o.$get()),a.$validate_filenameparts(o)},v.$$arity=1),t.defn(w,"$validate_filenameparts",y=function(e){var a,o,s,u,$,_=this,d=i,p=i,h=i,g=i;return null==f.log&&(f.log=i),d=l(e.$keys(),"select",[],(a=function(t){a.$$s;return null==t&&(t=i),t["$include?"]("filenamepart")},a.$$s=_,a.$$arity=1,a)),p=l(d,"map",[],(o=function(t){o.$$s;return null==t&&(t=i),e["$[]"](t)},o.$$s=_,o.$$arity=1,o)),h=l(l(p,"group_by",[],(s=function(t){s.$$s;return null==t&&(t=i),t},s.$$s=_,s.$$arity=1,s)),"keep_if",[],(u=function(t,e){u.$$s;return null==t&&(t=i),null==e&&(e=i),r(e.$length(),1)},u.$$s=_,u.$$arity=2,u)).$keys(),c(h["$empty?"]())||(g=n(t.const_get_relative(A,"I18n").$t("duplicate filenameparts"),": "+l(h,"map",[],($=function(t){$.$$s;return null==t&&(t=i),'"'+t+'"'},$.$$s=_,$.$$arity=1,$)).$join(", ")),f.log.$error(g)),i},y.$$arity=1),t.defn(w,"$_schema",b=function(){return $(["$schema","description","type","required","definitions","properties"],{$schema:"http://json-schema.org/draft-04/schema#",description:"Generated from x.json with shasum 0b1781e0803dc084178858e9fbe2b4e0b65c08e7",type:"object",required:["produce","abc_parser","restposition","wrap","defaults","templates","annotations","extract","layout","neatjson"],definitions:$(["apanchor","pos","notes_entry","minc_entry","nconf_entry","align","notebound_pos","notebound_repeat","annotated_bezier","extract_layout"],{apanchor:$(["type","enum"],{type:"string",enum:["manual","box","center"]}),pos:$(["type","minItems","uniqueItems","items"],{type:"array",minItems:2,uniqueItems:!1,items:$(["type"],{type:"number"})}),notes_entry:$(["type","required","properties"],{type:"object",required:["pos","text","style"],properties:$(["pos","text","align","style"],{pos:$(["$ref"],{$ref:"#/definitions/pos"}),text:$(["type"],{type:"string"}),align:$(["$ref"],{$ref:"#/definitions/align"}),style:$(["type"],{type:"string"})})}),minc_entry:$(["type","required","additionalProperties","properties"],{type:"object",required:["minc_f"],additionalProperties:!1,properties:$(["minc_f"],{minc_f:$(["type"],{type:"number"})})}),nconf_entry:$(["type","additionalProperties","patternProperties"],{type:"object",additionalProperties:!1,patternProperties:$(["t_d*"],{"t_d*":$(["type","additionalProperties","patternProperties"],{type:"object",additionalProperties:!1,patternProperties:$(["n_d*"],{"n_d*":$(["type","additionalProperties","properties"],{type:"object",additionalProperties:!1,properties:$(["nshift"],{nshift:$(["type"],{type:"number"})})})})})})}),align:$(["type","enum"],{type:"string",enum:["l","r","auto"]}),notebound_pos:$(["type","additionalProperties","patternProperties"],{type:"object",additionalProperties:!1,patternProperties:$(["v_d*"],{"v_d*":$(["type","additionalProperties","patternProperties"],{type:"object",additionalProperties:!1,patternProperties:$(["t_d*|d*"],{"t_d*|d*":$(["type","additionalProperties","properties"],{type:"object",additionalProperties:!1,properties:$(["pos","align","show","text"],{pos:$(["$ref"],{$ref:"#/definitions/pos"}),align:$(["$ref"],{$ref:"#/definitions/align"}),show:$(["type"],{type:"boolean"}),text:$(["type"],{type:"string"})})})})})})}),notebound_repeat:$(["type","additionalProperties","patternProperties"],{type:"object",additionalProperties:!1,patternProperties:$(["v_d*"],{"v_d*":$(["text","style","pos"],{text:"integer",style:$(["type"],{type:"string"}),pos:$(["$ref"],{$ref:"#/definitions/pos"})})})}),annotated_bezier:$(["type","properties"],{type:"object",properties:$(["cp1","cp2","pos","shape","show","style"],{cp1:$(["$ref"],{$ref:"#/definitions/pos"}),cp2:$(["$ref"],{$ref:"#/definitions/pos"}),pos:$(["$ref"],{$ref:"#/definitions/pos"}),shape:$(["type","minItems","uniqueItems","items"],{type:"array",minItems:0,uniqueItems:!0,items:$(["type"],{type:"string"})}),show:$(["type"],{type:"boolean"}),style:$(["type"],{type:"string"})})}),extract_layout:$(["type","requiredx","additionalProperties","properties"],{type:"object",requiredx:["limit_a3","LINE_THIN","LINE_MEDIUM","LINE_THICK","ELLIPSE_SIZE","REST_SIZE","grid"],additionalProperties:!1,properties:$(["limit_a3","beams","bottomup","jumpline_anchor","jumpline_vcut","LINE_THIN","LINE_MEDIUM","LINE_THICK","PITCH_OFFSET","X_SPACING","X_OFFSET","instrument","DRAWING_AREA_SIZE","ELLIPSE_SIZE","REST_SIZE","grid","color","packer"],{limit_a3:$(["type"],{type:"boolean"}),beams:$(["type"],{type:"boolean"}),bottomup:$(["type"],{type:"boolean"}),jumpline_anchor:$(["$ref"],{$ref:"#/definitions/pos"}),jumpline_vcut:$(["type"],{type:"number"}),LINE_THIN:$(["type"],{type:"number"}),LINE_MEDIUM:$(["type"],{type:"number"}),LINE_THICK:$(["type"],{type:"number"}),PITCH_OFFSET:$(["type"],{type:"integer"}),X_SPACING:$(["type"],{type:"number"}),X_OFFSET:$(["type"],{type:"number"}),instrument:$(["type"],{type:"string"}),DRAWING_AREA_SIZE:$(["type","minItems","items"],{type:"array",minItems:2,items:$(["type"],{type:"number"})}),ELLIPSE_SIZE:$(["type","minItems","items"],{type:"array",minItems:2,items:$(["type"],{type:"number"})}),REST_SIZE:$(["type","minItems","items"],{type:"array",minItems:2,items:$(["type"],{type:"number"})}),grid:$(["type"],{type:"boolean"}),color:$(["type","properties"],{type:"object",properties:$(["color_default","color_variant1","color_variant2"],{color_default:$(["type"],{type:"string"}),color_variant1:$(["type"],{type:"string"}),color_variant2:$(["type"],{type:"string"})})}),packer:$(["type","properties"],{type:"object",properties:$(["pack_method","pack_max_spread_factor","pack_min_increment"],{pack_method:$(["type"],{type:"integer"}),pack_max_spread_factor:$(["type"],{type:"number"}),pack_min_increment:$(["type"],{type:"number"})})})})})}),properties:$(["confstack","produce","template","abc_parser","restposition","wrap","defaults","templates","annotations","extract","layout","neatjson"],{confstack:$(["type","required","properties"],{type:"object",required:["env"],properties:$(["env"],{env:$(["type"],{type:"string"})})}),produce:$(["type","minItems","uniqueItems","items"],{type:"array",minItems:0,uniqueItems:!0,items:$(["type"],{type:"integer"})}),template:$(["type","additionalProperties","properties"],{type:"object",additionalProperties:!1,properties:$(["filebase","title"],{filebase:$(["type"],{type:"string"}),title:$(["type"],{type:"string"})})}),abc_parser:$(["type"],{type:"string"}),restposition:$(["type","additionalProperties","required","properties"],{type:"object",additionalProperties:!1,required:["default","repeatstart","repeatend"],properties:$(["default","repeatstart","repeatend"],{default:$(["type"],{type:"string"}),repeatstart:$(["type"],{type:"string"}),repeatend:$(["type"],{type:"string"})})}),wrap:$(["type"],{type:"integer"}),defaults:$(["type","required","properties"],{type:"object",required:["notebound"],properties:$(["notebound"],{notebound:$(["type","required","properties"],{type:"object",required:["annotation","partname","variantend","tuplet"],properties:$(["annotation","partname","variantend","tuplet"],{annotation:$(["type","required","properties"],{type:"object",required:["pos"],properties:$(["pos","style"],{pos:$(["$ref"],{$ref:"#/definitions/pos"}),style:$(["type"],{type:"string"})})}),partname:$(["type","required","properties"],{type:"object",required:["pos"],properties:$(["pos","style","show"],{pos:$(["$ref"],{$ref:"#/definitions/pos"}),style:$(["type"],{type:"string"}),show:$(["type"],{type:"boolean"})})}),variantend:$(["type","required","properties"],{type:"object",required:["pos"],properties:$(["pos","style"],{pos:$(["$ref"],{$ref:"#/definitions/pos"}),style:$(["type"],{type:"string"})})}),tuplet:$(["$ref","required"],{$ref:"#/definitions/annotated_bezier",required:["cp1","cp2","shape"]})})})})}),templates:$(["type","required","properties"],{type:"object",required:["notes","lyrics","tuplet","annotations"],properties:$(["notes","lyrics","tuplet","annotations"],{notes:$(["$ref"],{$ref:"#/definitions/notes_entry"}),lyrics:$(["type","required","properties"],{type:"object",required:["verses","pos"],properties:$(["verses","pos","style"],{verses:$(["type","minItems","uniqueItems","items"],{type:"array",minItems:1,uniqueItems:!0,items:$(["type"],{type:"integer"})}),pos:$(["$ref"],{$ref:"#/definitions/pos"}),style:$(["type"],{type:"string"})})}),tuplet:$(["type","required","properties"],{type:"object",required:["cp1","cp2","shape"],properties:$(["cp1","cp2","shape"],{cp1:$(["$ref"],{$ref:"#/definitions/pos"}),cp2:$(["$ref"],{$ref:"#/definitions/pos"}),shape:$(["type","minItems","uniqueItems","items"],{type:"array",minItems:1,uniqueItems:!0,items:$(["type"],{type:"string"})})})}),annotations:$(["type","required","properties"],{type:"object",required:["text","pos"],properties:$(["text","pos","style"],{text:$(["type"],{type:"string"}),pos:$(["$ref"],{$ref:"#/definitions/pos"}),style:$(["type"],{type:"string"})})})})}),annotations:$(["type","required","properties"],{type:"object",required:["vl","vt","vr"],properties:$(["vl","vt","vr"],{vl:$(["type","required","properties"],{type:"object",required:["text","pos"],properties:$(["text","pos"],{text:$(["type"],{type:"string"}),pos:$(["$ref"],{$ref:"#/definitions/pos"})})}),vt:$(["type","required","properties"],{type:"object",required:["text","pos"],properties:$(["text","pos"],{text:$(["type"],{type:"string"}),pos:$(["$ref"],{$ref:"#/definitions/pos"})})}),vr:$(["type","required","properties"],{type:"object",required:["text","pos"],properties:$(["text","pos"],{text:$(["type"],{type:"string"}),pos:$(["$ref"],{$ref:"#/definitions/pos"})})})})}),extract:$(["type","patternProperties"],{type:"object",patternProperties:$(["d*","4","5"],{"d*":$(["type","additionalProperties","requiredx","properties"],{type:"object",additionalProperties:!1,requiredx:["title","filenamepart","startpos","voices","synchlines","flowlines","subflowlines","jumplines","repeatsigns","layoutlines","legend","lyrics","layout","nonflowrest","notes","barnumbers","countnotes","stringnames","printer"],properties:$(["title","filenamepart","startpos","voices","synchlines","flowlines","subflowlines","jumplines","repeatsigns","layoutlines","legend","lyrics","layout","nonflowrest","notes","notebound","tuplets","barnumbers","countnotes","stringnames","sortmark","printer","images"],{title:$(["type"],{type:"string"}),filenamepart:$([],{}),startpos:$(["type"],{type:"integer"}),voices:$(["type","minItems","uniqueItems","items"],{type:"array",minItems:1,uniqueItems:!0,items:$(["type"],{type:"integer"})}),synchlines:$(["type","minItems","uniqueItems","items"],{type:"array",minItems:0,uniqueItems:!0,items:$(["type","minItems","uniqueItems","items"],{type:"array",minItems:1,uniqueItems:!0,items:$(["type"],{type:"integer"})})}),flowlines:$(["type","minItems","uniqueItems","items"],{type:"array",minItems:1,uniqueItems:!0,items:$(["type"],{type:"integer"})}),subflowlines:$(["type","minItems","uniqueItems","items"],{type:"array",minItems:1,uniqueItems:!0,items:$(["type"],{type:"integer"})}),jumplines:$(["type","minItems","uniqueItems","items"],{type:"array",minItems:1,uniqueItems:!0,items:$(["type"],{type:"integer"})}),repeatsigns:$(["type","requiredx","properties"],{type:"object",requiredx:["voices","left","right"],properties:$(["voices","left","right"],{voices:$(["type","minItems","uniqueItems","items"],{type:"array",minItems:0,uniqueItems:!0,items:$([],{})}),left:$(["type","required","properties"],{type:"object",required:["pos","text","style"],properties:$(["pos","text","style"],{pos:$(["$ref"],{$ref:"#/definitions/pos"}),text:$(["type"],{type:"string"}),style:$(["type"],{type:"string"})})}),right:$(["type","required","properties"],{type:"object",required:["pos","text","style"],properties:$(["pos","text","style"],{pos:$(["$ref"],{$ref:"#/definitions/pos"}),text:$(["type"],{type:"string"}),style:$(["type"],{type:"string"})})})})}),layoutlines:$(["type","minItems","uniqueItems","items"],{type:"array",minItems:0,uniqueItems:!0,items:$(["type"],{type:"integer"})}),legend:$(["type","required","properties"],{type:"object",required:["spos","pos"],properties:$(["spos","pos","align","style"],{spos:$(["$ref"],{$ref:"#/definitions/pos"}),pos:$(["$ref"],{$ref:"#/definitions/pos"}),align:$(["$ref"],{$ref:"#/definitions/align"}),style:$(["type"],{type:"string"})})}),lyrics:$(["type","patternProperties"],{type:"object",patternProperties:$([".*"],{".*":$(["type","required"],{type:"object",required:["verses","pos"]})})}),layout:$(["$ref"],{$ref:"#/definitions/extract_layout"}),nonflowrest:$(["type"],{type:"boolean"}),notes:$(["patternProperties"],{patternProperties:$([".*"],{".*":$(["$ref"],{$ref:"#/definitions/notes_entry"})})}),notebound:$(["type","additionalProperties","properties"],{type:"object",additionalProperties:!1,properties:$(["annotation","barnumber","c_jumplines","countnote","decoration","flowline","minc","nconf","partname","repeat_begin","repeat_end","tuplet","variantend"],{annotation:$(["$ref"],{$ref:"#/definitions/notebound_pos"}),barnumber:$(["$ref","align"],{$ref:"#/definitions/notebound_pos",align:$(["$ref"],{$ref:"#/definitions/align"})}),c_jumplines:$(["type","additionalProperties","patternProperties"],{type:"object",additionalProperties:!1,patternProperties:$(["v_d*"],{"v_d*":$(["p_repeat","p_begin","p_end","p_follow"],{p_repeat:$(["type"],{type:"number"}),p_begin:$(["type"],{type:"number"}),p_end:$(["type"],{type:"number"}),p_follow:$(["type"],{type:"number"})})})}),countnote:$(["$ref"],{$ref:"#/definitions/notebound_pos"}),decoration:$(["$ref"],{$ref:"#/definitions/notebound_pos"}),flowline:$(["type","patternProperties"],{type:"object",patternProperties:$(["v_d+"],{"v_d+":$(["type","patternProperties"],{type:"object",patternProperties:$(["d*"],{"d*":$(["$ref"],{$ref:"#/definitions/annotated_bezier"})})})})}),minc:$(["type","additionalProperties","patternProperties"],{type:"object",additionalProperties:!1,patternProperties:$(["d*"],{"d*":$(["$ref"],{$ref:"#/definitions/minc_entry"})})}),nconf:$(["type","additionalProperties","patternProperties"],{type:"object",additionalProperties:!1,patternProperties:$(["v_d*"],{"v_d*":$(["$ref"],{$ref:"#/definitions/nconf_entry"})})}),partname:$(["$ref"],{$ref:"#/definitions/notebound_pos"}),repeat_begin:$(["$ref"],{$ref:"#/definitions/notebound_pos"}),repeat_end:$(["$ref"],{$ref:"#/definitions/notebound_repeat"}),tuplet:$(["type","patternProperties"],{type:"object",patternProperties:$(["v_d*"],{"v_d*":$(["type","patternProperties"],{type:"object",patternProperties:$(["d*"],{"d*":$(["$ref"],{$ref:"#/definitions/annotated_bezier"})})})})}),variantend:$(["$ref"],{$ref:"#/definitions/notebound_pos"})})}),tuplets:$(["type","properties"],{type:"object",properties:$(["text"],{text:$(["type"],{type:"string"})})}),barnumbers:$(["type","required","properties"],{type:"object",required:["voices","pos","autopos","style","prefix"],properties:$(["voices","pos","autopos","apanchor","style","prefix"],{voices:$(["type","minItems","uniqueItems","items"],{type:"array",minItems:0,uniqueItems:!0,items:$([],{})}),pos:$(["$ref"],{$ref:"#/definitions/pos"}),autopos:$(["type"],{type:"boolean"}),apanchor:$(["$ref"],{$ref:"#/definitions/apanchor"}),style:$(["type"],{type:"string"}),prefix:$(["type"],{type:"string"})})}),countnotes:$(["type","required","properties"],{type:"object",required:["voices","pos","autopos","style"],properties:$(["voices","pos","autopos","apanchor","style"],{voices:$(["type","minItems","uniqueItems","items"],{type:"array",minItems:0,uniqueItems:!0,items:$([],{})}),pos:$(["$ref"],{$ref:"#/definitions/pos"}),autopos:$(["type"],{type:"boolean"}),apanchor:$(["$ref"],{$ref:"#/definitions/apanchor"}),style:$(["type"],{type:"string"})})}),stringnames:$(["type","required","properties"],{type:"object",required:["text","vpos","style","marks"],properties:$(["text","vpos","style","marks"],{text:$(["type"],{type:"string"}),vpos:$(["type","minItems","uniqueItems","items"],{type:"array",minItems:0,uniqueItems:!0,items:$([],{})}),style:$(["type"],{type:"string"}),marks:$(["type","required","properties"],{type:"object",required:["vpos","hpos"],properties:$(["vpos","hpos"],{vpos:$(["type","minItems","uniqueItems","items"],{type:"array",minItems:1,uniqueItems:!0,items:$(["type"],{type:"integer"})}),hpos:$(["type","minItems","uniqueItems","items"],{type:"array",minItems:1,uniqueItems:!0,items:$(["type"],{type:"integer"})})})})})}),sortmark:$(["type","properties"],{type:"object",properties:$(["show"],{show:$(["type"],{type:"boolean"})})}),printer:$(["type","required","properties"],{type:"object",required:["a3_offset","a4_offset","show_border"],properties:$(["a3_offset","a4_offset","show_border"],{a3_offset:$(["type","minItems","axItems","uniqueItems","items"],{type:"array",minItems:2,axItems:2,uniqueItems:!1,items:$(["type"],{type:"integer"})}),a4_offset:$(["type","minItems","uniqueItems","items"],{type:"array",minItems:2,uniqueItems:!1,items:$(["type"],{type:"integer"})}),show_border:$(["type"],{type:"boolean"})})}),images:$(["type","patternProperties"],{type:"object",patternProperties:$(["d*"],{"d*":$(["type","properties"],{type:"object",properties:$(["imagename","show","pos","height"],{imagename:$(["type"],{type:"string"}),show:$(["type"],{type:"boolean"}),pos:$(["$ref"],{$ref:"#/definitions/pos"}),height:$(["type"],{type:"number"})})})})})})}),4:$(["type","required","properties"],{type:"object",required:["title","voices"],properties:$(["title","filenamepart","voices"],{title:$(["type"],{type:"string"}),filenamepart:$([],{}),voices:$(["type","minItems","uniqueItems","items"],{type:"array",minItems:1,uniqueItems:!0,items:$(["type"],{type:"integer"})})})}),5:$(["type","required","properties"],{type:"object",required:["title","voices"],properties:$(["title","filenamepart","voices"],{title:$(["type"],{type:"string"}),filenamepart:$([],{}),voices:$(["type","minItems","uniqueItems","items"],{type:"array",minItems:1,uniqueItems:!0,items:$(["type"],{type:"integer"})})})})})}),layout:$(["type","required","properties"],{type:"object",required:["grid","limit_a3","SHOW_SLUR","LINE_THIN","LINE_MEDIUM","LINE_THICK","ELLIPSE_SIZE","REST_SIZE","X_SPACING","X_OFFSET","Y_SCALE","DRAWING_AREA_SIZE","BEAT_RESOLUTION","SHORTEST_NOTE","BEAT_PER_DURATION","PITCH_OFFSET","FONT_STYLE_DEF","MM_PER_POINT","DURATION_TO_STYLE","REST_TO_GLYPH"],properties:$(["grid","limit_a3","SHOW_SLUR","LINE_THIN","LINE_MEDIUM","LINE_THICK","ELLIPSE_SIZE","REST_SIZE","X_SPACING","X_OFFSET","Y_SCALE","DRAWING_AREA_SIZE","BEAT_RESOLUTION","SHORTEST_NOTE","BEAT_PER_DURATION","PITCH_OFFSET","FONT_STYLE_DEF","MM_PER_POINT","DURATION_TO_STYLE","REST_TO_GLYPH"],{grid:$(["type"],{type:"boolean"}),limit_a3:$(["type"],{type:"boolean"}),SHOW_SLUR:$(["type"],{type:"boolean"}),LINE_THIN:$(["type"],{type:"number"}),LINE_MEDIUM:$(["type"],{type:"number"}),LINE_THICK:$(["type"],{type:"number"}),ELLIPSE_SIZE:$(["type","minItems","uniqueItems","items"],{type:"array",minItems:1,uniqueItems:!0,items:$(["type"],{type:"number"})}),REST_SIZE:$(["type","minItems","uniqueItems","items"],{type:"array",minItems:1,uniqueItems:!0,items:$(["type"],{type:"number"})}),X_SPACING:$(["type"],{type:"number"}),X_OFFSET:$(["type"],{type:"number"}),Y_SCALE:$(["type"],{type:"integer"}),DRAWING_AREA_SIZE:$(["type","minItems","uniqueItems","items"],{type:"array",minItems:1,uniqueItems:!0,items:$(["type"],{type:"integer"})}),BEAT_RESOLUTION:$(["type"],{type:"integer"}),SHORTEST_NOTE:$(["type"],{type:"integer"}),BEAT_PER_DURATION:$(["type"],{type:"integer"}),PITCH_OFFSET:$(["type"],{type:"integer"}),
FONT_STYLE_DEF:$(["type","required","patternProperties"],{type:"object",required:["bold","italic","large","regular","small_bold","small_italic","small","smaller"],patternProperties:$([".*"],{".*":$(["type","required","properties"],{type:"object",required:["text_color","font_size","font_style"],properties:$(["text_color","font_size","font_style"],{text_color:$(["type","minItems","uniqueItems","items"],{type:"array",minItems:3,uniqueItems:!1,items:$(["type"],{type:"integer"})}),font_size:$(["type"],{type:"integer"}),font_style:$(["type"],{type:"string"})})})})}),MM_PER_POINT:$(["type"],{type:"number"}),DURATION_TO_STYLE:$(["type","required","patternProperties"],{type:"object",required:["err","d64","d48","d32","d24","d16","d12","d8","d6","d4","d3","d2","d1"],patternProperties:$([".*"],{".*":$(["type","minItems","uniqueItems","items"],{type:"array",minItems:3,uniqueItems:!1,items:$(["type"],{type:["number","string","boolean"]})})})}),REST_TO_GLYPH:$(["type","patternProperties"],{type:"object",patternProperties:$([".*"],{".*":$(["type","minItems","uniqueItems","items"],{type:"array",minItems:1,uniqueItems:!0,items:[$(["type","minItems","uniqueItems","items"],{type:"array",minItems:1,uniqueItems:!1,items:$(["type"],{type:"number"})}),$(["type"],{type:"string"}),$(["type"],{type:"boolean"})]})})})})}),neatjson:$(["type","required","properties"],{type:"object",required:["wrap","aligned","after_comma","after_colon_1","after_colon_n","before_colon_n","explicit_sort"],properties:$(["wrap","aligned","after_comma","after_colon_1","after_colon_n","before_colon_n","sorted","explicit_sort"],{wrap:$(["type"],{type:"integer"}),aligned:$(["type"],{type:"boolean"}),after_comma:$(["type"],{type:"integer"}),after_colon_1:$(["type"],{type:"integer"}),after_colon_n:$(["type"],{type:"integer"}),before_colon_n:$(["type"],{type:"integer"}),sorted:$(["type"],{type:"boolean"}),explicit_sort:$(["type"],{type:"object"})})})})})},b.$$arity=0)}(g[0],0,g)}(a[0],a)},Opal.modules.consolelogger=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t>e:t["$>"](e)}function n(t,e){return"number"==typeof t&&"number"==typeof e?t<=e:t["$<="](e)}function a(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}var i=(t.top,[]),o=t.nil,s=(t.breaker,t.slice,t.hash2),c=t.klass,l=t.send,u=t.truthy,f=t.gvars;return t.add_stubs(["$attr_reader","$[]","$now","$clear_errors","$clear_annotations","$send","$push","$add_annotation","$==","$loglevel","$join","$write","$loglevel?","$info","$-","$>","$count","$call","$to_sym","$message","$invert","$<=","$keys","$private","$first","$+","$last","$<<","$strftime","$puts","$write_html"]),t.const_set(i[0],"LOGLEVELS",s(["message","error","warning","info","debug"],{message:0,error:1,warning:2,info:3,debug:4})),t.const_set(i[0],"LOGICONS",s(["message","error","warning","info","debug"],{message:"icon-info-circled",error:"icon-error-alt",warning:"icon-attention",info:"icon-info-circled",debug:"icon-minus-squared"})),function(i,$,_){function d(){}var p,h,g,m,v,y,b,w,x,A,k,E,S,N,C,I,O,P,L,M,T,B,j,F=d=c(i,null,"Logger",d),R=F.$$proto,q=[F].concat(_);R.captured_errors=R.timestamp=R.annotations=R.loglevel=o,F.$attr_reader("annotations"),t.defn(F,"$clear_annotations",p=function(){return this.annotations=[]},p.$$arity=0),t.defn(F,"$initialize",h=function(e){var r=this;return r.console=e,r.loglevel=t.const_get_relative(q,"LOGLEVELS")["$[]"]("info"),r.timestamp=t.const_get_relative(q,"Time").$now(),r.$clear_errors(),r.$clear_annotations()},h.$$arity=1),t.defn(F,"$clear_annotations",g=function(){return this.annotations=[]},g.$$arity=0),t.defn(F,"$log_from_worker",m=function(e){return l(this,"send",[e["$[]"]("type")].concat(t.to_a(e["$[]"]("args"))))},m.$$arity=1),t.defn(F,"$error",v=function(t,e,r,n){var a=this,i=o;return null==e&&(e=o),null==r&&(r=o),null==n&&(n=[]),a.captured_errors.$push(t),a.$add_annotation(t,e,r,"error"),a.$loglevel()["$=="]("debug")&&(i=n.$join("\n")),a.$write("error",""+t+i)},v.$$arity=-2),t.defn(F,"$warning",y=function(t,e,r){var n=this;return null==e&&(e=o),null==r&&(r=o),u(n["$loglevel?"]("warning"))&&n.$add_annotation(t,e,r,"warning"),n.$write("warning",t)},y.$$arity=-2),t.defn(F,"$info",b=function(t,e,r){var n=this;return null==e&&(e=o),null==r&&(r=o),n.$add_annotation(t,e,r,"info"),n.$write("info",t)},b.$$arity=-2),t.defn(F,"$debug",w=function(t,e,r){var n=this;return null==e&&(e=o),null==r&&(r=o),n.$add_annotation(t,e,r,"debug"),n.$write("debug",t)},w.$$arity=-2),t.defn(F,"$message",x=function(t,e,r){var n=this;return null==e&&(e=o),null==r&&(r=o),n.$add_annotation(t,e,r,"message"),n.$write("message",t)},x.$$arity=-2),t.defn(F,"$timestamp",A=function(r,n,a){var i=this;return null==f.log&&(f.log=o),null==n&&(n=o),null==a&&(a=o),f.log.$info("Timestamp "+e(t.const_get_relative(q,"Time").$now(),i.timestamp)+" sec: "+r)},A.$$arity=-2),t.defn(F,"$timestamp_start",k=function(){return this.timestamp=t.const_get_relative(q,"Time").$now()},k.$$arity=0),t.defn(F,"$clear_errors",E=function(){return this.captured_errors=[]},E.$$arity=0),t.defn(F,"$has_errors?",S=function(){return r(this.captured_errors.$count(),0)},S.$$arity=0),t.defn(F,"$get_errors",N=function(){return this.captured_errors},N.$$arity=0),t.defn(F,"$get_status",C=function(){var t=this;return s(["annotations","captured_errors"],{annotations:t.annotations,captured_errors:t.captured_errors})},C.$$arity=0),t.defn(F,"$set_status",I=function(t){var e=this;return e.annotations=t["$[]"]("annotations"),e.captured_errors=t["$[]"]("captured_errors")},I.$$arity=1),t.defn(F,"$benchmark",O=function(r){var n=O.$$p,a=n||o,i=o,s=o;return null==f.log&&(f.log=o),n&&(O.$$p=null),i=t.const_get_relative(q,"Time").$now(),s=a.$call(),f.log.$info("  elapsed "+e(t.const_get_relative(q,"Time").$now(),i)+" sec for "+r),s},O.$$arity=1),t.defn(F,"$loglevel=",P=function(e){var r,n=this;return null==f.log&&(f.log=o),n.loglevel=u(r=t.const_get_relative(q,"LOGLEVELS")["$[]"](e.$to_sym()))?r:t.const_get_relative(q,"LOGLEVELS")["$[]"]("debug"),f.log.$message("logging messages up to "+t.const_get_relative(q,"LOGLEVELS").$invert()["$[]"](n.loglevel))},P.$$arity=1),t.defn(F,"$loglevel",L=function(){var e=this;return t.const_get_relative(q,"LOGLEVELS").$invert()["$[]"](e.loglevel)},L.$$arity=0),t.defn(F,"$loglevel?",M=function(e){var r,a=this;return n(u(r=t.const_get_relative(q,"LOGLEVELS")["$[]"](e))?r:t.const_get_relative(q,"LOGLEVELS")["$[]"]("warning"),a.loglevel)},M.$$arity=1),t.defn(F,"$loglevels",T=function(){return t.const_get_relative(q,"LOGLEVELS").$keys()},T.$$arity=0),F.$private(),t.defn(F,"$add_annotation",B=function(t,e,r,n){var i,c=this,l=o,f=o;return u(e)&&(l=e,f=u(i=r)?i:[l.$first(),a(l.$last(),1)],c.annotations["$<<"](s(["start_pos","end_pos","text","type"],{start_pos:l,end_pos:f,text:t,type:n}))),o},B.$$arity=4),t.defn(F,"$write",j=function(e,r){var n=this;return u(n["$loglevel?"](e))?(t.const_get_relative(q,"Time").$now().$strftime("%H:%M:%S"),n.$puts(r)):o},j.$$arity=2)}(i[0],0,i),function(e,r,a){function i(){}var s,l=i=c(e,r,"NodeLogger",i),f=l.$$proto,$=[l].concat(a);f.loglevel=o,t.defn(l,"$write",s=function(e,r){var a,i=this,s=o;return s=u(a=t.const_get_relative($,"LOGLEVELS")["$[]"](e))?a:t.const_get_relative($,"LOGLEVELS")["$[]"]("warning"),u(n(s,i.loglevel))?(t.const_get_relative($,"Time").$now().$strftime("%H:%M:%S"),i.$puts(r)):o},s.$$arity=2)}(i[0],t.const_get_relative(i,"Logger"),i),function(e,r,a){function i(){}var s,f,$=i=c(e,r,"ConsoleLogger",i),_=$.$$proto,d=[$].concat(a);return _.loglevel=_.console=o,t.defn($,"$initialize",s=function(e){var r=this,n=s.$$p,a=o,i=o,c=o;for(n&&(s.$$p=null),i=0,c=arguments.length,a=new Array(c);i<c;i++)a[i]=arguments[i];return l(r,t.find_super_dispatcher(r,"initialize",s,!1),a,n),r.console=e},s.$$arity=1),t.defn($,"$write",f=function(e,r){var a,i=this,s=o,c=o;return s=u(a=t.const_get_relative(d,"LOGLEVELS")["$[]"](e))?a:t.const_get_relative(d,"LOGLEVELS")["$[]"]("warning"),u(n(s,i.loglevel))?(c=t.const_get_relative(d,"Time").$now().$strftime("%H:%M:%S"),i.console.$write_html("<li class='"+e+"'><i class=\""+t.const_get_relative(d,"LOGICONS")["$[]"](e)+"\"><span class='time'>"+c+"</span><span class='msg'>"+r+"</span></li>"),i.$puts(r)):o},f.$$arity=2),o&&"write"}(i[0],t.const_get_relative(i,"Logger"),i)},Opal.modules.harpnotes=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}function n(t,e){return"number"==typeof t&&"number"==typeof e?t/e:t["$/"](e)}function a(t,e){return"number"==typeof t&&"number"==typeof e?t>e:t["$>"](e)}function i(t,e){return"number"==typeof t&&"number"==typeof e?t*e:t["$*"](e)}function o(t,e){return"number"==typeof t&&"number"==typeof e?t<e:t["$<"](e)}function s(t,e){return"number"==typeof t&&"number"==typeof e?t<=e:t["$<="](e)}function c(t,e){return"number"==typeof t&&"number"==typeof e?t>=e:t["$>="](e)}var l=(t.top,[]),u=t.nil,f=(t.breaker,t.slice,t.module),$=t.klass,_=t.send,d=t.truthy,p=t.hash2,h=t.gvars,g=t.hash,m=t.range;return t.add_stubs(["$attr_accessor","$first","$last","$to_json","$[]","$+","$class","$map","$-","$instance_variables","$instance_variable_get","$is_a?","$raise","$pitch","$beat","$duration","$first_in_part","$attr_reader","$nil?","$uniq","$flatten","$measure_start","$proxy_note","$alias_method","$each","$beat=","$get_proxy_object","$variant","$sheet_drawable","$prev_playable","$prev_playable=","$next_playable","$next_playable=","$!","$companion=","$visible?","$update_beats","$<<","$compact","$expanded_beat_maps","$select","$left","$right","$product","$min_by","$abs","$new","$max","$keys","$last_beat","$private","$inject","$index","$/","$time","$floor","$>","$start_pos","$error","$tuplet","$[]=","$index=","$==","$reset","$_check1","$center","$size","$conf_key","$origin","$_rect_overlap?","$empty?","$warning","$t","$count","$push","$shapes","$get","$clone","$dotted?","$dotted","$gsub","$length","$strip","$*","$to_f","$include","$set_instrument_handlers","$lambda","$===","$each_with_index","$split","$to_i","$line_width=","$call","$join","$tap","$Vector2d","$conf_key=","$conf_value=","$draginfo=","$%","$get_print_options","$initialize","$layout_debug_grid","$layout_images","$benchmark","$compute_beat_compression","$values","$<","$min","$include?","$build_synch_points","$synched_notes","$voices","$layout_voice","$loglevel?","$check_annotations","$notes","$compute_color_by_variant_no","$color=","$layout_stringnames","$meta_data","$align=","$strftime","$now","$checksum","$harpnote_options","$squeeze","$delete","$layout_sortmark","$resolve_placeholder","$message","$printer_config=","$pop","$strict=","$upcase","$ord","$-@","$make_sheetmark_path","$to_a","$<=>","$visible=","$visible","$layout_playable","$proxy","$decorations","$make_decorations_per_playable","$more_conf_keys","$layout_barnumbers_countnotes","$znid","$make_annotated_bezier_path","$first_in_part?","$tuplet_start?","$tuplet_end?","$round","$to_s","$tie_end?","$make_slur_path","$tie_start?","$slur_starts","$slur_ends","$policy","$debug","$from","$to","$compute_vertical_cut","$make_path_from_jumpline","$make_repeatsign_annotation","$position","$style","$companion","$text","$<=","$next_pitch","$prev_pitch","$&","$size_with_dot","$reverse","$compute_note_position","$count_note","$!=","$measure_start?","$measure_count","$compute_beat_compression_1","$compute_beat_compression_2","$compute_beat_compression_10","$compute_beat_compression_0","$group_by","$sort","$beat_maps","$duration_to_id","$get_minc_factor","$notes_on_beat","$>=","$next_first_in_part","$layout_note","$layout_accord","$layout_pause","$convert_pitch_to_xpos","$compute_ellipse_properties_from_note","$layout_note_shift","$sheet_drawable=","$layout_note_flags","$times","$odd?","$check_duration","$shift","$sort_by","$unshift","$x","$y","$normalize","$to_sym","$start_pos_to_s","$end_pos","$rotate","$angle","$perpendicular","$scan"]),function(l,v){var y,b=y=f(l,"Harpnotes"),w=(b.$$proto,[b].concat(v));!function(i,o){var s,c=s=f(i,"Music"),l=(c.$$proto,[c].concat(o));!function(n,a,i){function o(){}var s,c,l,f,d=o=$(n,null,"MusicEntity",o),p=d.$$proto,h=[d].concat(i);p.visible=p.start_pos=u,d.$attr_accessor("beat","conf_key","count_note","decorations","end_pos","next_pitch","next_first_in_part","next_playable","prev_pitch","prev_playable","start_pos","time","endtime","visible","variant","znid","origin","sheet_drawable"),t.defn(d,"$initialize",s=function(){var t=this;return t.visible=!0,t.origin=[u,t.decorations=[]]},s.$$arity=0),t.defn(d,"$visible?",c=function(){return this.visible},c.$$arity=0),t.defn(d,"$start_pos_to_s",l=function(){var t=this;return"["+t.start_pos.$first()+":"+t.start_pos.$last()+"]"},l.$$arity=0),t.defn(d,"$to_json",f=function(){var n,a=this;return t.const_get_relative(h,"Hash")["$[]"](e([["class",a.$class()]],_(r(a.$instance_variables(),["@constructor","@toString"]),"map",[],(n=function(t){var e=n.$$s||this;return null==t&&(t=u),[t,e.$instance_variable_get(t)]},n.$$s=a,n.$$arity=1,n)))).$to_json()},f.$$arity=0)}(l[0],0,l),function(e,r,n){function a(){}var i,o,s,c,l=a=$(e,r,"NonPlayable",a),f=l.$$proto,_=[l].concat(n);f.companion=u,l.$attr_accessor("companion"),t.defn(l,"$companion=",i=function(e){var r=this;return d(e["$is_a?"](t.const_get_qualified(t.const_get_qualified(t.const_get_relative(_,"Harpnotes"),"Music"),"Playable")))||r.$raise("Companion must be playable"),r.companion=e},i.$$arity=1),t.defn(l,"$pitch",o=function(){var e=this;try{return e.companion.$pitch()}catch(e){if(!t.rescue(e,[t.const_get_relative(_,"StandardError")]))throw e;try{return u}finally{t.pop_exception()}}},o.$$arity=0),t.defn(l,"$beat",s=function(){var e=this;try{return e.companion.$beat()}catch(e){if(!t.rescue(e,[t.const_get_relative(_,"StandardError")]))throw e;try{return u}finally{t.pop_exception()}}},s.$$arity=0),t.defn(l,"$duration",c=function(){var e=this;try{return e.companion.$duration()}catch(e){if(!t.rescue(e,[t.const_get_relative(_,"StandardError")]))throw e;try{return u}finally{t.pop_exception()}}},c.$$arity=0)}(l[0],t.const_get_relative(l,"MusicEntity"),l),function(e,r,n){function a(){}var i,o,s,c,l,f,d,p,h,g,m=a=$(e,r,"Playable",a),v=m.$$proto;[m].concat(n);v.tie_end=v.tie_start=v.tuplet_start=v.tuplet_end=v.measure_start=u,m.$attr_accessor("first_in_part","jump_starts","jump_ends","slur_starts","slur_ends","tie_start","tie_end","duration","tuplet","tuplet_start","tuplet_end","shift","count_note","measure_count","measure_start"),t.defn(m,"$initialize",i=function(){var e=this,r=i.$$p,n=u,a=u,o=u;for(r&&(i.$$p=null),a=0,o=arguments.length,n=new Array(o);a<o;a++)n[a]=arguments[a];return _(e,t.find_super_dispatcher(e,"initialize",i,!1),n,r),e.slur_starts=[],e.slur_ends=[],e.tie_start=!1,e.tie_end=!1,e.tuplet=1,e.tuplet_start=!1,e.tuplet_end=!1,e.count_note=u},i.$$arity=0),t.defn(m,"$first_in_part?",o=function(){return this.$first_in_part()},o.$$arity=0),t.defn(m,"$tie_end?",s=function(){return this.tie_end},s.$$arity=0),t.defn(m,"$tie_start?",c=function(){return this.tie_start},c.$$arity=0),t.defn(m,"$tuplet_start?",l=function(){return this.tuplet_start},l.$$arity=0),t.defn(m,"$tuplet_end?",f=function(){return this.tuplet_end},f.$$arity=0),t.defn(m,"$measure_start?",d=function(){return this.measure_start},d.$$arity=0),t.defn(m,"$proxy_note",p=function(){return this},p.$$arity=0),t.defn(m,"$left",h=function(){return this},h.$$arity=0),t.defn(m,"$right",g=function(){return this},g.$$arity=0)}(l[0],t.const_get_relative(l,"MusicEntity"),l),function(e,r,n){function a(){}var i,o=a=$(e,r,"Note",a);o.$$proto,[o].concat(n);o.$attr_reader("pitch","duration"),t.defn(o,"$initialize",i=function(e,r){var n=this,a=i.$$p;return a&&(i.$$p=null),_(n,t.find_super_dispatcher(n,"initialize",i,!1),[],null),d(e["$nil?"]())&&n.$raise("trying to create a note with undefined pitch"),n.pitch=e,n.next_pitch=e,n.next_playable=n,n.prev_pitch=e,n.prev_playable=n,n.duration=r},i.$$arity=2)}(l[0],t.const_get_relative(l,"Playable"),l),function(e,n,a){function i(){}var o,s,c,l,f,p,h,g,m,v,y,b,w,x,A,k=i=$(e,n,"SynchPoint",i),E=k.$$proto,S=[k].concat(a);E.notes=u,k.$attr_reader("notes","synched_notes"),t.defn(k,"$initialize",o=function(e,r){var n=this,a=o.$$p;return null==r&&(r=[]),a&&(o.$$p=null),_(n,t.find_super_dispatcher(n,"initialize",o,!1),[],null),d(e["$is_a?"](t.const_get_relative(S,"Array")))||n.$raise("Notes must be an array"),n.notes=e,n.synched_notes=[e,r].$flatten().$uniq()},o.$$arity=-2),t.defn(k,"$measure_start",s=function(){return this.$proxy_note().$measure_start()},s.$$arity=0),k.$alias_method("measure_start?","measure_start"),t.defn(k,"$duration",c=function(){return this.$proxy_note().$duration()},c.$$arity=0),t.defn(k,"$beat=",l=function(e){var n,a=this;return a.beat=e,_(a.notes,"each",[],(n=function(a){var i=(n.$$s,u);return null==a&&(a=u),i=[e],_(a,"beat=",t.to_a(i)),i[r(i.length,1)]},n.$$s=a,n.$$arity=1,n))},l.$$arity=1),t.defn(k,"$pitch",f=function(){return this.$proxy_note().$pitch()},f.$$arity=0),t.defn(k,"$proxy_note",p=function(){var t=this;return t.$get_proxy_object(t.notes)},p.$$arity=0),t.defn(k,"$variant",h=function(){return this.$proxy_note().$variant()},h.$$arity=0),t.defn(k,"$sheet_drawable",g=function(){return this.$proxy_note().$sheet_drawable()},g.$$arity=0),t.defn(k,"$prev_playable",m=function(){return this.$proxy_note().$prev_playable()},m.$$arity=0),t.defn(k,"$prev_playable=",v=function(e){var n=this,a=u;return a=[e],_(n.$proxy_note(),"prev_playable=",t.to_a(a)),a[r(a.length,1)]},v.$$arity=1),t.defn(k,"$next_playable",y=function(){return this.$proxy_note().$next_playable()},y.$$arity=0),t.defn(k,"$next_playable=",b=function(e){var n=this,a=u;return a=[e],_(n.$proxy_note(),"next_playable=",t.to_a(a)),a[r(a.length,1)]},b.$$arity=1),t.defn(k,"$get_proxy_object",w=function(t){return t.$last()},w.$$arity=1),t.defn(k,"$left",x=function(){return this.notes.$first()},x.$$arity=0),t.defn(k,"$right",A=function(){return this.notes.$last()},A.$$arity=0)}(l[0],t.const_get_relative(l,"Playable"),l),function(e,r,n){function a(){}var i,o,s,c=a=$(e,r,"Pause",a),l=c.$$proto;[c].concat(n);l.visible=l.invisible=u,c.$attr_accessor("duration","pitch"),c.$attr_accessor("invisible"),t.defn(c,"$initialize",i=function(e,r){var n=this,a=i.$$p;return a&&(i.$$p=null),_(n,t.find_super_dispatcher(n,"initialize",i,!1),[],null),d(e["$nil?"]())&&n.$raise("trying to create a rest with undefined pitch"),n.pitch=e,n.duration=r,n.next_playable=n,n.prev_pitch=e,n.prev_playable=n},i.$$arity=2),t.defn(c,"$visible=",o=function(t){return this.visible=t},o.$$arity=1),t.defn(c,"$visible?",s=function(){var t,e=this;return d(t=e.visible)?e.invisible["$!"]():t},s.$$arity=0)}(l[0],t.const_get_relative(l,"Playable"),l),function(e,n,a){function i(){}var o,s=i=$(e,n,"MeasureStart",i);s.$$proto,[s].concat(a);t.defn(s,"$initialize",o=function(e){var n=this,a=o.$$p,i=u;return a&&(o.$$p=null),_(n,t.find_super_dispatcher(n,"initialize",o,!1),[],null),i=[e],_(n,"companion=",t.to_a(i)),i[r(i.length,1)],n.visible=e["$visible?"]()},o.$$arity=1)}(l[0],t.const_get_relative(l,"NonPlayable"),l),function(e,r,n){function a(){}var i,o=a=$(e,r,"NewPart",a);o.$$proto,[o].concat(n);o.$attr_reader("name"),t.defn(o,"$initialize",i=function(e,r){var n=this,a=i.$$p;return null==r&&(r=u),a&&(i.$$p=null),_(n,t.find_super_dispatcher(n,"initialize",i,!1),[],null),n.conf_key=r,n.name=e},i.$$arity=-2)}(l[0],t.const_get_relative(l,"NonPlayable"),l),function(e,n,a){function i(){}var o,s,c,l,f,p=i=$(e,n,"NoteBoundAnnotation",i),h=p.$$proto;[p].concat(a);h.annotations=u,t.defn(p,"$initialize",o=function(e,n,a){var i=this,s=o.$$p,c=u;return null==a&&(a=u),s&&(o.$$p=null),_(i,t.find_super_dispatcher(i,"initialize",o,!1),[],null),c=[e],_(i,"companion=",t.to_a(c)),c[r(c.length,1)],i.conf_key=a,i.annotations=n},o.$$arity=-3),t.defn(p,"$style",s=function(){var t;return d(t=this.annotations["$[]"]("style"))?t:"regular"},s.$$arity=0),t.defn(p,"$text",c=function(){return this.annotations["$[]"]("text")},c.$$arity=0),t.defn(p,"$position",l=function(){return this.annotations["$[]"]("pos")},l.$$arity=0),t.defn(p,"$policy",f=function(){return this.annotations["$[]"]("policy")},f.$$arity=0)}(l[0],t.const_get_relative(l,"NonPlayable"),l),function(e,r,n){function a(){}var i,o=a=$(e,r,"Goto",a),s=(o.$$proto,[o].concat(n));o.$attr_reader("from","to","policy"),t.defn(o,"$initialize",i=function(e,r,n){var a=this,o=i.$$p;return o&&(i.$$p=null),_(a,t.find_super_dispatcher(a,"initialize",i,!1),[],null),d(e["$is_a?"](t.const_get_qualified(t.const_get_qualified(t.const_get_relative(s,"Harpnotes"),"Music"),"Playable")))||a.$raise("End point of Jump ("+e.$class()+") must be a Playable"),d(r["$is_a?"](t.const_get_qualified(t.const_get_qualified(t.const_get_relative(s,"Harpnotes"),"Music"),"Playable")))||a.$raise("Start point of Jump ("+r.$class()+") must be a Playable"),a.from=e,a.to=r,a.policy=n,a.conf_key=n["$[]"]("conf_key")},i.$$arity=3)}(l[0],t.const_get_relative(l,"MusicEntity"),l),function(e,r,n){function a(){}var i,o=a=$(e,r,"BeatMap",a);o.$$proto,[o].concat(n);o.$attr_accessor("index"),t.defn(o,"$initialize",i=function(t){return this.index=t},i.$$arity=1)}(l[0],t.const_get_relative(l,"Hash"),l),function(e,i,o){function s(){}var c,l,f,g,m,v,y,b=s=$(e,null,"Song",s),w=b.$$proto,x=[b].concat(o);w.voices=w.beat_maps=w.meta_data=w.harpnote_options=u,b.$attr_reader("voices","beat_maps"),b.$attr_accessor("meta_data","harpnote_options","checksum"),t.defn(b,"$to_json",c=function(){var t=this;return p(["voices","beat_maps","meta_data","harpnote_options"],{voices:t.voices,beat_maps:t.beat_maps,meta_data:t.meta_data,harpnote_options:t.harpnote_options}).$to_json()},c.$$arity=0),t.defn(b,"$initialize",l=function(t,e,r){var n=this;return null==t&&(t=[]),null==e&&(e=8),null==r&&(r=p([],{})),n.voices=t,n.note_length_in_beats=e,n.meta_data=r,n.views=[],n.$update_beats()},l.$$arity=-1),t.defn(b,"$<<",f=function(t){var e=this;return e.voices["$<<"](t),e.$update_beats()},f.$$arity=1),t.defn(b,"$build_synch_points",g=function(e){var n,a=this;return null==e&&(e=u),_(a.$expanded_beat_maps(),"map",[],(n=function(a){var i,o,s,c=n.$$s||this,l=u,f=u,$=u,p=u,h=u,g=u,m=u,v=u,y=u,b=u;return null==a&&(a=u),l=_([a["$[]"](e.$first()),a["$[]"](e.$last())].$compact(),"select",[],(i=function(t){i.$$s;return null==t&&(t=u),t["$visible?"]()},i.$$s=c,i.$$arity=1,i)),f=l["$[]"](0),$=l["$[]"](1),d(d(o=f)?$:o)&&(p=f.$left(),h=f.$right(),g=$.$left(),m=$.$right(),v=[p,h].$product([g,m])),d(v)&&(y=_(v,"min_by",[],(s=function(t){s.$$s;return null==t&&(t=u),r(t.$last().$pitch(),t.$first().$pitch()).$abs()},s.$$s=c,s.$$arity=1,s)),b=t.const_get_relative(x,"SynchPoint").$new(y,v)),b},n.$$s=a,n.$$arity=1,n)).$flatten().$compact()},g.$$arity=-1),t.defn(b,"$last_beat",m=function(){var t,e=this;return _(e.beat_maps,"map",[],(t=function(e){var r;t.$$s;return null==e&&(e=u),d(r=e.$keys().$max())?r:0},t.$$s=e,t.$$arity=1,t)).$max()},m.$$arity=0),t.defn(b,"$expanded_beat_maps",v=function(){var e,r=this;return _(t.Range.$new(0,r.$last_beat(),!1),"map",[],(e=function(t){var r,n=e.$$s||this;return null==n.beat_maps&&(n.beat_maps=u),null==t&&(t=u),_(n.beat_maps,"map",[],(r=function(e){r.$$s;return null==e&&(e=u),e["$[]"](t)},r.$$s=n,r.$$arity=1,r))},e.$$s=r,e.$$arity=1,e))},v.$$arity=0),b.$private(),t.defn(b,"$update_beats",y=function(){var e,i=this;return i.beat_maps=_(i.voices,"map",[],(e=function(i){var o,s,c=e.$$s||this,l=u;return null==i&&(i=u),l=0,_(_(i,"select",[],(o=function(e){o.$$s;return null==e&&(e=u),e["$is_a?"](t.const_get_relative(x,"Playable"))},o.$$s=c,o.$$arity=1,o)),"inject",[t.const_get_relative(x,"BeatMap").$new(i.$index())],(s=function(e,o){var c=(s.$$s,u),f=u,$=u,p=u;return null==h.log&&(h.log=u),null==e&&(e=u),null==o&&(o=u),l=n(o.$time(),8),c=l.$floor(0),f=r(l,c),d(a(f,0))&&($=o.$start_pos(),h.log.$error("unsupported tuplet "+o.$tuplet()+" "+f,$),l=c),p=[l,o],_(e,"[]=",t.to_a(p)),p[r(p.length,1)],p=[l],_(o,"beat=",t.to_a(p)),p[r(p.length,1)],p=[i.$index()],_(e,"index=",t.to_a(p)),p[r(p.length,1)],e},s.$$s=c,s.$$arity=2,s))},e.$$s=i,e.$$arity=1,e)),u},y.$$arity=0)}(l[0],0,l),function(e,r,n){function a(){}var i,o,s,c,l=a=$(e,r,"Voice",a),f=l.$$proto;[l].concat(n);f.show_voice=f.show_flowline=f.show_jumpline=u,l.$attr_accessor("index","name","show_voice","show_flowline","show_jumpline"),t.defn(l,"$initialize",i=function(){var e=this,r=i.$$p,n=u,a=u,o=u;for(r&&(i.$$p=null),a=0,o=arguments.length,n=new Array(o);a<o;a++)n[a]=arguments[a];return e.show_voice=!0,e.show_flowline=!0,e.show_jumpline=!0,_(e,t.find_super_dispatcher(e,"initialize",i,!1),n,r)},i.$$arity=0),t.defn(l,"$show_voice?",o=function(){return this.show_voice["$=="](!0)},o.$$arity=0),t.defn(l,"$show_flowline?",s=function(){return this.show_flowline["$=="](!0)},s.$$arity=0),t.defn(l,"$show_jumpline?",c=function(){return this.show_jumpline["$=="](!0)},c.$$arity=0)}(l[0],t.const_get_relative(l,"Array"),l)}(w[0],w),function(n,o){var s,c=s=f(n,"Drawing"),l=(c.$$proto,[c].concat(o));!function(r,n,i){function o(){}var s,c,l,f,p,g=o=$(r,null,"CollisionDetector",o),m=g.$$proto,v=[g].concat(i);m.coll_stack=u,t.defn(g,"$initialize",s=function(){return this.$reset()},s.$$arity=0),t.defn(g,"$check_annotations",c=function(e){var r,n,a=this;return _(_(e,"select",[],(r=function(e){r.$$s;return null==e&&(e=u),e["$is_a?"](t.const_get_relative(v,"Annotation"))},r.$$s=a,r.$$arity=1,r)),"each",[],(n=function(t){var e=n.$$s||this;return null==t&&(t=u),e.$_check1(t.$center(),t.$size(),t.$conf_key(),t.$origin())},n.$$s=a,n.$$arity=1,n))},c.$$arity=1),t.defn(g,"$reset",l=function(){return this.coll_stack=[]},l.$$arity=0),t.defn(g,"$_check1",f=function(r,n,a,i){var o,s,c,l=this,f=u,$=u,p=u,g=u,m=u,y=u,b=u;if(null==h.log&&(h.log=u),s=r,o=t.to_ary(s),f=null==o[0]?u:o[0],$=null==o[1]?u:o[1],s=n,o=t.to_ary(s),p=null==o[0]?u:o[0],g=null==o[1]?u:o[1],m=[f,$,e(f,p),e($,g)],y=_(l.coll_stack,"select",[],(c=function(t){var e=c.$$s||this;return null==t&&(t=u),e["$_rect_overlap?"](t,m)},c.$$s=l,c.$$arity=1,c)),b=[0,0],d(y["$empty?"]()));else{try{b=i["$[]"]("start_pos")}catch(e){if(!t.rescue(e,[t.const_get_relative(v,"StandardError")]))throw e;try{h.log.$error("BUG: Annotation without origin harpnotes 749")}finally{t.pop_exception()}}h.log.$warning(e(t.const_get_relative(v,"I18n").$t("annotations too close ["),y.$count()+"] "+a),b)}return l.coll_stack.$push(m),r},f.$$arity=4),t.defn(g,"$_rect_overlap?",p=function(e,r){var n,i,o,s=u,c=u,l=u,f=u,$=u,_=u,p=u,h=u;return i=e,n=t.to_ary(i),s=null==n[0]?u:n[0],c=null==n[1]?u:n[1],l=null==n[2]?u:n[2],f=null==n[3]?u:n[3],i=r,n=t.to_ary(i),$=null==n[0]?u:n[0],_=null==n[1]?u:n[1],p=null==n[2]?u:n[2],h=null==n[3]?u:n[3],d(n=d(i=d(o=a(l,$))?a(p,s):o)?a(f,_):i)?a(h,c):n},p.$$arity=2)}(l[0],0,l),function(e,r,n){function a(){}var i,o=a=$(e,null,"Sheet",a);o.$$proto,[o].concat(n);o.$attr_reader("children","active_voices"),o.$attr_accessor("printer_config"),t.defn(o,"$initialize",i=function(t,e){var r=this;return null==h.conf&&(h.conf=u),r.children=t,r.active_voices=e,r.printer_config=h.conf["$[]"]("printer")},i.$$arity=2)}(l[0],0,l),function(r,n,a){function i(){}var o,s,c,l=i=$(r,null,"CompoundDrawable",i),f=l.$$proto;[l].concat(a);f.shapes=u,l.$attr_accessor("shapes","proxy"),t.defn(l,"$initialize",o=function(t,e){var r=this;return r.shapes=t,r.proxy=e},o.$$arity=2),t.defn(l,"$push",s=function(t){return this.shapes["$<<"](t)},s.$$arity=1),t.defn(l,"$merge",c=function(t){var r=this;return r.shapes=e(r.shapes,t.$shapes())},c.$$arity=1)}(l[0],0,l),function(n,a,i){function o(){}var s,c,l,f,p,g,m,v,y,b=o=$(n,null,"Drawable",o),w=b.$$proto;[b].concat(i);w.visible=w.line_width=w.color=w.size=u,b.$attr_accessor("conf_key","conf_value","draginfo","color","size","more_conf_keys"),t.defn(b,"$initialize",s=function(){var t=this;return null==h.conf&&(h.conf=u),t.visible=!0,t.line_width=h.conf.$get("layout.LINE_THIN"),t.conf_key=u,t.more_conf_keys=[],t.color=h.conf.$get("layout.color.color_default"),t.size=[1,1]},s.$$arity=0),t.defn(b,"$center",c=function(){var t=this;return t.$raise("center not implemented for "+t.$class())},c.$$arity=0),t.defn(b,"$visible?",l=function(){return this.visible},l.$$arity=0),t.defn(b,"$visible=",f=function(t){return this.visible=t},f.$$arity=1),t.defn(b,"$line_width=",p=function(t){return this.line_width=t},p.$$arity=1),t.defn(b,"$line_width",g=function(){return this.line_width},g.$$arity=0),t.defn(b,"$color=",m=function(t){return this.color=t},m.$$arity=1),t.defn(b,"$color",v=function(){return this.color},v.$$arity=0),t.defn(b,"$size_with_dot",y=function(){var n=this,a=u,i=u;return a=n.size.$clone(),d(n["$dotted?"]())&&(i=[0,e(a["$[]"](0),1)],_(a,"[]=",t.to_a(i)),i[r(i.length,1)]),a},y.$$arity=0)}(l[0],0,l),function(e,r,n){function a(){}var i,o,s,c=a=$(e,r,"Symbol",a),l=c.$$proto;[c].concat(n);l.dotted=l.hasbarover=u,c.$attr_accessor("dotted","hasbarover"),t.defn(c,"$iniitalize",i=function(){var e=this,r=i.$$p,n=u,a=u,o=u;for(r&&(i.$$p=null),a=0,o=arguments.length,n=new Array(o);a<o;a++)n[a]=arguments[a];return _(e,t.find_super_dispatcher(e,"iniitalize",i,!1),n,r)},i.$$arity=0),t.defn(c,"$dotted?",o=function(){return this.dotted},o.$$arity=0),t.defn(c,"$hasbarover?",s=function(){return this.hasbarover},s.$$arity=0)}(l[0],t.const_get_relative(l,"Drawable"),l),function(e,r,n){function a(){}var i,o,s,c=a=$(e,r,"FlowLine",a),l=c.$$proto;[c].concat(n);l.style=u,c.$attr_reader("from","to","style"),t.defn(c,"$initialize",i=function(e,r,n){var a=this,o=i.$$p;return null==n&&(n="solid"),o&&(i.$$p=null),_(a,t.find_super_dispatcher(a,"initialize",i,!1),[],null),a.from=e,a.to=r,a.style=n},i.$$arity=-3),t.defn(c,"$dashed?",o=function(){return this.style["$=="]("dashed")},o.$$arity=0),t.defn(c,"$dotted?",s=function(){return this.style["$=="]("dotted")},s.$$arity=0)}(l[0],t.const_get_relative(l,"Drawable"),l),function(e,r,n){function a(){}var i,o=a=$(e,r,"Image",a);o.$$proto,[o].concat(n);o.$attr_reader("url","llpos","height","opacity","origin"),t.defn(o,"$initialize",i=function(t,e,r,n){var a=this;return null==n&&(n=u),a.url=t,a.llpos=e,a.height=r,a.origin=u},i.$$arity=-4)}(l[0],t.const_get_relative(l,"Drawable"),l),function(e,r,n){function a(){}var i,o,s=a=$(e,r,"Path",a),c=s.$$proto;[s].concat(n);c.fill=u,s.$attr_reader("path","style","origin"),t.defn(s,"$initialize",i=function(e,r,n,a){var o=this,s=i.$$p;return null==r&&(r=u),null==n&&(n=u),null==a&&(a="solid"),s&&(i.$$p=null),_(o,t.find_super_dispatcher(o,"initialize",i,!1),[],null),o.path=e,o.fill=r,o.origin=n,o.style=a},i.$$arity=-2),t.defn(s,"$filled?",o=function(){return this.fill["$=="]("filled")},o.$$arity=0)}(l[0],t.const_get_relative(l,"Drawable"),l),function(e,r,n){function a(){}var i,o,s,c,l,f=a=$(e,r,"Ellipse",a),d=f.$$proto;[f].concat(n);d.size=d.fill=d.rect=u,f.$attr_reader("center","size","fill","origin","color"),t.defn(f,"$initialize",i=function(e,r,n,a,o,s){var c=this,l=i.$$p;return null==n&&(n="filled"),null==a&&(a=!1),null==o&&(o=u),null==s&&(s=!1),l&&(i.$$p=null),_(c,t.find_super_dispatcher(c,"initialize",i,!1),[],null),c.center=e,c.size=r,c.fill=n,c.dotted=a,c.rect=s,c.origin=o},i.$$arity=-3),t.defn(f,"$height",o=function(){return this.size.$last()},o.$$arity=0),t.defn(f,"$dotted?",s=function(){return this.$dotted()},s.$$arity=0),t.defn(f,"$filled?",c=function(){return this.fill["$=="]("filled")},c.$$arity=0),t.defn(f,"$rect?",l=function(){return this.rect["$=="](!0)},l.$$arity=0)}(l[0],t.const_get_relative(l,"Symbol"),l),function(e,r,n){function o(){}var s,c,l=o=$(e,r,"Annotation",o),f=l.$$proto;[l].concat(n);f.text=f.style=u,l.$attr_reader("center","text","style","origin"),l.$attr_accessor("conf_key","conf_value","align","baseline"),t.defn(l,"$initialize",s=function(e,r,n,a,i,o){var c=this,l=s.$$p,f=u;return null==n&&(n="regular"),null==a&&(a=u),null==i&&(i=u),null==o&&(o=p([],{})),l&&(s.$$p=null),_(c,t.find_super_dispatcher(c,"initialize",s,!1),[],null),f=r.$gsub(/[]/,p(["","","","","",""],{"":'"',"":'"',
"":"'","":"'","":"-","":"-"})),c.center=e,c.text=f,c.style=n,c.align="left",c.baseline="alphabetic",c.origin=a,c.conf_key=i,c.conf_value=o},s.$$arity=-3),t.defn(l,"$size",c=function(){var t,e=this,r=u,n=u,o=u;return null==h.conf&&(h.conf=u),null==h.log&&(h.log=u),d(d(t=e.text)?a(e.text.$strip().$length(),0):t)?(r=h.conf.$get("layout.FONT_STYLE_DEF."+e.style+".font_size"),d(r)||(r=10,h.log.$error("unsupported style for annotation: "+e.style)),n=i(r,h.conf.$get("layout.MM_PER_POINT").$to_f()),o=i(e.text.$length(),n)):(t=[1.5,2],o=t[0],n=t[1]),[o,n]},c.$$arity=0)}(l[0],t.const_get_relative(l,"Drawable"),l),function(e,r,n){function a(){}var i,o,s,c,l=a=$(e,r,"Glyph",a),f=l.$$proto,g=[l].concat(n);f.size=f.fill=u,l.$attr_reader("center","size","glyph","origin"),t.const_set(g[0],"GLYPHS",p(["rest_1","rest_4","rest_8","rest_16","fermata","emphasis","error"],{rest_1:p(["d","w","h"],{d:[["M",-10,-5],["l",20,0],["l",0,10],["l",-20,0],["l",0,-10],["z"]],w:20,h:10}),rest_4:p(["d","w","h"],{d:[["M",-1,-10],["c",.12,-.06,.24,-.06,.36,-.03],["c",.09,.06,4.74,5.58,4.86,5.82],["c",.21,.39,.15,.78,-.15,1.26],["c",-.24,.33,-.72,.81,-1.62,1.56],["c",-.45,.36,-.87,.75,-.96,.84],["c",-.93,.99,-1.14,2.49,-.6,3.63],["c",.18,.39,.27,.48,1.32,1.68],["c",1.92,2.25,1.83,2.16,1.83,2.34],["c",0,.18,-.18,.36,-.36,.39],["c",-.15,0,-.27,-.06,-.48,-.27],["c",-.75,-.75,-2.46,-1.29,-3.39,-1.08],["c",-.45,.09,-.69,.27,-.9,.69],["c",-.12,.3,-.21,.66,-.24,1.14],["c",-.03,.66,.09,1.35,.3,2.01],["c",.15,.42,.24,.66,.45,.96],["c",.18,.24,.18,.33,.03,.42],["c",-.12,.06,-.18,.03,-.45,-.3],["c",-1.08,-1.38,-2.07,-3.36,-2.4,-4.83],["c",-.27,-1.05,-.15,-1.77,.27,-2.07],["c",.21,-.12,.42,-.15,.87,-.15],["c",.87,.06,2.1,.39,3.3,.9],["l",.39,.18],["l",-1.65,-1.95],["c",-2.52,-2.97,-2.61,-3.09,-2.7,-3.27],["c",-.09,-.24,-.12,-.48,-.03,-.75],["c",.15,-.48,.57,-.96,1.83,-2.01],["c",.45,-.36,.84,-.72,.93,-.78],["c",.69,-.75,1.02,-1.8,.9,-2.79],["c",-.06,-.33,-.21,-.84,-.39,-1.11],["c",-.09,-.15,-.45,-.6,-.81,-1.05],["c",-.36,-.42,-.69,-.81,-.72,-.87],["c",-.09,-.18,0,-.42,.21,-.51],["z"]],w:7.888,h:21.435}),rest_8:p(["d","w","h"],{d:[["M",-2,-6.7],["c",.66,-.09,1.23,.09,1.68,.51],["c",.27,.3,.39,.54,.57,1.26],["c",.09,.33,.18,.66,.21,.72],["c",.12,.27,.33,.45,.6,.48],["c",.12,0,.18,0,.33,-.09],["c",.39,-.18,1.32,-1.29,1.68,-1.98],["c",.09,-.21,.24,-.3,.39,-.3],["c",.12,0,.27,.09,.33,.18],["c",.03,.06,-.27,1.11,-1.86,6.42],["c",-1.02,3.48,-1.89,6.39,-1.92,6.42],["c",0,.03,-.12,.12,-.24,.15],["c",-.18,.09,-.21,.09,-.45,.09],["c",-.24,0,-.3,0,-.48,-.06],["c",-.09,-.06,-.21,-.12,-.21,-.15],["c",-.06,-.03,.15,-.57,1.68,-4.92],["c",.96,-2.67,1.74,-4.89,1.71,-4.89],["l",-.51,.15],["c",-1.08,.36,-1.74,.48,-2.55,.48],["c",-.66,0,-.84,-.03,-1.32,-.27],["c",-1.32,-.63,-1.77,-2.16,-1.02,-3.3],["c",.33,-.45,.84,-.81,1.38,-.9],["z"]],w:7.534,h:13.883}),rest_16:p(["d","w","h"],{d:[["M",-1.33,-11.12],["c",.66,-.09,1.23,.09,1.68,.51],["c",.27,.3,.39,.54,.57,1.26],["c",.09,.33,.18,.66,.21,.72],["c",.15,.39,.57,.57,.87,.42],["c",.39,-.18,1.2,-1.23,1.62,-2.07],["c",.06,-.15,.24,-.24,.36,-.24],["c",.12,0,.27,.09,.33,.18],["c",.03,.06,-.45,1.86,-2.67,10.17],["c",-1.5,5.55,-2.73,10.14,-2.76,10.17],["c",-.03,.03,-.12,.12,-.24,.15],["c",-.18,.09,-.21,.09,-.45,.09],["c",-.24,0,-.3,0,-.48,-.06],["c",-.09,-.06,-.21,-.12,-.21,-.15],["c",-.06,-.03,.12,-.57,1.44,-4.92],["c",.81,-2.67,1.47,-4.86,1.47,-4.89],["c",-.03,0,-.27,.06,-.54,.15],["c",-1.08,.36,-1.77,.48,-2.58,.48],["c",-.66,0,-.84,-.03,-1.32,-.27],["c",-1.32,-.63,-1.77,-2.16,-1.02,-3.3],["c",.72,-1.05,2.22,-1.23,3.06,-.42],["c",.3,.33,.42,.6,.6,1.38],["c",.09,.45,.21,.78,.33,.9],["c",.09,.09,.27,.18,.45,.21],["c",.12,0,.18,0,.33,-.09],["c",.33,-.15,1.02,-.93,1.41,-1.59],["c",.12,-.21,.18,-.39,.39,-1.08],["c",.66,-2.1,1.17,-3.84,1.17,-3.87],["c",0,0,-.21,.06,-.42,.15],["c",-.51,.15,-1.2,.33,-1.68,.42],["c",-.33,.06,-.51,.06,-.96,.06],["c",-.66,0,-.84,-.03,-1.32,-.27],["c",-1.32,-.63,-1.77,-2.16,-1.02,-3.3],["c",.33,-.45,.84,-.81,1.38,-.9],["z"]],w:9.724,h:21.383}),fermata:p(["d","w","h"],{d:[["M",-.75,-5.34],["c",.12,0,.45,-.03,.69,-.03],["c",2.91,-.03,5.55,1.53,7.41,4.35],["c",1.17,1.71,1.95,3.72,2.43,6.03],["c",.12,.51,.12,.57,.03,.69],["c",-.12,.21,-.48,.27,-.69,.12],["c",-.12,-.09,-.18,-.24,-.27,-.69],["c",-.78,-3.63,-3.42,-6.54,-6.78,-7.38],["c",-.78,-.21,-1.2,-.24,-2.07,-.24],["c",-.63,0,-.84,0,-1.2,.06],["c",-1.83,.27,-3.42,1.08,-4.8,2.37],["c",-1.41,1.35,-2.4,3.21,-2.85,5.19],["c",-.09,.45,-.15,.6,-.27,.69],["c",-.21,.15,-.57,.09,-.69,-.12],["c",-.09,-.12,-.09,-.18,.03,-.69],["c",.33,-1.62,.78,-3,1.47,-4.38],["c",1.77,-3.54,4.44,-5.67,7.56,-5.97],["z"],["M",-.5,1.5],["c",1.38,-.3,2.58,.9,2.31,2.25],["c",-.15,.72,-.78,1.35,-1.47,1.5],["c",-1.38,.27,-2.58,-.93,-2.31,-2.31],["c",.15,-.69,.78,-1.29,1.47,-1.44],["z"]],w:19.748,h:11.289}),emphasis:p(["d","w","h"],{d:[["M",-6.45,-3.69],["c",.06,-.03,.15,-.06,.18,-.06],["c",.06,0,2.85,.72,6.24,1.59],["l",6.33,1.65],["c",.33,.06,.45,.21,.45,.51],["c",0,.3,-.12,.45,-.45,.51],["l",-6.33,1.65],["c",-3.39,.87,-6.18,1.59,-6.21,1.59],["c",-.21,0,-.48,-.24,-.51,-.45],["c",0,-.15,.06,-.36,.18,-.45],["c",.09,-.06,.87,-.27,3.84,-1.05],["c",2.04,-.54,3.84,-.99,4.02,-1.02],["c",.15,-.06,1.14,-.24,2.22,-.42],["c",1.05,-.18,1.92,-.36,1.92,-.36],["c",0,0,-.87,-.18,-1.92,-.36],["c",-1.08,-.18,-2.07,-.36,-2.22,-.42],["c",-.18,-.03,-1.98,-.48,-4.02,-1.02],["c",-2.97,-.78,-3.75,-.99,-3.84,-1.05],["c",-.12,-.09,-.18,-.3,-.18,-.45],["c",.03,-.15,.15,-.3,.3,-.39],["z"]],w:13.5,h:7.5}),error:p(["d","w","h"],{d:[["M",-10,-5],["l",0,10],["l",20,-10],["l",0,10],["z"]],w:20,h:10})})),t.defn(l,"$initialize",i=function(e,r,n,a,o,s,c){var l=this,f=i.$$p,$=u;return null==h.log&&(h.log=u),null==a&&(a=t.const_get_relative(g,"FALSE")),null==o&&(o=u),null==s&&(s=u),null==c&&(c=p([],{})),f&&(i.$$p=null),_(l,t.find_super_dispatcher(l,"initialize",i,!1),[],null),$=t.const_get_relative(g,"GLYPHS")["$[]"](n),d($)||(d($)||h.log.$error("BUG: unsuppoerted glyph "+n),$=t.const_get_relative(g,"GLYPHS")["$[]"]("error")),l.center=e,l.glyph_name=n,l.glyph=$,l.size=r,l.dotted=a,l.origin=o,l.filled=!0,l.conf_key=s,l.conf_value=c,l.coll_stack=[]},i.$$arity=-4),t.defn(l,"$height",o=function(){return this.size.$last()},o.$$arity=0),t.defn(l,"$dotted?",s=function(){return this.$dotted()},s.$$arity=0),t.defn(l,"$filled?",c=function(){return this.fill["$=="]("filled")},c.$$arity=0)}(l[0],t.const_get_relative(l,"Symbol"),l)}(w[0],w),function(l,v){var y,b=y=f(l,"Layout"),w=(b.$$proto,[b].concat(v));!function(l,f,v){function y(){}var b,w,x,A,k,E,S,N,C,I,O,P,L,M,T,B,j,F,R,q,D,z,U,H,G,Y,V,Q,X,J,W,K,Z,tt,et,rt,nt=y=$(l,null,"Default",y),at=nt.$$proto,it=[nt].concat(v);at.placeholders=at.y_offset=at.beat_spacing=at.print_options_raw=at.bottom_annotation_positions=at.uri=at.draw_instrument=at.slur_index=at.color_default=at.layout_minc=at.conf_beat_resolution=at.instrument_orientation=at.pitch_to_xpos=at.color_variant1=at.color_variant2=at.print_options_keys=u,nt.$include(t.const_get_qualified(t.const_get_relative(it,"Harpnotes"),"Music")),nt.$include(t.const_get_qualified(t.const_get_relative(it,"Harpnotes"),"Drawing")),nt.$attr_accessor("uri","placeholders"),t.const_set(it[0],"MM_PER_POINT",.3),t.defn(nt,"$initialize",b=function(){var t=this;return null==h.conf&&(h.conf=u),t.beat_spacing=n(i(h.conf.$get("layout.Y_SCALE"),1),h.conf.$get("layout.BEAT_RESOLUTION")),t.slur_index=p([],{}),t.y_offset=5,t.conf_beat_resolution=h.conf.$get("layout.BEAT_RESOLUTION"),t.layout_minc=p([],{}),t.color_default=h.conf.$get("layout.color.color_default"),t.color_variant1=h.conf.$get("layout.color.color_variant1"),t.color_variant2=h.conf.$get("layout.color.color_variant2"),t.draw_instrument=u,d(t.placeholders)||(t.placeholders=p([],{})),t.$set_instrument_handlers()},b.$$arity=0),t.defn(nt,"$set_instrument_handlers",w=function(){var n,a,o,s,c,l,f,$,p,m,v=this,y=u,b=u,w=u,x=u,A=u,k=u,E=u,S=u,N=u;return null==h.conf&&(h.conf=u),y=h.conf["$[]"]("layout.X_OFFSET"),b=h.conf["$[]"]("layout.X_SPACING"),w=h.conf.$get("layout.PITCH_OFFSET"),v.bottom_annotation_positions=[[150,289],[325,289],[380,289]],v.pitch_to_xpos=_(v,"lambda",[],(n=function(t){n.$$s;return null==t&&(t=u),e(i(e(w,t),b),y)},n.$$s=v,n.$$arity=1,n)),function(){return x=h.conf["$[]"]("layout.instrument"),"Zipino"["$==="](x)?(A="54 55 57 59 60 62 64 66 67 69 71 72 74 76 78",k=t.const_get_relative(it,"Hash")["$[]"](_(A.$split(" ").$each_with_index(),"map",[],(a=function(t,e){a.$$s;return null==t&&(t=u),null==e&&(e=u),[t.$to_i(),e]},a.$$s=v,a.$$arity=2,a))),v.pitch_to_xpos=_(v,"lambda",[],(o=function(t){var r=(o.$$s,u),n=u;return null==t&&(t=u),r=k["$[]"](e(t,w)),n=0,d(r["$nil?"]())||(n=e(i(r,b),y)),n},o.$$s=v,o.$$arity=1,o)),v.bottom_annotation_positions=[[y,287],[y,290],[e(y,100),290]],v.draw_instrument=_(v,"lambda",[],(s=function(){var n=(s.$$s,u),a=u;return null==h.conf&&(h.conf=u),n=t.const_get_qualified(t.const_get_qualified(t.const_get_relative(it,"Harpnotes"),"Drawing"),"Path").$new([["M",e(y,30),20],["L",e(y,190),100],["M",e(y,190),200],["L",e(y,30),281]],"open"),a=[h.conf.$get("layout.LINE_MEDIUM")],_(n,"line_width=",t.to_a(a)),a[r(a.length,1)],[n]},s.$$s=v,s.$$arity=0,s)),v.instrument_orientation="horizontal"):"saitenspiel"["$==="](x)?(v.pitch_to_xpos=_(v,"lambda",[],(c=function(r){var n=(c.$$s,u),a=u;return null==r&&(r=u),n=t.const_get_relative(it,"Hash")["$[]"]([[31,0],[36,1],[38,2],[40,3],[41,4],[43,5],[45,6],[47,7],[48,8],[50,9]]),n=n["$[]"](e(r,w)),a=0,d(n)&&(a=e(i(n,b),y)),a},c.$$s=v,c.$$arity=1,c)),v.bottom_annotation_positions=[[y,287],[y,290],[e(y,100),290]],v.draw_instrument=_(v,"lambda",[],(l=function(){var n=(l.$$s,u),a=u;return null==h.conf&&(h.conf=u),n=t.const_get_qualified(t.const_get_qualified(t.const_get_relative(it,"Harpnotes"),"Drawing"),"Path").$new([["M",e(y,30),6],["L",e(y,180),81],["L",e(y,180),216],["L",e(y,30),291]],"open"),a=[h.conf.$get("layout.LINE_MEDIUM")],_(n,"line_width=",t.to_a(a)),a[r(a.length,1)],[n]},l.$$s=v,l.$$arity=0,l))):"okon-f"["$==="](x)||"okon-g"["$==="](x)||"okon-c"["$==="](x)||"okon-d"["$==="](x)?(E="",A="",x=h.conf["$[]"]("layout.instrument"),"okon-f"["$==="](x)?(A="55 57 58 60 62 64 65 67 69 70 72 74 76 77 79 81 82 84",E=""):"okon-g"["$==="](x)?(A="55 57 59 60 62 64 66 67 69 71 72 74 76 78 79 81 83 84",E="      59          66       71          78       83 "):"okon-c"["$==="](x)?(A="55 57 59 60 62 64 65 67 69 71 72 74 76 77 79 81 83 84",E="      59                   71                   83"):"okon-d"["$==="](x)&&(A="55 57 59 61 62 64 66 67 69 71 73 74 76 78 79 81 83 85",E="      59 61       66       71 73       78       83"),S=g(59,7,61,7,66,7,71,7,73,20,78,65,83,110),k=t.const_get_relative(it,"Hash")["$[]"](_(A.$split(" ").$each_with_index(),"map",[],(f=function(t,e){f.$$s;return null==t&&(t=u),null==e&&(e=u),[t.$to_i(),e]},f.$$s=v,f.$$arity=2,f))),N=_(E.$split(" "),"map",[],($=function(t){$.$$s;return null==t&&(t=u),t.$to_i()},$.$$s=v,$.$$arity=1,$)),v.pitch_to_xpos=_(v,"lambda",[],(p=function(t){var r=(p.$$s,u),n=u;return null==t&&(t=u),r=k["$[]"](e(t,w)),n=0,d(r)&&(n=e(i(r,b),y)),n},p.$$s=v,p.$$arity=1,p)),v.bottom_annotation_positions=[[y,290],[e(y,200),290],[e(y,270),290]],v.draw_instrument=_(v,"lambda",[],(m=function(){var n,a=m.$$s||this,i=u,o=u,s=u;return null==h.conf&&(h.conf=u),i=[],_(N,"each",[],(n=function(e){var r=n.$$s||this;return null==r.pitch_to_xpos&&(r.pitch_to_xpos=u),null==e&&(e=u),i.$push(t.const_get_qualified(t.const_get_qualified(t.const_get_relative(it,"Harpnotes"),"Drawing"),"Annotation").$new([r.pitch_to_xpos.$call(e),S["$[]"](e)],"*","large"))},n.$$s=a,n.$$arity=1,n)),o=t.const_get_qualified(t.const_get_qualified(t.const_get_relative(it,"Harpnotes"),"Drawing"),"Path").$new([["M",r(y,15),280],["L",r(y,15),0],["M",e(y,135),0],["L",e(y,290),157],["L",e(y,290),280]],"open"),s=[h.conf.$get("layout.LINE_MEDIUM")],_(o,"line_width=",t.to_a(s)),s[r(s.length,1)],i.$push(o)},m.$$s=v,m.$$arity=0,m))):"21-strings-a-f"["$==="](x)?v.bottom_annotation_positions=[[190,287],[190,290],[250,290]]:"18-strings-b-e"["$==="](x)?v.bottom_annotation_positions=[[210,287],[210,290],[280,290]]:u}()},w.$$arity=0),t.defn(nt,"$layout_images",x=function(e,n){var a,i=this,o=u,s=u;return o=[],s=e["$[]"]("images"),d(s["$nil?"]())||_(s,"each",[],(a=function(e,i){var s,c=a.$$s||this,l=u;return null==h.resources&&(h.resources=u),null==e&&(e=u),null==i&&(i=u),i["$[]"]("show")["$=="](!0)?(l=h.resources["$[]"](i["$[]"]("imagename")),d(l["$is_a?"](t.const_get_relative(it,"Array")))&&(l=l.$join()),d(l)?o.$push(_(t.const_get_qualified(t.const_get_qualified(t.const_get_relative(it,"Harpnotes"),"Drawing"),"Image").$new(l,r(c.$Vector2d(i["$[]"]("pos")),[0,i["$[]"]("height")]),i["$[]"]("height")),"tap",[],(s=function(a){var o=(s.$$s,u);return null==a&&(a=u),o=["extract."+n+".images."+e+".pos"],_(a,"conf_key=",t.to_a(o)),o[r(o.length,1)],o=[i["$[]"]("pos")],_(a,"conf_value=",t.to_a(o)),o[r(o.length,1)],o=[p(["handler"],{handler:"annotation"})],_(a,"draginfo=",t.to_a(o)),o[r(o.length,1)]},s.$$s=c,s.$$arity=1,s))):u):u},a.$$s=i,a.$$arity=2,a)),o},x.$$arity=2),t.defn(nt,"$layout_debug_grid",A=function(){var e,a,o,s,c=this,l=u,f=u,$=u,d=u,h=u;return l=p(["size","emphasis","line","emphline"],{size:1,emphasis:10,line:.02,emphline:.2}),f=l["$[]"]("size"),$=i(l["$[]"]("emphasis"),f),d=[420,297],h=[],_(_(t.Range.$new(0,n(d.$first(),f),!1),"map",[],(e=function(t){e.$$s;return null==t&&(t=u),i(t,f)},e.$$s=c,e.$$arity=1,e)),"each",[],(a=function(e){var n=(a.$$s,u),i=u;return null==e&&(e=u),n=t.const_get_qualified(t.const_get_qualified(t.const_get_relative(it,"Harpnotes"),"Drawing"),"Path").$new([["M",e,0],["l",0,d.$last()]]),i=[l["$[]"]("line")],_(n,"line_width=",t.to_a(i)),i[r(i.length,1)],e["$%"]($)["$=="](0)&&(i=[l["$[]"]("emphline")],_(n,"line_width=",t.to_a(i)),i[r(i.length,1)]),h["$<<"](n)},a.$$s=c,a.$$arity=1,a)),_(_(t.Range.$new(0,n(d.$last(),f),!1),"map",[],(o=function(t){o.$$s;return null==t&&(t=u),i(t,f)},o.$$s=c,o.$$arity=1,o)),"each",[],(s=function(e){var n=(s.$$s,u),a=u;return null==e&&(e=u),n=t.const_get_qualified(t.const_get_qualified(t.const_get_relative(it,"Harpnotes"),"Drawing"),"Path").$new([["M",0,e],["l",d.$first(),0]]),a=[l["$[]"]("line")],_(n,"line_width=",t.to_a(a)),a[r(a.length,1)],e["$%"]($)["$=="](0)&&(a=[l["$[]"]("emphline")],_(n,"line_width=",t.to_a(a)),a[r(a.length,1)]),h["$<<"](n)},s.$$s=c,s.$$arity=1,s)),h},A.$$arity=0),t.defn(nt,"$layout",k=function(s,c,l,f){var $,g,v,y,b,w,x,A,k,E,S,N,C,I,O,P,L=this,M=u,T=u,B=u,j=u,F=u,R=u,q=u,D=u,z=u,U=u,H=u,G=u,Y=u,V=u,Q=u,X=u,J=u,W=u,K=u,Z=u,tt=u,et=u,rt=u,nt=u,at=u,ot=u,st=u,ct=u,lt=u,ut=u,ft=u,$t=u,_t=u,dt=u,pt=u,ht=u,gt=u,mt=u,vt=u,yt=u,bt=u;null==h.conf&&(h.conf=u),null==h.log&&(h.log=u),null==c&&(c=u),null==l&&(l=0),null==f&&(f="A4"),M=L.$get_print_options(l),L.print_options_raw=M,T=M.$get(),B=d($=T["$[]"]("layout"))?$:p([],{}),h.conf.$push(p(["layout"],{layout:B})),h.conf.$push(p(["printer"],{printer:d($=T["$[]"]("printer"))?$:p([],{})})),L.$initialize(),j=[],d(h.conf["$[]"]("layout.grid"))&&(j=L.$layout_debug_grid()),F=L.$layout_images(T,l),L.layout_minc=d($=M["$[]"]("notebound.minc"))?$:p([],{}),L.y_offset=T["$[]"]("startpos"),L.y_size=h.conf.$get("layout.DRAWING_AREA_SIZE").$last(),R=u,_(h.log,"benchmark",["compute beat compression map"],(g=function(){var t=g.$$s||this,r=u;return r=e(T["$[]"]("voices"),T["$[]"]("layoutlines").$uniq()),R=t.$compute_beat_compression(s,r)},g.$$s=L,g.$$arity=0,g)),q=d($=R.$values().$max())?$:0,D=n(r(h.conf.$get("layout.DRAWING_AREA_SIZE").$last(),L.y_offset),q),d(o(D,L.beat_spacing))&&(z=n(L.beat_spacing,D),h.log.$warning("note distance too small (factor "+z+")")),L.beat_spacing=[D,i(h.conf.$get("layout.packer.pack_max_spreadfactor"),L.beat_spacing)].$min(),c=d(h.conf.$get("layout.bottomup"))?d($=c)?$:_(t.const_get_relative(it,"Proc"),"new",[],(v=function(t){var e=v.$$s||this;return null==e.y_size&&(e.y_size=u),null==e.beat_spacing&&(e.beat_spacing=u),null==t&&(t=u),e.y_size-t*e.beat_spacing},v.$$s=L,v.$$arity=1,v)):d($=c)?$:_(t.const_get_relative(it,"Proc"),"new",[],(y=function(t){var e=y.$$s||this;return null==e.beat_spacing&&(e.beat_spacing=u),null==e.y_offset&&(e.y_offset=u),null==t&&(t=u),t*e.beat_spacing+e.y_offset},y.$$s=L,y.$$arity=1,y)),U=_(t.const_get_relative(it,"Proc"),"new",[],(b=function(t){b.$$s;return null==t&&(t=u),c.$call(R["$[]"](t))},b.$$s=L,b.$$arity=1,b)),H=_(T["$[]"]("synchlines"),"select",[],(w=function(t){var e;w.$$s;return null==t&&(t=u),d(e=T["$[]"]("voices")["$include?"](t.$first()))?T["$[]"]("voices")["$include?"](t.$last()):e},w.$$s=L,w.$$arity=1,w)),G=[],_(h.log,"benchmark",["build_syncpoints"],(x=function(){var t,e=x.$$s||this;return G=_(H,"map",[],(t=function(e){var r,n=t.$$s||this,a=u;return null==e&&(e=u),a=s.$build_synch_points(e),_(a,"map",[],(r=function(t){r.$$s;return null==t&&(t=u),t.$synched_notes()},r.$$s=n,r.$$arity=1,r))},t.$$s=e,t.$$arity=1,t)).$flatten()},x.$$s=L,x.$$arity=0,x)),Y=T["$[]"]("voices"),V=_(s.$voices().$each_with_index(),"map",[],(A=function(t,e){var r=A.$$s||this,n=u,a=u;return null==t&&(t=u),null==e&&(e=u),d(Y["$include?"](e))?(n=T["$[]"]("countnotes"),d(n["$[]"]("voices")["$include?"](e))||(n=u),a=T["$[]"]("barnumbers"),d(a["$[]"]("voices")["$include?"](e))||(a=u),r.$layout_voice(t,U,l,p(["voice_nr","nonflowrest","flowline","subflowline","jumpline","repeatsigns","synched_notes","countnotes","barnumbers","print_options_raw"],{voice_nr:e,nonflowrest:T["$[]"]("nonflowrest"),flowline:T["$[]"]("flowlines")["$include?"](e),subflowline:T["$[]"]("subflowlines")["$include?"](e),jumpline:T["$[]"]("jumplines")["$include?"](e),repeatsigns:T["$[]"]("repeatsigns"),synched_notes:G,countnotes:n,barnumbers:a,print_options_raw:M}))):u},A.$$s=L,A.$$arity=2,A)).$flatten().$compact(),d(h.log["$loglevel?"]("warning"))&&(Q=t.const_get_relative(it,"CollisionDetector").$new(),Q.$check_annotations(V)),X=_(H,"map",[],(k=function(e){var n,a=k.$$s||this,i=u;return null==e&&(e=u),i=s.$build_synch_points(e),_(i,"map",[],(n=function(e){var a=n.$$s||this,i=u,o=u;return null==e&&(e=u),i=t.const_get_relative(it,"FlowLine").$new(e.$notes().$first().$sheet_drawable(),e.$notes().$last().$sheet_drawable(),"dashed"),o=[a.$compute_color_by_variant_no(e.$notes().$first().$variant())],_(i,"color=",t.to_a(o)),o[r(o.length,1)],i},n.$$s=a,n.$$arity=1,n))},k.$$s=L,k.$$arity=1,k)).$flatten(),J=L.$layout_stringnames(T,l),d(($=f["$=="]("A4"))?a(h.conf["$[]"]("printer.a4_pages").$length(),1):f["$=="]("A4"))&&(W=i(12,h.conf.$get("layout.X_SPACING")),_(m(1,2,!1),"each",[],(E=function(r){var n,a=E.$$s||this;return null==r&&(r=u),_([4,290],"each",[],(n=function(a){n.$$s;return null==h.conf&&(h.conf=u),null==a&&(a=u),J["$<<"](t.const_get_qualified(t.const_get_qualified(t.const_get_relative(it,"Harpnotes"),"Drawing"),"Annotation").$new([e(e(i(.25,h.conf.$get("layout.X_SPACING")),h.conf.$get("layout.X_OFFSET")),i(W,r)),a],"x","small",u))},n.$$s=a,n.$$arity=1,n))},E.$$s=L,E.$$arity=1,E))),K=[],Z=d($=s.$meta_data()["$[]"]("title"))?$:"untitled",tt=s.$meta_data()["$[]"]("filename"),et=s.$meta_data()["$[]"]("meter"),d(et)&&(et=et.$last().$split("=").$first()),rt=s.$meta_data()["$[]"]("key"),nt=s.$meta_data()["$[]"]("composer"),at=s.$meta_data()["$[]"]("tempo_display"),ot=T["$[]"]("title"),st=T["$[]"]("legend")["$[]"]("pos"),ct=d($=L.print_options_raw.$get("legend.align"))?$:"r",ct=function(){return d(ct["$=="]("l"))?"right":"left"}(),lt=T["$[]"]("legend")["$[]"]("spos"),ut=ot+"\n"+nt+"\nTakt: "+et+" ("+at+")\nTonart: "+rt,ft=d($=L.print_options_raw.$get("legend.style"))?$:"regular",K["$<<"](_(t.const_get_qualified(t.const_get_qualified(t.const_get_relative(it,"Harpnotes"),"Drawing"),"Annotation").$new(st,Z,"large",u,"extract."+l+".legend.pos",st),"tap",[],(S=function(e){var n=(S.$$s,u);return null==e&&(e=u),n=[p(["handler"],{handler:"annotation"})],_(e,"draginfo=",t.to_a(n)),n[r(n.length,1)],n=[ct],_(e,"align=",t.to_a(n)),n[r(n.length,1)]},S.$$s=L,S.$$arity=1,S))),d(M["$[]"]("notes.T06_legend")["$nil?"]())&&K["$<<"](_(t.const_get_qualified(t.const_get_qualified(t.const_get_relative(it,"Harpnotes"),"Drawing"),"Annotation").$new(lt,ut,ft,u,"extract."+l+".legend.spos",lt),"tap",[],(N=function(e){var n=(N.$$s,u);return null==e&&(e=u),n=[p(["handler"],{handler:"annotation"})],_(e,"draginfo=",t.to_a(n)),n[r(n.length,1)]},N.$$s=L,N.$$arity=1,N))),$t=t.const_get_relative(it,"Time").$now().$strftime("%Y-%m-%d %H:%M:%S"),K["$<<"](t.const_get_qualified(t.const_get_qualified(t.const_get_relative(it,"Harpnotes"),"Drawing"),"Annotation").$new(L.bottom_annotation_positions["$[]"](0),tt+" - created "+$t+" by Zupfnoter "+t.const_get_relative(it,"VERSION")+" ["+L.uri["$[]"]("hostname")+"]","smaller")),K["$<<"](t.const_get_qualified(t.const_get_qualified(t.const_get_relative(it,"Harpnotes"),"Drawing"),"Annotation").$new(L.bottom_annotation_positions["$[]"](1),"Zupfnoter: https://www.zupfnoter.de","smaller")),K["$<<"](t.const_get_qualified(t.const_get_qualified(t.const_get_relative(it,"Harpnotes"),"Drawing"),"Annotation").$new(L.bottom_annotation_positions["$[]"](2),s.$checksum(),"smaller")),_t=T["$[]"]("lyrics"),dt=s.$harpnote_options()["$[]"]("lyrics")["$[]"]("text"),d(dt)&&(pt=dt.$join("\n"),d(_t)&&(ht=_(pt.$gsub("\t"," ").$squeeze(" ").$split(/\n\n+/),"map",[],(C=function(t){C.$$s;return null==t&&(t=u),t.$strip()},C.$$s=L,C.$$arity=1,C)),_t.$delete("versepos"),_(_t,"each",[],(I=function(e,n){var i,s,c,f=I.$$s||this,$=u,h=u,g=u,m=u;return null==f.print_options_raw&&(f.print_options_raw=u),null==e&&(e=u),null==n&&(n=u),$=n["$[]"]("pos"),h=_(d(i=n["$[]"]("verses"))?i:[],"map",[],(s=function(t){var e=(s.$$s,u);return null==t&&(t=u),t["$=="](0)&&(e=9999),d(o(t,0))&&(e=t),d(a(t,0))&&(e=r(t,1)),ht["$[]"](e)},s.$$s=f,s.$$arity=1,s)).$join("\n\n"),g="lyrics."+e,m="extract."+l+"."+g,ft=d(i=f.print_options_raw.$get(g+".style"))?i:"regular",K["$<<"](_(t.const_get_qualified(t.const_get_qualified(t.const_get_relative(it,"Harpnotes"),"Drawing"),"Annotation").$new($,h,ft,u,m+".pos",$),"tap",[],(c=function(e){var n=(c.$$s,u);return null==e&&(e=u),n=[p(["handler"],{handler:"annotation"})],_(e,"draginfo=",t.to_a(n)),n[r(n.length,1)]},c.$$s=f,c.$$arity=1,c)))},I.$$s=L,I.$$arity=2,I)))),gt=T["$[]"]("sortmark"),d(gt["$[]"]("show"))&&J["$<<"](L.$layout_sortmark(Z,gt));try{_(T["$[]"]("notes"),"each",[],(O=function(e,n){var a,i,o=O.$$s||this,s=u,c=u;return null==e&&(e=u),null==n&&(n=u),s="extract."+l+".notes."+e,c=d(a=n["$[]"]("align"))?a:"r",c=function(){return d(c["$=="]("r"))?"left":"right"}(),d(n["$[]"]("pos"))||o.$raise(t.const_get_relative(it,"I18n").$t("missing pos")+" in "+s),d(n["$[]"]("text"))||o.$raise(t.const_get_relative(it,"I18n").$t("missing text")+" in "+s),K["$<<"](_(t.const_get_qualified(t.const_get_qualified(t.const_get_relative(it,"Harpnotes"),"Drawing"),"Annotation").$new(n["$[]"]("pos"),o.$resolve_placeholder(n["$[]"]("text"),s),n["$[]"]("style"),u,s+".pos",n["$[]"]("pos")),"tap",[],(i=function(e){var n=(i.$$s,u);return null==e&&(e=u),n=[c],_(e,"align=",t.to_a(n)),n[r(n.length,1)],n=[p(["handler"],{handler:"annotation"})],_(e,"draginfo=",t.to_a(n)),n[r(n.length,1)]},i.$$s=o,i.$$arity=1,i)))},O.$$s=L,O.$$arity=2,O))}catch(e){if(!t.rescue(e,[t.const_get_relative(it,"Exception")]))throw e;mt=e;try{h.log.$error(mt.$message())}finally{t.pop_exception()}}return d(L.draw_instrument)&&_(L.draw_instrument.$call(),"each",[],(P=function(t){P.$$s;return null==t&&(t=u),J.$push(t)},P.$$s=L,P.$$arity=1,P)),vt=e(e(e(e(e(F,j),X),V),K),J),yt=t.const_get_qualified(t.const_get_qualified(t.const_get_relative(it,"Harpnotes"),"Drawing"),"Sheet").$new(vt,Y),bt=[h.conf["$[]"]("printer")],_(yt,"printer_config=",t.to_a(bt)),bt[r(bt.length,1)],h.conf.$pop(),h.conf.$pop(),yt},k.$$arity=-2),t.defn(nt,"$get_print_options",E=function(e){var n=u,a=u,i=u;return null==h.conf&&(h.conf=u),null==h.log&&(h.log=u),n=t.const_get_relative(it,"Confstack").$new(),a=[!1],_(n,"strict=",t.to_a(a)),a[r(a.length,1)],n.$push(h.conf.$get("extract.0")),i=h.conf.$get("extract."+e),d(i)?n.$push(i):h.log.$warning("selected print variant ["+e+"] not available using [0]: '"+n.$get("title")+"'"),d(n["$[]"]("layout.beams"))&&n.$push(p(["layout"],{layout:p(["DURATION_TO_STYLE"],{DURATION_TO_STYLE:h.conf["$[]"]("layout.DURATION_TO_BEAMS")})})),n},E.$$arity=1),t.defn(nt,"$layout_sortmark",S=function(a,o){var s,c,l,f=this,$=u,g=u,m=u,v=u,y=u,b=u,w=u,x=u;return null==h.conf&&(h.conf=u),$=a.$upcase().$gsub(/[YZ]/,p(["","","","","Y","Z"],{"":"AE","":"OE","":"UE","":"ss",Y:"X",Z:"X"})).$gsub(/[^A-Za-z]/,""),g=_(e($,"AAAA").$split(""),"map",[],(s=function(t){s.$$s;return null==t&&(t=u),r(t.$ord(),"A".$ord())},s.$$s=f,s.$$arity=1,s)),m=e(g["$[]"](0),n(i(e(e(i(.1,g["$[]"](1)),i(.01,g["$[]"](2))),i(.001,g["$[]"](3))),.5),2.4)),l=o["$[]"]("size"),c=t.to_ary(l),v=null==c[0]?u:c[0],y=null==c[1]?u:c[1],b=function(){return d(o["$[]"]("fill"))?"filled":"open"}(),w=i(e(12.5,m),h.conf.$get("layout.X_SPACING")),x=[["M",w,0],["l",n(v["$-@"](),2),y],["l",v,0],["l",n(v["$-@"](),2),y["$-@"]()],["l",0,y],["l",0,y["$-@"]()],["z"]],t.const_get_qualified(t.const_get_qualified(t.const_get_relative(it,"Harpnotes"),"Drawing"),"Path").$new(x,b)},S.$$arity=2),t.defn(nt,"$layout_stringnames",N=function(a,o){var s,c,l=this,f=u,$=u,p=u,g=u,m=u,v=u,y=u,b=u,w=u,x=u,A=u;return null==h.conf&&(h.conf=u),f=a["$[]"]("stringnames")["$[]"]("vpos"),$=a["$[]"]("stringnames")["$[]"]("marks")["$[]"]("hpos"),p="stringnames",g=[],d($["$empty?"]())||(g=e(g,_($,"inject",[[]],(s=function(e,r){var n,i=s.$$s||this;return null==e&&(e=u),null==r&&(r=u),_(a["$[]"]("stringnames")["$[]"]("marks")["$[]"]("vpos"),"each",[],(n=function(a){var i=n.$$s||this,o=u;return null==i.pitch_to_xpos&&(i.pitch_to_xpos=u),null==a&&(a=u),o=i.$make_sheetmark_path([i.pitch_to_xpos.$call(r),a]),e["$<<"](t.const_get_qualified(t.const_get_qualified(t.const_get_relative(it,"Harpnotes"),"Drawing"),"Path").$new(o,"filled"))},n.$$s=i,n.$$arity=1,n)),e},s.$$s=l,s.$$arity=2,s)))),d(f["$empty?"]())||(m=37,v=a["$[]"]("stringnames")["$[]"]("text").$split(" "),v=i(v,e(n(m,v.$length()),1)),y=h.conf.$get("layout.PITCH_OFFSET")["$-@"](),b=r(e(y,m),1),f=a["$[]"]("stringnames")["$[]"]("vpos"),w=a["$[]"]("stringnames")["$[]"]("style"),x=h.conf.$get("layout.X_SPACING"),A=r(h.conf.$get("layout.X_OFFSET"),1),g=e(g,_(t.Range.$new(y,b,!1).$to_a(),"inject",[[]],(c=function(n,a){var o,s=c.$$s||this,l=u;return null==n&&(n=u),null==a&&(a=u),l=e(i(e(y["$-@"](),a),x),A),_(f,"each",[],(o=function(e){o.$$s;return null==e&&(e=u),n["$<<"](t.const_get_qualified(t.const_get_qualified(t.const_get_relative(it,"Harpnotes"),"Drawing"),"Annotation").$new([l,e],v["$[]"](r(a,y)),w,u,p))},o.$$s=s,o.$$arity=1,o)),n},c.$$s=l,c.$$arity=2,c)))),g},N.$$arity=2),t.const_set(it[0],"NOTE_POSITION_LOOKUP",p(["11","12","13","21","22","23","31","32","33"],{11:["r","r"],12:["r","l"],13:["r","l"],21:["r","r"],22:["r","l"],23:["l","l"],31:["l","r"],32:["l","r"],33:["l","l"]})),t.defn(nt,"$compute_note_position",C=function(r,n,i,s){var c=u,l=u;return c=e(r["$<=>"](n),2),l=e(i["$<=>"](n),2),d(o(n,10))?["r","r"]:d(a(n,410))?["l","l"]:t.const_get_relative(it,"NOTE_POSITION_LOOKUP")["$[]"](""+c+l)},C.$$arity=4),t.defn(nt,"$layout_voice",I=function(n,o,s,c){var l,f,$,g,m,v,y,b,w,x,A,k,E,S,N,C,I,O,P,L=this,M=u,T=u,B=u,j=u,F=u,R=u,q=u,D=u,z=u,U=u,H=u,G=u,Y=u,V=u,Q=u,X=u,J=u,W=u,K=u,Z=u,tt=u,et=u,rt=u;return null==h.log&&(h.log=u),null==h.settings&&(h.settings=u),null==h.conf&&(h.conf=u),L.print_options_keys=L.print_options_raw.$keys(),M=c["$[]"]("voice_nr"),T=_(n,"select",[],(l=function(e){l.$$s;return null==e&&(e=u),e["$is_a?"](t.const_get_relative(it,"Playable"))},l.$$s=L,l.$$arity=1,l)),d(c["$[]"]("nonflowrest"))||(B=u,_(T,"each",[],(f=function(e){var n,a,i=(f.$$s,u);return null==e&&(e=u),d(d(n=e["$is_a?"](t.const_get_relative(it,"Pause")))?c["$[]"]("flowline")["$!"]():n)&&(i=[!1],_(e,"visible=",t.to_a(i)),i[r(i.length,1)]),d(d(n=d(a=e["$is_a?"](t.const_get_relative(it,"Pause")))?c["$[]"]("subflowline")["$!"]():a)?c["$[]"]("flowline")["$!"]():n)&&(i=[!1],_(e,"visible=",t.to_a(i)),i[r(i.length,1)]),d(d(n=d(a=c["$[]"]("flowline")["$!"]())?e.$visible():a)?c["$[]"]("synched_notes")["$include?"](e.$proxy_note())["$!"]():n)&&(d(B["$nil?"]())||(i=[!0],_(B,"visible=",t.to_a(i)),i[r(i.length,1)])),B=e},f.$$s=L,f.$$arity=1,f))),j=[],F=_(T,"map",[],($=function(e){var r=$.$$s||this,n=u,a=u,i=u,l=u;return null==e&&(e=u),n="notebound.nconf.v_"+M+".t_"+e.$time(),a="extract."+s+"."+n,i=r.$layout_playable(e,o,a),l=i.$proxy(),j.$push(function(){return d(e.$decorations()["$empty?"]())?[]:r.$make_decorations_per_playable(e,l,s,c,M)}()),l.$more_conf_keys().$push(p(["conf_key","text","icon","value"],{conf_key:l.$conf_key().$gsub(/\.[^\.]+$/,"")+".nshift",text:t.const_get_relative(it,"I18n").$t("shift left"),icon:"fa fa-arrow-left",value:-.5})),l.$more_conf_keys().$push(p(["conf_key","text","icon","value"],{conf_key:l.$conf_key().$gsub(/\.[^\.]+$/,"")+".nshift",text:t.const_get_relative(it,"I18n").$t("shift right"),icon:"fa fa-arrow-right",value:.5})),l.$more_conf_keys().$push(p(["text","icon","value"],{text:"---",icon:"fa fa-arrows-v",value:.5})),l.$more_conf_keys().$push(p(["conf_key","text","icon"],{conf_key:"extract."+s+".notebound.minc."+e.$time()+".minc_f",text:t.const_get_relative(it,"I18n").$t("Edit Minc"),icon:"fa fa-arrows-v"})),l.$more_conf_keys().$push(p(["conf_key","text","icon","value"],{conf_key:"extract."+s+".notebound.minc."+e.$time()+".minc_f",text:t.const_get_relative(it,"I18n").$t("increase Minc"),icon:"fa fa-arrow-down",value:.5})),l.$more_conf_keys().$push(p(["conf_key","text","icon","value"],{conf_key:"extract."+s+".notebound.minc."+e.$time()+".minc_f",text:t.const_get_relative(it,"I18n").$t("decrease Minc"),icon:"fa fa-arrow-up",value:-.5})),i.$shapes()},$.$$s=L,$.$$arity=1,$)).$flatten().$compact(),j=j.$flatten().$compact(),m=_(h.log,"benchmark",["countnotes / barnumbers"],(v=function(){return(v.$$s||this).$layout_barnumbers_countnotes(T,s,c,M)},v.$$s=L,v.$$arity=0,v)),g=t.to_ary(m),R=null==g[0]?u:g[0],q=null==g[1]?u:g[1],B=u,D=h.settings["$[]"]("flowconf")["$=="]("true"),z=h.conf["$[]"]("defaults.notebound.flowline"),U="notebound.flowline.v_"+M,H=d(g=c["$[]"]("print_options_raw")["$[]"](U))?g:p([],{}),G=_(_(n,"select",[],(y=function(e){y.$$s;return null==e&&(e=u),e["$is_a?"](t.const_get_relative(it,"Playable"))},y.$$s=L,y.$$arity=1,y)),"map",[],(b=function(n){var a,i,o,c=b.$$s||this,l=u,f=u,$=u,g=u,m=u,v=u,y=u,w=u,x=u,A=u,k=u,E=u,S=u,N=u;if(null==h.conf&&(h.conf=u),null==n&&(n=u),l=u,d(B["$nil?"]()));else{if(d(!0))if(f=""+n.$znid(),$=H["$[]"](f),d(d(a=$)?a:D["$=="](!0))){g="extract."+s+"."+U+"."+f,m=e(g,".*"),v=c.$Vector2d(B.$sheet_drawable().$center()),y=c.$Vector2d(n.$sheet_drawable().$center()),w=t.const_get_relative(it,"Confstack").$new(),w.$push(z);try{w.$push($)}catch(e){if(!t.rescue(e,[t.const_get_relative(it,"StandardError")]))throw e;t.pop_exception()}i=c.$make_annotated_bezier_path([v,y],w),a=t.to_ary(i),x=null==a[0]?u:a[0],A=null==a[1]?u:a[1],k=null==a[2]?u:a[2],E=null==a[3]?u:a[3],S=D["$=="](!0)?p(["handler","p1","p2","cp1","cp2","mp","tuplet_options","conf_key","callback"],{handler:"tuplet",p1:v.$to_a(),p2:y.$to_a(),cp1:k.$to_a(),cp2:E.$to_a(),mp:A,tuplet_options:w,conf_key:g,callback:u}):u,l=_(t.const_get_qualified(t.const_get_qualified(t.const_get_relative(it,"Harpnotes"),"Drawing"),"Path").$new(x),"tap",[],(o=function(e){var n=(o.$$s,u);return null==e&&(e=u),n=[m],_(e,"conf_key=",t.to_a(n)),n[r(n.length,1)],n=[S],_(e,"draginfo=",t.to_a(n)),n[r(n.length,1)]},o.$$s=c,o.$$arity=1,o))}else l=t.const_get_qualified(t.const_get_qualified(t.const_get_relative(it,"Harpnotes"),"Drawing"),"FlowLine").$new(B.$sheet_drawable(),n.$sheet_drawable());N=[h.conf.$get("layout.LINE_MEDIUM")],_(l,"line_width=",t.to_a(N)),N[r(N.length,1)],d(B["$visible?"]())||(l=u)}return d(n["$first_in_part?"]())&&(l=u),d(n["$visible?"]())||(l=u),B=n,l},b.$$s=L,b.$$arity=1,b)).$compact(),B=u,Y=_(_(n,"select",[],(w=function(e){var r;w.$$s;return null==e&&(e=u),d(r=e["$is_a?"](t.const_get_relative(it,"Playable")))?r:e["$is_a?"](t.const_get_relative(it,"SynchPoint"))},
w.$$s=L,w.$$arity=1,w)),"map",[],(x=function(n){var a,i,o,l=x.$$s||this,f=u,$=u,h=u,g=u,m=u,v=u,y=u,b=u,w=u,A=u,k=u,E=u,S=u;if(null==n&&(n=u),d(c["$[]"]("synched_notes")["$include?"](n.$proxy_note())));else{if(f=u,d(d(a=d(i=B["$nil?"]()["$!"]())?B.$visible():i)?n.$visible():a))if(U="notebound.flowline.v_"+M,H=d(a=c["$[]"]("print_options_raw")["$[]"](U))?a:p([],{}),$=""+n.$znid(),h=H["$[]"]($),d(d(a=h)?a:D["$=="](!0))){g="extract."+s+"."+U+"."+$,m=e(g,".*"),v=l.$Vector2d(B.$sheet_drawable().$center()),y=l.$Vector2d(n.$sheet_drawable().$center()),b=t.const_get_relative(it,"Confstack").$new(),b.$push(z);try{b.$push(h)}catch(e){if(!t.rescue(e,[t.const_get_relative(it,"StandardError")]))throw e;t.pop_exception()}i=l.$make_annotated_bezier_path([v,y],b),a=t.to_ary(i),w=null==a[0]?u:a[0],A=null==a[1]?u:a[1],k=null==a[2]?u:a[2],E=null==a[3]?u:a[3],S=D["$=="](!0)?p(["handler","p1","p2","cp1","cp2","mp","tuplet_options","conf_key","callback"],{handler:"tuplet",p1:v.$to_a(),p2:y.$to_a(),cp1:k.$to_a(),cp2:E.$to_a(),mp:A,tuplet_options:b,conf_key:g,callback:u}):u,f=_(t.const_get_qualified(t.const_get_qualified(t.const_get_relative(it,"Harpnotes"),"Drawing"),"Path").$new(w,u,u,"dotted"),"tap",[],(o=function(e){var n=(o.$$s,u);return null==e&&(e=u),n=[m],_(e,"conf_key=",t.to_a(n)),n[r(n.length,1)],n=[S],_(e,"draginfo=",t.to_a(n)),n[r(n.length,1)]},o.$$s=l,o.$$arity=1,o))}else f=t.const_get_relative(it,"FlowLine").$new(B.$sheet_drawable(),n.$sheet_drawable(),"dotted");d(n["$first_in_part?"]())&&(f=u)}return B=n,f},x.$$s=L,x.$$arity=1,x)).$compact(),d(c["$[]"]("subflowline"))||(Y=[]),d(c["$[]"]("flowline"))||(G=[]),d(c["$[]"]("countnotes"))||(q=[]),d(c["$[]"]("barnumbers"))||(R=[]),V=T.$first(),Q=[],X=_(T,"inject",[[]],(A=function(n,a){var i,o,l,f,$,g,m=A.$$s||this,v=u,y=u,b=u,w=u,x=u,k=u,E=u,S=u,N=u,C=u,I=u,O=u,P=u,L=u,T=u,B=u,j=u,F=u;if(null==h.conf&&(h.conf=u),null==n&&(n=u),null==a&&(a=u),d(a["$tuplet_start?"]())&&(V=a),d(V)&&Q.$push(a.$time()),d(a["$tuplet_end?"]())){v="notebound.tuplet.v_"+M+"."+V.$znid(),y="extract."+s+"."+v,b="pos",w=t.const_get_relative(it,"Confstack").$new(),w.$push(h.conf["$[]"]("defaults.notebound.tuplet"));try{w.$push(c["$[]"]("print_options_raw")["$[]"](v))}catch(e){if(!t.rescue(e,[t.const_get_relative(it,"StandardError")]))throw e;t.pop_exception()}x=m.$Vector2d(V.$sheet_drawable().$center()),k=m.$Vector2d(a.$sheet_drawable().$center()),o=m.$make_annotated_bezier_path([x,k],w),i=t.to_ary(o),E=null==i[0]?u:i[0],S=null==i[1]?u:i[1],N=null==i[2]?u:i[2],C=null==i[3]?u:i[3],I=function(){try{return w["$[]"]("pos")}catch(e){if(!t.rescue(e,[t.const_get_relative(it,"StandardError")]))throw e;try{return[0,0]}finally{t.pop_exception()}}}(),O=e(S,I),P=_(r(O,S).$to_a(),"map",[],(l=function(t){l.$$s;return null==t&&(t=u),t.$round(0)},l.$$s=m,l.$$arity=1,l)),L=_(m,"lambda",[],(f=function(t){f.$$s;return null==t&&(t=u),u},f.$$s=m,f.$$arity=1,f)),w["$[]"]("show")["$=="](!1)||(T=e(y,".*"),B=d(i=c["$[]"]("print_options_raw")["$[]"]("tuplets.style"))?i:"small",j=p(["handler","p1","p2","cp1","cp2","mp","tuplet_options","conf_key","callback"],{handler:"tuplet",p1:x.$to_a(),p2:k.$to_a(),cp1:N.$to_a(),cp2:C.$to_a(),mp:S,tuplet_options:w,conf_key:y,callback:L}),F=d(i=c["$[]"]("print_options_raw")["$[]"]("tuplets.text"))?i:a.$tuplet().$to_s(),F=F.$gsub("{{tuplet}}",a.$tuplet().$to_s()),n.$push(_(t.const_get_qualified(t.const_get_qualified(t.const_get_relative(it,"Harpnotes"),"Drawing"),"Path").$new(E),"tap",[],($=function(e){var n=($.$$s,u);return null==h.conf&&(h.conf=u),null==e&&(e=u),n=[T],_(e,"conf_key=",t.to_a(n)),n[r(n.length,1)],n=[h.conf.$get("layout.LINE_THIN")],_(e,"line_width=",t.to_a(n)),n[r(n.length,1)],n=[j],_(e,"draginfo=",t.to_a(n)),n[r(n.length,1)]},$.$$s=m,$.$$arity=1,$))),n.$push(_(t.const_get_qualified(t.const_get_qualified(t.const_get_relative(it,"Harpnotes"),"Drawing"),"Annotation").$new(O.$to_a(),F,B,V.$origin(),e(y,"."+b),P.$to_a()),"tap",[],(g=function(e){var n=(g.$$s,u);return null==e&&(e=u),n=[p(["handler"],{handler:"annotation"})],_(e,"draginfo=",t.to_a(n)),n[r(n.length,1)]},g.$$s=m,g.$$arity=1,g)))),Q=[],V=u}return n},A.$$s=L,A.$$arity=2,A)),J=["first_playable",T.$first()],_(L.slur_index,"[]=",t.to_a(J)),J[r(J.length,1)],W=T.$first(),K=_(T,"inject",[[]],(k=function(n,a){var i,o,s,c,l=k.$$s||this,f=u,$=u,p=u;return null==l.slur_index&&(l.slur_index=u),null==h.conf&&(h.conf=u),null==n&&(n=u),null==a&&(a=u),d(a["$tie_end?"]())&&(f=e(l.$Vector2d(W.$sheet_drawable().$center()),[3,0]),$=e(l.$Vector2d(a.$sheet_drawable().$center()),[3,0]),p=function(){return d(h.conf["$[]"]("layout.bottomup"))?l.$make_slur_path($,f):l.$make_slur_path(f,$)}(),n.$push(_(t.const_get_qualified(t.const_get_qualified(t.const_get_relative(it,"Harpnotes"),"Drawing"),"Path").$new(p),"tap",[],(i=function(e){i.$$s;return null==h.conf&&(h.conf=u),null==e&&(e=u),J=[h.conf.$get("layout.LINE_MEDIUM")],_(e,"line_width=",t.to_a(J)),J[r(J.length,1)]},i.$$s=l,i.$$arity=1,i))),d(a["$is_a?"](t.const_get_qualified(t.const_get_qualified(t.const_get_relative(it,"Harpnotes"),"Music"),"SynchPoint")))&&_(a.$notes(),"each_with_index",[],(o=function(a,i){var s,c=o.$$s||this;null==h.log&&(h.log=u),null==a&&(a=u),null==i&&(i=u);try{return f=W.$notes()["$[]"](i),f=e(c.$Vector2d(f.$sheet_drawable().$center()),[3,0]),$=e(c.$Vector2d(a.$sheet_drawable().$center()),[3,0]),p=c.$make_slur_path(f,$),n.$push(_(t.const_get_qualified(t.const_get_qualified(t.const_get_relative(it,"Harpnotes"),"Drawing"),"Path").$new(p),"tap",[],(s=function(e){s.$$s;return null==h.conf&&(h.conf=u),null==e&&(e=u),J=[h.conf.$get("layout.LINE_MEDIUM")],_(e,"line_width=",t.to_a(J)),J[r(J.length,1)]},s.$$s=c,s.$$arity=1,s)))}catch(e){if(!t.rescue(e,[t.const_get_relative(it,"Exception")]))throw e;e;try{return h.log.$error("tied chords which doesn't have same number of notes",a.$start_pos())}finally{t.pop_exception()}}},o.$$s=l,o.$$arity=2,o))),d(a["$tie_start?"]())&&(W=a),_(a.$slur_starts(),"each",[],(s=function(e){var n=s.$$s||this;return null==n.slur_index&&(n.slur_index=u),null==e&&(e=u),J=[e,a],_(n.slur_index,"[]=",t.to_a(J)),J[r(J.length,1)]},s.$$s=l,s.$$arity=1,s)),J=[a.$slur_starts().$first(),a],_(l.slur_index,"[]=",t.to_a(J)),J[r(J.length,1)],_(a.$slur_ends(),"each",[],(c=function(i){var o,s,l=c.$$s||this,p=u,g=u;return null==l.slur_index&&(l.slur_index=u),null==h.conf&&(h.conf=u),null==i&&(i=u),p=d(o=l.slur_index["$[]"](i))?o:l.slur_index["$[]"]("first_playable"),f=e(l.$Vector2d(p.$sheet_drawable().$center()),[3,0]),$=e(l.$Vector2d(a.$sheet_drawable().$center()),[3,0]),g=l.$make_slur_path(f,$),d(h.conf.$get("layout.SHOW_SLUR"))?n.$push(_(t.const_get_qualified(t.const_get_qualified(t.const_get_relative(it,"Harpnotes"),"Drawing"),"Path").$new(g),"tap",[],(s=function(e){s.$$s;return null==h.conf&&(h.conf=u),null==e&&(e=u),J=[h.conf.$get("layout.LINE_MEDIUM")],_(e,"line_width=",t.to_a(J)),J[r(J.length,1)]},s.$$s=l,s.$$arity=1,s))):u},c.$$s=l,c.$$arity=1,c)),n},k.$$s=L,k.$$arity=2,k)),Z=_(_(n,"select",[],(E=function(e){E.$$s;return null==e&&(e=u),e["$is_a?"](t.const_get_relative(it,"Goto"))},E.$$s=L,E.$$arity=1,E)),"map",[],(S=function(n){var o,l,f=S.$$s||this,$=u,g=u,m=u,v=u,y=u,b=u,w=u,x=u,A=u,k=u,E=u,N=u,C=u,I=u,O=u;return null==h.log&&(h.log=u),null==h.conf&&(h.conf=u),null==n&&(n=u),d(n.$conf_key())&&($="extract."+s+"."+n.$conf_key(),g=c["$[]"]("print_options_raw")["$[]"](n.$conf_key()),d(g)||(m=$.$gsub(/(.*)\.(\d+)\.(\d+)\.(\w+)/,"\\1.\\2.\\4"),g=c["$[]"]("print_options_raw")["$[]"](m))),d(g)||(g=n.$policy()["$[]"]("distance")),d(g)||(g=1),v=function(){return!g["$=="](0)}(),d(a(g,0))&&(g=r(g,1)),y=d(o=n.$policy()["$[]"]("from_anchor"))?o:"after",b=d(o=n.$policy()["$[]"]("to_anchor"))?o:"before",w=d(o=n.$policy()["$[]"]("vertical_anchor"))?o:"from",h.log.$debug("vertical line x offset: "+g+" harpnotes:2160"),x=i(e(g,.5),h.conf.$get("layout.X_SPACING")),A=n.$from().$sheet_drawable(),k=n.$to().$sheet_drawable(),d(h.conf["$[]"]("layout.bottomup"))&&(E=p(["before","after"],{before:"after",after:"before"}),y=E["$[]"](y),b=E["$[]"](b)),N=f.$compute_vertical_cut(A,k),C=p(["from","to","vertical","vertical_anchor","padding","xspacing","jumpline_anchor","verticalcut"],{from:p(["center","size","anchor"],{center:A.$center(),size:A.$size(),anchor:y}),to:p(["center","size","anchor"],{center:k.$center(),size:k.$size(),anchor:b}),vertical:x,vertical_anchor:w,padding:n.$policy()["$[]"]("padding"),xspacing:h.conf["$[]"]("layout.X_SPACING"),jumpline_anchor:h.conf["$[]"]("layout.jumpline_anchor"),verticalcut:N}),I=t.const_get_qualified(t.const_get_qualified(t.const_get_relative(it,"Harpnotes"),"Layout"),"Default").$make_path_from_jumpline(C),O=p(["handler","jumpline","xspacing"],{handler:"jumpline",jumpline:C,xspacing:h.conf.$get("layout.X_SPACING")}),d(v)?d(d(o=n.$policy()["$[]"]("is_repeat"))?c["$[]"]("repeatsigns")["$[]"]("voices")["$include?"](c["$[]"]("voice_nr")):o)?u:[_(t.const_get_qualified(t.const_get_qualified(t.const_get_relative(it,"Harpnotes"),"Drawing"),"Path").$new(I["$[]"](0),u,n.$from()),"tap",[],(l=function(e){l.$$s;return null==h.conf&&(h.conf=u),null==e&&(e=u),J=[$],_(e,"conf_key=",t.to_a(J)),J[r(J.length,1)],J=[g],_(e,"conf_value=",t.to_a(J)),J[r(J.length,1)],J=[h.conf.$get("layout.LINE_THICK")],_(e,"line_width=",t.to_a(J)),J[r(J.length,1)],J=[O],_(e,"draginfo=",t.to_a(J)),J[r(J.length,1)]},l.$$s=f,l.$$arity=1,l)),t.const_get_qualified(t.const_get_qualified(t.const_get_relative(it,"Harpnotes"),"Drawing"),"Path").$new(I["$[]"](1),"filled",n.$from()),t.const_get_qualified(t.const_get_qualified(t.const_get_relative(it,"Harpnotes"),"Drawing"),"Path").$new(I["$[]"](2),"filled",n.$from())]:u},S.$$s=L,S.$$arity=1,S)).$flatten().$compact(),d(c["$[]"]("jumpline"))||(Z=[]),tt=L.color_default,_(Z,"each",[],(N=function(e){N.$$s;return null==e&&(e=u),J=[tt],_(e,"color=",t.to_a(J)),J[r(J.length,1)]},N.$$s=L,N.$$arity=1,N)),et=[],d(c["$[]"]("repeatsigns")["$[]"]("voices")["$include?"](c["$[]"]("voice_nr")))&&(et=_(_(n,"select",[],(C=function(e){var r;C.$$s;return null==e&&(e=u),d(r=e["$is_a?"](t.const_get_relative(it,"Goto")))?e.$policy()["$[]"]("is_repeat"):r},C.$$s=L,C.$$arity=1,C)),"map",[],(I=function(t){var e=I.$$s||this,r=u,n=u;return null==t&&(t=u),r=e.$make_repeatsign_annotation(t,"begin",s,c,M),n=e.$make_repeatsign_annotation(t,"end",s,c,M),[n,r]},I.$$s=L,I.$$arity=1,I)).$flatten()),rt=_(_(n,"select",[],(O=function(e){O.$$s;return null==e&&(e=u),e["$is_a?"](t.const_get_relative(it,"NoteBoundAnnotation"))},O.$$s=L,O.$$arity=1,O)),"map",[],(P=function(n){var a,i,o=P.$$s||this,l=u,f=u,$=u,h=u,g=u,m=u,v=u,y=u;return null==n&&(n=u),l=e(n.$conf_key(),".pos"),f=c["$[]"]("print_options_raw").$get(e(n.$conf_key(),".show")),$=function(){return!!d(f["$nil?"]())||f}(),d(l)?(h="extract."+s+"."+l,g=function(){try{return c["$[]"]("print_options_raw").$get(l)}catch(e){if(!t.rescue(e,[t.const_get_relative(it,"StandardError")]))throw e;try{return u}finally{t.pop_exception()}}}(),d(g)||(g=n.$position())):(g=n.$position(),h=u),m=d(a=c["$[]"]("print_options_raw").$get(e(n.$conf_key(),".style")))?a:n.$style(),v=e(o.$Vector2d(n.$companion().$sheet_drawable().$center()),g),y=_(t.const_get_qualified(t.const_get_qualified(t.const_get_relative(it,"Harpnotes"),"Drawing"),"Annotation").$new(v.$to_a(),n.$text(),m,n.$companion().$origin(),h,g),"tap",[],(i=function(e){i.$$s;return null==e&&(e=u),J=[p(["handler"],{handler:"annotation"})],_(e,"draginfo=",t.to_a(J)),J[r(J.length,1)]},i.$$s=o,i.$$arity=1,i)),d((a=n.$policy()["$=="]("Goto"))?c["$[]"]("jumpline")["$!"]():n.$policy()["$=="]("Goto"))&&(y=u),$["$=="](!1)&&(y=u),y},P.$$s=L,P.$$arity=1,P)),e(e(e(e(e(e(e(e(e(e(G,Y),K),X),F),q),R),j),Z),rt),et).$compact()},I.$$arity=4),t.defn(nt,"$make_decorations_per_playable",O=function(a,o,s,c,l){var f,$,h=this,g=u,m=u,v=u,y=u,b=u;return g=u,g=a.$decorations(),d(g["$empty?"]())||(m=function(){return d(a.$measure_start())?2:1}(),v=.8,y=_(o.$size(),"map",[],(f=function(t){f.$$s;return null==t&&(t=u),i(t,v)},f.$$s=h,f.$$arity=1,f)),b=[],_(g,"each_with_index",[],($=function(i,f){var h,g=$.$$s||this,w=u,x=u,A=u,k=u,E=u;return null==i&&(i=u),null==f&&(f=u),w="notebound.decoration.v_"+l+".t_"+a.$znid()+"."+f+".pos",x="extract."+s+"."+w,A=function(){try{return c["$[]"]("print_options_raw")["$[]"](w)}catch(e){if(!t.rescue(e,[t.const_get_relative(it,"StandardError")]))throw e;try{return u}finally{t.pop_exception()}}}(),d(A)||(A=[0,r(n(o.$size().$last()["$-@"](),v),m).$round()]),k=[e(o.$center().$first(),A.$first()),e(o.$center().$last(),A.$last())],E=t.const_get_qualified(t.const_get_qualified(t.const_get_relative(it,"Harpnotes"),"Drawing"),"Glyph").$new(k,y,i,!1,u,x,A),_(E,"tap",[],(h=function(e){var n=(h.$$s,u);return null==e&&(e=u),n=[p(["handler"],{handler:"annotation"})],_(e,"draginfo=",t.to_a(n)),n[r(n.length,1)]},h.$$s=g,h.$$arity=1,h)),b.$push([E])},$.$$s=h,$.$$arity=2,$))),b},O.$$arity=5),t.defn(nt,"$make_repeatsign_annotation",P=function(n,a,i,o,c){var l,f,$=this,h=u,g=u,m=u,v=u,y=u,b=u,w=u,x=u,A=u,k=u;return d(l=n.$policy()["$[]"]("from_anchor"))?l:"after",d(l=n.$policy()["$[]"]("to_anchor"))?l:"before",a["$=="]("begin")?(h=n.$to(),g=n.$to()["$=="](n.$from())?"left":function(){return d(s(h.$pitch(),h.$next_pitch()))?"left":"right"}()):(h=n.$from(),g=n.$to()["$=="](n.$from())?"right":function(){return d(s(h.$prev_pitch(),h.$pitch()))?"right":"left"}()),m="notebound.repeat_"+a.$to_s()+".v_"+c+"."+h.$znid(),v=m+".pos",y="extract."+i+"."+v,b=o["$[]"]("repeatsigns")["$[]"](g),w=function(){try{return o["$[]"]("print_options_raw")["$[]"](v)}catch(e){if(!t.rescue(e,[t.const_get_relative(it,"StandardError")]))throw e;try{return u}finally{t.pop_exception()}}}(),d(w)||(w=b["$[]"]("pos")),x=d(l=o["$[]"]("print_options_raw")["$[]"](m+".text"))?l:b["$[]"]("text"),A=d(l=o["$[]"]("print_options_raw")["$[]"](m+".style"))?l:b["$[]"]("style"),k=e($.$Vector2d(h.$sheet_drawable().$center()),w),_(t.const_get_qualified(t.const_get_qualified(t.const_get_relative(it,"Harpnotes"),"Drawing"),"Annotation").$new(k.$to_a(),x,A,h.$origin(),y,w),"tap",[],(f=function(e){var n=(f.$$s,u);return null==e&&(e=u),n=[p(["handler"],{handler:"annotation"})],_(e,"draginfo=",t.to_a(n)),n[r(n.length,1)]},f.$$s=$,f.$$arity=1,f))},P.$$arity=5),nt.$private(),t.defn(nt,"$compute_vertical_cut",L=function(t,n){var a,i=u,o=u,s=u,c=u,l=u;return null==h.conf&&(h.conf=u),i=d(a=h.conf["$[]"]("layout.jumpline_vcut"))?a:0,o=r([t.$origin().$prev_playable(),t.$origin().$next_playable()],[t.$origin()]),s=r([n.$origin().$prev_playable(),n.$origin().$next_playable()],[n.$origin()]),c=[t.$origin(),n.$origin()].$compact(),l=e(o,s)["$&"](c),d(l["$empty?"]())||(i=0),i},L.$$arity=2),t.defn(nt,"$layout_barnumbers_countnotes",M=function(n,a,i,o){var s,c,l,f,$=this,g=u,m=u,v=u,y=u,b=u,w=u,x=u,A=u,k=u,E=u,S=u,N=u,C=u,I=u,O=u,P=u,L=u,M=u,T=u,B=u,j=u,F=u;return null==h.conf&&(h.conf=u),g=h.conf["$[]"]("layout.limit_a3")["$=="](!0),m=h.conf["$[]"]("layout.bottomup")["$=="](!0),v=i["$[]"]("countnotes"),y=i["$[]"]("barnumbers"),b=[],w=[],d(d(s=v)?s:y)&&(x=_(n,"select",[],(c=function(t){c.$$s;return null==t&&(t=u),t["$visible?"]()},c.$$s=$,c.$$arity=1,c)),d(v)&&(A=v["$[]"]("style"),s=[1,1],s[0],k=s[1],E=v["$[]"]("apanchor"),S=v["$[]"]("autopos"),N=v["$[]"]("pos"),l=v["$[]"]("apbase"),s=t.to_ary(l),C=null==s[0]?u:s[0],I=null==s[1]?u:s[1]),d(y)&&(O=y["$[]"]("style"),s=[2.7,2.7],s[0],P=s[1],L=y["$[]"]("apanchor"),M=y["$[]"]("autopos"),T=y["$[]"]("pos"),l=y["$[]"]("apbase"),s=t.to_ary(l),B=null==s[0]?u:s[0],j=null==s[1]?u:s[1],F=y["$[]"]("prefix")),_(x,"each",[],(f=function(n){var i,s,c,l,$=f.$$s||this,h=u,x=u,R=u,q=u,D=u,z=u,U=u,H=u,G=u,Y=u,V=u,Q=u,X=u,J=u,W=u,K=u,Z=u,tt=u,et=u,rt=u,nt=u,at=u,ot=u,st=u,ct=u,lt=u,ut=u,ft=u,$t=u,_t=u,dt=u,pt=u;return null==$.print_options_keys&&($.print_options_keys=u),null==$.print_options_raw&&($.print_options_raw=u),null==n&&(n=u),h=n.$sheet_drawable(),x=h.$center(),s=x,i=t.to_ary(s),R=null==i[0]?u:i[0],null==i[1]?u:i[1],s=h.$size(),i=t.to_ary(s),q=null==i[0]?u:i[0],D=null==i[1]?u:i[1],s=h.$size_with_dot(),i=t.to_ary(s),z=null==i[0]?u:i[0],null==i[1]?u:i[1],s=n.$prev_playable().$sheet_drawable().$center(),i=t.to_ary(s),U=null==i[0]?u:i[0],null==i[1]?u:i[1],s=n.$next_playable().$sheet_drawable().$center(),i=t.to_ary(s),H=null==i[0]?u:i[0],null==i[1]?u:i[1],s=function(){return d(m)?$.$compute_note_position(H,R,U,g).$reverse():$.$compute_note_position(U,R,H,g)}(),i=t.to_ary(s),G=null==i[0]?u:i[0],Y=null==i[1]?u:i[1],d(v)&&(V="notebound.countnote.v_"+o+".t_"+n.$time(),Q=V+".pos",X=V+".align",J=d(i=n.$count_note())?i:"",W=function(){return d("center"["$=="](E))?0:D}(),d($.print_options_keys["$include?"](Q))&&(K=$.print_options_raw["$[]"](Q)),d(d(i=$.print_options_keys["$include?"](X))?$.print_options_raw["$[]"](X)["$!="]("auto"):i)&&(Y=$.print_options_raw["$[]"](X)),Z=function(){return S["$=="](!0)&&d(Y["$=="]("l"))?"right":"left"}(),d(K)||(S["$=="](!0)?(tt=function(){return d((i=Y["$=="]("r"))?n["$tie_start?"]():Y["$=="]("r"))?1.5:0}(),et=e(tt,function(){return Y["$=="]("l")?e(q,C)["$-@"]():e(z,C)}()),rt=function(){return d(m)?e(e(W,I),k)["$-@"]():e(W,I)}(),K=[et,rt]):K=N),nt=e($.$Vector2d(x),K),b.$push(_(t.const_get_qualified(t.const_get_qualified(t.const_get_relative(it,"Harpnotes"),"Drawing"),"Annotation").$new(nt.$to_a(),J,A,n.$origin(),"extract."+a+"."+Q,K),"tap",[],(c=function(e){var n=(c.$$s,u);return null==e&&(e=u),n=[Z],_(e,"align=",t.to_a(n)),n[r(n.length,1)],n=[p(["handler"],{handler:"annotation"})],_(e,"draginfo=",t.to_a(n)),n[r(n.length,1)],e.$more_conf_keys().$push(p(["conf_key","text","icon","value"],{conf_key:"extract."+a+"."+X,text:t.const_get_relative(it,"I18n").$t("countnote left"),icon:"fa fa-arrow-left",value:"l"})),e.$more_conf_keys().$push(p(["conf_key","text","icon","value"],{conf_key:"extract."+a+"."+X,text:t.const_get_relative(it,"I18n").$t("countnote right"),icon:"fa fa-arrow-right",value:"r"}))},c.$$s=$,c.$$arity=1,c)))),d(d(i=y)?n["$measure_start?"]():i)?(V="notebound.countnote.v_"+o+".t_"+n.$time(),Q=V+".pos",X=V+".align","extract."+a+"."+V,J=d(i=n.$count_note())?i:"",at="notebound.barnumber.v_"+o+".t_"+n.$time(),ot=at+".pos",st=at+".align","extract."+a+"."+ot,ct=d(i=""+F+n.$measure_count().$to_s())?i:"",lt=function(){return d("center"["$=="](L))?0:D}(),d($.print_options_keys["$include?"](ot))&&(ut=$.print_options_raw["$[]"](ot)),d(d(i=$.print_options_keys["$include?"](st))?$.print_options_raw["$[]"](st)["$!="]("auto"):i)&&(G=$.print_options_raw["$[]"](st)),ft=function(){return M["$=="](!0)&&d(G["$=="]("l"))?"right":"left"}(),d(ut)||(M["$=="](!0)?($t=function(){return d((i=G["$=="]("r"))?n["$tie_start?"]():G["$=="]("r"))?1:0}(),_t=e($t,function(){return G["$=="]("l")?e(q,B)["$-@"]():e(z,B)}()),dt=function(){return d(m)?e(lt,j):e(e(lt,j),P)["$-@"]()}(),ut=[_t,dt]):ut=T),pt=e($.$Vector2d(x),ut),w.$push(_(t.const_get_qualified(t.const_get_qualified(t.const_get_relative(it,"Harpnotes"),"Drawing"),"Annotation").$new(pt.$to_a(),ct,O,n.$origin(),"extract."+a+"."+ot,ut),"tap",[],(l=function(e){var n=(l.$$s,u);return null==e&&(e=u),n=[ft],_(e,"align=",t.to_a(n)),n[r(n.length,1)],n=[p(["handler"],{handler:"annotation"})],_(e,"draginfo=",t.to_a(n)),n[r(n.length,1)],e.$more_conf_keys().$push(p(["conf_key","text","icon","value"],{conf_key:"extract."+a+"."+st,text:t.const_get_relative(it,"I18n").$t("barnumber left"),icon:"fa fa-arrow-left",value:"l"})),e.$more_conf_keys().$push(p(["conf_key","text","icon","value"],{conf_key:"extract."+a+"."+st,text:t.const_get_relative(it,"I18n").$t("barnumber right"),icon:"fa fa-arrow-right",value:"r"}))},l.$$s=$,l.$$arity=1,l)))):u},f.$$s=$,f.$$arity=1,f))),[w,b]},M.$$arity=4),t.defn(nt,"$compute_beat_compression",T=function(t,e){var r,n=this,a=u;return null==h.conf&&(h.conf=u),h.conf.$get("layout.packer.pack_method")["$=="](1)&&(a=n.$compute_beat_compression_1(t,e)),h.conf.$get("layout.packer.pack_method")["$=="](2)&&(a=n.$compute_beat_compression_2(t,e)),h.conf.$get("layout.packer.pack_method")["$=="](10)&&(a=n.$compute_beat_compression_10(t,e)),(d(r=h.conf.$get("layout.packer.pack_method"))?r:0)["$=="](0)&&(a=n.$compute_beat_compression_0(t,e)),a},T.$$arity=2),t.defn(nt,"$compute_beat_compression_2",B=function(e,n){var a,o,s,c,l,f,$,d=this,h=u,g=u,m=u,v=u;return h=p([],{}),g=_(_(_(n,"map",[],(a=function(t){a.$$s;return null==t&&(t=u),e.$voices()["$[]"](t)},a.$$s=d,a.$$arity=1,a)),"inject",[[]],(o=function(t,e){o.$$s;return null==t&&(t=u),null==e&&(e=u),t.$push(e)},o.$$s=d,o.$$arity=2,o)).$flatten(),"select",[],(s=function(e){s.$$s;return null==e&&(e=u),e["$is_a?"](t.const_get_qualified(t.const_get_qualified(t.const_get_relative(it,"Harpnotes"),"Music"),"Playable"))},s.$$s=d,s.$$arity=1,s)),m=_(_(g,"select",[],(c=function(e){c.$$s;return null==e&&(e=u),e["$is_a?"](t.const_get_qualified(t.const_get_qualified(t.const_get_relative(it,"Harpnotes"),"Music"),"SynchPoint"))},c.$$s=d,c.$$arity=1,c)),"map",[],(l=function(t){l.$$s;return null==t&&(t=u),t.$notes()},l.$$s=d,l.$$arity=1,l)),g=g.$push(m).$flatten(),v=_(g,"group_by",[],(f=function(t){f.$$s;return null==t&&(t=u),t.$beat()},f.$$s=d,f.$$arity=1,f)),_(v.$keys().$sort(),"each",[],($=function(e){var n=($.$$s,u);return null==e&&(e=u),n=[e,i(e,8)],_(h,"[]=",t.to_a(n)),n[r(n.length,1)]},$.$$s=d,$.$$arity=1,$)),h},B.$$arity=2),t.defn(nt,"$compute_beat_compression_10",j=function(r,a){var i,o,s,c,l=this,f=u,$=u,p=u,g=u,m=u;return null==h.conf&&(h.conf=u),_(r.$beat_maps(),"map",[],(i=function(t){i.$$s;return null==t&&(t=u),t.$keys().$max()},i.$$s=l,i.$$arity=1,i)).$max(),f=0,$=0,p=_(a,"inject",[[]],(o=function(t,e){o.$$s;return null==t&&(t=u),null==e&&(e=u),t.$push(r.$beat_maps()["$[]"](e))},o.$$s=l,o.$$arity=2,o)).$compact(),g=_(r.$beat_maps(),"inject",[[]],(s=function(t,e){s.$$s;return null==t&&(t=u),null==e&&(e=u),t.$push(e.$keys()),t},s.$$s=l,s.$$arity=2,s)).$flatten().$uniq().$sort(),m=h.conf.$get("layout.DURATION_TO_STYLE"),t.const_get_relative(it,"Hash")["$[]"](_(g,"map",[],(c=function(r){var a,i,o,s,l=c.$$s||this,g=u,v=u,y=u,b=u,w=u,x=u,A=u;if(null==l.conf_beat_resolution&&(l.conf_beat_resolution=u),null==h.log&&(h.log=u),null==r&&(r=u),g=_(p,"map",[],(a=function(t){a.$$s;return null==t&&(t=u),t["$[]"](r)},a.$$s=l,a.$$arity=1,a)).$flatten().$compact(),v=_(g,"map",[],(i=function(t){i.$$s;return null==t&&(t=u),t.$duration()},i.$$s=l,i.$$arity=1,i)).$max(),y=g["$empty?"](),b=_(g,"select",[],(o=function(t){o.$$s;return null==t&&(t=u),t["$first_in_part?"]()},o.$$s=l,o.$$arity=1,o)),w=_(g,"select",[],(s=function(t){s.$$s;return null==t&&(t=u),t["$measure_start?"]()},s.$$s=l,s.$$arity=1,s)).$first(),d(y));else{try{x=l.conf_beat_resolution*m["$[]"](l.$duration_to_id(v)).$first()}catch(e){if(!t.rescue(e,[t.const_get_relative(it,"Exception")]))throw e;e;try{h.log.$error("BUG: unsupported duration: "+v+" on beat "+r+",  "+g.$to_json())}finally{t.pop_exception()}}A=n(e(x,$),2),$=x,d(w)&&(A=e(A,n(A,4))),d(b["$empty?"]())||(A=e(A,A)),A=e(A,l.$get_minc_factor(g.$first().$time(),A)),f=e(f,A)}return[r,f]},c.$$s=l,c.$$arity=1,c)))},j.$$arity=2),t.defn(nt,"$get_minc_factor",F=function(e,r){var n=this,a=u;if(null==r&&(r=n.conf_beat_resolution),a=n.layout_minc["$[]"](e.$to_s()),!d(a))return 0;try{return i(a["$[]"]("minc_f"),r)}catch(e){if(!t.rescue(e,[t.const_get_relative(it,"StandardError")]))throw e;try{return 0}finally{t.pop_exception()}}},F.$$arity=-2),t.defn(nt,"$compute_beat_compression_0",R=function(a,o){var s,c,l,f,$,g,m,v,y=this,b=u,w=u,x=u,A=u,k=u,E=u,S=u;return null==h.conf&&(h.conf=u),b=h.conf.$get("layout.DURATION_TO_STYLE"),i(d(s=h.conf.$get("layout.packer.pack_min_increment"))?s:0,y.conf_beat_resolution),w=0,x=p([],{}),A=0,k=_(_(_(o,"map",[],(c=function(t){c.$$s;return null==t&&(t=u),a.$voices()["$[]"](t)},c.$$s=y,c.$$arity=1,c)),"inject",[[]],(l=function(t,e){l.$$s;return null==t&&(t=u),null==e&&(e=u),t.$push(e)},l.$$s=y,l.$$arity=2,l)).$flatten(),"select",[],(f=function(e){f.$$s;return null==e&&(e=u),e["$is_a?"](t.const_get_qualified(t.const_get_qualified(t.const_get_relative(it,"Harpnotes"),"Music"),"Playable"))},f.$$s=y,f.$$arity=1,f)),E=_(_(k,"select",[],($=function(e){$.$$s;return null==e&&(e=u),e["$is_a?"](t.const_get_qualified(t.const_get_qualified(t.const_get_relative(it,"Harpnotes"),"Music"),"SynchPoint"))},$.$$s=y,$.$$arity=1,$)),"map",[],(g=function(t){g.$$s;return null==t&&(t=u),t.$notes()},g.$$s=y,g.$$arity=1,g)),k=k.$push(E).$flatten(),S=_(k,"group_by",[],(m=function(t){m.$$s;return null==t&&(t=u),t.$beat()},m.$$s=y,m.$$arity=1,m)),_(S.$keys().$sort(),"each",[],(v=function(a){var i,o,s,c=v.$$s||this,l=u,f=u,$=u,p=u,g=u,m=u,y=u,k=u;null==c.conf_beat_resolution&&(c.conf_beat_resolution=u),null==h.log&&(h.log=u),null==a&&(a=u),l=S["$[]"](a),f=_(l,"map",[],(i=function(t){i.$$s;return null==t&&(t=u),t.$duration()},i.$$s=c,i.$$arity=1,i)).$max(),$=_(l,"select",[],(o=function(t){o.$$s;return null==t&&(t=u),t["$first_in_part?"]()},o.$$s=c,o.$$arity=1,o)),p=_(l,"select",[],(s=function(t){s.$$s;return null==t&&(t=u),t["$measure_start?"]()},s.$$s=c,s.$$arity=1,s));try{g=c.conf_beat_resolution*b["$[]"](c.$duration_to_id(f)).$first()}catch(e){if(!t.rescue(e,[t.const_get_relative(it,"Exception")]))throw e;e;try{h.log.$error("BUG: unsupported duration: "+f+" on beat "+a+",  "+c.$notes_on_beat().$to_json())}finally{t.pop_exception()}}return m=n(e(g,A),2),A=g,y=m,d($["$empty?"]())||(y=e(y,m)),d(p["$empty?"]())||(y=e(y,n(y,4))),y=e(y,c.$get_minc_factor(l.$first().$time(),m)),w=e(w,y),k=[a,w],_(x,"[]=",t.to_a(k)),k[r(k.length,1)]},v.$$s=y,v.$$arity=1,v)),x},R.$$arity=2),t.defn(nt,"$compute_beat_compression_1",q=function(a,o){var s,l,f,$,g,m,v,y,b=this,w=u,x=u,A=u,k=u,E=u,S=u,N=u,C=u,I=u,O=u;return null==h.conf&&(h.conf=u),w=h.conf.$get("layout.DURATION_TO_STYLE"),x=i(d(s=h.conf.$get("layout.packer.pack_min_increment"))?s:0,b.conf_beat_resolution),A=p([],{}),k=p([],{}),E=0,S=0,N=0,C=_(_(_(o,"map",[],(l=function(t){l.$$s;return null==t&&(t=u),a.$voices()["$[]"](t)},l.$$s=b,l.$$arity=1,l)),"inject",[[]],(f=function(t,e){f.$$s;return null==t&&(t=u),null==e&&(e=u),t.$push(e)},f.$$s=b,f.$$arity=2,f)).$flatten(),"select",[],($=function(e){$.$$s;return null==e&&(e=u),e["$is_a?"](t.const_get_qualified(t.const_get_qualified(t.const_get_relative(it,"Harpnotes"),"Music"),"Playable"))},$.$$s=b,$.$$arity=1,$)),I=_(_(C,"select",[],(g=function(e){g.$$s;return null==e&&(e=u),e["$is_a?"](t.const_get_qualified(t.const_get_qualified(t.const_get_relative(it,"Harpnotes"),"Music"),"SynchPoint"))},g.$$s=b,g.$$arity=1,g)),"map",[],(m=function(t){m.$$s;return null==t&&(t=u),t.$notes()},m.$$s=b,m.$$arity=1,m)),C=C.$push(I).$flatten(),O=_(C,"group_by",[],(v=function(t){v.$$s;return null==t&&(t=u),t.$beat()},v.$$s=b,v.$$arity=1,v)),_(O.$keys().$sort(),"each",[],(y=function(a){var i,o,s,l,f,$,p=y.$$s||this,g=u,m=u,v=u,b=u,C=u,I=u,P=u,L=u,M=u,T=u;null==p.conf_beat_resolution&&(p.conf_beat_resolution=u),null==h.log&&(h.log=u),null==a&&(a=u),g=O["$[]"](a),m=_(g,"map",[],(i=function(t){i.$$s;return null==t&&(t=u),t.$duration()},i.$$s=p,i.$$arity=1,i)).$max();try{v=p.conf_beat_resolution*w["$[]"](p.$duration_to_id(m)).$first()}catch(e){if(!t.rescue(e,[t.const_get_relative(it,"Exception")]))throw e;e;try{h.log.$error("BUG: unsupported duration: "+m+" on beat "+a+",  "+p.$notes_on_beat().$to_json())}finally{t.pop_exception()}}return b=n(e(v,N),2),N=v,C=_(g,"select",[],(o=function(t){var e;o.$$s;return null==t&&(t=u),c(d(e=A["$[]"](t.$pitch()))?e:-1,r(E,x))},o.$$s=p,o.$$arity=1,o)),I=_(g,"select",[],(s=function(t){var e,r=(s.$$s,u),n=u;return null==t&&(t=u),r=[d(e=t.$prev_pitch())?e:t.$pitch(),t.$pitch(),d(e=t.$next_pitch())?e:t.$pitch()],n=(d(e=r.$sort().$reverse()["$=="](r))?e:r.$sort()["$=="](r))["$!"](),d(t.$next_first_in_part())&&(n=!1),n},s.$$s=p,s.$$arity=1,s)),P=_(g,"select",[],(l=function(t){l.$$s;return null==t&&(t=u),t["$first_in_part?"]()},l.$$s=p,l.$$arity=1,l)),L=_(g,"select",[],(f=function(t){f.$$s;return null==t&&(t=u),t["$measure_start?"]()},f.$$s=p,f.$$arity=1,f)),M=S,S=x,d(C["$empty?"]()["$!"]())?M=b:d(I["$empty?"]()["$!"]())&&(S=n(b,2),M=S),d(P["$empty?"]())||(M=e(M,b),S=x),d(L["$empty?"]())||(M=e(M,n(M,4))),M=e(M,p.$get_minc_factor(g.$first().$time(),b)),E=e(E,M),_(g,"each",[],($=function(e){var n=($.$$s,u);return null==e&&(e=u),n=[e.$pitch(),E],_(A,"[]=",t.to_a(n)),n[r(n.length,1)]},$.$$s=p,$.$$arity=1,$)),T=[a,E],_(k,"[]=",t.to_a(T)),T[r(T.length,1)]},y.$$s=b,y.$$arity=1,y)),k},q.$$arity=2),t.defn(nt,"$layout_playable",D=function(e,r,n){var a=this;return null==h.log&&(h.log=u),function(){return d(e["$is_a?"](t.const_get_relative(it,"Note")))?a.$layout_note(e,r,n+".n_0"):d(e["$is_a?"](t.const_get_relative(it,"SynchPoint")))?a.$layout_accord(e,r,n):d(e["$is_a?"](t.const_get_relative(it,"Pause")))?a.$layout_pause(e,r,n+".n_0"):h.log.$error("BUG: Missing Music -> Sheet transform: "+e)}()},D.$$arity=3),t.defn(nt,"$layout_note",z=function(a,i,o){var s,c,l=this,f=u,$=u,p=u,g=u,m=u,v=u,y=u,b=u,w=u,x=u,A=u,k=u,E=u;return null==h.conf&&(h.conf=u),f=l.$convert_pitch_to_xpos(a),$=i.$call(a.$beat()),c=l.$compute_ellipse_properties_from_note(a),s=t.to_ary(c),p=null==s[0]?u:s[0],g=null==s[1]?u:s[1],m=null==s[2]?u:s[2],v=null==s[3]?u:s[3],y=l.$layout_note_shift(a,m,f,p,o),b=l.$compute_color_by_variant_no(a.$variant()),w=t.const_get_relative(it,"Ellipse").$new([e(f,y),$],m,g,p,a),x=[e(o,".***")],_(w,"conf_key=",t.to_a(x)),x[r(x.length,1)],x=[w],_(a,"sheet_drawable=",t.to_a(x)),x[r(x.length,1)],x=[b],_(w,"color=",t.to_a(x)),x[r(x.length,1)],x=[h.conf.$get("layout.LINE_THICK")],_(w,"line_width=",t.to_a(x)),x[r(x.length,1)],A=t.const_get_relative(it,"CompoundDrawable").$new([w],w),d(v)&&A.$push(l.$layout_note_flags(f,$,m,y,b,v)),d(a.$measure_start())&&(k=e(m.$last(),h.conf.$get("layout.LINE_THICK")),d(h.conf.$get("layout.bottomup"))&&(k=k["$-@"]()),E=function(){return d(d(s=v)?h.conf.$get("layout.bottomup")["$!"]():s)?h.conf.$get("layout.LINE_THICK"):0}(),w=t.const_get_relative(it,"Ellipse").$new([r(e(f,y),E),r($,k)],[r(m.$first(),E),n(h.conf.$get("layout.LINE_THICK"),2)],"filled",!1,u,!0),x=[b],_(w,"color=",t.to_a(x)),x[r(x.length,1)],x=[h.conf.$get("layout.LINE_THIN")],_(w,"line_width=",t.to_a(x)),x[r(x.length,1)],A.$push(w)),A},z.$$arity=3),t.defn(nt,"$layout_note_flags",U=function(a,o,s,c,l,f){var $,d,p,g=this,m=u,v=u,y=u,b=u,w=u,x=u,A=u,k=u,E=u,S=u,N=u,C=u,I=u;return null==h.conf&&(h.conf=u),g.instrument_orientation["$=="]("horizontal")?($=[i(2,s["$[]"](1)),.1],m=$[0],v=$[1],y=h.conf.$get("layout.LINE_MEDIUM"),b=e(a,n(c,2)),w=r(e(o,s["$[]"](1)),n(y,2)),x=[["M",b,w],["l",m,v]],$=[i(-.6,s["$[]"](0)),i(.6,s["$[]"](1))],A=$[0],k=$[1],E=A,S=function(){try{return n(i(v,E),m)}catch(e){if(!t.rescue(e,[t.const_get_relative(it,"StandardError")]))throw e;try{return 0}finally{t.pop_exception()}}}(),N=["l",A,k],_(f,"times",[],(d=function(t){d.$$s;return null==t&&(t=u),x=e(x,[["M",e(e(b,m),i(t,E)),e(w,v)],N])},d.$$s=g,d.$$arity=1,d))):($=[.1,i(2,s["$[]"](1))],m=$[0],v=$[1],y=h.conf.$get("layout.LINE_MEDIUM"),b=r(e(e(a,c),s["$[]"](0)),n(y,2)),w=o,x=[["M",b,w],["l",m,v["$-@"]()]],$=[i(1.3,s["$[]"](1)),i(.6,s["$[]"](1))],A=$[0],k=$[1],S=k,E=function(){try{return n(i(m,S),v)}catch(e){if(!t.rescue(e,[t.const_get_relative(it,"StandardError")]))throw e;try{return 0}finally{t.pop_exception()}}}(),N=["l",A,k],_(f,"times",[],(p=function(t){p.$$s;return null==t&&(t=u),x=e(x,[["M",r(e(b,m),i(t,E)),e(r(o,v),i(t,S))],N])},p.$$s=g,p.$$arity=1,p))),C=t.const_get_qualified(t.const_get_qualified(t.const_get_relative(it,"Harpnotes"),"Drawing"),"Path").$new(x,"open"),I=[y],_(C,"line_width=",t.to_a(I)),I[r(I.length,1)],I=[l],_(C,"color=",t.to_a(I)),I[r(I.length,1)],C},U.$$arity=6),t.defn(nt,"$convert_pitch_to_xpos",H=function(t){return this.pitch_to_xpos.$call(t.$pitch())},H.$$arity=1),t.defn(nt,"$compute_color_by_variant_no",G=function(t){var e=this;return t["$=="](0)?e.color_default:function(){return d(t["$odd?"]())?e.color_variant1:e.color_variant2}()},G.$$arity=1),t.defn(nt,"$compute_ellipse_properties_from_note",Y=function(e){var r,n,a,o=this,s=u,c=u,l=u,f=u,$=u;return null==h.conf&&(h.conf=u),n=h.conf.$get("layout.DURATION_TO_STYLE")["$[]"](o.$check_duration(e)),r=t.to_ary(n),s=null==r[0]?u:r[0],
c=null==r[1]?u:r[1],l=null==r[2]?u:r[2],f=null==r[3]?u:r[3],$=_(h.conf.$get("layout.ELLIPSE_SIZE"),"map",[],(a=function(t){a.$$s;return null==t&&(t=u),i(t,s)},a.$$s=o,a.$$arity=1,a)),[l,c,$,f]},Y.$$arity=1),t.defn(nt,"$layout_note_shift",V=function(t,n,s,c,l){var f=this,$=u,_=u,p=u;return null==h.conf&&(h.conf=u),$=0,d(h.conf.$get("layout.limit_a3"))&&(d(o(s,5))&&($=e($,n.$first())),d(a(s,415))&&($=e($,n.$first()["$-@"]()),d(c)&&($=r($,1.5)))),d(t.$shift())&&($=t.$shift()["$[]"]("dir")["$=="](-1)?e($,n.$first()["$-@"]()):e($,n.$first())),d(l)&&(_=l.$gsub(/extract\.(\d+)\./,""),d(f.print_options_keys["$include?"](_+".nshift"))&&(p=f.print_options_raw["$[]"](_+".nshift"),$=i(i(n.$first(),2),p))),$},V.$$arity=5),t.defn(nt,"$layout_accord",Q=function(e,r,n){var a,i,o,s,c=this,l=u,f=u,$=u;return l=_(e.$notes().$reverse().$each_with_index(),"map",[],(a=function(t,e){var i=a.$$s||this;return null==t&&(t=u),null==e&&(e=u),i.$layout_note(t,r,n+".n_"+e)},a.$$s=c,a.$$arity=2,a)).$reverse(),f=e.$get_proxy_object(l).$proxy(),$=_(_(l,"map",[],(i=function(t){i.$$s;return null==t&&(t=u),t.$proxy()},i.$$s=c,i.$$arity=1,i)),"sort_by",[],(o=function(t){o.$$s;return null==t&&(t=u),t.$center().$first()},o.$$s=c,o.$$arity=1,o)),l=_(l,"map",[],(s=function(t){s.$$s;return null==t&&(t=u),t.$shapes()},s.$$s=c,s.$$arity=1,s)),l.$unshift(t.const_get_relative(it,"FlowLine").$new($.$first(),$.$last(),"dashed")),t.const_get_relative(it,"CompoundDrawable").$new(l,f)},Q.$$arity=3),t.defn(nt,"$layout_pause",X=function(a,o,s){var c,l,f=this,$=u,p=u,g=u,m=u,v=u,y=u,b=u,w=u,x=u,A=u,k=u,E=u,S=u;return null==h.conf&&(h.conf=u),$=f.$convert_pitch_to_xpos(a),p=o.$call(a.$beat()),l=h.conf.$get("layout.REST_TO_GLYPH")["$[]"](f.$check_duration(a)),c=t.to_ary(l),g=null==c[0]?u:c[0],m=null==c[1]?u:c[1],v=null==c[2]?u:c[2],y=h.conf.$get("layout.REST_SIZE"),b=[i(y.$first(),g.$first()),i(y.$last(),g.$last())],w=f.$layout_note_shift(a,b,$,v,s),x=f.$compute_color_by_variant_no(a.$variant()),A=u,A=t.const_get_qualified(t.const_get_qualified(t.const_get_relative(it,"Harpnotes"),"Drawing"),"Glyph").$new([e($,w),p],b,m,v,a),k=[e(s,".***")],_(A,"conf_key=",t.to_a(k)),k[r(k.length,1)],k=[A],_(a,"sheet_drawable=",t.to_a(k)),k[r(k.length,1)],k=[x],_(A,"color=",t.to_a(k)),k[r(k.length,1)],k=[h.conf.$get("layout.LINE_THICK")],_(A,"line_width=",t.to_a(k)),k[r(k.length,1)],d(a["$visible?"]())||(k=[!1],_(A,"visible=",t.to_a(k)),k[r(k.length,1)]),E=t.const_get_relative(it,"CompoundDrawable").$new([A],A),d(a.$measure_start())&&(S=e(b.$last(),h.conf.$get("layout.LINE_THICK")),d(h.conf.$get("layout.bottomup"))&&(S=S["$-@"]()),A=t.const_get_relative(it,"Ellipse").$new([e($,w),r(p,S)],[b.$first(),n(h.conf.$get("layout.LINE_THICK"),2)],"filled",!1,u,!0),k=[x],_(A,"color=",t.to_a(k)),k[r(k.length,1)],k=[h.conf.$get("layout.LINE_THIN")],_(A,"line_width=",t.to_a(k)),k[r(k.length,1)],d(a["$visible?"]())||(k=[!1],_(A,"visible=",t.to_a(k)),k[r(k.length,1)]),E.$push(A)),E},X.$$arity=3),t.defs(nt,"$make_path_from_jumpline",J=function(n){var o,s,c=this,l=u,f=u,$=u,_=u,p=u,h=u,g=u,m=u,v=u,y=u,b=u,w=u,x=u,A=u,k=u,E=u,S=u,N=u,C=u,I=u,O=u,P=u,L=u,M=u,T=u,B=u,j=u,F=u,R=u,q=u,D=u,z=u,U=u;return s=n["$[]"]("jumpline_anchor"),o=t.to_ary(s),l=null==o[0]?u:o[0],f=null==o[1]?u:o[1],$=c.$Vector2d(n["$[]"]("from")["$[]"]("center")),_=e(c.$Vector2d(n["$[]"]("from")["$[]"]("size")),[l,f]),p=function(){return n["$[]"]("from")["$[]"]("anchor")["$=="]("before")?-1:1}(),h=c.$Vector2d(n["$[]"]("to")["$[]"]("center")),g=e(c.$Vector2d(n["$[]"]("to")["$[]"]("size")),[l,f]),m=function(){return n["$[]"]("to")["$[]"]("anchor")["$=="]("before")?-1:1}(),v=n["$[]"]("vertical"),y=n["$[]"]("verticalcut"),b=$,n["$[]"]("vertical_anchor")["$=="]("to")&&(b=h),w=c.$Vector2d(e(b.$x(),v),$.$y()),x=c.$Vector2d(e(b.$x(),v),h.$y()),A=c.$Vector2d(i(r(w,$),[1,0]).$normalize().$x(),0),k=c.$Vector2d(i(r(x,h),[1,0]).$normalize().$x(),0),E=c.$Vector2d(0,i(r(w,x),[0,1]).$normalize().$y()),S=i(_,[A.$x(),p]),N=i(g,[k.$x(),m]),w=e(w,i(S,[0,1])),x=e(x,i(N,[0,1])),C=e($,S),I=w,O=x,P=e(h,N),L=e(e(h,N),i(k,[2,0])),M=e(e(P,i(k,2.5)),[0,1]),T=r(e(P,i(k,2.5)),[0,1]),B=r(O.$y(),I.$y()),j=function(){return d(a(B,0))?y:y["$-@"]()}(),y["$=="](0)&&(j=B),F=e(I,[0,j]),R=e(F,E),q=r(O,[0,j]),D=e(e(F,i(E,1.5)),[.5,0]),z=r(e(F,i(E,1.5)),[.5,0]),U=y["$=="](0)?[]:[["M"].concat(t.to_a(F)),["l"].concat(t.to_a(r(D,F))),["l"].concat(t.to_a(r(z,D))),["l"].concat(t.to_a(r(F,z))),["z"]],[[["M"].concat(t.to_a(C)),["l"].concat(t.to_a(r(I,C))),["l"].concat(t.to_a(r(R,I))),["M"].concat(t.to_a(q)),["L"].concat(t.to_a(O)),["L"].concat(t.to_a(L))],[["M"].concat(t.to_a(P)),["l"].concat(t.to_a(r(M,P))),["l"].concat(t.to_a(r(T,M))),["l"].concat(t.to_a(r(P,T))),["z"]],U]},J.$$arity=1),t.defn(nt,"$duration_to_id",W=function(t){var e=u;return null==h.conf&&(h.conf=u),e=("d"+t).$to_sym(),d(h.conf.$get("layout.DURATION_TO_STYLE")["$[]"](e)["$nil?"]())&&(e="err"),e},W.$$arity=1),t.defn(nt,"$check_duration",K=function(t){var e=this,r=u;return null==h.log&&(h.log=u),r=e.$duration_to_id(t.$duration()),d(r["$==="]("err"))&&h.log.$error("unsupported duration at "+t.$start_pos_to_s(),t.$start_pos(),t.$end_pos()),r},K.$$arity=1),t.defn(nt,"$make_sheetmark_path",Z=function(t){var e,a=this,o=u,s=u,c=u,l=u,f=u;return o=.5,s=5,c=r(a.$Vector2d(t),[o,n(s,2)]),l=[a.$Vector2d(o,i(2,o)["$-@"]()),a.$Vector2d(o,i(2,o)),a.$Vector2d(0,s),a.$Vector2d(o["$-@"](),i(2,o)),a.$Vector2d(o["$-@"](),i(-2,o)),a.$Vector2d(0,s["$-@"]())],f=[["M",c.$x(),c.$y()]],_(l,"each",[],(e=function(t){e.$$s;return null==t&&(t=u),f["$<<"](["l",t.$x(),t.$y()])},e.$$s=a,e.$$arity=1,e)),f},Z.$$arity=1),t.defn(nt,"$make_slur_path",tt=function(t,n){var a=this,o=u,s=u,c=u,l=u;return o=r(n,t),s=a.$Vector2d(i(.3,o.$length()),0).$rotate(o.$angle()),c=s.$rotate(-.4),l=e(o,s.$reverse().$rotate(.4)),[["M",t.$x(),t.$y()],["c",c.$x(),c.$y(),l.$x(),l.$y(),o.$x(),o.$y()]]},tt.$$arity=2),t.defn(nt,"$make_annotated_bezier_path",et=function(a,o){var c,l=this,f=u,$=u,_=u,p=u,g=u,m=u,v=u,y=u,b=u,w=u,x=u,A=u,k=u,E=u,S=u,N=u,C=u,I=u,O=u,P=u,L=u;return null==h.log&&(h.log=u),f=a.$first(),$=a.$last(),_=r($,f),p=l.$Vector2d(o["$[]"]("cp1")),g=l.$Vector2d(o["$[]"]("cp2")),m=i(t.const_get_qualified(t.const_get_relative(it,"Math"),"PI"),-.5),v=p.$rotate(_.$angle()).$rotate(m),y=g.$rotate(_.$angle()).$rotate(m),y=e(_,y),h.log.$debug(v.$to_s()+" - "+y.$to_s()),b=e(f,v),w=e(f,y),x=n(e(f,b),2),A=n(e($,w),2),k=n(e(b,w),2),E=n(e(x,k),2),S=n(e(A,k),2),N=E["$=="](S)?l.$Vector2d([0,0]):r(E,S).$perpendicular().$normalize(),C=d(d(c=s(b.$x(),f.$x()))?s(f.$x(),$.$x()):c)?r(e(n(e(E,S),2),i(N,-2)),[2,0]):e(n(e(E,S),2),i(N,2)),C=e(C,[0,-2]),I=[["M",f.$x(),f.$y()]],O=[["c",v.$x(),v.$y(),y.$x(),y.$y(),_.$x(),_.$y()]],P=[["l",v.$x(),v.$y()],["L",w.$x(),w.$y()],["L",$.$x(),$.$y()]],L=[],d(o["$[]"]("shape")["$include?"]("c"))&&(L=e(L,e(I,O))),d(o["$[]"]("shape")["$include?"]("l"))&&(L=e(L,e(I,P))),[L,C,b,w]},et.$$arity=2),t.defn(nt,"$resolve_placeholder",rt=function(e,r){var n,a=this,i=u,o=u;return i=e,o=i.$scan(/\{\{([^\}]+)\}\}/),_(o,"each",[],(n=function(a){var o=n.$$s||this,s=u;return null==o.placeholders&&(o.placeholders=u),null==h.log&&(h.log=u),null==a&&(a=u),s=o.placeholders["$[]"](a.$first()),d(s)?(e=s.$call(),d(e)||(h.log.$error(t.const_get_relative(it,"I18n").$t("no placeholder value found in ")+" in '"+r+"': '"+a.$first()+"'"),e=""),i=i.$gsub("{{"+a+"}}",e)):h.log.$error(t.const_get_relative(it,"I18n").$t("wrong placeholder: ")+" in '"+r+"': '"+a.$first()+"'")},n.$$s=a,n.$$arity=1,n)),i},rt.$$arity=2)}(w[0],0,w)}(w[0],w)}(l[0],l)},Opal.modules.abc_to_harpnotes_factory=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}var n=(t.top,[]),a=t.nil,i=(t.breaker,t.slice,t.module),o=t.klass,s=t.gvars,c=t.truthy,l=t.hash2,u=t.send;return t.add_stubs(["$===","$new","$error","$split","$[]","$count","$length","$last","$each","$match","$parse","$[]=","$-","$first","$<<","$message","$+","$inject","$each_with_index","$include?","$t","$strip","$==","$get_metadata","$map","$select","$nil?","$join","$compact","$flatten"]),function(n,f){var $,_=$=i(n,"Harpnotes"),d=(_.$$proto,[_].concat(f));!function(n,f){var $,_=$=i(n,"Input"),d=(_.$$proto,[_].concat(f));!function(e,r,n){function i(){}var c,l=i=o(e,null,"ABCToHarpnotesFactory",i),u=(l.$$proto,[l].concat(n));t.defs(l,"$create_engine",c=function(e){var r=a,n=a;return null==s.log&&(s.log=a),r=e,"ABC2SVG"["$==="](r)?n=t.const_get_qualified(t.const_get_qualified(t.const_get_relative(u,"Harpnotes"),"Input"),"Abc2svgToHarpnotes").$new():(s.log.$error("Undefined abc parser: "+e),n=t.const_get_qualified(t.const_get_qualified(t.const_get_relative(u,"Harpnotes"),"Input"),"Abc2svgToHarpnotes").$new()),n},c.$$arity=1)}(d[0],0,d),function(n,i,f){function $(){}var _,d,p,h,g,m=$=o(n,null,"AbstractAbcToHarpnotes",$),v=m.$$proto,y=[m].concat(f);v.abc_code=a,t.defn(m,"$initialize",_=function(){var t=this;return t.abc_code=a,t.previous_new_part=[]},_.$$arity=0),t.defn(m,"$charpos_to_line_column",d=function(t){var e,r=this,n=a,i=a,o=a,s=a;return n=c(e=t)?e:1,i=r.abc_code["$[]"](1,n).$split("\n"),o=i.$count(),s=i.$last().$length(),[o,s]},d.$$arity=1),t.defn(m,"$parse_harpnote_config",p=function(n){var i,o=this,f=a,$=a,_=a;return f=l([],{}),$=1,u(n.$split("\n"),"each",[],(i=function(n){var o,l=i.$$s||this,_=a,d=a,p=a,h=a,g=a;if(null==s.log&&(s.log=a),null==n&&(n=a),_=u(n,"match",[/^%%%%hn\.(print|legend|note|annotation|lyrics) (.*)/],(o=function(t){o.$$s;return null==t&&(t=a),[t["$[]"](1),t["$[]"](2)]},o.$$s=l,o.$$arity=1,o)),c(_))try{d=t.const_get_relative(y,"JSON").$parse(_.$last()),p=["line_no",$],u(d,"[]=",t.to_a(p)),p[e(p.length,1)],c(f["$[]"](_.$first()))||(p=[_.$first(),[]],u(f,"[]=",t.to_a(p)),p[e(p.length,1)]),f["$[]"](_.$first())["$<<"](d)}catch(e){if(!t.rescue(e,[t.const_get_relative(y,"Exception")]))throw e;h=e;try{g="error in harpnote commands: "+h.$message()+" ["+$+":"+_+"]",s.log.$error(g,[$,1],[$,2])}finally{t.pop_exception()}}return $=r($,1)},i.$$s=o,i.$$arity=1,i)),c(f["$[]"]("legend"))&&(_=["legend",f["$[]"]("legend").$first()],u(f,"[]=",t.to_a(_)),_[e(_.length,1)]),c(f["$[]"]("lyrics"))&&(_=["lyrics",f["$[]"]("lyrics").$first()],u(f,"[]=",t.to_a(_)),_[e(_.length,1)]),f},p.$$arity=1),t.defn(m,"$get_metadata",h=function(n){var i,o=this;return u(n.$split("\n").$each_with_index(),"inject",[l([],{})],(i=function(n,o){var l,f,$,_,d=i.$$s||this,p=a,h=a,g=a,m=a;return null==s.log&&(s.log=a),null==o&&(o=a),o=t.to_ary(o),l=t.slice.call(o,0,o.length),f=l.splice(0,1)[0],null==f&&(f=a),$=l.splice(0,1)[0],null==$&&($=a),null==n&&(n=a),p=u(f,"match",[/^([A-Z]):\s*(.*)/],(_=function(t){_.$$s;return null==t&&(t=a),[t["$[]"](1),t["$[]"](2)]},_.$$s=d,_.$$arity=1,_)),c(p)&&(h=p.$first(),c(n["$[]"](h))?(c(["F","X"]["$include?"](h))&&s.log.$error(t.const_get_relative(y,"I18n").$t("more than one line found for ")+" ':"+h+"'",[r($,1),1]),n["$[]"](h)["$<<"](p.$last().$strip())):(h["$=="]("F")&&(g=p.$last().$strip(),c(g["$include?"]("{{"))||c(g.$match(/^[a-zA-z0-9_\-\.]+$/))||s.log.$error('"'+g+'": '+t.const_get_relative(y,"I18n").$t("bad characters in filename"),[r($,1),1])),m=[h,[p.$last().$strip()]],u(n,"[]=",t.to_a(m)),m[e(m.length,1)])),n},i.$$s=o,i.$$arity=2,i.$$has_top_level_mlhs_arg=!0,i))},h.$$arity=1),t.defn(m,"$add_metadata",g=function(t,e){var r,n,i=this,o=a,s=a;return o=i.$get_metadata(t),s=u(u(e,"select",[],(r=function(t,e){r.$$s;return null==t&&(t=a),null==e&&(e=a),o["$[]"](t)["$nil?"]()},r.$$s=i,r.$$arity=2,r)),"map",[],(n=function(t,e){n.$$s;return null==t&&(t=a),null==e&&(e=a),t+":"+e},n.$$s=i,n.$$arity=2,n)),[s,t].$flatten().$compact().$join("\n")},g.$$arity=2)}(d[0],0,d)}(d[0],d)}(n[0],n)},Opal.modules.native=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t>=e:t["$>="](e)}var n=t.top,a=[],i=t.nil,o=(t.breaker,t.slice,t.module),s=t.truthy,c=t.send,l=t.range,u=t.hash2,f=t.klass,$=t.gvars;return t.add_stubs(["$try_convert","$native?","$respond_to?","$to_n","$raise","$inspect","$Native","$proc","$map!","$end_with?","$define_method","$[]","$convert","$call","$to_proc","$new","$each","$native_reader","$native_writer","$extend","$is_a?","$map","$alias_method","$to_a","$_Array","$include","$method_missing","$bind","$instance_method","$slice","$-","$length","$[]=","$enum_for","$===","$>=","$<<","$each_pair","$_initialize","$name","$exiting_mid","$native_module"]),function(e,r){var n,a,f,$,_,d,p,h,g,m=n=o(e,"Native"),v=(m.$$proto,[m].concat(r));t.defs(m,"$is_a?",a=function(t,e){var r=this;try{return t instanceof r.$try_convert(e)}catch(t){return!1}},a.$$arity=2),t.defs(m,"$try_convert",f=function(t,e){var r=this;return null==e&&(e=i),r["$native?"](t)?t:t["$respond_to?"]("to_n")?t.$to_n():e},f.$$arity=-2),t.defs(m,"$convert",$=function(e){var r=this;return r["$native?"](e)?e:e["$respond_to?"]("to_n")?e.$to_n():void r.$raise(t.const_get_relative(v,"ArgumentError"),e.$inspect()+" isn't native")},$.$$arity=1),t.defs(m,"$call",_=function(t,e,r){var n,a=this,o=_.$$p,s=o||i,c=arguments.length,l=c-2;l<0&&(l=0),n=new Array(l);for(var u=2;u<c;u++)n[u-2]=arguments[u];o&&(_.$$p=null);var f=t[e];if(f instanceof Function){for(var $=new Array(n.length),d=0,p=n.length;d<p;d++){var h=n[d],g=a.$try_convert(h);$[d]=g===i?h:g}return s!==i&&$.push(s),a.$Native(f.apply(t,$))}return a.$Native(f)},_.$$arity=-3),t.defs(m,"$proc",d=function(){var e,r=this,n=d.$$p,a=n||i;return n&&(d.$$p=null),s(a)||r.$raise(t.const_get_relative(v,"LocalJumpError"),"no block given"),c(t.const_get_qualified("::","Kernel"),"proc",[],(e=function(r){var n,o,s=e.$$s||this,l=i,u=arguments.length,f=u-0;f<0&&(f=0),n=new Array(f);for(var $=0;$<u;$++)n[$-0]=arguments[$];if(c(n,"map!",[],(o=function(t){var e=o.$$s||this;return null==t&&(t=i),e.$Native(t)},o.$$s=s,o.$$arity=1,o)),l=s.$Native(this),this===t.global)return a.apply(s,n);var _=a.$$s;a.$$s=null;try{return a.apply(l,n)}finally{a.$$s=_}},e.$$s=r,e.$$arity=-1,e))},d.$$arity=0),function(e,r){var n,a,f,$,_,d=n=o(e,"Helpers"),p=(d.$$proto,[d].concat(r));t.defn(d,"$alias_native",a=function(e,r,n){var a,o,f,$,_,d,h=this;if($=t.slice.call(arguments,1,arguments.length),null==(n=t.extract_kwargs($))||!n.$$is_hash){if(null!=n)throw t.ArgumentError.$new("expected kwargs");n=u([],{})}return _=n.$$smap.as,null==_&&(_=i),0<$.length&&(d=$.splice(0,1)[0]),null==d&&(d=e),s(d["$end_with?"]("="))?c(h,"define_method",[e],(a=function(e){var r=a.$$s||this;return null==r.native&&(r.native=i),null==e&&(e=i),r.native[d["$[]"](l(0,-2,!1))]=t.const_get_relative(p,"Native").$convert(e),e},a.$$s=h,a.$$arity=1,a)):s(_)?c(h,"define_method",[e],(o=function(e){var r,n,a=o.$$s||this,l=i;null==a.native&&(a.native=i),(r=o.$$p||i)&&(o.$$p=null);var u=arguments.length,f=u-0;f<0&&(f=0),n=new Array(f);for(var $=0;$<u;$++)n[$-0]=arguments[$];return s(l=c(t.const_get_relative(p,"Native"),"call",[a.native,d].concat(t.to_a(n)),r.$to_proc()))?_.$new(l.$to_n()):i},o.$$s=h,o.$$arity=-1,o)):c(h,"define_method",[e],(f=function(e){var r,n,a=f.$$s||this;null==a.native&&(a.native=i),(r=f.$$p||i)&&(f.$$p=null);var o=arguments.length,s=o-0;s<0&&(s=0),n=new Array(s);for(var l=0;l<o;l++)n[l-0]=arguments[l];return c(t.const_get_relative(p,"Native"),"call",[a.native,d].concat(t.to_a(n)),r.$to_proc())},f.$$s=h,f.$$arity=-1,f))},a.$$arity=-2),t.defn(d,"$native_reader",f=function(t){var e,r,n=this,a=arguments.length,o=a-0;o<0&&(o=0),r=new Array(o);for(var s=0;s<a;s++)r[s-0]=arguments[s];return c(r,"each",[],(e=function(t){var r,n=e.$$s||this;return null==t&&(t=i),c(n,"define_method",[t],(r=function(){var e=r.$$s||this;return null==e.native&&(e.native=i),e.$Native(e.native[t])},r.$$s=n,r.$$arity=0,r))},e.$$s=n,e.$$arity=1,e))},f.$$arity=-1),t.defn(d,"$native_writer",$=function(t){var e,r,n=this,a=arguments.length,o=a-0;o<0&&(o=0),r=new Array(o);for(var s=0;s<a;s++)r[s-0]=arguments[s];return c(r,"each",[],(e=function(t){var r,n=e.$$s||this;return null==t&&(t=i),c(n,"define_method",[t+"="],(r=function(e){var n=r.$$s||this;return null==n.native&&(n.native=i),null==e&&(e=i),n.$Native(n.native[t]=e)},r.$$s=n,r.$$arity=1,r))},e.$$s=n,e.$$arity=1,e))},$.$$arity=-1),t.defn(d,"$native_accessor",_=function(e){var r,n=this,a=arguments.length,i=a-0;i<0&&(i=0),r=new Array(i);for(var o=0;o<a;o++)r[o-0]=arguments[o];return c(n,"native_reader",t.to_a(r)),c(n,"native_writer",t.to_a(r))},_.$$arity=-1)}(v[0],v),t.defs(m,"$included",p=function(e){return e.$extend(t.const_get_relative(v,"Helpers"))},p.$$arity=1),t.defn(m,"$initialize",h=function(e){var r=this;return s(t.const_get_qualified("::","Kernel")["$native?"](e))||t.const_get_qualified("::","Kernel").$raise(t.const_get_relative(v,"ArgumentError"),e.$inspect()+" isn't native"),r.native=e},h.$$arity=1),t.defn(m,"$to_n",g=function(){var t=this;return null==t.native&&(t.native=i),t.native},g.$$arity=0)}(a[0],a),function(e,r){var n,a,l,u,f=n=o(e,"Kernel"),$=(f.$$proto,[f].concat(r));t.defn(f,"$native?",a=function(t){return null==t||!t.$$class},a.$$arity=1),t.defn(f,"$Native",l=function(e){var r,n,a=this;return s(null==e)?i:s(a["$native?"](e))?t.const_get_qualified(t.const_get_relative($,"Native"),"Object").$new(e):s(e["$is_a?"](t.const_get_relative($,"Array")))?c(e,"map",[],(r=function(t){var e=r.$$s||this;return null==t&&(t=i),e.$Native(t)},r.$$s=a,r.$$arity=1,r)):s(e["$is_a?"](t.const_get_relative($,"Proc")))?c(a,"proc",[],(n=function(r){var a,o,s=n.$$s||this;(a=n.$$p||i)&&(n.$$p=null);var l=arguments.length,u=l-0;u<0&&(u=0),o=new Array(u);for(var f=0;f<l;f++)o[f-0]=arguments[f];return s.$Native(c(e,"call",t.to_a(o),a.$to_proc()))},n.$$s=a,n.$$arity=-1,n)):e},l.$$arity=1),f.$alias_method("_Array","Array"),t.defn(f,"$Array",u=function(e,r){var n,a=this,o=u.$$p,l=o||i,f=arguments.length,_=f-1;_<0&&(_=0),n=new Array(_);for(var d=1;d<f;d++)n[d-1]=arguments[d];return o&&(u.$$p=null),s(a["$native?"](e))?c(t.const_get_qualified(t.const_get_relative($,"Native"),"Array"),"new",[e].concat(t.to_a(n)),l.$to_proc()).$to_a():a.$_Array(e)},u.$$arity=-2)}(a[0],a),function(r,n,a){function o(){}var l,$,_,d,p,h,g,m,v,y,b,w,x,A,k,E=o=f(r,n,"Object",o),S=E.$$proto;[E].concat(a);S.native=i,E.$include(t.const_get_qualified("::","Native")),t.defn(E,"$==",l=function(e){return this.native===t.const_get_qualified("::","Native").$try_convert(e)},l.$$arity=1),t.defn(E,"$has_key?",$=function(e){var r=this;return t.hasOwnProperty.call(r.native,e)},$.$$arity=1),t.alias(E,"key?","has_key?"),t.alias(E,"include?","has_key?"),t.alias(E,"member?","has_key?"),t.defn(E,"$each",_=function(e){var r,n=this,a=_.$$p,o=a||i,s=arguments.length,l=s-0;l<0&&(l=0),r=new Array(l);for(var u=0;u<s;u++)r[u-0]=arguments[u];if(a&&(_.$$p=null),o!==i){for(var f in n.native)t.yieldX(o,[f,n.native[f]]);return n}return c(n,"method_missing",["each"].concat(t.to_a(r)))},_.$$arity=-1),t.defn(E,"$[]",d=function(e){var r=this,n=r.native[e];return n instanceof Function?n:t.const_get_qualified("::","Native").$call(r.native,e)},d.$$arity=1),t.defn(E,"$[]=",p=function(e,r){var n=this,a=i;return a=t.const_get_qualified("::","Native").$try_convert(r),s(a===i)?n.native[e]=r:n.native[e]=a},p.$$arity=2),t.defn(E,"$merge!",h=function(e){var r=this;e=t.const_get_qualified("::","Native").$convert(e);for(var n in e)r.native[n]=e[n];return r},h.$$arity=1),t.defn(E,"$respond_to?",g=function(e,r){var n=this;return null==r&&(r=!1),t.const_get_qualified("::","Kernel").$instance_method("respond_to?").$bind(n).$call(e,r)},g.$$arity=-2),t.defn(E,"$respond_to_missing?",m=function(e,r){var n=this;return null==r&&(r=!1),t.hasOwnProperty.call(n.native,e)},m.$$arity=-2),t.defn(E,"$method_missing",v=function(r,n){var a,o=this,s=v.$$p,l=s||i,u=i,f=arguments.length,$=f-1;$<0&&($=0),a=new Array($);for(var _=1;_<f;_++)a[_-1]=arguments[_];return s&&(v.$$p=null),"="===r.charAt(r.length-1)?(u=[r.$slice(0,e(r.$length(),1)),a["$[]"](0)],c(o,"[]=",t.to_a(u)),u[e(u.length,1)]):c(t.const_get_qualified("::","Native"),"call",[o.native,r].concat(t.to_a(a)),l.$to_proc())},v.$$arity=-2),t.defn(E,"$nil?",y=function(){return!1},y.$$arity=0),t.defn(E,"$is_a?",b=function(e){var r=this;return t.is_a(r,e)},b.$$arity=1),t.alias(E,"kind_of?","is_a?"),t.defn(E,"$instance_of?",w=function(t){return this.$$class===t},w.$$arity=1),t.defn(E,"$class",x=function(){return this.$$class},x.$$arity=0),t.defn(E,"$to_a",A=function(e){var r=this,n=A.$$p,a=n||i;return null==e&&(e=u([],{})),n&&(A.$$p=null),c(t.const_get_qualified(t.const_get_qualified("::","Native"),"Array"),"new",[r.native,e],a.$to_proc()).$to_a()},A.$$arity=-1),t.defn(E,"$inspect",k=function(){var t=this;return"#<Native:"+String(t.native)+">"},k.$$arity=0)}(t.const_get_relative(a,"Native"),t.const_get_relative(a,"BasicObject"),a),function(n,a,o){function l(){}var $,_,d,p,h,g,m,v=l=f(n,null,"Array",l),y=v.$$proto,b=[v].concat(o);y.named=y.native=y.get=y.block=y.set=y.length=i,v.$include(t.const_get_relative(b,"Native")),v.$include(t.const_get_relative(b,"Enumerable")),t.defn(v,"$initialize",$=function(e,r){var n,a=this,o=$.$$p,l=o||i;return null==r&&(r=u([],{})),o&&($.$$p=null),c(a,t.find_super_dispatcher(a,"initialize",$,!1),[e],null),a.get=s(n=r["$[]"]("get"))?n:r["$[]"]("access"),a.named=r["$[]"]("named"),a.set=s(n=r["$[]"]("set"))?n:r["$[]"]("access"),a.length=s(n=r["$[]"]("length"))?n:"length",a.block=l,s(null==a.$length())?a.$raise(t.const_get_relative(b,"ArgumentError"),"no length found on the array-like object"):i},$.$$arity=-2),t.defn(v,"$each",_=function(){var e=this,r=_.$$p,n=r||i;if(r&&(_.$$p=null),!s(n))return e.$enum_for("each");for(var a=0,o=e.$length();a<o;a++)t.yield1(n,e["$[]"](a));return e},_.$$arity=0),t.defn(v,"$[]",d=function(e){var r=this,n=i,a=i;return n=function(){return a=e,t.const_get_relative(b,"String")["$==="](a)||t.const_get_relative(b,"Symbol")["$==="](a)?s(r.named)?r.native[r.named](e):r.native[e]:t.const_get_relative(b,"Integer")["$==="](a)?s(r.get)?r.native[r.get](e):r.native[e]:i}(),s(n)?s(r.block)?r.block.$call(n):r.$Native(n):i},d.$$arity=1),t.defn(v,"$[]=",p=function(e,r){var n=this;return s(n.set)?n.native[n.set](e,t.const_get_relative(b,"Native").$convert(r)):n.native[e]=t.const_get_relative(b,"Native").$convert(r)},p.$$arity=2),t.defn(v,"$last",h=function(t){var n=this,a=i,o=i;if(null==t&&(t=i),s(t)){for(a=e(n.$length(),1),o=[];s(r(a,0));)o["$<<"](n["$[]"](a)),a=e(a,1);return o}return n["$[]"](e(n.$length(),1))},h.$$arity=-1),t.defn(v,"$length",g=function(){var t=this;return t.native[t.length]},g.$$arity=0),t.alias(v,"to_ary","to_a"),t.defn(v,"$inspect",m=function(){return this.$to_a().$inspect()},m.$$arity=0)}(t.const_get_relative(a,"Native"),0,a),function(e,r,n){function a(){}var i,o=a=f(e,null,"Numeric",a);o.$$proto,[o].concat(n);t.defn(o,"$to_n",i=function(){return this.valueOf()},i.$$arity=0)}(a[0],0,a),function(e,r,n){function a(){}var i,o=a=f(e,null,"Proc",a);o.$$proto,[o].concat(n);t.defn(o,"$to_n",i=function(){return this},i.$$arity=0)}(a[0],0,a),function(e,r,n){function a(){}var i,o=a=f(e,null,"String",a);o.$$proto,[o].concat(n);t.defn(o,"$to_n",i=function(){return this.valueOf()},i.$$arity=0)}(a[0],0,a),function(e,r,n){function a(){}var i,o=a=f(e,null,"Regexp",a);o.$$proto,[o].concat(n);t.defn(o,"$to_n",i=function(){return this.valueOf()},i.$$arity=0)}(a[0],0,a),function(e,r,n){function a(){}var o,s=a=f(e,null,"MatchData",a),c=s.$$proto;[s].concat(n);c.matches=i,t.defn(s,"$to_n",o=function(){return this.matches},o.$$arity=0)}(a[0],0,a),function(e,r,n){function a(){}var o,s=a=f(e,null,"Struct",a),l=(s.$$proto,[s].concat(n));t.defn(s,"$to_n",o=function(){var e,r=this,n=i;return n={},c(r,"each_pair",[],(e=function(r,a){e.$$s;return null==r&&(r=i),null==a&&(a=i),n[r]=t.const_get_relative(l,"Native").$try_convert(a,a)},e.$$s=r,e.$$arity=2,e)),n},o.$$arity=0)}(a[0],0,a),function(e,r,n){function a(){}var i,o=a=f(e,null,"Array",a),s=(o.$$proto,[o].concat(n));t.defn(o,"$to_n",i=function(){for(var e=this,r=[],n=0,a=e.length;n<a;n++){var i=e[n];r.push(t.const_get_relative(s,"Native").$try_convert(i,i))}return r},i.$$arity=0)}(a[0],0,a),function(e,r,n){function a(){}var i,o=a=f(e,null,"Boolean",a);o.$$proto,[o].concat(n);t.defn(o,"$to_n",i=function(){return this.valueOf()},i.$$arity=0)}(a[0],0,a),function(e,r,n){function a(){}var i,o=a=f(e,null,"Time",a);o.$$proto,[o].concat(n);t.defn(o,"$to_n",i=function(){return this},i.$$arity=0)}(a[0],0,a),function(e,r,n){function a(){}var i,o=a=f(e,null,"NilClass",a);o.$$proto,[o].concat(n);t.defn(o,"$to_n",i=function(){return null},i.$$arity=0)}(a[0],0,a),function(e,r,n){function a(){}var o,s,l=a=f(e,null,"Hash",a),u=(l.$$proto,[l].concat(n));l.$alias_method("_initialize","initialize"),t.defn(l,"$initialize",o=function(e){var r=this,n=o.$$p,a=n||i;if(n&&(o.$$p=null),null!=e&&(void 0===e.constructor||e.constructor===Object)){var s,l,f=r.$$smap,$=r.$$keys;for(s in e)l=e[s],!l||void 0!==l.constructor&&l.constructor!==Object?l&&l.$$is_array?(l=l.map(function(e){return!e||void 0!==e.constructor&&e.constructor!==Object?r.$Native(e):t.const_get_relative(u,"Hash").$new(e)}),f[s]=l):f[s]=r.$Native(l):f[s]=t.const_get_relative(u,"Hash").$new(l),$.push(s);return r}return c(r,"_initialize",[e],a.$to_proc())},o.$$arity=-1),t.defn(l,"$to_n",s=function(){for(var e,r,n=this,a={},i=n.$$keys,o=n.$$smap,s=0,c=i.length;s<c;s++)e=i[s],e.$$is_string?r=o[e]:(e=e.key,r=e.value),a[e]=t.const_get_relative(u,"Native").$try_convert(r,r);return a},s.$$arity=0)}(a[0],0,a),function(e,r,n){function a(){}var i,o=a=f(e,null,"Module",a);o.$$proto,[o].concat(n);t.defn(o,"$native_module",i=function(){var e=this;return t.global[e.$name()]=e},i.$$arity=0)}(a[0],0,a),function(e,r,n){function a(){}var i,o,s=a=f(e,null,"Class",a),c=(s.$$proto,[s].concat(n));t.defn(s,"$native_alias",i=function(e,r){var n=this,a=n.$$proto["$"+r];a||n.$raise(t.const_get_relative(c,"NameError").$new("undefined method `"+r+"' for class `"+n.$inspect()+"'",n.$exiting_mid())),n.$$proto[e]=a},i.$$arity=2),t.defn(s,"$native_class",o=function(){var t=this;return t.$native_module(),t.new=t.$new},o.$$arity=0)}(a[0],0,a),$.$=$.global=n.$Native(t.global)},Opal.modules.abc2svg_to_harpnotes=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}function n(t,e){return"number"==typeof t&&"number"==typeof e?t/e:t["$/"](e)}function a(t,e){return"number"==typeof t&&"number"==typeof e?t>=e:t["$>="](e)}function i(t,e){return"number"==typeof t&&"number"==typeof e?t>e:t["$>"](e)}function o(t,e){return"number"==typeof t&&"number"==typeof e?t*e:t["$*"](e)}function s(t,e){return"number"==typeof t&&"number"==typeof e?t<e:t["$<"](e)}var c=t.top,l=[],u=t.nil,f=(t.breaker,t.slice,t.module),$=t.klass,_=t.send,d=t.hash2,p=t.gvars,h=t.truthy,g=t.hash,m=t.range;return t.add_stubs(["$require","$attr_reader","$get","$_reset_state","$get_metadata","$new","$abcplay=","$-","$get_abcmodel","$nil?","$raise","$t","$_make_metadata","$_transform_voices","$meta_data=","$_make_harpnote_options","$harpnote_options=","$[]","$meta_data","$empty?","$error","$[]=","$compact","$map","$gsub","$strip","$+","$_get_key_by_accidentals","$first","$==","$/","$to_i","$join","$>=","$private","$match","$charpos_to_line_column","$flatten","$to_a","$each_with_index","$_transform_voice","$_make_variant_ending_jumps","$unshift","$to_s","$_investigate_first_bar","$each","$send","$inject","$<<","$_make_jumplines","$_make_notebound_annotations","$count","$last","$select","$!","$=~","$_extract_goto_info_from_bar","$!=","$length","$push","$_bar_is_repetition_end?","$>","$pop","$_transform_bar_repeat_end","$include?","$_parse_origin","$_parse_tuplet_info","$_parse_decorations","$_transform_measure_start","$_convert_duration","$decorations=","$measure_count=","$_transform_count_note","$count_note=","$time=","$_mkznid","$znid=","$origin=","$start_pos=","$end_pos=","$tuplet=","$tuplet_start=","$tuplet_end=","$variant=","$time","$duration","$duration=","$origin","$start_pos","$end_pos","$tuplet","$tuplet_start","$tuplet_end","$tie_end=","$tie_start=","$_parse_slur","$_push_slur","$slur_starts=","$_pop_slur","$slur_ends=","$measure_start=","$_make_repeats_jumps_annotations","$*","$%","$ceil","$split","$zip","$min","$round","$floor","$visible=","$invisible=","$is_a?","$prev_pitch","$pitch=","$znid","$warning","$start_pos_to_s","$_extract_chord_lines","$===","$shift=","$notes","$to_f","$pitch","$next_pitch=","$next_playable=","$next_first_in_part=","$prev_pitch=","$prev_playable=","$first_in_part=","$<","$start_with?","$to_sym","$&","$>>"]),c.$require("native"),function(c,l){var v,y=v=f(c,"Harpnotes"),b=(y.$$proto,[y].concat(l));!function(c,l){var v,y=v=f(c,"Input"),b=(y.$$proto,[y].concat(l));!function(c,l,f){function v(){}var y,b,w,x,A,k,E,S,N,C,I,O,P,L,M,T,B,j,F,R,q,D,z,U,H,G,Y,V,Q,X,J,W,K,Z,tt,et,rt,nt,at,it,ot,st,ct=v=$(c,l,"Abc2svgToHarpnotes",v),lt=ct.$$proto,ut=[ct].concat(f);lt.abc_code=lt.abcplay=lt.abc_model=lt.meta_data=lt.info_fields=lt.remark_table=lt.score_statements=lt.wmeasure=lt.measure_start_time=lt.next_note_marks=lt.variant_no=lt.variant_endings=lt.previous_note=lt.repetition_stack=lt.pushed_variant_ending_repeat=lt.part_table=lt.measure_count=lt.tie_started=lt.countby=lt._shortest_note=lt.pitch_providers=lt.slurstack=lt.tuplet_p=u,t.const_set(ut[0],"ABC2SVG_DURATION_FACTOR",1536),ct.$attr_reader("abc_model"),t.defn(ct,"$initialize",y=function(){var e=this,r=y.$$p,n=u,a=u,i=u;for(null==p.conf&&(p.conf=u),r&&(y.$$p=null),a=0,i=arguments.length,n=new Array(i);a<i;a++)n[a]=arguments[a];return _(e,t.find_super_dispatcher(e,"initialize",y,!1),n,r),e.abcplay=u,e.abc_code=u,e.previous_new_part=[],e.score_statements=[],e.part_table=d([],{}),e.abc_model=d([],{}),e._shortest_note=p.conf.$get("layout.SHORTEST_NOTE"),e.$_reset_state()},y.$$arity=0),t.defn(ct,"$transform",b=function(r){var n,a,i=this,o=u,s=u,c=u,l=u,f=u;return null==p.conf&&(p.conf=u),null==p.log&&(p.log=u),i.abc_code=r,i.annotations=p.conf.$get("annotations"),i.info_fields=i.$get_metadata(i.abc_code),o=t.const_get_qualified(t.const_get_relative(ut,"ABC2SVG"),"Abc2Svg").$new(u,d(["mode"],{mode:"model"})),h(i.abcplay)&&(s=[i.abcplay],_(o,"abcplay=",t.to_a(s)),s[e(s.length,1)]),a=o.$get_abcmodel(r),n=t.to_ary(a),i.abc_model=null==n[0]?u:n[0],c=null==n[1]?u:n[1],h(i.abc_model["$nil?"]())&&i.$raise(t.const_get_relative(ut,"I18n").$t("no suitable ABC found")),i.$_make_metadata(),l=i.$_transform_voices(),s=[i.meta_data],_(l,"meta_data=",t.to_a(s)),s[e(s.length,1)],s=[i.$_make_harpnote_options()],_(l,"harpnote_options=",t.to_a(s)),s[e(s.length,1)],f=l.$meta_data()["$[]"]("filename"),h(f["$empty?"]())&&p.log.$error(t.const_get_relative(ut,"I18n").$t("Filename not specified in song add an F: instruction"),[1,1]),[l,c]},b.$$arity=1),t.defn(ct,"$_make_harpnote_options",w=function(){var n,a=this,i=u,o=u;return null==p.conf&&(p.conf=u),i=d(["lyrics"],{lyrics:d(["text"],{text:a.info_fields["$[]"]("W")})}),o=["template",p.conf.$get("template")],_(i,"[]=",t.to_a(o)),o[e(o.length,1)],o=["print",_(p.conf.$get("produce"),"map",[],(n=function(e){var a,i=(n.$$s,u),o=u;return null==p.conf&&(p.conf=u),null==p.log&&(p.log=u),null==e&&(e=u),i=p.conf.$get("extract."+e+".title"),h(i)?(o=(h(a=p.conf.$get("extract."+e+".filenamepart"))?a:i).$strip().$gsub(/[^a-zA-Z0-9\-\_]/,"_"),d(["title","view_id","filenamepart"],{title:i,view_id:e,filenamepart:o})):(p.log.$error(r(t.const_get_relative(ut,"I18n").$t("could not find extract with number")," "+e),[1,1],[1e3,1e3]),u)},n.$$s=a,n.$$arity=1,n)).$compact()],_(i,"[]=",t.to_a(o)),o[e(o.length,1)],i},w.$$arity=0),t.defn(ct,"$_get_key_by_accidentals",x=function(t){
return g(7,["C#","D#Dor","E#Phr","F#Lyd","G#Mix","A#m","B#Loc"],6,["F#","G#Dor","A#Phr","BLyd","C#Mix","D#m","E#Loc"],5,["B","C#Dor","D#Phr","ELyd","F#Mix","G#m","A#Loc"],4,["E","F#Dor","G#Phr","ALyd","BMix","C#m","D#Loc"],3,["A","BDor","C#Phr","DLyd","EMix","F#m","G#Loc"],2,["D","EDor","F#Phr","GLyd","AMix","Bm","C#Loc"],1,["G","ADor","BPhr","CLyd","DMix","Em","F#Loc"],0,["C","DDor","EPhr","FLyd","GMix","Am","BLoc"],-1,["F","GDor","APhr","BbLyd","CMix","Dm","ELoc"],-2,["Bb","CDor","DPhr","EbLyd","FMix","Gm","ALoc"],-3,["Eb","FDor","GPhr","AbLyd","BbMix","Cm","DLoc"],-4,["Ab","BbDor","CPhr","DbLyd","EbMix","Fm","GLoc"],-5,["Db","EbDor","FPhr","GbLyd","AbMix","Bbm","CLoc"],-6,["Gb","AbDor","BbPhrCbLyd","DbMix","Ebm","FLoc"],-7,["CbDbDor","EbPhrFbLyd","GbMix","Abm","BbLoc"])["$[]"](t["$[]"]("k_sf"))["$[]"](t["$[]"]("k_mode"))},x.$$arity=1),t.defn(ct,"$_make_metadata",A=function(){var e,r,i=this,o=u,s=u,c=u,l=u,f=u,$=u,p=u;return o=i.$_get_key_by_accidentals(i.abc_model["$[]"]("voices").$first()["$[]"]("voice_properties")["$[]"]("key")),s=i.$_get_key_by_accidentals(i.abc_model["$[]"]("voices").$first()["$[]"]("voice_properties")["$[]"]("okey")),c="",o["$=="](s)||(c="(Original in "+s+")"),l=function(){try{return i.abc_model["$[]"]("voices").$first()["$[]"]("voice_properties")["$[]"]("sym")}catch(e){if(!t.rescue(e,[t.const_get_relative(ut,"StandardError")]))throw e;try{return u}finally{t.pop_exception()}}}(),h(h(e=l)?l["$[]"]("tempo_notes"):e)?(f=_(l["$[]"]("tempo_notes"),"map",[],(r=function(e){r.$$s;return null==e&&(e=u),n(e,t.const_get_relative(ut,"ABC2SVG_DURATION_FACTOR"))},r.$$s=i,r.$$arity=1,r)),$=l["$[]"]("tempo").$to_i(),p=i.info_fields["$[]"]("Q").$join(" ")):(f=[.25],$=120,p="1/4=120"),h(a($,1))||($=120),i.meta_data=d(["number","composer","title","filename","tempo","tempo_display","meter","key","o_key"],{number:i.info_fields["$[]"]("X").$first(),composer:(h(e=i.info_fields["$[]"]("C"))?e:[]).$join("\n"),title:(h(e=i.info_fields["$[]"]("T"))?e:[]).$join("\n"),filename:(h(e=i.info_fields["$[]"]("F"))?e:[]).$join("\n"),tempo:d(["duration","bpm","sym"],{duration:f,bpm:$,sym:l}),tempo_display:p,meter:i.info_fields["$[]"]("M"),key:o,o_key:c})},A.$$arity=0),ct.$private(),t.defn(ct,"$_mkznid",k=function(t){var e=this,r=u,n=u,a=u;return null==p.log&&(p.log=u),r=e.remark_table["$[]"](t["$[]"]("time")),h(r)?h(r.$match(/[a-z][a-zA-Z0-9_]*/))||(n=e.$charpos_to_line_column(t["$[]"]("istart")),a=e.$charpos_to_line_column(t["$[]"]("iend")),p.log.$error("illegal character in of [r:] (must be of [a-z][a-z0.9_])",n,a),r=u):h(r)||(r=""+t["$[]"]("time")),r},k.$$arity=1),t.defn(ct,"$_reset_state",E=function(){var t,e=this;return e.countnames=_(m(1,32,!1).$to_a(),"map",[],(t=function(e){t.$$s;return null==e&&(e=u),[e,"e","u","e"]},t.$$s=e,t.$$arity=1,t)).$flatten(),e.jumptargets=d([],{}),e.is_first_measure=!0,e.measure_start_time=0,e.measure_count=0,e.next_note_marks=d(["measure","repeat_start","variant_ending","variant_followup"],{measure:!1,repeat_start:!1,variant_ending:!1,variant_followup:!1}),e.previous_new_part=[],e.previous_note=u,e.remark_table=d([],{}),e.repetition_stack=[],e.variant_endings=[[]],e.tie_started=!1,e.variant_no=0,e.slurstack=0,e.tuplet_count=1,e.tuplet_down_count=1,e.countby=u,e.wmeasure=0},E.$$arity=0),t.defn(ct,"$_transform_voices",S=function(){var e,n=this,a=u;return a=_(n.abc_model["$[]"]("voices").$each_with_index(),"map",[],(e=function(t,n){var a=e.$$s||this,i=u,o=u;return null==t&&(t=u),null==n&&(n=u),i="v_"+r(n,1),o=a.$_transform_voice(t,i),h(o["$empty?"]())||(o=r(o,a.$_make_variant_ending_jumps(i))),o},e.$$s=n,e.$$arity=2,e)).$compact(),a.$unshift(a.$first()),t.const_get_qualified(t.const_get_qualified(t.const_get_relative(ut,"Harpnotes"),"Music"),"Song").$new(a)},S.$$arity=0),t.defn(ct,"$_transform_voice",N=function(n,a){var i,o,s,c,l,f,$=this,d=u,g=u,m=u,v=u,y=u;return null==p.log&&(p.log=u),d=$.abc_model["$[]"]("music_type_ids")["$[]"]("note").$to_s(),$.$_reset_state(),$.wmeasure=n["$[]"]("voice_properties")["$[]"]("meter")["$[]"]("wmeasure"),$.countby=function(){try{return n["$[]"]("voice_properties")["$[]"]("meter")["$[]"]("a_meter").$first()["$[]"]("bot").$to_i()}catch(e){if(!t.rescue(e,[t.const_get_relative(ut,"StandardError")]))throw e;try{return u}finally{t.pop_exception()}}}(),$.$_investigate_first_bar(n),_(n["$[]"]("symbols"),"each",[],(i=function(r){var n=i.$$s||this,a=u;return null==r&&(r=u),a=["start_pos",n.$charpos_to_line_column(r["$[]"]("istart"))],_(r,"[]=",t.to_a(a)),a[e(a.length,1)],a=["end_pos",n.$charpos_to_line_column(r["$[]"]("iend"))],_(r,"[]=",t.to_a(a)),a[e(a.length,1)]},i.$$s=$,i.$$arity=1,i)),$.pitch_providers=_(n["$[]"]("symbols"),"map",[],(o=function(t){o.$$s;return null==t&&(t=u),t["$[]"]("type").$to_s()["$=="](d)?t:u},o.$$s=$,o.$$arity=1,o)),g=_(n["$[]"]("symbols").$each_with_index(),"map",[],(s=function(e,r){var n=s.$$s||this,i=u,o=u;null==n.abc_model&&(n.abc_model=u),null==p.log&&(p.log=u),null==e&&(e=u),null==r&&(r=u),i=n.abc_model["$[]"]("music_types")["$[]"](e["$[]"]("type"));try{g=n.$send("_transform_"+i,e,r,a)}catch(r){if(!t.rescue(r,[t.const_get_relative(ut,"Exception")]))throw r;o=r;try{p.log.$error("Bug: "+o,n.$charpos_to_line_column(e["$[]"]("istart")))}finally{t.pop_exception()}}return g},s.$$s=$,s.$$arity=2,s)),g=g.$flatten(),m=_(g,"inject",[[]],(c=function(t,e){var r=c.$$s||this;return null==t&&(t=u),null==e&&(e=u),t["$<<"](r.$_make_jumplines(e,a)),t},c.$$s=$,c.$$arity=2,c)),v=_(g,"inject",[[]],(l=function(t,e){var r=l.$$s||this;return null==t&&(t=u),null==e&&(e=u),t["$<<"](r.$_make_notebound_annotations(e,a))},l.$$s=$,l.$$arity=2,l)),g=r(g,r(m,v)),g=g.$flatten().$compact(),h(g.$count()["$=="](0))&&(y=a.$gsub("v_","").$to_i(),h(h(f=$.score_statements.$last())?$.score_statements.$last()["$[]"]("sy")["$[]"]("voices")["$[]"](e(y,1))["$[]"]("range")["$=="](-1):f)||p.log.$error(t.const_get_relative(ut,"I18n").$t("Empty voice")+" "+y+":  V:"+n["$[]"]("voice_properties")["$[]"]("id"))),g},N.$$arity=2),t.defn(ct,"$_investigate_first_bar",C=function(r){var n,a,i=this,o=u,s=u,c=u;return o=i.abc_model["$[]"]("music_type_ids")["$[]"]("bar").$to_s(),s=_(r["$[]"]("symbols"),"select",[],(n=function(t){n.$$s;return null==t&&(t=u),t["$[]"]("type").$to_s()["$=="](o)?t["$[]"]("invisible")["$!"]():t["$[]"]("type").$to_s()["$=="](o)},n.$$s=i,n.$$arity=1,n)).$compact(),i.measure_start_time=0,h(s.$first())?(i.measure_start_time=e(s.$first()["$[]"]("time"),i.wmeasure),h(h(a=s.$first())?i.measure_start_time["$=="](0):a)?(c=["measure",!0],_(i.next_note_marks,"[]=",t.to_a(c)),c[e(c.length,1)]):u):u},C.$$arity=1),t.defn(ct,"$_bar_is_repetition_end?",I=function(t){return t["$=~"](/^:.*$/)},I.$$arity=1),t.defn(ct,"$_transform_bar",O=function(n,a,o){var s,c,l=this,f=u,$=u,g=u,m=u,v=u;return null==p.log&&(p.log=u),f=[],$=n["$[]"]("bar_type"),g=n["$[]"]("text"),m=function(){try{return l.$_extract_goto_info_from_bar(n).$last()["$[]"]("distance")}catch(e){if(!t.rescue(e,[t.const_get_relative(ut,"StandardError")]))throw e;try{return[-10,10,15]}finally{t.pop_exception()}}}(),h(h(s=n["$[]"]("invisible"))?s:$["$=~"](/^\:?([\[\]]+)$/))||(v=["measure",!0],_(l.next_note_marks,"[]=",t.to_a(v)),v[e(v.length,1)]),h($["$=~"](/^.*:$/))&&(v=["repeat_start",!0],_(l.next_note_marks,"[]=",t.to_a(v)),v[e(v.length,1)]),n["$[]"]("rbstart")["$=="](2)&&(l.variant_no=r(l.variant_no,1),v=["variant_ending",d(["text"],{text:g})],_(l.next_note_marks,"[]=",t.to_a(v)),v[e(v.length,1)]),h((s=n["$[]"]("rbstart")["$=="](2))?l.variant_endings.$last()["$empty?"]():n["$[]"]("rbstart")["$=="](2))&&(h(m.$length()["$!="](3))&&(p.log.$error("you need to specify 3 values: "+m,l.$charpos_to_line_column(n["$[]"]("istart")),l.$charpos_to_line_column(n["$[]"]("iend"))),m=[-10,10,15]),l.variant_endings.$last().$push(d(["rbstop","distance"],{rbstop:l.previous_note,distance:m}))),h(h(s=h(c=n["$[]"]("rbstop")["$=="](2))?l.variant_endings.$last().$last()["$nil?"]()["$!"]():c)?l.variant_endings.$last().$last()["$[]"]("rbstart"):s)&&(v=["rbstop",l.previous_note],_(l.variant_endings.$last().$last(),"[]=",t.to_a(v)),v[e(v.length,1)],h(l["$_bar_is_repetition_end?"]($))&&(v=["repeat_end",!0],_(l.variant_endings.$last().$last(),"[]=",t.to_a(v)),v[e(v.length,1)]),h(l["$_bar_is_repetition_end?"]($))?(l.pushed_variant_ending_repeat=!0,l.repetition_stack.$push(l.repetition_stack.$last())):h(h(s=l.pushed_variant_ending_repeat)?i(l.repetition_stack.$count(),1):s)&&l.repetition_stack.$pop(),n["$[]"]("rbstart")["$=="](2)||(v=["variant_followup",!0],_(l.next_note_marks,"[]=",t.to_a(v)),v[e(v.length,1)],l.variant_endings.$push([]),l.variant_no=0)),h(l["$_bar_is_repetition_end?"]($))&&f["$<<"](l.$_transform_bar_repeat_end(n,a,o)),h($["$include?"](":"))&&(h(!1)||e(n["$[]"]("time"),l.measure_start_time)["$=="](l.wmeasure)||(v=["measure",!1],_(l.next_note_marks,"[]=",t.to_a(v)),v[e(v.length,1)])),l.is_first_measure=!1,f},O.$$arity=3),t.defn(ct,"$_transform_part",P=function(n,a,i){var o=this,s=u,c=u,l=u;return null==p.log&&(p.log=u),h(o.part_table["$[]"](n["$[]"]("time")))&&(s=o.$charpos_to_line_column(n["$[]"]("istart")),c=o.$charpos_to_line_column(n["$[]"]("iend")),p.log.$error(r("abc:"+s.$first()+":"+s.$last()+" Error: ",t.const_get_relative(ut,"I18n").$t("Multiple parts for same note")),s,c)),l=[n["$[]"]("time"),n["$[]"]("text")],_(o.part_table,"[]=",t.to_a(l)),l[e(l.length,1)],u},P.$$arity=3),t.defn(ct,"$_transform_remark",L=function(n,a,i){var o=this,s=u,c=u,l=u;return null==p.log&&(p.log=u),h(o.remark_table["$[]"](n["$[]"]("time")))&&(s=o.$charpos_to_line_column(n["$[]"]("istart")),c=o.$charpos_to_line_column(n["$[]"]("iend")),p.log.$error(r("abc:"+s.$first()+":"+s.$last()+" Error: ",t.const_get_relative(ut,"I18n").$t("Multiple remarks for same note")),s,c)),l=[n["$[]"]("time"),n["$[]"]("text")],_(o.remark_table,"[]=",t.to_a(l)),l[e(l.length,1)],u},L.$$arity=3),t.defn(ct,"$_transform_note",M=function(r,n,a){var i,o,s,c,l,f,$=this,d=u,p=u,g=u,m=u,v=u,y=u,b=u,w=u,x=u,A=u,k=u,E=u,S=u,N=u;return d=$.$_parse_origin(r),i=[d["$[]"]("startChar"),d["$[]"]("endChar")],p=i[0],g=i[1],o=$.$_parse_tuplet_info(r),i=t.to_ary(o),m=null==i[0]?u:i[0],v=null==i[1]?u:i[1],y=null==i[2]?u:i[2],b=$.$_parse_decorations(r),$.$_transform_measure_start(r),w=$.$_convert_duration(r["$[]"]("notes").$first()["$[]"]("dur")),x=_(r["$[]"]("notes"),"map",[],(s=function(n){var a=s.$$s||this,i=u,o=u;return null==a.measure_count&&(a.measure_count=u),null==a.variant_no&&(a.variant_no=u),null==n&&(n=u),i=t.const_get_qualified(t.const_get_qualified(t.const_get_relative(ut,"Harpnotes"),"Music"),"Note").$new(n["$[]"]("midi"),w),o=[b],_(i,"decorations=",t.to_a(o)),o[e(o.length,1)],o=[a.measure_count],_(i,"measure_count=",t.to_a(o)),o[e(o.length,1)],o=[a.$_transform_count_note(r)],_(i,"count_note=",t.to_a(o)),o[e(o.length,1)],o=[r["$[]"]("time")],_(i,"time=",t.to_a(o)),o[e(o.length,1)],o=[a.$_mkznid(r)],_(i,"znid=",t.to_a(o)),o[e(o.length,1)],o=[d],_(i,"origin=",t.to_a(o)),o[e(o.length,1)],o=[a.$charpos_to_line_column(p)],_(i,"start_pos=",t.to_a(o)),o[e(o.length,1)],o=[a.$charpos_to_line_column(g)],_(i,"end_pos=",t.to_a(o)),o[e(o.length,1)],o=[m],_(i,"tuplet=",t.to_a(o)),o[e(o.length,1)],o=[y],_(i,"tuplet_start=",t.to_a(o)),o[e(o.length,1)],o=[v],_(i,"tuplet_end=",t.to_a(o)),o[e(o.length,1)],o=[a.variant_no],_(i,"variant=",t.to_a(o)),o[e(o.length,1)],i},s.$$s=$,s.$$arity=1,s)),A=[],x.$count()["$=="](1)?A["$<<"](x.$first()):(k=t.const_get_qualified(t.const_get_qualified(t.const_get_relative(ut,"Harpnotes"),"Music"),"SynchPoint").$new(x),E=x.$first(),S=[$.$_mkznid(r)],_(k,"znid=",t.to_a(S)),S[e(S.length,1)],S=[b],_(k,"decorations=",t.to_a(S)),S[e(S.length,1)],S=[$.measure_count],_(k,"measure_count=",t.to_a(S)),S[e(S.length,1)],S=[$.$_transform_count_note(r)],_(k,"count_note=",t.to_a(S)),S[e(S.length,1)],S=[E.$time()],_(k,"time=",t.to_a(S)),S[e(S.length,1)],S=[E.$duration()],_(k,"duration=",t.to_a(S)),S[e(S.length,1)],S=[E.$origin()],_(k,"origin=",t.to_a(S)),S[e(S.length,1)],S=[E.$start_pos()],_(k,"start_pos=",t.to_a(S)),S[e(S.length,1)],S=[E.$end_pos()],_(k,"end_pos=",t.to_a(S)),S[e(S.length,1)],S=[E.$tuplet()],_(k,"tuplet=",t.to_a(S)),S[e(S.length,1)],S=[E.$tuplet_start()],_(k,"tuplet_start=",t.to_a(S)),S[e(S.length,1)],S=[E.$tuplet_end()],_(k,"tuplet_end=",t.to_a(S)),S[e(S.length,1)],A["$<<"](k)),h($.repetition_stack["$empty?"]())&&$.repetition_stack["$<<"](A.$last()),S=[$.tie_started],_(A.$first(),"tie_end=",t.to_a(S)),S[e(S.length,1)],$.tie_started=r["$[]"]("ti1")["$nil?"]()["$!"](),S=[$.tie_started],_(A.$first(),"tie_start=",t.to_a(S)),S[e(S.length,1)],S=[_($.$_parse_slur(r["$[]"]("slur_start")),"map",[],(c=function(t){var e=c.$$s||this;return null==t&&(t=u),e.$_push_slur()},c.$$s=$,c.$$arity=1,c))],_(A.$first(),"slur_starts=",t.to_a(S)),S[e(S.length,1)],N=h(i=r["$[]"]("slur_end"))?i:0,S=[_(t.Range.$new(1,N,!1),"map",[],(l=function(){return(l.$$s||this).$_pop_slur()},l.$$s=$,l.$$arity=0,l))],_(A.$first(),"slur_ends=",t.to_a(S)),S[e(S.length,1)],h($.next_note_marks["$[]"]("measure"))&&(_(x,"each",[],(f=function(r){f.$$s;return null==r&&(r=u),S=[!0],_(r,"measure_start=",t.to_a(S)),S[e(S.length,1)]},f.$$s=$,f.$$arity=1,f)),S=["measure",!1],_($.next_note_marks,"[]=",t.to_a(S)),S[e(S.length,1)]),$.$_make_repeats_jumps_annotations(A,r,a),A},M.$$arity=3),t.defn(ct,"$_transform_measure_start",T=function(t){var e=this;return h(e.next_note_marks["$[]"]("measure"))?(e.measure_count=r(e.measure_count,1),e.measure_start_time=t["$[]"]("time")):u},T.$$arity=1),t.defn(ct,"$_transform_count_note",B=function(i){var s,c,l,f,$=this,d=u,p=u,g=u,m=u,v=u,y=u;return h($.countby)?(d=n(t.const_get_relative(ut,"ABC2SVG_DURATION_FACTOR"),$.countby),p=n(o(4,e(i["$[]"]("time"),$.measure_start_time)),d),g=r(p,n(o(4,i["$[]"]("dur")),d)),m=h(h(s=p["$%"](1)["$=="](0))?g["$%"](1)["$=="](0):s)?_(t.Range.$new(p,g,!0).$to_a(),"map",[],(c=function(t){var e=c.$$s||this;return null==e.countnames&&(e.countnames=u),null==t&&(t=u),e.countnames["$[]"](t)},c.$$s=$,c.$$arity=1,c)).$join():p["$%"](1)["$=="](0)?_(t.Range.$new(p,g.$ceil(),!0).$to_a(),"map",[],(l=function(t){var e=l.$$s||this;return null==e.countnames&&(e.countnames=u),null==t&&(t=u),e.countnames["$[]"](t)},l.$$s=$,l.$$arity=1,l)).$join(""):"",v=m.$split(/[eui\?]+/),y=m.$split(/[0-9]+/),h(y["$empty?"]())&&(y=[""]),_(y,"each_with_index",[],(f=function(r,n){var i=(f.$$s,u);return null==r&&(r=u),null==n&&(n=u),h(a(n,1))?(i=[n,u],_(y,"[]=",t.to_a(i)),i[e(i.length,1)]):u},f.$$s=$,f.$$arity=2,f)),m=y.$zip(v).$flatten().$compact().$join(" ").$strip().$split().$join("-"),m=m.$gsub("ue","u")):u},B.$$arity=1),t.defn(ct,"$_convert_duration",j=function(e){var r=this;return[128,o(n(e,t.const_get_relative(ut,"ABC2SVG_DURATION_FACTOR")),r._shortest_note).$round()].$min()},j.$$arity=1),t.defn(ct,"$_transform_staves",F=function(e,r,n){var a=this,o=u,s=u;return null==p.log&&(p.log=u),h(a.score_statements)||(a.score_statements=[]),a.score_statements.$push(e),h(i(a.score_statements.$length(),1))?(o=a.$charpos_to_line_column(e["$[]"]("istart")),s=a.$charpos_to_line_column(e["$[]"]("iend")),p.log.$error(t.const_get_relative(ut,"I18n").$t("you have multiple %%score statements")+": "+a.score_statements.$length(),o,s)):u},F.$$arity=3),t.defn(ct,"$_transform_rest",R=function(r,a,i){var o,s,c,l=this,f=u,$=u,d=u,g=u,m=u,v=u,y=u,b=u,w=u,x=u,A=u,k=u;return null==p.conf&&(p.conf=u),f=l.$_parse_origin(r),o=[f["$[]"]("startChar"),f["$[]"]("endChar")],$=o[0],d=o[1],g=[l.pitch_providers["$[]"](t.Range.$new(0,a,!1)).$compact().$last(),l.pitch_providers["$[]"](t.Range.$new(a,-1,!1)).$compact().$first()],p.conf["$[]"]("restposition.default")["$=="]("previous")&&(g=[h(o=g.$first())?o:g.$last()]),p.conf["$[]"]("restposition.default")["$=="]("next")&&(g=[h(o=g.$last())?o:g.$first()]),m=l.$_parse_decorations(r),g=g.$compact(),h(g["$empty?"]())?v=60:(g=_(g,"map",[],(s=function(t){s.$$s;return null==t&&(t=u),t["$[]"]("notes").$last()["$[]"]("midi")},s.$$s=l,s.$$arity=1,s)),v=n(g.$inject("+"),g.$length()).$floor().$to_i()),h(v["$nil?"]())&&(l.$raise("undefined pitch"),v=60),l.$_transform_measure_start(r),y=r["$[]"]("notes"),y=function(){return h(y)?y.$first()["$[]"]("dur"):r["$[]"]("dur")}(),y=l.$_convert_duration(y),c=l.$_parse_tuplet_info(r),o=t.to_ary(c),b=null==o[0]?u:o[0],w=null==o[1]?u:o[1],x=null==o[2]?u:o[2],A=t.const_get_qualified(t.const_get_qualified(t.const_get_relative(ut,"Harpnotes"),"Music"),"Pause").$new(v,y),k=[l.measure_count],_(A,"measure_count=",t.to_a(k)),k[e(k.length,1)],k=[m],_(A,"decorations=",t.to_a(k)),k[e(k.length,1)],k=[l.$_transform_count_note(r)],_(A,"count_note=",t.to_a(k)),k[e(k.length,1)],k=[l.$_mkznid(r)],_(A,"znid=",t.to_a(k)),k[e(k.length,1)],k=[r["$[]"]("time")],_(A,"time=",t.to_a(k)),k[e(k.length,1)],k=[l.$_parse_origin(r)],_(A,"origin=",t.to_a(k)),k[e(k.length,1)],k=[l.$charpos_to_line_column($)],_(A,"start_pos=",t.to_a(k)),k[e(k.length,1)],k=[l.$charpos_to_line_column(d)],_(A,"end_pos=",t.to_a(k)),k[e(k.length,1)],k=[l.variant_no],_(A,"variant=",t.to_a(k)),k[e(k.length,1)],k=[b],_(A,"tuplet=",t.to_a(k)),k[e(k.length,1)],k=[x],_(A,"tuplet_start=",t.to_a(k)),k[e(k.length,1)],k=[w],_(A,"tuplet_end=",t.to_a(k)),k[e(k.length,1)],h(r["$[]"]("invis"))&&(k=[!1],_(A,"visible=",t.to_a(k)),k[e(k.length,1)]),k=[r["$[]"]("invis")],_(A,"invisible=",t.to_a(k)),k[e(k.length,1)],h(l.repetition_stack["$empty?"]())&&l.repetition_stack["$<<"](A),A=[A],h(l.next_note_marks["$[]"]("measure"))&&(k=[!0],_(A.$first(),"measure_start=",t.to_a(k)),k[e(k.length,1)],k=["measure",!1],_(l.next_note_marks,"[]=",t.to_a(k)),k[e(k.length,1)]),l.$_make_repeats_jumps_annotations(A,r,i),A},R.$$arity=3),t.defn(ct,"$_transform_tempo",q=function(e,n,a){var i=this,o=u,s=u;return null==p.log&&(p.log=u),e["$[]"]("istart")["$=="](i.meta_data["$[]"]("tempo")["$[]"]("sym")["$[]"]("istart"))?u:(o=i.$charpos_to_line_column(e["$[]"]("istart")),s=i.$charpos_to_line_column(e["$[]"]("iend")),p.log.$error(r("abc:"+o.$first()+":"+o.$last()+" Error: ",t.const_get_relative(ut,"I18n").$t("tempo change not suported by zupfnoter")),o,s))},q.$$arity=3),t.defn(ct,"$_transform_yspace",D=function(t,e){return u},D.$$arity=2),t.defn(ct,"$_transform_bar_repeat_end",z=function(r,n,a){var o=this,s=u,c=u,l=u,f=u,$=u,g=u,m=u;return null==p.conf&&(p.conf=u),s=o.repetition_stack.$length(),c=s["$=="](1)?o.repetition_stack.$last():o.repetition_stack.$pop(),l=o.$_extract_goto_info_from_bar(r),f=function(){try{return l.$last()["$[]"]("distance")}catch(e){if(!t.rescue(e,[t.const_get_relative(ut,"StandardError")]))throw e;try{return[2]}finally{t.pop_exception()}}}(),h(i(f.$count(),1))&&o.$raise("too many distance values for repeat end. Need only one "+f),h(o.previous_note["$is_a?"](t.const_get_qualified(t.const_get_qualified(t.const_get_relative(ut,"Harpnotes"),"Music"),"Pause")))&&p.conf["$[]"]("restposition.repeatend")["$=="]("previous")&&($=[o.previous_note.$prev_pitch()],_(o.previous_note,"pitch=",t.to_a($)),$[e($.length,1)]),f=f.$first(),$=["first_in_part",!0],_(o.next_note_marks,"[]=",t.to_a($)),$[e($.length,1)],g=o.previous_note,m="notebound.c_jumplines."+a+"."+g.$znid()+".p_repeat",[t.const_get_qualified(t.const_get_qualified(t.const_get_relative(ut,"Harpnotes"),"Music"),"Goto").$new(o.previous_note,c,d(["distance","is_repeat","level","conf_key"],{distance:f,is_repeat:!0,level:s,conf_key:m}))]},z.$$arity=3),t.defn(ct,"$_transform_grace",U=function(){return u},U.$$arity=0),t.defn(ct,"$_transform_format",H=function(t){return u},H.$$arity=1),t.defn(ct,"$_transform_key",G=function(t){return u},G.$$arity=1),t.defn(ct,"$_transform_meter",Y=function(e){var n=this,a=u,i=u;return null==p.log&&(p.log=u),h(n.next_note_marks["$[]"]("measure"))||(a=n.$charpos_to_line_column(e["$[]"]("istart")),i=n.$charpos_to_line_column(e["$[]"]("iend")),p.log.$warning(r("abc:"+a.$first()+":"+a.$last()+" Error: ",t.const_get_relative(ut,"I18n").$t("Meter change not at beginning of measure")),a,i)),n.is_first_measure=!0,n.wmeasure=e["$[]"]("wmeasure"),n.countby=function(){try{return e["$[]"]("a_meter").$first()["$[]"]("bot").$to_i()}catch(e){if(!t.rescue(e,[t.const_get_relative(ut,"StandardError")]))throw e;try{return u}finally{t.pop_exception()}}}(),u},Y.$$arity=1),t.defn(ct,"$_transform_block",V=function(t){return u},V.$$arity=1),t.defn(ct,"$_transform_clef",Q=function(t){return u},Q.$$arity=1),t.defn(ct,"$_make_variant_ending_jumps",X=function(e){var r,n=this,a=u,i=u;return a=[],i=function(){return h(n.variant_endings.$last()["$empty?"]())?-2:-1}(),_(n.variant_endings["$[]"](t.Range.$new(0,i,!1)),"each",[],(r=function(n){var i,o,s=r.$$s||this,c=u,l=u,f=u,$=u,p=u;return null==n&&(n=u),c=n["$[]"](0)["$[]"]("distance"),l=n.$first()["$[]"]("rbstop"),f="notebound.c_jumplines."+e+"."+l.$znid(),$=h(n["$[]"](-1)["$[]"]("is_followup"))?-2:-1,_(n["$[]"](t.Range.$new(1,$,!1)),"each_with_index",[],(i=function(e,r){var o=(i.$$s,u);return null==e&&(e=u),null==r&&(r=u),o=f+"."+r+".p_begin",a["$<<"](t.const_get_qualified(t.const_get_qualified(t.const_get_relative(ut,"Harpnotes"),"Music"),"Goto").$new(n["$[]"](0)["$[]"]("rbstop"),e["$[]"]("rbstart"),d(["conf_key","distance","from_anchor","to_anchor"],{conf_key:o,distance:c["$[]"](0),from_anchor:"after",to_anchor:"before"})))},i.$$s=s,i.$$arity=2,i)),_(n["$[]"](m(1,-3,!1)),"each_with_index",[],(o=function(e,r){var i=(o.$$s,u);return null==e&&(e=u),null==r&&(r=u),h(e["$[]"]("repeat_end"))?u:(i=f+".p_end",a["$<<"](t.const_get_qualified(t.const_get_qualified(t.const_get_relative(ut,"Harpnotes"),"Music"),"Goto").$new(e["$[]"]("rbstop"),n["$[]"](-1)["$[]"]("rbstart"),d(["conf_key","distance","from_anchor","to_anchor","vertical_anchor"],{conf_key:i,distance:c["$[]"](1),from_anchor:"after",to_anchor:"before",vertical_anchor:"to"}))))},o.$$s=s,o.$$arity=2,o)),h(n["$[]"](-1)["$[]"]("is_followup"))?(p=f+".p_follow",a["$<<"](t.const_get_qualified(t.const_get_qualified(t.const_get_relative(ut,"Harpnotes"),"Music"),"Goto").$new(n["$[]"](-2)["$[]"]("rbstop"),n["$[]"](-1)["$[]"]("rbstart"),d(["conf_key","distance","from_anchor","to_anchor","vertical_anchor"],{conf_key:p,distance:c["$[]"](2),from_anchor:"after",to_anchor:"before",vertical_anchor:"to"})))):u},r.$$s=n,r.$$arity=1,r)),a},X.$$arity=1),t.defn(ct,"$_make_jumplines",J=function(e,r){var n,a=this,i=u;return h(e["$is_a?"](t.const_get_qualified(t.const_get_qualified(t.const_get_relative(ut,"Harpnotes"),"Music"),"Playable")))?(i=a.$_extract_goto_info_from_bar(e.$origin()["$[]"]("raw_voice_element")),_(i,"inject",[[]],(n=function(a,i){var o,s=n.$$s||this,c=u,l=u,f=u,$=u;return null==s.jumptargets&&(s.jumptargets=u),null==p.log&&(p.log=u),null==a&&(a=u),null==i&&(i=u),c=i["$[]"]("target"),l=s.jumptargets["$[]"](c),f="notebound.c_jumplines."+r+"."+e.$znid()+".p_goto",$=h(o=i["$[]"]("distance").$first())?o:2,h(l["$nil?"]())?p.log.$error("target '"+c+"' not found in voice at "+e.$start_pos_to_s(),e.$start_pos(),e.$end_pos()):a["$<<"](t.const_get_qualified(t.const_get_qualified(t.const_get_relative(ut,"Harpnotes"),"Music"),"Goto").$new(e,l,d(["conf_key","distance"],{conf_key:f,distance:$}))),a},n.$$s=a,n.$$arity=2,n))):u},J.$$arity=2),t.defn(ct,"$_make_notebound_annotations",W=function(r,n){var a,o=this,s=u,c=u;return s=[],h(r["$is_a?"](t.const_get_qualified(t.const_get_qualified(t.const_get_relative(ut,"Harpnotes"),"Music"),"Playable")))&&(c=o.$_extract_chord_lines(r.$origin()["$[]"]("raw_voice_element")),_(c,"each_with_index",[],(a=function(o,c){var l,f,$,g,m,v=a.$$s||this,y=u,b=u,w=u,x=u,A=u,k=u,E=u,S=u,N=u,C=u,I=u;return null==v.annotations&&(v.annotations=u),null==p.log&&(p.log=u),null==p.conf&&(p.conf=u),null==o&&(o=u),null==c&&(c=u),y=o.$match(/^([!#\<\>])([^\@]+)?(\@(\-?[0-9\.]+),(\-?[0-9\.]+))?$/),h(y)?(b=y["$[]"](1),w=y["$[]"](2),h(y["$[]"](4))&&(x=y["$[]"](4)),h(y["$[]"](5))&&(A=y["$[]"](5)),k=b,"#"["$==="](k)?(E=v.annotations["$[]"](w),h(E)||p.log.$error("could not find annotation "+w,r.$start_pos(),r.$end_pos())):"!"["$==="](k)?E=d(["text","style"],{text:w,style:"regular"}):"<"["$==="](k)?(S=[d(["dir","size","style"],{dir:-1,size:w,style:"regular"})],_(r,"shift=",t.to_a(S)),S[e(S.length,1)],h(r["$is_a?"](t.const_get_qualified(t.const_get_qualified(t.const_get_relative(ut,"Harpnotes"),"Music"),"SynchPoint")))&&_(r.$notes(),"each",[],(l=function(r){l.$$s;return null==r&&(r=u),S=[d(["dir","size","style"],{dir:-1,size:w,style:"regular"})],_(r,"shift=",t.to_a(S)),S[e(S.length,1)]},l.$$s=v,l.$$arity=1,l))):">"["$==="](k)?(S=[d(["dir","size","style"],{dir:1,size:w,style:"regular"})],_(r,"shift=",t.to_a(S)),S[e(S.length,1)],h(r["$is_a?"](t.const_get_qualified(t.const_get_qualified(t.const_get_relative(ut,"Harpnotes"),"Music"),"SynchPoint")))&&_(r.$notes(),"each",[],(f=function(r){f.$$s;return null==r&&(r=u),S=[d(["dir","size","style"],{dir:1,size:w,style:"regular"})],_(r,"shift=",t.to_a(S)),S[e(S.length,1)]},f.$$s=v,f.$$arity=1,f))):E=u,h(E)?(h(x)&&(N=_([x,A],"map",[],($=function(t){$.$$s;return null==t&&(t=u),t.$to_f()},$.$$s=v,$.$$arity=1,$))),C=h(g=h(m=N)?m:E["$[]"]("pos"))?g:p.conf["$[]"]("defaults.notebound.annotation.pos"),h(r.$znid())&&(I="notebound.annotation."+n+"."+r.$znid()),h(i(c,0))&&(I="notebound.annotation."+n+"."+r.$znid()+"."+c),s["$<<"](t.const_get_qualified(t.const_get_qualified(t.const_get_relative(ut,"Harpnotes"),"Music"),"NoteBoundAnnotation").$new(r,d(["style","pos","text"],{style:E["$[]"]("style"),pos:C,text:E["$[]"]("text")}),I))):u):u},a.$$s=o,a.$$arity=2,a))),s},W.$$arity=2),t.defn(ct,"$_make_repeats_jumps_annotations",K=function(r,n,a){var i,o,s=this,c=u,l=u,f=u,$=u,g=u,v=u,y=u,b=u;return null==p.conf&&(p.conf=u),c=r.$first(),l=s.part_table["$[]"](n["$[]"]("time")),h(s.previous_note)&&(f=[c.$pitch()],_(s.previous_note,"next_pitch=",t.to_a(f)),f[e(f.length,1)],f=[c],_(s.previous_note,"next_playable=",t.to_a(f)),f[e(f.length,1)],h(l)&&(f=[!0],_(s.previous_note,"next_first_in_part=",t.to_a(f)),f[e(f.length,1)]),f=[s.previous_note.$pitch()],_(c,"prev_pitch=",t.to_a(f)),f[e(f.length,1)],f=[s.previous_note],_(c,"prev_playable=",t.to_a(f)),f[e(f.length,1)]),s.previous_note=c,$=c.$znid(),h(l)&&(h($)&&(g="notebound.partname."+a+"."+$),v=p.conf["$[]"]("defaults.notebound.partname.pos"),f=[!0],_(r.$first(),"first_in_part=",t.to_a(f)),f[e(f.length,1)],r["$<<"](t.const_get_qualified(t.const_get_qualified(t.const_get_relative(ut,"Harpnotes"),"Music"),"NoteBoundAnnotation").$new(r.$first(),d(["style","pos","text"],{style:"regular",pos:v,text:l}),g))),h(s.next_note_marks["$[]"]("repeat_start"))&&(f=[!0],_(s.previous_note,"first_in_part=",t.to_a(f)),f[e(f.length,1)],s.repetition_stack["$<<"](r.$first()),f=["repeat_start",!1],_(s.next_note_marks,"[]=",t.to_a(f)),f[e(f.length,1)]),h(s.next_note_marks["$[]"]("first_in_part"))&&(f=[!0],_(s.previous_note,"first_in_part=",t.to_a(f)),f[e(f.length,1)],f=["first_in_part",!1],_(s.next_note_marks,"[]=",t.to_a(f)),f[e(f.length,1)]),h(s.next_note_marks["$[]"]("variant_ending"))&&(y=s.next_note_marks["$[]"]("variant_ending")["$[]"]("text"),h($)&&(g="notebound.variantend."+a+"."+$),v=p.conf["$[]"]("defaults.notebound.variantend.pos"),f=[!0],_(r.$first(),"first_in_part=",t.to_a(f)),f[e(f.length,1)],r["$<<"](t.const_get_qualified(t.const_get_qualified(t.const_get_relative(ut,"Harpnotes"),"Music"),"NoteBoundAnnotation").$new(r.$first(),d(["style","pos","text","policy"],{style:"regular",pos:v,text:y,policy:"Goto"}),g)),f=["variant_ending",u],_(s.next_note_marks,"[]=",t.to_a(f)),f[e(f.length,1)],s.variant_endings.$last().$push(d([],{})),f=["rbstart",s.previous_note],_(s.variant_endings.$last().$last(),"[]=",t.to_a(f)),f[e(f.length,1)]),h(s.next_note_marks["$[]"]("variant_followup"))&&(f=[!0],_(s.previous_note,"first_in_part=",t.to_a(f)),f[e(f.length,1)],s.variant_endings["$[]"](-2).$push(d(["rbstart","is_followup"],{rbstart:s.previous_note,is_followup:!0})),f=["variant_followup",!1],_(s.next_note_marks,"[]=",t.to_a(f)),f[e(f.length,1)]),b=s.$_extract_chord_lines(n),_(_(b,"select",[],(i=function(t){i.$$s;return null==t&&(t=u),t["$[]"](0)["$=="](":")},i.$$s=s,i.$$arity=1,i)),"each",[],(o=function(n){var a,i=o.$$s||this;return null==i.jumptargets&&(i.jumptargets=u),null==n&&(n=u),f=[n["$[]"](m(1,-1,!1)),_(r,"select",[],(a=function(e){a.$$s;return null==e&&(e=u),e["$is_a?"](t.const_get_qualified(t.const_get_qualified(t.const_get_relative(ut,"Harpnotes"),"Music"),"Playable"))},a.$$s=i,a.$$arity=1,a)).$last()],_(i.jumptargets,"[]=",t.to_a(f)),f[e(f.length,1)]},o.$$s=s,o.$$arity=1,o))},K.$$arity=3),t.defn(ct,"$_get_extra",Z=function(e,r){var n,a,i=this;return function(){try{return h(n=e["$[]"]("extra"))?_(e["$[]"]("extra"),"select",[],(a=function(t){a.$$s;return null==t&&(t=u),t["$[]"]("type").$to_s()["$=="](r.$to_s())},a.$$s=i,a.$$arity=1,a)).$first():n}catch(e){if(!t.rescue(e,[t.const_get_relative(ut,"StandardError")]))throw e;try{return u}finally{t.pop_exception()}}}()},Z.$$arity=2),t.defn(ct,"$_push_slur",tt=function(){var t=this;return t.slurstack=r(t.slurstack,1)},tt.$$arity=0),t.defn(ct,"$_pop_slur",et=function(){var t=this,r=u;return r=t.slurstack,t.slurstack=e(t.slurstack,1),h(s(t.slurstack,0))&&(t.slurstack=0),r},et.$$arity=0),t.defn(ct,"$_extract_chord_lines",rt=function(r){var n,a,i=this,o=u;return o=r["$[]"]("a_gch"),h(o)?_(_(o,"select",[],(n=function(r){var a=(n.$$s,u);return null==r&&(r=u),a=["type","^"],_(r,"[]=",t.to_a(a)),a[e(a.length,1)]},n.$$s=i,n.$$arity=1,n)),"map",[],(a=function(t){a.$$s;return null==t&&(t=u),t["$[]"]("text")},a.$$s=i,a.$$arity=1,a)):[]},rt.$$arity=1),t.defn(ct,"$_extract_goto_info_from_bar",nt=function(t){var e,r=this,n=u;return n=r.$_extract_chord_lines(t),_(n,"inject",[[]],(e=function(r,n){var a,i=e.$$s||this,o=u,s=u,c=u,l=u,f=u;return null==p.log&&(p.log=u),null==r&&(r=u),null==n&&(n=u),h(n["$start_with?"]("@"))&&(o=n.$match(/^^@([^\@]*)@(\-?\d*)(,(\-?\d*),(\-?\d*))?$/),h(o)?(s=o["$[]"](1),c=_([2,4,5],"map",[],(a=function(t){a.$$s;return null==t&&(t=u),h(o["$[]"](t))?o["$[]"](t).$to_i():u},a.$$s=i,a.$$arity=1,a)).$compact(),r.$push(d(["target","distance"],{target:s,distance:c}))):(l=i.$charpos_to_line_column(t["$[]"]("istart")),f=i.$charpos_to_line_column(t["$[]"]("iend")),p.log.$error("Syntax-Error in Jump anotation",l,f))),r},e.$$s=r,e.$$arity=2,e))},nt.$$arity=1),t.defn(ct,"$_parse_decorations",at=function(t){var e,r,n,a=this,i=u,o=u;return i=h(e=t["$[]"]("a_dd"))?e:[],o=_(i,"map",[],(r=function(t){r.$$s;return null==t&&(t=u),o=t["$[]"]("name").$to_sym()},r.$$s=a,r.$$arity=1,r)),_(o.$flatten(),"select",[],(n=function(t){n.$$s;return null==t&&(t=u),["fermata","emphasis"]["$include?"](t)},n.$$s=a,n.$$arity=1,n))},at.$$arity=1),t.defn(ct,"$_parse_origin",it=function(t){return d(["startChar","endChar","start_pos","end_pos","raw_voice_element"],{startChar:t["$[]"]("istart"),endChar:t["$[]"]("iend"),start_pos:t["$[]"]("start_pos"),end_pos:t["$[]"]("end_pos"),raw_voice_element:t})},it.$$arity=1),t.defn(ct,"$_parse_slur",ot=function(t){var e,r=u,n=u;for(r=h(e=t)?e:0,n=[];h(i(r,0));)n.$push(r["$&"](15)),r=r["$>>"](4);return n},ot.$$arity=1),t.defn(ct,"$_parse_tuplet_info",st=function(e){var n=this,a=u,i=u,o=u,s=u,c=u;return null==p.log&&(p.log=u),h(e["$[]"]("in_tuplet"))?(h(e["$[]"]("tp1"))&&(a=n.$charpos_to_line_column(e["$[]"]("istart")),i=n.$charpos_to_line_column(e["$[]"]("iend")),p.log.$error(r("abc:"+a.$first()+":"+a.$last()+" Error: ",t.const_get_relative(ut,"I18n").$t("Nested Tuplet")),a,i)),h(e["$[]"]("tp0"))?(n.tuplet_p=e["$[]"]("tp0"),o=!0):o=u,s=n.tuplet_p,c=!!h(e["$[]"]("te0"))||u):(s=1,o=u,c=u),[s,c,o]},st.$$arity=1)}(b[0],t.const_get_relative(b,"AbstractAbcToHarpnotes"),b)}(b[0],b)}(l[0],l)},Opal.modules["opal-jspdf"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t*e:t["$*"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}function n(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}function a(t,e){return"number"==typeof t&&"number"==typeof e?t/e:t["$/"](e)}var i=t.top,o=[],s=t.nil,c=(t.breaker,t.slice,t.klass),l=t.truthy,u=t.send;return t.add_stubs(["$require","$attr_accessor","$apply_offset_to_point","$[]","$nil?","$start_with?","$raise","$to_n","$map","$*","$-","$==","$+","$/","$private","$first","$last"]),
i.$require("native"),function(i,o,f){function $(){}var _,d,p,h,g,m,v,y,b,w,x,A,k,E,S,N,C,I,O,P,L,M,T=$=c(i,null,"JsPDF",$),B=T.$$proto;[T].concat(f);return B.native_jspdf=B.x_offset=B.y_offset=s,T.$attr_accessor("x_offset","y_offset"),t.defn(T,"$initialize",_=function(t,e,r){var n=this;return null==t&&(t="p"),null==e&&(e="mm"),null==r&&(r="a4"),n.x_offset=0,n.y_offset=0,n.native_jspdf=new jsPDF(t,e,r)},_.$$arity=-1),t.defs(T,"$jspdfversion",d=function(){return jsPDF.version},d.$$arity=0),t.defn(T,"$line",p=function(t,e){var r=this,n=s,a=s;return n=r.$apply_offset_to_point(t),a=r.$apply_offset_to_point(e),r.native_jspdf.lines([[a[0]-n[0],a[1]-n[1]]],n[0],n[1])},p.$$arity=2),t.defn(T,"$line_cap=",h=function(t){return this.native_jspdf.setLineCap(t)},h.$$arity=1),t.defn(T,"$ellipse",g=function(t,e,r){var n=this,a=s;return null==r&&(r=void 0),a=n.$apply_offset_to_point(t),n.native_jspdf.ellipse(a["$[]"](0),a["$[]"](1),e["$[]"](0),e["$[]"](1),r)},g.$$arity=-3),t.defn(T,"$fill=",m=function(t){return this.native_jspdf.setFillColor(t[0],t[1],t[2])},m.$$arity=1),t.defn(T,"$stroke=",v=function(t){return this.native_jspdf.setDrawColor(t[0],t[1],t[2])},v.$$arity=1),t.defn(T,"$line_width=",y=function(t){return this.native_jspdf.setLineWidth(t)},y.$$arity=1),t.defn(T,"$line_dash=",b=function(t){var e=this;return null==t&&(t=3),l(t["$nil?"]())&&(t=void 0),e.native_jspdf.setLineDash([t,t],t)},b.$$arity=-1),t.defn(T,"$text_color=",w=function(t){return this.native_jspdf.setTextColor(t[0],t[1],t[2])},w.$$arity=1),t.defn(T,"$font_size=",x=function(t){return this.native_jspdf.setFontSize(t)},x.$$arity=1),t.defn(T,"$font_style=",A=function(t){return this.native_jspdf.setFontStyle(t)},A.$$arity=1),t.defn(T,"$use_solid_lines",k=function(){return this.native_jspdf.setLineDash("",0)},k.$$arity=0),t.defn(T,"$image",E=function(e,r,n,a){var i,o,c=this,u=s,f=s,$=s;return o=c.$apply_offset_to_point([r,n]),i=t.to_ary(o),u=null==i[0]?s:i[0],f=null==i[1]?s:i[1],$=s,l(e["$start_with?"]("data:image/jpeg"))&&($="jpeg"),l(e["$start_with?"]("data:image/png"))&&($="png"),l($)?c.native_jspdf.addImage(e,$,u,f,0,a):c.$raise("image format not supported for pdf: "+$)},E.$$arity=4),t.defn(T,"$text",S=function(e,r,n,a){var i,o,c=this,l=s,u=s;return null==a&&(a=s),o=c.$apply_offset_to_point([e,r]),i=t.to_ary(o),l=null==i[0]?s:i[0],u=null==i[1]?s:i[1],c.native_jspdf.text(l,u,n,a.$to_n())},S.$$arity=-4),t.defn(T,"$rect_like_ellipse",N=function(t,n,a){var i,o=this,c=s,l=s;return null==a&&(a="undefined"),c=o.$apply_offset_to_point(t),l=u(n,"map",[],(i=function(t){i.$$s;return null==t&&(t=s),e(2,t)},i.$$s=o,i.$$arity=1,i)),o.native_jspdf.rect(r(c["$[]"](0),n["$[]"](0)),r(c["$[]"](1),n["$[]"](1)),l["$[]"](0),l["$[]"](1),a)},N.$$arity=-3),t.defn(T,"$rect",C=function(e,r,n,a,i){var o,c,l=this,u=s,f=s;return null==i&&(i="undefined"),c=l.$apply_offset_to_point([e,r]),o=t.to_ary(c),u=null==o[0]?s:o[0],f=null==o[1]?s:o[1],l.native_jspdf.rect(u,f,n,a,i)},C.$$arity=-5),t.defn(T,"$lines",I=function(e,r,n,a,i,o){var c,l,u=this,f=s,$=s;return l=u.$apply_offset_to_point([r,n]),c=t.to_ary(l),f=null==c[0]?s:c[0],$=null==c[1]?s:c[1],u.native_jspdf.lines(e,f,$,a,i,o)},I.$$arity=6),t.defn(T,"$output",O=function(t,e){var r=this;return null==t&&(t="raw"),null==e&&(e=s),t["$=="]("raw")&&(t=void 0),l(e["$nil?"]())&&(e=void 0),r.native_jspdf.output(t,e)},O.$$arity=-1),t.defn(T,"$left_arrowhead",P=function(e,i){var o,c,l=this,u=s,f=s,$=s,_=s,d=s,p=s,h=s;return u=1,c=l.$apply_offset_to_point([e,i]),o=t.to_ary(c),f=null==o[0]?s:o[0],$=null==o[1]?s:o[1],_=f,d=n(f,u),p=n($,a(u,2)),h=r($,a(u,2)),l.native_jspdf.triangle(_,$,d,p,d,h,_,$,"FD")},P.$$arity=2),t.defn(T,"$addPage",L=function(){return this.native_jspdf.addPage()},L.$$arity=0),T.$private(),t.defn(T,"$apply_offset_to_point",M=function(t){var e=this;return[n(t.$first(),e.x_offset),n(t.$last(),e.y_offset)]},M.$$arity=1),s&&"apply_offset_to_point"}(o[0],0,o)},Opal.modules["opal-jszip"]=function(t){var e=(t.top,[]),r=t.nil,n=(t.breaker,t.slice,t.module),a=t.klass;return t.add_stubs(["$new","$to_blob"]),function(e,i){var o,s=o=n(e,"JSZip"),c=(s.$$proto,[s].concat(i));!function(e,n,i){function o(){}var s,c,l,u,f,$,_=o=a(e,null,"ZipFile",o),d=(_.$$proto,[_].concat(i));t.defn(_,"$initialize",s=function(){return this.zip=new JSZip},s.$$arity=0),t.defn(_,"$folder",c=function(e){var r=this;return t.const_get_relative(d,"Folder").$new(r.zip.folder(e))},c.$$arity=1),t.defn(_,"$file",l=function(t,e){return this.zip.file(t,e)},l.$$arity=2),t.defn(_,"$to_blob",u=function(){return this.zip.generate({type:"blob"})},u.$$arity=0),t.defn(_,"$to_blob_url",f=function(){var t=this,e=r;return e=t.$to_blob(),window.URL.createObjectURL(e)},f.$$arity=0),t.defn(_,"$to_base64",$=function(){return this.zip.generate()},$.$$arity=0)}(c[0],0,c),function(e,r,n){function i(){}var o,s,c=i=a(e,null,"Folder",i);c.$$proto,[c].concat(n);t.defn(c,"$initialize",o=function(t){return this.folder=t},o.$$arity=1),t.defn(c,"$file",s=function(t,e){return this.folder.file(t,e)},s.$$arity=2)}(c[0],0,c)}(e[0],e)},Opal.modules.pdf_engine=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t*e:t["$*"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}function n(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}function a(t,e){return"number"==typeof t&&"number"==typeof e?t/e:t["$/"](e)}var i=t.top,o=[],s=t.nil,c=(t.breaker,t.slice,t.module),l=t.klass,u=t.hash2,f=t.gvars,$=t.send,_=t.truthy,d=t.range;return t.add_stubs(["$require","$include","$attr_reader","$new","$*","$[]","$last","$printer_config","$y_offset=","$-","$each","$draw_segment","$+","$first","$x_offset=","$draw_sheet","$addPage","$rect","$children","$line_width","$line_width=","$is_a?","$visible?","$draw_ellipse","$draw_flowline","$draw_glyph","$draw_path","$draw_annotation","$draw_image","$error","$class","$private","$get","$style","$text_color=","$font_size=","$font_style=","$align","$gsub","$text","$==","$split","$empty?","$center","$color","$filled?","$size","$stroke=","$fill=","$rect?","$rect_like_ellipse","$ellipse","$fill","$map","$/","$dotted?","$draw_the_dot","$hasbarover","$draw_the_barover","$glyph","$===","$lines","$push","$hasbarover?","$dashed?","$line_dash=","$line","$from","$to","$use_solid_lines","$clone","$[]=","$distance","$nil?","$level","$left_arrowhead","$Vector2d","$llpos","$height","$image","$url","$x","$y","$opacity","$line_cap=","$path","$inject","$flatten"]),i.$require("opal-jspdf"),i.$require("harpnotes"),function(i,o){var p,h=p=c(i,"Harpnotes"),g=(h.$$proto,[h].concat(o));!function(i,o,c){function p(){}var h,g,m,v,y,b,w,x,A,k,E,S,N,C,I=p=l(i,null,"PDFEngine",p),O=I.$$proto,P=[I].concat(c);O.pdf=s,I.$include(t.const_get_qualified(t.const_get_relative(P,"Harpnotes"),"Drawing")),I.$attr_reader("pdf"),t.const_set(P[0],"PADDING",4),t.const_set(P[0],"JUMPLINE_INDENT",10),t.const_set(P[0],"JUMPLINE_INDENT",10),t.const_set(P[0],"DOTTED_SIZE",.5),t.const_set(P[0],"COLORS",u(["black","white","grey","lightgrey","darkgrey","dimgrey"],{black:[0,0,0],white:[255,255,255],grey:[128,128,128],lightgrey:[211,211,211],darkgrey:[169,169,169],dimgrey:[105,105,105]})),t.defn(I,"$initialize",h=function(){return this.pdf=t.const_get_relative(P,"JsPDF").$new("l","mm","a3")},h.$$arity=0),t.defn(I,"$draw_in_segments",g=function(a){var i,o,c=this,l=s,u=s,d=s,p=s;return null==f.conf&&(f.conf=s),l=e(-12,f.conf["$[]"]("layout.X_SPACING")),c.pdf=t.const_get_relative(P,"JsPDF").$new("p","mm","a4"),u=[a.$printer_config()["$[]"]("a4_offset").$last()],$(c.pdf,"y_offset=",t.to_a(u)),u[r(u.length,1)],d=!1,p=_(i=a.$printer_config()["$[]"]("a4_pages"))?i:[0,1,2],$(p,"each",[],(o=function(t){var r=o.$$s||this;return null==t&&(t=s),r.$draw_segment(n(n(30,a.$printer_config()["$[]"]("a4_offset").$first()),e(t,l)),a,d),d=!0},o.$$s=c,o.$$arity=1,o)),c.pdf},g.$$arity=1),t.defn(I,"$draw",m=function(e){var r,n,a=this;return n=e.$printer_config()["$[]"]("a3_offset"),r=t.to_ary(n),a.pdf["$x_offset="](null==r[0]?s:r[0]),a.pdf["$y_offset="](null==r[1]?s:r[1]),a.$draw_sheet(e)},m.$$arity=1),t.defn(I,"$draw_segment",v=function(e,n,a){var i=this,o=s;return null==a&&(a=!1),o=[e],$(i.pdf,"x_offset=",t.to_a(o)),o[r(o.length,1)],_(a)&&i.pdf.$addPage(),i.$draw_sheet(n)},v.$$arity=-3),t.defn(I,"$draw_sheet",y=function(e){var n,a=this;return _(e.$printer_config()["$[]"]("show_border"))&&(a.pdf.$rect(1,1,418,295),a.pdf.$rect(0,0,420,297)),$(e.$children(),"each",[],(n=function(e){var a=n.$$s||this,i=s;return null==a.pdf&&(a.pdf=s),null==f.log&&(f.log=s),null==e&&(e=s),i=[e.$line_width()],$(a.pdf,"line_width=",t.to_a(i)),i[r(i.length,1)],_(e["$is_a?"](t.const_get_relative(P,"Ellipse")))?_(e["$visible?"]())?a.$draw_ellipse(e):s:_(e["$is_a?"](t.const_get_relative(P,"FlowLine")))?_(e["$visible?"]())?a.$draw_flowline(e):s:_(e["$is_a?"](t.const_get_qualified(t.const_get_qualified(t.const_get_relative(P,"Harpnotes"),"Drawing"),"Glyph")))?_(e["$visible?"]())?a.$draw_glyph(e):s:_(e["$is_a?"](t.const_get_qualified(t.const_get_qualified(t.const_get_relative(P,"Harpnotes"),"Drawing"),"Path")))?_(e["$visible?"]())?a.$draw_path(e):s:_(e["$is_a?"](t.const_get_qualified(t.const_get_qualified(t.const_get_relative(P,"Harpnotes"),"Drawing"),"Annotation")))?_(e["$visible?"]())?a.$draw_annotation(e):s:_(e["$is_a?"](t.const_get_qualified(t.const_get_qualified(t.const_get_relative(P,"Harpnotes"),"Drawing"),"Image")))?a.$draw_image(e):(f.log.$error("BUG: don't know how to draw "+e.$class()+" (pdf_engine 74)"),s)},n.$$s=a,n.$$arity=1,n)),a.pdf},y.$$arity=1),I.$private(),t.defn(I,"$draw_annotation",b=function(a){var i,o,c=this,l=s,d=s,p=s,h=s,g=s;return null==f.conf&&(f.conf=s),l=_(i=f.conf.$get("layout.FONT_STYLE_DEF")["$[]"](a.$style()))?i:f.conf.$get("layout.FONT_STYLE_DEF")["$[]"]("regular"),d=f.conf.$get("layout.MM_PER_POINT"),p=[l["$[]"]("text_color")],$(c.pdf,"text_color=",t.to_a(p)),p[r(p.length,1)],p=[e(l["$[]"]("font_size"),.983)],$(c.pdf,"font_size=",t.to_a(p)),p[r(p.length,1)],p=[l["$[]"]("font_style")],$(c.pdf,"font_style=",t.to_a(p)),p[r(p.length,1)],h=_(i=a.$align())?i:"left",g=$(a.$text(),"gsub",[/(\\?)(~)/],(o=function(t){o.$$s;return null==t&&(t=s),t["$[]"](0)["$=="]("\\")?t["$[]"](1):" "},o.$$s=c,o.$$arity=1,o)),g=g.$split("\n"),_(g["$empty?"]())&&(g=[""]),c.pdf.$text(a.$center().$first(),n(a.$center().$last(),e(l["$[]"]("font_size"),d)),g,u(["align"],{align:h}))},b.$$arity=1),t.defn(I,"$draw_ellipse",w=function(e){var n,i=this,o=s,c=s,l=s,u=s;return o=t.const_get_relative(P,"COLORS")["$[]"](e.$color()),c=function(){return _(e["$filled?"]())?"F":"FD"}(),l=e.$size(),u=[0],$(i.pdf,"line_width=",t.to_a(u)),u[r(u.length,1)],u=[o],$(i.pdf,"stroke=",t.to_a(u)),u[r(u.length,1)],u=[function(){return _(e["$filled?"]())?o:t.const_get_relative(P,"COLORS")["$[]"]("white")}()],$(i.pdf,"fill=",t.to_a(u)),u[r(u.length,1)],_(e["$rect?"]())?i.pdf.$rect_like_ellipse(e.$center(),l,c):i.pdf.$ellipse(e.$center(),l,c),e.$fill()["$=="]("filled")||(u=[e.$line_width()],$(i.pdf,"line_width=",t.to_a(u)),u[r(u.length,1)],l=$(l,"map",[],(n=function(t){n.$$s;return null==t&&(t=s),r(t,a(e.$line_width(),2))},n.$$s=i,n.$$arity=1,n)),_(e["$rect?"]())?i.pdf.$rect_like_ellipse(e.$center(),l,c):i.pdf.$ellipse(e.$center(),l,c)),_(e["$dotted?"]())&&i.$draw_the_dot(e),_(e.$hasbarover())&&i.$draw_the_barover(e),u=[t.const_get_relative(P,"COLORS")["$[]"]("black")],$(i.pdf,"stroke=",t.to_a(u)),u[r(u.length,1)],u=[t.const_get_relative(P,"COLORS")["$[]"]("black")],$(i.pdf,"fill=",t.to_a(u)),u[r(u.length,1)]},w.$$arity=1),t.defn(I,"$draw_glyph",x=function(i){var o,c,l,u=this,p=s,h=s,g=s,m=s,v=s,y=s,b=s,w=s;return i["$filled?"]("FD","FD"),p=[$(d(0,3,!0),"map",[],(o=function(){o.$$s;return _(i["$filled?"]())?0:128},o.$$s=u,o.$$arity=0,o))],$(u.pdf,"fill=",t.to_a(p)),p[r(p.length,1)],h=[r(i.$center().$first(),i.$size().$first()),r(i.$center().$last(),i.$size().$last())],h=[i.$center().$first(),i.$center().$last()],g=[e(i.$size().$first(),2),e(i.$size().$last(),2)],m=a(g.$last(),i.$glyph()["$[]"]("h")),[i.$glyph()["$[]"]("w"),i.$glyph()["$[]"]("h")],$([i.$glyph()["$[]"]("w"),i.$glyph()["$[]"]("h")],"map",[],(c=function(t){c.$$s;return null==t&&(t=s),e(a(t,2),m)},c.$$s=u,c.$$arity=1,c)),v=t.const_get_relative(P,"COLORS")["$[]"]("white"),p=[v],$(u.pdf,"fill=",t.to_a(p)),p[r(p.length,1)],p=[v],$(u.pdf,"stroke=",t.to_a(p)),p[r(p.length,1)],u.pdf.$rect_like_ellipse(i.$center(),i.$size(),"FD"),v=t.const_get_relative(P,"COLORS")["$[]"](i.$color()),p=[v],$(u.pdf,"fill=",t.to_a(p)),p[r(p.length,1)],p=[v],$(u.pdf,"stroke=",t.to_a(p)),p[r(p.length,1)],y=[m,m],b=[],w=[],p=[1e-4],$(u.pdf,"line_width=",t.to_a(p)),p[r(p.length,1)],$(i.$glyph()["$[]"]("d"),"each",[],(l=function(t){var r=l.$$s||this,a=s;return null==r.pdf&&(r.pdf=s),null==f.log&&(f.log=s),null==t&&(t=s),function(){return a=t.$first(),"M"["$==="](a)?(b=[],w=[n(h.$first(),e(t["$[]"](1),y.$first())),n(h.$last(),e(t["$[]"](2),y.$last()))],_(b["$empty?"]())?s:r.pdf.$lines(b,w.$first(),w.$last(),y,"FD",!1)):"l"["$==="](a)?b.$push(t["$[]"](d(1,-1,!1))):"m"["$==="](a)?b.$push(t["$[]"](d(1,-1,!1))):"c"["$==="](a)?b.$push(t["$[]"](d(1,-1,!1))):"z"["$==="](a)?(_(b["$empty?"]())||r.pdf.$lines(b,w.$first(),w.$last(),y,"FD",!0),b=[]):f.log.$error("BUG: unsupported Pdf Path command '"+t.$first()+"' in glyph (pdf_engine 195)")}()},l.$$s=u,l.$$arity=1,l)),p=[[0,0,0]],$(u.pdf,"stroke=",t.to_a(p)),p[r(p.length,1)],_(i["$dotted?"]())&&u.$draw_the_dot(i),_(i["$hasbarover?"]())?u.$draw_the_barover(i):s},x.$$arity=1),t.defn(I,"$draw_the_dot",A=function(e){var a=this,i=s,o=s,c=s,l=s,u=s,f=s;return i=t.const_get_relative(P,"COLORS")["$[]"](e.$color()),o=n(t.const_get_relative(P,"DOTTED_SIZE"),e.$line_width()),c=n(t.const_get_relative(P,"DOTTED_SIZE"),e.$line_width()),l=n(e.$center().$first(),n(e.$size().$first(),o)),u=e.$center().$last(),f=[0],$(a.pdf,"line_width=",t.to_a(f)),f[r(f.length,1)],f=[[255,255,255]],$(a.pdf,"fill=",t.to_a(f)),f[r(f.length,1)],f=[[255,255,255]],$(a.pdf,"stroke=",t.to_a(f)),f[r(f.length,1)],a.pdf.$ellipse([l,u],[c,c],"FD"),f=[i],$(a.pdf,"fill=",t.to_a(f)),f[r(f.length,1)],f=[i],$(a.pdf,"stroke=",t.to_a(f)),f[r(f.length,1)],a.pdf.$ellipse([l,u],[t.const_get_relative(P,"DOTTED_SIZE"),t.const_get_relative(P,"DOTTED_SIZE")],"FD")},A.$$arity=1),t.defn(I,"$draw_the_barover",k=function(n){var a=this,i=s,o=s,c=s;return i=[t.const_get_relative(P,"COLORS")["$[]"](n.$color())],$(a.pdf,"fill=",t.to_a(i)),i[r(i.length,1)],o=[n.$center().$first(),r(r(n.$center().$last(),n.$size().$last()),e(1.3,n.$line_width()))],c=[n.$size().$first(),.2],a.pdf.$rect_like_ellipse(o,c,"F")},k.$$arity=1),t.defn(I,"$draw_flowline",E=function(e){var n=this,i=s,o=s;return i=t.const_get_relative(P,"COLORS")["$[]"](e.$color()),o=[i],$(n.pdf,"stroke=",t.to_a(o)),o[r(o.length,1)],_(e["$dashed?"]())&&(o=[a(3,2.84)],$(n.pdf,"line_dash=",t.to_a(o)),o[r(o.length,1)]),_(e["$dotted?"]())&&(o=[a(1.5,2.84)],$(n.pdf,"line_dash=",t.to_a(o)),o[r(o.length,1)]),n.pdf.$line(e.$from().$center(),e.$to().$center()),n.pdf.$use_solid_lines()},E.$$arity=1),t.defn(I,"$draw_jumpline",S=function(i){var o,c=this,l=s,u=s,f=s,p=s,h=s;return l=i.$from().$center().$clone(),u=[0,n(l["$[]"](0),t.const_get_relative(P,"PADDING"))],$(l,"[]=",t.to_a(u)),u[r(u.length,1)],u=[1,r(l["$[]"](1),a(t.const_get_relative(P,"PADDING"),4))],$(l,"[]=",t.to_a(u)),u[r(u.length,1)],f=i.$to().$center().$clone(),u=[0,n(f["$[]"](0),t.const_get_relative(P,"PADDING"))],$(f,"[]=",t.to_a(u)),u[r(u.length,1)],u=[1,n(f["$[]"](1),a(t.const_get_relative(P,"PADDING"),4))],$(f,"[]=",t.to_a(u)),u[r(u.length,1)],p=i.$distance(),h=_(p["$nil?"]())?r(418,e(i.$level(),t.const_get_relative(P,"JUMPLINE_INDENT"))):n(f["$[]"](0),p),u=[$(d(0,3,!0),"map",[],(o=function(){o.$$s;return 0},o.$$s=c,o.$$arity=0,o))],$(c.pdf,"stroke=",t.to_a(u)),u[r(u.length,1)],c.pdf.$line(f,[h,f["$[]"](1)]),c.pdf.$line([h,f["$[]"](1)],[h,l["$[]"](1)]),c.pdf.$line([h,l["$[]"](1)],l),c.pdf.$left_arrowhead(l["$[]"](0),l["$[]"](1))},S.$$arity=1),t.defn(I,"$draw_image",N=function(t){var e=this,r=s;return r=n(n(e.$Vector2d([0,0]),t.$llpos()),[0,t.$height()]),e.pdf.$image(t.$url(),r.$x(),r.$y(),t.$height(),t.$opacity())},N.$$arity=1),t.defn(I,"$draw_path",C=function(e){var a,i=this,o=s,c=s,l=s,u=s,p=s,h=s;return o=[],c=[1,1],l=[],u=function(){return _(e["$filled?"]())?"FD":"S"}(),p=t.const_get_relative(P,"COLORS")["$[]"](e.$color()),h=[function(){return _(e["$filled?"]())?p:t.const_get_relative(P,"COLORS")["$[]"]("white")}()],$(i.pdf,"fill=",t.to_a(h)),h[r(h.length,1)],h=[p],$(i.pdf,"stroke=",t.to_a(h)),h[r(h.length,1)],h=["round"],$(i.pdf,"line_cap=",t.to_a(h)),h[r(h.length,1)],$(e.$path(),"each",[],(a=function(t){var e,i=a.$$s||this,p=s,h=s;return null==i.pdf&&(i.pdf=s),null==f.log&&(f.log=s),null==t&&(t=s),function(){return p=t.$first(),"M"["$==="](p)?(_(o["$empty?"]())||i.pdf.$lines(o,l.$first(),l.$last(),c,u,!1),o=[],l=t["$[]"](d(1,2,!1))):"L"["$==="](p)?(h=$([[l],o].$flatten(1),"inject",[[0,0]],(e=function(t,r){e.$$s;return null==t&&(t=s),null==r&&(r=s),[n(r["$[]"](0),t["$[]"](-2)),n(r["$[]"](1),t["$[]"](-1))]},e.$$s=i,e.$$arity=2,e)),_(o["$empty?"]())||i.pdf.$lines(o,l.$first(),l.$last(),c,u,!1),o=[],l=h,o.$push([r(t["$[]"](1),h.$first()),r(t["$[]"](2),h.$last())])):"l"["$==="](p)?o.$push(t["$[]"](d(1,-1,!1))):"c"["$==="](p)?o.$push(t["$[]"](d(1,-1,!1))):"z"["$==="](p)?(_(o["$empty?"]())||i.pdf.$lines(o,l.$first(),l.$last(),c,"FD",!0),o=[]):f.log.$error("BUG: unsupported command '"+t.$first()+"' in glyph (pdf_engine 328)")}()},a.$$s=i,a.$$arity=1,a)),_(o["$empty?"]())?s:i.pdf.$lines(o,l.$first(),l.$last(),c,u,!1)},C.$$arity=1)}(g[0],0,g)}(o[0],o)},Opal.modules.init_conf=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}var r=(t.top,[]),n=t.nil,a=(t.breaker,t.slice,t.module),i=t.send,o=t.truthy,s=t.hash2,c=t.gvars,l=t.range;return t.add_stubs(["$join","$map","$each_with_index","$split","$between?","$lambda","$[]","$get","$cut_string_names","$year","$now","$t","$to_a","$first","$+","$last"]),function(r,u){var f,$,_,d=f=a(r,"InitConf"),p=(d.$$proto,[d].concat(u));t.defs(d,"$cut_string_names",$=function(t,e,r){var a,s=this;return i(t.$split(" ").$each_with_index(),"map",[],(a=function(t,i){a.$$s;return null==t&&(t=n),null==i&&(i=n),o(i["$between?"](e,r))?t:"~"},a.$$s=s,a.$$arity=2,a)).$join(" ")},$.$$arity=3),t.defs(d,"$init_conf",_=function(){var r,a,o,u,f,$,_,d,h,g,m,v,y,b,w,x,A,k,E,S,N,C,I,O,P,L,M,T,B,j,F,R,q=this,D=n;return D=["produce","annotations","restposition","default","repeatstart","repeatend","extract","title","filenamepart","startpos","voices","flowlines","subflowlines","synchlines","jumplines","repeatsigns","layoutlines","barnumbers","countnotes","legend","nonflowrest","lyrics","notes","images","tuplets","layout","printer","annotation","decoration","partname","variantend","countnote","c_jumplines","tuplet","minc","flowline","imagename","stringnames","limit_a3","LINE_THIN","LINE_MEDIUM","LINE_THICK","ELLIPSE_SIZE","REST_SIZE","DRAWING_AREA_SIZE","instrument","bottomup","beams","packer","pack_method","pack_max_spreadfactor","pack_min_increment","sortmark","show","fill","size","PITCH_OFFSET","X_OFFSET","X_SPACING","jumpline_anchor","jumpline_vcut","a3_offset","a4_offset","a4_pages","T01_number","T01_number_extract","T02_copyright_music","T03_copyright_harpnotes","T04_to_order","T05_printed_extracts","T99_do_not_copy","0","1","2","3","4","5","6","verses","cp1","cp2","shape","pos","hpos","height","vpos","spos","autopos","apbase","text","style","marks","resources","d64","d48","d32","d24","d16","d12","d8","d6","d4","d3","d2","d1"],s(["produce","abc_parser","restposition","template","wrap","defaults","templates","presets","annotations","extract","layout","neatjson"],{produce:[0],abc_parser:"ABC2SVG",restposition:s(["default","repeatstart","repeatend"],{default:"center",repeatstart:"next",repeatend:"default"}),template:s(["filebase","title"],{filebase:"-no-template-",title:"- no template -"}),wrap:60,defaults:s(["notebound"],{notebound:s(["annotation","partname","variantend","tuplet","flowline"],{annotation:s(["pos"],{pos:[5,-7]}),partname:s(["pos"],{pos:[-4,-7]}),variantend:s(["pos"],{pos:[-4,-7]}),tuplet:s(["cp1","cp2","shape","show"],{cp1:[5,2],cp2:[5,-2],shape:["c"],show:!0}),flowline:s(["cp1","cp2","shape","show"],{cp1:[0,10],cp2:[0,-10],shape:["c"],show:!0})})}),templates:s(["notes","lyrics","images","tuplet","annotations","extracts"],{notes:s(["pos","text","style"],{pos:[320,6],text:"ENTER_NOTE",style:"large"}),lyrics:s(["verses","pos","style"],{verses:[1],pos:[350,70],style:"regular"}),images:s(["imagename","show","pos","height"],{imagename:"",show:!0,pos:[10,10],height:100}),tuplet:s(["cp1","cp2","shape","show"],{cp1:[5,2],cp2:[5,-2],shape:["c"],show:!0}),annotations:s(["text","pos"],{text:"_vorlage_",pos:[-5,-6]}),extracts:s(["title","filenamepart","notes"],{title:"",filenamepart:"-",notes:s(["T01_number_extract"],{T01_number_extract:s(["text"],{text:"{{extract_filename}}"})})})}),presets:s(["barnumbers_countnotes","stdextract","layout","instrument","notes","printer"],{barnumbers_countnotes:s(["anchor_at_box","anchor_at_center"],{anchor_at_box:s(["barnumbers","countnotes"],{barnumbers:s(["apanchor","apbase"],{apanchor:"box",apbase:[1,1]}),countnotes:s(["apanchor","apbase"],{apanchor:"box",apbase:[1,-.5]})}),anchor_at_center:s(["barnumbers","countnotes"],{barnumbers:s(["apanchor","apbase"],{apanchor:"center",apbase:[1,.3]}),countnotes:s(["apanchor","apbase"],{apanchor:"center",apbase:[1,0]})})}),stdextract:s([],{}),layout:s(["notes_small","notes_regular","notes_large","notes_with_beams","-","packer_compact","packer_regular","--","color_on","color_off","---","jumpline_anchor_close","jumpline_anchor_medium","jumpline_anchor_wide","jumpline_open","jumpline_close"],{notes_small:s(["LINE_MEDIUM","LINE_THICK","ELLIPSE_SIZE","REST_SIZE","beams"],{LINE_MEDIUM:.2,LINE_THICK:.3,ELLIPSE_SIZE:[3.5,1.3],REST_SIZE:[4,1.5],beams:!1}),notes_regular:s(["LINE_MEDIUM","LINE_THICK","ELLIPSE_SIZE","REST_SIZE","beams"],{LINE_MEDIUM:i(q,"lambda",[],(r=function(){r.$$s;return null==c.conf&&(c.conf=n),c.conf["$[]"]("extract.0.layout.LINE_MEDIUM")},r.$$s=q,r.$$arity=0,r)),LINE_THICK:i(q,"lambda",[],(a=function(){a.$$s;return null==c.conf&&(c.conf=n),c.conf["$[]"]("extract.0.layout.LINE_THICK")},a.$$s=q,a.$$arity=0,a)),ELLIPSE_SIZE:i(q,"lambda",[],(o=function(){o.$$s;return null==c.conf&&(c.conf=n),c.conf["$[]"]("extract.0.layout.ELLIPSE_SIZE")},o.$$s=q,o.$$arity=0,o)),REST_SIZE:i(q,"lambda",[],(u=function(){u.$$s;return null==c.conf&&(c.conf=n),c.conf["$[]"]("extract.0.layout.REST_SIZE")},u.$$s=q,u.$$arity=0,u)),beams:!1}),notes_large:s(["LINE_MEDIUM","LINE_THICK","ELLIPSE_SIZE","REST_SIZE","beams"],{LINE_MEDIUM:.3,LINE_THICK:.7,ELLIPSE_SIZE:[4,2],REST_SIZE:[4,2],beams:!1}),notes_with_beams:s(["LINE_THIN","LINE_MEDIUM","LINE_THICK","ELLIPSE_SIZE","REST_SIZE","beams"],{LINE_THIN:.1,LINE_MEDIUM:.2,LINE_THICK:.5,ELLIPSE_SIZE:[1.3,1],REST_SIZE:[2,1.3],beams:!0}),"-":s([],{}),packer_compact:s(["packer"],{packer:s(["pack_method","pack_max_spreadfactor","pack_min_increment"],{pack_method:1,pack_max_spreadfactor:2,pack_min_increment:.2})}),packer_regular:s(["packer"],{packer:i(q,"lambda",[],(f=function(){f.$$s;return null==c.conf&&(c.conf=n),c.conf.$get("extract.0.layout.packer")},f.$$s=q,f.$$arity=0,f))}),"--":s([],{}),color_on:s(["color"],{color:s(["color_default","color_variant1","color_variant2"],{color_default:"black",color_variant1:"grey",color_variant2:"darkgrey"})}),color_off:s(["color"],{color:s(["color_default","color_variant1","color_variant2"],{color_default:"black",color_variant1:"black",color_variant2:"black"})}),"---":s([],{}),jumpline_anchor_close:s(["jumpline_anchor"],{jumpline_anchor:[3,1]}),jumpline_anchor_medium:s(["jumpline_anchor"],{jumpline_anchor:[5,1]}),jumpline_anchor_wide:s(["jumpline_anchor"],{jumpline_anchor:[10,1]}),jumpline_open:s(["jumpline_vcut"],{jumpline_vcut:3}),jumpline_close:s(["jumpline_vcut"],{jumpline_vcut:0})}),instrument:s(["37-strings-g-g","25-strings-g-g","25-strings-G-g Bass","21-strings-a-f","18-strings-b-e","saitenspiel","Zipino","Okon-Harfe"],{"37-strings-g-g":s(["layout","stringnames","printer"],{layout:s(["instrument","limit_a3","beams","bottomup","PITCH_OFFSET","X_SPACING","X_OFFSET"],{instrument:"37-strings-g-g",limit_a3:!0,beams:!1,bottomup:!1,PITCH_OFFSET:i(q,"lambda",[],($=function(){$.$$s;return null==c.conf&&(c.conf=n),c.conf["$[]"]("extract.0.layout.PITCH_OFFSET")},$.$$s=q,$.$$arity=0,$)),X_SPACING:i(q,"lambda",[],(_=function(){_.$$s;return null==c.conf&&(c.conf=n),c.conf["$[]"]("extract.0.layout.X_SPACING")},_.$$s=q,_.$$arity=0,_)),X_OFFSET:i(q,"lambda",[],(d=function(){d.$$s;return null==c.conf&&(c.conf=n),c.conf["$[]"]("extract.0.layout.X_OFFSET")},d.$$s=q,d.$$arity=0,d))}),stringnames:s(["text","marks"],{text:i(q,"lambda",[],(h=function(){h.$$s;return null==c.conf&&(c.conf=n),c.conf["$[]"]("extract.0.stringnames.text")},h.$$s=q,h.$$arity=0,h)),marks:s(["hpos"],{hpos:[43,79]})}),printer:s(["a4_pages","a4_offset","a3_offset"],{a4_pages:[0,1,2],a4_offset:i(q,"lambda",[],(g=function(){g.$$s;return null==c.conf&&(c.conf=n),c.conf["$[]"]("extract.0.printer.a4_offset")},g.$$s=q,g.$$arity=0,g)),a3_offset:i(q,"lambda",[],(m=function(){m.$$s;return null==c.conf&&(c.conf=n),c.conf["$[]"]("extract.0.printer.a3_offset")},m.$$s=q,m.$$arity=0,m))})}),"25-strings-g-g":s(["layout","stringnames","printer"],{layout:s(["instrument","limit_a3","beams","bottomup","PITCH_OFFSET","X_SPACING","X_OFFSET"],{instrument:"25-strings-g-g",limit_a3:!1,beams:!1,bottomup:!1,PITCH_OFFSET:i(q,"lambda",[],(v=function(){v.$$s;return null==c.conf&&(c.conf=n),c.conf["$[]"]("extract.0.layout.PITCH_OFFSET")},v.$$s=q,v.$$arity=0,v)),X_SPACING:i(q,"lambda",[],(y=function(){y.$$s;return null==c.conf&&(c.conf=n),c.conf["$[]"]("extract.0.layout.X_SPACING")},y.$$s=q,y.$$arity=0,y)),X_OFFSET:i(q,"lambda",[],(b=function(){b.$$s;return null==c.conf&&(c.conf=n),c.conf["$[]"]("extract.0.layout.X_OFFSET")},b.$$s=q,b.$$arity=0,b))}),stringnames:s(["text","marks"],{text:i(q,"lambda",[],(w=function(){var t=w.$$s||this;return null==c.conf&&(c.conf=n),t.$cut_string_names(c.conf["$[]"]("extract.0.stringnames.text"),12,36)},w.$$s=q,w.$$arity=0,w)),marks:s(["hpos"],{hpos:[55,79]})}),printer:s(["a4_pages","a3_offset","a4_offset"],{a4_pages:[1,2],a3_offset:[-5,0],a4_offset:i(q,"lambda",[],(x=function(){x.$$s;return null==c.conf&&(c.conf=n),c.conf["$[]"]("extract.0.printer.a4_offset")},x.$$s=q,x.$$arity=0,x))})}),"25-strings-G-g Bass":s(["layout","stringnames","printer"],{layout:s(["instrument","limit_a3","beams","bottomup","PITCH_OFFSET","X_SPACING","X_OFFSET"],{instrument:"25-strings-g-g",limit_a3:!1,beams:!1,bottomup:!1,PITCH_OFFSET:i(q,"lambda",[],(A=function(){A.$$s;return-31},A.$$s=q,A.$$arity=0,A)),X_SPACING:i(q,"lambda",[],(k=function(){k.$$s;return null==c.conf&&(c.conf=n),c.conf["$[]"]("extract.0.layout.X_SPACING")},k.$$s=q,k.$$arity=0,k)),X_OFFSET:i(q,"lambda",[],(E=function(){E.$$s;return null==c.conf&&(c.conf=n),c.conf["$[]"]("extract.0.layout.X_OFFSET")},E.$$s=q,E.$$arity=0,E))}),stringnames:s(["text","marks"],{text:i(q,"lambda",[],(S=function(){var t=S.$$s||this;return null==c.conf&&(c.conf=n),t.$cut_string_names(c.conf["$[]"]("extract.0.stringnames.text"),12,36)},S.$$s=q,S.$$arity=0,S)),marks:s(["hpos"],{hpos:[43,67]})}),printer:s(["a4_pages","a3_offset","a4_offset"],{a4_pages:[1,2],a3_offset:[-5,0],a4_offset:i(q,"lambda",[],(N=function(){N.$$s;return null==c.conf&&(c.conf=n),c.conf["$[]"]("extract.0.printer.a4_offset")},N.$$s=q,N.$$arity=0,N))})}),"21-strings-a-f":s(["layout","stringnames","printer"],{layout:s(["instrument","limit_a3","beams","bottomup","PITCH_OFFSET","X_SPACING","X_OFFSET"],{instrument:"21-strings-a-f",limit_a3:!1,beams:!1,bottomup:!1,PITCH_OFFSET:i(q,"lambda",[],(C=function(){C.$$s;return null==c.conf&&(c.conf=n),c.conf["$[]"]("extract.0.layout.PITCH_OFFSET")},C.$$s=q,C.$$arity=0,C)),X_SPACING:i(q,"lambda",[],(I=function(){I.$$s;return null==c.conf&&(c.conf=n),c.conf["$[]"]("extract.0.layout.X_SPACING")},I.$$s=q,I.$$arity=0,I)),X_OFFSET:23}),stringnames:s(["text","marks"],{text:i(q,"lambda",[],(O=function(){var t=O.$$s||this;return null==c.conf&&(c.conf=n),t.$cut_string_names(c.conf["$[]"]("extract.0.stringnames.text"),14,34)},O.$$s=q,O.$$arity=0,O)),marks:s(["hpos"],{hpos:[57,77]})}),printer:s(["a4_pages","a3_offset","a4_offset"],{a4_pages:[1,2],a3_offset:[-5,0],a4_offset:i(q,"lambda",[],(P=function(){P.$$s;return null==c.conf&&(c.conf=n),c.conf["$[]"]("extract.0.printer.a4_offset")},P.$$s=q,P.$$arity=0,P))})}),"18-strings-b-e":s(["layout","stringnames","printer"],{layout:s(["instrument","limit_a3","beams","bottomup","PITCH_OFFSET","X_SPACING","X_OFFSET"],{instrument:"18-strings-b-e",limit_a3:!1,beams:!1,bottomup:!1,PITCH_OFFSET:i(q,"lambda",[],(L=function(){L.$$s;return null==c.conf&&(c.conf=n),c.conf["$[]"]("extract.0.layout.PITCH_OFFSET")},L.$$s=q,L.$$arity=0,L)),X_SPACING:i(q,"lambda",[],(M=function(){M.$$s;return null==c.conf&&(c.conf=n),c.conf["$[]"]("extract.0.layout.X_SPACING")},M.$$s=q,M.$$arity=0,M)),X_OFFSET:28.5}),stringnames:s(["text","marks"],{text:i(q,"lambda",[],(T=function(){var t=T.$$s||this;return null==c.conf&&(c.conf=n),t.$cut_string_names(c.conf["$[]"]("extract.0.stringnames.text"),16,33)},T.$$s=q,T.$$arity=0,T)),marks:s(["hpos"],{hpos:[59,76]})}),printer:s(["a4_pages","a3_offset","a4_offset"],{a4_pages:[2],a3_offset:[0,0],a4_offset:[40,0]})}),saitenspiel:s(["layout","stringnames","printer"],{layout:s(["instrument","limit_a3","beams","bottomup","PITCH_OFFSET","X_SPACING","X_OFFSET"],{instrument:"saitenspiel",limit_a3:!1,beams:!1,bottomup:!1,PITCH_OFFSET:-24,X_SPACING:14.5,X_OFFSET:240}),stringnames:s(["text","marks"],{text:"G C D E F G A B C D  ~ ~ ~ ~ ~ ~ ~",marks:s(["hpos"],{hpos:[55,74]})}),printer:s(["a4_pages","a3_offset","a4_offset"],{a4_pages:[2],a3_offset:[0,0],a4_offset:[35,0]})}),Zipino:s(["layout","stringnames","printer"],{layout:s(["instrument","limit_a3","beams","bottomup","PITCH_OFFSET","X_SPACING","X_OFFSET","ELLIPSE_SIZE","REST_SIZE"],{instrument:"Zipino",limit_a3:!0,beams:!0,bottomup:!1,PITCH_OFFSET:0,X_SPACING:12.5,X_OFFSET:230,ELLIPSE_SIZE:[2,2],REST_SIZE:[2,2]}),stringnames:s(["text","marks"],{text:"F# G A B C D E F# G A B C D E F# ~ ~ ~ ~ ~ ~  ~",marks:s(["hpos"],{hpos:[54]})}),printer:s(["a4_pages","a3_offset","a4_offset"],{a4_pages:[2],a3_offset:[0,0],a4_offset:[35,0]})}),"Okon-Harfe":s(["layout","stringnames","printer"],{layout:s(["instrument","beams","bottomup","limit_a3","PITCH_OFFSET","X_SPACING","X_OFFSET"],{instrument:"okon-f",beams:!0,bottomup:!0,limit_a3:!1,PITCH_OFFSET:0,X_SPACING:15,X_OFFSET:50}),stringnames:s(["text","marks"],{text:"G A B C D E F G A B C D E F G A B C ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~",marks:s(["hpos"],{hpos:[55,74]})}),printer:s(["a4_pages","a3_offset","a4_offset"],{a4_pages:[1,2],a3_offset:[-35,0],a4_offset:[70,0]})})}),notes:s(["T01_number","T01_number_extract","T01_number_extract_value","T02_copyright_music","T03_copyright_harpnotes","T04_to_order","T05_printed_extracts","T06_legend","T99_do_not_copy","T01_T99"],{T01_number:s(["value"],{value:s(["pos","text","style","align"],{pos:[410,17],text:"XXX-{{number}}",style:"bold",align:"l"})}),T01_number_extract:s(["value"],{value:s(["pos","text","style"],{pos:[411,17],text:"{{extract_filename}}",style:"bold"})}),T01_number_extract_value:s(["key","value"],{key:"T01_number_extract",value:s(["text"],{text:"{{extract_filename}}"})}),T02_copyright_music:s(["value"],{value:s(["pos","text","style"],{pos:[340,251],text:i(q,"lambda",[],(B=function(){B.$$s;return" "+t.const_get_relative(p,"Time").$now().$year()+"\n"+t.const_get_relative(p,"I18n").$t("Private copy")},B.$$s=q,B.$$arity=0,B)),style:"small"})}),T03_copyright_harpnotes:s(["value"],{value:s(["pos","text","style"],{pos:[340,260],text:" "+t.const_get_relative(p,"Time").$now().$year()+" Notenbild: zupfnoter.de",style:"small"})}),T04_to_order:s(["value"],{value:s(["pos","text","style"],{pos:[340,242],
text:i(q,"lambda",[],(j=function(){j.$$s;return t.const_get_relative(p,"I18n").$t("provided by\n")},j.$$s=q,j.$$arity=0,j)),style:"small"})}),T05_printed_extracts:s(["value"],{value:s(["pos","text","style","align"],{pos:[410,22],text:"{{printed_extracts}}",style:"smaller",align:"l"})}),T06_legend:s(["value"],{value:s(["pos","text","style"],{pos:[360,30],text:"{{extract_title}}\n{{composer}}\nTakt: {{meter}} ({{tempo}})\nTonart: {{key}}",style:"small"})}),T99_do_not_copy:s(["value"],{value:s(["pos","text","style"],{pos:[380,284],text:i(q,"lambda",[],(F=function(){F.$$s;return t.const_get_relative(p,"I18n").$t("Please do not copy")},F.$$s=q,F.$$arity=0,F)),style:"small_bold"})}),T01_T99:s(["value"],{value:s([],{})})}),printer:s(["printer_left","printer_centric","printer_right"],{printer_left:s(["printer","layout"],{printer:s(["a3_offset","a4_offset","show_border"],{a3_offset:[-10,0],a4_offset:[-5,0],show_border:!1}),layout:s(["limit_a3"],{limit_a3:!1})}),printer_centric:s(["printer","layout"],{printer:s(["a3_offset","a4_offset","show_border"],{a3_offset:[0,0],a4_offset:[5,0],show_border:!1}),layout:s(["limit_a3"],{limit_a3:!0})}),printer_right:s(["printer","layout"],{printer:s(["a3_offset","a4_offset","show_border"],{a3_offset:[10,0],a4_offset:[5,0],show_border:!1}),layout:s(["limit_a3"],{limit_a3:!1})})})}),annotations:s(["vl","vt","vr"],{vl:s(["text","pos"],{text:"v",pos:[-5,-5]}),vt:s(["text","pos"],{text:"v",pos:[-1,-5]}),vr:s(["text","pos"],{text:"v",pos:[2,-5]})}),extract:s(["0","1","2","3","4","5"],{0:s(["title","startpos","voices","synchlines","flowlines","subflowlines","jumplines","repeatsigns","layoutlines","legend","lyrics","images","layout","sortmark","nonflowrest","notes","tuplets","barnumbers","countnotes","stringnames","printer"],{title:"alle Stimmen",startpos:15,voices:[1,2,3,4],synchlines:[[1,2],[3,4]],flowlines:[1,3],subflowlines:[2,4],jumplines:[1,3],repeatsigns:s(["voices","left","right"],{voices:[],left:s(["pos","text","style"],{pos:[-7,-2],text:"|:",style:"bold"}),right:s(["pos","text","style"],{pos:[5,-2],text:":|",style:"bold"})}),layoutlines:[1,2,3,4],legend:s(["spos","pos"],{spos:[320,27],pos:[320,7]}),lyrics:s([],{}),images:s([],{}),layout:s(["limit_a3","bottomup","beams","jumpline_anchor","color","LINE_THIN","LINE_MEDIUM","LINE_THICK","PITCH_OFFSET","X_SPACING","X_OFFSET","ELLIPSE_SIZE","REST_SIZE","DRAWING_AREA_SIZE","instrument","packer"],{limit_a3:!0,bottomup:!1,beams:!1,jumpline_anchor:[3,1],color:s(["color_default","color_variant1","color_variant2"],{color_default:"black",color_variant1:"grey",color_variant2:"dimgrey"}),LINE_THIN:.1,LINE_MEDIUM:.3,LINE_THICK:.5,PITCH_OFFSET:-43,X_SPACING:11.5,X_OFFSET:2.8,ELLIPSE_SIZE:[3.5,1.7],REST_SIZE:[4,2],DRAWING_AREA_SIZE:[400,282],instrument:"37-strings-g-g",packer:s(["pack_method","pack_max_spreadfactor","pack_min_increment"],{pack_method:0,pack_max_spreadfactor:2,pack_min_increment:.2})}),sortmark:s(["size","fill","show"],{size:[2,4],fill:!0,show:!1}),nonflowrest:!1,notes:s([],{}),tuplets:s(["text"],{text:"{{tuplet}}"}),barnumbers:s(["voices","pos","autopos","apanchor","apbase","style","prefix"],{voices:[],pos:[6,-4],autopos:!0,apanchor:"box",apbase:[1,1],style:"small_bold",prefix:""}),countnotes:s(["voices","pos","autopos","apbase","apanchor","style"],{voices:[],pos:[3,-2],autopos:!0,apbase:[1,-.5],apanchor:"box",style:"smaller"}),stringnames:s(["text","vpos","style","marks"],{text:"G G# A A# B C C# D D# E F F# G G# A A# B C C# D D# E F F# G G# A A# B C C# D D# E F F# G",vpos:[],style:"small",marks:s(["vpos","hpos"],{vpos:[11],hpos:[43,55,79]})}),printer:s(["a3_offset","a4_offset","a4_pages","show_border"],{a3_offset:[0,0],a4_offset:[-5,0],a4_pages:[0,1,2],show_border:!1})}),1:s(["title","voices"],{title:"Sopran, Alt",voices:[1,2]}),2:s(["title","voices"],{title:"Tenor, Bass",voices:[3,4]}),3:s(["title","voices"],{title:"Melodie",voices:[1]}),4:s(["title","voices"],{title:"Extract 4",voices:[1]}),5:s(["title","voices"],{title:"Extract 5",voices:[1]})}),layout:s(["grid","limit_a3","SHOW_SLUR","LINE_THIN","LINE_MEDIUM","LINE_THICK","ELLIPSE_SIZE","REST_SIZE","X_SPACING","X_OFFSET","Y_SCALE","DRAWING_AREA_SIZE","BEAT_RESOLUTION","SHORTEST_NOTE","BEAT_PER_DURATION","PITCH_OFFSET","FONT_STYLE_DEF","MM_PER_POINT","DURATION_TO_STYLE","DURATION_TO_BEAMS","REST_TO_GLYPH"],{grid:!1,limit_a3:!0,SHOW_SLUR:!1,LINE_THIN:.1,LINE_MEDIUM:.3,LINE_THICK:.5,ELLIPSE_SIZE:[3.5,1.7],REST_SIZE:[4,2],X_SPACING:11.5,X_OFFSET:2.8,Y_SCALE:4,DRAWING_AREA_SIZE:[400,282],BEAT_RESOLUTION:192,SHORTEST_NOTE:64,BEAT_PER_DURATION:3,PITCH_OFFSET:-43,FONT_STYLE_DEF:s(["bold","italic","large","regular","small_bold","small_italic","small","smaller"],{bold:s(["text_color","font_size","font_style"],{text_color:[0,0,0],font_size:12,font_style:"bold"}),italic:s(["text_color","font_size","font_style"],{text_color:[0,0,0],font_size:12,font_style:"italic"}),large:s(["text_color","font_size","font_style"],{text_color:[0,0,0],font_size:20,font_style:"bold"}),regular:s(["text_color","font_size","font_style"],{text_color:[0,0,0],font_size:12,font_style:"normal"}),small_bold:s(["text_color","font_size","font_style"],{text_color:[0,0,0],font_size:9,font_style:"bold"}),small_italic:s(["text_color","font_size","font_style"],{text_color:[0,0,0],font_size:9,font_style:"italic"}),small:s(["text_color","font_size","font_style"],{text_color:[0,0,0],font_size:9,font_style:"normal"}),smaller:s(["text_color","font_size","font_style"],{text_color:[0,0,0],font_size:6,font_style:"normal"})}),MM_PER_POINT:.3,DURATION_TO_STYLE:s(["err","d64","d48","d32","d24","d16","d12","d8","d6","d4","d3","d2","d1"],{err:[2,"filled",!1],d64:[1,"empty",!1],d48:[.75,"empty",!0],d32:[.75,"empty",!1],d24:[.75,"filled",!0],d16:[.75,"filled",!1],d12:[.5,"filled",!0],d8:[.5,"filled",!1],d6:[.3,"filled",!0],d4:[.3,"filled",!1],d3:[.1,"filled",!0],d2:[.1,"filled",!1],d1:[.05,"filled",!1]}),DURATION_TO_BEAMS:s(["d64","d48","d32","d24","d16","d12","d8","d6","d4","d3","d2","d1"],{d64:[1,"empty",!1],d48:[1,"empty",!0,0],d32:[1,"empty",!1,0],d24:[1,"filled",!0,0],d16:[1,"filled",!1,0],d12:[1,"filled",!0,1],d8:[1,"filled",!1,1],d6:[1,"filled",!0,2],d4:[1,"filled",!1,2],d3:[1,"filled",!0,3],d2:[1,"filled",!1,3],d1:[1,"filled",!1,4]}),REST_TO_GLYPH:s(["err","d64","d48","d32","d24","d16","d12","d8","d6","d4","d3","d2","d1"],{err:[[2,2],"rest_1",!1],d64:[[1,.8],"rest_1",!1],d48:[[.5,.4],"rest_1",!0],d32:[[.5,.4],"rest_1",!1],d24:[[.4,.75],"rest_4",!0],d16:[[.4,.75],"rest_4",!1],d12:[[.4,.5],"rest_8",!0],d8:[[.4,.5],"rest_8",!1],d6:[[.4,.3],"rest_16",!0],d4:[[.3,.3],"rest_16",!1],d3:[[.3,.5],"rest_32",!0],d2:[[.3,.5],"rest_32",!1],d1:[[.3,.5],"rest_64",!1]})}),neatjson:s(["wrap","aligned","after_comma","after_colon_1","after_colon_n","before_colon_n","short","afterComma","afterColon1","afterColonN","beforeColonN","decimals","explicit_sort"],{wrap:60,aligned:!0,after_comma:1,after_colon_1:1,after_colon_n:1,before_colon_n:1,short:!1,afterComma:1,afterColon1:1,afterColonN:1,beforeColonN:1,decimals:2,explicit_sort:t.const_get_relative(p,"Hash")["$[]"](i(D.$each_with_index().$to_a(),"map",[],(R=function(t){R.$$s;return null==t&&(t=n),[t.$first(),e("_",("000"+t.$last())["$[]"](l(-4,-1,!1)))]},R.$$s=q,R.$$arity=1,R)))})})},_.$$arity=0)}(r[0],r),t.const_set(r[0],"DBX_APIKEY_FULL","zwydv2vbgp30e05"),t.const_set(r[0],"DBX_APIKEY_APP","xr3zna7wrp75zax"),t.const_set(r[0],"CONFIG_SEPARATOR","%%%%zupfnoter.config")},Opal.modules.text_pane=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}function n(t,e){return"number"==typeof t&&"number"==typeof e?t>e:t["$>"](e)}var a=(t.top,[]),i=t.nil,o=(t.breaker,t.slice,t.module),s=t.klass,c=t.hash2,l=t.truthy,u=t.send,f=t.gvars,$=t.range;return t.add_stubs(["$attr_accessor","$reset","$push","$[]","$pop","$empty?","$reverse","$flatten","$lambda","$new","$_clean_models","$create_lyrics_editor","$from_lyrics","$on","$Native","$getSession","$save_to_localstorage","$clear_markers","$call","$niil","$editor","$raise","$t","$==","$gsub","$get_selection_positions","$min","$first","$max","$last","$strip","$_get_abc_from_editor","$+","$_get_config_json","$_has_resources?","$_get_resources_json","$_split_parts","$map","$-","$set_markers","$to_n","$each","$add_marker","$join","$split","$<<","$clear","$_get_config_model","$scan","$to_s","$[]=","$do","$_set_config_model","$get","$set_config_model","$_set_config_json","$token","$get_selection_info","$type","$replace_range","$startpos","$endpos","$start_with?","$delete","$deep_dup","$get_lyrics_raw","$>","$count","$get_abc_part","$error","$clear_errors","$get_lyrics","$replace_text","$call_consumers","$nil?","$_set_abc_to_editor","$_set_resources_json","$set_text","$parse","$select","$clean_localstorage","$each_with_index","$benchmark","$neat_generate","$undo","$info","$dig","$redo","$undo_history","$redo_history","$!"]),function(a,_){var d,p=d=o(a,"Harpnotes"),h=(p.$$proto,[p].concat(_));!function(a,o,_){function d(){}var p,h,g,m,v,y,b,w,x,A,k,E,S,N,C,I,O,P,L,M,T,B,j,F,R,q,D,z,U,H,G,Y,V,Q,X,J,W,K,Z,tt,et,rt,nt,at,it,ot,st,ct,lt,ut,ft,$t,_t,dt,pt,ht,gt,mt,vt,yt=d=s(a,null,"TextPane",d),bt=yt.$$proto,wt=[yt].concat(_);bt.editor=bt.range=bt.config_separator=bt.markers=bt.config_models=bt.dirty=bt.config_undo=bt.on_change=bt.lyrics_editor=bt.controller=bt.handle_from_lyrics=i,yt.$attr_accessor("editor","controller","autofold"),function(e,r,n){function a(){}var o,u,f,$,_,d,p,h=a=s(e,null,"UndoManager",a),g=h.$$proto;[h].concat(n);g.undostack=g.currentstate=g.redostack=i,t.defn(h,"$initialize",o=function(){return this.$reset()},o.$$arity=0),t.defn(h,"$reset",u=function(){var t=this;return t.undostack=[],t.redostack=[],t.currentstate=c(["title","state"],{title:"init state",state:c([],{})})},u.$$arity=0),t.defn(h,"$do",f=function(t,e){var r=this;return r.undostack.$push(r.currentstate),r.redostack=[],r.currentstate=c(["title","state"],{title:e,state:t}),r.currentstate},f.$$arity=2),t.defn(h,"$undo",$=function(){var t=this,e=i;return l(t.undostack["$[]"](1))?(e=t.undostack.$pop(),t.redostack.$push(t.currentstate),t.currentstate=e):i},$.$$arity=0),t.defn(h,"$redo",_=function(){var t=this,e=i;return l(t.redostack["$empty?"]())?i:(e=t.redostack.$pop(),t.undostack.$push(t.currentstate),t.currentstate=e)},_.$$arity=0),t.defn(h,"$undo_history",d=function(){var t=this;return[t.undostack,t.currentstate].$flatten().$reverse()},d.$$arity=0),t.defn(h,"$redo_history",p=function(){return[this.redostack].$flatten().$reverse()},p.$$arity=0)}(wt[0],0,wt),t.defn(yt,"$initialize",p=function(e){var r,n=this,a=ace.require("ace/ext/language_tools");a.setCompleters([a.snippetCompleter]);var o=ace.edit(e);return o.commands.bindKey("Cmd-L",null),o.commands.bindKey("Ctrl-L",null),o.commands.bindKey("Ctrl-P",null),o.commands.bindKey("Ctrl-K",null),o.$blockScrolling=1/0,o.getSession().setMode("ace/mode/abc"),o.setTheme("ace/theme/abc"),o.setOptions({highlightActiveLine:!0,enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!1}),n.editor=o,n.range=ace.require("ace/range").Range,n.inhibit_callbacks=!1,n.markers=[],n.autofold=!0,n.on_change=u(n,"lambda",[],(r=function(){r.$$s;return i},r.$$s=n,r.$$arity=0,r)),n.config_separator="%%%%zupfnoter",n.dirty=c([],{}),n.config_undo=t.const_get_relative(wt,"UndoManager").$new(),n.$_clean_models(),n.$create_lyrics_editor("abcLyrics")},p.$$arity=1),t.defn(yt,"$create_lyrics_editor",h=function(t){var e=this,r=ace.require("ace/ext/language_tools");r.setCompleters([r.snippetCompleter]);var n=ace.edit(t);return n.$blockScrolling=1/0,n.getSession().setMode("ace/mode/markdown"),n.setTheme("ace/theme/abc"),n.setOptions({highlightActiveLine:!0,enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!1}),n.on("change",function(){e.$from_lyrics()}),e.lyrics_editor=n,e.lyrics_range=ace.require("ace/range").Range,e.lyrics_inhibit_callbacks=!1,e.lyrics_markers=[]},h.$$arity=1),t.defn(yt,"$on_change",g=function(){var t,e=this,r=g.$$p,n=r||i;return r&&(g.$$p=null),e.on_change=n,u(e.$Native(e.$Native(e.editor).$getSession()),"on",["change"],(t=function(e){var r=t.$$s||this;return null==r.on_change&&(r.on_change=i),null==e&&(e=i),r.$save_to_localstorage("zn_abc"),r.$clear_markers(),r.on_change.$call(e)},t.$$s=e,t.$$arity=1,t))},g.$$arity=0),t.defn(yt,"$on_selection_change",m=function(){var t,e=this,r=m.$$p,n=r||i;return r&&(m.$$p=null),u(e.$Native(e.$Native(e.editor)["$[]"]("selection")),"on",["changeSelection"],(t=function(e){var r=t.$$s||this;return null==r.inhibit_callbacks&&(r.inhibit_callbacks=i),null==e&&(e=i),l(r.inhibit_callbacks)?i:n.$call(e)},t.$$s=e,t.$$arity=1,t))},m.$$arity=0),t.defn(yt,"$on_cursor_change",v=function(){var t,e=this,r=v.$$p,n=r||i;return r&&(v.$$p=null),n.$call(i),u(e.$Native(e.$Native(e.editor)["$[]"]("selection")),"on",["changeCursor"],(t=function(e){var r=t.$$s||this;return null==r.inhibit_callbacks&&(r.inhibit_callbacks=i),null==e&&(e=i),l(r.inhibit_callbacks)?i:n.$call(e)},t.$$s=e,t.$$arity=1,t))},v.$$arity=0),t.defn(yt,"$clear_selection",y=function(){var t=this;return t.editor.selection.clearSelection(),t.$niil()},y.$$arity=0),t.defn(yt,"$edit_unisons",b=function(e){var r,n,a,o=this,s=i,c=i,$=i,_=i;return s=o.editor.selection.getRange(),c=o.editor.getSession().doc.getTextRange(o.$editor().selection.getRange()),l(c["$empty?"]())?o.$raise(t.const_get_relative(wt,"I18n").$t("Selection is empty")):($=/\[([\^\_=]?[a-zA-Z][',]*)\s*(([\^\_=]?[a-zA-Z][',]*\s*)*)([\^\_=]?[a-zA-Z][',]*)+\]/,_=c,e["$=="]("replaceByFirst")&&(_=u(c,"gsub",[$],(r=function(t){var e;r.$$s;return null==t&&(t=i),""+((e=f["~"])===i?i:e["$[]"](1))},r.$$s=o,r.$$arity=1,r))),e["$=="]("replaceByLast")&&(_=u(c,"gsub",[$],(n=function(t){var e;n.$$s;return null==t&&(t=i),""+((e=f["~"])===i?i:e["$[]"](4))},n.$$s=o,n.$$arity=1,n))),e["$=="]("swapFirstWithLast")&&(_=u(c,"gsub",[$],(a=function(t){var e;a.$$s;return null==t&&(t=i),"["+((e=f["~"])===i?i:e["$[]"](4))+((e=f["~"])===i?i:e["$[]"](2))+((e=f["~"])===i?i:e["$[]"](1))+"]"},a.$$s=o,a.$$arity=1,a))),o.$editor().session.replace(s,_)),i},b.$$arity=1),t.defn(yt,"$get_selection_positions",w=function(){var t=this;return doc=t.editor.selection.doc,range=t.editor.selection.getRange(),range_start=doc.positionToIndex(range.start,0),range_end=doc.positionToIndex(range.end,0),[range_start,range_end]},w.$$arity=0),t.defn(yt,"$get_selection_ranges",x=function(){var t=this,e=t.editor.selection.doc;return t.editor.selection.getAllRanges().map(function(t){return[e.positionToIndex(t.start,0),e.positionToIndex(t.end,0)]})},x.$$arity=0),t.defn(yt,"$get_selection_info",A=function(){var t=this;return doc=t.editor.selection.doc,range=t.editor.selection.getRange(),token=t.editor.session.getTokenAt(range.start.row,range.start.column),token&&(token.startpos=[range.start.row,token.start],token.endpos=[range.start.row,token.start+token.value.length]),t.$Native({selection:[[range.start.row+1,range.start.column+1],[range.end.row+1,range.end.column+1]],token:token})},A.$$arity=0),t.defn(yt,"$select_range_by_position",k=function(t,e,r){var n=this,a=i,o=i,s=i;null==r&&(r=!1),a=l(r)?n.$get_selection_positions():[t,e],o=[a.$first(),t].$min(),s=[a.$last(),e].$max(),doc=n.editor.selection.doc,startrange=doc.indexToPosition(o),endrange=doc.indexToPosition(s),range=new n.range(startrange.row,startrange.column,endrange.row,endrange.column),myrange={start:startrange,end:endrange},n.editor.focus(),n.editor.selection.setSelectionRange(myrange,!1)},k.$$arity=-3),t.defn(yt,"$set_focus",E=function(){return this.editor.focus()},E.$$arity=0),t.defn(yt,"$select_add_range_by_position",S=function(t,e,r){var n=this,a=i,o=i,s=i;null==r&&(r=!1),a=l(r)?n.$get_selection_positions():[t,e],o=[a.$first(),t].$min(),s=[a.$last(),e].$max(),doc=n.editor.selection.doc,startrange=doc.indexToPosition(o),endrange=doc.indexToPosition(s),range=new n.range(startrange.row,startrange.column,endrange.row,endrange.column),myrange={start:startrange,end:endrange},n.editor.focus(),n.editor.selection.addRange(range,!1)},S.$$arity=-3),t.defn(yt,"$get_text",N=function(){var t=this,r=i;return r=t.$_get_abc_from_editor().$strip(),r=e(r,e("\n\n"+t.config_separator+".config\n\n",t.$_get_config_json())),l(t["$_has_resources?"]())&&(r=e(r,e("\n\n"+t.config_separator+".resources\n\n",t.$_get_resources_json()))),r},N.$$arity=0),t.defn(yt,"$set_text",C=function(t){return this.$_split_parts(t)},C.$$arity=1),t.defn(yt,"$replace_range",I=function(t,e,r){var n=this;therange=new n.range(t[0],t[1],e[0],e[1]),n.$editor().getSession().replace(therange,r)},I.$$arity=3),t.defn(yt,"$replace_text",O=function(t,e){return this.editor.replace(e,{needle:t}),i},O.$$arity=2),t.defn(yt,"$set_annotations",P=function(t){var e,n=this,a=i;return a=u(t,"map",[],(e=function(t){e.$$s;return null==t&&(t=i),c(["row","text","type"],{row:r(t["$[]"]("start_pos").$first(),1),text:t["$[]"]("text"),type:t["$[]"]("type")})},e.$$s=n,e.$$arity=1,e)),n.$set_markers(t),n.editor.getSession().setAnnotations(a.$to_n()),i},P.$$arity=1),t.defn(yt,"$set_markers",L=function(t){var e,r=this;return r.$clear_markers(),u(t,"each",[],(e=function(t){var r=e.$$s||this;return null==t&&(t=i),r.$add_marker(t)},e.$$s=r,e.$$arity=1,e))},L.$$arity=1),t.defn(yt,"$prepend_comment",M=function(t){var r,n=this,a=i;a=e(u(t.$split(/\r?\n/),"map",[],(r=function(t){r.$$s;return null==t&&(t=i),"% "+t},r.$$s=n,r.$$arity=1,r)).$join("\n"),"\n%\n"),n.editor.selection.moveCursorFileStart(),n.editor.insert(a)},M.$$arity=1),t.defn(yt,"$append_text",T=function(t){var e=this;e.editor.selection.moveCursorFileEnd(),e.editor.insert(t)},T.$$arity=1),t.defn(yt,"$add_marker",B=function(t){var e=this,n=i,a=i,o=i;return n=c(["row","col"],{row:t["$[]"]("start_pos").$first(),col:t["$[]"]("start_pos").$last()}),a=c(["row","col"],{row:t["$[]"]("end_pos").$first(),col:t["$[]"]("end_pos").$last()}),o=e.editor.getSession().addMarker(new e.range(r(n["$[]"]("row"),1),r(n["$[]"]("col"),1),r(a["$[]"]("row"),1),r(a["$[]"]("col"),1)),"marked","line",!0),e.markers["$<<"](c(["from","to","id"],{from:[n["$[]"]("row"),n["$[]"]("col")],to:[a["$[]"]("row"),a["$[]"]("col")],id:o})),i},B.$$arity=1),t.defn(yt,"$clear_markers",j=function(){var t,e=this;return u(e.markers,"each",[],(t=function(e){var r=t.$$s||this;return null==r.editor&&(r.editor=i),null==e&&(e=i),r.editor.session.removeMarker(e["$[]"]("id"))},t.$$s=e,t.$$arity=1,t)),e.markers.$clear()},j.$$arity=0),t.defn(yt,"$get_abc_part",F=function(){return this.editor.getSession().getValue()},F.$$arity=0),t.defn(yt,"$get_config_part",R=function(){return this.config_models["$[]"]("config")},R.$$arity=0),t.defn(yt,"$get_config_model",q=function(){var t=this,e=i;return e=t.$_get_config_model(),l(e)?[t.$_get_config_model(),!0]:[c([],{}),!1]},q.$$arity=0),t.defn(yt,"$get_checksum",D=function(){var t=this,e=i;e=t.$_get_abc_from_editor().$strip();var r,n=305419896;for(r=0;r<e.length;r++)n+=e.charCodeAt(r)*(r+1);return n.$to_s().$scan(/...?/).$join(" ")},D.$$arity=0),t.defn(yt,"$resize",z=function(){return this.editor.resize()},z.$$arity=0),t.defn(yt,"$set_config_model",U=function(e,n,a){var o=this,s=i;return null==n&&(n="no desc"),null==a&&(a=!0),s=["zn_config",!0],u(o.dirty,"[]=",t.to_a(s)),s[r(s.length,1)],a["$=="](!0)&&o.config_undo.$do(e,n),o.$_set_config_model(e)},U.$$arity=-2),t.defn(yt,"$patch_config_part",H=function(e,n,a){var o=this,s=i,c=i,l=i;return null==a&&(a=e),s=t.const_get_qualified(t.const_get_relative(wt,"Confstack"),"Confstack").$new(!1),c=t.const_get_qualified(t.const_get_relative(wt,"Confstack"),"Confstack").$new(!1),s.$push(o.$_get_config_model()),l=[e,n],u(c,"[]=",t.to_a(l)),l[r(l.length,1)],s.$push(c.$get()),o.$set_config_model(s.$get(),a,!0)},H.$$arity=-3),t.defn(yt,"$copy_config_part_to_extract",G=function(e,n,a){var o=this,s=i,c=i,l=i,f=i;return null==a&&(a=e),s=t.const_get_qualified(t.const_get_relative(wt,"Confstack"),"Confstack").$new(!1),c=t.const_get_qualified(t.const_get_relative(wt,"Confstack"),"Confstack").$new(!1),s.$push(o.$_get_config_model()),l=e.$gsub(/^extract\.\d+/,"extract."+n),f=[l,s.$get(e)],u(c,"[]=",t.to_a(f)),f[r(f.length,1)],s.$push(c.$get()),o.$set_config_model(s.$get(),a,!0)},G.$$arity=-3),t.defn(yt,"$neat_config_part",Y=function(){var t=this;return t.$_set_config_json(t.$_get_config_json(),"neat config_part",!1)},Y.$$arity=0),t.defn(yt,"$patch_resources",V=function(e,n){var a=this,o=i;return null==f.resources&&(f.resources=i),o=["zn_resources",!0],u(a.dirty,"[]=",t.to_a(o)),o[r(o.length,1)],o=[e,n],u(f.resources,"[]=",t.to_a(o)),o[r(o.length,1)],a.$save_to_localstorage("zn_resources"),a.on_change.$call(i)},V.$$arity=2),t.defn(yt,"$patch_token",Q=function(t,e,r){var n=this,a=i;return a=n.$get_selection_info().$token(),a.$type().$to_s()["$=="](t.$to_s())||n.$raise("cannot patch token if there is a name mismatch '"+a.$type()+"' - '"+t+"'"),n.$replace_range(a.$startpos(),a.$endpos(),r)},Q.$$arity=3),t.defn(yt,"$extend_config_part",X=function(e,n){var a=this,o=i,s=i,c=i;return o=t.const_get_qualified(t.const_get_relative(wt,"Confstack"),"Confstack").$new(!1),s=t.const_get_qualified(t.const_get_relative(wt,"Confstack"),"Confstack").$new(!1),o.$push(a.$_get_config_model()),c=[e,n],u(s,"[]=",t.to_a(c)),c[r(c.length,1)],o.$push(s.$get()),o.$push(a.$_get_config_model()),a.$set_config_model(o.$get(),"extend "+e,!0)},X.$$arity=2),t.defn(yt,"$delete_config_part",J=function(e){var n=this,a=i,o=i;return null==f.resources&&(f.resources=i),l(e["$start_with?"]("$resources"))?f.resources.$delete(e.$split(".").$last()):(a=t.const_get_qualified(t.const_get_relative(wt,"Confstack"),"Confstack").$new(!1),a.$push(n.$_get_config_model().$deep_dup()),o=[e,t.const_get_qualified(t.const_get_relative(wt,"Confstack"),"DeleteMe")],u(a,"[]=",t.to_a(o)),o[r(o.length,1)],n.$set_config_model(a.$get(),"delete "+e,!0))},J.$$arity=1),t.defn(yt,"$get_config_part_value",W=function(e){var r=this,n=i;return n=t.const_get_qualified(t.const_get_relative(wt,"Confstack"),"Confstack").$new(!1),n.$push(r.$_get_config_model()),n["$[]"](e)},W.$$arity=1),t.defn(yt,"$get_lyrics",K=function(){var t,e=this,r=i;return r=e.$get_lyrics_raw(),l(n(r.$count(),0))?u(r,"map",[],(t=function(e){t.$$s;return null==e&&(e=i),e.$first().$gsub(/\nW\:[ \t]*/,"\n")},t.$$s=e,t.$$arity=1,t)).$join().$strip():i},K.$$arity=0),t.defn(yt,"$get_lyrics_raw",Z=function(){var t=this,e=i,r=i,a=i;return null==f.log&&(f.log=i),e=/((\n((W\:)([^\n]*)\n)+)+)/,r=t.$get_abc_part(),a=r.$scan(e),l(n(a.$count(),1))&&f.log.$error("you have more than one lyrics section in your abc code"),a},Z.$$arity=0),t.defn(yt,"$to_lyrics",tt=function(){var t=this,r=i,n=i,a=i;return null==f.log&&(f.log=i),f.log.$clear_errors(),r=t.$get_lyrics(),l(r)||(n=t.$get_abc_part(),a=e(n.$strip(),"\n%\nW:\n%\n%\n"),t.$replace_text(n,a)),t.handle_from_lyrics=!1,t.lyrics_editor.getSession().setValue(t.$get_lyrics()),t.handle_from_lyrics=!0,t.controller.$call_consumers("error_alert"),i},tt.$$arity=0),t.defn(yt,"$from_lyrics",et=function(){var t,e=this,r=i,n=i,a=i;return l(e.handle_from_lyrics)&&(r=e.$get_lyrics_raw(),n=r.$first().$first(),a=e.lyrics_editor.getSession().getValue(),l(a["$empty?"]())&&(a=" "),a=u(a.$split("\n"),"map",[],(t=function(e){t.$$s;return null==e&&(e=i),"W:"+e},t.$$s=e,t.$$arity=1,t)).$join("\n"),a="\n"+a+"\n",e.$replace_text(n,a)),i},et.$$arity=0),t.defn(yt,"$restore_from_localstorage",rt=function(){var t,e=this,r=i,n=i,a=i,o=i;return r=e.$Native(localStorage.getItem("abc_data")),l(r["$nil?"]())?(n=e.$Native(localStorage.getItem("zn_abc")),l(n)&&e.$_set_abc_to_editor(n),a=l(t=e.$Native(localStorage.getItem("zn_config")))?t:c([],{}),e.config_undo.$reset(),l(a)&&e.$_set_config_json(a,"from localstore zn_config",!0),o=e.$Native(localStorage.getItem("zn_resources")),l(o)&&e.$_set_resources_json(o)):(localStorage.removeItem("abc_data"),l(r["$nil?"]())||e.$set_text(r)),e.dirty=c([],{})},rt.$$arity=0),t.defn(yt,"$save_to_localstorage",nt=function(e){var n=this,a=i;return null==e&&(e=i),l(e)&&(a=[e,!0],u(n.dirty,"[]=",t.to_a(a)),a[r(a.length,1)]),n.dirty["$[]"]("zn_abc")["$=="](!0)&&localStorage.setItem("zn_abc",n.$_get_abc_from_editor()),n.dirty["$[]"]("zn_config")["$=="](!0)&&localStorage.setItem("zn_config",n.$_get_config_json()),n.dirty["$[]"]("zn_resources")["$=="](!0)&&localStorage.setItem("zn_resources",n.$_get_resources_json()),n.dirty=c([],{})},nt.$$arity=-1),t.defn(yt,"$clean_localstorage",at=function(){return localStorage.removeItem("zn_abc"),localStorage.removeItem("zn_config"),localStorage.removeItem("zn_resources"),i},at.$$arity=0),t.defn(yt,"$get_config_from_text",it=function(e){var r,n=this;return t.const_get_relative(wt,"JSON").$parse(u(e.$split(n.config_separator),"select",[],(r=function(t){r.$$s;return null==t&&(t=i),t["$start_with?"](".config")},r.$$s=n,r.$$arity=1,r)).$first().$gsub(".config",""))},it.$$arity=1),t.defn(yt,"$_split_parts",ot=function(r){var n,a=this;return a.$_clean_models(),a.$clean_localstorage(),u(r.$split(a.config_separator),"each_with_index",[],(n=function(r,a){var o=n.$$s||this;return null==o.config_undo&&(o.config_undo=i),null==f.log&&(f.log=i),null==r&&(r=i),null==a&&(a=i),a["$=="](0)?o.$_set_abc_to_editor(r):l(r["$start_with?"](".config"))?(o.config_undo.$reset(),o.$_set_config_json(r.$split(".config").$last(),"from loaded abc",!0)):l(r["$start_with?"](".resources"))?o.$_set_resources_json(r.$split(".resources").$last()):f.log.$error(e(t.const_get_relative(wt,"I18n").$t("unsupported section found in abc file: "),r["$[]"]($(0,10,!1))))},n.$$s=a,n.$$arity=2,n))},ot.$$arity=1),t.defn(yt,"$_set_abc_to_editor",st=function(t){var e=this;return e.inhibit_callbacks=!0,e.editor.getSession().setValue(t),e.inhibit_callbacks=!1,e.$save_to_localstorage("zn_abc")},st.$$arity=1),t.defn(yt,"$_get_abc_from_editor",ct=function(){var t=this;return"",t.editor.getSession().getValue()},ct.$$arity=0),t.defn(yt,"$_set_config_json",lt=function(e,r,n){var a=this;return null==r&&(r="no desc"),null==n&&(n=!0),a.$set_config_model(t.const_get_relative(wt,"JSON").$parse(e),r,n)},lt.$$arity=-2),t.defn(yt,"$_get_config_json",ut=function(){var e,r=this,n=i;return null==f.conf&&(f.conf=i),null==f.log&&(f.log=i),n=f.conf["$[]"]("neatjson"),u(f.log,"benchmark",["neat_json",736,"text_pane"],(e=function(){var r=e.$$s||this;return t.const_get_relative(wt,"JSON").$neat_generate(r.$_get_config_model(),n)},e.$$s=r,e.$$arity=0,e))},ut.$$arity=0),t.defn(yt,"$_get_config_model",ft=function(){var t;return l(t=this.config_models["$[]"]("config"))?t:c([],{})},ft.$$arity=0),t.defn(yt,"$_set_config_model",$t=function(e){var n=this,a=i;return a=["config",e],u(n.config_models,"[]=",t.to_a(a)),a[r(a.length,1)],n.$save_to_localstorage("zn_config"),n.on_change.$call(i)},$t.$$arity=1),t.defn(yt,"$undo_config",_t=function(){var t=this,e=i;return null==f.log&&(f.log=i),e=t.config_undo.$undo(),l(e)?(f.log.$info("undo: "+e["$[]"]("title")+": "+e["$[]"]("state").$dig("extract","0","legend","pos")),l(e)?t.$set_config_model(e["$[]"]("state"),e["$[]"]("title"),!1):i):i},_t.$$arity=0),t.defn(yt,"$redo_config",dt=function(){var t=this,e=i;return null==f.log&&(f.log=i),e=t.config_undo.$redo(),l(e)?(f.log.$info("redo: "+e["$[]"]("title")+": "+e["$[]"]("state").$dig("extract","0","legend","pos")),l(e)?t.$set_config_model(e["$[]"]("state"),e["$[]"]("title"),!1):i):i},dt.$$arity=0),t.defn(yt,"$history_config",pt=function(){var t=this;return c(["undo","redo"],{undo:t.config_undo.$undo_history(),redo:t.config_undo.$redo_history()})},pt.$$arity=0),t.defn(yt,"$_set_resources_json",ht=function(e){var r=this;return f.resources=t.const_get_relative(wt,"JSON").$parse(e),r.$save_to_localstorage("zn_resources"),r.on_change.$call(i)},ht.$$arity=1),t.defn(yt,"$_get_resources_json",gt=function(){return null==f.resources&&(f.resources=i),null==f.conf&&(f.conf=i),t.const_get_relative(wt,"JSON").$neat_generate(f.resources,f.conf["$[]"]("neatjson"))},gt.$$arity=0),t.defn(yt,"$_has_resources?",mt=function(){return null==f.resources&&(f.resources=i),f.resources["$empty?"]()["$!"]()},mt.$$arity=0),t.defn(yt,"$_clean_models",vt=function(){var t=this;return f.resources=c([],{}),t.config_models=c([],{}),t.dirty=c([],{})},vt.$$arity=0)}(h[0],0,h)}(a[0],a)},Opal.modules["command-controller"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}var r=(t.top,[]),n=t.nil,a=(t.breaker,t.slice,t.module),i=t.klass,o=t.truthy,s=t.send,c=t.hash2,l=t.range;return t.add_stubs(["$attr_reader","$call","$lambda","$raise","$new","$set_help","$set_default","$push","$!","$start_with?","$to_s","$each","$name","$[]","$get_default","$[]=","$-","$get_help","$empty?","$get_clean_argument_values","$perform","$undoable?","$clear","$can_undo?","$pop","$invert","$can_redo?","$map","$scan","$first","$select","$nil?","$to_sym","$parse_string","$gsub","$each_with_index","$parameter_name","$clone","$unshift","$to_a","$is_public?","$last","$join","$parameters"]),function(r,u){var f,$=f=a(r,"CommandController"),_=($.$$proto,[$].concat(u));!function(e,r,a){function s(){}var c,l,u,f,$,_=s=i(e,null,"Parameter",s),d=_.$$proto;[_].concat(a);d.default_action=d.name=d.help_action=n,_.$attr_reader("name"),t.defn(_,"$initialize",c=function(t,e){var r=this;return r.name=t,r.type=e},c.$$arity=2),t.defn(_,"$set_help",l=function(){var t=this,e=l.$$p,r=e||n;return e&&(l.$$p=null),t.help_action=r},l.$$arity=0),t.defn(_,"$set_default",u=function(){var t=this,e=u.$$p,r=e||n;return e&&(u.$$p=null),t.default_action=r},u.$$arity=0),t.defn(_,"$get_help",f=function(){var t=this,e=n;return e=t.default_action.$call(),o(e)&&(e="["+e+"]"),"{"+t.name+"}"+e+" = "+t.help_action.$call()},f.$$arity=0),t.defn(_,"$get_default",$=function(){return this.default_action.$call()},$.$$arity=0)}(_[0],0,_),function(r,a,l){function u(){}var f,$,_,d,p,h,g,m,v,y,b,w,x,A,k,E=u=i(r,null,"Command",u),S=E.$$proto,N=[E].concat(l);S.parameters=S.name=S.action=S.inverse_action=S.help_action=S.undoable=n,E.$attr_reader("name","parameters"),t.defn(E,"$initialize",f=function(t){var e,r,a,i=this;return i.name=t,i.help_action=s(i,"lambda",[],(e=function(){e.$$s;return"no help defined for "+t},e.$$s=i,e.$$arity=0,e)),i.parameters=[],i.action=s(i,"lambda",[],(r=function(e){var a=r.$$s||this;return null==e&&(e=n),a.$raise("No action defined for "+t)},r.$$s=i,r.$$arity=1,r)),i.inverse_action=s(i,"lambda",[],(a=function(e){var r=a.$$s||this;return null==e&&(e=n),r.$raise("No  undo defined fore "+t)},a.$$s=i,a.$$arity=1,a)),i.undoable=!0},f.$$arity=1),t.defn(E,"$add_parameter",$=function(e,r,a,i){var o,c,l=this,u=$.$$p,f=u||n,_=n;return null==a&&(a=n),null==i&&(i=n),u&&($.$$p=null),_=t.const_get_relative(N,"Parameter").$new(e,r),s(_,"set_help",[],(o=function(){o.$$s;return a},o.$$s=l,o.$$arity=0,o)),s(_,"set_default",[],(c=function(){c.$$s;return i},c.$$s=l,c.$$arity=0,c)),f!==n&&f.$call(_),l.parameters.$push(_)},$.$$arity=-3),t.defn(E,"$as_action",_=function(){var t=this,e=_.$$p,r=e||n;return e&&(_.$$p=null),t.action=r},_.$$arity=0),t.defn(E,"$as_inverse",d=function(){var t=this,e=d.$$p,r=e||n;return e&&(d.$$p=null),t.inverse_action=r},d.$$arity=0),t.defn(E,"$is_public?",p=function(){return this.name.$to_s()["$start_with?"]("_")["$!"]()},p.$$arity=0),t.defn(E,"$set_help",h=function(){var t=this,e=h.$$p,r=e||n;return e&&(h.$$p=null),t.help_action=r},h.$$arity=0),t.defn(E,"$perform",g=function(t){return this.action.$call(t)},g.$$arity=1),t.defn(E,"$invert",m=function(t){return this.inverse_action.$call(t)},m.$$arity=1),t.defn(E,"$get_clean_argument_values",v=function(r){var a,i=this,l=n;return l=c([],{}),s(i.parameters,"each",[],(a=function(i){var c,u=(a.$$s,n);return null==i&&(i=n),u=[i.$name(),o(c=r["$[]"](i.$name()))?c:i.$get_default()],s(l,"[]=",t.to_a(u)),u[e(u.length,1)]},a.$$s=i,a.$$arity=1,a)),l},v.$$arity=1),t.defn(E,"$get_help",y=function(){return this.help_action.$call()},y.$$arity=0),t.defn(E,"$parameter_name",b=function(t){return this.parameters["$[]"](t).$name()},b.$$arity=1),t.defn(E,"$parameter_help",w=function(t){return this.parameters["$[]"](t).$get_help()
},w.$$arity=1),t.defn(E,"$parameter_default",x=function(t){return this.parameters["$[]"](t).$get_default()},x.$$arity=1),t.defn(E,"$undoable?",A=function(){return this.undoable},A.$$arity=0),t.defn(E,"$undoable=",k=function(t){return this.undoable=t},k.$$arity=1)}(_[0],0,_),function(r,a,u){function f(){}var $,_,d,p,h,g,m,v,y,b,w,x,A,k,E=f=i(r,null,"CommandStack",f),S=E.$$proto,N=[E].concat(u);S.commands=S.undo_stack=S.redo_stack=S.history_stack=n,t.defn(E,"$initialize",$=function(){var t=this;return t.commands=c([],{}),t.undo_stack=[],t.redo_stack=[],t.history_stack=[]},$.$$arity=0),t.defn(E,"$add_command",_=function(r){var a=this,i=_.$$p,o=i||n,c=n,l=n;return i&&(_.$$p=null),c=t.const_get_relative(N,"Command").$new(r),o.$call(c),l=[c.$name(),c],s(a.commands,"[]=",t.to_a(l)),l[e(l.length,1)]},_.$$arity=1),t.defn(E,"$can_undo?",d=function(){return this.undo_stack["$empty?"]()["$!"]()},d.$$arity=0),t.defn(E,"$can_redo?",p=function(){return this.redo_stack["$empty?"]()["$!"]()},p.$$arity=0),t.defn(E,"$perform",h=function(t,e){var r=this,a=n;return a=t.$get_clean_argument_values(e),t.$perform(a),o(t["$undoable?"]())&&(r.undo_stack.$push([t,a]),r.redo_stack.$clear()),r.history_stack.$push(["  do",t,a])},h.$$arity=2),t.defn(E,"$undo",g=function(){var e,r,a=this,i=n,s=n;return o(a["$can_undo?"]())?(r=a.undo_stack.$pop(),e=t.to_ary(r),i=null==e[0]?n:e[0],s=null==e[1]?n:e[1],a.redo_stack.$push([i,s]),a.history_stack.$push(["undo",i,s]),i.$invert(s)):a.$raise("nothing to undo")},g.$$arity=0),t.defn(E,"$redo",m=function(){var e,r,a=this,i=n,s=n;return o(a["$can_redo?"]())?(r=a.redo_stack.$pop(),e=t.to_ary(r),i=null==e[0]?n:e[0],s=null==e[1]?n:e[1],a.$perform(i,s)):a.$raise("nothing to redo")},m.$$arity=0),t.const_set(N[0],"STRING_COMMAND_REGEX",/([^ \\\^"{]+)|"(([^\\"]|\\["n\\])*)"|(\{.+\})/),t.defn(E,"$parse_string",v=function(e){var r,a=this;return s(e.$scan(t.const_get_relative(N,"STRING_COMMAND_REGEX")),"map",[],(r=function(t){var e,a=r.$$s||this;return null==t&&(t=n),s(t,"select",[],(e=function(t){e.$$s;return null==t&&(t=n),t["$nil?"]()["$!"]()},e.$$s=a,e.$$arity=1,e)).$first()},r.$$s=a,r.$$arity=1,r))},v.$$arity=1),t.defn(E,"$run_parsed_command",y=function(t,e){var r=this,a=n;return a=r.commands["$[]"](t.$to_sym()),r.$perform(a,e)},y.$$arity=2),t.defn(E,"$run_string",b=function(r){var a,i,u=this,f=n,$=n,_=n;return f=c([],{}),$=u.$parse_string(r),o($["$empty?"]())&&($=["help"]),$=s($,"map",[],(a=function(t){a.$$s;return null==t&&(t=n),t.$gsub("\\\\","\\")},a.$$s=u,a.$$arity=1,a)),_=u.commands["$[]"]($.$first().$to_sym()),o(_)||u.$raise("wrong command: "+r),s($["$[]"](l(1,-1,!1)),"each_with_index",[],(i=function(a,o){var c=i.$$s||this,l=n;null==a&&(a=n),null==o&&(o=n);try{return l=[_.$parameter_name(o),a],s(f,"[]=",t.to_a(l)),l[e(l.length,1)]}catch(e){if(!t.rescue(e,[t.const_get_relative(N,"StandardError")]))throw e;try{return c.$raise("too many arguments in '"+r+"'")}finally{t.pop_exception()}}},i.$$s=u,i.$$arity=2,i)),u.$perform(_,f)},b.$$arity=1),t.defn(E,"$history",w=function(){return this.history_stack.$clone()},w.$$arity=0),t.defn(E,"$undostack",x=function(){var t,e=this;return s(e.undo_stack,"map",[],(t=function(e){t.$$s;return null==e&&(e=n),e.$clone().$unshift("undo")},t.$$s=e,t.$$arity=1,t))},x.$$arity=0),t.defn(E,"$redostack",A=function(){var t,e=this;return s(e.redo_stack,"map",[],(t=function(e){t.$$s;return null==e&&(e=n),e.$clone().$unshift("redo")},t.$$s=e,t.$$arity=1,t))},A.$$arity=0),t.defn(E,"$help_string_style",k=function(){var t,e,r=this;return s(s(r.commands.$to_a(),"select",[],(t=function(e){t.$$s;return null==e&&(e=n),e.$last()["$is_public?"]()},t.$$s=r,t.$$arity=1,t)),"map",[],(e=function(t,r){var a,i=e.$$s||this,o=n;return null==t&&(t=n),null==r&&(r=n),o=s(r.$parameters(),"map",[],(a=function(t){a.$$s;return null==t&&(t=n),"{"+t.$name()+"}"},a.$$s=i,a.$$arity=1,a)).$join(" "),r.$name()+" "+o+" : "+r.$get_help()},e.$$s=r,e.$$arity=2,e))},k.$$arity=0)}(_[0],0,_)}(r[0],r)},Opal.modules.controller=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}function n(t,e){return"number"==typeof t&&"number"==typeof e?t<=e:t["$<="](e)}function a(t,e){return"number"==typeof t&&"number"==typeof e?t>e:t["$>"](e)}var i=(t.top,[]),o=t.nil,s=(t.breaker,t.slice,t.klass),c=t.truthy,l=t.hash2,u=t.gvars,f=t.send,_=t.range;return t.add_stubs(["$nil?","$Native","$now","$load_dir","$save_dir","$[]","$warning","$update","$to_json","$[]=","$-","$parse","$clone","$private","$attr_accessor","$html","$find","$new","$post_named_message","$downcase","$locale","$call_consumers","$to_n","$phrases","$load_from_loacalstorage","$on_command","$save_to_localstorage","$handle_command","$info","$jspdfversion","$check_suppoerted_browser","$strict=","$push","$_init_conf","$controller=","$each","$select","$methods","$=~","$send","$setup_tune_preview","$setup_harpnote_preview","$setup_harpnote_player","$setup_worker_listners","$get_uri","$class","$last","$cleanup_localstorage","$empty?","$get_abc_part","$load_demo_tune","$set_status","$loglevel","$get_current_template","$load_from_uri","$==","$get_lyrics","$ok?","$render_previews","$error","$t","$setup_ui_listener","$show_message_of_the_day","$year","$lambda","$has_errors?","$join","$get_errors","$get_notes","$map","$to_s","$call","$get_config_form_menu_entries","$clear_errors","$timestamp_start","$timestamp","$run_string","$message","$backtrace","$run_parsed_command","$include?","$systemstatus","$uniq","$always","$fail","$then","$get","$set_text","$body","$alert","$restore_from_localstorage","$match","$first","$draw","$layout_harpnotes","$draw_in_segments","$migrate_config_lyrics","$migrate_notes","$migrate_config_cleanup","$delete","$inject","$split","$gsub","$to_i","$+","$count","$is_a?","$resolve","$tap","$is_playing?","$stop_play_abc","$is_stopped?","$play_auto","$play_song","$play_selection","$play_from_selection","$stop","$set_active","$tweak_abc_text","$benchmark","$compute_tune_preview","$get_checksum","$set_svg","$set_inactive","$start_with?","$get_config_from_editor","$debug","$load_song","$active_voices","$harpnote_preview_printer","$save_scroll_position","$resize","$clear_annotations","$render_previews_in_worker","$render_previews_in_uithread","$render_tunepreview__in_worker","$clear","$size","$render_harpnotepreview_in_worker","$render_tunepreview_in_uithread","$render_harpnotepreview_callback","$bind_elements","$set_annotations","$annotations","$file","$get_text","$output","$render_a4","$render_a3","$to_blob","$strftime","$load_music_model","$keys","$set_extracts_menu","$validate_conf","$uri=","$get_placeholder_replacers","$placeholders=","$layout","$pop","$meta_data","$reset_to","$transform","$abc_model","$player_model_abc=","$checksum=","$get_config_model","$migrate_config","$set_config_model","$add_class","$scroll_into_view","$has_class?","$scroll_to_element","$remove_class","$select_range_by_position","$range_highlight_more","$range_unhighlight_more","$range_unhighlight","$highlight_abc_object","$!","$between?","$select_add_range_by_position","$get_selection_ranges","$to_a","$compact","$flatten","$merge!","$loglevel=","$app_name","$app_id","$dig","$set_harppreview_size","$set_view_box","$on_select","$select_abc_object","$on_drag_start","$on_drag_end","$zip","$patch_config_part","$refresh_form","$on_mouseover","$on_mouseout","$on_draggable_rightcklick","$set_canvas","$on_named_message","$<=","$shift","$set_worker_model","$log_from_worker","$on_change","$request_refresh","$on_selection_change","$get_selection_info","$unhighlight_all","$range_highlight","$on_cursor_change","$on_noteon","$highlight_abc_object_by_player_callback","$on_noteoff","$on_songoff","$on","$shift_key","$alt_key","$meta_key","$ctrl_key","$key_code","$===","$ord","$prevent","$play_abc","$toggle_console","$chr","$key","$newValue","$present_message_of_the_day","$>","$init_conf"]),function(e,r,n){function a(){}var i,c,l,u=a=s(e,null,"LastRenderMonitor",a),f=(u.$$proto,[u].concat(n));t.defn(u,"$ok?",i=function(){var t=this,e=o;return e=localStorage.getItem("lastrender"),t.$Native(e)["$nil?"]()},i.$$arity=0),t.defn(u,"$set_active",c=function(){return localStorage.setItem("lastrender",t.const_get_relative(f,"Time").$now()),!0},c.$$arity=0),t.defn(u,"$clear",l=function(){return localStorage.removeItem("lastrender"),!1},l.$$arity=0)}(i[0],0,i),function(r,n,a){function i(){}var $,_,d,p,h,g,m,v,y,b=i=s(r,null,"LocalStore",i),w=b.$$proto,x=[b].concat(a);w.directory=w.name=o,t.defn(b,"$initialize",$=function(t){var e=this;return e.name=t,e.$load_dir(),c(e.directory)?o:(e.directory=l([],{}),e.$save_dir())},$.$$arity=1),t.defn(b,"$create",_=function(t,e,r){var n=this;return null==u.log&&(u.log=o),null==r&&(r=o),c(n.directory["$[]"](t))?u.log.$warning("local storage: key '"+t+"' already exists"):n.$update(t,e,r,!0)},_.$$arity=-3),t.defn(b,"$update",d=function(r,n,a,i){var s,$=this,_=o,d=o;return null==u.log&&(u.log=o),null==a&&(a=o),null==i&&(i=!1),_=l(["p","title"],{p:n,title:a}).$to_json(),c(c(s=$.directory["$[]"](r))?s:i)?(localStorage.setItem($.$mangle_key(r),_),d=[r,a],f($.directory,"[]=",t.to_a(d)),d[e(d.length,1)],$.$save_dir()):u.log.$warning("local storage update: key '"+r+"' does not exist")},d.$$arity=-3),t.defn(b,"$retrieve",p=function(e){var r=this,n=o,a=o;return n=t.const_get_relative(x,"JSON").$parse(localStorage.getItem(r.$mangle_key(e))),c(n)&&(a=n["$[]"]("p")),a},p.$$arity=1),t.defn(b,"$delete",h=function(r){var n=this,a=o;return null==u.log&&(u.log=o),c(n.directory["$[]"](r))?u.log.$warning("local storage: key '"+r+"' does not exist"):(localStorage.removeItem(n.$mangle_key(r)),a=[r,o],f(n.directory,"[]=",t.to_a(a)),a[e(a.length,1)],n.$save_dir())},h.$$arity=1),t.defn(b,"$list",g=function(){return this.directory.$clone()},g.$$arity=0),b.$private(),t.defn(b,"$mangle_key",m=function(t){return this.name+"."+t},m.$$arity=1),t.defn(b,"$load_dir",v=function(){var e=this,r=o;return r=e.name+"__dir",e.directory=t.const_get_relative(x,"JSON").$parse(localStorage.getItem(r))},v.$$arity=0),t.defn(b,"$save_dir",y=function(){var t=this,e=o,r=o;return e=t.directory.$to_json(),r=t.name+"__dir",localStorage.setItem(r,e)},y.$$arity=0)}(i[0],0,i),function(i,d,p){function h(){}var g,m,v,y,b,w,x,A,k,E,S,N,C,I,O,P,L,M,T,B,j,F,R,q,D,z,U,H,G,Y,V,Q,X,J,W,K,Z,tt,et,rt,nt,at,it,ot,st,ct,lt,ut,ft,$t,_t,dt,pt,ht,gt,mt,vt,yt,bt,wt,xt,At=h=s(i,null,"Controller",h),kt=At.$$proto,Et=[At].concat(p);return kt.worker=kt.console=kt.editor=kt.systemstatus=kt.worker_info=kt.systemstatus_consumers=kt.commands=kt.dropboxpath=kt.harpnote_player=kt.harpnote_preview_printer=kt.music_model=kt.tune_preview_printer=kt.expand_selection=kt.abc_model=kt.dropboxclient=kt.dropboxloginstate=kt.worker_tunepreview=kt.info_url=kt.refresh_timer=o,At.$attr_accessor("dropped_abc","dropboxclient","dropboxpath","editor","harpnote_preview_printer","info_url","tune_preview_printer","systemstatus","zupfnoter_ui"),t.defn(At,"$initialize",g=function(){var r,n,a,i,s,$=this,_=o,d=o,p=o,h=o,g=o,m=o,v=o,y=o,b=o;return null==u.log&&(u.log=o),null==u.conf&&(u.conf=o),_=t.const_get_relative(Et,"Time").$now(),_=t.const_get_relative(Et,"Element").$find("#buster").$html(),_=t.const_get_relative(Et,"JSON").$parse(_)["$[]"]("buster"),$.worker=t.const_get_relative(Et,"NamedWebworker").$new("public/znworker.js"+_),$.worker_tunepreview=$.worker,$.worker_info=l(["version"],{version:"unknown"}),$.worker.$post_named_message("get_worker_info",o),d=l(["de","de-de","en","en-us"],{de:"de-de","de-de":"de-de",en:"en-US","en-us":"en-US"}),p=function(){try{return navigator.language.$downcase()}catch(e){if(!t.rescue(e,[t.const_get_relative(Et,"StandardError")]))throw e;try{return"de-de"}finally{t.pop_exception()}}}(),h=c(r=d["$[]"](p))?r:"de-de",$.info_url="https://www.zupfnoter.de/category/info_"+h,$.refresh_timer=[],$.render_stack=[],$.version=t.const_get_relative(Et,"VERSION"),c(p)&&f(t.const_get_relative(Et,"I18n"),"locale",[h],(n=function(){var e=n.$$s||this,r=o;return null==e.worker&&(e.worker=o),e.$call_consumers("localizedtexts"),r=JSON.stringify(t.const_get_relative(Et,"I18n").$phrases().$to_n()),e.worker.$post_named_message("i18n_set_locale",r)},n.$$s=$,n.$$arity=0,n)),$.zupfnoter_ui=new init_w2ui($),$.console=t.const_get_qualified(t.const_get_relative(Et,"JqConsole"),"JqConsole").$new("commandconsole","zupfnoter> "),$.console.$load_from_loacalstorage(),f($.console,"on_command",[],(a=function(t){var e=a.$$s||this;return null==e.console&&(e.console=o),null==t&&(t=o),e.console.$save_to_localstorage(),e.$handle_command(t)},a.$$s=$,a.$$arity=1,a)),$.dropped_abc="T: nothing dropped yet",u.log=t.const_get_relative(Et,"ConsoleLogger").$new($.console),u.log.$info("Welcome to Zupfnoter"),u.log.$info("Zupfnoter "+t.const_get_relative(Et,"VERSION")),u.log.$info("Opal:     "+t.const_get_relative(Et,"RUBY_ENGINE_VERSION")),u.log.$info("Ruby:     "+t.const_get_relative(Et,"RUBY_VERSION")),u.log.$info("Abc2svg:  "+abc2svg.version),u.log.$info("JsPdf:    "+t.const_get_relative(Et,"JsPDF").$jspdfversion()),u.log.$info("Browser:  "+bowser.name+"  "+bowser.version),u.log.$info("Language: "+h),$.$check_suppoerted_browser(),u.conf=t.const_get_relative(Et,"Confstack").$new(o),g=[!1],f(u.conf,"strict=",t.to_a(g)),g[e(g.length,1)],u.conf.$push($.$_init_conf()),u.resources=l([],{}),u.settings=l(["autoscroll","follow"],{autoscroll:"true",follow:"true"}),$.$call_consumers("settings_menu"),$.json_validator=t.const_get_qualified(t.const_get_relative(Et,"Ajv"),"JsonValidator").$new(),$.editor=t.const_get_qualified(t.const_get_relative(Et,"Harpnotes"),"TextPane").$new("abcEditor"),g=[$],f($.editor,"controller=",t.to_a(g)),g[e(g.length,1)],$.songbook=t.const_get_relative(Et,"LocalStore").$new("songbook"),$.abc_transformer=t.const_get_qualified(t.const_get_qualified(t.const_get_relative(Et,"Harpnotes"),"Input"),"Abc2svgToHarpnotes").$new(),$.dropboxclient=t.const_get_qualified(t.const_get_qualified(t.const_get_relative(Et,"Opal"),"DropboxJs"),"NilClient").$new(),$.systemstatus=l(["version","dropboxpathlist"],{version:t.const_get_relative(Et,"VERSION"),dropboxpathlist:[]}),$.commands=t.const_get_qualified(t.const_get_relative(Et,"CommandController"),"CommandStack").$new(),f(f($.$methods(),"select",[],(i=function(t){i.$$s;return null==t&&(t=o),t["$=~"](/__ic.*/)},i.$$s=$,i.$$arity=1,i)),"each",[],(s=function(t){var e=s.$$s||this;return null==t&&(t=o),e.$send(t)},s.$$s=$,s.$$arity=1,s)),$.$setup_tune_preview(),$.$setup_harpnote_preview(),$.$setup_harpnote_player(),$.$setup_worker_listners(),m=$.$class().$get_uri(),v=function(){try{return m["$[]"]("parsed_search")["$[]"]("mode").$last()}catch(e){if(!t.rescue(e,[t.const_get_relative(Et,"StandardError")]))throw e;try{return"work"}finally{t.pop_exception()}}}(),$.$cleanup_localstorage(),$.$load_from_loacalstorage(),c($.editor.$get_abc_part()["$empty?"]())&&$.$load_demo_tune(),c($.systemstatus["$[]"]("view"))||$.$set_status(l(["dropbox","music_model","loglevel","autorefresh","view","mode"],{dropbox:"not connected",music_model:"unchanged",loglevel:u.log.$loglevel(),autorefresh:"off",view:0,mode:v})),$.$set_status(l(["mode"],{mode:v})),c($.systemstatus["$[]"]("saveformat"))||$.$set_status(l(["saveformat"],{saveformat:"A3-A4"})),$.$get_current_template(),$.$handle_command("dreconnect"),y=function(){try{return m["$[]"]("parsed_search")["$[]"]("load")}catch(e){if(!t.rescue(e,[t.const_get_relative(Et,"StandardError")]))throw e;try{return o}finally{t.pop_exception()}}}(),c(y)&&$.$load_from_uri(m["$[]"]("parsed_search")["$[]"]("load")),$.systemstatus["$[]"]("mode")["$=="]("demo")?$.$handle_command("view 0"):($.editor.$get_lyrics(),b=t.const_get_relative(Et,"LastRenderMonitor").$new(),c(b["$ok?"]())?c(m["$[]"]("parsed_search")["$[]"]("debug"))||$.$render_previews():(u.log.$error(t.const_get_relative(Et,"I18n").$t("last session failed. Did not render. Cleanup ABC, then render manually")),$.$call_consumers("error_alert"))),$.$setup_ui_listener(),$.$show_message_of_the_day()},g.$$arity=0),t.defn(At,"$about_zupfnoter",m=function(){var e=this;return"<p>"+t.const_get_relative(Et,"I18n").$t("Free software to create sheets for table harps")+"</p>\n         <table>\n          <tbody>\n          <tr><td>Zupfnoter:</td><td>"+t.const_get_relative(Et,"VERSION")+"</td></tr>\n          <tr><td>Worker:</td><td>"+e.worker_info["$[]"]("version")+'</td></tr>\n          <tr><td><a target="_blank" href="http://opalrb.com">Opal</a>:</td><td>'+t.const_get_relative(Et,"RUBY_ENGINE_VERSION")+"</td></tr>\n          <tr><td>Ruby:</td><td>"+t.const_get_relative(Et,"RUBY_VERSION")+'</td></tr>\n          <tr><td><a target="_blank" href="http://moinejf.free.fr/js/index.html">abc2svg</a>:</td><td>'+abc2svg.version+'</td></tr>\n          <tr><td><a target="_blank" href="https://wim.vree.org/js/xml2abc-js_index.html">xml2abc.js</a>:</td><td>'+xml2abc_VERSION+'</td></tr>\n          <tr><td><a target="_blank" href="https://parall.ax/products/jspdf">jsPDF</a>:</td><td>'+t.const_get_relative(Et,"JsPDF").$jspdfversion()+"</td></tr>\n         </tbody>\n        </table>\n        <p> "+t.const_get_relative(Et,"Time").$now().$year()+' Bernhard Weichel - info@zupfnoter.de</p>\n        <p><a target="_blank" href="https://www.zupfnoter.de">Website: https://www.zupfnoter.de</a></p>\n    '},m.$$arity=0),t.defn(At,"$call_consumers",v=function(t){var e,r,n,a,i,s,$,_,d,p,h,g,m,v,y,b,w,x,A,k=this;return k.systemstatus_consumers=l(["systemstatus","lock","unlock","localizedtexts","statusline","error_alert","play_start","play_stop","play_stopping","disable_save","enable_save","before_open","document_title","current_notes","settings_menu","extracts","harp_preview_size","render_status","show_config_tab"],{systemstatus:[f(k,"lambda",[],(e=function(){var t=e.$$s||this;return null==t.systemstatus&&(t.systemstatus=o),update_systemstatus_w2ui(t.systemstatus.$to_n())},e.$$s=k,e.$$arity=0,e))],lock:[f(k,"lambda",[],(r=function(){r.$$s;return lockscreen()},r.$$s=k,r.$$arity=0,r))],unlock:[f(k,"lambda",[],(n=function(){n.$$s;return unlockscreen()},n.$$s=k,n.$$arity=0,n))],localizedtexts:[f(k,"lambda",[],(a=function(){a.$$s;return update_localized_texts()},a.$$s=k,a.$$arity=0,a))],statusline:[],error_alert:[f(k,"lambda",[],(i=function(){i.$$s;return null==u.log&&(u.log=o),c(u.log["$has_errors?"]())?window.update_error_status_w2ui(u.log.$get_errors().$join("<br/>\n")):o},i.$$s=k,i.$$arity=0,i))],play_start:[f(k,"lambda",[],(s=function(){s.$$s;return update_play_w2ui("start")},s.$$s=k,s.$$arity=0,s))],play_stop:[f(k,"lambda",[],($=function(){$.$$s;return update_play_w2ui("stop")},$.$$s=k,$.$$arity=0,$))],play_stopping:[f(k,"lambda",[],(_=function(){_.$$s;return update_play_w2ui("stopping")},_.$$s=k,_.$$arity=0,_))],disable_save:[f(k,"lambda",[],(d=function(){d.$$s;return disable_save()},d.$$s=k,d.$$arity=0,d))],enable_save:[f(k,"lambda",[],(p=function(){p.$$s;return enable_save()},p.$$s=k,p.$$arity=0,p))],before_open:[f(k,"lambda",[],(h=function(){h.$$s;return before_open()},h.$$s=k,h.$$arity=0,h))],document_title:[f(k,"lambda",[],(g=function(){var t=g.$$s||this;return null==t.document_title&&(t.document_title=o),document.title=t.document_title},g.$$s=k,g.$$arity=0,g))],current_notes:[f(k,"lambda",[],(m=function(){var t=m.$$s||this;return null==t.harpnote_player&&(t.harpnote_player=o),update_current_notes_w2ui(t.harpnote_player.$get_notes().$join(", "))},m.$$s=k,m.$$arity=0,m))],settings_menu:[f(k,"lambda",[],(v=function(){v.$$s;return null==u.settings&&(u.settings=o),update_settings_menu(u.settings.$to_n())},v.$$s=k,v.$$arity=0,v))],extracts:[f(k,"lambda",[],(y=function(){var t,e=y.$$s||this,r=o;return null==e.extracts&&(e.extracts=o),r=f(e.extracts,"map",[],(t=function(e,r){t.$$s;return null==e&&(e=o),null==r&&(r=o),l(["id","text"],{id:e,text:e+": "+r})},t.$$s=e,t.$$arity=2,t)),set_extract_menu(r.$to_n()),e.$call_consumers("systemstatus")},y.$$s=k,y.$$arity=0,y))],harp_preview_size:[f(k,"lambda",[],(b=function(){var t=b.$$s||this;return null==t.harp_preview_size&&(t.harp_preview_size=o),set_harp_preview_size(t.harp_preview_size)},b.$$s=k,b.$$arity=0,b))],render_status:[f(k,"lambda",[],(w=function(){var t=w.$$s||this;return null==t.systemstatus&&(t.systemstatus=o),null==t.render_stack&&(t.render_stack=o),set_render_status(t.systemstatus["$[]"]("autorefresh")+" "+t.render_stack.$to_s())},w.$$s=k,w.$$arity=0,w))],show_config_tab:[f(k,"lambda",[],(x=function(){x.$$s;return show_config_tab()},x.$$s=k,x.$$arity=0,x))]}),f(k.systemstatus_consumers["$[]"](t),"each",[],(A=function(t){A.$$s;return null==t&&(t=o),t.$call()},A.$$s=k,A.$$arity=1,A))},v.$$arity=1),t.defn(At,"$get_config_form_menu_entries",y=function(){return t.const_get_relative(Et,"ConfstackEditor").$get_config_form_menu_entries()},y.$$arity=0),t.defn(At,"$handle_command",b=function(e){var r=this,n=o;null==u.log&&(u.log=o),u.log.$clear_errors();try{u.log.$timestamp_start(),u.log.$timestamp(e),r.commands.$run_string(e)}catch(r){if(!t.rescue(r,[t.const_get_relative(Et,"Exception")]))throw r;n=r;try{u.log.$error(n.$message()+' in command "'+e+'"',o,o,n.$backtrace())}finally{t.pop_exception()}}return r.$call_consumers("error_alert")},b.$$arity=1),t.defn(At,"$handle_parsed_command",w=function(e,r){var n=this,a=o;null==u.log&&(u.log=o),u.log.$clear_errors();try{u.log.$timestamp_start(),u.log.$timestamp(e),n.commands.$run_parsed_command(e,n.$Native(r))}catch(r){if(!t.rescue(r,[t.const_get_relative(Et,"Exception")]))throw r;a=r;try{u.log.$error(a.$message()+' in command "'+e+'"',o,o,a.$backtrace())}finally{t.pop_exception()}}return n.$call_consumers("error_alert")},w.$$arity=2),t.defn(At,"$save_to_localstorage",x=function(){var t,e=this,r=o;return r=f(e.systemstatus,"select",[],(t=function(e,r){t.$$s;return null==e&&(e=o),null==r&&(r=o),["last_read_info_id","zndropboxlogincmd","music_model","view","autorefresh","loglevel","nwworkingdir","dropboxapp","dropboxpath","dropboxpathlist","dropboxloginstate","perspective","saveformat","zoom"]["$include?"](e)},t.$$s=e,t.$$arity=2,t)).$to_json(),e.systemstatus["$[]"]("mode")["$=="]("work")&&localStorage.setItem("systemstatus",r),e.editor.$save_to_localstorage()},x.$$arity=0),t.defn(At,"$push_to_dropboxpathlist",A=function(){var t,e=this,r=o;return r=c(t=e.$systemstatus()["$[]"]("dropboxpathlist"))?t:[],r.$push(e.dropboxpath),r=r.$uniq().$last(10),e.$set_status(l(["dropboxpathlist"],{dropboxpathlist:r}))},A.$$arity=0),t.defn(At,"$load_from_uri",k=function(e){var r,n,a,i=this;return f(f(f(t.const_get_relative(Et,"HTTP").$get(e),"then",[],(r=function(t){var e=r.$$s||this;return null==e.editor&&(e.editor=o),null==t&&(t=o),e.editor.$set_text(t.$body())},r.$$s=i,r.$$arity=1,r)),"fail",[],(n=function(t){var r=n.$$s||this;return null==t&&(t=o),r.$alert("could not load from URL: "+e)},n.$$s=i,n.$$arity=1,n)),"always",[],(a=function(t){a.$$s;return null==t&&(t=o),o},a.$$s=i,a.$$arity=1,a))},k.$$arity=1),t.defn(At,"$load_from_loacalstorage",E=function(){var e=this,r=o;return e.editor.$restore_from_localstorage(),r=t.const_get_relative(Et,"JSON").$parse(localStorage.getItem("systemstatus")),c(r)&&e.$set_status(r),o},E.$$arity=0),t.defn(At,"$cleanup_localstorage",S=function(){var e,r=this,n=o,a=o;return n=Object.keys(localStorage),a=f(n,"select",[],(e=function(t){e.$$s;return null==t&&(t=o),t.$match(/dropbox\-auth:default:/)},e.$$s=r,e.$$arity=1,e)),c(a["$empty?"]())||(localStorage.removeItem(a.$first()),localStorage.removeItem("systemstatus")),localStorage.setItem("zupfnoterVersion",t.const_get_relative(Et,"VERSION")),o},S.$$arity=0),t.defn(At,"$load_demo_tune",N=function(){var e,r=this,n=o;return n="public/demos/zndemo_42_Ich_steh_an_deiner_krippen_hier.abc",f(t.const_get_relative(Et,"HTTP"),"get",[n,l(["async"],{async:!1})],(e=function(t){var r=e.$$s||this;return null==r.editor&&(r.editor=o),null==t&&(t=o),r.editor.$set_text(t.$body()),t.$body()},e.$$s=r,e.$$arity=1,e))},N.$$arity=0),t.defn(At,"$render_a3",C=function(r){var n=this,a=o,i=o,s=o;return null==u.settings&&(u.settings=o),null==r&&(r=n.systemstatus["$[]"]("view")),a=u.settings["$[]"]("flowconf"),i=["flowconf",!1],f(u.settings,"[]=",t.to_a(i)),i[e(i.length,1)],s=t.const_get_qualified(t.const_get_relative(Et,"Harpnotes"),"PDFEngine").$new().$draw(n.$layout_harpnotes(r,"A3")),i=["flowconf",a],f(u.settings,"[]=",t.to_a(i)),i[e(i.length,1)],s},C.$$arity=-1),t.defn(At,"$render_a4",I=function(r){var n=this,a=o,i=o,s=o;return null==u.settings&&(u.settings=o),null==r&&(r=n.systemstatus["$[]"]("view")),a=u.settings["$[]"]("flowconf"),i=["flowconf",!1],f(u.settings,"[]=",t.to_a(i)),i[e(i.length,1)],s=t.const_get_qualified(t.const_get_relative(Et,"Harpnotes"),"PDFEngine").$new().$draw_in_segments(n.$layout_harpnotes(r,"A4")),i=["flowconf",a],f(u.settings,"[]=",t.to_a(i)),i[e(i.length,1)],s},I.$$arity=-1),t.defn(At,"$migrate_config",O=function(r){var n=this,a=o,i=o,s=o,$=o,_=o,d=o,p=o;return null==u.version&&(u.version=o),a=t.const_get_relative(Et,"Confstack").$new(!1),i=[!1],f(a,"strict=",t.to_a(i)),i[e(i.length,1)],s=t.const_get_relative(Et,"Confstack").$new(!1),i=[!1],f(s,"strict=",t.to_a(i)),i[e(i.length,1)],s.$push(r.$clone()),a.$push(r),c(r["$[]"]("extract"))&&($=n.$migrate_config_lyrics(a),a.$push($),_=n.$migrate_notes(a),a.$push(_)),i=["$schema",t.const_get_relative(Et,"SCHEMA_VERSION")],f(a,"[]=",t.to_a(i)),i[e(i.length,1)],d=n.$migrate_config_cleanup(a.$get()),p=s.$get()["$=="](d)?l(["changed","message","oldversion"],{changed:!1,message:"",oldversion:s["$[]"](u.version)}):l(["changed","message","oldversion"],{changed:!0,message:t.const_get_relative(Et,"I18n").$t(t.const_get_relative(Et,"I18n").$t("Please double check the generated sheets.\n\nYour abc file was automatically migrated\nto Zupfnoter version"))+" "+t.const_get_relative(Et,"VERSION"),oldversion:s["$[]"]("$version")}),i=["$version",t.const_get_relative(Et,"VERSION")],f(d,"[]=",t.to_a(i)),i[e(i.length,1)],[d,p]},O.$$arity=1),t.defn(At,"$migrate_config_cleanup",P=function(t){var e,r=this;return c(t["$[]"]("extract"))&&f(t["$[]"]("extract"),"each",[],(e=function(t,r){var n=(e.$$s,o);return null==t&&(t=o),null==r&&(r=o),n=r["$[]"]("lyrics"),c(n)?n.$delete("versepos"):o},e.$$s=r,e.$$arity=2,e)),t},P.$$arity=1),t.defn(At,"$migrate_config_lyrics",L=function(n){var a,i=this,s=o;return s=f(n["$[]"]("extract"),"inject",[l([],{})],(a=function(n,i){var s,u=a.$$s||this,$=o,_=o,d=o;return null==n&&(n=o),null==i&&(i=o),$=i.$last()["$[]"]("lyrics"),c($)&&($=$["$[]"]("versepos")),c($)&&(_=f($,"inject",[l([],{})],(s=function(n,a){var i,c=s.$$s||this,u=o,$=o;return null==n&&(n=o),null==a&&(a=o),u=f(a.$first().$gsub(","," ").$split(" "),"map",[],(i=function(t){i.$$s;return null==t&&(t=o),t.$to_i()},i.$$s=c,i.$$arity=1,i)),$=[r(n.$count(),1).$to_s(),l(["verses","pos"],{verses:u,pos:a.$last()})],f(n,"[]=",t.to_a($)),$[e($.length,1)],n},s.$$s=u,s.$$arity=2,s)),d=[i.$first(),l(["lyrics"],{lyrics:_})],f(n,"[]=",t.to_a(d)),d[e(d.length,1)]),n},a.$$s=i,a.$$arity=2,a)),l(["extract"],{extract:s})},L.$$arity=1),t.defn(At,"$migrate_notes",M=function(n){var a,i=this,s=o;return s=f(n["$[]"]("extract"),"inject",[l([],{})],(a=function(n,i){var s,u=a.$$s||this,$=o,_=o,d=o;return null==n&&(n=o),null==i&&(i=o),$=i.$last()["$[]"]("notes"),c($["$is_a?"](t.const_get_relative(Et,"Array")))&&(_=f($,"inject",[l([],{})],(s=function(n,a){var i=(s.$$s,o);return null==n&&(n=o),null==a&&(a=o),i=[r(n.$count(),1).$to_s(),a],f(n,"[]=",t.to_a(i)),i[e(i.length,1)],n},s.$$s=u,s.$$arity=2,s)),d=[i.$first(),l(["notes"],{notes:_})],f(n,"[]=",t.to_a(d)),d[e(d.length,1)]),n},a.$$s=i,a.$$arity=2,a)),l(["extract"],{extract:s})},M.$$arity=1),t.defn(At,"$play_abc",T=function(e){var r,n,a=this,i=o;return null==e&&(e="music_model"),i=c(a.systemstatus["$[]"]("harpnotes_dirty"))?a.$render_previews():t.const_get_relative(Et,"Promise").$new().$resolve(),f(f(i,"then",[],(r=function(){var n,a=r.$$s||this;return f(t.const_get_relative(Et,"Promise").$new(),"tap",[],(n=function(t){var r=n.$$s||this;return null==r.harpnote_player&&(r.harpnote_player=o),null==t&&(t=o),c(r.harpnote_player["$is_playing?"]())?(r.$call_consumers("play_stopping"),r.$stop_play_abc()):c(r.harpnote_player["$is_stopped?"]())&&(r.$call_consumers("play_start"),e["$=="]("auto")&&r.harpnote_player.$play_auto(),e["$=="]("music_model")&&r.harpnote_player.$play_song(),e["$=="]("selection")&&r.harpnote_player.$play_selection(),e["$=="]("selection_ff")&&r.harpnote_player.$play_from_selection()),t.$resolve()},n.$$s=a,n.$$arity=1,n))},r.$$s=a,r.$$arity=0,r)),"fail",[],(n=function(t){var e=n.$$s||this;return null==u.log&&(u.log=o),null==t&&(t=o),u.log.$error("bug: Error in player "+t,"controller",530),e.$call_consumers("error_alert")},n.$$s=a,n.$$arity=1,n))},T.$$arity=-1),t.defn(At,"$stop_play_abc",B=function(){return this.harpnote_player.$stop()},B.$$arity=0),t.defn(At,"$render_tunepreview_in_uithread",j=function(){var e,r=this,n=o,a=o;null==u.log&&(u.log=o),r.$set_active("#tunePreview"),r.$setup_tune_preview();try{n=r.$tweak_abc_text(),f(u.log,"benchmark",["render tune preview"],(e=function(){var t=e.$$s||this,r=o;return null==t.tune_preview_printer&&(t.tune_preview_printer=o),null==t.editor&&(t.editor=o),r=t.tune_preview_printer.$compute_tune_preview(n,t.editor.$get_checksum()),t.tune_preview_printer.$set_svg(r),t.$set_inactive("#tunePreview")},e.$$s=r,e.$$arity=0,e))}catch(e){if(!t.rescue(e,[t.const_get_relative(Et,"Exception")]))throw e;a=e;try{u.log.$error("Bug "+a.$message(),o,o,a.$backtrace())}finally{t.pop_exception()}}return o},j.$$arity=0),t.defn(At,"$render_tunepreview__in_worker",F=function(){var e,r=this,n=o,a=o;null==u.log&&(u.log=o),r.$set_active("#tunePreview"),r.$setup_tune_preview();try{n=r.$tweak_abc_text(),f(u.log,"benchmark",["render tune preview by worker"],(e=function(){var t=e.$$s||this;return null==t.worker_tunepreview&&(t.worker_tunepreview=o),null==t.editor&&(t.editor=o),t.worker_tunepreview.$post_named_message("compute_tune_preview",l(["abc","checksum"],{abc:n,checksum:t.editor.$get_checksum()}))},e.$$s=r,e.$$arity=0,e))}catch(e){if(!t.rescue(e,[t.const_get_relative(Et,"Exception")]))throw e;a=e;try{u.log.$error("Bug "+a.$message(),o,o,a.$backtrace())}finally{t.pop_exception()}}return o},F.$$arity=0),t.defn(At,"$tweak_abc_text",R=function(){var t,e=this,r=o;return r=e.editor.$get_abc_part(),r=f(r.$split("\n"),"map",[],(t=function(e){var r,n=t.$$s||this,a=o;return null==e&&(e=o),a=e,c(e["$start_with?"]("W:"))&&(a=f(a,"gsub",[/(\\?)(~)/],(r=function(t){r.$$s;return null==t&&(t=o),t["$[]"](0)["$=="]("\\")?t["$[]"](1):" "},r.$$s=n,r.$$arity=1,r))),a},t.$$s=e,t.$$arity=1,t)).$join("\n")},R.$$arity=0),t.defn(At,"$render_harpnotepreview_in_worker",q=function(){var t,e=this;return null==u.log&&(u.log=o),f(u.log,"benchmark",["render_harpnotepreview_callback_by_worker"],(t=function(){var e=t.$$s||this;return null==e.worker&&(e.worker=o),null==e.systemstatus&&(e.systemstatus=o),null==e.editor&&(e.editor=o),null==u.settings&&(u.settings=o),null==u.resources&&(u.resources=o),e.$set_active("#harpPreview"),e.worker.$post_named_message("compute_harpnotes_preview",l(["settings","resources","systemstatus","uri","config_from_editor","page_format","abc_part_from_editor","checksum"],{settings:u.settings,resources:u.resources,systemstatus:e.systemstatus,uri:l(["hostname"],{hostname:e.$class().$get_uri()["$[]"]("hostname")}),config_from_editor:e.$get_config_from_editor(),page_format:"A3",abc_part_from_editor:e.editor.$get_abc_part(),checksum:e.editor.$get_checksum()}))},t.$$s=e,t.$$arity=0,t)),o},q.$$arity=0),t.defn(At,"$render_harpnotepreview_callback",D=function(){var e,r=this;return null==u.log&&(u.log=o),f(u.log,"benchmark",["render_harpnotepreview_callback"],(e=function(){var r,n,a=e.$$s||this,i=o;null==a.systemstatus&&(a.systemstatus=o),null==a.song_harpnotes&&(a.song_harpnotes=o),null==u.log&&(u.log=o);try{u.log.$debug("viewid: "+a.systemstatus["$[]"]("view")+" controller 612"),a.song_harpnotes=a.$layout_harpnotes(a.systemstatus["$[]"]("view"),"A3"),
c(a.song_harpnotes)&&(f(u.log,"benchmark",["loading music to player"],(r=function(){var t=r.$$s||this;return null==t.harpnote_player&&(t.harpnote_player=o),null==t.music_model&&(t.music_model=o),null==t.song_harpnotes&&(t.song_harpnotes=o),t.harpnote_player.$load_song(t.music_model,t.song_harpnotes.$active_voices())},r.$$s=a,r.$$arity=0,r)),f(u.log,"benchmark",["drawing preview sheet"],(n=function(){var t=n.$$s||this,e=o;return null==t.harpnote_preview_printer&&(t.harpnote_preview_printer=o),null==t.song_harpnotes&&(t.song_harpnotes=o),e=t.harpnote_preview_printer.$draw(t.song_harpnotes),t.harpnote_preview_printer.$set_svg(e),t.$harpnote_preview_printer().$draw(t.song_harpnotes),t.$set_inactive("#harpPreview")},n.$$s=a,n.$$arity=0,n)),a.$set_status(l(["harpnotes_dirty"],{harpnotes_dirty:!1})))}catch(e){if(!t.rescue(e,[t.const_get_relative(Et,"Exception")]))throw e;i=e;try{u.log.$error("Bug "+i.$message(),o,o,i.$backtrace())}finally{t.pop_exception()}}return a.$set_status(l(["refresh"],{refresh:!1}))},e.$$s=r,e.$$arity=0,e)),o},D.$$arity=0),t.defn(At,"$render_previews",z=function(){var e=this;return null==u.log&&(u.log=o),t.const_get_relative(Et,"LastRenderMonitor").$new().$set_active(),e.$save_to_localstorage(),e.harpnote_preview_printer.$save_scroll_position(),e.editor.$resize(),u.log.$info("rendering"),e.$set_status(l(["harpnotes_dirty"],{harpnotes_dirty:!0})),u.log.$clear_errors(),u.log.$clear_annotations(),e.systemstatus["$[]"]("autorefresh")["$=="]("on")?e.$render_previews_in_worker():e.$render_previews_in_uithread()},z.$$arity=0),t.defn(At,"$render_previews_in_worker",U=function(){var e,n,a,i=this;return i.$render_tunepreview__in_worker(),f(f(f(t.const_get_relative(Et,"Promise").$new(),"tap",[],(e=function(t){e.$$s;return null==t&&(t=o),t.$resolve()},e.$$s=i,e.$$arity=1,e)),"fail",[],(n=function(){return(n.$$s||this).$alert("fail")},n.$$s=i,n.$$arity=0,n)),"then",[],(a=function(){var e,n,i=a.$$s||this;return f(f(t.const_get_relative(Et,"Promise").$new(),"tap",[],(e=function(t){var n=e.$$s||this;return null==n.harpnote_preview_printer&&(n.harpnote_preview_printer=o),null==n.render_stack&&(n.render_stack=o),null==t&&(t=o),n.harpnote_preview_printer.$clear(),n.render_stack.$push(r(n.render_stack.$count(),1)),n.$call_consumers("render_status"),n.render_stack.$size()["$=="](1)&&n.$render_harpnotepreview_in_worker(),t.$resolve()},e.$$s=i,e.$$arity=1,e)),"fail",[],(n=function(){return(n.$$s||this).$alert("BUG - This should never happen in render Previews controller 683")},n.$$s=i,n.$$arity=0,n))},a.$$s=i,a.$$arity=0,a))},U.$$arity=0),t.defn(At,"$render_previews_in_uithread",H=function(){var e,r,n,a=this;return a.$render_tunepreview_in_uithread(),f(f(f(t.const_get_relative(Et,"Promise").$new(),"tap",[],(e=function(t){e.$$s;return null==t&&(t=o),t.$resolve()},e.$$s=a,e.$$arity=1,e)),"then",[],(r=function(){var e,n,a=r.$$s||this;return f(f(t.const_get_relative(Et,"Promise").$new(),"tap",[],(e=function(t){var r=e.$$s||this;return null==r.harpnote_preview_printer&&(r.harpnote_preview_printer=o),null==t&&(t=o),r.harpnote_preview_printer.$clear(),r.$set_active("#harpPreview"),setTimeout(function(){r.$render_harpnotepreview_callback(),t.$resolve()},0)},e.$$s=a,e.$$arity=1,e)),"fail",[],(n=function(){return(n.$$s||this).$alert("BUG - This should never happen in render Previews controller 711")},n.$$s=a,n.$$arity=0,n))},r.$$s=a,r.$$arity=0,r)),"then",[],(n=function(){var e,r=n.$$s||this;return f(t.const_get_relative(Et,"Promise").$new(),"tap",[],(e=function(r){var n=e.$$s||this;return null==n.harpnote_preview_printer&&(n.harpnote_preview_printer=o),null==n.editor&&(n.editor=o),null==u.log&&(u.log=o),null==r&&(r=o),n.harpnote_preview_printer.$bind_elements(),n.$call_consumers("error_alert"),n.editor.$set_annotations(u.log.$annotations()),t.const_get_relative(Et,"LastRenderMonitor").$new().$clear(),r.$resolve()},e.$$s=r,e.$$arity=1,e))},n.$$s=a,n.$$arity=0,n))},H.$$arity=0),t.defn(At,"$save_file",G=function(){var e=this,r=o,n=o,a=o;return r=t.const_get_qualified(t.const_get_relative(Et,"JSZip"),"ZipFile").$new(),r.$file("song.abc",e.editor.$get_text()),r.$file("harpnotes_a4.pdf",e.$render_a4().$output("blob")),r.$file("harpnotes_a3.pdf",e.$render_a3().$output("blob")),n=r.$to_blob(),a="song"+t.const_get_relative(Et,"Time").$now().$strftime("%d%m%Y%H%M%S")+".zip",window.saveAs(n,a)},G.$$arity=0),t.defn(At,"$layout_harpnotes",Y=function(r,n){var a,i,s,l=this,$=o,_=o;null==u.log&&(u.log=o),null==u.conf&&(u.conf=o),null==r&&(r=0),null==n&&(n="A4"),f(u.log,"benchmark",["transforming music model"],(a=function(){return(a.$$s||this).$load_music_model()},a.$$s=l,a.$$arity=0,a)),u.image_list=function(){try{return u.conf.$get()["$[]"]("resources").$keys()}catch(e){if(!t.rescue(e,[t.const_get_relative(Et,"StandardError")]))throw e;try{return o}finally{t.pop_exception()}}}(),l.$set_extracts_menu();try{try{f(u.log,"benchmark",["validate default conf"],(i=function(){var t,e=i.$$s||this;return null==e.json_validator&&(e.json_validator=o),null==u.log&&(u.log=o),null==u.settings&&(u.settings=o),null==u.conf&&(u.conf=o),e.validation_errors=[],c(c(t=u.log.$loglevel()["$=="]("debug"))?t:u.settings["$[]"]("validate")["$=="]("true"))?e.validation_errors=e.json_validator.$validate_conf(u.conf):o},i.$$s=l,i.$$arity=0,i)),l.$call_consumers("document_title"),$=o,f(u.log,"benchmark",["computing layout"],(s=function(){var a=s.$$s||this,i=o,c=o;return null==a.music_model&&(a.music_model=o),i=t.const_get_qualified(t.const_get_qualified(t.const_get_relative(Et,"Harpnotes"),"Layout"),"Default").$new(),c=[a.$class().$get_uri()],f(i,"uri=",t.to_a(c)),c[e(c.length,1)],c=[a.$get_placeholder_replacers(r)],f(i,"placeholders=",t.to_a(c)),c[e(c.length,1)],$=i.$layout(a.music_model,o,r,n)},s.$$s=l,s.$$arity=0,s)),l.editor.$set_annotations(u.log.$annotations())}catch(e){if(!t.rescue(e,[t.const_get_relative(Et,"Exception")]))throw e;_=e;try{u.log.$error(""+_.$message(),o,o,_.$backtrace())}finally{t.pop_exception()}}}finally{u.conf.$pop()}return $},Y.$$arity=-1),t.defn(At,"$get_placeholder_replacers",V=function(e){var r,n,a,i,s,$,_,d,p,h,g,m,v=this;return l(["composer","key","meter","number","o_key","tempo","title","extract_title","extract_filename","printed_extracts","watermark","current_year"],{composer:f(v,"lambda",[],(r=function(){var t=r.$$s||this;return null==t.music_model&&(t.music_model=o),t.music_model.$meta_data()["$[]"]("composer")},r.$$s=v,r.$$arity=0,r)),key:f(v,"lambda",[],(n=function(){var t=n.$$s||this;return null==t.music_model&&(t.music_model=o),t.music_model.$meta_data()["$[]"]("key")},n.$$s=v,n.$$arity=0,n)),meter:f(v,"lambda",[],(a=function(){var t=a.$$s||this;return null==t.music_model&&(t.music_model=o),t.music_model.$meta_data()["$[]"]("meter").$join(" ")},a.$$s=v,a.$$arity=0,a)),number:f(v,"lambda",[],(i=function(){var t=i.$$s||this;return null==t.music_model&&(t.music_model=o),t.music_model.$meta_data()["$[]"]("number")},i.$$s=v,i.$$arity=0,i)),o_key:f(v,"lambda",[],(s=function(){var t=s.$$s||this;return null==t.music_model&&(t.music_model=o),t.music_model.$meta_data()["$[]"]("o_key")},s.$$s=v,s.$$arity=0,s)),tempo:f(v,"lambda",[],($=function(){var t=$.$$s||this;return null==t.music_model&&(t.music_model=o),t.music_model.$meta_data()["$[]"]("tempo_display")},$.$$s=v,$.$$arity=0,$)),title:f(v,"lambda",[],(_=function(){var t=_.$$s||this;return null==t.music_model&&(t.music_model=o),t.music_model.$meta_data()["$[]"]("title")},_.$$s=v,_.$$arity=0,_)),extract_title:f(v,"lambda",[],(d=function(){d.$$s;return null==u.conf&&(u.conf=o),u.conf["$[]"]("extract."+e+".title")},d.$$s=v,d.$$arity=0,d)),extract_filename:f(v,"lambda",[],(p=function(){p.$$s;return null==u.conf&&(u.conf=o),u.conf["$[]"]("extract."+e+".filenamepart")},p.$$s=v,p.$$arity=0,p)),printed_extracts:f(v,"lambda",[],(h=function(){var t,e=h.$$s||this;return null==u.conf&&(u.conf=o),f(u.conf["$[]"]("produce"),"map",[],(t=function(e){t.$$s;return null==u.conf&&(u.conf=o),null==e&&(e=o),u.conf["$[]"]("extract."+e+".filenamepart")},t.$$s=e,t.$$arity=1,t)).$join(" ")},h.$$s=v,h.$$arity=0,h)),watermark:f(v,"lambda",[],(g=function(){var t;g.$$s;return null==u.settings&&(u.settings=o),c(t=u.settings["$[]"]("watermark"))?t:""},g.$$s=v,g.$$arity=0,g)),current_year:f(v,"lambda",[],(m=function(){m.$$s;return t.const_get_relative(Et,"Time").$now().$year().$to_s()},m.$$s=v,m.$$arity=0,m))})},V.$$arity=1),t.defn(At,"$load_music_model",Q=function(){var r,n,a=this,i=o,s=o,c=o,l=o;return null==u.conf&&(u.conf=o),i=a.$get_config_from_editor(),u.conf.$reset_to(1),u.conf.$push(i),s=t.const_get_qualified(t.const_get_qualified(t.const_get_relative(Et,"Harpnotes"),"Input"),"Abc2svgToHarpnotes").$new(),n=s.$transform(a.editor.$get_abc_part()),r=t.to_ary(n),a.music_model=null==r[0]?o:r[0],c=null==r[1]?o:r[1],a.abc_model=s.$abc_model(),l=[c],f(a.harpnote_player,"player_model_abc=",t.to_a(l)),l[e(l.length,1)],l=[a.editor.$get_checksum()],f(a.music_model,"checksum=",t.to_a(l)),l[e(l.length,1)],a.document_title=a.music_model.$meta_data()["$[]"]("filename")},Q.$$arity=0),t.defn(At,"$get_config_from_editor",X=function(){var e,r,n=this,a=o,i=o;return null==u.log&&(u.log=o),r=n.editor.$get_config_model(),e=t.to_ary(r),a=null==e[0]?o:e[0],i=null==e[1]?o:e[1],c(i)&&(r=n.$migrate_config(a),e=t.to_ary(r),a=null==e[0]?o:e[0],i=null==e[1]?o:e[1],c(i["$[]"]("changed"))&&(u.log.$info(i["$[]"]("message")),n.editor.$set_config_model(a,"{migrated config}",!0))),a},X.$$arity=0),t.defs(At,"$get_uri",J=function(){var t=this,e=o;e=o,e=new URL(window.location.href);var r={};return e.search.substr(1).split("&").forEach(function(t){var e=t.split("="),n=e[0],a=e[1]&&decodeURIComponent(e[1]);(r[n]=r[n]||[]).push(a)}),e.parsed_search=r,t.$Native(e)},J.$$arity=0),t.defn(At,"$highlight_abc_object_by_player_callback",W=function(e,r){var n,a,i=this,s=o,l=o;return s=t.const_get_relative(Et,"Element").$find("._"+e+"_"),c(r)?(s.$add_class("highlightplay"),i.tune_preview_printer.$scroll_into_view(s.$first()),l=f(s,"select",[],(n=function(t){n.$$s;return null==t&&(t=o),t["$has_class?"]("znref")},n.$$s=i,n.$$arity=1,n)).$last(),c(l)&&i.harpnote_preview_printer.$scroll_to_element(f(s,"select",[],(a=function(t){a.$$s;return null==t&&(t=o),t["$has_class?"]("znref")},a.$$s=i,a.$$arity=1,a)).$last())):s.$remove_class("highlightplay"),o},W.$$arity=2),t.defn(At,"$highlight_abc_object",K=function(t){var r=this,n=o,a=o,i=o;return n=r.$Native(t),a=n["$[]"]("startChar"),i=n["$[]"]("endChar"),i["$=="](a)&&(i=e(i,5)),c(r.harpnote_player["$is_playing?"]())||(r.editor.$select_range_by_position(a,i,r.expand_selection),r.$call_consumers("current_notes")),r.tune_preview_printer.$range_highlight_more(n["$[]"]("startChar"),n["$[]"]("endChar")),r.harpnote_preview_printer.$range_highlight_more(n["$[]"]("startChar"),n["$[]"]("endChar"))},K.$$arity=1),t.defn(At,"$unhighlight_abc_object",Z=function(t){var e=this,r=o;return r=e.$Native(t),e.tune_preview_printer.$range_unhighlight_more(r["$[]"]("startChar"),r["$[]"]("endChar")),e.harpnote_preview_printer.$range_unhighlight(r["$[]"]("startChar"),r["$[]"]("endChar"))},Z.$$arity=1),t.defn(At,"$select_abc_object",tt=function(t){return this.$highlight_abc_object(t)},tt.$$arity=1),t.defn(At,"$select_by_time_segments",et=function(e){var r,n,a,i=this,s=o,l=o;return s=[],l=f(i.abc_model["$[]"]("voices"),"map",[],(r=function(t){r.$$s;return null==t&&(t=o),t["$[]"]("symbols")},r.$$s=i,r.$$arity=1,r)),f(e,"each",[],(n=function(e){var r,a=n.$$s||this;return null==e&&(e=o),f(l,"each",[],(r=function(n){var a,i,l=r.$$s||this,u=o;return null==n&&(n=o),u=f(f(n,"select",[],(a=function(t){a.$$s;return null==t&&(t=o),[5,6,12,14]["$include?"](t["$[]"]("type"))["$!"]()},a.$$s=l,a.$$arity=1,a)),"select",[],(i=function(r){i.$$s;return null==r&&(r=o),f(r["$[]"]("time"),"between?",t.to_a(e))},i.$$s=l,i.$$arity=1,i)),c(u["$empty?"]())?o:s.$push([u.$first(),u.$last()])},r.$$s=a,r.$$arity=1,r))},n.$$s=i,n.$$arity=1,n)),f(s,"each",[],(a=function(t){var e=a.$$s||this;return null==e.editor&&(e.editor=o),null==t&&(t=o),t["$=="](s.$first())?e.editor.$select_range_by_position(t.$first()["$[]"]("istart"),t.$last()["$[]"]("iend")):e.editor.$select_add_range_by_position(t.$first()["$[]"]("istart"),t.$last()["$[]"]("iend"))},a.$$s=i,a.$$arity=1,a))},et.$$arity=1),t.defn(At,"$get_selected_time_segments",rt=function(){var n,a=this,i=o;return null==u.log&&(u.log=o),i=a.editor.$get_selection_ranges(),u.log.$info(i.$to_json()),f(i,"map",[],(n=function(a){var i,s=n.$$s||this,l=o,$=o,_=o,d=o;return null==s.abc_model&&(s.abc_model=o),null==u.log&&(u.log=o),null==a&&(a=o),l=a.$to_a(),l.$first()["$=="](l.$last())||(l=[l.$first(),e(l.$last(),1)]),$=f(s.abc_model["$[]"]("voices"),"map",[],(i=function(e){var r,n=i.$$s||this;return null==e&&(e=o),f(e["$[]"]("symbols"),"select",[],(r=function(e){var n,a;r.$$s;return null==e&&(e=o),c(n=(c(a=e["$[]"]("iend")["$nil?"]())?a:e["$[]"]("istart")["$nil?"]())["$!"]())?c(a=f(e["$[]"]("istart"),"between?",t.to_a(l)))?a:f(e["$[]"]("iend"),"between?",t.to_a(l)):n},r.$$s=n,r.$$arity=1,r))},i.$$s=s,i.$$arity=1,i)),_=$.$flatten().$compact(),u.log.$info(_.$to_json()),c(_["$empty?"]())?(u.log.$error(t.const_get_relative(Et,"I18n").$t("your cursor is not within a voice")),d=[0,0]):d=[_.$first()["$[]"]("time"),e(r(_.$last()["$[]"]("time"),_.$last()["$[]"]("dur")),1)],d},n.$$s=a,n.$$arity=1,n))},rt.$$arity=0),t.defn(At,"$set_status",nt=function(r){var n=this,a=o;return null==u.log&&(u.log=o),n.systemstatus["$merge!"](r),u.log.$debug("sytemstatus: "+n.systemstatus.$to_s()+" controller 995"),n.systemstatus["$[]"]("loglevel")["$=="](u.log.$loglevel())||(a=[n.systemstatus["$[]"]("loglevel")],f(u.log,"loglevel=",t.to_a(a)),a[e(a.length,1)]),n.$save_to_localstorage(),n.$call_consumers("systemstatus"),o},nt.$$arity=1),t.defn(At,"$set_status_dropbox_status",at=function(){var t=this;return t.$set_status(l(["dropbox","dropboxapp","dropboxpath","dropboxloginstate"],{dropbox:t.dropboxclient.$app_name()+": "+t.dropboxpath,dropboxapp:t.dropboxclient.$app_id(),dropboxpath:t.dropboxpath,dropboxloginstate:t.dropboxloginstate}))},at.$$arity=0),t.defn(At,"$clear_status_dropbox_status",it=function(){var t=this;return t.$set_status(l(["dropbox","dropboxapp","dropboxpath","dropboxloginstate"],{dropbox:t.dropboxclient.$app_name()+": "+t.dropboxpath,dropboxapp:o,dropboxpath:o,dropboxloginstate:o}))},it.$$arity=0),t.defn(At,"$set_extracts_menu",ot=function(){var t,e=this;return null==u.log&&(u.log=o),f(u.log,"benchmark",["prepare extract menu"],(t=function(){var e,r=t.$$s||this,n=o;return null==u.conf&&(u.conf=o),n=u.conf["$[]"]("produce"),r.extracts=f(u.conf.$get("extract"),"inject",[[]],(e=function(t,r){var a=(e.$$s,o),i=o,s=o;return null==t&&(t=o),null==r&&(r=o),a=r.$last().$dig("filenamepart"),i=function(){return c(n["$include?"](r.$first().$to_i()))?"*  ":" "}(),s=""+i+a+" "+r.$last()["$[]"]("title")+" ",t.$push([r.$first(),s])},e.$$s=r,e.$$arity=2,e)),r.$call_consumers("extracts")},t.$$s=e,t.$$arity=0,t))},ot.$$arity=0),t.defn(At,"$setup_harpnote_preview",st=function(){var e,n,a,i,s,u,_=this;return _.harpnote_preview_printer=t.const_get_qualified(t.const_get_relative(Et,"Harpnotes"),"SvgEngine").$new("harpPreview",10,10),_.$set_harppreview_size([2200,1400]),_.harpnote_preview_printer.$set_view_box(0,0,420,297),f(_.harpnote_preview_printer,"on_select",[],(e=function(t){var r=e.$$s||this;return null==t&&(t=o),r.$select_abc_object(t["$[]"]("origin"))},e.$$s=_,e.$$arity=1,e)),f(_.harpnote_preview_printer,"on_drag_start",[],(n=function(t){n.$$s;return null==t&&(t=o),o},n.$$s=_,n.$$arity=1,n)),f(_.harpnote_preview_printer,"on_drag_end",[],(a=function(t){var e,n=a.$$s||this,i=o,s=o;return null==n.editor&&(n.editor=o),null==n.config_form_editor&&(n.config_form_editor=o),null==t&&(t=o),i=t["$[]"]("conf_key"),s=t["$[]"]("conf_value_new"),c(s)||(s=f(t["$[]"]("conf_value")["$[]"]("pos").$zip(t["$[]"]("delta")),"map",[],(e=function(t){e.$$s;return null==t&&(t=o),r(t.$first(),t.$last())},e.$$s=n,e.$$arity=1,e))),n.editor.$patch_config_part(i,s,"drag "+i),c(n.config_form_editor)?n.config_form_editor.$refresh_form():o},a.$$s=_,a.$$arity=1,a)),f(_.harpnote_preview_printer,"on_mouseover",[],(i=function(t){i.$$s;return null==t&&(t=o),update_mouseover_status_w2ui(t["$[]"]("conf_key"))},i.$$s=_,i.$$arity=1,i)),f(_.harpnote_preview_printer,"on_mouseout",[],(s=function(t){s.$$s;return null==t&&(t=o),update_mouseover_status_w2ui("")},s.$$s=_,s.$$arity=1,s)),f(_.harpnote_preview_printer,"on_draggable_rightcklick",[],(u=function(e){var r,n=u.$$s||this,a=o;return null==e&&(e=o),a=[],c(e["$[]"]("conf_key"))&&a.$push(l(["id","text","icon"],{id:e["$[]"]("conf_key"),text:t.const_get_relative(Et,"I18n").$t("Edit Config"),icon:"fa fa-gear"})),f(e["$[]"]("more_conf_keys"),"each",[],(r=function(t){var e=(r.$$s,o),n=o,i=o,s=o;return null==t&&(t=o),e=t["$[]"]("conf_key"),n=t["$[]"]("text"),i=t["$[]"]("icon"),s=t["$[]"]("value"),a.$push(l(["id","text","icon","value"],{id:e,text:n,icon:i,value:s}))},r.$$s=n,r.$$arity=1,r)),$(e["$[]"]("element")).w2menu({items:a.$to_n(),onSelect:function(t){w2ui.layout_left_tabs.click("configtab"),null!=t.item.value&&n.$handle_command("cconf "+t.item.id+" "+t.item.value),n.$handle_command("editconf "+t.item.id.$gsub(/\.[^\.]+$/,"")),null!=t.item.value&&n.$handle_command("render")}}),!1},u.$$s=_,u.$$arity=1,u))},st.$$arity=0),t.defn(At,"$setup_tune_preview",ct=function(){var e,r=this;return r.tune_preview_printer=t.const_get_qualified(t.const_get_relative(Et,"ABC2SVG"),"Abc2Svg").$new(t.const_get_relative(Et,"Element").$find("#tunePreview")),f(r.tune_preview_printer,"on_select",[],(e=function(t){var r=e.$$s||this;return null==t&&(t=o),r.$Native(t),r.$select_abc_object(t)},e.$$s=r,e.$$arity=1,e))},ct.$$arity=0),t.defn(At,"$setup_harpnote_player",lt=function(){var r=this,n=o;return r.harpnote_player=t.const_get_qualified(t.const_get_qualified(t.const_get_relative(Et,"Harpnotes"),"Music"),"HarpnotePlayer").$new(),n=[r],f(r.harpnote_player,"controller=",t.to_a(n)),n[e(n.length,1)]},lt.$$arity=0),t.defn(At,"$set_harppreview_size",ut=function(t){var e=this;return e.harp_preview_size=t,e.harpnote_preview_printer.$set_canvas(t),e.$call_consumers("harp_preview_size")},ut.$$arity=1),t.defn(At,"$toggle_autorefresh",ft=function(){var t=this;return t.systemstatus["$[]"]("autorefresh")["$=="]("on")?t.$handle_command("autorefresh off"):t.$handle_command("autorefresh on"),t.$call_consumers("render_status")},ft.$$arity=0),t.defn(At,"$toggle_console",$t=function(){var t=this;w2ui.layout.toggle("bottom",!0),t.editor.$resize()},$t.$$arity=0),t.defn(At,"$show_console",_t=function(){var t=this;w2ui.layout.show("bottom",!0),t.editor.$resize()},_t.$$arity=0),t.defn(At,"$setup_worker_listners",dt=function(){var r,a,i,s,$,_,d,p,h,g,m,v=this;return f(v.worker_tunepreview,"on_named_message",["compute_tune_preview"],(r=function(t){var e,n=r.$$s||this;return null==u.log&&(u.log=o),null==t&&(t=o),f(u.log,"benchmark",["preocessing reply from compute_tune_preview"],(e=function(){var r=e.$$s||this,n=o;return null==r.tune_preview_printer&&(r.tune_preview_printer=o),n=t["$[]"]("payload"),r.$set_inactive("#tunePreview"),r.tune_preview_printer.$set_svg(n)},e.$$s=n,e.$$arity=0,e))},r.$$s=v,r.$$arity=1,r)),f(v.worker,"on_named_message",["get_worker_info"],(a=function(t){var e=a.$$s||this;return null==t&&(t=o),e.worker_info=t["$[]"]("payload")},a.$$s=v,a.$$arity=1,a)),f(v.worker,"on_named_message",["set_logger_status"],(i=function(t){var e=i.$$s||this;return null==e.editor&&(e.editor=o),null==u.log&&(u.log=o),null==t&&(t=o),e.editor.$set_annotations(u.log.$annotations())},i.$$s=v,i.$$arity=1,i)),f(v.worker,"on_named_message",["compute_harpnotes_preview"],(s=function(e){var r,a=s.$$s||this;return null==u.log&&(u.log=o),null==e&&(e=o),f(u.log,"benchmark",["processing reply from compute_harpnotes_preview"],(r=function(){var a=r.$$s||this,i=o;return null==a.render_stack&&(a.render_stack=o),null==a.harpnote_preview_printer&&(a.harpnote_preview_printer=o),null==a.harp_preview_size&&(a.harp_preview_size=o),null==a.editor&&(a.editor=o),null==u.log&&(u.log=o),i=e["$[]"]("payload"),c(n(a.render_stack.$size(),1))&&(a.harpnote_preview_printer.$set_svg(i),a.$set_harppreview_size(a.harp_preview_size),a.$set_status(l(["harpnotes_dirty"],{harpnotes_dirty:!1})),a.$set_status(l(["refresh"],{refresh:!1})),a.$set_inactive("#harpPreview"),t.const_get_relative(Et,"LastRenderMonitor").$new().$clear(),a.editor.$set_annotations(u.log.$annotations())),a.render_stack.$shift(),a.$call_consumers("render_status"),c(a.render_stack["$empty?"]())||(a.render_stack.$clear(),a.$render_previews()),o},r.$$s=a,r.$$arity=0,r))},s.$$s=v,s.$$arity=1,s)),f(v.worker,"on_named_message",["error_alert"],($=function(t){var e=$.$$s||this;return null==t&&(t=o),e.$call_consumers("error_alert")},$.$$s=v,$.$$arity=1,$)),f(v.worker,"on_named_message",["update_ui"],(_=function(t){var e=_.$$s||this;return null==t&&(t=o),e.extracts=t["$[]"]("payload")["$[]"]("extracts"),e.$call_consumers("extracts"),e.document_title=t["$[]"]("payload")["$[]"]("document_title"),e.$call_consumers("document_title")},_.$$s=v,_.$$arity=1,_)),f(v.worker,"on_named_message",["load_player_model_abc"],(d=function(r){var n,a=d.$$s||this;return null==u.log&&(u.log=o),null==r&&(r=o),f(u.log,"benchmark",["preocessing reply from load_player_model_abc"],(n=function(){var a=n.$$s||this,i=o;return null==a.harpnote_player&&(a.harpnote_player=o),i=[JSON.parse(r["$[]"]("payload"))],f(a.harpnote_player,"player_model_abc=",t.to_a(i)),i[e(i.length,1)]},n.$$s=a,n.$$arity=0,n))},d.$$s=v,d.$$arity=1,d)),f(v.worker,"on_named_message",["load_player_from_worker"],(p=function(t){var e,r=p.$$s||this;return null==u.log&&(u.log=o),null==t&&(t=o),f(u.log,"benchmark",["preocessing reply from load_player_model"],(e=function(){var r=e.$$s||this;return null==r.harpnote_player&&(r.harpnote_player=o),r.harpnote_player.$set_worker_model(t["$[]"]("payload"))},e.$$s=r,e.$$arity=0,e))},p.$$s=v,p.$$arity=1,p)),f(v.worker,"on_named_message",["load_abc_model"],(h=function(t){var e,r=h.$$s||this;return null==u.log&&(u.log=o),null==t&&(t=o),f(u.log,"benchmark",["preocessing reply from load_abc_model"],(e=function(){return(e.$$s||this).abc_model=t["$[]"]("payload")},e.$$s=r,e.$$arity=0,e))},h.$$s=v,h.$$arity=1,h)),f(v.worker,"on_named_message",["log"],(g=function(t){g.$$s;return null==u.log&&(u.log=o),null==t&&(t=o),u.log.$log_from_worker(t["$[]"]("payload"))},g.$$s=v,g.$$arity=1,g)),f(v.worker,"on_named_message",["rescue_from_worker_error"],(m=function(t){var e=m.$$s||this;return null==e.render_stack&&(e.render_stack=o),null==t&&(t=o),e.render_stack.$clear(),e.$call_consumers("error_alert"),e.$call_consumers("render_status")},m.$$s=v,m.$$arity=1,m))},dt.$$arity=0),t.defn(At,"$setup_ui_listener",pt=function(){var e,n,a,i,s,$,d,p,h,g=this;return null==u.window&&(u.window=o),f(g.editor,"on_change",[],(e=function(t){var r=e.$$s||this;return null==t&&(t=o),r.$set_status(l(["music_model"],{music_model:"changed"})),r.$set_status(l(["harpnotes_dirty"],{harpnotes_dirty:!0})),r.$request_refresh(!0),o},e.$$s=g,e.$$arity=1,e)),f(g.editor,"on_selection_change",[],(n=function(t){var e,r=n.$$s||this,a=o;return null==r.editor&&(r.editor=o),null==r.harpnote_preview_printer&&(r.harpnote_preview_printer=o),null==r.tune_preview_printer&&(r.tune_preview_printer=o),null==t&&(t=o),a=r.editor.$get_selection_ranges(),r.editor.$get_selection_info(),r.harpnote_preview_printer.$unhighlight_all(),r.tune_preview_printer.$unhighlight_all(),f(a,"each",[],(e=function(t){var r=e.$$s||this;return null==r.harpnote_preview_printer&&(r.harpnote_preview_printer=o),null==r.tune_preview_printer&&(r.tune_preview_printer=o),null==r.harpnote_player&&(r.harpnote_player=o),null==t&&(t=o),r.harpnote_preview_printer.$range_highlight_more(t.$first(),t.$last()),r.tune_preview_printer.$range_highlight_more(t.$first(),t.$last()),r.harpnote_player.$range_highlight(t.$first(),t.$last())},e.$$s=r,e.$$arity=1,e))},n.$$s=g,n.$$arity=1,n)),f(g.editor,"on_cursor_change",[],(a=function(t){var e=a.$$s||this,n=o,i=o,s=o,u=o,f=o,$=o;return null==e.editor&&(e.editor=o),null==t&&(t=o),e.$request_refresh(!1),n=e.editor.$get_selection_info(),i=e.editor.$get_selection_ranges(),s=n["$[]"]("selection"),u=s.$first().$first()+":"+s.$first().$last(),s.$first()["$=="](s.$last())||(u=r(u," - "+s.$last().$first()+":"+s.$last().$last())),f=c(n["$[]"]("token"))?n["$[]"]("token"):l(["type","value"],{type:"",value:""}),$=l(["position","tokeninfo","token","selections"],{position:u,tokeninfo:f["$[]"]("type")+" ["+f["$[]"]("value")+"]",token:f,selections:i}),update_editor_status_w2ui($.$to_n())},a.$$s=g,a.$$arity=1,a)),f(g.harpnote_player,"on_noteon",[],(i=function(t){var e=i.$$s||this;return null==u.settings&&(u.settings=o),null==t&&(t=o),u.settings["$[]"]("follow")["$=="]("false")?o:e.$highlight_abc_object_by_player_callback(t["$[]"]("startChar"),!0)},i.$$s=g,i.$$arity=1,i)),f(g.harpnote_player,"on_noteoff",[],(s=function(t){var e=s.$$s||this;return null==u.settings&&(u.settings=o),null==t&&(t=o),u.settings["$[]"]("follow")["$=="]("false")?o:e.$highlight_abc_object_by_player_callback(t["$[]"]("startChar"),!1)},s.$$s=g,s.$$arity=1,s)),f(g.harpnote_player,"on_songoff",[],($=function(){var t=$.$$s||this;return t.$stop_play_abc(),t.$call_consumers("play_stop")},$.$$s=g,$.$$arity=0,$)),f(u.window,"on",["mousedown"],(d=function(t){var e=d.$$s||this;return null==t&&(t=o),e.expand_selection=t.$shift_key(),!0},d.$$s=g,d.$$arity=1,d)),f(t.const_get_relative(Et,"Element").$find("body"),"on",["keydown"],(p=function(t){var e,r,n=p.$$s||this,a=o;return null==n.editor&&(n.editor=o),null==n.zupfnoter_ui&&(n.zupfnoter_ui=o),null==t&&(t=o),c(t.$alt_key())?o:c(c(e=t.$meta_key())?e:t.$ctrl_key())?function(){return a=t.$key_code(),"A".$ord()["$==="](a)?n.editor.$select_range_by_position(0,1e4):"R".$ord()["$==="](a)||13["$==="](a)?(t.$prevent(),n.$handle_command("render")):"S".$ord()["$==="](a)?(t.$prevent(),n.$handle_command("dsave")):"P".$ord()["$==="](a)?(t.$prevent(),n.$play_abc("auto")):"K".$ord()["$==="](a)?(t.$prevent(),n.$toggle_console()):"L".$ord()["$==="](a)?(n.zupfnoter_ui.toggle_full_screen(),t.$prevent()):function(t){for(var e=0,r=t.length;e<r;e++)if(t[e]["$==="](a))return!0;return!1}(f(_(0,9,!1),"map",[],(r=function(t){r.$$s;return null==t&&(t=o),t.$to_s().$ord()},r.$$s=n,r.$$arity=1,r)))?(t.$prevent(),n.$handle_command("view "+t.$key_code().$chr())):o}():o},p.$$s=g,p.$$arity=1,p)),f(t.const_get_relative(Et,"Element").$find(window),"on",["storage"],(h=function(t){var e,r=h.$$s||this,n=o,a=o;return null==r.systemstatus&&(r.systemstatus=o),null==u.log&&(u.log=o),null==t&&(t=o),n=r.$Native(t["$[]"]("originalEvent")).$key(),a=r.$Native(t["$[]"]("originalEvent")).$newValue(),u.log.$debug("got storage event "+n+": "+a+" (controller 1372)"),c(c(e=r.systemstatus["$[]"]("autorefresh")["$=="]("remote")?n["$=="]("command"):r.systemstatus["$[]"]("autorefresh")["$=="]("remote"))?a["$=="]("render"):e)?r.$load_from_loacalstorage():o},h.$$s=g,h.$$arity=1,h))},pt.$$arity=0),t.defn(At,"$show_message_of_the_day",ht=function(){var t=this,e=o,r=o;e=[],r=t.info_url+"/feed/",$.get(r,function(r){$(r).find("item").each(function(){var t=$(this);e.push({title:t.find("title").text(),description:t.find("description").text(),link:t.find("link").text(),pubDate:t.find("pubDate").text(),postId:t.find("post-id").text()})}),t.$present_message_of_the_day(e)})},ht.$$arity=0),t.defn(At,"$present_message_of_the_day",gt=function(e){var n,i,s,u,$=this,_=o,d=o,p=o,h=o,g=o,m=o;if(_=$.$Native(e.$first())["$[]"]("postId").$to_i(),d=c(n=$.$systemstatus()["$[]"]("last_read_info_id"))?n:0,p=f($,"lambda",[],(i=function(){return(i.$$s||this).$set_status(l(["last_read_info_id"],{last_read_info_id:_}))},i.$$s=$,i.$$arity=0,i)),h=f($,"lambda",[],(s=function(){s.$$s;return o},s.$$s=$,s.$$arity=0,s)),g='<h3><a href="'+$.info_url+'" target="_blank">'+t.const_get_relative(Et,"I18n").$t("read now")+"</a></h3>",g=r(g,f(e,"map",[],(u=function(t){var e=u.$$s||this,r=o,n=o;return null==t&&(t=o),r=e.$Native(t),n=r["$[]"]("postId"),r["$[]"]("description"),'<div style="text-align:left;"><p>'+n+": "+r["$[]"]("title")+"</p></div>"},u.$$s=$,u.$$arity=1,u)).$join()),m=l(["msg","title","width","height","modal","btn_yes","btn_no","callBack"],{msg:g,title:t.const_get_relative(Et,"I18n").$t("There is new unread information"),width:600,height:200,modal:!0,btn_yes:l(["text","class","style","callBack"],{text:t.const_get_relative(Et,"I18n").$t("already read"),class:"",style:"",callBack:p}),btn_no:l(["text","class","style","callBack"],{text:t.const_get_relative(Et,"I18n").$t("read later"),class:"",style:"",callBack:h}),callBack:o}),!c(a(_,d)))return o;w2confirm(m.$to_n())},gt.$$arity=1),t.defn(At,"$request_refresh",mt=function(t){var e,r=this,n=o;return c(t)&&r.$set_status(l(["refresh"],{refresh:!0})),c(r.refresh_timer["$empty?"]())||f(r.refresh_timer,"each",[],(e=function(t){var r=e.$$s||this;return null==r.refresh_timer&&(r.refresh_timer=o),null==t&&(t=o),clearTimeout(t),r.refresh_timer.$pop()},e.$$s=r,e.$$arity=1,e)),c(r.systemstatus["$[]"]("refresh"))?(r.$stop_play_abc(),function(){return n=r.systemstatus["$[]"]("autorefresh"),"on"["$==="](n)?r.refresh_timer.$push(setTimeout(function(){r.$render_previews()},600)):"off"["$==="](n)?r.refresh_timer.$push(setTimeout(function(){r.$render_tunepreview_in_uithread()},600)):("remote"["$==="](n),o)}()):o},mt.$$arity=1),t.defn(At,"$send_remote_command",vt=function(t){return localStorage.setItem("command",""),localStorage.setItem("command",t)},vt.$$arity=1),t.defn(At,"$set_active",yt=function(e){return t.const_get_relative(Et,"Element").$find(e).$add_class("spinner")},yt.$$arity=1),t.defn(At,"$set_inactive",bt=function(e){return t.const_get_relative(Et,"Element").$find(e).$remove_class("spinner")},bt.$$arity=1),t.defn(At,"$check_suppoerted_browser",wt=function(){var e=o,n=o;return null==u.log&&(u.log=o),e=["Chrome","Firefox","Vivaldi","Opera"],c(e["$include?"](bowser.name))?o:(n=r(t.const_get_relative(Et,"I18n").$t("Unsupported browser. Please use one of "),e.$to_s()),u.log.$warning(n),alert(n))},wt.$$arity=0),t.defn(At,"$_init_conf",xt=function(){return t.const_get_relative(Et,"InitConf").$init_conf()},xt.$$arity=0),o&&"_init_conf"}(i[0],0,i)},Opal.modules["controller-cli"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}var n=(t.top,[]),a=t.nil,i=(t.breaker,t.slice,t.klass),o=t.hash2,s=t.gvars,c=t.send,l=t.truthy,u=t.module,f=t.range;return t.add_stubs(["$new","$loglevel=","$-","$info","$strict=","$push","$_init_conf","$set_text","$patch_config_part","$get_config_from_editor","$reset_to","$get","$create_engine","$transform","$get_abc_part","$get_checksum","$checksum=","$layout_harpnotes","$include?","$[]","$meta_data","$dig","$harpnote_options","$raise","$each","$output","$render_a3","$[]=","$t","$jspdfversion","$last","$split","$get_candidate_keys","$map","$join","$to_s","$first","$compact","$gsub","$length","$+","$reverse","$lambda","$_split_parts","$_clean_models","$each_with_index","$==","$start_with?","$_set_config_json","$_set_resources_json","$error"]),function(e,r,n){function a(){}var s,c=a=i(e,null,"Controller",a);c.$$proto,[c].concat(n);t.defs(c,"$get_uri",s=function(){return o(["hostname"],{hostname:"zupfnoter-cli"})},s.$$arity=0)}(n[0],0,n),function(r,n,u){function f(){}var $,_,d,p,h,g,m,v=f=i(r,n,"CliController",f),y=v.$$proto,b=[v].concat(u);y.editor=y.music_model=a,t.defn(v,"$initialize",$=function(){var r=this,n=a;return null==s.log&&(s.log=a),null==s.conf&&(s.conf=a),s.log=t.const_get_relative(b,"NodeLogger").$new("x.log"),n=["warning"],c(s.log,"loglevel=",t.to_a(n)),n[e(n.length,1)],s.log.$info("Welcome to Zupfnoter"),s.log.$info("Zupfnoter "+t.const_get_relative(b,"VERSION")),s.log.$info("Opal:     "+t.const_get_relative(b,"RUBY_ENGINE_VERSION")),s.log.$info("Ruby:     "+t.const_get_relative(b,"RUBY_VERSION")),s.log.$info("Abc2svg:  "+abc2svg.version),
s.conf=t.const_get_relative(b,"Confstack").$new(a),n=[!1],c(s.conf,"strict=",t.to_a(n)),n[e(n.length,1)],s.conf.$push(r.$_init_conf()),s.settings=o([],{}),r.editor=t.const_get_relative(b,"TextPaneEmulatorForCli").$new(),r.json_validator=t.const_get_qualified(t.const_get_relative(b,"Ajv"),"JsonValidator").$new()},$.$$arity=0),t.defn(v,"$set_abc_input",_=function(t){return this.editor.$set_text(t)},_.$$arity=1),t.defn(v,"$call_consumers",d=function(t){return a},d.$$arity=1),t.defn(v,"$apply_config",p=function(t){return this.editor.$patch_config_part("",t,"from json file")},p.$$arity=1),t.defn(v,"$load_music_model",h=function(){var r,n,i=this,o=a,l=a,u=a,f=a;return null==s.conf&&(s.conf=a),o=i.$get_config_from_editor(),s.conf.$reset_to(1),s.conf.$push(o),l=s.conf.$get("abc_parser"),u=t.const_get_qualified(t.const_get_qualified(t.const_get_relative(b,"Harpnotes"),"Input"),"ABCToHarpnotesFactory").$create_engine(l),n=u.$transform(i.editor.$get_abc_part()),r=t.to_ary(n),i.music_model=null==r[0]?a:r[0],i.player_model_abc=null==r[1]?a:r[1],f=[i.editor.$get_checksum()],c(i.music_model,"checksum=",t.to_a(f)),f[e(f.length,1)]},h.$$arity=0),t.defn(v,"$produce_pdfs",g=function(r){var n,i=this,s=a,u=a,f=a,$=a;return i.$layout_harpnotes(),l(i.music_model.$meta_data()["$[]"]("filename")["$include?"]("{{"))?(!0,s=i.music_model.$harpnote_options().$dig("template","filebase"),l(s)||i.$raise("no filebase given for template"),u=[]):(u=i.music_model.$harpnote_options()["$[]"]("print"),s=i.music_model.$meta_data()["$[]"]("filename")),f=r,$=o([],{}),c(u,"each",[],(n=function(r){var i=n.$$s||this,o=a,l=a;return null==r&&(r=a),o=r["$[]"]("view_id"),l=[f+"/"+s+"_"+r["$[]"]("filenamepart")+"_a3.pdf",i.$render_a3(o).$output("raw")],c($,"[]=",t.to_a(l)),l[e(l.length,1)],a},n.$$s=i,n.$$arity=1,n)),$},g.$$arity=1),t.defn(v,"$about_zupfnoter",m=function(){return t.const_get_relative(b,"I18n").$t("Free software to create sheets for table harps")+"\n          Zupfnoter: "+t.const_get_relative(b,"VERSION")+"\n          Opal     : "+t.const_get_relative(b,"RUBY_ENGINE_VERSION")+"\n          Ruby     : "+t.const_get_relative(b,"RUBY_VERSION")+"\n          abc2svg  : "+abc2svg.version+"\n          jsPD     : "+t.const_get_relative(b,"JsPDF").$jspdfversion()+"\n          Website  : https://www.zupfnoter.de\n    "},m.$$arity=0)}(n[0],t.const_get_relative(n,"Controller"),n),function(n,i){var o,f,$,_,d,p,h,g=o=u(n,"I18n");g.$$proto,[g].concat(i);t.defs(g,"$t",f=function(t){return t},f.$$arity=1),t.defs(g,"$t_key",$=function(t){return this.$t(t.$split(".").$last())},$.$$arity=1),t.defs(g,"$t_help",_=function(t){var e,r,n,i=this,o=a,u=a,f=a;return o=i.$get_candidate_keys(t),u=c(o,"map",[],(e=function(t){e.$$s;return null==s.conf_helptext&&(s.conf_helptext=a),null==t&&(t=a),s.conf_helptext["$[]"](t.$join("."))},e.$$s=i,e.$$arity=1,e)),o=c(o,"map",[],(r=function(t){r.$$s;return null==t&&(t=a),t.$join(".")},r.$$s=i,r.$$arity=1,r)).$to_s(),f=l(n=u.$compact().$first())?n:"no help for "+o,"<h2>"+t+'</h2><div style="padding:0.5em;width:30em;">'+f+"</div>"},_.$$arity=1),t.defs(g,"$get_candidate_keys",d=function(n){var i,o,l,u,f,$,_=this,d=a,p=a,h=a,g=a;return d=n,d=c(d,"gsub",[/^(extract\.)(\d+)(.*)$/],(i=function(){var t;i.$$s;return((t=s["~"])===a?a:t["$[]"](1))+"0"+((t=s["~"])===a?a:t["$[]"](3))},i.$$s=_,i.$$arity=0,i)),d=c(d,"gsub",[/^(extract\.0\.lyrics\.)(\d+)(.*)$/],(o=function(){var t;o.$$s;return((t=s["~"])===a?a:t["$[]"](1))+"0"+((t=s["~"])===a?a:t["$[]"](3))},o.$$s=_,o.$$arity=0,o)),d=c(d,"gsub",[/^(extract\.0\.images\.)(\d+)(.*)$/],(l=function(){var t;l.$$s;return((t=s["~"])===a?a:t["$[]"](1))+"0"+((t=s["~"])===a?a:t["$[]"](3))},l.$$s=_,l.$$arity=0,l)),d=c(d,"gsub",[/^(extract\.0\.notes\.)([a-zA-SU-Z_0-9]+)(.*)$/],(u=function(){var t;u.$$s;return((t=s["~"])===a?a:t["$[]"](1))+"0"+((t=s["~"])===a?a:t["$[]"](3))},u.$$s=_,u.$$arity=0,u)),d=c(d,"gsub",[/^(extract\.0\.tuplet\.)([a-zA-SU-Z_0-9]+)(.*)$/],(f=function(){var t;f.$$s;return((t=s["~"])===a?a:t["$[]"](1))+"0"+((t=s["~"])===a?a:t["$[]"](3))},f.$$s=_,f.$$arity=0,f)),p=d.$split("."),h=[],g=[],c(t.Range.$new(0,e(p.$length(),1),!1),"each",[],($=function(e){$.$$s;return null==e&&(e=a),g.$push(p["$[]"](t.Range.$new(e,-1,!1)))},$.$$s=_,$.$$arity=1,$)),r(g,h.$reverse())},d.$$arity=1),t.defs(g,"$locale",p=function(t){return a},p.$$arity=1),t.defs(g,"$phrases",h=function(){return a},h.$$arity=0)}(n[0],n),function(e,n,o){function u(){}var $,_,d,p,h,g,m,v,y,b,w,x=u=i(e,n,"TextPaneEmulatorForCli",u),A=x.$$proto,k=[x].concat(o);return A.abc_part=A.config_separator=a,t.defn(x,"$initialize",$=function(){var e,r=this;return r.abc_text=a,r.config_separator="%%%%zupfnoter",r.on_change=c(r,"lambda",[],(e=function(){e.$$s;return a},e.$$s=r,e.$$arity=0,e)),r.config_undo=t.const_get_relative(k,"UndoManager").$new()},$.$$arity=0),t.defn(x,"$get_abc_part",_=function(){return this.abc_part},_.$$arity=0),t.defn(x,"$set_text",d=function(t){return this.$_split_parts(t)},d.$$arity=1),t.defn(x,"$_split_parts",p=function(e){var n,i=this;return i.$_clean_models(),c(e.$split(i.config_separator),"each_with_index",[],(n=function(e,i){var o=n.$$s||this;return null==s.log&&(s.log=a),null==e&&(e=a),null==i&&(i=a),i["$=="](0)?o.abc_part=e:l(e["$start_with?"](".config"))?o.$_set_config_json(e.$split(".config").$last(),"from loaded abc",!0):l(e["$start_with?"](".resources"))?o.$_set_resources_json(e.$split(".resources").$last()):s.log.$error(r(t.const_get_relative(k,"I18n").$t("unsupported section found in abc file: "),e["$[]"](f(0,10,!1))))},n.$$s=i,n.$$arity=2,n))},p.$$arity=1),t.defn(x,"$_get_abc_from_editor",h=function(){return this.abc_part},h.$$arity=0),t.defn(x,"$set_config_part",g=function(t){return a},g.$$arity=1),t.defn(x,"$clear_markers",m=function(){return a},m.$$arity=0),t.defn(x,"$set_markers",v=function(){return a},v.$$arity=0),t.defn(x,"$set_annotations",y=function(){return a},y.$$arity=0),t.defn(x,"$save_to_localstorage",b=function(t){return null==t&&(t=a),a},b.$$arity=-1),t.defn(x,"$clean_localstorage",w=function(){return a},w.$$arity=0),a&&"clean_localstorage"}(n[0],t.const_get_qualified(t.const_get_relative(n,"Harpnotes"),"TextPane"),n)},Opal.modules.confstack2=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}var n=t.top,a=[],i=t.nil,o=(t.breaker,t.slice,t.klass),s=t.truthy,c=t.send,l=t.hash2,u=t.hash,f=t.range;return t.add_stubs(["$to_n","$duplicable?","$dup","$map","$to_proc","$each_pair","$===","$deep_dup","$[]=","$-","$delete","$deep_merge!","$[]","$is_a?","$deep_merge","$key?","$call","$inject","$respond_to?","$keys","$join","$compact","$push","$digkeys","$require","$attr_accessor","$+","$push_from_env","$first","$caller","$last","$count","$new","$get_from_env","$to_json","$push_to_env","$include?","$nil?","$parse","$pop","$get","$open","$puts","$to_yaml","$has_key?","$dig","$split","$!","$raise","$==","$_resolve_dependencies","$each","$each_with_index","$_get_one","$select","$to_i","$reverse","$private","$index","$class","$_resolve_value_dependency","$_resolve_hash_dependency","$_resolve_array_dependency"]),function(e,r,n){function a(){}var i,s=a=o(e,null,"Object",a);s.$$proto,[s].concat(n);t.defn(s,"$duplicable?",i=function(){return!0},i.$$arity=0)}(a[0],0,a),function(e,r,n){function a(){}var i,s=a=o(e,null,"NilClass",a);s.$$proto,[s].concat(n);t.defn(s,"$duplicable?",i=function(){return!1},i.$$arity=0)}(a[0],0,a),function(e,r,n){function a(){}var i,s=a=o(e,null,"FalseClass",a);s.$$proto,[s].concat(n);t.defn(s,"$duplicable?",i=function(){return!1},i.$$arity=0)}(a[0],0,a),function(e,r,n){function a(){}var i,s=a=o(e,null,"TrueClass",a);s.$$proto,[s].concat(n);t.defn(s,"$duplicable?",i=function(){return!1},i.$$arity=0)}(a[0],0,a),function(e,r,n){function a(){}var i,s=a=o(e,null,"Symbol",a);s.$$proto,[s].concat(n);t.defn(s,"$duplicable?",i=function(){return!1},i.$$arity=0)}(a[0],0,a),function(e,r,n){function a(){}var i,s=a=o(e,null,"Numeric",a);s.$$proto,[s].concat(n);t.defn(s,"$duplicable?",i=function(){return!1},i.$$arity=0)}(a[0],0,a),function(e,r,n){function a(){}var i,s=a=o(e,null,"BigDecimal",a);s.$$proto,[s].concat(n);t.defn(s,"$duplicable?",i=function(){return!0},i.$$arity=0)}(a[0],0,a),function(e,r,n){function a(){}var i,s=a=o(e,null,"Method",a);s.$$proto,[s].concat(n);t.defn(s,"$duplicable?",i=function(){return!1},i.$$arity=0)}(a[0],0,a),function(e,r,n){function a(){}var i,s=a=o(e,null,"String",a);s.$$proto,[s].concat(n);t.defn(s,"$deep_dup",i=function(){return this.$to_n()},i.$$arity=0)}(a[0],0,a),function(e,r,n){function a(){}var i,s=a=o(e,null,"Numerical",a);s.$$proto,[s].concat(n);t.defn(s,"$deep_dup",i=function(){return this.$to_n()},i.$$arity=0)}(a[0],0,a),function(e,r,n){function a(){}var i,c=a=o(e,null,"Object",a);c.$$proto,[c].concat(n);t.defn(c,"$deep_dup",i=function(){var t=this;return s(t["$duplicable?"]())?t.$dup():t},i.$$arity=0)}(a[0],0,a),function(e,r,n){function a(){}var i,s=a=o(e,null,"Array",a);s.$$proto,[s].concat(n);t.defn(s,"$deep_dup",i=function(){return c(this,"map",[],"deep_dup".$to_proc())},i.$$arity=0)}(a[0],0,a),function(r,n,a){function l(){}var u,f,$,_=l=o(r,null,"Hash",l),d=(_.$$proto,[_].concat(a));t.defn(_,"$deep_dup",u=function(){var r,n=this,a=i;return a=n.$dup(),c(n,"each_pair",[],(r=function(n,o){var l,u=(r.$$s,i);return null==n&&(n=i),null==o&&(o=i),s(s(l=!1)?t.const_get_qualified("::","String")["$==="](n):l)?(u=[n,o.$deep_dup()],c(a,"[]=",t.to_a(u)),u[e(u.length,1)]):(a.$delete(n),u=[n.$deep_dup(),o.$deep_dup()],c(a,"[]=",t.to_a(u)),u[e(u.length,1)])},r.$$s=n,r.$$arity=2,r)),a},u.$$arity=0),t.defn(_,"$deep_merge",f=function(t){var e=this,r=f.$$p,n=r||i;return r&&(f.$$p=null),c(e.$dup(),"deep_merge!",[t],n.$to_proc())},f.$$arity=1),t.defn(_,"$deep_merge!",$=function(r){var n,a=this,o=$.$$p,l=o||i;return o&&($.$$p=null),c(r,"each_pair",[],(n=function(r,a){var o,u=n.$$s||this,f=i,$=i;return null==r&&(r=i),null==a&&(a=i),f=u["$[]"](r),$=[r,function(){return s(s(o=f["$is_a?"](t.const_get_relative(d,"Hash")))?a["$is_a?"](t.const_get_relative(d,"Hash")):o)?c(f,"deep_merge",[a],l.$to_proc()):s((o=l!==i)?u["$key?"](r):l!==i)?l.$call(r,f,a):a}()],c(u,"[]=",t.to_a($)),$[e($.length,1)]},n.$$s=a,n.$$arity=2,n)),a},$.$$arity=1)}(a[0],0,a),function(e,r,n){function a(){}var l,u,f=a=o(e,null,"Hash",a);f.$$proto,[f].concat(n);t.defn(f,"$dig",l=function(t){var e,r,n=this,a=arguments.length,o=a-0;o<0&&(o=0),r=new Array(o);for(var l=0;l<a;l++)r[l-0]=arguments[l];return c(r,"inject",[n],(e=function(t,r){e.$$s;return null==t&&(t=i),null==r&&(r=i),s(t["$respond_to?"]("keys"))?t["$[]"](r):i},e.$$s=n,e.$$arity=2,e))},l.$$arity=-1),t.defn(f,"$digkeys",u=function(t,e){var r,n=this;return null==t&&(t=[]),null==e&&(e=i),c(n.$keys(),"inject",[t],(r=function(t,n){var a=r.$$s||this,o=i;return null==t&&(t=i),null==n&&(n=i),o=[e,n].$compact().$join("."),t.$push(o),s(a["$[]"](n)["$respond_to?"]("keys"))&&a["$[]"](n).$digkeys(t,o),t},r.$$s=n,r.$$arity=2,r))},u.$$arity=-1)}(a[0],0,a),n.$require("json"),function(n,a,$){function _(){}var d,p,h,g,m,v,y,b,w,x,A,k,E,S,N,C,I,O,P=_=o(n,null,"Confstack",_),L=P.$$proto,M=[P].concat($);return L.confstack_name=L.sourcestack=L.confstack=L.lookup_cache=L.strict=L.confresult_cache=L.callstack=i,function(t,e,r){function n(){}var a=n=o(t,null,"DeleteMe",n);a.$$proto,[a].concat(r)}(M[0],0,M),P.$attr_accessor("strict"),t.defn(P,"$initialize",d=function(t){var e=this;return null==t&&(t="default"),e.callstack=[],e.confstack=[l([],{})],e.lookup_cache=l([],{}),e.confresult_cache=l([],{}),e.sourcestack=[],e.strict=!0,s(t)&&(e.confstack_name=r("confstack__",t),e.$push(l(["confstack"],{confstack:l(["env"],{env:e.confstack_name})})),e.$push_from_env()),e},d.$$arity=-1),t.defn(P,"$push",p=function(e){var r=this,n=i;return null==e&&(e=l([],{})),r.confresult_cache=l([],{}),r.lookup_cache=l([],{}),s(e["$is_a?"](t.const_get_relative(M,"Hash")))&&(r.sourcestack.$push(r.$caller().$first()),n=r.confstack.$last().$deep_dup().$deep_merge(e),r.confstack.$push(n)),r.confstack.$count()},p.$$arity=-1),t.defn(P,"$push_to_env",h=function(r){var n=this,a=i,o=i,s=i,u=i;return null==r&&(r=l([],{})),a=t.const_get_relative(M,"Confstack").$new(!1),a.$push(n.$get_from_env()),a.$push(r),o=a["$[]"](),s=o.$to_json(),u=[n["$[]"]("confstack.env"),s],c(t.const_get_relative(M,"ENV"),"[]=",t.to_a(u)),u[e(u.length,1)],n.$push(r)},h.$$arity=-1),t.defn(P,"$push_from_env",g=function(){var t=this;return t.$push_to_env(t.$get_from_env())},g.$$arity=0),t.defn(P,"$get_from_env",m=function(){var e=this,r=i,n=i;return r=l([],{}),s(e.$keys()["$include?"]("confstack.env"))&&(n=t.const_get_relative(M,"ENV")["$[]"](e["$[]"]("confstack.env")),s(n["$nil?"]())||(r=t.const_get_relative(M,"JSON").$parse(n))),r},m.$$arity=0),t.defn(P,"$pop",v=function(){var t=this;return t.lookup_cache=l([],{}),t.sourcestack.$pop(),t.confstack.$pop(),t.confstack.$count()},v.$$arity=0),t.defn(P,"$reset_to",y=function(e){var r=this;return r.lookup_cache=l([],{}),r.sourcestack=r.sourcestack["$[]"](t.Range.$new(0,e,!1)),r.confstack=r.confstack["$[]"](t.Range.$new(0,e,!1)),r.confstack.$count()},y.$$arity=1),t.defn(P,"$save",b=function(e){var r,n,a=this,o=i;return o=a.$get(),c(t.const_get_relative(M,"File"),"open",[e+".yaml","w"],(r=function(t){r.$$s;return null==t&&(t=i),t.$puts(o.$to_yaml())},r.$$s=a,r.$$arity=1,r)),c(t.const_get_relative(M,"File"),"open",[e+".json","w"],(n=function(t){n.$$s;return null==t&&(t=i),t.$puts(o.$to_json())},n.$$s=a,n.$$arity=1,n))},b.$$arity=1),t.defn(P,"$get",w=function(r,n){var a,o,u=this,f=i,$=i;return null==r&&(r=i),null==n&&(n=l(["resolve"],{resolve:!0})),s(r["$nil?"]())?f=u.confstack.$last():s(u.lookup_cache["$has_key?"](r))?f=u.lookup_cache["$[]"](r):(f=c(u.confstack.$last(),"dig",t.to_a(r.$split("."))),$=[r,f],c(u.lookup_cache,"[]=",t.to_a($)),$[e($.length,1)],s(f)||s(s(a=s(o=f["$nil?"]())?u.$keys()["$include?"](r)["$!"]():o)?u.strict:a)&&u.$raise("confstack: key not available: "+r)),n["$[]"]("resolve")["$=="](!0)&&(f=u.$_resolve_dependencies(r,f)),f},w.$$arity=-1),t.alias(P,"[]","get"),t.defn(P,"$each",x=function(){var t,e=this,r=x.$$p,n=r||i;return r&&(x.$$p=null),c(e.$keys(),"each",[],(t=function(e){var r=t.$$s||this;return null==e&&(e=i),n.$call(e,r["$[]"](e))},t.$$s=e,t.$$arity=1,t))},x.$$arity=0),t.defn(P,"$keys",A=function(){return this.confstack.$last().$digkeys()},A.$$arity=0),t.defn(P,"$get_source",k=function(t){var e,r,n,a=this,o=i,s=i;return o=c(a.confstack.$each_with_index(),"map",[],(e=function(r,n){var a=e.$$s||this;return null==r&&(r=i),null==n&&(n=i),[a.$_get_one(r,t),n]},e.$$s=a,e.$$arity=2,e)),s=c(o,"select",[],(r=function(t){r.$$s;return null==t&&(t=i),t.$first()["$nil?"]()["$!"]()},r.$$s=a,r.$$arity=1,r)).$last(),c(a.confstack,"map",[],(n=function(e,r){var a=n.$$s||this;return null==e&&(e=i),null==r&&(r=i),a.$_get_one(e,t)},n.$$s=a,n.$$arity=2,n)).$compact().$last(),a.sourcestack["$[]"](s.$last().$to_i())},k.$$arity=1),t.defn(P,"$[]=",E=function(e,r){var n,a=this,o=i,l=i;return s(r["$=="](t.const_get_relative(M,"DeleteMe")))?a.$delete(e):(o=e.$split(".").$reverse(),l=c(o,"inject",[r],(n=function(t,e){n.$$s;return null==t&&(t=i),null==e&&(e=i),u(e,t)},n.$$s=a,n.$$arity=2,n)),a.$push(l))},E.$$arity=2),t.defn(P,"$delete",S=function(e){var r=this,n=i;return n=e.$split("."),c(r.confstack.$last(),"dig",t.to_a(n["$[]"](f(0,-2,!1)))).$delete(n.$last())},S.$$arity=1),P.$private(),t.defn(P,"$_resolve_value_dependency",N=function(n,a){var o,l=this,u=i,f=i,$=i;return s(l.confresult_cache["$has_key?"](a))?u=l.confresult_cache["$[]"](a):(s(l.callstack["$include?"](n))&&(f=l.callstack["$[]"](t.Range.$new(c(l.callstack,"index",[],(o=function(t){o.$$s;return null==t&&(t=i),t["$=="](n)},o.$$s=l,o.$$arity=1,o)),-1,!1)),l.callstack=[],l.$raise("circular conf dependency: "+r(f,[n+" ..."]))),l.callstack.$push(n),u=a.$call(),l.callstack.$pop(),$=[n,u],c(l.confresult_cache,"[]=",t.to_a($)),$[e($.length,1)]),u},N.$$arity=2),t.defn(P,"$_resolve_array_dependency",C=function(t,e){var r,n=this;return c(e,"map",[],(r=function(t){var e=r.$$s||this;return null==t&&(t=i),e.$_resolve_dependencies(i,t)},r.$$s=n,r.$$arity=1,r))},C.$$arity=2),t.defn(P,"$_resolve_hash_dependency",I=function(r,n){var a,o=this;return c(n,"inject",[l([],{})],(a=function(n,o){var s=a.$$s||this,l=i;return null==n&&(n=i),null==o&&(o=i),l=[o.$first(),s.$_resolve_dependencies([r,o.$first()],o.$last())],c(n,"[]=",t.to_a(l)),l[e(l.length,1)],n},a.$$s=o,a.$$arity=2,a))},I.$$arity=2),t.defn(P,"$_resolve_dependencies",O=function(e,r){var n=this;return r.$class()["$=="](t.const_get_relative(M,"Proc"))&&(r=n.$_resolve_value_dependency(e,r)),r.$class()["$=="](t.const_get_relative(M,"Hash"))&&(r=n.$_resolve_hash_dependency(e,r)),r.$class()["$=="](t.const_get_relative(M,"Array"))&&(r=n.$_resolve_array_dependency(e,r)),r},O.$$arity=2),i&&"_resolve_dependencies"}(a[0],0,a)},Opal.modules["opal-abc2svg"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}function n(t,e){return"number"==typeof t&&"number"==typeof e?t>e:t["$>"](e)}function a(t,e){return"number"==typeof t&&"number"==typeof e?t*e:t["$*"](e)}var i=(t.top,[]),o=t.nil,s=(t.breaker,t.slice,t.module),c=t.klass,l=t.send,u=t.hash2,f=t.truthy,$=t.gvars;return t.add_stubs(["$attr_accessor","$lambda","$phrases","$set_callback","$error","$+","$[]","$===","$_anno_start","$_anno_stop","$push","$_callback_get_abcmodel","$to_n","$unhighlight_all","$range_highlight_more","$nil?","$each","$get_elements_by_range","$find","$==","$scroll_into_view","$add_class","$remove_class","$id","$gsub","$t","$strip_js","$get_svg","$compute_tune_preview","$set_svg","$html","$join","$[]=","$-","$sort","$map","$>","$*","$first","$last","$private","$parse","$loglevel","$debug","$to_json","$split","$inject","$length","$_mk_id","$stopPropagation","$Native","$call"]),function(i,_){var d,p=d=s(i,"ABC2SVG"),h=(p.$$proto,[p].concat(_));!function(i,s,_){function d(){}var p,h,g,m,v,y,b,w,x,A,k,E,S,N,C,I,O,P,L,M,T,B,j=d=c(i,null,"Abc2Svg",d),F=j.$$proto,R=[j].concat(_);F.user=F.root=F.printer=F.abc_source=F.interactive_elements=F.abc_model=F.player_model=F.svgbuf=F.on_select=o,j.$attr_accessor("abcplay"),t.defn(j,"$initialize",p=function(r,n){var a,i,s,c,_,d,p,h=this,g=o,m=o;return null==$.log&&($.log=o),null==n&&(n=u(["mode"],{mode:"svg"})),h.on_select=l(h,"lambda",[],(a=function(t){a.$$s;return null==t&&(t=o),o},a.$$s=h,a.$$arity=1,a)),h.printer=r,h.svgbuf=[],h.abc_source="",h.interactive_elements=u([],{}),h.abc_model=o,h.player_model=[],h.object_map=u([],{}),h.abcplay=o,h.user=u(["img_out","errmsg","read_file","annotate","page_format","keep_remark","textrans"],{img_out:o,errmsg:o,read_file:o,annotate:!0,page_format:!0,keep_remark:!0,textrans:t.const_get_relative(R,"I18n").$phrases()}),l(h,"set_callback",["errmsg"],(i=function(t,r,n){i.$$s;return null==$.log&&($.log=o),null==t&&(t=o),null==r&&(r=o),null==n&&(n=o),f(r)?$.log.$error(t,[e(r,1),e(n,1)]):$.log.$error(t)},i.$$s=h,i.$$arity=3,i)),g=n["$[]"]("mode"),"svg"["$==="](g)?(l(h,"set_callback",["anno_start"],(s=function(t,e,r,n,a,i,c){var l=s.$$s||this;return null==t&&(t=o),null==e&&(e=o),null==r&&(r=o),null==n&&(n=o),null==a&&(a=o),null==i&&(i=o),null==c&&(c=o),l.$_anno_start(t,e,r,n,a,i,c)},s.$$s=h,s.$$arity=7,s)),l(h,"set_callback",["anno_stop"],(c=function(t,e,r,n,a,i,s){var l=c.$$s||this;return null==t&&(t=o),null==e&&(e=o),null==r&&(r=o),null==n&&(n=o),null==a&&(a=o),null==i&&(i=o),null==s&&(s=o),l.$_anno_stop(t,e,r,n,a,i,s)},c.$$s=h,c.$$arity=7,c)),l(h,"set_callback",["img_out"],(_=function(t){var e=_.$$s||this;return null==e.svgbuf&&(e.svgbuf=o),null==t&&(t=o),e.svgbuf.$push(t)},_.$$s=h,_.$$arity=1,_)),l(h,"set_callback",["get_abcmodel"],(d=function(t,e,r,n){d.$$s;return null==t&&(t=o),null==e&&(e=o),null==r&&(r=o),null==n&&(n=o),o},d.$$s=h,d.$$arity=4,d))):"model"["$==="](g)?l(h,"set_callback",["get_abcmodel"],(p=function(t,e,r,n){var a=p.$$s||this;return null==t&&(t=o),null==e&&(e=o),null==r&&(r=o),null==n&&(n=o),a.$_callback_get_abcmodel(t,e,r,n)},p.$$s=h,p.$$arity=4,p)):$.log.$error("BUG: unsupported mode for abc2svg"),h.root=new abc2svg.Abc(h.user.$to_n()),m="\nI:titletrim 0\nI:measurenb 1\nI:contbarnb 1\nI:linewarn 0\nI:staffnonote 2\nI:stretchlast 1\n      ",h.root.tosvg("my_parameters",m),h.root},p.$$arity=-2),t.defn(j,"$range_highlight",h=function(t,e){var r=this;return r.$unhighlight_all(),r.$range_highlight_more(t,e),o},h.$$arity=2),t.defn(j,"$scroll_into_view",g=function(t){if(f(t["$nil?"]()))return o;t.parents(".svg_block").get(0).scrollIntoView(!0)},g.$$arity=1),t.defn(j,"$range_highlight_more",m=function(e,r){var n,a=this;return l(a.$get_elements_by_range(e,r),"each",[],(n=function(e){var r=n.$$s||this,a=o;return null==$.settings&&($.settings=o),null==e&&(e=o),a=t.const_get_relative(R,"Element").$find("#"+e),$.settings["$[]"]("autoscroll")["$=="]("false")||r.$scroll_into_view(a),a.$add_class("highlight")},n.$$s=a,n.$$arity=1,n)),o},m.$$arity=2),t.defn(j,"$range_unhighlight_more",v=function(e,r){var n,a=this;return l(a.$get_elements_by_range(e,r),"each",[],(n=function(e){var r=(n.$$s,o);return null==e&&(e=o),r=t.const_get_relative(R,"Element").$find("#"+e),r.$remove_class("highlight")},n.$$s=a,n.$$arity=1,n))},v.$$arity=2),t.defn(j,"$unhighlight_all",y=function(){var e=this;return t.const_get_relative(R,"Element").$find("#"+e.printer.$id()+" .highlight").$remove_class("highlight")},y.$$arity=0),t.defn(j,"$on_select",b=function(){var t=this,e=b.$$p,r=e||o;return e&&(b.$$p=null),t.on_select=r},b.$$arity=0),t.defn(j,"$strip_js",w=function(e){var r=o;return null==$.log&&($.log=o),r=e.$gsub(/(I:|%%)(beginjs|endjs)/,"% removed "),e["$=="](r)||$.log.$error(t.const_get_relative(R,"I18n").$t("CAUTION: your abc-code is vulnerable !!! removed beginjs / endjs"),[1,1]),r},w.$$arity=1),t.defn(j,"$compute_tune_preview",x=function(t,r){var n=this,a=o;return null==r&&(r=""),a="\n%%textoption right\n%%textfont * * 8\n%%text "+r+"\n      ",n.abc_source=n.$strip_js(t),n.interactive_elements=u([],{}),n.svgbuf=[],n.root.tosvg("abc",e(n.abc_source,a)),u(["svg","interactive_elements"],{svg:n.$get_svg(),interactive_elements:n.interactive_elements})},x.$$arity=-2),t.defn(j,"$draw",A=function(t,e){var r=this,n=o;return null==e&&(e=""),n=r.$compute_tune_preview(t,e=""),r.$set_svg(n)},A.$$arity=-2),t.defn(j,"$set_svg",k=function(t){var e=this;return e.interactive_elements=t["$[]"]("interactive_elements"),e.printer.$html(t["$[]"]("svg")),o},k.$$arity=1),t.defn(j,"$get_abcmodel",E=function(t){var e=this,r=o;return null==$.log&&($.log=o),r=e.$strip_js(t),abc2svg.modules.load(r,function(){console.log("modules loaded")},function(t){$.log.$error(t)}),e.root.tosvg("abc",r),[e.abc_model,e.player_model]},E.$$arity=1),t.defn(j,"$get_svg",S=function(){var t=this,e=o;return e=t.svgbuf.$join("\n"),e=e.$gsub("<svg ",'<div class="svg_block"><svg '),e=e.$gsub("</svg>","</svg></div>")},S.$$arity=0),t.defn(j,"$get_html",N=function(){return'\n      <html>\n      <head>\n        <meta charset="utf-8"/>\n        <style type="text/css">\n           rect.abcref {fill-opacity:0.0}\n          .nobrk s\t{ white-space:nowrap; }\n          svg {display:block}\n        </style>\n      </head>\n      <body>\n         '+this.printer.$html()+"\n      </body>\n      "},N.$$arity=0),t.defn(j,"$set_callback",C=function(e){var n=this,a=C.$$p,i=a||o,s=o;return a&&(C.$$p=null),s=[e,i],l(n.user,"[]=",t.to_a(s)),s[r(s.length,1)]},C.$$arity=1),t.defn(j,"$get_elements_by_range",I=function(t,e){var i,s=this,c=o,u=o;return c=[t,e].$sort(),u=[],l(s.interactive_elements,"each",[],(i=function(t,e){var s,$=i.$$s||this,_=o;return null==t&&(t=o),null==e&&(e=o),_=l(["startChar","endChar"],"map",[],(s=function(t){s.$$s;return null==t&&(t=o),e["$[]"](t)},s.$$s=$,s.$$arity=1,s)).$sort(),f(n(a(r(c.$first(),_.$last()),r(_.$first(),c.$last())),0))?u.$push(t):o},i.$$s=s,i.$$arity=2,i)),u},I.$$arity=2),j.$private(),t.defn(j,"$_callback_get_abcmodel",O=function(e,r,n,a){var i=this,s=o;null==$.log&&($.log=o),s="",(new AbcMIDI).add(e,r),s=(new AbcJSON).gen_json(e,r,n,a);var c=new ToAudio;return c.add(e,r),i.player_model=c.clear(),i.abc_model=t.const_get_relative(R,"JSON").$parse(s),$.log.$loglevel()["$=="]("debug")&&$.log.$debug(i.abc_model.$to_json()),i.abc_model},O.$$arity=4),t.defn(j,"$_get_charpos",P=function(r,n,a){var i,s=this,c=o,u=o;return c=s.abc_source.$split("\n"),u=l(c["$[]"](t.Range.$new(0,n,!1)),"inject",[0],(i=function(t,r){i.$$s;return null==t&&(t=o),null==r&&(r=o),t=e(t,r.$length())},i.$$s=s,i.$$arity=2,i)),e(u,a)},P.$$arity=3),t.defn(j,"$_anno_start",L=function(t,e,r,n,a,i,s){var c=this,l=o;return l=c.$_mk_id(t,e,r),c.root.out_svg('<g class="'+l+'">\n'),o},L.$$arity=7),t.defn(j,"$_clickabcnote",M=function(t,e){var r=this;return r.$Native(t).$stopPropagation(),r.on_select.$call(r.interactive_elements["$[]"](e))},M.$$arity=2),t.defn(j,"$_anno_stop",T=function(e,n,a,i,s,c,f){var $=this,_=o,d=o,p=o;return _=$.$_mk_id(e,n,a),d="onclick=\"Opal.top.uicontroller.tune_preview_printer.$_clickabcnote(evt, '"+_+"')\"",$.root.out_svg("</g>\n"),$.root.out_svg("<rect "+d+' class="abcref _'+n+'_" id="'+_+'" x="'),$.root.out_sxsy(i,'" y="',s),$.root.out_svg('" width="'+c.toFixed(2)+'" height="'+f.toFixed(2)+'"/>\n'),p=[_,u(["startChar","endChar"],{startChar:n,endChar:a})],l($.interactive_elements,"[]=",t.to_a(p)),p[r(p.length,1)]},T.$$arity=7),t.defn(j,"$_mk_id",B=function(t,e,r){return"_"+t+"_"+e+"_"+r+"_"},B.$$arity=3)}(h[0],0,h)}(i[0],i)},Opal.modules["version-prod"]=function(t){var e=(t.top,[]);t.nil,t.breaker,t.slice;return t.add_stubs(["$year","$now"]),t.const_set(e[0],"VERSION","v_1.11.2-22-g3930171e"),t.const_set(e[0],"SCHEMA_VERSION","https://zupfnoter.weichel21.de/schema/zupfnoter-config_1.0.json"),t.const_set(e[0],"COPYRIGHT"," "+t.const_get_relative(e,"Time").$now().$year()+" https://www.zupfnoter.de")},abc2svg={C:{BLEN:1536,BAR:0,CLEF:1,CUSTOS:2,GRACE:4,KEY:5,METER:6,MREST:7,NOTE:8,PART:9,REST:10,SPACE:11,STAVES:12,STBRK:13,TEMPO:14,BLOCK:16,REMARK:17,FULL:0,EMPTY:1,OVAL:2,OVALBARS:3,SQUARE:4,SL_ABOVE:1,SL_BELOW:2,SL_AUTO:3,SL_HIDDEN:4,SL_DOTTED:8},Abc:function(user){"use strict";function clone(t,e){if(!t)return t;var r=new t.constructor;for(var n in t)t.hasOwnProperty(n)&&(e&&"object"==typeof t[n]?r[n]=clone(t[n],e-1):r[n]=t[n]);return r}function errbld(t,e,r,n){var a,i,o,s,c;if(user.errbld){switch(t){case 0:t="warn";break;case 1:t="error";break;default:t="fatal"}return void user.errbld(t,e,r,n)}if(void 0!=n&&n>=0){for(a=o=0;;){if((i=parse.file.indexOf("\n",a))<0||i>n)break;o++,a=i+1}s=n-a}switch(c="",r&&(c=r,o&&(c+=":"+(o+1)+":"+(s+1)),c+=" "),t){case 0:c+="Warning: ";break;case 1:c+="Error: ";break;default:c+="Internal bug: "}user.errmsg(c+e,o,s)}function error(t,e,r,n,a,i,o){var s;user.textrans&&(s=user.textrans[r])&&(r=s),arguments.length>3&&(r=r.replace(/\$./g,function(t){switch(t){case"$1":return n;case"$2":return a;case"$3":return i;default:return o}})),e&&e.fname?errbld(t,r,e.fname,e.istart):errbld(t,r)}function scanBuf(){this.index=0,scanBuf.prototype.char=function(){return this.buffer[this.index]},scanBuf.prototype.next_char=function(){return this.buffer[++this.index]},scanBuf.prototype.get_int=function(){for(var t=0,e=this.buffer[this.index];e>="0"&&e<="9";)t=10*t+Number(e),e=this.next_char();return t}}function syntax(t,e,r,n,a,i){error(t,{fname:parse.fname,istart:parse.istart+parse.line.index},e,r,n,a,i)}function js_inject(js){/eval *\(|Function|setTimeout|setInterval/.test(js)?syntax(1,"Unsecure code"):eval('"use strict"\n'+js)}function y_get(t,e,r,n){var a,i=staff_tb[t],o=r/realwidth*YSTEP|0,s=(r+n)/realwidth*YSTEP|0;if(o<0&&(o=0),s>=YSTEP&&(s=YSTEP-1,o>s&&(o=s)),e)for(a=i.top[o++];o<=s;)a<i.top[o]&&(a=i.top[o]),o++;else for(a=i.bot[o++];o<=s;)a>i.bot[o]&&(a=i.bot[o]),o++;return a}function y_set(t,e,r,n,a){var i=staff_tb[t],o=r/realwidth*YSTEP|0,s=(r+n)/realwidth*YSTEP|0;if(o<0&&(o=0),s>=YSTEP&&(s=YSTEP-1,o>s&&(o=s)),e)for(;o<=s;)i.top[o]<a&&(i.top[o]=a),o++;else for(;o<=s;)i.bot[o]>a&&(i.bot[o]=a),o++}function up_p(t,e){switch(e){case C.SL_ABOVE:return!0;case C.SL_BELOW:return!1}return t.multi&&0!=t.multi?t.multi>0:!!t.p_v.have_ly&&t.pos.voc!=C.SL_ABOVE}function d_arp(t){var e,r,n,a=t.s,i=t.dd,o=5;if(a.type==C.NOTE)for(e=0;e<=a.nhd;e++){if(a.notes[e].acc)n=5+a.notes[e].shac;else switch(n=6-a.notes[e].shhd,a.head){case C.SQUARE:n+=3.5;break;case C.OVALBARS:case C.OVAL:n+=2}n>o&&(o=n)}r=3*(a.notes[a.nhd].pit-a.notes[0].pit)+4,e=i.h,r<e&&(r=e),t.has_val=!0,t.val=r,t.x-=o,t.y=3*(a.notes[0].pit-18)-3}function d_cresc(t){if(!t.ldst){var e,r,n,a,i,o,s,c,l,u,f=t.s,$=t.start;e=$.s,i=e.x+3,c=$.ix,c>0&&(l=a_de[c-1]),t.st=f.st,t.lden=!1,t.has_val=!0,a=up_p(f,f.pos.dyn),a&&(t.up=!0),l&&l.s==e&&(t.up&&!l.up||!t.up&&l.up)&&(n=l.dd,f_staff[n.func]&&(s=l.x+l.val+4)>i&&(i=s)),t.defl.noen?(o=t.x-i)<20&&(i=t.x-20-3,o=20):(s=f.x,u=a_de[t.ix+1],u&&u.s==e&&(t.up&&!u.up||!t.up&&u.up)&&(n=u.dd,f_staff[n.func]&&(s-=5)),(o=s-i-4)<20&&(i-=.5*(20-o),o=20)),t.val=o,t.x=i,t.y=y_get(t.st,a,i,o),a||(r=t.dd,t.y-=r.h)}}function d_near(t){var e,r,n=t.s,a=t.dd;a.str||(r=n.multi?n.multi>0:n.stem<0,e=r?0|n.ymx:n.ymn-a.h|0,e>-6&&e<24&&(r&&(e+=3),e=6*((e+6)/6|0)-6),r?n.ymx=e+a.h:n.ymn=e,t.y=e,n.type==C.NOTE&&(t.x+=n.notes[n.stem>=0?0:n.nhd].shhd),"d"==a.name[0]&&n.nflags>=-1&&(r?n.stem>0&&(t.x+=3.5):n.stem<0&&(t.x-=3.5)))}function d_pf(t){var e,r,n,a,i,o=t.s,s=t.dd;t.val=s.wl+s.wr,a=up_p(o,o.pos.vol),a&&(t.up=!0),n=o.x-s.wl,t.ix>0&&(i=a_de[t.ix-1],i.s==o&&(t.up&&!i.up||!t.up&&i.up)&&(e=i.dd,f_staff[e.func]&&(r=i.x+i.val+4)>n&&(n=r))),t.x=n,t.y=y_get(o.st,a,n,t.val),a||(t.y-=s.h)}function d_slide(t){var e,r,n=t.s,a=n.notes[0].pit,i=5;for(e=0;e<=n.nhd;e++){if(n.notes[e].acc)r=4+n.notes[e].shac;else switch(r=5-n.notes[e].shhd,n.head){case C.SQUARE:r+=3.5;break;case C.OVALBARS:case C.OVAL:r+=2}n.notes[e].pit<=a+3&&r>i&&(i=r)}t.x-=i,t.y=3*(a-18)}function d_trill(t){if(!t.ldst){var e,r,n,a,i,o=t.s,s=o.st,c=t.start.s,l=c.x;if(t.prev&&(l=t.prev.x+10,n=t.prev.y),t.st=s,4!=t.dd.func)switch(t.dd.glyph){case"8va":case"15ma":r=1;break;default:r=o.multi>=0}t.defl.noen?(a=t.x-l)<20&&(l=t.x-20-3,a=20):(a=o.x-l-6,o.type==C.NOTE&&(a-=6),a<20&&(l-=.5*(20-a),a=20)),e=t.dd,n||(n=y_get(s,r,l,a)),r?(i=staff_tb[c.st].topbar+2,n<i&&(n=i)):(n-=e.h,i=staff_tb[c.st].botbar-2,n>i&&(n=i)),t.lden=!1,t.has_val=!0,t.val=a,t.x=l,t.y=n,r&&(n+=e.h),y_set(s,r,l,a,n),r?c.ymx=o.ymx=n:c.ymn=o.ymn=n}}function d_upstaff(t){if(!t.ldst){if(t.start)return void d_trill(t);var e,r,n,a=t.s,i=t.dd,o=a.x,s=i.wl+i.wr,c=staff_tb[a.st].topbar+2,l=staff_tb[a.st].botbar-2;if(a.nhd&&(o+=a.notes[a.stem>=0?0:a.nhd].shhd),r=-1,4==i.func)r=0;else if(a.pos)switch(a.pos.orn){case C.SL_ABOVE:r=1;break;case C.SL_BELOW:r=0}switch(i.glyph){case"accent":case"roll":!r||r<0&&(a.multi<0||!a.multi&&a.stem>0)?(e=y_get(a.st,!1,a.x-i.wl,s),e>l&&(e=l),e-=i.h,y_set(a.st,!1,a.x,0,e),n=!0,a.ymn=e):(e=y_get(a.st,!0,a.x,0),e<c&&(e=c),y_set(a.st,!0,a.x-i.wl,s,e+i.h),a.ymx=e+i.h);break;case"brth":case"lphr":case"mphr":case"sphr":for(e=c+1,"brth"==i.glyph&&e<a.ymx&&(e=a.ymx),a=a.ts_next;a&&!a.seqst;a=a.ts_next);o+=.45*((a?a.x:realwidth)-o);break;default:0==i.name.indexOf("invert")&&(n=!0),"invertedfermata"!=i.name&&(r>0||r<0&&a.multi>=0)?(e=y_get(a.st,!0,a.x-i.wl,s)+2,e<c&&(e=c),y_set(a.st,!0,a.x-i.wl,s,e+i.h),a.ymx=e+i.h):(e=y_get(a.st,!1,a.x-i.wl,s)-2,e>l&&(e=l),e-=i.h,y_set(a.st,!1,a.x-i.wl,s,e),"fermata"==i.name&&(n=!0),a.ymn=e)}n&&(e+=i.h,t.inv=!0),t.x=o,t.y=e}}function deco_add(t){var e=t.match(/(\S*)\s+(.*)/);decos[e[1]]=e[2]}function deco_def(t){var e,r,n,a,i,o,s=decos[t];if(!s)return void(cfmt.decoerr&&error(1,null,"Unknown decoration '$1'",t));if(!(e=s.match(/(\d+)\s+(.+?)\s+([0-9.]+)\s+([0-9.]+)\s+([0-9.]+)/)))return void error(1,null,"Invalid decoration '$1'",t);var c=Number(e[1]),l=parseFloat(e[3]),u=parseFloat(e[4]),f=parseFloat(e[5]);if(isNaN(c))return void error(1,null,"%%deco: bad C function value '$1'",e[1])
;if((c<0||c>10)&&(c<32||c>41))return void error(1,null,"%%deco: bad C function index '$1'",c);if(l<0||u<0||f<0)return void error(1,null,"%%deco: cannot have a negative value '$1'",s);if(l>50||u>80||f>80)return void error(1,null,"%%deco: abnormal h/wl/wr value '$1'",s);if(r=dd_tb[t],r||(r={name:t},dd_tb[t]=r),r.func=0==r.name.indexOf("head-")?9:c,r.glyph=e[2],r.h=l,r.wl=u,r.wr=f,o=s.replace(e[0],"").trim(),o&&('"'==o[0]&&(o=o.slice(1,-1)),r.str=o),6==r.func&&void 0==r.str&&(r.str=r.name),"("==(i=r.name.slice(-1))||")"==i&&r.name.indexOf("(")<0)if(a=r.name.slice(0,-1)+("("==i?")":"("),n=dd_tb[a])"("==i?(r.dd_en=n,n.dd_st=r):(r.dd_st=n,n.dd_en=r);else if(!(n=deco_def(a)))return;return r}function deco_cnv(t,e,r){var n,a,i,o,s,c=t.length;for(n=0;n<c;n++)if(o=t[n],(i=dd_tb[o])||(i=deco_def(o))){switch(i.func){case 0:if(e.type==C.BAR&&"dot"==i.name){e.bar_dotted=!0;break}case 1:case 2:if(!e.notes){error(1,e,errs.must_note_rest,i.name);continue}break;case 8:if(e.type!=C.NOTE){error(1,e,errs.must_note,i.name);continue}s=e.notes[e.nhd],s.a_dcn||(s.a_dcn=[]),s.a_dcn.push(i.name);continue;case 9:if(!e.notes){error(1,e,errs.must_note_rest,i.name);continue}for(a=0;a<=e.nhd;a++)s=e.notes[a],s.a_dcn||(s.a_dcn=[]),s.a_dcn.push(i.name);continue;default:break;case 10:if(e.notes)for(a=0;a<=e.nhd;a++)e.notes[a].color=i.name;else e.color=i.name;continue;case 32:e.invis=!0;continue;case 33:if(e.type!=C.BAR){error(1,e,"!beamon! must be on a bar");continue}e.beam_on=!0;continue;case 34:if(e.type!=C.NOTE||!r||r.type!=C.NOTE||e.nflags!=r.nflags){error(1,e,"!$1! must be on the last of a couple of notes",i.name);continue}for(e.trem2=!0,e.beam_end=!0,r.trem2=!0,r.beam_st=!0,e.ntrem=r.ntrem=Number(i.name[4]),r.nflags=--e.nflags,r.head=++e.head,e.nflags>0?e.nflags+=e.ntrem:(e.nflags<=-2&&(e.stemless=!0,r.stemless=!0),e.nflags=e.ntrem),r.nflags=e.nflags,a=0;a<=e.nhd;a++)e.notes[a].dur*=2;for(a=0;a<=r.nhd;a++)r.notes[a].dur*=2;continue;case 35:if(e.type!=C.NOTE){error(1,e,"!xstem! must be on a note");continue}e.xstem=!0,e.nflags=0;continue;case 36:if(e.type!=C.NOTE){error(1,e,errs.must_note,i.name);continue}"1"==i.name[6]?e.beam_br1=!0:e.beam_br2=!0;continue;case 37:e.rbstop=1;continue;case 38:if(e.type!=C.NOTE){error(1,e,errs.must_note,i.name);continue}e.trem1=!0,e.ntrem=i.name.length,e.nflags>0?e.nflags+=e.ntrem:e.nflags=e.ntrem;continue;case 39:if(e.type!=C.NOTE){error(1,e,errs.must_note,i.name);continue}e.feathered_beam="a"==i.name[5]?1:-1;continue;case 40:e.stemless=!0;continue;case 41:e.rbstop=2;continue}e.a_dd||(e.a_dd=[]),e.a_dd.push(i)}}function deco_update(t,e){var r,n,a=a_de.length;for(r=0;r<a;r++)n=a_de[r],n.s==t&&(n.x+=e)}function deco_width(t){var e,r,n=0,a=t.a_dd,i=a.length;for(r=0;r<i;r++)switch(e=a[r],e.func){case 1:n<7&&(n=7);break;case 2:n<14&&(n=14);break;case 3:switch(e.glyph){case"brth":case"lphr":case"mphr":case"sphr":t.wr<20&&(t.wr=20)}}return 0!=n&&t.prev&&t.prev.type==C.BAR&&(n-=3),n}function draw_all_deco(){if(0!=a_de.length){var t,e,r,n,a,i,o,s,c,l,u,f,$,_,d=[],p=[];if(!cfmt.dynalign)for(i=nstaff,s=staff_tb[i].y;--i>=0;)c=staff_tb[i].y,p[i]=.5*(s+24+c),s=c;for(;;){if(!(t=a_de.shift()))break;e=t.dd,e&&(e.dd_en||(r=t.s,a=e.glyph,f=a.indexOf("/"),f>0&&(a=r.stem>=0?a.slice(0,f):a.slice(f+1)),f_staff[e.func]?set_sscale(r.st):set_scale(r),i=t.st,staff_tb[i].topbar&&(o=t.x,s=t.y+staff_tb[i].y,void 0!=t.m?(n=r.notes[t.m],o+=n.shhd*stv_g.scale):f_staff[e.func]&&!cfmt.dynalign&&(t.up&&i>0||!t.up&&i<nstaff)&&(l=t.up?p[--i]:p[i++],l-=.5*e.h,(t.up&&s<l||!t.up&&s>l)&&(c=y_get(i,!t.up,t.x,t.val)+staff_tb[i].y,t.up&&(c-=e.h),(t.up&&c>l||!t.up&&c<l)&&(s=l))),u=user[a],u&&"function"==typeof u?u(o,s,t):(anno_start(r,"deco"),t.inv&&(g_open(o,s,0,1,-1),o=s=0),t.has_val?(2!=e.func||stv_g.st<0?out_deco_val(o,s,a,t.val/stv_g.scale,t.defl):out_deco_val(o,s,a,t.val,t.defl),t.defl.noen&&d.push(t.start)):void 0!=e.str&&"sfz"!=e.str?($=e.str,"@"==$[0]&&(_=$.match(/^@([0-9.-]+),([0-9.-]+);?/),o+=Number(_[1]),s+=Number(_[2]),$=$.replace(_[0],"")),out_deco_str(o,s,a,$)):t.lden?out_deco_long(o,s,t):xygl(o,s,a),stv_g.g&&g_close(),anno_stop(r,"deco")))))}a_de=d}}function draw_deco_near(){function t(t){var e,r,n,a,i,o=t.a_dd.length;for(r=0;r<o;r++){switch(e=t.a_dd[r],e.func){default:n=0;break;case 3:case 4:case 5:if(ottava[e.name])if(i=e.name.slice(0,-1)+t.st.toString(),od[i]){if("("==e.name[e.name.length-1]){od[i]++;continue}if(od[i]--,t.v+1!=od[i]>>8||!od[i])continue;od[i]&=255}else"("==e.name[e.name.length-1]&&(od[i]=1+(t.v+1<<8));n=t.pos.orn;break;case 6:n=t.pos.vol;break;case 7:n=t.pos.dyn}n!=C.SL_HIDDEN&&(a={s:t,dd:e,st:t.st,ix:a_de.length,defl:{},x:t.x,y:t.y},a_de.push(a),e.dd_en?a.ldst=!0:e.dd_st&&(a.lden=!0,a.defl.nost=!0),f_near[e.func]&&func_tb[e.func](a))}}function e(t,e){var r,n,a,i,o=t.notes[e],s=o.a_dcn.length;for(n=0;n<s;n++)if(a=o.a_dcn[n],(i=dd_tb[a])||(i=deco_def(a))){switch(i.func){case 0:case 1:case 3:case 4:case 8:break;default:error(1,null,"Cannot have !$1! on a head",i.name);continue;case 9:o.invis=!0;break;case 10:o.color=i.name;continue;case 32:o.invis=!0;continue;case 40:t.stemless=!0;continue}r={s:t,dd:i,st:t.st,m:e,ix:0,defl:{},x:t.x,y:3*(o.pit-18)},a_de.push(r),i.dd_en?r.ldst=!0:i.dd_st&&(r.lden=!0,r.defl.nost=!0)}}function r(r){var n;if(r.a_dd&&t(r),r.notes)for(n=0;n<r.notes.length;n++)r.notes[n].a_dcn&&e(r,n)}var n,a;for(n=tsfirst;n;n=n.ts_next){switch(n.type){case C.CLEF:case C.KEY:case C.METER:continue}break}for(0!=a_de.length&&function(t){var e,r,n=t.x-t.wl,a=a_de.length;for(e=0;e<a;e++)r=a_de[e],r.ix=e,r.s.x=r.x=n,r.defl.nost=!0}(n);n;n=n.ts_next){switch(n.type){case C.BAR:case C.MREST:case C.NOTE:case C.REST:case C.SPACE:break;case C.GRACE:for(a=n.extra;a;a=a.next)r(a);default:continue}r(n)}!function(){var t,e,r,n,a,i,o,s,c,l=a_de.length;for(t=0;t<l;t++)if(r=a_de[t],r.ldst){for(a=r.dd,i=a.dd_en,s=r.s,o=s.v,e=t+1;e<l&&(n=a_de[e],n.start||n.dd!=i||n.s.v!=o);e++);if(e==l)for(c=s.st,e=t+1;e<l&&(n=a_de[e],n.start||n.dd!=i||n.s.st!=c);e++);e==l&&(n={s:r.s,st:r.st,dd:i,ix:a_de.length-1,x:realwidth-6,y:r.s.y,lden:!0,defl:{noen:!0}},n.x<s.x+10&&(n.x=s.x+10),void 0!=r.m&&(n.m=r.m),a_de.push(n)),n.start=r,n.defl.nost=r.defl.nost,"trill("==a.name&&t>0&&"trill"==a_de[t-1].dd.name&&(n.prev=a_de[t-1])}for(t=0;t<l;t++)n=a_de[t],n.lden&&!n.start&&(s=n.s,r={s:prev_scut(s),st:n.st,dd:n.dd.dd_st,ix:a_de.length-1,y:s.y,ldst:!0},r.x=r.s.x,void 0!=n.m&&(r.m=n.m),a_de.push(r),n.start=r)}()}function draw_deco_note(){var t,e,r,n,a=a_de.length;for(t=0;t<a;t++)e=a_de[t],r=e.dd,n=r.func,f_note[n]&&void 0==e.m&&func_tb[n](e)}function draw_deco_staff(){var t,e,r,n,a,i,o,s,c,l,u,f,$,_,d,p=new Array(nstaff),h=a_de.length;for(o=0;o<=nstaff;o++)p[o]={ymin:0,ymax:0};for(o=0;o<h;o++)c=a_de[o],(l=c.dd)&&f_staff[l.func]&&void 0==c.m&&(func_tb[l.func](c),l.dd_en||cfmt.dynalign&&(c.up?c.y>p[c.st].ymax&&(p[c.st].ymax=c.y):c.y<p[c.st].ymin&&(p[c.st].ymin=c.y)));for(o=0;o<h;o++)c=a_de[o],(l=c.dd)&&!l.dd_en&&f_staff[l.func]&&(cfmt.dynalign?(a=c.up?p[c.st].ymax:p[c.st].ymin,c.y=a):a=c.y,c.up&&(a+=l.h),y_set(c.st,c.up,c.x,c.val,a));for(o=0;o<=nstaff;o++)p[o]={ymin:0,ymax:24};for(t=tsfirst;t;t=t.ts_next)if(t.a_gch){for(e||(e=t),f=null,$=0;$<t.a_gch.length&&(u=t.a_gch[$],!("g"==u.type&&(f=u,u.y<0)));$++);f&&(i=f.w,f.y>=0?(a=y_get(t.st,!0,t.x,i))>p[t.st].ymax&&(p[t.st].ymax=a):(a=y_get(t.st,!1,t.x,i))<p[t.st].ymin&&(p[t.st].ymin=a))}if(e){for(o=0;o<=nstaff;o++)d=staff_tb[o].botbar,p[o].ymin>d-4&&(p[o].ymin=d-4),_=staff_tb[o].topbar,p[o].ymax<_+4&&(p[o].ymax=_+4);for(set_dscale(-1),t=e;t;t=t.ts_next)t.a_gch&&draw_gchord(t,p[t.st].ymin,p[t.st].ymax)}for(s=0;s<voice_tb.length;s++)r=voice_tb[s],!r.second&&r.sym&&function(t){var e,r,a,i,o,s,c;for(a=staff_tb[t.st].topbar+25,e=t.sym;e;e=e.next)if(e.type==C.BAR&&e.rbstart&&!e.norepbra){if(!e.next)break;for(c||(c=e,set_font("repeat")),r=e;e.next&&(e=e.next,!e.rbstop););i=y_get(t.st,!0,r.x,e.x-r.x),a<i&&(a=i),r.text&&(s=strwh(r.text),i=y_get(t.st,!0,r.x+4,s[0]),i+=s[1],a<i&&(a=i)),e.rbstart&&(e=e.prev)}if(e=c)for(set_dscale(t.st,!0),i=a*staff_tb[t.st].staffscale;e;e=e.next)if(e.rbstart&&!e.norepbra){for(r=e;e.next&&(e=e.next,!e.rbstop););if(r==e)break;n=r.x,o=e.type!=C.BAR?e.rbstop?0:e.x-realwidth+4:e.bar_type.length>1&&"[]"!=e.bar_type||"]"==e.bar_type?r.st>0&&!(cur_sy.staves[r.st-1].flags&STOP_BAR)?e.wl:":"==e.bar_type.slice(-1)?12:":"!=e.bar_type[0]?0:8:e.rbstop?0:8,o=e.x-n-o,e.next||e.rbstop||t.bar_start||(t.bar_start=clone(e),t.bar_start.type=C.BAR,t.bar_start.bar_type="[",delete t.bar_start.text,t.bar_start.rbstart=1,delete t.bar_start.a_gch),r.text&&xy_str(n+4,i-gene.curfont.size-3,r.text),xypath(n,i),2==r.rbstart&&(output+="m0 20v-20"),output+="h"+o.toFixed(2),2==e.rbstop&&(output+="v20"),output+='"/>\n',y_set(r.st,!0,n,o,a+2),e.rbstart&&(e=e.prev)}}(r)}function draw_measnb(){var t,e,r,n,a,i,o,s,c=cur_sy;for(e=0;e<=nstaff&&!c.st_print[e];e++);if(!(e>nstaff)){if(set_dscale(e),1!=staff_tb[e].staffscale&&(s=get_font("measure").size,param_set_font("measurefont","* "+(s/staff_tb[e].staffscale).toString())),set_font("measure"),t=tsfirst,(r=gene.nbar)>1)if(0==cfmt.measurenb)o=!0,a=y_get(e,!0,0,20),a<staff_tb[e].topbar+14&&(a=staff_tb[e].topbar+14),cfmt.measurebox?xy_str_b(0,a,r.toString()):xy_str(0,a,r.toString()),y_set(e,!0,0,20,a+gene.curfont.size+2);else if(r%cfmt.measurenb==0){for(;;t=t.ts_next){switch(t.type){case C.METER:case C.CLEF:case C.KEY:case C.STBRK:continue}break}for(;t.st!=e;)t=t.ts_next;t.type==C.BAR&&t.bar_num||(t.prev&&t.prev.type!=C.CLEF&&(t=t.prev),n=t.x-t.wl,o=!0,i=cwid("0")*gene.curfont.swfac,r>=10&&(i*=r>=100?3:2),cfmt.measurebox&&(i+=4),a=y_get(e,!0,n,i),a<staff_tb[e].topbar+6&&(a=staff_tb[e].topbar+6),a+=2,cfmt.measurebox?(xy_str_b(n,a,r.toString()),a+=2,i+=3):xy_str(n,a,r.toString()),a+=gene.curfont.size,y_set(e,!0,n,i,a),t.ymx=a)}for(;t;t=t.ts_next){switch(t.type){case C.STAVES:for(c=t.sy,e=0;e<nstaff&&!c.st_print[e];e++);set_sscale(e);continue;default:continue;case C.BAR:if(!t.bar_num)continue}r=t.bar_num,0!=cfmt.measurenb&&r%cfmt.measurenb==0&&t.next&&(o||(o=!0),i=cwid("0")*gene.curfont.swfac,r>=10&&(i*=r>=100?3:2),cfmt.measurebox&&(i+=4),n=t.x-.4*i,a=y_get(e,!0,n,i),a<staff_tb[e].topbar+6&&(a=staff_tb[e].topbar+6),t.next.type==C.NOTE&&(t.next.stem>0?a<t.next.ys-gene.curfont.size&&(a=t.next.ys-gene.curfont.size):a<t.next.y&&(a=t.next.y)),a+=2,cfmt.measurebox?(xy_str_b(n,a,r.toString()),a+=2,i+=3):xy_str(n,a,r.toString()),a+=gene.curfont.size,y_set(e,!0,n,i,a),t.ymx=a)}gene.nbar=r,s&&param_set_font("measurefont","* "+s.toString())}}function draw_notempo(t,e,r,n,a){var i,o,s,c=identify_note(t,n),l=c[0],u=c[1],f=c[2];switch(out_XYAB('<g transform="translate(X,Y) scale(F)">\n',e+4,r+5,a),l){case C.OVAL:o="HD";break;case C.EMPTY:o="Hd";break;default:o="hd"}if(xygl(-posx,posy,o),i=4,u){switch(s=9,f>0&&(s+=4),l){case C.SQUARE:s+=3;break;case C.OVALBARS:case C.OVAL:s+=2;break;case C.EMPTY:s+=1}for(i=s*u,s-=posx;--u>=0;)xygl(s,posy,"dot"),s+=3.5}return n<C.BLEN&&(f<=0?out_stem(-posx,posy,21):(out_stem(-posx,posy,21,!1,f),i<6&&(i=6))),output+="</g>\n",(i+15)*a}function tempo_width(t){var e=0;return set_font("tempo"),t.tempo_str1&&(e=strwh(t.tempo_str1)[0]),t.tempo_ca&&(e+=strwh(t.tempo_ca)[0]),t.tempo_notes&&(e+=10*t.tempo_notes.length+6+cwid(" ")*gene.curfont.swfac*6+10),t.tempo_str2&&(e+=strwh(t.tempo_str2)[0]),e}function write_tempo(t,e,r){var n,a,i=.6*gene.curfont.size/15;if(set_font("tempo"),t.tempo_str1&&(xy_str(e,r,t.tempo_str1),e+=strwh(t.tempo_str1)[0]+3),t.tempo_notes){for(n=0;n<t.tempo_notes.length;n++)e+=draw_notempo(t,e,r,t.tempo_notes[n],i);xy_str(e,r,"="),e+=strwh("= ")[0],t.tempo_ca&&(xy_str(e,r,t.tempo_ca),e+=strwh(t.tempo_ca)[0]),t.tempo?(xy_str(e,r,t.tempo.toString()),a=cwid("0")*gene.curfont.swfac,e+=a+5,t.tempo>=10&&(e+=a,t.tempo>=100&&(e+=a))):e+=draw_notempo(t,e,r,t.new_beat,i)}t.tempo_str2&&xy_str(e,r,t.tempo_str2),t.del=!0}function draw_partempo(t,e){var r,n,a,i,o,s,c=0,l=0,u=staff_tb[t].topbar+8,f=0,$=1,_=0;for(r=tsfirst;r;r=r.ts_next)r.type!=C.TEMPO||r.del||(a||(a=r),o=tempo_width(r),s=y_get(t,!0,r.x-16,o),s>u&&(u=s),_>=r.x-16&&!(f&$>>1)&&(f|=$),$<<=1,_=r.x-16+o);if(a)for(set_sscale(-1),set_font("tempo"),l=gene.curfont.size+2+2,s=2-l,i=s-l,0!=f&&(l*=2),e<u+l&&(c=u+l-e),r=a;r;r=r.ts_next)r.type!=C.TEMPO||r.del||((user.anno_start||user.anno_stop)&&(r.wl=16,r.wr=30,r.ymn=1&f?i:s,r.ymx=r.ymn+14,anno_start(r)),write_tempo(r,r.x-16,1&f?i:s),anno_stop(r),f>>=1);for(u=staff_tb[t].topbar+8,r=tsfirst;r;r=r.ts_next)r.type==C.PART&&(n||(n=r,set_font("parts"),i=gene.curfont.size+2+2),o=strwh(r.text)[0],s=y_get(t,!0,r.x-10,o+3),u<s&&(u=s));if(n)for(set_sscale(-1),e<u+i+l&&(c=u+i+l-e),r=n;r;r=r.ts_next)r.type==C.PART&&(r.x-=10,(user.anno_start||user.anno_stop)&&(o=strwh(r.text)[0],r.wl=0,r.wr=o,r.ymn=-l-i,r.ymx=r.ymn+i,anno_start(r)),cfmt.partsbox?xy_str_b(r.x,2-l-i,r.text):xy_str(r.x,2-l-i,r.text),anno_stop(r));return c}function b_pos(t,e,r,n){function a(t){return 6*Math.round((t+12)/6)-12-t}var i,o,s,c,l=t?3.5:BEAM_SHIFT,u=t?1.8:BEAM_DEPTH;if(e>0){if((o=n-(r-1)*l-u)>26)return 0;i=n}else{if((i=n+(r-1)*l+u)<-2)return 0;o=n}return s=a(i-BEAM_OFFSET),c=a(o+BEAM_OFFSET),s*s>c*c?c:s}function sym_dup(t){var e,r,n=clone(t);for(n.invis=!0,delete n.text,delete n.a_gch,delete n.a_ly,delete n.a_dd,n.notes=clone(t.notes),e=0;e<=n.nhd;e++)r=n.notes[e]=clone(t.notes[e]),delete r.a_dcn;return n}function calculate_beam(t,e){var r,n,a,i,o,s,c,l,u,f,$,_,d,p,h,g,m,v,y,b,w,x;for(e.beam_st||(r=sym_dup(e),lkvsym(r,e),lktsym(r,e),r.x-=12,r.x>e.prev.x+12&&(r.x=e.prev.x+12),r.beam_st=!0,delete r.beam_end,r.tmp=!0,delete r.slur_start,delete r.slur_end,e=r),a=i=0,c=l=!1,o=e.st,s=e.v,y=e.grace?GSTEM_XOFF:3.5,n=e;n.type!=C.NOTE||(n.nflags>i&&(i=n.nflags),a++,n.st!=o&&(c=!0),n.stem!=e.stem&&(l=!0),w||n.invis||n.stemless&&!n.trem2||(w=!0),!n.beam_end);n=n.next)if(!n.next){for(;n.type!=C.NOTE;n=n.prev);r=sym_dup(n),r.next=n.next,r.next&&(r.next.prev=r),n.next=r,r.prev=n,r.ts_next=n.ts_next,r.ts_next&&(r.ts_next.ts_prev=r),n.ts_next=r,r.ts_prev=n,delete r.beam_st,r.beam_end=!0,r.tmp=!0,delete r.slur_start,delete r.slur_end,r.x+=12,r.x<realwidth-12&&(r.x=realwidth-12),n=r,a++;break}if(!w)return!1;if(t.s2=n,0==staff_tb[o].y){if(c)return!1}else if(!c)return t.s1=e,t.a=(e.ys-n.ys)/(e.xs-n.xs),t.b=e.ys-e.xs*t.a+staff_tb[o].y,t.nflags=i,!0;for(v=e,g=100,m=0,r=e;r.type!=C.NOTE||(1==(b=r.p_v.scale)&&(b=staff_tb[r.st].staffscale),r.stem>=0?(u=y+r.notes[0].shhd,r.notes[r.nhd].pit>m&&(m=r.notes[r.nhd].pit,v=r)):(u=-y+r.notes[r.nhd].shhd,r.notes[0].pit<g&&(g=r.notes[0].pit,v=r)),r.xs=r.x+u*b,r!=n);r=r.next);if(cfmt.flatbeams?_=0:!l&&a>=3&&v!=e&&v!=n&&(_=0),f=e.ys+staff_tb[o].y,void 0==_&&(_=(n.ys+staff_tb[n.st].y-f)/(n.xs-e.xs)),0!=_&&(_=_>0?BEAM_SLOPE*_/(BEAM_SLOPE+_):BEAM_SLOPE*_/(BEAM_SLOPE-_)),d=f-_*e.xs,h=0,r=e,l)$=.5*((e.grace?3.5:BEAM_SHIFT)*(i-1)+BEAM_DEPTH),e.stem!=n.stem&&e.nflags<n.nflags?$*=n.stem:$*=e.stem,d+=$;else if(e.grace)for(;$=_*r.xs+d-staff_tb[r.st].y,p=GSTEM-2,r.stem>0?p-=$-3*(r.notes[r.nhd].pit-18):p+=$-3*(r.notes[0].pit-18),p+=3*(r.nflags-1),p>h&&(h=p),r!=n;r=r.next);else{for(var A=BEAM_DEPTH+BEAM_SHIFT*(i-1);r.ts_prev&&r.ts_prev.type==C.NOTE&&r.ts_prev.time==r.time&&r.ts_prev.x>e.xs;)r=r.ts_prev;for(;r&&r.time<=n.time;r=r.ts_next)if(!(r.type!=C.NOTE||r.invis||r.st!=o&&r.v!=s)){if(u=r.v==s?r.xs:r.x,$=_*u+d-staff_tb[r.st].y,r.v==s)p=min_tb[0==r.nhd?0:1][r.nflags],r.stem>0?(r.notes[r.nhd].pit>26&&(p-=2,r.notes[r.nhd].pit>28&&(p-=2)),p-=$-3*(r.notes[r.nhd].pit-18)):(r.notes[0].pit<18&&(p-=2,r.notes[0].pit<16&&(p-=2)),p-=3*(r.notes[0].pit-18)-$),p+=BEAM_DEPTH+BEAM_SHIFT*(r.nflags-1);else{if(e.stem>0)if(r.stem>0){if(r.ymn>$+4||r.ymx<$-A-2)continue;p=r.v>s?r.ymx-$:r.ymn+8-$}else p=r.ymx-$;else if(r.stem<0){if(r.ymx<$-4||r.ymn>$-A-2)continue;p=r.v<s?$-r.ymn:$-r.ymx+8}else p=$-r.ymn;p+=2+A}p>h&&(h=p)}}if(h>0&&(d+=e.stem*h),!c&&!l)for(r=e.next;;r=r.next){var k;switch(r.type){case C.REST:if(!(k=r.ts_next)||k.st!=o||k.type!=C.NOTE&&k.type!=C.REST)break;case C.BAR:if(r.invis)break;case C.CLEF:f=_*r.x+d,e.stem>0?(f=r.ymx-f+BEAM_DEPTH+BEAM_SHIFT*(i-1)+2)>0&&(d+=f):(f=r.ymn-f-BEAM_DEPTH-BEAM_SHIFT*(i-1)-2)<0&&(d+=f);break;case C.GRACE:for(k=r.extra;k;k=k.next)f=_*k.x+d,e.stem>0?(f=k.ymx-f+BEAM_DEPTH+BEAM_SHIFT*(i-1)+2)>0&&(d+=f):(f=k.ymn-f-BEAM_DEPTH-BEAM_SHIFT*(i-1)-2)<0&&(d+=f)}if(r==n)break}for(0==_&&(d+=b_pos(e.grace,e.stem,i,d-staff_tb[o].y)),r=e;;r=r.next){switch(r.type){case C.NOTE:r.ys=_*r.xs+d-staff_tb[r.st].y,r.stem>0?(r.ymx=r.ys+2.5,r.ts_prev&&r.ts_prev.stem>0&&r.ts_prev.st==r.st&&r.ts_prev.ymn<r.ymx&&r.ts_prev.x==r.x&&0==r.notes[0].shhd&&(r.ts_prev.x-=3,r.ts_prev.xs-=3)):r.ymn=r.ys-2.5;break;case C.REST:if(f=_*r.x+d-staff_tb[r.st].y,x=BEAM_DEPTH+BEAM_SHIFT*(i-1)+(r.head!=C.FULL?4:9),e.stem>0){if(f-=x,0==e.multi&&f>12&&(f=12),r.y<=f)break}else if(f+=x,0==e.multi&&f<12&&(f=12),r.y>=f)break;r.head!=C.FULL&&(f=6*((f+3+12)/6|0)-12),r.y=f}if(r==n)break}return 0!=staff_tb[o].y&&(t.s1=e,t.a=_,t.b=d,t.nflags=i,!0)}function draw_beams(t){function e(t,e,r,n,a,i){var o,s,c=a.s1,l=c.nflags;c.ntrem&&(l-=c.ntrem),c.trem2&&i>l&&(c.dur>=C.BLEN/2?(t=c.x+6,e=a.s2.x-6):c.dur<C.BLEN/4&&(t+=5,e-=6)),o=a.a*t+a.b-r,e-=t,e/=stv_g.scale,s=a.a*e*stv_g.scale,xypath(t,o,!0),output+="l"+e.toFixed(2)+" "+(-s).toFixed(2)+"v"+n.toFixed(2)+"l"+(-e).toFixed(2)+" "+s.toFixed(2)+'z"/>\n'}var r,n,a,i,o,s,c,l,u,f,$,_,d=t.s1,p=t.s2;for(anno_start(d,"beam"),d.grace?(o=3.5,s=3.2,i=.29,c=1.8):(o=BEAM_SHIFT,s=BEAM_STUB,i=.34,c=BEAM_DEPTH),a=d.stem,d.stem!=p.stem&&d.nflags<p.nflags&&(a=p.stem),a<0&&(c=-c),e(d.xs-i,p.xs+i,0,c,t,1),l=0,r=d;r.type==C.NOTE&&r.stem!=a&&(r.ys=t.a*r.xs+t.b-staff_tb[r.st].y+o*(r.nflags-1)*r.stem-c),r!=p;r=r.next);for(d.feathered_beam&&(l=o/(p.xs-d.xs),d.feathered_beam>0?(l=-l,o=l*d.xs):o=l*p.xs,l*=a),i=0,n=2;n<=t.nflags;n++)for(i+=o,0!=l&&(t.a+=l),r=d;;r=r.next)if(r.type!=C.NOTE||r.nflags<n){if(r==p)break}else if(r.trem1&&n>r.nflags-r.ntrem){if(_=r.dur>=C.BLEN/2?r.x:r.xs,e(_-5,_+5,(i+2.5)*a,c,t,n),r==p)break}else{for(f=r;;){if(r==p)break;if(u=r.next,u.type==C.NOTE||u.type==C.REST)if(u.trem1){if(u.nflags-u.ntrem<n)break}else if(u.nflags<n)break;if(u.beam_br1||u.beam_br2&&n>2)break;r=u}for($=r;$.type!=C.NOTE;)$=$.prev;if(_=f.xs,f==$)if(f==d)_+=s;else if(f==p)_-=s;else if(f.beam_br1||f.beam_br2&&n>2)_+=s;else{for(u=f.next;u.type!=C.NOTE;)u=u.next;if(u.beam_br1||u.beam_br2&&n>2)_-=s;else{for(f=f.prev;f.type!=C.NOTE;)f=f.prev;f.nflags<u.nflags||f.nflags==u.nflags&&f.dots<u.dots?_+=s:_-=s}}if(e(_,$.xs,i*a,c,t,n),r==p)break}d.tmp?unlksym(d):p.tmp&&unlksym(p),anno_stop(d,"beam")}function draw_lstaff(t){function e(t,e,r){for(var n,a,i,o;!cur_sy.st_print[e];){if(cur_sy.staves[e].flags&r)return;e++}for(n=a=e;;){if(cur_sy.st_print[n]&&(a=n),cur_sy.staves[n].flags&r)break;n++}i=staff_tb[e].y+staff_tb[e].topbar*staff_tb[e].staffscale,o=staff_tb[a].y+staff_tb[a].botbar*staff_tb[a].staffscale,r&(CLOSE_BRACE|CLOSE_BRACE2)?out_brace(t,o,i-o):out_bracket(t,i,i-o)}var r,n,a,i,o=cur_sy.nstaff,s=0;for(r=0;(cur_sy.staves[r].flags&(OPEN_BRACE|OPEN_BRACKET)&&s++,!cur_sy.st_print[r])&&(cur_sy.staves[r].flags&(CLOSE_BRACE|CLOSE_BRACKET)&&s--,r!=o);r++);for(n=o;n>r&&!cur_sy.st_print[n];n--);if(r!=n||0!=s)for(a=staff_tb[n].y+staff_tb[n].botbar*staff_tb[n].staffscale,i=staff_tb[r].y+staff_tb[r].topbar*staff_tb[r].staffscale-a,xypath(t,a),output+="v"+(-i).toFixed(2)+'"/>\n',r=0;r<=o;r++)cur_sy.staves[r].flags&OPEN_BRACE&&e(t,r,CLOSE_BRACE),cur_sy.staves[r].flags&OPEN_BRACKET&&e(t,r,CLOSE_BRACKET),cur_sy.staves[r].flags&OPEN_BRACE2&&e(t-6,r,CLOSE_BRACE2),cur_sy.staves[r].flags&OPEN_BRACKET2&&e(t-6,r,CLOSE_BRACKET2)}function draw_meter(t,e){if(e.a_meter){var r,n,a,i,o=e.st,s=staff_tb[o],c=s.y;for("|||||"!=s.stafflines&&(c+=(s.topbar+s.botbar)/2-12),r=0;r<e.a_meter.length;r++){var l,u=e.a_meter[r];if(t=e.x+e.x_meter[r],u.bot){for(a=i="",n=0;n<u.top.length;n++)a+=tgls["meter"+u.top[n]].c;for(n=0;n<u.bot.length;n++)i+=tgls["meter"+u.bot[n]].c;out_XYAB('<g transform="translate(X,Y)" text-anchor="middle">\n\t<text y="-12">A</text>\n\t<text>B</text>\n</g>\n',t,c+6,a,i)}else switch(u.top[0]){case"C":l="|"!=u.top[1]?"csig":"ctsig",t-=5,c+=12;break;case"c":l="."!=u.top[1]?"imsig":"iMsig";break;case"o":l="."!=u.top[1]?"pmsig":"pMsig";break;default:for(a="",n=0;n<u.top.length;n++)a+=tgls["meter"+u.top[n]].c;out_XYAB('<text x="X" y="Y" text-anchor="middle">A</text>\n',t,c+12,a)}l&&xygl(t,c,l)}}}function draw_acc(t,e,r,n,a){if(n)if(n==a)r=-1==r?-2:2;else if(2*n!=a)return void xygl(t,e,"acc"+r+"_"+n+"_"+a);xygl(t,e,"acc"+r)}function draw_hl(t,e,r,n,a){var i,o,s=staff_tb[n],c=s.y,l=s.stafflines,u=6*(l.length-1),f=s.botline;if(/[\[|]/.test(l)){if(e%6&&(e+=3),r%6&&(r-=3),l.indexOf("-")>=0&&(e>f&&e<u||r>f&&r<u||e<=f&&r>=u)){for(i=e,o=r;i>f&&"-"==l[i/6];)i-=6;for(;o<u&&"-"==l[o/6];)o+=6;for(;i<o;i+=6)"-"==l[i/6]&&xygl(t,c+i,a)}for(;e<f;e+=6)xygl(t,c+e,a);for(;r>u;r-=6)xygl(t,c+r,a)}}function draw_keysig(t,e,r){if(!r.k_none){var n,a,i,o=r.k_old_sf,s=t.st,c=staff_tb[s].y,l=r.k_y_clef;for(1&l&&(l+=7),l/=2;l<0;)l+=7;if(l%=7,r.k_a_acc){if(r.k_a_acc.length){var u,f=r.k_a_acc[0].acc,$=100;for(n=0;n<r.k_a_acc.length;n++)u=r.k_a_acc[n],a=3*(r.k_y_clef+u.pit-18),0!=n&&(a>$+18||a<$-18)?e-=5.5:u.acc!=f&&(e+=3),f=u.acc,draw_hl(e,a,a,s,"hl"),$=a,draw_acc(e,c+a,u.acc,u.micro_n,u.micro_d),e+=5.5}}else{if((cfmt.cancelkey||0==r.k_sf)&&(0==r.k_sf||o*r.k_sf<0)){for(a=sharp_cl[l],i=a>9?sharp1:sharp2,n=0;n<o;n++)xygl(e,c+a,"acc3"),a+=i[n],e+=5.5;for(a=flat_cl[l],i=a<18?flat1:flat2,n=0;n>o;n--)xygl(e,c+a,"acc3"),a+=i[-n],e+=5.5;0!=r.k_sf&&(e+=3)}if(r.k_sf>0){for(a=sharp_cl[l],i=a>9?sharp1:sharp2,n=0;n<r.k_sf;n++)xygl(e,c+a,"acc1"),a+=i[n],e+=5.5;if(cfmt.cancelkey&&n<o)for(e+=2;n<o;n++)xygl(e,c+a,"acc3"),a+=i[n],e+=5.5}if(r.k_sf<0){for(a=flat_cl[l],i=a<18?flat1:flat2,n=0;n>r.k_sf;n--)xygl(e,c+a,"acc-1"),a+=i[-n],e+=5.5;if(cfmt.cancelkey&&n>o)for(e+=2;n>o;n--)xygl(e,c+a,"acc3"),a+=i[-n],e+=5.5}}}}function bar_cnv(t){switch(t){case"[":case"[]":return"";case"|:":case"|::":case"|:::":return"["+t;case":|":case"::|":case":::|":return t+"]";case"::":return cfmt.dblrepbar;case"||:":return"[|:"}return t}function draw_bar(t,e,r){var n,a,i,o,s=t.st,c=staff_tb[s],l=t.x;if(o=bar_cnv(t.bar_type)){if(0!=s&&t.ts_prev&&t.ts_prev.type!=C.BAR&&(r=c.topbar*c.staffscale),t.ymx=t.ymn+r,set_sscale(-1),anno_start(t),i=c.y+12,"|||||"!=c.stafflines&&(i+=(c.topbar+c.botbar)/2-12),t.bar_mrep)if(set_sscale(s),1==t.bar_mrep){for(a=t.prev;a.type!=C.REST;a=a.prev);xygl(a.x,i,"mrep")}else xygl(l,i,"mrep2"),t.v==cur_sy.top_voice&&(set_font("annotation"),xy_str(l,i+c.topbar-9,t.bar_mrep.toString(),"c"));for(n=o.length;--n>=0;){switch(o[n]){case"|":set_sscale(-1),out_bar(l,e,r,t.bar_dotted);break;default:l-=3,set_sscale(-1),out_thbar(l,e,r);break;case":":l-=2,set_sscale(s),xygl(l+1,i-12,"rdots")}l-=3}set_sscale(-1),anno_stop(t)}}function draw_rest(t){var e,r,n,a,i,o,s=staff_tb[t.st];if(s.topbar){if(t.dur==t.p_v.meter.wmeasure||t.rep_nb&&t.rep_nb>=0){for(e=t.ts_next;e&&e.time!=t.time+t.dur;)e=e.ts_next;for(a=e?e.x:realwidth,e=t;!e.seqst;)e=e.ts_prev;e=e.ts_prev,a=(a+e.x)/2,t.a_dd&&deco_update(t,a-t.x),t.x=a}else a=t.x,t.notes[0].shhd&&(a+=t.notes[0].shhd*stv_g.scale);if(!t.invis){if(o=s.y,t.rep_nb)return set_sscale(t.st),anno_start(t),"|||||"==s.stafflines?o+=12:o+=(s.topbar+s.botbar)/2,t.rep_nb<0?xygl(a,o,"srep"):(xygl(a,o,"mrep"),t.rep_nb>2&&t.v==cur_sy.top_voice&&(set_font("annotation"),xy_str(a,o+s.topbar-9,t.rep_nb.toString(),"c"))),void anno_stop(t);if(set_scale(t),anno_start(t),i=t.y,r=5-t.nflags,7==r&&12==i&&s.stafflines.length<=2&&(i-=6),xygl(a,i+o,t.notes[0].head?t.notes[0].head:rest_tb[r]),r>=6){switch(n=i/6,r){default:switch(s.stafflines[n+1]){case"|":case"[":break;default:xygl(a,i+6+o,"hl1")}9==r&&(i-=6,n--);break;case 7:i+=6,n++;case 6:}switch(s.stafflines[n]){case"|":case"[":break;default:xygl(a,i+o,"hl1")}}for(a+=8,i+=o+3,r=0;r<t.dots;r++)xygl(a,i,"dot"),a+=3.5;anno_stop(t)}}}function draw_gracenotes(t){var e,r,n,a,i,o,s,c,l,u,f,$,_,d,p,h,g={};for(d=t.extra;d&&(d.beam_st&&!d.beam_end&&calculate_beam(g,d)&&draw_beams(g),anno_start(d),draw_note(d,!g.s2),d==g.s2&&(g.s2=null),anno_stop(d),d.next);d=d.next);if(t.sappo&&(d=t.extra,d.next?(a=.5*(d.next.x-d.x)+4,i=.5*(d.ys+d.next.ys)-d.y,d.stem>0?i-=1:i+=1):(a=9,i=d.stem>0?5:-5),h=d.notes[d.stem<0?0:d.nhd],out_acciac(x_head(d,h),y_head(d,h),a,i,d.stem>0)),!t.p_v.key.k_bagpipe&&cfmt.graceslurs&&!t.slur_start&&t.next&&t.next.type==C.NOTE){if(p=d,p.stem>=0){for(e=127,d=t.extra;d;d=d.next)d.y<e&&(e=d.y,p=d);r=p.x,n=p.y-5,t.extra!=p&&(r-=4,n+=1),t=t.next,c=t.x-1,t.stem<0&&(c-=4),l=3*(t.notes[0].pit-18)-5,$=.4*(c-r),$>3&&($=3),_=$,u=.2,f=.8,n>l+7?(r=p.x-1,n+=.5,l+=6.5,c=t.x-5.5,$=.8*(n-l),_=.2*(n-l),u=0):l>n+4&&(l=n+4,r=p.x+2,n=p.y-4)}else{for(e=-127,d=t.extra;d;d=d.next)d.y>e&&(e=d.y,p=d);r=p.x,n=p.y+5,t.extra!=p&&(r-=4,n-=1),t=t.next,c=t.x-1,t.stem>=0&&(c-=2),l=3*(t.notes[t.nhd].pit-18)+5,$=.4*(r-c),$<-3&&($=-3),_=$,u=.2,f=.8,n<l-7?(r=p.x-1,n-=.5,l-=6.5,c=t.x-5.5,$=.8*(n-l),_=.2*(n-l),u=0):l<n-4&&(l=n-4,r=p.x+2,n=p.y+4)}a=u*c+(1-u)*r-r,i=u*l+(1-u)*n-$-n,o=f*c+(1-f)*r-r,s=f*l+(1-f)*n-_-n,anno_start(t,"slur"),xypath(r,n+staff_tb[t.st].y),output+="c"+a.toFixed(2)+" "+(-i).toFixed(2)+" "+o.toFixed(2)+" "+(-s).toFixed(2)+" "+(c-r).toFixed(2)+" "+(-l+n).toFixed(2)+'"/>\n',anno_stop(t,"slur")}}function setdoty(t,e){var r,n,a;for(r=0;r<=t.nhd;r++)a=3*(t.notes[r].pit-18),a%6==0&&(t.dot_low?a-=3:a+=3),e[r]=a;for(r=0;r<t.nhd;r++)if(!(e[r+1]>e[r])){for(n=r;n>0&&!(e[n]>e[n-1]+6);)n--;if(3*(t.notes[n].pit-18)-e[n]<e[r+1]-3*(t.notes[r+1].pit-18))for(;n<=r;)e[n++]-=6;else e[r+1]=e[r]+6}}function x_head(t,e){return t.x+e.shhd*stv_g.scale}function y_head(t,e){return staff_tb[t.st].y+3*(e.pit-18)}function draw_basic_note(t,e,r,n){var a,i,o,s,c,l=!1,u=e.notes[r],f=staff_tb[e.st].y,$=3*(u.pit-18),_=u.shhd*stv_g.scale,d=t+_,p=$+f,h=identify_note(e,u.dur),g=h[0],m=h[1];h[2];if($%6==0&&_!=(e.stem>0?e.notes[0].shhd:e.notes[e.nhd].shhd)&&(o=0,$>=30?(o=$)%6&&(o-=3):$<=-6&&(o=$)%6&&(o+=3),o&&xygl(d,o+f,"hl")),u.invis);else if(e.grace)i="ghd",d-=4.5*stv_g.scale;else if(u.map&&u.map[0])a=e.head,i=u.map[0][a],i||(i=u.map[0][u.map[0].length-1]),(a=i.indexOf("/"))>=0&&(i=e.stem>=0?i.slice(0,a):i.slice(a+1));else if(e.type==C.CUSTOS)i="custos";else switch(g){case C.OVAL:i="HD";break;case C.OVALBARS:if(e.head!=C.SQUARE){i="HDD";break}case C.SQUARE:i=u.dur<4*C.BLEN?"breve":"longa",tsnext||!e.next||e.next.type!=C.BAR||e.next.next||(m=0);break;case C.EMPTY:i="Hd";break;default:i="hd"}if(void 0!=u.color?l=set_color(u.color):u.map&&u.map[2]&&(l=set_color(u.map[2])),i&&xygl(d,p,i),m)for(s=t+(7.7+e.xmx)*stv_g.scale,void 0==n[r]&&(n[r]=3*(e.notes[r].pit-18),0==(1&e.notes[r].pit)&&(n[r]+=3)),c=n[r]+f;--m>=0;)xygl(s,c,"dot"),s+=3.5;u.acc&&(t-=u.shac*stv_g.scale,e.grace?(g_open(t,$+f,0,.75),draw_acc(0,0,u.acc,u.micro_n,u.micro_d),g_close()):draw_acc(t,$+f,u.acc,u.micro_n,u.micro_d)),void 0!=l&&set_color(l)}function draw_note(t,e){var r,n,a,i,o,s,c,l,a,u,f=new Array(t.nhd+1);if(t.dots&&setdoty(t,f),u=t.notes[t.stem<0?t.nhd:0],l=x_head(t,u),i=staff_tb[t.st].y,t.grace)s="ghl";else switch(t.head){default:s="hl";break;case C.OVAL:case C.OVALBARS:s="hl1";break;case C.SQUARE:s="hl2"}if(draw_hl(l,3*(t.notes[0].pit-18),3*(t.notes[t.nhd].pit-18),t.st,s),a=y_head(t,u),t.stemless?t.xstem&&(r=t.ts_prev,o=(r.stem>0?r.y:r.ys)-t.y,o+=staff_tb[r.st].y-i,o/=t.p_v.scale,out_stem(l,a,o)):(o=t.ys-t.y,c=t.nflags,t.ntrem&&(c-=t.ntrem),!e||c<=0?(t.nflags>0&&(t.stem>=0?o-=1:o+=1),out_stem(l,a,o,t.grace)):out_stem(l,a,o,t.grace,c,cfmt.straightflags)),e&&t.trem1){var $=t.ntrem||0,_=l;o=3*(t.notes[t.stem>0?t.nhd:0].pit-18),t.head==C.FULL||t.head==C.EMPTY?(_+=(t.grace?GSTEM_XOFF:3.5)*t.stem,t.stem>0?o+=6+5.4*$:o-=11.4):t.stem>0?o+=5+5.4*$:o-=10.4,o/=t.p_v.scale,out_trem(_,i+o,$)}for(l=t.x,n=0;n<=t.nhd;n++)draw_basic_note(l,t,n,f)}function next_scut(t){var e=t;for(t=t.next;t;t=t.next){if(t.rbstop)return t;e=t}return e}function prev_scut(t){for(;t.prev;)if(t=t.prev,t.rbstart)return t;for(t=t.p_v.sym;t.type!=C.CLEF;)t=t.ts_prev;return t.next&&t.next.type==C.KEY&&(t=t.next),t.next&&t.next.type==C.METER?t.next:t}function slur_direction(t,e){var r,n,a;if(t.grace&&t.stem>0)return-1;for(r=t;;r=r.next){if(r.type==C.NOTE){if(!r.stemless){if(r.stem<0)return 1;n=!0}r.notes[0].pit<22&&(a=!0)}if(r==e)break}return n||a?-1:1}function slur_out(t,e,r,n,a,i,o){var s,c,l,u=.3;c=n-e,c<0&&(c=-c),(s=r-t)>40&&c/s<.7&&(u=.3+.002*(s-40))>.7&&(u=.7);var f=.5*(t+r),$=.5*(e+n),_=f+u*(t-f),d=$+u*(e-$)+i;_=t+.45*(_-t),d=e+.45*(d-e);var p=f+u*(r-f),h=$+u*(n-$)+i;p=r+.45*(p-r),h=n+.45*(h-n),s=.03*(r-t),c=2*a,l=.2+.001*(r-t),l>.6&&(l=.6),l*=a;var g=stv_g.v?stv_g.scale:1;output+=o?'<path class="stroke" stroke-dasharray="5,5" d="M':'<path class="fill" d="M',out_sxsy(t," ",e),output+="c"+((_-t)/stv_g.scale).toFixed(2)+" "+((e-d)/g).toFixed(2)+" "+((p-t)/stv_g.scale).toFixed(2)+" "+((e-h)/g).toFixed(2)+" "+((r-t)/stv_g.scale).toFixed(2)+" "+((e-n)/g).toFixed(2),o||(output+="\n\tv"+(-l).toFixed(2)+"c"+((p-s-r)/stv_g.scale).toFixed(2)+" "+((n+l-h-c)/g).toFixed(2)+" "+((_+s-r)/stv_g.scale).toFixed(2)+" "+((n+l-d-c)/g).toFixed(2)+" "+((t-r)/stv_g.scale).toFixed(2)+" "+((n+l-e)/g).toFixed(2)),output+='"/>\n'}function slur_multi(t,e){for(;;){if(t.multi)return t.multi;if(t==e)break;t=t.next}return 0}function draw_slur(t,e,r,n,a){for(var i,o,s,c,l,u,f,$,_,d,p,h,g,m,v,y=t;y.v!=e.v;)y=y.ts_next;switch(7&a){case C.SL_ABOVE:v=1;break;case C.SL_BELOW:v=-1;break;default:v=slur_multi(y,e),v||(v=slur_direction(y,e))}var b=1,w=y.st,x=!1;if(y!=e)for(i=y.next;;){if(i.type!=C.NOTE&&i.type!=C.REST||(b++,i.st!=w&&(x=!0,i.st<w&&(w=i.st))),i==e)break;i=i.next}if(x&&error(2,y,"*** multi-staves slurs not treated yet"),s=t.x,t.notes&&t.notes[0].shhd&&(s+=t.notes[0].shhd),t!=e)l=e.x,e.notes&&(l+=e.notes[0].shhd);else{for(i=e.ts_next;i&&i.type!=C.STAVES;i=i.ts_next);l=i?i.x:realwidth}if(r>=0?c=3*(y.notes[r].pit-18)+5*v:(c=v>0?y.ymx+2:y.ymn-2,y.type==C.NOTE&&(v>0?y.stem>0&&(s+=5,y.beam_end&&y.nflags>=-1&&!y.in_tuplet&&(y.nflags>0?(s+=2,c=y.ys-3):c=y.ys-6)):y.stem<0&&(s-=1,e.grace?c=y.y-8:y.beam_end&&y.nflags>=-1&&(!y.in_tuplet||y.ys<c+3)&&(y.nflags>0?(s+=2,c=y.ys+3):c=y.ys+6)))),n>=0?u=3*(e.notes[n].pit-18)+5*v:(u=v>0?e.ymx+2:e.ymn-2,e.type==C.NOTE&&(v>0?e.stem>0&&(l+=1,e.beam_st&&e.nflags>=-1&&!e.in_tuplet&&(u=e.ys-6)):e.stem<0&&(l-=5,e.beam_st&&e.nflags>=-1&&!e.in_tuplet&&(u=e.ys+6)))),y.type!=C.NOTE&&(c=u+1.2*v,(s=y.x+.5*y.wr)>l-12&&(s=l-12)),e.type!=C.NOTE&&(u=y.type==C.NOTE?c+1.2*v:c,y!=e&&(l=e.x-.3*e.wl)),b>=3&&(y.next.type!=C.BAR&&y.next.x<s+48&&(v>0?(d=y.next.ymx-2,c<d&&(c=d)):(d=y.next.ymn+2,c>d&&(c=d))),e.prev&&e.prev.type!=C.BAR&&e.prev.x>l-48&&(v>0?(d=e.prev.ymx-2,u<d&&(u=d)):(d=e.prev.ymn+2,u>d&&(u=d)))),_=(u-c)/(l-s),(_>SLUR_SLOPE||_<-SLUR_SLOPE)&&(_=_>SLUR_SLOPE?SLUR_SLOPE:-SLUR_SLOPE,_*v>0?c=u-_*(l-s):u=c+_*(l-s)),d=u-c,d>8?d=8:d<-8&&(d=-8),p=d,p<0&&(p=-p),g=.5*p,m=.3*d,d*v>0?(l-=g,u-=m):(s+=g,c+=m),y.grace&&(s=y.x-.5*GSTEM_XOFF),e.grace&&(l=e.x+1.5*GSTEM_XOFF),h=0,_=(u-c)/(l-s),y!=e&&y.v==e.v){for($=c-_*s,i=y.next;i!=e;i=i.next)if(i.st==w)switch(i.type){case C.NOTE:case C.REST:v>0?(d=3*(i.notes[i.nhd].pit-18)+6,d<i.ymx&&(d=i.ymx),(d-=_*i.x+$)>h&&(h=d)):(d=3*(i.notes[0].pit-18)-6,d>i.ymn&&(d=i.ymn),(d-=_*i.x+$)<h&&(h=d));break;case C.GRACE:for(o=i.extra;o;o=o.next)v>0?(d=3*(o.notes[o.nhd].pit-18)+6,d<o.ymx&&(d=o.ymx),(d-=_*o.x+$)>h&&(h=d)):(d=3*(o.notes[0].pit-18)-6,d>o.ymn&&(d=o.ymn),(d-=_*o.x+$)<h&&(h=d))}c+=.45*h,u+=.45*h,h*=.65}if(f=b>3?(.08*(l-s)+12)*v:(.03*(l-s)+8)*v,v>0?(f<3*h&&(f=3*h),f>40&&(f=40)):(f>3*h&&(f=3*h),f<-40&&(f=-40)),d=u-c,d<0&&(d=-d),v>0?f<.8*d&&(f=.8*d):f>-.8*d&&(f=-.8*d),f*=cfmt.slurheight,slur_out(s,c,l,u,v,f,a&C.SL_DOTTED),g=l-s,_=(u-c)/g,$=c-_*s+.4*f,y.v==e.v)for(i=y;i!=e;i=i.next)i.st==w&&(d=_*i.x+$,i.ymx<d?i.ymx=d:i.ymn>d&&(i.ymn=d),i.next==e?(g=l,e.sl1&&(g-=5)):g=i.next.x,i!=y&&(s=i.x),g-=s,y_set(w,v>0,s,g,d));return(v>0?C.SL_ABOVE:C.SL_BELOW)|a&C.SL_DOTTED}function draw_slurs(t,e){for(var r,n,a,i,o,s,c,l,u=t;;){if(!u||u==e){if(!a||!(u=a.next)||u==e)break;a=null}if(u.type!=C.GRACE)if(u.type!=C.NOTE&&u.type!=C.REST&&u.type!=C.SPACE||!u.slur_start&&!u.sl1)u=u.next;else{n=null,r=u.next;for(var f=!1;;)if(r)if(r.type!=C.GRACE){
if(r.type==C.BAR&&(":"==r.bar_type[0]||"|]"==r.bar_type||"[|"==r.bar_type||r.text&&"1"!=r.text[0])){n=r;break}if(r.type==C.NOTE||r.type==C.REST||r.type==C.SPACE){if(r.slur_end||r.sl2){n=r;break}if(r.slur_start||r.sl1){if(i){for(n=r;n.next;n=n.next);n.next=i.next,i.next&&(i.next.prev=n),n=null}draw_slurs(r,e),i&&i.next&&(i.next.prev.next=null,i.next.prev=i)}if(r==e)break;r=r.next}else r=r.next}else i=r,r=r.extra;else{if(i){r=i.next,i=null;continue}if(!a||f)break;r=a.next,f=!0}if(r){if(!n){if((u=r)==e)break;continue}}else n=next_scut(u);if(a){for(r=u;r.next;r=r.next);r.next=a.next,a.next&&(a.next.prev=r),a.slur_start=C.SL_AUTO}if(i&&(i.prev.next=i.extra,i.extra.prev=i.prev,i.slur_start=C.SL_AUTO),u.slur_start)c=15&u.slur_start,u.slur_start>>=4,o=-1;else{for(o=0;o<=u.nhd&&!u.notes[o].sl1;o++);c=15&u.notes[o].sl1,u.notes[o].sl1>>=4,u.sl1--}if(s=-1,l=0,n.type!=C.NOTE&&n.type!=C.REST&&n.type!=C.SPACE||!n.slur_end&&!n.sl2)n.type==C.BAR&&(":"==n.bar_type[0]||"|]"==n.bar_type||"[|"==n.bar_type||n.text&&"1"!=n.text[0])||(l=1);else if(n.slur_end)n.slur_end--;else{for(s=0;s<=n.nhd&&!n.notes[s].sl2;s++);n.notes[s].sl2--,n.sl2--}if(c=draw_slur(u,n,o,s,c),l&&(n.p_v.slur_start||(n.p_v.slur_start=0),n.p_v.slur_start<<=4,n.p_v.slur_start+=c),a&&a.next&&(a.next.prev.next=null,a.next.prev=a),i&&(i.prev.next=i,i.extra.prev=null),!u.slur_start&&!u.sl1){if(u==e)break;u=u.next}}else a=u,u=u.extra}}function draw_tuplet(t,e){var r,n,a,i,o,s,c,l,u,f,$,_,d,p,h,g,m,d,v,y,b,w,x;for(i=t.st,r=t;r;r=r.next)if(r.type==C.NOTE||r.type==C.REST){if((r.slur_start||r.slur_end||r.sl1||r.sl2)&&(s=!0),r.st<i&&(i=r.st),0==e){if(r.tp1&&draw_tuplet(r,1),r.te0)break}else if(r.te1)break}else if(r.type==C.GRACE)for(a=r.extra;a;a=a.next)(a.slur_start||a.sl1)&&(s=!0);if(!r)return error(1,t,"No end of tuplet in this music line"),void(0==e?t.tp0=0:t.tp1=0);if(s){if(draw_slurs(t,r),t.slur_start||t.sl1)return;for(n=t.next;n!=r;n=n.next)if(n.slur_start||n.slur_end||n.sl1||n.sl2)return;if(r.slur_end||r.sl2)return}if(0==e?(b=t.tp0,t.tp0=0,w=t.tq0):(b=t.tp1,t.tp1=0,w=t.tq1),1!=t.tf[0]){if(y=t.tf[3],y||(y=t.stem>0?C.SL_ABOVE:C.SL_BELOW),t==r)o=!0;else if(1==t.tf[1])o=!0,draw_slur(t,r,-1,-1,y);else if(2==t.tf[0]||t.type!=C.NOTE||r.type!=C.NOTE)o=!1;else{for(o=!0,n=t;;n=n.next){if(n.type!=C.NOTE&&n.type!=C.REST){if(n.type==C.GRACE||n.type==C.SPACE)continue;o=!1;break}if(n==r)break;if(n.beam_end){o=!1;break}}if(o&&!t.beam_st&&!t.beam_br1&&!t.beam_br2)for(n=t.prev;n;n=n.prev)if(n.type==C.NOTE||n.type==C.REST){n.nflags>=t.nflags&&(o=!1);break}if(o&&!r.beam_end)for(n=r.next;n;n=n.next)if(n.type==C.NOTE||n.type==C.REST){!n.beam_br1&&!n.beam_br2&&n.nflags>=r.nflags&&(o=!1);break}}if(o){if(1==t.tf[2])return;for($=(r.x+t.x)/2,d=t==r?0:(r.ys-t.ys)/(r.x-t.x),v=t.ys-d*t.x,h=d*$+v,y==C.SL_ABOVE?(_=y_get(i,1,$-4,8),_>h&&(v+=_-h),v+=2):(_=y_get(i,0,$-4,8),_<h&&(v+=_-h),v-=10),n=t;!(n.x>=$);n=n.next);return t.stem*r.stem>0&&(t.stem>0?$+=1.5:$-=1.5),_=d*$+v,0==t.tf[2]?out_bnum($,_,b):out_bnum($,_,b+":"+w),void(y==C.SL_ABOVE?(_+=10,n.ymx<_&&(n.ymx=_),y_set(i,!0,$-3,6,_)):(n.ymn>_&&(n.ymn=_),y_set(i,!1,$-3,6,_)))}if(0!=t.tf[1]&&error(2,t,"'what' value of %%tuplets not yet coded"),y=t.tf[3],y||(y=t.multi>=0?C.SL_ABOVE:C.SL_BELOW),y==C.SL_ABOVE){if(t.st==r.st?u=f=staff_tb[i].topbar+4:(u=t.ymx,f=r.ymx),c=t.x-4,t.st==i){for(n=t;!n.dur;n=n.next);_=y_get(i,1,n.x-4,8),_>u&&(u=_),t.stem>0&&(c+=3)}if(r.st==i){for(n=r;!n.dur;n=n.prev);_=y_get(i,1,n.x-4,8),_>f&&(f=_)}for(r.dur>r.prev.dur?l=r.next?r.next.x-r.next.wl-5:realwidth-6:(l=r.x+4,x=r.stem>=0?0:r.nhd,r.notes[x].shhd>0&&(l+=r.notes[x].shhd),r.st==i&&r.stem>0&&(l+=3.5)),$=.5*(c+l),_=.5*(u+f),d=(f-u)/(l-c),p=3*(r.notes[r.nhd].pit-t.notes[t.nhd].pit)/(l-c),p>0?d<0?d=0:d>p&&(d=p):d>0?d=0:d<p&&(d=p),d*d<.1*.1&&(d=0),m=0,n=t;;n=n.next)if(n.dur&&n.st==i){if(h=_+(n.x-$)*d,g=y_get(i,1,n.x-4,8)+2,g-h>m&&(m=g-h),n==r)break}else if(n==r)break;for(_+=m,u=_+d*(c-$),f=_+d*(l-$),_+=8,n=t;;n=n.next)if(n.st==i){if(h=_+(n.x-$)*d,n.ymx<h&&(n.ymx=h),n==r)break;y_set(i,!0,n.x,n.next.x-n.x,h)}else if(n==r)break}else{if(c=t.x-7,r.dur>r.prev.dur?l=r.next?r.next.x-r.next.wl-8:realwidth-6:(l=r.x+2,r.notes[r.nhd].shhd>0&&(l+=r.notes[r.nhd].shhd)),t.stem>=0&&(c+=2,l+=2),t.st==i){for(n=t;!n.dur;n=n.next);u=y_get(i,0,n.x-4,8)}else u=0;if(r.st==i){for(n=r;!n.dur;n=n.prev);f=y_get(i,0,n.x-4,8)}else f=0;for($=.5*(c+l),_=.5*(u+f),d=(f-u)/(l-c),p=3*(r.notes[0].pit-t.notes[0].pit)/(l-c),p>0?d<0?d=0:d>p&&(d=p):d>0?d=0:d<p&&(d=p),d*d<.1*.1&&(d=0),m=0,n=t;;n=n.next)if(n.dur&&n.st==i){if(h=_+(n.x-$)*d,g=y_get(i,0,n.x-4,8),g-h<m&&(m=g-h),n==r)break}else if(n==r)break;for(_+=m-10,u=_+d*(c-$),f=_+d*(l-$),_-=2,n=t;;n=n.next){if(n.st==i){if(n==r)break;h=_+(n.x-$)*d,n.ymn>h&&(n.ymn=h),y_set(i,!1,n.x,n.next.x-n.x,h)}if(n==r)break}}if(1==t.tf[2])return void out_tubr(c,u+4,l-c,f-u,y==C.SL_ABOVE);out_tubrn(c,u,l-c,f-u,y==C.SL_ABOVE,0==t.tf[2]?b.toString():b+":"+w),h=.5*(u+f),y==C.SL_ABOVE?y_set(i,!0,$-3,6,h+9):y_set(i,!1,$-3,6,h)}}function draw_note_ties(t,e,r,n,a){var i,o,s,c,l,u,f,$,_,d,p,h,g,m;for(i=0;i<r.length;i++){switch(s=r[i],l=t.notes[s].pit,c=n[i],u=2!=a?e.notes[c].pit:l,o=(7&t.notes[s].ti1)==C.SL_ABOVE?1:-1,d=t.x,g=t.notes[s].shhd,o>0?s<t.nhd&&l+1==t.notes[s+1].pit&&t.notes[s+1].shhd>g&&(g=t.notes[s+1].shhd):s>0&&l==t.notes[s-1].pit+1&&t.notes[s-1].shhd>g&&(g=t.notes[s-1].shhd),d+=.6*g,p=e.x,2!=a&&(g=e.notes[c].shhd,o>0?c<e.nhd&&u+1==e.notes[c+1].pit&&e.notes[c+1].shhd<g&&(g=e.notes[c+1].shhd):c>0&&u==e.notes[c-1].pit+1&&e.notes[c-1].shhd<g&&(g=e.notes[c-1].shhd),p+=.6*g),$=t.st,a){case 0:l==u||1&l||(l=u);break;case 3:o=-o;case 1:d=t.x,d>p-20&&(d=p-20),l=u,$=e.st;break;default:if(t!=e)p-=e.wl,e.type==C.BAR&&(p+=5);else{for(m=t.time+t.dur,_=t.ts_next;_&&!(_.time>m);_=_.ts_next);p=_?_.x:realwidth}p<d+16&&(p=d+16)}p-d>20?(d+=3.5,p-=3.5):(d+=1.5,p-=1.5),f=3*(l-18),h=(.04*(p-d)+10)*o,slur_out(d,staff_tb[$].y+f,p,staff_tb[$].y+f,o,h,t.notes[s].ti1&C.SL_DOTTED)}}function draw_ties(t,e,r){var n,a,i,o,s,c,l=[],u=[],f=[],$=t.nhd,_=t.time+t.dur;if(2==r){for(a=0;a<=$;a++)t.notes[a].ti1&&f.push(a);return void draw_note_ties(t,e||t,f,f,r)}for(a=0;a<=$;a++)if(t.notes[a].ti1){for(c=-1,s=t.notes[a].apit,o=e.nhd;o>=0;o--){switch(e.notes[o].apit-s){case 1:case-1:t.notes[a].acc!=e.notes[o].acc&&(c=o);default:continue;case 0:c=o}break}c>=0?(l.push(a),u.push(c)):f.push(a)}if(draw_note_ties(t,e,l,u,r),f.length){for(n=t.ts_next;n&&n.time<_;)n=n.ts_next;for(;n&&n.time==_;)if(n.type==C.NOTE&&n.st==t.st){for(l.length=0,u.length=0,a=f.length;--a>=0;)for(i=f[a],s=t.notes[i].apit,o=n.nhd;o>=0;o--)if(n.notes[o].apit==s){l.push(i),u.push(o),f[a]=f.pop();break}if(l.length>0&&(draw_note_ties(t,n,l,u,1==r?1:0),0==f.length))return;n=n.ts_next}else n=n.ts_next;0!=f.length&&error(1,t,"Bad tie")}}function tie_comb(t){var e,r,n;for(r=t.time+t.dur,n=t.st,e=t.ts_next;e;e=e.ts_next)if(e.st==n)if(e.time!=r){if(e.time>r)return t}else if(e.type==C.NOTE)return e}function draw_all_ties(t){function e(t,e,r){var n;if(t.type==C.GRACE)for(n=t.extra;n;n=n.next)n.ti1&&draw_ties(n,e,r);else draw_ties(t,e,r)}var r,n,a,i,o,s,c,l,u;for(r=t.sym;r;r=r.next){switch(r.type){case C.CLEF:case C.KEY:case C.METER:continue}break}for(s=t.s_rtie,n=r;n&&(!n.dur&&n.type!=C.GRACE);n=n.next)n.type==C.BAR&&n.text&&("1"==n.text[0]?s=t.s_tie:t.s_tie=s);if(n){for(t.s_tie&&(t.s_tie.x=r.x+r.wr,r=t.s_tie,t.s_tie=null,r.st=n.st,r.ts_next=n.ts_next,r.time=n.time-r.dur,draw_ties(r,n,1));;){for(r=n;r&&!r.ti1;r=r.next)if(s&&r.type==C.BAR&&r.text)if("1"!=r.text[0]){if("|"!=r.bar_type){for(n=r.next;n&&n.type!=C.NOTE;n=n.next);if(!n){r=null;break}c=clone(s),c.x=r.x,c.next=n,c.st=n.st,c.time=n.time-c.dur,draw_ties(c,n,1)}}else s=null;if(!r)break;for(o=r.time+r.dur,n=r.next;n&&!n.dur;n=n.next)if(n.text){if("1"!=n.text[0])break;s=r}if(n){if(n.type!=C.NOTE&&n.type!=C.BAR){error(1,r,"Bad tie");continue}if(n.time!=o){if((a=tie_comb(r))==r){error(1,r,"Bad tie");continue}n=a}}else{for(n=r.ts_next;n;n=n.ts_next)if(n.st==r.st&&!(n.time<o)){if(n.time>o){n=null;break}if(n.dur)break}if(!n){e(r,null,2),t.s_tie=r;break}}for(a=r.ts_next;a;a=a.ts_next)if(a.st==r.st){if(a.time>o)break;a.type!=C.CLEF||(i=!0)}i||r.st!=n.st?(i=!1,u=.4*(n.x-r.x),l=n.x,n.x-=u,n.x>r.x+32&&(n.x=r.x+32),e(r,n,2),n.x=l,l=r.x,r.x+=u,r.x<n.x-24&&(r.x=n.x-24),draw_ties(r,n,3),r.x=l):e(r,n,n.type==C.NOTE?0:2)}t.s_rtie=s}}function draw_all_slurs(t){var e,r,n=t.sym,a=t.slur_start,i=0;if(n){if(a)for(t.slur_start=0;0!=a;)i<<=4,i|=15&a,a>>=4;for(draw_slurs(n,void 0);n;n=n.next)for(;n.slur_end||n.sl2;){if(n.slur_end)n.slur_end--,r=-1;else{for(r=0;r<=n.nhd&&!n.notes[r].sl2;r++);n.notes[r].sl2--,n.sl2--}a=15&i,e=prev_scut(n),draw_slur(e,n,-1,r,a),e.type==C.BAR&&(":"==e.bar_type[0]||"|]"==e.bar_type||"[|"==e.bar_type||e.text&&"1"!=e.text[0])||(i>>=4)}for(n=t.sym;0!=i;)a=15&i,i>>=4,e=next_scut(n),draw_slur(n,e,-1,-1,a),e.type==C.BAR&&(":"==e.bar_type[0]||"|]"==e.bar_type||"[|"==e.bar_type||e.text&&"1"!=e.text[0])||(t.slur_start||(t.slur_start=0),t.slur_start<<=4,t.slur_start+=a)}}function draw_sym_near(){var t,e,r,n,a,i,o,s,c,a,l,u,f,$;for($=output,output="",n=0;n<voice_tb.length;n++){var _={},d=!0;for(t=voice_tb[n],r=t.sym;r;r=r.next)switch(r.type){case C.GRACE:for(o=r.extra;o;o=o.next)o.beam_st&&!o.beam_end&&calculate_beam(_,o);break;case C.NOTE:(r.beam_st&&!r.beam_end||d&&!r.beam_st)&&(d=!1,calculate_beam(_,r))}}for(a=0;a<=nstaff;a++)for(e=staff_tb[a],e.top||(e.top=new Float32Array(YSTEP),e.bot=new Float32Array(YSTEP)),c=0;c<YSTEP;c++)e.top[c]=0,e.bot[c]=24;for(set_tie_room(),draw_deco_near(),r=tsfirst;r;r=r.ts_next)if(!r.invis){switch(r.type){case C.GRACE:for(o=r.extra;o;o=o.next)y_set(r.st,!0,o.x-2,4,o.ymx+1),y_set(r.st,!1,o.x-2,4,o.ymn-1);continue;case C.MREST:y_set(r.st,!0,r.x+16,32,r.ymx+2);continue;default:y_set(r.st,!0,r.x-r.wl,r.wl+r.wr,r.ymx+2),y_set(r.st,!1,r.x-r.wl,r.wl+r.wr,r.ymn-2);continue;case C.NOTE:}r.stem>0?(r.beam_st?(l=3,s=r.beam_end?4:10):(l=-8,s=r.beam_end?11:16),y_set(r.st,!0,r.x+l,s,r.ymx),y_set(r.st,!1,r.x-r.wl,r.wl+r.wr,r.ymn)):(y_set(r.st,!0,r.x-r.wl,r.wl+r.wr,r.ymx),r.beam_st?(l=-6,s=r.beam_end?4:10):(l=-8,s=r.beam_end?5:16),l+=r.notes[0].shhd,y_set(r.st,!1,r.x+l,s,r.ymn)),r.notes[r.nhd].acc&&(i=r.y+8,r.ymx<i&&(r.ymx=i),y_set(r.st,!0,r.x,0,i)),r.notes[0].acc&&(i=r.y,1==r.notes[0].acc||3==r.notes[0].acc?i-=7:i-=5,r.ymn>i&&(r.ymn=i),y_set(r.st,!1,r.x,0,i))}for(n=0;n<voice_tb.length;n++)if(t=voice_tb[n],r=t.sym){for(set_color(r.color),a=t.st,set_dscale(a);r;r=r.next)r.tp0&&draw_tuplet(r,0);for(draw_all_slurs(t),r=t.sym;r;r=r.next)r.tp0&&draw_tuplet(r,0)}for(a=0;a<=nstaff;a++)for(e=staff_tb[a],u=e.topbar+2,f=e.botbar-2,c=0;c<YSTEP;c++)u>e.top[c]&&(e.top[c]=u),f<e.bot[c]&&(e.bot[c]=f);for(set_color(void 0),draw_deco_note(),draw_deco_staff(),set_dscale(-1),n=0;n<voice_tb.length;n++)if(t=voice_tb[n],t.have_ly){draw_all_lyrics();break}cfmt.measurenb>=0&&draw_measnb(),set_dscale(-1),output=$}function draw_vname(t){var e,r,n,a,i,o,s,c,l=[];for(n=cur_sy.nstaff;n>=0&&!cur_sy.st_print[n];n--);if(!(n<0)){for(a=0;a<voice_tb.length;a++)if(e=voice_tb[a],e.sym&&(n=cur_sy.voices[a].st,cur_sy.st_print[n])){if(e.new_name){c=2;break}e.snm&&(c=1)}if(c){for(a=0;a<voice_tb.length;a++)if(e=voice_tb[a],e.sym&&(n=cur_sy.voices[a].st,cur_sy.st_print[n]&&(e.new_name&&delete e.new_name,o=2==c?e.nm:e.snm))){if(cur_sy.staves[n].flags&CLOSE_BRACE2)for(;!(cur_sy.staves[n].flags&OPEN_BRACE2);)n--;else if(cur_sy.staves[n].flags&CLOSE_BRACE)for(;!(cur_sy.staves[n].flags&OPEN_BRACE);)n--;l[n]?l[n]+="\\n"+o:l[n]=o}if(0!=l.length)for(set_font("voice"),t=.5*-t,n=0;n<l.length;n++)if(l[n]){if(i=l[n].split("\\n"),s=staff_tb[n].y+.5*staff_tb[n].topbar*staff_tb[n].staffscale+9*(i.length-1)-.3*gene.curfont.size,r=n,cur_sy.staves[n].flags&OPEN_BRACE2)for(;!(cur_sy.staves[r].flags&CLOSE_BRACE2);)r++;else if(cur_sy.staves[n].flags&OPEN_BRACE)for(;!(cur_sy.staves[r].flags&CLOSE_BRACE);)r++;for(r!=n&&(s-=.5*(staff_tb[n].y-staff_tb[r].y)),r=0;r<i.length;r++)o=i[r],xy_str(t,s,o,"c"),s-=18}}}}function set_staff(){var t,e,r,n,a,i,o,s,c,l,u,f;for(n=0;n<voice_tb.length;n++)u=voice_tb[n],1!=u.scale&&(u.scale_str='transform="scale('+u.scale.toFixed(2)+')"');for(e=0;e<=nstaff&&!gene.st_print[e];e++);if(a=0,e>nstaff)e--,f=staff_tb[e];else for(f=staff_tb[e],t=0;t<YSTEP;t++)l=f.top[t],a<l&&(a=l);if(a+=draw_partempo(e,a),!gene.st_print[e])return a;a*=f.staffscale,i=.5*cfmt.staffsep+f.topbar*f.staffscale,a<i&&(a=i),a<f.ann_top&&(a=f.ann_top),f.y=-a,r=e;var $=cur_sy.staves[r];for(e++;e<=nstaff;e++)if(f=staff_tb[e],gene.st_print[e]){if(i=$.sep||cfmt.sysstaffsep,s=$.maxsep||cfmt.maxsysstaffsep,o=0,f.staffscale==staff_tb[r].staffscale){for(t=0;t<YSTEP;t++)l=f.top[t]-staff_tb[r].bot[t],o<l&&(o=l);o*=f.staffscale}else for(t=0;t<YSTEP;t++)l=f.top[t]*f.staffscale-staff_tb[r].bot[t]*staff_tb[r].staffscale,o<l&&(o=l);i+=f.topbar*f.staffscale,o<i&&(o=i),s+=f.topbar*f.staffscale,o>s&&(o=s),a+=o,f.y=-a,r=e,$=cur_sy.staves[r]}for(c=0,t=0;t<YSTEP;t++)l=staff_tb[r].bot[t],c>l&&(c=l);for(c>f.ann_bot&&(c=f.ann_bot),c*=staff_tb[r].staffscale,e=0;e<=nstaff;e++)f=staff_tb[e],o=f.y,1!=f.staffscale&&(f.scale_str='transform="translate(0,'+(posy-o).toFixed(2)+") scale("+f.staffscale.toFixed(2)+')"');if(0==c){for(e=nstaff;e>=0&&!gene.st_print[e];e--);if(e<0)return a}return o=-c,i=.5*cfmt.staffsep,o<i&&(o=i),s=.5*cfmt.maxstaffsep,o>s&&(o=s),a+o}function draw_systems(t){function e(){var t,e,r,n,a=0;for(t=0;t<=cur_sy.nstaff;t++)f[t]<0?$[t]=_[t]=0:(e=staff_tb[t].staffscale,r=staff_tb[t].topbar*e,n=staff_tb[t].botbar*e,0==a&&(a=staff_tb[t].y+r),$[t]=staff_tb[t].y+n,_[t]=a-$[t],a=cur_sy.staves[t].flags&STOP_BAR?0:$[t])}function r(t,e,r){var n,a,i,o,s,c=0,l="",u=cur_sy.staves[t].stafflines,f=u.length;if(/[\[|]/.test(u)){if(n=r-e,set_sscale(t),a=n/stv_g.scale,cache&&cache.st_l==u&&cache.st_ws==a)return void xygl(e,staff_tb[t].y,"stdef"+cfmt.fullsvg);for(i=0;i<f;i++,c-=6)if("."!=u[i]){for(o=0;i<f;i++,c-=6,o-=6){switch(u[i]){case".":case"-":continue;case s:l+="m-"+a.toFixed(2)+" "+o+"h"+a.toFixed(2),o=0;continue}void 0!=s&&(l+='"/>\n'),s=u[i],l+='<path class="stroke"',"["==s&&(l+=' stroke-width="1.5"'),l+=' d="m0 '+c+"h"+a.toFixed(2),o=0}l+='"/>\n'}if(c=staff_tb[t].y,!cache&&n==get_lwidth())return cache={st_l:u,st_ws:a},i="stdef"+cfmt.fullsvg,glyphs[i]='<g id="'+i+'">\n'+l+"</g>",void xygl(e,c,i);out_XYAB('<g transform="translate(X, Y)">\n'+l+"</g>\n",e,c)}}var n,a,i,o,s,c,l,u,f=[],$=[],_=[];for(draw_vname(t),i=0;i<=nstaff;i++)f[i]=cur_sy.st_print[i]?0:-1;for(e(),draw_lstaff(0),n=tsfirst;n;n=n.ts_next){if(u&&n.time!=u){for(u=0,i=0;i<=nstaff;i++)cur_sy.st_print[i]||(f[i]=-1);e()}switch(n.type){case C.STAVES:if(!(l=n.ts_prev.type==C.BAR?n.ts_prev.x:0)){for(a=n.ts_next;a&&a.time==n.time;a=a.ts_next){switch(a.type){case C.BAR:case C.CLEF:case C.KEY:case C.METER:l=a.x;continue}break}a||(l=realwidth)}for(c=n.sy,i=0;i<=nstaff;i++)o=f[i],o<0?c.st_print[i]&&(f[i]=l||n.x-n.wl-2):c.st_print[i]&&c.staves[i].stafflines==cur_sy.staves[i].stafflines||(l?(s=l,u=n.time):(s=n.x-n.wl-2,f[i]=-1),r(i,o,s),c.st_print[i]&&(f[i]=s));cur_sy=c,e();continue;case C.BAR:if(i=n.st,n.second||n.invis)break;draw_bar(n,$[i],_[i]);break;case C.STBRK:if(0==cur_sy.voices[n.v].range&&n.xmx>14){for(var d=0,p=0;p<voice_tb.length;p++)cur_sy.voices[p].range>0&&d++;for(a=n.ts_next;a&&a.type==C.STBRK;a=a.ts_next)d--;0==d&&draw_lstaff(n.x)}if(!(a=n.prev))break;if(s=a.x,a.type!=C.BAR&&(s+=a.wr),i=n.st,(o=f[i])>=0){if(o>=s)continue;r(i,o,s)}f[i]=n.x}}for(i=0;i<=nstaff;i++)u&&!cur_sy.st_print[i]||(o=f[i])<0||o>=realwidth||r(i,o,realwidth)}function draw_symbols(t){var e,r,n,a,i={};for(e=t.sym;e;e=e.next){if(e.invis)switch(e.type){case C.KEY:t.key=e;default:continue;case C.NOTE:}switch(r=e.x,set_color(e.color),e.type){case C.NOTE:set_scale(e),e.beam_st&&!e.beam_end&&calculate_beam(i,e)&&draw_beams(i),e.invis||(anno_start(e),draw_note(e,!i.s2),anno_stop(e)),e==i.s2&&(i.s2=null);break;case C.REST:draw_rest(e);break;case C.BAR:break;case C.CLEF:if(a=e.st,e.time>staff_tb[a].clef.time&&(staff_tb[a].clef=e),e.second)break;if(!staff_tb[e.st].topbar)break;set_color(void 0),set_sscale(a),anno_start(e),n=staff_tb[a].y,e.clef_name?xygl(r,n+e.y,e.clef_name):e.clef_small?xygl(r,n+e.y,"s"+e.clef_type+"clef"):xygl(r,n+e.y,e.clef_type+"clef"),e.clef_octave&&(e.clef_octave>0?(n+=e.ymx-10,e.clef_small&&(n-=1)):(n+=e.ymn+2,e.clef_small&&(n+=1)),xygl(r-2,n,"oct")),anno_stop(e);break;case C.METER:if(t.meter=e,e.second||!staff_tb[e.st].topbar)break;if(cfmt.alignbars&&0!=e.st)break;set_color(void 0),set_sscale(e.st),anno_start(e),draw_meter(r,e),anno_stop(e);break;case C.KEY:if(t.key=e,e.second||!staff_tb[e.st].topbar)break;set_color(void 0),set_sscale(e.st),anno_start(e),draw_keysig(t,r,e),anno_stop(e);break;case C.MREST:set_scale(e),r+=32,anno_start(e),xygl(r,staff_tb[e.st].y+12,"mrest"),out_XYAB('<text style="font-family:serif; font-weight:bold; font-size: 15px"\n\tx ="X" y="Y" text-anchor="middle">A</text>\n',r,staff_tb[e.st].y+28,e.nmes),anno_stop(e);break;case C.GRACE:set_scale(e),draw_gracenotes(e);break;case C.SPACE:case C.STBRK:break;case C.CUSTOS:set_scale(e),draw_note(e,0);break;case C.BLOCK:case C.PART:case C.REMARK:case C.STAVES:case C.TEMPO:break;default:error(2,e,"draw_symbols - Cannot draw symbol "+e.type)}}set_scale(t.sym),draw_all_ties(t),set_color(void 0)}function draw_all_sym(){var t,e,r=voice_tb.length;for(e=0;e<r;e++)t=voice_tb[e],t.sym&&void 0!=t.sym.x&&draw_symbols(t);draw_all_deco(),set_sscale(-1)}function set_tie_dir(t){var e,r,n,a,i,o,s;for(e=t;e;e=e.next)if(e.ti1)if(0==e.multi){for(i=n=0,o=128,r=0;r<=e.nhd;r++)e.notes[r].ti1&&(n++,o<128&&e.notes[r].pit<=o+1&&i++,o=e.notes[r].pit);if(n<=1){for(a=e.stem<0?C.SL_ABOVE:C.SL_BELOW,r=0;r<=e.nhd;r++)if(s=e.notes[r].ti1){(7&s)==C.SL_AUTO&&(e.notes[r].ti1=s&C.SL_DOTTED|a);break}}else if(0!=i){for(o=128,r=0;r<=e.nhd;r++)if(e.notes[r].ti1){if(o<128&&e.notes[r].pit<=o+1){n=r;break}o=e.notes[r].pit}for(a=C.SL_BELOW,r=0;r<=e.nhd;r++)0!=(s=e.notes[r].ti1)&&(n==r&&(a=C.SL_ABOVE),(7&s)==C.SL_AUTO&&(e.notes[r].ti1=s&C.SL_DOTTED|a))}else{if(1&n){for(n=(n-1)/2,a=C.SL_BELOW,r=0;r<=e.nhd;r++)0!=(s=e.notes[r].ti1)&&(0==n&&e.notes[r].pit>=22&&(a=C.SL_ABOVE),(7&s)==C.SL_AUTO&&(e.notes[r].ti1=s&C.SL_DOTTED|a),0==n--&&(a=C.SL_ABOVE));continue}for(n/=2,a=C.SL_BELOW,r=0;r<=e.nhd;r++)0!=(s=e.notes[r].ti1)&&((7&s)==C.SL_AUTO&&(e.notes[r].ti1=s&C.SL_DOTTED|a),0==--n&&(a=C.SL_ABOVE))}}else for(a=e.multi>0?C.SL_ABOVE:C.SL_BELOW,r=0;r<=e.nhd;r++)(7&(s=e.notes[r].ti1))==C.SL_AUTO&&(e.notes[r].ti1=s&C.SL_DOTTED|a)}function set_tie_room(){var t,e,r,n,a,i,o;for(n=0;n<voice_tb.length;n++)if(t=voice_tb[n],(e=t.sym)&&(e=e.next))for(set_tie_dir(e);e;e=e.next)if(e.ti1){if(e.notes[0].pit<20&&(7&e.notes[0].ti1)==C.SL_BELOW);else if(!(e.notes[e.nhd].pit>24&&(7&e.notes[e.nhd].ti1)==C.SL_ABOVE))continue;for(r=e.next;r&&r.type!=C.NOTE;)r=r.next;if(r){if(r.st!=e.st)continue;a=r.x-e.x-10}else a=realwidth-e.x-10;o=a<100?9:a<300?12:16,e.notes[e.nhd].pit>24&&(i=3*(e.notes[e.nhd].pit-18)+o,e.ymx<i&&(e.ymx=i),r&&r.ymx<i&&(r.ymx=i),y_set(e.st,!0,e.x+5,a,i)),e.notes[0].pit<20&&(i=3*(e.notes[0].pit-18)-o,e.ymn>i&&(e.ymn=i),r&&r.ymn>i&&(r.ymn=i),y_set(e.st,!1,e.x+5,a,i))}}function get_bool(t){return!t||!/^(0|n|f)/i.test(t)}function get_font_scale(t){var e=t.split(/\s+/);if(!(e.length<=1)){var r=parseFloat(e[e.length-1]);if(isNaN(r)||e<=0)return void syntax(1,"Bad scale value in %%font");font_scale_tb[e[0]]=r;for(var n in font_tb)if(font_tb.hasOwnProperty(n)){var a=font_tb[n];a.name==e[0]&&(a.swfac=a.size*r)}}}function param_set_font(t,e){var r,n,a,i,o,s,c,l,u,f;if("-"==t[t.length-2]){if((i=t[t.length-1])<"1"||i>"9")return;t="u"+i+"font"}n=cfmt[t],n&&(r=font_tb[n])&&(a=r.name+"."+r.size,r.class&&(a+="."+r.class)),i=e.indexOf("class="),i>=0&&(i+=6,o=e.indexOf(" ",i),f=o>0?e.slice(i,o):e.slice(i),e=e.replace(new RegExp("class="+f),"").trim()),o=e.split(/\s+/),s=o[0],"*"==s&&r?s=r.name:(s=s.replace("Times-Roman","serif"),s=s.replace("Times","serif"),s=s.replace("Helvetica","sans-serif"),s=s.replace("Courier","monospace")),o.length>1?"*"==(l=o[o.length-1])&&r&&(l=r.size):r&&(l=r.size),l&&(c=s+"."+l,f&&(c+="."+f),c!=a&&(r=font_tb[c],r||(u=font_scale_tb[s],u||(u=1.1),r={name:s,size:Number(l),swfac:l*u},font_tb[c]=r),f&&(r.class=f),cfmt[t]=c))}function get_unit(t){var e=parseFloat(t);switch(t.slice(-2)){case"CM":case"cm":e*=CM;break;case"IN":case"in":e*=IN;break;case"PT":case"pt":e*=.75}return e}function set_infoname(t){for(var e=cfmt.infoname.split("\n"),r=t[0],n=0;n<e.length;n++){if(e[n][0]==r)return 1==t.length?e.splice(n,1):e[n]=t,void(cfmt.infoname=e.join("\n"))}cfmt.infoname+="\n"+t}function get_textopt(t){return textopt[t]}function set_pos(t,e){t=t.slice(0,3),"ste"==t&&(t="stm"),set_v_param("pos",t+" "+e)}function set_writefields(t){var e,r,n=t.split(/\s+/);if(get_bool(n[1]))for(r=0;r<n[0].length;r++)e=n[0][r],cfmt.writefields.indexOf(e)<0&&(cfmt.writefields+=e);else for(r=0;r<n[0].length;r++)e=n[0][r],cfmt.writefields.indexOf(e)>=0&&(cfmt.writefields=cfmt.writefields.replace(e,""))}function set_v_param(t,e){if(curvoice)return void set_vp([t+"=",e]);t=[t+"=",e];info.V||(info.V={}),info.V["*"]?Array.prototype.push.apply(info.V["*"],t):info.V["*"]=t}function set_page(){img.chg&&(img.chg=!1,img.lm=cfmt.leftmargin-cfmt.printmargin,img.lm<0&&(img.lm=0),img.rm=cfmt.rightmargin-cfmt.printmargin,img.rm<0&&(img.rm=0),img.width=cfmt.pagewidth-2*cfmt.printmargin,img.width-img.lm-img.rm<100&&(error(0,void 0,"Bad staff width"),img.width=img.lm+img.rm+150),set_posx())}function set_format(t,e,r){var n,a,i,o,s;if(r)fmt_lock[t]=!0;else if(fmt_lock[t])return;if(/.+font(-[\d])?$/.test(t))switch(" box"==e.slice(-4)&&(o=!0,e=e.slice(0,-4)),param_set_font(t,e),t){case"gchordfont":cfmt.gchordbox=o;break;case"measurefont":cfmt.measurebox=o;break;case"partsfont":cfmt.partsbox=o}else switch(t){case"aligncomposer":case"barsperstaff":case"infoline":case"measurefirst":case"measurenb":case"rbmax":case"rbmin":case"shiftunison":if(i=parseInt(e),isNaN(i)){syntax(1,"Bad integer value");break}cfmt[t]=i;break;case"microscale":if(n=parseInt(e),isNaN(n)||n<4||n>256||n%1){syntax(1,errs.bad_val,"%%"+t);break}set_v_param("uscale",n);break;case"bgcolor":case"dblrepbar":case"titleformat":cfmt[t]=e;break;case"breaklimit":case"lineskipfac":case"maxshrink":case"pagescale":case"parskipfac":case"scale":case"slurheight":case"stemheight":case"stretchlast":if(n=parseFloat(e),isNaN(n)){syntax(1,errs.bad_val,"%%"+t);break}switch(t){case"scale":n/=.75;case"pagescale":t="scale",img.chg=!0}cfmt[t]=n;break;case"bstemdown":case"breakoneoln":case"cancelkey":case"contbarnb":case"custos":case"decoerr":case"dynalign":case"flatbeams":case"gchordbox":case"graceslurs":case"graceword":case"hyphencont":case"keywarn":case"linewarn":case"measurebox":case"partsbox":case"rbdbstop":case"singleline":case"squarebreve":case"straightflags":case"stretchstaff":case"timewarn":case"titlecaps":case"titleleft":cfmt[t]=get_bool(e);break;case"chordnames":for(i=e.split(","),cfmt.chordnames={},s=0;s<i.length;s++)cfmt.chordnames["CDEFGAB"[s]]=i[s];break;case"composerspace":case"indent":case"infospace":case"maxstaffsep":case"maxsysstaffsep":case"musicspace":case"partsspace":case"staffsep":case"subtitlespace":case"sysstaffsep":case"textspace":case"titlespace":case"topspace":case"vocalspace":case"wordsspace":n=get_unit(e),isNaN(n)?syntax(1,errs.bad_val,"%%"+t):cfmt[t]=n;break;case"print-leftmargin":syntax(0,"$1 is deprecated - use %%printmargin instead","%%"+t),t="printmargin";case"printmargin":case"leftmargin":case"pagewidth":case"rightmargin":if(n=get_unit(e),isNaN(n)){syntax(1,errs.bad_val,"%%"+t);break}cfmt[t]=n,img.chg=!0;break;case"concert-score":cfmt.sound="concert";break;case"writefields":set_writefields(e);break;case"dynamic":case"gchord":case"gstemdir":case"ornament":case"stemdir":case"vocal":case"volume":set_pos(t,e);break;case"font":get_font_scale(e);break;case"fullsvg":if(0!=parse.state){syntax(1,"Cannot have %%fullsvg inside a tune");break}cfmt[t]=e;break;case"gracespace":for(i=e.split(/\s+/),s=0;s<3;s++)if(isNaN(Number(i[s]))){syntax(1,errs.bad_val,"%%gracespace");break}for(s=0;s<3;s++)cfmt[t]=Number(i[s]);break;case"tuplets":cfmt[t]=e.split(/\s+/),i=cfmt[t][3],i&&posval[i]&&(cfmt[t][3]=posval[i]);break;case"infoname":set_infoname(e);break;case"notespacingfactor":if(n=parseFloat(e),isNaN(n)||n<1||n>2){syntax(1,errs.bad_val,"%%"+t);break}for(s=5,a=space_tb[s];--s>=0;)a/=n,space_tb[s]=a;for(s=5,a=space_tb[s];++s<space_tb.length;)a*=n,space_tb[s]=a;break;case"play":cfmt.sound="play";break;case"pos":t=e.split(/\s+/),set_pos(t[0],t[1]);break;case"sounding-score":cfmt.sound="sounding";break;case"staffwidth":if(i=get_unit(e),isNaN(i)){syntax(1,errs.bad_val,"%%"+t);break}if(i<100){syntax(1,"%%staffwidth too small");break}if((i=cfmt.pagewidth-i-cfmt.leftmargin)<2){syntax(1,"%%staffwidth too big");break}cfmt.rightmargin=i,img.chg=!0;break;case"textoption":cfmt[t]=get_textopt(e);break;case"titletrim":i=Number(e),isNaN(i)?cfmt[t]=get_bool(e):cfmt[t]=i;break;case"combinevoices":syntax(1,"%%combinevoices is deprecated - use %%voicecombine instead");break;case"voicemap":set_v_param("map",e);break;case"voicescale":set_v_param("scale",e);break;default:0==parse.state&&(cfmt[t]=e)}}function font_init(){param_set_font("annotationfont","sans-serif 12"),param_set_font("composerfont","serifItalic 14"),param_set_font("footerfont","serif 16"),param_set_font("gchordfont","sans-serif 12"),param_set_font("headerfont","serif 16"),param_set_font("historyfont","serif 16"),param_set_font("infofont","serifItalic 14"),param_set_font("measurefont","serifItalic 14"),param_set_font("partsfont","serif 15"),param_set_font("repeatfont","serif 13"),param_set_font("subtitlefont","serif 16"),param_set_font("tempofont","serifBold 15"),param_set_font("textfont","serif 16"),param_set_font("titlefont","serif 20"),param_set_font("vocalfont","serifBold 13"),param_set_font("voicefont","serifBold 13"),param_set_font("wordsfont","serif 16")}function style_font(t){var e=t.split("."),r=e[1],n=t.indexOf("Italic"),a=100,i=t.indexOf("Oblique"),o=t.indexOf("Bold");return t=e[0],e="",o>0&&(e+="font-weight:bold; ",a=o),(n>0||i>0)&&(n>0&&(e+="font-style:italic; ",n<a&&(a=n)),i>0&&(e+="font-style:oblique; ",i<a&&(a=i))),100!=a&&("-"==t[a-1]&&a--,t=t.slice(0,a)),"font-family:"+t+"; "+e+"font-size:"+r+"px"}function font_class(t){return t.class?"f"+t.fid+cfmt.fullsvg+" "+t.class:"f"+t.fid+cfmt.fullsvg}function style_add_font(t){font_style+="\n.f"+t.fid+cfmt.fullsvg+" {"+style_font(t.name+"."+t.size)+"}"}function use_font(t){defined_font[t.fid]||(defined_font[t.fid]=!0,style_add_font(t))}function get_font(t){t+="font";var e=cfmt[t],r=font_tb[e];return r||(syntax(1,"Unknown font $1",t),r=gene.curfont),r.fid||(r.fid=fid++),use_font(r),r}function cnv_escape(t){for(var e,r,n,a,i="",o=0;;){if((n=t.indexOf("\\",o))<0)break;if(i+=t.slice(o,n),!(e=t[++n]))return i+"\\";switch(e){case"0":case"2":if("0"!=t[n+1])break;if(r=oct_acc[t[n+2]]){i+=r,o=n+3;continue}break;case"u":if(o=Number("0x"+t.slice(n+1,n+5)),isNaN(o)||o<32){i+=t[++n]+"",o=n+1;continue}if(a=[o],o>=55296&&o<=57343){if(o=Number("0x"+t.slice(n+7,n+11)),isNaN(o))break;a.push(o),o=n+11}else o=n+5;i+=String.fromCharCode.apply(null,a);continue;case"t":i+=" ",o=n+1;continue;default:if(r=abc_utf[t.slice(n,n+2)]){i+=r,o=n+2;continue}switch(e){case"`":i+=t[++n]+"",o=n+1;continue;case"'":i+=t[++n]+"",o=n+1;continue;case"^":i+=t[++n]+"",o=n+1;continue;case"~":i+=t[++n]+"",o=n+1;continue;case"=":i+=t[++n]+"",o=n+1;continue;case"_":i+=t[++n]+"",o=n+1;continue;case".":i+=t[++n]+"",o=n+1;continue;case'"':i+=t[++n]+"",o=n+1;continue;case"o":i+=t[++n]+"",o=n+1;continue;case"H":i+=t[++n]+"",o=n+1;continue;case"v":i+=t[++n]+"",o=n+1;continue;case"c":i+=t[++n]+"",o=n+1;continue;case";":i+=t[++n]+"",o=n+1;continue}}i+="\\"+e,o=n+1}return i+t.slice(o)}function do_include(t){var e,r;return user.read_file?include>2?void syntax(1,"Too many include levels"):(include++,(e=user.read_file(t))?(r=clone(parse),tosvg(t,e),parse=r,void include--):void syntax(1,"Cannot read file '$1'",t)):void syntax(1,"No read_file support")}function tosvg(t,e,r,n){function a(t,e){return t.indexOf("%")>=0&&(t=t.replace(/([^\\])%.*/,"$1").replace(/\\%/g,"%")),t=t.replace(/\s+$/,""),e&&t.indexOf("\\")>=0?cnv_escape(t):t}function i(){generate(),info.W&&put_words(info.W),put_history(),blk_flush(),parse.state=0,cfmt=v,info=y,char_tb=b,glovar=w,maps=x,mac=A,maci=k,init_tune(),img.chg=!0,set_page()}var o,r,s,c,l,u,f,$,_,d,p,h,g,m,v,y,b,w,x,A,k,E,S="\n";for(abc2svg.modules&&(abc2svg.modules.hooks.length||abc2svg.modules.g_hooks.length)&&set_hooks(),parse.file=e,parse.fname=t,void 0==r&&(r=0),n||(n=e.length);r<n;r=parse.eol+1){for(s=e.indexOf("\n",r),(s<0||s>n)&&(s=n),parse.eol=s;;){switch(s--,e[s]){case" ":case"\t":continue}break}if(++s!=r){if(parse.istart=parse.bol=r,parse.iend=s,parse.line.index=0,f=e[r],$=e[r+1],"%"==f){if(parse.prefix.indexOf($)<0)continue;"a"==e[r+2]&&"b"==e[r+3]&&"c"==e[r+4]&&" "==e[r+5]?(r+=6,f=e[r],$=e[r+1]):E=!0}else"I"==f&&":"==$&&(E=!0);if(E){for(E=!1,r+=2;;){switch(e[r]){case" ":case"\t":r++;continue}break}if(!(p=e.slice(r,s))||"%"==p[0])continue;switch(h=p.split(/\s+/,2),h[0]||h.shift(),h[0]){case"abcm2ps":case"ss-pref":parse.prefix=h[1];continue;case"abc-include":l=h[1].match(/.*\.(.*)/),l&&"abc"==l[1]&&do_include(h[1]);continue}if("begin"==h[0].slice(0,5)){if(g=h[0].substr(5),c="\n"+f+$+"end"+g,(o=e.indexOf(c,s))<0){syntax(1,"No $1 after %%$2",c.slice(1),h[0]),parse.eol=n;continue}do_begin_end(g,h[1],e.slice(s+1,o).replace(new RegExp("^"+f+$,"gm"),"")),parse.eol=e.indexOf("\n",o+6),parse.eol<0&&(parse.eol=n);continue}switch(h[0]){case"select":if(0!=parse.state){syntax(1,"%%select ignored");continue}if(u=a(p.slice(7),!1),'"'==u[0]&&(u=u.slice(1,-1)),!u){delete parse.select;continue}u=u.replace(/\(/g,"\\("),u=u.replace(/\)/g,"\\)"),parse.select=new RegExp(u,"m");continue;case"tune":syntax(1,"%%tune not treated yet");continue;case"voice":if(0!=parse.state){syntax(1,"%%voice ignored");continue}if(!(u=a(p.slice(6),!1))){parse.cur_tune_opts?parse.cur_tune_opts.voice_opts=null:parse.voice_opts=null;continue}if("end"==u)continue;for(parse.cur_tune_opts?(parse.cur_tune_opts.voice_opts||(parse.cur_tune_opts.voice_opts={}),d=parse.cur_tune_opts.voice_opts):(parse.voice_opts||(parse.voice_opts={}),d=parse.voice_opts),d[u]=[];;){if(r=++s,"%"!=e[r])break;if(s=e.indexOf("\n",s),e[r+1]==$){switch(r+=2,p=s<0?e.slice(r):e.slice(r,s),h=p.match(/\S+/),h[0]){default:d[u].push(a(p,!0));continue;case"score":case"staves":case"tune":case"voice":r-=2}break}}parse.eol=r-1;continue}do_pscom(a(p,!0))}else if(":"==$&&/[A-Za-z+]/.test(f)){for(r+=2;;){switch(e[r]){case" ":case"\t":r++;continue}break}if(p=a(e.slice(r,s),!0),"+"==f){if(!_){syntax(1,"+: without previous info field");continue}S=" ",f=_}switch(f){case"X":if(0!=parse.state){syntax(1,errs.ignored,f);continue}if(parse.select&&!function(){var t,a,i=e.indexOf("K:",r);return!(i<0)&&(i=e.indexOf("\n",i),!!parse.select.test(e.slice(parse.bol,i))||(t=/\n\w*\n/,t.lastIndex=i,a=t.exec(e),s=a?t.lastIndex:n,!1))}()){s=e.indexOf("\nX:",parse.eol),s<0&&(s=n),parse.eol=s;continue}v=clone(cfmt),cfmt.pos=clone(cfmt.pos),y=clone(info,1),b=clone(char_tb),w=clone(glovar),x=clone(maps,1),A=clone(mac),k=new Int8Array(maci),info.X=p,parse.state=1;continue;case"T":switch(parse.state){case 0:continue;case 1:void 0==info.T?info.T=p:info.T+="\n"+p;continue}m=new_block("title"),m.text=p;continue;case"K":switch(parse.state){case 0:continue;case 1:info.K=p}do_info(f,p);continue;case"W":if(0==parse.state||cfmt.writefields.indexOf(f)<0)break;void 0==info.W?info.W=p:info.W+=S+p;break;case"m":if(parse.state>=2){syntax(1,errs.ignored,f);continue}if((!cfmt.sound||"play"!=cfmt.sound)&&cfmt.writefields.indexOf(f)<0)break;if(!(h=p.match(/(.*?)[= ]+(.*)/))||!h[2]){syntax(1,errs.bad_val,"m:");continue}mac[h[1]]=h[2],maci[h[1].charCodeAt(0)]=1;break;case"s":if(3!=parse.state||cfmt.writefields.indexOf(f)<0)break;get_sym(p," "==S);break;case"w":if(3!=parse.state||cfmt.writefields.indexOf(f)<0)break;if(get_lyrics(p," "==S),"\\"==p.slice(-1)){S=" ",_=f;continue}break;case"|":if(parse.state<2)continue
;parse.line.buffer=a(e.slice(r,s),!0),parse_music_line();continue;default:if("ABCDFGHOSZ".indexOf(f)>=0){if(parse.state>=2){syntax(1,errs.ignored,f);continue}info[f]?info[f]+=S+p:info[f]=p;break}do_info(f,p);continue}S="\n",_=f}else{if(_=void 0,parse.state<2)continue;parse.line.buffer=a(e.slice(r,s),!0),parse_music_line()}}else 1==parse.state?(parse.istart=r,syntax(1,"Empty line in tune header - ignored")):parse.state>=2&&(i(),parse.select&&(s=e.indexOf("\nX:",parse.eol),s<0&&(s=n),parse.eol=s))}include||(parse.state>=2&&i(),parse.state=0)}function set_head_shift(t){var e,r,n,a,i,o,s=dx_tb[t.head],c=t.stem,l=t.nhd;if(0!=l){o=.78*s,t.grace&&(o*=.5),c>=0?(r=1,n=l+1,i=t.notes[0].pit):(o=-o,r=l-1,n=-1,i=t.notes[l].pit);var u=!1,f=0;for(e=r;e!=n;e+=c){if(a=t.notes[e].pit-i,i=t.notes[e].pit,0==a){if(u){var $=t.notes[e].shhd=t.notes[e-c].shhd+o;f<$&&(f=$);continue}if(e+c!=n&&i+c==t.notes[e+c].pit){t.notes[e].shhd=-o,f<-o&&(f=-o);continue}}a<0&&(a=-a),a>3||a>=2&&t.head!=C.SQUARE?u=!1:(u=!u)&&(t.notes[e].shhd=o,f<o&&(f=o))}t.xmx=f}}function acc_shift(t,e){var r,n,a,i,o,s,c,l=t.length;for(r=l-1;--r>=0;)if((a=t[r].shhd)&&!(a>0))for(a=e-a,o=t[r].pit,n=l;--n>=0;)if(t[n].acc){if((s=t[n].pit)<o-3)break;s>o+3||t[n].shac<a&&(t[n].shac=a)}for(r=l;--r>=0;)if(c=t[r].acc){for(a=t[r].shac,a||(a=t[r].shhd,a=a<0?e-a:e),o=t[r].pit,n=l;--n>r;)t[n].acc&&((s=t[n].pit)>=o+4&&(s>o+4||c<0||t[n].acc<0)||a>t[n].shac-6&&(i=t[n].shac+7)>a&&(a=i));t[r].shac=a}}function set_acc_shft(){var t,e,r,n,a,r,i,o;for(t=tsfirst;t;)if(t.type!=C.NOTE||t.invis)t=t.ts_next;else{for(r=t.st,i=t.time,a=!1,e=t;e&&(e.time==i&&e.type==C.NOTE&&e.st==r);e=e.ts_next)if(!a)for(n=0;n<=e.nhd;n++)if(e.notes[n].acc){a=!0;break}if(a){for(o=dx_tb[t.head],r={notes:[]};t!=e;t=t.ts_next)r.notes=r.notes.concat(t.notes);sort_pitch(r),acc_shift(r.notes,o)}else t=e}}function lkvsym(t,e){t.next=e,t.prev=e.prev,t.prev?t.prev.next=t:t.p_v.sym=t,e.prev=t}function lktsym(t,e){e?(t.ts_next=e,t.ts_prev=e.ts_prev,t.ts_prev&&(t.ts_prev.ts_next=t),e.ts_prev=t):t.ts_next=t.ts_prev=null}function unlksym(t){t.next&&(t.next.prev=t.prev),t.prev?t.prev.next=t.next:t.p_v.sym=t.next,t.ts_next&&(t.seqst&&!t.ts_next.seqst&&(t.ts_next.seqst=!0,t.ts_next.shrink=t.shrink,t.ts_next.space=t.space),t.ts_next.ts_prev=t.ts_prev),t.ts_prev&&(t.ts_prev.ts_next=t.ts_next),tsfirst==t&&(tsfirst=t.ts_next),tsnext==t&&(tsnext=t.ts_next)}function insert_clef(t,e,r){var n,a=t.p_v,i=t.st;for(t.type==C.BAR&&t.prev&&t.prev.type==C.BAR&&(t=t.prev),a.last_sym=t.prev,a.last_sym||(a.sym=null),a.time=t.time,n=sym_add(a,C.CLEF),n.next=t,t.prev=n,n.clef_type=e,n.clef_line=r,n.st=i,n.clef_small=!0,delete n.second,n.notes=[],n.notes[0]={pit:t.notes[0].pit},n.nhd=0;!t.seqst;)t=t.ts_prev;return lktsym(n,t),n.ts_prev.type!=C.CLEF&&(n.seqst=!0),n}function set_float(){var t,e,r,n,a,i,o,s;for(n=0;n<voice_tb.length;n++)for(t=voice_tb[n],r=!1,e=t.st,a=t.sym;a;a=a.next){if(!a.floating){for(;a&&!a.floating;)a=a.next;if(!a)break;r=!1}if(a.dur)if(a.notes[0].pit>=19)r=!1;else if(a.notes[a.nhd].pit<=12)r=!0,a.st++;else{for(o=127,i=a.ts_prev;i&&(i.st==e&&i.v!=a.v);i=i.ts_prev)i.type==C.NOTE&&i.notes[0].pit<o&&(o=i.notes[0].pit);if(127!=o)if(a.notes[a.nhd].pit>o-3)r=!1;else{for(s=-127,i=a.ts_next;i&&(i.st==e+1&&i.v!=a.v);i=i.ts_next)i.type==C.NOTE&&i.notes[i.nhd].pit>s&&(s=i.notes[i.nhd].pit);if(-127!=s)if(a.notes[0].pit<s+3)r=!0,a.st++;else{if(o-=a.notes[a.nhd].pit,s=a.notes[0].pit-s,r){if(o<s-3){r=!1;continue}}else{if(o<s+3)continue;r=!0}a.st++}else r&&a.st++}else r&&a.st++}else r&&a.st++}}function set_graceoffs(t){var e,r,n,a,i=cfmt.gracespace[0],o=cfmt.gracespace[1],s=cfmt.gracespace[2],c=t.extra;for(t.prev&&t.prev.type==C.BAR&&(i-=3),a=i,c.beam_st=!0;;c=c.next){for(set_head_shift(c),acc_shift(c.notes,7),n=0,r=c.nhd;r>=0;r--)c.notes[r].shac>n&&(n=c.notes[r].shac);if(a+=n,c.x=a,c.nflags<=0&&(c.beam_st=!0,c.beam_end=!0),!(e=c.next)){c.beam_end=!0;break}e.nflags<=0&&(c.beam_end=!0),c.beam_end&&(e.beam_st=!0,a+=o/4),c.nflags<=0&&(a+=o/4),c.y>e.y+8&&(a-=1.5),a+=o}return e=t.next,e&&e.type==C.NOTE&&(c.y>=3*(e.notes[e.nhd].pit-18)?s-=1:c.beam_st&&c.y<3*(e.notes[e.nhd].pit-18)-4&&(s+=2)),a+=s}function gchord_width(t,e,r){var n,a,i,o,s,c=0,l=0,u=0,f=0;for(s=0;s<t.a_gch.length;s++)switch(a=t.a_gch[s],a.type){default:o=-a.x,o>c&&(c=o),i=a.w+2-o,i>l&&(l=i);break;case"<":i=a.w+e,i>u&&(u=i);break;case">":i=a.w+t.wr,i>f&&(f=i)}if(n=t.prev){if(n.a_gch)for(n=t.ts_prev;;n=n.ts_prev){if(n==t.prev){r<c&&(r=c);break}n.seqst&&(c-=n.shrink)}0!=u&&r<u&&(r=u)}if(n=t.next){if(n.a_gch)for(n=t.ts_next;;n=n.ts_next){if(n==t.next){t.wr<l&&(t.wr=l);break}n.seqst&&(l-=8)}0!=f&&t.wr<f&&(t.wr=u)}return r}function set_width(t){var e,r,n,a,i,o,s,c;switch(t.type){case C.NOTE:case C.REST:for(t.wr=o=hw_tb[t.head],t.xmx>0&&(t.wr+=t.xmx+4),e=t.prev;e&&0==w_tb[e.type];e=e.prev);if(e)switch(e.type){case C.BAR:case C.CLEF:case C.KEY:case C.METER:o+=3}for(n=0;n<=t.nhd;n++)if(a=t.notes[n].shhd,a<0&&o<5-a&&(o=5-a),t.notes[n].acc){var l=t.notes[n].shac+(t.notes[n].micro?5.5:3.5);o<l&&(o=l)}if(e)switch(e.type){case C.BAR:case C.CLEF:case C.KEY:case C.METER:o-=3}if(t.a_dd&&(o+=deco_width(t)),t.beam_st&&t.beam_end&&t.stem>0&&t.nflags>0&&t.wr<t.xmx+9&&(t.wr=t.xmx+9),t.dots>0){if(void 0==t.wl)switch(t.head){case C.SQUARE:t.xmx+=4;break;case C.OVALBARS:case C.OVAL:t.xmx+=2;break;case C.EMPTY:t.xmx+=1}t.wr<t.xmx+8&&(t.wr=t.xmx+8),t.dots>=2&&(t.wr+=3.5*(t.dots-1))}if(t.trem2&&t.beam_end&&o<20&&(o=20),s=o,e)switch(e.type){case C.NOTE:e.stem>0&&t.stem<0&&s<7&&(s=7),(t.y>27&&e.y>27||t.y<-3&&e.y<-3)&&s<6&&(s=6),e.ti1&&s<14&&(s=14);break;case C.CLEF:if(e.second||e.clef_small)break;s+=8;break;case C.KEY:s+=4}return t.a_gch&&(s=gchord_width(t,o,s)),t.a_ly&&(s=ly_width(t,s)),void(e&&e.type==C.GRACE?t.wl=o-4.5:t.wl=s);case C.SPACE:return a=t.width/2,t.wr=a,t.a_gch&&(a=gchord_width(t,a,a)),t.a_dd&&(a+=deco_width(t)),void(t.wl=a);case C.BAR:if(t.norepbra)break;if(t.invis)t.wl=t.wr=0;else{var u=t.bar_type;switch(u){case"|":i=7;break;case"|:":case":|":i=15;break;case"::":i=26;break;default:if(!u)break;for(i=4+3*u.length,r=0;r<u.length;r++)switch(u[r]){case"[":case"]":i+=3;break;case":":i+=2}}for(t.wl=i,t.next&&t.next.type!=C.METER?t.wr=7:t.wr=5,e=t.prev;e;e=e.prev)if(0!=w_tb[e.type]){e.type==C.GRACE&&(t.wl-=8);break}}return t.a_dd&&(t.wl+=deco_width(t)),void(t.text&&t.text.length<4&&t.next&&t.next.a_gch&&(set_font("repeat"),t.wr+=strwh(t.text)[0]+2));case C.CLEF:return t.invis?void(t.wl=t.wr=1):void(t.wl=t.wr=t.clef_small?8:12);case C.KEY:var f,$,_;if(t.wl=3,_=4,t.k_a_acc){if(f=$=t.k_a_acc.length,$)var d=t.k_a_acc[0].acc;for(r=1;r<$;r++)c=t.k_a_acc[r],c.pit>t.k_a_acc[r-1].pit+6||c.pit<t.k_a_acc[r-1].pit-6?f--:c.acc!=d&&(_+=3),d=c.acc}else f=t.k_sf,$=t.k_old_sf&&(cfmt.cancelkey||0==f)?t.k_old_sf:0,f*$>=0?(f<0&&(f=-f),$<0&&($=-$),$>f&&(f=$)):(f-=$,f<0&&(f=-f),_+=3);return void(t.wr=5.5*f+_);case C.METER:for(s=0,t.x_meter=[],r=0;r<t.a_meter.length;r++){var p=t.a_meter[r];if("C"==p.top[0])t.x_meter[r]=s+6,s+=12;else{for(i=0,p=!p.bot||p.top.length>p.bot.length?p.top:p.bot,n=0;n<p.length;n++)switch(p[n]){case"(":s+=4;case")":case"1":i+=4;break;default:i+=12}t.x_meter[r]=s+i/2,s+=i}}return t.wl=0,void(t.wr=s+6);case C.MREST:return t.wl=6,void(t.wr=66);case C.GRACE:return t.wl=set_graceoffs(t),t.wr=0,void(t.a_ly&&ly_width(t,s));case C.STBRK:return t.wl=t.xmx,void(t.next&&t.next.type==C.CLEF?(t.wr=2,delete t.next.clef_small):t.wr=8);case C.CUSTOS:return void(t.wl=t.wr=4);case C.BLOCK:case C.PART:case C.REMARK:case C.STAVES:case C.TEMPO:break;default:error(2,t,"set_width - Cannot set width for symbol $1",t.type)}t.wl=t.wr=0}function time2space(t,e){var r,n,a;return smallest_duration>=C.BLEN/2?smallest_duration>=C.BLEN?e/=4:e/=2:!t.next&&e>=C.BLEN&&(e/=2),r=e>=C.BLEN/4?e<C.BLEN/2?5:e<C.BLEN?6:e<2*C.BLEN?7:e<4*C.BLEN?8:9:e>=C.BLEN/8?4:e>=C.BLEN/16?3:e>=C.BLEN/32?2:e>=C.BLEN/64?1:0,n=e-(C.BLEN/16/8<<r),a=space_tb[r],0!=n&&(n<0?a=space_tb[0]*e/(C.BLEN/16/8):(r>=9&&(r=8),a+=(space_tb[r+1]-space_tb[r])*n/e)),a}function set_space(t){var e,r,n=t.ts_prev.time,a=t.time-n;if(0==a){switch(t.type){case C.MREST:return t.wl}return 0}if(t.ts_prev.type==C.MREST)return 71;for(r=time2space(t,a);!t.dur;){switch(t.type){case C.BAR:return.9*r-7;case C.CLEF:return r-t.wl-t.wr;case C.BLOCK:case C.PART:case C.REMARK:case C.STAVES:case C.TEMPO:if(!(t=t.ts_next))return r;continue}break}if(t.beam_st||(r*=.9),t.type==C.NOTE&&t.nflags>=-1&&t.stem>0){var i=!0;for(e=t.ts_prev;e&&e.time==n;e=e.ts_prev)if(e.type==C.NOTE&&(e.nflags<-1||e.stem>0)){i=!1;break}if(i){for(e=t.ts_next;e&&e.time==t.time;e=e.ts_next)if(e.type==C.NOTE&&(e.nflags<-1||e.stem<0)){i=!1;break}i&&(r*=.9)}}return r}function set_sp_tup(t,e){var r=t.time,n=e.time-r,a=time2space(t,n/t.tq0)*t.tq0;for(t=t.ts_next;;){if(t.seqst&&(t.space=(t.time-r)/n*a),r=t.time,t==e)break;t=t.ts_next}}function add_end_bar(t){return{type:C.BAR,bar_type:"|",fname:t.fname,istart:t.istart,iend:t.iend,v:t.v,p_v:t.p_v,st:t.st,dur:0,seqst:!0,invis:!0,time:t.time+t.dur,nhd:0,notes:[{pit:t.notes[0].pit}],wl:0,wr:0}}function set_allsymwidth(t){for(var e,r,n,a=tsfirst,i=0,o=[],s=0,c=0;;){var l=i,u=a;do{set_width(a),e=(o[a.st]||0)+a.wl,e>l&&(l=e),a.tp0?1==++c&&(n=a,s|=1):a.te0&&0==--c&&(s=4),a=a.ts_next}while(a!=t&&!a.seqst);if(u.shrink=l-i,14&s||(u.ts_prev?u.space=set_space(u):u.space=0),s&&(8&s&&(set_sp_tup(r,u),s&=-9),1&s&&(r=n,s++),4&s&&(s+=4)),0==u.shrink&&0==u.space&&u.type==C.CLEF&&(delete u.seqst,u.time=u.ts_prev.time),a==t)break;i=l,a=u;do{(!o[a.st]||o[a.st]<i+a.wr)&&(o[a.st]=i+a.wr),a=a.ts_next}while(!a.seqst)}}function to_rest(t){t.type=C.REST,delete t.in_tuplet,delete t.sl1,delete t.sl2,delete t.a_dd,delete t.a_gch,t.slur_start=t.slur_end=0}function set_repeat(t){var e,r,n,a,i,o=t.repeat_n,s=t.repeat_k,c=t.st,l=t.v;if(t.repeat_n=0,o<0){for(o=-o,n=o,r=t.prev;r;r=r.prev)if(r.dur){if(--n<=0)break}else if(r.type==C.BAR)return void error(1,r,"Bar in repeat sequence");if(!r)return void error(1,t,errs.not_enough_n);for(i=t.time-r.time,n=s*o,e=t;e;e=e.next)if(e.dur){if(--n<=0)break}else if(e.type==C.BAR)return void error(1,e,"Bar in repeat sequence");if(!e||!e.next)return void error(1,t,errs.not_enough_n);for(e=t.prev;e!=r;e=e.prev)if(e.type==C.NOTE){e.beam_end=!0;break}for(a=s;--a>=0;){for(n=o,t.dur&&n--,e=t.ts_next;n>0;)e.st==c&&(unlksym(e),e.v==l&&e.dur&&n--),e=e.ts_next;for(to_rest(t),t.dur=t.notes[0].dur=i,t.rep_nb=-1,t.beam_st=!0,set_width(t),t.seqst&&(t.space=set_space(t)),t.head=C.SQUARE,t=e;t&&(t.st!=c||t.v!=l||!t.dur);t=t.ts_next);}}else{for(n=o,e=t.prev.prev;e&&(e.type!=C.BAR&&e.time!=tsfirst.time||!(--n<=0));e=e.prev);if(!e)return void error(1,t,errs.not_enough_m);for(i=t.time-e.time,n=1==o?s:o,e=t;e&&!(e.type==C.BAR&&--n<=0);e=e.next);if(!e)return void error(1,t,errs.not_enough_m);if(n=s,2==o&&n>1){if(!(e=e.next))return void error(1,t,errs.not_enough_m);e.repeat_n=o,e.repeat_k=--n}if(i/=o,2==o){for(r=t,e=t.ts_next;;e=e.ts_next)if(e.st==c){if(e.v==l&&e.type==C.BAR)break;unlksym(e)}for(to_rest(r),r.dur=r.notes[0].dur=i,r.invis=!0,r.seqst&&(r.space=set_space(r)),e.bar_mrep=2,e.seqst&&(e.space=set_space(e)),r=e.next,e=r.ts_next;;e=e.ts_next)if(e.st==c){if(e.v==l&&e.type==C.BAR)break;unlksym(e)}return to_rest(r),r.dur=r.notes[0].dur=i,r.invis=!0,set_width(r),r.seqst&&(r.space=set_space(r)),void(e.seqst&&(e.space=set_space(e)))}for(r=t,a=s;--a>=0;){for(e=r.ts_next;;e=e.ts_next)if(e.st==c){if(e.v==l&&e.type==C.BAR)break;unlksym(e)}if(to_rest(r),r.dur=r.notes[0].dur=i,r.beam_st=!0,r.seqst&&(r.space=set_space(r)),e.seqst&&(e.space=set_space(e)),1==s){r.rep_nb=1;break}r.rep_nb=s-a+1,r=e.next}}}function custos_add(t){for(var e,r,n,a=t;;){if(a.type==C.NOTE)break;if(!(a=a.next))return}for(e=t.p_v,e.last_sym=t.prev,e.time=t.time,r=sym_add(e,C.CUSTOS),r.next=t,t.prev=r,lktsym(r,t),r.seqst=!0,r.shrink=t.shrink,r.shrink<12&&(r.shrink=12),r.space=a.space,r.wl=0,r.wr=4,r.nhd=a.nhd,r.notes=[],n=0;n<t.notes.length;n++)r.notes[n]={pit:a.notes[n].pit,shhd:0,dur:C.BLEN/4};r.stemless=!0}function set_nl(t){function e(t){cfmt.custos&&1==voice_tb.length&&custos_add(t);for(var e=t.ts_next;e;e=e.ts_next)if(e.seqst){t.nl=!0;break}}function r(t){if(!t.next)return e(t),t;for(t=t.ts_next;t;t=t.ts_next)if(t.seqst){e(t);break}return t}var n;if(t.eoln&&!cfmt.keywarn&&!cfmt.timewarn)return r(t);switch(t.type){case C.CLEF:case C.BAR:case C.STAVES:break;case C.KEY:if(cfmt.keywarn&&!t.k_none)break;return r(t);case C.METER:if(cfmt.timewarn)break;return r(t);case C.GRACE:if(!(t=t.next))return t;default:return r(t)}for(;t;t=t.ts_prev)if(t.seqst){switch(t.type){case C.KEY:case C.CLEF:case C.METER:continue}break}for(n=0;;t=t.ts_next){if(!t)return t;if(t.seqst){if(n<0)break;switch(t.type){case C.STAVES:if(t.ts_prev&&t.ts_prev.type==C.BAR)break;for(;t.ts_next&&(0==w_tb[t.ts_next.type]||t.ts_next.type==C.CLEF);)t=t.ts_next;if(!t.ts_next||t.ts_next.type!=C.BAR)continue;t=t.ts_next;case C.BAR:if(n)break;n=1;continue;case C.STBRK:t.stbrk_forced?n=-1:unlksym(t);continue;case C.METER:if(!cfmt.timewarn)break;continue;case C.CLEF:if(n)break;continue;case C.KEY:if(!cfmt.keywarn||t.k_none)break;continue;default:if(!n||t.prev&&t.prev.type==C.GRACE)continue}break}}return e(t),t}function get_ck_width(){var t=voice_tb[0];return set_width(t.clef),set_width(t.key),set_width(t.meter),[t.clef.wl+t.clef.wr+t.key.wl+t.key.wr,t.meter.wl+t.meter.wr]}function get_width(t,e){var r,n,a=0,i=1-cfmt.maxshrink;do{if(t.seqst&&(r=t.shrink,(n=t.space)<r?a+=r:a+=r*cfmt.maxshrink+n*i,t.x=a),t==e)break;t=t.ts_next}while(t);return a}function set_lines(t,e,r,n){for(var a,i,o,s,c,l,u,f,$,_;e&&!e.eoln;e=e.ts_next);for(f=get_width(t,e)+n;;){if(($=Math.ceil(f/r))<=1)return e&&(e=set_nl(e)),e;for(i=a=t,c=t.x-t.shrink-n,u=c+r,l=c+f/$,c+=f/$*cfmt.breaklimit,t=t.ts_next;t!=e&&!(t.x&&(t.type==C.BAR&&(i=t),t.x>=c));t=t.ts_next);if(t==e)return e&&(e=set_nl(e)),e;for(_=!1,o=null;t!=e;t=t.ts_next)if(s=t.x){if(s>u)break;if(t.type==C.BAR)if(s<l)o=t;else{if(o&&!(t.x<l)){if(o>l)break;if(l-o.x<t.x-l)break;o=t;break}o=t}}if(o&&(t=o,_=!0),!_){var d=0,p=i.time;for(u-=8,t=i,o=null;t!=e;t=t.ts_next)if(t.beam_st&&d++,t.beam_end&&d>0&&d--,s=t.x){if(s+t.wr>=u)break;if(!d&&!t.in_tuplet)if((t.time-p)%(C.BLEN/4)!=0){if(o&&!(t.x<l)){if(o>l)break;if(l-o.x<t.x-l)break;o=t;break}o=t}else o=t}o&&(t=o,_=!0)}if(!_){for(o=t=i;t!=e;t=t.ts_next)if(s=t.x){if(!(t.x<l)){if(o>l)break;if(l-o.x<t.x-l)break;o=t;break}o=t}t=o}if(t.nl)for(error(0,t,"Line split problem - adjust maxshrink and/or breaklimit"),$=2,t=t.ts_next;t!=e&&!(t.x&&--$<=0);t=t.ts_next);if(!(t=set_nl(t))||e&&t.time>=e.time)break;f-=t.x-a.x,n=0}return t}function cut_tune(t,e){var r,n,a,i,o,r=tsfirst;if(0!=e&&(i=set_indent(),t-=i,e-=i),i=get_ck_width(),t-=i[0],e+=i[1],cfmt.custos&&1==voice_tb.length&&(t-=12),cfmt.barsperstaff)for(i=cfmt.barsperstaff,n=r;n;n=n.ts_next)n.type!=C.BAR||!n.bar_num||--i>0||(n.eoln=!0,i=cfmt.barsperstaff);for(o=e,n=r;r;r=r.ts_next)if(r.seqst||r.eoln){if((o+=r.shrink)>t)n=set_lines(n,r,t,e);else{if(!r.eoln)continue;if(delete r.eoln,r.dur){for(a=r.ts_next;a&&!(a.seqst||a.dur<r.dur);a=a.ts_next);n=a&&!a.seqst?set_lines(n,r,t,e):set_nl(r)}else n=set_nl(r)}if(!n)break;n.ts_prev?(o=n.shrink,r=n.ts_prev,e=0):delete n.nl}}function set_yval(t){switch(t.type){case C.CLEF:if(t.second||t.invis){t.ymx=t.ymn=12;break}switch(t.y=6*(t.clef_line-1),t.clef_type){default:t.ymx=t.y+28,t.ymn=t.y-14;break;case"c":t.ymx=t.y+13,t.ymn=t.y-11;break;case"b":t.ymx=t.y+7,t.ymn=t.y-12}t.clef_small&&(t.ymx-=2,t.ymn+=2),t.ymx<26&&(t.ymx=26),t.ymn>-1&&(t.ymn=-1),t.clef_octave&&(t.clef_octave>0?t.ymx+=12:t.ymn-=12);break;case C.KEY:t.k_sf>2?t.ymx=34:t.k_sf>0?t.ymx=30:t.ymx=26,t.ymn=-2;break;default:t.ymx=26,t.ymn=-2}}function set_auto_clef(t,e,r){var n,a,i,o,s,c;for(i=12,a=20,n=e;n&&(n.type!=C.STAVES||n==e);n=n.ts_next)if(n.st==t)if(n.type==C.NOTE)n.notes[0].pit<a?a=n.notes[0].pit:n.notes[n.nhd].pit>i&&(i=n.notes[n.nhd].pit);else if(n.type==C.CLEF){if("a"!=n.clef_type)break;unlksym(n)}if(a>=19||a>=13&&"b"!=r)return"t";if(i<=13||i<=19&&"t"!=r)return"b";"a"==r&&(r=(i+a)/2>=16?"t":"b");var l=r,u=n,f=null;for(n=e;n!=u&&(n.type!=C.STAVES||n==e);n=n.ts_next)if(n.st==t&&n.type==C.NOTE){if(o=n.time,"t"==l){if(n.notes[0].pit>12||n.notes[n.nhd].pit>20){n.notes[0].pit>20&&(f=n);continue}if((s=n.ts_prev)&&s.time==o&&s.st==t&&s.type==C.NOTE&&s.notes[0].pit>=19)continue;if((s=n.ts_next)&&s.st==t&&s.time==o&&s.type==C.NOTE&&s.notes[0].pit>=19)continue}else{if(n.notes[0].pit<12||n.notes[n.nhd].pit<20){n.notes[n.nhd].pit<12&&(f=n);continue}if((s=n.ts_prev)&&s.time==o&&s.st==t&&s.type==C.NOTE&&s.notes[0].pit<=13)continue;if((s=n.ts_next)&&s.st==t&&s.time==o&&s.type==C.NOTE&&s.notes[0].pit<=13)continue}if(f){for(c=n,s=n.ts_prev;s!=f;s=s.ts_prev)if(s.st==t){if(s.type==C.BAR&&s.v==n.v){c=s;break}s.type==C.NOTE&&s.beam_st&&!s.p_v.second&&(c=s)}c.time!=f.time?(f=n,l="t"==l?"b":"t",s=insert_clef(c,l,"t"==l?2:4),s.clef_auto=!0):f=n}else l=r="t"==l?"b":"t",f=n}return r}function set_clefs(){var t,e,r,n,a,i,o,s,c,l=new Array(nstaff),u=cur_sy,f=[];for(staff_tb=new Array(nstaff),r=0;r<=nstaff;r++)l[r]={autoclef:!0},staff_tb[r]={output:"",sc_out:""};for(n=0;n<voice_tb.length;n++)a=voice_tb[n],u.voices[n].range<0||(r=u.voices[n].st,u.voices[n].second||(void 0!=a.staffnonote&&(u.staves[r].staffnonote=a.staffnonote),a.staffscale&&(u.staves[r].staffscale=a.staffscale),u.voices[n].sep&&(u.staves[r].sep=u.voices[n].sep),u.voices[n].maxsep&&(u.staves[r].maxsep=u.voices[n].maxsep)),u.voices[n].second||a.clef.clef_auto||(l[r].autoclef=!1));for(n=0;n<voice_tb.length;n++)a=voice_tb[n],u.voices[n].range<0||u.voices[n].second||(r=u.voices[n].st,t=a.clef,l[r].autoclef&&(t.clef_type=set_auto_clef(r,tsfirst,t.clef_type),t.clef_line="t"==t.clef_type?2:4),l[r].clef=staff_tb[r].clef=t);for(r=0;r<=u.nstaff;r++)f[r]=3*(u.staves[r].stafflines.length-1);for(t=tsfirst;t;t=t.ts_next){switch(t.repeat_n&&set_repeat(t),t.type){case C.STAVES:for(u=t.sy,r=0;r<=nstaff;r++)l[r].autoclef=!0;for(n=0;n<voice_tb.length;n++)u.voices[n].range<0||(a=voice_tb[n],r=u.voices[n].st,u.voices[n].second||(void 0!=a.staffnonote&&(u.staves[r].staffnonote=a.staffnonote),a.staffscale&&(u.staves[r].staffscale=a.staffscale),u.voices[n].sep&&(u.staves[r].sep=u.voices[n].sep),u.voices[n].maxsep&&(u.staves[r].maxsep=u.voices[n].maxsep)),e=a.clef,e.clef_auto||(l[r].autoclef=!1));for(r=0;r<=u.nstaff;r++)f[r]=3*(u.staves[r].stafflines.length-1);for(n=0;n<voice_tb.length;n++)if(!(u.voices[n].range<0||u.voices[n].second))if(a=voice_tb[n],r=u.voices[n].st,e=a.clef,e.clef_auto?(o=set_auto_clef(r,t,l[r].clef?l[r].clef.clef_type:"a"),s="t"==o?2:4):(o=e.clef_type,s=e.clef_line),l[r].clef){if(o!=l[r].clef.clef_type||s!=l[r].clef.clef_line){for(i=t.ts_next;i&&(i.v!=n||i.st!=r);)i=i.ts_next;i&&(i.type!=C.CLEF&&(i=insert_clef(i,o,s),e.clef_auto&&(i.clef_auto=!0)),l[r].clef=a.clef=i)}}else e.clef_auto&&("a"!=e.type&&(a.clef=clone(a.clef)),a.clef.clef_type=o,a.clef.clef_line=s),staff_tb[r].clef=l[r].clef=a.clef;continue;default:t.mid=f[t.st];continue;case C.CLEF:}if("a"==t.clef_type&&(t.clef_type=set_auto_clef(t.st,t.ts_next,l[t.st].clef.clef_type),t.clef_line="t"==t.clef_type?2:4),a=t.p_v,a.clef=t,t.second)unlksym(t);else{if(r=t.st,l[r].clef){if(t.clef_type==l[r].clef.clef_type&&t.clef_line==l[r].clef.clef_line)continue}else staff_tb[r].clef=t;l[r].clef=t}}for(u=cur_sy,n=0;n<voice_tb.length;n++)if(!(u.voices[n].range<0)&&(e=voice_tb[n].sym)&&127==e.notes[0].pit){switch(r=u.voices[n].st,staff_tb[r].clef.clef_type){default:c=22;break;case"c":c=16;break;case"b":c=10}for(t=e;t;t=t.next)t.notes[0].pit=c}}function set_pitch(t){var e,r,n,a,i,o,s=C.BLEN,c=new Array(nstaff);for(n=0;n<=nstaff;n++)e=staff_tb[n].clef,c[n]=delta_tb[e.clef_type]+2*e.clef_line,e.clefpit&&(c[n]+=e.clefpit),cfmt.sound?e.clef_octave&&!e.clef_oct_transp&&(c[n]+=e.clef_octave):e.clef_oct_transp&&(c[n]-=e.clef_octave);for(e=tsfirst;e!=t;e=e.ts_next)switch(n=e.st,e.type){case C.CLEF:c[n]=delta_tb[e.clef_type]+2*e.clef_line,e.clefpit&&(c[n]+=e.clefpit),cfmt.sound?e.clef_octave&&!e.clef_oct_transp&&(c[n]+=e.clef_octave):e.clef_oct_transp&&(c[n]-=e.clef_octave),set_yval(e);break;case C.GRACE:for(r=e.extra;r;r=r.next){if(0!=(a=c[r.st])&&!e.p_v.key.k_drum)for(i=0;i<=r.nhd;i++)o=r.notes[i],o.pit+=a;r.ymn=3*(r.notes[0].pit-18)-2,r.ymx=3*(r.notes[r.nhd].pit-18)+2}set_yval(e);break;case C.KEY:e.k_y_clef=c[n];default:set_yval(e);break;case C.MREST:if(e.invis)break;e.y=12,e.ymx=39,e.ymn=-2;break;case C.REST:if(1==voice_tb.length){e.y=12,e.ymx=24,e.ymn=0;break}case C.NOTE:if(0!=(a=c[n])&&!e.p_v.key.k_drum)for(i=e.nhd;i>=0;i--)e.notes[i].pit+=a;e.type==C.NOTE?(e.ymx=3*(e.notes[e.nhd].pit-18)+4,e.ymn=3*(e.notes[0].pit-18)-4):(e.y=6*((e.notes[0].pit-18)/2|0),e.ymx=e.y+rest_sp[5-e.nflags][0],e.ymn=e.y-rest_sp[5-e.nflags][1]),e.dur<s&&(s=e.dur)}t||(smallest_duration=s)}function set_stem_dir(){for(var t,e,r,n,a,i,o,s,c,l,u=[],f=tsfirst,$=cur_sy,_=$.nstaff;f;){for(n=0;n<=_;n++)u[n]=[];for(l=[],e=f;e&&e.type!=C.BAR;e=e.ts_next)if(e.type!=C.STAVES){if(!(e.type!=C.NOTE&&e.type!=C.REST||e.invis)){if((n=e.st)>_){var d="*** fatal set_stem_dir(): bad staff number "+n+" max "+_;throw error(2,null,d),new Error(d)}for(i=e.v,o=l[i],o||(o={st1:-1,st2:-1},l[i]=o),o.st1<0?o.st1=n:o.st1!=n&&(n>o.st1?n>o.st2&&(o.st2=n):(o.st1>o.st2&&(o.st2=o.st1),o.st1=n)),s=u[n],a=$.voices[i].range,r=s.length;--r>=0&&(c=s[r],c.v!=a););if(r<0){for(c={v:a,ymx:0,ymn:24},r=0;r<s.length;r++)if(a<s[r].v){s.splice(r,0,c);break}r==s.length&&s.push(c)}e.type==C.NOTE&&(e.ymx>c.ymx&&(c.ymx=e.ymx),e.ymn<c.ymn&&(c.ymn=e.ymn),e.xstem&&(e.ts_prev.st!=n-1||e.ts_prev.type!=C.NOTE?(error(1,f,"Bad !xstem!"),e.xstem=!1):(e.ts_prev.multi=1,e.multi=1,e.stemless=!0)))}}else{if(e!=f)break;for($=f.sy,n=_;n<=$.nstaff;n++)u[n]=[];_=$.nstaff}for(;f!=e;f=f.ts_next)if(!f.multi){switch(f.type){default:continue;case C.REST:if(void 0!=f.combine&&f.combine<0||!f.ts_next||f.ts_next.type!=C.REST||f.ts_next.st!=f.st||f.time!=f.ts_next.time||f.dur!=f.ts_next.dur||f.invis)break;unlksym(f.ts_next);break;case C.NOTE:case C.GRACE:}if(n=f.st,i=f.v,o=l[i],s=u[n],o&&o.st2>=0)n==o.st1?f.multi=-1:n==o.st2&&(f.multi=1);else if(s.length<=1)f.floating&&(f.multi=n==voice_tb[i].st?-1:1);else{for(a=$.voices[i].range,r=s.length;--r>=0&&s[r].v!=a;);r<0||(r==s.length-1?f.multi=-1:(f.multi=1,0!=r&&r+2==s.length&&(s[r].ymn-cfmt.stemheight>s[r+1].ymx&&(f.multi=-1),t=f.ts_next,f.ts_prev&&f.ts_prev.time==f.time&&f.ts_prev.st==f.st&&f.notes[f.nhd].pit==f.ts_prev.notes[0].pit&&f.beam_st&&f.beam_end&&(!t||t.st!=f.st||t.time!=f.time)&&(f.multi=-1))))}}for(;f&&f.type==C.BAR;)f=f.ts_next}}function set_rest_offset(){var t,e,r,n,a,i,o,s,c,l,u,f=[],$=cur_sy;for(t=tsfirst;t;t=t.ts_next)if(!t.invis&&(t.type==C.STAVES&&($=t.sy),t.dur&&(i=f[t.v],i||(i={},f[t.v]=i),i.s=t,i.st=t.st,i.end_time=t.time+t.dur,t.type==C.REST))){for(s=-127,o=127,a=l=!1,r=0;r<=f.length;r++)(i=f[r])&&i.s&&i.st==t.st&&r!=t.v&&(i.end_time<=t.time||(a=!0,e=i.s,$.voices[r].range<$.voices[t.v].range?e.time==t.time?e.ymn<o&&(o=e.ymn,e.dots&&(l=!0)):e.y<o&&(o=e.y):e.time==t.time?e.ymx>s&&(s=e.ymx,e.dots&&(l=!0)):e.y>s&&(s=e.y)));for(n=t.time+t.dur,e=t.ts_next;e&&!(e.time>=n);e=e.ts_next)e.st==t.st&&e.dur&&!e.invis&&(a=!0,$.voices[e.v].range<$.voices[t.v].range?e.time==t.time?e.ymn<o&&(o=e.ymn,e.dots&&(l=!0)):e.y<o&&(o=e.y):e.time==t.time?e.ymx>s&&(s=e.ymx,e.dots&&(l=!0)):e.y>s&&(s=e.y));if(a)if(127==o&&t.y<12&&(c=12-t.y,t.y+=c,t.ymx+=c,t.ymn+=c),-127==s&&t.y>12&&(c=t.y-12,t.y-=c,t.ymx-=c,t.ymn-=c),(c=o-t.ymx)<0){if(c=6*Math.ceil(-c/6),t.ymn-c>=s){t.y-=c,t.ymx-=c,t.ymn-=c;continue}u=l?15:10,t.notes[0].shhd=u,t.xmx=u}else if((c=s-t.ymn)>0){if(c=6*Math.ceil(c/6),t.ymx+c<=o){t.y+=c,t.ymx+=c,t.ymn+=c;continue}u=l?15:10,t.notes[0].shhd=u,t.xmx=u}else;else t.y=12,t.ymx=24,t.ymn=0}}function new_sym(t,e,r){var n={type:t,fname:r.fname,v:e.v,p_v:e,st:e.st,time:r.time,next:e.last_sym.next};return n.next&&(n.next.prev=n),e.last_sym.next=n,n.prev=e.last_sym,e.last_sym=n,lktsym(n,r),n.ts_prev.type!=t&&(n.seqst=!0),r.type==t&&n.v!=r.v&&(delete r.seqst,r.shrink=0),n}function init_music_line(){var t,e,r,n,a,i,o=voice_tb.length;for(a=0;a<o;a++)if(!(cur_sy.voices[a].range<0)){for(t=voice_tb[a],t.second=cur_sy.voices[a].second,t.last_sym=t.sym,i=cur_sy.voices[a].st;i<nstaff&&!cur_sy.st_print[i];)i++;t.st=i}for(n=tsfirst;n.type==C.CLEF;)a=n.v,cur_sy.voices[a].range>=0&&!cur_sy.voices[a].second&&(delete n.clef_small,t=n.p_v,t.last_sym=t.sym=n),n=n.ts_next;for(a=0;a<o;a++)t=voice_tb[a],t.sym&&t.sym.type==C.CLEF||cur_sy.voices[a].range<0||cur_sy.voices[a].second&&!t.bar_start||(i=cur_sy.voices[a].st,staff_tb[i]&&staff_tb[i].clef&&(e=clone(staff_tb[i].clef),e.v=a,e.p_v=t,e.st=i,e.time=tsfirst.time,e.prev=null,e.next=t.sym,e.next&&(e.next.prev=e),t.sym=e,t.last_sym=e,e.ts_next=n,e.ts_prev=n?n.ts_prev:null,e.ts_prev?(e.ts_prev.ts_next=e,delete e.seqst):(tsfirst=e,e.seqst=!0),n&&(n.ts_prev=e,n.type==C.CLEF&&delete n.seqst),delete e.clef_small,e.second=cur_sy.voices[a].second,cur_sy.st_print[i]||(e.invis=!0)));for(a=0;a<o;a++)cur_sy.voices[a].range<0||cur_sy.voices[a].second||!cur_sy.st_print[cur_sy.voices[a].st]||(t=voice_tb[a],n&&n.v==a&&n.type==C.KEY?(t.last_sym=n,n.k_old_sf=n.k_sf,n=n.ts_next):(r=t.key,(r.k_sf||r.k_a_acc)&&(e=new_sym(C.KEY,t,n),e.k_sf=r.k_sf,e.k_old_sf=r.k_sf,e.k_none=r.k_none,e.k_a_acc=r.k_a_acc,e.istart=r.istart,e.iend=r.iend,r.k_bagpipe&&(e.k_bagpipe=r.k_bagpipe,"p"==e.k_bagpipe&&(e.k_old_sf=3)))));if(1&insert_meter){for(a=0;a<o;a++)t=voice_tb[a],r=t.meter,cur_sy.voices[a].range<0||cur_sy.voices[a].second||!cur_sy.st_print[cur_sy.voices[a].st]||0==r.a_meter.length||(n&&n.v==a&&n.type==C.METER?(t.last_sym=n,n=n.ts_next):(e=new_sym(C.METER,t,n),e.istart=r.istart,e.iend=r.iend,e.wmeasure=r.wmeasure,e.a_meter=r.a_meter));insert_meter&=-2}for(a=0;a<o;a++)t=voice_tb[a],n&&n.v==a&&n.type==C.BAR?(t.last_sym=n,n=n.ts_next):(r=t.bar_start)&&(t.bar_start=null,cur_sy.voices[a].range<0||!cur_sy.st_print[cur_sy.voices[a].st]||(r.next=t.last_sym.next,r.next&&(r.next.prev=r),t.last_sym.next=r,r.prev=t.last_sym,t.last_sym=r,lktsym(r,n),r.time=tsfirst.time,r.ts_prev.type!=r.type&&(r.seqst=!0),n&&n.type==r.type&&r.v!=n.v&&(delete n.seqst,n.shrink=0)));for(set_pitch(n),e=n;e;e=e.ts_next)if(e.seqst){for(e=e.ts_next;e&&!e.seqst;e=e.ts_next);break}set_allsymwidth(e)}function set_words(t){var e,r,n,a,i=!0,o=127;for(e=t.sym;e;e=e.next)if(e.type==C.NOTE){o=e.notes[0].pit;break}for(e=t.sym;e;e=e.next){switch(e.type){case C.MREST:i=!0;break;case C.BAR:e.beam_on||(i=!0),!e.next&&e.prev&&e.prev.head==C.OVALBARS&&(e.prev.head=C.SQUARE);break;case C.NOTE:case C.REST:if(e.trem2)break;n=e.nflags,e.ntrem&&(n+=e.ntrem),e.type==C.REST&&e.beam_end&&(e.beam_end=!1,i=!0),(i||n<=0)&&(a&&(a.beam_end=!0,a=null),n<=0?(e.beam_st=!0,e.beam_end=!0):e.type==C.NOTE&&(e.beam_st=!0,i=!1)),e.beam_end&&(i=!0),e.type==C.NOTE&&(a=e)}if(e.type==C.NOTE)for(0!=e.nhd&&sort_pitch(e),o=e.notes[0].pit,r=e.prev;r&&r.type==C.REST;r=r.prev)r.notes[0].pit=o;else e.notes||(e.notes=[],e.notes[0]={},e.nhd=0),e.notes[0].pit=o}a&&(a.beam_end=!0)}function set_rb(t){for(var e,r,n,a=t.sym;a;)if(a.type==C.BAR&&a.rbstart&&!a.norepbra){if(r=cfmt.rbmax,a.text&&"1"==a.text[0]){for(n=0,e=null,a=a.next;a;a=a.next)if(a.type==C.BAR){if(n++,a.rbstop){n<=cfmt.rbmax&&(r=n,e=null);break}n==cfmt.rbmin&&(e=a)}e&&(e.rbstop=1,r=cfmt.rbmin)}for(;a;){if(2!=a.rbstart){if(!(a=a.next))break;if(2!=a.rbstart){if(!(a=a.next))break;if(2!=a.rbstart)break}}for(n=0,e=null,a=a.next;a;a=a.next)if(a.type==C.BAR){if(n++,a.rbstop)break;a.next?n==r&&(a.rbstop=1):a.rbstop=2}}}else a=a.next}function set_global(){var t,e,r,n,a;for(a=cur_sy,e=a.nstaff;;){if(!(a=a.next))break;a.nstaff>e&&(e=a.nstaff)}for(nstaff=e,n=voice_tb.length,r=0;r<n;r++)t=voice_tb[r],set_words(t),set_rb(t);set_float(),set_clefs(),set_pitch(null)}function set_indent(t){var e,r,n,a,i,o,s,c,l=voice_tb.length,u=0;for(r=0;r<l;r++)if(a=voice_tb[r],!(cur_sy.voices[r].range<0)&&(e=cur_sy.voices[r].st,i=(t||a.new_name)&&a.nm?a.nm:a.snm))for(c||(c=get_font("voice"),set_font(c)),o=0;;){if(s=i.indexOf("\\n",o),n=strwh(s<0?i.slice(o):i.slice(o,s)),n=n[0],n>u&&(u=n),s<0)break;o=s+1}for(c&&(u+=4*cwid(" ")*c.swfac),n=.5,e=0;e<=cur_sy.nstaff;e++){if(cur_sy.staves[e].flags&(OPEN_BRACE2|OPEN_BRACKET2)){n=12;break}cur_sy.staves[e].flags&(OPEN_BRACE|OPEN_BRACKET)&&(n=6)}return u+=n,t&&(u+=cfmt.indent),u}function set_beams(t){var e,r,n,a,i,o,s,c,l,u=-1;for(e=t;e;e=e.next)if(e.type==C.NOTE){if(e.stem||0!=(e.stem=e.multi))e.beam_st&&!e.beam_end&&(n=!0);else if(s=e.mid/3+18,n)e.stem=u;else if(e.beam_st&&!e.beam_end){for(n=!0,c=e.notes[e.nhd].pit,l=e.notes[0].pit,r=e.next;r;r=r.next)if(r.type==C.NOTE){if(r.stem||r.multi){e.stem=r.stem||r.multi;break}if(r.notes[r.nhd].pit>c&&(c=r.notes[r.nhd].pit),r.notes[0].pit<l&&(l=r.notes[0].pit),r.beam_end)break}r.beam_end&&((c+l)/2<s?e.stem=1:(c+l)/2>s?e.stem=-1:cfmt.bstemdown&&(e.stem=-1)),e.stem||(e.stem=u)}else{if((i=(e.notes[e.nhd].pit+e.notes[0].pit)/2)==s){for(i=0,o=0;o<=e.nhd;o++)i+=e.notes[o].pit;i/=e.nhd+1}i<s?e.stem=1:i>s?e.stem=-1:cfmt.bstemdown?e.stem=-1:e.stem=u}if(e.beam_end&&(n=!1),u=e.stem,a){for(r=a.extra;r;r=r.next)r.stem=-u;a.stem=-u,a=null}}else{if(e.type!=C.GRACE)continue;if(r=e.extra,2==r.stem){a=e;continue}for(e.stem||0!=(e.stem=e.multi)||(e.stem=1);r;r=r.next)r.stem=e.stem,r.multi=e.multi}}function same_head(t,e){var r,n,a,i,o,s,c,l,u,f,$;if(t.shiftunison&&t.shiftunison>=3)return!1;if((a=t.dur)>=C.BLEN)return!1;if((i=e.dur)>=C.BLEN)return!1;if(t.stemless&&e.stemless)return!1;if(t.dots!=e.dots&&(t.shiftunison&&1&t.shiftunison||t.dots*e.dots!=0))return!1;if(t.stem*e.stem>0)return!1;if(r=n=0,t.notes[0].pit>e.notes[0].pit){if(t.stem<0)return!1;for(;e.notes[n].pit!=t.notes[0].pit;)if(++n>e.nhd)return!1}else if(t.notes[0].pit<e.notes[0].pit){if(e.stem<0)return!1;for(;e.notes[0].pit!=t.notes[r].pit;)if(++r>t.nhd)return!1}if(e.notes[n].acc!=t.notes[r].acc)return!1;s=r,l=n,f=t.notes[r].shhd,$=e.notes[n].shhd;do{if(r++,n++,r>t.nhd)break;if(n>e.nhd)break;if(e.notes[n].acc!=t.notes[r].acc)return!1;f<t.notes[r].shhd&&(f=t.notes[r].shhd),$<e.notes[n].shhd&&($=e.notes[n].shhd)}while(e.notes[n].pit==t.notes[r].pit);if(r<=t.nhd){if(n<=e.nhd)return!1;if(e.stem>0)return!1}else if(n<=e.nhd&&t.stem>0)return!1;if(c=r,u=n,o=0,a!=i)if(a<i&&(a=i,i=t.dur),a<C.BLEN/2)e.dots>0?o=2:t.dots>0&&(o=1);else{if(!(i<C.BLEN/4))return!1;if(t.shiftunison&&2&t.shiftunison)return!1;o=e.dur>=C.BLEN/2?2:1}if(0==o&&(o=t.p_v.scale<e.p_v.scale?2:1),1==o){for(n=l;n<u;n++)e.notes[n].invis=!0,delete e.notes[n].acc;for(n=0;n<=e.nhd;n++)e.notes[n].shhd+=f}else{for(r=s;r<c;r++)t.notes[r].invis=!0,delete t.notes[r].acc;for(r=0;r<=t.nhd;r++)t.notes[r].shhd+=$}return!0}function unison_acc(t,e,r,n){var a,i;if(e.notes[n].acc){for(i=2*w_note[t.head]+t.xmx+e.notes[n].shac+2,e.notes[n].micro&&(i+=2),t.dots&&(i+=6),a=0;a<=e.nhd;a++)e.notes[a].shhd+=i,e.notes[a].shac-=i;e.xmx+=i}else{for(i=2*w_note[e.head]+e.xmx+t.notes[r].shac+2,t.notes[r].micro&&(i+=2),e.dots&&(i+=6),a=0;a<=t.nhd;a++)t.notes[a].shhd+=i,t.notes[a].shac-=i;t.xmx+=i}}function set_left(t){var e,r,n,a,i=w_note[t.head],o=i,s=[];for(r=0;r<MAXPIT;r++)s.push(-100);if(t.nflags>-2)for(t.stem>0?(o=-o,r=2*t.notes[0].pit,n=2*(Math.ceil((t.ymx-2)/3)+18)):(r=2*(Math.ceil((t.ymn+2)/3)+18),n=2*t.notes[t.nhd].pit),r<0&&(r=0),n>=MAXPIT&&(n=MAXPIT-1);r<=n;)s[r++]=o;for(a=t.notes[t.stem>0?0:t.nhd].shhd,e=0;e<=t.nhd;e++)o=-t.notes[e].shhd+i+a,r=2*t.notes[e].pit,r<0?r=0:r>=MAXPIT-1&&(r=MAXPIT-2),o>s[r]&&(s[r]=o),t.head!=C.SQUARE&&(o-=1),o>s[r-1]&&(s[r-1]=o),o>s[r+1]&&(s[r+1]=o);return s}function set_right(t){var e,r,n,a,i,o=w_note[t.head],s=o,c=t.nflags>0&&t.beam_st&&t.beam_end,l=[];for(r=0;r<MAXPIT;r++)l.push(-100);if(t.nflags>-2)for(t.stem<0?(s=-s,r=2*(Math.ceil((t.ymn+2)/3)+18),n=2*t.notes[t.nhd].pit,a=r+4):(r=2*t.notes[0].pit,n=2*(Math.ceil((t.ymx-2)/3)+18)),r<0&&(r=0),n>MAXPIT&&(n=MAXPIT);r<n;)l[r++]=s;if(c)if(t.stem>0)for(r=0==t.xmx?2*t.notes[t.nhd].pit:2*t.notes[0].pit,r+=4,r<0&&(r=0);r<MAXPIT&&r<=n-4;r++)l[r]=11;else for(r=a,r<0&&(r=0);r<MAXPIT&&r<=2*t.notes[0].pit-4;r++)l[r]=3.5;for(i=t.notes[t.stem>0?0:t.nhd].shhd,e=0;e<=t.nhd;e++)s=t.notes[e].shhd+o-i,r=2*t.notes[e].pit,r<0?r=0:r>=MAXPIT-1&&(r=MAXPIT-2),s>l[r]&&(l[r]=s),t.head!=C.SQUARE&&(s-=1),
s>l[r-1]&&(l[r-1]=s),s>l[r+1]&&(l[r+1]=s);return l}function set_overlap(){var t,e,r,n,a,i,o,s,c,l,u,f,$,_,d,p,h,g,m,v,y,b,w;for(t=tsfirst;t;t=t.ts_next)if(t.type==C.NOTE&&!t.invis){if(t.xstem&&t.ts_prev.stem<0)for(s=0;s<=t.nhd;s++)t.notes[s].shhd-=7,t.notes[s].shac+=16;for(r=t;;){if(!(r=r.ts_next))break;if(r.time!=t.time){r=null;break}if(r.type==C.NOTE&&!r.invis&&r.st==t.st)break}if(r&&(e=t,cur_sy.voices[e.v].range<cur_sy.voices[r.v].range?r.dot_low=!0:e.dot_low=!0,!(e.ymn>r.ymx||e.ymx<r.ymn||same_head(e,r)))){if(g=set_right(e),m=set_left(r),(n=e.ts_prev)&&n.time==e.time&&n.st==e.st&&n.type==C.NOTE&&!n.invis)for(y=set_right(n),a=0;a<MAXPIT;a++)y[a]>g[a]&&(g[a]=y[a]);else n=null;for(f=-10,a=0;a<MAXPIT;a++)m[a]+g[a]>f&&(f=m[a]+g[a]);if(!(f<-3&&(!e.dots||!r.dots||!r.dot_low||e.stem>0||r.stem<0||e.notes[e.nhd].pit+2!=r.notes[0].pit||1&r.notes[0].pit))){if(v=set_right(r),h=set_left(e),n)for(y=set_left(n),a=0;a<MAXPIT;a++)y[a]>h[a]&&(h[a]=y[a]);for($=_=d=-100,a=0;a<MAXPIT;a++)h[a]+v[a]>$&&($=h[a]+v[a]),v[a]>d&&(d=v[a]),g[a]>_&&(_=g[a]);for(l=0,i=e.nhd,o=r.nhd;;){switch(u=e.notes[i].pit-r.notes[o].pit){case 0:if(e.notes[i].acc!=r.notes[o].acc){l=-1;break}r.notes[o].acc&&(r.notes[o].acc=0),e.dots&&r.dots&&1&e.notes[i].pit&&(l=1);break;case-1:e.dots&&r.dots&&(1&e.notes[i].pit?(e.dot_low=!1,r.dot_low=!1):(e.dot_low=!0,r.dot_low=!0));break;case-2:if(e.dots&&r.dots&&!(1&e.notes[i].pit)){e.dot_low=!1,r.dot_low=!1;break}}if(l<0)break;if(u>=0&&--i<0)break;if(u<=0&&--o<0)break}if(l<0)unison_acc(e,r,i,o);else{if(c=0,e.dots?r.dots&&(l||(c=1)):r.dots&&$+_<f+d&&(c=1),b=m,w=v,!n&&$+_<f+d&&function(){e=r,r=t,f=$,b=h,w=g,d=_}(),f+=3,f<0&&(f=0),s=e.stem>=0?0:e.nhd,f+=e.notes[s].shhd,s=r.stem>=0?0:r.nhd,f-=r.notes[s].shhd,e.dots)if(p=7.7+e.xmx+3.5*e.dots-3.5+3,c){if(p<f+d+r.xmx){for($=0,i=0;i<=e.nhd;i++)a=e.notes[i].pit,1&a||(e.dot_low?a--:a++),a*=2,a<1?a=1:a>=MAXPIT-1&&(a=MAXPIT-2),w[a]>$&&($=w[a]),w[a-1]+1>$&&($=w[a-1]=1),w[a+1]+1>$&&($=w[a+1]+1);$>4.5&&7.7+e.xmx+2<f+$+r.xmx&&(r.xmx=$+3-7.7)}}else{for($=-100,i=0;i<=e.nhd;i++)a=e.notes[i].pit,1&a||(e.dot_low?a--:a++),a*=2,a<1?a=1:a>=MAXPIT-1&&(a=MAXPIT-2),b[a]>$&&($=b[a]),b[a-1]+1>$&&($=b[a-1]+1),b[a+1]+1>$&&($=b[a+1]+1);p+$+2>f&&(f=p+$+2)}for(s=r.nhd;s>=0;s--)r.notes[s].shhd+=f;r.xmx+=f,c&&(e.xmx=r.xmx)}}}}}function set_stems(){var t,e,r,n,a,i,o,s,c,l;for(t=tsfirst;t;t=t.ts_next)if(t.type==C.NOTE){if(set_head_shift(t),s=t.nflags,t.beam_st&&!t.beam_end){for(t.feathered_beam&&(s=++t.nflags),e=t.next;e.type!=C.NOTE||(t.feathered_beam&&e.nflags++,!e.beam_end);e=e.next);e.nflags>s&&(s=e.nflags)}else if(!t.beam_st&&t.beam_end){for(e=t.prev;!e.beam_st;e=e.prev);e.nflags>s&&(s=e.nflags)}switch(n=cfmt.stemheight,s){case 2:n+=2;break;case 3:n+=5;break;case 4:n+=10;break;case 5:n+=16}1!=(a=t.p_v.scale)&&(n*=.5*(a+1)),i=3*(t.notes[0].pit-18),t.nhd>0?(n-=2,o=3*(t.notes[t.nhd].pit-18)):o=i,t.ntrem&&(n+=2*t.ntrem),t.stemless?(t.stem>=0?(t.y=i,t.ys=o):(t.ys=i,t.y=o),-4==s&&(i-=6),t.ymx=o+4,t.ymn=i-4):t.stem>=0?(s>=2&&(n-=1),t.notes[t.nhd].pit>26&&(s<=0||!t.beam_st||!t.beam_end)&&(n-=2,t.notes[t.nhd].pit>28&&(n-=2)),t.y=i,t.notes[0].ti1&&(i-=3),t.ymn=i-4,t.ys=o+n,t.ys<t.mid&&(t.ys=t.mid),t.ymx=t.ys+2.5|0):(t.notes[0].pit<18&&(s<=0||!t.beam_st||!t.beam_end)&&(n-=2,t.notes[0].pit<16&&(n-=2)),t.ys=i-n,t.ys>t.mid&&(t.ys=t.mid),t.ymn=t.ys-2.5|0,t.y=o,t.notes[t.nhd].ti1&&(o+=3),t.ymx=o+4)}else{if(t.type!=C.GRACE)continue;for(c=l=t.mid,r=t.extra;r;r=r.next)n=GSTEM,r.nflags>1&&(n+=1.2*(r.nflags-1)),i=3*(r.notes[0].pit-18),o=3*(r.notes[r.nhd].pit-18),t.stem>=0?(r.y=i,r.ys=o+n,o=Math.round(r.ys)):(r.y=o,r.ys=i-n,i=Math.round(r.ys)),o+=2,i-=2,i<c?c=i:o>l&&(l=o),r.ymx=o,r.ymn=i;t.ymx=l,t.ymn=c}}function check_bar(t){for(var e,r,n=t.p_v;t.type==C.CLEF||t.type==C.KEY||t.type==C.METER;)if(t.type==C.METER&&t.time>n.sym.time&&(insert_meter|=1),!(t=t.prev))return;if(t.type==C.BAR&&(void 0!=t.text&&(n.bar_start=clone(t),n.bar_start.bar_type="[",delete t.text,delete t.a_gch),":"!=(e=t.bar_type)&&":"==e.slice(-1))){if(n.bar_start||(n.bar_start=clone(t)),":"!=e[0])return"||:"==e?(n.bar_start.bar_type="|:",void(t.bar_type="||")):(n.bar_start.bar_type=e,void(t.prev&&t.prev.type==C.BAR?unlksym(t):t.bar_type="|"));if("::"==e)return n.bar_start.bar_type="|:",void(t.bar_type=":|");if("||:"==e)return n.bar_start.bar_type="|:",void(t.bar_type="||");for(r=0;":"==e[r];)r++;if(r<e.length){for(t.bar_type=e.slice(0,r)+"|",r=e.length-1;":"==e[r];)r--;n.bar_start.bar_type="|"+e.slice(r+1)}else r=e.length/2|0,t.bar_type=e.slice(0,r)+"|",n.bar_start.bar_type="|"+e.slice(r)}}function sym_staff_move(t){for(var e=tsfirst;e&&!e.nl;e=e.ts_next)e.st==t&&e.type!=C.CLEF&&(e.st++,e.invis=!0)}function block_gen(t){switch(t.subtype){case"leftmargin":case"rightmargin":case"pagescale":case"pagewidth":case"scale":case"staffwidth":svg_flush(),set_format(t.subtype,t.param);break;case"ml":svg_flush(),user.img_out(t.text);break;case"newpage":blk_flush(),block.newpage=!0,blk_out();break;case"sep":set_page(),vskip(t.sk1),output+='<path class="stroke"\n\td="M',out_sxsy(t.x," ",0),output+="h"+t.l.toFixed(2)+'"/>\n',vskip(t.sk2);break;case"text":write_text(t.text,t.opt);break;case"title":write_title(t.text,!0);break;case"vskip":vskip(t.sk);break;default:error(2,t,"Block $1 not treated",t.subtype)}}function set_piece(){function t(t){var e=staff_tb[t],r=f.staves[t];e||(e=staff_tb[t]={}),e.y=0,e.stafflines=r.stafflines,e.staffscale=r.staffscale,e.ann_top=e.ann_bot=0}function e(){var t,e,r,n=f.staves.length;for(t=0;t<n;t++)if(f.staves[t].flags&(OPEN_BRACE|OPEN_BRACE2)){for(r=0,e=t;t<n&&(r|=l[t]?1:2,!(f.staves[t].flags&(CLOSE_BRACE|CLOSE_BRACE2)));)t++;if(3==r)for(;e<=t;)l[e]=!0,u[e++]=!0}}var r,n,a,i,o,s,c,l=[],u=[],f=cur_sy;for(nstaff=s=f.nstaff,i=0;i<=s;i++)t(i);for(r=tsfirst;r&&!r.nl;r=r.ts_next){switch(r.ts_next||(n=r),r.type){case C.STAVES:if(e(),f.st_print=new Uint8Array(l),f=r.sy,s=f.nstaff,nstaff<s){for(i=nstaff+1;i<=s;i++)t(i);nstaff=s}l=[];continue;case C.BLOCK:blocks.push(r),unlksym(r),n&&(n=r.ts_prev);continue}if(i=r.st,!l[i])switch(r.type){case C.CLEF:i>nstaff&&(staff_tb[i].clef=r,unlksym(r));break;case C.BAR:if(!f.staves[i].staffnonote||f.staves[i].staffnonote<=1)break;case C.GRACE:u[i]=l[i]=!0;break;case C.NOTE:case C.REST:case C.SPACE:case C.MREST:f.staves[i].staffnonote>1?u[i]=l[i]=!0:r.invis||0==f.staves[i].staffnonote&&r.type!=C.NOTE||(u[i]=l[i]=!0)}}for(tsnext=r,e(),f.st_print=new Uint8Array(l),function(){var t,e,r,n;for(t=0;t<=nstaff;t++)if(e=staff_tb[t],u[t]){for(n=e.stafflines.length,e.topbar=6*(n-1),r=0;r<n-1&&"."==e.stafflines[r];r++);e.botline=e.botbar=6*r,r>=n-2&&("."!=e.stafflines[r]?(e.botbar-=6,e.topbar+=6):(e.botbar-=12,e.topbar+=12))}else e.botbar=e.topbar=0}(),i=0;i<nstaff;i++)u[i]||sym_staff_move(i);if(u[nstaff]||(staff_tb[nstaff].topbar=0),init_music_line(),gene.st_print=new Uint8Array(u),tsnext)for(r=tsnext,delete r.nl,n=r.ts_prev,n.ts_next=null,c=voice_tb.length,o=0;o<c;o++){if(a=voice_tb[o],a.sym&&a.sym.time<=tsnext.time){for(r=tsnext.ts_prev;r;r=r.ts_prev)if(r.v==o){a.s_next=r.next,r.next=null,check_bar(r);break}if(r)continue}a.s_next=a.sym,a.sym=null}n.type!=C.BAR&&(r=add_end_bar(n),r.prev=r.ts_prev=n,n.ts_next=n.next=r,r.shrink=n.wr+2,r.space=set_space(r),r.space<r.shrink&&n.type!=C.KEY&&(r.space=r.shrink))}function set_sym_glue(t){var e,r,n,a,i=0,o=0,s=0,c=0,l=0;for(e=tsfirst;e;e=e.ts_next)e.type!=C.GRACE||n||(n=e),e.seqst&&(i+=e.shrink,e.space?e.space<e.shrink?(l+=e.shrink,o+=e.shrink):o+=e.space:c+=e.shrink);if(0==o)return void(realwidth=0);if(i>=t||o==l){for(i>t&&error(1,e,"Line too much shrunk $1 $2 $3",i.toFixed(2),o.toFixed(2),t.toFixed(2)),s=0,e=tsfirst;e;e=e.ts_next)e.seqst&&(s+=e.shrink),e.x=s;spf_last=0}else if(o+c>t*(1-cfmt.stretchlast)||tsnext&&0==blocks.length&&tsnext.type!=C.BLOCK&&cfmt.stretchstaff){for(var u=4;--u>=0;){for(a=(t-c-l)/(o-l),o=0,l=0,s=0,e=tsfirst;e;e=e.ts_next)e.seqst&&(e.space?e.space*a<=e.shrink?(l+=e.shrink,o+=e.shrink,s+=e.shrink):(o+=e.space,s+=e.space*a):s+=e.shrink),e.x=s;if(Math.abs(s-t)<.1)break}spf_last=a}else for(a=(t-c-l)/o,spf_last<a&&(a=spf_last),e=tsfirst;e;e=e.ts_next)e.seqst&&(s+=e.space*a<=e.shrink?e.shrink:e.space*a),e.x=s;for(realwidth=s,e=n;e;e=e.ts_next)if(e.type==C.GRACE)for(s=e.gr_shift?e.prev.x+e.prev.wr:e.x-e.wl,r=e.extra;r;r=r.next)r.x+=s}function set_sym_line(){var t,e,r,n=voice_tb.length;for(r=0;r<n;r++)t=voice_tb[r],e=t.s_next,t.sym=e,e&&(e.prev=null)}function set_posx(){posx=img.lm/cfmt.scale}function gen_init(){for(var t=tsfirst,e=t.time;t;t=t.ts_next){if(t.time!=e)return void set_page();switch(t.type){case C.NOTE:case C.REST:case C.MREST:return void set_page();default:continue;case C.STAVES:cur_sy=t.sy;break;case C.BLOCK:block_gen(t)}unlksym(t),t.p_v.s_next==t&&(t.p_v.s_next=t.next)}tsfirst=null}function output_music(){var t,e,r,n;if(gen_init(),tsfirst){for(set_global(),voice_tb.length>1&&set_stem_dir(),t=0;t<voice_tb.length;t++)set_beams(voice_tb[t].sym);for(set_stems(),voice_tb.length>1&&(set_rest_offset(),set_overlap()),set_acc_shft(),set_allsymwidth(null),r=set_indent(!0),cfmt.singleline?(t=get_ck_width(),e=r+t[0]+t[1]+get_width(tsfirst,null),img.width=e*cfmt.scale+img.lm+img.rm+2):(e=get_lwidth(),cut_tune(e,r)),spf_last=1.2;;){if(set_piece(),set_sym_glue(e-r),0!=realwidth)for(0!=r&&(posx+=r),draw_sym_near(),n=set_staff(),delayed_update(),draw_systems(r),draw_all_sym(),vskip(n),0!=r&&(posx-=r,insert_meter&=-3);0!=blocks.length;)block_gen(blocks.shift());if(tsfirst=tsnext,svg_flush(),!tsnext)break;if(gen_init(),!tsfirst)break;tsfirst.ts_prev=null,set_sym_line(),e=get_lwidth(),r=set_indent()}}}function reset_gen(){insert_meter=cfmt.writefields.indexOf("M")>=0?3:2}function set_ref(t){t.fname=parse.fname,t.istart=parse.istart,t.iend=parse.iend}function new_clef(t){var e={type:C.CLEF,clef_line:2,clef_type:"t",v:curvoice.v,p_v:curvoice,time:curvoice.time,dur:0},r=1;switch(set_ref(e),t[0]){case'"':r=t.indexOf('"',1),e.clef_name=t.slice(1,r),r++;break;case"a":if("u"==t[1]){e.clef_type="a",e.clef_auto=!0,r=4;break}r=4;case"C":e.clef_type="c",e.clef_line=3;break;case"b":r=4;case"F":e.clef_type="b",e.clef_line=4;break;case"n":r=4,e.invis=!0;break;case"t":if("e"==t[1]){e.clef_type="c",e.clef_line=4;break}r=6;case"G":break;case"p":r=4;case"P":e.clef_type="p",e.clef_line=3,curvoice.key.k_sf=0;break;default:return void syntax(1,"Unknown clef '$1'",t)}if(t[r]>="1"&&t[r]<="9"&&(e.clef_line=Number(t[r]),r++),"8"!=t[r+1])return e;switch(t[r]){case"^":e.clef_oct_transp=!0;case"+":e.clef_octave=7;break;case"_":e.clef_oct_transp=!0;case"-":e.clef_octave=-7}return e}function get_transp(t,e){var r,n,a,i,o=[];if("0"==t[0])return 0;if("123456789-+".indexOf(t[0])>=0){if(n=3*parseInt(t),isNaN(n)||n<-108||n>108)return void syntax(1,"Bad transpose value");switch(t.slice(-1)){default:return n;case"#":n++;break;case"b":n+=2}return n>0?n:n-3}if("instr"==e)if(a=t.indexOf("/"),cfmt.sound)t=a<0?"c"+t:t.replace(/.*\//,"c");else{if(a<0)return 0;t=t.replace("/","")}for(a=new scanBuf,a.buffer=t,r=0;r<2;r++){if(!(i=parse_acc_pit(a)))return void syntax(1,"Bad transpose value");i.pit+=124,n=12*(i.pit/7|0)+note_pit[i.pit%7],i.acc&&3!=i.acc&&(n+=i.acc),o[r]=n}if(cfmt.sound&&(o[0]=252),n=3*(o[1]-o[0]),i)switch(i.acc){default:return n;case 2:case 1:n++;break;case-1:case-2:n+=2}return n>0?n:n-3}function set_linebreak(t){var e,r;for(e=0;e<128;e++)"\n"==char_tb[e]&&(char_tb[e]=nil);for(t=t.split(/\s+/),e=0;e<t.length;e++){switch(r=t[e]){case"!":case"$":case"*":case";":case"?":case"@":break;case"<none>":continue;case"<EOL>":r="\n";break;default:syntax(1,"Bad value '$1' in %%linebreak - ignored",r);continue}char_tb[r.charCodeAt(0)]="\n"}}function set_user(t){var e,r,n,a=t.match(/(.*?)[= ]*([!"].*[!"])/);if(!a)return void syntax(1,'Lack of starting ! or " in U: / %%user');if(r=a[1],n=a[2],n.slice(-1)!=n[0])return void syntax(1,"Lack of ending $1 in U:/%%user",n[0]);if("\\"==r[0]&&("t"==r[1]?r="\t":r[1]||(r=" ")),(e=r.charCodeAt(0))>=128)return void syntax(1,errs.not_ascii);switch(char_tb[e][0]){case"0":case"d":case"i":case" ":break;case'"':case"!":if(char_tb[e].length>1)break;default:return void syntax(1,"Bad user character '$1'",r)}switch(n){case"!beambreak!":n=" ";break;case"!ignore!":n="i";break;case"!nil!":case"!none!":n="d"}char_tb[e]=n}function get_st_lines(t){var e,r;if(t){if(/^[\]\[|.-]+$/.test(t))return t.replace(/\]/g,"[");switch(e=parseInt(t)){case 0:return"...";case 1:return"..|";case 2:return".||";case 3:return".|||"}if(!(isNaN(e)||e<0||e>16)){for(r="|";--e>0;)r+="|";return r}}}function new_block(t){var e={type:C.BLOCK,subtype:t,dur:0};2==parse.state&&goto_tune();var r=curvoice;return curvoice=voice_tb[par_sy.top_voice],sym_link(e),curvoice=r,e}function set_vp(t){for(var e,r,n,a,i;;){if(!(r=t.shift()))break;if("="==r[r.length-1]&&0==t.length){syntax(1,errs.bad_val,r);break}switch(r){case"clef=":e=t.shift();break;case"clefpitch=":if((r=t.shift())&&(a=ntb.indexOf(r[0]))>=0){switch(r[1]){case"'":a+=7;break;case",":a-=7,","==r[2]&&(a-=7)}i=4-a;break}syntax(1,errs.bad_val,r);break;case"octave=":case"uscale=":a=parseInt(t.shift()),isNaN(a)?syntax(1,errs.bad_val,r):curvoice[r.slice(0,-1)]=a;break;case"cue=":curvoice.scale="on"==t.shift()?.7:1;break;case"instrument=":curvoice.transp=get_transp(t.shift(),"instr");break;case"map=":"play"!=cfmt.sound&&(curvoice.map=t.shift());break;case"name=":case"nm=":curvoice.nm=t.shift(),'"'==curvoice.nm[0]&&(curvoice.nm=curvoice.nm.slice(1,-1)),curvoice.new_name=!0;break;case"stem=":case"pos=":if(r="pos="==r?t.shift().split(" "):["stm",t.shift()],void 0==(a=posval[r[1]])){syntax(1,errs.bad_val,r[0]);break}n||(n={}),n[r[0]]=a;break;case"scale=":a=parseFloat(t.shift()),isNaN(a)||a<.6||a>1.5?syntax(1,errs.bad_val,"%%voicescale"):curvoice.scale=a;break;case"score=":if(cfmt.sound)break;r=t.shift(),r.indexOf("/")<0&&(r+="/c"),curvoice.transp=get_transp(r);break;case"shift=":curvoice.shift=get_transp(t.shift());break;case"sound=":case"transpose=":if(!cfmt.sound)break;curvoice.transp=get_transp(t.shift());break;case"subname=":case"sname=":case"snm=":curvoice.snm=t.shift(),'"'==curvoice.snm[0]&&(curvoice.snm=curvoice.snm.slice(1,-1));break;case"stafflines=":a=get_st_lines(t.shift()),void 0==a?syntax(1,"Bad %%stafflines value"):void 0!=curvoice.st?par_sy.staves[curvoice.st].stafflines=a:curvoice.stafflines=a;break;case"staffnonote=":a=parseInt(t.shift()),isNaN(a)?syntax(1,"Bad %%staffnonote value"):curvoice.staffnonote=a;break;case"staffscale=":a=parseFloat(t.shift()),isNaN(a)||a<.3||a>2?syntax(1,"Bad %%staffscale value"):curvoice.staffscale=a;break;default:switch(r.slice(0,4)){case"treb":case"bass":case"alto":case"teno":case"perc":e=r;break;default:"GFC".indexOf(r[0])>=0?e=r:"="==r.slice(-1)&&t.shift()}}}if(n){curvoice.pos=clone(curvoice.pos);for(r in n)n.hasOwnProperty(r)&&(curvoice.pos[r]=n[r])}e&&(e=new_clef(e))&&(i&&(e.clefpit=i),get_clef(e))}function set_kv_parm(t){curvoice.init||(curvoice.init=!0,info.V&&(info.V["*"]&&(t=info.V["*"].concat(t)),info.V[curvoice.id]&&(t=info.V[curvoice.id].concat(t)))),0!=t.length&&set_vp(t)}function memo_kv_parm(t,e){0!=e.length&&(info.V||(info.V={}),info.V[t]?Array.prototype.push.apply(info.V[t],e):info.V[t]=e)}function new_key(t){var e,r,n,a,i=0,o={type:C.KEY,k_delta:0,dur:0};switch(set_ref(o),e=1,t[0]){case"A":o.k_sf=3;break;case"B":o.k_sf=5;break;case"C":o.k_sf=0;break;case"D":o.k_sf=2;break;case"E":o.k_sf=4;break;case"F":o.k_sf=-1;break;case"G":o.k_sf=1;break;case"H":switch(t[1]){case"P":case"p":o.k_bagpipe=t[1],o.k_sf="P"==t[1]?0:2,e++;break;default:syntax(1,"Unknown bagpipe-like key")}break;case"P":o.k_drum=!0,r=!0;break;case"n":0==t.indexOf("none")&&(o.k_sf=0,o.k_none=!0,e=4);default:r=!0}if(!r){switch(t[e]){case"#":o.k_sf+=7,e++;break;case"b":o.k_sf-=7,e++}switch(t=t.slice(e).trim(),t.slice(0,3).toLowerCase()){default:if("m"!=t[0]||" "!=t[1]&&"\t"!=t[1]&&"\n"!=t[1]){r=!0;break}case"aeo":case"m":case"min":o.k_sf-=3,i=5;break;case"dor":o.k_sf-=2,i=1;break;case"ion":case"maj":break;case"loc":o.k_sf-=5,i=6;break;case"lyd":o.k_sf+=1,i=3;break;case"mix":o.k_sf-=1,i=4;break;case"phr":o.k_sf-=4,i=2}if(r||(t=t.replace(/\w+\s*/,"")),0==t.indexOf("exp ")&&(t=t.replace(/\w+\s*/,""),t||syntax(1,"No accidental after 'exp'"),o.k_exp=!0),"^"==(n=t[0])||"_"==n||"="==n){o.k_a_acc=[],a=new scanBuf,a.buffer=t;do{var s=parse_acc_pit(a);if(!s)return[o,null];for(o.k_a_acc.push(s),n=t[a.index];" "==n;)n=t[++a.index]}while("^"==n||"_"==n||"="==n);t=t.slice(a.index)}else o.k_exp&&0==t.indexOf("none")&&(o.k_sf=0,t=t.replace(/\w+\s*/,""))}return o.k_delta=cgd2cde[(o.k_sf+7)%7],o.k_mode=i,[o,info_split(t,0)]}function new_meter(t){var e,r,n,a,i,o,s={type:C.METER,dur:0,a_meter:[]},c={},l=0,u=0,f=t;if(set_ref(s),0==f.indexOf("none"))u=4,i=1;else for(i=0;u<t.length&&"="!=f[u];){switch(f[u]){case"C":c.top=f[u++],"|"==f[u]&&(c.top+=f[u++]),l=4,n=4;break;case"c":case"o":l="c"==f[u]?4:3,n=4,c.top=f[u++],"."==f[u]&&(c.top+=f[u++]);break;case"(":for("("==f[u+1]&&(o=!0,c.top=f[u++],s.a_meter.push(c),c={}),a=u+1;a<t.length&&")"!=f[a]&&"/"!=f[a];)a++;if(")"==f[a]&&"/"==f[a+1]){u++;continue}case")":o="("==f[u],c.top=f[u++],s.a_meter.push(c),c={};continue;default:if(f[u]<="0"||f[u]>"9")return void syntax(1,"Bad char '$1' in M:",f[u]);for(n=2,c.top=f[u++];;){for(;f[u]>="0"&&f[u]<="9";)c.top+=f[u++];if(")"==f[u]){if("/"!=f[u+1])break;u++}if("/"==f[u]){if(u++,f[u]<="0"||f[u]>"9")return void syntax(1,"Bad char '$1' in M:",f[u]);for(c.bot=f[u++];f[u]>="0"&&f[u]<="9";)c.bot+=f[u++];break}if(" "!=f[u]&&"+"!=f[u])break;if(u>=t.length||"("==f[u+1])break;c.top+=f[u++]}l=parseInt(c.top)}for(o||(c.bot&&(n=parseInt(c.bot)),i+=l*C.BLEN/n),s.a_meter.push(c),c={};" "==f[u];)u++;"+"==f[u]&&(c.top=f[u++],s.a_meter.push(c),c={})}if("="==f[u]){if(!(e=f.substring(++u).match(/^(\d+)\/(\d+)$/)))return void syntax(1,"Bad duration '$1' in M:",f.substring(u));i=C.BLEN*e[1]/e[2]}if(s.wmeasure=i,3!=parse.state){if(info.M=t,glovar.meter=s,parse.state>=1)for(glovar.ulen||(i<=1||i>=3*C.BLEN/4?glovar.ulen=C.BLEN/8:glovar.ulen=C.BLEN/16),r=0;r<voice_tb.length;r++)voice_tb[r].meter=s,voice_tb[r].wmeasure=i}else curvoice.wmeasure=i,is_voice_sig()?(curvoice.meter=s,reset_gen()):sym_link(s)}function new_tempo(t){var e,r,n,a=0,i={type:C.TEMPO,dur:0};if(set_ref(i),cfmt.writefields.indexOf("Q")<0&&(i.del=!0),'"'==t[0]){if((a=t.indexOf('"',1))<0)return void syntax(1,"Unterminated string in Q:");for(i.tempo_str1=t.slice(1,a),a++;" "==t[a];)a++}for(n=new scanBuf,n.buffer=t,n.index=a;;){if(void 0==(e=t[n.index])||e<="0"||e>"9")break;for(r=parse_dur(n),i.tempo_notes||(i.tempo_notes=[]),i.tempo_notes.push(C.BLEN*r[0]/r[1]);;){if(" "!=(e=t[n.index]))break;n.index++}}if("="==e){for(e=t[++n.index];" "==e;)e=t[++n.index];for(a=n.index,"c"==e&&"a"==t[a+1]&&"."==t[a+2]&&" "==t[a+3]&&(i.tempo_ca="ca. ",n.index+=4),"/"!=t[n.index+1]?i.tempo=n.get_int():(r=parse_dur(n),i.new_beat=C.BLEN*r[0]/r[1]),e=t[n.index];" "==e;)e=t[++n.index]}if('"'==e){if(n.index++,(a=t.indexOf('"',n.index+1))<0)return void syntax(1,"Unterminated string in Q:");i.tempo_str2=t.slice(n.index,a)}if(3!=parse.state){if(1==parse.state)return info.Q=t,void(glovar.tempo=i);goto_tune()}curvoice.v==par_sy.top_voice&&(sym_link(i),glovar.tempo&&0==curvoice.time&&(glovar.tempo.del=!0))}function do_info(t,e){var r,n,a,i;switch(t){case"I":do_pscom(e);break;case"L":if(2==parse.state&&goto_tune(),i=e.match(/^1\/(\d+)(=(\d+)\/(\d+))?$/)){if(!(n=Number(i[1]))||0!=(n&n-1))break;if(n=C.BLEN/n,i[2]){if(!(a=Number(i[4]))||0!=(a&a-1)){a=0;break}a=Number(i[3])/a*C.BLEN}else a=n}else"auto"==e&&(n=a=-1);if(!a){syntax(1,"Bad L: value");break}parse.state<2?glovar.ulen=n:(curvoice.ulen=n,curvoice.dur_fact=a/n);break;case"M":new_meter(e);break;case"U":set_user(e);break;case"P":if(0==parse.state)break;if(1==parse.state){info.P=e;break}if(2==parse.state&&goto_tune(),cfmt.writefields.indexOf(t)<0)break;r={type:C.PART,text:e,dur:0};var o=voice_tb[par_sy.top_voice];if(curvoice.v!=o.v){if(curvoice.time!=o.time)break;if(o.last_sym&&o.last_sym.type==C.PART)break;var s=curvoice;curvoice=o,sym_link(r),curvoice=s}else sym_link(r);break;case"Q":if(0==parse.state)break;new_tempo(e);break;case"V":get_voice(e);break;case"K":if(0==parse.state)break;get_key(e);break;case"N":case"R":info[t]?info[t]+="\n"+e:info[t]=e;break;case"r":if(!user.keep_remark||3!=parse.state)break;r={type:C.REMARK,text:e,dur:0},sym_link(r);break;default:syntax(0,"'$1:' line ignored",t)}}function adjust_dur(t){var e,r,n,a,i;if((e=curvoice.last_sym)&&e.type!=C.MREST&&e.type!=C.BAR){for(;e.type!=C.BAR&&e.prev;)e=e.prev;if(r=e.time,n=curvoice.time-r,0==r){for(;e&&!e.dur;)e=e.next;e&&e.type==C.REST&&e.invis&&(r+=e.dur*curvoice.wmeasure/n,e.prev?e.prev.next=e.next:curvoice.sym=e.next,e.next&&(e.next.prev=e.prev),e=e.next)}if(curvoice.wmeasure!=n){for(;e;e=e.next)if(e.time=r,e.dur&&!e.grace&&(e.dur=e.dur*curvoice.wmeasure/n,e.dur_orig=e.dur_orig*curvoice.wmeasure/n,r+=e.dur,e.type==C.NOTE||e.type==C.REST)){for(a=0;a<=e.nhd;a++)e.notes[a].dur=e.notes[a].dur*curvoice.wmeasure/n;i=identify_note(e,e.dur_orig),e.head=i[0],e.dots=i[1],e.nflags=i[2],e.nflags<=-2?e.stemless=!0:delete e.stemless}curvoice.time=t.time=r}}}function new_bar(){var t,e,r,n=parse.line,a={type:C.BAR,fname:parse.fname,istart:parse.bol+n.index,dur:0,multi:0};for(vover&&vover.bar&&get_vover("|"),glovar.new_nbar&&(a.bar_num=glovar.new_nbar,glovar.new_nbar=0),r=n.char();;){switch(e=n.next_char()){case"|":case"[":case"]":case":":r+=e;continue}break}switch(":"==r[0]&&(1==r.length?(r="|",a.bar_dotted=!0):a.rbstop=2),a_gch&&gch_build(a),a_dcn&&(deco_cnv(a_dcn,a),a_dcn=null),r.slice(-1)){case"[":if(/[0-9" ]/.test(e))break;r=r.slice(0,-1),n.index--,e="[";break;case":":a.rbstop=2}if(e>"0"&&e<="9"){for("["==r.slice(-1)&&(r=r.slice(0,-1)),a.text=e;;){if(e=n.next_char(),"0123456789,.-".indexOf(e)<0)break;a.text+=e}a.rbstop=2,a.rbstart=2}else if('"'==e&&"["==r.slice(-1)){for(r=r.slice(0,-1),a.text="";;){if(!(e=n.next_char()))return void syntax(1,"No end of repeat string");if('"'==e){n.index++;break}"\\"==e&&(a.text+=e,e=n.next_char()),a.text+=e}a.text=cnv_escape(a.text),a.rbstop=2,a.rbstart=2}if("]"==r[0]&&(a.rbstop=2,1!=r.length?r=r.slice(1):a.invis=!0),a.iend=parse.bol+n.index,a.rbstart&&curvoice.norepbra&&!curvoice.second&&(a.norepbra=!0),curvoice.ulen<0&&adjust_dur(a),(t=curvoice.last_sym)&&t.type==C.SPACE)t.time--;else if(t&&t.type==C.BAR){if("["==r&&!t.text&&(0==curvoice.st||par_sy.staves[curvoice.st-1].flags&STOP_BAR||a.norepbra))return a.text&&(t.text=a.text),a.a_gch&&(t.a_gch=a.a_gch),a.norepbra&&(t.norepbra=a.norepbra),a.rbstart&&(t.rbstart=a.rbstart),void(a.rbstop&&(t.rbstop=a.rbstop));if("|:"==r){if(":|"==t.bar_type)return t.bar_type="::",void(t.rbstop=2);if("||"==t.bar_type)return t.bar_type="||:",void(t.rbstop=2)}}switch(r){case"[":a.rbstop=2;case"[]":case"[|]":a.invis=!0,r="[]";break;case":|:":case":||:":r="::";break;case"||":if(!cfmt.rbdbstop)break;case"[|":case"|]":a.rbstop=2}a.bar_type=r,curvoice.lyric_restart||(curvoice.lyric_restart=a),curvoice.sym_restart||(curvoice.sym_restart=a),!t||t.type!=C.KEY||t.prev&&t.prev.type==C.BAR?sym_link(a):(curvoice.last_sym=t.prev,t.prev||(curvoice.sym=t.prev),sym_link(a),a.next=t,t.prev=a,curvoice.last_sym=t),a.st=curvoice.st,a.rbstart&&!curvoice.norepbra&&curvoice.st>0&&!(par_sy.staves[curvoice.st-1].flags&STOP_BAR)&&(t={type:C.BAR,fname:a.fname,istart:a.istart,iend:a.iend,bar_type:"[",multi:0,invis:!0,text:a.text,rbstart:2},sym_link(t),t.st=curvoice.st,delete a.text,a.rbstart=0)}function parse_staves(t){for(var e,r=[],n=!1,a=0,i=0,o=0,s=0,c=0,l=0;l<t.length;){switch(t[l]){case" ":case"\t":break;case"[":if(s||i+o>=2){syntax(1,errs.misplaced,"["),n=!0;break}a|=i+o==0?OPEN_BRACKET:OPEN_BRACKET2,o++,c<<=8,c|=OPEN_BRACKET;break;case"{":if(s||i||o>=2){syntax(1,errs.misplaced,"{"),n=!0;break}a|=o?OPEN_BRACE2:OPEN_BRACE,i++,c<<=8,c|=OPEN_BRACE;break;case"(":if(s){syntax(1,errs.misplaced,"("),n=!0;break}a|=OPEN_PARENTH,s++,c<<=8,c|=OPEN_PARENTH;break;case"*":!i||s||a&(OPEN_BRACE|OPEN_BRACE2)||(a|=FL_VOICE);break;case"+":a|=MASTER_VOICE;break;default:if(!/\w/.test(t[l])){syntax(1,"Bad voice ID in %%staves"),n=!0;break}for(e="";l<t.length&&!(" \t()[]{}|*".indexOf(t[l])>=0);)e+=t[l++];for(;l<t.length;l++){switch(t[l]){case" ":case"\t":continue;case"]":if(!(c&OPEN_BRACKET)){syntax(1,errs.misplaced,"]"),n=!0;break}o--,a|=i+o==0?CLOSE_BRACKET:CLOSE_BRACKET2,c>>=8;continue;case"}":if(!(c&OPEN_BRACE)){syntax(1,errs.misplaced,"}"),n=!0;break}i--,a|=o?CLOSE_BRACE2:CLOSE_BRACE,a&=~FL_VOICE,c>>=8;continue;case")":if(!(c&OPEN_PARENTH)){syntax(1,errs.misplaced,")"),n=!0;break}s--,a|=CLOSE_PARENTH,c>>=8;continue;case"|":a|=STOP_BAR;continue}break}r.push([e,a]),a=0;continue}l++}if(0!=c&&(syntax(1,"'}', ')' or ']' missing in %%staves"),n=!0),!n&&0!=r.length)return r}function info_split(t){if(!t)return[];var e=t.match(/(".+?"|.+?)(\s+|=|$)/g);if(!e)return syntax(1,"Unterminated string"),[];for(var r=0;r<e.length;r++)e[r]=e[r].trim();return e}function identify_note(t,e){var r,n,a;for(e%12!=0&&syntax(1,"Invalid note duration $1",e),e/=12,0==e&&syntax(1,"Note too short"),a=5;0!=e&&!(1&e);e>>=1,a--);switch(e>>=1){case 0:n=0;break;case 1:n=1;break;case 3:n=2;break;default:n=3}if((a-=n)>=0)r=C.FULL;else switch(a){default:syntax(1,"Note too long"),a=-4;case-4:r=C.SQUARE;break;case-3:r=cfmt.squarebreve?C.SQUARE:C.OVALBARS;break;case-2:r=C.OVAL;break;case-1:r=C.EMPTY}return[r,n,a]}function parse_dur(t){var e,r,n;return reg_dur.lastIndex=t.index,e=reg_dur.exec(t.buffer),e[0]?(r=e[1]||1,n=e[3]||1,e[3]||(n*=1<<e[2].length),t.index=reg_dur.lastIndex,[r,n]):[1,1]}function parse_acc_pit(t){var e,r,n,a,i,o,s=t.char();switch(s){case"^":s=t.next_char(),"^"==s?(r=2,s=t.next_char()):r=1;break;case"=":r=3,s=t.next_char();break;case"_":s=t.next_char(),"_"==s?(r=-2,s=t.next_char()):r=-1}if((r&&3!=r&&s>="1"&&s<="9"||"/"==s)&&(o=parse_dur(t),n=o[0],a=o[1],1==a?a=curvoice?curvoice.uscale:1:a*=2,s=t.char()),i=ntb.indexOf(s)+16,s=t.next_char(),i<16)return void syntax(1,"'$1' is not a note",t.buffer[t.index-1]);for(;"'"==s;)i+=7,s=t.next_char();for(;","==s;)i-=7,s=t.next_char();return e={pit:i,apit:i,shhd:0,shac:0,ti1:0},r&&(e.acc=r,n&&(e.micro_n=n,e.micro_d=a)),e}function set_map(t){var e,r,n,a,i=maps[curvoice.map];for(e="abcdefg"[(t.pit+77)%7],r=t.acc?["__","_","","^","^^","="][t.acc+2]:"",n=r+e,a=t.pit;a>=28;a-=7)n+="'";for(a=t.pit;a<21;a+=7)n+=",";(i[n]||(n="octave,"+r+e,i[n]||(n="key,"+"abcdefg"[(t.pit+77-curvoice.ckey.k_delta)%7],i[n]||(n="all",i[n]))))&&(t.map=i[n],t.map[1]&&(t.apit=t.pit=t.map[1].pit,t.acc=t.map[1].acc))}function parse_basic_note(t,e){var r,n=parse_acc_pit(t);if(n)return"0"==t.char()&&(parse.stemless=!0,t.index++),r=parse_dur(t),n.dur=e*r[0]/r[1],n}function parse_vpos(){var t=parse.line,e=0;switch("."!=t.buffer[t.index-1]||a_dcn||(e=C.SL_DOTTED),t.next_char()){case"'":return t.index++,e+C.SL_ABOVE;case",":return t.index++,e+C.SL_BELOW}return e+C.SL_AUTO}function note_transp(t){var e,r,n,a,i,o,s,c,l,u,f=t.nhd,$=curvoice.okey.k_sf,_=curvoice.ckey.k_sf-$,d=cgd2cde[(_+28)%7],p=curvoice.vtransp;for(p<0&&0!=d&&(d-=7),d+=7*(p/3/12|0),e=0;e<=f;e++){if(u=t.notes[e],n=u.pit,u.pit+=d,u.apit=u.pit,s=cde2fcg[(n+5+112)%7],!(i=u.acc))if(curvoice.okey.a_acc){for(r=0;r<curvoice.okey.a_acc.length;r++)if(o=curvoice.okey.a_acc[r],(n+112-o.pit)%7==0){i=o.acc;break}}else $>0?s<$-1&&(i=1):$<0&&s>=$+6&&(i=-1);if(c=s+_,i&&3!=i&&(c+=7*i),s=(2+((c+1+21)/7|0)-3+160)%5,i=acc2[s],u.acc);else if(curvoice.ckey.k_none){if(3==i||acc_same_pitch(u.pit))continue}else{if(!curvoice.ckey.a_acc)continue;for(l=cgd2cde[(c+112)%7],r=0;r<curvoice.ckey.a_acc.length&&(l+112-curvoice.ckey.a_acc[r].pits)%7!=0;r++);if(r<curvoice.ckey.a_acc.length)continue}if(s=u.acc,(a=u.micro_d)&&s!=i)switch(n=u.micro_n,i){case 3:n>a/2?(n-=a/2,u.micro_n=n,i=s):i=-s;break;case 2:n>a/2?(u.pit+=1,u.apit=u.pit,n-=a/2):n+=a/2,i=s,u.micro_n=n;break;case-2:n>=a/2?(u.pit-=1,u.apit=u.pit,n-=a/2):n+=a/2,i=s,u.micro_n=n}u.acc=i}}function sort_pitch(t){t.notes=t.notes.sort(function(t,e){return t.pit-e.pit})}function new_note(t,e){var r,n,a,i,o,s,c,l,u,f,$,_,d,p=0,h=parse.line,g=a_dcn;switch(a_dcn=null,parse.stemless=!1,n={type:C.NOTE,fname:parse.fname,stem:0,multi:0,nhd:0,xmx:0},n.istart=parse.bol+h.index,curvoice.color&&(n.color=curvoice.color),t?n.grace=!0:(a_gch&&gch_build(n),parse.repeat_n&&(n.repeat_n=parse.repeat_n,n.repeat_k=parse.repeat_k,parse.repeat_n=0)),i=h.char()){case"X":n.invis=!0;case"Z":if(n.type=C.MREST,i=h.next_char(),n.nmes=i>"0"&&i<="9"?h.get_int():1,n.dur=curvoice.wmeasure*n.nmes,curvoice.second)return void(curvoice.time+=n.dur);break;case"y":n.type=C.SPACE,n.invis=!0,n.dur=0,i=h.next_char(),n.width=i>="0"&&i<="9"?h.get_int():10;break;case"x":n.invis=!0;case"z":n.type=C.REST,h.index++,f=parse_dur(h),n.dur_orig=(curvoice.ulen<0?15120:curvoice.ulen)*f[0]/f[1],n.dur=n.dur_orig*curvoice.dur_fact,n.notes=[{pit:18,dur:n.dur_orig}];break;case"[":a=!0,i=h.next_char();default:for(curvoice.uscale&&(n.uscale=curvoice.uscale),n.notes=[];;){if(a)for(;;){if(!i)break;if((c=i.charCodeAt(0))>=128)return void syntax(1,errs.not_ascii);switch(s=char_tb[c],s[0]){case"(":p<<=4,p+=parse_vpos(),i=h.char();continue;case"!":if(a_dcn||(a_dcn=[]),s.length>1)a_dcn.push(s.slice(1,-1));else{for(o="";;){if(!(i=h.next_char()))return void syntax(1,"No end of decoration");if("!"==i)break;o+=i}a_dcn.push(o)}i=h.next_char();continue}break}if(!(r=parse_basic_note(h,n.grace?C.BLEN/4:curvoice.ulen<0?15120:curvoice.ulen)))return;if(curvoice.octave&&(r.apit=r.pit+=7*curvoice.octave),curvoice.ottava&&(r.pit+=curvoice.ottava),p&&(r.sl1=p,n.sl1?n.sl1++:n.sl1=1,p=0),a_dcn&&(r.a_dcn=a_dcn,a_dcn=null),n.notes.push(r),!a)break;for(i=h.char();;){switch(i){case")":r.sl2?r.sl2++:r.sl2=1,n.sl2?n.sl2++:n.sl2=1,i=h.next_char();continue;case"-":r.ti1=parse_vpos(),n.ti1=!0,i=h.char();continue;case".":if("-"!=(i=h.next_char())){syntax(1,"Misplaced dot");break}continue}break}if("]"==i){for(h.index++,f=parse_dur(h),n.nhd=n.notes.length-1,c=0;c<=n.nhd;c++)r=n.notes[c],r.dur=r.dur*f[0]/f[1];break}}n.dur_orig=n.notes[0].dur,n.dur=n.notes[0].dur*curvoice.dur_fact}if(n.grace&&n.type!=C.NOTE)return void syntax(1,"Not a note in grace note sequence");if(n.notes){if(n.grace){var m=curvoice.key.k_bagpipe?8:4;for(c=0;c<=n.nhd;c++)n.notes[c].dur/=m;n.dur/=m,n.dur_orig/=m,t.stem&&(n.stem=t.stem)}else{switch(curvoice.pos.stm){case C.SL_ABOVE:n.stem=1;break;case C.SL_BELOW:n.stem=-1;break;case C.SL_HIDDEN:n.stemless=!0}if(n.dur*=e,_=curvoice.brk_rhythm){if(curvoice.brk_rhythm=0,u=curvoice.last_note,_>0){for(l=2*_-1,n.dur=n.dur*l/_,n.dur_orig=n.dur_orig*l/_,c=0;c<=n.nhd;c++)n.notes[c].dur=n.notes[c].dur*l/_;for(u.dur/=_,u.dur_orig/=_,c=0;c<=u.nhd;c++)u.notes[c].dur/=_}else{for(_=-_,l=2*_-1,n.dur/=_,n.dur_orig/=_,c=0;c<=n.nhd;c++)n.notes[c].dur/=_;for(u.dur=u.dur*l/_,u.dur_orig=u.dur_orig*l/_,c=0;c<=u.nhd;c++)u.notes[c].dur=u.notes[c].dur*l/_}for(curvoice.time=u.time+u.dur,$=identify_note(u,u.dur_orig),u.head=$[0],u.dots=$[1],u.nflags=$[2],u.nflags<=-2?u.stemless=!0:delete u.stemless,u=u.next;u;u=u.next)u.time=curvoice.time}}n.type==C.NOTE?($=identify_note(n,n.dur_orig),n.head=$[0],n.dots=$[1],n.nflags=$[2],n.nflags<=-2&&(n.stemless=!0)):(d=n.dur_orig,d==curvoice.wmeasure&&(d=d<2*C.BLEN?C.BLEN:d<4*C.BLEN?2*C.BLEN:4*C.BLEN),$=identify_note(n,d),n.head=$[0],n.dots=$[1],n.nflags=$[2]),curvoice.last_note=n}if(sym_link(n),n.type==C.NOTE&&(curvoice.vtransp&&note_transp(n),curvoice.map&&maps[curvoice.map]))for(c=0;c<=n.nhd;c++)set_map(n.notes[c]);return cfmt.shiftunison&&(n.shiftunison=cfmt.shiftunison),t||(curvoice.lyric_restart||(curvoice.lyric_restart=n),curvoice.sym_restart||(curvoice.sym_restart=n)),g&&deco_cnv(g,n,n.prev),parse.stemless&&(n.stemless=!0),n.iend=parse.bol+h.index,n}function parse_music_line(){function t(t){var e,r,n;for(e=1,r=p.index+1;e<t.length;e++,r++)if(t[e]!=p.buffer[r]){if("n"!=t[e])return;if((n=ntb.indexOf(p.buffer[r]))<0)return;for(;"'"==p.buffer[r+1];)n+=7,r++;for(;","==p.buffer[r+1];)n-=7,r++}return p.index=r,n}function e(t,e){var r,n,a="",o=t.length;for(i=0;i<o;i++)if((r=t[i])>="h"&&r<="z"){for(n=e+r.charCodeAt(0)-"n".charCodeAt(0),r="";n<0;)n+=7,r+=",";for(;n>14;)n-=7,r+="'";a+=ntb[n]+r}else a+=r;return a}function r(t,r){
var a=p,i=parse.istart;parse.line=p=new scanBuf,parse.istart+=a.index,p.buffer=r?e(t,r):t,n(!0),parse.line=p=a,parse.istart=i}function n(e){for(var n,i,l,h,g,m,v,y,b;;){if(!(n=p.char()))break;if("."==n)switch(p.buffer[p.index+1]){case"(":case"-":case"|":n=p.next_char()}if((i=n.charCodeAt(0))>=128){syntax(1,errs.not_ascii),p.index++;break}if(!e&&maci[i]){y=0;for(h in mac)if(mac.hasOwnProperty(h)&&h[0]==n){if(h.indexOf("n")<0){if(p.buffer.indexOf(h,p.index)!=p.index)continue;p.index+=h.length}else if(!(y=t(h)))continue;r(mac[h],y),y=1;break}if(y)continue}switch(l=char_tb[i],l[0]){case" ":g=curvoice.last_note,g&&(g.beam_end=!0,a&&(a.gr_shift=!0));break;case"\n":if(cfmt.barsperstaff)break;0==par_sy.voices[curvoice.v].range&&curvoice.last_sym&&(curvoice.last_sym.eoln=!0);break;case"&":if(a){syntax(1,errs.bad_char,n);break}if(")"==(n=p.next_char())){get_vover(")");break}get_vover("&");continue;case"(":if((n=p.next_char())>"0"&&n<="9"){var w=p.get_int(),x=qplet_tb[w],A=w,n=p.char();if(":"==n&&(n=p.next_char(),n>"0"&&n<="9"&&(x=p.get_int(),n=p.char()),":"==n)){if(!((n=p.next_char())>"0"&&n<="9")){syntax(1,"Invalid 'r' in tuplet");continue}A=p.get_int(),n=p.char()}0!=x&&void 0!=x||(x=curvoice.wmeasure%9==0?3:2),u=f[++$],u||(f[$]=u={}),u.p=w,u.q=x,u.r=A,u.f=cfmt.tuplets,u.fact=_*x/w,_=u.fact;continue}if("&"==n){if(a){syntax(1,errs.bad_char,n);break}get_vover("(");break}d<<=4,p.index--,d+=parse_vpos();continue;case")":if(curvoice.ignore)break;if(g=curvoice.last_sym)switch(g.type){case C.NOTE:case C.REST:case C.SPACE:break;default:g=null}if(!g){syntax(1,errs.bad_char,n);break}g.slur_end?g.slur_end++:g.slur_end=1;break;case"!":if(a_dcn||(a_dcn=[]),l.length>1)m=l.slice(1,-1);else{for(m="",v=p.index;;){if(!(n=p.next_char()))break;if("!"==n)break;m+=n}if(!n){p.index=v,syntax(1,"No end of decoration");break}}ottava[m]&&set_ottava(m),a_dcn.push(m);break;case'"':parse_gchord(l);break;case"-":var k=0;if(!curvoice.last_note||curvoice.last_note.type!=C.NOTE){syntax(1,"No note before '-'");break}for(k=parse_vpos(),g=curvoice.last_note,v=0;v<=g.nhd;v++)g.notes[v].ti1?0==g.nhd&&syntax(1,"Too many ties"):g.notes[v].ti1=k;g.ti1=!0,a&&(a.ti1=!0);continue;case"[":var E=p.buffer[p.index+1];if('|[]: "'.indexOf(E)>=0||E>="1"&&E<="9"){if(a){syntax(1,errs.bar_grace);break}new_bar();continue}if(":"==p.buffer[p.index+2]){if((v=p.buffer.indexOf("]",p.index+1))<0){syntax(1,"Lack of ']'");break}b=p.buffer.slice(p.index+3,v).trim(),parse.istart=parse.bol+p.index,parse.iend=parse.bol+ ++v,p.index=0,do_info(E,b),p.index=v;continue}case"n":if(!(g=new_note(a,_)))continue;if(g.type==C.NOTE&&d&&(g.slur_start=d,d=0),a){$>=0&&(g.in_tuplet=!0);continue}$>=0&&g.notes&&(g.in_tuplet=!0,$>0?(f[0].p&&(g.tp0=f[0].p,g.tq0=f[0].q,g.tf=f[0].f,f[0].p=0),f[0].r--,u.p&&(g.tp1=u.p,g.tq1=u.q,g.tf=u.f,u.p=0)):u.p&&(g.tp0=u.p,g.tq0=u.q,g.tf=u.f,u.p=0),0==--u.r&&(0==$--?(g.te0=!0,_=1,curvoice.time=Math.round(curvoice.time),g.dur=curvoice.time-g.time):(g.te1=!0,u=f[0],0==u.r?($--,g.te0=!0,_=1,curvoice.time=Math.round(curvoice.time),g.dur=curvoice.time-g.time):_=u.fact)));continue;case"<":if(!curvoice.last_note){syntax(1,"No note before '<'");break}if(a){syntax(1,"Cannot have a broken rhythm in grace notes");break}for(y="<"==n?1:-1;"<"==n||">"==n;)y*=2,n=p.next_char();curvoice.brk_rhythm=y;continue;case"i":break;case"{":if(a){syntax(1,"'{' in grace note");break}switch(o=curvoice.last_note,curvoice.last_note=null,s=a_dcn,a_dcn=void 0,a={type:C.GRACE,fname:parse.fname,istart:parse.bol+p.index,dur:0,multi:0},curvoice.pos.gst){case C.SL_ABOVE:a.stem=1;break;case C.SL_BELOW:a.stem=-1;break;case C.SL_HIDDEN:a.stem=2}if(sym_link(a),"/"==(n=p.next_char())){a.sappo=!0;break}continue;case"|":if(a){syntax(1,errs.bar_grace);break}n=p.buffer[p.index-1],new_bar(),"."==n&&(curvoice.last_sym.bar_dotted=!0);continue;case"}":if(g=curvoice.last_note,!a||!g){syntax(1,errs.bad_char,n);break}if(a_dcn&&syntax(1,"Decoration ignored"),g.gr_end=!0,a.extra=a.next,a.extra.prev=null,a.next=null,curvoice.last_sym=a,a=null,!g.prev&&!curvoice.key.k_bagpipe){for(v=0;v<=g.nhd;v++)g.notes[v].dur*=2;g.dur*=2,g.dur_orig*=2;var S=identify_note(g,g.dur_orig);g.head=S[0],g.dots=S[1],g.nflags=S[2]}curvoice.last_note=o,a_dcn=s;break;case"\\":if(!(n=p.buffer[p.index+1])){c=!0;break}default:syntax(1,errs.bad_char,n)}p.index++}}var a,o,s,c,l,u,f=[],$=-1,_=1,d=0,p=parse.line;if(3!=parse.state){if(2!=parse.state)return;goto_tune()}if(n(),$>=0)for(syntax(1,"No end of tuplet"),l=curvoice.last_note;l;l=l.prev)if(l.tp1&&(l.tp1=0),l.tp0){l.tp0=0;break}a&&(syntax(1,"No end of grace note sequence"),curvoice.last_sym=a.prev,curvoice.last_note=o,a.prev&&(a.prev.next=null)),cfmt.breakoneoln&&curvoice.last_note&&(curvoice.last_note.beam_end=!0),c||cfmt.barsperstaff||"\n"==char_tb["\n".charCodeAt(0)]&&0==par_sy.voices[curvoice.v].range&&curvoice.last_sym&&(curvoice.last_sym.eoln=!0)}function cwid(t){var e=t.charCodeAt(0);if(e>=128){if(e>=768&&e<880)return 0;e=97}return cw_tb[e]}function strwh(t){var e,r,n,a=gene.curfont,i=a.swfac,o=a.size,s=0,c=t.length;for(e=0;e<c;e++){switch(n=t[e]){case"$":if("0"==(n=t[e+1]))a=gene.deffont;else{if(!(n>="1"&&n<="9")){n="$";break}a=get_font("u"+n)}e++,i=a.swfac,a.size>o&&(o=a.size);continue;case"&":r=t.indexOf(";",e),r>0&&r-e<10&&(e=r,n="a")}s+=cwid(n)*i}return gene.curfont=a,[s,o]}function set_font(t){"string"==typeof t&&(t=get_font(t)),gene.curfont=gene.deffont=t}function out_str(t){var e,r=gene.curfont,n=r;output+=t.replace(/<|>|&.*?;|&|  |\$./g,function(t){switch(t[0]){case"<":return"&lt;";case">":return"&gt;";case"&":return"&"==t?"&amp;":t;case" ":return" ";case"$":if("0"==t[1])e=gene.deffont,use_font(e);else{if(!(t[1]>="1"&&t[1]<="9"))return t;e=get_font("u"+t[1])}return t="",e==n?t:(n!=r&&(t="</tspan>"),n=e,n==r?t:t+'<tspan\n\tclass="'+font_class(e)+'">')}}),n!=r&&(output+="</tspan>",gene.curfont=n)}function xy_str(t,e,r,n,a){switch(e+=.2*strwh(r)[1],output+='<text class="'+font_class(gene.curfont)+'" x="',out_sxsy(t,'" y="',e),n){case"c":output+='" text-anchor="middle">';break;case"j":output+='" textLength="'+a.toFixed(2)+'">';break;case"r":output+='" text-anchor="end">';break;default:output+='">'}out_str(r),output+="</text>\n"}function xy_str_b(t,e,r){var n=strwh(r);output+='<rect class="stroke" x="',out_sxsy(t-2,'" y="',e+n[1]+1),output+='" width="'+(n[0]+4).toFixed(2)+'" height="'+(n[1]+3).toFixed(2)+'"/>\n',xy_str(t,e,r)}function trim_title(t,e){var r;return cfmt.titletrim&&(r=t.lastIndexOf(", "),r<0||t[r+2]<"A"||t[r+2]>"Z"?r=0:1==cfmt.titletrim?(r<t.length-7||t.indexOf(" ",r+3)>=0)&&(r=0):r<t.length-cfmt.titletrim-2&&(r=0)),!e&&cfmt.writefields.indexOf("X")>=0&&(t=info.X+".  "+t),r&&(t=t.slice(r+2).trim()+" "+t.slice(0,r)),cfmt.titlecaps?t.toUpperCase():t}function get_lwidth(){return(img.width-img.lm-img.rm-2)/cfmt.scale}function write_title(t,e){var r;t&&(set_page(),t=trim_title(t,e),e?(set_font("subtitle"),r=cfmt.subtitlespace):(set_font("title"),r=cfmt.titlespace),vskip(strwh(t)[1]+r),cfmt.titleleft?xy_str(0,0,t):xy_str(get_lwidth()/2,0,t,"c"))}function put_inf2r(t,e,r,n,a){if(!r){if(!n)return;r=n,n=null}n?xy_str(t,e,r+" ("+n+")",a):xy_str(t,e,r,a)}function str_skip(t){vskip(strwh(t)[1]*cfmt.lineskipfac)}function write_text(t,e){if("s"!=e){set_font("text"),set_page();var r,n,a,i,o,s,c,l,u=get_lwidth(),f=gene.curfont.size,$=f*cfmt.lineskipfac,_=f*cfmt.parskipfac,d=block.started?function(){}:blk_out,p=block.started?svg_flush:blk_flush;switch(d(),e){default:switch(e){case"c":a=u/2;break;case"r":a=u;break;default:a=0}for(n=0;;){if((r=t.indexOf("\n",n))<0){l=t.slice(n),str_skip(l),xy_str(a,0,l,e);break}if(r==n){for(vskip(_),p(),use_font(gene.curfont);"\n"==t[r+1];)vskip($),r++;if(r==t.length)break;d()}else l=t.slice(n,r),str_skip(l),xy_str(a,0,l,e);n=r+1}vskip(_),p();break;case"f":case"j":for(n=0;;){for(r=t.indexOf("\n\n",n),i=r<0?t.slice(n):t.slice(n,r),i=i.split(/\s+/),o=s=0,n=0;n<i.length;n++)c=strwh(i[n]+" ")[0],(o+=c)>=u&&(l=i.slice(s,n).join(" "),str_skip(l),xy_str(0,0,l,e,u),s=n,o=c);if(0!=o&&(l=i.slice(s).join(" "),str_skip(l),xy_str(0,0,l)),vskip(_),p(),r<0)break;for(;"\n"==t[r+2];)vskip($),r++;if(r==t.length)break;d(),use_font(gene.curfont),n=r+2}}}}function put_words(t){function e(t,e,r){var n,a,i=0;if("$"==t[i]&&t[i+1]>="0"&&t[i+1]<="9"&&(i+=2),a=0,n=i,t[i]>="0"&&t[i]<="9"||"."==t[i+1]){for(;i<t.length&&(i++," "!=t[i]&&":"!=t[i-1]&&"."!=t[i-1]););for(a=i;" "==t[i];)i++}return 0!=a&&xy_str(e,0,t.slice(n,a),"r"),i<t.length&&xy_str(e+5,0,t.slice(i),"l"),i>=t.length&&0==a}var r,n,a,i,o,s,c,l;blk_out(),set_font("words");var u=get_lwidth()/2,f=(u-45)/(cwid("a")*gene.curfont.swfac);for(i=0,t=t.split("\n"),o=t.length,n=0;n<o;n++){if(r=t[n],r.length>f){i=0;break}r?l=!0:l&&(i++,l=!1)}if(i>0){for(n=i=(i+1)/2|0,l=!1,c=0;c<o;c++){for(r=t[c],a=0;" "==r[a];)a++;if(a==r.length){if(l&&--n<=0)break;l=!1}else l=!0}s=c+1}else s=c=o;for(vskip(cfmt.wordsspace),n=0;n<c||s<o;n++)n<c&&0==t[n].length&&(blk_out(),use_font(gene.curfont)),vskip(cfmt.lineskipfac*gene.curfont.size),n<c&&e(t[n],45,0),s<o&&(e(t[s],20+u,1)&&0==--i&&(n<c?i++:s<t.length-1&&(u*=.6)),s++)}function put_history(){var t,e,r,n,a,i,o,s,c=cfmt.infoname.split("\n"),l=c.length;for(t=0;t<l;t++)if(r=c[t][0],!(cfmt.writefields.indexOf(r)<0)&&(n=info[r])){for(a||(a=!0,set_font("history"),vskip(cfmt.textspace),i=gene.curfont.size*cfmt.lineskipfac),s=c[t].slice(2),'"'==s[0]&&(s=s.slice(1,-1)),vskip(i),xy_str(0,0,s),o=strwh(s)[0],n=n.split("\n"),xy_str(o,0,n[0]),e=1;e<n.length;e++)vskip(i),xy_str(o,0,n[e]);vskip(.3*i),blk_out(),use_font(gene.curfont)}}function write_headform(t){for(var e,r,n,a,i,o,s,c={},l=clone(info_font_init),u={A:cfmt.infospace,C:cfmt.composerspace,O:cfmt.composerspace,R:cfmt.infospace},f={},$="",_=cfmt.titleformat,d=0,p=0;;){for(;" "==_[p];)p++;if(p>=_.length)break;if((e=_[p++])<"A"||e>"Z")if("+"==e){if(0==$.length||"+"==$.slice(-1))continue;$=$.slice(0,-1)+"+"}else","==e&&("+"==$.slice(-1)&&($=$.slice(0,-1)+"l"),$+="\n");else{if(c[e])f[e]++;else{if(!info[e])continue;c[e]=info[e].split("\n"),f[e]=1}switch($+=e,_[p]){case"-":$+="l",p++;break;case"0":$+="c",p++;break;case"1":$+="r",p++;break;default:$+="c"}}}"+"==$.slice(-1)&&($=$.slice(0,-1)+"l"),$+="\n";var h,g={l:cfmt.titlespace,c:cfmt.titlespace,r:cfmt.titlespace},m={l:0,c:.5*t,r:t},v={};for(_=$,p=0;;){for(v.l=v.c=v.r=o=0,d=p;;){if("\n"==(e=_[d++]))break;if("+"==(a=_[d++]))a=_[d+1];else if(0!=v[a])continue;h=c[e],h&&(n=l[e],n||(n="history"),r=get_font(n),s=1.1*r.size,u[e]&&(s+=u[e]),o<s&&(o=s),v[a]=s)}for(g.l+=o-v.l,g.c+=o-v.c,g.r+=o-v.r;;){if("\n"==(e=_[p++]))break;if(a=_[p++],0!=c[e].length){if(h=c[e].shift(),"+"==a&&(f[e]--,e=_[p++],a=_[p++],c[e].length>0&&(h?h+=" "+c[e].shift():h=" "+c[e].shift())),n=l[e],n||(n="history"),r=get_font(n),s=1.1*r.size,u[e]&&(s+=u[e]),set_font(r),i=m[a],o=g[a]+s,"Q"==e){if(!glovar.tempo.del){if("l"!=a){var y=tempo_width(glovar.tempo);"c"==a&&(y*=.5),i-=y}write_tempo(glovar.tempo,i,-o)}}else h&&xy_str(i,-o,h,a);if("T"==e&&(n=l.T="subtitle",u.T=cfmt.subtitlespace),f[e]<=1)for("T"==e&&(r=get_font(n),s=1.1*r.size,u[e]&&(s+=u[e]),set_font(r));c[e].length>0;)o+=s,h=c[e].shift(),xy_str(i,-o,h,a);f[e]--,g[a]=o}}if(g.c>g.l&&(g.l=g.c),g.r>g.l&&(g.l=g.r),p>=$.length)break;g.c=g.r=g.l}vskip(g.l)}function write_heading(){var t,e,r,n,a,i,o,s,c=get_lwidth();if(blk_out(),vskip(cfmt.topspace),cfmt.titleformat)return write_headform(c),void vskip(cfmt.musicspace);if(info.T&&cfmt.writefields.indexOf("T")>=0)for(t=0;;){if((e=info.T.indexOf("\n",t))<0){write_title(info.T.substring(t),0!=t);break}write_title(info.T.slice(t,e),0!=t),t=e+1}if(set_font("composer"),o=s=0,parse.ckey.k_bagpipe&&!cfmt.infoline&&cfmt.writefields.indexOf("R")>=0&&(i=info.R),i&&(xy_str(0,-cfmt.composerspace,i),o=cfmt.composerspace),r=info.A,cfmt.writefields.indexOf("C")>=0&&(n=info.C),cfmt.writefields.indexOf("O")>=0&&(a=info.O),n||a||cfmt.infoline){var l,u;if(vskip(cfmt.composerspace),cfmt.aligncomposer<0?(l=0,u=" "):0==cfmt.aligncomposer?(l=.5*c,u="c"):(l=c,u="r"),s=o,n||a){for(cfmt.aligncomposer>=0&&o!=s&&vskip(o-s),t=0;;){if(vskip(gene.curfont.size),(e=n?n.indexOf("\n",t):-1)<0){put_inf2r(l,0,n?n.substring(t):null,a,u);break}xy_str(l,0,n.slice(t,e),u),o+=gene.curfont.size,t=e+1}s>o&&vskip(s-o)}i=i?null:info.R,(i||r)&&cfmt.infoline&&(set_font("info"),vskip(gene.curfont.size+cfmt.infospace),put_inf2r(c,0,i,r,"r"),o+=gene.curfont.size+cfmt.infospace)}else s=cfmt.composerspace;info.P&&cfmt.writefields.indexOf("P")>=0&&(set_font("parts"),o=cfmt.partsspace+gene.curfont.size-o,o>0&&(s+=o),s>.01&&vskip(s),xy_str(0,0,info.P),s=0),vskip(s+cfmt.musicspace)}function def_use(t){var e,r,n;if(!defined_glyph[t]){if(defined_glyph[t]=!0,!(n=glyphs[t]))return void error(1,null,"Unknown glyph: '$1'",t);for(r=0;;){if((e=n.indexOf('xlink:href="#',r))<0)break;e+=13,r=n.indexOf('"',e),def_use(n.slice(e,r))}defs+="\n"+n}}function defs_add(t){var e,r,n,a,i,o=0;for(t=t.replace(/<!--.*?-->/g,"");;){if((i=t.indexOf("<",o))<0)break;if((e=t.indexOf('id="',i))<0)break;if(e+=4,(r=t.indexOf('"',e))<0)break;if(n=t.slice(e,r),(o=t.indexOf(">",r))<0)break;if("/"==t[o-1])o++;else{if((e=t.indexOf(" ",i))<0)break;if(a=t.slice(i+1,e),(o=t.indexOf("</"+a+">",o))<0)break;o+=3+a.length}"<filter"==t.substr(i,7)?fulldefs+="\n"+t.slice(i,o):glyphs[n]=t.slice(i,o)}}function set_g(){stv_g.started&&(stv_g.started=!1,output+="</g>\n"),(1!=stv_g.scale||stv_g.color)&&(output+="<g ",1!=stv_g.scale&&(stv_g.st>=0?output+=staff_tb[stv_g.st].scale_str:output+=voice_tb[stv_g.v].scale_str),stv_g.color&&(1!=stv_g.scale&&(output+=" "),output+='style="color:'+stv_g.color+'"'),output+=">\n",stv_g.started=!0)}function set_color(t){if(t!=stv_g.color){var e=stv_g.color;return stv_g.color=t,set_g(),e}}function set_sscale(t){var e,r;t!=stv_g.st&&1!=stv_g.scale&&(stv_g.scale=0),e=t>=0?staff_tb[t].staffscale:1,r=t>=0&&1!=e?staff_tb[t].y:posy,e==stv_g.scale&&r==stv_g.dy||(stv_g.scale=e,stv_g.dy=r,stv_g.st=t,set_g())}function set_scale(t){var e=t.p_v.scale;if(1==e)return void set_sscale(t.st);e==stv_g.scale&&stv_g.dy==posy||(stv_g.scale=e,stv_g.dy=posy,stv_g.st=-1,stv_g.v=t.v,set_g())}function set_dscale(t,e){output&&(stv_g.st<0?staff_tb[0].output+=output:1==stv_g.scale?staff_tb[stv_g.st].output+=output:staff_tb[stv_g.st].sc_out+=output,output=""),stv_g.scale=t<0?1:e?1:staff_tb[t].staffscale,stv_g.st=t,stv_g.dy=0}function delayed_update(){var t;for(t=0;t<=nstaff;t++)staff_tb[t].sc_out&&(output+='<g transform="translate(0,'+(posy-staff_tb[t].y).toFixed(2)+") scale("+staff_tb[t].staffscale.toFixed(2)+')">\n'+staff_tb[t].sc_out+"</g>\n",staff_tb[t].sc_out=""),staff_tb[t].output&&(output+='<g transform="translate(0,'+(-staff_tb[t].y).toFixed(2)+')">\n'+staff_tb[t].output+"</g>\n",staff_tb[t].output="")}function anno_out(t,e,r){if(void 0!=t.istart){var n=t.type,a=t.ymx-t.ymn+4,i=t.wl||2,o=t.wr||2;t.grace&&(n=C.GRACE),r(e||anno_type[n],t.istart,t.iend,t.x-i-2,staff_tb[t.st].y+t.ymn+a-2,i+o+4,a,t)}}function a_start(t,e){anno_out(t,e,user.anno_start)}function a_stop(t,e){anno_out(t,e,user.anno_stop)}function empty_function(){}function out_XYAB(t,e,r,n,a){e=sx(e),r=sy(r),output+=t.replace(/X|Y|A|B|F|G/g,function(t){switch(t){case"X":return e.toFixed(2);case"Y":return r.toFixed(2);case"A":return n;case"B":return a;case"F":return n.toFixed(2);default:return a.toFixed(2)}})}function g_open(t,e,r,n,a){out_XYAB('<g transform="translate(X,Y',t,e),r&&(output+=") rotate("+r.toFixed(2)),n&&(output+=a?") scale("+n.toFixed(2)+", "+a.toFixed(2):") scale("+n.toFixed(2)),output+=')">\n',stv_g.g++}function g_close(){stv_g.g--,output+="</g>\n"}function sx(t){return stv_g.g?t:(t+posx)/stv_g.scale}function sy(t){return stv_g.g?t:1==stv_g.scale?posy-t:stv_g.st<0?(posy-t)/stv_g.scale:stv_g.dy-t}function out_sxsy(t,e,r){t=sx(t),r=sy(r),output+=t.toFixed(2)+e+r.toFixed(2)}function xypath(t,e,r){out_XYAB('<path class="A" d="mX Y\n',t,e,r?"fill":"stroke")}function xygl(t,e,r){var n=tgls[r];return n&&!glyphs[r]?(t+=n.x*stv_g.scale,e+=n.y,void(n.sc?out_XYAB('<text transform="translate(X,Y) scale(F)">B</text>\n',t,e,n.sc,n.c):out_XYAB('<text x="X" y="Y">A</text>\n',t,e,n.c))):glyphs[r]?(def_use(r),void out_XYAB('<use x="X" y="Y" xlink:href="#A"/>\n',t,e,r)):void error(1,null,"no definition of $1",r)}function out_acciac(t,e,r,n,a){a?(t-=1,e+=4):(t-=5,e-=4),out_XYAB('<path class="stroke" d="mX YlF G"/>\n',t,e,r,-n)}function out_bar(t,e,r,n){output+='<path class="stroke" stroke-width="1" '+(n?'stroke-dasharray="5,5" ':"")+'d="m'+(t+posx).toFixed(2)+" "+(posy-e).toFixed(2)+"v"+(-r).toFixed(2)+'"/>\n'}function out_bnum(t,e,r){out_XYAB('<text style="font-family:serif; font-style:italic; font-size:12px"\n\tx="X" y="Y" text-anchor="middle">A</text>\n',t,e,r.toString())}function out_brace(t,e,r){t+=posx-6,e=posy-e,r/=24,output+='<text transform="translate('+t.toFixed(2)+","+e.toFixed(2)+") scale(2.5,"+r.toFixed(2)+')">'+tgls.brace.c+"</text>\n"}function out_bracket(t,e,r){t+=posx-5,e=posy-e-3,r+=2,output+='<path class="fill"\n\td="m'+t.toFixed(2)+" "+e.toFixed(2)+"\n\tc10.5 1 12 -4.5 12 -3.5c0 1 -3.5 5.5 -8.5 5.5\n\tv"+r.toFixed(2)+'\n\tc5 0 8.5 4.5 8.5 5.5c0 1 -1.5 -4.5 -12 -3.5"/>\n'}function out_hyph(t,e,r){var n,a=25+3*(r/20|0);n=r>15?(r-15)/a|0:0,t+=(r-a*n-5)/2,out_XYAB('<path class="stroke" stroke-width="1.2"\n\tstroke-dasharray="5,A"\n\td="mX YhB"/>\n',t,e+6,Math.round((a-5)/stv_g.scale),a*n+5)}function out_stem(t,e,r,n,a,i){var o=n?GSTEM_XOFF:3.5,s=-r;if(r<0&&(o=-o),t+=o*stv_g.scale,stv_g.st<0&&(s/=stv_g.scale),out_XYAB('<path class="stroke" d="mX YvF"/>\n',t,e,s),a){if(output+='<path class="fill"\n\td="',e+=r,r>0)if(i)if(n)for(;--a>=0;)out_XYAB("MX Yl3 1.5 0 2 -3 -1.5z\n",t,e),e-=3;else for(e+=1;--a>=0;)out_XYAB("MX Yl7 3.2 0 3.2 -7 -3.2z\n",t,e),e-=5.4;else if(n)if(1==a)out_XYAB("MX Yc0.6 3.4 5.6 3.8 3 10\n\t1.2 -4.4 -1.4 -7 -3 -7\n",t,e);else for(;--a>=0;)out_XYAB("MX Yc1 3.2 5.6 2.8 3.2 8\n\t1.4 -4.8 -2.4 -5.4 -3.2 -5.2\n",t,e),e-=3.5;else if(1==a)out_XYAB("MX Yc0.6 5.6 9.6 9 5.6 18.4\n\t1.6 -6 -1.3 -11.6 -5.6 -12.8\n",t,e);else for(;--a>=0;)out_XYAB("MX Yc0.9 3.7 9.1 6.4 6 12.4\n\t1 -5.4 -4.2 -8.4 -6 -8.4\n",t,e),e-=5.4;else if(i){if(!n)for(e+=1;--a>=0;)out_XYAB("MX Yl7 -3.2 0 -3.2 -7 3.2z\n",t,e),e+=5.4}else if(n)if(1==a)out_XYAB("MX Yc0.6 -3.4 5.6 -3.8 3 -10\n\t1.2 4.4 -1.4 7 -3 7\n",t,e);else for(;--a>=0;)out_XYAB("MX Yc1 -3.2 5.6 -2.8 3.2 -8\n\t1.4 4.8 -2.4 5.4 -3.2 5.2\n",t,e),e+=3.5;else if(1==a)out_XYAB("MX Yc0.6 -5.6 9.6 -9 5.6 -18.4\n\t1.6 6 -1.3 11.6 -5.6 12.8\n",t,e);else for(;--a>=0;)out_XYAB("MX Yc0.9 -3.7 9.1 -6.4 6 -12.4\n\t1 5.4 -4.2 8.4 -6 8.4\n",t,e),e+=5.4;output+='"/>\n'}}function out_thbar(t,e,r){t+=posx+1.5,e=posy-e,output+='<path class="stroke" stroke-width="3" d="m'+t.toFixed(2)+" "+e.toFixed(2)+"v"+(-r).toFixed(2)+'"/>\n'}function out_trem(t,e,r){for(out_XYAB('<path class="fill" d="mX Y\n\t',t-4.5,e);;){if(output+="l9 -3v3l-9 3z",--r<=0)break;output+="m0 5.4"}output+='"/>\n'}function out_tubr(t,e,r,n,a){var i=a?-3:3;e+=i,r/=stv_g.scale,output+='<path class="stroke" d="m',out_sxsy(t," ",e),output+="v"+i.toFixed(2)+"l"+r.toFixed(2)+" "+(-n).toFixed(2)+"v"+(-i).toFixed(2)+'"/>\n'}function out_tubrn(t,e,r,n,a,i){var o=10*i.length,s=a?-3:3;out_XYAB('<text style="font-family:serif; font-style:italic; font-size:12px"\n\tx="X" y="Y" text-anchor="middle">A</text>\n',t+r/2,e+n/2,i),r/=stv_g.scale,a||(e+=6),output+='<path class="stroke" d="m',out_sxsy(t," ",e),output+="v"+s.toFixed(2)+"m"+r.toFixed(2)+" "+(-n).toFixed(2)+"v"+(-s).toFixed(2)+'"/>\n<path class="stroke" stroke-dasharray="'+((r-o)/2).toFixed(2)+" "+o.toFixed(2)+'" d="m',out_sxsy(t," ",e-s),output+="l"+r.toFixed(2)+" "+(-n).toFixed(2)+'"/>\n'}function out_wln(t,e,r){out_XYAB('<path class="stroke" stroke-width="0.8" d="mX YhF"/>\n',t,e+3,r)}function out_deco_str(t,e,r,n){var a=deco_str_style[r];if(!a)return void xygl(t,e,r);t+=a.dx,e+=a.dy,a.def||(style+="\n."+r+" {"+a.style+"}",a.def=!0),out_XYAB('<text x="X" y="Y" class="A"B>',t,e,r,a.anchor||""),set_font("annotation"),out_str(n),output+="</text>\n"}function out_arp(t,e,r){for(g_open(t,e,270),t=0,e=-4,r=Math.ceil(r/6);--r>=0;)xygl(t,e,"ltr"),t+=6;g_close()}function out_cresc(t,e,r,n){t+=r,r=-r,out_XYAB('<path class="stroke"\n\td="mX YlA ',t,e+5,r),n.nost?output+="-2.2m0 -3.6l"+(-r).toFixed(2)+' -2.2"/>\n':output+="-4l"+(-r).toFixed(2)+' -4"/>\n'}function out_dim(t,e,r,n){out_XYAB('<path class="stroke"\n\td="mX YlA ',t,e+5,r),n.noen?output+="-2.2m0 -3.6l"+(-r).toFixed(2)+' -2.2"/>\n':output+="-4l"+(-r).toFixed(2)+' -4"/>\n'}function out_ltr(t,e,r){for(e+=4,r=Math.ceil(r/6);--r>=0;)xygl(t,e,"ltr"),t+=6}function out_8va(t,e,r,n){n.nost?r-=5:(out_XYAB('<text x="X" y="Y" style="font-family:serif; font-weight:bold; font-style:italic; font-size:12px">8<tspan dy="-4" style="font-size:10px">va</tspan></text>\n',t-8,e),t+=12,r-=12),e+=6,out_XYAB('<path class="stroke" stroke-dasharray="6,6" d="mX YhA"/>\n',t,e,r),n.noen||out_XYAB('<path class="stroke" d="mX Yv6"/>\n',t+r,e)}function out_8vb(t,e,r,n){n.nost?r-=5:(out_XYAB('<text x="X" y="Y" style="font-family:serif; font-weight:bold; font-style:italic; font-size:12px">8<tspan dy="-4" style="font-size:10px">vb</tspan></text>\n',t-8,e),t+=4,r-=4),out_XYAB('<path class="stroke" stroke-dasharray="6,6" d="mX YhA"/>\n',t,e,r),n.noen||out_XYAB('<path class="stroke" d="mX Yv-6"/>\n',t+r,e)}function out_15ma(t,e,r,n){n.nost?r-=5:(out_XYAB('<text x="X" y="Y" style="font-family:serif; font-weight:bold; font-style:italic; font-size:12px">15<tspan dy="-4" style="font-size:10px">ma</tspan></text>\n',t-10,e),t+=20,r-=20),e+=6,out_XYAB('<path class="stroke" stroke-dasharray="6,6" d="mX YhA"/>\n',t,e,r),n.noen||out_XYAB('<path class="stroke" d="mX Yv6"/>\n',t+r,e)}function out_15mb(t,e,r,n){n.nost?r-=5:(out_XYAB('<text x="X" y="Y" style="font-family:serif; font-weight:bold; font-style:italic; font-size:12px">15<tspan dy="-4" style="font-size:10px">mb</tspan></text>\n',t-10,e),t+=7,r-=7),out_XYAB('<path class="stroke" stroke-dasharray="6,6" d="mX YhA"/>\n',t,e,r),n.noen||out_XYAB('<path class="stroke" d="mX Yv-6"/>\n',t+r,e)}function out_deco_val(t,e,r,n,a){deco_val_tb[r]?deco_val_tb[r](t,e,n,a):error(1,null,"No function for decoration '$1'",r)}function out_glisq(t,e,r){var n=r.start,a=n.x,i=n.y+staff_tb[n.st].y,o=-Math.atan2(e-i,t-a),s=o/Math.PI*180,c=(t-a)/Math.cos(o);for(g_open(a,i,s),a=n.s.dots?13+n.s.xmx:8,c=(c-a-6)/6|0,c<1&&(c=1);--c>=0;)xygl(a,0,"ltr"),a+=6;g_close()}function out_gliss(t,e,r){var n=r.start,a=n.x,i=n.y+staff_tb[n.st].y,o=-Math.atan2(e-i,t-a),s=o/Math.PI*180,c=(t-a)/Math.cos(o);g_open(a,i,s),a=n.s.dots?13+n.s.xmx:8,c-=a+8,xypath(a,0),output+="l"+c.toFixed(2)+' 0" stroke-width="1"/>\n',g_close()}function out_deco_long(t,e,r){var n=r.dd.glyph;deco_l_tb[n]?deco_l_tb[n](t,e,r):error(1,null,"No function for decoration '$1'",n)}function vskip(t){posy+=t}function svg_flush(){if(!multicol&&output&&user.img_out&&0!=posy){var t='<svg xmlns="http://www.w3.org/2000/svg" version="1.1"\n\txmlns:xlink="http://www.w3.org/1999/xlink"\n\tcolor="black" class="music" stroke-width=".7"',e="";cfmt.bgcolor&&(t+=' style="background-color: '+cfmt.bgcolor+'"'),posy*=cfmt.scale,user.imagesize?t+="\n"+user.imagesize+' viewBox="0 0 '+img.width.toFixed(0)+" "+posy.toFixed(0)+'">\n':t+='\n\twidth="'+img.width.toFixed(0)+'px" height="'+posy.toFixed(0)+'px">\n',(style||font_style||musicfont)&&(t+='<style type="text/css">'+style+font_style,musicfont&&(musicfont.indexOf("(")>0?t+="\n.music {font-family: music; font-size: 24px; fill: currentColor}\n@font-face {\n  font-family: music;\n  src: "+musicfont+"}":t+="\n.music {font-family: "+musicfont+"; font-size: 24px; fill: currentColor}"),t+="\n</style>\n"),defs+=fulldefs,defs&&(t+="<defs>"+defs+"\n</defs>\n"),1!=cfmt.scale&&(t+='<g class="g" transform="scale('+cfmt.scale.toFixed(2)+')">\n',e="</g>\n"),psvg&&psvg.ps_flush(!0),user.img_out(t+output+e+"</svg>"),output="",font_style="",cfmt.fullsvg?(defined_glyph={},defined_font={}):(musicfont="",style="",fulldefs=""),defs="",posy=0}}function blk_out(){!multicol&&user.img_out&&(blk_flush(),user.page_format&&!block.started&&(block.started=!0,block.newpage?(block.newpage=!1,user.img_out('<div class="nobrk newpage">')):user.img_out('<div class="nobrk">')))}function blk_flush(){svg_flush(),block.started&&(block.started=!1,user.img_out("</div>"))}function voice_filter(){var t,e,r;for(t in parse.voice_opts)if(parse.voice_opts.hasOwnProperty(t)&&(e=new RegExp(t),e.test(curvoice.id)||e.test(curvoice.nm)))for(r in parse.voice_opts[t])parse.voice_opts[t].hasOwnProperty(r)&&do_pscom(parse.voice_opts[t][r])}function sym_link(t){t.fname||set_ref(t),curvoice.ignore||(parse.last_sym=t,t.prev=curvoice.last_sym,curvoice.last_sym?curvoice.last_sym.next=t:curvoice.sym=t,curvoice.last_sym=t),t.v=curvoice.v,t.p_v=curvoice,t.st=curvoice.cst,t.time=curvoice.time,t.dur&&!t.grace&&(curvoice.time+=t.dur),t.pos=curvoice.pos,curvoice.second&&(t.second=!0),curvoice.floating&&(t.floating=!0)}function sym_add(t,e){var r,n={type:e,dur:0},a=curvoice;return curvoice=t,sym_link(n),curvoice=a,r=n.prev,r||(r=n.next),r&&(n.fname=r.fname,n.istart=r.istart,n.iend=r.iend),n}function mrest_expand(t){var e,r,n,a=t.nmes,i=t.dur/a,o=t.a_dd;for(t.type=C.REST,t.dur=i,t.head=C.FULL,t.nflags=-2,n=t.next,e=t.p_v,e.last_sym=t,e.time=t.time+i,e.cst=t.st,r=t;--a>0;)r=sym_add(e,C.BAR),r.bar_type="|",r=sym_add(e,C.REST),t.invis&&(r.invis=!0),r.dur=i,r.head=C.FULL,r.nflags=-2,e.time+=i;r.next=n,n&&(n.prev=r),r.a_dd=o}function sort_all(){var t,e,r,n,a,i,o,s,c,l,u,f,$=voice_tb.length,_=[],d=[],p=-1;for(e=0;e<$;e++)_.push(voice_tb[e].sym);for(var h=1,g=cur_sy;;){if(g&&h)for(f=g,g=null,o=-1,d=[],e=0;e<$;e++)f.voices[e]?(i=f.voices[e].range)<0||(d[i]=e,o++):f.voices[e]={range:-1};for(a=r=1e6,i=0;i<$&&void 0!=(e=d[i]);i++)!(t=_[e])||t.time>r||(n=w_tb[t.type],t.time<r?(r=t.time,a=n):n<a&&(a=n),t.type==C.MREST&&(1==t.nmes?mrest_expand(t):o>0&&(p=r)));if(a>127)break;if(r==p){for(c=0,i=0;i<$&&void 0!=(e=d[i]);i++)if((t=_[e])&&t.time==r&&w_tb[t.type]==a){if(t.type!=C.MREST){p=-1;break}if(0==c)c=t.nmes;else if(c!=t.nmes){p=-1;break}}if(p<0)for(i=0;i<$&&void 0!=(e=d[i]);i++)(t=_[e])&&t.type==C.MREST&&mrest_expand(t)}for(i=0;i<$&&void 0!=(e=d[i]);i++)if((t=_[e])&&t.time==r&&w_tb[t.type]==a){if(t.type==C.STAVES){for(g=t.sy,l=0;l<$&&void 0!=d[l];l++);for(u=0;u<$;u++)g.voices[u]&&((i=g.voices[u].range)<0||f.voices[u].range>=0||(d[l++]=u))}h&&(h=0,t.seqst=!0),t.ts_prev=s,s?s.ts_next=t:tsfirst=t,s=t,_[e]=t.next}h=a}}function voice_adj(){var t,e,r,n;for(e=glovar.tempo,e&&staves_found<=0&&(n=par_sy.top_voice,t=voice_tb[n],t.sym&&t.sym.type!=C.TEMPO&&(e=clone(e),e.v=n,e.p_v=t,e.st=t.st,e.time=0,e.next=t.sym,e.next&&(e.next.prev=e),t.sym=e)),n=0;n<voice_tb.length;n++){for(t=voice_tb[n],t.ignore&&(t.ignore=!1),e=t.sym;e&&!(e.time>=staves_found);e=e.next);for(;e;e=e.next){switch(e.type){case C.GRACE:if(e.next&&e.next.type==C.BAR&&e.time--,!cfmt.graceword)continue;for(r=e.next;r;r=r.next){switch(r.type){case C.SPACE:continue;case C.NOTE:if(!r.a_ly)break;e.a_ly=r.a_ly,r.a_ly=null}break}continue}e.feathered_beam&&function(t){var e,r,n,a,i,o,s,a=t.dur,c=1;for(e=t;e&&!e.beam_end&&e.next;e=e.next)c++;if(c<=1)return void delete t.feathered_beam;if(r=e,i=a/2,s=a/(c-1),n=t.time,t.feathered_beam>0)for(e=t,o=c-1;e!=r;e=e.next,o--)a=(s*o|0)+i,e.dur=a,e.time=n,n+=a;else for(e=t,o=0;e!=r;e=e.next,o++)a=(s*o|0)+i,e.dur=a,e.time=n,n+=a;e.dur=e.time+e.dur-n,e.time=n}(e)}}}function dupl_voice(){var t,e,r,n,a,i,o,s,c=voice_tb.length;for(o=0;o<c;o++)if(t=voice_tb[o],e=t.clone){for(t.clone=null,r=t.sym;r&&!(r.time>=staves_found);r=r.next);for(e.clef=clone(t.clef),curvoice=e;r;r=r.next)if(r.type!=C.STAVES){if(n=clone(r),r.notes)for(n.notes=[],s=0;s<=r.nhd;s++)n.notes.push(clone(r.notes[s]));if(sym_link(n),e.second?n.second=!0:delete n.second,e.floating?n.floating=!0:delete n.floating,delete n.a_ly,a=n.extra)for(i=clone(a),n.extra=i,n=i,n.v=e.v,n.p_v=e,n.st=e.st,a=a.next;a;a=a.next){if(i=clone(a),a.notes)for(i.notes=[],s=0;s<=a.nhd;s++)i.notes.push(clone(a.notes[s]));n.next=i,i.prev=n,n=i,n.v=e.v,n.p_v=e,n.st=e.st}}}}function new_syst(t){var e,r,n={voices:[],staves:[],top_voice:0};if(t)return void(cur_sy=par_sy=n);for(r=0;r<voice_tb.length;r++){e=par_sy.voices[r].st;var a=par_sy.staves[e],i=voice_tb[r];void 0!=i.staffnonote&&(a.staffnonote=i.staffnonote),i.staffscale&&(a.staffscale=i.staffscale),n.voices[r]=clone(par_sy.voices[r]),n.voices[r].range=-1,delete n.voices[r].second}for(e=0;e<par_sy.staves.length;e++)n.staves[e]=clone(par_sy.staves[e]),n.staves[e].flags=0;par_sy.next=n,par_sy=n}function set_bar_num(){var t,e,r,n,a,i,o=cur_sy.top_voice,s=voice_tb[o].meter.wmeasure,c=gene.nbar;for(t=tsfirst;;t=t.ts_next){if(!t)return;switch(t.type){case C.METER:s=t.wmeasure;case C.CLEF:case C.KEY:case C.STBRK:continue;case C.BAR:if(t.bar_num){gene.nbar=t.bar_num;break}t.text&&!cfmt.contbarnb&&("1"==t.text[0]?c=gene.nbar:(gene.nbar=c,t.bar_num=gene.nbar))}break}if(n=t.time+s,0==t.time)for(e=t.ts_next;e;e=e.ts_next)if(e.type==C.BAR&&e.time){e.time<n&&(t=e,n=t.time+s);break}for(a=gene.nbar;t;t=t.ts_next)switch(t.type){case C.METER:s=t.wmeasure,t.time<n&&(n=t.time+s);break;case C.MREST:for(a+=t.nmes-1;t.ts_next&&t.ts_next.type!=C.BAR;)t=t.ts_next;break;case C.BAR:if(t.bar_num&&(a=t.bar_num),t.time<n){t.text&&"1"==t.text[0]&&(c=a,i=n-t.time);break}r=t.time,e=t;do{if(e.dur)break;if(e.type==C.BAR&&e.text)break;e=e.next}while(e&&e.time==r);if(a++,e&&e.type==C.BAR&&e.text)if("1"==e.text[0])i=0,c=a;else if(cfmt.contbarnb||(a=c),i){cfmt.contbarnb&&a--,n=r+i;break}for(t.bar_num=a,n=r+s;t.ts_next&&!t.ts_next.seqst;)t=t.ts_next}cfmt.measurenb<0&&(gene.nbar=a)}function get_map(t){if(t){var e,r,n,a,i,o,s=info_split(t,2);if(s.length<3)return void syntax(1,"Not enough parameters in %%map");if(o=s[1],0==o.indexOf("octave,")||0==o.indexOf("key,"))o=o.replace(/[,']+$/m,"").toLowerCase(),"k"==o[0]&&(o=o.replace(/[_=^]+/,""));else if("*"==o[0]||0==o.indexOf("all"))o="all";else{if(i=new scanBuf,i.buffer=s[1],!(r=parse_acc_pit(i)))return void syntax(1,"Bad note in %%map");for(o="abcdefg"[(r.pit+77)%7],r.acc&&(o=["__","_","","^","^^","="][r.acc+2]+o),e=r.pit;e>=28;e-=7)o+="'";for(e=r.pit;e<21;e+=7)o+=","}if(n=maps[s[0]],n||(maps[s[0]]=n={}),a=n[o],a||(n[o]=a=[]),s[2]){if(e=2,s[2].indexOf("=")<0){if("*"!=s[2][0]&&(i=new scanBuf,i.buffer=s[2],a[1]=parse_acc_pit(i)),!s[3])return;e++,s[3].indexOf("=")<0&&(a[0]=s[3].split(","),e++)}for(;e<s.length;e++)switch(s[e]){case"heads=":a[0]=s[++e].split(",");break;case"print=":i=new scanBuf,i.buffer=s[++e],a[1]=parse_acc_pit(i);break;case"color=":a[2]=s[++e]}}}}function set_transp(){var t,e,r;if(!curvoice.ckey.k_bagpipe&&!curvoice.ckey.k_drum&&(cfmt.transp&&curvoice.transp&&syntax(0,"Mix of old and new transposition syntaxes"),e=(cfmt.transp||0)+(curvoice.transp||0)+(curvoice.shift||0),r=curvoice.vtransp||0,e!=r)){if(curvoice.vtransp=e,!(t=curvoice.last_sym))return curvoice.key=clone(curvoice.okey),key_transp(curvoice.key),curvoice.ckey=clone(curvoice.key),void(curvoice.key.k_none&&(curvoice.key.k_sf=0));for(;;){if(t.type==C.KEY)break;if(!t.prev){t=curvoice.key;break}t=t.prev}key_transp(t),curvoice.ckey=clone(t),curvoice.key.k_none&&(t.k_sf=0)}}function set_ottava(t){if(!cfmt.sound)switch(t){case"15ma(":curvoice.ottava=-14;break;case"8va(":curvoice.ottava=-7;break;case"8vb(":curvoice.ottava=7;break;case"15mb(":curvoice.ottava=14;break;case"15ma)":case"8va)":case"8vb)":case"15mb)":curvoice.ottava=0}}function do_pscom(t){var e,r,n,a,i,o,s,c,l=!1;if(" lock"==t.slice(-5)&&(l=!0,t=t.slice(0,-5).trim()),a=t.match(/(\w|-)+/)){switch(a=a[0],i=t.replace(a,"").trim(),a){case"center":return parse.state>=2?(n=new_block("text"),n.text=cnv_escape(i),void(n.opt="c")):void write_text(cnv_escape(i),"c");case"clef":return void(parse.state>=2&&(2==parse.state&&goto_tune(),(n=new_clef(i))&&get_clef(n)));case"deco":return void deco_add(i);case"linebreak":return void set_linebreak(i);case"map":return void get_map(i);case"maxsysstaffsep":if(3==parse.state)return void(par_sy.voices[curvoice.v].maxsep=get_unit(i));break;case"multicol":switch(generate(),i){case"start":blk_out(),multicol={posy:posy,maxy:posy,lmarg:cfmt.leftmargin,
rmarg:cfmt.rightmargin,state:parse.state};break;case"new":if(!multicol){syntax(1,"%%multicol new without start");break}posy>multicol.maxy&&(multicol.maxy=posy),cfmt.leftmargin=multicol.lmarg,cfmt.rightmargin=multicol.rmarg,img.chg=!0,set_page(),posy=multicol.posy;break;case"end":if(!multicol){syntax(1,"%%multicol end without start");break}posy<multicol.maxy&&(posy=multicol.maxy),cfmt.leftmargin=multicol.lmarg,cfmt.rightmargin=multicol.rmarg,multicol=void 0,blk_flush(),img.chg=!0,set_page();break;default:syntax(1,"Unknown keyword '$1' in %%multicol",i)}return;case"musicfont":return void(musicfont=i);case"ottava":if(3!=parse.state){if(2!=parse.state)return;goto_tune()}if(o=parseInt(i),isNaN(o)||o<-2||o>2)return void syntax(1,errs.bad_val,"%%ottava");switch(curvoice.ottava){case 14:c="15mb)";break;case 7:c="8vb)";break;case-7:c="8va)";break;case-14:c="15ma)"}switch(c&&(a_dcn||(a_dcn=[]),a_dcn.push(c),set_ottava(c)),o){case-2:c="15mb(";break;case-1:c="8vb(";break;case 0:return;case 1:c="8va(";break;case 2:c="15ma("}return a_dcn||(a_dcn=[]),a_dcn.push(c),void set_ottava(c);case"repbra":return void(parse.state>=2&&(2==parse.state&&goto_tune(),curvoice.norepbra=!get_bool(i)));case"repeat":if(3!=parse.state)return;if(!curvoice.last_sym)return void syntax(1,"%%repeat cannot start a tune");if(i.length){if(c=i.split(/\s+/),o=parseInt(c[0]),s=parseInt(c[1]),isNaN(o)||o<1||curvoice.last_sym.type==C.BAR&&o>2)return void syntax(1,"Incorrect 1st value in %%repeat");if(isNaN(s))s=1;else if(s<1)return void syntax(1,"Incorrect 2nd value in %%repeat")}else o=1,s=1;return parse.repeat_n=curvoice.last_sym.type==C.BAR?o:-o,void(parse.repeat_k=s);case"sep":var u,f,$,_;return set_page(),(_=img.width-img.lm-img.rm,e=u=f=0,i&&($=i.split(/\s+/),e=get_unit($[0]),$[1]&&(u=get_unit($[1]),$[2]&&(f=get_unit($[2])))),e<1&&(e=14),u<1&&(u=e),f<1&&(f=90),parse.state>=2)?(n=new_block(a),n.x=(_-f)/2/cfmt.scale,n.l=f/cfmt.scale,n.sk1=e,void(n.sk2=u)):(blk_out(),vskip(e),output+='<path class="stroke"\n\td="M',out_sxsy((_-f)/2/cfmt.scale," ",0),output+="h"+(f/cfmt.scale).toFixed(2)+'"/>\n',vskip(u),void blk_flush());case"setbarnb":return r=parseInt(i),void(isNaN(r)?syntax(1,"Bad %%setbarnb value"):parse.state>=2?glovar.new_nbar=r:cfmt.measurefirst=r);case"staff":if(3!=parse.state){if(2!=parse.state)return;goto_tune()}if(r=parseInt(i),isNaN(r))return void syntax(1,"Bad %%staff value '$1'",i);var d;return(d="+"==i[0]||"-"==i[0]?curvoice.cst+r:r-1)<0||d>nstaff?void syntax(1,"Bad %%staff number $1 (cur $2, max $3)",d,curvoice.cst,nstaff):(delete curvoice.floating,void(curvoice.cst=d));case"staffbreak":if(3!=parse.state){if(2!=parse.state)return;goto_tune()}return n={type:C.STBRK,dur:0},i[0]>="0"&&i[0]<="9"?(n.xmx=get_unit(i),"f"==i.slice(-1)&&(n.stbrk_forced=!0)):(n.xmx=14,"f"==i[0]&&(n.stbrk_forced=!0)),void sym_link(n);case"stafflines":case"staffscale":case"staffnonote":return void set_v_param(a,i);case"staves":case"score":if(0==parse.state)return;return void get_staves(a,i);case"sysstaffsep":if(3==parse.state)return void(par_sy.voices[curvoice.v].sep=get_unit(i));break;case"text":return parse.state>=2?(n=new_block(a),n.text=cnv_escape(i),void(n.opt=cfmt.textoption)):void write_text(cnv_escape(i),cfmt.textoption);case"transpose":if(cfmt.sound)return;switch(parse.state){case 0:cfmt.transp=0;case 1:case 2:return void(cfmt.transp=(cfmt.transp||0)+get_transp(i))}for(n=curvoice.last_sym;n;n=n.prev){switch(n.type){case C.NOTE:n=clone(curvoice.okey),n.k_old_sf=curvoice.ckey.k_sf,sym_link(n);break;case C.KEY:break;default:continue}break}return void do_info("V",curvoice.id+" shift="+i);case"tune":return;case"user":return void set_user(i);case"voicecolor":if(3!=parse.state){if(2!=parse.state)return;goto_tune()}return void(curvoice.color=i);case"vskip":return(r=get_unit(i))<0?void syntax(1,"%%vskip cannot be negative"):parse.state>=2?(n=new_block(a),void(n.sk=r)):void vskip(r);case"newpage":case"leftmargin":case"rightmargin":case"pagescale":case"pagewidth":case"printmargin":case"scale":case"staffwidth":if(3==parse.state)return n=new_block(a),void(n.param=i);if("newpage"==a)return blk_flush(),void(block.newpage=!0)}set_format(a,i,l)}}function do_begin_end(t,e,r){var n,a,i,o;switch(t){case"js":js_inject(r);break;case"ml":parse.state>=2?(o=new_block(t),o.text=r):(svg_flush(),user.img_out(r));break;case"svg":for(a=0;;){if((n=r.indexOf('<style type="text/css">\n',a))<0)break;if((a=r.indexOf("</style>",n))<0){syntax(1,"No </style> in %%beginsvg sequence");break}style+=r.slice(n+23,a).replace(/\s+$/,"")}for(a=0;;){if((n=r.indexOf("<defs>\n",a))<0)break;if((a=r.indexOf("</defs>",n))<0){syntax(1,"No </defs> in %%beginsvg sequence");break}defs_add(r.slice(n+6,a))}break;case"text":if(i=get_textopt(e),i||(i=cfmt.textoption),parse.state>=2){o=new_block(t),o.text=cnv_escape(r),o.opt=i;break}write_text(cnv_escape(r),i)}}function generate(){var t,e;if(vover&&(syntax(1,"No end of voice overlay"),get_vover(vover.bar?"|":")")),0!=voice_tb.length&&(voice_adj(),dupl_voice(),sort_all(),tsfirst&&(set_bar_num(),tsfirst))){for(user.get_abcmodel&&user.get_abcmodel(tsfirst,voice_tb,anno_type,info),user.img_out&&output_music(),t=0;t<voice_tb.length;t++)e=voice_tb[t],e.time=0,e.sym=e.last_sym=null,e.st=cur_sy.voices[t].st,e.second=cur_sy.voices[t].second,delete e.have_ly,e.hy_st=0,delete e.bar_start,delete e.slur_st,delete e.s_tie,delete e.s_rtie;staves_found=0}}function key_transp(t){var e=curvoice.vtransp/3|0,r=(-2&e)+7*(1&e)+t.k_sf;switch((curvoice.vtransp+210)%3){case 1:r=(r+4+48)%12-4;break;case 2:r=(r+7+48)%12-7;break;default:r=(r+5+48)%12-5}t.k_sf=r,t.k_delta=cgd2cde[(r+7)%7]}function set_k_acc(t){var e,r,n,a,i,o=[],s=[],c=[],l=[];if(t.k_sf>0)for(a=0;a<t.k_sf;a++)o[a]=1,s[a]=[26,23,27,24,21,25,22][a];else for(a=0;a<-t.k_sf;a++)o[a]=-1,s[a]=[22,25,21,24,20,23,26][a];for(n=t.k_a_acc.length,e=0;e<n;e++){for(i=t.k_a_acc[e],r=0;r<a;r++)if(s[r]==i.pit){o[r]=i.acc,i.micro_n&&(c[r]=i.micro_n,l[r]=i.micro_d);break}r==a&&(o[r]=i.acc,s[r]=i.pit,i.micro_n&&(c[r]=i.micro_n,l[r]=i.micro_d),a++)}for(e=0;e<a;e++)i=t.k_a_acc[e],i||(i=t.k_a_acc[e]={}),i.acc=o[e],i.pit=s[e],c[e]?(i.micro_n=c[e],i.micro_d=l[e]):(delete i.micro_n,delete i.micro_d)}function acc_same_pitch(t){var e,r,n=curvoice.last_sym.prev;if(n)for(r=n.time;n;n=n.prev)switch(n.type){case C.BAR:if(n.time<r)return;for(;;){if(!(n=n.prev))return;if(n.type==C.NOTE){if(n.time+n.dur==r)break;return}if(n.time<r)return}for(e=0;e<=n.nhd;e++)if(n.notes[e].pit==t&&n.notes[e].ti1)return n.notes[e].acc;return;case C.NOTE:for(e=0;e<=n.nhd;e++)if(n.notes[e].pit==t)return n.notes[e].acc}}function get_staves(t,e){var r,n,a,i,o,s,c,l,u,f=parse_staves(e);if(f){0!=voice_tb.length&&(voice_adj(),dupl_voice());var $=0,_=!0;for(s=0;s<voice_tb.length;s++)n=voice_tb[s],n.time>$&&($=n.time),n.sym&&(_=!1);if(_||0==$&&staves_found<0)for(s=0;s<par_sy.voices.length;s++)par_sy.voices[s].range=-1;else{for(s=0;s<par_sy.voices.length;s++)if(par_sy.voices[s].range>=0){curvoice=voice_tb[s];break}curvoice.time=$,r={type:C.STAVES,dur:0},sym_link(r),par_sy.nstaff=nstaff,new_syst(),r.sy=par_sy}for(staves_found=$,s=0;s<voice_tb.length;s++)n=voice_tb[s],delete n.second,delete n.ignore,delete n.floating;for(u=0,i=0;i<f.length;i++){if(c=f[i][0],n=new_voice(c),n.time=$,s=n.v,0==i&&(par_sy.top_voice=n.v),par_sy.voices[s].range>=0){for(a=clone(n),par_sy.voices[voice_tb.length]=clone(par_sy.voices[s]),s=voice_tb.length,a.v=s,a.sym=a.last_sym=null,a.time=$,voice_tb.push(a),delete a.clone;n.clone;)n=n.clone;n.clone=a,n=a}f[i][0]=n,par_sy.voices[s].range=u++}if("t"==t[1])for(i=0;i<f.length;i++)(o=f[i][1])&(OPEN_BRACE|OPEN_BRACE2)&&(o&(OPEN_BRACE|CLOSE_BRACE))!=(OPEN_BRACE|CLOSE_BRACE)&&(o&(OPEN_BRACE2|CLOSE_BRACE2))!=(OPEN_BRACE2|CLOSE_BRACE2)&&0==f[i+1][1]&&(o&OPEN_PARENTH||f[i+2][1]&OPEN_PARENTH||(f[i+2][1]&(CLOSE_BRACE|CLOSE_BRACE2)?f[i+1][1]|=FL_VOICE:0==f[i+2][1]&&f[i+3][1]&(CLOSE_BRACE|CLOSE_BRACE2)&&(f[i][1]|=OPEN_PARENTH,f[i+1][1]|=CLOSE_PARENTH,f[i+2][1]|=OPEN_PARENTH,f[i+3][1]|=CLOSE_PARENTH)));for(l=-1,i=0;i<f.length;i++)if(o=f[i][1],(o&(OPEN_PARENTH|CLOSE_PARENTH))==(OPEN_PARENTH|CLOSE_PARENTH)&&(o&=~(OPEN_PARENTH|CLOSE_PARENTH),f[i][1]=o),n=f[i][0],o&FL_VOICE?(n.floating=!0,n.second=!0):(l++,par_sy.staves[l]||(par_sy.staves[l]={stafflines:"|||||",staffscale:1}),par_sy.staves[l].flags=0),s=n.v,n.st=n.cst=par_sy.voices[s].st=l,par_sy.staves[l].flags|=o,o&OPEN_PARENTH){for(a=n;i<f.length-1&&(n=f[++i][0],s=n.v,f[i][1]&MASTER_VOICE?(a.second=!0,a=n):n.second=!0,n.st=n.cst=par_sy.voices[s].st=l,!(f[i][1]&CLOSE_PARENTH)););par_sy.staves[l].flags|=f[i][1]}if(l<0&&(l=0),par_sy.nstaff=nstaff=l,"c"==t[1])for(l=0;l<nstaff;l++)par_sy.staves[l].flags^=STOP_BAR;for(s=0;s<voice_tb.length;s++)n=voice_tb[s],par_sy.voices[s].range<0?n.ignore=!0:(par_sy.voices[s].second=n.second,!((l=n.st)>0)||n.norepbra||par_sy.staves[l-1].flags&STOP_BAR||(n.norepbra=!0));curvoice=parse.state>=2?voice_tb[par_sy.top_voice]:null}}function get_vover(t){function e(t){var e,r;for(e=0;e<voice_tb.length;e++)if(r=voice_tb[e],r.id==t)return r;return r=clone(curvoice),r.v=voice_tb.length,r.id=t,r.sym=r.last_sym=null,delete r.nm,delete r.snm,delete r.new_name,delete r.lyric_restart,delete r.lyric_cont,delete r.ly_a_h,delete r.sym_restart,delete r.sym_cont,voice_tb.push(r),r}var r,n,a,i,o,s,c,l;parse.line;if(!curvoice.ignore){if("|"==t||")"==t)return curvoice.last_note?(curvoice.last_note.beam_end=!0,vover?(curvoice.time!=vover.p_voice.time&&(syntax(1,"Wrong duration in voice overlay"),curvoice.time>vover.p_voice.time&&(vover.p_voice.time=curvoice.time)),curvoice=vover.p_voice,void(vover=null)):void syntax(1,"Erroneous end of voice overlay")):void syntax(1,errs.nonote_vo);if("("==t)return vover?void syntax(1,"Voice overlay already started"):void(vover={p_voice:curvoice,time:curvoice.time});if(!curvoice.last_note)return void syntax(1,errs.nonote_vo);if(curvoice.last_note.beam_end=!0,!(r=curvoice.voice_down)){r=e(curvoice.id+"o"),curvoice.voice_down=r,r.time=0,r.second=!0,c=r.v,par_sy.voices[c]={st:curvoice.st,second:!0};var u=void 0!=curvoice.clone?1:0;for(a=par_sy.voices[curvoice.v].range,s=0;s<par_sy.voices.length;s++)par_sy.voices[s].range>a&&(par_sy.voices[s].range+=u+1);par_sy.voices[c].range=a+1,u&&(n=e(r.id+"c"),n.second=!0,l=n.v,par_sy.voices[l]={second:!0,range:a+2},r.clone=n)}if(r.ulen=curvoice.ulen,r.dur_fact=curvoice.dur_fact,curvoice.uscale&&(r.uscale=curvoice.uscale),vover)curvoice!=vover.p_voice&&curvoice.time!=vover.p_voice.time&&(syntax(1,"Wrong duration in voice overlay"),curvoice.time>vover.p_voice.time&&(vover.p_voice.time=curvoice.time));else{for(vover={bar:!0,p_voice:curvoice},o=r.time,i=curvoice.last_sym;!(i.type==C.BAR||i.time<=o);i=i.prev);vover.time=i.time}r.time=vover.time,curvoice=r}}function is_voice_sig(){var t;if(!curvoice.sym)return!0;if(0!=curvoice.time)return!1;for(t=curvoice.last_sym;t;t=t.prev)if(0!=w_tb[t.type])return!1;return!0}function get_clef(t){var e,r;if(is_voice_sig())return void(curvoice.clef=t);for(e=curvoice.last_sym;e&&e.prev&&e.time==curvoice.time&&0==w_tb[e.type];e=e.prev);if(e&&e.prev&&e.time==curvoice.time&&(e.type==C.KEY&&!e.k_none||e.type==C.BAR)){for(r=e;r.prev;r=r.prev){switch(r.prev.type){case C.KEY:case C.BAR:continue}break}e=curvoice.last_sym,curvoice.last_sym=r.prev,sym_link(t),t.next=r,r.prev=t,curvoice.last_sym=e}else sym_link(t);t.clef_small=!0}function get_key(t){var e,r,n,a,i=new_key(t),o=i[0];switch(i=i[1],o.k_sf&&!o.k_exp&&o.k_a_acc&&set_k_acc(o),parse.state){case 1:for(void 0!=o.k_sf||o.k_a_acc||(o.k_sf=0,o.k_none=!0),e=0;e<voice_tb.length;e++)r=voice_tb[e],r.key=clone(o),r.okey=clone(o),r.ckey=clone(o);return parse.okey=clone(o),parse.ckey=o,0!=i.length&&memo_kv_parm("*",i),glovar.ulen||(glovar.ulen=C.BLEN/8),parse.state=2,set_page(),write_heading(),reset_gen(),void(gene.nbar=cfmt.measurefirst);case 2:goto_tune(!0)}if(0!=i.length&&set_kv_parm(i),a=(cfmt.transp||0)+(curvoice.transp||0)+(curvoice.shift||0),void 0==o.k_sf){if(!o.k_a_acc&&!a)return;o.k_sf=curvoice.okey.k_sf}if(curvoice.okey=clone(o),a&&(curvoice.vtransp=a,key_transp(o)),o.k_old_sf=curvoice.ckey.k_sf,curvoice.ckey=o,is_voice_sig())return curvoice.key=clone(o),void(o.k_none&&(curvoice.key.k_sf=0));n=curvoice.last_sym,n&&n.type==C.METER?(curvoice.last_sym=n.prev,curvoice.last_sym||(curvoice.sym=null),sym_link(o),o.next=n,n.prev=o,curvoice.last_sym=n):sym_link(o)}function new_voice(t){var e,r,n,a=voice_tb.length;if(1==a&&voice_tb[0].default&&(delete voice_tb[0].default,0==voice_tb[0].time))return e=voice_tb[0],e.id=t,cfmt.transp&&parse.state>=2&&(n=curvoice,curvoice=e,set_transp(),curvoice=n),e;for(r=0;r<a;r++)if(e=voice_tb[r],e.id==t)return e;return e={v:r,id:t,time:0,new:!0,pos:{dyn:0,gch:0,gst:0,orn:0,stm:0,voc:0,vol:0},scale:1,ulen:glovar.ulen,dur_fact:1,key:clone(parse.ckey),ckey:clone(parse.ckey),okey:clone(parse.okey),meter:clone(glovar.meter),wmeasure:glovar.meter.wmeasure,clef:{type:C.CLEF,clef_auto:!0,clef_type:"a",time:0},hy_st:0},voice_tb.push(e),par_sy.voices[r]={range:-1},e}function init_tune(){nstaff=-1,voice_tb=[],curvoice=null,new_syst(!0),staves_found=-1,gene={},a_de=[],od={}}function do_cloning(t){for(var e,r,n=parse.file,a=parse.eol+1,i=a;;){if((r=n.indexOf("\n",i))<0){r=0;break}if(/%.*|\n.*|.:.|\[.:/.test(n.slice(r+1,r+4)))break;i=r+1}for(include++,tosvg(parse.fname,n,a,r),e=0;e<t.length;e++)get_voice(t[e]),tosvg(parse.fname,n,a,r);include--}function get_voice(t){var e,r,n=info_split(t,1),a=n.shift();if(a){if(a.indexOf(",")>0&&(r=a.split(","),a=r.shift()),parse.state<2)return 0!=n.length&&memo_kv_parm(a,n),void("*"!=a&&1==parse.state&&new_voice(a));if("*"==a)return void syntax(1,"Cannot have V:* in tune body");curvoice=new_voice(a),set_kv_parm(n),2==parse.state&&goto_tune(),set_transp(),e=curvoice.v,curvoice.new&&(delete curvoice.new,staves_found<0&&(curvoice.st=curvoice.cst=++nstaff,par_sy.nstaff=nstaff,par_sy.voices[e].st=nstaff,par_sy.voices[e].range=e,par_sy.staves[nstaff]={stafflines:"|||||",staffscale:1}),par_sy.voices[e].range<0&&staves_found>=0&&(curvoice.ignore=!0)),curvoice.stafflines&&(par_sy.staves[curvoice.st].stafflines=curvoice.stafflines,curvoice.stafflines=""),curvoice.filtered||curvoice.ignore||!parse.voice_opts||(curvoice.filtered=!0,voice_filter()),r&&do_cloning(r)}}function goto_tune(t){var e,r,n={type:C.STAVES,dur:0,sy:par_sy};for(parse.state=3,0==voice_tb.length?(curvoice=new_voice("1"),curvoice.clef.istart=curvoice.key.istart,curvoice.clef.iend=curvoice.key.iend,curvoice.default=!0):curvoice||(curvoice=voice_tb[staves_found<0?0:par_sy.top_voice]),curvoice.init||t||(set_kv_parm([]),set_transp()),e=0;e<voice_tb.length;e++)r=voice_tb[e],r.ulen=glovar.ulen,r.key.k_bagpipe&&!r.pos.stm&&(r.pos=clone(r.pos),r.pos.stm=C.SL_BELOW);if(staves_found<0){for(nstaff=voice_tb.length-1,e=0;e<=nstaff;e++)r=voice_tb[e],delete r.new,r.st=r.cst=par_sy.voices[e].st=par_sy.voices[e].range=e,par_sy.staves[e]={stafflines:"|||||",staffscale:1};par_sy.nstaff=nstaff}r=curvoice,curvoice=voice_tb[par_sy.top_voice],sym_link(n),staves_found<0&&(n.default=!0),curvoice=r}function get_sym(t,e){var r,n,a,i,o;if(!curvoice.ignore){if(e){if(!(r=curvoice.sym_cont))return void syntax(1,"+: symbol line without music")}else if(curvoice.sym_restart?(curvoice.sym_start=r=curvoice.sym_restart,curvoice.sym_restart=null):r=curvoice.sym_start,r||(r=curvoice.sym),!r)return void syntax(1,"s: without music");for(a=0;;){for(;" "==t[a]||"\t"==t[a];)a++;if(!(n=t[a]))break;switch(n){case"|":for(;r&&r.type!=C.BAR;)r=r.next;if(!r)return void syntax(1,"Not enough measure bars for symbol line");r=r.next,a++;continue;case"!":case'"':if(i=++a,(a=t.indexOf(n,i))<0){syntax(1,"!"==n?"No end of decoration":"No end of guitar chord"),a=t.length;continue}o=t.slice(i-1,a+1);break;case"*":break;default:if((o=n.charCodeAt(0))<128&&(o=char_tb[o],o.length>1&&("!"==o[0]||'"'==o[0]))){n=o[0];break}syntax(1,errs.bad_char,n)}for(;r&&(r.type!=C.NOTE||r.grace);)r=r.next;if(!r)return void syntax(1,"Too many elements in symbol line");switch(n){default:break;case"!":deco_cnv([o.slice(1,-1)],r,r.prev);break;case'"':a_gch=r.a_gch,parse_gchord(o),a_gch&&gch_build(r)}r=r.next,a++}curvoice.lyric_cont=r}}function get_lyrics(t,e){var r,n,a,i,o,s;if(!curvoice.ignore){if(curvoice.pos.voc!=C.SL_HIDDEN&&(curvoice.have_ly=!0),e){if(!(r=curvoice.lyric_cont))return void syntax(1,"+: lyric without music")}else if(set_font("vocal"),curvoice.lyric_restart?(curvoice.lyric_start=r=curvoice.lyric_restart,curvoice.lyric_restart=null,curvoice.lyric_line=0):(curvoice.lyric_line++,r=curvoice.lyric_start),r||(r=curvoice.sym),!r)return void syntax(1,"w: without music");for(a=t,i=0;;){for(;" "==a[i]||"\t"==a[i];)i++;if(!a[i])break;switch(o=parse.istart+i+2,a[i]){case"|":for(;r&&r.type!=C.BAR;)r=r.next;if(!r)return void syntax(1,"Not enough measure bars for lyric line");r=r.next,i++;continue;case"-":n="-\n";break;case"_":n="_\n";break;case"*":n="";break;default:if("\\"==a[i]&&i==a.length-1)return void(curvoice.lyric_cont=r);for(n="";;){if(!a[i])break;switch(a[i]){case"_":case"*":case"|":i--;case" ":case"\t":break;case"~":n+=" ",i++;continue;case"-":n+="\n";break;case"\\":n+=a[++i],i++;continue;default:n+=a[i++];continue}break}}for(;r&&(r.type!=C.NOTE||r.grace);)r=r.next;if(!r)return void syntax(1,"Too many words in lyric line");n&&r.pos.voc!=C.SL_HIDDEN&&(n.match(/^\$\d/)&&(set_font("0"==n[1]?"vocal":"u"+n[1]),n=n.slice(2)),s={t:n,font:gene.curfont,w:strwh(n)[0],istart:o,iend:o+n.length},r.a_ly||(r.a_ly=[]),r.a_ly[curvoice.lyric_line]=s),r=r.next,i++}curvoice.lyric_cont=r}}function ly_width(t,e){var r,n,a,i,o,s,c,l,u,f,$,_=t.a_ly;for(i=0,c=0;c<_.length;c++)if(r=_[c])if("-\n"!=($=r.t)&&"_\n"!=$){for(s=r.w,a=r.font.swfac,o=s+2*cwid(" ")*a,t.type==C.GRACE?f=t.wl:$[0]>="0"&&$[0]<="9"&&$.length>2||":"==$[1]||"("==$[0]||")"==$[0]?("("==$[0]?n=cwid("(")*a:(l=$.indexOf(" "),set_font(r.font),n=l>0?strwh($.slice(0,l))[0]:s),f=.4*(s-n+2*cwid(" ")*a),f>20&&(f=20),f+=n,r.t[0]>="0"&&r.t[0]<="9"&&f>i&&(i=f)):(f=.4*o)>20&&(f=20),r.shift=f,e<f&&(e=f),o-=f,f=2*cwid(" ")*a,u=t.next;u;u=u.next){switch(u.type){case C.NOTE:case C.REST:if(u.a_ly&&u.a_ly[c]&&0!=u.a_ly[c].w){if("-\n"!=u.a_ly[c].t&&"_\n"!=u.a_ly[c].t)break;o-=f}else o-=9;if(o<=0)break;continue;case C.CLEF:case C.METER:case C.KEY:o-=10;continue;default:o-=5}break}o>t.wr&&(t.wr=o)}else r.shift=0;if(i>0)for(c=0;c<_.length;c++)(r=_[c])&&r.t[0]>="0"&&r.t[0]<="9"&&(r.shift=i);return e}function draw_lyric_line(t,e,r){var n,a,i,o,s,c,l,u,f,$;for(t.hy_st&1<<e&&(l=!0,t.hy_st&=~(1<<e)),o=t.sym;o.type==C.CLEF||o.type==C.KEY||o.type==C.METER;o=o.next);for(a=o.prev?o.prev.x:tsfirst.x,f=0;o;o=o.next)if(c=o.a_ly?o.a_ly[e]:null)c.font!=gene.curfont&&(gene.curfont=c.font),n=c.t,i=c.w,$=c.shift,l&&("_\n"==n?n="-\n":"-\n"!=n&&(out_hyph(a,r,o.x-$-a),l=!1,a=o.x+o.wr)),u&&"_\n"!=n&&(out_wln(a+3,r,f-a+3),u=!1,a=o.x+o.wr),"-\n"!=n&&"_\n"!=n?(f=o.x-$,"\n"==n.slice(-1)&&(n=n.slice(0,-1),l=!0),(user.anno_start||user.anno_stop)&&(s={st:o.st,istart:c.istart,iend:c.iend,x:f,y:r,ymn:r,ymx:r+gene.curfont.size,wl:0,wr:i},anno_start(s,"lyrics")),xy_str(f,r,n),anno_stop(s,"lyrics"),a=f+i):(0==f&&a>o.x-18&&(a=o.x-18),"-"==n[0]?l=!0:u=!0,f=o.x-$);else switch(o.type){case C.REST:case C.MREST:u&&(out_wln(a+3,r,f-a),u=!1,a=o.x+o.wr)}for(l&&(l=!1,f=realwidth-10,f<a+10&&(f=a+10),out_hyph(a,r,f-a),cfmt.hyphencont&&(t.hy_st|=1<<e)),t.s_next;o;o=o.next)if(o.type==C.NOTE){if(!o.a_ly)break;c=o.a_ly[e],c&&"_\n"==c.t&&(u=!0,(f=realwidth-15)<a+12&&(f=a+12));break}u&&(out_wln(a+3,r,f-a+3),u=!1)}function draw_lyrics(t,e,r,n,a){var i,o,s=staff_tb[t.st].staffscale;if(set_font("vocal"),a>0){for(n>-cfmt.vocalspace&&(n=-cfmt.vocalspace),n*=s,i=0;i<e;i++)n-=1.1*r[i],draw_lyric_line(t,i,n);return(n-r[i-1]/6)/s}for(o=staff_tb[t.st].topbar+cfmt.vocalspace,n<o&&(n=o),n*=s,i=e;--i>=0;)draw_lyric_line(t,i,n),n+=1.1*r[i];return n/s}function draw_all_lyrics(){var t,e,r,n,a,i,o,s,c,l,u=new Array(nstaff),f=voice_tb.length,$=new Array(f),_=new Array(f),d=new Array(f),p=new Array(f),h=0,g=0,m=-1;for(r=0;r<f;r++)if(t=voice_tb[r],t.sym){if(t.st!=m&&(h=0,g=0,m=t.st),n=0,t.have_ly){for($[r]||($[r]=[]),e=t.sym;e;e=e.next)if(c=e.a_ly){for(i=e.x,s=10,a=0;a<c.length;a++)if((l=c[a])&&0!=l.w){i-=l.shift,s=l.w;break}for(o=y_get(t.st,1,i,s),h<o&&(h=o),o=y_get(t.st,0,i,s),g>o&&(g=o);n<c.length;)$[r][n++]=0;for(a=0;a<c.length;a++)(l=c[a])&&(!$[r][a]||l.font.size>$[r][a])&&($[r][a]=l.font.size)}}else o=y_get(t.st,1,0,realwidth),h<o&&(h=o),o=y_get(t.st,0,0,realwidth),g>o&&(g=o);u[m]||(u[m]={}),u[m].top=h,u[m].bot=g,_[r]=n,0!=n&&(t.pos.voc?d[r]=t.pos.voc==C.SL_ABOVE:voice_tb[r+1]&&voice_tb[r+1].st==m&&voice_tb[r+1].have_ly?d[r]=!0:d[r]=!1,d[r]?u[m].a=!0:u[m].b=!0)}for(a=0,r=0;r<f;r++)t=voice_tb[r],t.sym&&t.have_ly&&(d[r]?p[a++]=r:(m=t.st,set_dscale(m,!0),_[r]>0&&(u[m].bot=draw_lyrics(t,_[r],$[r],u[m].bot,1))));for(;--a>=0;)r=p[a],t=voice_tb[r],m=t.st,set_dscale(m,!0),u[m].top=draw_lyrics(t,_[r],$[r],u[m].top,-1);for(r=0;r<f;r++)if(t=voice_tb[r],t.sym){if(m=t.st,u[m].a)for(h=u[m].top+2,e=t.sym.next;e;e=e.next)e.a_ly&&y_set(m,1,e.x-2,10,h);if(u[m].b)if(g=u[m].bot-2,_[t.v]>0)for(e=t.sym.next;e;e=e.next)e.a_ly&&y_set(m,0,e.x-2,10,g);else y_set(m,0,0,realwidth,g)}}function parse_gchord(t){function e(){for(var t="";;){if(r=n[s++],"1234567890.-".indexOf(r)<0)return parseFloat(t);t+=r}}var r,n,a,i,o,t,s,c,l,u=get_font("annotation"),f=u.size,$=parse.line;if(c=parse.bol+$.index,t.length>1)n=t.slice(1,-1),l=c+1;else{for(n="";;){if(!(r=$.next_char()))return void syntax(1,"No end of guitar chord");if('"'==r)break;"\\"==r&&(n+=r,r=$.next_char()),n+=r}l=parse.bol+$.index+1}if(curvoice.pos.gch!=C.SL_HIDDEN)for(s=0,t="g";;){if(!(r=n[s]))break;switch(a={text:"",istart:c,iend:l,font:u},r){case"@":t=r,s++,i=e(),","!=r?(syntax(1,"',' lacking in annotation '@x,y'"),o=0):(o=e()," "!=r&&s--),a.x=i,a.y=o-f/2;break;case"^":case"_":case"<":case">":s++,t=r;break;default:switch(t){case"g":a.font=get_font("gchord");break;case"@":a.x=i,o-=f,a.y=o-f/2}}for(a.type=t;;){if(!(r=n[s]))break;switch(r){case"\\":if(!(r=n[++s])||"n"==r)break;a.text+="\\";default:a.text+=r,s++;continue;case"&":for(;;){switch(a.text+=r,r=n[++s]){default:continue;case";":case void 0:case"\\":}break}if(";"==r){a.text+=r;continue}break;case";":}s++;break}a_gch||(a_gch=[]),a_gch.push(a)}}function gch_tr1(t,e){var r,n,a,i,o,s,c,l,u=0;switch(t[0]){case"A":n=5;break;case"B":n=6;break;case"C":n=0;break;case"D":if("o"==t[1]){u++,n=0;break}n=1;break;case"E":n=2;break;case"F":"a"==t[1]&&u++,n=3;break;case"G":n=4;break;case"L":u++,n=5;break;case"M":u++,n=2;break;case"R":u++,n=1;break;case"S":u++,"o"==t[1]?(u++,n=4):n=6;break;case"/":u--;break;default:return t}if(s=0,c=u+1,u>=0){for(;"#"==t[c];)s++,c++;for(;"b"==t[c];)s--,c++;i=cde2fcg[n]+e+7*s,o=cgd2cde[(i+112)%7],a=(159+((i+22)/7|0))%5,r=(u?latin_names[o]:note_names[o])+acc_name[a]}else r="";return(l=t.indexOf("/",c))<0?r+t.slice(c):(n=note_names.indexOf(t[++l]))<0?r+t.slice(c):(r+=t.slice(c,l),s=0,"#"==t[++l]?(s++,"#"==t[++l]&&(s++,l++)):"b"==t[l]&&(s--,"b"==t[++l]&&(s--,l++)),i=cde2fcg[n]+e+7*s,o=cgd2cde[(i+112)%7],a=(159+((i+22)/7|0))%5,r+note_names[o]+acc_name[a]+t.slice(l))}function gch_transp(t){for(var e,r,n,a=0,i=curvoice.ckey.k_sf-curvoice.okey.k_sf;;){if(!(e=t.a_gch[a++]))return;"g"==e.type&&(r=e.text,n=r.indexOf("\t"),n>=0&&(n++,r=r.slice(0,n)+gch_tr1(r.slice(n),i)),e.text=gch_tr1(r,i))}}function gch_build(t){var e,r,n,a,i=curvoice.pos.gch==C.SL_BELOW?-1:1,o=0,s=0,c=0,l=0,u=cfmt.gchordbox;for(t.a_gch=a_gch,a_gch=null,curvoice.vtransp&&gch_transp(t),a=0;a<t.a_gch.length;a++){if(e=t.a_gch[a],"g"==e.type)cfmt.chordnames&&(e.otext=e.text,e.text=e.text.replace(/A|B|C|D|E|F|G/g,function(t){return cfmt.chordnames[t]}),"H"==cfmt.chordnames.B&&(e.text=e.text.replace(/Hb/g,"Bb"))),e.text=e.text.replace(/##|#|=|bb|b/g,function(t){switch(t){case"##":return"&#x1d12a;";case"#":return"";case"=":return"";case"b":return""}return"&#x1d12b;"});else if(e.text=cnv_escape(e.text),"@"==e.type&&!user.anno_start&&!user.anno_stop)continue;switch(gene.curfont=e.font,r=strwh(e.text),e.w=r[0],e.type){case"@":break;case"^":n=.4*r[0],n>8&&(n=8),e.x=-n,o-=r[1],e.y=o;break;case"_":n=.4*r[0],n>8&&(n=8),e.x=-n,s-=r[1],e.y=s;break;case"<":e.x=-(r[0]+6),c-=r[1],e.y=c+r[1]/2;break;case">":e.x=6,l-=r[1],e.y=l+r[1]/2;break;default:e.box=u,n=.4*r[0],n>8&&(n=8),e.x=-n,i<0?(s-=r[1],e.y=s,u&&(s-=2,e.y-=1)):(o-=r[1],e.y=o,u&&(o-=2,e.y-=1))}}for(c/=2,l/=2,a=0;a<t.a_gch.length;a++)switch(e=t.a_gch[a],e.type){case"^":e.y-=o;break;case"<":e.y-=c;break;case">":e.y-=l;break;case"g":i>0&&(e.y-=o)}}function draw_gchord(t,e,r){var n,a,i,o,s,c,l,u,f,$,_,d=t.a_gch[0].w,p=y_get(t.st,1,t.x-2,d),h=y_get(t.st,0,t.x-2,d),g=3*((t.notes[t.nhd].pit+t.notes[0].pit>>1)-18);for(o=0;o<t.a_gch.length&&(n=t.a_gch[o],!("g"==n.type&&(a=n,n.y<0)));o++);for(a&&(a.y>=0?p<r&&(p=r):h>e&&(h=e)),set_dscale(t.st),o=0;o<t.a_gch.length;o++){switch(n=t.a_gch[o],use_font(n.font),set_font(n.font),_=n.font.size,d=n.w,s=t.x+n.x,i=n.text,n.type){case"_":c=n.y+h,y_set(t.st,0,s,d,c-.2*_-2);break;case"^":c=n.y+p,y_set(t.st,1,s,d,c+.8*_+2);break;case"<":t.notes[0].acc&&(s-=t.notes[0].shac),c=n.y+g-_/2;break;case">":s+=t.xmx,t.dots>0&&(s+=1.5+3.5*t.dots),c=n.y+g-_/2;break;default:if($=n.box?3:2,n.y>=0?(c=n.y+p,y_set(t.st,!0,s,d,c+_+$)):(c=n.y+h,y_set(t.st,!1,s,d,c-$)),(u=i.indexOf("\t"))>=0){s=realwidth;for(var m=t.next;m;m=m.next){switch(m.type){default:continue;case C.NOTE:case C.REST:case C.BAR:s=m.x}break}for(f=2;!((u=i.indexOf("\t",u+1))<0);)f++;var v=(s-t.x)/f;for(s=t.x,c*=staff_tb[t.st].staffscale,user.anno_start&&user.anno_start("gchord",n.istart,n.iend,s-2,c+_+2,d+4,_+4,t),u=0,f=u;!((u=i.indexOf("\t",f))<0);)xy_str(s,c,i.slice(f,u),"c"),s+=v,f=u+1;xy_str(s,c,i.slice(f),"c"),user.anno_stop&&user.anno_stop("gchord",n.istart,n.iend,t.x-2,c+_+2,d+4,_+4,t);continue}break;case"@":c=n.y+g,c>0?(l=c+_)>staff_tb[t.st].ann_top&&(staff_tb[t.st].ann_top=l):c<staff_tb[t.st].ann_bot&&(staff_tb[t.st].ann_bot=c)}user.anno_start&&user.anno_start("annot",n.istart,n.iend,s-2,c+_+2,d+4,_+4,t),n.box?xy_str_b(s,c,i):xy_str(s,c,i),user.anno_stop&&user.anno_stop("annot",n.istart,n.iend,s-2,c+_+2,d+4,_+4,t)}}function psdeco(){return!1}function psxygl(){return!1}function set_hooks(){function set_hs(hs){for(var of,h,k=0;k<hs.length;k++)h=hs[k],"string"==typeof h?self[h]||eval("self."+h+"="+h):eval("of="+h[0]+";"+h[0]+"="+h[1]+".bind(self,of)")}var h=abc2svg.modules.hooks,gh=abc2svg.modules.g_hooks;hook_init?h.length&&(set_hs(h),gh.push.apply(gh,h),abc2svg.modules.hooks=[]):(h.length&&(gh.push.apply(gh,h),abc2svg.modules.hooks=[]),set_hs(gh),hook_init=!0)}var C=abc2svg.C,require=empty_function,system=empty_function,write=empty_function,XMLHttpRequest=empty_function;this.user=user;var OPEN_BRACE=1,CLOSE_BRACE=2,OPEN_BRACKET=4,CLOSE_BRACKET=8,OPEN_PARENTH=16,CLOSE_PARENTH=32,STOP_BAR=64,FL_VOICE=128,OPEN_BRACE2=256,CLOSE_BRACE2=512,OPEN_BRACKET2=1024,CLOSE_BRACKET2=2048,MASTER_VOICE=4096,IN=96,CM=37.8,YSTEP=256,errs={bad_char:"Bad character '$1'",bad_val:"Bad value in $1",bar_grace:"Cannot have a bar in grace notes",ignored:"$1: inside tune - ignored",misplaced:"Misplaced '$1' in %%staves",must_note:"!$1! must be on a note",must_note_rest:"!$1! must be on a note or a rest",nonote_vo:"No note in voice overlay",not_enough_n:"Not enough notes/rests for %%repeat",not_enough_m:"Not enough measures for %%repeat",not_ascii:"Not an ASCII character"},glovar={meter:{type:C.METER,wmeasure:1,a_meter:[]}},info={},mac={},maci=new Int8Array(128),parse={ctx:{},prefix:"%",state:0,line:new scanBuf},psvg,dd_tb={},a_de,od,decos={dot:"0 stc 5 1 1",tenuto:"0 emb 5 3 3",slide:"1 sld 3 7 0",arpeggio:"2 arp 12 10 0",roll:"3 roll 7 6 6",fermata:"3 hld 12 7 7",emphasis:"3 accent 7 4 4",lowermordent:"3 lmrd 10 5 5",coda:"3 coda 24 10 10",uppermordent:"3 umrd 10 5 5",segno:"3 sgno 22 8 8",trill:"3 trl 14 5 5",upbow:"3 upb 10 5 5",downbow:"3 dnb 9 5 5",gmark:"3 grm 6 5 5",wedge:"3 wedge 8 3 3",turnx:"3 turnx 10 0 5",breath:"3 brth 0 1 20",longphrase:"3 lphr 0 1 1",mediumphrase:"3 mphr 0 1 1",shortphrase:"3 sphr 0 1 1",invertedfermata:"3 hld 12 7 7",invertedturn:"3 turn 10 0 5",invertedturnx:"3 turnx 10 0 5",0:"3 fng 8 3 3 0",1:"3 fng 8 3 3 1",2:"3 fng 8 3 3 2",3:"3 fng 8 3 3 3",4:"3 fng 8 3 3 4",5:"3 fng 8 3 3 5",plus:"3 dplus 7 3 3","+":"3 dplus 7 3 3",accent:"3 accent 6 4 4",">":"3 accent 6 4 4",marcato:"3 marcato 9 3 3","^":"3 marcato 9 3 3",mordent:"3 lmrd 10 5 5",open:"3 opend 10 3 3",snap:"3 snap 14 3 3",thumb:"3 thumb 14 3 3",dacapo:"3 dacs 16 20 20 Da Capo",dacoda:"3 dacs 16 20 20 Da Coda","D.C.":"3 dacs 16 10 10 D.C.","D.S.":"3 dacs 16 10 10 D.S.","D.C.alcoda":"3 dacs 16 38 38 D.C. al Coda","D.S.alcoda":"3 dacs 16 38 38 D.S. al Coda","D.C.alfine":"3 dacs 16 38 38 D.C. al Fine","D.S.alfine":"3 dacs 16 38 38 D.S. al Fine",fine:"3 dacs 16 10 10 Fine",turn:"3 turn 10 0 5","trill(":"3 ltr 8 0 0","trill)":"3 ltr 8 0 0",f:"6 pf 18 1 7",ff:"6 pf 18 2 10",fff:"6 pf 18 4 13",ffff:"6 pf 18 6 16",mf:"6 pf 18 6 13",mp:"6 pf 18 6 16",p:"6 pf 18 2 8",pp:"6 pf 18 5 14",ppp:"6 pf 18 8 20",pppp:"6 pf 18 10 25",pralltriller:"3 umrd 10 5 5",sfz:'6 sfz 18 4 10 ""',ped:"4 ped 20 0 0","ped-up":"4 pedoff 20 0 0","crescendo(":"7 cresc 18 0 0","crescendo)":"7 cresc 18 0 0","<(":"7 cresc 18 0 0","<)":"7 cresc 18 0 0","diminuendo(":"7 dim 18 0 0","diminuendo)":"7 dim 18 0 0",">(":"7 dim 18 0 0",">)":"7 dim 18 0 0","-(":"8 gliss 0 0 0","-)":"8 gliss 0 0 0","~(":"8 glisq 0 0 0","~)":"8 glisq 0 0 0","8va(":"3 8va 10 0 0","8va)":"3 8va 10 0 0","8vb(":"4 8vb 10 0 0","8vb)":"4 8vb 10 0 0","15ma(":"3 15ma 10 0 0","15ma)":"3 15ma 10 0 0","15mb(":"4 15mb 10 0 0","15mb)":"4 15mb 10 0 0",invisible:"32 0 0 0 0",beamon:"33 0 0 0 0",trem1:"34 0 0 0 0",trem2:"34 0 0 0 0",trem3:"34 0 0 0 0",trem4:"34 0 0 0 0",xstem:"35 0 0 0 0",beambr1:"36 0 0 0 0",beambr2:"36 0 0 0 0",rbstop:"37 0 0 0 0","/":"38 0 0 6 6","//":"38 0 0 6 6","///":"38 0 0 6 6","beam-accel":"39 0 0 0 0","beam-rall":"39 0 0 0 0",stemless:"40 0 0 0 0",rbend:"41 0 0 0 0"},f_near=[!0,!0,!0],f_note=[!1,!1,!1,!0,!0,!0,!1,!1,!0],f_staff=[!1,!1,!1,!1,!1,!1,!0,!0],func_tb=[d_near,d_slide,d_arp,d_upstaff,d_upstaff,d_trill,d_pf,d_cresc],ottava={"8va(":1,"8va)":1,"15ma(":1,"15ma)":1,"8vb(":1,"8vb)":1,"15mb(":1,"15mb)":1
},STEM_MIN=16,STEM_MIN2=14,STEM_MIN3=12,STEM_MIN4=10,STEM_CH_MIN=14,STEM_CH_MIN2=10,STEM_CH_MIN3=9,STEM_CH_MIN4=9,BEAM_DEPTH=3.2,BEAM_OFFSET=.25,BEAM_SHIFT=5,BEAM_SLOPE=.4,BEAM_STUB=8,SLUR_SLOPE=.5,GSTEM=15,GSTEM_XOFF=2.3,cache,min_tb=[[STEM_MIN,STEM_MIN,STEM_MIN2,STEM_MIN3,STEM_MIN4,STEM_MIN4],[STEM_CH_MIN,STEM_CH_MIN,STEM_CH_MIN2,STEM_CH_MIN3,STEM_CH_MIN4,STEM_CH_MIN4]],sharp_cl=new Int8Array([24,9,15,21,6,12,18]),flat_cl=new Int8Array([12,18,24,9,15,21,6]),sharp1=new Int8Array([-9,12,-9,-9,12,-9]),sharp2=new Int8Array([12,-9,12,-9,12,-9]),flat1=new Int8Array([9,-12,9,-12,9,-12]),flat2=new Int8Array([-12,9,-12,9,-12,9]),rest_tb=["r128","r64","r32","r16","r8","r4","r2","r1","r0","r00"],musicfont='url("data:application/font-ttf;base64,AAEAAAANAIAAAwBQRkZUTX30pOoAACfYAAAAHE9TLzJYnlnxAAABWAAAAFZjbWFwN+qJgQAAAsAAAAIqY3Z0IAAiAogAAATsAAAABGdhc3D//wADAAAn0AAAAAhnbHlmirg/swAABXwAAB4caGVhZAsOgeEAAADcAAAANmhoZWEIoQEcAAABFAAAACRobXR4cVoAlAAAAbAAAAEObG9jYQpbAnAAAATwAAAAim1heHAAiwDcAAABOAAAACBuYW1lNpjajAAAI5gAAAGDcG9zdA9CdgsAACUcAAACsQABAAAAAQAAtjNVVF8PPPUACwQAAAAAANGXIhcAAAAA1qodLf+6/QwD9ASUAAAACAACAAAAAAAAAAEAAASU/QwAXAQN/7r/vwP0AAEAAAAAAAAAAAAAAAAAAABDAAEAAABEAKsABQAAAAAAAgAAAAEAAQAAAEAALgAAAAAAAQG7AZAABQAIApkCzAAAAI8CmQLMAAAB6wAzAQkAAAIABQMAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUGZFZABAAADpXAMz/zMAXASUAvQAAAABAAAAAAAAAXYAIgAAAAABVQAAAZAAAABXAAAB4P/cA14AegMLAAAC0gAAAr//ugHWAAADCwAAAw4AAAMn/8gBrgAAASIAAAGQAAABfAAAAZAAAAGQAAABgQAAAZAAAAGQAAABgQAAAZkACQGYAAkB9AAAAQQAFAEEAAoCEQAAAhwAAAHAAAABSQAAAUoAAAFK//4BLAAAAjAAAAHgAAABDQAyAMgAAAENAAABCwAUAW4AAAENADIBQP/9ARgAAAJYAAAAtgAAAIIAAACCAAABLAAAASwAAADuAAAA/wAAAUkAAAGPAAAB2AAAAdgAAANTAAACM//wAyD/4QG1AAABtQAAAkQADQJEAA0EDQAAAhwADAAAAAAAAAADAAAAAwAAABwAAQAAAAABJAADAAEAAAAcAAQBCAAAAD4AIAAEAB4AAOAA4EjgUOBc4GLgaeB84IzgleCk4Kngs+EB4efiZOKA5KDkrOTA5M7k6uTu5QHlZ+Vp5W3mUOZV6Vz//wAAAADgAOBH4FDgXOBi4GngeuCA4JTgoOCp4LPhAeHn4mDigOSg5KzkwOTO5OHk7uUA5WflaeVs5lDmVelc//8AAyAEH74ftx+sH6cfoR+RH44fhx99H3kfcB8jHj4dxh2rG4wbgRtuG2EbTxtMGzsa1hrVGtMZ8RntFucAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABBgAAAwAAAAAAAAABAgAAAAIAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACICiAAAACoAKgAqADYAZgDOARABpgI4ApICpgNCA9QELAROBGIEtAUEBSQFagWqBeQGMAZwBrYHEAckB0oHcAesB8gH9ggiCDwIVgiMCJoIrAjSCOwJHAlGCaIJyAnwCgAKKApOCloKZgpyCn4KoArGCvwLSguqDB4MNAxaDIgMzA0WDTANVA40DvAPDgAAAAIAIgAAATICqgADAAcALrEBAC88sgcEAO0ysQYF3DyyAwIA7TIAsQMALzyyBQQA7TKyBwYB/DyyAQIA7TIzESERJzMRIyIBEO7MzAKq/VYiAmYAAAEAAAAAAZEBkAADAAAxESERAZEBkP5wAAEAAAAAAFcEAwAgAAARNTY1NCcmNTQ3BhUUFxYVFAcWFRQHBhUUFyY1NDc2NTQ1IxJXPxUlTU0lFT9XEiMCAwIYQzZgOTRmOjJLIjlhTWEYGGZMYDklSjI6ZjQ5YDZIAAP/3AACAd4CswAHAA8ARwAAACImNDYyFhQEIiY0NjIWFBc0NjMyFhUUBxYzMjY1NCcmJwMnEyY1NDc2MhYVFAYjIiY1NDcmIyIGFRQXFhcTFwMWFRQHBiImAZ4gGBggGP5+IBgYIBhbGxQTHiwYKCdBMDxBzyvTmDgoYDgbFBMeLBgoJ0EwQTvUK9eYOChgOAFSGCAYGCBUGCAYGCDYEhwaER0OGC8lKDAtOP7eIAEmj2A1LxQzIRIcGhEdDhgvJSgwMTQBJh/+1pBgNS8UMwAFAHr/NANeAlQAFwAbAB8AIwAnAAABMxUeARczFSMOAQcVIzUuAScjNTM+ATcRIxYXNxU2NyczJicHNQYHAdgoVXgHiooHeFUoVXgHiooHeFVwBWsoawVwcAVrKGsFAlSJCItgKGCLCImJCItgKGKJCP7lug7IyA66KLoOyMkOuwAAAAAEAAD9gQKnBJQAPwBGAFoAZwAAATYzMhYXFhUUBwYHFxYVFAYjIiY1NDYzMhYVFAYHFjMyNTQvAQYjIiY1NDc+ATc+AjcuAjU0NjceARUUBgcbATY1NCYjCwEOARUUFy4BNTQ2NycOAQcSITIDBhUUFz4BNTQmJw4BAY8SCzVnID98QisQAkVPUWBAMi5CPjAbKmUBEQscr8E5El4mBi0wFwMKBW9ROx5beR8fq25OFSA3Ry8yM2BJEY9sAQUBLwQpBAdJcBgaO0UBCgIqJkR7lDwiBLsgDlBNWEEsQEQtKzIBD4ASCr4Bt6yEZiNkHgUoKBEhdUgdip4YQHlyiahf/rX+nieRQGr+ngFeCkAwLToMWjpGYhS9cpdn/tYEDiEuUiMxj0gpTw8HdwACAAD9/ALSAgAAZABoAAABMjY1NCcmIyIHDgIHJicmJxEjETMRNjc2Nx4DFxYzMjY1NCcmIyIHFhcUFhUUBisBJjU0NzY3NjMyFxYXFRQGBwYjIicHFzYzMhYXFh0BBgcGIyImNTQ3MzIWFRQGFQYHFgEzESMB3j5KDRpJRjwCBgoEIhoeLhwcLh4aIgYUDBkPJyUxPRIkUi8xMg0CMyEFRAUaVScjXlU3CFpIHy00PyIiPzRCZh4oCDdWXUxyRAUhMwIPMDX+TXt7/iB4Si0tbEkFDhsKYicrH/4EBAD+ER8rJ2ILKhcdCRt7QjE2YhoQKAMNBB4rGTIUC0QZDU80UxJObxwNF0tKFz4sOUMSUzRQTjwyGSseBA4EJhAcA978AAAAA/+6/aUCwwD/ACYAMQA9AAA3NDYzMhcWFRQHDgEHNjc2NzY1NCcuASMiBgc+ATMyFhUUBwYjIiYFIiY1NDYyFhUUBiciJjU0NjMyFhUUBhOMZqNLLJdU9oTwdVskCzgeOSg8Zg0XGxwuRychLThGAoIWHRkqHhoaFxsaFxQcGylgdm1Bb/aISm4HQH1erj0xfkEhGFJEHRBLLzIgHmeSHBcWHB0VFh3yHhkWGRsUGR4AAAAAAgAA/wYBcgD6AAMABwAANzMTIwMzEyPclAKW3JQClvr+DAH0/gwAAAQAAP4KAh8DqgAJACAAYgBtAAAlFhc+ATU0JiMiAwInDgEVFBcuATU0NjcmJw4BBx4BMzIXHgEfAR0BFCMiJjU0NjMyFhUUBgcWMzI2NTQvAQYjIiY1NDc+ATc+AjcmNTQ2Nx4BFRQGBx4BFzYzMhcWFRQHBgMGFRQXPgE1NCcGAUkTBk1HVkIODRgBLDkfICpMOwUJcVUBBW2CAyIDBgICejZTMyglNTEnFSIjLAENCRWNmS4OTB4FIycSDllALxlJYQIIBBIIXDkyYzZkAwY3XilfdcRbEk8zNlb+4AELEAk0JykmEkEpOE4QPlpaeVNxfhogQBcXGwd/SDEkMzckIigBDDM1DwmNAZKKalEcUBgEICENwgdufxMzYltth0wRbiQCQzZidzAbA1YeIjkkJXszRiYmAAIAAP5jAkIBmgBjAGcAAAEyNjU0JyYjIgcOAQcmJyYnESMRMxE2NzY3HgMXFjMyNjU0JyYjIgcWFxQWFRQGKwEmNTQ3Njc2MzIXFhcVFAYHBiMiJwcXNjMyFhcWHQEGBwYjIiY1NDczMhYVFAYVBgcWATMRIwF+MjsKFTo4MAIMBB0TGCUWFiUYEx0EEQoTDCAdJzEOHEMlJygKAioaBDYEFUQjGElGLQZIOhglKzEbGzQoNVIYIAYtRkk9WzYEGioCDCYr/qNiYv6AYDskJFc7BR0LUhwiGf5qAzP+dBkiHFIIIhIXCBZiNSsoThUNIAILAxgiFCgQCTUVC0ArQQ4+WhYKEjw7EzIjLjUPQStAPzAoFCMYAwsDHw0WAxj8zQAAAAAD/8j+HgI2AMwAJgAvADsAADc0NjMyFxYVFAcOAQc2NzY3NjU0Jy4BIyIGBz4BMzIWFRQHBiMiJgUiJjQ2MhYUBiciJjU0NjMyFhUUBg9wUoI8I3hDxmnAXkceCS0YLSAwUgoSFhYlOSAZJSw5AgISFxQiGBUVEhYVEhEWFSFNXlczWsZsO1cGM2RKjC8pZjMaFEI2Fw08JigaGFN1FyQWFyIYwhgUERQVEBMZAAAAAAIAAP8GAa4A+gALABQAADMUFjMyNjU0JiMiBgc0NjIWFAYiJooqIyIrJyYlKIp9tH19tH1ieHlhZXV2YWeQkdKRkgAAAQAA/wYBIgD6AAkAADE3MxEXFSM1NxFkfUHwQfr+Ph4UFB4BLAAAAAEAAP8GAY8A+gA8AAA3MhUUBw4DBzYzMhYzMjc+AjMOAgcGBwYjIiYjIgYjIjU0Jz4FNTQnIgcyFhUUBiMiNTQ+AcfIBQ02QG82EyAbZBwYHgUQDAEBBQUBBxAaKRp0FR9WAgcBAiw+RzwoU04aHCk3Hkw8WPp+Gg4hLh1ELQwjDgMNCwUWFgMpDhgnJhABAiFFODwyOBhiATUlHh8pZyg5GQAAAQAA/wYBdQD6ADkAADcyFhUUBiMiJjU0NzYzMhcWFRQGBx4BFRQHBiMiJicmNDYzMhYVFAYjFjMyNjU0JicmNDc+ATQmIyJmGyInIRsyHzNZRiZERj0+UUskTSdXGCMyICIqJRsMPyQrSC4WFi9LKSQ8qhwXGyMrIy8aKhMiSC5ECwtFLUMnExYUHUwuIRsZHikxJyY6CAQiBAk3UDAAAAEAAP8GAZAA+gARAAAFFyM3NSM1NjUzATM/AREzFSMBRTLIMuGTo/77sAFjS0vRKSkxKPKA/o6Wkf7ZKAAAAAABAAD/BwF+APoALwAAFzYzMhYVFAYjFjMyNz4BNTQnJiMiBxMhDgErAQc2MzIXHgEVFAcOAiMiJy4BNTQSHCEbKiAcGiQxHBMJHhwoTkgKAWILNSXVBjlCUzEhK0MWQCslPCsQHl8gIBccICEeFB8gORwaNQEiJDp5Hh8VQSVPLxAQAhQJMhIjAAAAAAIAAP8GAYEA+gAJACwAABcyNjU0JiMiBxYTFhUUBiMiJjU0NjMmIyIGFT4CMzIWFRQGIyImJz4BMzIWyCktKigsMAfdGyMYHiIbEBY3NS8VGC0eTE9xSGFmAQFsWzA/0kUsIjAlngGfGiYZKB4bDB4jeF8LCglANkRZgnhpkRIAAQAA/wYBkAD7ACgAADciDgMHNz4IMzIWMzI2Nw4EFSM2NzY3NjcGIyImYRQaFAkRBQoBDAILBQsJDRAJL3UjGjsRG0UaHgiCAQgRaB4tER4lYKEFDgkbBnQBCwIJAQYBAwEmFw5Dp0FcQitFGzaHJzkKKAADAAD/BgGEAPoADgAcADQAABcOARUUFjMyNjU0LgM3PgE1NCYiBhUUHgMHLgE1NDY3MhYVFAYHHgEVFAYjIiY1NDaaNixYLCo/DyAdMT4zI0RSMwocEjFwMSlmSktlKjA6MnVNTHY5KhkkGx0wKR8OFxINE1oaIhwdMCggDxcTChU/GDw1M00BRjInNBcaOjU3SkgwJDUAAAIAAP8GAYEA+gAJACwAADciBhUUFjMyNyYDJjU0NjMyFhUUBiMWMzI2NQ4CIyImNTQ2MzIWFw4BIyImuSktKigsMAfdGyMYHiIbEBY3NS8VGC0eTE9xSGFmAQFsWzA/0kUsIjAlnv5hGiYZKB4bDB4jeF8LCglANkRZgnhpkRIAAQAJ/woBmQD5ADAAACUwFzY1NCYjDgEVFBcWMzI3NjcUHgEVDgEHIicmJzQmNTQ3MhYXFhUUBiMiJjU+ATMBLxIEPB8yQSchMCsoHCoJCBtVVk87OwQB2yRAESIkHCApAiAapAMFCBQiAmVrjjMqIhhYAQQDAVVQATk5ZgIrAuYCHhQnJCU5LhwWJgACAAn+ogGZAV4AOAA/AAAlMBc2NTQmIyIHERYzMjc2NxQeARUOAQcjFSM1JicmJzQmNTQ3NTMVMjYzMhYXFhUUBiMiJjU+ATMDEQYVFBcWAS8SBDwfAxAMDCsoHCoJCBtRVQEjPS47BAGrIwMHAyRAESIkHCApAiAaej0nCqQDBQgUIgT+SwQiGFgBBAMBVFEBaGsJLTlmAisCyxlpZgEeFCckJTkuHBYm/pcBli6RjjMNAAABAAD/BgH0APoACwAANTM1MxUzFSMVIzUj10bX10bXI9fXRtfXAAAAAQAU/gYA4wIAABMAABMWBwYnJgI1NBI3NhcWBwYCFRQS3AcNCQVJa2tJCQsGBjxGR/4WCAUDBlcBIH18ASJWCwcGCEn+54iG/uUAAAEACv4CANwB/QATAAATNhI1NAInJjc2FxYSFRQCBwYnJhQ7R0Y8CQwKB0lra0kICwb+FkkBG4aIARlJCwQECVb+3nx9/uBXCQkEAAAEAAD/TAIRAKoAAwAHABsAJQAAJTMRIwEzESM3BhUUFx4BFzMyNzY0Jy4BJzAjIgQUBiMiJjU0NjIB6Sgo/hcnJ5cFAwpVLg0zEwUDCVYuDTYBQXlnZnp5zqr+ogFe/qLzDA4LCyJHBCMJHAsiRwQmeEVEOD9HAAACAAD/JAIcANwAAwAPAAA3FSE1JTMVITUzESM1IRUjGQHq/f0ZAeoZGf4WGUaMjJYyMv5IMjIAAAIAAP9/AcAAgQATAB0AADcGFRQXHgEXMzI3NjQnLgEnMCMiBBQGIyImNTQ2Mm8FAwpVLg0zEwUDCVYuDTYBQXlnZnp5zj8MDgsLIkcEIwkcCyJHBCZ4RUQ4P0cAAgAA/2wBSACUAA0AGwAAJSYjIgYVFBcWMzI2NTQ3FhUUBiMiJyY1NDYzMgEkDSU8lwYLJjyXEA9+SE8kD35IT0QXYSsKCRdhKwkXHh1DZ0MeHUNnAAAAAAEAAP90AUoAiwAOAAAVNDY3NjMyFhUUBwYjIiZdSB4RM0OlGBsxQSE+VBMHODJ1MAg5AAAB//7/bwFMAJEACwAAJzcXNxcHFwcnByc3AhuMjBuGhhyLixyGcSB2dSBwcCF1dSFwAAAABQAA/2oBLACWAAUACwARABcAHwAAFwcWMzI3LwEGFRQXPwEmIyIHHwE2NTQnBjQ2MhYUBiKWRx0qKR9dRx0dXEgfKSodXEcdHfJYfFhYfBJIHR1aSR8pKh1YSB0dWkgfKSodhXxYWHxYAAAAAQAA/wYCMAD6AAMAABUBMwEBuHj+R/oB9P4MAAEAAP/OAGQAMgAHAAAWIiY0NjIWFEcqHR0qHTIdKh0dKgAAAAIAMv9kAQ0BsAAKABYAADciBh0BNjc2NTQmNzIWFRQHBiMRMxE2lBUqHCwuIAciOU9SOiMjeh4SywNCPzYbJiYyI0VQUgJM/rw0AAACAAD+hgDFAXoAAwAMAAAXNzUHERU3ESM1BxE3HJCQqRmsAWUtli0BSeg0/cDiMwJDAQAAAgAA/o8BDAF1AAMAHwAANxU3NQMjNQc1NzUHNTc1MxU3NTMVNxUHFTcVBxUjNQdSZmYZOTk5ORlmGDw8PDwYZk20HLX+Ja8RVQ63EFcOsqoat68PUxK0D1MPsaodAAAAAQAU/4QBCwB6AB4AABc1JicHMBUjNTM3JzAjNTMVFhc3MDUzFSMGBxcwMxXDKAwzSDkzMzlIIRI0SDkhEzQ5fDsmDTM7SjIySDkiETM5RyIRNEgABAAA/2oBbAGwABAAHgAtADwAADcOAR0BMjc2NzY3NjU0JyYjNzIWFRQHBgcGIxEzETYXDgEdATI3Njc2NTQnJiM3MhYVFAcGBw4BIxEzETZOER4LGwQCHwwEChARGR0rCRgrNS8fGdERHQ0hHQsGCxAPFh8qCxkoFjcWHht9AR4QyyYFAys0DRkeFBUmOSESIDk0QAJG/sEyJgEdEcsuLzATExwWFSY2JBYcPi8bJQJG/sEyAAAAAAIAMv9kAQ0BsAAKABYAADciBhUUFxYXNTQmJzIXETMRIicmNTQ2qxcgLi4aKjM6IyM6Uk85eiYbMEVCA8sSHiY0AUT9tFJQRSMyAAAB//0AAAE/APQAGAAANwYjIiY1ND8BNi8BJjU0NjMyMRcFFhUUBxICAwcJBs8ODs0ICwcBAgEfDg4BARAICgNJBwZPAwsKEgFrBg4NBQAAAAEAAAAAARgBNQAFAAAxGwEjJweMjEFYWgE1/svGxgAAAgAAAAACWAFKAA4AGQAAMTQ2MzIeAhUjLgEiBgchIiY0NjMyFhUUBrN5OWtVMwoLpuKmCwEhFyUlFxkjI5iyLFGATW6Ghm4kMCQkGBkjAAABAAAAAAC2AS0AFwAAEzIWFxYVFAcOASMnJjU0NjU0Iy4BNTQ2VhsbEBoyGUQQBgFHFBsoLQEtDBEdMD08HS0DAQIIaxMPASYcHjEAAQAA/wYAggD6AAMAADUzEyOAAoL6/gwAAQAAAAAAggD6AAMAADUzFSOCgvr6AAAAAQAA/4MBLAAAAAMAADEhFSEBLP7UfQAAAQAAAAABLAB9AAMAADUhFSEBLP7UfX0AAQAA/n4A6wGHABMAABMXBxcmIyIGFRQXJjU0NjMyFyc3Kb1nbDI0HyY4eDQlIiKHZAGH5dnPLiQdNTRLTSMtFby0AAABAAD/DQEAAMAAFgAANw4CIyImNTQ2MhYVFAcyNjc2MhcDJ6sDGRoTKzcmOCkXIjMhAhUDljA8AQcEKSgfIB4ZHRshLAIC/m8QAAAAAQAA/gwBSADAACQAABcGIyImNTQ2MzIWFRQHMj8BBiMiJjU0NjMyFhUUBzI3NjIXAyerKCErNycbHCkXQQs8NhgrNycbHCkXSC4CFQPFLcQMKCggIB8ZHRsiygwpKB8gHhkdG00CAv1uDAAAAQAA/gwBjwHAADYAADcGIyImNTQ2MzIWFRQHMj8BIg4BIyImNTQ2MzIWFRQHMjc2MhcBJxMGIyImNTQ2MzIWFRQHMjf2KB8rNycbHCkXPws6ASAcEys3JxscKRdILgEWA/70LVUoISs3JxscKRdBCzwMKCggIB8ZHRsiywkEKSgfIB4ZHRtNAgL8bgwBJAwoKCAgHxkdGyIAAAAAAQAA/QwB2gHAAEUAABMGIyImNTQ2MzIWFRQHMj8BBiMiJjU0NjMyFhUUBzI/AQYjIiY1NDYzMhYVFAcyPwEiDgEjIiY1NDYyFhUUBzI3NjIXASerKCErNycbHCkXQQs6KCErNycbHCkXQQs6KB8rNycbHCkXPws6ASAcEys3JjgpF0guAhUD/qkt/jwMKCggIB8ZHRsiygwoKCAgHxkdGyLKDCgoICAfGR0bIssJBCkoHyAeGR0bTQIC+24MAAAAAQAA/QwCGQKuAFYAACUGIyImNTQ2MzIWFRQHMj8BBiMiJjU0NjMyFhUUBzI/ASIOASMiJjU0NjMyFhUUBzI3NjIXAScTBiMiJjU0NjMyFhUUBzI/AQYjIiY1NDYzMhYVFAcyNwE/KCErNycbHCkXQQs2KB8rNycbHCkXPws0ASAcEys3JxscKRdILgEWA/5qLVUoISs3JxscKRdBCzooISs3JxscKRdBCzQMKCggIB8ZHRsixAwoKCAgHxkdGyLHCQQpKB8gHhkdG00CAvqADAEkDCgoICAfGR0bIsgMKCggIB8ZHRsiAAEAAP8aA1IA5gALAAA1MxUhNTMRIzUhFSMZAyAZGfzgGeZ9ff40fX0AAAAAA//w/wYCJgD6AAcADwATAAA2IiY0NjIWFAAiJjQ2MhYUBQEzAVAyIyMyIwGIMiMjMiP90gG4fv5HSyMyIyMy/s8jMiMjMloB9P4MAAT/4f8GAwcA+gAHAA8AEwAXAAA2IiY0NjIWFAAiJjQ2MhYUBQEzATMBMwFBMiMjMiMCdzIjIzIj/OMBuHv+R3kBuHv+R0sjMiMjMv7PIzIjIzJaAfT+DAH0/gwAAQAA//0BtQDUAC8AACUyNjU0JwYjIjU+ATMyFhUUBwYjIi8BJiMiBhUUFzYzMhUUByInJjU0NzYzFh8BFgF2FRwWFBIcAQ8JIC0pFxwkHqggDxYcFRQTHBkZGBwoFiAoF6giJSkcJxAMGw8VQiYzJBUVghYoHicPDB0gAxoiLTMkEwIQghcAAAEAAP/NAbUBAwA2AAAXIiY1NDc2MxYfATUzFRcWMzI2NTQnBiMiNT4BMzIWFRQHBiMiLwEVIzUnJiMiBhUUFzYzMhUUTSAtKBYgKBcuHlwiDxUcFhQSHAEPCSAtKRccJB4uHlwgDxYcFRQTHANDJjMkEwIQJGmARxcpHCcQDBsPFUImMyQVFSRsg0cWKB4nDwwdIAABAA0AAAJFAOAACwAANyc3FzcXNxcHJwcnIhWOZXhqTRaSaXRpLhmZfHx8VBehfHx8AAAAAQAN/8sCRQERABMAACUHJwcnNxc3NTMXNxc3FwcnBxUjARZAaUsVjmUWGwFGak8UkmkZG0ZGfE4ZmXwXlntKfFUYoXwblgAABAAA//wD9AJ/AAkAlACgAKoAAAUiJjQ2MzIWFAYlJjU0NzYzMhYVFAcOBwcWMzI2NTQ2Ny4CPQEeARUUBiMiJwYjIiYnDgEiJicmIyIGBwYjIjU0Njc+CTc2NTQmNTQ/AQ4BFDMyNxcOASMiJjU0PgIzMhYVFAYjIiYnNxYzMjY1NCYnBwYVFBYVFA8BHgEzMj4GNz4BNTQnJiMiBhUUBTY1NCYnDgEVFAPWCxMTCwwSEf3pIxwgThsjCgQMCxAKEgcSASosFTJDXSCBXrq0UUJBIyQ8IkETMCYgGxwaEg0tA1csCjohDhsPEQYKAwcDCQMCQgI0WnIgNRwQKTYwFBcfPXFIfntCJR05EQ0aNCEsXF8mAkYBJhE7DwQHBwkHDAgSLDUiBAQWHC8BPFoXEj8zAhIYEhIYEl84JTUlKykfIRMJEQ4QCg8GDgEzMBpSXxksWTQGATyxa0ZfOTooGCkbFiAtIwE6BwszFAgRBgwCEAMZDCkOCAIWQR4HDNcHWFAwCEUsIRofSEcvXDwlPispDC0dGyNJBaAIBhlEGggEowxYAgIHBAsHDyAwLyAHDhI5KyJwBYEiSRUdWUM+AAIADAAKAdMBzwAKAI8AACU0JiMiBhQWMzI2Jw4BIyImNDYzMhYXNjU0JyYjIiY0NjMyFx4BFxYzMjU0Jy4BNTQ2MzIWFRQGBxQzMjc+ATc2MzIWFRQGIyIGBwYVFDMyNjMyFhQGIyImIyIGFRQXHgEXFhUUBiMiJy4BJyYjIhUUFhUUBiMiJjQ2NTQjIgcOAQcGIyImNTQ3NjMyNzY1NAEWGA8QFRYPEBeJGSYOGRsaGQ0qGCUMFBgdHBkXEhALAxQLEhQBAiceFBIbIwEWEA0RAQ0MGhMeGxIbFQ0QIRsrDhwbHRkPJxQXEgsUOA0OGRcTFAwBExEKEiogExIdJhcNDhIDERIMFBoNDBYjEg3uEBQTIhYVCgElGSobJQIDFg4KExwoHQwLPhYNGA0IFycPFxobFhEjGSoQEzgPDhsUESMGCw4PFicdKBomCAoWChIDCw0ZExsOCzkVDx8eMBMUGBokMRckDhI9DAcWFBgODRINDBoAAAACAAD95AIdANwAAwAPAAA3FSE1JTMVITUzEyMDIRUjGQHq/f0ZAeoZARkB/hYZRoyMljIy/QgBcjIAAAAAAAwAlgABAAAAAAABAAcAEAABAAAAAAACAAcAKAABAAAAAAADACIAdgABAAAAAAAEAAcAqQABAAAAAAAFAAsAyQABAAAAAAAGAAcA5QADAAEECQABAA4AAAADAAEECQACAA4AGAADAAEECQADAEQAMAADAAEECQAEAA4AmQADAAEECQAFABYAsQADAAEECQAGAA4A1QBhAGIAYwAyAHMAdgBnAABhYmMyc3ZnAABSAGUAZwB1AGwAYQByAABSZWd1bGFyAABGAG8AbgB0AEYAbwByAGcAZQAgADIALgAwACAAOgAgAGEAYgBjADIAcwB2AGcAIAA6ACAAOQAtADMALQAyADAAMQA4AABGb250Rm9yZ2UgMi4wIDogYWJjMnN2ZyA6IDktMy0yMDE4AABhAGIAYwAyAHMAdgBnAABhYmMyc3ZnAABWAGUAcgBzAGkAbwBuACAAMQAuADAAAFZlcnNpb24gMS4wAABhAGIAYwAyAHMAdgBnAABhYmMyc3ZnAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABEAAAAAQACAQIBAwEEAQUBBgEHAQgBCQEKAQsBDAENAQ4BDwEQAREBEgETARQBFQEWARcBGAEZARoBGwEcAR0BHgEfASABIQEiASMBJAElASYBJwEoASkBKgErASwBLQEuAS8BMAExATIBMwE0ATUBNgE3ATgBOQE6ATsBPAE9AT4BPwFAAUEBQgYubm9kZWYHdW5pRTAwMAd1bmlFMDQ3B3VuaUUwNDgHdW5pRTA1MAd1bmlFMDVDB3VuaUUwNjIHdW5pRTA2OQd1bmlFMDdBB3VuaUUwN0IHdW5pRTA3Qwd1bmlFMDgwB3VuaUUwODEHdW5pRTA4Mgd1bmlFMDgzB3VuaUUwODQHdW5pRTA4NQd1bmlFMDg2B3VuaUUwODcHdW5pRTA4OAd1bmlFMDg5B3VuaUUwOEEHdW5pRTA4Qgd1bmlFMDhDB3VuaUUwOTQHdW5pRTA5NQd1bmlFMEEwB3VuaUUwQTEHdW5pRTBBMgd1bmlFMEEzB3VuaUUwQTQHdW5pRTBBOQd1bmlFMEIzB3VuaUUxMDEHdW5pRTFFNwd1bmlFMjYwB3VuaUUyNjEHdW5pRTI2Mgd1bmlFMjYzB3VuaUUyNjQHdW5pRTI4MAd1bmlFNEEwB3VuaUU0QUMHdW5pRTRDMAd1bmlFNENFB3VuaUU0RTEHdW5pRTRFMgd1bmlFNEUzB3VuaUU0RTQHdW5pRTRFNQd1bmlFNEU2B3VuaUU0RTcHdW5pRTRFOAd1bmlFNEU5B3VuaUU0RUEHdW5pRTRFRQd1bmlFNTAwB3VuaUU1MDEHdW5pRTU2Nwd1bmlFNTY5B3VuaUU1NkMHdW5pRTU2RAd1bmlFNjUwB3VuaUU2NTUHdW5pRTk1QwAAAAAAAAH//wACAAAAAQAAAADVs2WlAAAAANGXIhcAAAAA1qodLQ==")',defined_font={},font_tb={},fid=1,font_scale_tb={serif:1.05,serifBold:1.05,"sans-serif":1.1,"sans-serifBold":1.1,Palatino:1.1,Mono:1.35},fmt_lock={},cfmt={aligncomposer:1,breaklimit:.7,breakoneoln:!0,cancelkey:!0,composerspace:6,dblrepbar:":][:",decoerr:!0,dynalign:!0,fullsvg:"",gracespace:new Float32Array([4,8,11]),graceslurs:!0,hyphencont:!0,indent:0,infoname:'R "Rhythm: "\nB "Book: "\nS "Source: "\nD "Discography: "\nN "Notes: "\nZ "Transcription: "\nH "History: "',infospace:0,keywarn:!0,leftmargin:1.4*CM,lineskipfac:1.1,linewarn:!0,maxshrink:.65,maxstaffsep:2e3,maxsysstaffsep:2e3,measurefirst:1,measurenb:-1,musicspace:6,parskipfac:.4,partsspace:8,pagewidth:21*CM,printmargin:0,rightmargin:1.4*CM,rbdbstop:!0,rbmax:4,rbmin:2,scale:1,slurheight:1,staffsep:46,stemheight:21,stretchlast:.25,stretchstaff:!0,subtitlespace:3,sysstaffsep:34,textspace:14,titlespace:6,titletrim:!0,topspace:22,tuplets:[0,0,0,0],vocalspace:10,writefields:"CMOPQsTWw",wordsspace:5},textopt={align:"j",center:"c",fill:"f",justify:"j",ragged:"f",right:"r",skip:"s"},posval={above:C.SL_ABOVE,auto:0,below:C.SL_BELOW,down:C.SL_BELOW,hidden:C.SL_HIDDEN,opposite:C.SL_HIDDEN,under:C.SL_BELOW,up:C.SL_ABOVE};Abc.prototype.style_font=style_font;var abc_utf={"=D":"","=H":"","=T":"","=d":"","=h":"","=t":"","/O":"","/o":"","/L":"","/l":"",vL:"",vl:"",vd:"",".i":"",AA:"",aa:"",AE:"",ae:"",DH:"",dh:"",OE:"",oe:"",ss:"",TH:"",th:""},oct_acc={1:"",2:"",3:"",4:"&#x1d12a;",5:"&#x1d12b;"},include=0;Abc.prototype.tosvg=tosvg;var gene,staff_tb,nstaff,tsnext,realwidth,insert_meter,spf_last,space_tb=new Float32Array([7,10,14.15,20,28.3,40,56.6,80,100,120]),smallest_duration,dx_tb=new Float32Array([10,10,11,13,13]),hw_tb=new Float32Array([4.5,5,6,7,8]),w_note=new Float32Array([3.5,3.7,5,6,7]),delta_tb={t:-4,c:0,b:4,p:-6},rest_sp=[[18,18],[12,18],[12,12],[0,12],[6,8],[10,10],[6,4],[10,0],[10,4],[10,10]],delpit=[0,-7,-14,0],MAXPIT=96,blocks=[],a_gch,a_dcn,multicol,maps={},qplet_tb=new Int8Array([0,1,3,2,3,0,2,0,3,0]),ntb="CDEFGABcdefgab",note_pit=new Int8Array([0,2,4,5,7,9,11]),reg_dur=/(\d*)(\/*)(\d*)/g,cde2fcg=new Int8Array([0,2,4,-1,1,3,5]),cgd2cde=new Int8Array([0,4,1,5,2,6,3]),acc2=new Int8Array([-2,-1,3,1,2]),nil=["0"],char_tb=[nil,nil,nil,nil,nil,nil,nil,nil,nil," ","\n",nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil," ","!",'"',"i","\n",nil,"&",nil,"(",")","i",nil,nil,"-","!dot!",nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,"|","i","<","n","<","i","i","n","n","n","n","n","n","n","!fermata!","d","d","d","!emphasis!","!lowermordent!","d","!coda!","!uppermordent!","d","d","!segno!","!trill!","d","d","d","n","d","n","[","\\","|","n","n","i","n","n","n","n","n","n","n","d","d","d","d","d","d","d","d","d","d","d","d","d","!upbow!","!downbow!","d","n","n","n","{","|","}","!gmark!",nil],cw_tb=new Float32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.25,.333,.408,.5,.5,.833,.778,.333,.333,.333,.5,.564,.25,.564,.25,.278,.5,.5,.5,.5,.5,.5,.5,.5,.5,.5,.278,.278,.564,.564,.564,.444,.921,.722,.667,.667,.722,.611,.556,.722,.722,.333,.389,.722,.611,.889,.722,.722,.556,.722,.667,.556,.611,.722,.722,.944,.722,.722,.611,.333,.278,.333,.469,.5,.333,.444,.5,.444,.5,.444,.333,.5,.5,.278,.278,.5,.278,.778,.5,.5,.5,.5,.333,.389,.278,.5,.5,.722,.5,.5,.444,.48,.2,.48,.541,.5]),info_font_init={A:"info",C:"composer",O:"composer",P:"parts",Q:"tempo",R:"info",T:"title",X:"title"},output="",style="\n.fill {fill: currentColor}\n.stroke {stroke: currentColor; fill: none}\n.music text, .music tspan {fill:currentColor}",font_style="",posx=cfmt.leftmargin/cfmt.scale,posy=0,img={width:cfmt.pagewidth,lm:cfmt.leftmargin,rm:cfmt.rightmargin},defined_glyph={},defs="",fulldefs="",stv_g={scale:1,dy:0,st:-1,v:0,g:0},block={},tgls={brace:{x:0,y:0,c:""},sgno:{x:-6,y:0,c:""},coda:{x:-12,y:6,c:""},tclef:{x:-8,y:0,c:""},cclef:{x:-8,y:0,c:""},bclef:{x:-8,y:0,c:""},pclef:{x:-6,y:0,c:""},stclef:{x:-8,y:0,c:""},scclef:{x:-8,y:0,c:""},sbclef:{x:-7,y:0,c:""},spclef:{x:-6,y:0,c:""},meter0:{c:""},meter1:{c:""},meter2:{c:""},meter3:{c:""},meter4:{c:""},meter5:{c:""},meter6:{c:""},meter7:{c:""},meter8:{c:""},meter9:{c:""},"meter+":{c:""},"meter(":{c:""},"meter)":{c:""},csig:{x:0,y:0,c:""},ctsig:{x:0,y:0,c:""},HDD:{x:-7,y:0,c:""},breve:{x:-6,y:0,c:""},HD:{x:-5.2,y:0,c:""},Hd:{x:-3.8,y:0,c:""},hd:{x:-3.7,y:0,c:""},ghd:{x:2,y:0,c:"",sc:.66},pshhd:{x:-3.7,y:0,c:""},pfthd:{x:-3.7,y:0,c:""},x:{x:-3.7,y:0,c:""},"circle-x":{x:-3.7,y:0,c:""},srep:{x:-5,y:0,c:""},dot:{x:-2,y:0,c:""},"acc-1":{x:-3,y:0,c:""},acc3:{x:-2,y:0,c:""},acc1:{x:-3,y:0,c:""},acc2:{x:-3,y:0,c:""},"acc-2":{x:-3,y:0,c:""},"acc-1_1_4":{x:-3,y:0,c:""},accent:{x:-3,y:2,c:""},marcato:{x:-3,y:0,c:""},hld:{x:-7,y:0,c:""},brth:{x:0,y:0,c:""},r00:{x:-1.5,y:0,c:""},r0:{x:-1.5,y:0,c:""},r1:{x:-3.5,y:6,c:""},r2:{x:-3.2,y:0,c:""},r4:{x:-3,y:0,c:""},r8:{x:-3,y:0,c:""},r16:{x:-4,y:0,c:""},r32:{x:-4,y:0,c:""},r64:{x:-4,y:0,c:""},r128:{x:-4,y:0,c:""},mrest:{x:-10,y:0,c:""},mrep:{x:-6,y:0,c:""},mrep2:{x:-9,y:0,c:""},turn:{x:-5,y:4,c:""},turnx:{x:-5,y:4,c:""},umrd:{x:-7,y:2,c:""},lmrd:{x:-7,y:2,c:""},ped:{x:-10,y:0,c:""},pedoff:{x:-5,y:0,c:""},longa:{x:-6,y:0,c:""}},glyphs={acc1_1_4:'<g id="acc1_1_4">\n\t<path d="m0 7.8v-15.4" class="stroke"/>\n\t<path class="fill" d="M-1.8 2.7l3.6 -1.1v2.2l-3.6 1.1v-2.2z\n\t\tM-1.8 -3.7l3.6 -1.1v2.2l-3.6 1.1v-2.2"/>\n</g>',acc1_3_4:'<g id="acc1_3_4">\n\t<path d="m-2.5 8.7v-15.4M0 7.8v-15.4M2.5 6.9v-15.4" class="stroke"/>\n\t<path class="fill" d="m-3.7 3.1l7.4 -2.2v2.2l-7.4 2.2v-2.2z\n\t\tM-3.7 -3.2l7.4 -2.2v2.2l-7.4 2.2v-2.2"/>\n</g>',"acc-1_3_4":'<g id="acc-1_3_4">\n    <path class="fill" d="m0.6 -2.7\n\tc-5.7 -3.1 -5.7 3.6 0 6.7c-3.9 -4 -4 -7.6 0 -5.8\n\tM1 -2.7c5.7 -3.1 5.7 3.6 0 6.7c3.9 -4 4 -7.6 0 -5.8"/>\n    <path d="m1.6 3.5v-13M0 3.5v-13" class="stroke" stroke-width=".6"/>\n</g>',pmsig:'<path id="pmsig" class="stroke" stroke-width="0.8"\n\td="m0 -7a5 5 0 0 1 0 -10a5 5 0 0 1 0 10"/>',pMsig:'<g id="pMsig">\n\t<use xlink:href="#pmsig"/>\n\t<path class="fill" d="m0 -10a2 2 0 0 1 0 -4a2 2 0 0 1 0 4"/>\n</g>',imsig:'<path id="imsig" class="stroke" stroke-width="0.8"\n\td="m3 -8a5 5 0 1 1 0 -8"/>',iMsig:'<g id="iMsig">\n\t<use xlink:href="#imsig"/>\n\t<path class="fill" d="m0 -10a2 2 0 0 1 0 -4a2 2 0 0 1 0 4"/>\n</g>',hl:'<path id="hl" class="stroke" stroke-width="1" d="m-6 0h12"/>',hl1:'<path id="hl1" class="stroke" stroke-width="1" d="m-7 0h14"/>',hl2:'<path id="hl2" class="stroke" stroke-width="1" d="m-9 0h18"/>',ghl:'<path id="ghl" class="stroke" d="m-3.5 0h7"/>',rdots:'<g id="rdots" class="fill">\n\t<circle cx="0" cy="-9" r="1.2"/>\n\t<circle cx="0" cy="-15" r="1.2"/>\n</g>',grm:'<path id="grm" class="fill" d="m-5 -2.5\n\tc5 -8.5 5.5 4.5 10 -2 -5 8.5 -5.5 -4.5 -10 2"/>',stc:'<circle id="stc" class="fill" cx="0" cy="-3" r="1.2"/>',sld:'<path id="sld" class="fill" d="m-7.2 4.8\n\tc1.8 .7 4.5 -.2 7.2 -4.8 -2.1 5 -5.4 6.8 -7.6 6"/>',emb:'<path id="emb" class="stroke" stroke-width="1.2" stroke-linecap="round"\n\td="m-2.5 -3h5"/>',roll:'<path id="roll" class="fill" d="m-6 0\n\tc0.4 -7.3 11.3 -7.3 11.7 0 -1.3 -6 -10.4 -6 -11.7 0"/>',upb:'<path id="upb" class="stroke" d="m-2.6 -9.4\n\tl2.6 8.8 2.6 -8.8"/>',dnb:'<g id="dnb">\n\t<path d="M-3.2 -2v-7.2m6.4 0v7.2" class="stroke"/>\n\t<path d="M-3.2 -6.8v-2.4l6.4 0v2.4" class="fill"/>\n</g>',dplus:'<path id="dplus" class="stroke" stroke-width="1.7"\n\td="m0 -.5v-6m-3 3h6"/>',lphr:'<path id="lphr" class="stroke" stroke-width="1.2"\n\td="m0 0v18"/>',mphr:'<path id="mphr" class="stroke" stroke-width="1.2"\n\td="m0 0v12"/>',sphr:'<path id="sphr" class="stroke" stroke-width="1.2"\n\td="m0 0v6"/>',sfz:'<text id="sfz" x="-5" y="-7" style="font-family:serif; font-style:italic; font-size:14px">\n\ts<tspan font-size="16" font-weight="bold">f</tspan>z</text>',trl:'<text id="trl" x="-2" y="-4"\n\tstyle="font-family:serif; font-weight:bold; font-style:italic; font-size:16px">tr</text>',opend:'<circle id="opend" class="stroke"\n\tcx="0" cy="-3" r="2.5"/>',snap:'<path id="snap" class="stroke" d="m-3 -6\n\tc0 -5 6 -5 6 0 0 5 -6 5 -6 0\n\tM0 -5v6"/>',thumb:'<path id="thumb" class="stroke" d="m-2.5 -7\n\tc0 -6 5 -6 5 0 0 6 -5 6 -5 0\n\tM-2.5 -9v4"/>',wedge:'<path id="wedge" class="fill" d="m0 -1l-1.5 -5h3l-1.5 5"/>',ltr:'<path id="ltr" class="fill"\n\td="m0 -.4c2 -1.5 3.4 -1.9 3.9 .4 0.2 .8 .7 .7 2.1 -.4\n\tv0.8c-2 1.5 -3.4 1.9 -3.9 -.4 -.2 -.8 -.7 -.7 -2.1 .4z"/>',custos:'<g id="custos">\n\t<path class="fill" d="m-4 0l2 2.5 2 -2.5 2 2.5 2 -2.5\n\t\t-2 -2.5 -2 2.5 -2 -2.5 -2 2.5"/>\n\t<path class="stroke" d="m3.5 0l5 -7"/>\n</g>',triangle:'<path id="triangle" class="fill" d="m-3.7 -3.2l7.4 0 -3.7 6.4 -3.7 -6.4"/>',diamond:'<path id="diamond" class="fill" d="m0 3.5l-3.7 -3.5 3.7 -3.5 3.7 3.5z"/>',oct:'<text id="oct" style="font-family:serif; font-size:12px">8</text>'},anno_type=["bar","clef","custos","","grace","key","meter","Zrest","note","part","rest","yspace","staves","Break","tempo","","block","remark"],anno_start=user.anno_start?a_start:empty_function,anno_stop=user.anno_stop?a_stop:empty_function;Abc.prototype.out_svg=function(t){output+=t},Abc.prototype.sx=sx,Abc.prototype.sy=sy,Abc.prototype.sh=function(t){return stv_g.st<0?t/stv_g.scale:t},Abc.prototype.ax=function(t){return t+posx},Abc.prototype.ay=function(t){return stv_g.st<0?posy-t:posy+(stv_g.dy-t)*stv_g.scale-stv_g.dy},Abc.prototype.ah=function(t){return stv_g.st<0?t:t*stv_g.scale},Abc.prototype.out_sxsy=out_sxsy,Abc.prototype.xypath=xypath;var deco_str_style={crdc:{dx:0,dy:5,style:"font-family:serif; font-style:italic; font-size:14px"},dacs:{dx:0,dy:3,style:"font-family:serif; font-size:16px",anchor:' text-anchor="middle"'},fng:{dx:0,dy:1,style:"font-family:Bookman; font-size:8px",anchor:' text-anchor="middle"'},pf:{dx:0,dy:5,style:"font-family:serif; font-weight:bold; font-style:italic; font-size:16px"},"@":{dx:0,dy:5,style:"font-family:sans-serif; font-size:12px"}},deco_val_tb={arp:out_arp,cresc:out_cresc,dim:out_dim,ltr:out_ltr,"8va":out_8va,"8vb":out_8vb,"15ma":out_15ma,"15mb":out_15mb},deco_l_tb={glisq:out_glisq,gliss:out_gliss};Abc.prototype.blk_out=blk_out,Abc.prototype.blk_flush=blk_flush;var par_sy,cur_sy,voice_tb,curvoice,staves_found,vover,tsfirst,w_tb=new Uint8Array([2,1,8,0,3,5,6,9,9,0,9,3,0,7,0,0,0,0]),note_names="CDEFGAB",latin_names=["Do","Re","Mi","Fa","Sol","La","Si"],acc_name=["bb","b","","#","##"];font_init(),init_tune(),Abc.prototype.add_style=function(t){style+=t},Abc.prototype.cfmt=function(){return cfmt},Abc.prototype.get_a_gch=function(){return a_gch},Abc.prototype.get_cur_sy=function(){return cur_sy},Abc.prototype.get_curvoice=function(){return curvoice},Abc.prototype.get_delta_tb=function(){return delta_tb},Abc.prototype.get_decos=function(){return decos},Abc.prototype.get_fname=function(){return parse.fname},Abc.prototype.get_font=get_font,Abc.prototype.get_font_style=function(){return font_style},Abc.prototype.get_glyphs=function(){return glyphs},Abc.prototype.get_img=function(){return img},Abc.prototype.get_maps=function(){return maps},Abc.prototype.get_multi=function(){return multicol},Abc.prototype.get_newpage=function(){if(block.newpage)return block.newpage=!1,!0},Abc.prototype.get_posy=function(){var t=posy;return posy=0,t},Abc.prototype.get_staff_tb=function(){return staff_tb},Abc.prototype.get_top_v=function(){return par_sy.top_voice},Abc.prototype.get_tsfirst=function(){return tsfirst},Abc.prototype.get_voice_tb=function(){return voice_tb},Abc.prototype.info=function(){return info},Abc.prototype.set_cur_sy=function(t){cur_sy=t},Abc.prototype.set_tsfirst=function(t){tsfirst=t},Abc.prototype.set_xhtml=function(t){var e=write_text;return write_text=t,e},Abc.prototype.sort_pitch=sort_pitch,Abc.prototype.stv_g=function(){return stv_g},Abc.prototype.svg_flush=svg_flush;var hook_init,self=this}};var Abc=abc2svg.Abc;"object"==typeof module&&"object"==typeof exports&&(exports.abc2svg=abc2svg,exports.Abc=Abc),abc2svg.loadjs=function(t,e,r){r&&r()},abc2svg.modules={ambitus:{fn:"ambitus-1.js"},beginps:{fn:"psvg-1.js"},break:{fn:"break-1.js"},capo:{fn:"capo-1.js"},clip:{fn:"clip-1.js"},voicecombine:{fn:"combine-1.js"},diagram:{fn:"diag-1.js"},equalbars:{fn:"equalbars-1.js"},grid:{fn:"grid-1.js"},grid2:{fn:"grid2-1.js"},MIDI:{fn:"MIDI-1.js"},percmap:{fn:"perc-1.js"},sth:{fn:"sth-1.js"},temperament:{fn:"temper-1.js"},nreq:0,hooks:[],g_hooks:[],load:function(t,e,r){var n,a=this.nreq,i=t.match(/(^|\n)(%%|I:).+?\b/g);if(!i)return!0;this.cbf=e||function(){},this.errmsg=r||function(){return"object"==typeof user&&user.errmsg?user.errmsg:"function"==typeof printErr?printErr:"function"==typeof alert?function(t){alert(t)}:"object"==typeof console?console.log:function(){}}();for(var o=0;o<i.length;o++)(n=abc2svg.modules[i[o].replace(/\n?(%%|I:)/,"")])&&!n.loaded&&(n.loaded=!0,this.nreq++,abc2svg.loadjs(n.fn,function(){0==--abc2svg.modules.nreq&&abc2svg.modules.cbf()},function(){abc2svg.modules.errmsg("error loading "+n.fn),0==--abc2svg.modules.nreq&&abc2svg.modules.cbf()}));return this.nreq==a}},abc2svg.version="1.17.8-4f07d34b4d",abc2svg.vdate="2018-08-24","object"==typeof module&&"object"==typeof exports&&(exports.ToAudio=ToAudio);var abcsf2=[];!function(t,e){"object"==typeof exports?(t.sf2=exports,e(exports)):"function"==typeof define&&define.amd?define(["exports"],function(r){return t.sf2=r,t.sf2,e(r)}):(t.sf2={},e(t.sf2))}(this,function(t){"use strict";var e=t;return e.Parser=function(t,e){e=e||{},this.input=t,this.parserOptions=e.parserOptions},e.Parser.prototype.parse=function(){var t,r=new e.Riff.Parser(this.input,this.parserOptions);if(r.parse(),1!==r.chunkList.length)throw new Error("wrong chunk length");if(null===(t=r.getChunk(0)))throw new Error("chunk not found");this.parseRiffChunk(t),this.input=null},e.Parser.prototype.parseRiffChunk=function(t){var r,n,a=this.input,i=t.offset;if("RIFF"!==t.type)throw new Error("invalid chunk type:"+t.type);if("sfbk"!==(n=String.fromCharCode(a[i++],a[i++],a[i++],a[i++])))throw new Error("invalid signature:"+n);if(r=new e.Riff.Parser(a,{index:i,length:t.size-4}),r.parse(),3!==r.getNumberOfChunks())throw new Error("invalid sfbk structure");this.parseInfoList(r.getChunk(0)),this.parseSdtaList(r.getChunk(1)),this.parsePdtaList(r.getChunk(2))},e.Parser.prototype.parseInfoList=function(t){var r,n,a=this.input,i=t.offset;if("LIST"!==t.type)throw new Error("invalid chunk type:"+t.type);if("INFO"!==(n=String.fromCharCode(a[i++],a[i++],a[i++],a[i++])))throw new Error("invalid signature:"+n);r=new e.Riff.Parser(a,{index:i,length:t.size-4}),r.parse()},e.Parser.prototype.parseSdtaList=function(t){var r,n,a=this.input,i=t.offset;if("LIST"!==t.type)throw new Error("invalid chunk type:"+t.type);if("sdta"!==(n=String.fromCharCode(a[i++],a[i++],a[i++],a[i++])))throw new Error("invalid signature:"+n);if(r=new e.Riff.Parser(a,{index:i,length:t.size-4}),r.parse(),1!==r.chunkList.length)throw new Error("TODO");this.samplingData=r.getChunk(0)},e.Parser.prototype.parsePdtaList=function(t){var r,n,a=this.input,i=t.offset;if("LIST"!==t.type)throw new Error("invalid chunk type:"+t.type);if("pdta"!==(n=String.fromCharCode(a[i++],a[i++],a[i++],a[i++])))throw new Error("invalid signature:"+n);if(r=new e.Riff.Parser(a,{index:i,length:t.size-4}),r.parse(),9!==r.getNumberOfChunks())throw new Error("invalid pdta chunk");this.parsePhdr(r.getChunk(0)),this.parsePbag(r.getChunk(1)),this.parsePmod(r.getChunk(2)),this.parsePgen(r.getChunk(3)),this.parseInst(r.getChunk(4)),this.parseIbag(r.getChunk(5)),this.parseImod(r.getChunk(6)),this.parseIgen(r.getChunk(7)),this.parseShdr(r.getChunk(8))},e.Parser.prototype.parsePhdr=function(t){var e=this.input,r=t.offset,n=this.presetHeader=[],a=t.offset+t.size;if("phdr"!==t.type)throw new Error("invalid chunk type:"+t.type);for(;r<a;)n.push({presetName:String.fromCharCode.apply(null,e.subarray(r,r+=20)),preset:e[r++]|e[r++]<<8,bank:e[r++]|e[r++]<<8,presetBagIndex:e[r++]|e[r++]<<8,library:(e[r++]|e[r++]<<8|e[r++]<<16|e[r++]<<24)>>>0,genre:(e[r++]|e[r++]<<8|e[r++]<<16|e[r++]<<24)>>>0,morphology:(e[r++]|e[r++]<<8|e[r++]<<16|e[r++]<<24)>>>0})},e.Parser.prototype.parsePbag=function(t){var e=this.input,r=t.offset,n=this.presetZone=[],a=t.offset+t.size;if("pbag"!==t.type)throw new Error("invalid chunk type:"+t.type);for(;r<a;)n.push({presetGeneratorIndex:e[r++]|e[r++]<<8,presetModulatorIndex:e[r++]|e[r++]<<8})},e.Parser.prototype.parsePmod=function(t){if("pmod"!==t.type)throw new Error("invalid chunk type:"+t.type);this.presetZoneModulator=this.parseModulator(t)},e.Parser.prototype.parsePgen=function(t){if("pgen"!==t.type)throw new Error("invalid chunk type:"+t.type);this.presetZoneGenerator=this.parseGenerator(t)},e.Parser.prototype.parseInst=function(t){var e=this.input,r=t.offset,n=this.instrument=[],a=t.offset+t.size;if("inst"!==t.type)throw new Error("invalid chunk type:"+t.type);for(;r<a;)n.push({instrumentName:String.fromCharCode.apply(null,e.subarray(r,r+=20)),instrumentBagIndex:e[r++]|e[r++]<<8})},e.Parser.prototype.parseIbag=function(t){var e=this.input,r=t.offset,n=this.instrumentZone=[],a=t.offset+t.size;if("ibag"!==t.type)throw new Error("invalid chunk type:"+t.type);for(;r<a;)n.push({instrumentGeneratorIndex:e[r++]|e[r++]<<8,instrumentModulatorIndex:e[r++]|e[r++]<<8})},e.Parser.prototype.parseImod=function(t){if("imod"!==t.type)throw new Error("invalid chunk type:"+t.type);this.instrumentZoneModulator=this.parseModulator(t)},e.Parser.prototype.parseIgen=function(t){if("igen"!==t.type)throw new Error("invalid chunk type:"+t.type);this.instrumentZoneGenerator=this.parseGenerator(t)},
e.Parser.prototype.parseShdr=function(t){var e,r,n,a,i,o,s,c,l,u,f=this.input,$=t.offset,_=this.sample=[],d=this.sampleHeader=[],p=t.offset+t.size;if("shdr"!==t.type)throw new Error("invalid chunk type:"+t.type);for(;$<p;){e=String.fromCharCode.apply(null,f.subarray($,$+=20)),r=f[$++]<<0|f[$++]<<8|f[$++]<<16|f[$++]<<24,n=f[$++]<<0|f[$++]<<8|f[$++]<<16|f[$++]<<24,a=f[$++]<<0|f[$++]<<8|f[$++]<<16|f[$++]<<24,i=f[$++]<<0|f[$++]<<8|f[$++]<<16|f[$++]<<24,o=f[$++]<<0|f[$++]<<8|f[$++]<<16|f[$++]<<24,s=f[$++],c=f[$++]<<24>>24,l=f[$++]|f[$++]<<8,u=f[$++]|f[$++]<<8;var h=new Int16Array(new Uint8Array(f.subarray(this.samplingData.offset+2*r,this.samplingData.offset+2*n)).buffer);if(a-=r,i-=r,o>0){var g=this.adjustSampleData(h,o);h=g.sample,o*=g.multiply,a*=g.multiply,i*=g.multiply}_.push(h),d.push({sampleName:e,startLoop:a,endLoop:i,sampleRate:o,originalPitch:s,pitchCorrection:c,sampleLink:l,sampleType:u})}},e.Parser.prototype.adjustSampleData=function(t,e){for(var r,n,a,i,o=1;e<22050;){for(r=new Int16Array(2*t.length),n=i=0,a=t.length;n<a;++n)r[i++]=t[n],r[i++]=t[n];t=r,o*=2,e*=2}return{sample:t,multiply:o}},e.Parser.prototype.parseModulator=function(t){for(var r,n,a=this.input,i=t.offset,o=t.offset+t.size,s=[];i<o;){if(i+=2,r=a[i++]|a[i++]<<8,void 0===(n=e.Parser.GeneratorEnumeratorTable[r]))s.push({type:n,value:{code:r,amount:a[i]|a[i+1]<<8<<16>>16,lo:a[i++],hi:a[i++]}});else switch(n){case"keyRange":case"velRange":case"keynum":case"velocity":s.push({type:n,value:{lo:a[i++],hi:a[i++]}});break;default:s.push({type:n,value:{amount:a[i++]|a[i++]<<8<<16>>16}})}i+=2,i+=2}return s},e.Parser.prototype.parseGenerator=function(t){for(var r,n,a=this.input,i=t.offset,o=t.offset+t.size,s=[];i<o;)if(r=a[i++]|a[i++]<<8,void 0!==(n=e.Parser.GeneratorEnumeratorTable[r]))switch(n){case"keynum":case"keyRange":case"velRange":case"velocity":s.push({type:n,value:{lo:a[i++],hi:a[i++]}});break;default:s.push({type:n,value:{amount:a[i++]|a[i++]<<8<<16>>16}})}else s.push({type:n,value:{code:r,amount:a[i]|a[i+1]<<8<<16>>16,lo:a[i++],hi:a[i++]}});return s},e.Parser.prototype.getInstruments=function(){var t,e,r,n,a,i,o,s,c,l=this.instrument,u=this.instrumentZone,f=[];for(i=0,o=l.length;i<o;++i){for(t=l[i].instrumentBagIndex,e=l[i+1]?l[i+1].instrumentBagIndex:u.length,r=[],s=t,c=e;s<c;++s)n=this.createInstrumentGenerator_(u,s),a=this.createInstrumentModulator_(u,s),r.push({generator:n.generator,modulator:a.modulator});f.push({name:l[i].instrumentName,info:r})}return f},e.Parser.prototype.createInstrumentGenerator_=function(t,e){return{generator:this.createBagModGen_(t,t[e].instrumentGeneratorIndex,t[e+1]?t[e+1].instrumentGeneratorIndex:this.instrumentZoneGenerator.length,this.instrumentZoneGenerator).modgen}},e.Parser.prototype.createInstrumentModulator_=function(t,e){return{modulator:this.createBagModGen_(t,t[e].presetModulatorIndex,t[e+1]?t[e+1].instrumentModulatorIndex:this.instrumentZoneModulator.length,this.instrumentZoneModulator).modgen}},e.Parser.prototype.createBagModGen_=function(t,e,r,n){var a,i,o,s={unknown:[],keyRange:{hi:127,lo:0}};for(i=e,o=r;i<o;++i)a=n[i],"unknown"===a.type?s.unknown.push(a.value):s[a.type]=a.value;return{modgen:s}},e.Parser.GeneratorEnumeratorTable=["startAddrsOffset","endAddrsOffset","startloopAddrsOffset","endloopAddrsOffset","startAddrsCoarseOffset","modLfoToPitch","vibLfoToPitch","modEnvToPitch","initialFilterFc","initialFilterQ","modLfoToFilterFc","modEnvToFilterFc","endAddrsCoarseOffset","modLfoToVolume",void 0,"chorusEffectsSend","reverbEffectsSend","pan",void 0,void 0,void 0,"delayModLFO","freqModLFO","delayVibLFO","freqVibLFO","delayModEnv","attackModEnv","holdModEnv","decayModEnv","sustainModEnv","releaseModEnv","keynumToModEnvHold","keynumToModEnvDecay","delayVolEnv","attackVolEnv","holdVolEnv","decayVolEnv","sustainVolEnv","releaseVolEnv","keynumToVolEnvHold","keynumToVolEnvDecay","instrument",void 0,"keyRange","velRange","startloopAddrsCoarseOffset","keynum","velocity","initialAttenuation",void 0,"endloopAddrsCoarseOffset","coarseTune","fineTune","sampleID","sampleModes",void 0,"scaleTuning","exclusiveClass","overridingRootKey"],e.Riff={},e.Riff.Parser=function(t,e){e=e||{},this.input=t,this.ip=e.index||0,this.length=e.length||t.length-this.ip,this.offset=this.ip,this.padding=void 0===e.padding||e.padding,this.bigEndian=void 0!==e.bigEndian&&e.bigEndian},e.Riff.Chunk=function(t,e,r){this.type=t,this.size=e,this.offset=r},e.Riff.Parser.prototype.parse=function(){var t=this.length+this.offset;for(this.chunkList=[];this.ip<t;)this.parseChunk()},e.Riff.Parser.prototype.parseChunk=function(){var t,r=this.input,n=this.ip;this.chunkList.push(new e.Riff.Chunk(String.fromCharCode(r[n++],r[n++],r[n++],r[n++]),t=this.bigEndian?r[n++]<<24|r[n++]<<16|r[n++]<<8|r[n++]:r[n++]|r[n++]<<8|r[n++]<<16|r[n++]<<24,n)),n+=t,1===(this.padding&&n-this.offset&1)&&n++,this.ip=n},e.Riff.Parser.prototype.getChunk=function(t){var e=this.chunkList[t];return void 0===e?null:e},e.Riff.Parser.prototype.getNumberOfChunks=function(){return this.chunkList.length},e}),navigator.requestMIDIAccess&&navigator.requestMIDIAccess({sysex:!0}).then(onMIDISuccess,onMIDIFailure1),abc2svg.ambitus={do_ambitus:function(){var t,e,r,n,a,i=abc2svg.C,o=this.get_voice_tb();for(e=0;e<o.length;e++)if(r=o[e],!r.second){for(n=100,a=-100,t=r.sym;t;t=t.next)t.type==i.NOTE&&(t.notes[t.nhd].pit>a&&(a=t.notes[t.nhd].pit),t.notes[0].pit<n&&(n=t.notes[0].pit));100!=n&&(t=r.clef,t.stem=1,t.head=i.FULL,t.stemless=!0,t.nhd=1,t.notes=[{dur:i.BLEN/4,pit:n,shhd:0},{dur:i.BLEN/4,pit:a,shhd:0}])}},draw_symbols:function(t,e){var r=this.get_staff_tb(),n=e.sym;void 0!=n.clef_type&&n.nhd>0&&(n.x-=26,this.set_scale(n),this.draw_note(n),n.notes[1].pit-n.notes[0].pit>4&&(this.xypath(n.x,3*(n.notes[1].pit-18)+r[n.st].y),this.out_svg("v"+(3*(n.notes[1].pit-n.notes[0].pit)).toFixed(2)+'" stroke-width=".6"/>\n')),n.x+=26,e.clef.nhd=0),t(e)},set_pitch:function(t,e){t(e),!e&&this.cfmt().ambitus&&abc2svg.ambitus.do_ambitus.call(this)},set_fmt:function(t,e,r,n){if("ambitus"==e)return void(this.cfmt().ambitus=r);t(e,r,n)},set_width:function(t,e){void 0!=e.clef_type&&e.nhd>0?(e.wl=40,e.wr=12):t(e)}},abc2svg.modules.hooks.push("draw_note","set_scale",["draw_symbols","abc2svg.ambitus.draw_symbols"],["set_pitch","abc2svg.ambitus.set_pitch"],["set_format","abc2svg.ambitus.set_fmt"],["set_width","abc2svg.ambitus.set_width"]),abc2svg.modules.ambitus.loaded=!0,abc2svg.break={get_break:function(t){var e,r,a,i,o=abc2svg.C,s=t.split(/[ ,]/),c=this.cfmt();for(c.break||(c.break=[]),n=1;n<s.length;n++)e=s[n],r=e.match(/(\d+)([a-z]?)(:\d+\/\d+)?/),r?(r[2]&&(i=r[2].charCodeAt(0)-97),r[3]?(a=r[3].match(/:(\d+)\/(\d+)/),!a||a[2]<1?this.syntax(1,"Bad denominator in %%break"):c.break.push({m:r[1],t:a[1]*o.BLEN/a[2],sq:i})):c.break.push({m:r[1],t:0,sq:i})):this.syntax(1,errs.bad_val,"%%break")},do_break:function(){var t,e,r,n,a,i=this.get_voice_tb();for(v=this.get_cur_sy().top_voice,s1=i[v].sym,cfmt=this.cfmt(),t=0;t<cfmt.break.length;t++){for(n=cfmt.break[t],e=n.m,s=s1;s&&s.bar_num!=e;s=s.next);if(s){if(n.sq){for(a=n.sq,s=s.ts_next;s&&(s.bar_num!=e||0!=--a);s=s.ts_next);if(!s)continue}if(r=n.t){for(r=s.time+r;s&&!(s.time>=r);s=s.next);if(!s)continue;s=s.prev}s.eoln=!0}}},do_pscom:function(t,e){"break "==e.slice(0,6)?abc2svg.break.get_break.call(this,e):t(e)},set_bar_num:function(t){t(),this.cfmt().break&&abc2svg.break.do_break.call(this)}},abc2svg.modules.hooks.push("errs","syntax",["do_pscom","abc2svg.break.do_pscom"],["set_bar_num","abc2svg.break.set_bar_num"]),abc2svg.modules.break.loaded=!0,abc2svg.capo={gch_capo:function(t){for(var e,r,n=this.cfmt(),a=n.capo,i=0;;){if(!(e=t[i++]))return;if("g"==e.type)break}r=Object.create(e),r.capo=!1,r.text=this.gch_tr1(r.text,[0,5,-2,3,-4,1,-6,-1,4,-3,2,-5][a%12]),this.capo_first||(this.capo_first=!0,r.text+="  (capo: "+a.toString()+")"),r.font=this.get_font(n.capofont?"capo":"annotation"),t.splice(i,0,r),e.capo=!0},gch_build:function(t,e){var r=this.get_a_gch();this.cfmt().capo&&r&&abc2svg.capo.gch_capo.call(this,r),t(e)},output_music:function(t){this.capo_first=!1,t()},set_fmt:function(t,e,r,n){if("capo"==e)return void(this.cfmt().capo=r);t(e,r,n)}},abc2svg.modules.hooks.push("gch_tr1","get_font",["set_format","abc2svg.capo.set_fmt"],["gch_build","abc2svg.capo.gch_build"],["output_music","abc2svg.capo.output_music"]),abc2svg.modules.capo.loaded=!0,abc2svg.clip={get_clip:function(t){function e(t){var e,r=t.match(/(\d+)([a-z]?)(:\d+\/\d+)?/);if(r){if(r[2]&&(e=r[2].charCodeAt(0)-97),!r[3])return{m:r[1],t:0,sq:e};if((t=r[3].match(/:(\d+)\/(\d+)/))&&!(t[2]<1))return{m:r[1],t:t[1]*a.BLEN/t[2],sq:e}}}var r,n,a=abc2svg.C,i=t.split(/[ -]/);return 3!=i.length?void this.syntax(1,this.errs.bad_val,"%%clip"):(r=i[1]?e(i[1]):{m:0,t:0},n=e(i[2]),r&&n?void(this.cfmt().clip=[r,n]):void this.syntax(1,this.errs.bad_val,"%%clip"))},do_clip:function(){function t(t,r){var n,a,i;if(r.m<=1){if(1==r.m){for(n=t;n&&(n.type!=e.BAR||0==n.time);n=n.ts_next);n.time<voice_tb[this.get_cur_sy().top_voice].meter.wmeasure&&(t=n)}}else{for(;t&&!(t.type==e.BAR&&t.bar_num>=r.m);t=t.ts_next);if(!t)return;if(r.sq){for(i=r.sq,t=t.ts_next;t&&(t.type!=e.BAR||t.bar_num!=r.m||0!=--i);t=t.ts_next);if(!t)return}}if(0==r.t)return t;for(a=t.time+r.t;t.time<a;)if(!(t=t.ts_next))return t;do{t=t.ts_prev}while(!t.seqst);return t}var e=abc2svg.C;voice_tb=this.get_voice_tb(),cfmt=this.cfmt();var r,n,a,i,o;if(r=this.get_tsfirst(),cfmt.clip[0].m>0||cfmt.clip[0].t>0){if(!(r=t(r,cfmt.clip[0])))return void this.set_tsfirst(null);for(a=this.get_cur_sy(),n=this.get_tsfirst();n!=r;n=n.ts_next)switch(n.type){case e.CLEF:n.p_v.clef=n;break;case e.KEY:n.p_v.key=this.clone(n.as.u.key);break;case e.METER:n.p_v.meter=this.clone(n.as.u.meter);break;case e.STAVES:a=n.sy,this.set_cur_sy(a)}for(o=0;o<voice_tb.length;o++){for(i=voice_tb[o],n=r;n;n=n.ts_next)if(n.v==o){delete n.prev;break}i.sym=n}this.set_tsfirst(r),delete r.ts_prev}if(r=t(r,cfmt.clip[1])){do{if(!(r=r.ts_next))return}while(!r.seqst);for(o=0;o<voice_tb.length;o++){for(i=voice_tb[o],n=r.ts_prev;n;n=n.ts_prev)if(n.v==o){delete n.next;break}n||(i.sym=null)}delete r.ts_prev.ts_next}},do_pscom:function(t,e){"clip "==e.slice(0,5)?abc2svg.clip.get_clip.call(this,e):t(e)},set_bar_num:function(t){t(),this.cfmt().clip&&abc2svg.clip.do_clip.call(this)}},abc2svg.modules.hooks.push("clone","errs","syntax",["do_pscom","abc2svg.clip.do_pscom"],["set_bar_num","abc2svg.clip.set_bar_num"]),abc2svg.modules.clip.loaded=!0,abc2svg.combine={comb_v:function(){function t(t){var e,r=t.ts_next;return!(!r||r.type!=i.NOTE&&r.type!=i.REST)&&(r.v!=t.v&&r.st==t.st&&r.time==t.time&&r.dur==t.dur&&(!(t.combine<=0&&r.type!=t.type)&&((!t.a_gch||!r.a_gch)&&(t.type==i.REST?!(t.type==r.type&&t.invis&&!r.invis):!(r.a_ly||r.sl1||r.sl2||r.slur_start||r.slur_end)&&(r.beam_st==t.beam_st&&r.beam_end==t.beam_end&&(e=r.nhd,!(t.combine<=1&&t.notes[0].pit<=r.notes[e].pit+1)))))))}function e(t,e){var r,n,a;if(t.notes=t.notes.concat(e.notes),t.nhd=r=t.notes.length-1,this.sort_pitch(t),t.combine>=3){for(a=r;a>0;a--)t.notes[a].pit==t.notes[a-1].pit&&t.notes[a].acc==t.notes[a-1].acc&&t.notes.splice(a,1);t.nhd=r=t.notes.length-1}t.ymx=3*(t.notes[r].pit-18)+4,t.ymn=3*(t.notes[0].pit-18)-4,n=t.notes[0].ti1,(15&n)==i.SL_AUTO&&(t.notes[0].ti1=i.SL_BELOW|n&~i.SL_DOTTED),(15&(n=t.notes[r].ti1))==i.SL_AUTO&&(t.notes[r].ti1=i.SL_ABOVE|n&~i.SL_DOTTED)}function r(r){for(var n;;)if(r.nhd,n=r.ts_next,n.nhd,r.type!=n.type?n.type!=i.REST&&(n=r,r=n.ts_next):r.type==i.REST?r.invis&&!n.invis&&delete r.invis:e.call(this,r,n),n.a_gch&&(r.a_gch=n.a_gch),n.a_dd&&(r.a_dd?r.a_dd=r.a_dd.concat(n.a_dd):r.a_dd=n.a_dd),this.unlksym(n),r.in_tuplet||!t.call(this,r))break}var n,a,i=abc2svg.C;for(n=this.get_tsfirst();n;n=n.ts_next){switch(n.type){case i.REST:if(void 0==n.combine||n.combine<0)continue;t.call(this,n)&&r.call(this,n);continue;default:continue;case i.NOTE:if(void 0==n.combine||n.combine<=0)continue}if(n.beam_st)if(n.beam_end)t.call(this,n)&&r.call(this,n);else{for(a=n;;){if(!t.call(this,a)){a=null;break}if(a.beam_end)break;do{a=a.next}while(a.type!=i.NOTE&&a.type!=i.REST)}if(a)for(a=n;;){if(r.call(this,a),a.beam_end)break;do{a=a.next}while(a.type!=i.NOTE&&a.type!=i.REST)}}}},do_pscom:function(t,e){"voicecombine "==e.slice(0,13)?this.set_v_param("combine",e.split(/[ \t]/)[1]):t(e)},new_note:function(t,e,r){var n=this.get_curvoice(),a=t(e,r);return a&&a.notes&&void 0!=n.combine&&(a.combine=n.combine),a},set_stem_dir:function(t){t(),abc2svg.combine.comb_v.call(this)},set_vp:function(t,e){var r,n=this.get_curvoice();for(r=0;r<e.length;r++)if("combine="==e[r]){n.combine=e[r+1];break}t(e)}},abc2svg.modules.hooks.push("set_v_param","sort_pitch","unlksym",["do_pscom","abc2svg.combine.do_pscom"],["new_note","abc2svg.combine.new_note"],["set_stem_dir","abc2svg.combine.set_stem_dir"],["set_vp","abc2svg.combine.set_vp"]),abc2svg.modules.voicecombine.loaded=!0,abc2svg.diag={do_diag:function(){var t=this.get_glyphs(),e=this.get_voice_tb();if(!t.fb){var r,n,a,i=this.get_decos();for(ns="CDEFGAB",ms=["","m","7","m7","maj7","sus4"],this.add_style("\n.diag {font:6px sans-serif}\n.frn {font:italic 7px sans-serif}"),r=0;r<ns.length;r++)for(n=0;n<ms.length;n++)a=ns[r]+ms[n],i[a]="3 "+a+" 40 0 0";for(n=0;n<ms.length;n++)a="F"+ms[n],i[a]="3 F#"+ms[n]+" 40 0 0";t.fb='<g id="fb">\n<path class="stroke" stroke-width="0.4" d="M-10 -34h20m0 6h-20m0 6h20m0 6h-20m0 6h20"/>\n<path class="stroke" stroke-width="0.5" d="M-10 -34v24m4 0v-24m4 0v24m4 0v-24m4 0v24m4 0v-24"/>\n</g>',t.nut='<path id="nut" class="stroke" stroke-width="1.6" d="M-10.2 -34.5h20.4"/>',t.barre='<path id="barre" class="stroke" stroke-width=".9" d="M-10.2 -31h20.4"/>',t.fr1='<text id="fr1" x="-20" y="-29" class="frn">fr1</text>',t.fr2='<text id="fr2" x="-20" y="-29" class="frn">fr2</text>',t.fr3='<text id="fr3" x="-20" y="-29" class="frn">fr3</text>',t.ddot='<circle id="ddot" class="fill" r="1.5"/>',t.C='<g id="C">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-8,-3,4" y="-36" class="diag">321</text>\n<use x="-6" y="-19" xlink:href="#ddot"/>\n<use x="-2" y="-25" xlink:href="#ddot"/>\n<use x="6" y="-31" xlink:href="#ddot"/>\n</g>',t.Cm='<g id="Cm">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr3"/>\n<use xlink:href="#fb"/>\n<text x="-4,0,4" y="-36" class="diag">342</text>\n<use x="2" y="-19" xlink:href="#ddot"/>\n<use x="-2" y="-19" xlink:href="#ddot"/>\n<use x="6" y="-25" xlink:href="#ddot"/>\n</g>',t.C7='<g id="C7">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-8,-4,0,4" y="-36" class="diag">3241</text>\n<use x="2" y="-19" xlink:href="#ddot"/>\n<use x="-6" y="-19" xlink:href="#ddot"/>\n<use x="-2" y="-25" xlink:href="#ddot"/>\n<use x="6" y="-31" xlink:href="#ddot"/>\n</g>',t.Cm7='<g id="Cm7">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr3"/>\n<use xlink:href="#fb"/>\n<text x="-12,-4,4" y="-36" class="diag">x32</text>\n<use x="-2" y="-19" xlink:href="#ddot"/>\n<use x="6" y="-25" xlink:href="#ddot"/>\n</g>',t.Cmaj7='<g id="Cmaj7">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-12,-8,-4" y="-36" class="diag">x21</text>\n<use x="-2" y="-25" xlink:href="#ddot"/>\n<use x="-6" y="-19" xlink:href="#ddot"/>\n</g>',t.Csus4='<g id="Csus4">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr3"/>\n<use xlink:href="#fb"/>\n<text x="-12,0,4" y="-36" class="diag">x34</text>\n<use x="6" y="-13" xlink:href="#ddot"/>\n<use x="2" y="-19" xlink:href="#ddot"/>\n</g>',t.D='<g id="D">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-12,0,4,8" y="-36" class="diag">x132</text>\n<use x="6" y="-19" xlink:href="#ddot"/>\n<use x="10" y="-25" xlink:href="#ddot"/>\n<use x="2" y="-25" xlink:href="#ddot"/>\n</g>',t.Dm='<g id="Dm">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-12,0,4,8" y="-36" class="diag">x231</text>\n<use x="6" y="-19" xlink:href="#ddot"/>\n<use x="2" y="-25" xlink:href="#ddot"/>\n<use x="10" y="-31" xlink:href="#ddot"/>\n</g>',t.D7='<g id="D7">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-12,0,4,8" y="-36" class="diag">x312</text>\n<use x="10" y="-25" xlink:href="#ddot"/>\n<use x="2" y="-25" xlink:href="#ddot"/>\n<use x="6" y="-31" xlink:href="#ddot"/>\n</g>',t.Dm7='<g id="Dm7">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-12,-8,0,4,8" y="-36" class="diag">xx211</text>\n<use x="2" y="-25" xlink:href="#ddot"/>\n<use x="10" y="-31" xlink:href="#ddot"/>\n<use x="6" y="-31" xlink:href="#ddot"/>\n</g>',t.Dmaj7='<g id="Dmaj7">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-12,-8,0,4,8" y="-36" class="diag">xx123</text>\n<use x="10" y="-25" xlink:href="#ddot"/>\n<use x="6" y="-25" xlink:href="#ddot"/>\n<use x="2" y="-25" xlink:href="#ddot"/>\n</g>',t.Dsus4='<g id="Dsus4">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-12,-8,0,4,8" y="-36" class="diag">xx123</text>\n<use x="10" y="-19" xlink:href="#ddot"/>\n<use x="6" y="-19" xlink:href="#ddot"/>\n<use x="2" y="-25" xlink:href="#ddot"/>\n</g>',t.E='<g id="E">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-8,-4,0" y="-36" class="diag">231</text>\n<use x="-2" y="-25" xlink:href="#ddot"/>\n<use x="-6" y="-25" xlink:href="#ddot"/>\n<use x="2" y="-31" xlink:href="#ddot"/>\n</g>',t.Em='<g id="Em">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-8,-4" y="-36" class="diag">23</text>\n<use x="-2" y="-25" xlink:href="#ddot"/>\n<use x="-6" y="-25" xlink:href="#ddot"/>\n</g>',t.E7='<g id="E7">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-8,0" y="-36" class="diag">21</text>\n<use x="2" y="-31" xlink:href="#ddot"/>\n<use x="-6" y="-25" xlink:href="#ddot"/>\n</g>',t.Em7='<g id="Em7">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-8" y="-36" class="diag">1</text>\n<use x="-6" y="-25" xlink:href="#ddot"/>\n</g>',t.Emaj7='<g id="Emaj7">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-8,-4,0" y="-36" class="diag">312</text>\n<use x="2" y="-31" xlink:href="#ddot"/>\n<use x="-2" y="-31" xlink:href="#ddot"/>\n<use x="-6" y="-25" xlink:href="#ddot"/>\n</g>',t.Esus4='<g id="Esus4">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-4,0" y="-36" class="diag">12</text>\n<use x="2" y="-25" xlink:href="#ddot"/>\n<use x="-2" y="-25" xlink:href="#ddot"/>\n</g>',t.F='<g id="F">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr1"/>\n<use xlink:href="#fb"/>\n<text x="-8,-4,0" y="-36" class="diag">342</text>\n<use x="-2" y="-19" xlink:href="#ddot"/>\n<use x="-6" y="-19" xlink:href="#ddot"/>\n<use x="2" y="-25" xlink:href="#ddot"/>\n</g>',t.Fm='<g id="Fm">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr1"/>\n<use xlink:href="#fb"/>\n<text x="-8,-4" y="-36" class="diag">34</text>\n<use x="-2" y="-19" xlink:href="#ddot"/>\n<use x="-6" y="-19" xlink:href="#ddot"/>\n</g>',t.F7='<g id="F7">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr1"/>\n<use xlink:href="#fb"/>\n<text x="-8,0" y="-36" class="diag">32</text>\n<use x="2" y="-25" xlink:href="#ddot"/>\n<use x="-6" y="-19" xlink:href="#ddot"/>\n</g>',t.Fm7='<g id="Fm7">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr1"/>\n<use xlink:href="#fb"/>\n<text x="-8" y="-36" class="diag">3</text>\n<use x="-6" y="-19" xlink:href="#ddot"/>\n</g>',t.Fmaj7='<g id="Fmaj7">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr1"/>\n<use xlink:href="#fb"/>\n<text x="-8,-4,0" y="-36" class="diag">423</text>\n<use x="2" y="-25" xlink:href="#ddot"/>\n<use x="-2" y="-25" xlink:href="#ddot"/>\n<use x="-6" y="-19" xlink:href="#ddot"/>\n</g>',t.Fsus4='<g id="Fsus4">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr1"/>\n<use xlink:href="#fb"/>\n<text x="-4,0" y="-36" class="diag">34</text>\n<use x="2" y="-19" xlink:href="#ddot"/>\n<use x="-2" y="-19" xlink:href="#ddot"/>\n</g>',t["F#"]='<g id="F#">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr2"/>\n<use xlink:href="#fb"/>\n<text x="-8,-4,0" y="-36" class="diag">342</text>\n<use x="-2" y="-19" xlink:href="#ddot"/>\n<use x="-6" y="-19" xlink:href="#ddot"/>\n<use x="2" y="-25" xlink:href="#ddot"/>\n</g>',t["F#m"]='<g id="F#m">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr2"/>\n<use xlink:href="#fb"/>\n<text x="-8,-4" y="-36" class="diag">34</text>\n<use x="-2" y="-19" xlink:href="#ddot"/>\n<use x="-6" y="-19" xlink:href="#ddot"/>\n</g>',t["F#7"]='<g id="F#7">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr2"/>\n<use xlink:href="#fb"/>\n<text x="-8,0" y="-36" class="diag">32</text>\n<use x="2" y="-25" xlink:href="#ddot"/>\n<use x="-6" y="-19" xlink:href="#ddot"/>\n</g>',t["F#m7"]='<g id="F#m7">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr2"/>\n<use xlink:href="#fb"/>\n<text x="-8" y="-36" class="diag">3</text>\n<use x="-6" y="-19" xlink:href="#ddot"/>\n</g>',t["F#maj7"]='<g id="F#maj7">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr2"/>\n<use xlink:href="#fb"/>\n<text x="-8,-4,0" y="-36" class="diag">423</text>\n<use x="2" y="-25" xlink:href="#ddot"/>\n<use x="-2" y="-25" xlink:href="#ddot"/>\n<use x="-6" y="-19" xlink:href="#ddot"/>\n</g>',t["F#sus4"]='<g id="F#sus4">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr2"/>\n<use xlink:href="#fb"/>\n<text x="-4,0" y="-36" class="diag">34</text>\n<use x="2" y="-19" xlink:href="#ddot"/>\n<use x="-2" y="-19" xlink:href="#ddot"/>\n</g>',t.G='<g id="G">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-12,-8,8" y="-36" class="diag">234</text>\n<use x="10" y="-19" xlink:href="#ddot"/>\n<use x="-10" y="-19" xlink:href="#ddot"/>\n<use x="-6" y="-25" xlink:href="#ddot"/>\n</g>',t.Gm='<g id="Gm">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr3"/>\n<use xlink:href="#fb"/>\n<text x="-8,-4" y="-36" class="diag">34</text>\n<use x="-2" y="-19" xlink:href="#ddot"/>\n<use x="-6" y="-19" xlink:href="#ddot"/>\n</g>',t.G7='<g id="G7">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-12,-8,8" y="-36" class="diag">321</text>\n<use x="-10" y="-19" xlink:href="#ddot"/>\n<use x="-6" y="-25" xlink:href="#ddot"/>\n<use x="10" y="-31" xlink:href="#ddot"/>\n</g>',t.Gm7='<g id="Gm7">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr3"/>\n<use xlink:href="#fb"/>\n<text x="-8" y="-36" class="diag">3</text>\n<use x="-6" y="-19" xlink:href="#ddot"/>\n</g>',t.Gmaj7='<g id="Gmaj7">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-12,-8,8" y="-36" class="diag">312</text>\n<use x="10" y="-25" xlink:href="#ddot"/>\n<use x="-6" y="-25" xlink:href="#ddot"/>\n<use x="-10" y="-19" xlink:href="#ddot"/>\n</g>',t.Gsus4='<g id="Gsus4">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr3"/>\n<use xlink:href="#fb"/>\n<text x="-4,0" y="-36" class="diag">34</text>\n<use x="2" y="-19" xlink:href="#ddot"/>\n<use x="-2" y="-19" xlink:href="#ddot"/>\n</g>',t.A='<g id="A">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-4,0,4" y="-36" class="diag">234</text>\n<use x="6" y="-25" xlink:href="#ddot"/>\n<use x="2" y="-25" xlink:href="#ddot"/>\n<use x="-2" y="-25" xlink:href="#ddot"/>\n</g>',t.Am='<g id="Am">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-4,0,4" y="-36" class="diag">231</text>\n<use x="2" y="-25" xlink:href="#ddot"/>\n<use x="-2" y="-25" xlink:href="#ddot"/>\n<use x="6" y="-31" xlink:href="#ddot"/>\n</g>',t.A7='<g id="A7">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-4,4" y="-36" class="diag">23</text>\n<use x="6" y="-25" xlink:href="#ddot"/>\n<use x="-2" y="-25" xlink:href="#ddot"/>\n</g>',t.Am7='<g id="Am7">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-4,4" y="-36" class="diag">21</text>\n<use x="6" y="-31" xlink:href="#ddot"/>\n<use x="-2" y="-25" xlink:href="#ddot"/>\n</g>',t.Amaj7='<g id="Amaj7">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-12,-4,0,4" y="-36" class="diag">x213</text>\n<use x="6" y="-25" xlink:href="#ddot"/>\n<use x="2" y="-31" xlink:href="#ddot"/>\n<use x="-2" y="-25" xlink:href="#ddot"/>\n</g>',t.Asus4='<g id="Asus4">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-12,0,4" y="-36" class="diag">x12</text>\n<use x="6" y="-19" xlink:href="#ddot"/>\n<use x="2" y="-25" xlink:href="#ddot"/>\n</g>',t.B='<g id="B">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr2"/>\n<use xlink:href="#fb"/>\n<text x="-4,0,4" y="-36" class="diag">234</text>\n<use x="6" y="-19" xlink:href="#ddot"/>\n<use x="2" y="-19" xlink:href="#ddot"/>\n<use x="-2" y="-19" xlink:href="#ddot"/>\n</g>',t.Bm='<g id="Bm">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr2"/>\n<use xlink:href="#fb"/>\n<text x="-4,0,4" y="-36" class="diag">341</text>\n<use x="6" y="-25" xlink:href="#ddot"/>\n<use x="2" y="-19" xlink:href="#ddot"/>\n<use x="-2" y="-19" xlink:href="#ddot"/>\n</g>',t.B7='<g id="B7">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-12,-8,-4,0,8" y="-36" class="diag">x2134</text>\n<use x="10" y="-25" xlink:href="#ddot"/>\n<use x="2" y="-25" xlink:href="#ddot"/>\n<use x="-6" y="-25" xlink:href="#ddot"/>\n<use x="-2" y="-31" xlink:href="#ddot"/>\n</g>',t.Bm7='<g id="Bm7">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr2"/>\n<use xlink:href="#fb"/>\n<text x="-12,0,8" y="-36" class="diag">x32</text>\n<use x="-2" y="-19" xlink:href="#ddot"/>\n<use x="6" y="-25" xlink:href="#ddot"/>\n</g>',t.Bmaj7='<g id="Bmaj7">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr2"/>\n<use xlink:href="#fb"/>\n<text x="-12,-4,0,4" y="-36" class="diag">x324</text>\n<use x="6" y="-19" xlink:href="#ddot"/>\n<use x="2" y="-25" xlink:href="#ddot"/>\n<use x="-2" y="-19" xlink:href="#ddot"/>\n</g>',t.Bsus4='<g id="Bsus4">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr2"/>\n<use xlink:href="#fb"/>\n<text x="-12,0,4" y="-36" class="diag">x34</text>\n<use x="6" y="-19" xlink:href="#ddot"/>\n<use x="2" y="-25" xlink:href="#ddot"/>\n</g>'}var o,r,s,c;for(o=e[0].sym;o;o=o.next)if(o.a_gch)for(r=0;r<o.a_gch.length;r++)(s=o.a_gch[r])&&"g"==s.type&&!s.capo&&(c=s.otext||s.text,this.deco_cnv(c.split(/[ \t\/]/,1),o,null))},output_music:function(t){this.cfmt().diag&&abc2svg.diag.do_diag.call(this),t()},set_fmt:function(t,e,r,n){if("diagram"==e)return void(this.cfmt().diag=r);t(e,r,n)}},abc2svg.modules.hooks.push("deco_cnv",["output_music","abc2svg.diag.output_music"],["set_format","abc2svg.diag.set_fmt"]),abc2svg.modules.diagram.loaded=!0,abc2svg.equalbars={output_music:function(t){this.equalbars_d=0,t()},set_fmt:function(t,e,r,n){"equalbars"==e?this.cfmt().equalbars=this.get_bool(r):t(e,r,n)},set_sym_glue:function(t,e){var r,n,a,i,o,s,c,l,u,$=abc2svg.C,_=[],p=this.get_tsfirst();if(t(e),this.cfmt().equalbars){for(n=p;n;n=n.ts_next)if(n.seqst){switch(n.type){default:continue;case $.BAR:case $.GRACE:case $.MREST:case $.NOTE:case $.REST:case $.SPACE:}break}if(n){for(r=n.ts_next,u=l=r.time;;){if(!r.ts_next){_.push([r,r.time-l]),l=r.time,r.dur&&(l+=r.dur);break}r.type==$.BAR&&r.seqst&&(_.push([r,r.time-l]),l=r.time),r=r.ts_next}if(0!=(o=_.length))for(s=n.type==$.GRACE?n.extra.x:n.x,d=this.equalbars_d,d||(d=this.equalbars_d=s),a=(e-d)/(l-u),i=0;i<o;i++){for(r=_[i][0],f=a*_[i][1]/(r.x-s);n!=r;n=n.ts_next)if(n.type==$.GRACE)for(c=n.extra;c;c=c.next)c.x=d+(c.x-s)*f;else n.x&&(n.x=d+(n.x-s)*f);for(d+=a*_[i][1],s=n.x;;)if(n.x=d,!(n=n.ts_next)||n.seqst)break;if(!n)break}}}}},abc2svg.modules.hooks.push("get_bool",["output_music","abc2svg.equalbars.output_music"],["set_format","abc2svg.equalbars.set_fmt"],["set_sym_glue","abc2svg.equalbars.set_sym_glue"]),abc2svg.modules.equalbars.loaded=!0,abc2svg.grid={do_grid:function(){function t(t){var e=_.BLEN/4;return t.a_meter[0]&&"C"!=t.a_meter[0].top[0]&&t.a_meter[0].bot?(e=_.BLEN/t.a_meter[0].bot[0]|0,8==t.a_meter[0].bot[0]&&t.a_meter[0].top[0]%3==0&&(e=_.BLEN/8*3),e):e}function e(t,e,i){var o,s,c,l,u,f,$,_,d,p,g,m,v,y=0,b=[],w=t.length%6==0?6:8;for(w>t.length&&(w=t.length),c=0,o=0;o<t.length;o++){if(o%w==0&&c++,$=t[o],0==$.length)_="%";else for(_="",s=0;s<$.length;s++)$[s]?(0!=s&&(_+=" / "),_+=$[s]):0==s&&(_+="%");u=e[o],":"==u[u.length-1]&&(_="  "+_),f=e[o+1],f&&":"==f[0]&&(_+="  "),b.push(_),":"==u[u.length-1]&&(_+="  "),f&&":"==f[0]&&(_+="  "),d=this.strwh(_)[0],d>y&&(y=d)}for(y<20&&(y=20),d=y*w,d>r.width&&(w/=2,c*=2,d/=2),p=i.size+8,l='<svg xmlns="http://www.w3.org/2000/svg" version="1.1"\n\txmlns:xlink="http://www.w3.org/1999/xlink"\n\tcolor="black" width="'+r.width.toFixed(0)+'px" height="'+(p*c+6).toFixed(0)+'px"',o=h.bgcolor,o&&(l+=' style="background-color: '+o+'"'),l+='>\n<style type="text/css">\n.mid {text-anchor:middle}\n',h.fullsvg&&(l+=".stroke {stroke: currentColor; fill: none}\n."+n+" {"+this.style_font(i.name+"."+i.size)+"}\n"),l+="</style>\n",l+='<path class="stroke" d="\n',g=(r.width-d)/2,v=1,s=0;s<=c;s++)l+="M"+g.toFixed(2)+" "+v.toFixed(2)+"h"+d.toFixed(2)+"\n",v+=p;for(m=g,o=0;o<=w;o++)l+="M"+m.toFixed(2)+" 1v"+(p*c).toFixed(2)+"\n",m+=y;for(l+='"/>\n',v=-1-.2*p,o=0;o<b.length;o++)o%w==0&&(v+=p,m=g+y/2),l+='<text class="'+a+'" x="'+m.toFixed(2)+'" y="'+v.toFixed(2)+'">'+b[o]+"</text>\n",m+=y;for(v=-1-.2*p,m=g,o=0;o<e.length;o++)u=e[o],":"==u[0]&&(l+='<text class="'+a+'" x="'+(m-5).toFixed(2)+'" y="'+v.toFixed(2)+'" style="font-weight:bold;font-size:'+(i.size+2).toFixed(2)+'">:|</text>\n'),o%w==0&&(v+=p,m=g),":"==u[u.length-1]&&(l+='<text class="'+a+'" x="'+(m+5).toFixed(2)+'" y="'+v.toFixed(2)+'" style="font-weight:bold;font-size:'+(i.size+2).toFixed(2)+'">|:</text>\n'),m+=y;return l+"</svg>"}var r,n,a,i,o,s,c,l,u,f,$,_=abc2svg.C,d=this.get_tsfirst(),p=this.get_voice_tb(),h=this.cfmt(),g=[],m=[],v=[];for(r=this.get_img(),o=t(p[0].meter),s=l=f=0,g.push("|"),i=p[0].sym;i;i=i.next){for(;i.time>s;)l++,s+=o;switch(i.type){case _.NOTE:case _.REST:if(i.a_gch)for(c=0;c<i.a_gch.length;c++)if("g"==i.a_gch[c].type){v[l]||(v[l]=i.a_gch[c].text,f++);break}break;case _.BAR:if(i.time<o){g[0]=i.bar_type,l=0,s=i.time;break}if(i.time!=s)break;m.push(v),g.push(i.bar_type),v=[],l=0;break;case _.METER:o=t(i)}}if(0!=f)if(0!=v.length&&(g.push(""),m.push(v)),this.cfmt().gridfont||this.param_set_font("gridfont","serif 16"),$=this.get_font("grid"),n=this.font_class($),a=n+" mid",this.set_font("grid"),u=p[this.get_top_v()],i={type:_.BLOCK,subtype:"ml",dur:0,time:0,p_v:u,v:u.v,text:e.call(this,m,g,$)},h.grid<0){for(var y=d;y.ts_next;y=y.ts_next);i.time=y.time,i.prev=u.last_sym,i.ts_prev=y,u.last_sym.next=i,y.ts_next=i}else i.time=0,i.next=u.sym,i.ts_next=d,d.ts_prev=i,d=i,this.set_tsfirst(i),u.sym.prev=i,u.sym=i},output_music:function(t){this.cfmt().grid&&abc2svg.grid.do_grid.call(this),t()},set_fmt:function(t,e,r,n){if("grid"==e)return void(this.cfmt().grid=r);t(e,r,n)}},abc2svg.modules.hooks.push("font_class","get_font","param_set_font","set_font","strwh",["output_music","abc2svg.grid.output_music"],["set_format","abc2svg.grid.set_fmt"]),abc2svg.modules.grid.loaded=!0,abc2svg.grid2={do_grid:function(){var t,e,r,n=this.get_voice_tb();for(e=0;e<n.length;e++)if(r=n[e],r.grid2)for(r.stafflines="...",r.clef.invis=!0,r.key.k_sf=r.key.k_a_acc=0,r.staffnonote=2,t=r.sym;t;t=t.next)t.dur&&(t.invis=!0,delete t.sl1,t.ti1=0)},draw_chosym:function(t){var e,r;for(this.set_dscale(t.st),e=0;e<t.a_gch.length;e++)r=t.a_gch[e],"g"==r.type&&(this.use_font(r.font),this.set_font(r.font),this.xy_str(t.x+r.x,r.y+6,r.text))},draw_gchord:function(t,e,r,n){e.p_v.grid2?abc2svg.grid2.draw_chosym.call(this,e):t(e,r,n)},output_music:function(t){abc2svg.grid2.do_grid.call(this),t()},set_format:function(t,e,r,n){if("grid2"==e){var a=this.get_curvoice();return void(a&&(a.grid2=r))}t(e,r,n)}},abc2svg.modules.hooks.push("set_dscale","set_font","use_font","xy_str",["draw_gchord","abc2svg.grid2.draw_gchord"],["output_music","abc2svg.grid2.output_music"],["set_format","abc2svg.grid2.set_format"]),abc2svg.modules.grid2.loaded=!0,abc2svg.MIDI={do_midi:function(t){var e,r,n=new Int8Array([0,0,1,2,2,3,3,4,5,5,6,6]),a=new Int8Array([0,1,0,-1,0,0,1,0,-1,0,-1,0]),i=this.get_maps(),o=t.split(/\s+/);switch(o[1]){case"channel":if("10"!=o[2])break;this.set_v_param("midictl","0 1");break;case"drummap":if("play"!=this.cfmt().sound)break;if(e=function(t){if(t.match(/^([_^]*)([A-Ga-g])([,']*)$/))return t.match(/[A-Z]/)&&(t=t.toLowerCase(),t.indexOf("'")>0?t=t.replace("'",""):t+=","),t}(o[2]),
r=function(t){var e=Number(t);if(!isNaN(e))return t=7*(e/12|0)-19,e%=12,t+=n[e],note={pit:t,apit:t},a[e]&&(note.acc=a[e]),note}(o[3]),!e||!r){this.syntax(1,abc.errs.bad_val,"%%MIDI drummap");break}i.MIDIdrum||(i.MIDIdrum={}),i.MIDIdrum[e]=[null,r],this.set_v_param("mididrum","MIDIdrum");break;case"program":if(r=void 0!=o[3]?o[3]:o[2],r=parseInt(r),isNaN(r)||r<0||r>127)return void this.syntax(1,"Bad program in %%MIDI");this.set_v_param("instr",r);break;case"control":if(e=parseInt(o[2]),isNaN(e)||e<0||e>127)return void this.syntax(1,"Bad controller number in %%MIDI");if(r=parseInt(o[3]),isNaN(r)||r<0||r>127)return void this.syntax(1,"Bad controller value in %%MIDI");this.set_v_param("midictl",o[2]+" "+o[3])}},set_midi:function(t){var e,r,n=this.get_curvoice();for(e=0;e<t.length;e++)switch(t[e]){case"instr=":n.instr=t[e+1];break;case"midictl=":n.midictl||(n.midictl={}),r=t[e+1].split(" "),n.midictl[r[0]]=Number(r[1]);break;case"mididrum=":n.map||(n.map={}),n.map=t[e+1]}},do_pscom:function(t,e){"MIDI "==e.slice(0,5)?abc2svg.MIDI.do_midi.call(this,e):t(e)},set_vp:function(t,e){abc2svg.MIDI.set_midi.call(this,e),t(e)}},abc2svg.modules.hooks.push("errs","set_v_param","syntax",["do_pscom","abc2svg.MIDI.do_pscom"],["set_vp","abc2svg.MIDI.set_vp"]),abc2svg.modules.MIDI.loaded=!0,abc2svg.modules.psvg={do_begin_end:function(t,e,r,n){if("ps"!=e)return void t(e,r,n);"nosvg"!=r&&(this.psvg||(this.psvg=new Psvg(this)),this.psvg.ps_eval.call(this.psvg,n))},psdeco:function(t,e,r,n,a){return!!this.psvg&&this.psvg.psdeco.call(this.psvg,e,r,n,a)},psxygl:function(t,e,r,n){return!!this.psvg&&this.psvg.psxygl.call(this.psvg,e,r,n)}},abc2svg.modules.hooks.push("out_arp","out_deco_str","out_deco_val","out_ltr","xygl",["do_begin_end","abc2svg.modules.psvg.do_begin_end"],["psdeco","abc2svg.modules.psvg.psdeco"],["psxygl","abc2svg.modules.psvg.psxygl"]),abc2svg.modules.beginps.loaded=!0,abc2svg.sth={recal_beam:function(t,e){var r=this.get_staff_tb(),n=e.st,a=t.s2;for(e.sth&&(e.ys=e.sth),a.sth&&(a.ys=a.sth),t.a=(e.ys-a.ys)/(e.xs-a.xs),t.b=e.ys-e.xs*t.a+r[n].y;;)if(e.ys=t.a*e.xs+t.b-r[n].y,e.stem>0?e.ymx=e.ys+2.5:e.ymn=e.ys-2.5,(e=e.next)==a)break},set_sth:function(){var t,e,r,n,a,i=this.get_voice_tb();for(r=0;r<i.length;r++)if(a=i[r],null==a.sth)for(n=[],t=a.sym;t;t=t.next)if(t.sth&&(n=t.sth,t.sth=null),!(0==n.length||t.nflags<=-2||t.stemless||!t.beam_st&&!t.beam_end)&&"*"!=(e=n.shift()))if("|"!=e)e=Number(e),!isNaN(e)&&e&&(t.stem>=0?(t.ys=t.y+e,t.ymx=t.ys+2.5|0):(t.ys=t.y-e,t.ymn=t.ys-2.5|0),t.sth=t.ys);else for(t=t.next;t&&!t.bar_type;t=t.next);},calculate_beam:function(t,e,r){var n=t(e,r);return n&&e.s2&&r.sth&&abc2svg.sth.recal_beam.call(this,e,r),n},new_note:function(t,e,r){var n=abc2svg.C,a=t(e,r),i=this.get_curvoice();return i.sth&&a&&a.type==n.NOTE&&(a.sth=i.sth,i.sth=null),a},set_format:function(t,e,r,n){if("sth"==e){var a=this.get_curvoice();return 2==this.parse.state&&this.goto_tune(),void(a&&(a.sth=r.split(/[ \t;-]+/)))}t(e,r,n)},set_stems:function(t){t(),abc2svg.sth.set_sth.call(this)}},abc2svg.modules.hooks.push("goto_tune","parse",["calculate_beam","abc2svg.sth.calculate_beam"],["new_note","abc2svg.sth.new_note"],["set_format","abc2svg.sth.set_format"],["set_stems","abc2svg.sth.set_stems"]),abc2svg.modules.sth.loaded=!0,abc2svg.temper={set_bar_num:function(t){if(t(),this.cfmt().temper){var e=this.get_voice_tb()[0];e.temper=new Float32Array(12);for(var r=0;r<12;r++)e.temper[r]=this.cfmt().temper[r]/100}},set_fmt:function(t,e,r,n){if("temperament"==e){var a=new Float32Array(r.split(/ +/)),i=a.length;if(12==i){for(;--i>=0&&!isNaN(parseInt(a[i])););if(i<0)return void(this.cfmt().temper=a)}return void this.syntax(1,errs.bad_val,"%%temperament")}t(e,r,n)}},abc2svg.modules.hooks.push("syntax",["set_bar_num","abc2svg.temper.set_bar_num"],["set_format","abc2svg.temper.set_fmt"]),abc2svg.modules.temperament.loaded=!0,Opal.loaded(["abc2svg-1"]),function(t){var e,r,n=t.top,a=[],i=t.nil,o=(t.breaker,t.slice,t.truthy),s=t.send,c=t.gvars,l=i,u=i,f=i,$=i,_=i;t.add_stubs(["$require","$[]","$>=","$length","$puts","$about_zupfnoter","$new","$exit","$mkdir_p","$first","$sort","$each","$clear_errors","$read","$message","$set_abc_input","$exist?","$parse","$apply_config","$load_music_model","$produce_pdfs","$write","$basename","$join","$get_errors"]),global.window={document:{createElementNS:function(){return{}}}},global.navigator={},global.btoa=function(t){return Buffer.from(t).toString("base64")},global.atob=function(t){return Buffer.from(t,"base64").toString("binary")},jsPDF=require("../vendor/jspdf.node.debug.js"),Ajv=require("ajv"),neatJSON=require("./neatjson_js"),fs=require("fs"),glob=require("glob"),n.$require("opal"),n.$require("opal-platform"),n.$require("nodejs"),n.$require("nodejs/fileutils"),n.$require("vector2d"),n.$require("opal-neatjson"),n.$require("opal-ajv"),n.$require("consolelogger"),n.$require("harpnotes"),n.$require("abc_to_harpnotes_factory"),n.$require("abc2svg_to_harpnotes"),n.$require("opal-jspdf"),n.$require("opal-jszip"),n.$require("pdf_engine"),n.$require("init_conf"),n.$require("text_pane"),n.$require("command-controller"),n.$require("controller"),n.$require("controller-cli"),n.$require("confstack2"),n.$require("opal-abc2svg"),n.$require("version-prod"),n.$require("abc2svg-1.js"),l=o(e=t.const_get_relative(a,"ARGV")["$[]"](0))?e:"*.abc",u=o(e=t.const_get_relative(a,"ARGV")["$[]"](1))?e:".",f=t.const_get_relative(a,"ARGV")["$[]"](2),o(function(t,e){return"number"==typeof t&&"number"==typeof e?t>=e:t["$>="](e)}(t.const_get_relative(a,"ARGV").$length(),2))||(n.$puts('usage: node --max_old_space_size=4096 zupfnoter-cli.js "/tmp/zntest/*.abc" /tmp/xxxd'),n.$puts(t.const_get_relative(a,"CliController").$new().$about_zupfnoter()),n.$exit(0)),t.const_get_relative(a,"FileUtils").$mkdir_p(u),n.$puts("processing "+t.const_get_relative(a,"ARGV").$first()+" to "+u),$=t.const_get_relative(a,"CliController").$new(),_=t.const_get_relative(a,"Dir")["$[]"](l).$sort(),s(_,"each",[],(r=function(e){var n,l=r.$$s||this,_=i,d=i,p=i,h=i;null==c.log&&(c.log=i),null==e&&(e=i),c.log.$clear_errors();try{_=t.const_get_relative(a,"File").$read(e)}catch(e){if(!t.rescue(e,[t.const_get_relative(a,"Exception")]))throw e;d=e;try{l.$puts(d)}finally{t.pop_exception()}}return c.log.$message("processing: "+e),$=t.const_get_relative(a,"CliController").$new(),$.$set_abc_input(_),o(t.const_get_relative(a,"File")["$exist?"](f))&&(l.$puts("reading config"),p=t.const_get_relative(a,"JSON").$parse(t.const_get_relative(a,"File").$read(f)),$.$apply_config(p)),$.$load_music_model(),h=$.$produce_pdfs("."),s(h,"each",[],(n=function(t,e){var r=n.$$s||this,a=i;null==t&&(t=i),null==e&&(e=i),a=u+"/"+t,r.$puts(t);var o=require("encoding"),s=o.convert(e,"Latin-1");return fs.writeFileSync(a,s),i},n.$$s=l,n.$$arity=2,n)),t.const_get_relative(a,"File").$write(u+"/"+t.const_get_relative(a,"File").$basename(e)+".err.log",c.log.$get_errors().$join("\n"))},r.$$s=n,r.$$arity=1,r))}(Opal)},{"../vendor/jspdf.node.debug.js":87,"./neatjson_js":1,ajv:2,crypto:void 0,encoding:47,fs:void 0,glob:52}],87:[function(t,e,r){"use strict";function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t){function e(t){for(var e=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],r=0;r<64;r++){var n=x((e[r]*t+50)/100);n<1?n=1:n>255&&(n=255),A[q[r]]=n}for(var a=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],i=0;i<64;i++){var o=x((a[i]*t+50)/100);o<1?o=1:o>255&&(o=255),k[q[i]]=o}for(var s=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],c=0,l=0;l<8;l++)for(var u=0;u<8;u++)E[c]=1/(A[q[c]]*s[l]*s[u]*8),S[c]=1/(k[q[c]]*s[l]*s[u]*8),c++}function r(t,e){for(var r=0,n=0,a=new Array,i=1;i<=16;i++){for(var o=1;o<=t[i];o++)a[e[n]]=[],a[e[n]][0]=r,a[e[n]][1]=i,n++,r++;r*=2}return a}function n(){m=r(D,z),v=r(G,Y),y=r(U,H),b=r(V,Q)}function a(){for(var t=1,e=2,r=1;r<=15;r++){for(var n=t;n<e;n++)C[32767+n]=r,N[32767+n]=[],N[32767+n][1]=r,N[32767+n][0]=n;for(var a=-(e-1);a<=-t;a++)C[32767+a]=r,N[32767+a]=[],N[32767+a][1]=r,N[32767+a][0]=e-1+a;t<<=1,e<<=1}}function i(){for(var t=0;t<256;t++)R[t]=19595*t,R[t+256>>0]=38470*t,R[t+512>>0]=7471*t+32768,R[t+768>>0]=-11059*t,R[t+1024>>0]=-21709*t,R[t+1280>>0]=32768*t+8421375,R[t+1536>>0]=-27439*t,R[t+1792>>0]=-5329*t}function o(t){for(var e=t[0],r=t[1]-1;r>=0;)e&1<<r&&(L|=1<<M),r--,--M<0&&(255==L?(s(255),s(0)):s(L),M=7,L=0)}function s(t){P.push(t)}function c(t){s(t>>8&255),s(255&t)}function l(t,e){var r,n,a,i,o,s,c,l,u,f=0;for(u=0;u<8;++u){r=t[f],n=t[f+1],a=t[f+2],i=t[f+3],o=t[f+4],s=t[f+5],c=t[f+6],l=t[f+7];var $=r+l,_=r-l,d=n+c,p=n-c,h=a+s,g=a-s,m=i+o,v=i-o,y=$+m,b=$-m,w=d+h,x=d-h;t[f]=y+w,t[f+4]=y-w;var A=.707106781*(x+b);t[f+2]=b+A,t[f+6]=b-A,y=v+g,w=g+p,x=p+_;var k=.382683433*(y-x),E=.5411961*y+k,S=1.306562965*x+k,N=.707106781*w,C=_+N,O=_-N;t[f+5]=O+E,t[f+3]=O-E,t[f+1]=C+S,t[f+7]=C-S,f+=8}for(f=0,u=0;u<8;++u){r=t[f],n=t[f+8],a=t[f+16],i=t[f+24],o=t[f+32],s=t[f+40],c=t[f+48],l=t[f+56];var P=r+l,L=r-l,M=n+c,T=n-c,B=a+s,j=a-s,F=i+o,R=i-o,q=P+F,D=P-F,z=M+B,U=M-B;t[f]=q+z,t[f+32]=q-z;var H=.707106781*(U+D);t[f+16]=D+H,t[f+48]=D-H,q=R+j,z=j+T,U=T+L;var G=.382683433*(q-U),Y=.5411961*q+G,V=1.306562965*U+G,Q=.707106781*z,X=L+Q,J=L-Q;t[f+40]=J+Y,t[f+24]=J-Y,t[f+8]=X+V,t[f+56]=X-V,f++}var W;for(u=0;u<64;++u)W=t[u]*e[u],I[u]=W>0?W+.5|0:W-.5|0;return I}function u(){c(65504),c(16),s(74),s(70),s(73),s(70),s(0),s(1),s(1),s(0),c(1),c(1),s(0),s(0)}function f(t,e){c(65472),c(17),s(8),c(e),c(t),s(3),s(1),s(17),s(0),s(2),s(17),s(1),s(3),s(17),s(1)}function $(){c(65499),c(132),s(0);for(var t=0;t<64;t++)s(A[t]);s(1);for(var e=0;e<64;e++)s(k[e])}function _(){c(65476),c(418),s(0);for(var t=0;t<16;t++)s(D[t+1]);for(var e=0;e<=11;e++)s(z[e]);s(16);for(var r=0;r<16;r++)s(U[r+1]);for(var n=0;n<=161;n++)s(H[n]);s(1);for(var a=0;a<16;a++)s(G[a+1]);for(var i=0;i<=11;i++)s(Y[i]);s(17);for(var o=0;o<16;o++)s(V[o+1]);for(var l=0;l<=161;l++)s(Q[l])}function d(){c(65498),c(12),s(3),s(1),s(0),s(2),s(17),s(3),s(17),s(0),s(63),s(0)}function p(t,e,r,n,a){for(var i,s=a[0],c=a[240],u=l(t,e),f=0;f<64;++f)O[q[f]]=u[f];var $=O[0]-r;r=O[0],0==$?o(n[0]):(i=32767+$,o(n[C[i]]),o(N[i]));for(var _=63;_>0&&0==O[_];_--);if(0==_)return o(s),r;for(var d,p=1;p<=_;){for(var h=p;0==O[p]&&p<=_;++p);var g=p-h;if(g>=16){d=g>>4;for(var m=1;m<=d;++m)o(c);g&=15}i=32767+O[p],o(a[(g<<4)+C[i]]),o(N[i]),p++}return 63!=_&&o(s),r}function h(){for(var t=String.fromCharCode,e=0;e<256;e++)F[e]=t(e)}function g(t){if(t<=0&&(t=1),t>100&&(t=100),w!=t){var r=0;r=t<50?Math.floor(5e3/t):Math.floor(200-2*t),e(r),w=t}}var m,v,y,b,w,x=Math.floor,A=new Array(64),k=new Array(64),E=new Array(64),S=new Array(64),N=new Array(65535),C=new Array(65535),I=new Array(64),O=new Array(64),P=[],L=0,M=7,T=new Array(64),B=new Array(64),j=new Array(64),F=new Array(256),R=new Array(2048),q=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],D=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],z=[0,1,2,3,4,5,6,7,8,9,10,11],U=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],H=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],G=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],Y=[0,1,2,3,4,5,6,7,8,9,10,11],V=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],Q=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];this.encode=function(t,e){(new Date).getTime();e&&g(e),P=new Array,L=0,M=7,c(65496),u(),$(),f(t.width,t.height),_(),d();var r=0,n=0,a=0;L=0,M=7,this.encode.displayName="_encode_";for(var i,s,l,h,w,x,A,k,N,C=t.data,I=t.width,O=t.height,F=4*I,q=0;q<O;){for(i=0;i<F;){for(w=F*q+i,x=w,A=-1,k=0,N=0;N<64;N++)k=N>>3,A=4*(7&N),x=w+k*F+A,q+k>=O&&(x-=F*(q+1+k-O)),i+A>=F&&(x-=i+A-F+4),s=C[x++],l=C[x++],h=C[x++],T[N]=(R[s]+R[l+256>>0]+R[h+512>>0]>>16)-128,B[N]=(R[s+768>>0]+R[l+1024>>0]+R[h+1280>>0]>>16)-128,j[N]=(R[s+1280>>0]+R[l+1536>>0]+R[h+1792>>0]>>16)-128;r=p(T,E,r,m,y),n=p(B,S,n,v,b),a=p(j,S,a,v,b),i+=32}q+=8}if(M>=0){var D=[];D[1]=M+1,D[0]=(1<<M+1)-1,o(D)}return c(65497),new Uint8Array(P)},function(){(new Date).getTime();t||(t=50),h(),n(),a(),i(),g(t),(new Date).getTime()}()}function i(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,-1===["BM","BA","CI","CP","IC","PT"].indexOf(this.flag))throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function o(t){r.default=t}function s(){r.default=f}Object.defineProperty(r,"__esModule",{value:!0});var c=function(t){function r(e){if("object"!==n(e))throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var r={};this.subscribe=function(t,e,n){if(n=n||!1,"string"!=typeof t||"function"!=typeof e||"boolean"!=typeof n)throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");r.hasOwnProperty(t)||(r[t]={});var a=Math.random().toString(35);return r[t][a]=[e,!!n],a},this.unsubscribe=function(t){for(var e in r)if(r[e][t])return delete r[e][t],0===Object.keys(r[e]).length&&delete r[e],!0;return!1},this.publish=function(n){if(r.hasOwnProperty(n)){var a=Array.prototype.slice.call(arguments,1),i=[];for(var o in r[n]){var s=r[n][o];try{s[0].apply(e,a)}catch(e){t.console&&console.error("jsPDF PubSub Error",e.message,e)}s[1]&&i.push(o)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return r}}function a(e,i,o,s){var c={},l=[],u=1;"object"===n(e)&&(c=e,e=c.orientation,i=c.unit||i,o=c.format||o,s=c.compress||c.compressPdf||s,l=c.filters||(!0===s?["FlateEncode"]:l),u="number"==typeof c.userUnit?Math.abs(c.userUnit):1),i=i||"mm",e=(""+(e||"P")).toLowerCase();var f=c.putOnlyUsedFonts||!0,$={},_={internal:{},__private__:{}};_.__private__.PubSub=r;var d="1.3",p=_.__private__.getPdfVersion=function(){return d},h=(_.__private__.setPdfVersion=function(t){d=t},{a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]}),g=(_.__private__.getPageFormats=function(){return h},_.__private__.getPageFormat=function(t){return h[t]});"string"==typeof o&&(o=g(o)),o=o||g("a4");var m=_.f2=_.__private__.f2=function(t){if(isNaN(t))throw new Error("Invalid argument passed to jsPDF.f2");return t.toFixed(2)},v=_.__private__.f3=function(t){if(isNaN(t))throw new Error("Invalid argument passed to jsPDF.f3");return t.toFixed(3)},y="00000000000000000000000000000000",b=_.__private__.getFileId=function(){return y},w=_.__private__.setFileId=function(t){return t=t||"12345678901234567890123456789012".split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),y=t};_.setFileId=function(t){return w(t),this},_.getFileId=function(){return b()};var x,A=_.__private__.convertDateToPDFDate=function(t){var e=t.getTimezoneOffset(),r=e<0?"+":"-",n=Math.floor(Math.abs(e/60)),a=Math.abs(e%60),i=[r,T(n),"'",T(a),"'"].join("");return["D:",t.getFullYear(),T(t.getMonth()+1),T(t.getDate()),T(t.getHours()),T(t.getMinutes()),T(t.getSeconds()),i].join("")},k=_.__private__.convertPDFDateToDate=function(t){var e=parseInt(t.substr(2,4),10),r=parseInt(t.substr(6,2),10)-1,n=parseInt(t.substr(8,2),10),a=parseInt(t.substr(10,2),10),i=parseInt(t.substr(12,2),10),o=parseInt(t.substr(14,2),10);parseInt(t.substr(16,2),10),parseInt(t.substr(20,2),10);return new Date(e,r,n,a,i,o,0)},E=_.__private__.setCreationDate=function(t){var e,r=/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|\-0[0-9]|\-1[0-1])\'(0[0-9]|[1-5][0-9])\'?$/;if(void 0===t&&(t=new Date),"object"===n(t)&&"[object Date]"===Object.prototype.toString.call(t))e=A(t);else{if(!r.test(t))throw new Error("Invalid argument passed to jsPDF.setCreationDate");e=t}return x=e},S=_.__private__.getCreationDate=function(t){var e=x;return"jsDate"===t&&(e=k(x)),e};_.setCreationDate=function(t){return E(t),this},_.getCreationDate=function(t){return S(t)};var N,C,I,O,P,L,M,T=_.__private__.padd2=function(t){return("0"+parseInt(t)).slice(-2)},B=!1,j=[],F=[],R=0,q=(_.__private__.setCustomOutputDestination=function(t){C=t},_.__private__.resetCustomOutputDestination=function(t){C=void 0},_.__private__.out=function(t){var e;return t="string"==typeof t?t:t.toString(),e=void 0===C?B?j[N]:F:C,e.push(t),B||(R+=t.length+1),e}),D=_.__private__.write=function(t){return q(1===arguments.length?t.toString():Array.prototype.join.call(arguments," "))},z=_.__private__.getArrayBuffer=function(t){for(var e=t.length,r=new ArrayBuffer(e),n=new Uint8Array(r);e--;)n[e]=t.charCodeAt(e);return r},U=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]],H=(_.__private__.getStandardFonts=function(t){return U},c.fontSize||16),G=(_.__private__.setFontSize=_.setFontSize=function(t){return H=t,this},_.__private__.getFontSize=_.getFontSize=function(){return H}),Y=c.R2L||!1,V=(_.__private__.setR2L=_.setR2L=function(t){return Y=t,this},_.__private__.getR2L=_.getR2L=function(t){return Y},_.__private__.setZoomMode=function(t){var e=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^\d*\.?\d*\%$/.test(t))I=t;else if(isNaN(t)){if(-1===e.indexOf(t))throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+t+'" is not recognized.');I=t}else I=parseInt(t,10)}),Q=(_.__private__.getZoomMode=function(){return I},_.__private__.setPageMode=function(t){if(-1==[void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(t))throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+t+'" is not recognized.');O=t}),X=(_.__private__.getPageMode=function(){return O},_.__private__.setLayoutMode=function(t){if(-1==[void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(t))throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+t+'" is not recognized.');P=t}),J=(_.__private__.getLayoutMode=function(){return P},_.__private__.setDisplayMode=_.setDisplayMode=function(t,e,r){return V(t),X(e),Q(r),this},{title:"",subject:"",author:"",keywords:"",creator:""}),W=(_.__private__.getDocumentProperty=function(t){if(-1===Object.keys(J).indexOf(t))throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return J[t]},_.__private__.getDocumentProperties=function(t){return J},_.__private__.setDocumentProperties=_.setProperties=_.setDocumentProperties=function(t){for(var e in J)J.hasOwnProperty(e)&&t[e]&&(J[e]=t[e]);return this},_.__private__.setDocumentProperty=function(t,e){if(-1===Object.keys(J).indexOf(t))throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return J[t]=e},0),K=[],Z={},tt={},et=0,rt=[],nt=[],at=new r(_),it=c.hotfixes||[],ot=_.__private__.newObject=function(){var t=st();return ct(t,!0),t},st=_.__private__.newObjectDeferred=function(){return W++,K[W]=function(){return R},W},ct=function(t,e){return e="boolean"==typeof e&&e,K[t]=R,e&&q(t+" 0 obj"),t},lt=_.__private__.newAdditionalObject=function(){var t=st(),e={objId:t,content:""};return nt.push(e),e},ut=st(),ft=st(),$t=_.__private__.decodeColorString=function(t){var e=t.split(" ");if(2===e.length&&("g"===e[1]||"G"===e[1])){var r=parseFloat(e[0]);e=[r,r,r,"r"]}for(var n="#",a=0;a<3;a++)n+=("0"+Math.floor(255*parseFloat(e[a])).toString(16)).slice(-2);return n},_t=_.__private__.encodeColorString=function(t){var e;"string"==typeof t&&(t={ch1:t});var r=t.ch1,a=t.ch2,i=t.ch3,o=t.ch4,s=(t.precision,"draw"===t.pdfColorType?["G","RG","K"]:["g","rg","k"]);if("string"==typeof r&&"#"!==r.charAt(0)){var c=new RGBColor(r);if(c.ok)r=c.toHex();else if(!/^\d*\.?\d*$/.test(r))throw new Error('Invalid color "'+r+'" passed to jsPDF.encodeColorString.')}if("string"==typeof r&&/^#[0-9A-Fa-f]{3}$/.test(r)&&(r="#"+r[1]+r[1]+r[2]+r[2]+r[3]+r[3]),"string"==typeof r&&/^#[0-9A-Fa-f]{6}$/.test(r)){var l=parseInt(r.substr(1),16);r=l>>16&255,a=l>>8&255,i=255&l}if(void 0===a||void 0===o&&r===a&&a===i)if("string"==typeof r)e=r+" "+s[0];else switch(t.precision){case 2:e=m(r/255)+" "+s[0];break;case 3:default:e=v(r/255)+" "+s[0]}else if(void 0===o||"object"===n(o)){if(o&&!isNaN(o.a)&&0===o.a)return e=["1.000","1.000","1.000",s[1]].join(" ");if("string"==typeof r)e=[r,a,i,s[1]].join(" ");else switch(t.precision){case 2:e=[m(r/255),m(a/255),m(i/255),s[1]].join(" ");break;default:case 3:e=[v(r/255),v(a/255),v(i/255),s[1]].join(" ")}}else if("string"==typeof r)e=[r,a,i,o,s[2]].join(" ");else switch(t.precision){case 2:e=[m(r/255),m(a/255),m(i/255),m(o/255),s[2]].join(" ");break;case 3:default:e=[v(r/255),v(a/255),v(i/255),v(o/255),s[2]].join(" ")}return e},dt=_.__private__.getFilters=function(){return l},pt=_.__private__.putStream=function(t){t=t||{};var e=t.data||"",r=t.filters||dt(),n=t.alreadyAppliedFilters||[],i=t.addLength1||!1,o=e.length,s={};!0===r&&(r=["FlateEncode"]);var c=t.additionalKeyValues||[];s=void 0!==a.API.processDataByFilters?a.API.processDataByFilters(e,r):{data:e,reverseChain:[]};var l=s.reverseChain+(Array.isArray(n)?n.join(" "):n.toString());0!==s.data.length&&(c.push({key:"Length",value:s.data.length}),!0===i&&c.push({key:"Length1",value:o})),0!=l.length&&(l.split("/").length-1==1?c.push({key:"Filter",value:l}):c.push({key:"Filter",value:"["+l+"]"})),q("<<");for(var u=0;u<c.length;u++)q("/"+c[u].key+" "+c[u].value);q(">>"),0!==s.data.length&&(q("stream"),q(s.data),q("endstream"))},ht=_.__private__.putPage=function(t){var e=(t.mediaBox,t.number),r=t.data,n=t.objId,a=t.contentsObjId;ct(n,!0);rt[N].mediaBox.topRightX,rt[N].mediaBox.bottomLeftX,rt[N].mediaBox.topRightY,rt[N].mediaBox.bottomLeftY;q("<</Type /Page"),q("/Parent "+t.rootDictionaryObjId+" 0 R"),q("/Resources "+t.resourceDictionaryObjId+" 0 R"),q("/MediaBox ["+parseFloat(m(t.mediaBox.bottomLeftX))+" "+parseFloat(m(t.mediaBox.bottomLeftY))+" "+m(rt[N].mediaBox.topRightX)+" "+m(rt[N].mediaBox.topRightY)+"]"),null!==t.cropBox&&q("/CropBox ["+m(t.cropBox.bottomLeftX)+" "+m(t.cropBox.bottomLeftY)+" "+m(t.cropBox.topRightX)+" "+m(t.cropBox.topRightY)+"]"),null!==t.bleedBox&&q("/BleedBox ["+m(t.bleedBox.bottomLeftX)+" "+m(t.bleedBox.bottomLeftY)+" "+m(t.bleedBox.topRightX)+" "+m(t.bleedBox.topRightY)+"]"),null!==t.trimBox&&q("/TrimBox ["+m(t.trimBox.bottomLeftX)+" "+m(t.trimBox.bottomLeftY)+" "+m(t.trimBox.topRightX)+" "+m(t.trimBox.topRightY)+"]"),null!==t.artBox&&q("/ArtBox ["+m(t.artBox.bottomLeftX)+" "+m(t.artBox.bottomLeftY)+" "+m(t.artBox.topRightX)+" "+m(t.artBox.topRightY)+"]"),"number"==typeof t.userUnit&&1!==t.userUnit&&q("/UserUnit "+t.userUnit),at.publish("putPage",{objId:n,pageContext:rt[e],pageNumber:e,page:r}),q("/Contents "+a+" 0 R"),q(">>"),q("endobj");var i=r.join("\n");return ct(a,!0),pt({data:i,filters:dt()}),q("endobj"),n},gt=_.__private__.putPages=function(){var t,e,r=[];for(t=1;t<=et;t++)rt[t].objId=st(),rt[t].contentsObjId=st();for(t=1;t<=et;t++)r.push(ht({number:t,data:j[t],objId:rt[t].objId,contentsObjId:rt[t].contentsObjId,mediaBox:rt[t].mediaBox,cropBox:rt[t].cropBox,bleedBox:rt[t].bleedBox,trimBox:rt[t].trimBox,artBox:rt[t].artBox,userUnit:rt[t].userUnit,rootDictionaryObjId:ut,resourceDictionaryObjId:ft}));ct(ut,!0),q("<</Type /Pages");var n="/Kids [";for(e=0;e<et;e++)n+=r[e]+" 0 R ";q(n+"]"),q("/Count "+et),q(">>"),q("endobj"),at.publish("postPutPages")},mt=function(t){at.publish("putFont",{font:t,out:q,newObject:ot,putStream:pt}),!0!==t.isAlreadyPutted&&(t.objectNumber=ot(),q("<<"),q("/Type /Font"),q("/BaseFont /"+t.postScriptName),q("/Subtype /Type1"),"string"==typeof t.encoding&&q("/Encoding /"+t.encoding),q("/FirstChar 32"),q("/LastChar 255"),q(">>"),q("endobj"))},vt=function(){for(var t in Z)Z.hasOwnProperty(t)&&(!1===f||!0===f&&$.hasOwnProperty(t))&&mt(Z[t])},yt=function(){q("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),q("/Font <<");for(var t in Z)Z.hasOwnProperty(t)&&(!1===f||!0===f&&$.hasOwnProperty(t))&&q("/"+t+" "+Z[t].objectNumber+" 0 R");q(">>"),q("/XObject <<"),at.publish("putXobjectDict"),q(">>")},bt=function(){vt(),at.publish("putResources"),ct(ft,!0),q("<<"),yt(),q(">>"),q("endobj"),at.publish("postPutResources")},wt=function(){at.publish("putAdditionalObjects");for(var t=0;t<nt.length;t++){var e=nt[t];ct(e.objId,!0),q(e.content),q("endobj")}at.publish("postPutAdditionalObjects")},xt=function(t,e,r){tt.hasOwnProperty(e)||(tt[e]={}),tt[e][r]=t},At=function(t,e,r,n,a){a=a||!1;var i="F"+(Object.keys(Z).length+1).toString(10),o={id:i,postScriptName:t,fontName:e,fontStyle:r,encoding:n,isStandardFont:a,metadata:{}},s=this;return at.publish("addFont",{font:o,instance:s}),void 0!==i&&(Z[i]=o,xt(i,e,r)),i},kt=function(t,e){var r,n,a,i,o,s,c,l,u;if(e=e||{},a=e.sourceEncoding||"Unicode",o=e.outputEncoding,(e.autoencode||o)&&Z[L].metadata&&Z[L].metadata[a]&&Z[L].metadata[a].encoding&&(i=Z[L].metadata[a].encoding,!o&&Z[L].encoding&&(o=Z[L].encoding),!o&&i.codePages&&(o=i.codePages[0]),"string"==typeof o&&(o=i[o]),o)){for(c=!1,s=[],r=0,n=t.length;r<n;r++)l=o[t.charCodeAt(r)],l?s.push(String.fromCharCode(l)):s.push(t[r]),s[r].charCodeAt(0)>>8&&(c=!0);t=s.join("")}for(r=t.length;void 0===c&&0!==r;)t.charCodeAt(r-1)>>8&&(c=!0),r--;if(!c)return t;for(s=e.noBOM?[]:[254,255],r=0,n=t.length;r<n;r++){if(l=t.charCodeAt(r),(u=l>>8)>>8)throw new Error("Character at position "+r+" of string '"+t+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");s.push(u),s.push(l-(u<<8))}return String.fromCharCode.apply(void 0,s)},Et=_.__private__.pdfEscape=_.pdfEscape=function(t,e){return kt(t,e).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},St=_.__private__.beginPage=function(t,e){var r,n="string"==typeof e&&e.toLowerCase();if("string"==typeof t&&g(t.toLowerCase())&&(t=g(t.toLowerCase())[0],e=g(t.toLowerCase())[1]),Array.isArray(t)&&(e=t[1],t=t[0]),(isNaN(t)||isNaN(e))&&(t=o[0],e=o[1]),n){switch(n.substr(0,1)){case"l":e>t&&(n="s");break;case"p":t>e&&(n="s")}"s"===n&&(r=t,t=e,e=r)}(t>14400||e>14400)&&(console.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),t=Math.min(14400,t),e=Math.min(14400,e)),o=[t,e],B=!0,j[++et]=[],rt[et]={objId:0,contentsObjId:0,userUnit:Number(u),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(t),topRightY:Number(e)}},It(et)},Nt=function(){St.apply(this,arguments),Xt(Qt),q(ne),0!==le&&q(le+" J"),0!==fe&&q(fe+" j"),at.publish("addPage",{pageNumber:et})},Ct=function(t){t>0&&t<=et&&(j.splice(t,1),et--,N>et&&(N=et),this.setPage(N))},It=function(t){t>0&&t<=et&&(N=t)},Ot=_.__private__.getNumberOfPages=_.getNumberOfPages=function(){return j.length-1},Pt=function(t,e,r){var n,a=void 0;return r=r||{},t=void 0!==t?t:Z[L].fontName,e=void 0!==e?e:Z[L].fontStyle,n=t.toLowerCase(),void 0!==tt[n]&&void 0!==tt[n][e]?a=tt[n][e]:void 0!==tt[t]&&void 0!==tt[t][e]?a=tt[t][e]:!1===r.disableWarning&&console.warn("Unable to look up font label for font '"+t+"', '"+e+"'. Refer to getFontList() for available fonts."),a||r.noFallback||null==(a=tt.times[e])&&(a=tt.times.normal),a},Lt=_.__private__.putInfo=function(){ot(),q("<<"),q("/Producer (jsPDF "+a.version+")");for(var t in J)J.hasOwnProperty(t)&&J[t]&&q("/"+t.substr(0,1).toUpperCase()+t.substr(1)+" ("+Et(J[t])+")");q("/CreationDate ("+x+")"),q(">>"),q("endobj")},Mt=_.__private__.putCatalog=function(t){t=t||{};var e=t.rootDictionaryObjId||ut;switch(ot(),q("<<"),q("/Type /Catalog"),q("/Pages "+e+" 0 R"),I||(I="fullwidth"),I){case"fullwidth":q("/OpenAction [3 0 R /FitH null]");break;case"fullheight":q("/OpenAction [3 0 R /FitV null]");break;case"fullpage":q("/OpenAction [3 0 R /Fit]");break;case"original":q("/OpenAction [3 0 R /XYZ null null 1]");break;default:var r=""+I;"%"===r.substr(r.length-1)&&(I=parseInt(I)/100),"number"==typeof I&&q("/OpenAction [3 0 R /XYZ null null "+m(I)+"]")}switch(P||(P="continuous"),P){case"continuous":q("/PageLayout /OneColumn");break;case"single":q("/PageLayout /SinglePage");break;case"two":case"twoleft":q("/PageLayout /TwoColumnLeft");break;case"tworight":q("/PageLayout /TwoColumnRight")}O&&q("/PageMode /"+O),at.publish("putCatalog"),q(">>"),q("endobj")},Tt=_.__private__.putTrailer=function(){q("trailer"),q("<<"),q("/Size "+(W+1)),q("/Root "+W+" 0 R"),q("/Info "+(W-1)+" 0 R"),q("/ID [ <"+y+"> <"+y+"> ]"),q(">>")},Bt=_.__private__.putHeader=function(){q("%PDF-"+d),q("%")},jt=_.__private__.putXRef=function(){var t=1,e="0000000000";for(q("xref"),q("0 "+(W+1)),q("0000000000 65535 f "),t=1;t<=W;t++){var r=K[t];q("function"==typeof r?(e+K[t]()).slice(-10)+" 00000 n ":void 0!==K[t]?(e+K[t]).slice(-10)+" 00000 n ":"0000000000 00000 n ")}},Ft=_.__private__.buildDocument=function(){B=!1,W=0,R=0,F=[],K=[],nt=[],ut=st(),ft=st(),at.publish("buildDocument"),Bt(),gt(),wt(),bt(),Lt(),Mt();var t=R;return jt(),Tt(),q("startxref"),q(""+t),q("%%EOF"),B=!0,F.join("\n")},Rt=_.__private__.getBlob=function(t){return new Blob([z(t)],{type:"application/pdf"})},qt=_.output=_.__private__.output=function(e){return e.foo=function(){try{return e.apply(this,arguments)}catch(e){var r=e.stack||"";~r.indexOf(" at ")&&(r=r.split(" at ")[1])
;var n="Error in function "+r.split("\n")[0].split("<")[0]+": "+e.message;if(!t.console)throw new Error(n);t.console.error(n,e),t.alert&&alert(n)}},e.foo.bar=e,e.foo}(function(e,r){r=r||{};var n=Ft();switch("string"==typeof r?r={filename:r}:r.filename=r.filename||"generated.pdf",e){case void 0:return n;case"save":_.save(r.filename);break;case"arraybuffer":return z(n);case"blob":return Rt(n);case"bloburi":case"bloburl":return t.URL&&t.URL.createObjectURL(Rt(n))||void 0;case"datauristring":case"dataurlstring":return"data:application/pdf;filename="+r.filename+";base64,"+btoa(n);case"dataurlnewwindow":var a='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring")+'"></iframe></body></html>',i=t.open();if(null!==i&&i.document.write(a),i||"undefined"==typeof safari)return i;case"datauri":case"dataurl":return t.document.location.href="data:application/pdf;filename="+r.filename+";base64,"+btoa(n);default:return null}}),Dt=function(t){return!0===Array.isArray(it)&&it.indexOf(t)>-1};switch(i){case"pt":M=1;break;case"mm":M=72/25.4;break;case"cm":M=72/2.54;break;case"in":M=72;break;case"px":M=1==Dt("px_scaling")?.75:96/72;break;case"pc":case"em":M=12;break;case"ex":M=6;break;default:throw new Error("Invalid unit: "+i)}E(),w();var zt=_.__private__.getPageInfo=function(t){if(isNaN(t)||t%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:rt[t].objId,pageNumber:t,pageContext:rt[t]}},Ut=_.__private__.getPageInfoByObjId=function(t){for(var e in rt)if(rt[e].objId===t)break;if(isNaN(t)||t%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");return zt(e)},Ht=_.__private__.getCurrentPageInfo=function(){return{objId:rt[N].objId,pageNumber:N,pageContext:rt[N]}};_.addPage=function(){return Nt.apply(this,arguments),this},_.setPage=function(){return It.apply(this,arguments),this},_.insertPage=function(t){return this.addPage(),this.movePage(N,t),this},_.movePage=function(t,e){if(t>e){for(var r=j[t],n=rt[t],a=t;a>e;a--)j[a]=j[a-1],rt[a]=rt[a-1];j[e]=r,rt[e]=n,this.setPage(e)}else if(t<e){for(var r=j[t],n=rt[t],a=t;a<e;a++)j[a]=j[a+1],rt[a]=rt[a+1];j[e]=r,rt[e]=n,this.setPage(e)}return this},_.deletePage=function(){return Ct.apply(this,arguments),this};var Gt=(_.__private__.text=_.text=function(t,e,r,a){function i(t){return t=t.split("\t").join(Array(a.TabLen||9).join(" ")),Et(t,l)}function o(t){for(var e,r=t.concat(),n=[],a=r.length;a--;)e=r.shift(),"string"==typeof e?n.push(e):Array.isArray(t)&&1===e.length?n.push(e[0]):n.push([e[0],e[1],e[2]]);return n}function s(t,e){var r;if("string"==typeof t)r=e(t)[0];else if(Array.isArray(t)){for(var n,a,i=t.concat(),o=[],s=i.length;s--;)n=i.shift(),"string"==typeof n?o.push(e(n)[0]):Array.isArray(n)&&"string"===n[0]&&(a=e(n[0],n[1],n[2]),o.push([a[0],a[1],a[2]]));r=o}return r}var c;"number"!=typeof t||"number"!=typeof e||"string"!=typeof r&&!Array.isArray(r)||(c=r,r=e,e=t,t=c);var l=arguments[3],u=arguments[4],f=arguments[5];if("object"===n(l)&&null!==l||("string"==typeof u&&(f=u,u=null),"string"==typeof l&&(f=l,l=null),"number"==typeof l&&(u=l,l=null),a={flags:l,angle:u,align:f}),l=l||{},l.noBOM=l.noBOM||!0,l.autoencode=l.autoencode||!0,isNaN(e)||isNaN(r)||void 0===t||null===t)throw new Error("Invalid arguments passed to jsPDF.text");if(0===t.length)return h;var _="",d=!1,p="number"==typeof a.lineHeightFactor?a.lineHeightFactor:Vt,h=a.scope||this,g=!1,y=!0;if("string"==typeof t)g=!0;else if(Array.isArray(t)){for(var b,w=t.concat(),x=[],A=w.length;A--;)("string"!=typeof(b=w.shift())||Array.isArray(b)&&"string"!=typeof b[0])&&(y=!1);g=y}if(!1===g)throw new Error('Type of text must be string or Array. "'+t+'" is not recognized.');var k=Z[L].encoding;"WinAnsiEncoding"!==k&&"StandardEncoding"!==k||(t=s(t,function(t,e,r){return[i(t),e,r]})),"string"==typeof t&&(t=t.match(/[\r?\n]/)?t.split(/\r\n|\r|\n/g):[t]);var E=H/h.internal.scaleFactor,S=E*(Vt-1);switch(a.baseline){case"bottom":r-=S;break;case"top":r+=E-S;break;case"hanging":r+=E-2*S;break;case"middle":r+=E/2-S}var N=a.maxWidth||0;N>0&&("string"==typeof t?t=h.splitTextToSize(t,N):"[object Array]"===Object.prototype.toString.call(t)&&(t=h.splitTextToSize(t.join(" "),N)));var C={text:t,x:e,y:r,options:a,mutex:{pdfEscape:Et,activeFontKey:L,fonts:Z,activeFontSize:H}};at.publish("preProcessText",C),t=C.text,a=C.options;var u=a.angle,I=h.internal.scaleFactor,O=[];if(u){u*=Math.PI/180;var P=Math.cos(u),M=Math.sin(u);O=[m(P),m(M),m(-1*M),m(P)]}var T=a.charSpace;void 0!==T&&(_+=v(T*I)+" Tc\n");var B=(a.lang,-1),j=void 0!==a.renderingMode?a.renderingMode:a.stroke,F=h.internal.getCurrentPageInfo().pageContext;switch(j){case 0:case!1:case"fill":B=0;break;case 1:case!0:case"stroke":B=1;break;case 2:case"fillThenStroke":B=2;break;case 3:case"invisible":B=3;break;case 4:case"fillAndAddForClipping":B=4;break;case 5:case"strokeAndAddPathForClipping":B=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":B=6;break;case 7:case"addToPathForClipping":B=7}var R=void 0!==F.usedRenderingMode?F.usedRenderingMode:-1;-1!==B?_+=B+" Tr\n":-1!==R&&(_+="0 Tr\n"),-1!==B&&(F.usedRenderingMode=B);var D,f=a.align||"left",z=H*p,U=h.internal.pageSize.getWidth(),I=h.internal.scaleFactor,G=Z[L],T=a.charSpace||se,N=a.maxWidth||0,l={},V=[];if("[object Array]"===Object.prototype.toString.call(t)){var Q,X,D,x=o(t);"left"!==f&&(D=x.map(function(t){return h.getStringUnitWidth(t,{font:G,charSpace:T,fontSize:H})*H/I}));var J,X=Math.max.apply(Math,D),W=0;if("right"===f){e-=D[0],t=[];for(var K=0,A=x.length;K<A;K++)X-D[K],0===K?(J=Zt(e),Q=te(r)):(J=(W-D[K])*I,Q=-z),t.push([x[K],J,Q]),W=D[K]}else if("center"===f){e-=D[0]/2,t=[];for(var K=0,A=x.length;K<A;K++)(X-D[K])/2,0===K?(J=Zt(e),Q=te(r)):(J=(W-D[K])/2*I,Q=-z),t.push([x[K],J,Q]),W=D[K]}else if("left"===f){t=[];for(var K=0,A=x.length;K<A;K++)Q=0===K?te(r):-z,J=0===K?Zt(e):0,t.push(x[K])}else{if("justify"!==f)throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');t=[];for(var N=0!==N?N:U,K=0,A=x.length;K<A;K++)Q=0===K?te(r):-z,J=0===K?Zt(e):0,K<A-1&&V.push(((N-D[K])/(x[K].split(" ").length-1)*I).toFixed(2)),t.push([x[K],J,Q])}}!0===("boolean"==typeof a.R2L?a.R2L:Y)&&(t=s(t,function(t,e,r){return[t.split("").reverse().join(""),e,r]}));var C={text:t,x:e,y:r,options:a,mutex:{pdfEscape:Et,activeFontKey:L,fonts:Z,activeFontSize:H}};at.publish("postProcessText",C),t=C.text,d=C.mutex.isHex;var x=o(t);t=[];for(var tt,et,rt,nt=0,A=x.length,it="",K=0;K<A;K++)it="",Array.isArray(x[K])?(tt=parseFloat(x[K][1]),et=parseFloat(x[K][2]),rt=(d?"<":"(")+x[K][0]+(d?">":")"),nt=1):(tt=Zt(e),et=te(r),rt=(d?"<":"(")+x[K]+(d?">":")")),void 0!==V&&void 0!==V[K]&&(it=V[K]+" Tw\n"),0!==O.length&&0===K?t.push(it+O.join(" ")+" "+tt.toFixed(2)+" "+et.toFixed(2)+" Tm\n"+rt):1===nt||0===nt&&0===K?t.push(it+tt.toFixed(2)+" "+et.toFixed(2)+" Td\n"+rt):t.push(it+rt);t=0===nt?t.join(" Tj\nT* "):t.join(" Tj\n"),t+=" Tj\n";var ot="BT\n/"+L+" "+H+" Tf\n"+(H*p).toFixed(2)+" TL\n"+ie+"\n";return ot+=_,ot+=t,ot+="ET",q(ot),$[L]=!0,h},_.__private__.lstext=_.lstext=function(t,e,r,n){return console.warn("jsPDF.lstext is deprecated"),this.text(t,e,r,{charSpace:n})},_.__private__.clip=_.clip=function(t){q("evenodd"===t?"W*":"W"),q("n")},_.__private__.clip_fixed=_.clip_fixed=function(t){console.log("clip_fixed is deprecated"),_.clip(t)},_.__private__.isValidStyle=function(t){var e=[void 0,null,"S","F","DF","FD","f","f*","B","B*"],r=!1;return-1!==e.indexOf(t)&&(r=!0),r}),Yt=_.__private__.getStyle=function(t){var e="S";return"F"===t?e="f":"FD"===t||"DF"===t?e="B":"f"!==t&&"f*"!==t&&"B"!==t&&"B*"!==t||(e=t),e};_.__private__.line=_.line=function(t,e,r,n){if(isNaN(t)||isNaN(e)||isNaN(r)||isNaN(n))throw new Error("Invalid arguments passed to jsPDF.line");return this.lines([[r-t,n-e]],t,e)},_.__private__.lines=_.lines=function(t,e,r,n,a,i){var o,s,c,l,u,f,$,_,d,p,h,g;if("number"==typeof t&&(g=r,r=e,e=t,t=g),n=n||[1,1],i=i||!1,isNaN(e)||isNaN(r)||!Array.isArray(t)||!Array.isArray(n)||!Gt(a)||"boolean"!=typeof i)throw new Error("Invalid arguments passed to jsPDF.lines");for(q(v(Zt(e))+" "+v(te(r))+" m "),o=n[0],s=n[1],l=t.length,p=e,h=r,c=0;c<l;c++)u=t[c],2===u.length?(p=u[0]*o+p,h=u[1]*s+h,q(v(Zt(p))+" "+v(te(h))+" l")):(f=u[0]*o+p,$=u[1]*s+h,_=u[2]*o+p,d=u[3]*s+h,p=u[4]*o+p,h=u[5]*s+h,q(v(Zt(f))+" "+v(te($))+" "+v(Zt(_))+" "+v(te(d))+" "+v(Zt(p))+" "+v(te(h))+" c"));return i&&q(" h"),null!==a&&q(Yt(a)),this},_.__private__.rect=_.rect=function(t,e,r,n,a){if(isNaN(t)||isNaN(e)||isNaN(r)||isNaN(n)||!Gt(a))throw new Error("Invalid arguments passed to jsPDF.rect");return q([m(Zt(t)),m(te(e)),m(r*M),m(-n*M),"re"].join(" ")),null!==a&&q(Yt(a)),this},_.__private__.triangle=_.triangle=function(t,e,r,n,a,i,o){if(isNaN(t)||isNaN(e)||isNaN(r)||isNaN(n)||isNaN(a)||isNaN(i)||!Gt(o))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[r-t,n-e],[a-r,i-n],[t-a,e-i]],t,e,[1,1],o,!0),this},_.__private__.roundedRect=_.roundedRect=function(t,e,r,n,a,i,o){if(isNaN(t)||isNaN(e)||isNaN(r)||isNaN(n)||isNaN(a)||isNaN(i)||!Gt(o))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var s=4/3*(Math.SQRT2-1);return this.lines([[r-2*a,0],[a*s,0,a,i-i*s,a,i],[0,n-2*i],[0,i*s,-a*s,i,-a,i],[2*a-r,0],[-a*s,0,-a,-i*s,-a,-i],[0,2*i-n],[0,-i*s,a*s,-i,a,-i]],t+a,e,[1,1],o),this},_.__private__.ellipse=_.ellipse=function(t,e,r,n,a){if(isNaN(t)||isNaN(e)||isNaN(r)||isNaN(n)||!Gt(a))throw new Error("Invalid arguments passed to jsPDF.ellipse");var i=4/3*(Math.SQRT2-1)*r,o=4/3*(Math.SQRT2-1)*n;return q([m(Zt(t+r)),m(te(e)),"m",m(Zt(t+r)),m(te(e-o)),m(Zt(t+i)),m(te(e-n)),m(Zt(t)),m(te(e-n)),"c"].join(" ")),q([m(Zt(t-i)),m(te(e-n)),m(Zt(t-r)),m(te(e-o)),m(Zt(t-r)),m(te(e)),"c"].join(" ")),q([m(Zt(t-r)),m(te(e+o)),m(Zt(t-i)),m(te(e+n)),m(Zt(t)),m(te(e+n)),"c"].join(" ")),q([m(Zt(t+i)),m(te(e+n)),m(Zt(t+r)),m(te(e+o)),m(Zt(t+r)),m(te(e)),"c"].join(" ")),null!==a&&q(Yt(a)),this},_.__private__.circle=_.circle=function(t,e,r,n){if(isNaN(t)||isNaN(e)||isNaN(r)||!Gt(n))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(t,e,r,r,n)};_.setFont=function(t,e){return L=Pt(t,e,{disableWarning:!1}),this},_.setFontStyle=_.setFontType=function(t){return L=Pt(void 0,t),this};_.__private__.getFontList=_.getFontList=function(){var t,e,r,n={};for(t in tt)if(tt.hasOwnProperty(t)){n[t]=r=[];for(e in tt[t])tt[t].hasOwnProperty(e)&&r.push(e)}return n};_.addFont=function(t,e,r,n){n=n||"Identity-H",At.call(this,t,e,r,n)};var Vt,Vt,Qt=c.lineWidth||.200025,Xt=_.__private__.setLineWidth=_.setLineWidth=function(t){return q((t*M).toFixed(2)+" w"),this},Jt=(_.__private__.setLineDash=a.API.setLineDash=function(t,e){if(t=t||[],e=e||0,isNaN(e)||!Array.isArray(t))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return t=t.map(function(t){return(t*M).toFixed(3)}).join(" "),e=parseFloat((e*M).toFixed(3)),q("["+t+"] "+e+" d"),this},_.__private__.getLineHeight=_.getLineHeight=function(){return H*Vt}),Jt=_.__private__.getLineHeight=_.getLineHeight=function(){return H*Vt},Wt=_.__private__.setLineHeightFactor=_.setLineHeightFactor=function(t){return t=t||1.15,"number"==typeof t&&(Vt=t),this},Kt=_.__private__.getLineHeightFactor=_.getLineHeightFactor=function(){return Vt};Wt(c.lineHeight);var Zt=_.__private__.getHorizontalCoordinate=function(t){return t*M},te=_.__private__.getVerticalCoordinate=function(t){return rt[N].mediaBox.topRightY-rt[N].mediaBox.bottomLeftY-t*M},ee=_.__private__.getHorizontalCoordinateString=function(t){return m(t*M)},re=_.__private__.getVerticalCoordinateString=function(t){return m(rt[N].mediaBox.topRightY-rt[N].mediaBox.bottomLeftY-t*M)},ne=c.strokeColor||"0 G",ae=(_.__private__.getStrokeColor=_.getDrawColor=function(){return $t(ne)},_.__private__.setStrokeColor=_.setDrawColor=function(t,e,r,n){return ne=_t({ch1:t,ch2:e,ch3:r,ch4:n,pdfColorType:"draw",precision:2}),q(ne),this},c.fillColor||"0 g"),ie=(_.__private__.getFillColor=_.getFillColor=function(){return $t(ae)},_.__private__.setFillColor=_.setFillColor=function(t,e,r,n){return ae=_t({ch1:t,ch2:e,ch3:r,ch4:n,pdfColorType:"fill",precision:2}),q(ae),this},c.textColor||"0 g"),oe=_.__private__.getTextColor=_.getTextColor=function(){return $t(ie)},se=(_.__private__.setTextColor=_.setTextColor=function(t,e,r,n){return ie=_t({ch1:t,ch2:e,ch3:r,ch4:n,pdfColorType:"text",precision:3}),this},c.charSpace||0),ce=_.__private__.getCharSpace=_.getCharSpace=function(){return se},le=(_.__private__.setCharSpace=_.setCharSpace=function(t){if(isNaN(t))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return se=t,this},0);_.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2};var ue,fe=(_.__private__.setLineCap=_.setLineCap=function(t){var e=_.CapJoinStyles[t];if(void 0===e)throw new Error("Line cap style of '"+t+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return le=e,q(e+" J"),this},0);_.__private__.setLineJoin=_.setLineJoin=function(t){var e=_.CapJoinStyles[t];if(void 0===e)throw new Error("Line join style of '"+t+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return fe=e,q(e+" j"),this},_.__private__.setMiterLimit=_.setMiterLimit=function(t){if(t=t||0,isNaN(t))throw new Error("Invalid argument passed to jsPDF.setMiterLimit");return ue=parseFloat(m(t*M)),q(ue+" M"),this};_.save=function(e,r){if(e=e||"generated.pdf",r=r||{},r.returnPromise=r.returnPromise||!1,!1!==r.returnPromise)return new Promise(function(r,n){try{var a=saveAs(Rt(Ft()),e);"function"==typeof saveAs.unload&&t.setTimeout&&setTimeout(saveAs.unload,911),r(a)}catch(t){n(t.message)}});saveAs(Rt(Ft()),e),"function"==typeof saveAs.unload&&t.setTimeout&&setTimeout(saveAs.unload,911)};for(var $e in a.API)a.API.hasOwnProperty($e)&&("events"===$e&&a.API.events.length?function(t,e){var r,n,a;for(a=e.length-1;-1!==a;a--)r=e[a][0],n=e[a][1],t.subscribe.apply(t,[r].concat("function"==typeof n?[n]:n))}(at,a.API.events):_[$e]=a.API[$e]);return _.internal={pdfEscape:Et,getStyle:Yt,getFont:function(){return Z[Pt.apply(_,arguments)]},getFontSize:G,getCharSpace:ce,getTextColor:oe,getLineHeight:Jt,getLineHeightFactor:Kt,write:D,getHorizontalCoordinate:Zt,getVerticalCoordinate:te,getCoordinateString:ee,getVerticalCoordinateString:re,collections:{},newObject:ot,newAdditionalObject:lt,newObjectDeferred:st,newObjectDeferredBegin:ct,getFilters:dt,putStream:pt,events:at,scaleFactor:M,pageSize:{getWidth:function(){return(rt[N].mediaBox.topRightX-rt[N].mediaBox.bottomLeftX)/M},setWidth:function(t){rt[N].mediaBox.topRightX=t*M+rt[N].mediaBox.bottomLeftX},getHeight:function(){return(rt[N].mediaBox.topRightY-rt[N].mediaBox.bottomLeftY)/M},setHeight:function(t){rt[N].mediaBox.topRightY=t*M+rt[N].mediaBox.bottomLeftY}},output:qt,getNumberOfPages:Ot,pages:j,out:q,f2:m,f3:v,getPageInfo:zt,getPageInfoByObjId:Ut,getCurrentPageInfo:Ht,getPDFVersion:p,hasHotfix:Dt},Object.defineProperty(_.internal.pageSize,"width",{get:function(){return(rt[N].mediaBox.topRightX-rt[N].mediaBox.bottomLeftX)/M},set:function(t){rt[N].mediaBox.topRightX=t*M+rt[N].mediaBox.bottomLeftX},enumerable:!0,configurable:!0}),Object.defineProperty(_.internal.pageSize,"height",{get:function(){return(rt[N].mediaBox.topRightY-rt[N].mediaBox.bottomLeftY)/M},set:function(t){rt[N].mediaBox.topRightY=t*M+rt[N].mediaBox.bottomLeftY},enumerable:!0,configurable:!0}),function(t){for(var e=0,r=U.length;e<r;e++){var n=At(t[e][0],t[e][1],t[e][2],U[e][3],!0);$[n]=!0;var a=t[e][0].split("-");xt(n,a[0],a[1]||"")}at.publish("addFonts",{fonts:Z,dictionary:tt})}(U),L="F1",Nt(o,e),at.publish("initialized"),_}return a.API={events:[]},a.version="1.5.2","function"==typeof define&&define.amd?define("jsPDF",function(){return a}):void 0!==e&&e.exports?(e.exports=a,e.exports.jsPDF=a):t.jsPDF=a,a}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||"undefined"!=typeof global&&global||Function('return typeof this === "object" && this.content')()||Function("return this")());window.tmp=c,function(t,e){function r(t,e,r){r||(r=1);for(var n,a=[];n=e.exec(t);)a.push(n[r]);return a}var a,i=1,o=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},s=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},c=function(t){if(isNaN(t))throw new Error("Invalid argument passed to jsPDF.f2");return t.toFixed(2)},l=function(t){if(isNaN(t))throw new Error("Invalid argument passed to jsPDF.f2");return t.toFixed(5)};t.__acroform__={};var u=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},f=function(t){return t*i},$=function(t){return t/i},_=function(t){var e=new j,r=W.internal.getHeight(t)||0,n=W.internal.getWidth(t)||0;return e.BBox=[0,0,Number(c(n)),Number(c(r))],e},d=t.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|=1<<e},p=t.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&=~(1<<e)},h=t.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return 0==(t&1<<e)?0:1},g=t.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return h(t,e-1)},m=t.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return d(t,e-1)},v=t.__acroform__.clearBitForPdf=function(t,e,r){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return p(t,e-1)},y=t.__acroform__.calculateCoordinates=function(t){var e=this.internal.getHorizontalCoordinate,r=this.internal.getVerticalCoordinate,n=t[0],a=t[1],i=t[2],o=t[3],s={};return s.lowerLeft_X=e(n)||0,s.lowerLeft_Y=r(a+o)||0,s.upperRight_X=e(n+i)||0,s.upperRight_Y=r(a)||0,[Number(c(s.lowerLeft_X)),Number(c(s.lowerLeft_Y)),Number(c(s.upperRight_X)),Number(c(s.upperRight_Y))]},b=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],r=t.V||t.DV,n=w(t,r),i=a.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(a.__private__.encodeColorString(t.color)),e.push("/"+i+" "+c(n.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(n.text),e.push("ET"),e.push("Q"),e.push("EMC");var o=new _(t);return o.stream=e.join("\n"),o}},w=function(t,e){var r=t.maxFontSize||12,n=(t.fontName,{text:"",fontSize:""});e="("==e.substr(0,1)?e.substr(1):e,e=")"==e.substr(e.length-1)?e.substr(0,e.length-1):e;var i=e.split(" "),s=(a.__private__.encodeColorString(t.color),r),l=W.internal.getHeight(t)||0;l=l<0?-l:l;var u=W.internal.getWidth(t)||0;u=u<0?-u:u;s++;t:for(;;){var e="";s--;var f=x("3",t,s).height,$=t.multiline?l-s:(l-f)/2;$+=2;var _=-2,d=$,p=0,h=0,g=0;if(s<=0){s=12,e="(...) Tj\n",e+="% Width of Text: "+x(e,t,s).width+", FieldWidth:"+u+"\n";break}g=x(i[0]+" ",t,s).width;var m="",v=0;for(var y in i)if(i.hasOwnProperty(y)){m+=i[y]+" ",m=" "==m.substr(m.length-1)?m.substr(0,m.length-1):m;var b=parseInt(y);g=x(m+" ",t,s).width;var w=function(e,r,n){if(e+1<i.length){var a=r+" "+i[e+1];return x(a,t,n).width<=u-4}return!1}(b,m,s),A=y>=i.length-1;if(w&&!A){m+=" ";continue}if(w||A){if(A)h=b;else if(t.multiline&&(f+2)*(v+2)+2>l)continue t}else{if(!t.multiline)continue t;if((f+2)*(v+2)+2>l)continue t;h=b}for(var k="",E=p;E<=h;E++)k+=i[E]+" ";switch(k=" "==k.substr(k.length-1)?k.substr(0,k.length-1):k,g=x(k,t,s).width,t.textAlign){case"right":_=u-g-2;break;case"center":_=(u-g)/2;break;case"left":default:_=2}e+=c(_)+" "+c(d)+" Td\n",e+="("+o(k)+") Tj\n",e+=-c(_)+" 0 Td\n",d=-(s+2),g=0,p=h+1,v++,m=""}else;break}return n.text=e,n.fontSize=s,n},x=function(t,e,r){var n=a.internal.getFont(e.fontName,e.fontStyle),i=a.getStringUnitWidth(t,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:a.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:i}},A={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},k=function(){a.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var t=a.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var e in t)if(t.hasOwnProperty(e)){var r=t[e];r.objId=void 0,r.hasAnnotation&&S.call(a,r)}},E=function(t){a.internal.acroformPlugin.printedOut&&(a.internal.acroformPlugin.printedOut=!1,a.internal.acroformPlugin.acroFormDictionaryRoot=null),a.internal.acroformPlugin.acroFormDictionaryRoot||P.call(a),a.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t)},S=function(t){var e={type:"reference",object:t},r=function(t){return t.type===e.type&&t.object===e.object};void 0===a.internal.getPageInfo(t.page).pageContext.annotations.find(r)&&a.internal.getPageInfo(t.page).pageContext.annotations.push(e)},N=function(){if(void 0===a.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("putCatalogCallback: Root missing.");a.internal.write("/AcroForm "+a.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")},C=function(){a.internal.events.unsubscribe(a.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete a.internal.acroformPlugin.acroFormDictionaryRoot._eventID,a.internal.acroformPlugin.printedOut=!0},I=function(t){var e=!t;t||(a.internal.newObjectDeferredBegin(a.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),a.internal.acroformPlugin.acroFormDictionaryRoot.putStream());var t=t||a.internal.acroformPlugin.acroFormDictionaryRoot.Kids;for(var r in t)if(t.hasOwnProperty(r)){var i=t[r],o=[],s=i.Rect;if(i.Rect&&(i.Rect=y.call(this,i.Rect)),a.internal.newObjectDeferredBegin(i.objId,!0),i.DA=W.createDefaultAppearanceStream(i),"object"===n(i)&&"function"==typeof i.getKeyValueListForStream&&(o=i.getKeyValueListForStream()),i.Rect=s,i.hasAppearanceStream&&!i.appearanceStreamContent){var c=b.call(this,i);o.push({key:"AP",value:"<</N "+c+">>"}),a.internal.acroformPlugin.xForms.push(c)}if(i.appearanceStreamContent){var l="";for(var u in i.appearanceStreamContent)if(i.appearanceStreamContent.hasOwnProperty(u)){var f=i.appearanceStreamContent[u];if(l+="/"+u+" ",l+="<<",Object.keys(f).length>=1||Array.isArray(f)){for(var r in f)if(f.hasOwnProperty(r)){var $=f[r];"function"==typeof $&&($=$.call(this,i)),l+="/"+r+" "+$+" ",a.internal.acroformPlugin.xForms.indexOf($)>=0||a.internal.acroformPlugin.xForms.push($)}}else{var $=f;"function"==typeof $&&($=$.call(this,i)),l+="/"+r+" "+$,a.internal.acroformPlugin.xForms.indexOf($)>=0||a.internal.acroformPlugin.xForms.push($)}l+=">>"}o.push({key:"AP",value:"<<\n"+l+">>"})}a.internal.putStream({additionalKeyValues:o}),a.internal.out("endobj")}e&&O.call(this,a.internal.acroformPlugin.xForms)},O=function(t){for(var e in t)if(t.hasOwnProperty(e)){var r=e,i=t[e];a.internal.newObjectDeferredBegin(i&&i.objId,!0),"object"===n(i)&&"function"==typeof i.putStream&&i.putStream(),delete t[r]}},P=function(){if(void 0!==this.internal&&(void 0===this.internal.acroformPlugin||!1===this.internal.acroformPlugin.isInitialized)){if(a=this,R.FieldNum=0,this.internal.acroformPlugin=JSON.parse(JSON.stringify(A)),this.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");i=a.internal.scaleFactor,a.internal.acroformPlugin.acroFormDictionaryRoot=new F,a.internal.acroformPlugin.acroFormDictionaryRoot._eventID=a.internal.events.subscribe("postPutResources",C),a.internal.events.subscribe("buildDocument",k),a.internal.events.subscribe("putCatalog",N),a.internal.events.subscribe("postPutPages",I),a.internal.acroformPlugin.isInitialized=!0}},L=t.__acroform__.arrayToPdfArray=function(t){if(Array.isArray(t)){for(var e="[",r=0;r<t.length;r++)switch(0!==r&&(e+=" "),n(t[r])){case"boolean":case"number":case"object":e+=t[r].toString();break;case"string":"/"!==t[r].substr(0,1)?e+="("+o(t[r].toString())+")":e+=t[r].toString()}return e+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},M=function(t){var e=[];return"string"==typeof t&&(e=r(t,/\((.*?)\)/g)),e},T=function(t){return t=t||"",t.toString(),t="("+o(t)+")"},B=function(){var t;Object.defineProperty(this,"objId",{configurable:!0,get:function(){if(t||(t=a.internal.newObjectDeferred()),!t)throw new Error("AcroFormPDFObject: Couldn't create Object ID");return t},set:function(e){t=e}})};B.prototype.toString=function(){return this.objId+" 0 R"},B.prototype.putStream=function(){var t=this.getKeyValueListForStream();a.internal.putStream({data:this.stream,additionalKeyValues:t}),a.internal.out("endobj")},B.prototype.getKeyValueListForStream=function(){return function(t){var e=[],r=Object.getOwnPropertyNames(t).filter(function(t){return"content"!=t&&"appearanceStreamContent"!=t&&"_"!=t.substring(0,1)});for(var n in r)if(!1===Object.getOwnPropertyDescriptor(t,r[n]).configurable){var a=r[n],i=t[a];i&&(Array.isArray(i)?e.push({key:a,value:L(i)}):i instanceof B?e.push({key:a,value:i.objId+" 0 R"}):"function"!=typeof i&&e.push({key:a,value:i}))}return e}(this)};var j=function(){B.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writeable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writeable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writeable:!0});var t=[];Object.defineProperty(this,"BBox",{configurable:!1,writeable:!0,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writeable:!0});var e;Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(t){e=t.trim()},get:function(){return e||null}})};u(j,B);var F=function(){B.call(this);var t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}});var e;Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e)return"("+e+")"},set:function(t){e=t}})};u(F,B);var R=function t(){B.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(t){if(isNaN(t))throw new Error('Invalid value "'+t+'" for attribute F supplied.');e=t}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return Boolean(g(e,3))},set:function(t){!0===Boolean(t)?this.F=m(e,3):this.F=v(e,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(t){if(isNaN(t))throw new Error('Invalid value "'+t+'" for attribute Ff supplied.');r=t}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(0!==n.length)return n},set:function(t){n=void 0!==t?t:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:$(n[0])},set:function(t){n[0]=f(t)}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:$(n[1])},set:function(t){n[1]=f(t)}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:$(n[2])},set:function(t){n[2]=f(t)}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:$(n[3])},set:function(t){n[3]=f(t)}});var a="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return a},set:function(t){switch(t){case"/Btn":case"/Tx":case"/Ch":case"/Sig":a=t;break;default:throw new Error('Invalid value "'+t+'" for attribute FT supplied.')}}});var i=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!i||i.length<1){if(this instanceof V)return;i="FieldObject"+t.FieldNum++}return"("+o(i)+")"},set:function(t){i=t.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return i},set:function(t){i=t}});var c="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return c},set:function(t){c=t}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(t){l=t}});var u=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return $(u)},set:function(t){u=f(t)}});var _=50;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return $(_)},set:function(t){_=f(t)}});var d="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return d},set:function(t){d=t}});var p="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!p||this instanceof V||this instanceof X))return T(p)},set:function(t){t=t.toString(),p=t}});var h=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof H==!1?T(h):h},set:function(t){t=t.toString(),h=this instanceof H==!1?s("("===t.substr(0,1)?t.substr(1,t.length-2):t):t}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof H==!0?s(h.substr(1,h.length-1)):h},set:function(t){t=t.toString(),h=this instanceof H==!0?"/"+t:t}});var y=null;Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(y)return this instanceof H==!1?T(y):y},set:function(t){t=t.toString(),y=this instanceof H==!1?s("("===t.substr(0,1)?t.substr(1,t.length-2):t):t}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof H==!0?s(y.substr(1,y.length-1)):y},set:function(t){t=t.toString(),y=this instanceof H==!0?"/"+t:t}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var b=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,writeable:!0,get:function(){return b},set:function(t){t=Boolean(t),b=t}});var w;Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,writeable:!0,get:function(){if(w)return w},set:function(t){w=t}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return Boolean(g(this.Ff,1))},set:function(t){!0===Boolean(t)?this.Ff=m(this.Ff,1):this.Ff=v(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return Boolean(g(this.Ff,2))},set:function(t){!0===Boolean(t)?this.Ff=m(this.Ff,2):this.Ff=v(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return Boolean(g(this.Ff,3))},set:function(t){!0===Boolean(t)?this.Ff=m(this.Ff,3):this.Ff=v(this.Ff,3)}});var x=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(null!==x)return x},set:function(t){if(-1===[0,1,2].indexOf(t))throw new Error('Invalid value "'+t+'" for attribute Q supplied.');x=t}}),Object.defineProperty(this,"textAlign",{get:function(){var t="left";switch(x){case 0:default:t="left";break;case 1:t="center";break;case 2:t="right"}return t},configurable:!0,enumerable:!0,set:function(t){switch(t){case"right":case 2:x=2;break;case"center":case 1:x=1;break;case"left":case 0:default:x=0}}})};u(R,B);var q=function(){R.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){
return t},set:function(e){t=e}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return L(e)},set:function(t){e=M(t)}}),this.getOptions=function(){return e},this.setOptions=function(t){e=t,this.sort&&e.sort()},this.addOption=function(t){t=t||"",t=t.toString(),e.push(t),this.sort&&e.sort()},this.removeOption=function(t,r){for(r=r||!1,t=t||"",t=t.toString();-1!==e.indexOf(t)&&(e.splice(e.indexOf(t),1),!1!==r););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return Boolean(g(this.Ff,18))},set:function(t){!0===Boolean(t)?this.Ff=m(this.Ff,18):this.Ff=v(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return Boolean(g(this.Ff,19))},set:function(t){!0===this.combo&&(!0===Boolean(t)?this.Ff=m(this.Ff,19):this.Ff=v(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return Boolean(g(this.Ff,20))},set:function(t){!0===Boolean(t)?(this.Ff=m(this.Ff,20),e.sort()):this.Ff=v(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return Boolean(g(this.Ff,22))},set:function(t){!0===Boolean(t)?this.Ff=m(this.Ff,22):this.Ff=v(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return Boolean(g(this.Ff,23))},set:function(t){!0===Boolean(t)?this.Ff=m(this.Ff,23):this.Ff=v(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return Boolean(g(this.Ff,27))},set:function(t){!0===Boolean(t)?this.Ff=m(this.Ff,27):this.Ff=v(this.Ff,27)}}),this.hasAppearanceStream=!1};u(q,R);var D=function(){q.call(this),this.fontName="helvetica",this.combo=!1};u(D,q);var z=function(){D.call(this),this.combo=!0};u(z,D);var U=function(){z.call(this),this.edit=!0};u(U,z);var H=function(){R.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return Boolean(g(this.Ff,15))},set:function(t){!0===Boolean(t)?this.Ff=m(this.Ff,15):this.Ff=v(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return Boolean(g(this.Ff,16))},set:function(t){!0===Boolean(t)?this.Ff=m(this.Ff,16):this.Ff=v(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return Boolean(g(this.Ff,17))},set:function(t){!0===Boolean(t)?this.Ff=m(this.Ff,17):this.Ff=v(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return Boolean(g(this.Ff,26))},set:function(t){!0===Boolean(t)?this.Ff=m(this.Ff,26):this.Ff=v(this.Ff,26)}});var t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){if(0!==Object.keys(t).length){var e=[];e.push("<<");var r;for(r in t)e.push("/"+r+" ("+t[r]+")");return e.push(">>"),e.join("\n")}},set:function(e){"object"===n(e)&&(t=e)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(e){"string"==typeof e&&(t.CA=e)}});var e;Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(t){e="/"+t}})};u(H,R);var G=function(){H.call(this),this.pushButton=!0};u(G,H);var Y=function(){H.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=void 0!==e?e:[]}})};u(Y,H);var V=function(){R.call(this);var t;Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(e){t=e}});var e;Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(t){e=t}});var r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var t=[];t.push("<<");var e;for(e in r)t.push("/"+e+" ("+r[e]+")");return t.push(">>"),t.join("\n")},set:function(t){"object"===n(t)&&(r=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(t){"string"==typeof t&&(r.CA=t)}});var a;Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return a},set:function(t){a=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return a.substr(1,a.length-1)},set:function(t){a="/"+t}}),this.optionName=name,this.caption="l",this.appearanceState="Off",this._AppearanceType=W.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(name)};u(V,R),Y.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t&&"getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var r=this.Kids[e];r.appearanceStreamContent=t.createAppearanceStream(r.optionName),r.caption=t.getCA()}},Y.prototype.createOption=function(t){var e=(this.Kids.length,new V);return e.Parent=this,e.optionName=t,this.Kids.push(e),K.call(this,e),e};var Q=function(){H.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=W.CheckBox.createAppearanceStream()};u(Q,H);var X=function(){R.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return Boolean(g(this.Ff,13))},set:function(t){!0===Boolean(t)?this.Ff=m(this.Ff,13):this.Ff=v(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return Boolean(g(this.Ff,21))},set:function(t){!0===Boolean(t)?this.Ff=m(this.Ff,21):this.Ff=v(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return Boolean(g(this.Ff,23))},set:function(t){!0===Boolean(t)?this.Ff=m(this.Ff,23):this.Ff=v(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return Boolean(g(this.Ff,24))},set:function(t){!0===Boolean(t)?this.Ff=m(this.Ff,24):this.Ff=v(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return Boolean(g(this.Ff,25))},set:function(t){!0===Boolean(t)?this.Ff=m(this.Ff,25):this.Ff=v(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return Boolean(g(this.Ff,26))},set:function(t){!0===Boolean(t)?this.Ff=m(this.Ff,26):this.Ff=v(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};u(X,R);var J=function(){X.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return Boolean(g(this.Ff,14))},set:function(t){!0===Boolean(t)?this.Ff=m(this.Ff,14):this.Ff=v(this.Ff,14)}}),this.password=!0};u(J,X);var W={CheckBox:{createAppearanceStream:function(){return{N:{On:W.CheckBox.YesNormal},D:{On:W.CheckBox.YesPushDown,Off:W.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=_(t),r=[],n=a.internal.getFont(t.fontName,t.fontStyle).id,i=a.__private__.encodeColorString(t.color),o=w(t,t.caption);return r.push("0.749023 g"),r.push("0 0 "+c(W.internal.getWidth(t))+" "+c(W.internal.getHeight(t))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+c(o.fontSize)+" Tf "+i),r.push("BT"),r.push(o.text),r.push("ET"),r.push("Q"),r.push("EMC"),e.stream=r.join("\n"),e},YesNormal:function(t){var e=_(t),r=a.internal.getFont(t.fontName,t.fontStyle).id,n=a.__private__.encodeColorString(t.color),i=[],o=W.internal.getHeight(t),s=W.internal.getWidth(t),l=w(t,t.caption);return i.push("1 g"),i.push("0 0 "+c(s)+" "+c(o)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+c(s-1)+" "+c(o-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+r+" "+c(l.fontSize)+" Tf "+n),i.push(l.text),i.push("ET"),i.push("Q"),e.stream=i.join("\n"),e},OffPushDown:function(t){var e=_(t),r=[];return r.push("0.749023 g"),r.push("0 0 "+c(W.internal.getWidth(t))+" "+c(W.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join("\n"),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:W.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=W.RadioButton.Circle.YesNormal,e.D[t]=W.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=_(t),r=[],n=W.internal.getWidth(t)<=W.internal.getHeight(t)?W.internal.getWidth(t)/4:W.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var a=W.internal.Bezier_C,i=Number((n*a).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+l(W.internal.getWidth(t)/2)+" "+l(W.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),r.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),r.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),r.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join("\n"),e},YesPushDown:function(t){var e=_(t),r=[],n=W.internal.getWidth(t)<=W.internal.getHeight(t)?W.internal.getWidth(t)/4:W.internal.getHeight(t)/4,n=Number((.9*n).toFixed(5)),a=Number((2*n).toFixed(5)),i=Number((a*W.internal.Bezier_C).toFixed(5)),o=Number((n*W.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+l(W.internal.getWidth(t)/2)+" "+l(W.internal.getHeight(t)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),r.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),r.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),r.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+l(W.internal.getWidth(t)/2)+" "+l(W.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+o+" "+o+" "+n+" 0 "+n+" c"),r.push("-"+o+" "+n+" -"+n+" "+o+" -"+n+" 0 c"),r.push("-"+n+" -"+o+" -"+o+" -"+n+" 0 -"+n+" c"),r.push(o+" -"+n+" "+n+" -"+o+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join("\n"),e},OffPushDown:function(t){var e=_(t),r=[],n=W.internal.getWidth(t)<=W.internal.getHeight(t)?W.internal.getWidth(t)/4:W.internal.getHeight(t)/4,n=Number((.9*n).toFixed(5)),a=Number((2*n).toFixed(5)),i=Number((a*W.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+l(W.internal.getWidth(t)/2)+" "+l(W.internal.getHeight(t)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),r.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),r.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),r.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join("\n"),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:W.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=W.RadioButton.Cross.YesNormal,e.D[t]=W.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=_(t),r=[],n=W.internal.calculateCross(t);return r.push("q"),r.push("1 1 "+c(W.internal.getWidth(t)-2)+" "+c(W.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push(c(n.x1.x)+" "+c(n.x1.y)+" m"),r.push(c(n.x2.x)+" "+c(n.x2.y)+" l"),r.push(c(n.x4.x)+" "+c(n.x4.y)+" m"),r.push(c(n.x3.x)+" "+c(n.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join("\n"),e},YesPushDown:function(t){var e=_(t),r=W.internal.calculateCross(t),n=[];return n.push("0.749023 g"),n.push("0 0 "+c(W.internal.getWidth(t))+" "+c(W.internal.getHeight(t))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+c(W.internal.getWidth(t)-2)+" "+c(W.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push(c(r.x1.x)+" "+c(r.x1.y)+" m"),n.push(c(r.x2.x)+" "+c(r.x2.y)+" l"),n.push(c(r.x4.x)+" "+c(r.x4.y)+" m"),n.push(c(r.x3.x)+" "+c(r.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join("\n"),e},OffPushDown:function(t){var e=_(t),r=[];return r.push("0.749023 g"),r.push("0 0 "+c(W.internal.getWidth(t))+" "+c(W.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join("\n"),e}}},createDefaultAppearanceStream:function(t){var e=a.internal.getFont(t.fontName,t.fontStyle).id,r=a.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+r}};W.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=W.internal.getWidth(t),r=W.internal.getHeight(t),n=Math.min(e,r);return{x1:{x:(e-n)/2,y:(r-n)/2+n},x2:{x:(e-n)/2+n,y:(r-n)/2},x3:{x:(e-n)/2,y:(r-n)/2},x4:{x:(e-n)/2+n,y:(r-n)/2+n}}}},W.internal.getWidth=function(t){var e=0;return"object"===n(t)&&(e=f(t.Rect[2])),e},W.internal.getHeight=function(t){var e=0;return"object"===n(t)&&(e=f(t.Rect[3])),e};var K=t.addField=function(t){if(P.call(this),!(t instanceof R))throw new Error("Invalid argument passed to jsPDF.addField.");return E.call(this,t),t.page=a.internal.getCurrentPageInfo().pageNumber,this};t.addButton=function(t){if(t instanceof H==!1)throw new Error("Invalid argument passed to jsPDF.addButton.");return K.call(this,t)},t.addTextField=function(t){if(t instanceof X==!1)throw new Error("Invalid argument passed to jsPDF.addTextField.");return K.call(this,t)},t.addChoiceField=function(t){if(t instanceof q==!1)throw new Error("Invalid argument passed to jsPDF.addChoiceField.");return K.call(this,t)};"object"==n(e)&&void 0===e.ChoiceField&&void 0===e.ListBox&&void 0===e.ComboBox&&void 0===e.EditBox&&void 0===e.Button&&void 0===e.PushButton&&void 0===e.RadioButton&&void 0===e.CheckBox&&void 0===e.TextField&&void 0===e.PasswordField?(e.ChoiceField=q,e.ListBox=D,e.ComboBox=z,e.EditBox=U,e.Button=H,e.PushButton=G,e.RadioButton=Y,e.CheckBox=Q,e.TextField=X,e.PasswordField=J,e.AcroForm={Appearance:W}):console.warn("AcroForm-Classes are not populated into global-namespace, because the class-Names exist already."),t.AcroFormChoiceField=q,t.AcroFormListBox=D,t.AcroFormComboBox=z,t.AcroFormEditBox=U,t.AcroFormButton=H,t.AcroFormPushButton=G,t.AcroFormRadioButton=Y,t.AcroFormCheckBox=Q,t.AcroFormTextField=X,t.AcroFormPasswordField=J,t.AcroFormAppearance=W,t.AcroForm={ChoiceField:q,ListBox:D,ComboBox:z,EditBox:U,Button:H,PushButton:G,RadioButton:Y,CheckBox:Q,TextField:X,PasswordField:J,Appearance:W}}(c.API,"undefined"!=typeof window&&window||"undefined"!=typeof global&&global),function(t){var e={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},r=t.getImageFileTypeByImageData=function(r,n){n=n||"UNKNOWN";var a,i,o,s,c,l="UNKNOWN";t.isArrayBufferView(r)&&(r=t.arrayBufferToBinaryString(r));for(c in e)for(o=e[c],a=0;a<o.length;a+=1){for(s=!0,i=0;i<o[a].length;i+=1)if(void 0!==o[a][i]&&o[a][i]!==r.charCodeAt(i)){s=!1;break}if(!0===s){l=c;break}}return"UNKNOWN"===l&&"UNKNOWN"!==n&&(console.warn('FileType of Image not recognized. Processing image as "'+n+'".'),l=n),l},a=function t(e){for(var r=this.internal.newObject(),n=this.internal.write,a=this.internal.putStream,i=this.internal.getFilters,o=i();-1!==o.indexOf("FlateEncode");)o.splice(o.indexOf("FlateEncode"),1);e.n=r;var s=[];if(s.push({key:"Type",value:"/XObject"}),s.push({key:"Subtype",value:"/Image"}),s.push({key:"Width",value:e.w}),s.push({key:"Height",value:e.h}),e.cs===this.color_spaces.INDEXED?s.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(e.pal.length/3-1)+" "+("smask"in e?r+2:r+1)+" 0 R]"}):(s.push({key:"ColorSpace",value:"/"+e.cs}),e.cs===this.color_spaces.DEVICE_CMYK&&s.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),s.push({key:"BitsPerComponent",value:e.bpc}),"dp"in e&&s.push({key:"DecodeParms",value:"<<"+e.dp+">>"}),"trns"in e&&e.trns.constructor==Array){for(var c="",l=0,u=e.trns.length;l<u;l++)c+=e.trns[l]+" "+e.trns[l]+" ";s.push({key:"Mask",value:"["+c+"]"})}"smask"in e&&s.push({key:"SMask",value:r+1+" 0 R"});var f=void 0!==e.f?["/"+e.f]:void 0;if(a({data:e.data,additionalKeyValues:s,alreadyAppliedFilters:f}),n("endobj"),"smask"in e){var $="/Predictor "+e.p+" /Colors 1 /BitsPerComponent "+e.bpc+" /Columns "+e.w,_={w:e.w,h:e.h,cs:"DeviceGray",bpc:e.bpc,dp:$,data:e.smask};"f"in e&&(_.f=e.f),t.call(this,_)}e.cs===this.color_spaces.INDEXED&&(this.internal.newObject(),a({data:this.arrayBufferToBinaryString(new Uint8Array(e.pal))}),n("endobj"))},i=function(){var t=this.internal.collections.addImage_images;for(var e in t)a.call(this,t[e])},o=function(){var t,e=this.internal.collections.addImage_images,r=this.internal.write;for(var n in e)t=e[n],r("/I"+t.i,t.n,"0","R")},s=function(e){return e&&"string"==typeof e&&(e=e.toUpperCase()),e in t.image_compression?e:t.image_compression.NONE},c=function(){var t=this.internal.collections.addImage_images;return t||(this.internal.collections.addImage_images=t={},this.internal.events.subscribe("putResources",i),this.internal.events.subscribe("putXobjectDict",o)),t},l=function(t){var e=0;return t&&(e=Object.keys?Object.keys(t).length:function(t){var e=0;for(var r in t)t.hasOwnProperty(r)&&e++;return e}(t)),e},u=function(t){return void 0===t||null===t||0===t.length},f=function(e){return"string"==typeof e?t.sHashCode(e):t.isArrayBufferView(e)?t.sHashCode(t.arrayBufferToBinaryString(e)):null},$=function(e){return"function"==typeof t["process"+e.toUpperCase()]},_=function(t){return"object"===n(t)&&1===t.nodeType},d=function(e,r){if("IMG"===e.nodeName&&e.hasAttribute("src")){var n=""+e.getAttribute("src");if(0===n.indexOf("data:image/"))return unescape(n);var a=t.loadFile(n);if(void 0!==a)return btoa(a)}if("CANVAS"===e.nodeName){var i=e;return e.toDataURL("image/jpeg",1)}var i=document.createElement("canvas");i.width=e.clientWidth||e.width,i.height=e.clientHeight||e.height;var o=i.getContext("2d");if(!o)throw"addImage requires canvas to be supported by browser.";return o.drawImage(e,0,0,i.width,i.height),i.toDataURL("png"==(""+r).toLowerCase()?"image/png":"image/jpeg")},p=function(t,e){var r;if(e)for(var n in e)if(t===e[n].alias){r=e[n];break}return r},h=function(t,e,r){return t||e||(t=-96,e=-96),t<0&&(t=-1*r.w*72/t/this.internal.scaleFactor),e<0&&(e=-1*r.h*72/e/this.internal.scaleFactor),0===t&&(t=e*r.w/r.h),0===e&&(e=t*r.h/r.w),[t,e]},g=function(t,e,r,n,a,i,o,s){var c=h.call(this,r,n,a),l=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString;if(r=c[0],n=c[1],o[i]=a,s){s*=Math.PI/180;var f=Math.cos(s),$=Math.sin(s),_=function(t){return t.toFixed(4)},d=[_(f),_($),_(-1*$),_(f),0,0,"cm"]}this.internal.write("q"),s?(this.internal.write([1,"0","0",1,l(t),u(e+n),"cm"].join(" ")),this.internal.write(d.join(" ")),this.internal.write([l(r),"0","0",l(n),"0","0","cm"].join(" "))):this.internal.write([l(r),"0","0",l(n),l(t),u(e+n),"cm"].join(" ")),this.internal.write("/I"+a.i+" Do"),this.internal.write("Q")};t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"},t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"},t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},t.sHashCode=function(t){t=t||"";var e,r,n=0;if(0===t.length)return n;for(e=0;e<t.length;e++)r=t.charCodeAt(e),n=(n<<5)-n+r,n|=0;return n},t.isString=function(t){return"string"==typeof t},t.validateStringAsBase64=function(t){t=t||"",t.toString().trim();var e=!0;return 0===t.length&&(e=!1),t.length%4!=0&&(e=!1),!1===/^[A-Za-z0-9+\/]+$/.test(t.substr(0,t.length-2))&&(e=!1),!1===/^[A-Za-z0-9\/][A-Za-z0-9+\/]|[A-Za-z0-9+\/]=|==$/.test(t.substr(-2))&&(e=!1),e},t.extractInfoFromBase64DataURI=function(t){return/^data:([\w]+?\/([\w]+?));\S*;*base64,(.+)$/g.exec(t)},t.extractImageFromDataUrl=function(t){t=t||"";var e=t.split("base64,"),r=null;if(2===e.length){var n=/^data:(\w*\/\w*);*(charset=[\w=-]*)*;*$/.exec(e[0]);Array.isArray(n)&&(r={mimeType:n[1],charset:n[2],data:e[1]})}return r},t.supportsArrayBuffer=function(){return"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array},t.isArrayBuffer=function(t){return!!this.supportsArrayBuffer()&&t instanceof ArrayBuffer},t.isArrayBufferView=function(t){return!!this.supportsArrayBuffer()&&("undefined"!=typeof Uint32Array&&(t instanceof Int8Array||t instanceof Uint8Array||"undefined"!=typeof Uint8ClampedArray&&t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array||t instanceof Float64Array))},t.binaryStringToUint8Array=function(t){for(var e=t.length,r=new Uint8Array(e),n=0;n<e;n++)r[n]=t.charCodeAt(n);return r},t.arrayBufferToBinaryString=function(t){if("function"==typeof atob)return atob(this.arrayBufferToBase64(t))},t.arrayBufferToBase64=function(t){for(var e,r,n,a,i,o="",s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c=new Uint8Array(t),l=c.byteLength,u=l%3,f=l-u,$=0;$<f;$+=3)i=c[$]<<16|c[$+1]<<8|c[$+2],e=(16515072&i)>>18,r=(258048&i)>>12,n=(4032&i)>>6,a=63&i,o+=s[e]+s[r]+s[n]+s[a];return 1==u?(i=c[f],e=(252&i)>>2,r=(3&i)<<4,o+=s[e]+s[r]+"=="):2==u&&(i=c[f]<<8|c[f+1],e=(64512&i)>>10,r=(1008&i)>>4,n=(15&i)<<2,o+=s[e]+s[r]+s[n]+"="),o},t.createImageInfo=function(t,e,r,n,a,i,o,s,c,l,u,f,$){var _={alias:s,w:e,h:r,cs:n,bpc:a,i:o,data:t};return i&&(_.f=i),c&&(_.dp=c),l&&(_.trns=l),u&&(_.pal=u),f&&(_.smask=f),$&&(_.p=$),_},t.addImage=function(e,r,a,i,o,h,m,v,y){var b="";if("string"!=typeof r){var w=h;h=o,o=i,i=a,a=r,r=w}if("object"===n(e)&&!_(e)&&"imageData"in e){var x=e;e=x.imageData,r=x.format||r||"UNKNOWN",a=x.x||a||0,i=x.y||i||0,o=x.w||o,h=x.h||h,m=x.alias||m,v=x.compression||v,y=x.rotation||x.angle||y}var A=this.internal.getFilters();if(void 0===v&&-1!==A.indexOf("FlateEncode")&&(v="SLOW"),"string"==typeof e&&(e=unescape(e)),isNaN(a)||isNaN(i))throw console.error("jsPDF.addImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addImage");var k,E,S=c.call(this);if(!((k=p(e,S))||(_(e)&&(e=d(e,r)),u(m)&&(m=f(e)),k=p(m,S)))){if(this.isString(e)&&(b=this.convertStringToImageData(e),""!==b?e=b:void 0!==(b=t.loadFile(e))&&(e=b)),r=this.getImageFileTypeByImageData(e,r),!$(r))throw new Error("addImage does not support files of type '"+r+"', please ensure that a plugin for '"+r+"' support is added.");if(this.supportsArrayBuffer()&&(e instanceof Uint8Array||(E=e,e=this.binaryStringToUint8Array(e))),!(k=this["process"+r.toUpperCase()](e,l(S),m,s(v),E)))throw new Error("An unknown error occurred whilst processing the image")}return g.call(this,a,i,o,h,k,k.i,S,y),this},t.convertStringToImageData=function(e){var r,n,a="";if(this.isString(e)){var r=this.extractImageFromDataUrl(e);n=null!==r?r.data:e;try{a=atob(n)}catch(e){throw t.validateStringAsBase64(n)?new Error("atob-Error in jsPDF.convertStringToImageData "+e.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertStringToImageData ")}}return a};var m=function(t){var e,n,a;if("JPEG"!==r(t))throw new Error("getJpegSize requires a binary string jpeg file");for(var i=256*t.charCodeAt(4)+t.charCodeAt(5),o=4,s=t.length;o<s;){if(o+=i,255!==t.charCodeAt(o))throw new Error("getJpegSize could not find the size of the image");if(192===t.charCodeAt(o+1)||193===t.charCodeAt(o+1)||194===t.charCodeAt(o+1)||195===t.charCodeAt(o+1)||196===t.charCodeAt(o+1)||197===t.charCodeAt(o+1)||198===t.charCodeAt(o+1)||199===t.charCodeAt(o+1))return n=256*t.charCodeAt(o+5)+t.charCodeAt(o+6),e=256*t.charCodeAt(o+7)+t.charCodeAt(o+8),a=t.charCodeAt(o+9),[e,n,a];o+=2,i=256*t.charCodeAt(o)+t.charCodeAt(o+1)}},v=function(t){if(65496!=(t[0]<<8|t[1]))throw new Error("Supplied data is not a JPEG");for(var e,r,n,a,i=t.length,o=(t[4]<<8)+t[5],s=4;s<i;){if(s+=o,e=y(t,s),o=(e[2]<<8)+e[3],(192===e[1]||194===e[1])&&255===e[0]&&o>7)return e=y(t,s+5),r=(e[2]<<8)+e[3],n=(e[0]<<8)+e[1],a=e[4],{width:r,height:n,numcomponents:a};s+=2}throw new Error("getJpegSizeFromBytes could not find the size of the image")},y=function(t,e){return t.subarray(e,e+5)};t.processJPEG=function(t,e,r,n,a,i){var o,s=this.decode.DCT_DECODE;if(!this.isString(t)&&!this.isArrayBuffer(t)&&!this.isArrayBufferView(t))return null;if(this.isString(t)&&(o=m(t)),this.isArrayBuffer(t)&&(t=new Uint8Array(t)),this.isArrayBufferView(t)&&(o=v(t),t=a||this.arrayBufferToBinaryString(t)),void 0===i)switch(o.numcomponents){case 1:i=this.color_spaces.DEVICE_GRAY;break;case 4:i=this.color_spaces.DEVICE_CMYK;break;default:case 3:i=this.color_spaces.DEVICE_RGB}return this.createImageInfo(t,o.width,o.height,i,8,s,e,r)},t.processJPG=function(){return this.processJPEG.apply(this,arguments)},t.getImageProperties=function(e){var r,n,a="";if(_(e)&&(e=d(e)),this.isString(e)&&(a=this.convertStringToImageData(e),""!==a?e=a:void 0!==(a=t.loadFile(e))&&(e=a)),n=this.getImageFileTypeByImageData(e),!$(n))throw new Error("addImage does not support files of type '"+n+"', please ensure that a plugin for '"+n+"' support is added.");if(this.supportsArrayBuffer()&&(e instanceof Uint8Array||(e=this.binaryStringToUint8Array(e))),!(r=this["process"+n.toUpperCase()](e)))throw new Error("An unknown error occurred whilst processing the image");return{fileType:n,width:r.w,height:r.h,colorSpace:r.cs,compressionMode:r.f,bitsPerComponent:r.bpc}}}(c.API),function(t){c.API.events.push(["addPage",function(t){this.internal.getPageInfo(t.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(t){for(var e=this.internal.getPageInfoByObjId(t.objId),r=t.pageContext.annotations,n=function(t){if(void 0!==t&&""!=t)return!0},a=!1,i=0;i<r.length&&!a;i++){var o=r[i];switch(o.type){case"link":if(n(o.options.url)||n(o.options.pageNumber)){a=!0;break}case"reference":case"text":case"freetext":a=!0}}if(0!=a){this.internal.write("/Annots [");for(var s=(this.internal.pageSize.height,this.internal.getCoordinateString),c=this.internal.getVerticalCoordinateString,i=0;i<r.length;i++){var o=r[i];switch(o.type){case"reference":this.internal.write(" "+o.object.objId+" 0 R ");break;case"text":var l=this.internal.newAdditionalObject(),u=this.internal.newAdditionalObject(),f=o.title||"Note",$="/Rect ["+s(o.bounds.x)+" "+c(o.bounds.y+o.bounds.h)+" "+s(o.bounds.x+o.bounds.w)+" "+c(o.bounds.y)+"] ";h="<</Type /Annot /Subtype /Text "+$+"/Contents ("+o.contents+")",h+=" /Popup "+u.objId+" 0 R",h+=" /P "+e.objId+" 0 R",h+=" /T ("+f+") >>",l.content=h;var _=l.objId+" 0 R",$="/Rect ["+s(o.bounds.x+30)+" "+c(o.bounds.y+o.bounds.h)+" "+s(o.bounds.x+o.bounds.w+30)+" "+c(o.bounds.y)+"] ";h="<</Type /Annot /Subtype /Popup "+$+" /Parent "+_,o.open&&(h+=" /Open true"),h+=" >>",u.content=h,this.internal.write(l.objId,"0 R",u.objId,"0 R");break;case"freetext":var $="/Rect ["+s(o.bounds.x)+" "+c(o.bounds.y)+" "+s(o.bounds.x+o.bounds.w)+" "+c(o.bounds.y+o.bounds.h)+"] ",d=o.color||"#000000";h="<</Type /Annot /Subtype /FreeText "+$+"/Contents ("+o.contents+")",h+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+d+")",h+=" /Border [0 0 0]",h+=" >>",this.internal.write(h);break;case"link":if(o.options.name){var p=this.annotations._nameMap[o.options.name];o.options.pageNumber=p.page,o.options.top=p.y}else o.options.top||(o.options.top=0);var $="/Rect ["+s(o.x)+" "+c(o.y)+" "+s(o.x+o.w)+" "+c(o.y+o.h)+"] ",h="";if(o.options.url)h="<</Type /Annot /Subtype /Link "+$+"/Border [0 0 0] /A <</S /URI /URI ("+o.options.url+") >>";else if(o.options.pageNumber){var g=this.internal.getPageInfo(o.options.pageNumber);switch(h="<</Type /Annot /Subtype /Link "+$+"/Border [0 0 0] /Dest ["+g.objId+" 0 R",o.options.magFactor=o.options.magFactor||"XYZ",o.options.magFactor){case"Fit":h+=" /Fit]";break;case"FitH":h+=" /FitH "+o.options.top+"]";break;case"FitV":o.options.left=o.options.left||0,h+=" /FitV "+o.options.left+"]";break;case"XYZ":default:var m=c(o.options.top);o.options.left=o.options.left||0,void 0===o.options.zoom&&(o.options.zoom=0),h+=" /XYZ "+o.options.left+" "+m+" "+o.options.zoom+"]"}}""!=h&&(h+=" >>",this.internal.write(h))}}this.internal.write("]")}}]),t.createAnnotation=function(t){var e=this.internal.getCurrentPageInfo();switch(t.type){case"link":this.link(t.bounds.x,t.bounds.y,t.bounds.w,t.bounds.h,t);break;case"text":case"freetext":e.pageContext.annotations.push(t)}},t.link=function(t,e,r,n,a){this.internal.getCurrentPageInfo().pageContext.annotations.push({x:t,y:e,w:r,h:n,options:a,type:"link"})},t.textWithLink=function(t,e,r,n){var a=this.getTextWidth(t),i=this.internal.getLineHeight()/this.internal.scaleFactor;return this.text(t,e,r),r+=.2*i,this.link(e,r-i,a,i,n),a},t.getTextWidth=function(t){var e=this.internal.getFontSize();return this.getStringUnitWidth(t)*e/this.internal.scaleFactor}}(c.API),function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},a=[1570,1571,1573,1575];t.__arabicParser__={};var i=t.__arabicParser__.isInArabicSubstitutionA=function(t){return void 0!==e[t.charCodeAt(0)]},o=t.__arabicParser__.isArabicLetter=function(t){return"string"==typeof t&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(t)},s=t.__arabicParser__.isArabicEndLetter=function(t){return o(t)&&i(t)&&e[t.charCodeAt(0)].length<=2},c=t.__arabicParser__.isArabicAlfLetter=function(t){return o(t)&&a.indexOf(t.charCodeAt(0))>=0},l=(t.__arabicParser__.arabicLetterHasIsolatedForm=function(t){
return o(t)&&i(t)&&e[t.charCodeAt(0)].length>=1},t.__arabicParser__.arabicLetterHasFinalForm=function(t){return o(t)&&i(t)&&e[t.charCodeAt(0)].length>=2}),u=(t.__arabicParser__.arabicLetterHasInitialForm=function(t){return o(t)&&i(t)&&e[t.charCodeAt(0)].length>=3},t.__arabicParser__.arabicLetterHasMedialForm=function(t){return o(t)&&i(t)&&4==e[t.charCodeAt(0)].length}),f=t.__arabicParser__.resolveLigatures=function(t){var e=0,n=r,a=0,i="",o=0;for(e=0;e<t.length;e+=1)void 0!==n[t.charCodeAt(e)]?(o++,n=n[t.charCodeAt(e)],"number"==typeof n&&(a=$(t.charAt(e),t.charAt(e-o),t.charAt(e+1)),a=-1!==a?a:0,i+=String.fromCharCode(n),n=r,o=0),e===t.length-1&&(n=r,i+=t.charAt(e-(o-1)),e-=o-1,o=0)):(n=r,i+=t.charAt(e-o),e-=o,o=0);return i},$=(t.__arabicParser__.isArabicDiacritic=function(t){return void 0!==t&&void 0!==n[t.charCodeAt(0)]},t.__arabicParser__.getCorrectForm=function(t,e,r){return o(t)?!1===i(t)?-1:!l(t)||!o(e)&&!o(r)||!o(r)&&s(e)||s(t)&&!o(e)||s(t)&&c(e)||s(t)&&s(e)?0:u(t)&&o(e)&&!s(e)&&o(r)&&l(r)?3:s(t)||!o(r)?1:2:-1}),_=t.__arabicParser__.processArabic=t.processArabic=function(t){t=t||"";var r=0,n=0,a=0,i="",s="",c="",l=t.split("\\s+"),u=[];for(r=0;r<l.length;r+=1){for(u.push(""),n=0;n<l[r].length;n+=1)i=l[r][n],s=l[r][n-1],c=l[r][n+1],o(i)?(a=$(i,s,c),u[r]+=-1!==a?String.fromCharCode(e[i.charCodeAt(0)][a]):i):u[r]+=i;u[r]=f(u[r])}return u.join(" ")},d=function(t){var e=t.text,r=(t.x,t.y,t.options,t.mutex,[]);if("[object Array]"===Object.prototype.toString.call(e)){var n=0;for(r=[],n=0;n<e.length;n+=1)"[object Array]"===Object.prototype.toString.call(e[n])?r.push([_(e[n][0]),e[n][1],e[n][2]]):r.push([_(e[n])]);t.text=r}else t.text=_(e)};t.events.push(["preProcessText",d])}(c.API),function(t){t.autoPrint=function(t){var e;switch(t=t||{},t.variant=t.variant||"non-conform",t.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})}return this}}(c.API),function(t){var e=function(){var t=void 0;Object.defineProperty(this,"pdf",{get:function(){return t},set:function(e){t=e}});var e=150;Object.defineProperty(this,"width",{get:function(){return e},set:function(t){e=isNaN(t)||!1===Number.isInteger(t)||t<0?150:t,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=e+1)}});var r=300;Object.defineProperty(this,"height",{get:function(){return r},set:function(t){r=isNaN(t)||!1===Number.isInteger(t)||t<0?300:t,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=r+1)}});var n=[];Object.defineProperty(this,"childNodes",{get:function(){return n},set:function(t){n=t}});var a={};Object.defineProperty(this,"style",{get:function(){return a},set:function(t){a=t}}),Object.defineProperty(this,"parentNode",{get:function(){return!1}})};e.prototype.getContext=function(t,e){t=t||"2d";var r;if("2d"!==t)return null;for(r in e)this.pdf.context2d.hasOwnProperty(r)&&(this.pdf.context2d[r]=e[r]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])}(c.API),function(t){var e,r={x:void 0,y:void 0,w:void 0,h:void 0,ln:void 0},n=1,a=function(t,e,n,a,i){r={x:t,y:e,w:n,h:a,ln:i}},i=function(){return r},o={left:0,top:0,bottom:0};t.setHeaderFunction=function(t){e=t},t.getTextDimensions=function(t,e){var r=this.table_font_size||this.internal.getFontSize();this.internal.getFont().fontStyle;e=e||{};var n=e.scaleFactor||this.internal.scaleFactor,a=0,i=0,o=0,s=0;if("string"==typeof t)0!==(a=this.getStringUnitWidth(t)*r)&&(i=1);else{if("[object Array]"!==Object.prototype.toString.call(t))throw new Error("getTextDimensions expects text-parameter to be of type String or an Array of Strings.");for(var c=0;c<t.length;c++)s=this.getStringUnitWidth(t[c])*r,a<s&&(a=s);0!==a&&(i=t.length)}return a/=n,o=Math.max((i*r*this.getLineHeightFactor()-r*(this.getLineHeightFactor()-1))/n,0),{w:a,h:o}},t.cellAddPage=function(){var t=this.margins||o;this.addPage(),a(t.left,t.top,void 0,void 0),n+=1},t.cellInitialize=function(){r={x:void 0,y:void 0,w:void 0,h:void 0,ln:void 0},n=1},t.cell=function(t,e,r,n,s,c,l){var u=i(),f=!1;if(void 0!==u.ln)if(u.ln===c)t=u.x+u.w,e=u.y;else{var $=this.margins||o;u.y+u.h+n+13>=this.internal.pageSize.getHeight()-$.bottom&&(this.cellAddPage(),f=!0,this.printHeaders&&this.tableHeaderRow&&this.printHeaderRow(c,!0)),e=i().y+i().h,f&&(e=23)}if(void 0!==s[0])if(this.printingHeaderRow?this.rect(t,e,r,n,"FD"):this.rect(t,e,r,n),"right"===l){s instanceof Array||(s=[s]);for(var _=0;_<s.length;_++){var d=s[_],p=this.getStringUnitWidth(d)*this.internal.getFontSize();this.text(d,t+r-p-3,e+this.internal.getLineHeight()*(_+1))}}else this.text(s,t+3,e+this.internal.getLineHeight());return a(t,e,r,n,c),this},t.arrayMax=function(t,e){var r,n,a,i=t[0];for(r=0,n=t.length;r<n;r+=1)a=t[r],e?-1===e(i,a)&&(i=a):a>i&&(i=a);return i},t.table=function(e,a,i,s,c){if(!i)throw"No data for PDF table";var l,u,f,$,_,d,p,h,g,m,v=[],y=[],b={},w={},x=[],A=[],k=!1,E=!0,S=12,N=o;if(N.width=this.internal.pageSize.getWidth(),c&&(!0===c.autoSize&&(k=!0),!1===c.printHeaders&&(E=!1),c.fontSize&&(S=c.fontSize),c.css&&void 0!==c.css["font-size"]&&(S=16*c.css["font-size"]),c.margins&&(N=c.margins)),this.lnMod=0,r={x:void 0,y:void 0,w:void 0,h:void 0,ln:void 0},n=1,this.printHeaders=E,this.margins=N,this.setFontSize(S),this.table_font_size=S,void 0===s||null===s)v=Object.keys(i[0]);else if(s[0]&&"string"!=typeof s[0]){for(u=0,f=s.length;u<f;u+=1)l=s[u],v.push(l.name),y.push(l.prompt),w[l.name]=l.width*(19.049976/25.4)}else v=s;if(k)for(m=function(t){return t[l]},u=0,f=v.length;u<f;u+=1){for(l=v[u],b[l]=i.map(m),x.push(this.getTextDimensions(y[u]||l,{scaleFactor:1}).w),d=b[l],p=0,$=d.length;p<$;p+=1)_=d[p],x.push(this.getTextDimensions(_,{scaleFactor:1}).w);w[l]=t.arrayMax(x),x=[]}if(E){var C=this.calculateLineHeight(v,w,y.length?y:v);for(u=0,f=v.length;u<f;u+=1)l=v[u],A.push([e,a,w[l],C,String(y.length?y[u]:l)]);this.setTableHeaderRow(A),this.printHeaderRow(1,!1)}for(u=0,f=i.length;u<f;u+=1){var C;for(h=i[u],C=this.calculateLineHeight(v,w,h),p=0,g=v.length;p<g;p+=1)l=v[p],this.cell(e,a,w[l],C,h[l],u+2,l.align)}return this.lastCellPos=r,this.table_x=e,this.table_y=a,this},t.calculateLineHeight=function(t,e,r){for(var n,a=0,i=0;i<t.length;i++){n=t[i],r[n]=this.splitTextToSize(String(r[n]),e[n]-3);var o=this.internal.getLineHeight()*r[n].length+3;o>a&&(a=o)}return a},t.setTableHeaderRow=function(t){this.tableHeaderRow=t},t.printHeaderRow=function(t,r){if(!this.tableHeaderRow)throw"Property tableHeaderRow does not exist.";var i,o,s,c;if(this.printingHeaderRow=!0,void 0!==e){var l=e(this,n);a(l[0],l[1],l[2],l[3],-1)}this.setFontStyle("bold");var u=[];for(s=0,c=this.tableHeaderRow.length;s<c;s+=1)this.setFillColor(200,200,200),i=this.tableHeaderRow[s],r&&(this.margins.top=13,i[1]=this.margins&&this.margins.top||0,u.push(i)),o=[].concat(i),this.cell.apply(this,o.concat(t));u.length>0&&this.setTableHeaderRow(u),this.setFontStyle("normal"),this.printingHeaderRow=!1}}(c.API),function(t,e){var r,a,i,o,s,c,l=function(t){return t=t||{},this.isStrokeTransparent=t.isStrokeTransparent||!1,this.strokeOpacity=t.strokeOpacity||1,this.strokeStyle=t.strokeStyle||"#000000",this.fillStyle=t.fillStyle||"#000000",this.isFillTransparent=t.isFillTransparent||!1,this.fillOpacity=t.fillOpacity||1,this.font=t.font||"10px sans-serif",this.textBaseline=t.textBaseline||"alphabetic",this.textAlign=t.textAlign||"left",this.lineWidth=t.lineWidth||1,this.lineJoin=t.lineJoin||"miter",this.lineCap=t.lineCap||"butt",this.path=t.path||[],this.transform=void 0!==t.transform?t.transform.clone():new B,this.globalCompositeOperation=t.globalCompositeOperation||"normal",this.globalAlpha=t.globalAlpha||1,this.clip_path=t.clip_path||[],this.currentPoint=t.currentPoint||new M,this.miterLimit=t.miterLimit||10,this.lastPoint=t.lastPoint||new M,this.ignoreClearRect="boolean"!=typeof t.ignoreClearRect||t.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new u(this),r=this.internal.f2,a=this.internal.f3,i=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,s=this.internal.getHorizontalCoordinate,c=this.internal.getVerticalCoordinate}]);var u=function(t){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}}),Object.defineProperty(this,"pdf",{get:function(){return t}});var e=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return e},set:function(t){e=Boolean(t)}});var r=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return r},set:function(t){r=Boolean(t)}});var n=0;Object.defineProperty(this,"posX",{get:function(){return n},set:function(t){isNaN(t)||(n=t)}});var a=0;Object.defineProperty(this,"posY",{get:function(){return a},set:function(t){isNaN(t)||(a=t)}});var i=!1;Object.defineProperty(this,"autoPaging",{get:function(){return i},set:function(t){i=Boolean(t)}});var o=0;Object.defineProperty(this,"lastBreak",{get:function(){return o},set:function(t){o=t}});var s=[];Object.defineProperty(this,"pageBreaks",{get:function(){return s},set:function(t){s=t}});var c=new l;Object.defineProperty(this,"ctx",{get:function(){return c},set:function(t){t instanceof l&&(c=t)}}),Object.defineProperty(this,"path",{get:function(){return c.path},set:function(t){c.path=t}});var u=[];Object.defineProperty(this,"ctxStack",{get:function(){return u},set:function(t){u=t}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(t){var e;e=f(t),this.ctx.fillStyle=e.style,this.ctx.isFillTransparent=0===e.a,this.ctx.fillOpacity=e.a,this.pdf.setFillColor(e.r,e.g,e.b,{a:e.a}),this.pdf.setTextColor(e.r,e.g,e.b,{a:e.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(t){var e=f(t);this.ctx.strokeStyle=e.style,this.ctx.isStrokeTransparent=0===e.a,this.ctx.strokeOpacity=e.a,0===e.a?this.pdf.setDrawColor(255,255,255):(e.a,this.pdf.setDrawColor(e.r,e.g,e.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(t){-1!==["butt","round","square"].indexOf(t)&&(this.ctx.lineCap=t,this.pdf.setLineCap(t))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(t){isNaN(t)||(this.ctx.lineWidth=t,this.pdf.setLineWidth(t))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(t){-1!==["bevel","round","miter"].indexOf(t)&&(this.ctx.lineJoin=t,this.pdf.setLineJoin(t))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(t){isNaN(t)||(this.ctx.miterLimit=t,this.pdf.setMiterLimit(t))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(t){this.ctx.textBaseline=t}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(t){-1!==["right","end","center","left","start"].indexOf(t)&&(this.ctx.textAlign=t)}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(t){this.ctx.font=t;var e,r;if(e=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i,null!==(r=e.exec(t))){var n=r[1],a=(r[2],r[3]),i=r[4],o=r[5],s=r[6];i="px"===o?Math.floor(parseFloat(i)):"em"===o?Math.floor(parseFloat(i)*this.pdf.getFontSize()):Math.floor(parseFloat(i)),this.pdf.setFontSize(i);var c="";("bold"===a||parseInt(a,10)>=700||"bold"===n)&&(c="bold"),"italic"===n&&(c+="italic"),0===c.length&&(c="normal");for(var l="",u=s.toLowerCase().replace(/"|'/g,"").split(/\s*,\s*/),f={arial:"Helvetica",verdana:"Helvetica",helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",courier:"Courier",times:"Times",cursive:"Times",fantasy:"Times",serif:"Times"},$=0;$<u.length;$++){if(void 0!==this.pdf.internal.getFont(u[$],c,{noFallback:!0,disableWarning:!0})){l=u[$];break}if("bolditalic"===c&&void 0!==this.pdf.internal.getFont(u[$],"bold",{noFallback:!0,disableWarning:!0}))l=u[$],c="bold";else if(void 0!==this.pdf.internal.getFont(u[$],"normal",{noFallback:!0,disableWarning:!0})){l=u[$],c="normal";break}}if(""===l)for(var $=0;$<u.length;$++)if(f[u[$]]){l=f[u[$]];break}l=""===l?"Times":l,this.pdf.setFont(l,c)}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(t){this.ctx.globalCompositeOperation=t}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(t){this.ctx.globalAlpha=t}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(t){this.ctx.ignoreClearRect=Boolean(t)}})};u.prototype.fill=function(){g.call(this,"fill",!1)},u.prototype.stroke=function(){g.call(this,"stroke",!1)},u.prototype.beginPath=function(){this.path=[{type:"begin"}]},u.prototype.moveTo=function(t,e){if(isNaN(t)||isNaN(e))throw console.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var r=this.ctx.transform.applyToPoint(new M(t,e));this.path.push({type:"mt",x:r.x,y:r.y}),this.ctx.lastPoint=new M(t,e)},u.prototype.closePath=function(){var t=new M(0,0),e=0;for(e=this.path.length-1;-1!==e;e--)if("begin"===this.path[e].type&&"object"===n(this.path[e+1])&&"number"==typeof this.path[e+1].x){t=new M(this.path[e+1].x,this.path[e+1].y),this.path.push({type:"lt",x:t.x,y:t.y});break}"object"===n(this.path[e+2])&&"number"==typeof this.path[e+2].x&&this.path.push(JSON.parse(JSON.stringify(this.path[e+2]))),this.path.push({type:"close"}),this.ctx.lastPoint=new M(t.x,t.y)},u.prototype.lineTo=function(t,e){if(isNaN(t)||isNaN(e))throw console.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var r=this.ctx.transform.applyToPoint(new M(t,e));this.path.push({type:"lt",x:r.x,y:r.y}),this.ctx.lastPoint=new M(r.x,r.y)},u.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),g.call(this,null,!0)},u.prototype.quadraticCurveTo=function(t,e,r,n){if(isNaN(r)||isNaN(n)||isNaN(t)||isNaN(e))throw console.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var a=this.ctx.transform.applyToPoint(new M(r,n)),i=this.ctx.transform.applyToPoint(new M(t,e));this.path.push({type:"qct",x1:i.x,y1:i.y,x:a.x,y:a.y}),this.ctx.lastPoint=new M(a.x,a.y)},u.prototype.bezierCurveTo=function(t,e,r,n,a,i){if(isNaN(a)||isNaN(i)||isNaN(t)||isNaN(e)||isNaN(r)||isNaN(n))throw console.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var o=this.ctx.transform.applyToPoint(new M(a,i)),s=this.ctx.transform.applyToPoint(new M(t,e)),c=this.ctx.transform.applyToPoint(new M(r,n));this.path.push({type:"bct",x1:s.x,y1:s.y,x2:c.x,y2:c.y,x:o.x,y:o.y}),this.ctx.lastPoint=new M(o.x,o.y)},u.prototype.arc=function(t,e,r,n,a,i){if(isNaN(t)||isNaN(e)||isNaN(r)||isNaN(n)||isNaN(a))throw console.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(i=Boolean(i),!this.ctx.transform.isIdentity){var o=this.ctx.transform.applyToPoint(new M(t,e));t=o.x,e=o.y;var s=this.ctx.transform.applyToPoint(new M(0,r)),c=this.ctx.transform.applyToPoint(new M(0,0));r=Math.sqrt(Math.pow(s.x-c.x,2)+Math.pow(s.y-c.y,2))}Math.abs(a-n)>=2*Math.PI&&(n=0,a=2*Math.PI),this.path.push({type:"arc",x:t,y:e,radius:r,startAngle:n,endAngle:a,counterclockwise:i})},u.prototype.arcTo=function(t,e,r,n,a){throw new Error("arcTo not implemented.")},u.prototype.rect=function(t,e,r,n){if(isNaN(t)||isNaN(e)||isNaN(r)||isNaN(n))throw console.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(t,e),this.lineTo(t+r,e),this.lineTo(t+r,e+n),this.lineTo(t,e+n),this.lineTo(t,e),this.lineTo(t+r,e),this.lineTo(t,e)},u.prototype.fillRect=function(t,e,r,n){if(isNaN(t)||isNaN(e)||isNaN(r)||isNaN(n))throw console.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!$.call(this)){var a={};"butt"!==this.lineCap&&(a.lineCap=this.lineCap,this.lineCap="butt"),"miter"!==this.lineJoin&&(a.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(t,e,r,n),this.fill(),a.hasOwnProperty("lineCap")&&(this.lineCap=a.lineCap),a.hasOwnProperty("lineJoin")&&(this.lineJoin=a.lineJoin)}},u.prototype.strokeRect=function(t,e,r,n){if(isNaN(t)||isNaN(e)||isNaN(r)||isNaN(n))throw console.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");_.call(this)||(this.beginPath(),this.rect(t,e,r,n),this.stroke())},u.prototype.clearRect=function(t,e,r,n){if(isNaN(t)||isNaN(e)||isNaN(r)||isNaN(n))throw console.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(t,e,r,n))},u.prototype.save=function(t){t="boolean"!=typeof t||t;for(var e=this.pdf.internal.getCurrentPageInfo().pageNumber,r=0;r<this.pdf.internal.getNumberOfPages();r++)this.pdf.setPage(r+1),this.pdf.internal.out("q");if(this.pdf.setPage(e),t){this.ctx.fontSize=this.pdf.internal.getFontSize();var n=new l(this.ctx);this.ctxStack.push(this.ctx),this.ctx=n}},u.prototype.restore=function(t){t="boolean"!=typeof t||t;for(var e=this.pdf.internal.getCurrentPageInfo().pageNumber,r=0;r<this.pdf.internal.getNumberOfPages();r++)this.pdf.setPage(r+1),this.pdf.internal.out("Q");this.pdf.setPage(e),t&&0!==this.ctxStack.length&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin)},u.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var f=function(t){var e,r,n,a,i=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,o=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d\.]+)\s*\)/,s=/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/;!0===t.isCanvasGradient&&(t=t.getColor());var c=new RGBColor(t);if(!t)return{r:0,g:0,b:0,a:0,style:t};if(s.test(t))e=0,r=0,n=0,a=0;else{var l=i.exec(t);null!==l?(e=parseInt(l[1]),r=parseInt(l[2]),n=parseInt(l[3]),a=1):(l=o.exec(t),null!==l?(e=parseInt(l[1]),r=parseInt(l[2]),n=parseInt(l[3]),a=parseFloat(l[4])):(a=1,"#"!==t.charAt(0)&&(t=c.ok?c.toHex():"#000000"),4===t.length?(e=t.substring(1,2),e+=e,r=t.substring(2,3),r+=r,n=t.substring(3,4),n+=n):(e=t.substring(1,3),r=t.substring(3,5),n=t.substring(5,7)),e=parseInt(e,16),r=parseInt(r,16),n=parseInt(n,16)))}return{r:e,g:r,b:n,a:a,style:t}},$=function(){return this.ctx.isFillTransparent||0==this.globalAlpha},_=function(){return Boolean(this.ctx.isStrokeTransparent||0==this.globalAlpha)};u.prototype.fillText=function(t,e,r,n){if(isNaN(e)||isNaN(r)||"string"!=typeof t)throw console.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(n=isNaN(n)?void 0:n,!$.call(this)){r=v.call(this,r);var a=I(this.ctx.transform.rotation),i=this.ctx.transform.scaleX;A.call(this,{text:t,x:e,y:r,scale:i,angle:a,align:this.textAlign,maxWidth:n})}},u.prototype.strokeText=function(t,e,r,n){if(isNaN(e)||isNaN(r)||"string"!=typeof t)throw console.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!_.call(this)){n=isNaN(n)?void 0:n,r=v.call(this,r);var a=I(this.ctx.transform.rotation),i=this.ctx.transform.scaleX;A.call(this,{text:t,x:e,y:r,scale:i,renderingMode:"stroke",angle:a,align:this.textAlign,maxWidth:n})}},u.prototype.measureText=function(t){if("string"!=typeof t)throw console.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var e=this.pdf,r=this.pdf.internal.scaleFactor,n=e.internal.getFontSize(),a=e.getStringUnitWidth(t)*n/e.internal.scaleFactor;return a*=Math.round(96*r/72*1e4)/1e4,new function(t){t=t||{};var e=t.width||0;return Object.defineProperty(this,"width",{get:function(){return e}}),this}({width:a})},u.prototype.scale=function(t,e){if(isNaN(t)||isNaN(e))throw console.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var r=new B(t,0,0,e,0,0);this.ctx.transform=this.ctx.transform.multiply(r)},u.prototype.rotate=function(t){if(isNaN(t))throw console.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var e=new B(Math.cos(t),Math.sin(t),-Math.sin(t),Math.cos(t),0,0);this.ctx.transform=this.ctx.transform.multiply(e)},u.prototype.translate=function(t,e){if(isNaN(t)||isNaN(e))throw console.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var r=new B(1,0,0,1,t,e);this.ctx.transform=this.ctx.transform.multiply(r)},u.prototype.transform=function(t,e,r,n,a,i){if(isNaN(t)||isNaN(e)||isNaN(r)||isNaN(n)||isNaN(a)||isNaN(i))throw console.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var o=new B(t,e,r,n,a,i);this.ctx.transform=this.ctx.transform.multiply(o)},u.prototype.setTransform=function(t,e,r,n,a,i){t=isNaN(t)?1:t,e=isNaN(e)?0:e,r=isNaN(r)?0:r,n=isNaN(n)?1:n,a=isNaN(a)?0:a,i=isNaN(i)?0:i,this.ctx.transform=new B(t,e,r,n,a,i)},u.prototype.drawImage=function(t,e,r,n,a,i,o,s,c){var l=this.pdf.getImageProperties(t),u=1,f=1,$=1,_=1;void 0!==n&&void 0!==s&&($=s/n,_=c/a,u=l.width/n*s/n,f=l.height/a*c/a),void 0===i&&(i=e,o=r,e=0,r=0),void 0!==n&&void 0===s&&(s=n,c=a),void 0===n&&void 0===s&&(s=l.width,c=l.height);var p=this.ctx.transform.decompose(),g=I(p.rotate.shx);p.scale.sx,p.scale.sy;var v=new B;v=v.multiply(p.translate),v=v.multiply(p.skew),v=v.multiply(p.scale);for(var y=(v.applyToPoint(new M(s,c)),v.applyToRectangle(new T(i-e*$,o-r*_,n*u,a*f))),b=d.call(this,y),w=[],x=0;x<b.length;x+=1)-1===w.indexOf(b[x])&&w.push(b[x]);w.sort();var A;if(this.autoPaging)for(var k=w[0],E=w[w.length-1],S=k;S<E+1;S++){if(this.pdf.setPage(S),0!==this.ctx.clip_path.length){var N=this.path;A=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=h(A,this.posX,-1*this.pdf.internal.pageSize.height*(S-1)+this.posY),m.call(this,"fill",!0),this.path=N}var C=JSON.parse(JSON.stringify(y));C=h([C],this.posX,-1*this.pdf.internal.pageSize.height*(S-1)+this.posY)[0],this.pdf.addImage(t,"jpg",C.x,C.y,C.w,C.h,null,null,g)}else this.pdf.addImage(t,"jpg",y.x,y.y,y.w,y.h,null,null,g)};var d=function(t,e,r){var n=[];switch(e=e||this.pdf.internal.pageSize.width,r=r||this.pdf.internal.pageSize.height,t.type){default:case"mt":case"lt":n.push(Math.floor((t.y+this.posY)/r)+1);break;case"arc":n.push(Math.floor((t.y+this.posY-t.radius)/r)+1),n.push(Math.floor((t.y+this.posY+t.radius)/r)+1);break;case"qct":var a=P(this.ctx.lastPoint.x,this.ctx.lastPoint.y,t.x1,t.y1,t.x,t.y);n.push(Math.floor(a.y/r)+1),n.push(Math.floor((a.y+a.h)/r)+1);break;case"bct":var i=L(this.ctx.lastPoint.x,this.ctx.lastPoint.y,t.x1,t.y1,t.x2,t.y2,t.x,t.y);n.push(Math.floor(i.y/r)+1),n.push(Math.floor((i.y+i.h)/r)+1);break;case"rect":n.push(Math.floor((t.y+this.posY)/r)+1),n.push(Math.floor((t.y+t.h+this.posY)/r)+1)}for(var o=0;o<n.length;o+=1)for(;this.pdf.internal.getNumberOfPages()<n[o];)p.call(this);return n},p=function(){var t=this.fillStyle,e=this.strokeStyle,r=this.font,n=this.lineCap,a=this.lineWidth,i=this.lineJoin;this.pdf.addPage(),this.fillStyle=t,this.strokeStyle=e,this.font=r,this.lineCap=n,this.lineWidth=a,this.lineJoin=i},h=function(t,e,r){for(var n=0;n<t.length;n++)switch(t[n].type){case"bct":t[n].x2+=e,t[n].y2+=r;case"qct":t[n].x1+=e,t[n].y1+=r;case"mt":case"lt":case"arc":default:t[n].x+=e,t[n].y+=r}return t},g=function(t,e){for(var r,n,a=this.fillStyle,i=this.strokeStyle,o=(this.font,this.lineCap),s=this.lineWidth,c=this.lineJoin,l=JSON.parse(JSON.stringify(this.path)),u=JSON.parse(JSON.stringify(this.path)),f=[],$=0;$<u.length;$++)if(void 0!==u[$].x)for(var _=d.call(this,u[$]),g=0;g<_.length;g+=1)-1===f.indexOf(_[g])&&f.push(_[g]);for(var $=0;$<f.length;$++)for(;this.pdf.internal.getNumberOfPages()<f[$];)p.call(this);if(f.sort(),this.autoPaging)for(var v=f[0],y=f[f.length-1],$=v;$<y+1;$++){if(this.pdf.setPage($),this.fillStyle=a,this.strokeStyle=i,this.lineCap=o,this.lineWidth=s,this.lineJoin=c,0!==this.ctx.clip_path.length){var b=this.path;r=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=h(r,this.posX,-1*this.pdf.internal.pageSize.height*($-1)+this.posY),m.call(this,t,!0),this.path=b}n=JSON.parse(JSON.stringify(l)),this.path=h(n,this.posX,-1*this.pdf.internal.pageSize.height*($-1)+this.posY),!1!==e&&0!==$||m.call(this,t,e)}else m.call(this,t,e);this.path=l},m=function(t,e){if(("stroke"!==t||e||!_.call(this))&&("stroke"===t||e||!$.call(this))){var r=[];this.ctx.globalAlpha;this.ctx.fillOpacity<1&&this.ctx.fillOpacity;for(var n=this.path,a=0;a<n.length;a++){var i=n[a];switch(i.type){case"begin":r.push({begin:!0});break;case"close":r.push({close:!0});break;case"mt":r.push({start:i,deltas:[],abs:[]});break;case"lt":var o=r.length;if(!isNaN(n[a-1].x)){var s=[i.x-n[a-1].x,i.y-n[a-1].y];if(o>0)for(o;o>=0;o--)if(!0!==r[o-1].close&&!0!==r[o-1].begin){r[o-1].deltas.push(s),r[o-1].abs.push(i);break}}break;case"bct":var s=[i.x1-n[a-1].x,i.y1-n[a-1].y,i.x2-n[a-1].x,i.y2-n[a-1].y,i.x-n[a-1].x,i.y-n[a-1].y];r[r.length-1].deltas.push(s);break;case"qct":var c=n[a-1].x+2/3*(i.x1-n[a-1].x),l=n[a-1].y+2/3*(i.y1-n[a-1].y),u=i.x+2/3*(i.x1-i.x),f=i.y+2/3*(i.y1-i.y),d=i.x,p=i.y,s=[c-n[a-1].x,l-n[a-1].y,u-n[a-1].x,f-n[a-1].y,d-n[a-1].x,p-n[a-1].y];r[r.length-1].deltas.push(s);break;case"arc":r.push({deltas:[],abs:[],arc:!0}),Array.isArray(r[r.length-1].abs)&&r[r.length-1].abs.push(i)}}var h;h=e?null:"stroke"===t?"stroke":"fill";for(var a=0;a<r.length;a++){if(r[a].arc)for(var g=r[a].abs,m=0;m<g.length;m++){var v=g[m];if(void 0!==v.startAngle){var x=I(v.startAngle),A=I(v.endAngle),S=v.x,N=v.y;y.call(this,S,N,v.radius,x,A,v.counterclockwise,h,e)}else k.call(this,v.x,v.y)}if(!r[a].arc&&!0!==r[a].close&&!0!==r[a].begin){var S=r[a].start.x,N=r[a].start.y;E.call(this,r[a].deltas,S,N,null,null)}}h&&b.call(this,h),e&&w.call(this)}},v=function(t){var e=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,r=e*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return t-r;case"top":return t+e-r;case"hanging":return t+e-2*r;case"middle":return t+e/2-r;case"ideographic":return t;case"alphabetic":default:return t}};u.prototype.createLinearGradient=function(){var t=function(){};return t.colorStops=[],t.addColorStop=function(t,e){this.colorStops.push([t,e])},t.getColor=function(){return 0===this.colorStops.length?"#000000":this.colorStops[0][1]},t.isCanvasGradient=!0,t},u.prototype.createPattern=function(){return this.createLinearGradient()},u.prototype.createRadialGradient=function(){return this.createLinearGradient()};var y=function(t,e,r,n,a,i,o,s){for(var c=(this.pdf.internal.scaleFactor,O(n)),l=O(a),u=N.call(this,r,c,l,i),f=0;f<u.length;f++){var $=u[f];0===f&&x.call(this,$.x1+t,$.y1+e),S.call(this,t,e,$.x2,$.y2,$.x3,$.y3,$.x4,$.y4)}s?w.call(this):b.call(this,o)},b=function(t){switch(t){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},w=function(){this.pdf.clip()},x=function(t,e){this.pdf.internal.out(i(t)+" "+o(e)+" m")},A=function(t){var e;switch(t.align){case"right":case"end":e="right";break;case"center":e="center";break;case"left":case"start":default:e="left"}var r=this.ctx.transform.applyToPoint(new M(t.x,t.y)),n=this.ctx.transform.decompose(),a=new B;a=a.multiply(n.translate),a=a.multiply(n.skew),a=a.multiply(n.scale);for(var i=this.pdf.getTextDimensions(t.text),o=this.ctx.transform.applyToRectangle(new T(t.x,t.y,i.w,i.h)),s=a.applyToRectangle(new T(t.x,t.y-i.h,i.w,i.h)),c=d.call(this,s),l=[],u=0;u<c.length;u+=1)-1===l.indexOf(c[u])&&l.push(c[u]);l.sort();var f;if(!0===this.autoPaging)for(var $=l[0],_=l[l.length-1],p=$;p<_+1;p++){if(this.pdf.setPage(p),0!==this.ctx.clip_path.length){var g=this.path;f=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=h(f,this.posX,-1*this.pdf.internal.pageSize.height*(p-1)+this.posY),m.call(this,"fill",!0),this.path=g}var v=JSON.parse(JSON.stringify(o));if(v=h([v],this.posX,-1*this.pdf.internal.pageSize.height*(p-1)+this.posY)[0],t.scale>=.01){var y=this.pdf.internal.getFontSize();this.pdf.setFontSize(y*t.scale)}this.pdf.text(t.text,v.x,v.y,{angle:t.angle,align:e,renderingMode:t.renderingMode,maxWidth:t.maxWidth}),t.scale>=.01&&this.pdf.setFontSize(y)}else{if(t.scale>=.01){var y=this.pdf.internal.getFontSize();this.pdf.setFontSize(y*t.scale)}this.pdf.text(t.text,r.x+this.posX,r.y+this.posY,{angle:t.angle,align:e,renderingMode:t.renderingMode,maxWidth:t.maxWidth}),t.scale>=.01&&this.pdf.setFontSize(y)}},k=function(t,e,r,n){r=r||0,n=n||0,this.pdf.internal.out(i(t+r)+" "+o(e+n)+" l")},E=function(t,e,r){return this.pdf.lines(t,e,r,null,null)},S=function(t,e,n,a,i,o,l,u){this.pdf.internal.out([r(s(n+t)),r(c(a+e)),r(s(i+t)),r(c(o+e)),r(s(l+t)),r(c(u+e)),"c"].join(" "))},N=function(t,e,r,n){var a=2*Math.PI,i=e;(i<a||i>a)&&(i%=a);var o=r;(o<a||o>a)&&(o%=a);for(var s=[],c=Math.PI/2,l=n?-1:1,u=e,f=Math.min(a,Math.abs(o-i));f>1e-5;){var $=u+l*Math.min(f,c);s.push(C.call(this,t,u,$)),f-=Math.abs($-u),u=$}return s},C=function(t,e,r){var n=(r-e)/2,a=t*Math.cos(n),i=t*Math.sin(n),o=a,s=-i,c=o*o+s*s,l=c+o*a+s*i,u=4/3*(Math.sqrt(2*c*l)-l)/(o*i-s*a),f=o-u*s,$=s+u*o,_=f,d=-$,p=n+e,h=Math.cos(p),g=Math.sin(p);return{x1:t*Math.cos(e),y1:t*Math.sin(e),x2:f*h-$*g,y2:f*g+$*h,x3:_*h-d*g,y3:_*g+d*h,x4:t*Math.cos(r),y4:t*Math.sin(r)}},I=function(t){return 180*t/Math.PI},O=function(t){return t*Math.PI/180},P=function(t,e,r,n,a,i){var o=t+.5*(r-t),s=e+.5*(n-e),c=a+.5*(r-a),l=i+.5*(n-i),u=Math.min(t,a,o,c),f=Math.max(t,a,o,c),$=Math.min(e,i,s,l),_=Math.max(e,i,s,l);return new T(u,$,f-u,_-$)},L=function(t,e,r,n,a,i,o,s){for(var c,l,u,f,$,_,d,p,h,g,m,v,y,b,w,x,A,k,E,S,N,C,I,O,P=r-t,L=n-e,M=a-r,B=i-n,j=o-a,F=s-i,b=0;b<41;b++)c=b/40,l=t+c*P,u=e+c*L,f=r+c*M,$=n+c*B,_=a+c*j,d=i+c*F,E=f-l,S=$-u,N=_-f,C=d-$,g=l+c*E,m=u+c*S,p=f+c*N,h=$+c*C,I=p-g,O=h-m,v=g+c*I,y=m+c*O,0==b?(w=v,x=y,A=v,k=y):(w=Math.min(w,v),x=Math.min(x,y),A=Math.max(A,v),k=Math.max(k,y));return new T(Math.round(w),Math.round(x),Math.round(A-w),Math.round(k-x))},M=function(t,e){var r=t||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return r},set:function(t){isNaN(t)||(r=parseFloat(t))}});var n=e||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return n},set:function(t){isNaN(t)||(n=parseFloat(t))}});var a="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return a},set:function(t){a=t.toString()}}),this},T=function(t,e,r,n){M.call(this,t,e),this.type="rect";var a=r||0;Object.defineProperty(this,"w",{enumerable:!0,
get:function(){return a},set:function(t){isNaN(t)||(a=parseFloat(t))}});var i=n||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return i},set:function(t){isNaN(t)||(i=parseFloat(t))}}),this},B=function(t,e,r,n,a,i){var o=[];return Object.defineProperty(this,"sx",{get:function(){return o[0]},set:function(t){o[0]=Math.round(1e5*t)/1e5}}),Object.defineProperty(this,"shy",{get:function(){return o[1]},set:function(t){o[1]=Math.round(1e5*t)/1e5}}),Object.defineProperty(this,"shx",{get:function(){return o[2]},set:function(t){o[2]=Math.round(1e5*t)/1e5}}),Object.defineProperty(this,"sy",{get:function(){return o[3]},set:function(t){o[3]=Math.round(1e5*t)/1e5}}),Object.defineProperty(this,"tx",{get:function(){return o[4]},set:function(t){o[4]=Math.round(1e5*t)/1e5}}),Object.defineProperty(this,"ty",{get:function(){return o[5]},set:function(t){o[5]=Math.round(1e5*t)/1e5}}),Object.defineProperty(this,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(this,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(this,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(this,"isIdentity",{get:function(){return 1===this.sx&&(0===this.shy&&(0===this.shx&&(1===this.sy&&(0===this.tx&&0===this.ty))))}}),this.sx=isNaN(t)?1:t,this.shy=isNaN(e)?0:e,this.shx=isNaN(r)?0:r,this.sy=isNaN(n)?1:n,this.tx=isNaN(a)?0:a,this.ty=isNaN(i)?0:i,this};B.prototype.multiply=function(t){var e=t.sx*this.sx+t.shy*this.shx,r=t.sx*this.shy+t.shy*this.sy,n=t.shx*this.sx+t.sy*this.shx,a=t.shx*this.shy+t.sy*this.sy,i=t.tx*this.sx+t.ty*this.shx+this.tx,o=t.tx*this.shy+t.ty*this.sy+this.ty;return new B(e,r,n,a,i,o)},B.prototype.decompose=function(){var t=this.sx,e=this.shy,r=this.shx,n=this.sy,a=this.tx,i=this.ty,o=Math.sqrt(t*t+e*e);t/=o,e/=o;var s=t*r+e*n;r-=t*s,n-=e*s;var c=Math.sqrt(r*r+n*n);return r/=c,n/=c,s/=c,t*n<e*r&&(t=-t,e=-e,s=-s,o=-o),{scale:new B(o,0,0,c,0,0),translate:new B(1,0,0,1,a,i),rotate:new B(t,e,-e,t,0,0),skew:new B(1,0,s,1,0,0)}},B.prototype.applyToPoint=function(t){var e=t.x*this.sx+t.y*this.shx+this.tx,r=t.x*this.shy+t.y*this.sy+this.ty;return new M(e,r)},B.prototype.applyToRectangle=function(t){var e=this.applyToPoint(t),r=this.applyToPoint(new M(t.x+t.w,t.y+t.h));return new T(e.x,e.y,r.x-e.x,r.y-e.y)},B.prototype.clone=function(){var t=this.sx,e=this.shy,r=this.shx,n=this.sy,a=this.tx,i=this.ty;return new B(t,e,r,n,a,i)}}(c.API,"undefined"!=typeof self&&self||"undefined"!=typeof window&&window||"undefined"!=typeof global&&global||Function('return typeof this === "object" && this.content')()||Function("return this")()),function(t){var e=function(t){var e,r,n,a,i,o,s,c,l,u;for(/[^\x00-\xFF]/.test(t),e="\0\0\0\0".slice(t.length%4||4),t+=e,r=[],n=0,a=t.length;a>n;n+=4)i=(t.charCodeAt(n)<<24)+(t.charCodeAt(n+1)<<16)+(t.charCodeAt(n+2)<<8)+t.charCodeAt(n+3),0!==i?(u=i%85,i=(i-u)/85,l=i%85,i=(i-l)/85,c=i%85,i=(i-c)/85,s=i%85,i=(i-s)/85,o=i%85,r.push(o+33,s+33,c+33,l+33,u+33)):r.push(122);return function(t,e){for(var r=e;r>0;r--)t.pop()}(r,e.length),String.fromCharCode.apply(String,r)+"~>"},r=function(t){var e,r,n,a,i,o=String,s="length",c=255,l="charCodeAt",u="slice",f="replace";for(t[u](-2),t=t[u](0,-2)[f](/\s/g,"")[f]("z","!!!!!"),e="uuuuu"[u](t[s]%5||5),t+=e,n=[],a=0,i=t[s];i>a;a+=5)r=52200625*(t[l](a)-33)+614125*(t[l](a+1)-33)+7225*(t[l](a+2)-33)+85*(t[l](a+3)-33)+(t[l](a+4)-33),n.push(c&r>>24,c&r>>16,c&r>>8,c&r);return function(t,e){for(var r=e;r>0;r--)t.pop()}(n,e[s]),o.fromCharCode.apply(o,n)},n=function(t){for(var e,r="",e=0;e<t.length;e+=1)r+=("0"+t.charCodeAt(e).toString(16)).slice(-2);return r+=">"},a=function(t){var e=new RegExp(/^([0-9A-Fa-f]{2})+$/);if(t=t.replace(/\s/g,""),-1!==t.indexOf(">")&&(t=t.substr(0,t.indexOf(">"))),t.length%2&&(t+="0"),!1===e.test(t))return"";for(var r,n="",r=0;r<t.length;r+=2)n+=String.fromCharCode("0x"+(t[r]+t[r+1]));return n},i=function(e,r){r=Object.assign({predictor:1,colors:1,bitsPerComponent:8,columns:1},r);for(var n,a,i=[],o=e.length;o--;)i[o]=e.charCodeAt(o);return n=t.adler32cs.from(e),a=new Deflater(6),a.append(new Uint8Array(i)),e=a.flush(),i=new Uint8Array(e.length+6),i.set(new Uint8Array([120,156])),i.set(e,2),i.set(new Uint8Array([255&n,n>>8&255,n>>16&255,n>>24&255]),e.length+2),e=String.fromCharCode.apply(null,i)};t.processDataByFilters=function(t,o){var s=0,c=t||"",l=[];for(o=o||[],"string"==typeof o&&(o=[o]),s=0;s<o.length;s+=1)switch(o[s]){case"ASCII85Decode":case"/ASCII85Decode":c=r(c),l.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":c=e(c),l.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":c=a(c),l.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":c=n(c),l.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":c=i(c),l.push("/FlateDecode");break;default:throw'The filter: "'+o[s]+'" is not implemented'}return{data:c,reverseChain:l.reverse().join(" ")}}}(c.API),function(t){t.loadFile=function(t,e,r){e=e||!0,r=r||function(){};var n;try{n=function(t,e,r){var n=new XMLHttpRequest,a=[],i=0,o=function(t){var e=t.length,r=String.fromCharCode;for(i=0;i<e;i+=1)a.push(r(255&t.charCodeAt(i)));return a.join("")};return n.open("GET",t,!e),n.overrideMimeType("text/plain; charset=x-user-defined"),!1===e&&(n.onload=function(){return o(this.responseText)}),n.send(null),200!==n.status?void console.warn('Unable to load file "'+t+'"'):e?o(n.responseText):void 0}(t,e)}catch(t){n=void 0}return n},t.loadImageFile=t.loadFile}(c.API),function(t,e){var r=function(t){var e=n(t);return"undefined"===e?"undefined":"string"===e||t instanceof String?"string":"number"===e||t instanceof Number?"number":"function"===e||t instanceof Function?"function":t&&t.constructor===Array?"array":t&&1===t.nodeType?"element":"object"===e?"object":"unknown"},a=function(t,e){var r=document.createElement(t);if(e.className&&(r.className=e.className),e.innerHTML){r.innerHTML=e.innerHTML;for(var n=r.getElementsByTagName("script"),a=n.length;a-- >0;null)n[a].parentNode.removeChild(n[a])}for(var i in e.style)r.style[i]=e.style[i];return r},i=function t(e,r){for(var n=3===e.nodeType?document.createTextNode(e.nodeValue):e.cloneNode(!1),a=e.firstChild;a;a=a.nextSibling)!0!==r&&1===a.nodeType&&"SCRIPT"===a.nodeName||n.appendChild(t(a,r));return 1===e.nodeType&&("CANVAS"===e.nodeName?(n.width=e.width,n.height=e.height,n.getContext("2d").drawImage(e,0,0)):"TEXTAREA"!==e.nodeName&&"SELECT"!==e.nodeName||(n.value=e.value),n.addEventListener("load",function(){n.scrollTop=e.scrollTop,n.scrollLeft=e.scrollLeft},!0)),n},o=function t(e){var r=Object.assign(t.convert(Promise.resolve()),JSON.parse(JSON.stringify(t.template))),n=t.convert(Promise.resolve(),r);return n=n.setProgress(1,t,1,[t]),n=n.set(e)};o.prototype=Object.create(Promise.prototype),o.prototype.constructor=o,o.convert=function(t,e){return t.__proto__=e||o.prototype,t},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{}}},o.prototype.from=function(t,e){function n(t){switch(r(t)){case"string":return"string";case"element":return"canvas"===t.nodeName.toLowerCase?"canvas":"element";default:return"unknown"}}return this.then(function(){switch(e=e||n(t)){case"string":return this.set({src:a("div",{innerHTML:t})});case"element":return this.set({src:t});case"canvas":return this.set({canvas:t});case"img":return this.set({img:t});default:return this.error("Unknown source type.")}})},o.prototype.to=function(t){switch(t){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){var t=[function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}];return this.thenList(t).then(function(){var t={position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0},e={position:"relative",display:"inline-block",width:Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:"white"},r=i(this.prop.src,this.opt.html2canvas.javascriptEnabled);"BODY"===r.tagName&&(e.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=a("div",{className:"html2pdf__overlay",style:t}),this.prop.container=a("div",{className:"html2pdf__container",style:e}),this.prop.container.appendChild(r),this.prop.container.firstChild.appendChild(a("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var t=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(t).then(function(){var t=Object.assign({},this.opt.html2canvas);if(delete t.onrendered,this.isHtml2CanvasLoaded())return html2canvas(this.prop.container,t)}).then(function(t){(this.opt.html2canvas.onrendered||function(){})(t),this.prop.canvas=t,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var t=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(t).then(function(){var t=this.opt.jsPDF,e=Object.assign({async:!0,allowTaint:!0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete e.onrendered,t.context2d.autoPaging=!0,t.context2d.posX=this.opt.x,t.context2d.posY=this.opt.y,e.windowHeight=e.windowHeight||0,e.windowHeight=0==e.windowHeight?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):e.windowHeight,this.isHtml2CanvasLoaded())return html2canvas(this.prop.container,e)}).then(function(t){(this.opt.html2canvas.onrendered||function(){})(t),this.prop.canvas=t,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){var t=[function(){return this.prop.canvas||this.toCanvas()}];return this.thenList(t).then(function(){var t=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=t})},o.prototype.toPdf=function(){var t=[function(){return this.toContext2d()}];return this.thenList(t).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(t,e,r){return r=r||"pdf","img"===r.toLowerCase()||"image"===r.toLowerCase()?this.outputImg(t,e):this.outputPdf(t,e)},o.prototype.outputPdf=function(t,e){var r=[function(){return this.prop.pdf||this.toPdf()}];return this.thenList(r).then(function(){return this.prop.pdf.output(t,e)})},o.prototype.outputImg=function(t,e){var r=[function(){return this.prop.img||this.toImg()}];return this.thenList(r).then(function(){switch(t){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+t+'" is not supported.'}})},o.prototype.isHtml2CanvasLoaded=function(){var t=void 0!==e.html2canvas;return t||console.error("html2canvas not loaded."),t},o.prototype.save=function(t){var e=[function(){return this.prop.pdf||this.toPdf()}];if(this.isHtml2CanvasLoaded())return this.thenList(e).set(t?{filename:t}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(t){var e=[function(){return this.prop.pdf||this.toPdf()}];if(this.isHtml2CanvasLoaded())return this.thenList(e).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(t){if("object"!==r(t))return this;var e=Object.keys(t||{}).map(function(e){if(e in o.template.prop)return function(){this.prop[e]=t[e]};switch(e){case"margin":return this.setMargin.bind(this,t.margin);case"jsPDF":return function(){return this.opt.jsPDF=t.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,t.pageSize);default:return function(){this.opt[e]=t[e]}}},this);return this.then(function(){return this.thenList(e)})},o.prototype.get=function(t,e){return this.then(function(){var r=t in o.template.prop?this.prop[t]:this.opt[t];return e?e(r):r})},o.prototype.setMargin=function(t){return this.then(function(){switch(r(t)){case"number":t=[t,t,t,t];case"array":if(2===t.length&&(t=[t[0],t[1],t[0],t[1]]),4===t.length)break;default:return this.error("Invalid margin array.")}this.opt.margin=t}).then(this.setPageSize)},o.prototype.setPageSize=function(t){function e(t,e){return Math.floor(t*e/72*96)}return this.then(function(){t=t||c.getPageSize(this.opt.jsPDF),t.hasOwnProperty("inner")||(t.inner={width:t.width-this.opt.margin[1]-this.opt.margin[3],height:t.height-this.opt.margin[0]-this.opt.margin[2]},t.inner.px={width:e(t.inner.width,t.k),height:e(t.inner.height,t.k)},t.inner.ratio=t.inner.height/t.inner.width),this.prop.pageSize=t})},o.prototype.setProgress=function(t,e,r,n){return null!=t&&(this.progress.val=t),null!=e&&(this.progress.state=e),null!=r&&(this.progress.n=r),null!=n&&(this.progress.stack=n),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(t,e,r,n){return this.setProgress(t?this.progress.val+t:null,e||null,r?this.progress.n+r:null,n?this.progress.stack.concat(n):null)},o.prototype.then=function(t,e){var r=this;return this.thenCore(t,e,function(t,e){return r.updateProgress(null,null,1,[t]),Promise.prototype.then.call(this,function(e){return r.updateProgress(null,t),e}).then(t,e).then(function(t){return r.updateProgress(1),t})})},o.prototype.thenCore=function(t,e,r){r=r||Promise.prototype.then;var n=this;t&&(t=t.bind(n)),e&&(e=e.bind(n));var a=-1!==Promise.toString().indexOf("[native code]")&&"Promise"===Promise.name,i=a?n:o.convert(Object.assign({},n),Promise.prototype),s=r.call(i,t,e);return o.convert(s,n.__proto__)},o.prototype.thenExternal=function(t,e){return Promise.prototype.then.call(this,t,e)},o.prototype.thenList=function(t){var e=this;return t.forEach(function(t){e=e.thenCore(t)}),e},o.prototype.catch=function(t){t&&(t=t.bind(this));var e=Promise.prototype.catch.call(this,t);return o.convert(e,this)},o.prototype.catchExternal=function(t){return Promise.prototype.catch.call(this,t)},o.prototype.error=function(t){return this.then(function(){throw new Error(t)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,c.getPageSize=function(t,e,r){if("object"===n(t)){var a=t;t=a.orientation,e=a.unit||e,r=a.format||r}e=e||"mm",r=r||"a4",t=(""+(t||"P")).toLowerCase();var i=(""+r).toLowerCase(),o={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(e){case"pt":var s=1;break;case"mm":var s=72/25.4;break;case"cm":var s=72/2.54;break;case"in":var s=72;break;case"px":var s=.75;break;case"pc":case"em":var s=12;break;case"ex":var s=6;break;default:throw"Invalid unit: "+e}if(o.hasOwnProperty(i))var c=o[i][1]/s,l=o[i][0]/s;else try{var c=r[1],l=r[0]}catch(t){throw new Error("Invalid format: "+r)}if("p"===t||"portrait"===t){if(t="p",l>c){var u=l;l=c,c=u}}else{if("l"!==t&&"landscape"!==t)throw"Invalid orientation: "+t;if(t="l",c>l){var u=l;l=c,c=u}}return{width:l,height:c,unit:e,k:s}},t.html=function(t,e){e=e||{},e.callback=e.callback||function(){},e.html2canvas=e.html2canvas||{},e.html2canvas.canvas=e.html2canvas.canvas||this.canvas,e.jsPDF=e.jsPDF||this;var r=(e.jsPDF,new o(e));return e.worker?r:r.from(t).doCallback()}}(c.API,"undefined"!=typeof window&&window||"undefined"!=typeof global&&global),function(t){var e,r,n;t.addJS=function(t){return n=t,this.internal.events.subscribe("postPutResources",function(t){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(e+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),r=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+n+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){void 0!==e&&void 0!==r&&this.internal.out("/Names <</JavaScript "+e+" 0 R>>")}),this}}(c.API),function(t){t.events.push(["postPutResources",function(){var t=this,e=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var r=t.outline.render().split(/\r\n/),n=0;n<r.length;n++){var a=r[n],i=e.exec(a);if(null!=i){var o=i[1];t.internal.newObjectDeferredBegin(o,!1)}t.internal.write(a)}if(this.outline.createNamedDestinations){for(var s=this.internal.pages.length,c=[],n=0;n<s;n++){var l=t.internal.newObject();c.push(l);var u=t.internal.getPageInfo(n+1);t.internal.write("<< /D["+u.objId+" 0 R /XYZ null null null]>> endobj")}var f=t.internal.newObject();t.internal.write("<< /Names [ ");for(var n=0;n<c.length;n++)t.internal.write("(page_"+(n+1)+")"+c[n]+" 0 R");t.internal.write(" ] >>","endobj");t.internal.newObject();t.internal.write("<< /Dests "+f+" 0 R"),t.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){var t=this;t.outline.root.children.length>0&&(t.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&t.internal.write("/Names "+namesOid+" 0 R"))}]),t.events.push(["initialized",function(){var t=this;t.outline={createNamedDestinations:!1,root:{children:[]}},t.outline.add=function(t,e,r){var n={title:e,options:r,children:[]};return null==t&&(t=this.root),t.children.push(n),n},t.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=t,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},t.outline.genIds_r=function(e){e.id=t.internal.newObjectDeferred();for(var r=0;r<e.children.length;r++)this.genIds_r(e.children[r])},t.outline.renderRoot=function(t){this.objStart(t),this.line("/Type /Outlines"),t.children.length>0&&(this.line("/First "+this.makeRef(t.children[0])),this.line("/Last "+this.makeRef(t.children[t.children.length-1]))),this.line("/Count "+this.count_r({count:0},t)),this.objEnd()},t.outline.renderItems=function(e){for(var r=(this.ctx.pdf.internal.getCoordinateString,this.ctx.pdf.internal.getVerticalCoordinateString),n=0;n<e.children.length;n++){var a=e.children[n];this.objStart(a),this.line("/Title "+this.makeString(a.title)),this.line("/Parent "+this.makeRef(e)),n>0&&this.line("/Prev "+this.makeRef(e.children[n-1])),n<e.children.length-1&&this.line("/Next "+this.makeRef(e.children[n+1])),a.children.length>0&&(this.line("/First "+this.makeRef(a.children[0])),this.line("/Last "+this.makeRef(a.children[a.children.length-1])));var i=this.count=this.count_r({count:0},a);if(i>0&&this.line("/Count "+i),a.options&&a.options.pageNumber){var o=t.internal.getPageInfo(a.options.pageNumber);this.line("/Dest ["+o.objId+" 0 R /XYZ 0 "+r(0)+" 0]")}this.objEnd()}for(var n=0;n<e.children.length;n++){var a=e.children[n];this.renderItems(a)}},t.outline.line=function(t){this.ctx.val+=t+"\r\n"},t.outline.makeRef=function(t){return t.id+" 0 R"},t.outline.makeString=function(e){return"("+t.internal.pdfEscape(e)+")"},t.outline.objStart=function(t){this.ctx.val+="\r\n"+t.id+" 0 obj\r\n<<\r\n"},t.outline.objEnd=function(t){this.ctx.val+=">> \r\nendobj\r\n"},t.outline.count_r=function(t,e){for(var r=0;r<e.children.length;r++)t.count++,this.count_r(t,e.children[r]);return t.count}}])}(c.API),function(t){var e=function(){return"function"!=typeof PNG||"function"!=typeof u},r=function(e){return e!==t.image_compression.NONE&&n()},n=function(){var t="function"==typeof Deflater;if(!t)throw new Error("requires deflate.js for compression");return t},a=function(e,r,n,a){var c=5,u=f;switch(a){case t.image_compression.FAST:c=3,u=l;break;case t.image_compression.MEDIUM:c=6,u=$;break;case t.image_compression.SLOW:c=9,u=_}e=s(e,r,n,u);var d=new Uint8Array(i(c)),p=o(e),h=new Deflater(c),g=h.append(e),m=h.flush(),v=d.length+g.length+m.length,y=new Uint8Array(v+4);return y.set(d),y.set(g,d.length),y.set(m,d.length+g.length),y[v++]=p>>>24&255,y[v++]=p>>>16&255,y[v++]=p>>>8&255,y[v++]=255&p,t.arrayBufferToBinaryString(y)},i=function(t,e){var r=Math.LOG2E*Math.log(32768)-8,n=r<<4|8,a=n<<8;return a|=Math.min(3,(e-1&255)>>1)<<6,a|=0,a+=31-a%31,[n,255&a]},o=function(t,e){for(var r,n=1,a=0,i=t.length,o=0;i>0;){r=i>e?e:i,i-=r;do{n+=t[o++],a+=n}while(--r);n%=65521,a%=65521}return(a<<16|n)>>>0},s=function(t,e,r,n){for(var a,i,o,s=t.length/e,c=new Uint8Array(t.length+s),l=p(),u=0;u<s;u++){if(o=u*e,a=t.subarray(o,o+e),n)c.set(n(a,r,i),o+u);else{for(var f=0,$=l.length,_=[];f<$;f++)_[f]=l[f](a,r,i);var d=h(_.concat());c.set(_[d],o+u)}i=a}return c},c=function(t,e,r){var n=Array.apply([],t);return n.unshift(0),n},l=function(t,e,r){var n,a=[],i=0,o=t.length;for(a[0]=1;i<o;i++)n=t[i-e]||0,a[i+1]=t[i]-n+256&255;return a},f=function(t,e,r){var n,a=[],i=0,o=t.length;for(a[0]=2;i<o;i++)n=r&&r[i]||0,a[i+1]=t[i]-n+256&255;return a},$=function(t,e,r){var n,a,i=[],o=0,s=t.length;for(i[0]=3;o<s;o++)n=t[o-e]||0,a=r&&r[o]||0,i[o+1]=t[o]+256-(n+a>>>1)&255;return i},_=function(t,e,r){var n,a,i,o,s=[],c=0,l=t.length;for(s[0]=4;c<l;c++)n=t[c-e]||0,a=r&&r[c]||0,i=r&&r[c-e]||0,o=d(n,a,i),s[c+1]=t[c]-o+256&255;return s},d=function(t,e,r){var n=t+e-r,a=Math.abs(n-t),i=Math.abs(n-e),o=Math.abs(n-r);return a<=i&&a<=o?t:i<=o?e:r},p=function(){return[c,l,f,$,_]},h=function(t){for(var e,r,n,a=0,i=t.length;a<i;)e=g(t[a].slice(1)),(e<r||!r)&&(r=e,n=a),a++;return n},g=function(t){for(var e=0,r=t.length,n=0;e<r;)n+=Math.abs(t[e++]);return n},m=function(e){var r;switch(e){case t.image_compression.FAST:r=11;break;case t.image_compression.MEDIUM:r=13;break;case t.image_compression.SLOW:r=14;break;default:r=12}return r};t.processPNG=function(t,n,i,o,s){var c,l,u,f,$,_,d=this.color_spaces.DEVICE_RGB,p=this.decode.FLATE_DECODE,h=8;if(this.isArrayBuffer(t)&&(t=new Uint8Array(t)),this.isArrayBufferView(t)){if(e())throw new Error("PNG support requires png.js and zlib.js");if(c=new PNG(t),t=c.imgData,h=c.bits,d=c.colorSpace,f=c.colors,-1!==[4,6].indexOf(c.colorType)){if(8===c.bits)for(var g,v,y=32==c.pixelBitlength?new Uint32Array(c.decodePixels().buffer):16==c.pixelBitlength?new Uint16Array(c.decodePixels().buffer):new Uint8Array(c.decodePixels().buffer),b=y.length,w=new Uint8Array(b*c.colors),x=new Uint8Array(b),A=c.pixelBitlength-c.bits,k=0,E=0;k<b;k++){for(g=y[k],v=0;v<A;)w[E++]=g>>>v&255,v+=c.bits;x[k]=g>>>v&255}if(16===c.bits){for(var g,y=new Uint32Array(c.decodePixels().buffer),b=y.length,w=new Uint8Array(b*(32/c.pixelBitlength)*c.colors),x=new Uint8Array(b*(32/c.pixelBitlength)),S=c.colors>1,k=0,E=0,N=0;k<b;)g=y[k++],w[E++]=g>>>0&255,S&&(w[E++]=g>>>16&255,g=y[k++],w[E++]=g>>>0&255),x[N++]=g>>>16&255;h=8}r(o)?(t=a(w,c.width*c.colors,c.colors,o),_=a(x,c.width,1,o)):(t=w,_=x,p=null)}if(3===c.colorType&&(d=this.color_spaces.INDEXED,$=c.palette,c.transparency.indexed)){for(var C=c.transparency.indexed,I=0,k=0,b=C.length;k<b;++k)I+=C[k];if((I/=255)===b-1&&-1!==C.indexOf(0))u=[C.indexOf(0)];else if(I!==b){for(var y=c.decodePixels(),x=new Uint8Array(y.length),k=0,b=y.length;k<b;k++)x[k]=C[y[k]];_=a(x,c.width,1)}}var O=m(o);return l=p===this.decode.FLATE_DECODE?"/Predictor "+O+" /Colors "+f+" /BitsPerComponent "+h+" /Columns "+c.width:"/Colors "+f+" /BitsPerComponent "+h+" /Columns "+c.width,(this.isArrayBuffer(t)||this.isArrayBufferView(t))&&(t=this.arrayBufferToBinaryString(t)),(_&&this.isArrayBuffer(_)||this.isArrayBufferView(_))&&(_=this.arrayBufferToBinaryString(_)),this.createImageInfo(t,c.width,c.height,d,h,p,n,i,l,u,$,_,O)}throw new Error("Unsupported PNG image data, try using JPEG instead.")}}(c.API),function(t){t.processGIF89A=function(e,r,n,i,o){var s=new GifReader(e),c=s.width,l=s.height,u=[];s.decodeAndBlitFrameRGBA(0,u);var f={data:u,width:c,height:l},$=new a(100),_=$.encode(f,100);return t.processJPEG.call(this,_,r,n,i)},t.processGIF87A=t.processGIF89A}(c.API),function(t){t.processBMP=function(e,r,n,o,s){var c=new i(e,!1),l=c.width,u=c.height,f=c.getData(),$={data:f,width:l,height:u},_=new a(100),d=_.encode($,100);return t.processJPEG.call(this,d,r,n,o)}}(c.API),function(t){t.setLanguage=function(t){var e={af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"FYRO Macedonian",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"};return void 0===this.internal.languageSettings&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),void 0!==e[t]&&(this.internal.languageSettings.languageCode=t,!1===this.internal.languageSettings.isSubscribed&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this}}(c.API),function(t){var e=t.getCharWidthsArray=function(t,e){e=e||{};var r,n,a,i=e.font||this.internal.getFont(),o=e.fontSize||this.internal.getFontSize(),s=e.charSpace||this.internal.getCharSpace(),c=e.widths?e.widths:i.metadata.Unicode.widths,l=c.fof?c.fof:1,u=e.kerning?e.kerning:i.metadata.Unicode.kerning,f=u.fof?u.fof:1,$=0,_=c[0]||l,d=[];for(r=0,n=t.length;r<n;r++)a=t.charCodeAt(r),"function"==typeof i.metadata.widthOfString?d.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(a))+s*(1e3/o)||0)/1e3):d.push((c[a]||_)/l+(u[a]&&u[a][$]||0)/f),$=a;return d},r=t.getArraySum=function(t){for(var e=t.length,r=0;e;)e--,r+=t[e];return r},n=t.getStringUnitWidth=function(t,n){n=n||{};var a=n.fontSize||this.internal.getFontSize(),i=n.font||this.internal.getFont(),o=n.charSpace||this.internal.getCharSpace();return"function"==typeof i.metadata.widthOfString?i.metadata.widthOfString(t,a,o)/a:r(e.apply(this,arguments))},a=function(t,e,r,n){for(var a=[],i=0,o=t.length,s=0;i!==o&&s+e[i]<r;)s+=e[i],i++;a.push(t.slice(0,i));var c=i;for(s=0;i!==o;)s+e[i]>n&&(a.push(t.slice(c,i)),s=0,c=i),s+=e[i],i++;return c!==i&&a.push(t.slice(c,i)),a},i=function(t,i,o){o||(o={});var s,c,l,u,f,$,_=[],d=[_],p=o.textIndent||0,h=0,g=0,m=t.split(" "),v=e.apply(this,[" ",o])[0];if($=-1===o.lineIndent?m[0].length+2:o.lineIndent||0){var y=Array($).join(" "),b=[];m.map(function(t){t=t.split(/\s*\n/),t.length>1?b=b.concat(t.map(function(t,e){return(e&&t.length?"\n":"")+t})):b.push(t[0])}),m=b,$=n.apply(this,[y,o])}for(l=0,u=m.length;l<u;l++){var w=0;if(s=m[l],$&&"\n"==s[0]&&(s=s.substr(1),w=1),c=e.apply(this,[s,o]),g=r(c),p+h+g>i||w){if(g>i){for(f=a.apply(this,[s,c,i-(p+h),i]),_.push(f.shift()),_=[f.pop()];f.length;)d.push([f.shift()]);g=r(c.slice(s.length-(_[0]?_[0].length:0)))}else _=[s];d.push(_),p=g+$,h=v}else _.push(s),p+=h+g,h=v}if($)var x=function(t,e){return(e?y:"")+t.join(" ")};else var x=function(t){return t.join(" ")};return d.map(x)};t.splitTextToSize=function(t,e,r){r=r||{};var n,a=r.fontSize||this.internal.getFontSize(),o=function(t){var e={0:1},r={};if(t.widths&&t.kerning)return{widths:t.widths,kerning:t.kerning}
;var n=this.internal.getFont(t.fontName,t.fontStyle);return n.metadata.Unicode?{widths:n.metadata.Unicode.widths||e,kerning:n.metadata.Unicode.kerning||r}:{font:n.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}.call(this,r);n=Array.isArray(t)?t:t.split(/\r?\n/);var s=1*this.internal.scaleFactor*e/a;o.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/a:0,o.lineIndent=r.lineIndent;var c,l,u=[];for(c=0,l=n.length;c<l;c++)u=u.concat(i.apply(this,[n[c],s,o]));return u}}(c.API),function(t){var e=function(t){for(var e={},r=0;r<"klmnopqrstuvwxyz".length;r++)e["klmnopqrstuvwxyz"[r]]="0123456789abcdef"[r];var n,a,i,o,s={},c=1,l=s,u=[],f="",$="",_=t.length-1;for(r=1;r!=_;)o=t[r],r+=1,"'"==o?n?(i=n.join(""),n=void 0):n=[]:n?n.push(o):"{"==o?(u.push([l,i]),l={},i=void 0):"}"==o?(a=u.pop(),a[0][a[1]]=l,i=void 0,l=a[0]):"-"==o?c=-1:void 0===i?e.hasOwnProperty(o)?(f+=e[o],i=parseInt(f,16)*c,c=1,f=""):f+=o:e.hasOwnProperty(o)?($+=e[o],l[i]=parseInt($,16)*c,c=1,i=void 0,$=""):$+=o;return s},r={codePages:["WinAnsiEncoding"],WinAnsiEncoding:e("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},n={Unicode:{Courier:r,"Courier-Bold":r,"Courier-BoldOblique":r,"Courier-Oblique":r,Helvetica:r,"Helvetica-Bold":r,"Helvetica-BoldOblique":r,"Helvetica-Oblique":r,"Times-Roman":r,"Times-Bold":r,"Times-BoldItalic":r,"Times-Italic":r}},a={Unicode:{"Courier-Oblique":e("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":e("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":e("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:e("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":e("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":e("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:e("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:e("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":e("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:e("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":e("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":e("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":e("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":e("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(t){var e,r,i,o=t.font;e=a.Unicode[o.postScriptName],e&&(r=o.metadata.Unicode?o.metadata.Unicode:o.metadata.Unicode={},r.widths=e.widths,r.kerning=e.kerning),(i=n.Unicode[o.postScriptName])&&(r=o.metadata.Unicode?o.metadata.Unicode:o.metadata.Unicode={},r.encoding=i,i.codePages&&i.codePages.length&&(o.encoding=i.codePages[0]))}])}(c.API),function(t,e){t.API.events.push(["addFont",function(e){var r=e.font,n=e.instance;if(void 0!==n&&n.existsFileInVFS(r.postScriptName))r.metadata=t.API.TTFFont.open(r.postScriptName,r.fontName,n.getFileFromVFS(r.postScriptName),r.encoding),r.metadata.Unicode=r.metadata.Unicode||{encoding:{},kerning:{},widths:[]},r.metadata.glyIdsUsed=[0];else if(!1===r.isStandardFont)throw new Error("Font does not exist in FileInVFS, import fonts or remove declaration doc.addFont('"+r.postScriptName+"').")}])}(c,"undefined"!=typeof self&&self||"undefined"!=typeof global&&global||"undefined"!=typeof window&&window||Function("return this")()),function(t){t.addSvg=function(t,e,r,n,a){function i(t,e){var r=e.createElement("style");r.type="text/css",r.styleSheet?r.styleSheet.cssText=t:r.appendChild(e.createTextNode(t)),e.getElementsByTagName("head")[0].appendChild(r)}if(void 0===e||void 0===r)throw new Error("addSVG needs values for 'x' and 'y'");var o=function(t){var e=t.createElement("iframe");return i(".jsPDF_sillysvg_iframe {display:none;position:absolute;}",t),e.name="childframe",e.setAttribute("width",0),e.setAttribute("height",0),e.setAttribute("frameborder","0"),e.setAttribute("scrolling","no"),e.setAttribute("seamless","seamless"),e.setAttribute("class","jsPDF_sillysvg_iframe"),t.body.appendChild(e),e}(document),s=function(t,e){var r=(e.contentWindow||e.contentDocument).document;return r.write(t),r.close(),r.getElementsByTagName("svg")[0]}(t,o),c=[1,1],l=parseFloat(s.getAttribute("width")),u=parseFloat(s.getAttribute("height"));l&&u&&(n&&a?c=[n/l,a/u]:n?c=[n/l,n/l]:a&&(c=[a/u,a/u]));var f,$,_,d,p=s.childNodes;for(f=0,$=p.length;f<$;f++)_=p[f],_.tagName&&"PATH"===_.tagName.toUpperCase()&&(d=function(t){for(var e=parseFloat(t[1]),r=parseFloat(t[2]),n=[],a=3,i=t.length;a<i;)"c"===t[a]?(n.push([parseFloat(t[a+1]),parseFloat(t[a+2]),parseFloat(t[a+3]),parseFloat(t[a+4]),parseFloat(t[a+5]),parseFloat(t[a+6])]),a+=7):"l"===t[a]?(n.push([parseFloat(t[a+1]),parseFloat(t[a+2])]),a+=3):a+=1;return[e,r,n]}(_.getAttribute("d").split(" ")),d[0]=d[0]*c[0]+e,d[1]=d[1]*c[1]+r,this.lines.call(this,d[2],d[0],d[1],c));return this},t.addSVG=t.addSvg,t.addSvgAsImage=function(t,e,r,n,a,i,o,s){if(isNaN(e)||isNaN(r))throw console.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(a))throw console.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=n,c.height=a;var l=c.getContext("2d");return l.fillStyle="#fff",l.fillRect(0,0,c.width,c.height),canvg(c,t,{ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0}),this.addImage(c.toDataURL("image/jpeg",1),e,r,n,a,o,s),this}}(c.API),function(t){t.putTotalPages=function(t){var e,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),r=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var a=0;a<this.internal.pages[n].length;a++)this.internal.pages[n][a]=this.internal.pages[n][a].replace(e,r);return this}}(c.API),function(t){t.viewerPreferences=function(t,e){function r(t,e){var r,n=!1;for(r=0;r<t.length;r+=1)t[r]===e&&(n=!0);return n}t=t||{},e=e||!1;var a,i,o,s={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},c=Object.keys(s),l=[],u=0,f=0,$=0,_=!0;if(void 0===this.internal.viewerpreferences&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(s)),this.internal.viewerpreferences.isSubscribed=!1),a=this.internal.viewerpreferences.configuration,"reset"===t||!0===e){var d=c.length;for($=0;$<d;$+=1)a[c[$]].value=a[c[$]].defaultValue,a[c[$]].explicitSet=!1}if("object"===n(t))for(i in t)if(o=t[i],r(c,i)&&void 0!==o){if("boolean"===a[i].type&&"boolean"==typeof o)a[i].value=o;else if("name"===a[i].type&&r(a[i].valueSet,o))a[i].value=o;else if("integer"===a[i].type&&Number.isInteger(o))a[i].value=o;else if("array"===a[i].type){for(u=0;u<o.length;u+=1)if(_=!0,1===o[u].length&&"number"==typeof o[u][0])l.push(String(o[u]-1));else if(o[u].length>1){for(f=0;f<o[u].length;f+=1)"number"!=typeof o[u][f]&&(_=!1);!0===_&&l.push([o[u][0]-1,o[u][1]-1].join(" "))}a[i].value="["+l.join(" ")+"]"}else a[i].value=a[i].defaultValue;a[i].explicitSet=!0}return!1===this.internal.viewerpreferences.isSubscribed&&(this.internal.events.subscribe("putCatalog",function(){var t,e=[];for(t in a)!0===a[t].explicitSet&&("name"===a[t].type?e.push("/"+t+" /"+a[t].value):e.push("/"+t+" "+a[t].value));0!==e.length&&this.internal.write("/ViewerPreferences\n<<\n"+e.join("\n")+"\n>>")}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=a,this}}(c.API),function(t){var e="",r="",n="";t.addMetadata=function(t,a){return r=a||"http://jspdf.default.namespaceuri/",e=t,this.internal.events.subscribe("postPutResources",function(){if(e){var t='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+r+'"><jspdf:metadata>',a=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),i=unescape(encodeURIComponent(t)),o=unescape(encodeURIComponent(e)),s=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),l=i.length+o.length+s.length+a.length+c.length;n=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+l+" >>"),this.internal.write("stream"),this.internal.write(a+i+o+s+c),this.internal.write("endstream"),this.internal.write("endobj")}else n=""}),this.internal.events.subscribe("putCatalog",function(){n&&this.internal.write("/Metadata "+n+" 0 R")}),this}}(c.API),function(t,e){function r(t){for(var e="",r=0;r<t.length;r++)e+=""+t.charCodeAt(r).toString(16);return e}var n=t.API,a=n.pdfEscape16=function(t,e){for(var r,n=e.metadata.Unicode.widths,a=["","0","00","000","0000"],i=[""],o=0,s=t.length;o<s;++o){if(r=e.metadata.characterToGlyph(t.charCodeAt(o)),e.metadata.glyIdsUsed.push(r),e.metadata.toUnicode[r]=t.charCodeAt(o),-1==n.indexOf(r)&&(n.push(r),n.push([parseInt(e.metadata.widthOfGlyph(r),10)])),"0"==r)return i.join("");r=r.toString(16),i.push(a[4-r.length],r)}return i.join("")},i=function(t){var e,r,n,a,i,o,s;for(i="/CIDInit /ProcSet findresource begin\n12 dict begin\nbegincmap\n/CIDSystemInfo <<\n  /Registry (Adobe)\n  /Ordering (UCS)\n  /Supplement 0\n>> def\n/CMapName /Adobe-Identity-UCS def\n/CMapType 2 def\n1 begincodespacerange\n<0000><ffff>\nendcodespacerange",r=Object.keys(t).sort(function(t,e){return t-e}),n=[],o=0,s=r.length;o<s;o++)e=r[o],n.length>=100&&(i+="\n"+n.length+" beginbfchar\n"+n.join("\n")+"\nendbfchar",n=[]),a=("0000"+t[e].toString(16)).slice(-4),e=("0000"+(+e).toString(16)).slice(-4),n.push("<"+e+"><"+a+">");return n.length&&(i+="\n"+n.length+" beginbfchar\n"+n.join("\n")+"\nendbfchar\n"),i+="endcmap\nCMapName currentdict /CMap defineresource pop\nend\nend"},o=function(e,r,n,a){if(e.metadata instanceof t.API.TTFFont&&"Identity-H"===e.encoding){for(var o=e.metadata.Unicode.widths,s=e.metadata.subset.encode(e.metadata.glyIdsUsed,1),c=s,l="",u=0;u<c.length;u++)l+=String.fromCharCode(c[u]);var f=n();a({data:l,addLength1:!0}),r("endobj");var $=n();a({data:i(e.metadata.toUnicode),addLength1:!0}),r("endobj");var _=n();r("<<"),r("/Type /FontDescriptor"),r("/FontName /"+e.fontName),r("/FontFile2 "+f+" 0 R"),r("/FontBBox "+t.API.PDFObject.convert(e.metadata.bbox)),r("/Flags "+e.metadata.flags),r("/StemV "+e.metadata.stemV),r("/ItalicAngle "+e.metadata.italicAngle),r("/Ascent "+e.metadata.ascender),r("/Descent "+e.metadata.decender),r("/CapHeight "+e.metadata.capHeight),r(">>"),r("endobj");var d=n();r("<<"),r("/Type /Font"),r("/BaseFont /"+e.fontName),r("/FontDescriptor "+_+" 0 R"),r("/W "+t.API.PDFObject.convert(o)),r("/CIDToGIDMap /Identity"),r("/DW 1000"),r("/Subtype /CIDFontType2"),r("/CIDSystemInfo"),r("<<"),r("/Supplement 0"),r("/Registry (Adobe)"),r("/Ordering ("+e.encoding+")"),r(">>"),r(">>"),r("endobj"),e.objectNumber=n(),r("<<"),r("/Type /Font"),r("/Subtype /Type0"),r("/ToUnicode "+$+" 0 R"),r("/BaseFont /"+e.fontName),r("/Encoding /"+e.encoding),r("/DescendantFonts ["+d+" 0 R]"),r(">>"),r("endobj"),e.isAlreadyPutted=!0}};n.events.push(["putFont",function(t){o(t.font,t.out,t.newObject,t.putStream)}]);var s=function(e,r,n,a){if(e.metadata instanceof t.API.TTFFont&&"WinAnsiEncoding"===e.encoding){for(var o=(e.metadata.Unicode.widths,e.metadata.rawData),s=o,c="",l=0;l<s.length;l++)c+=String.fromCharCode(s[l]);var u=n();a({data:c,addLength1:!0}),r("endobj");var f=n();a({data:i(e.metadata.toUnicode),addLength1:!0}),r("endobj");var $=n();r("<<"),r("/Descent "+e.metadata.decender),r("/CapHeight "+e.metadata.capHeight),r("/StemV "+e.metadata.stemV),r("/Type /FontDescriptor"),r("/FontFile2 "+u+" 0 R"),r("/Flags 96"),r("/FontBBox "+t.API.PDFObject.convert(e.metadata.bbox)),r("/FontName /"+e.fontName),r("/ItalicAngle "+e.metadata.italicAngle),r("/Ascent "+e.metadata.ascender),r(">>"),r("endobj"),e.objectNumber=n();for(var l=0;l<e.metadata.hmtx.widths.length;l++)e.metadata.hmtx.widths[l]=parseInt(e.metadata.hmtx.widths[l]*(1e3/e.metadata.head.unitsPerEm));r("<</Subtype/TrueType/Type/Font/ToUnicode "+f+" 0 R/BaseFont/"+e.fontName+"/FontDescriptor "+$+" 0 R/Encoding/"+e.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(e.metadata.hmtx.widths)+">>"),r("endobj"),e.isAlreadyPutted=!0}};n.events.push(["putFont",function(t){s(t.font,t.out,t.newObject,t.putStream)}]);var c=function(t){var e,n,i=t.text||"",o=t.x,s=t.y,c=t.options||{},l=t.mutex||{},u=l.pdfEscape,f=l.activeFontKey,$=l.fonts,_=(l.activeFontSize,""),d=0,p="",e=f,h=$[e].encoding;if("Identity-H"!==$[e].encoding)return{text:i,x:o,y:s,options:c,mutex:l};for(p=i,e=f,"[object Array]"===Object.prototype.toString.call(i)&&(p=i[0]),d=0;d<p.length;d+=1)$[e].metadata.hasOwnProperty("cmap")&&(n=$[e].metadata.cmap.unicode.codeMap[p[d].charCodeAt(0)]),n?_+=p[d]:p[d].charCodeAt(0)<256&&$[e].metadata.hasOwnProperty("Unicode")?_+=p[d]:_+="";var g="";return parseInt(e.slice(1))<14||"WinAnsiEncoding"===h?g=r(u(_,e)):"Identity-H"===h&&(g=a(_,$[e])),l.isHex=!0,{text:g,x:o,y:s,options:c,mutex:l}},l=function(t){var e=t.text||"",r=t.x,n=t.y,a=t.options,i=t.mutex,o=(a.lang,[]),s={text:e,x:r,y:n,options:a,mutex:i};if("[object Array]"===Object.prototype.toString.call(e)){var l=0;for(l=0;l<e.length;l+=1)"[object Array]"===Object.prototype.toString.call(e[l])&&3===e[l].length?o.push([c(Object.assign({},s,{text:e[l][0]})).text,e[l][1],e[l][2]]):o.push(c(Object.assign({},s,{text:e[l]})).text);t.text=o}else t.text=c(Object.assign({},s,{text:e})).text};n.events.push(["postProcessText",l])}(c,"undefined"!=typeof self&&self||"undefined"!=typeof global&&global||"undefined"!=typeof window&&window||Function("return this")()),function(t){var e=function(t){return void 0!==t&&(void 0===t.vFS&&(t.vFS={}),!0)};t.existsFileInVFS=function(t){return!!e(this.internal)&&void 0!==this.internal.vFS[t]},t.addFileToVFS=function(t,r){return e(this.internal),this.internal.vFS[t]=r,this},t.getFileFromVFS=function(t){return e(this.internal),void 0!==this.internal.vFS[t]?this.internal.vFS[t]:null}}(c.API),function(t,e){t.API.adler32cs=function(){var t="function"==typeof ArrayBuffer&&"function"==typeof Uint8Array,e=null,r=function(){return t?function(t){return t instanceof ArrayBuffer||null!==e&&t instanceof e}:function(){return!1}}(),n=function(){return null!==e?function(t){return new e(t,"utf8").toString("binary")}:function(t){return unescape(encodeURIComponent(t))}}(),a=function(t,e){for(var r=65535&t,n=t>>>16,a=0,i=e.length;a<i;a++)r=(r+(255&e.charCodeAt(a)))%65521,n=(n+r)%65521;return(n<<16|r)>>>0},i=function(t,e){for(var r=65535&t,n=t>>>16,a=0,i=e.length;a<i;a++)r=(r+e[a])%65521,n=(n+r)%65521;return(n<<16|r)>>>0},o={},s=o.Adler32=function(){var e=function(t){if(!(this instanceof e))throw new TypeError("Constructor cannot called be as a function.");if(!isFinite(t=null==t?1:+t))throw new Error("First arguments needs to be a finite number.");this.checksum=t>>>0},o=e.prototype={};return o.constructor=e,e.from=function(t){return t.prototype=o,t}(function(t){if(!(this instanceof e))throw new TypeError("Constructor cannot called be as a function.");if(null==t)throw new Error("First argument needs to be a string.");this.checksum=a(1,t.toString())}),e.fromUtf8=function(t){return t.prototype=o,t}(function(t){if(!(this instanceof e))throw new TypeError("Constructor cannot called be as a function.");if(null==t)throw new Error("First argument needs to be a string.");var r=n(t.toString());this.checksum=a(1,r)}),t&&(e.fromBuffer=function(t){return t.prototype=o,t}(function(t){if(!(this instanceof e))throw new TypeError("Constructor cannot called be as a function.");if(!r(t))throw new Error("First argument needs to be ArrayBuffer.");var n=new Uint8Array(t);return this.checksum=i(1,n)})),o.update=function(t){if(null==t)throw new Error("First argument needs to be a string.");return t=t.toString(),this.checksum=a(this.checksum,t)},o.updateUtf8=function(t){if(null==t)throw new Error("First argument needs to be a string.");var e=n(t.toString());return this.checksum=a(this.checksum,e)
},t&&(o.updateBuffer=function(t){if(!r(t))throw new Error("First argument needs to be ArrayBuffer.");var e=new Uint8Array(t);return this.checksum=i(this.checksum,e)}),o.clone=function(){return new s(this.checksum)},e}();return o.from=function(t){if(null==t)throw new Error("First argument needs to be a string.");return a(1,t.toString())},o.fromUtf8=function(t){if(null==t)throw new Error("First argument needs to be a string.");var e=n(t.toString());return a(1,e)},t&&(o.fromBuffer=function(t){if(!r(t))throw new Error("First argument need to be ArrayBuffer.");var e=new Uint8Array(t);return i(1,e)}),o}()}(c),function(t){var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"];t.__bidiEngine__=t.prototype.__bidiEngine__=function(t){var e,n,a,i,o,s,c,l=r,u=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],f=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],$={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},_={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},d=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],p=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),h=!1,g=0;this.__bidiEngine__={};var m=function(t,e){if(e)for(var r=0;r<t.length;r++)e[r]=r;void 0===i&&(i=y(t)),void 0===s&&(s=y(t))},v=function(t){var e=t.charCodeAt(),r=e>>8,n=_[r];return void 0!==n?l[256*n+(255&e)]:252===r||253===r?"AL":p.test(r)?"L":8===r?"R":"N"},y=function(t){for(var e,r=0;r<t.length;r++){if("L"===(e=v(t.charAt(r))))return!1;if("R"===e)return!0}return!1},b=function(t,r,o,s){var c,l,u,f,$=r[s];switch($){case"L":case"R":h=!1;break;case"N":case"AN":break;case"EN":h&&($="AN");break;case"AL":h=!0,$="R";break;case"WS":$="N";break;case"CS":s<1||s+1>=r.length||"EN"!==(c=o[s-1])&&"AN"!==c||"EN"!==(l=r[s+1])&&"AN"!==l?$="N":h&&(l="AN"),$=l===c?l:"N";break;case"ES":c=s>0?o[s-1]:"B",$="EN"===c&&s+1<r.length&&"EN"===r[s+1]?"EN":"N";break;case"ET":if(s>0&&"EN"===o[s-1]){$="EN";break}if(h){$="N";break}for(u=s+1,f=r.length;u<f&&"ET"===r[u];)u++;$=u<f&&"EN"===r[u]?"EN":"N";break;case"NSM":if(a&&!i){for(f=r.length,u=s+1;u<f&&"NSM"===r[u];)u++;if(u<f){var _=t[s],d=_>=1425&&_<=2303||64286===_;if(c=r[u],d&&("R"===c||"AL"===c)){$="R";break}}}$=s<1||"B"===(c=r[s-1])?"N":o[s-1];break;case"B":h=!1,e=!0,$=g;break;case"S":n=!0,$="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":h=!1;break;case"BN":$="N"}return $},w=function(t,e,r){for(var n=0;n<r;n++)if("S"===t[n]){e[n]=g;for(var a=n-1;a>=0&&"WS"===t[a];a--)e[a]=g}},x=function(t,e,r){var n=t.split("");return r&&A(n,r,{hiLevel:g}),n.reverse(),e&&e.reverse(),n.join("")},A=function(t,r,a){var i,o,s,c,l,_=-1,d=t.length,p=0,m=[],y=g?f:u,x=[];for(h=!1,e=!1,n=!1,o=0;o<d;o++)x[o]=v(t[o]);for(s=0;s<d;s++){if(l=p,m[s]=b(t,x,m,s),p=y[l][$[m[s]]],i=240&p,p&=15,r[s]=c=y[p][5],i>0)if(16===i){for(o=_;o<s;o++)r[o]=1;_=-1}else _=-1;if(y[p][6])-1===_&&(_=s);else if(_>-1){for(o=_;o<s;o++)r[o]=c;_=-1}"B"===x[s]&&(r[s]=0),a.hiLevel|=c}n&&w(x,r,d)},k=function(t,r,n,a,i){if(!(i.hiLevel<t)){if(1===t&&1===g&&!e)return r.reverse(),void(n&&n.reverse());for(var o,s,c,l,u=r.length,f=0;f<u;){if(a[f]>=t){for(c=f+1;c<u&&a[c]>=t;)c++;for(l=f,s=c-1;l<s;l++,s--)o=r[l],r[l]=r[s],r[s]=o,n&&(o=n[l],n[l]=n[s],n[s]=o);f=c}f++}}},E=function(t,e,r){if(0!==r.hiLevel&&c)for(var n,a=0;a<t.length;a++)1===e[a]&&(n=d.indexOf(t[a]))>=0&&(t[a]=d[n+1])},S=function(t,e,r){var n=t.split(""),a={hiLevel:g};return r||(r=[]),A(n,r,a),E(n,r,a),k(2,n,e,r,a),k(1,n,e,r,a),n.join("")};return this.__bidiEngine__.doBidiReorder=function(t,e,r){if(m(t,e),a||!o||s)if(a&&o&&i^s)g=i?1:0,t=x(t,e,r);else if(!a&&o&&s)g=i?1:0,t=S(t,e,r),t=x(t,e);else if(!a||i||o||s){if(a&&!o&&i^s)t=x(t,e),i?(g=0,t=S(t,e,r)):(g=1,t=S(t,e,r),t=x(t,e));else if(a&&i&&!o&&s)g=1,t=S(t,e,r),t=x(t,e);else if(!a&&!o&&i^s){var n=c;i?(g=1,t=S(t,e,r),g=0,c=!1,t=S(t,e,r),c=n):(g=0,t=S(t,e,r),t=x(t,e),g=1,c=!1,t=S(t,e,r),c=n,t=x(t,e))}}else g=0,t=S(t,e,r);else g=i?1:0,t=S(t,e,r);return t},this.__bidiEngine__.setOptions=function(t){t&&(a=t.isInputVisual,o=t.isOutputVisual,i=t.isInputRtl,s=t.isOutputRtl,c=t.isSymmetricSwapping)},this.__bidiEngine__.setOptions(t),this.__bidiEngine__};var r=e,n=new t.__bidiEngine__({isInputVisual:!0}),a=function(t){var e=t.text,r=(t.x,t.y,t.options,t.mutex,[]);if("[object Array]"===Object.prototype.toString.call(e)){var a=0;for(r=[],a=0;a<e.length;a+=1)"[object Array]"===Object.prototype.toString.call(e[a])?r.push([n.doBidiReorder(e[a][0]),e[a][1],e[a][2]]):r.push([n.doBidiReorder(e[a])]);t.text=r}else t.text=n.doBidiReorder(e)};t.API.events.push(["postProcessText",a])}(c);try{e.exports=a}catch(t){}i.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,16===this.bitPP&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=0===this.colors?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:a,green:n,blue:r,quad:i}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},i.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(t){console.log("bit decode error:"+t)}},i.prototype.bit1=function(){for(var t=Math.ceil(this.width/8),e=t%4,r=this.height>=0?this.height-1:-this.height,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<t;a++)for(var i=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+8*a*4,s=0;s<8&&8*a+s<this.width;s++){var c=this.palette[i>>7-s&1];this.data[o+4*s]=c.blue,this.data[o+4*s+1]=c.green,this.data[o+4*s+2]=c.red,this.data[o+4*s+3]=255}0!=e&&(this.pos+=4-e)}},i.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<t;a++){var i=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+2*a*4,s=i>>4,c=15&i,l=this.palette[s];if(this.data[o]=l.blue,this.data[o+1]=l.green,this.data[o+2]=l.red,this.data[o+3]=255,2*a+1>=this.width)break;l=this.palette[c],this.data[o+4]=l.blue,this.data[o+4+1]=l.green,this.data[o+4+2]=l.red,this.data[o+4+3]=255}0!=e&&(this.pos+=4-e)}},i.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var a=this.datav.getUint8(this.pos++,!0),i=r*this.width*4+4*n;if(a<this.palette.length){var o=this.palette[a];this.data[i]=o.red,this.data[i+1]=o.green,this.data[i+2]=o.blue,this.data[i+3]=255}else this.data[i]=255,this.data[i+1]=255,this.data[i+2]=255,this.data[i+3]=255}0!=t&&(this.pos+=4-t)}},i.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),r=e,n=this.height-1;n>=0;n--){for(var a=this.bottom_up?n:this.height-1-n,i=0;i<this.width;i++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var s=(o&r)/r*255|0,c=(o>>5&r)/r*255|0,l=(o>>10&r)/r*255|0,u=o>>15?255:0,f=a*this.width*4+4*i;this.data[f]=l,this.data[f+1]=c,this.data[f+2]=s,this.data[f+3]=u}this.pos+=t}},i.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),r=e,n=parseInt("111111",2),a=n,i=this.height-1;i>=0;i--){for(var o=this.bottom_up?i:this.height-1-i,s=0;s<this.width;s++){var c=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(c&r)/r*255|0,u=(c>>5&a)/a*255|0,f=(c>>11)/r*255|0,$=o*this.width*4+4*s;this.data[$]=f,this.data[$+1]=u,this.data[$+2]=l,this.data[$+3]=255}this.pos+=t}},i.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*r;this.data[o]=i,this.data[o+1]=a,this.data[o+2]=n,this.data[o+3]=255}this.pos+=this.width%4}},i.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),s=e*this.width*4+4*r;this.data[s]=i,this.data[s+1]=a,this.data[s+2]=n,this.data[s+3]=o}},i.prototype.getData=function(){return this.data};try{e.exports=function(t){var e=new i(t);return{data:e.getData(),width:e.width,height:e.height}}}catch(t){}window.tmp=i,function(t){function e(){function t(t){var e,r,a,i,o,s,l=n.dyn_tree,u=n.stat_desc.static_tree,f=n.stat_desc.extra_bits,$=n.stat_desc.extra_base,d=n.stat_desc.max_length,p=0;for(i=0;i<=c;i++)t.bl_count[i]=0;for(l[2*t.heap[t.heap_max]+1]=0,e=t.heap_max+1;e<_;e++)r=t.heap[e],i=l[2*l[2*r+1]+1]+1,i>d&&(i=d,p++),l[2*r+1]=i,r>n.max_code||(t.bl_count[i]++,o=0,r>=$&&(o=f[r-$]),s=l[2*r],t.opt_len+=s*(i+o),u&&(t.static_len+=s*(u[2*r+1]+o)));if(0!==p){do{for(i=d-1;0===t.bl_count[i];)i--;t.bl_count[i]--,t.bl_count[i+1]+=2,t.bl_count[d]--,p-=2}while(p>0);for(i=d;0!==i;i--)for(r=t.bl_count[i];0!==r;)(a=t.heap[--e])>n.max_code||(l[2*a+1]!=i&&(t.opt_len+=(i-l[2*a+1])*l[2*a],l[2*a+1]=i),r--)}}function e(t,e){var r=0;do{r|=1&t,t>>>=1,r<<=1}while(--e>0);return r>>>1}function r(t,r,n){var a,i,o,s=[],l=0;for(a=1;a<=c;a++)s[a]=l=l+n[a-1]<<1;for(i=0;i<=r;i++)0!==(o=t[2*i+1])&&(t[2*i]=e(s[o]++,o))}var n=this;n.build_tree=function(e){var a,i,o,s=n.dyn_tree,c=n.stat_desc.static_tree,l=n.stat_desc.elems,u=-1;for(e.heap_len=0,e.heap_max=_,a=0;a<l;a++)0!==s[2*a]?(e.heap[++e.heap_len]=u=a,e.depth[a]=0):s[2*a+1]=0;for(;e.heap_len<2;)o=e.heap[++e.heap_len]=u<2?++u:0,s[2*o]=1,e.depth[o]=0,e.opt_len--,c&&(e.static_len-=c[2*o+1]);for(n.max_code=u,a=Math.floor(e.heap_len/2);a>=1;a--)e.pqdownheap(s,a);o=l;do{a=e.heap[1],e.heap[1]=e.heap[e.heap_len--],e.pqdownheap(s,1),i=e.heap[1],e.heap[--e.heap_max]=a,e.heap[--e.heap_max]=i,s[2*o]=s[2*a]+s[2*i],e.depth[o]=Math.max(e.depth[a],e.depth[i])+1,s[2*a+1]=s[2*i+1]=o,e.heap[1]=o++,e.pqdownheap(s,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],t(e),r(s,n.max_code,e.bl_count)}}function r(t,e,r,n,a){var i=this;i.static_tree=t,i.extra_bits=e,i.extra_base=r,i.elems=n,i.max_length=a}function n(t,e,r,n,a){var i=this;i.good_length=t,i.max_lazy=e,i.nice_length=r,i.max_chain=n,i.func=a}function a(t,e,r,n){var a=t[2*e],i=t[2*r];return a<i||a==i&&n[e]<=n[r]}function i(){function t(){var t;for(Ct=2*kt,Ot[Lt-1]=0,t=0;t<Lt-1;t++)Ot[t]=0;Yt=R[Vt].max_lazy,Xt=R[Vt].good_length,Jt=R[Vt].nice_length,Gt=R[Vt].max_chain,Dt=0,jt=0,Ut=0,Ft=Ht=Z-1,qt=0,Pt=0}function n(){var t;for(t=0;t<$;t++)Wt[2*t]=0;for(t=0;t<l;t++)Kt[2*t]=0;for(t=0;t<u;t++)Zt[2*t]=0;Wt[2*d]=1,te.opt_len=te.static_len=0,oe=ce=0}function i(){ee.dyn_tree=Wt,ee.stat_desc=r.static_l_desc,re.dyn_tree=Kt,re.stat_desc=r.static_d_desc,ne.dyn_tree=Zt,ne.stat_desc=r.static_bl_desc,ue=0,fe=0,le=8,n()}function o(t,e){var r,n,a=-1,i=t[1],o=0,s=7,c=4;for(0===i&&(s=138,c=3),t[2*(e+1)+1]=65535,r=0;r<=e;r++)n=i,i=t[2*(r+1)+1],++o<s&&n==i||(o<c?Zt[2*n]+=o:0!==n?(n!=a&&Zt[2*n]++,Zt[2*p]++):o<=10?Zt[2*h]++:Zt[2*g]++,o=0,a=n,0===i?(s=138,c=3):n==i?(s=6,c=3):(s=7,c=4))}function s(){var t;for(o(Wt,ee.max_code),o(Kt,re.max_code),ne.build_tree(te),t=u-1;t>=3&&0===Zt[2*e.bl_order[t]+1];t--);return te.opt_len+=3*(t+1)+5+5+4,t}function c(t){te.pending_buf[te.pending++]=t}function _(t){c(255&t),c(t>>>8&255)}function L(t){c(t>>8&255),c(255&t)}function rt(t,e){var r,n=e;fe>m-n?(r=t,ue|=r<<fe&65535,_(ue),ue=r>>>m-fe,fe+=n-m):(ue|=t<<fe&65535,fe+=n)}function nt(t,e){var r=2*t;rt(65535&e[r],65535&e[r+1])}function at(t,e){var r,n,a=-1,i=t[1],o=0,s=7,c=4;for(0===i&&(s=138,c=3),r=0;r<=e;r++)if(n=i,i=t[2*(r+1)+1],!(++o<s&&n==i)){if(o<c)do{nt(n,Zt)}while(0!=--o);else 0!==n?(n!=a&&(nt(n,Zt),o--),nt(p,Zt),rt(o-3,2)):o<=10?(nt(h,Zt),rt(o-3,3)):(nt(g,Zt),rt(o-11,7));o=0,a=n,0===i?(s=138,c=3):n==i?(s=6,c=3):(s=7,c=4)}}function it(t,r,n){var a;for(rt(t-257,5),rt(r-1,5),rt(n-4,4),a=0;a<n;a++)rt(Zt[2*e.bl_order[a]+1],3);at(Wt,t-1),at(Kt,r-1)}function ot(){16==fe?(_(ue),ue=0,fe=0):fe>=8&&(c(255&ue),ue>>>=8,fe-=8)}function st(){rt(W<<1,3),nt(d,r.static_ltree),ot(),1+le+10-fe<9&&(rt(W<<1,3),nt(d,r.static_ltree),ot()),le=7}function ct(t,r){var n,a,i;if(te.pending_buf[se+2*oe]=t>>>8&255,te.pending_buf[se+2*oe+1]=255&t,te.pending_buf[ae+oe]=255&r,oe++,0===t?Wt[2*r]++:(ce++,t--,Wt[2*(e._length_code[r]+f+1)]++,Kt[2*e.d_code(t)]++),0==(8191&oe)&&Vt>2){for(n=8*oe,a=Dt-jt,i=0;i<l;i++)n+=Kt[2*i]*(5+e.extra_dbits[i]);if(n>>>=3,ce<Math.floor(oe/2)&&n<Math.floor(a/2))return!0}return oe==ie-1}function lt(t,r){var n,a,i,o,s=0;if(0!==oe)do{n=te.pending_buf[se+2*s]<<8&65280|255&te.pending_buf[se+2*s+1],a=255&te.pending_buf[ae+s],s++,0===n?nt(a,t):(i=e._length_code[a],nt(i+f+1,t),o=e.extra_lbits[i],0!==o&&(a-=e.base_length[i],rt(a,o)),n--,i=e.d_code(n),nt(i,r),0!==(o=e.extra_dbits[i])&&(n-=e.base_dist[i],rt(n,o)))}while(s<oe);nt(d,t),le=t[2*d+1]}function ut(){fe>8?_(ue):fe>0&&c(255&ue),ue=0,fe=0}function ft(t,e,r){ut(),le=8,r&&(_(e),_(~e)),te.pending_buf.set(Nt.subarray(t,t+e),te.pending),te.pending+=e}function $t(t,e,r){rt((J<<1)+(r?1:0),3),ft(t,e,!0)}function _t(t,e,a){var i,o,c=0;Vt>0?(ee.build_tree(te),re.build_tree(te),c=s(),i=te.opt_len+3+7>>>3,(o=te.static_len+3+7>>>3)<=i&&(i=o)):i=o=e+5,e+4<=i&&-1!=t?$t(t,e,a):o==i?(rt((W<<1)+(a?1:0),3),lt(r.static_ltree,r.static_dtree)):(rt((K<<1)+(a?1:0),3),it(ee.max_code+1,re.max_code+1,c+1),lt(Wt,Kt)),n(),a&&ut()}function dt(t){_t(jt>=0?jt:-1,Dt-jt,t),jt=Dt,bt.flush_pending()}function pt(){var t,e,r,n;do{if(0===(n=Ct-Ut-Dt)&&0===Dt&&0===Ut)n=kt;else if(-1==n)n--;else if(Dt>=kt+kt-et){Nt.set(Nt.subarray(kt,kt+kt),0),zt-=kt,Dt-=kt,jt-=kt,t=Lt,r=t;do{e=65535&Ot[--r],Ot[r]=e>=kt?e-kt:0}while(0!=--t);t=kt,r=t;do{e=65535&It[--r],It[r]=e>=kt?e-kt:0}while(0!=--t);n+=kt}if(0===bt.avail_in)return;t=bt.read_buf(Nt,Dt+Ut,n),Ut+=t,Ut>=Z&&(Pt=255&Nt[Dt],Pt=(Pt<<Bt^255&Nt[Dt+1])&Tt)}while(Ut<et&&0!==bt.avail_in)}function ht(t){var e,r=65535;for(r>xt-5&&(r=xt-5);;){if(Ut<=1){if(pt(),0===Ut&&t==x)return D;if(0===Ut)break}if(Dt+=Ut,Ut=0,e=jt+r,(0===Dt||Dt>=e)&&(Ut=Dt-e,Dt=e,dt(!1),0===bt.avail_out))return D;if(Dt-jt>=kt-et&&(dt(!1),0===bt.avail_out))return D}return dt(t==E),0===bt.avail_out?t==E?U:D:t==E?H:z}function gt(t){var e,r,n=Gt,a=Dt,i=Ht,o=Dt>kt-et?Dt-(kt-et):0,s=Jt,c=St,l=Dt+tt,u=Nt[a+i-1],f=Nt[a+i];Ht>=Xt&&(n>>=2),s>Ut&&(s=Ut);do{if(e=t,Nt[e+i]==f&&Nt[e+i-1]==u&&Nt[e]==Nt[a]&&Nt[++e]==Nt[a+1]){a+=2,e++;do{}while(Nt[++a]==Nt[++e]&&Nt[++a]==Nt[++e]&&Nt[++a]==Nt[++e]&&Nt[++a]==Nt[++e]&&Nt[++a]==Nt[++e]&&Nt[++a]==Nt[++e]&&Nt[++a]==Nt[++e]&&Nt[++a]==Nt[++e]&&a<l);if(r=tt-(l-a),a=l-tt,r>i){if(zt=t,i=r,r>=s)break;u=Nt[a+i-1],f=Nt[a+i]}}}while((t=65535&It[t&c])>o&&0!=--n);return i<=Ut?i:Ut}function mt(t){for(var e,r=0;;){if(Ut<et){if(pt(),Ut<et&&t==x)return D;if(0===Ut)break}if(Ut>=Z&&(Pt=(Pt<<Bt^255&Nt[Dt+(Z-1)])&Tt,r=65535&Ot[Pt],It[Dt&St]=Ot[Pt],Ot[Pt]=Dt),0!==r&&(Dt-r&65535)<=kt-et&&Qt!=b&&(Ft=gt(r)),Ft>=Z)if(e=ct(Dt-zt,Ft-Z),Ut-=Ft,Ft<=Yt&&Ut>=Z){Ft--;do{Dt++,Pt=(Pt<<Bt^255&Nt[Dt+(Z-1)])&Tt,r=65535&Ot[Pt],It[Dt&St]=Ot[Pt],Ot[Pt]=Dt}while(0!=--Ft);Dt++}else Dt+=Ft,Ft=0,Pt=255&Nt[Dt],Pt=(Pt<<Bt^255&Nt[Dt+1])&Tt;else e=ct(0,255&Nt[Dt]),Ut--,Dt++;if(e&&(dt(!1),0===bt.avail_out))return D}return dt(t==E),0===bt.avail_out?t==E?U:D:t==E?H:z}function vt(t){for(var e,r,n=0;;){if(Ut<et){if(pt(),Ut<et&&t==x)return D;if(0===Ut)break}if(Ut>=Z&&(Pt=(Pt<<Bt^255&Nt[Dt+(Z-1)])&Tt,n=65535&Ot[Pt],It[Dt&St]=Ot[Pt],Ot[Pt]=Dt),Ht=Ft,Rt=zt,Ft=Z-1,0!==n&&Ht<Yt&&(Dt-n&65535)<=kt-et&&(Qt!=b&&(Ft=gt(n)),Ft<=5&&(Qt==y||Ft==Z&&Dt-zt>4096)&&(Ft=Z-1)),Ht>=Z&&Ft<=Ht){r=Dt+Ut-Z,e=ct(Dt-1-Rt,Ht-Z),Ut-=Ht-1,Ht-=2;do{++Dt<=r&&(Pt=(Pt<<Bt^255&Nt[Dt+(Z-1)])&Tt,n=65535&Ot[Pt],It[Dt&St]=Ot[Pt],Ot[Pt]=Dt)}while(0!=--Ht);if(qt=0,Ft=Z-1,Dt++,e&&(dt(!1),0===bt.avail_out))return D}else if(0!==qt){if(e=ct(0,255&Nt[Dt-1]),e&&dt(!1),Dt++,Ut--,0===bt.avail_out)return D}else qt=1,Dt++,Ut--}return 0!==qt&&(e=ct(0,255&Nt[Dt-1]),qt=0),dt(t==E),0===bt.avail_out?t==E?U:D:t==E?H:z}function yt(e){return e.total_in=e.total_out=0,e.msg=null,te.pending=0,te.pending_out=0,wt=V,At=x,i(),t(),S}var bt,wt,xt,At,kt,Et,St,Nt,Ct,It,Ot,Pt,Lt,Mt,Tt,Bt,jt,Ft,Rt,qt,Dt,zt,Ut,Ht,Gt,Yt,Vt,Qt,Xt,Jt,Wt,Kt,Zt,te=this,ee=new e,re=new e,ne=new e;te.depth=[];var ae,ie,oe,se,ce,le,ue,fe;te.bl_count=[],te.heap=[],Wt=[],Kt=[],Zt=[],te.pqdownheap=function(t,e){for(var r=te.heap,n=r[e],i=e<<1;i<=te.heap_len&&(i<te.heap_len&&a(t,r[i+1],r[i],te.depth)&&i++,!a(t,n,r[i],te.depth));)r[e]=r[i],e=i,i<<=1;r[e]=n},te.deflateInit=function(t,e,r,n,a,i){return n||(n=X),a||(a=T),i||(i=w),t.msg=null,e==v&&(e=6),a<1||a>M||n!=X||r<9||r>15||e<0||e>9||i<0||i>b?I:(t.dstate=te,Et=r,kt=1<<Et,St=kt-1,Mt=a+7,Lt=1<<Mt,Tt=Lt-1,Bt=Math.floor((Mt+Z-1)/Z),Nt=new Uint8Array(2*kt),It=[],Ot=[],ie=1<<a+6,te.pending_buf=new Uint8Array(4*ie),xt=4*ie,se=Math.floor(ie/2),ae=3*ie,Vt=e,Qt=i,yt(t))},te.deflateEnd=function(){return wt!=Y&&wt!=V&&wt!=Q?I:(te.pending_buf=null,Ot=null,It=null,Nt=null,te.dstate=null,wt==V?O:S)},te.deflateParams=function(t,e,r){var n=S;return e==v&&(e=6),e<0||e>9||r<0||r>b?I:(R[Vt].func!=R[e].func&&0!==t.total_in&&(n=t.deflate(A)),Vt!=e&&(Vt=e,Yt=R[Vt].max_lazy,Xt=R[Vt].good_length,Jt=R[Vt].nice_length,Gt=R[Vt].max_chain),Qt=r,n)},te.deflateSetDictionary=function(t,e,r){var n,a=r,i=0;if(!e||wt!=Y)return I;if(a<Z)return S;for(a>kt-et&&(a=kt-et,i=r-a),Nt.set(e.subarray(i,i+a),0),Dt=a,jt=a,Pt=255&Nt[0],Pt=(Pt<<Bt^255&Nt[1])&Tt,n=0;n<=a-Z;n++)Pt=(Pt<<Bt^255&Nt[n+(Z-1)])&Tt,It[n&St]=Ot[Pt],Ot[Pt]=n;return S},te.deflate=function(t,e){var r,n,a,i,o;if(e>E||e<0)return I;if(!t.next_out||!t.next_in&&0!==t.avail_in||wt==Q&&e!=E)return t.msg=q[C-I],I;if(0===t.avail_out)return t.msg=q[C-P],P;if(bt=t,i=At,At=e,wt==Y&&(n=X+(Et-8<<4)<<8,a=(Vt-1&255)>>1,a>3&&(a=3),n|=a<<6,0!==Dt&&(n|=G),n+=31-n%31,wt=V,L(n)),0!==te.pending){if(bt.flush_pending(),0===bt.avail_out)return At=-1,S}else if(0===bt.avail_in&&e<=i&&e!=E)return bt.msg=q[C-P],P;if(wt==Q&&0!==bt.avail_in)return t.msg=q[C-P],P;if(0!==bt.avail_in||0!==Ut||e!=x&&wt!=Q){switch(o=-1,R[Vt].func){case B:o=ht(e);break;case j:o=mt(e);break;case F:o=vt(e)}if(o!=U&&o!=H||(wt=Q),o==D||o==U)return 0===bt.avail_out&&(At=-1),S;if(o==z){if(e==A)st();else if($t(0,0,!1),e==k)for(r=0;r<Lt;r++)Ot[r]=0;if(bt.flush_pending(),0===bt.avail_out)return At=-1,S}}return e!=E?S:N}}function o(){var t=this;t.next_in_index=0,t.next_out_index=0,t.avail_in=0,t.total_in=0,t.avail_out=0,t.total_out=0}function s(t){var e=this,r=new o,n=x,a=new Uint8Array(512),i=t?t.level:v;void 0===i&&(i=v),r.deflateInit(i),r.next_out=a,e.append=function(t,e){var i,o=[],s=0,c=0,l=0;if(t.length){r.next_in_index=0,r.next_in=t,r.avail_in=t.length;do{if(r.next_out_index=0,r.avail_out=512,r.deflate(n)!=S)throw new Error("deflating: "+r.msg);r.next_out_index&&(512==r.next_out_index?o.push(new Uint8Array(a)):o.push(new Uint8Array(a.subarray(0,r.next_out_index)))),l+=r.next_out_index,e&&r.next_in_index>0&&r.next_in_index!=s&&(e(r.next_in_index),s=r.next_in_index)}while(r.avail_in>0||0===r.avail_out);return i=new Uint8Array(l),o.forEach(function(t){i.set(t,c),c+=t.length}),i}},e.flush=function(){var t,e,n=[],i=0,o=0;do{if(r.next_out_index=0,r.avail_out=512,(t=r.deflate(E))!=N&&t!=S)throw new Error("deflating: "+r.msg);512-r.avail_out>0&&n.push(new Uint8Array(a.subarray(0,r.next_out_index))),o+=r.next_out_index}while(r.avail_in>0||0===r.avail_out);return r.deflateEnd(),e=new Uint8Array(o),n.forEach(function(t){e.set(t,i),i+=t.length}),e}}var c=15,l=30,u=19,f=256,$=f+1+29,_=2*$+1,d=256,p=16,h=17,g=18,m=16,v=-1,y=1,b=2,w=0,x=0,A=1,k=3,E=4,S=0,N=1,C=2,I=-2,O=-3,P=-5,L=[0,1,2,3,4,4,5,5,6,6,6,6,7,7,7,7,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,0,0,16,17,18,18,19,19,20,20,20,20,21,21,21,21,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29]
;e._length_code=[0,1,2,3,4,5,6,7,8,8,9,9,10,10,11,11,12,12,12,12,13,13,13,13,14,14,14,14,15,15,15,15,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,28],e.base_length=[0,1,2,3,4,5,6,7,8,10,12,14,16,20,24,28,32,40,48,56,64,80,96,112,128,160,192,224,0],e.base_dist=[0,1,2,3,4,6,8,12,16,24,32,48,64,96,128,192,256,384,512,768,1024,1536,2048,3072,4096,6144,8192,12288,16384,24576],e.d_code=function(t){return t<256?L[t]:L[256+(t>>>7)]},e.extra_lbits=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],e.extra_dbits=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],e.extra_blbits=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],e.bl_order=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],r.static_ltree=[12,8,140,8,76,8,204,8,44,8,172,8,108,8,236,8,28,8,156,8,92,8,220,8,60,8,188,8,124,8,252,8,2,8,130,8,66,8,194,8,34,8,162,8,98,8,226,8,18,8,146,8,82,8,210,8,50,8,178,8,114,8,242,8,10,8,138,8,74,8,202,8,42,8,170,8,106,8,234,8,26,8,154,8,90,8,218,8,58,8,186,8,122,8,250,8,6,8,134,8,70,8,198,8,38,8,166,8,102,8,230,8,22,8,150,8,86,8,214,8,54,8,182,8,118,8,246,8,14,8,142,8,78,8,206,8,46,8,174,8,110,8,238,8,30,8,158,8,94,8,222,8,62,8,190,8,126,8,254,8,1,8,129,8,65,8,193,8,33,8,161,8,97,8,225,8,17,8,145,8,81,8,209,8,49,8,177,8,113,8,241,8,9,8,137,8,73,8,201,8,41,8,169,8,105,8,233,8,25,8,153,8,89,8,217,8,57,8,185,8,121,8,249,8,5,8,133,8,69,8,197,8,37,8,165,8,101,8,229,8,21,8,149,8,85,8,213,8,53,8,181,8,117,8,245,8,13,8,141,8,77,8,205,8,45,8,173,8,109,8,237,8,29,8,157,8,93,8,221,8,61,8,189,8,125,8,253,8,19,9,275,9,147,9,403,9,83,9,339,9,211,9,467,9,51,9,307,9,179,9,435,9,115,9,371,9,243,9,499,9,11,9,267,9,139,9,395,9,75,9,331,9,203,9,459,9,43,9,299,9,171,9,427,9,107,9,363,9,235,9,491,9,27,9,283,9,155,9,411,9,91,9,347,9,219,9,475,9,59,9,315,9,187,9,443,9,123,9,379,9,251,9,507,9,7,9,263,9,135,9,391,9,71,9,327,9,199,9,455,9,39,9,295,9,167,9,423,9,103,9,359,9,231,9,487,9,23,9,279,9,151,9,407,9,87,9,343,9,215,9,471,9,55,9,311,9,183,9,439,9,119,9,375,9,247,9,503,9,15,9,271,9,143,9,399,9,79,9,335,9,207,9,463,9,47,9,303,9,175,9,431,9,111,9,367,9,239,9,495,9,31,9,287,9,159,9,415,9,95,9,351,9,223,9,479,9,63,9,319,9,191,9,447,9,127,9,383,9,255,9,511,9,0,7,64,7,32,7,96,7,16,7,80,7,48,7,112,7,8,7,72,7,40,7,104,7,24,7,88,7,56,7,120,7,4,7,68,7,36,7,100,7,20,7,84,7,52,7,116,7,3,8,131,8,67,8,195,8,35,8,163,8,99,8,227,8],r.static_dtree=[0,5,16,5,8,5,24,5,4,5,20,5,12,5,28,5,2,5,18,5,10,5,26,5,6,5,22,5,14,5,30,5,1,5,17,5,9,5,25,5,5,5,21,5,13,5,29,5,3,5,19,5,11,5,27,5,7,5,23,5],r.static_l_desc=new r(r.static_ltree,e.extra_lbits,f+1,$,c),r.static_d_desc=new r(r.static_dtree,e.extra_dbits,0,l,c),r.static_bl_desc=new r(null,e.extra_blbits,0,u,7);var M=9,T=8,B=0,j=1,F=2,R=[new n(0,0,0,0,B),new n(4,4,8,4,j),new n(4,5,16,8,j),new n(4,6,32,32,j),new n(4,4,16,16,F),new n(8,16,32,32,F),new n(8,16,128,128,F),new n(8,32,128,256,F),new n(32,128,258,1024,F),new n(32,258,258,4096,F)],q=["need dictionary","stream end","","","stream error","data error","","buffer error","",""],D=0,z=1,U=2,H=3,G=32,Y=42,V=113,Q=666,X=8,J=0,W=1,K=2,Z=3,tt=258,et=tt+Z+1;o.prototype={deflateInit:function(t,e){var r=this;return r.dstate=new i,e||(e=c),r.dstate.deflateInit(r,t,e)},deflate:function(t){var e=this;return e.dstate?e.dstate.deflate(e,t):I},deflateEnd:function(){var t=this;if(!t.dstate)return I;var e=t.dstate.deflateEnd();return t.dstate=null,e},deflateParams:function(t,e){var r=this;return r.dstate?r.dstate.deflateParams(r,t,e):I},deflateSetDictionary:function(t,e){var r=this;return r.dstate?r.dstate.deflateSetDictionary(r,t,e):I},read_buf:function(t,e,r){var n=this,a=n.avail_in;return a>r&&(a=r),0===a?0:(n.avail_in-=a,t.set(n.next_in.subarray(n.next_in_index,n.next_in_index+a),e),n.next_in_index+=a,n.total_in+=a,a)},flush_pending:function(){var t=this,e=t.dstate.pending;e>t.avail_out&&(e=t.avail_out),0!==e&&(t.next_out.set(t.dstate.pending_buf.subarray(t.dstate.pending_out,t.dstate.pending_out+e),t.next_out_index),t.next_out_index+=e,t.dstate.pending_out+=e,t.total_out+=e,t.avail_out-=e,t.dstate.pending-=e,0===t.dstate.pending&&(t.dstate.pending_out=0))}};var rt=t.zip||t;rt.Deflater=rt._jzlib_Deflater=s}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||"undefined"!=typeof global&&global||Function('return typeof this === "object" && this.content')()||Function("return this")()),function(t){function r(t){this.ok=!1,"#"==t.charAt(0)&&(t=t.substr(1,6)),t=t.replace(/ /g,""),t=t.toLowerCase();var e,r={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};for(var n in r)t==n&&(t=r[n]);for(var a=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(t){return[parseInt(t[1]),parseInt(t[2]),parseInt(t[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}}],i=0;i<a.length;i++){var o=a[i].re,s=a[i].process,c=o.exec(t);c&&(e=s(c),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var t=this.r.toString(16),e=this.g.toString(16),r=this.b.toString(16);return 1==t.length&&(t="0"+t),1==e.length&&(e="0"+e),1==r.length&&(r="0"+r),"#"+t+e+r}}"undefined"!=typeof define&&define.amd?define("RGBColor",function(){return r}):void 0!==e&&e.exports&&(e.exports=r),t.RGBColor=r}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||"undefined"!=typeof global&&global||Function('return typeof this === "object" && this.content')()||Function("return this")()),function(t){var e="+".charCodeAt(0),r="/".charCodeAt(0),n="0".charCodeAt(0),a="a".charCodeAt(0),i="A".charCodeAt(0),o="-".charCodeAt(0),s="_".charCodeAt(0),c=function(t){function e(t){s[u++]=t}var r,n,a,i,o,s;if(t.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var c=t.length;o="="===t.charAt(c-2)?2:"="===t.charAt(c-1)?1:0,s=new Uint8Array(3*t.length/4-o),a=o>0?t.length-4:t.length;var u=0;for(r=0,n=0;r<a;r+=4,n+=3)i=l(t.charAt(r))<<18|l(t.charAt(r+1))<<12|l(t.charAt(r+2))<<6|l(t.charAt(r+3)),e((16711680&i)>>16),e((65280&i)>>8),e(255&i);return 2===o?(i=l(t.charAt(r))<<2|l(t.charAt(r+1))>>4,e(255&i)):1===o&&(i=l(t.charAt(r))<<10|l(t.charAt(r+1))<<4|l(t.charAt(r+2))>>2,e(i>>8&255),e(255&i)),s},l=function(t){var c=t.charCodeAt(0);return c===e||c===o?62:c===r||c===s?63:c<n?-1:c<n+10?c-n+26+26:c<i+26?c-i:c<a+26?c-a+26:void 0};t.API.TTFFont=function(){function t(t,e,r){var n;if(this.rawData=t,n=this.contents=new f(t),this.contents.pos=4,"ttcf"===n.readString(4)){if(!e)throw new Error("Must specify a font name for TTC files.");throw new Error("Font "+e+" not found in TTC file.")}n.pos=0,this.parse(),this.subset=new O(this),this.registerTTF()}return t.open=function(e,r,n,a){var i;return i=c(n),new t(i,r,a)},t.prototype.parse=function(){return this.directory=new $(this.contents),this.head=new p(this),this.name=new w(this),this.cmap=new g(this),this.toUnicode=new Map,this.hhea=new m(this),this.maxp=new x(this),this.hmtx=new A(this),this.post=new y(this),this.os2=new v(this),this.loca=new C(this),this.glyf=new E(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var t,e,r,n,a;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=function(){var e,r,n,a;for(n=this.bbox,a=[],e=0,r=n.length;e<r;e++)t=n[e],a.push(Math.round(t*this.scaleFactor));return a}.call(this),this.stemV=0,this.post.exists?(n=this.post.italic_angle,e=n>>16,r=255&n,!0&e&&(e=-(1+(65535^e))),this.italicAngle=+(e+"."+r)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=1===(a=this.familyClass)||2===a||3===a||4===a||5===a||7===a,this.isScript=10===this.familyClass,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),0!==this.italicAngle&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(t){var e;return(null!=(e=this.cmap.unicode)?e.codeMap[t]:void 0)||0},t.prototype.widthOfGlyph=function(t){var e;return e=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*e},t.prototype.widthOfString=function(t,e,r){var n,a,i,o,s,c,r;for(t=""+t,o=0,a=s=0,c=t.length;0<=c?s<c:s>c;a=0<=c?++s:--s)n=t.charCodeAt(a),o+=this.widthOfGlyph(this.characterToGlyph(n))+r*(1e3/e)||0;return i=e/1e3,o*i},t.prototype.lineHeight=function(t,e){var r;return null==e&&(e=!1),r=e?this.lineGap:0,(this.ascender+r-this.decender)/1e3*t},t}();var u,f=function(){function t(t){this.data=null!=t?t:[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(t){return this.data[this.pos++]=t},t.prototype.readUInt32=function(){var t,e,r,n;return t=16777216*this.readByte(),e=this.readByte()<<16,r=this.readByte()<<8,n=this.readByte(),t+e+r+n},t.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},t.prototype.readInt32=function(){var t;return t=this.readUInt32(),t>=2147483648?t-4294967296:t},t.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},t.prototype.readUInt16=function(){var t,e;return t=this.readByte()<<8,e=this.readByte(),t|e},t.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},t.prototype.readInt16=function(){var t;return t=this.readUInt16(),t>=32768?t-65536:t},t.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},t.prototype.readString=function(t){var e,r,n;for(r=[],e=n=0;0<=t?n<t:n>t;e=0<=t?++n:--n)r[e]=String.fromCharCode(this.readByte());return r.join("")},t.prototype.writeString=function(t){var e,r,n,a;for(a=[],e=r=0,n=t.length;0<=n?r<n:r>n;e=0<=n?++r:--r)a.push(this.writeByte(t.charCodeAt(e)));return a},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(t){return this.writeInt16(t)},t.prototype.readLongLong=function(){var t,e,r,n,a,i,o,s;return t=this.readByte(),e=this.readByte(),r=this.readByte(),n=this.readByte(),a=this.readByte(),i=this.readByte(),o=this.readByte(),s=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^e)+1099511627776*(255^r)+4294967296*(255^n)+16777216*(255^a)+65536*(255^i)+256*(255^o)+(255^s)+1):72057594037927940*t+281474976710656*e+1099511627776*r+4294967296*n+16777216*a+65536*i+256*o+s},t.prototype.writeLongLong=function(t){var e,r;return e=Math.floor(t/4294967296),r=4294967295&t,this.writeByte(e>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e),this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(t){return this.writeInt32(t)},t.prototype.read=function(t){var e,r;for(e=[],r=0;0<=t?r<t:r>t;0<=t?++r:--r)e.push(this.readByte());return e},t.prototype.write=function(t){var e,r,n,a;for(a=[],r=0,n=t.length;r<n;r++)e=t[r],a.push(this.writeByte(e));return a},t}(),$=function(){function t(t){var e,r,n;for(this.scalarType=t.readInt(),this.tableCount=t.readShort(),this.searchRange=t.readShort(),this.entrySelector=t.readShort(),this.rangeShift=t.readShort(),this.tables={},r=0,n=this.tableCount;0<=n?r<n:r>n;0<=n?++r:--r)e={tag:t.readString(4),checksum:t.readInt(),offset:t.readInt(),length:t.readInt()},this.tables[e.tag]=e}var e;return t.prototype.encode=function(t){var r,n,a,i,o,s,c,l,u,$,_,d,p,h;d=Object.keys(t).length,s=Math.log(2),u=16*Math.floor(Math.log(d)/s),i=Math.floor(u/s),l=16*d-u,n=new f,n.writeInt(this.scalarType),n.writeShort(d),n.writeShort(u),n.writeShort(i),n.writeShort(l),a=16*d,c=n.pos+a,o=null,p=[];for(h in t)for(_=t[h],n.writeString(h),n.writeInt(e(_)),n.writeInt(c),n.writeInt(_.length),p=p.concat(_),"head"===h&&(o=c),c+=_.length;c%4;)p.push(0),c++;return n.write(p),$=e(n.data),r=2981146554-$,n.pos=o+8,n.writeUInt32(r),n.data},e=function(t){var e,r,n,a;for(t=k.call(t);t.length%4;)t.push(0);for(r=new f(t),e=0,n=0,a=t.length;n<a;n+=4)e+=r.readUInt32();return 4294967295&e},t}(),_={}.hasOwnProperty,d=function(t,e){function r(){this.constructor=t}for(var n in e)_.call(e,n)&&(t[n]=e[n]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};u=function(){function t(t){var e;this.file=t,e=this.file.directory.tables[this.tag],this.exists=!!e,e&&(this.offset=e.offset,this.length=e.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t}();var p=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.tag="head",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},e.prototype.encode=function(t){var e;return e=new f,e.writeInt(this.version),e.writeInt(this.revision),e.writeInt(this.checkSumAdjustment),e.writeInt(this.magicNumber),e.writeShort(this.flags),e.writeShort(this.unitsPerEm),e.writeLongLong(this.created),e.writeLongLong(this.modified),e.writeShort(this.xMin),e.writeShort(this.yMin),e.writeShort(this.xMax),e.writeShort(this.yMax),e.writeShort(this.macStyle),e.writeShort(this.lowestRecPPEM),e.writeShort(this.fontDirectionHint),e.writeShort(t),e.writeShort(this.glyphDataFormat),e.data},e}(u),h=function(){function t(t,e){var r,n,a,i,o,s,c,l,u,f,$,_,d,p,h,g,m,v,y;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=e+t.readInt(),f=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=3===this.platformID&&1===this.encodingID&&4===this.format||0===this.platformID&&4===this.format,this.codeMap={},this.format){case 0:for(s=g=0;g<256;s=++g)this.codeMap[s]=t.readByte();break;case 4:for(_=t.readUInt16(),$=_/2,t.pos+=6,a=function(){var e,r;for(r=[],s=e=0;0<=$?e<$:e>$;s=0<=$?++e:--e)r.push(t.readUInt16());return r}(),t.pos+=2,p=function(){var e,r;for(r=[],s=e=0;0<=$?e<$:e>$;s=0<=$?++e:--e)r.push(t.readUInt16());return r}(),c=function(){var e,r;for(r=[],s=e=0;0<=$?e<$:e>$;s=0<=$?++e:--e)r.push(t.readUInt16());return r}(),l=function(){var e,r;for(r=[],s=e=0;0<=$?e<$:e>$;s=0<=$?++e:--e)r.push(t.readUInt16());return r}(),n=(this.length-t.pos+this.offset)/2,o=function(){var e,r;for(r=[],s=e=0;0<=n?e<n:e>n;s=0<=n?++e:--e)r.push(t.readUInt16());return r}(),s=m=0,y=a.length;m<y;s=++m)for(h=a[s],d=p[s],r=v=d;d<=h?v<=h:v>=h;r=d<=h?++v:--v)0===l[s]?i=r+c[s]:(u=l[s]/2+(r-d)-($-s),0!==(i=o[u]||0)&&(i+=c[s])),this.codeMap[r]=65535&i}t.pos=f}return t.encode=function(t,e){var r,n,a,i,o,s,c,l,u,$,_,d,p,h,g,m,v,y,b,w,x,A,k,E,S,N,C,I,O,P,L,M,T,B,j,F,R,q,D,z,U,H,G,Y,V,Q;switch(I=new f,i=Object.keys(t).sort(function(t,e){return t-e}),e){case"macroman":for(p=0,h=function(){var t,e;for(e=[],d=t=0;t<256;d=++t)e.push(0);return e}(),m={0:0},a={},O=0,T=i.length;O<T;O++)n=i[O],null==m[G=t[n]]&&(m[G]=++p),a[n]={old:t[n],new:m[t[n]]},h[n]=m[t[n]];return I.writeUInt16(1),I.writeUInt16(0),I.writeUInt32(12),I.writeUInt16(0),I.writeUInt16(262),I.writeUInt16(0),I.write(h),{charMap:a,subtable:I.data,maxGlyphID:p+1};case"unicode":for(N=[],u=[],v=0,m={},r={},g=c=null,P=0,B=i.length;P<B;P++)n=i[P],b=t[n],null==m[b]&&(m[b]=++v),r[n]={old:b,new:m[b]},o=m[b]-n,null!=g&&o===c||(g&&u.push(g),N.push(n),c=o),g=n;for(g&&u.push(g),u.push(65535),N.push(65535),k=N.length,E=2*k,A=2*Math.pow(Math.log(k)/Math.LN2,2),$=Math.log(A/2)/Math.LN2,x=2*k-A,s=[],w=[],_=[],d=L=0,j=N.length;L<j;d=++L){if(S=N[d],l=u[d],65535===S){s.push(0),w.push(0);break}if(C=r[S].new,S-C>=32768)for(s.push(0),w.push(2*(_.length+k-d)),n=M=S;S<=l?M<=l:M>=l;n=S<=l?++M:--M)_.push(r[n].new);else s.push(C-S),w.push(0)}for(I.writeUInt16(3),I.writeUInt16(1),I.writeUInt32(12),I.writeUInt16(4),I.writeUInt16(16+8*k+2*_.length),I.writeUInt16(0),I.writeUInt16(E),I.writeUInt16(A),I.writeUInt16($),I.writeUInt16(x),U=0,F=u.length;U<F;U++)n=u[U],I.writeUInt16(n);for(I.writeUInt16(0),H=0,R=N.length;H<R;H++)n=N[H],I.writeUInt16(n);for(Y=0,q=s.length;Y<q;Y++)o=s[Y],I.writeUInt16(o);for(V=0,D=w.length;V<D;V++)y=w[V],I.writeUInt16(y);for(Q=0,z=_.length;Q<z;Q++)p=_[Q],I.writeUInt16(p);return{charMap:r,subtable:I.data,maxGlyphID:v+1}}},t}(),g=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.tag="cmap",e.prototype.parse=function(t){var e,r,n;for(t.pos=this.offset,this.version=t.readUInt16(),r=t.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=r?n<r:n>r;0<=r?++n:--n)e=new h(t,this.offset),this.tables.push(e),e.isUnicode&&null==this.unicode&&(this.unicode=e);return!0},e.encode=function(t,e){var r,n;return null==e&&(e="macroman"),r=h.encode(t,e),n=new f,n.writeUInt16(0),n.writeUInt16(1),r.table=n.data.concat(r.subtable),r},e}(u),m=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.tag="hhea",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},e}(u),v=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.tag="OS/2",e.prototype.parse=function(t){var e;if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var r,n;for(n=[],e=r=0;r<10;e=++r)n.push(t.readByte());return n}(),this.charRange=function(){var r,n;for(n=[],e=r=0;r<4;e=++r)n.push(t.readInt());return n}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var r,n;for(n=[],e=r=0;r<2;e=++r)n.push(t.readInt());return n}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},e}(u),y=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.tag="post",e.prototype.parse=function(t){var e,r,n,a,i;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:break;case 131072:for(n=t.readUInt16(),this.glyphNameIndex=[],e=a=0;0<=n?a<n:a>n;e=0<=n?++a:--a)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],i=[];t.pos<this.offset+this.length;)r=t.readByte(),i.push(this.names.push(t.readString(r)));return i;case 151552:return n=t.readUInt16(),this.offsets=t.read(n);case 196608:break;case 262144:return this.map=function(){var r,n,a;for(a=[],e=r=0,n=this.file.maxp.numGlyphs;0<=n?r<n:r>n;e=0<=n?++r:--r)a.push(t.readUInt32());return a}.call(this)}},e}(u),b=function(){function t(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID}return t}(),w=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.tag="name",e.prototype.parse=function(t){var e,r,n,a,i,o,s,c,l,u,f,$;for(t.pos=this.offset,t.readShort(),e=t.readShort(),o=t.readShort(),r=[],a=l=0;0<=e?l<e:l>e;a=0<=e?++l:--l)r.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+o+t.readShort()});for(s={},a=u=0,f=r.length;u<f;a=++u)n=r[a],t.pos=n.offset,c=t.readString(n.length),i=new b(c,n),null==s[$=n.nameID]&&(s[$]=[]),s[n.nameID].push(i);this.strings=s,this.copyright=s[0],this.fontFamily=s[1],this.fontSubfamily=s[2],this.uniqueSubfamily=s[3],this.fontName=s[4],this.version=s[5];try{this.postscriptName=s[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch(t){this.postscriptName=s[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=s[7],this.manufacturer=s[8],this.designer=s[9],this.description=s[10],this.vendorUrl=s[11],this.designerUrl=s[12],this.license=s[13],this.licenseUrl=s[14],this.preferredFamily=s[15],this.preferredSubfamily=s[17],this.compatibleFull=s[18],this.sampleText=s[19]},e}(u),x=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.tag="maxp",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},e}(u),A=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.tag="hmtx",e.prototype.parse=function(t){var e,r,n,a,i,o,s,c;for(t.pos=this.offset,this.metrics=[],e=i=0,s=this.file.hhea.numberOfMetrics;0<=s?i<s:i>s;e=0<=s?++i:--i)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(n=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var r,a;for(a=[],e=r=0;0<=n?r<n:r>n;e=0<=n?++r:--r)a.push(t.readInt16());return a}(),this.widths=function(){var t,e,r,n;for(r=this.metrics,n=[],t=0,e=r.length;t<e;t++)a=r[t],n.push(a.advance);return n}.call(this),r=this.widths[this.widths.length-1],c=[],e=o=0;0<=n?o<n:o>n;e=0<=n?++o:--o)c.push(this.widths.push(r));return c},e.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},e}(u),k=[].slice,E=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.tag="glyf",e.prototype.parse=function(t){return this.cache={}},e.prototype.glyphFor=function(t){t=t;var e,r,n,a,i,o,s,c,l,u;return t in this.cache?this.cache[t]:(a=this.file.loca,e=this.file.contents,r=a.indexOf(t),0===(n=a.lengthOf(t))?this.cache[t]=null:(e.pos=this.offset+r,o=new f(e.read(n)),i=o.readShort(),c=o.readShort(),u=o.readShort(),s=o.readShort(),l=o.readShort(),this.cache[t]=-1===i?new N(o,c,u,s,l):new S(o,i,c,u,s,l),this.cache[t]))},e.prototype.encode=function(t,e,r){var n,a,i,o,s,c;for(o=[],i=[],s=0,c=e.length;s<c;s++)a=e[s],n=t[a],i.push(o.length),n&&(o=o.concat(n.encode(r)));return i.push(o.length),{table:o,offsets:i}},e}(u),S=function(){function t(t,e,r,n,a,i){this.raw=t,this.numberOfContours=e,this.xMin=r,this.yMin=n,this.xMax=a,this.yMax=i,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t}(),N=function(){function t(t,o,s,c,l){var u,f;for(this.raw=t,this.xMin=o,this.yMin=s,this.xMax=c,this.yMax=l,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],u=this.raw;;){if(f=u.readShort(),this.glyphOffsets.push(u.pos),this.glyphIDs.push(u.readShort()),!(f&r))break;u.pos+=f&e?4:2,f&i?u.pos+=8:f&n?u.pos+=4:f&a&&(u.pos+=2)}}var e,r,n,a,i;return e=1,a=8,r=32,n=64,i=128,t.prototype.encode=function(t){var e,r,n,a,i;for(r=new f(k.call(this.raw.data)),i=this.glyphIDs,e=n=0,a=i.length;n<a;e=++n)i[e],r.pos=this.glyphOffsets[e];return r.data},t}(),C=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.tag="loca",e.prototype.parse=function(t){var e,r;return t.pos=this.offset,e=this.file.head.indexToLocFormat,this.offsets=0===e?function(){var e,n,a;for(a=[],r=e=0,n=this.length;e<n;r=e+=2)a.push(2*t.readUInt16());return a}.call(this):function(){var e,n,a;for(a=[],r=e=0,n=this.length;e<n;r=e+=4)a.push(t.readUInt32());return a}.call(this)},e.prototype.indexOf=function(t){return this.offsets[t]},e.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},e.prototype.encode=function(t,e){for(var r=new Uint32Array(this.offsets.length),n=0,a=0,i=0;i<r.length;++i)if(r[i]=n,a<e.length&&e[a]==i){++a,r[i]=n;var o=this.offsets[i],s=this.offsets[i+1]-o;s>0&&(n+=s)}for(var c=new Array(4*r.length),l=0;l<r.length;++l)c[4*l+3]=255&r[l],c[4*l+2]=(65280&r[l])>>8,c[4*l+1]=(16711680&r[l])>>16,c[4*l]=(4278190080&r[l])>>24;return c},e}(u),I=function(t){var e,r,n;r={};for(e in t)n=t[e],r[n]=e;return r},O=function(){function t(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var t,e,r,n,a;n=this.font.cmap.tables[0].codeMap,t={},a=this.subset;for(e in a)r=a[e],t[e]=n[r];return t},t.prototype.glyphsFor=function(t){var e,r,n,a,i,o,s;for(n={},i=0,o=t.length;i<o;i++)a=t[i],n[a]=this.font.glyf.glyphFor(a);e=[];for(a in n)r=n[a],(null!=r?r.compound:void 0)&&e.push.apply(e,r.glyphIDs);if(e.length>0){s=this.glyphsFor(e);for(a in s)r=s[a],n[a]=r}return n},t.prototype.encode=function(t,e){var r,n,a,i,o,s,c,l,u,f,$,_,d,p,h;r=g.encode(this.generateCmap(),"unicode"),i=this.glyphsFor(t),$={0:0},h=r.charMap;for(n in h)s=h[n],$[s.old]=s.new;f=r.maxGlyphID;for(_ in i)_ in $||($[_]=f++);return l=I($),u=Object.keys(l).sort(function(t,e){return t-e}),d=function(){var t,e,r;for(r=[],t=0,e=u.length;t<e;t++)o=u[t],r.push(l[o]);return r}(),a=this.font.glyf.encode(i,d,$),c=this.font.loca.encode(a.offsets,d),p={cmap:this.font.cmap.raw(),glyf:a.table,loca:c,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(e)},this.font.os2.exists&&(p["OS/2"]=this.font.os2.raw()),this.font.directory.encode(p)},t}();t.API.PDFObject=function(){function t(){}var e;return e=function(t,e){return(Array(e+1).join("0")+t).slice(-e)},t.convert=function(r){var n,a,i,o;if(Array.isArray(r))return"["+function(){var e,a,i;for(i=[],e=0,a=r.length;e<a;e++)n=r[e],i.push(t.convert(n));return i}().join(" ")+"]";if("string"==typeof r)return"/"+r;if(null!=r?r.isString:void 0)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if("[object Object]"==={}.toString.call(r)){i=["<<"];for(a in r)o=r[a],i.push("/"+a+" "+t.convert(o));return i.push(">>"),i.join("\n")}return""+r},t}()}(c),function(t){var e;e=function(){
function e(t){var e,r,n,a,i,o,s,c,l,u,f,$,_,d,p;for(this.data=t,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},o=null;;){switch(e=this.readUInt32(),u=function(){var t,e;for(e=[],s=t=0;t<4;s=++t)e.push(String.fromCharCode(this.data[this.pos++]));return e}.call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(e);break;case"fcTL":o&&this.animation.frames.push(o),this.pos+=4,o={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},i=this.readUInt16(),a=this.readUInt16()||100,o.delay=1e3*i/a,o.disposeOp=this.data[this.pos++],o.blendOp=this.data[this.pos++],o.data=[];break;case"IDAT":case"fdAT":for("fdAT"===u&&(this.pos+=4,e-=4),t=(null!=o?o.data:void 0)||this.imgData,s=_=0;0<=e?_<e:_>e;s=0<=e?++_:--_)t.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(n=this.palette.length/3,this.transparency.indexed=this.read(e),this.transparency.indexed.length>n)throw new Error("More transparent colors than palette size");if((f=n-this.transparency.indexed.length)>0)for(s=d=0;0<=f?d<f:d>f;s=0<=f?++d:--d)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(e)[0];break;case 2:this.transparency.rgb=this.read(e)}break;case"tEXt":$=this.read(e),c=$.indexOf(0),l=String.fromCharCode.apply(String,$.slice(0,c)),this.text[l]=String.fromCharCode.apply(String,$.slice(c+1));break;case"IEND":return o&&this.animation.frames.push(o),this.colors=function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}.call(this),this.hasAlphaChannel=4===(p=this.colorType)||6===p,r=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*r,this.colorSpace=function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}.call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=e}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}var r,n,a,i,o,s;e.load=function(t,r,n){var a;return"function"==typeof r&&(n=r),a=new XMLHttpRequest,a.open("GET",t,!0),a.responseType="arraybuffer",a.onload=function(){var t,i;return t=new Uint8Array(a.response||a.mozResponseArrayBuffer),i=new e(t),"function"==typeof(null!=r?r.getContext:void 0)&&i.render(r),"function"==typeof n?n(i):void 0},a.send(null)},n=1,a=2,r=0,e.prototype.read=function(t){var e,r;for(r=[],e=0;0<=t?e<t:e>t;0<=t?++e:--e)r.push(this.data[this.pos++]);return r},e.prototype.readUInt32=function(){var t,e,r,n;return t=this.data[this.pos++]<<24,e=this.data[this.pos++]<<16,r=this.data[this.pos++]<<8,n=this.data[this.pos++],t|e|r|n},e.prototype.readUInt16=function(){var t,e;return t=this.data[this.pos++]<<8,e=this.data[this.pos++],t|e},e.prototype.decodePixels=function(t){function e(e,o,s,c){var l,u,f,$,_,d,p,h,g,m,v,y,b,w,x,A,k,E,S,N,C,I=Math.ceil((i.width-e)/s),O=Math.ceil((i.height-o)/c),P=i.width==I&&i.height==O;for(w=r*I,y=P?n:new Uint8Array(w*O),d=t.length,b=0,u=0;b<O&&a<d;){switch(t[a++]){case 0:for($=k=0;k<w;$=k+=1)y[u++]=t[a++];break;case 1:for($=E=0;E<w;$=E+=1)l=t[a++],_=$<r?0:y[u-r],y[u++]=(l+_)%256;break;case 2:for($=S=0;S<w;$=S+=1)l=t[a++],f=($-$%r)/r,x=b&&y[(b-1)*w+f*r+$%r],y[u++]=(x+l)%256;break;case 3:for($=N=0;N<w;$=N+=1)l=t[a++],f=($-$%r)/r,_=$<r?0:y[u-r],x=b&&y[(b-1)*w+f*r+$%r],y[u++]=(l+Math.floor((_+x)/2))%256;break;case 4:for($=C=0;C<w;$=C+=1)l=t[a++],f=($-$%r)/r,_=$<r?0:y[u-r],0===b?x=A=0:(x=y[(b-1)*w+f*r+$%r],A=f&&y[(b-1)*w+(f-1)*r+$%r]),p=_+x-A,h=Math.abs(p-_),m=Math.abs(p-x),v=Math.abs(p-A),g=h<=m&&h<=v?_:m<=v?x:A,y[u++]=(l+g)%256;break;default:throw new Error("Invalid filter algorithm: "+t[a-1])}if(!P){var L=((o+b*c)*i.width+e)*r,M=b*w;for($=0;$<I;$+=1){for(var T=0;T<r;T+=1)n[L++]=y[M++];L+=(s-1)*r}}b++}}var r=this.pixelBitlength/8,n=new Uint8Array(this.width*this.height*r),a=0,i=this;return null==t&&(t=this.imgData),0===t.length?new Uint8Array(0):(t=new u(t),t=t.getBytes(),1==i.interlaceMethod?(e(0,0,8,8),e(4,0,8,8),e(0,4,4,8),e(2,0,4,4),e(0,2,2,4),e(1,0,2,2),e(0,1,1,2)):e(0,0,1,1),n)},e.prototype.decodePalette=function(){var t,e,r,n,a,i,o,s,c;for(r=this.palette,i=this.transparency.indexed||[],a=new Uint8Array((i.length||0)+r.length),n=0,r.length,t=0,e=o=0,s=r.length;o<s;e=o+=3)a[n++]=r[e],a[n++]=r[e+1],a[n++]=r[e+2],a[n++]=null!=(c=i[t++])?c:255;return a},e.prototype.copyToImageData=function(t,e){var r,n,a,i,o,s,c,l,u,f,$;if(n=this.colors,u=null,r=this.hasAlphaChannel,this.palette.length&&(u=null!=($=this._decodedPalette)?$:this._decodedPalette=this.decodePalette(),n=4,r=!0),a=t.data||t,l=a.length,o=u||e,i=s=0,1===n)for(;i<l;)c=u?4*e[i/4]:s,f=o[c++],a[i++]=f,a[i++]=f,a[i++]=f,a[i++]=r?o[c++]:255,s=c;else for(;i<l;)c=u?4*e[i/4]:s,a[i++]=o[c++],a[i++]=o[c++],a[i++]=o[c++],a[i++]=r?o[c++]:255,s=c},e.prototype.decode=function(){var t;return t=new Uint8Array(this.width*this.height*4),this.copyToImageData(t,this.decodePixels()),t};try{o=t.document.createElement("canvas"),s=o.getContext("2d")}catch(t){return-1}return i=function(t){var e;return s.width=t.width,s.height=t.height,s.clearRect(0,0,t.width,t.height),s.putImageData(t,0,0),e=new Image,e.src=o.toDataURL(),e},e.prototype.decodeFrames=function(t){var e,r,n,a,o,s,c,l;if(this.animation){for(c=this.animation.frames,l=[],r=o=0,s=c.length;o<s;r=++o)e=c[r],n=t.createImageData(e.width,e.height),a=this.decodePixels(new Uint8Array(e.data)),this.copyToImageData(n,a),e.imageData=n,l.push(e.image=i(n));return l}},e.prototype.renderFrame=function(t,e){var i,o,s;return o=this.animation.frames,i=o[e],s=o[e-1],0===e&&t.clearRect(0,0,this.width,this.height),(null!=s?s.disposeOp:void 0)===n?t.clearRect(s.xOffset,s.yOffset,s.width,s.height):(null!=s?s.disposeOp:void 0)===a&&t.putImageData(s.imageData,s.xOffset,s.yOffset),i.blendOp===r&&t.clearRect(i.xOffset,i.yOffset,i.width,i.height),t.drawImage(i.image,i.xOffset,i.yOffset)},e.prototype.animate=function(t){var e,r,n,a,i,o,s=this;return r=0,o=this.animation,a=o.numFrames,n=o.frames,i=o.numPlays,(e=function(){var o,c;if(o=r++%a,c=n[o],s.renderFrame(t,o),a>1&&r/a<i)return s.animation._timeout=setTimeout(e,c.delay)})()},e.prototype.stopAnimation=function(){var t;return clearTimeout(null!=(t=this.animation)?t._timeout:void 0)},e.prototype.render=function(t){var e,r;return t._png&&t._png.stopAnimation(),t._png=this,t.width=this.width,t.height=this.height,e=t.getContext("2d"),this.animation?(this.decodeFrames(e),this.animate(e)):(r=e.createImageData(this.width,this.height),this.copyToImageData(r,this.decodePixels()),e.putImageData(r,0,0))},e}(),t.PNG=e}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||"undefined"!=typeof global&&global||Function('return typeof this === "object" && this.content')()||Function("return this")());var l=function(){function t(){this.pos=0,this.bufferLength=0,this.eof=!1,this.buffer=null}return t.prototype={ensureBuffer:function(t){var e=this.buffer,r=e?e.byteLength:0;if(t<r)return e;for(var n=512;n<t;)n<<=1;for(var a=new Uint8Array(n),i=0;i<r;++i)a[i]=e[i];return this.buffer=a},getByte:function(){for(var t=this.pos;this.bufferLength<=t;){if(this.eof)return null;this.readBlock()}return this.buffer[this.pos++]},getBytes:function(t){var e=this.pos;if(t){this.ensureBuffer(e+t);for(var r=e+t;!this.eof&&this.bufferLength<r;)this.readBlock();var n=this.bufferLength;r>n&&(r=n)}else{for(;!this.eof;)this.readBlock();var r=this.bufferLength}return this.pos=r,this.buffer.subarray(e,r)},lookChar:function(){for(var t=this.pos;this.bufferLength<=t;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos])},getChar:function(){for(var t=this.pos;this.bufferLength<=t;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos++])},makeSubStream:function(t,e,r){for(var n=t+e;this.bufferLength<=n&&!this.eof;)this.readBlock();return new Stream(this.buffer,t,e,r)},skip:function(t){t||(t=1),this.pos+=t},reset:function(){this.pos=0}},t}(),u=function(){function t(t){throw new Error(t)}function e(e){var r=0,n=e[r++],a=e[r++];-1!=n&&-1!=a||t("Invalid header in flate stream"),8!=(15&n)&&t("Unknown compression method in flate stream"),((n<<8)+a)%31!=0&&t("Bad FCHECK in flate stream"),32&a&&t("FDICT bit set in flate stream"),this.bytes=e,this.bytesPos=r,this.codeSize=0,this.codeBuf=0,l.call(this)}if("undefined"!=typeof Uint32Array){var r=new Uint32Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),n=new Uint32Array([3,4,5,6,7,8,9,10,65547,65549,65551,65553,131091,131095,131099,131103,196643,196651,196659,196667,262211,262227,262243,262259,327811,327843,327875,327907,258,258,258]),a=new Uint32Array([1,2,3,4,65541,65543,131081,131085,196625,196633,262177,262193,327745,327777,393345,393409,459009,459137,524801,525057,590849,591361,657409,658433,724993,727041,794625,798721,868353,876545]),i=[new Uint32Array([459008,524368,524304,524568,459024,524400,524336,590016,459016,524384,524320,589984,524288,524416,524352,590048,459012,524376,524312,589968,459028,524408,524344,590032,459020,524392,524328,59e4,524296,524424,524360,590064,459010,524372,524308,524572,459026,524404,524340,590024,459018,524388,524324,589992,524292,524420,524356,590056,459014,524380,524316,589976,459030,524412,524348,590040,459022,524396,524332,590008,524300,524428,524364,590072,459009,524370,524306,524570,459025,524402,524338,590020,459017,524386,524322,589988,524290,524418,524354,590052,459013,524378,524314,589972,459029,524410,524346,590036,459021,524394,524330,590004,524298,524426,524362,590068,459011,524374,524310,524574,459027,524406,524342,590028,459019,524390,524326,589996,524294,524422,524358,590060,459015,524382,524318,589980,459031,524414,524350,590044,459023,524398,524334,590012,524302,524430,524366,590076,459008,524369,524305,524569,459024,524401,524337,590018,459016,524385,524321,589986,524289,524417,524353,590050,459012,524377,524313,589970,459028,524409,524345,590034,459020,524393,524329,590002,524297,524425,524361,590066,459010,524373,524309,524573,459026,524405,524341,590026,459018,524389,524325,589994,524293,524421,524357,590058,459014,524381,524317,589978,459030,524413,524349,590042,459022,524397,524333,590010,524301,524429,524365,590074,459009,524371,524307,524571,459025,524403,524339,590022,459017,524387,524323,589990,524291,524419,524355,590054,459013,524379,524315,589974,459029,524411,524347,590038,459021,524395,524331,590006,524299,524427,524363,590070,459011,524375,524311,524575,459027,524407,524343,590030,459019,524391,524327,589998,524295,524423,524359,590062,459015,524383,524319,589982,459031,524415,524351,590046,459023,524399,524335,590014,524303,524431,524367,590078,459008,524368,524304,524568,459024,524400,524336,590017,459016,524384,524320,589985,524288,524416,524352,590049,459012,524376,524312,589969,459028,524408,524344,590033,459020,524392,524328,590001,524296,524424,524360,590065,459010,524372,524308,524572,459026,524404,524340,590025,459018,524388,524324,589993,524292,524420,524356,590057,459014,524380,524316,589977,459030,524412,524348,590041,459022,524396,524332,590009,524300,524428,524364,590073,459009,524370,524306,524570,459025,524402,524338,590021,459017,524386,524322,589989,524290,524418,524354,590053,459013,524378,524314,589973,459029,524410,524346,590037,459021,524394,524330,590005,524298,524426,524362,590069,459011,524374,524310,524574,459027,524406,524342,590029,459019,524390,524326,589997,524294,524422,524358,590061,459015,524382,524318,589981,459031,524414,524350,590045,459023,524398,524334,590013,524302,524430,524366,590077,459008,524369,524305,524569,459024,524401,524337,590019,459016,524385,524321,589987,524289,524417,524353,590051,459012,524377,524313,589971,459028,524409,524345,590035,459020,524393,524329,590003,524297,524425,524361,590067,459010,524373,524309,524573,459026,524405,524341,590027,459018,524389,524325,589995,524293,524421,524357,590059,459014,524381,524317,589979,459030,524413,524349,590043,459022,524397,524333,590011,524301,524429,524365,590075,459009,524371,524307,524571,459025,524403,524339,590023,459017,524387,524323,589991,524291,524419,524355,590055,459013,524379,524315,589975,459029,524411,524347,590039,459021,524395,524331,590007,524299,524427,524363,590071,459011,524375,524311,524575,459027,524407,524343,590031,459019,524391,524327,589999,524295,524423,524359,590063,459015,524383,524319,589983,459031,524415,524351,590047,459023,524399,524335,590015,524303,524431,524367,590079]),9],o=[new Uint32Array([327680,327696,327688,327704,327684,327700,327692,327708,327682,327698,327690,327706,327686,327702,327694,0,327681,327697,327689,327705,327685,327701,327693,327709,327683,327699,327691,327707,327687,327703,327695,0]),5];return e.prototype=Object.create(l.prototype),e.prototype.getBits=function(e){for(var r,n=this.codeSize,a=this.codeBuf,i=this.bytes,o=this.bytesPos;n<e;)void 0===(r=i[o++])&&t("Bad encoding in flate stream"),a|=r<<n,n+=8;return r=a&(1<<e)-1,this.codeBuf=a>>e,this.codeSize=n-=e,this.bytesPos=o,r},e.prototype.getCode=function(e){for(var r=e[0],n=e[1],a=this.codeSize,i=this.codeBuf,o=this.bytes,s=this.bytesPos;a<n;){var c;void 0===(c=o[s++])&&t("Bad encoding in flate stream"),i|=c<<a,a+=8}var l=r[i&(1<<n)-1],u=l>>16,f=65535&l;return(0==a||a<u||0==u)&&t("Bad encoding in flate stream"),this.codeBuf=i>>u,this.codeSize=a-u,this.bytesPos=s,f},e.prototype.generateHuffmanTable=function(t){for(var e=t.length,r=0,n=0;n<e;++n)t[n]>r&&(r=t[n]);for(var a=1<<r,i=new Uint32Array(a),o=1,s=0,c=2;o<=r;++o,s<<=1,c<<=1)for(var l=0;l<e;++l)if(t[l]==o){for(var u=0,f=s,n=0;n<o;++n)u=u<<1|1&f,f>>=1;for(var n=u;n<a;n+=c)i[n]=o<<16|l;++s}return[i,r]},e.prototype.readBlock=function(){function e(t,e,r,n,a){for(var i=t.getBits(r)+n;i-- >0;)e[x++]=a}var s=this.getBits(3);if(1&s&&(this.eof=!0),0==(s>>=1)){var c,l=this.bytes,u=this.bytesPos;void 0===(c=l[u++])&&t("Bad block header in flate stream");var f=c;void 0===(c=l[u++])&&t("Bad block header in flate stream"),f|=c<<8,void 0===(c=l[u++])&&t("Bad block header in flate stream");var $=c;void 0===(c=l[u++])&&t("Bad block header in flate stream"),$|=c<<8,$!=(65535&~f)&&t("Bad uncompressed block length in flate stream"),this.codeBuf=0,this.codeSize=0;var _=this.bufferLength,d=this.ensureBuffer(_+f),p=_+f;this.bufferLength=p;for(var h=_;h<p;++h){if(void 0===(c=l[u++])){this.eof=!0;break}d[h]=c}return void(this.bytesPos=u)}var g,m;if(1==s)g=i,m=o;else if(2==s){for(var v=this.getBits(5)+257,y=this.getBits(5)+1,b=this.getBits(4)+4,w=Array(r.length),x=0;x<b;)w[r[x++]]=this.getBits(3);for(var A=this.generateHuffmanTable(w),k=0,x=0,E=v+y,S=new Array(E);x<E;){var N=this.getCode(A);16==N?e(this,S,2,3,k):17==N?e(this,S,3,3,k=0):18==N?e(this,S,7,11,k=0):S[x++]=k=N}g=this.generateHuffmanTable(S.slice(0,v)),m=this.generateHuffmanTable(S.slice(v,E))}else t("Unknown block type in flate stream");for(var d=this.buffer,C=d?d.length:0,I=this.bufferLength;;){var O=this.getCode(g);if(O<256)I+1>=C&&(d=this.ensureBuffer(I+1),C=d.length),d[I++]=O;else{if(256==O)return void(this.bufferLength=I);O-=257,O=n[O];var P=O>>16;P>0&&(P=this.getBits(P));var k=(65535&O)+P;O=this.getCode(m),O=a[O],P=O>>16,P>0&&(P=this.getBits(P));var L=(65535&O)+P;I+k>=C&&(d=this.ensureBuffer(I+k),C=d.length);for(var M=0;M<k;++M,++I)d[I]=d[I-L]}}},e}}();window.tmp=u,r.default=c;var f=r.default;r.rewire=o,r.restore=s,e.exports=c},{}]},{},[86]);
=======
!function e(t,r,n){function a(s,o){if(!r[s]){if(!t[s]){var c="function"==typeof require&&require;if(!o&&c)return c(s,!0);if(i)return i(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var u=r[s]={exports:{}};t[s][0].call(u.exports,function(e){var r=t[s][1][e];return a(r||e)},u,u.exports,e,t,r,n)}return r[s].exports}for(var i="function"==typeof require&&require,s=0;s<n.length;s++)a(n[s]);return a}({1:[function(e,t,r){!function(e){function t(e,t){function r(e,r){if(null===e||void 0===e)return r+"null";if("number"==typeof e){return r+(e===+e&&e!==(0|e)&&"decimals"in t?e.toFixed(t.decimals):e+"")}if(e instanceof Array){if(!e.length)return r+"[]";var f=e.map(function(e){return u(e,"")}),$=r+"["+i+f.join(o)+i+"]";if(!1===t.wrap||$.length<=t.wrap)return $;if(t.short){var p=r+" "+i;return f=e.map(function(e){return u(e,p)}),f[0]=f[0].replace(p,r+"["+i),f[f.length-1]=f[f.length-1]+i+"]",f.join(",\n")}var p=r+t.indent;return r+"[\n"+e.map(function(e){return u(e,p)}).join(",\n")+"\n"+(t.indentLast?p:r)+"]"}if(e instanceof Object){var d=[],h=0,_=t.sort||t.sorted;for(var m in e){var y=d[h++]=[m,e[m]];!0===_?y[2]=m:"function"==typeof _&&(y[2]=_(m,e[m],e))}if(!d.length)return r+"{}";_&&(d=d.sort(function(e,t){return e=e[2],t=t[2],e<t?-1:e>t?1:0}));var g=d.map(function(e){return[JSON.stringify(e[0]),u(e[1],"")]});t.sorted&&(g=g.sort(function(e,t){return e=e[0],t=t[0],e<t?-1:e>t?1:0})),g=g.map(function(e){return e.join(c)}).join(o);var $=r+"{"+s+g+s+"}";if(!1===t.wrap||$.length<t.wrap)return $;if(t.short){if(g=d.map(function(e){return[r+" "+s+JSON.stringify(e[0]),e[1]]}),g[0][0]=g[0][0].replace(r+" ",r+"{"),t.aligned){for(var v=0,h=g.length;h--;)g[h][0].length>v&&(v=g[h][0].length);for(var b=n(" ",v),h=g.length;h--;)g[h][0]=a(b,g[h][0])}for(var h=g.length;h--;){var m=g[h][0],x=g[h][1],p=n(" ",(m+l).length),$=m+l+u(x,"");g[h]=!1===t.wrap||$.length<=t.wrap||!x||"object"!=typeof x?$:m+l+u(x,p).replace(/^\s+/,"")}return g.join(",\n")+s+"}"}var g=[],h=0;for(var m in e){var y=g[h++]=[r+t.indent+JSON.stringify(m),e[m]];!0===_?y[2]=m:"function"==typeof _&&(y[2]=_(m,e[m],e))}if(_&&(g=g.sort(function(e,t){return e=e[2],t=t[2],e<t?-1:e>t?1:0})),t.aligned){for(var v=0,h=g.length;h--;)g[h][0].length>v&&(v=g[h][0].length);for(var b=n(" ",v),h=g.length;h--;)g[h][0]=a(b,g[h][0])}for(var p=r+t.indent,h=g.length;h--;){var m=g[h][0],x=g[h][1],$=m+l+u(x,"");g[h]=!1===t.wrap||$.length<=t.wrap||!x||"object"!=typeof x?$:m+l+u(x,p).replace(/^\s+/,"")}return r+"{\n"+g.join(",\n")+"\n"+(t.indentLast?p:r)+"}"}return r+JSON.stringify(e)}function n(e,t){for(var r="";;){if(1&t&&(r+=e),!(t>>=1))break;e+=e}return r}function a(e,t){return(t+e).substring(0,e.length)}t=t||{},"wrap"in t||(t.wrap=80),1==t.wrap&&(t.wrap=-1),"indent"in t||(t.indent="  "),"arrayPadding"in t||(t.arrayPadding="padding"in t?t.padding:0),"objectPadding"in t||(t.objectPadding="padding"in t?t.padding:0),"beforeComma"in t||(t.beforeComma="aroundComma"in t?t.aroundComma:0),"afterComma"in t||(t.afterComma="aroundComma"in t?t.aroundComma:0),"beforeColon"in t||(t.beforeColon="aroundColon"in t?t.aroundColon:0),"afterColon"in t||(t.afterColon="aroundColon"in t?t.aroundColon:0),"beforeColon1"in t||(t.beforeColon1="aroundColon1"in t?t.aroundColon1:"beforeColon"in t?t.beforeColon:0),"afterColon1"in t||(t.afterColon1="aroundColon1"in t?t.aroundColon1:"afterColon"in t?t.afterColon:0),"beforeColonN"in t||(t.beforeColonN="aroundColonN"in t?t.aroundColonN:"beforeColon"in t?t.beforeColon:0),"afterColonN"in t||(t.afterColonN="aroundColonN"in t?t.aroundColonN:"afterColon"in t?t.afterColon:0);var i=n(" ",t.arrayPadding),s=n(" ",t.objectPadding),o=n(" ",t.beforeComma)+","+n(" ",t.afterComma),c=n(" ",t.beforeColon1)+":"+n(" ",t.afterColon1),l=n(" ",t.beforeColonN)+":"+n(" ",t.afterColonN),u=function(){var e=new Map;return function(t,n){var a=e.get(t);return a||e.set(t,a={}),a[n]||(a[n]=r(t,n)),a[n]}}();return u(e,"")}e.neatJSON=t,t.version="0.8.3"}(void 0===r?this:r)},{}],2:[function(e,t,r){"use strict";function n(e){return y.test(e)}function a(t){function r(e,t){var r;if("string"==typeof e){if(!(r=A(e)))throw new Error('no schema with key or ref "'+e+'"')}else{var n=C(e);r=n.validate||I(n)}var a=r(t);return!0===r.$async?"*"==M._opts.async?h(a):a:(M.errors=r.errors,a)}function _(e,t){var r=C(e,void 0,t);return r.validate||I(r)}function v(e,t,r,n){if(Array.isArray(e))for(var a=0;a<e.length;a++)v(e[a],void 0,r,n);else t=s.normalizeId(t||e.id),P(t),M._schemas[t]=C(e,r,n,!0)}function b(e,t,r){v(e,t,r,!0)}function x(e,t){var a=e.$schema||M._opts.defaultMeta||w(),i=M._formats.uri;M._formats.uri="function"==typeof i?n:y;var s;try{s=r(a,e)}finally{M._formats.uri=i}if(!s&&t){var o="schema is invalid: "+O();if("log"!=M._opts.validateSchema)throw new Error(o);console.error(o)}return s}function w(){var e=M._opts.meta;return M._opts.defaultMeta="object"==typeof e?e.id||e:M._opts.v5?$.META_SCHEMA_ID:m,M._opts.defaultMeta}function A(e){var t=E(e);switch(typeof t){case"object":return t.validate||I(t);case"string":return A(t);case"undefined":return k(e)}}function k(e){var t=s.schema.call(M,{schema:{}},e);if(t){var r=t.schema,n=t.root,a=t.baseId,o=i.call(M,r,n,void 0,a);return M._fragments[e]=new c({ref:e,fragment:!0,schema:r,root:n,baseId:a,validate:o}),o}}function E(e){return e=s.normalizeId(e),M._schemas[e]||M._refs[e]||M._fragments[e]}function S(e){if(e instanceof RegExp)return N(M._schemas,e),void N(M._refs,e);switch(typeof e){case"undefined":return N(M._schemas),N(M._refs),void M._cache.clear();case"string":var t=E(e);return t&&M._cache.del(t.jsonStr),delete M._schemas[e],void delete M._refs[e];case"object":var r=l(e);M._cache.del(r);var n=e.id;n&&(n=s.normalizeId(n),delete M._schemas[n],delete M._refs[n])}}function N(e,t){for(var r in e){var n=e[r];n.meta||t&&!t.test(r)||(M._cache.del(n.jsonStr),delete e[r])}}function C(e,t,r,n){if("object"!=typeof e)throw new Error("schema should be object");var a=l(e),i=M._cache.get(a);if(i)return i;n=n||!1!==M._opts.addUsedSchema;var o=s.normalizeId(e.id);o&&n&&P(o);var u,f=!1!==M._opts.validateSchema&&!t;f&&!(u=e.id&&e.id==e.$schema)&&x(e,!0);var $=s.ids.call(M,e),p=new c({id:o,schema:e,localRefs:$,jsonStr:a,meta:r});return"#"!=o[0]&&n&&(M._refs[o]=p),M._cache.put(a,p),f&&u&&x(e,!0),p}function I(e,t){function r(){var t=e.validate,n=t.apply(null,arguments);return r.errors=t.errors,n}if(e.compiling)return e.validate=r,r.schema=e.schema,r.errors=null,r.root=t||r,!0===e.schema.$async&&(r.$async=!0),r;e.compiling=!0;var n;e.meta&&(n=M._opts,M._opts=M._metaOpts);var a;try{a=i.call(M,e.schema,t,e.localRefs)}finally{e.compiling=!1,e.meta&&(M._opts=n)}return e.validate=a,e.refs=a.refs,e.refVal=a.refVal,e.root=a.root,a}function O(e,t){if(!(e=e||M.errors))return"No errors";t=t||{};for(var r=void 0===t.separator?", ":t.separator,n=void 0===t.dataVar?"data":t.dataVar,a="",i=0;i<e.length;i++){var s=e[i];s&&(a+=n+s.dataPath+" "+s.message+r)}return a.slice(0,-r.length)}function L(e,t){"string"==typeof t&&(t=new RegExp(t)),M._formats[e]=t}function P(e){if(M._schemas[e]||M._refs[e])throw new Error('schema with key or id "'+e+'" already exists')}if(!(this instanceof a))return new a(t);var M=this;t=this._opts=p.copy(t)||{},this._schemas={},this._refs={},this._fragments={},this._formats=u(t.format),this._cache=t.cache||new o,this._loadingSchemas={},this._compilations=[],this.RULES=f(),this.validate=r,this.compile=_,this.addSchema=v,this.addMetaSchema=b,this.validateSchema=x,this.getSchema=A,this.removeSchema=S,this.addFormat=L,this.errorsText=O,this._addSchema=C,this._compile=I,t.loopRequired=t.loopRequired||1/0,(t.async||t.transpile)&&d.setup(t),!0===t.beautify&&(t.beautify={indent_size:2}),"property"==t.errorDataPath&&(t._errorDataPathProperty=!0),this._metaOpts=function(){for(var e=p.copy(M._opts),t=0;t<g.length;t++)delete e[g[t]];return e}(),t.formats&&function(){for(var e in M._opts.formats)L(e,M._opts.formats[e])}(),function(){!1!==M._opts.meta&&(b(e("./refs/json-schema-draft-04.json"),m,!0),M._refs["http://json-schema.org/schema"]=m)}(),t.v5&&$.enable(this),"object"==typeof t.meta&&b(t.meta),function(){var e=M._opts.schemas;if(e)if(Array.isArray(e))v(e);else for(var t in e)v(e[t],t)}()}var i=e("./compile"),s=e("./compile/resolve"),o=e("./cache"),c=e("./compile/schema_obj"),l=e("json-stable-stringify"),u=e("./compile/formats"),f=e("./compile/rules"),$=e("./v5"),p=e("./compile/util"),d=e("./async"),h=e("co");t.exports=a,a.prototype.compileAsync=d.compile;var _=e("./keyword");a.prototype.addKeyword=_.add,a.prototype.getKeyword=_.get,a.prototype.removeKeyword=_.remove,a.ValidationError=e("./compile/validation_error");var m="http://json-schema.org/draft-04/schema",y=/^(?:(?:[a-z][a-z0-9+-.]*:)?\/\/)?[^\s]*$/i,g=["removeAdditional","useDefaults","coerceTypes"]},{"./async":3,"./cache":4,"./compile":8,"./compile/formats":7,"./compile/resolve":9,"./compile/rules":10,"./compile/schema_obj":11,"./compile/util":13,"./compile/validation_error":14,"./keyword":39,"./refs/json-schema-draft-04.json":40,"./v5":42,co:45,"json-stable-stringify":78}],3:[function(e,t,r){"use strict";function n(e,t){!1!==t&&(t=!0);var r,a=e.async,i=e.transpile;switch(typeof i){case"string":var s=h[i];if(!s)throw new Error("bad transpiler: "+i);return e._transpileFunc=s(e,t);case"undefined":case"boolean":if("string"==typeof a){if(!(r=d[a]))throw new Error("bad async mode: "+a);return e.transpile=r(e,t)}for(var o=0;o<_.length;o++){var c=_[o];if(n(c,!1))return p.copy(c,e),e.transpile}throw new Error("generators, nodent and regenerator are not available");case"function":return e._transpileFunc=e.transpile;default:throw new Error("bad transpiler: "+i)}}function a(e,t){try{return new Function("(function*(){})()")(),!0}catch(e){if(t)throw new Error("generators not supported")}}function i(e,t){try{return new Function("(async function(){})()")(),!0}catch(e){if(t)throw new Error("es7 async functions not supported")}}function s(t,r){try{if(!f){f=e("regenerator"),f.runtime()}return t.async&&!0!==t.async||(t.async="es7"),o}catch(e){if(r)throw new Error("regenerator not available")}}function o(e){return f.compile(e).code}function c(t,r){try{if(!$){$=e("nodent")({log:!1,dontInstallRequireHook:!0})}return"es7"!=t.async&&(t.async&&!0!==t.async&&console.warn("nodent transpiles only es7 async functions"),t.async="es7"),l}catch(e){if(r)throw new Error("nodent not available")}}function l(e){return $.compile(e,"",{promises:!0,sourcemap:!1}).code}function u(e,t){function r(e,t,n){function i(e,r){if(!n)return t(e,r);setTimeout(function(){t(e,r)})}var s;try{s=a.compile(e)}catch(n){return void(n.missingSchema?function(n){function i(n,i){if(n)return t(n);if(!a._refs[s]&&!a._schemas[s])try{a.addSchema(i,s)}catch(e){return void t(e)}r(e,t)}var s=n.missingSchema;if(a._refs[s]||a._schemas[s])return t(new Error("Schema "+s+" is loaded but "+n.missingRef+" cannot be resolved"));var o=a._loadingSchemas[s];o?"function"==typeof o?a._loadingSchemas[s]=[o,i]:o[o.length]=i:(a._loadingSchemas[s]=i,a._opts.loadSchema(s,function(e,t){var r=a._loadingSchemas[s];if(delete a._loadingSchemas[s],"function"==typeof r)r(e,t);else for(var n=0;n<r.length;n++)r[n](e,t)}))}(n):i(n))}i(null,s)}var n,a=this;try{n=this._addSchema(e)}catch(e){return void setTimeout(function(){t(e)})}if(n.validate)setTimeout(function(){t(null,n.validate)});else{if("function"!=typeof this._opts.loadSchema)throw new Error("options.loadSchema should be a function");r(e,t,!0)}}t.exports={setup:n,compile:u};var f,$,p=e("./compile/util"),d={"*":a,"co*":a,es7:i},h={nodent:c,regenerator:s},_=[{async:"co*"},{async:"es7",transpile:"nodent"},{async:"co*",transpile:"regenerator"}]},{"./compile/util":13}],4:[function(e,t,r){"use strict";var n=t.exports=function(){this._cache={}};n.prototype.put=function(e,t){this._cache[e]=t},n.prototype.get=function(e){return this._cache[e]},n.prototype.del=function(e){delete this._cache[e]},n.prototype.clear=function(){this._cache={}}},{}],5:[function(e,t,r){"use strict";t.exports={$ref:e("../dotjs/ref"),allOf:e("../dotjs/allOf"),anyOf:e("../dotjs/anyOf"),dependencies:e("../dotjs/dependencies"),enum:e("../dotjs/enum"),format:e("../dotjs/format"),items:e("../dotjs/items"),maximum:e("../dotjs/_limit"),minimum:e("../dotjs/_limit"),maxItems:e("../dotjs/_limitItems"),minItems:e("../dotjs/_limitItems"),maxLength:e("../dotjs/_limitLength"),minLength:e("../dotjs/_limitLength"),maxProperties:e("../dotjs/_limitProperties"),minProperties:e("../dotjs/_limitProperties"),multipleOf:e("../dotjs/multipleOf"),not:e("../dotjs/not"),oneOf:e("../dotjs/oneOf"),pattern:e("../dotjs/pattern"),properties:e("../dotjs/properties"),required:e("../dotjs/required"),uniqueItems:e("../dotjs/uniqueItems"),validate:e("../dotjs/validate")}},{"../dotjs/_limit":16,"../dotjs/_limitItems":17,"../dotjs/_limitLength":18,"../dotjs/_limitProperties":19,"../dotjs/allOf":20,"../dotjs/anyOf":21,"../dotjs/dependencies":24,"../dotjs/enum":25,"../dotjs/format":26,"../dotjs/items":27,"../dotjs/multipleOf":28,"../dotjs/not":29,"../dotjs/oneOf":30,"../dotjs/pattern":31,"../dotjs/properties":33,"../dotjs/ref":34,"../dotjs/required":35,"../dotjs/uniqueItems":37,"../dotjs/validate":38}],6:[function(e,t,r){"use strict";t.exports=function e(t,r){if(t===r)return!0;var n,a=Array.isArray(t),i=Array.isArray(r);if(a&&i){if(t.length!=r.length)return!1;for(n=0;n<t.length;n++)if(!e(t[n],r[n]))return!1;return!0}if(a!=i)return!1;if(t&&r&&"object"==typeof t&&"object"==typeof r){var s=Object.keys(t);if(s.length!==Object.keys(r).length)return!1;var o=t instanceof Date,c=r instanceof Date;if(o&&c)return t.getTime()==r.getTime();if(o!=c)return!1;var l=t instanceof RegExp,u=r instanceof RegExp;if(l&&u)return t.toString()==r.toString();if(l!=u)return!1;for(n=0;n<s.length;n++)if(!Object.prototype.hasOwnProperty.call(r,s[n]))return!1;for(n=0;n<s.length;n++)if(!e(t[s[n]],r[s[n]]))return!1;return!0}return!1}},{}],7:[function(e,t,r){"use strict";function n(e){e="full"==e?"full":"fast";var t=p.copy(n[e]);for(var r in n.compare)t[r]={validate:t[r],compare:n.compare[r]};return t}function a(e){var t=e.match(d);if(!t)return!1;var r=+t[1],n=+t[2];return r>=1&&r<=12&&n>=1&&n<=h[r]}function i(e,t){var r=e.match(_);if(!r)return!1;var n=r[1],a=r[2],i=r[3],s=r[5];return n<=23&&a<=59&&i<=59&&(!t||s)}function s(e){var t=e.split(x);return 2==t.length&&a(t[0])&&i(t[1],!0)}function o(e){return e.length<=255&&m.test(e)}function c(e){return w.test(e)&&y.test(e)}function l(e){try{return new RegExp(e),!0}catch(e){return!1}}function u(e,t){if(e&&t)return e>t?1:e<t?-1:e===t?0:void 0}function f(e,t){if(e&&t&&(e=e.match(_),t=t.match(_),e&&t))return e=e[1]+e[2]+e[3]+(e[4]||""),t=t[1]+t[2]+t[3]+(t[4]||""),e>t?1:e<t?-1:e===t?0:void 0}function $(e,t){if(e&&t){e=e.split(x),t=t.split(x);var r=u(e[0],t[0]);if(void 0!==r)return r||f(e[1],t[1])}}var p=e("./util"),d=/^\d\d\d\d-(\d\d)-(\d\d)$/,h=[0,31,29,31,30,31,30,31,31,30,31,30,31],_=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d:\d\d)?$/i,m=/^[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*$/i,y=/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@\/?]|%[0-9a-f]{2})*)?(?:\#(?:[a-z0-9\-._~!$&'()*+,;=:@\/?]|%[0-9a-f]{2})*)?$/i,g=/^(?:urn\:uuid\:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,v=/^(?:\/(?:[^~\/]|~0|~1)*)*$|^\#(?:\/(?:[a-z0-9_\-\.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,b=/^(?:0|[1-9][0-9]*)(?:\#|(?:\/(?:[^~\/]|~0|~1)*)*)$/;t.exports=n,n.fast={date:/^\d\d\d\d-[0-1]\d-[0-3]\d$/,time:/^[0-2]\d:[0-5]\d:[0-5]\d(?:\.\d+)?(?:z|[+-]\d\d:\d\d)?$/i,"date-time":/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s][0-2]\d:[0-5]\d:[0-5]\d(?:\.\d+)?(?:z|[+-]\d\d:\d\d)$/i,uri:/^(?:[a-z][a-z0-9+-.]*)?(?:\:|\/)\/?[^\s]*$/i,email:/^[a-z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i,hostname:m,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:l,uuid:g,"json-pointer":v,"relative-json-pointer":b},n.full={date:a,time:i,"date-time":s,uri:c,email:/^[a-z0-9!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&''*+\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:o,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:l,uuid:g,"json-pointer":v,"relative-json-pointer":b},n.compare={date:u,time:f,"date-time":$};var x=/t|\s/i,w=/\/|\:/},{"./util":13}],8:[function(e,t,r){"use strict";function n(){if(void 0===p){try{p=e("js-beautify").js_beautify}catch(e){p=!1}}}function a(e,t,r,o){function w(){var e=U.validate,t=e.apply(null,arguments);return w.errors=e.errors,t}function A(e,r,i,s){var o=!r||r&&r.schema==e;if(r.schema!=t.schema)return a.call(L,e,r,i,s);var _=!0===e.$async;_&&!P.transpile&&m.setup(P);var w=y({isTop:!0,schema:e,isRoot:o,baseId:s,root:r,schemaPath:"",errSchemaPath:"#",errorPath:'""',RULES:G,validate:y,util:h,resolve:d,resolveRef:k,usePattern:C,useDefault:I,useCustomRule:O,opts:P,formats:H,self:L});w=$(M,u)+$(B,c)+$(F,l)+$(D,f)+w,P.beautify&&(n(),p?w=p(w,P.beautify):console.error('"npm install js-beautify" to use beautify option'));var A,E,S=P._transpileFunc;try{E=_&&S?S(w):w;A=new Function("self","RULES","formats","root","refVal","defaults","customRules","co","equal","ucs2length","ValidationError",E)(L,G,H,t,M,F,D,g,b,v,x),M[0]=A}catch(e){throw console.error("Error compiling schema, function code:",E),e}return A.schema=e,A.errors=null,A.refs=T,A.refVal=M,A.root=o?A:r,_&&(A.$async=!0),z&&(A.sourceCode=w),!0===P.sourceCode&&(A.source={patterns:B,defaults:F}),A}function k(e,n,i){n=d.url(e,n);var s,o,c=T[n];if(void 0!==c)return s=M[c],o="refVal["+c+"]",N(s,o);if(!i&&t.refs){var l=t.refs[n];if(void 0!==l)return s=t.refVal[l],o=E(n,s),N(s,o)}o=E(n);var u=d.call(L,A,t,n);if(!u){var f=r&&r[n];f&&(u=d.inlineRef(f,P.inlineRefs)?f:a.call(L,f,t,r,e))}return u?(S(n,u),N(u,o)):void 0}function E(e,t){var r=M.length;return M[r]=t,T[e]=r,"refVal"+r}function S(e,t){var r=T[e];M[r]=t}function N(e,t){return"object"==typeof e?{code:t,schema:e,inline:!0}:{code:t,$async:e&&e.$async}}function C(e){var t=j[e];return void 0===t&&(t=j[e]=B.length,B[t]=e),"pattern"+t}function I(e){switch(typeof e){case"boolean":case"number":return""+e;case"string":return h.toQuotedString(e);case"object":if(null===e)return"null";var t=_(e),r=R[t];return void 0===r&&(r=R[t]=F.length,F[r]=e),"default"+r}}function O(e,t,r,n){var a=e.definition.validateSchema;if(a&&!1!==L._opts.validateSchema){if(!a(t)){var i="keyword schema is invalid: "+L.errorsText(a.errors);if("log"!=L._opts.validateSchema)throw new Error(i);console.error(i)}}var s,o=e.definition.compile,c=e.definition.inline,l=e.definition.macro;o?s=o.call(L,t,r,n):l?(s=l.call(L,t,r,n),!1!==P.validateSchema&&L.validateSchema(s,!0)):s=c?c.call(L,n,e.keyword,t,r):e.definition.validate;var u=D.length;return D[u]=s,{code:"customRule"+u,validate:s}}var L=this,P=this._opts,M=[void 0],T={},B=[],j={},F=[],R={},D=[],z=!1!==P.sourceCode;t=t||{schema:e,refVal:M,refs:T};var q=i.call(this,e,t,o),U=this._compilations[q.index];if(q.compiling)return U.callValidate=w;var H=this._formats,G=this.RULES;try{var Y=A(e,t,r,o);U.validate=Y;var V=U.callValidate;return V&&(V.schema=Y.schema,V.errors=null,V.refs=Y.refs,V.refVal=Y.refVal,V.root=Y.root,V.$async=Y.$async,z&&(V.sourceCode=Y.sourceCode)),Y}finally{s.call(this,e,t,o)}}function i(e,t,r){var n=o.call(this,e,t,r);return n>=0?{index:n,compiling:!0}:(n=this._compilations.length,this._compilations[n]={schema:e,root:t,baseId:r},{index:n,compiling:!1})}function s(e,t,r){var n=o.call(this,e,t,r);n>=0&&this._compilations.splice(n,1)}function o(e,t,r){for(var n=0;n<this._compilations.length;n++){var a=this._compilations[n];if(a.schema==e&&a.root==t&&a.baseId==r)return n}return-1}function c(e,t){return"var pattern"+e+" = new RegExp("+h.toQuotedString(t[e])+");"}function l(e){return"var default"+e+" = defaults["+e+"];"}function u(e,t){return t[e]?"var refVal"+e+" = refVal["+e+"];":""}function f(e){return"var customRule"+e+" = customRules["+e+"];"}function $(e,t){if(!e.length)return"";for(var r="",n=0;n<e.length;n++)r+=t(n,e);return r}var p,d=e("./resolve"),h=e("./util"),_=e("json-stable-stringify"),m=e("../async"),y=e("../dotjs/validate"),g=e("co"),v=h.ucs2length,b=e("./equal"),x=e("./validation_error");t.exports=a},{"../async":3,"../dotjs/validate":38,"./equal":6,"./resolve":9,"./util":13,"./validation_error":14,co:45,"json-stable-stringify":78}],9:[function(e,t,r){"use strict";function n(e,t,r){var i=this._refs[r];if("string"==typeof i){if(!this._refs[i])return n.call(this,e,t,i);i=this._refs[i]}if((i=i||this._schemas[r])instanceof y)return o(i.schema,this._opts.inlineRefs)?i.schema:i.validate||this._compile(i);var s,c,l,u=a.call(this,t,r);return u&&(s=u.schema,t=u.root,l=u.baseId),s instanceof y?c=s.validate||e.call(this,s.schema,t,void 0,l):s&&(c=o(s,this._opts.inlineRefs)?s:e.call(this,s,t,void 0,l)),c}function a(e,t){var r=h.parse(t,!1,!0),n=f(r),a=u(e.schema.id);if(n!==a){var o=$(n),c=this._refs[o];if("string"==typeof c)return i.call(this,e,c,r);if(c instanceof y)c.validate||this._compile(c),e=c;else{if(!((c=this._schemas[o])instanceof y))return;if(c.validate||this._compile(c),o==$(t))return{schema:c,root:e,baseId:a};e=c}if(!e.schema)return;a=u(e.schema.id)}return s.call(this,r,a,e.schema,e)}function i(e,t,r){var n=a.call(this,e,t);if(n){var i=n.schema,o=n.baseId;return e=n.root,i.id&&(o=p(o,i.id)),s.call(this,r,o,i,e)}}function s(e,t,r,n){if(e.hash=e.hash||"","#/"==e.hash.slice(0,2)){for(var i=e.hash.split("/"),s=1;s<i.length;s++){var o=i[s];if(o){if(o=m.unescapeFragment(o),!(r=r[o]))break;if(r.id&&!g[o]&&(t=p(t,r.id)),r.$ref){var c=p(t,r.$ref),l=a.call(this,n,c);l&&(r=l.schema,n=l.root,t=l.baseId)}}}return r&&r!=n.schema?{schema:r,root:n,baseId:t}:void 0}}function o(e,t){return!1!==t&&(void 0===t||!0===t?c(e):t?l(e)<=t:void 0)}function c(e){var t;if(Array.isArray(e)){for(var r=0;r<e.length;r++)if("object"==typeof(t=e[r])&&!c(t))return!1}else for(var n in e){if("$ref"==n)return!1;if("object"==typeof(t=e[n])&&!c(t))return!1}return!0}function l(e){var t,r=0;if(Array.isArray(e)){for(var n=0;n<e.length;n++)if(t=e[n],"object"==typeof t&&(r+=l(t)),r==1/0)return 1/0}else for(var a in e){if("$ref"==a)return 1/0;if(v[a])r++;else if(t=e[a],"object"==typeof t&&(r+=l(t)+1),r==1/0)return 1/0}return r}function u(e,t){return!1!==t&&(e=$(e)),f(h.parse(e,!1,!0))}function f(e){var t=e.protocol||"//"==e.href.slice(0,2)?"//":"";return(e.protocol||"")+t+(e.host||"")+(e.path||"")+"#"}function $(e){return e?e.replace(b,""):""}function p(e,t){return t=$(t),h.resolve(e,t)}function d(e){function t(e,r,a){if(Array.isArray(e))for(var i=0;i<e.length;i++)t.call(this,e[i],r+"/"+i,a);else if(e&&"object"==typeof e){if("string"==typeof e.id){var s=a=a?h.resolve(a,e.id):e.id;s=$(s);var o=this._refs[s];if("string"==typeof o&&(o=this._refs[o]),o&&o.schema){if(!_(e,o.schema))throw new Error('id "'+s+'" resolves to more than one schema')}else if(s!=$(r))if("#"==s[0]){if(n[s]&&!_(e,n[s]))throw new Error('id "'+s+'" resolves to more than one schema');n[s]=e}else this._refs[s]=r}for(var c in e)t.call(this,e[c],r+"/"+m.escapeFragment(c),a)}}var r=$(e.id),n={};return t.call(this,e,u(r,!1),r),n}var h=e("url"),_=e("./equal"),m=e("./util"),y=e("./schema_obj");t.exports=n,n.normalizeId=$,n.fullPath=u,n.url=p,n.ids=d,n.inlineRef=o,n.schema=a;var g=m.toHash(["properties","patternProperties","enum","dependencies","definitions"]),v=m.toHash(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum"]),b=/#\/?$/},{"./equal":6,"./schema_obj":11,"./util":13,url:void 0}],10:[function(e,t,r){"use strict";var n=e("./_rules"),a=e("./util").toHash;t.exports=function(){var e=[{type:"number",rules:["maximum","minimum","multipleOf"]},{type:"string",rules:["maxLength","minLength","pattern","format"]},{type:"array",rules:["maxItems","minItems","uniqueItems","items"]},{type:"object",rules:["maxProperties","minProperties","required","dependencies","properties"]},{rules:["$ref","enum","not","anyOf","oneOf","allOf"]}],t=["type","additionalProperties","patternProperties"],r=["additionalItems","$schema","id","title","description","default"],i=["number","integer","string","array","object","boolean","null"];return e.all=a(t),e.forEach(function(r){r.rules=r.rules.map(function(r){return t.push(r),e.all[r]={keyword:r,code:n[r]}})}),e.keywords=a(t.concat(r)),e.types=a(i),e.custom={},e}},{"./_rules":5,"./util":13}],11:[function(e,t,r){"use strict";function n(e){a.copy(e,this)}var a=e("./util");t.exports=n},{"./util":13}],12:[function(e,t,r){"use strict";t.exports=function(e){for(var t,r=0,n=e.length,a=0;a<n;)r++,(t=e.charCodeAt(a++))>=55296&&t<=56319&&a<n&&56320==(64512&(t=e.charCodeAt(a)))&&a++;return r}},{}],13:[function(e,t,r){"use strict";function n(e,t){t=t||{};for(var r in e)t[r]=e[r];return t}function a(e,t,r){var n=r?" !== ":" === ",a=r?" || ":" && ",i=r?"!":"",s=r?"":"!";switch(e){case"null":return t+n+"null";case"array":return i+"Array.isArray("+t+")";case"object":return"("+i+t+a+"typeof "+t+n+'"object"'+a+s+"Array.isArray("+t+"))";case"integer":return"(typeof "+t+n+'"number"'+a+s+"("+t+" % 1)"+a+t+n+t+")";default:return"typeof "+t+n+'"'+e+'"'}}function i(e,t){switch(e.length){case 1:return a(e[0],t,!0);default:var r="",n=o(e);n.array&&n.object&&(r=n.null?"(":"(!"+t+" || ",r+="typeof "+t+' !== "object")',delete n.null,delete n.array,delete n.object),n.number&&delete n.integer;for(var i in n)r+=(r?" && ":"")+a(i,t,!0);return r}}function s(e,t){if(Array.isArray(t)){for(var r=[],n=0;n<t.length;n++){var a=t[n];k[a]?r[r.length]=a:"array"===e&&"array"===a&&(r[r.length]=a)}if(r.length)return r}else{if(k[t])return[t];if("array"===e&&"array"===t)return["array"]}}function o(e){for(var t={},r=0;r<e.length;r++)t[e[r]]=!0;return t}function c(e){return"number"==typeof e?"["+e+"]":E.test(e)?"."+e:"['"+l(e)+"']"}function l(e){return e.replace(S,"\\$&").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\f/g,"\\f").replace(/\t/g,"\\t")}function u(e,t){t+="[^0-9]";var r=e.match(new RegExp(t,"g"));return r?r.length:0}function f(e,t,r){return t+="([^0-9])",r=r.replace(/\$/g,"$$$$"),e.replace(new RegExp(t,"g"),r+"$1")}function $(e){return e.replace(N,"").replace(C,"").replace(I,"if (!($1))")}function p(e,t){var r=e.match(O);return r&&2===r.length?t?e.replace(P,"").replace(B,j):e.replace(L,"").replace(M,T):e}function d(e,t){for(var r in e)if(t[r])return!0}function h(e,t,r){for(var n in e)if(n!=r&&t[n])return!0}function _(e){return"'"+l(e)+"'"}function m(e,t,r,n){return v(e,r?"'/' + "+t+(n?"":".replace(/~/g, '~0').replace(/\\//g, '~1')"):n?"'[' + "+t+" + ']'":"'[\\'' + "+t+" + '\\']'")}function y(e,t,r){return v(e,_(r?"/"+w(t):c(t)))}function g(e,t,r){var n,a,i,s;if(""===e)return"rootData";if("/"==e[0]){if(!F.test(e))throw new Error("Invalid JSON-pointer: "+e);a=e,i="rootData"}else{if(!(s=e.match(R)))throw new Error("Invalid JSON-pointer: "+e);if(n=+s[1],"#"==(a=s[2])){if(n>=t)throw new Error("Cannot access property/index "+n+" levels up, current level is "+t);return r[t-n]}if(n>t)throw new Error("Cannot access data "+n+" levels up, current level is "+t);if(i="data"+(t-n||""),!a)return i}for(var o=i,l=a.split("/"),u=0;u<l.length;u++){var f=l[u];f&&(i+=c(A(f)),o+=" && "+i)}return o}function v(e,t){return'""'==e?t:(e+" + "+t).replace(/' \+ '/g,"")}function b(e){return A(decodeURIComponent(e))}function x(e){return encodeURIComponent(w(e))}function w(e){return e.replace(/~/g,"~0").replace(/\//g,"~1")}function A(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}t.exports={copy:n,checkDataType:a,checkDataTypes:i,coerceToTypes:s,toHash:o,getProperty:c,escapeQuotes:l,ucs2length:e("./ucs2length"),varOccurences:u,varReplace:f,cleanUpCode:$,cleanUpVarErrors:p,schemaHasRules:d,schemaHasRulesExcept:h,stableStringify:e("json-stable-stringify"),toQuotedString:_,getPathExpr:m,getPath:y,getData:g,unescapeFragment:b,escapeFragment:x,escapeJsonPointer:w};var k=o(["string","number","integer","boolean","null"]),E=/^[a-z$_][a-z$_0-9]*$/i,S=/'|\\/g,N=/else\s*{\s*}/g,C=/if\s*\([^)]+\)\s*\{\s*\}(?!\s*else)/g,I=/if\s*\(([^)]+)\)\s*\{\s*\}\s*else(?!\s*if)/g,O=/[^v\.]errors/g,L=/var errors = 0;|var vErrors = null;|validate.errors = vErrors;/g,P=/var errors = 0;|var vErrors = null;/g,M="return errors === 0;",T="validate.errors = null; return true;",B=/if \(errors === 0\) return true;\s*else throw new ValidationError\(vErrors\);/,j="return true;",F=/^\/(?:[^~]|~0|~1)*$/,R=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/},{"./ucs2length":12,"json-stable-stringify":78}],14:[function(e,t,r){"use strict";function n(e){this.message="validation failed",this.errors=e,
this.ajv=this.validation=!0}t.exports=n,n.prototype=Object.create(Error.prototype),n.prototype.constructor=n},{}],15:[function(e,t,r){"use strict";t.exports=function(e,t){var r,n=" ",a=e.level,i=e.dataLevel,s=e.schema[t],o=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,l=!e.opts.allErrors,u="data"+(i||""),f="valid"+a;if(n+="var "+f+" = undefined;",!1===e.opts.format)return n+=" "+f+" = true; ";var $=e.schema.format,p=e.opts.v5&&$.$data,d="";if(p){var h=e.util.getData($.$data,i,e.dataPathArr),_="format"+a,m="compare"+a;n+=" var "+_+" = formats["+h+"] , "+m+" = "+_+" && "+_+".compare;"}else{var _=e.formats[$];if(!_||!_.compare)return n+="  "+f+" = true; ";var m="formats"+e.util.getProperty($)+".compare"}var y,g="formatMaximum"==t,v="formatExclusive"+(g?"Maximum":"Minimum"),b=e.schema[v],x=e.opts.v5&&b&&b.$data,w=g?"<":">",A="result"+a,k=e.opts.v5&&s&&s.$data;if(k?(n+=" var schema"+a+" = "+e.util.getData(s.$data,i,e.dataPathArr)+"; ",y="schema"+a):y=s,x){var E=e.util.getData(b.$data,i,e.dataPathArr),S="exclusive"+a,N="op"+a,C="' + "+N+" + '";n+=" var schemaExcl"+a+" = "+E+"; ",E="schemaExcl"+a,n+=" if (typeof "+E+" != 'boolean' && "+E+" !== undefined) { "+f+" = false; ";var r=v,I=I||[];I.push(n),n="",!1!==e.createErrors?(n+=" { keyword: '"+(r||"_formatExclusiveLimit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: {} ",!1!==e.opts.messages&&(n+=" , message: '"+v+" should be boolean' "),e.opts.verbose&&(n+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),n+=" } "):n+=" {} ";var O=n;n=I.pop(),!e.compositeRule&&l?e.async?n+=" throw new ValidationError(["+O+"]); ":n+=" validate.errors = ["+O+"]; return false; ":n+=" var err = "+O+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" }  ",l&&(d+="}",n+=" else { "),k&&(n+=" if ("+y+" === undefined) "+f+" = true; else if (typeof "+y+" != 'string') "+f+" = false; else { ",d+="}"),p&&(n+=" if (!"+m+") "+f+" = true; else { ",d+="}"),n+=" var "+A+" = "+m+"("+u+",  ",n+=k?""+y:""+e.util.toQuotedString(s),n+=" ); if ("+A+" === undefined) "+f+" = false; var "+S+" = "+E+" === true; if ("+f+" === undefined) { "+f+" = "+S+" ? "+A+" "+w+" 0 : "+A+" "+w+"= 0; } if (!"+f+") var op"+a+" = "+S+" ? '"+w+"' : '"+w+"=';"}else{var S=!0===b,C=w;S||(C+="=");var N="'"+C+"'";k&&(n+=" if ("+y+" === undefined) "+f+" = true; else if (typeof "+y+" != 'string') "+f+" = false; else { ",d+="}"),p&&(n+=" if (!"+m+") "+f+" = true; else { ",d+="}"),n+=" var "+A+" = "+m+"("+u+",  ",n+=k?""+y:""+e.util.toQuotedString(s),n+=" ); if ("+A+" === undefined) "+f+" = false; if ("+f+" === undefined) "+f+" = "+A+" "+w,S||(n+="="),n+=" 0;"}n+=d+"if (!"+f+") { ";var r=t,I=I||[];I.push(n),n="",!1!==e.createErrors?(n+=" { keyword: '"+(r||"_formatLimit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { comparison: "+N+", limit:  ",n+=k?""+y:""+e.util.toQuotedString(s),n+=" , exclusive: "+S+" } ",!1!==e.opts.messages&&(n+=" , message: 'should be "+C+' "',n+=k?"' + "+y+" + '":""+e.util.escapeQuotes(s),n+="\"' "),e.opts.verbose&&(n+=" , schema:  ",n+=k?"validate.schema"+o:""+e.util.toQuotedString(s),n+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),n+=" } "):n+=" {} ";var O=n;return n=I.pop(),!e.compositeRule&&l?e.async?n+=" throw new ValidationError(["+O+"]); ":n+=" validate.errors = ["+O+"]; return false; ":n+=" var err = "+O+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+="}"}},{}],16:[function(e,t,r){"use strict";t.exports=function(e,t){var r,n,a=" ",i=e.level,s=e.dataLevel,o=e.schema[t],c=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,f="data"+(s||""),$=e.opts.v5&&o&&o.$data;$?(a+=" var schema"+i+" = "+e.util.getData(o.$data,s,e.dataPathArr)+"; ",n="schema"+i):n=o;var p="maximum"==t,d=p?"exclusiveMaximum":"exclusiveMinimum",h=e.schema[d],_=e.opts.v5&&h&&h.$data,m=p?"<":">",y=p?">":"<";if(_){var g=e.util.getData(h.$data,s,e.dataPathArr),v="exclusive"+i,b="op"+i,x="' + "+b+" + '";a+=" var schemaExcl"+i+" = "+g+"; ",g="schemaExcl"+i,a+=" var exclusive"+i+"; if (typeof "+g+" != 'boolean' && typeof "+g+" != 'undefined') { ";var r=d,w=w||[];w.push(a),a="",!1!==e.createErrors?(a+=" { keyword: '"+(r||"_exclusiveLimit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: {} ",!1!==e.opts.messages&&(a+=" , message: '"+d+" should be boolean' "),e.opts.verbose&&(a+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),a+=" } "):a+=" {} ";var A=a;a=w.pop(),!e.compositeRule&&u?e.async?a+=" throw new ValidationError(["+A+"]); ":a+=" validate.errors = ["+A+"]; return false; ":a+=" var err = "+A+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",a+=" } else if( ",$&&(a+=" ("+n+" !== undefined && typeof "+n+" != 'number') || "),a+=" ((exclusive"+i+" = "+g+" === true) ? "+f+" "+y+"= "+n+" : "+f+" "+y+" "+n+") || "+f+" !== "+f+") { var op"+i+" = exclusive"+i+" ? '"+m+"' : '"+m+"=';"}else{var v=!0===h,x=m;v||(x+="=");var b="'"+x+"'";a+=" if ( ",$&&(a+=" ("+n+" !== undefined && typeof "+n+" != 'number') || "),a+=" "+f+" "+y,v&&(a+="="),a+=" "+n+" || "+f+" !== "+f+") {"}var r=t,w=w||[];w.push(a),a="",!1!==e.createErrors?(a+=" { keyword: '"+(r||"_limit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { comparison: "+b+", limit: "+n+", exclusive: "+v+" } ",!1!==e.opts.messages&&(a+=" , message: 'should be "+x+" ",a+=$?"' + "+n:o+"'"),e.opts.verbose&&(a+=" , schema:  ",a+=$?"validate.schema"+c:""+o,a+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),a+=" } "):a+=" {} ";var A=a;return a=w.pop(),!e.compositeRule&&u?e.async?a+=" throw new ValidationError(["+A+"]); ":a+=" validate.errors = ["+A+"]; return false; ":a+=" var err = "+A+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",a+=" } ",u&&(a+=" else { "),a}},{}],17:[function(e,t,r){"use strict";t.exports=function(e,t){var r,n,a=" ",i=e.level,s=e.dataLevel,o=e.schema[t],c=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,f="data"+(s||""),$=e.opts.v5&&o&&o.$data;$?(a+=" var schema"+i+" = "+e.util.getData(o.$data,s,e.dataPathArr)+"; ",n="schema"+i):n=o;var p="maxItems"==t?">":"<";a+="if ( ",$&&(a+=" ("+n+" !== undefined && typeof "+n+" != 'number') || "),a+=" "+f+".length "+p+" "+n+") { ";var r=t,d=d||[];d.push(a),a="",!1!==e.createErrors?(a+=" { keyword: '"+(r||"_limitItems")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { limit: "+n+" } ",!1!==e.opts.messages&&(a+=" , message: 'should NOT have ",a+="maxItems"==t?"more":"less",a+=" than ",a+=$?"' + "+n+" + '":""+o,a+=" items' "),e.opts.verbose&&(a+=" , schema:  ",a+=$?"validate.schema"+c:""+o,a+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),a+=" } "):a+=" {} ";var h=a;return a=d.pop(),!e.compositeRule&&u?e.async?a+=" throw new ValidationError(["+h+"]); ":a+=" validate.errors = ["+h+"]; return false; ":a+=" var err = "+h+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",a+="} ",u&&(a+=" else { "),a}},{}],18:[function(e,t,r){"use strict";t.exports=function(e,t){var r,n,a=" ",i=e.level,s=e.dataLevel,o=e.schema[t],c=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,f="data"+(s||""),$=e.opts.v5&&o&&o.$data;$?(a+=" var schema"+i+" = "+e.util.getData(o.$data,s,e.dataPathArr)+"; ",n="schema"+i):n=o;var p="maxLength"==t?">":"<";a+="if ( ",$&&(a+=" ("+n+" !== undefined && typeof "+n+" != 'number') || "),!1===e.opts.unicode?a+=" "+f+".length ":a+=" ucs2length("+f+") ",a+=" "+p+" "+n+") { ";var r=t,d=d||[];d.push(a),a="",!1!==e.createErrors?(a+=" { keyword: '"+(r||"_limitLength")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { limit: "+n+" } ",!1!==e.opts.messages&&(a+=" , message: 'should NOT be ",a+="maxLength"==t?"longer":"shorter",a+=" than ",a+=$?"' + "+n+" + '":""+o,a+=" characters' "),e.opts.verbose&&(a+=" , schema:  ",a+=$?"validate.schema"+c:""+o,a+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),a+=" } "):a+=" {} ";var h=a;return a=d.pop(),!e.compositeRule&&u?e.async?a+=" throw new ValidationError(["+h+"]); ":a+=" validate.errors = ["+h+"]; return false; ":a+=" var err = "+h+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",a+="} ",u&&(a+=" else { "),a}},{}],19:[function(e,t,r){"use strict";t.exports=function(e,t){var r,n,a=" ",i=e.level,s=e.dataLevel,o=e.schema[t],c=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,f="data"+(s||""),$=e.opts.v5&&o&&o.$data;$?(a+=" var schema"+i+" = "+e.util.getData(o.$data,s,e.dataPathArr)+"; ",n="schema"+i):n=o;var p="maxProperties"==t?">":"<";a+="if ( ",$&&(a+=" ("+n+" !== undefined && typeof "+n+" != 'number') || "),a+=" Object.keys("+f+").length "+p+" "+n+") { ";var r=t,d=d||[];d.push(a),a="",!1!==e.createErrors?(a+=" { keyword: '"+(r||"_limitProperties")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { limit: "+n+" } ",!1!==e.opts.messages&&(a+=" , message: 'should NOT have ",a+="maxProperties"==t?"more":"less",a+=" than ",a+=$?"' + "+n+" + '":""+o,a+=" properties' "),e.opts.verbose&&(a+=" , schema:  ",a+=$?"validate.schema"+c:""+o,a+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),a+=" } "):a+=" {} ";var h=a;return a=d.pop(),!e.compositeRule&&u?e.async?a+=" throw new ValidationError(["+h+"]); ":a+=" validate.errors = ["+h+"]; return false; ":a+=" var err = "+h+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",a+="} ",u&&(a+=" else { "),a}},{}],20:[function(e,t,r){"use strict";t.exports=function(e,t){var r=" ",n=e.schema[t],a=e.schemaPath+e.util.getProperty(t),i=e.errSchemaPath+"/"+t,s=!e.opts.allErrors,o=e.util.copy(e),c="";o.level++;var l="valid"+o.level,u=o.baseId,f=!0,$=n;if($)for(var p,d=-1,h=$.length-1;d<h;)p=$[d+=1],e.util.schemaHasRules(p,e.RULES.all)&&(f=!1,o.schema=p,o.schemaPath=a+"["+d+"]",o.errSchemaPath=i+"/"+d,r+="  "+e.validate(o)+" ",o.baseId=u,s&&(r+=" if ("+l+") { ",c+="}"));return s&&(r+=f?" if (true) { ":" "+c.slice(0,-1)+" "),r=e.util.cleanUpCode(r)}},{}],21:[function(e,t,r){"use strict";t.exports=function(e,t){var r=" ",n=e.level,a=e.dataLevel,i=e.schema[t],s=e.schemaPath+e.util.getProperty(t),o=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,l="data"+(a||""),u="valid"+n,f="errs__"+n,$=e.util.copy(e),p="";$.level++;var d="valid"+$.level;if(i.every(function(t){return e.util.schemaHasRules(t,e.RULES.all)})){var h=$.baseId;r+=" var "+f+" = errors; var "+u+" = false;  ";var _=e.compositeRule;e.compositeRule=$.compositeRule=!0;var m=i;if(m)for(var y,g=-1,v=m.length-1;g<v;)y=m[g+=1],$.schema=y,$.schemaPath=s+"["+g+"]",$.errSchemaPath=o+"/"+g,r+="  "+e.validate($)+" ",$.baseId=h,r+=" "+u+" = "+u+" || "+d+"; if (!"+u+") { ",p+="}";e.compositeRule=$.compositeRule=_,r+=" "+p+" if (!"+u+") {  var err =   ",!1!==e.createErrors?(r+=" { keyword: 'anyOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(o)+" , params: {} ",!1!==e.opts.messages&&(r+=" , message: 'should match some schema in anyOf' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } else {  errors = "+f+"; if (vErrors !== null) { if ("+f+") vErrors.length = "+f+"; else vErrors = null; } ",e.opts.allErrors&&(r+=" } "),r=e.util.cleanUpCode(r)}else c&&(r+=" if (true) { ");return r}},{}],22:[function(e,t,r){"use strict";t.exports=function(e,t){var r=" ",n=e.level,a=e.dataLevel,i=e.schema[t],s=e.schemaPath+e.util.getProperty(t),o=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,l="data"+(a||""),u="valid"+n,f=e.opts.v5&&i&&i.$data;f&&(r+=" var schema"+n+" = "+e.util.getData(i.$data,a,e.dataPathArr)+"; "),f||(r+=" var schema"+n+" = validate.schema"+s+";"),r+="var "+u+" = equal("+l+", schema"+n+"); if (!"+u+") {   ";var $=$||[];$.push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'constant' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(o)+" , params: {} ",!1!==e.opts.messages&&(r+=" , message: 'should be equal to constant' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ";var p=r;return r=$.pop(),!e.compositeRule&&c?e.async?r+=" throw new ValidationError(["+p+"]); ":r+=" validate.errors = ["+p+"]; return false; ":r+=" var err = "+p+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" }"}},{}],23:[function(e,t,r){"use strict";t.exports=function(e,t){var r,n,a=" ",i=e.level,s=e.dataLevel,o=e.schema[t],c=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,f="data"+(s||""),$="valid"+i,p="errs__"+i,d=e.opts.v5&&o&&o.$data;d?(a+=" var schema"+i+" = "+e.util.getData(o.$data,s,e.dataPathArr)+"; ",n="schema"+i):n=o;var h,_,m,y,g,v=this,b="definition"+i,x=v.definition;if(d&&x.$data){g="keywordValidate"+i;var w=x.validateSchema;a+=" var "+b+" = RULES.custom['"+t+"'].definition; var "+g+" = "+b+".validate;"}else y=e.useCustomRule(v,o,e.schema,e),n="validate.schema"+c,g=y.code,h=x.compile,_=x.inline,m=x.macro;var A=g+".errors",k="i"+i,E="ruleErr"+i,S=x.async;if(S&&!e.async)throw new Error("async keyword in sync schema");if(_||m||(a+=A+" = null;"),a+="var "+p+" = errors;var "+$+";",w&&(a+=" "+$+" = "+b+".validateSchema("+n+"); if ("+$+") {"),_)x.statements?a+=" "+y.validate+" ":a+=" "+$+" = "+y.validate+"; ";else if(m){var N=e.util.copy(e);N.level++;var C="valid"+N.level;N.schema=y.validate,N.schemaPath="";var I=e.compositeRule;e.compositeRule=N.compositeRule=!0;var O=e.validate(N).replace(/validate\.schema/g,g);e.compositeRule=N.compositeRule=I,a+=" "+O}else{var L=L||[];L.push(a),a="",a+="  "+g+".call( ",e.opts.passContext?a+="this":a+="self",h||!1===x.schema?a+=" , "+f+" ":a+=" , "+n+" , "+f+" , validate.schema"+e.schemaPath+" ",a+=" , (dataPath || '')",'""'!=e.errorPath&&(a+=" + "+e.errorPath);var P=s?"data"+(s-1||""):"parentData",M=s?e.dataPathArr[s]:"parentDataProperty";a+=" , "+P+" , "+M+" , rootData )  ";var T=a;a=L.pop(),!1===x.errors?(a+=" "+$+" = ",S&&(a+=""+e.yieldAwait),a+=T+"; "):S?(A="customErrors"+i,a+=" var "+A+" = null; try { "+$+" = "+e.yieldAwait+T+"; } catch (e) { "+$+" = false; if (e instanceof ValidationError) "+A+" = e.errors; else throw e; } "):a+=" "+A+" = null; "+$+" = "+T+"; "}if(x.modifying&&(a+=" "+f+" = "+P+"["+M+"];"),w&&(a+=" }"),x.valid)u&&(a+=" if (true) { ");else{a+=" if ( ",void 0===x.valid?(a+=" !",a+=m?""+C:""+$):a+=" "+!x.valid+" ",a+=") { ",r=v.keyword;var L=L||[];L.push(a),a="";var L=L||[];L.push(a),a="",!1!==e.createErrors?(a+=" { keyword: '"+(r||"custom")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { keyword: '"+v.keyword+"' } ",!1!==e.opts.messages&&(a+=" , message: 'should pass \""+v.keyword+"\" keyword validation' "),e.opts.verbose&&(a+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),a+=" } "):a+=" {} ";var B=a;a=L.pop(),!e.compositeRule&&u?e.async?a+=" throw new ValidationError(["+B+"]); ":a+=" validate.errors = ["+B+"]; return false; ":a+=" var err = "+B+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";var j=a;a=L.pop(),_?x.errors?"full"!=x.errors&&(a+="  for (var "+k+"="+p+"; "+k+"<errors; "+k+"++) { var "+E+" = vErrors["+k+"]; if ("+E+".dataPath === undefined) "+E+".dataPath = (dataPath || '') + "+e.errorPath+"; if ("+E+".schemaPath === undefined) { "+E+'.schemaPath = "'+l+'"; } ',e.opts.verbose&&(a+=" "+E+".schema = "+n+"; "+E+".data = "+f+"; "),a+=" } "):!1===x.errors?a+=" "+j+" ":(a+=" if ("+p+" == errors) { "+j+" } else {  for (var "+k+"="+p+"; "+k+"<errors; "+k+"++) { var "+E+" = vErrors["+k+"]; if ("+E+".dataPath === undefined) "+E+".dataPath = (dataPath || '') + "+e.errorPath+"; if ("+E+".schemaPath === undefined) { "+E+'.schemaPath = "'+l+'"; } ',e.opts.verbose&&(a+=" "+E+".schema = "+n+"; "+E+".data = "+f+"; "),a+=" } } "):m?(a+="   var err =   ",!1!==e.createErrors?(a+=" { keyword: '"+(r||"custom")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { keyword: '"+v.keyword+"' } ",!1!==e.opts.messages&&(a+=" , message: 'should pass \""+v.keyword+"\" keyword validation' "),e.opts.verbose&&(a+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),a+=" } "):a+=" {} ",a+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&u&&(e.async?a+=" throw new ValidationError(vErrors); ":a+=" validate.errors = vErrors; return false; ")):!1===x.errors?a+=" "+j+" ":(a+=" if (Array.isArray("+A+")) { if (vErrors === null) vErrors = "+A+"; else vErrors = vErrors.concat("+A+"); errors = vErrors.length;  for (var "+k+"="+p+"; "+k+"<errors; "+k+"++) { var "+E+" = vErrors["+k+"]; if ("+E+".dataPath === undefined) "+E+".dataPath = (dataPath || '') + "+e.errorPath+";  "+E+'.schemaPath = "'+l+'";  ',e.opts.verbose&&(a+=" "+E+".schema = "+n+"; "+E+".data = "+f+"; "),a+=" } } else { "+j+" } "),a+=" } ",u&&(a+=" else { ")}return a}},{}],24:[function(e,t,r){"use strict";t.exports=function(e,t){var r=" ",n=e.level,a=e.dataLevel,i=e.schema[t],s=e.schemaPath+e.util.getProperty(t),o=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,l="data"+(a||""),u="errs__"+n,f=e.util.copy(e),$="";f.level++;var p="valid"+f.level,d={},h={};for(g in i){var _=i[g],m=Array.isArray(_)?h:d;m[g]=_}r+="var "+u+" = errors;";var y=e.errorPath;r+="var missing"+n+";";for(var g in h){if(m=h[g],r+=" if ("+l+e.util.getProperty(g)+" !== undefined ",c){r+=" && ( ";var v=m;if(v)for(var b,x=-1,w=v.length-1;x<w;){b=v[x+=1],x&&(r+=" || ");var A=e.util.getProperty(b);r+=" ( "+l+A+" === undefined && (missing"+n+" = "+e.util.toQuotedString(e.opts.jsonPointers?b:A)+") ) "}r+=")) {  ";var k="missing"+n,E="' + "+k+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.opts.jsonPointers?e.util.getPathExpr(y,k,!0):y+" + "+k);var S=S||[];S.push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(o)+" , params: { property: '"+e.util.escapeQuotes(g)+"', missingProperty: '"+E+"', depsCount: "+m.length+", deps: '"+e.util.escapeQuotes(1==m.length?m[0]:m.join(", "))+"' } ",!1!==e.opts.messages&&(r+=" , message: 'should have ",1==m.length?r+="property "+e.util.escapeQuotes(m[0]):r+="properties "+e.util.escapeQuotes(m.join(", ")),r+=" when property "+e.util.escapeQuotes(g)+" is present' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ";var N=r;r=S.pop(),!e.compositeRule&&c?e.async?r+=" throw new ValidationError(["+N+"]); ":r+=" validate.errors = ["+N+"]; return false; ":r+=" var err = "+N+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else{r+=" ) { ";var C=m;if(C)for(var I,O=-1,L=C.length-1;O<L;){I=C[O+=1];var A=e.util.getProperty(I),E=e.util.escapeQuotes(I);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(y,I,e.opts.jsonPointers)),r+=" if ("+l+A+" === undefined) {  var err =   ",!1!==e.createErrors?(r+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(o)+" , params: { property: '"+e.util.escapeQuotes(g)+"', missingProperty: '"+E+"', depsCount: "+m.length+", deps: '"+e.util.escapeQuotes(1==m.length?m[0]:m.join(", "))+"' } ",!1!==e.opts.messages&&(r+=" , message: 'should have ",1==m.length?r+="property "+e.util.escapeQuotes(m[0]):r+="properties "+e.util.escapeQuotes(m.join(", ")),r+=" when property "+e.util.escapeQuotes(g)+" is present' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}r+=" }   ",c&&($+="}",r+=" else { ")}e.errorPath=y;var P=f.baseId;for(var g in d){var _=d[g];e.util.schemaHasRules(_,e.RULES.all)&&(r+=" "+p+" = true; if ("+l+e.util.getProperty(g)+" !== undefined) { ",f.schema=_,f.schemaPath=s+e.util.getProperty(g),f.errSchemaPath=o+"/"+e.util.escapeFragment(g),r+="  "+e.validate(f)+" ",f.baseId=P,r+=" }  ",c&&(r+=" if ("+p+") { ",$+="}"))}return c&&(r+="   "+$+" if ("+u+" == errors) {"),r=e.util.cleanUpCode(r)}},{}],25:[function(e,t,r){"use strict";t.exports=function(e,t){var r=" ",n=e.level,a=e.dataLevel,i=e.schema[t],s=e.schemaPath+e.util.getProperty(t),o=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,l="data"+(a||""),u="valid"+n,f=e.opts.v5&&i&&i.$data;f&&(r+=" var schema"+n+" = "+e.util.getData(i.$data,a,e.dataPathArr)+"; ");var $="i"+n,p="schema"+n;f||(r+=" var "+p+" = validate.schema"+s+";"),r+="var "+u+";",f&&(r+=" if (schema"+n+" === undefined) "+u+" = true; else if (!Array.isArray(schema"+n+")) "+u+" = false; else {"),r+=u+" = false;for (var "+$+"=0; "+$+"<"+p+".length; "+$+"++) if (equal("+l+", "+p+"["+$+"])) { "+u+" = true; break; }",f&&(r+="  }  "),r+=" if (!"+u+") {   ";var d=d||[];d.push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'enum' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(o)+" , params: { allowedValues: schema"+n+" } ",!1!==e.opts.messages&&(r+=" , message: 'should be equal to one of the allowed values' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ";var h=r;return r=d.pop(),!e.compositeRule&&c?e.async?r+=" throw new ValidationError(["+h+"]); ":r+=" validate.errors = ["+h+"]; return false; ":r+=" var err = "+h+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" }",c&&(r+=" else { "),r}},{}],26:[function(e,t,r){"use strict";t.exports=function(e,t){var r=" ",n=e.level,a=e.dataLevel,i=e.schema[t],s=e.schemaPath+e.util.getProperty(t),o=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,l="data"+(a||"");if(!1===e.opts.format)return c&&(r+=" if (true) { "),r;var u,f=e.opts.v5&&i&&i.$data;f?(r+=" var schema"+n+" = "+e.util.getData(i.$data,a,e.dataPathArr)+"; ",u="schema"+n):u=i;var $=e.opts.unknownFormats,p=Array.isArray($);if(f){var d="format"+n;r+=" var "+d+" = formats["+u+"]; var isObject"+n+" = typeof "+d+" == 'object' && !("+d+" instanceof RegExp) && "+d+".validate; if (isObject"+n+") { ",e.async&&(r+=" var async"+n+" = "+d+".async; "),r+=" "+d+" = "+d+".validate; } if (  ",f&&(r+=" ("+u+" !== undefined && typeof "+u+" != 'string') || "),r+=" (",(!0===$||p)&&(r+=" ("+u+" && !"+d+" ",p&&(r+=" && self._opts.unknownFormats.indexOf("+u+") == -1 "),r+=") || "),r+=" ("+d+" && !(typeof "+d+" == 'function' ? ",e.async?r+=" (async"+n+" ? "+e.yieldAwait+" "+d+"("+l+") : "+d+"("+l+")) ":r+=" "+d+"("+l+") ",r+=" : "+d+".test("+l+"))))) {"}else{var d=e.formats[i];if(!d){if(!0===$||p&&-1==$.indexOf(i))throw new Error('unknown format "'+i+'" is used in schema at path "'+e.errSchemaPath+'"');return p||(console.warn('unknown format "'+i+'" ignored in schema at path "'+e.errSchemaPath+'"'),"ignore"!==$&&console.warn("In the next major version it will throw exception. See option unknownFormats for more information")),c&&(r+=" if (true) { "),r}var h="object"==typeof d&&!(d instanceof RegExp)&&d.validate;if(h){var _=!0===d.async;d=d.validate}if(_){if(!e.async)throw new Error("async format in sync schema");var m="formats"+e.util.getProperty(i)+".validate";r+=" if (!("+e.yieldAwait+" "+m+"("+l+"))) { "}else{r+=" if (! ";var m="formats"+e.util.getProperty(i);h&&(m+=".validate"),r+="function"==typeof d?" "+m+"("+l+") ":" "+m+".test("+l+") ",r+=") { "}}var y=y||[];y.push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'format' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(o)+" , params: { format:  ",r+=f?""+u:""+e.util.toQuotedString(i),r+="  } ",!1!==e.opts.messages&&(r+=" , message: 'should match format \"",r+=f?"' + "+u+" + '":""+e.util.escapeQuotes(i),r+="\"' "),e.opts.verbose&&(r+=" , schema:  ",r+=f?"validate.schema"+s:""+e.util.toQuotedString(i),r+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ";var g=r;return r=y.pop(),!e.compositeRule&&c?e.async?r+=" throw new ValidationError(["+g+"]); ":r+=" validate.errors = ["+g+"]; return false; ":r+=" var err = "+g+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } ",c&&(r+=" else { "),r}},{}],27:[function(e,t,r){"use strict";t.exports=function(e,t){var r=" ",n=e.level,a=e.dataLevel,i=e.schema[t],s=e.schemaPath+e.util.getProperty(t),o=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,l="data"+(a||""),u="valid"+n,f="errs__"+n,$=e.util.copy(e),p="";$.level++;var d="valid"+$.level,h="i"+n,_=$.dataLevel=e.dataLevel+1,m="data"+_,y=e.baseId;if(r+="var "+f+" = errors;var "+u+";",Array.isArray(i)){var g=e.schema.additionalItems;if(!1===g){r+=" "+u+" = "+l+".length <= "+i.length+"; ";var v=o;o=e.errSchemaPath+"/additionalItems",r+="  if (!"+u+") {   ";var b=b||[];b.push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'additionalItems' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(o)+" , params: { limit: "+i.length+" } ",!1!==e.opts.messages&&(r+=" , message: 'should NOT have more than "+i.length+" items' "),e.opts.verbose&&(r+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ";var x=r;r=b.pop(),!e.compositeRule&&c?e.async?r+=" throw new ValidationError(["+x+"]); ":r+=" validate.errors = ["+x+"]; return false; ":r+=" var err = "+x+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } ",o=v,c&&(p+="}",r+=" else { ")}var w=i;if(w)for(var A,k=-1,E=w.length-1;k<E;)if(A=w[k+=1],e.util.schemaHasRules(A,e.RULES.all)){r+=" "+d+" = true; if ("+l+".length > "+k+") { ";var S=l+"["+k+"]";$.schema=A,$.schemaPath=s+"["+k+"]",$.errSchemaPath=o+"/"+k,$.errorPath=e.util.getPathExpr(e.errorPath,k,e.opts.jsonPointers,!0),$.dataPathArr[_]=k;var N=e.validate($);$.baseId=y,e.util.varOccurences(N,m)<2?r+=" "+e.util.varReplace(N,m,S)+" ":r+=" var "+m+" = "+S+"; "+N+" ",r+=" }  ",c&&(r+=" if ("+d+") { ",p+="}")}if("object"==typeof g&&e.util.schemaHasRules(g,e.RULES.all)){$.schema=g,$.schemaPath=e.schemaPath+".additionalItems",$.errSchemaPath=e.errSchemaPath+"/additionalItems",r+=" "+d+" = true; if ("+l+".length > "+i.length+") {  for (var "+h+" = "+i.length+"; "+h+" < "+l+".length; "+h+"++) { ",$.errorPath=e.util.getPathExpr(e.errorPath,h,e.opts.jsonPointers,!0);var S=l+"["+h+"]";$.dataPathArr[_]=h;var N=e.validate($);$.baseId=y,e.util.varOccurences(N,m)<2?r+=" "+e.util.varReplace(N,m,S)+" ":r+=" var "+m+" = "+S+"; "+N+" ",c&&(r+=" if (!"+d+") break; "),r+=" } }  ",c&&(r+=" if ("+d+") { ",p+="}")}}else if(e.util.schemaHasRules(i,e.RULES.all)){$.schema=i,$.schemaPath=s,$.errSchemaPath=o,r+="  for (var "+h+" = 0; "+h+" < "+l+".length; "+h+"++) { ",$.errorPath=e.util.getPathExpr(e.errorPath,h,e.opts.jsonPointers,!0);var S=l+"["+h+"]";$.dataPathArr[_]=h;var N=e.validate($);$.baseId=y,e.util.varOccurences(N,m)<2?r+=" "+e.util.varReplace(N,m,S)+" ":r+=" var "+m+" = "+S+"; "+N+" ",c&&(r+=" if (!"+d+") break; "),r+=" }  ",c&&(r+=" if ("+d+") { ",p+="}")}return c&&(r+=" "+p+" if ("+f+" == errors) {"),r=e.util.cleanUpCode(r)}},{}],28:[function(e,t,r){"use strict";t.exports=function(e,t){var r,n=" ",a=e.level,i=e.dataLevel,s=e.schema[t],o=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,l=!e.opts.allErrors,u="data"+(i||""),f=e.opts.v5&&s&&s.$data;f?(n+=" var schema"+a+" = "+e.util.getData(s.$data,i,e.dataPathArr)+"; ",r="schema"+a):r=s,n+="var division"+a+";if (",f&&(n+=" "+r+" !== undefined && ( typeof "+r+" != 'number' || "),n+=" (division"+a+" = "+u+" / "+r+", ",e.opts.multipleOfPrecision?n+=" Math.abs(Math.round(division"+a+") - division"+a+") > 1e-"+e.opts.multipleOfPrecision+" ":n+=" division"+a+" !== parseInt(division"+a+") ",n+=" ) ",f&&(n+="  )  "),n+=" ) {   ";var $=$||[];$.push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'multipleOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { multipleOf: "+r+" } ",!1!==e.opts.messages&&(n+=" , message: 'should be multiple of ",n+=f?"' + "+r:s+"'"),e.opts.verbose&&(n+=" , schema:  ",n+=f?"validate.schema"+o:""+s,n+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),n+=" } "):n+=" {} ";var p=n;return n=$.pop(),!e.compositeRule&&l?e.async?n+=" throw new ValidationError(["+p+"]); ":n+=" validate.errors = ["+p+"]; return false; ":n+=" var err = "+p+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+="} ",l&&(n+=" else { "),n}},{}],29:[function(e,t,r){"use strict";t.exports=function(e,t){var r=" ",n=e.level,a=e.dataLevel,i=e.schema[t],s=e.schemaPath+e.util.getProperty(t),o=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,l="data"+(a||""),u="errs__"+n,f=e.util.copy(e);f.level++;var $="valid"+f.level;if(e.util.schemaHasRules(i,e.RULES.all)){f.schema=i,f.schemaPath=s,f.errSchemaPath=o,r+=" var "+u+" = errors;  ";var p=e.compositeRule;e.compositeRule=f.compositeRule=!0,f.createErrors=!1;var d;f.opts.allErrors&&(d=f.opts.allErrors,f.opts.allErrors=!1),r+=" "+e.validate(f)+" ",f.createErrors=!0,d&&(f.opts.allErrors=d),e.compositeRule=f.compositeRule=p,r+=" if ("+$+") {   ";var h=h||[];h.push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'not' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(o)+" , params: {} ",!1!==e.opts.messages&&(r+=" , message: 'should NOT be valid' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ";var _=r;r=h.pop(),!e.compositeRule&&c?e.async?r+=" throw new ValidationError(["+_+"]); ":r+=" validate.errors = ["+_+"]; return false; ":r+=" var err = "+_+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } else {  errors = "+u+"; if (vErrors !== null) { if ("+u+") vErrors.length = "+u+"; else vErrors = null; } ",e.opts.allErrors&&(r+=" } ")}else r+="  var err =   ",!1!==e.createErrors?(r+=" { keyword: 'not' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(o)+" , params: {} ",!1!==e.opts.messages&&(r+=" , message: 'should NOT be valid' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",c&&(r+=" if (false) { ");return r}},{}],30:[function(e,t,r){"use strict";t.exports=function(e,t){var r=" ",n=e.level,a=e.dataLevel,i=e.schema[t],s=e.schemaPath+e.util.getProperty(t),o=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,l="data"+(a||""),u="valid"+n,f="errs__"+n,$=e.util.copy(e),p="";$.level++;var d="valid"+$.level;r+="var "+f+" = errors;var prevValid"+n+" = false;var "+u+" = false;";var h=$.baseId,_=e.compositeRule;e.compositeRule=$.compositeRule=!0;var m=i;if(m)for(var y,g=-1,v=m.length-1;g<v;)y=m[g+=1],e.util.schemaHasRules(y,e.RULES.all)?($.schema=y,$.schemaPath=s+"["+g+"]",$.errSchemaPath=o+"/"+g,r+="  "+e.validate($)+" ",$.baseId=h):r+=" var "+d+" = true; ",g&&(r+=" if ("+d+" && prevValid"+n+") "+u+" = false; else { ",p+="}"),r+=" if ("+d+") "+u+" = prevValid"+n+" = true;";e.compositeRule=$.compositeRule=_,r+=p+"if (!"+u+") {   ";var b=b||[];b.push(r),r="",
!1!==e.createErrors?(r+=" { keyword: 'oneOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(o)+" , params: {} ",!1!==e.opts.messages&&(r+=" , message: 'should match exactly one schema in oneOf' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ";var x=r;return r=b.pop(),!e.compositeRule&&c?e.async?r+=" throw new ValidationError(["+x+"]); ":r+=" validate.errors = ["+x+"]; return false; ":r+=" var err = "+x+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+="} else {  errors = "+f+"; if (vErrors !== null) { if ("+f+") vErrors.length = "+f+"; else vErrors = null; }",e.opts.allErrors&&(r+=" } "),r}},{}],31:[function(e,t,r){"use strict";t.exports=function(e,t){var r,n=" ",a=e.level,i=e.dataLevel,s=e.schema[t],o=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,l=!e.opts.allErrors,u="data"+(i||""),f=e.opts.v5&&s&&s.$data;f?(n+=" var schema"+a+" = "+e.util.getData(s.$data,i,e.dataPathArr)+"; ",r="schema"+a):r=s;var $=f?"(new RegExp("+r+"))":e.usePattern(s);n+="if ( ",f&&(n+=" ("+r+" !== undefined && typeof "+r+" != 'string') || "),n+=" !"+$+".test("+u+") ) {   ";var p=p||[];p.push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'pattern' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { pattern:  ",n+=f?""+r:""+e.util.toQuotedString(s),n+="  } ",!1!==e.opts.messages&&(n+=" , message: 'should match pattern \"",n+=f?"' + "+r+" + '":""+e.util.escapeQuotes(s),n+="\"' "),e.opts.verbose&&(n+=" , schema:  ",n+=f?"validate.schema"+o:""+e.util.toQuotedString(s),n+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),n+=" } "):n+=" {} ";var d=n;return n=p.pop(),!e.compositeRule&&l?e.async?n+=" throw new ValidationError(["+d+"]); ":n+=" validate.errors = ["+d+"]; return false; ":n+=" var err = "+d+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+="} ",l&&(n+=" else { "),n}},{}],32:[function(e,t,r){"use strict";t.exports=function(e,t){var r=" ",n=e.level,a=e.dataLevel,i=e.schema[t],s=e.schemaPath+e.util.getProperty(t),o=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,l="data"+(a||""),u="valid"+n,f="key"+n,$="patternMatched"+n,p="",d=e.opts.ownProperties;r+="var "+u+" = true;";var h=i;if(h)for(var _,m=-1,y=h.length-1;m<y;){_=h[m+=1],r+=" var "+$+" = false; for (var "+f+" in "+l+") {  ",d&&(r+=" if (!Object.prototype.hasOwnProperty.call("+l+", "+f+")) continue; "),r+=" "+$+" = "+e.usePattern(_)+".test("+f+"); if ("+$+") break; } ";var g=e.util.escapeQuotes(_);r+=" if (!"+$+") { "+u+" = false;  var err =   ",!1!==e.createErrors?(r+=" { keyword: 'patternRequired' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(o)+" , params: { missingPattern: '"+g+"' } ",!1!==e.opts.messages&&(r+=" , message: 'should have property matching pattern \\'"+g+"\\'' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; }   ",c&&(p+="}",r+=" else { ")}return r+=""+p}},{}],33:[function(e,t,r){"use strict";t.exports=function(e,t){var r=" ",n=e.level,a=e.dataLevel,i=e.schema[t],s=e.schemaPath+e.util.getProperty(t),o=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,l="data"+(a||""),u="valid"+n,f="errs__"+n,$=e.util.copy(e),p="";$.level++;var d="valid"+$.level,h="key"+n,_=$.dataLevel=e.dataLevel+1,m="data"+_,y=Object.keys(i||{}),g=e.schema.patternProperties||{},v=Object.keys(g),b=e.schema.additionalProperties,x=y.length||v.length,w=!1===b,A="object"==typeof b&&Object.keys(b).length,k=e.opts.removeAdditional,E=w||A||k,S=e.opts.ownProperties,N=e.baseId,C=e.schema.required;if(C&&(!e.opts.v5||!C.$data)&&C.length<e.opts.loopRequired)var I=e.util.toHash(C);if(e.opts.v5)var O=e.schema.patternGroups||{},L=Object.keys(O);if(r+="var "+f+" = errors;var "+d+" = true;",E){if(r+=" for (var "+h+" in "+l+") {  ",S&&(r+=" if (!Object.prototype.hasOwnProperty.call("+l+", "+h+")) continue; "),x){if(r+=" var isAdditional"+n+" = !(false ",y.length)if(y.length>5)r+=" || validate.schema"+s+"["+h+"] ";else{var P=y;if(P)for(var M,T=-1,B=P.length-1;T<B;)M=P[T+=1],r+=" || "+h+" == "+e.util.toQuotedString(M)+" "}if(v.length){var j=v;if(j)for(var F,R=-1,D=j.length-1;R<D;)F=j[R+=1],r+=" || "+e.usePattern(F)+".test("+h+") "}if(e.opts.v5&&L&&L.length){var z=L;if(z)for(var q,R=-1,U=z.length-1;R<U;)q=z[R+=1],r+=" || "+e.usePattern(q)+".test("+h+") "}r+=" ); if (isAdditional"+n+") { "}if("all"==k)r+=" delete "+l+"["+h+"]; ";else{var H=e.errorPath,G="' + "+h+" + '";if(e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(e.errorPath,h,e.opts.jsonPointers)),w)if(k)r+=" delete "+l+"["+h+"]; ";else{r+=" "+d+" = false; ";var Y=o;o=e.errSchemaPath+"/additionalProperties";var V=V||[];V.push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'additionalProperties' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(o)+" , params: { additionalProperty: '"+G+"' } ",!1!==e.opts.messages&&(r+=" , message: 'should NOT have additional properties' "),e.opts.verbose&&(r+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ";var Q=r;r=V.pop(),!e.compositeRule&&c?e.async?r+=" throw new ValidationError(["+Q+"]); ":r+=" validate.errors = ["+Q+"]; return false; ":r+=" var err = "+Q+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",o=Y,c&&(r+=" break; ")}else if(A)if("failing"==k){r+=" var "+f+" = errors;  ";var X=e.compositeRule;e.compositeRule=$.compositeRule=!0,$.schema=b,$.schemaPath=e.schemaPath+".additionalProperties",$.errSchemaPath=e.errSchemaPath+"/additionalProperties",$.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,h,e.opts.jsonPointers);var W=l+"["+h+"]";$.dataPathArr[_]=h;var J=e.validate($);$.baseId=N,e.util.varOccurences(J,m)<2?r+=" "+e.util.varReplace(J,m,W)+" ":r+=" var "+m+" = "+W+"; "+J+" ",r+=" if (!"+d+") { errors = "+f+"; if (validate.errors !== null) { if (errors) validate.errors.length = errors; else validate.errors = null; } delete "+l+"["+h+"]; }  ",e.compositeRule=$.compositeRule=X}else{$.schema=b,$.schemaPath=e.schemaPath+".additionalProperties",$.errSchemaPath=e.errSchemaPath+"/additionalProperties",$.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,h,e.opts.jsonPointers);var W=l+"["+h+"]";$.dataPathArr[_]=h;var J=e.validate($);$.baseId=N,e.util.varOccurences(J,m)<2?r+=" "+e.util.varReplace(J,m,W)+" ":r+=" var "+m+" = "+W+"; "+J+" ",c&&(r+=" if (!"+d+") break; ")}e.errorPath=H}x&&(r+=" } "),r+=" }  ",c&&(r+=" if ("+d+") { ",p+="}")}var K=e.opts.useDefaults&&!e.compositeRule;if(y.length){var Z=y;if(Z)for(var M,ee=-1,te=Z.length-1;ee<te;){M=Z[ee+=1];var re=i[M];if(e.util.schemaHasRules(re,e.RULES.all)){var ne=e.util.getProperty(M),W=l+ne,ae=K&&void 0!==re.default;$.schema=re,$.schemaPath=s+ne,$.errSchemaPath=o+"/"+e.util.escapeFragment(M),$.errorPath=e.util.getPath(e.errorPath,M,e.opts.jsonPointers),$.dataPathArr[_]=e.util.toQuotedString(M);var J=e.validate($);if($.baseId=N,e.util.varOccurences(J,m)<2){J=e.util.varReplace(J,m,W);var ie=W}else{var ie=m;r+=" var "+m+" = "+W+"; "}if(ae)r+=" "+J+" ";else{if(I&&I[M]){r+=" if ("+ie+" === undefined) { "+d+" = false; ";var H=e.errorPath,Y=o,se=e.util.escapeQuotes(M);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(H,M,e.opts.jsonPointers)),o=e.errSchemaPath+"/required";var V=V||[];V.push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(o)+" , params: { missingProperty: '"+se+"' } ",!1!==e.opts.messages&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+se+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ";var Q=r;r=V.pop(),!e.compositeRule&&c?e.async?r+=" throw new ValidationError(["+Q+"]); ":r+=" validate.errors = ["+Q+"]; return false; ":r+=" var err = "+Q+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",o=Y,e.errorPath=H,r+=" } else { "}else r+=c?" if ("+ie+" === undefined) { "+d+" = true; } else { ":" if ("+ie+" !== undefined) { ";r+=" "+J+" } "}}c&&(r+=" if ("+d+") { ",p+="}")}}var oe=v;if(oe)for(var F,ce=-1,le=oe.length-1;ce<le;){F=oe[ce+=1];var re=g[F];if(e.util.schemaHasRules(re,e.RULES.all)){$.schema=re,$.schemaPath=e.schemaPath+".patternProperties"+e.util.getProperty(F),$.errSchemaPath=e.errSchemaPath+"/patternProperties/"+e.util.escapeFragment(F),r+=" for (var "+h+" in "+l+") {  ",S&&(r+=" if (!Object.prototype.hasOwnProperty.call("+l+", "+h+")) continue; "),r+=" if ("+e.usePattern(F)+".test("+h+")) { ",$.errorPath=e.util.getPathExpr(e.errorPath,h,e.opts.jsonPointers);var W=l+"["+h+"]";$.dataPathArr[_]=h;var J=e.validate($);$.baseId=N,e.util.varOccurences(J,m)<2?r+=" "+e.util.varReplace(J,m,W)+" ":r+=" var "+m+" = "+W+"; "+J+" ",c&&(r+=" if (!"+d+") break; "),r+=" } ",c&&(r+=" else "+d+" = true; "),r+=" }  ",c&&(r+=" if ("+d+") { ",p+="}")}}if(e.opts.v5){var ue=L;if(ue)for(var q,fe=-1,$e=ue.length-1;fe<$e;){q=ue[fe+=1];var pe=O[q],re=pe.schema;if(e.util.schemaHasRules(re,e.RULES.all)){$.schema=re,$.schemaPath=e.schemaPath+".patternGroups"+e.util.getProperty(q)+".schema",$.errSchemaPath=e.errSchemaPath+"/patternGroups/"+e.util.escapeFragment(q)+"/schema",r+=" var pgPropCount"+n+" = 0; for (var "+h+" in "+l+") {  ",S&&(r+=" if (!Object.prototype.hasOwnProperty.call("+l+", "+h+")) continue; "),r+=" if ("+e.usePattern(q)+".test("+h+")) { pgPropCount"+n+"++; ",$.errorPath=e.util.getPathExpr(e.errorPath,h,e.opts.jsonPointers);var W=l+"["+h+"]";$.dataPathArr[_]=h;var J=e.validate($);$.baseId=N,e.util.varOccurences(J,m)<2?r+=" "+e.util.varReplace(J,m,W)+" ":r+=" var "+m+" = "+W+"; "+J+" ",c&&(r+=" if (!"+d+") break; "),r+=" } ",c&&(r+=" else "+d+" = true; "),r+=" }  ",c&&(r+=" if ("+d+") { ",p+="}");var de=pe.minimum,he=pe.maximum;if(void 0!==de||void 0!==he){r+=" var "+u+" = true; ";var Y=o;if(void 0!==de){var _e=de,me="minimum",ye="less";r+=" "+u+" = pgPropCount"+n+" >= "+de+"; ",o=e.errSchemaPath+"/patternGroups/minimum",r+="  if (!"+u+") {   ";var V=V||[];V.push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'patternGroups' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(o)+" , params: { reason: '"+me+"', limit: "+_e+", pattern: '"+e.util.escapeQuotes(q)+"' } ",!1!==e.opts.messages&&(r+=" , message: 'should NOT have "+ye+" than "+_e+' properties matching pattern "'+e.util.escapeQuotes(q)+"\"' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ";var Q=r;r=V.pop(),!e.compositeRule&&c?e.async?r+=" throw new ValidationError(["+Q+"]); ":r+=" validate.errors = ["+Q+"]; return false; ":r+=" var err = "+Q+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } ",void 0!==he&&(r+=" else ")}if(void 0!==he){var _e=he,me="maximum",ye="more";r+=" "+u+" = pgPropCount"+n+" <= "+he+"; ",o=e.errSchemaPath+"/patternGroups/maximum",r+="  if (!"+u+") {   ";var V=V||[];V.push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'patternGroups' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(o)+" , params: { reason: '"+me+"', limit: "+_e+", pattern: '"+e.util.escapeQuotes(q)+"' } ",!1!==e.opts.messages&&(r+=" , message: 'should NOT have "+ye+" than "+_e+' properties matching pattern "'+e.util.escapeQuotes(q)+"\"' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ";var Q=r;r=V.pop(),!e.compositeRule&&c?e.async?r+=" throw new ValidationError(["+Q+"]); ":r+=" validate.errors = ["+Q+"]; return false; ":r+=" var err = "+Q+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } "}o=Y,c&&(r+=" if ("+u+") { ",p+="}")}}}}return c&&(r+=" "+p+" if ("+f+" == errors) {"),r=e.util.cleanUpCode(r)}},{}],34:[function(e,t,r){"use strict";t.exports=function(e,t){var r,n,a=" ",i=e.level,s=e.dataLevel,o=e.schema[t],c=e.errSchemaPath+"/"+t,l=!e.opts.allErrors,u="data"+(s||""),f="valid"+i;if("#"==o||"#/"==o)e.isRoot?(r=e.async,n="validate"):(r=!0===e.root.schema.$async,n="root.refVal[0]");else{var $=e.resolveRef(e.baseId,o,e.isRoot);if(void 0===$){var p="can't resolve reference "+o+" from id "+e.baseId;if("fail"==e.opts.missingRefs){console.log(p);var d=d||[];d.push(a),a="",!1!==e.createErrors?(a+=" { keyword: '$ref' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { ref: '"+e.util.escapeQuotes(o)+"' } ",!1!==e.opts.messages&&(a+=" , message: 'can\\'t resolve reference "+e.util.escapeQuotes(o)+"' "),e.opts.verbose&&(a+=" , schema: "+e.util.toQuotedString(o)+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),a+=" } "):a+=" {} ";var h=a;a=d.pop(),!e.compositeRule&&l?e.async?a+=" throw new ValidationError(["+h+"]); ":a+=" validate.errors = ["+h+"]; return false; ":a+=" var err = "+h+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",l&&(a+=" if (false) { ")}else{if("ignore"!=e.opts.missingRefs){var _=new Error(p);throw _.missingRef=e.resolve.url(e.baseId,o),_.missingSchema=e.resolve.normalizeId(e.resolve.fullPath(_.missingRef)),_}console.log(p),l&&(a+=" if (true) { ")}}else if($.inline){var m=e.util.copy(e);m.level++;var y="valid"+m.level;m.schema=$.schema,m.schemaPath="",m.errSchemaPath=o;var g=e.validate(m).replace(/validate\.schema/g,$.code);a+=" "+g+" ",l&&(a+=" if ("+y+") { ")}else r=!0===$.$async,n=$.code}if(n){var d=d||[];d.push(a),a="",e.opts.passContext?a+=" "+n+".call(this, ":a+=" "+n+"( ",a+=" "+u+", (dataPath || '')",'""'!=e.errorPath&&(a+=" + "+e.errorPath);a+=" , "+(s?"data"+(s-1||""):"parentData")+" , "+(s?e.dataPathArr[s]:"parentDataProperty")+", rootData)  ";var v=a;if(a=d.pop(),r){if(!e.async)throw new Error("async schema referenced by sync schema");a+=" try { ",l&&(a+="var "+f+" ="),a+=" "+e.yieldAwait+" "+v+"; } catch (e) { if (!(e instanceof ValidationError)) throw e; if (vErrors === null) vErrors = e.errors; else vErrors = vErrors.concat(e.errors); errors = vErrors.length; } ",l&&(a+=" if ("+f+") { ")}else a+=" if (!"+v+") { if (vErrors === null) vErrors = "+n+".errors; else vErrors = vErrors.concat("+n+".errors); errors = vErrors.length; } ",l&&(a+=" else { ")}return a}},{}],35:[function(e,t,r){"use strict";t.exports=function(e,t){var r=" ",n=e.level,a=e.dataLevel,i=e.schema[t],s=e.schemaPath+e.util.getProperty(t),o=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,l="data"+(a||""),u="valid"+n,f=e.opts.v5&&i&&i.$data;f&&(r+=" var schema"+n+" = "+e.util.getData(i.$data,a,e.dataPathArr)+"; ");var $="schema"+n;if(!f)if(i.length<e.opts.loopRequired&&e.schema.properties&&Object.keys(e.schema.properties).length){var p=[],d=i;if(d)for(var h,_=-1,m=d.length-1;_<m;){h=d[_+=1];var y=e.schema.properties[h];y&&e.util.schemaHasRules(y,e.RULES.all)||(p[p.length]=h)}}else var p=i;if(f||p.length){var g=e.errorPath,v=f||p.length>=e.opts.loopRequired;if(c)if(r+=" var missing"+n+"; ",v){f||(r+=" var "+$+" = validate.schema"+s+"; ");var b="i"+n,x="schema"+n+"["+b+"]",w="' + "+x+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(g,x,e.opts.jsonPointers)),r+=" var "+u+" = true; ",f&&(r+=" if (schema"+n+" === undefined) "+u+" = true; else if (!Array.isArray(schema"+n+")) "+u+" = false; else {"),r+=" for (var "+b+" = 0; "+b+" < "+$+".length; "+b+"++) { "+u+" = "+l+"["+$+"["+b+"]] !== undefined; if (!"+u+") break; } ",f&&(r+="  }  "),r+="  if (!"+u+") {   ";var A=A||[];A.push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(o)+" , params: { missingProperty: '"+w+"' } ",!1!==e.opts.messages&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+w+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ";var k=r;r=A.pop(),!e.compositeRule&&c?e.async?r+=" throw new ValidationError(["+k+"]); ":r+=" validate.errors = ["+k+"]; return false; ":r+=" var err = "+k+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } else { "}else{r+=" if ( ";var E=p;if(E)for(var S,b=-1,N=E.length-1;b<N;){S=E[b+=1],b&&(r+=" || ");var C=e.util.getProperty(S);r+=" ( "+l+C+" === undefined && (missing"+n+" = "+e.util.toQuotedString(e.opts.jsonPointers?S:C)+") ) "}r+=") {  ";var x="missing"+n,w="' + "+x+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.opts.jsonPointers?e.util.getPathExpr(g,x,!0):g+" + "+x);var A=A||[];A.push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(o)+" , params: { missingProperty: '"+w+"' } ",!1!==e.opts.messages&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+w+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ";var k=r;r=A.pop(),!e.compositeRule&&c?e.async?r+=" throw new ValidationError(["+k+"]); ":r+=" validate.errors = ["+k+"]; return false; ":r+=" var err = "+k+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } else { "}else if(v){f||(r+=" var "+$+" = validate.schema"+s+"; ");var b="i"+n,x="schema"+n+"["+b+"]",w="' + "+x+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(g,x,e.opts.jsonPointers)),f&&(r+=" if ("+$+" && !Array.isArray("+$+")) {  var err =   ",!1!==e.createErrors?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(o)+" , params: { missingProperty: '"+w+"' } ",!1!==e.opts.messages&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+w+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } else if ("+$+" !== undefined) { "),r+=" for (var "+b+" = 0; "+b+" < "+$+".length; "+b+"++) { if ("+l+"["+$+"["+b+"]] === undefined) {  var err =   ",!1!==e.createErrors?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(o)+" , params: { missingProperty: '"+w+"' } ",!1!==e.opts.messages&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+w+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } } ",f&&(r+="  }  ")}else{var I=p;if(I)for(var O,L=-1,P=I.length-1;L<P;){O=I[L+=1];var C=e.util.getProperty(O),w=e.util.escapeQuotes(O);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(g,O,e.opts.jsonPointers)),r+=" if ("+l+C+" === undefined) {  var err =   ",!1!==e.createErrors?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(o)+" , params: { missingProperty: '"+w+"' } ",!1!==e.opts.messages&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+w+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}e.errorPath=g}else c&&(r+=" if (true) {");return r}},{}],36:[function(e,t,r){"use strict";t.exports=function(e,t){var r=" ",n=e.level,a=e.dataLevel,i=e.schema[t],s=e.schemaPath+e.util.getProperty(t),o=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,l="data"+(a||""),u="valid"+n,f="errs__"+n,$=e.util.copy(e),p="";$.level++;var d,h="valid"+$.level,_="ifPassed"+e.level,m=$.baseId;r+="var "+_+";";var y=i;if(y)for(var g,v=-1,b=y.length-1;v<b;){if(g=y[v+=1],v&&!d&&(r+=" if (!"+_+") { ",p+="}"),g.if&&e.util.schemaHasRules(g.if,e.RULES.all)){r+=" var "+f+" = errors;   ";var x=e.compositeRule;if(e.compositeRule=$.compositeRule=!0,$.createErrors=!1,$.schema=g.if,$.schemaPath=s+"["+v+"].if",$.errSchemaPath=o+"/"+v+"/if",r+="  "+e.validate($)+" ",$.baseId=m,$.createErrors=!0,e.compositeRule=$.compositeRule=x,r+=" "+_+" = "+h+"; if ("+_+") {  ","boolean"==typeof g.then){if(!1===g.then){var w=w||[];w.push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'switch' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(o)+" , params: { caseIndex: "+v+" } ",!1!==e.opts.messages&&(r+=" , message: 'should pass \"switch\" keyword validation' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ";var A=r;r=w.pop(),!e.compositeRule&&c?e.async?r+=" throw new ValidationError(["+A+"]); ":r+=" validate.errors = ["+A+"]; return false; ":r+=" var err = "+A+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}r+=" var "+h+" = "+g.then+"; "}else $.schema=g.then,$.schemaPath=s+"["+v+"].then",$.errSchemaPath=o+"/"+v+"/then",r+="  "+e.validate($)+" ",$.baseId=m;r+="  } else {  errors = "+f+"; if (vErrors !== null) { if ("+f+") vErrors.length = "+f+"; else vErrors = null; } } "}else if(r+=" "+_+" = true;  ","boolean"==typeof g.then){if(!1===g.then){var w=w||[];w.push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'switch' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(o)+" , params: { caseIndex: "+v+" } ",!1!==e.opts.messages&&(r+=" , message: 'should pass \"switch\" keyword validation' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),r+=" } "):r+=" {} ";var A=r;r=w.pop(),!e.compositeRule&&c?e.async?r+=" throw new ValidationError(["+A+"]); ":r+=" validate.errors = ["+A+"]; return false; ":r+=" var err = "+A+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}r+=" var "+h+" = "+g.then+"; "}else $.schema=g.then,$.schemaPath=s+"["+v+"].then",$.errSchemaPath=o+"/"+v+"/then",r+="  "+e.validate($)+" ",$.baseId=m;d=g.continue}return r+=p+"var "+u+" = "+h+"; ",r=e.util.cleanUpCode(r)}},{}],37:[function(e,t,r){"use strict";t.exports=function(e,t){var r,n=" ",a=e.level,i=e.dataLevel,s=e.schema[t],o=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,l=!e.opts.allErrors,u="data"+(i||""),f="valid"+a,$=e.opts.v5&&s&&s.$data;if($?(n+=" var schema"+a+" = "+e.util.getData(s.$data,i,e.dataPathArr)+"; ",r="schema"+a):r=s,(s||$)&&!1!==e.opts.uniqueItems){$&&(n+=" var "+f+"; if ("+r+" === false || "+r+" === undefined) "+f+" = true; else if (typeof "+r+" != 'boolean') "+f+" = false; else { "),n+=" var "+f+" = true; if ("+u+".length > 1) { var i = "+u+".length, j; outer: for (;i--;) { for (j = i; j--;) { if (equal("+u+"[i], "+u+"[j])) { "+f+" = false; break outer; } } } } ",$&&(n+="  }  "),n+=" if (!"+f+") {   ";var p=p||[];p.push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'uniqueItems' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { i: i, j: j } ",!1!==e.opts.messages&&(n+=" , message: 'should NOT have duplicate items (items ## ' + j + ' and ' + i + ' are identical)' "),e.opts.verbose&&(n+=" , schema:  ",n+=$?"validate.schema"+o:""+s,n+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),n+=" } "):n+=" {} ";var d=n;n=p.pop(),!e.compositeRule&&l?e.async?n+=" throw new ValidationError(["+d+"]); ":n+=" validate.errors = ["+d+"]; return false; ":n+=" var err = "+d+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } ",l&&(n+=" else { ")}else l&&(n+=" if (true) { ");return n}},{}],38:[function(e,t,r){"use strict";t.exports=function(e,t){function r(t){return void 0!==e.schema[t.keyword]||"properties"==t.keyword&&(!1===e.schema.additionalProperties||"object"==typeof e.schema.additionalProperties||e.schema.patternProperties&&Object.keys(e.schema.patternProperties).length||e.opts.v5&&e.schema.patternGroups&&Object.keys(e.schema.patternGroups).length)}var n="",a=!0===e.schema.$async;if(e.isTop){var i=e.isTop,s=e.level=0,o=e.dataLevel=0,c="data";if(e.rootId=e.resolve.fullPath(e.root.schema.id),e.baseId=e.baseId||e.rootId,a){e.async=!0;var l="es7"==e.opts.async;e.yieldAwait=l?"await":"yield"}delete e.isTop,e.dataPathArr=[void 0],n+=" var validate = ",a?l?n+=" (async function ":("co*"==e.opts.async&&(n+="co.wrap"),n+="(function* "):n+=" (function ",n+=" (data, dataPath, parentData, parentDataProperty, rootData) { 'use strict'; var vErrors = null; ",n+=" var errors = 0;     ",n+=" if (rootData === undefined) rootData = data;"}else{var s=e.level,o=e.dataLevel,c="data"+(o||"");if(e.schema.id&&(e.baseId=e.resolve.url(e.baseId,e.schema.id)),a&&!e.async)throw new Error("async schema in sync schema");n+=" var errs_"+s+" = errors;"}var u="valid"+s,f=!e.opts.allErrors,$="",p="",d=e.schema.type,h=Array.isArray(d);if(d&&e.opts.coerceTypes){var _=e.util.coerceToTypes(e.opts.coerceTypes,d);if(_){var m=e.schemaPath+".type",y=e.errSchemaPath+"/type",g=h?"checkDataTypes":"checkDataType";n+=" if ("+e.util[g](d,c,!0)+") {  ";var v="dataType"+s,b="coerced"+s;n+=" var "+v+" = typeof "+c+"; ","array"==e.opts.coerceTypes&&(n+=" if ("+v+" == 'object' && Array.isArray("+c+")) "+v+" = 'array'; "),n+=" var "+b+" = undefined; ";var x="",w=_;if(w)for(var A,k=-1,E=w.length-1;k<E;)A=w[k+=1],k&&(n+=" if ("+b+" === undefined) { ",x+="}"),"array"==e.opts.coerceTypes&&"array"!=A&&(n+=" if ("+v+" == 'array' && "+c+".length == 1) { "+b+" = "+c+" = "+c+"[0]; "+v+" = typeof "+c+";  } "),"string"==A?n+=" if ("+v+" == 'number' || "+v+" == 'boolean') "+b+" = '' + "+c+"; else if ("+c+" === null) "+b+" = ''; ":"number"==A||"integer"==A?(n+=" if ("+v+" == 'boolean' || "+c+" === null || ("+v+" == 'string' && "+c+" && "+c+" == +"+c+" ","integer"==A&&(n+=" && !("+c+" % 1)"),n+=")) "+b+" = +"+c+"; "):"boolean"==A?n+=" if ("+c+" === 'false' || "+c+" === 0 || "+c+" === null) "+b+" = false; else if ("+c+" === 'true' || "+c+" === 1) "+b+" = true; ":"null"==A?n+=" if ("+c+" === '' || "+c+" === 0 || "+c+" === false) "+b+" = null; ":"array"==e.opts.coerceTypes&&"array"==A&&(n+=" if ("+v+" == 'string' || "+v+" == 'number' || "+v+" == 'boolean' || "+c+" == null) "+b+" = ["+c+"]; ");n+=" "+x+" if ("+b+" === undefined) {   ";var S=S||[];S.push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'type' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(y)+" , params: { type: '",n+=h?""+d.join(","):""+d,n+="' } ",!1!==e.opts.messages&&(n+=" , message: 'should be ",n+=h?""+d.join(","):""+d,n+="' "),e.opts.verbose&&(n+=" , schema: validate.schema"+m+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+c+" "),n+=" } "):n+=" {} ";var N=n;n=S.pop(),!e.compositeRule&&f?e.async?n+=" throw new ValidationError(["+N+"]); ":n+=" validate.errors = ["+N+"]; return false; ":n+=" var err = "+N+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } else {  ";var C=o?"data"+(o-1||""):"parentData",I=o?e.dataPathArr[o]:"parentDataProperty";n+=" "+c+" = "+b+"; ",o||(n+="if ("+C+" !== undefined)"),n+=" "+C+"["+I+"] = "+b+"; } } "}}var O;if(e.schema.$ref&&(O=e.util.schemaHasRulesExcept(e.schema,e.RULES.all,"$ref"))){if("fail"==e.opts.extendRefs)throw new Error('$ref: validation keywords used in schema at path "'+e.errSchemaPath+'"');"ignore"==e.opts.extendRefs?(O=!1,console.log('$ref: keywords ignored in schema at path "'+e.errSchemaPath+'"')):!0!==e.opts.extendRefs&&console.log('$ref: all keywords used in schema at path "'+e.errSchemaPath+'". It will change in the next major version, see issue #260. Use option { extendRefs: true } to keep current behaviour')}if(e.schema.$ref&&!O)n+=" "+e.RULES.all.$ref.code(e,"$ref")+" ",f&&(n+=" } if (errors === ",n+=i?"0":"errs_"+s,n+=") { ",p+="}");else{var L=e.RULES;if(L)for(var P,M=-1,T=L.length-1;M<T;)if(P=L[M+=1],function(e){for(var t=0;t<e.rules.length;t++)if(r(e.rules[t]))return!0}(P)){if(P.type&&(n+=" if ("+e.util.checkDataType(P.type,c)+") { "),e.opts.useDefaults&&!e.compositeRule)if("object"==P.type&&e.schema.properties){var B=e.schema.properties,j=Object.keys(B),F=j;if(F)for(var R,D=-1,z=F.length-1;D<z;){R=F[D+=1];var q=B[R];if(void 0!==q.default){var U=c+e.util.getProperty(R);n+="  if ("+U+" === undefined) "+U+" = ","shared"==e.opts.useDefaults?n+=" "+e.useDefault(q.default)+" ":n+=" "+JSON.stringify(q.default)+" ",n+="; "}}}else if("array"==P.type&&Array.isArray(e.schema.items)){var H=e.schema.items;if(H)for(var q,k=-1,G=H.length-1;k<G;)if(q=H[k+=1],void 0!==q.default){var U=c+"["+k+"]";n+="  if ("+U+" === undefined) "+U+" = ","shared"==e.opts.useDefaults?n+=" "+e.useDefault(q.default)+" ":n+=" "+JSON.stringify(q.default)+" ",n+="; "}}var Y=P.rules;if(Y)for(var V,Q=-1,X=Y.length-1;Q<X;)V=Y[Q+=1],r(V)&&(n+=" "+V.code(e,V.keyword)+" ",f&&($+="}"));if(f&&(n+=" "+$+" ",$=""),P.type&&(n+=" } ",d&&d===P.type&&!_)){var W=!0;n+=" else { ";var m=e.schemaPath+".type",y=e.errSchemaPath+"/type",S=S||[];S.push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'type' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(y)+" , params: { type: '",n+=h?""+d.join(","):""+d,n+="' } ",!1!==e.opts.messages&&(n+=" , message: 'should be ",n+=h?""+d.join(","):""+d,n+="' "),e.opts.verbose&&(n+=" , schema: validate.schema"+m+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+c+" "),n+=" } "):n+=" {} ";var N=n;n=S.pop(),!e.compositeRule&&f?e.async?n+=" throw new ValidationError(["+N+"]); ":n+=" validate.errors = ["+N+"]; return false; ":n+=" var err = "+N+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } "}f&&(n+=" if (errors === ",n+=i?"0":"errs_"+s,n+=") { ",p+="}")}}if(d&&!W&&!_){var m=e.schemaPath+".type",y=e.errSchemaPath+"/type",g=h?"checkDataTypes":"checkDataType";n+=" if ("+e.util[g](d,c,!0)+") {   ";var S=S||[];S.push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'type' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(y)+" , params: { type: '",n+=h?""+d.join(","):""+d,n+="' } ",!1!==e.opts.messages&&(n+=" , message: 'should be ",n+=h?""+d.join(","):""+d,n+="' "),e.opts.verbose&&(n+=" , schema: validate.schema"+m+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+c+" "),n+=" } "):n+=" {} ";var N=n;n=S.pop(),!e.compositeRule&&f?e.async?n+=" throw new ValidationError(["+N+"]); ":n+=" validate.errors = ["+N+"]; return false; ":n+=" var err = "+N+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" }"}return f&&(n+=" "+p+" "),i?(a?(n+=" if (errors === 0) return true;           ",n+=" else throw new ValidationError(vErrors); "):(n+=" validate.errors = vErrors; ",n+=" return errors === 0;       "),n+=" }); return validate;"):n+=" var "+u+" = errors === errs_"+s+";",n=e.util.cleanUpCode(n),i&&f&&(n=e.util.cleanUpVarErrors(n,a)),n}},{}],39:[function(e,t,r){"use strict";function n(e,t){function r(e,t,r){for(var n,i=0;i<a.length;i++){var s=a[i];if(s.type==t){n=s;break}}n||(n={type:t,rules:[]},a.push(n));var c={keyword:e,definition:r,custom:!0,code:o};n.rules.push(c),a.custom[e]=c}function n(e){if(!a.types[e])throw new Error("Unknown type "+e)}var a=this.RULES
;if(a.keywords[e])throw new Error("Keyword "+e+" is already defined");if(!s.test(e))throw new Error("Keyword "+e+" is not a valid identifier");if(t){if(t.macro&&void 0!==t.valid)throw new Error('"valid" option cannot be used with macro keywords');var i=t.type;if(Array.isArray(i)){var c,l=i.length;for(c=0;c<l;c++)n(i[c]);for(c=0;c<l;c++)r(e,i[c],t)}else i&&n(i),r(e,i,t);var u=!0===t.$data&&this._opts.v5;if(u&&!t.validate)throw new Error('$data support: "validate" function is not defined');var f=t.metaSchema;f&&(u&&(f={anyOf:[f,{$ref:"https://raw.githubusercontent.com/epoberezkin/ajv/master/lib/refs/json-schema-v5.json#/definitions/$data"}]}),t.validateSchema=this.compile(f,!0))}a.keywords[e]=a.all[e]=!0}function a(e){var t=this.RULES.custom[e];return t?t.definition:this.RULES.keywords[e]||!1}function i(e){var t=this.RULES;delete t.keywords[e],delete t.all[e],delete t.custom[e];for(var r=0;r<t.length;r++)for(var n=t[r].rules,a=0;a<n.length;a++)if(n[a].keyword==e){n.splice(a,1);break}}var s=/^[a-z_$][a-z0-9_$\-]*$/i,o=e("./dotjs/custom");t.exports={add:n,get:a,remove:i}},{"./dotjs/custom":23}],40:[function(e,t,r){t.exports={id:"http://json-schema.org/draft-04/schema#",$schema:"http://json-schema.org/draft-04/schema#",description:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},positiveInteger:{type:"integer",minimum:0},positiveIntegerDefault0:{allOf:[{$ref:"#/definitions/positiveInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},minItems:1,uniqueItems:!0}},type:"object",properties:{id:{type:"string",format:"uri"},$schema:{type:"string",format:"uri"},title:{type:"string"},description:{type:"string"},default:{},multipleOf:{type:"number",minimum:0,exclusiveMinimum:!0},maximum:{type:"number"},exclusiveMaximum:{type:"boolean",default:!1},minimum:{type:"number"},exclusiveMinimum:{type:"boolean",default:!1},maxLength:{$ref:"#/definitions/positiveInteger"},minLength:{$ref:"#/definitions/positiveIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{anyOf:[{type:"boolean"},{$ref:"#"}],default:{}},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:{}},maxItems:{$ref:"#/definitions/positiveInteger"},minItems:{$ref:"#/definitions/positiveIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},maxProperties:{$ref:"#/definitions/positiveInteger"},minProperties:{$ref:"#/definitions/positiveIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{anyOf:[{type:"boolean"},{$ref:"#"}],default:{}},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},enum:{type:"array",minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},dependencies:{exclusiveMaximum:["maximum"],exclusiveMinimum:["minimum"]},default:{}}},{}],41:[function(e,t,r){t.exports={id:"https://raw.githubusercontent.com/epoberezkin/ajv/master/lib/refs/json-schema-v5.json#",$schema:"http://json-schema.org/draft-04/schema#",description:"Core schema meta-schema (v5 proposals)",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},positiveInteger:{type:"integer",minimum:0},positiveIntegerDefault0:{allOf:[{$ref:"#/definitions/positiveInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},minItems:1,uniqueItems:!0},$data:{type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1}},type:"object",properties:{id:{type:"string",format:"uri"},$schema:{type:"string",format:"uri"},title:{type:"string"},description:{type:"string"},default:{},multipleOf:{anyOf:[{type:"number",minimum:0,exclusiveMinimum:!0},{$ref:"#/definitions/$data"}]},maximum:{anyOf:[{type:"number"},{$ref:"#/definitions/$data"}]},exclusiveMaximum:{anyOf:[{type:"boolean",default:!1},{$ref:"#/definitions/$data"}]},minimum:{anyOf:[{type:"number"},{$ref:"#/definitions/$data"}]},exclusiveMinimum:{anyOf:[{type:"boolean",default:!1},{$ref:"#/definitions/$data"}]},maxLength:{anyOf:[{$ref:"#/definitions/positiveInteger"},{$ref:"#/definitions/$data"}]},minLength:{anyOf:[{$ref:"#/definitions/positiveIntegerDefault0"},{$ref:"#/definitions/$data"}]},pattern:{anyOf:[{type:"string",format:"regex"},{$ref:"#/definitions/$data"}]},additionalItems:{anyOf:[{type:"boolean"},{$ref:"#"},{$ref:"#/definitions/$data"}],default:{}},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:{}},maxItems:{anyOf:[{$ref:"#/definitions/positiveInteger"},{$ref:"#/definitions/$data"}]},minItems:{anyOf:[{$ref:"#/definitions/positiveIntegerDefault0"},{$ref:"#/definitions/$data"}]},uniqueItems:{anyOf:[{type:"boolean",default:!1},{$ref:"#/definitions/$data"}]},maxProperties:{anyOf:[{$ref:"#/definitions/positiveInteger"},{$ref:"#/definitions/$data"}]},minProperties:{anyOf:[{$ref:"#/definitions/positiveIntegerDefault0"},{$ref:"#/definitions/$data"}]},required:{anyOf:[{$ref:"#/definitions/stringArray"},{$ref:"#/definitions/$data"}]},additionalProperties:{anyOf:[{type:"boolean"},{$ref:"#"},{$ref:"#/definitions/$data"}],default:{}},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},enum:{anyOf:[{type:"array",minItems:1,uniqueItems:!0},{$ref:"#/definitions/$data"}]},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"},format:{anyOf:[{type:"string"},{$ref:"#/definitions/$data"}]},formatMaximum:{anyOf:[{type:"string"},{$ref:"#/definitions/$data"}]},formatMinimum:{anyOf:[{type:"string"},{$ref:"#/definitions/$data"}]},formatExclusiveMaximum:{anyOf:[{type:"boolean",default:!1},{$ref:"#/definitions/$data"}]},formatExclusiveMinimum:{anyOf:[{type:"boolean",default:!1},{$ref:"#/definitions/$data"}]},constant:{anyOf:[{},{$ref:"#/definitions/$data"}]},contains:{$ref:"#"},patternGroups:{type:"object",additionalProperties:{type:"object",required:["schema"],properties:{maximum:{anyOf:[{$ref:"#/definitions/positiveInteger"},{$ref:"#/definitions/$data"}]},minimum:{anyOf:[{$ref:"#/definitions/positiveIntegerDefault0"},{$ref:"#/definitions/$data"}]},schema:{$ref:"#"}},additionalProperties:!1},default:{}},switch:{type:"array",items:{required:["then"],properties:{if:{$ref:"#"},then:{anyOf:[{type:"boolean"},{$ref:"#"}]},continue:{type:"boolean"}},additionalProperties:!1,dependencies:{continue:["if"]}}}},dependencies:{exclusiveMaximum:["maximum"],exclusiveMinimum:["minimum"],formatMaximum:["format"],formatMinimum:["format"],formatExclusiveMaximum:["formatMaximum"],formatExclusiveMinimum:["formatMinimum"]},default:{}}},{}],42:[function(e,t,r){"use strict";function n(t){function r(e,r,a){var i={inline:a||n[e],statements:!0,errors:"full"};r&&(i.type=r),t.addKeyword(e,i)}var n={switch:e("./dotjs/switch"),constant:e("./dotjs/constant"),_formatLimit:e("./dotjs/_formatLimit"),patternRequired:e("./dotjs/patternRequired")};if(!1!==t._opts.meta){var s=e("./refs/json-schema-v5.json");t.addMetaSchema(s,i)}r("constant"),t.addKeyword("contains",{type:"array",macro:a}),r("formatMaximum","string",n._formatLimit),r("formatMinimum","string",n._formatLimit),t.addKeyword("formatExclusiveMaximum"),t.addKeyword("formatExclusiveMinimum"),t.addKeyword("patternGroups"),r("patternRequired","object"),r("switch")}function a(e){return{not:{items:{not:e}}}}var i="https://raw.githubusercontent.com/epoberezkin/ajv/master/lib/refs/json-schema-v5.json";t.exports={enable:n,META_SCHEMA_ID:i}},{"./dotjs/_formatLimit":15,"./dotjs/constant":22,"./dotjs/patternRequired":32,"./dotjs/switch":36,"./refs/json-schema-v5.json":41}],43:[function(e,t,r){"use strict";function n(e,t,r){e instanceof RegExp&&(e=a(e,r)),t instanceof RegExp&&(t=a(t,r));var n=i(e,t,r);return n&&{start:n[0],end:n[1],pre:r.slice(0,n[0]),body:r.slice(n[0]+e.length,n[1]),post:r.slice(n[1]+t.length)}}function a(e,t){var r=t.match(e);return r?r[0]:null}function i(e,t,r){var n,a,i,s,o,c=r.indexOf(e),l=r.indexOf(t,c+1),u=c;if(c>=0&&l>0){for(n=[],i=r.length;u>=0&&!o;)u==c?(n.push(u),c=r.indexOf(e,u+1)):1==n.length?o=[n.pop(),l]:(a=n.pop(),a<i&&(i=a,s=l),l=r.indexOf(t,u+1)),u=c<l&&c>=0?c:l;n.length&&(o=[i,s])}return o}t.exports=n,n.range=i},{}],44:[function(e,t,r){function n(e){return parseInt(e,10)==e?parseInt(e,10):e.charCodeAt(0)}function a(e){return e.split("\\\\").join(h).split("\\{").join(_).split("\\}").join(m).split("\\,").join(y).split("\\.").join(g)}function i(e){return e.split(h).join("\\").split(_).join("{").split(m).join("}").split(y).join(",").split(g).join(".")}function s(e){if(!e)return[""];var t=[],r=d("{","}",e);if(!r)return e.split(",");var n=r.pre,a=r.body,i=r.post,o=n.split(",");o[o.length-1]+="{"+a+"}";var c=s(i);return i.length&&(o[o.length-1]+=c.shift(),o.push.apply(o,c)),t.push.apply(t,o),t}function o(e){return e?("{}"===e.substr(0,2)&&(e="\\{\\}"+e.substr(2)),$(a(e),!0).map(i)):[]}function c(e){return"{"+e+"}"}function l(e){return/^-?0\d/.test(e)}function u(e,t){return e<=t}function f(e,t){return e>=t}function $(e,t){var r=[],a=d("{","}",e);if(!a||/\$$/.test(a.pre))return[e];var i=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(a.body),o=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(a.body),h=i||o,_=a.body.indexOf(",")>=0;if(!h&&!_)return a.post.match(/,.*\}/)?(e=a.pre+"{"+a.body+m+a.post,$(e)):[e];var y;if(h)y=a.body.split(/\.\./);else if(y=s(a.body),1===y.length&&(y=$(y[0],!1).map(c),1===y.length)){var g=a.post.length?$(a.post,!1):[""];return g.map(function(e){return a.pre+y[0]+e})}var v,b=a.pre,g=a.post.length?$(a.post,!1):[""];if(h){var x=n(y[0]),w=n(y[1]),A=Math.max(y[0].length,y[1].length),k=3==y.length?Math.abs(n(y[2])):1,E=u;w<x&&(k*=-1,E=f);var S=y.some(l);v=[];for(var N=x;E(N,w);N+=k){var C;if(o)"\\"===(C=String.fromCharCode(N))&&(C="");else if(C=String(N),S){var I=A-C.length;if(I>0){var O=new Array(I+1).join("0");C=N<0?"-"+O+C.slice(1):O+C}}v.push(C)}}else v=p(y,function(e){return $(e,!1)});for(var L=0;L<v.length;L++)for(var P=0;P<g.length;P++){var M=b+v[L]+g[P];(!t||h||M)&&r.push(M)}return r}var p=e("concat-map"),d=e("balanced-match");t.exports=o;var h="\0SLASH"+Math.random()+"\0",_="\0OPEN"+Math.random()+"\0",m="\0CLOSE"+Math.random()+"\0",y="\0COMMA"+Math.random()+"\0",g="\0PERIOD"+Math.random()+"\0"},{"balanced-match":43,"concat-map":46}],45:[function(e,t,r){function n(e){var t=this,r=$.call(arguments,1);return new Promise(function(n,i){function s(t){var r;try{r=e.next(t)}catch(e){return i(e)}l(r)}function o(t){var r;try{r=e.throw(t)}catch(e){return i(e)}l(r)}function l(e){if(e.done)return n(e.value);var r=a.call(t,e.value);return r&&c(r)?r.then(s,o):o(new TypeError('You may only yield a function, promise, generator, array, or object, but the following object was passed: "'+String(e.value)+'"'))}if("function"==typeof e&&(e=e.apply(t,r)),!e||"function"!=typeof e.next)return n(e);s()})}function a(e){return e?c(e)?e:u(e)||l(e)?n.call(this,e):"function"==typeof e?i.call(this,e):Array.isArray(e)?s.call(this,e):f(e)?o.call(this,e):e:e}function i(e){var t=this;return new Promise(function(r,n){e.call(t,function(e,t){if(e)return n(e);arguments.length>2&&(t=$.call(arguments,1)),r(t)})})}function s(e){return Promise.all(e.map(a,this))}function o(e){for(var t=new e.constructor,r=Object.keys(e),n=[],i=0;i<r.length;i++){var s=r[i],o=a.call(this,e[s]);o&&c(o)?function(e,r){t[r]=void 0,n.push(e.then(function(e){t[r]=e}))}(o,s):t[s]=e[s]}return Promise.all(n).then(function(){return t})}function c(e){return"function"==typeof e.then}function l(e){return"function"==typeof e.next&&"function"==typeof e.throw}function u(e){var t=e.constructor;return!!t&&("GeneratorFunction"===t.name||"GeneratorFunction"===t.displayName||l(t.prototype))}function f(e){return Object==e.constructor}var $=Array.prototype.slice;t.exports=n.default=n.co=n,n.wrap=function(e){function t(){return n.call(this,e.apply(this,arguments))}return t.__generatorFunction__=e,t}},{}],46:[function(e,t,r){t.exports=function(e,t){for(var r=[],a=0;a<e.length;a++){var i=t(e[a],a);n(i)?r.push.apply(r,i):r.push(i)}return r};var n=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},{}],47:[function(e,t,r){"use strict";function n(e,t,r,n){r=s(r||"UTF-8"),t=s(t||"UTF-8"),e=e||"";var o;if("UTF-8"!==r&&"string"==typeof e&&(e=new Buffer(e,"binary")),r===t)o="string"==typeof e?new Buffer(e):e;else if(c&&!n)try{o=a(e,t,r)}catch(n){console.error(n);try{o=i(e,t,r)}catch(t){console.error(t),o=e}}else try{o=i(e,t,r)}catch(t){console.error(t),o=e}return"string"==typeof o&&(o=new Buffer(o,"utf-8")),o}function a(e,t,r){var n,a;return a=new c(r,t+"//TRANSLIT//IGNORE"),n=a.convert(e),n.slice(0,n.length)}function i(e,t,r){return"UTF-8"===t?o.decode(e,r):"UTF-8"===r?o.encode(e,t):o.encode(o.decode(e,r),t)}function s(e){return(e||"").toString().trim().replace(/^latin[\-_]?(\d+)$/i,"ISO-8859-$1").replace(/^win(?:dows)?[\-_]?(\d+)$/i,"WINDOWS-$1").replace(/^utf[\-_]?(\d+)$/i,"UTF-$1").replace(/^ks_c_5601\-1987$/i,"CP949").replace(/^us[\-_]?ascii$/i,"ASCII").toUpperCase()}var o=e("iconv-lite"),c=e("./iconv-loader");t.exports.convert=n},{"./iconv-loader":48,"iconv-lite":73}],48:[function(e,t,r){"use strict";var n,a;try{n="iconv",a=e(n).Iconv}catch(e){}t.exports=a},{}],49:[function(e,t,r){function n(e){return e&&"realpath"===e.syscall&&("ELOOP"===e.code||"ENOMEM"===e.code||"ENAMETOOLONG"===e.code)}function a(e,t,r){if($)return l(e,t,r);"function"==typeof t&&(r=t,t=null),l(e,t,function(a,i){n(a)?p.realpath(e,t,r):r(a,i)})}function i(e,t){if($)return u(e,t);try{return u(e,t)}catch(r){if(n(r))return p.realpathSync(e,t);throw r}}function s(){c.realpath=a,c.realpathSync=i}function o(){c.realpath=l,c.realpathSync=u}t.exports=a,a.realpath=a,a.sync=i,a.realpathSync=i,a.monkeypatch=s,a.unmonkeypatch=o;var c=e("fs"),l=c.realpath,u=c.realpathSync,f=process.version,$=/^v[0-5]\./.test(f),p=e("./old.js")},{"./old.js":50,fs:void 0}],50:[function(e,t,r){function n(){function e(e){e&&(n.message=e.message,e=n,t(e))}function t(e){if(e){if(process.throwDeprecation)throw e;if(!process.noDeprecation){var t="fs: missing callback "+(e.stack||e.message);process.traceDeprecation?console.trace(t):console.error(t)}}}var r;if(c){var n=new Error;r=e}else r=t;return r}function a(e){return"function"==typeof e?e:n()}var i=e("path"),s="win32"===process.platform,o=e("fs"),c=process.env.NODE_DEBUG&&/fs/.test(process.env.NODE_DEBUG);i.normalize;if(s)var l=/(.*?)(?:[\/\\]+|$)/g;else var l=/(.*?)(?:[\/]+|$)/g;if(s)var u=/^(?:[a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/][^\\\/]+)?[\\\/]*/;else var u=/^[\/]*/;r.realpathSync=function(e,t){function r(){var t=u.exec(e);n=t[0].length,a=t[0],c=t[0],f="",s&&!d[c]&&(o.lstatSync(c),d[c]=!0)}if(e=i.resolve(e),t&&Object.prototype.hasOwnProperty.call(t,e))return t[e];var n,a,c,f,$=e,p={},d={};for(r();n<e.length;){l.lastIndex=n;var h=l.exec(e);if(f=a,a+=h[0],c=f+h[1],n=l.lastIndex,!(d[c]||t&&t[c]===c)){var _;if(t&&Object.prototype.hasOwnProperty.call(t,c))_=t[c];else{var m=o.lstatSync(c);if(!m.isSymbolicLink()){d[c]=!0,t&&(t[c]=c);continue}var y=null;if(!s){var g=m.dev.toString(32)+":"+m.ino.toString(32);p.hasOwnProperty(g)&&(y=p[g])}null===y&&(o.statSync(c),y=o.readlinkSync(c)),_=i.resolve(f,y),t&&(t[c]=_),s||(p[g]=y)}e=i.resolve(_,e.slice(n)),r()}}return t&&(t[$]=e),e},r.realpath=function(e,t,r){function n(){var t=u.exec(e);d=t[0].length,h=t[0],_=t[0],m="",s&&!v[_]?o.lstat(_,function(e){if(e)return r(e);v[_]=!0,c()}):process.nextTick(c)}function c(){if(d>=e.length)return t&&(t[y]=e),r(null,e);l.lastIndex=d;var n=l.exec(e);return m=h,h+=n[0],_=m+n[1],d=l.lastIndex,v[_]||t&&t[_]===_?process.nextTick(c):t&&Object.prototype.hasOwnProperty.call(t,_)?p(t[_]):o.lstat(_,f)}function f(e,n){if(e)return r(e);if(!n.isSymbolicLink())return v[_]=!0,t&&(t[_]=_),process.nextTick(c);if(!s){var a=n.dev.toString(32)+":"+n.ino.toString(32);if(g.hasOwnProperty(a))return $(null,g[a],_)}o.stat(_,function(e){if(e)return r(e);o.readlink(_,function(e,t){s||(g[a]=t),$(e,t)})})}function $(e,n,a){if(e)return r(e);var s=i.resolve(m,n);t&&(t[a]=s),p(s)}function p(t){e=i.resolve(t,e.slice(d)),n()}if("function"!=typeof r&&(r=a(t),t=null),e=i.resolve(e),t&&Object.prototype.hasOwnProperty.call(t,e))return process.nextTick(r.bind(null,null,t[e]));var d,h,_,m,y=e,g={},v={};n()}},{fs:void 0,path:void 0}],51:[function(e,t,r){function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function a(e,t){return e.toLowerCase().localeCompare(t.toLowerCase())}function i(e,t){return e.localeCompare(t)}function s(e,t){e.ignore=t.ignore||[],Array.isArray(e.ignore)||(e.ignore=[e.ignore]),e.ignore.length&&(e.ignore=e.ignore.map(o))}function o(e){var t=null;if("/**"===e.slice(-3)){var r=e.replace(/(\/\*\*)+$/,"");t=new m(r,{dot:!0})}return{matcher:new m(e,{dot:!0}),gmatcher:t}}function c(e,t,r){if(r||(r={}),r.matchBase&&-1===t.indexOf("/")){if(r.noglobstar)throw new Error("base matching requires globstar");t="**/"+t}e.silent=!!r.silent,e.pattern=t,e.strict=!1!==r.strict,e.realpath=!!r.realpath,e.realpathCache=r.realpathCache||Object.create(null),e.follow=!!r.follow,e.dot=!!r.dot,e.mark=!!r.mark,e.nodir=!!r.nodir,e.nodir&&(e.mark=!0),e.sync=!!r.sync,e.nounique=!!r.nounique,e.nonull=!!r.nonull,e.nosort=!!r.nosort,e.nocase=!!r.nocase,e.stat=!!r.stat,e.noprocess=!!r.noprocess,e.absolute=!!r.absolute,e.maxLength=r.maxLength||1/0,e.cache=r.cache||Object.create(null),e.statCache=r.statCache||Object.create(null),e.symlinks=r.symlinks||Object.create(null),s(e,r),e.changedCwd=!1;var a=process.cwd();n(r,"cwd")?(e.cwd=d.resolve(r.cwd),e.changedCwd=e.cwd!==a):e.cwd=a,e.root=r.root||d.resolve(e.cwd,"/"),e.root=d.resolve(e.root),"win32"===process.platform&&(e.root=e.root.replace(/\\/g,"/")),e.cwdAbs=_(e.cwd)?e.cwd:f(e,e.cwd),"win32"===process.platform&&(e.cwdAbs=e.cwdAbs.replace(/\\/g,"/")),e.nomount=!!r.nomount,r.nonegate=!0,r.nocomment=!0,e.minimatch=new m(t,r),e.options=e.minimatch.options}function l(e){for(var t=e.nounique,r=t?[]:Object.create(null),n=0,s=e.matches.length;n<s;n++){var o=e.matches[n];if(o&&0!==Object.keys(o).length){var c=Object.keys(o);t?r.push.apply(r,c):c.forEach(function(e){r[e]=!0})}else if(e.nonull){var l=e.minimatch.globSet[n];t?r.push(l):r[l]=!0}}if(t||(r=Object.keys(r)),e.nosort||(r=r.sort(e.nocase?a:i)),e.mark){for(var n=0;n<r.length;n++)r[n]=e._mark(r[n]);e.nodir&&(r=r.filter(function(t){var r=!/\/$/.test(t),n=e.cache[t]||e.cache[f(e,t)];return r&&n&&(r="DIR"!==n&&!Array.isArray(n)),r}))}e.ignore.length&&(r=r.filter(function(t){return!$(e,t)})),e.found=r}function u(e,t){var r=f(e,t),n=e.cache[r],a=t;if(n){var i="DIR"===n||Array.isArray(n),s="/"===t.slice(-1);if(i&&!s?a+="/":!i&&s&&(a=a.slice(0,-1)),a!==t){var o=f(e,a);e.statCache[o]=e.statCache[r],e.cache[o]=e.cache[r]}}return a}function f(e,t){var r=t;return r="/"===t.charAt(0)?d.join(e.root,t):_(t)||""===t?t:e.changedCwd?d.resolve(e.cwd,t):d.resolve(t),"win32"===process.platform&&(r=r.replace(/\\/g,"/")),r}function $(e,t){return!!e.ignore.length&&e.ignore.some(function(e){return e.matcher.match(t)||!(!e.gmatcher||!e.gmatcher.match(t))})}function p(e,t){return!!e.ignore.length&&e.ignore.some(function(e){return!(!e.gmatcher||!e.gmatcher.match(t))})}r.alphasort=i,r.alphasorti=a,r.setopts=c,r.ownProp=n,r.makeAbs=f,r.finish=l,r.mark=u,r.isIgnored=$,r.childrenIgnored=p;var d=e("path"),h=e("minimatch"),_=e("path-is-absolute"),m=h.Minimatch},{minimatch:82,path:void 0,"path-is-absolute":84}],52:[function(e,t,r){function n(e,t,r){if("function"==typeof t&&(r=t,t={}),t||(t={}),t.sync){if(r)throw new TypeError("callback provided to sync glob");return h(e,t)}return new i(e,t,r)}function a(e,t){if(null===t||"object"!=typeof t)return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e}function i(e,t,r){function n(){--s._processing<=0&&(o?process.nextTick(function(){s._finish()}):s._finish())}if("function"==typeof t&&(r=t,t=null),t&&t.sync){if(r)throw new TypeError("callback provided to sync glob");return new w(e,t)}if(!(this instanceof i))return new i(e,t,r);m(this,e,t),this._didRealPath=!1;var a=this.minimatch.set.length;this.matches=new Array(a),"function"==typeof r&&(r=x(r),this.on("error",r),this.on("end",function(e){r(null,e)}));var s=this;if(this._processing=0,this._emitQueue=[],this._processQueue=[],this.paused=!1,this.noprocess)return this;if(0===a)return n();for(var o=!0,c=0;c<a;c++)this._process(this.minimatch.set[c],c,!1,n);o=!1}function s(e,t,r){return function(n,a){n?e._readdirError(t,n,r):e._readdirEntries(t,a,r)}}t.exports=n;var o=e("fs"),c=e("fs.realpath"),l=e("minimatch"),u=(l.Minimatch,e("inherits")),f=e("events").EventEmitter,$=e("path"),p=e("assert"),d=e("path-is-absolute"),h=e("./sync.js"),_=e("./common.js"),m=(_.alphasort,_.alphasorti,_.setopts),y=_.ownProp,g=e("inflight"),v=(e("util"),_.childrenIgnored),b=_.isIgnored,x=e("once");n.sync=h;var w=n.GlobSync=h.GlobSync;n.glob=n,n.hasMagic=function(e,t){var r=a({},t);r.noprocess=!0;var n=new i(e,r),s=n.minimatch.set;if(!e)return!1;if(s.length>1)return!0;for(var o=0;o<s[0].length;o++)if("string"!=typeof s[0][o])return!0;return!1},n.Glob=i,u(i,f),i.prototype._finish=function(){if(p(this instanceof i),!this.aborted){if(this.realpath&&!this._didRealpath)return this._realpath();_.finish(this),this.emit("end",this.found)}},i.prototype._realpath=function(){function e(){0==--t&&r._finish()}if(!this._didRealpath){this._didRealpath=!0;var t=this.matches.length;if(0===t)return this._finish();for(var r=this,n=0;n<this.matches.length;n++)this._realpathSet(n,e)}},i.prototype._realpathSet=function(e,t){var r=this.matches[e];if(!r)return t();var n=Object.keys(r),a=this,i=n.length;if(0===i)return t();var s=this.matches[e]=Object.create(null);n.forEach(function(r,n){r=a._makeAbs(r),c.realpath(r,a.realpathCache,function(n,o){n?"stat"===n.syscall?s[r]=!0:a.emit("error",n):s[o]=!0,0==--i&&(a.matches[e]=s,t())})})},i.prototype._mark=function(e){return _.mark(this,e)},i.prototype._makeAbs=function(e){return _.makeAbs(this,e)},i.prototype.abort=function(){this.aborted=!0,this.emit("abort")},i.prototype.pause=function(){this.paused||(this.paused=!0,this.emit("pause"))},i.prototype.resume=function(){if(this.paused){if(this.emit("resume"),this.paused=!1,this._emitQueue.length){var e=this._emitQueue.slice(0);this._emitQueue.length=0;for(var t=0;t<e.length;t++){var r=e[t];this._emitMatch(r[0],r[1])}}if(this._processQueue.length){var n=this._processQueue.slice(0);this._processQueue.length=0;for(var t=0;t<n.length;t++){var a=n[t];this._processing--,this._process(a[0],a[1],a[2],a[3])}}}},i.prototype._process=function(e,t,r,n){if(p(this instanceof i),p("function"==typeof n),!this.aborted){if(this._processing++,this.paused)return void this._processQueue.push([e,t,r,n]);for(var a=0;"string"==typeof e[a];)a++;var s;switch(a){case e.length:return void this._processSimple(e.join("/"),t,n);case 0:s=null;break;default:s=e.slice(0,a).join("/")}var o,c=e.slice(a);null===s?o=".":d(s)||d(e.join("/"))?(s&&d(s)||(s="/"+s),o=s):o=s;var u=this._makeAbs(o);if(v(this,o))return n();c[0]===l.GLOBSTAR?this._processGlobStar(s,o,u,c,t,r,n):this._processReaddir(s,o,u,c,t,r,n)}},i.prototype._processReaddir=function(e,t,r,n,a,i,s){var o=this;this._readdir(r,i,function(c,l){return o._processReaddir2(e,t,r,n,a,i,l,s)})},i.prototype._processReaddir2=function(e,t,r,n,a,i,s,o){if(!s)return o();for(var c=n[0],l=!!this.minimatch.negate,u=c._glob,f=this.dot||"."===u.charAt(0),p=[],d=0;d<s.length;d++){var h=s[d];if("."!==h.charAt(0)||f){var _;_=l&&!e?!h.match(c):h.match(c),_&&p.push(h)}}var m=p.length;if(0===m)return o();if(1===n.length&&!this.mark&&!this.stat){this.matches[a]||(this.matches[a]=Object.create(null));for(var d=0;d<m;d++){var h=p[d];e&&(h="/"!==e?e+"/"+h:e+h),"/"!==h.charAt(0)||this.nomount||(h=$.join(this.root,h)),this._emitMatch(a,h)}return o()}n.shift();for(var d=0;d<m;d++){var h=p[d];e&&(h="/"!==e?e+"/"+h:e+h),this._process([h].concat(n),a,i,o)}o()},i.prototype._emitMatch=function(e,t){if(!this.aborted&&!b(this,t)){if(this.paused)return void this._emitQueue.push([e,t]);var r=d(t)?t:this._makeAbs(t);if(this.mark&&(t=this._mark(t)),this.absolute&&(t=r),!this.matches[e][t]){if(this.nodir){var n=this.cache[r];if("DIR"===n||Array.isArray(n))return}this.matches[e][t]=!0;var a=this.statCache[r];a&&this.emit("stat",t,a),this.emit("match",t)}}},i.prototype._readdirInGlobStar=function(e,t){function r(r,n){if(r&&"ENOENT"===r.code)return t();var i=n&&n.isSymbolicLink();a.symlinks[e]=i,i||!n||n.isDirectory()?a._readdir(e,!1,t):(a.cache[e]="FILE",t())}if(!this.aborted){if(this.follow)return this._readdir(e,!1,t);var n="lstat\0"+e,a=this,i=g(n,r);i&&o.lstat(e,i)}},i.prototype._readdir=function(e,t,r){if(!this.aborted&&(r=g("readdir\0"+e+"\0"+t,r))){if(t&&!y(this.symlinks,e))return this._readdirInGlobStar(e,r);if(y(this.cache,e)){var n=this.cache[e];if(!n||"FILE"===n)return r();if(Array.isArray(n))return r(null,n)}o.readdir(e,s(this,e,r))}},i.prototype._readdirEntries=function(e,t,r){if(!this.aborted){if(!this.mark&&!this.stat)for(var n=0;n<t.length;n++){var a=t[n];a="/"===e?e+a:e+"/"+a,this.cache[a]=!0}return this.cache[e]=t,r(null,t)}},i.prototype._readdirError=function(e,t,r){if(!this.aborted){switch(t.code){case"ENOTSUP":case"ENOTDIR":var n=this._makeAbs(e);if(this.cache[n]="FILE",n===this.cwdAbs){var a=new Error(t.code+" invalid cwd "+this.cwd);a.path=this.cwd,a.code=t.code,this.emit("error",a),this.abort()}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(e)]=!1;break;default:this.cache[this._makeAbs(e)]=!1,this.strict&&(this.emit("error",t),this.abort()),this.silent||console.error("glob error",t)}return r()}},i.prototype._processGlobStar=function(e,t,r,n,a,i,s){var o=this;this._readdir(r,i,function(c,l){o._processGlobStar2(e,t,r,n,a,i,l,s)})},i.prototype._processGlobStar2=function(e,t,r,n,a,i,s,o){if(!s)return o();var c=n.slice(1),l=e?[e]:[],u=l.concat(c);this._process(u,a,!1,o);var f=this.symlinks[r],$=s.length;if(f&&i)return o();for(var p=0;p<$;p++){if("."!==s[p].charAt(0)||this.dot){var d=l.concat(s[p],c);this._process(d,a,!0,o);var h=l.concat(s[p],n);this._process(h,a,!0,o)}}o()},i.prototype._processSimple=function(e,t,r){var n=this;this._stat(e,function(a,i){n._processSimple2(e,t,a,i,r)})},i.prototype._processSimple2=function(e,t,r,n,a){if(this.matches[t]||(this.matches[t]=Object.create(null)),!n)return a();if(e&&d(e)&&!this.nomount){var i=/[\/\\]$/.test(e);"/"===e.charAt(0)?e=$.join(this.root,e):(e=$.resolve(this.root,e),i&&(e+="/"))}"win32"===process.platform&&(e=e.replace(/\\/g,"/")),this._emitMatch(t,e),a()},i.prototype._stat=function(e,t){function r(r,a){if(a&&a.isSymbolicLink())return o.stat(n,function(r,i){r?l._stat2(e,n,null,a,t):l._stat2(e,n,r,i,t)});l._stat2(e,n,r,a,t)}var n=this._makeAbs(e),a="/"===e.slice(-1);if(e.length>this.maxLength)return t();if(!this.stat&&y(this.cache,n)){var i=this.cache[n];if(Array.isArray(i)&&(i="DIR"),!a||"DIR"===i)return t(null,i);if(a&&"FILE"===i)return t()}var s=this.statCache[n];if(void 0!==s){if(!1===s)return t(null,s);var c=s.isDirectory()?"DIR":"FILE";return a&&"FILE"===c?t():t(null,c,s)}var l=this,u=g("stat\0"+n,r);u&&o.lstat(n,u)},i.prototype._stat2=function(e,t,r,n,a){if(r&&("ENOENT"===r.code||"ENOTDIR"===r.code))return this.statCache[t]=!1,a();var i="/"===e.slice(-1);if(this.statCache[t]=n,"/"===t.slice(-1)&&n&&!n.isDirectory())return a(null,!1,n);var s=!0;return n&&(s=n.isDirectory()?"DIR":"FILE"),this.cache[t]=this.cache[t]||s,i&&"FILE"===s?a():a(null,s,n)}},{"./common.js":51,"./sync.js":53,assert:void 0,events:void 0,fs:void 0,"fs.realpath":49,inflight:75,inherits:76,minimatch:82,once:83,path:void 0,"path-is-absolute":84,util:void 0}],53:[function(e,t,r){function n(e,t){if("function"==typeof t||3===arguments.length)throw new TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");return new a(e,t).found}function a(e,t){if(!e)throw new Error("must provide pattern");if("function"==typeof t||3===arguments.length)throw new TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");if(!(this instanceof a))return new a(e,t);if($(this,e,t),this.noprocess)return this;var r=this.minimatch.set.length;this.matches=new Array(r);for(var n=0;n<r;n++)this._process(this.minimatch.set[n],n,!1);this._finish()}t.exports=n,n.GlobSync=a;var i=e("fs"),s=e("fs.realpath"),o=e("minimatch"),c=(o.Minimatch,e("./glob.js").Glob,e("util"),e("path")),l=e("assert"),u=e("path-is-absolute"),f=e("./common.js"),$=(f.alphasort,f.alphasorti,f.setopts),p=f.ownProp,d=f.childrenIgnored,h=f.isIgnored;a.prototype._finish=function(){if(l(this instanceof a),this.realpath){var e=this;this.matches.forEach(function(t,r){var n=e.matches[r]=Object.create(null);for(var a in t)try{a=e._makeAbs(a);var i=s.realpathSync(a,e.realpathCache);n[i]=!0}catch(t){if("stat"!==t.syscall)throw t;n[e._makeAbs(a)]=!0}})}f.finish(this)},a.prototype._process=function(e,t,r){l(this instanceof a);for(var n=0;"string"==typeof e[n];)n++;var i;switch(n){case e.length:return void this._processSimple(e.join("/"),t);case 0:i=null;break;default:i=e.slice(0,n).join("/")}var s,c=e.slice(n);null===i?s=".":u(i)||u(e.join("/"))?(i&&u(i)||(i="/"+i),s=i):s=i;var f=this._makeAbs(s);if(!d(this,s)){c[0]===o.GLOBSTAR?this._processGlobStar(i,s,f,c,t,r):this._processReaddir(i,s,f,c,t,r)}},a.prototype._processReaddir=function(e,t,r,n,a,i){var s=this._readdir(r,i);if(s){for(var o=n[0],l=!!this.minimatch.negate,u=o._glob,f=this.dot||"."===u.charAt(0),$=[],p=0;p<s.length;p++){var d=s[p];if("."!==d.charAt(0)||f){var h;h=l&&!e?!d.match(o):d.match(o),h&&$.push(d)}}var _=$.length;if(0!==_)if(1!==n.length||this.mark||this.stat){n.shift();for(var p=0;p<_;p++){var m,d=$[p];m=e?[e,d]:[d],this._process(m.concat(n),a,i)}}else{this.matches[a]||(this.matches[a]=Object.create(null));for(var p=0;p<_;p++){var d=$[p];e&&(d="/"!==e.slice(-1)?e+"/"+d:e+d),"/"!==d.charAt(0)||this.nomount||(d=c.join(this.root,d)),this._emitMatch(a,d)}}}},a.prototype._emitMatch=function(e,t){if(!h(this,t)){var r=this._makeAbs(t);if(this.mark&&(t=this._mark(t)),this.absolute&&(t=r),!this.matches[e][t]){if(this.nodir){var n=this.cache[r];if("DIR"===n||Array.isArray(n))return}this.matches[e][t]=!0,this.stat&&this._stat(t)}}},a.prototype._readdirInGlobStar=function(e){if(this.follow)return this._readdir(e,!1);var t,r;try{r=i.lstatSync(e)}catch(e){if("ENOENT"===e.code)return null}var n=r&&r.isSymbolicLink();return this.symlinks[e]=n,n||!r||r.isDirectory()?t=this._readdir(e,!1):this.cache[e]="FILE",t},a.prototype._readdir=function(e,t){if(t&&!p(this.symlinks,e))return this._readdirInGlobStar(e);if(p(this.cache,e)){var r=this.cache[e];if(!r||"FILE"===r)return null;if(Array.isArray(r))return r}try{return this._readdirEntries(e,i.readdirSync(e))}catch(t){return this._readdirError(e,t),null}},a.prototype._readdirEntries=function(e,t){if(!this.mark&&!this.stat)for(var r=0;r<t.length;r++){var n=t[r];n="/"===e?e+n:e+"/"+n,this.cache[n]=!0}return this.cache[e]=t,t},a.prototype._readdirError=function(e,t){switch(t.code){case"ENOTSUP":case"ENOTDIR":var r=this._makeAbs(e);if(this.cache[r]="FILE",
r===this.cwdAbs){var n=new Error(t.code+" invalid cwd "+this.cwd);throw n.path=this.cwd,n.code=t.code,n}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(e)]=!1;break;default:if(this.cache[this._makeAbs(e)]=!1,this.strict)throw t;this.silent||console.error("glob error",t)}},a.prototype._processGlobStar=function(e,t,r,n,a,i){var s=this._readdir(r,i);if(s){var o=n.slice(1),c=e?[e]:[],l=c.concat(o);this._process(l,a,!1);var u=s.length;if(!this.symlinks[r]||!i)for(var f=0;f<u;f++){var $=s[f];if("."!==$.charAt(0)||this.dot){var p=c.concat(s[f],o);this._process(p,a,!0);var d=c.concat(s[f],n);this._process(d,a,!0)}}}},a.prototype._processSimple=function(e,t){var r=this._stat(e);if(this.matches[t]||(this.matches[t]=Object.create(null)),r){if(e&&u(e)&&!this.nomount){var n=/[\/\\]$/.test(e);"/"===e.charAt(0)?e=c.join(this.root,e):(e=c.resolve(this.root,e),n&&(e+="/"))}"win32"===process.platform&&(e=e.replace(/\\/g,"/")),this._emitMatch(t,e)}},a.prototype._stat=function(e){var t=this._makeAbs(e),r="/"===e.slice(-1);if(e.length>this.maxLength)return!1;if(!this.stat&&p(this.cache,t)){var n=this.cache[t];if(Array.isArray(n)&&(n="DIR"),!r||"DIR"===n)return n;if(r&&"FILE"===n)return!1}var a=this.statCache[t];if(!a){var s;try{s=i.lstatSync(t)}catch(e){if(e&&("ENOENT"===e.code||"ENOTDIR"===e.code))return this.statCache[t]=!1,!1}if(s&&s.isSymbolicLink())try{a=i.statSync(t)}catch(e){a=s}else a=s}this.statCache[t]=a;var n=!0;return a&&(n=a.isDirectory()?"DIR":"FILE"),this.cache[t]=this.cache[t]||n,(!r||"FILE"!==n)&&n},a.prototype._mark=function(e){return f.mark(this,e)},a.prototype._makeAbs=function(e){return f.makeAbs(this,e)}},{"./common.js":51,"./glob.js":52,assert:void 0,fs:void 0,"fs.realpath":49,minimatch:82,path:void 0,"path-is-absolute":84,util:void 0}],54:[function(e,t,r){"use strict";function n(e,t){if(this.encodingName=e.encodingName,!e)throw new Error("DBCS codec is called without the data.");if(!e.table)throw new Error("Encoding '"+this.encodingName+"' has no data.");var r=e.table();this.decodeTables=[],this.decodeTables[0]=f.slice(0),this.decodeTableSeq=[];for(var n=0;n<r.length;n++)this._addDecodeChunk(r[n]);this.defaultCharUnicode=t.defaultCharUnicode,this.encodeTable=[],this.encodeTableSeq=[];var a={};if(e.encodeSkipVals)for(var n=0;n<e.encodeSkipVals.length;n++){var i=e.encodeSkipVals[n];if("number"==typeof i)a[i]=!0;else for(var s=i.from;s<=i.to;s++)a[s]=!0}if(this._fillEncodeTable(0,0,a),e.encodeAdd)for(var o in e.encodeAdd)Object.prototype.hasOwnProperty.call(e.encodeAdd,o)&&this._setEncodeChar(o.charCodeAt(0),e.encodeAdd[o]);if(this.defCharSB=this.encodeTable[0][t.defaultCharSingleByte.charCodeAt(0)],this.defCharSB===c&&(this.defCharSB=this.encodeTable[0]["?"]),this.defCharSB===c&&(this.defCharSB="?".charCodeAt(0)),"function"==typeof e.gb18030){this.gb18030=e.gb18030();for(var $=this.decodeTables.length,p=this.decodeTables[$]=f.slice(0),d=this.decodeTables.length,h=this.decodeTables[d]=f.slice(0),n=129;n<=254;n++)for(var _=u-this.decodeTables[0][n],m=this.decodeTables[_],s=48;s<=57;s++)m[s]=u-$;for(var n=129;n<=254;n++)p[n]=u-d;for(var n=48;n<=57;n++)h[n]=l}}function a(e,t){this.leadSurrogate=-1,this.seqObj=void 0,this.encodeTable=t.encodeTable,this.encodeTableSeq=t.encodeTableSeq,this.defaultCharSingleByte=t.defCharSB,this.gb18030=t.gb18030}function i(e,t){this.nodeIdx=0,this.prevBuf=new o(0),this.decodeTables=t.decodeTables,this.decodeTableSeq=t.decodeTableSeq,this.defaultCharUnicode=t.defaultCharUnicode,this.gb18030=t.gb18030}function s(e,t){if(e[0]>t)return-1;for(var r=0,n=e.length;r<n-1;){var a=r+Math.floor((n-r+1)/2);e[a]<=t?r=a:n=a}return r}var o=e("buffer").Buffer;r._dbcs=n;for(var c=-1,l=-2,u=-1e3,f=new Array(256),$=0;$<256;$++)f[$]=c;n.prototype.encoder=a,n.prototype.decoder=i,n.prototype._getDecodeTrieNode=function(e){for(var t=[];e>0;e>>=8)t.push(255&e);0==t.length&&t.push(0);for(var r=this.decodeTables[0],n=t.length-1;n>0;n--){var a=r[t[n]];if(a==c)r[t[n]]=u-this.decodeTables.length,this.decodeTables.push(r=f.slice(0));else{if(!(a<=u))throw new Error("Overwrite byte in "+this.encodingName+", addr: "+e.toString(16));r=this.decodeTables[u-a]}}return r},n.prototype._addDecodeChunk=function(e){var t=parseInt(e[0],16),r=this._getDecodeTrieNode(t);t&=255;for(var n=1;n<e.length;n++){var a=e[n];if("string"==typeof a)for(var i=0;i<a.length;){var s=a.charCodeAt(i++);if(55296<=s&&s<56320){var o=a.charCodeAt(i++);if(!(56320<=o&&o<57344))throw new Error("Incorrect surrogate pair in "+this.encodingName+" at chunk "+e[0]);r[t++]=65536+1024*(s-55296)+(o-56320)}else if(4080<s&&s<=4095){for(var c=4095-s+2,l=[],u=0;u<c;u++)l.push(a.charCodeAt(i++));r[t++]=-10-this.decodeTableSeq.length,this.decodeTableSeq.push(l)}else r[t++]=s}else{if("number"!=typeof a)throw new Error("Incorrect type '"+typeof a+"' given in "+this.encodingName+" at chunk "+e[0]);for(var f=r[t-1]+1,i=0;i<a;i++)r[t++]=f++}}if(t>255)throw new Error("Incorrect chunk in "+this.encodingName+" at addr "+e[0]+": too long"+t)},n.prototype._getEncodeBucket=function(e){var t=e>>8;return void 0===this.encodeTable[t]&&(this.encodeTable[t]=f.slice(0)),this.encodeTable[t]},n.prototype._setEncodeChar=function(e,t){var r=this._getEncodeBucket(e),n=255&e;r[n]<=-10?this.encodeTableSeq[-10-r[n]][-1]=t:r[n]==c&&(r[n]=t)},n.prototype._setEncodeSequence=function(e,t){var r,n=e[0],a=this._getEncodeBucket(n),i=255&n;a[i]<=-10?r=this.encodeTableSeq[-10-a[i]]:(r={},a[i]!==c&&(r[-1]=a[i]),a[i]=-10-this.encodeTableSeq.length,this.encodeTableSeq.push(r));for(var s=1;s<e.length-1;s++){var o=r[n];"object"==typeof o?r=o:(r=r[n]={},void 0!==o&&(r[-1]=o))}n=e[e.length-1],r[n]=t},n.prototype._fillEncodeTable=function(e,t,r){for(var n=this.decodeTables[e],a=0;a<256;a++){var i=n[a],s=t+a;r[s]||(i>=0?this._setEncodeChar(i,s):i<=u?this._fillEncodeTable(u-i,s<<8,r):i<=-10&&this._setEncodeSequence(this.decodeTableSeq[-10-i],s))}},a.prototype.write=function(e){for(var t=new o(e.length*(this.gb18030?4:3)),r=this.leadSurrogate,n=this.seqObj,a=-1,i=0,l=0;;){if(-1===a){if(i==e.length)break;var u=e.charCodeAt(i++)}else{var u=a;a=-1}if(55296<=u&&u<57344)if(u<56320){if(-1===r){r=u;continue}r=u,u=c}else-1!==r?(u=65536+1024*(r-55296)+(u-56320),r=-1):u=c;else-1!==r&&(a=u,u=c,r=-1);var f=c;if(void 0!==n&&u!=c){var $=n[u];if("object"==typeof $){n=$;continue}"number"==typeof $?f=$:void 0==$&&void 0!==($=n[-1])&&(f=$,a=u),n=void 0}else if(u>=0){var p=this.encodeTable[u>>8];if(void 0!==p&&(f=p[255&u]),f<=-10){n=this.encodeTableSeq[-10-f];continue}if(f==c&&this.gb18030){var d=s(this.gb18030.uChars,u);if(-1!=d){var f=this.gb18030.gbChars[d]+(u-this.gb18030.uChars[d]);t[l++]=129+Math.floor(f/12600),f%=12600,t[l++]=48+Math.floor(f/1260),f%=1260,t[l++]=129+Math.floor(f/10),f%=10,t[l++]=48+f;continue}}}f===c&&(f=this.defaultCharSingleByte),f<256?t[l++]=f:f<65536?(t[l++]=f>>8,t[l++]=255&f):(t[l++]=f>>16,t[l++]=f>>8&255,t[l++]=255&f)}return this.seqObj=n,this.leadSurrogate=r,t.slice(0,l)},a.prototype.end=function(){if(-1!==this.leadSurrogate||void 0!==this.seqObj){var e=new o(10),t=0;if(this.seqObj){var r=this.seqObj[-1];void 0!==r&&(r<256?e[t++]=r:(e[t++]=r>>8,e[t++]=255&r)),this.seqObj=void 0}return-1!==this.leadSurrogate&&(e[t++]=this.defaultCharSingleByte,this.leadSurrogate=-1),e.slice(0,t)}},a.prototype.findIdx=s,i.prototype.write=function(e){var t,r=new o(2*e.length),n=this.nodeIdx,a=this.prevBuf,i=this.prevBuf.length,f=-this.prevBuf.length;i>0&&(a=o.concat([a,e.slice(0,10)]));for(var $=0,p=0;$<e.length;$++){var d=$>=0?e[$]:a[$+i],t=this.decodeTables[n][d];if(t>=0);else if(t===c)$=f,t=this.defaultCharUnicode.charCodeAt(0);else if(t===l){var h=f>=0?e.slice(f,$+1):a.slice(f+i,$+1+i),_=12600*(h[0]-129)+1260*(h[1]-48)+10*(h[2]-129)+(h[3]-48),m=s(this.gb18030.gbChars,_);t=this.gb18030.uChars[m]+_-this.gb18030.gbChars[m]}else{if(t<=u){n=u-t;continue}if(!(t<=-10))throw new Error("iconv-lite internal error: invalid decoding table value "+t+" at "+n+"/"+d);for(var y=this.decodeTableSeq[-10-t],g=0;g<y.length-1;g++)t=y[g],r[p++]=255&t,r[p++]=t>>8;t=y[y.length-1]}if(t>65535){t-=65536;var v=55296+Math.floor(t/1024);r[p++]=255&v,r[p++]=v>>8,t=56320+t%1024}r[p++]=255&t,r[p++]=t>>8,n=0,f=$+1}return this.nodeIdx=n,this.prevBuf=f>=0?e.slice(f):a.slice(f+i),r.slice(0,p).toString("ucs2")},i.prototype.end=function(){for(var e="";this.prevBuf.length>0;){e+=this.defaultCharUnicode;var t=this.prevBuf.slice(1);this.prevBuf=new o(0),this.nodeIdx=0,t.length>0&&(e+=this.write(t))}return this.nodeIdx=0,e}},{buffer:void 0}],55:[function(e,t,r){"use strict";t.exports={shiftjis:{type:"_dbcs",table:function(){return e("./tables/shiftjis.json")},encodeAdd:{"":92,"":126},encodeSkipVals:[{from:60736,to:63808}]},csshiftjis:"shiftjis",mskanji:"shiftjis",sjis:"shiftjis",windows31j:"shiftjis",ms31j:"shiftjis",xsjis:"shiftjis",windows932:"shiftjis",ms932:"shiftjis",932:"shiftjis",cp932:"shiftjis",eucjp:{type:"_dbcs",table:function(){return e("./tables/eucjp.json")},encodeAdd:{"":92,"":126}},gb2312:"cp936",gb231280:"cp936",gb23121980:"cp936",csgb2312:"cp936",csiso58gb231280:"cp936",euccn:"cp936",windows936:"cp936",ms936:"cp936",936:"cp936",cp936:{type:"_dbcs",table:function(){return e("./tables/cp936.json")}},gbk:{type:"_dbcs",table:function(){return e("./tables/cp936.json").concat(e("./tables/gbk-added.json"))}},xgbk:"gbk",isoir58:"gbk",gb18030:{type:"_dbcs",table:function(){return e("./tables/cp936.json").concat(e("./tables/gbk-added.json"))},gb18030:function(){return e("./tables/gb18030-ranges.json")},encodeSkipVals:[128],encodeAdd:{"":41699}},chinese:"gb18030",windows949:"cp949",ms949:"cp949",949:"cp949",cp949:{type:"_dbcs",table:function(){return e("./tables/cp949.json")}},cseuckr:"cp949",csksc56011987:"cp949",euckr:"cp949",isoir149:"cp949",korean:"cp949",ksc56011987:"cp949",ksc56011989:"cp949",ksc5601:"cp949",windows950:"cp950",ms950:"cp950",950:"cp950",cp950:{type:"_dbcs",table:function(){return e("./tables/cp950.json")}},big5:"big5hkscs",big5hkscs:{type:"_dbcs",table:function(){return e("./tables/cp950.json").concat(e("./tables/big5-added.json"))},encodeSkipVals:[41676]},cnbig5:"big5hkscs",csbig5:"big5hkscs",xxbig5:"big5hkscs"}},{"./tables/big5-added.json":61,"./tables/cp936.json":62,"./tables/cp949.json":63,"./tables/cp950.json":64,"./tables/eucjp.json":65,"./tables/gb18030-ranges.json":66,"./tables/gbk-added.json":67,"./tables/shiftjis.json":68}],56:[function(e,t,r){"use strict";for(var n=[e("./internal"),e("./utf16"),e("./utf7"),e("./sbcs-codec"),e("./sbcs-data"),e("./sbcs-data-generated"),e("./dbcs-codec"),e("./dbcs-data")],a=0;a<n.length;a++){var t=n[a];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=t[i])}},{"./dbcs-codec":54,"./dbcs-data":55,"./internal":57,"./sbcs-codec":58,"./sbcs-data":60,"./sbcs-data-generated":59,"./utf16":69,"./utf7":70}],57:[function(e,t,r){"use strict";function n(e,t){this.enc=e.encodingName,this.bomAware=e.bomAware,"base64"===this.enc?this.encoder=s:"cesu8"===this.enc&&(this.enc="utf8",this.encoder=o,""!==new l("eda0bdedb2a9","hex").toString()&&(this.decoder=c,this.defaultCharUnicode=t.defaultCharUnicode))}function a(e,t){u.call(this,t.enc)}function i(e,t){this.enc=t.enc}function s(e,t){this.prevStr=""}function o(e,t){}function c(e,t){this.acc=0,this.contBytes=0,this.accBytes=0,this.defaultCharUnicode=t.defaultCharUnicode}var l=e("buffer").Buffer;t.exports={utf8:{type:"_internal",bomAware:!0},cesu8:{type:"_internal",bomAware:!0},unicode11utf8:"utf8",ucs2:{type:"_internal",bomAware:!0},utf16le:"ucs2",binary:{type:"_internal"},base64:{type:"_internal"},hex:{type:"_internal"},_internal:n},n.prototype.encoder=i,n.prototype.decoder=a;var u=e("string_decoder").StringDecoder;u.prototype.end||(u.prototype.end=function(){}),a.prototype=u.prototype,i.prototype.write=function(e){return new l(e,this.enc)},i.prototype.end=function(){},s.prototype.write=function(e){e=this.prevStr+e;var t=e.length-e.length%4;return this.prevStr=e.slice(t),e=e.slice(0,t),new l(e,"base64")},s.prototype.end=function(){return new l(this.prevStr,"base64")},o.prototype.write=function(e){for(var t=new l(3*e.length),r=0,n=0;n<e.length;n++){var a=e.charCodeAt(n);a<128?t[r++]=a:a<2048?(t[r++]=192+(a>>>6),t[r++]=128+(63&a)):(t[r++]=224+(a>>>12),t[r++]=128+(a>>>6&63),t[r++]=128+(63&a))}return t.slice(0,r)},o.prototype.end=function(){},c.prototype.write=function(e){for(var t=this.acc,r=this.contBytes,n=this.accBytes,a="",i=0;i<e.length;i++){var s=e[i];128!=(192&s)?(r>0&&(a+=this.defaultCharUnicode,r=0),s<128?a+=String.fromCharCode(s):s<224?(t=31&s,r=1,n=1):s<240?(t=15&s,r=2,n=1):a+=this.defaultCharUnicode):r>0?(t=t<<6|63&s,r--,n++,0===r&&(a+=2===n&&t<128&&t>0?this.defaultCharUnicode:3===n&&t<2048?this.defaultCharUnicode:String.fromCharCode(t))):a+=this.defaultCharUnicode}return this.acc=t,this.contBytes=r,this.accBytes=n,a},c.prototype.end=function(){var e=0;return this.contBytes>0&&(e+=this.defaultCharUnicode),e}},{buffer:void 0,string_decoder:void 0}],58:[function(e,t,r){"use strict";function n(e,t){if(!e)throw new Error("SBCS codec is called without the data.");if(!e.chars||128!==e.chars.length&&256!==e.chars.length)throw new Error("Encoding '"+e.type+"' has incorrect 'chars' (must be of len 128 or 256)");if(128===e.chars.length){for(var r="",n=0;n<128;n++)r+=String.fromCharCode(n);e.chars=r+e.chars}this.decodeBuf=new s(e.chars,"ucs2");var a=new s(65536);a.fill(t.defaultCharSingleByte.charCodeAt(0));for(var n=0;n<e.chars.length;n++)a[e.chars.charCodeAt(n)]=n;this.encodeBuf=a}function a(e,t){this.encodeBuf=t.encodeBuf}function i(e,t){this.decodeBuf=t.decodeBuf}var s=e("buffer").Buffer;r._sbcs=n,n.prototype.encoder=a,n.prototype.decoder=i,a.prototype.write=function(e){for(var t=new s(e.length),r=0;r<e.length;r++)t[r]=this.encodeBuf[e.charCodeAt(r)];return t},a.prototype.end=function(){},i.prototype.write=function(e){for(var t=this.decodeBuf,r=new s(2*e.length),n=0,a=0,i=0;i<e.length;i++)n=2*e[i],a=2*i,r[a]=t[n],r[a+1]=t[n+1];return r.toString("ucs2")},i.prototype.end=function(){}},{buffer:void 0}],59:[function(e,t,r){"use strict";t.exports={437:"cp437",737:"cp737",775:"cp775",850:"cp850",852:"cp852",855:"cp855",856:"cp856",857:"cp857",858:"cp858",860:"cp860",861:"cp861",862:"cp862",863:"cp863",864:"cp864",865:"cp865",866:"cp866",869:"cp869",874:"windows874",922:"cp922",1046:"cp1046",1124:"cp1124",1125:"cp1125",1129:"cp1129",1133:"cp1133",1161:"cp1161",1162:"cp1162",1163:"cp1163",1250:"windows1250",1251:"windows1251",1252:"windows1252",1253:"windows1253",1254:"windows1254",1255:"windows1255",1256:"windows1256",1257:"windows1257",1258:"windows1258",28591:"iso88591",28592:"iso88592",28593:"iso88593",28594:"iso88594",28595:"iso88595",28596:"iso88596",28597:"iso88597",28598:"iso88598",28599:"iso88599",28600:"iso885910",28601:"iso885911",28603:"iso885913",28604:"iso885914",28605:"iso885915",28606:"iso885916",windows874:{type:"_sbcs",chars:""},win874:"windows874",cp874:"windows874",windows1250:{type:"_sbcs",chars:""},win1250:"windows1250",cp1250:"windows1250",windows1251:{type:"_sbcs",chars:""},win1251:"windows1251",cp1251:"windows1251",windows1252:{type:"_sbcs",chars:""},win1252:"windows1252",cp1252:"windows1252",windows1253:{type:"_sbcs",chars:""},win1253:"windows1253",cp1253:"windows1253",windows1254:{type:"_sbcs",chars:""},win1254:"windows1254",cp1254:"windows1254",windows1255:{type:"_sbcs",chars:""},win1255:"windows1255",cp1255:"windows1255",windows1256:{type:"_sbcs",chars:""},win1256:"windows1256",cp1256:"windows1256",windows1257:{type:"_sbcs",chars:""},win1257:"windows1257",cp1257:"windows1257",windows1258:{type:"_sbcs",chars:""},win1258:"windows1258",cp1258:"windows1258",iso88591:{type:"_sbcs",chars:""},cp28591:"iso88591",iso88592:{type:"_sbcs",chars:""},cp28592:"iso88592",iso88593:{type:"_sbcs",chars:""},cp28593:"iso88593",iso88594:{type:"_sbcs",chars:""},cp28594:"iso88594",iso88595:{type:"_sbcs",chars:""},cp28595:"iso88595",iso88596:{type:"_sbcs",chars:""},cp28596:"iso88596",iso88597:{type:"_sbcs",chars:""},cp28597:"iso88597",iso88598:{type:"_sbcs",chars:""},cp28598:"iso88598",iso88599:{type:"_sbcs",chars:""},cp28599:"iso88599",iso885910:{type:"_sbcs",chars:""},cp28600:"iso885910",iso885911:{type:"_sbcs",chars:""},cp28601:"iso885911",iso885913:{type:"_sbcs",chars:""},cp28603:"iso885913",iso885914:{type:"_sbcs",chars:""},cp28604:"iso885914",iso885915:{type:"_sbcs",chars:""},cp28605:"iso885915",iso885916:{type:"_sbcs",chars:""},cp28606:"iso885916",cp437:{type:"_sbcs",chars:""},ibm437:"cp437",csibm437:"cp437",cp737:{type:"_sbcs",chars:""},ibm737:"cp737",csibm737:"cp737",cp775:{type:"_sbcs",chars:""},ibm775:"cp775",csibm775:"cp775",cp850:{type:"_sbcs",chars:""},ibm850:"cp850",csibm850:"cp850",cp852:{type:"_sbcs",chars:""},ibm852:"cp852",csibm852:"cp852",cp855:{type:"_sbcs",chars:""},ibm855:"cp855",csibm855:"cp855",cp856:{type:"_sbcs",chars:""},ibm856:"cp856",csibm856:"cp856",cp857:{type:"_sbcs",chars:""},ibm857:"cp857",csibm857:"cp857",cp858:{type:"_sbcs",chars:""},ibm858:"cp858",csibm858:"cp858",cp860:{type:"_sbcs",chars:""},ibm860:"cp860",csibm860:"cp860",cp861:{type:"_sbcs",chars:""},ibm861:"cp861",csibm861:"cp861",cp862:{type:"_sbcs",chars:""},ibm862:"cp862",csibm862:"cp862",cp863:{type:"_sbcs",chars:""},ibm863:"cp863",csibm863:"cp863",cp864:{type:"_sbcs",chars:"\0\b\t\n\v\f\r !\"#$&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~"},ibm864:"cp864",csibm864:"cp864",cp865:{type:"_sbcs",chars:""},ibm865:"cp865",csibm865:"cp865",cp866:{type:"_sbcs",chars:""},ibm866:"cp866",csibm866:"cp866",cp869:{type:"_sbcs",chars:""},ibm869:"cp869",csibm869:"cp869",cp922:{type:"_sbcs",chars:""},ibm922:"cp922",csibm922:"cp922",cp1046:{type:"_sbcs",chars:""},ibm1046:"cp1046",csibm1046:"cp1046",cp1124:{type:"_sbcs",chars:""},ibm1124:"cp1124",csibm1124:"cp1124",cp1125:{type:"_sbcs",chars:""},ibm1125:"cp1125",csibm1125:"cp1125",cp1129:{type:"_sbcs",chars:""},ibm1129:"cp1129",csibm1129:"cp1129",cp1133:{type:"_sbcs",chars:""},ibm1133:"cp1133",csibm1133:"cp1133",cp1161:{type:"_sbcs",chars:""},ibm1161:"cp1161",csibm1161:"cp1161",cp1162:{type:"_sbcs",chars:""},ibm1162:"cp1162",csibm1162:"cp1162",cp1163:{type:"_sbcs",chars:""},ibm1163:"cp1163",csibm1163:"cp1163",maccroatian:{type:"_sbcs",chars:""},maccyrillic:{type:"_sbcs",chars:""},macgreek:{type:"_sbcs",chars:""},maciceland:{type:"_sbcs",chars:""},macroman:{type:"_sbcs",chars:""},macromania:{type:"_sbcs",chars:""},macthai:{type:"_sbcs",chars:"\ufeff"},macturkish:{type:"_sbcs",chars:""},macukraine:{type:"_sbcs",chars:""},koi8r:{type:"_sbcs",chars:""},koi8u:{type:"_sbcs",chars:""},koi8ru:{type:"_sbcs",chars:""},koi8t:{type:"_sbcs",chars:""},armscii8:{type:"_sbcs",chars:")(.,-"},rk1048:{type:"_sbcs",chars:""},tcvn:{type:"_sbcs",chars:"\0\b\t\n\v\f\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~"},georgianacademy:{type:"_sbcs",chars:""},georgianps:{type:"_sbcs",chars:""},pt154:{type:"_sbcs",chars:""},viscii:{type:"_sbcs",chars:"\0\b\t\n\v\f\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~"},iso646cn:{type:"_sbcs",chars:"\0\b\t\n\v\f\r !\"#%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}"},iso646jp:{type:"_sbcs",chars:"\0\b\t\n\v\f\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[]^_`abcdefghijklmnopqrstuvwxyz{|}"},hproman8:{type:"_sbcs",chars:""},macintosh:{type:"_sbcs",chars:""},ascii:{type:"_sbcs",chars:""},tis620:{type:"_sbcs",chars:""}}},{}],60:[function(e,t,r){"use strict";t.exports={10029:"maccenteuro",maccenteuro:{type:"_sbcs",chars:""},808:"cp808",ibm808:"cp808",cp808:{type:"_sbcs",chars:""},ascii8bit:"ascii",usascii:"ascii",ansix34:"ascii",ansix341968:"ascii",ansix341986:"ascii",csascii:"ascii",cp367:"ascii",ibm367:"ascii",isoir6:"ascii",iso646us:"ascii",iso646irv:"ascii",us:"ascii",latin1:"iso88591",latin2:"iso88592",latin3:"iso88593",latin4:"iso88594",latin5:"iso88599",latin6:"iso885910",latin7:"iso885913",latin8:"iso885914",latin9:"iso885915",latin10:"iso885916",csisolatin1:"iso88591",csisolatin2:"iso88592",csisolatin3:"iso88593",csisolatin4:"iso88594",csisolatincyrillic:"iso88595",csisolatinarabic:"iso88596",csisolatingreek:"iso88597",csisolatinhebrew:"iso88598",csisolatin5:"iso88599",csisolatin6:"iso885910",l1:"iso88591",l2:"iso88592",l3:"iso88593",l4:"iso88594",l5:"iso88599",l6:"iso885910",l7:"iso885913",l8:"iso885914",l9:"iso885915",l10:"iso885916",isoir14:"iso646jp",isoir57:"iso646cn",isoir100:"iso88591",isoir101:"iso88592",isoir109:"iso88593",isoir110:"iso88594",isoir144:"iso88595",isoir127:"iso88596",isoir126:"iso88597",isoir138:"iso88598",isoir148:"iso88599",isoir157:"iso885910",isoir166:"tis620",isoir179:"iso885913",isoir199:"iso885914",isoir203:"iso885915",isoir226:"iso885916",cp819:"iso88591",ibm819:"iso88591",cyrillic:"iso88595",arabic:"iso88596",arabic8:"iso88596",ecma114:"iso88596",asmo708:"iso88596",greek:"iso88597",greek8:"iso88597",ecma118:"iso88597",elot928:"iso88597",hebrew:"iso88598",hebrew8:"iso88598",turkish:"iso88599",turkish8:"iso88599",thai:"iso885911",thai8:"iso885911",celtic:"iso885914",celtic8:"iso885914",isoceltic:"iso885914",tis6200:"tis620",tis62025291:"tis620",tis62025330:"tis620",10000:"macroman",10006:"macgreek",10007:"maccyrillic",10079:"maciceland",10081:"macturkish",cspc8codepage437:"cp437",cspc775baltic:"cp775",cspc850multilingual:"cp850",cspcp852:"cp852",cspc862latinhebrew:"cp862",cpgr:"cp869",msee:"cp1250",mscyrl:"cp1251",msansi:"cp1252",msgreek:"cp1253",msturk:"cp1254",mshebr:"cp1255",msarab:"cp1256",winbaltrim:"cp1257",cp20866:"koi8r",20866:"koi8r",ibm878:"koi8r",cskoi8r:"koi8r",cp21866:"koi8u",21866:"koi8u",ibm1168:"koi8u",strk10482002:"rk1048",tcvn5712:"tcvn",tcvn57121:"tcvn",gb198880:"iso646cn",cn:"iso646cn",csiso14jisc6220ro:"iso646jp",
jisc62201969ro:"iso646jp",jp:"iso646jp",cshproman8:"hproman8",r8:"hproman8",roman8:"hproman8",xroman8:"hproman8",ibm1051:"hproman8",mac:"macintosh",csmacintosh:"macintosh"}},{}],61:[function(e,t,r){t.exports=[["8740",""],["8767",""],["87a1",""],["8840","",4,""],["88a1",""],["8940",""],["8943",""],["8946",""],["894c",""],["89a1",""],["89ab",""],["89b0",""],["89b5",""],["89c1",""],["89c5",""],["8a40",""],["8a43",""],["8a64",""],["8a76",""],["8aa1",""],["8aac",""],["8ab2",""],["8abb",""],["8ac9",""],["8ace",""],["8adf",""],["8af6",""],["8b40",""],["8b55",""],["8ba1",""],["8bde",""],["8c40",""],["8ca1",""],["8ca7",""],["8cc9",""],["8cce",""],["8ce6",""],["8d40",""],["8d42",""],["8da1",""],["8e40",""],["8ea1",""],["8f40",""],["8fa1",""],["9040",""],["90a1",""],["9140",""],["91a1",""],["9240",""],["92a1",""],["9340",""],["93a1",""],["9440",""],["94a1",""],["9540",""],["95a1",""],["9640",""],["96a1",""],["9740",""],["97a1",""],["9840",""],["98a1",""],["9940",""],["99a1",""],["9a40",""],["9aa1",""],["9b40",""],["9b62",""],["9ba1",""],["9c40",""],["9ca1",""],["9d40",""],["9da1",""],["9e40",""],["9ea1",""],["9ead",""],["9ec5",""],["9ef5",""],["9f40",""],["9f4f",""],["9fa1",""],["9fae",""],["9fb2",""],["9fc1",""],["9fc9",""],["9fdb",""],["9fe7",""],["9feb",""],["9ff0",""],["a040",""],["a055",""],["a058",""],["a05b",""],["a063",""],["a073",""],["a0a1",""],["a0a6",""],["a0ae",""],["a0b0",""],["a0d4",""],["a0e2",""],["a3c0","",31,""],["c6a1","",9,"",9,"",9,"",23],["c740","",58,""],["c7a1","",81,"",5,"",4],["c840","",26,"",25,""],["c8a1",""],["c8cd",""],["c8f5",""],["f9fe",""],["fa40",""],["faa1",""],["fb40",""],["fba1",""],["fc40",""],["fca1",""],["fd40",""],["fda1",""],["fe40",""],["fea1",""]]},{}],62:[function(e,t,r){t.exports=[["0","\0",127,""],["8140","",5,"",9,"",6,""],["8180","",6,"",4,"",4,"",5,""],["8240","",4,"",8,"",4,"",11],["8280","",10,"",4,"",7,"",5,"",8,"",20,"",4,"",6,""],["8340","",17,"",5,"",10,"",4,"",9,""],["8380","",5,"",13,"",28,"",4,"",4,"",5],["8440","",5,"",5,""],["8480","",9,"",4,"",6,"",6,"",9,"",5,"",10,"",7,""],["8540","",9,""],["8580","",4,"",6,"",4,"",4,"",7,""],["8640","",4,"",5,"",4,"",5,""],["8680","",4,"",4,"",5,"",6,"",8,"",4,"",4,"",4,""],["8740","",7,"",11,"",4,"",4],["8780","",7,"",6,"",14,"",10,"",6,"",12,"",8,"",5,"",6],["8840","",9,"",4,"",4,""],["8880","",4,"",6,"",8,"",6,"",7,"",4,"",4,"",7],["8940","",5,"",6,"",4,"",5,"",4,"",16,""],["8980","",4,"",4,"",7,"",17,"",10,"",13,"",5,"",7,"",4,""],["8a40","",4,"",12,""],["8a80","",5,"",6,"",4,"",11,"",6,"",4,"",4,"",9,"",5],["8b40","",8,"",17,"",6,"",13,""],["8b80","",4,"",4,"",5,"",4,"",4,"",22,"",11,"",25,"",7,"",6],["8c40","",7,""],["8c80","",8,"",4,"",6,"",6,"",6,"",4,"",4,"",4],["8d40","",5,"",5,"",5,"",6,"",9,"",4],["8d80","",5,"",4,"",4,"",4,"",7,"",7,"",10,"",10,"",12,"",21,""],["8e40","",21,"",12,"",6,"",12,""],["8e80","",4,"",7,"",4,"",4,"",5,"",6,"",4,"",14,"",4,"",4,"",6],["8f40","",5,"",11,"",8,""],["8f80","",6,"",14,"",5,"",5,"",4,""],["9040","",4,"",4,"",6,""],["9080","",7,"",4,"",4,"",4,"",4,"",18,"",6],["9140","",6,"",6,"",18,"",4,""],["9180","",6,"",8,"",9,"",5,"",4,"",4,"",16,"",13,"",8,"",5,"",4,""],["9240","",6,"",5,""],["9280","",5,"",7,"",6,""],["9340","",6,"",4,"",4,"",5,""],["9380","",5,"",4,"",6,"",4,"",7,"",9,"",6,"",8,"",4,"",6,""],["9440","",24,"",7,"",7,"",4,"",8],["9480","",4,"",4,"",14,"",7,"",7,""],["9540","",4,"",4,"",6,""],["9580","",4,"",4,"",8,"",4,"",4,"",25,"",7,"",5,""],["9640","",5,"",4,""],["9680","",7,"",9,"",7,"",4,"",6,"",6,"",5],["9740","",7,"",8,"",7,"",9,""],["9780","",6,"",5,"",4,"",9,"",4,"",11,"",7,"",16,""],["9840","",4,"",5,"",9,""],["9880","",7,"",5,"",11,"",9,"",9,"",11,"",5,"",5,"",6,"",4,"",7,"",6,""],["9940","",4,"",10,"",6,"",8,"",4,"",7,"",5],["9980","",114,"",6],["9a40","",11,"",7,"",13,""],["9a80","",4,"",7,"",7,"",6,"",4,"",4,"",7,"",6,"",4,"",4,""],["9b40","",4,""],["9b80","",5,"",4,"",4,"",5,""],["9c40","",7,""],["9c80","",7,"",7,"",10,"",14,"",4,"",6,"",5],["9d40","",7,"",4,"",9,"",6,""],["9d80","",9,"",5,"",6,"",12,"",4,"",10,"",5,"",5,"",6,"",10,""],["9e40","",7,"",32,"",7,"",6,"",6],["9e80","",9,"",17,"",13,"",11,"",12,"",12,""],["9f40","",6,"",10,"",4,"",10,"",7,""],["9f80","",13,"",12,"",4,"",4,"",5,"",4,"",4,"",6,"",5,"",8,"",9,"",4],["a040","",9,"",5,"",9,"",11,"",19],["a080","",9,"",6,"",4,"",11,"",11,"",6,""],["a1a1","",7,""],["a2a1","",9],["a2b1","",19,"",19,"",9],["a2e5","",9],["a2f1","",11],["a3a1","",88,""],["a4a1","",82],["a5a1","",85],["a6a1","",16,"",6],["a6c1","",16,"",6],["a6e0",""],["a6ee",""],["a6f4",""],["a7a1","",5,"",25],["a7d1","",5,"",25],["a840","",35,"",6],["a880","",7,""],["a8a1",""],["a8bd",""],["a8c0",""],["a8c5","",36],["a940","",8,""],["a959",""],["a95c",""],["a960","",9,"",8],["a980","",4,""],["a996",""],["a9a4","",75],["aa40","",5,"",5,"",8],["aa80","",7,"",10,""],["ab40","",11,"",4,"",5,"",4],["ab80","",6,"",4],["ac40","",10,"",8,"",5,"",4,"",11],["ac80","",6,"",12,"",4,""],["ad40","",10,"",7,"",15,"",12],["ad80","",9,"",8,"",6,""],["ae40","",6,"",7,"",4,""],["ae80","",7,"",6,"",4,""],["af40","",4,""],["af80",""],["b040","",6,"",5,"",4,"",6,"",7,""],["b080","",7,"",8,"",9,""],["b140","",4,"",7,"",10,""],["b180","",4,"",7,"",7,""],["b240","",11,"",5,"",11,"",4],["b280","",12,"",8,"",4,""],["b340","",5,""],["b380","",11,"",7,"",6,""],["b440","",7,"",9],["b480","",4,"",5,"",6,""],["b540","",5,"",9,"",4,"",14,"",4,"",8,""],["b580","",6,"",4,""],["b640","",6,"",11,"",10,"",4,"",5,""],["b680","",6,"",4,""],["b740","",14,"",5,"",9,"",4,"",16],["b780","",6,""],["b840","",4,"",10,"",10,"",9,"",5,""],["b880","",4,""],["b940","",5,"",10,"",6,""],["b980","",7,""],["ba40","",4,"",4,"",7,"",5,""],["ba80","",4,"",5,"",12,"",5,""],["bb40","",9,"",36,"",5,"",9],["bb80","",6,"",4,""],["bc40","",6,"",6,"",5,"",7,"",13,"",5],["bc80","",14,"",6,""],["bd40","",54,"",7],["bd80","",32,""],["be40","",12,"",6,"",42],["be80","",32,""],["bf40","",62],["bf80","",4,"",4,"",21,""],["c040","",35,"",23,""],["c080","",6,"",9,""],["c140","",4,"",7,"",4,"",4,"",6,""],["c180","",4,"",4,"",5,""],["c240","",6,"",5,""],["c280","",13,"",5,"",11,""],["c340","",5,"",4,"",6,""],["c380","",12,"",4,""],["c440","",5,"",4,"",4,"",5,"",4,""],["c480","",7,"",5,"",6,""],["c540","",14,"",4,"",5,"",4,"",5,""],["c580","",7,"",7,""],["c640",""],["c680","",4,"",9,""],["c740","",4,"",4,"",6,"",6,"",6,""],["c780",""],["c840","",4,"",5,"",5,"",7,"",5,"",7,""],["c880","",6,"",4,"",4,""],["c940","",4,"",7,"",12,""],["c980","",4,"",4,"",10,""],["ca40","",8,"",8,"",9,"",4,"",10],["ca80","",4,"",8,""],["cb40","",6,"",10,"",6,"",5,"",6,"",6,"",4,""],["cb80","",5,"",6,"",14,""],["cc40","",4,"",10,"",15,"",13,""],["cc80","",11,"",4,"",7,""],["cd40","",6,"",6,"",4,"",5,"",4,"",4,""],["cd80",""],["ce40","",6,"",5,"",7,""],["ce80","",4,"",6,"",4,""],["cf40","",4,"",4,"",6,"",9],["cf80","",5,"",7,"",4,""],["d040","",13,"",5,"",5,"",5,"",6,""],["d080","",4,"",4,"",5,""],["d140","",4,"",4,"",6,"",5],["d180","",4,"",4,"",4,""],["d240","",8,"",24,"",5,"",19,""],["d280","",26,""],["d340","",30,"",6],["d380","",4,"",5,"",21,""],["d440","",31,"",8,"",21],["d480","",25,"",6,""],["d540","",7,"",7,"",46],["d580","",32,""],["d640","",34,"",27],["d680","",30,""],["d740","",31,"",4,"",25],["d780","",24,""],["d840","",8,"",7,"",5,"",6,"",6,"",6,""],["d880","",6,"",20,""],["d940","",62],["d980","",32,""],["da40","",14,"",8,"",4,"",9,""],["da80","",12,""],["db40","",6,"",7,"",4,""],["db80","",4,"",5,"",11,""],["dc40","",4,"",6,"",6,"",11,"",6,"",7],["dc80","",10,"",21,""],["dd40","",62],["dd80","",32,""],["de40","",32,""],["de80","",4,""],["df40","",5,"",4,"",4,"",5,"",4,"",6,""],["df80","",4,""],["e040","",19,""],["e080","",10,"",6,"",8,""],["e140","",4,"",6,"",5,"",5,""],["e180","",10,"",9,"",8,""],["e240","",62],["e280","",32,"",5,""],["e340","",45,"",16],["e380","",7,"",24,""],["e440","",5,"",24,"",31],["e480","",32,""],["e540","",51,"",10],["e580","",31,""],["e640","",34,"",27],["e680","",29,""],["e740","",7,"",54],["e780","",32,"",6,"",4,""],["e840","",14,"",43,""],["e880","",20,""],["e940","",7,"",42],["e980","",32,""],["ea40","",27,"",6,""],["ea80","",4,"",12,""],["eb40","",9,"",7,"",9,"",6,""],["eb80","",4,""],["ec40","",8,"",4,"",18,"",7],["ec80","",4,"",7,"",4,"",4,""],["ed40","",6,"",46],["ed80","",4,"",23,""],["ee40","",62],["ee80","",32,"",4,"",6,""],["ef40","",5,"",37,"",4],["ef80","",30,"",4,"",8,""],["f040","",4,"",28,"",26],["f080","",9,"",12,"",4,"",6,""],["f140","",10,"",47],["f180","",32,""],["f240","",62],["f280","",32,""],["f340","",17,"",6,"",4,""],["f380","",8,"",6,""],["f440","",5,"",10,"",10,"",7,"",5],["f480","",32,""],["f540","",62],["f580","",32,""],["f640","",62],["f680","",32,"",5,"",5,"",4,"",7,""],["f740","",62],["f780","",4,"",4,""],["f840","",62],["f880","",32],["f940","",62],["f980","",32],["fa40","",62],["fa80","",32],["fb40","",27,"",9,""],["fb80","",5,"",8,"",5,""],["fc40","",8,"",4,"",8,"",6],["fc80","",4,"",5,"",8,""],["fd40","",4,"",4,"",10,"",38],["fd80","",5,"",11,"",4,""],["fe40",""]]},{}],63:[function(e,t,r){
t.exports=[["0","\0",127],["8141","",4,"",6,""],["8161","",9,"",5,""],["8181","",18,"",4,"",6,"",5,"",6,"",7,"",7,"",4,"",4,""],["8241","",7,"",5],["8261","",6,"",5,""],["8281","",7,"",7,"",4,"",10,"",5,"",17,"",7,"",6,"",7,"",18],["8341","",5,"",5,"",7],["8361","",18,""],["8381","",4,"",6,"",5,"",5,"",46,"",6,"",5,"",8],["8441","",5,"",8],["8461","",18],["8481","",7,"",6,"",5,"",10,"",5,"",18,"",5,"",6,"",5,"",26,""],["8541","",5,"",4,"",6,"",4],["8561","",5,"",5,"",6,""],["8581","",6,"",6,"",9,"",26,"",29,"",6,"",5,""],["8641","",6,"",5,""],["8661","",6,"",10],["8681","",22,"",4,"",6,"",5,"",6,"",22,"",4,""],["8741","",9,"",15],["8761","",18,""],["8781","",5,"",7,"",7,"",5,"",6,"",5,"",18,"",6,"",26,"",6,"",4],["8841","",4,"",5,"",6,"",4],["8861","",4,""],["8881","",15,"",4,"",6,"",5,"",54,""],["8941","",6,"",5,""],["8961","",10,"",5,""],["8981","",21,"",18,"",18,"",6,"",6,"",7,"",15],["8a41","",10,"",6,""],["8a61","",4,"",18,""],["8a81","",4,"",19,"",5,"",7,"",5,"",6,"",5,"",4,"",5,"",26,""],["8b41","",5,"",4,"",6,""],["8b61","",6,"",8],["8b81","",52,"",4,"",6,"",5,"",18,"",18],["8c41","",15,"",4],["8c61","",6,"",5,"",6,"",5],["8c81","",12,"",26,"",50,"",5,"",16],["8d41","",16,"",8],["8d61","",17,""],["8d81","",4,"",33,"",6,"",7,"",6,"",9,"",6,"",5,"",6,""],["8e41","",6,"",5,"",8],["8e61","",4,"",19],["8e81","",13,"",6,"",4,"",6,"",5,"",6,"",5,"",11,"",7,"",6,"",5,"",7],["8f41","",7,"",17],["8f61","",7,"",6,"",4],["8f81","",5,"",7,"",5,"",6,"",5,"",18,"",6,"",26,"",6,"",5],["9041","",6,"",5,""],["9061","",5,"",15],["9081","",12,"",6,"",5,"",4,"",6,"",4,"",5,"",11,"",33,""],["9141","",6,"",5],["9161","",9,"",5],["9181","",20,"",4,"",5,"",14,"",33,"",7,"",5,"",6],["9241","",7,"",4,""],["9261","",7,"",7,"",4],["9281","",21,"",18,"",6,"",7,"",6,"",35,""],["9341","",4,""],["9361","",6,"",8],["9381","",37,"",4,"",4,"",6,"",5,"",7,"",22,""],["9441","",5,"",5,"",8],["9461","",5,"",6,"",12],["9481","",5,"",6,"",6,"",9,"",22,"",4,"",6,"",10,"",6,"",24],["9541","",11,"",5,""],["9561","",6,"",5,""],["9581","",6,"",35,"",4,"",4,"",4,"",6,"",5,"",13,"",14],["9641","",23,""],["9661","",6,"",5,"",8],["9681","",10,"",5,"",13,"",33,"",6,"",44],["9741","",16,"",8],["9761","",17,"",7],["9781","",11,"",5,"",6,"",89,""],["9841","",16,"",5,""],["9861","",6,"",15],["9881","",21,"",6,"",5,"",4,"",6,"",5,"",6,"",5,"",6,"",5,""],["9941","",6,"",5,""],["9961","",6,"",5,""],["9981","",8,"",5,"",4,"",11,"",5,"",6,"",6,"",6,"",7,"",6,"",5,""],["9a41","",16],["9a61","",6,"",6,""],["9a81","",4,"",6,"",5,"",5,"",6,"",5,"",5,"",33,"",5,"",6,""],["9b41","",6,"",8],["9b61","",17,"",7],["9b81","",25,"",4,"",5,"",50,"",22,""],["9c41","",4,"",5,"",5],["9c61","",8,"",6,"",9],["9c81","",8,"",6,"",6,"",9,"",26,"",6,"",5,"",18,"",6,"",12],["9d41","",13,"",8],["9d61","",25],["9d81","",8,"",5,"",9,"",6,"",10,"",6,"",5,"",6,"",5,""],["9e41","",7,"",9,""],["9e61","",4,"",6,""],["9e81","",6,"",6,"",6,"",5,"",10,"",5,"",6,"",5,"",6,""],["9f41","",5,"",4,"",5,""],["9f61","",6,"",5,""],["9f81","",4,"",5,"",6,"",5,"",6,"",4,"",6,"",7,"",4,"",4,""],["a041","",5,"",6,""],["a061","",5,"",13],["a081","",4,"",4,"",4,"",6,"",5,"",6,"",5,"",26,"",4,"",5,"",7,""],["a141","",18,""],["a161","",6,"",5,""],["a181","",14,"",5,"",4,"",9,""],["a241","",5,"",18],["a261","",6,"",18],["a281","",7,"",6,"",7,""],["a341","",6,"",10,""],["a361","",6,"",16],["a381","",16,"",4,"",58,"",32,""],["a441","",5,""],["a461","",5,"",12],["a481","",28,"",93],["a541","",4,"",6,"",5,""],["a561","",17,"",5,""],["a581","",16,"",14,"",9],["a5b0","",9],["a5c1","",16,"",6],["a5e1","",16,"",6],["a641","",19,""],["a661","",5,"",5,"",6],["a681","",6,"",18,"",7],["a741","",4,"",6,"",7],["a761","",22,""],["a781","",6,"",5,"",7,"",9,"",9,"",4,"",5,"",4,""],["a841","",10,"",14],["a861","",18,"",6],["a881","",19,"",11,""],["a8a6",""],["a8a8",""],["a8b1","",27,"",25,"",14,""],["a941","",14,"",10],["a961","",18],["a981","",14,"",6,"",27,"",25,"",14,""],["aa41","",6,"",4,""],["aa61","",4,"",5,"",6,""],["aa81","",29,"",82],["ab41","",6,"",5,""],["ab61","",6,"",5,"",5],["ab81","",8,"",6,"",12,"",85],["ac41","",5,"",6,""],["ac61","",11,"",4],["ac81","",28,"",5,"",25],["acd1","",5,"",25],["ad41","",6,"",5,"",7],["ad61","",6,"",10,""],["ad81","",5,"",18,""],["ae41","",5,"",16],["ae61","",5,"",6,"",4],["ae81","",6,"",5,""],["af41","",19],["af61","",13,"",5,""],["af81","",5,"",6,"",5,""],["b041","",5,"",5,"",12],["b061","",5,"",19],["b081","",13,"",6,"",5,"",7,"",4,""],["b141","",6,"",5,""],["b161","",6,"",5,"",11],["b181","",14,"",6,""],["b241","",6,"",5,""],["b261","",18,"",5,""],["b281","",5,"",18,"",6,""],["b341","",19,""],["b361","",5,"",5,"",5],["b381","",5,"",5,"",19,"",4,""],["b441","",5,"",6,"",5],["b461","",6,"",10,""],["b481","",6,"",18,"",4,"",4,""],["b541","",14,"",5],["b561","",5,"",5,"",4],["b581","",6,"",5,"",11,""],["b641","",7,"",17],["b661","",15,""],["b681","",5,"",6,"",5,""],["b741","",13,"",6,""],["b761","",20,""],["b781","",6,"",14,""],["b841","",7,"",17],["b861","",8,"",13],["b881","",5,"",24,"",4,""],["b941","",6,"",5,""],["b961","",14,"",6,""],["b981","",22,"",4,"",4,""],["ba41","",5,"",6,""],["ba61","",5,"",4,"",5],["ba81","",6,"",9,""],["bb41","",4,"",5,"",4,""],["bb61","",6,"",5,""],["bb81","",31,""],["bc41","",17,""],["bc61","",5,"",6,""],["bc81","",4,"",6,"",5,"",5,"",4,""],["bd41","",7,"",7,""],["bd61","",5,"",13],["bd81","",5,"",25,""],["be41","",7,"",14],["be61","",7,"",7,""],["be81","",4,"",4,"",5,"",8,"",6,""],["bf41","",10,"",14],["bf61","",18,""],["bf81","",5,"",7,"",6,"",5,""],["c041","",5,"",6,"",5],["c061","",25],["c081","",6,"",5,"",7,""],["c141","",5,"",6,""],["c161","",19,""],["c181","",31,""],["c241","",4,"",5,""],["c261","",4,"",5,"",6,""],["c281","",5,"",7,"",9,""],["c341","",4],["c361","",4,"",5,"",11],["c381","",5,"",7,"",5,""],["c441","",7,"",7,""],["c461","",5,"",4],["c481","",5,"",11,""],["c541","",6,"",5,""],["c561","",6,"",5,"",4],["c581","",6,"",5,""],["c641","",6,"",5],["c6a1",""],["c7a1",""],["c8a1",""],["caa1",""],["cba1",""],["cca1",""],["cda1",""],["cea1",""],["cfa1",""],["d0a1",""],["d1a1","",5,"",4,""],["d2a1","",4,"",5,"",10,"",7,"",5,""],["d3a1",""],["d4a1",""],["d5a1",""],["d6a1",""],["d7a1",""],["d8a1",""],["d9a1",""],["daa1",""],["dba1",""],["dca1",""],["dda1",""],["dea1",""],["dfa1",""],["e0a1",""],["e1a1",""],["e2a1",""],["e3a1",""],["e4a1",""],["e5a1",""],["e6a1",""],["e7a1",""],["e8a1",""],["e9a1",""],["eaa1",""],["eba1",""],["eca1",""],["eda1",""],["eea1",""],["efa1",""],["f0a1",""],["f1a1",""],["f2a1",""],["f3a1",""],["f4a1",""],["f5a1",""],["f6a1",""],["f7a1",""],["f8a1",""],["f9a1",""],["faa1",""],["fba1",""],["fca1",""],["fda1",""]]},{}],64:[function(e,t,r){
t.exports=[["0","\0",127],["a140",""],["a1a1","",4,""],["a240","",7,""],["a2a1","",9,"",9,"",8,"",25,"",21],["a340","",16,"",6,"",16,"",6,"",10],["a3a1","",25,""],["a3e1",""],["a440",""],["a4a1",""],["a540",""],["a5a1",""],["a640",""],["a6a1",""],["a740",""],["a7a1",""],["a840",""],["a8a1",""],["a940",""],["a9a1",""],["aa40",""],["aaa1",""],["ab40",""],["aba1",""],["ac40",""],["aca1",""],["ad40",""],["ada1",""],["ae40",""],["aea1",""],["af40",""],["afa1",""],["b040",""],["b0a1",""],["b140",""],["b1a1",""],["b240",""],["b2a1",""],["b340",""],["b3a1",""],["b440",""],["b4a1",""],["b540",""],["b5a1",""],["b640",""],["b6a1",""],["b740",""],["b7a1",""],["b840",""],["b8a1",""],["b940",""],["b9a1",""],["ba40",""],["baa1",""],["bb40",""],["bba1",""],["bc40",""],["bca1",""],["bd40",""],["bda1",""],["be40",""],["bea1",""],["bf40",""],["bfa1",""],["c040",""],["c0a1",""],["c140",""],["c1a1",""],["c240",""],["c2a1",""],["c340",""],["c3a1",""],["c440",""],["c4a1",""],["c540",""],["c5a1",""],["c640",""],["c940",""],["c9a1",""],["ca40",""],["caa1",""],["cb40",""],["cba1",""],["cc40",""],["cca1",""],["cd40",""],["cda1",""],["ce40",""],["cea1",""],["cf40",""],["cfa1",""],["d040",""],["d0a1",""],["d140",""],["d1a1",""],["d240",""],["d2a1",""],["d340",""],["d3a1",""],["d440",""],["d4a1",""],["d540",""],["d5a1",""],["d640",""],["d6a1",""],["d740",""],["d7a1",""],["d840",""],["d8a1",""],["d940",""],["d9a1",""],["da40",""],["daa1",""],["db40",""],["dba1",""],["dc40",""],["dca1",""],["dd40",""],["dda1",""],["de40",""],["dea1",""],["df40",""],["dfa1",""],["e040",""],["e0a1",""],["e140",""],["e1a1",""],["e240",""],["e2a1",""],["e340",""],["e3a1",""],["e440",""],["e4a1",""],["e540",""],["e5a1",""],["e640",""],["e6a1",""],["e740",""],["e7a1",""],["e840",""],["e8a1",""],["e940",""],["e9a1",""],["ea40",""],["eaa1",""],["eb40",""],["eba1",""],["ec40",""],["eca1",""],["ed40",""],["eda1",""],["ee40",""],["eea1",""],["ef40",""],["efa1",""],["f040",""],["f0a1",""],["f140",""],["f1a1",""],["f240",""],["f2a1",""],["f340",""],["f3a1",""],["f440",""],["f4a1",""],["f540",""],["f5a1",""],["f640",""],["f6a1",""],["f740",""],["f7a1",""],["f840",""],["f8a1",""],["f940",""],["f9a1",""]]},{}],65:[function(e,t,r){t.exports=[["0","\0",127],["8ea1","",62],["a1a1","",9,""],["a2a1",""],["a2ba",""],["a2ca",""],["a2dc",""],["a2f2",""],["a2fe",""],["a3b0","",9],["a3c1","",25],["a3e1","",25],["a4a1","",82],["a5a1","",85],["a6a1","",16,"",6],["a6c1","",16,"",6],["a7a1","",5,"",25],["a7d1","",5,"",25],["a8a1",""],["ada1","",19,"",9],["adc0",""],["addf","",4,""],["b0a1",""],["b1a1",""],["b2a1",""],["b3a1",""],["b4a1",""],["b5a1",""],["b6a1",""],["b7a1",""],["b8a1",""],["b9a1",""],["baa1",""],["bba1",""],["bca1",""],["bda1",""],["bea1",""],["bfa1",""],["c0a1",""],["c1a1",""],["c2a1",""],["c3a1",""],["c4a1",""],["c5a1",""],["c6a1",""],["c7a1",""],["c8a1",""],["c9a1",""],["caa1",""],["cba1",""],["cca1",""],["cda1",""],["cea1",""],["cfa1",""],["d0a1",""],["d1a1",""],["d2a1",""],["d3a1",""],["d4a1",""],["d5a1",""],["d6a1",""],["d7a1",""],["d8a1",""],["d9a1",""],["daa1",""],["dba1",""],["dca1",""],["dda1",""],["dea1",""],["dfa1",""],["e0a1",""],["e1a1",""],["e2a1",""],["e3a1",""],["e4a1",""],["e5a1",""],["e6a1",""],["e7a1",""],["e8a1",""],["e9a1",""],["eaa1",""],["eba1",""],["eca1",""],["eda1",""],["eea1",""],["efa1",""],["f0a1",""],["f1a1",""],["f2a1",""],["f3a1",""],["f4a1",""],["f9a1",""],["faa1",""],["fba1",""],["fca1",""],["fcf1","",9,""],["8fa2af",""],["8fa2c2",""],["8fa2eb",""],["8fa6e1",""],["8fa6e7",""],["8fa6e9",""],["8fa6ec",""],["8fa6f1",""],["8fa7c2","",10,""],["8fa7f2","",10,""],["8fa9a1",""],["8fa9a4",""],["8fa9a6",""],["8fa9a8",""],["8fa9ab",""],["8fa9af",""],["8fa9c1",""],["8faaa1",""],["8faaba",""],["8faba1",""],["8fabbd",""],["8fabc5",""],["8fb0a1",""],["8fb1a1",""],["8fb2a1","",4,""],["8fb3a1",""],["8fb4a1",""],["8fb5a1",""],["8fb6a1","",5,"",4,""],["8fb7a1","",4,""],["8fb8a1",""],["8fb9a1",""],["8fbaa1","",4,""],["8fbba1",""],["8fbca1","",4,""],["8fbda1","",4,""],["8fbea1","",4,""],["8fbfa1",""],["8fc0a1",""],["8fc1a1",""],["8fc2a1",""],["8fc3a1","",4,""],["8fc4a1",""],["8fc5a1",""],["8fc6a1",""],["8fc7a1",""],["8fc8a1",""],["8fc9a1","",4,"",4,""],["8fcaa1",""],["8fcba1",""],["8fcca1","",9,""],["8fcda1","",5,""],["8fcea1","",6,""],["8fcfa1",""],["8fd0a1",""],["8fd1a1",""],["8fd2a1","",5],["8fd3a1",""],["8fd4a1","",4,""],["8fd5a1",""],["8fd6a1",""],["8fd7a1",""],["8fd8a1",""],["8fd9a1","",4,"",6,""],["8fdaa1","",4,""],["8fdba1","",6,""],["8fdca1","",4,""],["8fdda1","",4,""],["8fdea1","",4,""],["8fdfa1",""],["8fe0a1",""],["8fe1a1","",4,""],["8fe2a1",""],["8fe3a1","",5,"",4,""],["8fe4a1","",4,""],["8fe5a1","",4,""],["8fe6a1",""],["8fe7a1",""],["8fe8a1","",4,""],["8fe9a1","",4],["8feaa1","",4,""],["8feba1","",4,""],["8feca1",""],["8feda1","",4,"",4,""]]},{}],66:[function(e,t,r){t.exports={
uChars:[128,165,169,178,184,216,226,235,238,244,248,251,253,258,276,284,300,325,329,334,364,463,465,467,469,471,473,475,477,506,594,610,712,716,730,930,938,962,970,1026,1104,1106,8209,8215,8218,8222,8231,8241,8244,8246,8252,8365,8452,8454,8458,8471,8482,8556,8570,8596,8602,8713,8720,8722,8726,8731,8737,8740,8742,8748,8751,8760,8766,8777,8781,8787,8802,8808,8816,8854,8858,8870,8896,8979,9322,9372,9548,9588,9616,9622,9634,9652,9662,9672,9676,9680,9702,9735,9738,9793,9795,11906,11909,11913,11917,11928,11944,11947,11951,11956,11960,11964,11979,12284,12292,12312,12319,12330,12351,12436,12447,12535,12543,12586,12842,12850,12964,13200,13215,13218,13253,13263,13267,13270,13384,13428,13727,13839,13851,14617,14703,14801,14816,14964,15183,15471,15585,16471,16736,17208,17325,17330,17374,17623,17997,18018,18212,18218,18301,18318,18760,18811,18814,18820,18823,18844,18848,18872,19576,19620,19738,19887,40870,59244,59336,59367,59413,59417,59423,59431,59437,59443,59452,59460,59478,59493,63789,63866,63894,63976,63986,64016,64018,64021,64025,64034,64037,64042,65074,65093,65107,65112,65127,65132,65375,65510,65536],gbChars:[0,36,38,45,50,81,89,95,96,100,103,104,105,109,126,133,148,172,175,179,208,306,307,308,309,310,311,312,313,341,428,443,544,545,558,741,742,749,750,805,819,820,7922,7924,7925,7927,7934,7943,7944,7945,7950,8062,8148,8149,8152,8164,8174,8236,8240,8262,8264,8374,8380,8381,8384,8388,8390,8392,8393,8394,8396,8401,8406,8416,8419,8424,8437,8439,8445,8482,8485,8496,8521,8603,8936,8946,9046,9050,9063,9066,9076,9092,9100,9108,9111,9113,9131,9162,9164,9218,9219,11329,11331,11334,11336,11346,11361,11363,11366,11370,11372,11375,11389,11682,11686,11687,11692,11694,11714,11716,11723,11725,11730,11736,11982,11989,12102,12336,12348,12350,12384,12393,12395,12397,12510,12553,12851,12962,12973,13738,13823,13919,13933,14080,14298,14585,14698,15583,15847,16318,16434,16438,16481,16729,17102,17122,17315,17320,17402,17418,17859,17909,17911,17915,17916,17936,17939,17961,18664,18703,18814,18962,19043,33469,33470,33471,33484,33485,33490,33497,33501,33505,33513,33520,33536,33550,37845,37921,37948,38029,38038,38064,38065,38066,38069,38075,38076,38078,39108,39109,39113,39114,39115,39116,39265,39394,189e3]}},{}],67:[function(e,t,r){t.exports=[["a140","",62],["a180","",32],["a240","",62],["a280","",32],["a2ab","",5],["a2e3",""],["a2ef",""],["a2fd",""],["a340","",62],["a380","",31,""],["a440","",62],["a480","",32],["a4f4","",10],["a540","",62],["a580","",32],["a5f7","",7],["a640","",62],["a680","",32],["a6b9","",7],["a6d9","",6],["a6ec",""],["a6f3",""],["a6f6","",8],["a740","",62],["a780","",32],["a7c2","",14],["a7f2","",12],["a896","",10],["a8bc",""],["a8bf",""],["a8c1",""],["a8ea","",20],["a958",""],["a95b",""],["a95d",""],["a989","",11],["a997","",12],["a9f0","",14],["aaa1","",93],["aba1","",93],["aca1","",93],["ada1","",93],["aea1","",93],["afa1","",93],["d7fa","",4],["f8a1","",93],["f9a1","",93],["faa1","",93],["fba1","",93],["fca1","",93],["fda1","",93],["fe50",""],["fe80","",6,"",93]]},{}],68:[function(e,t,r){t.exports=[["0","\0",128],["a1","",62],["8140","",9,""],["8180",""],["81b8",""],["81c8",""],["81da",""],["81f0",""],["81fc",""],["824f","",9],["8260","",25],["8281","",25],["829f","",82],["8340","",62],["8380","",22],["839f","",16,"",6],["83bf","",16,"",6],["8440","",5,"",25],["8470","",5,"",7],["8480","",17],["849f",""],["8740","",19,"",9],["875f",""],["877e",""],["8780","",4,""],["889f",""],["8940",""],["8980",""],["8a40",""],["8a80",""],["8b40",""],["8b80",""],["8c40",""],["8c80",""],["8d40",""],["8d80",""],["8e40",""],["8e80",""],["8f40",""],["8f80",""],["9040",""],["9080",""],["9140",""],["9180",""],["9240",""],["9280",""],["9340",""],["9380",""],["9440",""],["9480",""],["9540",""],["9580",""],["9640",""],["9680",""],["9740",""],["9780",""],["9840",""],["989f",""],["9940",""],["9980",""],["9a40",""],["9a80",""],["9b40",""],["9b80",""],["9c40",""],["9c80",""],["9d40",""],["9d80",""],["9e40",""],["9e80",""],["9f40",""],["9f80",""],["e040",""],["e080",""],["e140",""],["e180",""],["e240",""],["e280",""],["e340",""],["e380",""],["e440",""],["e480",""],["e540",""],["e580",""],["e640",""],["e680",""],["e740",""],["e780",""],["e840",""],["e880",""],["e940",""],["e980",""],["ea40",""],["ea80",""],["ed40",""],["ed80",""],["ee40",""],["ee80",""],["eeef","",9,""],["f040","",62],["f080","",124],["f140","",62],["f180","",124],["f240","",62],["f280","",124],["f340","",62],["f380","",124],["f440","",62],["f480","",124],["f540","",62],["f580","",124],["f640","",62],["f680","",124],["f740","",62],["f780","",124],["f840","",62],["f880","",124],["f940",""],["fa40","",9,"",9,""],["fa80",""],["fb40",""],["fb80",""],["fc40",""]]},{}],69:[function(e,t,r){"use strict";function n(){}function a(){}function i(){this.overflowByte=-1}function s(e,t){this.iconv=t}function o(e,t){e=e||{},void 0===e.addBOM&&(e.addBOM=!0),this.encoder=t.iconv.getEncoder("utf-16le",e)}function c(e,t){this.decoder=null,this.initialBytes=[],this.initialBytesLen=0,this.options=e||{},this.iconv=t.iconv}function l(e,t){var r=t||"utf-16le";if(e.length>=2)if(254==e[0]&&255==e[1])r="utf-16be";else if(255==e[0]&&254==e[1])r="utf-16le";else{for(var n=0,a=0,i=Math.min(e.length-e.length%2,64),s=0;s<i;s+=2)0===e[s]&&0!==e[s+1]&&a++,0!==e[s]&&0===e[s+1]&&n++;a>n?r="utf-16be":a<n&&(r="utf-16le")}return r}var u=e("buffer").Buffer;r.utf16be=n,n.prototype.encoder=a,n.prototype.decoder=i,n.prototype.bomAware=!0,a.prototype.write=function(e){for(var t=new u(e,"ucs2"),r=0;r<t.length;r+=2){var n=t[r];t[r]=t[r+1],t[r+1]=n}return t},a.prototype.end=function(){},i.prototype.write=function(e){if(0==e.length)return"";var t=new u(e.length+1),r=0,n=0;for(-1!==this.overflowByte&&(t[0]=e[0],t[1]=this.overflowByte,r=1,n=2);r<e.length-1;r+=2,n+=2)t[n]=e[r+1],t[n+1]=e[r];return this.overflowByte=r==e.length-1?e[e.length-1]:-1,t.slice(0,n).toString("ucs2")},i.prototype.end=function(){},r.utf16=s,s.prototype.encoder=o,s.prototype.decoder=c,o.prototype.write=function(e){return this.encoder.write(e)},o.prototype.end=function(){return this.encoder.end()},c.prototype.write=function(e){if(!this.decoder){if(this.initialBytes.push(e),this.initialBytesLen+=e.length,this.initialBytesLen<16)return"";var e=u.concat(this.initialBytes),t=l(e,this.options.defaultEncoding);this.decoder=this.iconv.getDecoder(t,this.options),this.initialBytes.length=this.initialBytesLen=0}return this.decoder.write(e)},c.prototype.end=function(){if(!this.decoder){var e=u.concat(this.initialBytes),t=l(e,this.options.defaultEncoding);this.decoder=this.iconv.getDecoder(t,this.options);var r=this.decoder.write(e),n=this.decoder.end();return n?r+n:r}return this.decoder.end()}},{buffer:void 0}],70:[function(e,t,r){"use strict";function n(e,t){this.iconv=t}function a(e,t){this.iconv=t.iconv}function i(e,t){this.iconv=t.iconv,this.inBase64=!1,this.base64Accum=""}function s(e,t){this.iconv=t}function o(e,t){this.iconv=t.iconv,this.inBase64=!1,this.base64Accum=new l(6),this.base64AccumIdx=0}function c(e,t){this.iconv=t.iconv,this.inBase64=!1,this.base64Accum=""}var l=e("buffer").Buffer;r.utf7=n,r.unicode11utf7="utf7",n.prototype.encoder=a,n.prototype.decoder=i,n.prototype.bomAware=!0;var u=/[^A-Za-z0-9'\(\),-\.\/:\? \n\r\t]+/g;a.prototype.write=function(e){return new l(e.replace(u,function(e){return"+"+("+"===e?"":this.iconv.encode(e,"utf16-be").toString("base64").replace(/=+$/,""))+"-"}.bind(this)))},a.prototype.end=function(){};for(var f=/[A-Za-z0-9\/+]/,$=[],p=0;p<256;p++)$[p]=f.test(String.fromCharCode(p));var d="+".charCodeAt(0),h="-".charCodeAt(0),_="&".charCodeAt(0);i.prototype.write=function(e){for(var t="",r=0,n=this.inBase64,a=this.base64Accum,i=0;i<e.length;i++)if(n){if(!$[e[i]]){if(i==r&&e[i]==h)t+="+";else{var s=a+e.slice(r,i).toString();t+=this.iconv.decode(new l(s,"base64"),"utf16-be")}e[i]!=h&&i--,r=i+1,n=!1,a=""}}else e[i]==d&&(t+=this.iconv.decode(e.slice(r,i),"ascii"),r=i+1,n=!0);if(n){var s=a+e.slice(r).toString(),o=s.length-s.length%8;a=s.slice(o),s=s.slice(0,o),t+=this.iconv.decode(new l(s,"base64"),"utf16-be")}else t+=this.iconv.decode(e.slice(r),"ascii");return this.inBase64=n,this.base64Accum=a,t},i.prototype.end=function(){var e="";return this.inBase64&&this.base64Accum.length>0&&(e=this.iconv.decode(new l(this.base64Accum,"base64"),"utf16-be")),this.inBase64=!1,this.base64Accum="",e},r.utf7imap=s,s.prototype.encoder=o,s.prototype.decoder=c,s.prototype.bomAware=!0,o.prototype.write=function(e){for(var t=this.inBase64,r=this.base64Accum,n=this.base64AccumIdx,a=new l(5*e.length+10),i=0,s=0;s<e.length;s++){var o=e.charCodeAt(s);32<=o&&o<=126?(t&&(n>0&&(i+=a.write(r.slice(0,n).toString("base64").replace(/\//g,",").replace(/=+$/,""),i),n=0),a[i++]=h,t=!1),t||(a[i++]=o,o===_&&(a[i++]=h))):(t||(a[i++]=_,t=!0),t&&(r[n++]=o>>8,r[n++]=255&o,n==r.length&&(i+=a.write(r.toString("base64").replace(/\//g,","),i),n=0)))}return this.inBase64=t,this.base64AccumIdx=n,a.slice(0,i)},o.prototype.end=function(){var e=new l(10),t=0;return this.inBase64&&(this.base64AccumIdx>0&&(t+=e.write(this.base64Accum.slice(0,this.base64AccumIdx).toString("base64").replace(/\//g,",").replace(/=+$/,""),t),this.base64AccumIdx=0),e[t++]=h,this.inBase64=!1),e.slice(0,t)};var m=$.slice();m[",".charCodeAt(0)]=!0,c.prototype.write=function(e){for(var t="",r=0,n=this.inBase64,a=this.base64Accum,i=0;i<e.length;i++)if(n){if(!m[e[i]]){if(i==r&&e[i]==h)t+="&";else{var s=a+e.slice(r,i).toString().replace(/,/g,"/");t+=this.iconv.decode(new l(s,"base64"),"utf16-be")}e[i]!=h&&i--,r=i+1,n=!1,a=""}}else e[i]==_&&(t+=this.iconv.decode(e.slice(r,i),"ascii"),r=i+1,n=!0);if(n){var s=a+e.slice(r).toString().replace(/,/g,"/"),o=s.length-s.length%8;a=s.slice(o),s=s.slice(0,o),t+=this.iconv.decode(new l(s,"base64"),"utf16-be")}else t+=this.iconv.decode(e.slice(r),"ascii");return this.inBase64=n,this.base64Accum=a,t},c.prototype.end=function(){var e="";return this.inBase64&&this.base64Accum.length>0&&(e=this.iconv.decode(new l(this.base64Accum,"base64"),"utf16-be")),this.inBase64=!1,this.base64Accum="",e}},{buffer:void 0}],71:[function(e,t,r){"use strict";function n(e,t){this.encoder=e,this.addBOM=!0}function a(e,t){this.decoder=e,this.pass=!1,this.options=t||{}}r.PrependBOM=n,n.prototype.write=function(e){return this.addBOM&&(e="\ufeff"+e,this.addBOM=!1),this.encoder.write(e)},n.prototype.end=function(){return this.encoder.end()},r.StripBOM=a,a.prototype.write=function(e){var t=this.decoder.write(e);return this.pass||!t?t:("\ufeff"===t[0]&&(t=t.slice(1),"function"==typeof this.options.stripBOM&&this.options.stripBOM()),this.pass=!0,t)},a.prototype.end=function(){return this.decoder.end()}},{}],72:[function(e,t,r){"use strict";var n=e("buffer").Buffer;t.exports=function(t){var r=void 0;t.supportsNodeEncodingsExtension=!(new n(0)instanceof Uint8Array),t.extendNodeEncodings=function(){if(!r){if(r={},!t.supportsNodeEncodingsExtension)return console.error("ACTION NEEDED: require('iconv-lite').extendNodeEncodings() is not supported in your version of Node"),void console.error("See more info at https://github.com/ashtuchkin/iconv-lite/wiki/Node-v4-compatibility");var a={hex:!0,utf8:!0,"utf-8":!0,ascii:!0,binary:!0,base64:!0,ucs2:!0,"ucs-2":!0,utf16le:!0,"utf-16le":!0};n.isNativeEncoding=function(e){return e&&a[e.toLowerCase()]};var i=e("buffer").SlowBuffer;if(r.SlowBufferToString=i.prototype.toString,i.prototype.toString=function(e,a,i){return e=String(e||"utf8").toLowerCase(),n.isNativeEncoding(e)?r.SlowBufferToString.call(this,e,a,i):(void 0===a&&(a=0),void 0===i&&(i=this.length),t.decode(this.slice(a,i),e))},r.SlowBufferWrite=i.prototype.write,i.prototype.write=function(e,a,i,s){if(isFinite(a))isFinite(i)||(s=i,i=void 0);else{var o=s;s=a,a=i,i=o}a=+a||0;var c=this.length-a;if(i?(i=+i)>c&&(i=c):i=c,s=String(s||"utf8").toLowerCase(),n.isNativeEncoding(s))return r.SlowBufferWrite.call(this,e,a,i,s);if(e.length>0&&(i<0||a<0))throw new RangeError("attempt to write beyond buffer bounds");var l=t.encode(e,s);return l.length<i&&(i=l.length),l.copy(this,a,0,i),i},r.BufferIsEncoding=n.isEncoding,n.isEncoding=function(e){return n.isNativeEncoding(e)||t.encodingExists(e)},r.BufferByteLength=n.byteLength,n.byteLength=i.byteLength=function(e,a){return a=String(a||"utf8").toLowerCase(),n.isNativeEncoding(a)?r.BufferByteLength.call(this,e,a):t.encode(e,a).length},r.BufferToString=n.prototype.toString,n.prototype.toString=function(e,a,i){return e=String(e||"utf8").toLowerCase(),n.isNativeEncoding(e)?r.BufferToString.call(this,e,a,i):(void 0===a&&(a=0),void 0===i&&(i=this.length),t.decode(this.slice(a,i),e))},r.BufferWrite=n.prototype.write,n.prototype.write=function(e,a,i,s){var o=a,c=i,l=s;if(isFinite(a))isFinite(i)||(s=i,i=void 0);else{var u=s;s=a,a=i,i=u}if(s=String(s||"utf8").toLowerCase(),n.isNativeEncoding(s))return r.BufferWrite.call(this,e,o,c,l);a=+a||0;var f=this.length-a;if(i?(i=+i)>f&&(i=f):i=f,e.length>0&&(i<0||a<0))throw new RangeError("attempt to write beyond buffer bounds");var $=t.encode(e,s);return $.length<i&&(i=$.length),$.copy(this,a,0,i),i},t.supportsStreams){var s=e("stream").Readable;r.ReadableSetEncoding=s.prototype.setEncoding,s.prototype.setEncoding=function(e,r){this._readableState.decoder=t.getDecoder(e,r),this._readableState.encoding=e},s.prototype.collect=t._collect}}},t.undoExtendNodeEncodings=function(){if(t.supportsNodeEncodingsExtension){if(!r)throw new Error("require('iconv-lite').undoExtendNodeEncodings(): Nothing to undo; extendNodeEncodings() is not called.");delete n.isNativeEncoding;var a=e("buffer").SlowBuffer;if(a.prototype.toString=r.SlowBufferToString,a.prototype.write=r.SlowBufferWrite,n.isEncoding=r.BufferIsEncoding,n.byteLength=r.BufferByteLength,n.prototype.toString=r.BufferToString,n.prototype.write=r.BufferWrite,t.supportsStreams){var i=e("stream").Readable;i.prototype.setEncoding=r.ReadableSetEncoding,delete i.prototype.collect}r=void 0}}}},{buffer:void 0,stream:void 0}],73:[function(e,t,r){"use strict";var n=e("buffer").Buffer,a=e("./bom-handling"),i=t.exports;i.encodings=null,i.defaultCharUnicode="",i.defaultCharSingleByte="?",i.encode=function(e,t,r){e=""+(e||"");var a=i.getEncoder(t,r),s=a.write(e),o=a.end();return o&&o.length>0?n.concat([s,o]):s},i.decode=function(e,t,r){"string"==typeof e&&(i.skipDecodeWarning||(console.error("Iconv-lite warning: decode()-ing strings is deprecated. Refer to https://github.com/ashtuchkin/iconv-lite/wiki/Use-Buffers-when-decoding"),i.skipDecodeWarning=!0),e=new n(""+(e||""),"binary"));var a=i.getDecoder(t,r),s=a.write(e),o=a.end();return o?s+o:s},i.encodingExists=function(e){try{return i.getCodec(e),!0}catch(e){return!1}},i.toEncoding=i.encode,i.fromEncoding=i.decode,i._codecDataCache={},i.getCodec=function(t){i.encodings||(i.encodings=e("../encodings"));for(var r=(""+t).toLowerCase().replace(/[^0-9a-z]|:\d{4}$/g,""),n={};;){var a=i._codecDataCache[r];if(a)return a;var s=i.encodings[r];switch(typeof s){case"string":r=s;break;case"object":for(var o in s)n[o]=s[o];n.encodingName||(n.encodingName=r),r=s.type;break;case"function":return n.encodingName||(n.encodingName=r),a=new s(n,i),i._codecDataCache[n.encodingName]=a,a;default:throw new Error("Encoding not recognized: '"+t+"' (searched as: '"+r+"')")}}},i.getEncoder=function(e,t){var r=i.getCodec(e),n=new r.encoder(t,r);return r.bomAware&&t&&t.addBOM&&(n=new a.PrependBOM(n,t)),n},i.getDecoder=function(e,t){var r=i.getCodec(e),n=new r.decoder(t,r);return!r.bomAware||t&&!1===t.stripBOM||(n=new a.StripBOM(n,t)),n};var s="undefined"!=typeof process&&process.versions&&process.versions.node;if(s){var o=s.split(".").map(Number);(o[0]>0||o[1]>=10)&&e("./streams")(i),e("./extend-node")(i)}},{"../encodings":56,"./bom-handling":71,"./extend-node":72,"./streams":74,buffer:void 0}],74:[function(e,t,r){"use strict";function n(e,t){this.conv=e,t=t||{},t.decodeStrings=!1,s.call(this,t)}function a(e,t){this.conv=e,t=t||{},t.encoding=this.encoding="utf8",s.call(this,t)}var i=e("buffer").Buffer,s=e("stream").Transform;t.exports=function(e){e.encodeStream=function(t,r){return new n(e.getEncoder(t,r),r)},e.decodeStream=function(t,r){return new a(e.getDecoder(t,r),r)},e.supportsStreams=!0,e.IconvLiteEncoderStream=n,e.IconvLiteDecoderStream=a,e._collect=a.prototype.collect},n.prototype=Object.create(s.prototype,{constructor:{value:n}}),n.prototype._transform=function(e,t,r){if("string"!=typeof e)return r(new Error("Iconv encoding stream needs strings as its input."));try{var n=this.conv.write(e);n&&n.length&&this.push(n),r()}catch(e){r(e)}},n.prototype._flush=function(e){try{var t=this.conv.end();t&&t.length&&this.push(t),e()}catch(t){e(t)}},n.prototype.collect=function(e){var t=[];return this.on("error",e),this.on("data",function(e){t.push(e)}),this.on("end",function(){e(null,i.concat(t))}),this},a.prototype=Object.create(s.prototype,{constructor:{value:a}}),a.prototype._transform=function(e,t,r){if(!i.isBuffer(e))return r(new Error("Iconv decoding stream needs buffers as its input."));try{var n=this.conv.write(e);n&&n.length&&this.push(n,this.encoding),r()}catch(e){r(e)}},a.prototype._flush=function(e){try{var t=this.conv.end();t&&t.length&&this.push(t,this.encoding),e()}catch(t){e(t)}},a.prototype.collect=function(e){var t="";return this.on("error",e),this.on("data",function(e){t+=e}),this.on("end",function(){e(null,t)}),this}},{buffer:void 0,stream:void 0}],75:[function(e,t,r){function n(e,t){return o[e]?(o[e].push(t),null):(o[e]=[t],a(e))}function a(e){return c(function t(){var r=o[e],n=r.length,a=i(arguments);try{for(var s=0;s<n;s++)r[s].apply(null,a)}finally{r.length>n?(r.splice(0,n),process.nextTick(function(){t.apply(null,a)})):delete o[e]}})}function i(e){for(var t=e.length,r=[],n=0;n<t;n++)r[n]=e[n];return r}var s=e("wrappy"),o=Object.create(null),c=e("once");t.exports=s(n)},{once:83,wrappy:85}],76:[function(e,t,r){try{var n=e("util");if("function"!=typeof n.inherits)throw"";t.exports=n.inherits}catch(r){t.exports=e("./inherits_browser.js")}},{"./inherits_browser.js":77,util:void 0}],77:[function(e,t,r){"function"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}},{}],78:[function(e,t,r){var n="undefined"!=typeof JSON?JSON:e("jsonify");t.exports=function(e,t){t||(t={}),"function"==typeof t&&(t={cmp:t});var r=t.space||"";"number"==typeof r&&(r=Array(r+1).join(" "));var s="boolean"==typeof t.cycles&&t.cycles,o=t.replacer||function(e,t){return t},c=t.cmp&&function(e){return function(t){return function(r,n){var a={key:r,value:t[r]},i={key:n,value:t[n]};return e(a,i)}}}(t.cmp),l=[];return function e(t,u,f,$){var p=r?"\n"+new Array($+1).join(r):"",d=r?": ":":";if(f&&f.toJSON&&"function"==typeof f.toJSON&&(f=f.toJSON()),void 0!==(f=o.call(t,u,f))){if("object"!=typeof f||null===f)return n.stringify(f);if(a(f)){for(var h=[],_=0;_<f.length;_++){var m=e(f,_,f[_],$+1)||n.stringify(null);h.push(p+r+m)}return"["+h.join(",")+p+"]"}if(-1!==l.indexOf(f)){if(s)return n.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}l.push(f);for(var y=i(f).sort(c&&c(f)),h=[],_=0;_<y.length;_++){var u=y[_],g=e(f,u,f[u],$+1);if(g){var v=n.stringify(u)+d+g;h.push(p+r+v)}}return l.splice(l.indexOf(f),1),"{"+h.join(",")+p+"}"}}({"":e},"",e,0)};var a=Array.isArray||function(e){return"[object Array]"==={}.toString.call(e)},i=Object.keys||function(e){var t=Object.prototype.hasOwnProperty||function(){return!0},r=[];for(var n in e)t.call(e,n)&&r.push(n);return r}},{jsonify:79}],79:[function(e,t,r){r.parse=e("./lib/parse"),r.stringify=e("./lib/stringify")},{"./lib/parse":80,"./lib/stringify":81}],80:[function(e,t,r){var n,a,i,s,o={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},c=function(e){throw{name:"SyntaxError",message:e,at:n,text:i}},l=function(e){return e&&e!==a&&c("Expected '"+e+"' instead of '"+a+"'"),a=i.charAt(n),n+=1,a},u=function(){var e,t="";for("-"===a&&(t="-",l("-"));a>="0"&&a<="9";)t+=a,l();if("."===a)for(t+=".";l()&&a>="0"&&a<="9";)t+=a;if("e"===a||"E"===a)for(t+=a,l(),"-"!==a&&"+"!==a||(t+=a,l());a>="0"&&a<="9";)t+=a,l();if(e=+t,isFinite(e))return e;c("Bad number")},f=function(){var e,t,r,n="";if('"'===a)for(;l();){if('"'===a)return l(),n;if("\\"===a)if(l(),"u"===a){for(r=0,t=0;t<4&&(e=parseInt(l(),16),isFinite(e));t+=1)r=16*r+e;n+=String.fromCharCode(r)}else{if("string"!=typeof o[a])break;n+=o[a]}else n+=a}c("Bad string")},$=function(){for(;a&&a<=" ";)l()},p=function(){switch(a){case"t":return l("t"),l("r"),l("u"),l("e"),!0;case"f":return l("f"),l("a"),l("l"),l("s"),l("e"),!1;case"n":return l("n"),l("u"),l("l"),l("l"),null}c("Unexpected '"+a+"'")},d=function(){var e=[];if("["===a){if(l("["),$(),"]"===a)return l("]"),e;for(;a;){if(e.push(s()),$(),"]"===a)return l("]"),e;l(","),$()}}c("Bad array")},h=function(){var e,t={};if("{"===a){if(l("{"),$(),"}"===a)return l("}"),t;for(;a;){if(e=f(),$(),l(":"),Object.hasOwnProperty.call(t,e)&&c('Duplicate key "'+e+'"'),t[e]=s(),$(),"}"===a)return l("}"),t;l(","),$()}}c("Bad object")};s=function(){switch($(),a){case"{":return h();case"[":return d();case'"':return f();case"-":return u();default:return a>="0"&&a<="9"?u():p()}},t.exports=function(e,t){var r;return i=e,n=0,a=" ",r=s(),$(),a&&c("Syntax error"),"function"==typeof t?function e(r,n){var a,i,s=r[n];if(s&&"object"==typeof s)for(a in s)Object.prototype.hasOwnProperty.call(s,a)&&(i=e(s,a),void 0!==i?s[a]=i:delete s[a]);return t.call(r,n,s)}({"":r},""):r}},{}],81:[function(e,t,r){function n(e){return c.lastIndex=0,c.test(e)?'"'+e.replace(c,function(e){var t=l[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function a(e,t){var r,c,l,u,f,$=i,p=t[e];switch(p&&"object"==typeof p&&"function"==typeof p.toJSON&&(p=p.toJSON(e)),"function"==typeof o&&(p=o.call(t,e,p)),typeof p){case"string":return n(p);case"number":return isFinite(p)?String(p):"null";case"boolean":case"null":return String(p);case"object":if(!p)return"null";if(i+=s,f=[],"[object Array]"===Object.prototype.toString.apply(p)){for(u=p.length,r=0;r<u;r+=1)f[r]=a(r,p)||"null";return l=0===f.length?"[]":i?"[\n"+i+f.join(",\n"+i)+"\n"+$+"]":"["+f.join(",")+"]",i=$,l}if(o&&"object"==typeof o)for(u=o.length,r=0;r<u;r+=1)"string"==typeof(c=o[r])&&(l=a(c,p))&&f.push(n(c)+(i?": ":":")+l);else for(c in p)Object.prototype.hasOwnProperty.call(p,c)&&(l=a(c,p))&&f.push(n(c)+(i?": ":":")+l);return l=0===f.length?"{}":i?"{\n"+i+f.join(",\n"+i)+"\n"+$+"}":"{"+f.join(",")+"}",i=$,l}}var i,s,o,c=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,l={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};t.exports=function(e,t,r){var n;if(i="",s="","number"==typeof r)for(n=0;n<r;n+=1)s+=" ";else"string"==typeof r&&(s=r);if(o=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return a("",{"":e})}},{}],82:[function(e,t,r){function n(e,t){return t=t||{},function(r,n,a){return i(r,e,t)}}function a(e,t){e=e||{},t=t||{};var r={};return Object.keys(t).forEach(function(e){r[e]=t[e]}),Object.keys(e).forEach(function(t){r[t]=e[t]}),r}function i(e,t,r){if("string"!=typeof t)throw new TypeError("glob pattern string required");return r||(r={}),!(!r.nocomment&&"#"===t.charAt(0))&&(""===t.trim()?""===e:new s(t,r).match(e))}function s(e,t){if(!(this instanceof s))return new s(e,t);if("string"!=typeof e)throw new TypeError("glob pattern string required");t||(t={}),e=e.trim(),"/"!==h.sep&&(e=e.split(h.sep).join("/")),this.options=t,this.set=[],this.pattern=e,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.make()}function o(){if(!this._made){var e=this.pattern,t=this.options;if(!t.nocomment&&"#"===e.charAt(0))return void(this.comment=!0);if(!e)return void(this.empty=!0);this.parseNegate();var r=this.globSet=this.braceExpand();t.debug&&(this.debug=console.error),this.debug(this.pattern,r),r=this.globParts=r.map(function(e){return e.split(A)}),this.debug(this.pattern,r),r=r.map(function(e,t,r){return e.map(this.parse,this)},this),this.debug(this.pattern,r),r=r.filter(function(e){return-1===e.indexOf(!1)}),this.debug(this.pattern,r),this.set=r}}function c(){var e=this.pattern,t=!1,r=this.options,n=0;if(!r.nonegate){for(var a=0,i=e.length;a<i&&"!"===e.charAt(a);a++)t=!t,n++;n&&(this.pattern=e.substr(n)),this.negate=t}}function l(e,t){
if(t||(t=this instanceof s?this.options:{}),void 0===(e=void 0===e?this.pattern:e))throw new TypeError("undefined pattern");return t.nobrace||!e.match(/\{.*\}/)?[e]:m(e)}function u(e,t){function r(){if(a){switch(a){case"*":s+=v,o=!0;break;case"?":s+=g,o=!0;break;default:s+="\\"+a}m.debug("clearStateChar %j %j",a,s),a=!1}}if(e.length>65536)throw new TypeError("pattern is too long");var n=this.options;if(!n.noglobstar&&"**"===e)return _;if(""===e)return"";for(var a,i,s="",o=!!n.nocase,c=!1,l=[],u=[],f=!1,$=-1,d=-1,h="."===e.charAt(0)?"":n.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",m=this,b=0,x=e.length;b<x&&(i=e.charAt(b));b++)if(this.debug("%s\t%s %s %j",e,b,s,i),c&&w[i])s+="\\"+i,c=!1;else switch(i){case"/":return!1;case"\\":r(),c=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s\t%s %s %j <-- stateChar",e,b,s,i),f){this.debug("  in class"),"!"===i&&b===d+1&&(i="^"),s+=i;continue}m.debug("call clearStateChar %j",a),r(),a=i,n.noext&&r();continue;case"(":if(f){s+="(";continue}if(!a){s+="\\(";continue}l.push({type:a,start:b-1,reStart:s.length,open:y[a].open,close:y[a].close}),s+="!"===a?"(?:(?!(?:":"(?:",this.debug("plType %j %j",a,s),a=!1;continue;case")":if(f||!l.length){s+="\\)";continue}r(),o=!0;var A=l.pop();s+=A.close,"!"===A.type&&u.push(A),A.reEnd=s.length;continue;case"|":if(f||!l.length||c){s+="\\|",c=!1;continue}r(),s+="|";continue;case"[":if(r(),f){s+="\\"+i;continue}f=!0,d=b,$=s.length,s+=i;continue;case"]":if(b===d+1||!f){s+="\\"+i,c=!1;continue}if(f){var E=e.substring(d+1,b);try{RegExp("["+E+"]")}catch(e){var S=this.parse(E,k);s=s.substr(0,$)+"\\["+S[0]+"\\]",o=o||S[1],f=!1;continue}}o=!0,f=!1,s+=i;continue;default:r(),c?c=!1:!w[i]||"^"===i&&f||(s+="\\"),s+=i}for(f&&(E=e.substr(d+1),S=this.parse(E,k),s=s.substr(0,$)+"\\["+S[0],o=o||S[1]),A=l.pop();A;A=l.pop()){var N=s.slice(A.reStart+A.open.length);this.debug("setting tail",s,A),N=N.replace(/((?:\\{2}){0,64})(\\?)\|/g,function(e,t,r){return r||(r="\\"),t+t+r+"|"}),this.debug("tail=%j\n   %s",N,N,A,s);var C="*"===A.type?v:"?"===A.type?g:"\\"+A.type;o=!0,s=s.slice(0,A.reStart)+C+"\\("+N}r(),c&&(s+="\\\\");var I=!1;switch(s.charAt(0)){case".":case"[":case"(":I=!0}for(var O=u.length-1;O>-1;O--){var L=u[O],P=s.slice(0,L.reStart),M=s.slice(L.reStart,L.reEnd-8),T=s.slice(L.reEnd-8,L.reEnd),B=s.slice(L.reEnd);T+=B;var j=P.split("(").length-1,F=B;for(b=0;b<j;b++)F=F.replace(/\)[+*?]?/,"");B=F;var R="";""===B&&t!==k&&(R="$");s=P+M+B+R+T}if(""!==s&&o&&(s="(?=.)"+s),I&&(s=h+s),t===k)return[s,o];if(!o)return p(e);var D=n.nocase?"i":"";try{var z=new RegExp("^"+s+"$",D)}catch(e){return new RegExp("$.")}return z._glob=e,z._src=s,z}function f(){if(this.regexp||!1===this.regexp)return this.regexp;var e=this.set;if(!e.length)return this.regexp=!1,this.regexp;var t=this.options,r=t.noglobstar?v:t.dot?b:x,n=t.nocase?"i":"",a=e.map(function(e){return e.map(function(e){return e===_?r:"string"==typeof e?d(e):e._src}).join("\\/")}).join("|");a="^(?:"+a+")$",this.negate&&(a="^(?!"+a+").*$");try{this.regexp=new RegExp(a,n)}catch(e){this.regexp=!1}return this.regexp}function $(e,t){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return""===e;if("/"===e&&t)return!0;var r=this.options;"/"!==h.sep&&(e=e.split(h.sep).join("/")),e=e.split(A),this.debug(this.pattern,"split",e);var n=this.set;this.debug(this.pattern,"set",n);var a,i;for(i=e.length-1;i>=0&&!(a=e[i]);i--);for(i=0;i<n.length;i++){var s=n[i],o=e;r.matchBase&&1===s.length&&(o=[a]);if(this.matchOne(o,s,t))return!!r.flipNegate||!this.negate}return!r.flipNegate&&this.negate}function p(e){return e.replace(/\\(.)/g,"$1")}function d(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}t.exports=i,i.Minimatch=s;var h={sep:"/"};try{h=e("path")}catch(e){}var _=i.GLOBSTAR=s.GLOBSTAR={},m=e("brace-expansion"),y={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},g="[^/]",v=g+"*?",b="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",x="(?:(?!(?:\\/|^)\\.).)*?",w=function(e){return e.split("").reduce(function(e,t){return e[t]=!0,e},{})}("().*{}+?[]^$\\!"),A=/\/+/;i.filter=n,i.defaults=function(e){if(!e||!Object.keys(e).length)return i;var t=i,r=function(r,n,i){return t.minimatch(r,n,a(e,i))};return r.Minimatch=function(r,n){return new t.Minimatch(r,a(e,n))},r},s.defaults=function(e){return e&&Object.keys(e).length?i.defaults(e).Minimatch:s},s.prototype.debug=function(){},s.prototype.make=o,s.prototype.parseNegate=c,i.braceExpand=function(e,t){return l(e,t)},s.prototype.braceExpand=l,s.prototype.parse=u;var k={};i.makeRe=function(e,t){return new s(e,t||{}).makeRe()},s.prototype.makeRe=f,i.match=function(e,t,r){r=r||{};var n=new s(t,r);return e=e.filter(function(e){return n.match(e)}),n.options.nonull&&!e.length&&e.push(t),e},s.prototype.match=$,s.prototype.matchOne=function(e,t,r){var n=this.options;this.debug("matchOne",{this:this,file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var a=0,i=0,s=e.length,o=t.length;a<s&&i<o;a++,i++){this.debug("matchOne loop");var c=t[i],l=e[a];if(this.debug(t,c,l),!1===c)return!1;if(c===_){this.debug("GLOBSTAR",[t,c,l]);var u=a,f=i+1;if(f===o){for(this.debug("** at the end");a<s;a++)if("."===e[a]||".."===e[a]||!n.dot&&"."===e[a].charAt(0))return!1;return!0}for(;u<s;){var $=e[u];if(this.debug("\nglobstar while",e,u,t,f,$),this.matchOne(e.slice(u),t.slice(f),r))return this.debug("globstar found match!",u,s,$),!0;if("."===$||".."===$||!n.dot&&"."===$.charAt(0)){this.debug("dot detected!",e,u,t,f);break}this.debug("globstar swallow a segment, and continue"),u++}return!(!r||(this.debug("\n>>> no match, partial?",e,u,t,f),u!==s))}var p;if("string"==typeof c?(p=n.nocase?l.toLowerCase()===c.toLowerCase():l===c,this.debug("string match",c,l,p)):(p=l.match(c),this.debug("pattern match",c,l,p)),!p)return!1}if(a===s&&i===o)return!0;if(a===s)return r;if(i===o){return a===s-1&&""===e[a]}throw new Error("wtf?")}},{"brace-expansion":44,path:void 0}],83:[function(e,t,r){function n(e){var t=function(){return t.called?t.value:(t.called=!0,t.value=e.apply(this,arguments))};return t.called=!1,t}function a(e){var t=function(){if(t.called)throw new Error(t.onceError);return t.called=!0,t.value=e.apply(this,arguments)},r=e.name||"Function wrapped with `once`";return t.onceError=r+" shouldn't be called more than once",t.called=!1,t}var i=e("wrappy");t.exports=i(n),t.exports.strict=i(a),n.proto=n(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return n(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return a(this)},configurable:!0})})},{wrappy:85}],84:[function(e,t,r){"use strict";function n(e){return"/"===e.charAt(0)}function a(e){var t=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/,r=t.exec(e),n=r[1]||"",a=Boolean(n&&":"!==n.charAt(1));return Boolean(r[2]||a)}t.exports="win32"===process.platform?a:n,t.exports.posix=n,t.exports.win32=a},{}],85:[function(e,t,r){function n(e,t){function r(){for(var t=new Array(arguments.length),r=0;r<t.length;r++)t[r]=arguments[r];var n=e.apply(this,t),a=t[t.length-1];return"function"==typeof n&&n!==a&&Object.keys(a).forEach(function(e){n[e]=a[e]}),n}if(e&&t)return n(e)(t);if("function"!=typeof e)throw new TypeError("need wrapper function");return Object.keys(e).forEach(function(t){r[t]=e[t]}),r}t.exports=n},{}],86:[function(require,module,exports){function AbcJSON(e){var t=Array((e||2)+1).join(" ");AbcJSON.prototype.gen_json=function(e,r,n,a){function i(e,r,n){var a,o,l=e+t;if(h[r]){if("extra"==r){for(s+=f+e+'"extra": [',f="\n",o=n;o;o=o.next)i(l,null,o);s+="\n"+e+"]"}}else{switch(s+=f+e,r&&(s+='"'+r.toString()+'": '),typeof n){case"undefined":s+="null";break;case"object":if(!n){s+="null";break}if(Array.isArray(n)){if(0==n.length){s+="[]";break}for(f="[\n",c=n.length,a=0;a<c;a++)i(l,null,n[a]);s+="\n"+e+"]"}else{f="{\n";for(a in n)n.hasOwnProperty(a)&&i(l,a,n[a]);s+="\n"+e+"}"}break;default:s+=JSON.stringify(n)}f=",\n"}}var s,o,c,l,u,f,$=t+t,p=$+t,d=p+t,h={next:!0,prev:!0,ts_next:!0,ts_prev:!0,extra:!0,p_v:!0,dd_st:!0};for(s="",f="{\n",i(t,"music_types",n),f=",\n"+t+'"music_type_ids": {\n',c=n.length,o=0;o<c;o++)n[o]&&(s+=f+$+'"'+n[o]+'": '+o,f=",\n");for(f="\n"+t+"},\n",i(t,"info",a),s+=",\n"+t+'"voices": [',l=0,f="\n";;){f+=$+"{\n"+p+'"voice_properties": {\n';for(o in r[l])r[l].hasOwnProperty(o)&&i(d,o,r[l][o]);if(s+="\n"+p+"},\n"+p+'"symbols": [',u=r[l].sym){for(f="\n";u;u=u.next)i(d,null,u);s+="\n"+p+"]\n"+$+"}"}else s+="]\n"+p+"}";if(f=",\n",!r[++l])break}return s+"\n"+t+"]\n}\n"}}function AbcMIDI(){var e=abc2svg.C;AbcMIDI.prototype.add=function(t,r){function n(){for(var e=0;e<10;e++)for(var t=0;t<7;t++)f[7*e+t]=u[t]}function a(e){for(var t=0;t<7;t++)u[t]=0;switch(e.k_sf){case 7:u[6]=1;case 6:u[2]=1;case 5:u[5]=1;case 4:u[1]=1;case 3:u[4]=1;case 2:u[0]=1;case 1:u[3]=1;break;case-7:u[3]=-1;case-6:u[0]=-1;case-5:u[4]=-1;case-4:u[1]=-1;case-3:u[5]=-1;case-2:u[2]=-1;case-1:u[6]=-1}n()}function i(e,t){return t&&(f[e]=3==t?0:t),12*(e/7|0)+l[e%7]+(s[e]||f[e])}var s,o,c,l=new Int8Array([0,2,4,5,7,9,11]),u=new Int8Array(7),f=new Int8Array(70);for(o=0;o<r.length;o++)r[o].sym&&(t=r[o].clef,c=!t.clef_octave||t.clef_oct_transp?0:t.clef_octave,a(r[o].key),function(t){var o,l,u,$,p=r[t].sym,d=p.time,h=[],_=[];for(s=[];p;){switch(p.time>d&&(n(),d=p.time),p.dur&&(d=p.time+p.dur),p.type){case e.BAR:if(p.text)if("1"==p.text[0])for(_=[],rep_tie_time=[],o=0;o<s.length;o++)_[o]=s[o];else if(0!=_.length)for(s=[],h=[],o=0;o<_.length;o++)s[o]=_[o],h[o]=p.time;p.invis||n();break;case e.CLEF:c=!p.clef_octave||p.clef_oct_transp?0:p.clef_octave;break;case e.GRACE:for(l=p.extra;l;l=l.next)if(!l.type==e.NOTE)for(o=0;o<=l.nhd;o++)$=l.notes[o],u=$.apit+19+c,$.midi=i(u,$.acc);break;case e.KEY:a(p);break;case e.NOTE:for(o=0;o<=p.nhd;o++)$=p.notes[o],u=$.apit+19+c,s[u]&&p.time>h[u]&&(delete s[u],delete h[u]),$.midi=i(u,$.acc),$.ti1&&(s[u]=f[u],h[u]=p.time+p.dur)}p=p.next}}(o))}}function AbcPlay(e){function t(){}function r(e,t,r){var a,i=l.get_outputs();if(1==i.length)a=0;else{a=-1;var s=window.prompt("Use \n0: "+i[0]+"\n1: "+i[1]+"?","0");if(s&&(a=Number(s),(isNaN(a)||a<0||a>=i.length)&&(a=-1)),!s||a<0)return void(o.onend&&o.onend())}n(i[a]),l.play(e,t,r)}function n(e){(s="sf2"==e?a:i)&&(l.play=s.play,l.stop=s.stop,s.set_output&&s.set_output(e))}var a,i,s,o=e,c=ToAudio(),l={get_outputs:function(){var e,t=[];return i&&(e=i.get_outputs())&&(t=e),a&&(e=a.get_outputs())&&(t=t.concat(e)),t},set_output:n,clear:c.clear,add:c.add,set_sft:t,set_sfu:function(e){if(void 0==e)return o.sfu;o.sfu=e},set_speed:function(e){if(void 0==e)return o.speed;o.new_speed=e},set_vol:function(e){if(void 0==e)return o.gain;o.gain=e,s&&s.set_vol&&s.set_vol(e)},play:r,stop:t};return o.gain=.7,o.speed=1,function(){try{if(!localStorage)return}catch(e){return}var e=localStorage.getItem("sfu");e&&(o.sfu=e),(e=localStorage.getItem("volume"))&&(o.gain=Number(e))}(),"function"==typeof Midi5&&(i=Midi5(o)),"function"==typeof Audio5&&(a=Audio5(o)),l}function ToAudio(){var e,t,r,n,a=abc2svg.C,i=new Uint8Array([0,2,4,5,7,9,11]);return{clear:function(){var t=e;return e=null,t},add:function(s,o){function c(){var e,t,r,n;for(d=o[0].temper,S=new Int8Array(o.length),e=0;e<o.length;e++)t=o[e],n=t.instr||0,t.midictl&&(t.midictl[32]&&(n+=128*t.midictl[32]),t.midictl[0]&&(n+=128*t.midictl[0]*128)),I[e]=n,r=t.clef,S[e]=!r.clef_octave||r.clef_oct_transp?0:r.clef_octave,N[e]=new Float32Array(70),C[e]=new Float32Array(70),t.key.v=e,l(t.key)}function l(e){var t,r;if(e.k_bagpipe)r=new Float32Array([2.37,1.49,1.53,2.35,1.19,1.51,1.55]);else switch(r=new Float32Array(7),e.k_sf){case 7:r[6]=1;case 6:r[2]=1;case 5:r[5]=1;case 4:r[1]=1;case 3:r[4]=1;case 2:r[0]=1;case 1:r[3]=1;break;case-7:r[3]=-1;case-6:r[0]=-1;case-5:r[4]=-1;case-4:r[1]=-1;case-3:r[5]=-1;case-2:r[2]=-1;case-1:r[6]=-1}for(t=0;t<10;t++)N[e.v].set(r,7*t);C[e.v].set(N[e.v])}function u(e,t){var r=e.notes[t],n=r.apit+19,a=r.acc;return S[e.v]&&(n+=S[e.v]),a?(3==a?a=0:r.micro_n&&(a=(a<0?-r.micro_n:r.micro_n)/r.micro_d*2),p[n]=a):a=p[n],n=12*(n/7|0)+i[n%7]+a,!d||a|0!=a?n:n+d[n%12]}function f(e,t,r){var i,s=e.time+e.dur,o=t.apit,c=o+19;t.acc;for(S[e.v]&&(c+=S[e.v]),e=e.next;;e=e.next){if(!e)return r;if(e==x){var l=e.v;for(e=w.ts_next;e&&e.v!=l;)e=e.ts_next;if(!e)return r;s=e.time}if(e.time!=s)return r;if(e.type==a.NOTE)break}for(i=e.notes.length,h=0;h<i;h++)if(t=e.notes[h],t.apit==o)return r+=e.dur/n,t.ti2=!0,t.ti1?f(e,t,r):r;return r}function $(t,r,n){for(var a=0;a<=t.nhd;a++){var i=t.notes[a];i.ti2||e.push(new Float32Array([t.istart,r,I[t.v],u(t,a),i.ti1?f(t,i,n):n,1,t.v]))}}var p,d,h,_,m,y,g,v,b,x,w,A,k,E,S,N=[],C=[],I=[],O=s;for(c(),e?O.time<r&&(r=rep_st_t=O.time):(e=[],r=rep_st_t=t=0,n=a.BLEN/4*120/60);O;){if(O.tempo){for(y=0,_=O.tempo_notes.length,h=0;h<_;h++)y+=O.tempo_notes[h];n=y*O.tempo/60}switch(m=O.time-r,m>0&&(t+=m/n,r=O.time),O==x&&(O=w,r=O.time),p=C[O.v],O.type){case a.BAR:if(O.v!=v)break;if(":"==O.bar_type[0]){if(O.bar_type="|"+O.bar_type.slice(1),w=O,x||(x=O),b){for(O=b,g=0;g<o.length;g++)C[g].set(k[g]),S[g]=A[g];n=E}else O=s,c();r=O.time;break}if(!O.invis)for(g=0;g<o.length;g++)C[g].set(N[g]);if(":"==O.bar_type[O.bar_type.length-1]){for(b=O,x=null,g=0;g<o.length;g++)k||(k=[]),k[g]||(k[g]=new Float32Array(70)),k[g].set(C[g]),A||(A=[]),A[g]=S[g];E=n;break}O.text&&"1"==O.text[0]&&(x=O);break;case a.CLEF:S[O.v]=!O.clef_octave||O.clef_oct_transp?0:O.clef_octave;break;case a.GRACE:0==O.time&&0==r&&(m=0,O.sappo?m=a.BLEN/16:O.next&&O.next.type==a.NOTE||(m=y/2),r-=m),function(e){var r,i,s,o,c,l=e.next;if(e.sappo)o=a.BLEN/16;else if(l&&l.type==a.NOTE||!e.prev||e.prev.type!=a.NOTE){for(l.ts_prev.ts_next=l.ts_next,l.ts_next.ts_prev=l.ts_prev,c=l.ts_next;c;c=c.ts_next)if(c.time!=l.time){l.ts_next=c,l.ts_prev=c.ts_prev,l.ts_prev.ts_next=l,c.ts_prev=l;break}o=l.dots?1==l.dots?l.dur/3:2*l.dur/7:l.dur/2,l.time+=o,l.dur-=o}else o=e.prev.dur/2;for(i=0,r=e.extra;r;r=r.next)r.type==a.NOTE&&i++;for(o/=i*n,s=t,r=e.extra;r;r=r.next)r.type==a.NOTE&&($(r,s,o),s+=o)}(O);break;case a.KEY:l(O);break;case a.REST:case a.NOTE:y=O.dur,O.next&&O.next.type==a.GRACE&&(m=0,O.next.sappo?m=a.BLEN/16:O.next.next&&O.next.next.type==a.NOTE||(m=y/2),O.next.time-=m,y-=m),y/=n,O.type==a.NOTE?$(O,t,y):e.push(new Float32Array([O.istart,t,0,0,y,0,O.v]));break;case a.STAVES:v=O.sy.top_voice}O=O.ts_next}}}}function Audio5(e){function t(e){var t,r,n,a,i=e.length,s=0;for(n=3*i/4,"="==e[i-1]&&("="==e[i-2]&&n--,n--,i-=4),a=new Uint8Array(n),t=0;t<i;t+=4)r=(b[e[t]]<<18)+(b[e[t+1]]<<12)+(b[e[t+2]]<<6)+b[e[t+3]],a[s++]=r>>16&255,a[s++]=r>>8&255,a[s++]=255&r;return i!=e.length&&(r=(b[e[t]]<<18)+(b[e[t+1]]<<12)+(b[e[t+2]]<<6)+b[e[t+3]],a[s++]=r>>16&255,s<n&&(a[s++]=r>>8&255)),a}function r(e,t){var r,n=e.getChannelData(0);for(r=0;r<t.length;r++)n[r]=t[r]/196608}function n(e,t){var n,a,i,s,o,c,u=e.getInstruments()[0].info;for(g[t]=[],n=0;n<u.length;n++)if(i=u[n].generator,i.sampleID){a=i.sampleID.amount,o=e.sampleHeader[a].sampleRate,c=e.sample[a],s={attack:Math.pow(2,(i.attackVolEnv?i.attackVolEnv.amount:-12e3)/1200),hold:Math.pow(2,(i.holdVolEnv?i.holdVolEnv.amount:-12e3)/1200),decay:Math.pow(2,(i.decayVolEnv?i.decayVolEnv.amount:-12e3)/1200)/3,sustain:i.sustainVolEnv?i.sustainVolEnv.amount/1e3:0,buffer:l.createBuffer(1,c.length,o)},s.hold+=s.attack,s.decay+=s.hold,s.sustain>=.4?s.sustain=.01:s.sustain=1-s.sustain/.4,r(s.buffer,c),i.sampleModes&&1&i.sampleModes.amount&&(s.loopStart=e.sampleHeader[a].startLoop/o,s.loopEnd=e.sampleHeader[a].endLoop/o);var f=(i.scaleTuning?i.scaleTuning.amount:100)/100,$=(i.coarseTune?i.coarseTune.amount:0)+(i.fineTune?i.fineTune.amount:0)/100+e.sampleHeader[a].pitchCorrection/100-(i.overridingRootKey?i.overridingRootKey.amount:e.sampleHeader[a].originalPitch);for(j=i.keyRange.lo;j<=i.keyRange.hi;j++)g[t][j]=Math.pow(Math.pow(2,1/12),(j+$)*f),y[t][j]=s}}function a(e){v++,abc2svg.loadjs(d.sfu+"/"+e+".js",function(){var r=new sf2.Parser(t(abcsf2[e]));r.parse(),n(r,e),v--},function(){m("could not find the instrument "+(e/128|0).toString()+"-"+(e%128).toString()),v--})}function i(e){var t,r,n;for(t=f;(r=e[t])&&!(f>=$);t++)n=r[2],y[n]||(y[n]=[],a(n))}function s(e,t,r){var n,a=e[2],i=0|e[3],s=y[a][i],o=l.createBufferSource();if(s){if(o.buffer=s.buffer,s.loopStart&&(o.loop=!0,o.loopStart=s.loopStart,o.loopEnd=s.loopEnd),o.detune){var c=100*e[3]%100;c&&(o.detune.value=c)}o.playbackRate.value=g[a][i],n=l.createGain(),s.hold<.002?n.gain.setValueAtTime(1,t):(s.attack<.002?n.gain.setValueAtTime(1,t):(n.gain.setValueAtTime(0,t),n.gain.linearRampToValueAtTime(1,t+s.attack)),n.gain.setValueAtTime(1,t+s.hold)),n.gain.exponentialRampToValueAtTime(s.sustain,t+s.decay),o.connect(n),n.connect(u),o.start(t),o.stop(t+r)}}function o(e){var t,r,n,a,i;if(!(r=e[f])||f>=$)return void h();for(d.new_speed&&(p=l.currentTime-(l.currentTime-p)*d.speed/d.new_speed,d.speed=d.new_speed,d.new_speed=0),t=r[1]/d.speed,n=t+3;;){i=r[4]/d.speed,0!=r[5]&&s(r,t+p,i);var c=r[0];if(a=1e3*(t+p-l.currentTime),setTimeout(_,a,c,!0),setTimeout(_,a+1e3*i,c,!1),!(r=e[++f])||f>=$)return void setTimeout(h,1e3*(t+p-l.currentTime+i));if((t=r[1]/d.speed)>n)break}setTimeout(o,1e3*(t+p-l.currentTime)-300,e)}function c(e){return 0==$?void h():0!=v?void setTimeout(c,300,e):(u.connect(l.destination),p=l.currentTime+.2-e[f][1]*d.speed,void o(e))}var l,u,f,$,p,d=e,h=d.onend||function(){},_=d.onnote||function(){},m=d.errmsg||alert,y=[],g=[],v=0,b=[];return function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=e.length,r=0;r<t;r++)b[e[r]]=r;b["="]=0}(),d.sfu||(d.sfu="Scc1t2"),{get_outputs:function(){return window.AudioContext||window.webkitAudioContext?["sf2"]:null},play:function(e,t,r){if(!r||e>=r.length)return void h();u||(l=d.ac,l||(d.ac=l=new(window.AudioContext||window.webkitAudioContext)),u=l.createGain(),u.gain.value=d.gain),$=t,f=e,i(r),c(r)},stop:function(){$=0,u&&(u.disconnect(),u=null)},set_vol:function(e){u&&(u.gain.value=e)}}}function Midi5(e){function t(e,t,r){var a=0|e[3],i=e[2],s=15&e[6],r=100*e[3]%100;i!=u[s]&&(u[s]=i,n.send(new Uint8Array([176+s,0,i>>14&127,176+s,32,i>>7&127,192+s,127&i]))),r&&Midi5.ma.sysexEnabled&&n.send(new Uint8Array([240,127,127,8,2,127&i,1,a,a,r/.78125,0,247]),t),n.send(new Uint8Array([144+s,a,127]),t),n.send(new Uint8Array([128+s,a,64]),t+r-20)}function r(e){var u,f,$,p,d;if(f=e[a],!n||a>=i||!f)return void c();for(o.new_speed&&(s=window-performance.now()-(window.performance.now()-s)*o.speed/o.new_speed,o.speed=o.new_speed,o.new_speed=0),u=f[1]/o.speed*1e3,$=u+3e3;;){if(d=f[4]/o.speed*1e3,0!=f[5]&&t(f,u+s,d),p=u+s-window.performance.now(),setTimeout(l,p,f[0],!0),setTimeout(l,p+d,f[0],!1),!(f=e[++a])||a>=i)return void setTimeout(c,u+s-window.performance.now()+d);if((u=f[1]/o.speed*1e3)>$)break}setTimeout(r,u+s-window.performance.now()-300,e)}var n,a,i,s,o=e,c=o.onend||function(){},l=o.onnote||function(){},u=[];return{get_outputs:function(){if(Midi5.ma&&(n=Midi5.ma.outputs.values().next().value),n)return[n.name]},set_output:function(e){},play:function(e,t,n){if(!n||e>=n.length)return void c();i=t,a=e,s=window.performance.now()+200-n[a][1]*o.speed*1e3,r(n)},stop:function(){i=0,n&&n.clear&&n.clear()}}}function onMIDISuccess(e){Midi5.ma=e}function onMIDIFailure1(e){navigator.requestMIDIAccess().then(onMIDISuccess,onMIDIFailure2)}function onMIDIFailure2(e){}function isQuoted(e){return e.q}function quote(e){return e.q=!0,e}function unquote(e){return delete e.q,e}function Symbol(e){return this.nm=e,this}function isSymbol(e){return e&&e.constructor===Symbol}function symbolName(e){return e.nm}function isArray(e){return e&&e.constructor===Array}function inDs(e,t){for(var r=e.length-1;0<=r;--r)if(void 0!==e[r][t])return e[r];return!1}function member(e,t){return 0<=t.indexOf(e)}function PsParser(){function e(e){c.L=e,c.N=e.length,c.I=0,c.D=0}function t(){return c.I<c.N&&c.L[c.I]}function r(){return c.I<c.N&&c.L[c.I++]}function n(){for(;c.I<c.N&&member(c.L[c.I]," \t\n");)c.I++}function a(){for(;"%"==t();){for(;t()&&"\n"!=t();)r();n()}}function i(){r();for(var e=[],n=1;0<n&&t();){var a=r();switch(a){case"(":n++;break;case")":n--,n<=0&&(a=!1);break;case"\\":switch(a=r()){case"(":case")":case"\\":break;case"n":a="\n";break;case"r":a="\r";break;case"t":a="\t";break;default:a=!1}}!1!==a&&e.push(a)}return e.join("")}function s(){var e=r();if(member(e,"()<>/% \t\n"))throw new Error("Symbol expected, got "+e);for(var n=member(e,"+-0123456789."),a="."==e,i=[e];t()&&!member(t(),"()<>[]{}/% \t\n");)e=r(),i.push(e),n&&!member(e,"0123456789")&&(a||"."!=e?n=!1:a=!0);return i=i.join(""),1==i.length&&member(i,"+-.")&&(n=!1),n?a?parseFloat(i):parseInt(i,10):new Symbol(i)}function o(){switch(n(),t()){case!1:return;case"%":return a();case"[":case"]":return new Symbol(r());case"{":return c.D++,new Symbol(r());case"}":return c.D--,new Symbol(r());case"/":r();return quote(s());case"(":return i();case"<":if(r(),"<"!=t())throw new Error("Encoded strings not implemented yet");return r(),new Symbol("<<");case">":if(r(),">"!=t())throw new Error("Unexpected >");return r(),new Symbol(">>");default:return s()}}var c=this;return PsParser.prototype.init=e,PsParser.prototype.peek=t,PsParser.prototype.token=o,this}function Ps0(e,t,r){function n(a,i){if(isSymbol(a)&&!isQuoted(a)){var s=symbolName(a),o=inDs(t,s);if(!o)throw new Error("bind error '"+s+"'");r.push([!1,o[s]])}else if(i&&isArray(a)&&isQuoted(a)){if(0<a.length){var c=a[0],l=quote(a.slice(1));0<l.length&&r.push([!1,l]),n(c,!1)}}else"function"==typeof a?a():e.push(a)}function a(){n(e.pop(),!1)}function i(){for(var t=r.pop(),a=(t.shift(),t.pop()),i=0;i<t.length;i++)e.push(t[i]);n(a,!0)}function s(t){for(o.init(t);o.peek();){var n=o.token();if((n||0===n)&&(e.push(n),o.D<=0||isSymbol(n)&&(member(symbolName(n),"[]{}")||"<<"==symbolName(n)||">>"==symbolName(n))))for(a();0<r.length;)i()}return e}var o=new PsParser;return Ps0.prototype.run=n,Ps0.prototype.exec=a,Ps0.prototype.step=i,Ps0.prototype.parse=s,this}function Wps(e){function t(e){if(isSymbol(e)&&!isQuoted(e))return e;if(isArray(e)&&isQuoted(e)){for(var r=e.length,n=[],a=0;a<r;a++){var i=e[a],s=t(i);n=isArray(i)?n.concat(isQuoted(i)?quote([s]):[s]):n.concat(s)}return quote(n)}return e}function r(){var e=arguments;if(e.length)for(var t=0;t<e.length;t++)c.parse(e[t]);else c.parse(e);return a}var n=e,a=[],i={},s=[i],o=[],c=new Ps0(a,s,o);i.true=function(){a.push(!0)},i.false=function(){a.push(!1)},i.null=function(){a.push(null)},i.sub=function(){var e=a.pop();a.push(a.pop()-e)},i.mul=function(){a.push(a.pop()*a.pop())},i.div=function(){var e=a.pop();a.push(a.pop()/e)},i.mod=function(){var e=a.pop();a.push(a.pop()%e)};var l={};i.mark=function(){a.push(l)},i.counttomark=function(){for(var e=0,t=a.length-1;0<=t;t--){if(l===a[t])return a.push(e);e++}throw new Error("Mark not found")},i["<<"]=i.mark,i[">>"]=function(){for(var e={};0<a.length;){var t=a.pop();if(l===t)return a.push(e);e[a.pop()]=t}throw new Error("Mark not found")},i.exch=function(){var e=a.pop(),t=a.pop();a.push(e),a.push(t)},i.clear=function(){a.length=0},i.pop=function(){a.pop()},i.index=function(){a.push(a[a.length-2-a.pop()])},i.roll=function(){var e=a.pop(),t=a.pop(),r=[],n=[];e<0&&(e=t+e);for(var i=0;i<t;i++)i<e?r.unshift(a.pop()):n.unshift(a.pop());for(i=0;i<e;i++)a.push(r.shift());for(i=0;i<t-e;i++)a.push(n.shift())},i.copy=function(){var e=a.pop();if("object"==typeof e){var t=a.pop();for(var r in t)e[r]=t[r];a.push(e)}else for(var t=a.length-e,r=0;r<e;r++)a.push(a[t+r])},i.length=function(){a.push(a.pop().length)},i.astore=function(){for(var e=a.pop(),t=e.length,r=t-1;0<=r;r--)e[r]=a.pop();a.push(e)},i.array=function(){a.push(new Array(a.pop()))},i.eq=function(){var e=a.pop(),t=a.pop();a.push(t==e)},i.lt=function(){var e=a.pop(),t=a.pop();a.push(t<e)},i.ifelse=function(){var e=a.pop(),t=a.pop(),r=a.pop();o.push([!1,!0===r?t:e])},i.and=function(){var e=a.pop(),t=a.pop();if(!0===e||!1===e)return void a.push(1==e&&!0===t);a.push(e&t)},i.repeat=function e(){var t=a.pop(),r=a.pop();1<r&&o.push([!0,r-1,t,e]),0<r&&o.push([!1,t])},i.for=function e(){var t=a.pop(),r=a.pop(),n=a.pop(),i=a.pop();n<0?(r<=i+n&&o.push([!0,i+n,n,r,t,e]),r<=i&&o.push([!1,i,t])):(i+n<=r&&o.push([!0,i+n,n,r,t,e]),i<=r&&o.push([!1,i,t]))},i.exec=function(){o.push([!1,a.pop()])},i.cvx=function(){var e=a.pop();isSymbol(e)&&isQuoted(e)?a.push(unquote(e)):isArray(e)&&!isQuoted(e)?a.push(quote(e)):a.push(e)},i.dict=function(){a.pop(),a.push({})},i.get=function(){var e=a.pop(),t=a.pop();isSymbol(e)?a.push(t[symbolName(e)]):a.push(t[e])},i.getinterval=function(){for(var e=a.pop(),t=a.pop()+e,r=a.pop(),n=[];--e>=0;)n.push(r[t++]);a.push(n)},i.put=function(){var e=a.pop(),t=a.pop(),r=a.pop();isSymbol(t)?r[symbolName(t)]=e:r[t]=e},i.begin=function(){s.push(a.pop())},i.end=function(){s.pop()},i.currentdict=function(){a.push(s[s.length-1])},i.where=function(){var e=symbolName(a.pop()),t=inDs(s,e);t?(a.push(t),a.push(!0)):a.push(!1)},i.save=function(){for(var e=s.slice(),t=0;t<e.length;t++){var r=e[t],n={};for(var i in r)n[i]=r[i];e[t]=n}a.push(e)},i.restore=function(){for(var e=a.pop();0<s.length;)s.pop();for(;0<e.length;)s.unshift(e.pop())},i.type=function(){var e,t=a.pop();if(null===t)e="nulltype";else if(!0===t||!1===t)e="booleantype";else if(l===t)e="marktype";else if("string"==typeof t)e="stringtype";else if(isSymbol(t))e=isQuoted(t)?"nametype":"operatortype";else if("function"==typeof t)e="operatortype";else if(isArray(t))e="arraytype";else if("object"==typeof t)e="dicttype";else{if(1*t!=t)throw new Error("Undefined type '"+t+"'");e=t%1==0?"integertype":"realtype"}a.push(e)};var u=!0;return i[".strictBind"]=function(){u=!0===a.pop()},i.bind=function(){a.push(t(a.pop()))},i["="]=function(){var e=a.pop();alert(e&&e.nm||e)},i["=="]=function(){alert(a.pop())},i.stack=function(){alert(a)},i.pstack=function(){alert(a)},i[".call"]=function(){for(var e=a.pop(),t=a.pop(),r=a.pop(),n=[],i=0;i<e;i++)n.unshift(a.pop());if(!r[t])throw new Error(".call: "+t+" undef");a.push(r[t].apply(r,n))},i[".call0"]=function(){for(var e=a.pop(),t=a.pop(),r=a.pop(),n=[],i=0;i<e;i++)n.unshift(a.pop());if(!r[t])throw new Error(".call0: "+t+" undef");r[t].apply(r,n)},i[".svg"]=function(){a.push(n)},i[".math"]=function(){a.push(Math)},i[".date"]=function(){a.push(new Date)},i[".window"]=function(){a.push(window)},i[".callback"]=function(){var e=a.pop();a.push(function(){for(c.run(e,!0);0<o.length;)c.step()})},i[".minv"]=function(){var e=a.pop(),t=e[0],r=e[1],n=e[2],i=e[3],s=e[4],o=e[5];a.push([i,r,n,t,n*o-i*s,r*s-t*o])},i[".mmul"]=function(){var e=a.pop(),t=a.pop(),r=t[0],n=t[1],i=t[2],s=t[3],o=t[4],c=t[5],l=e[0],u=e[1],f=e[2],$=e[3],p=e[4],d=e[5];a.push([r*l+n*f,r*u+n*$,i*l+s*f,i*u+s*$,o*l+c*f+p,o*u+c*$+d])},i[".xy"]=function(){var e=a.pop(),t=a.pop(),r=a.pop();a.push(e[0]*r+e[2]*t+e[4]),a.push(e[1]*r+e[3]*t+e[5])},i[".rgb"]=function(){var e=a.pop(),t=a.pop(),r=a.pop();a.push("rgb("+r+","+t+","+e+")")},i[".rgba"]=function(){var e=a.pop(),t=a.pop(),r=a.pop(),n=a.pop();a.push("rgba("+n+","+r+","+t+","+e+")")},Wps.prototype.parse=r,this}function Psvg(e){function t(){return o(0),[g.xoffs-g.xorig,g.yoffs-g.yorig]}function r(){if(p=!1,o(0),h+="<g",1!=g.xscale||1!=g.yscale||g.rotate){if(h+=' transform="',1==g.xscale&&1==g.yscale||(g.xscale==g.yscale?h+="scale("+g.xscale.toFixed(3)+")":h+="scale("+g.xscale.toFixed(3)+","+g.yscale.toFixed(3)+")"),g.rotate){if(g.xoffs||g.yoffs){var e,t=g.xoffs,r=g.yoffs,n=g.sin,i=g.cos;e=t*i-r*n,r=t*n+r*i,h+=" translate("+e.toFixed(2)+","+r.toFixed(2)+")",b=g.xoffs,x=g.yoffs,g.xoffs=0,g.yoffs=0}h+=" rotate("+g.rotate.toFixed(2)+")"}h+='"'}a(!1),g.rgb&&(h+=' style="color:'+g.rgb+'"'),h+=">\n",y=1}function n(e){var t,r=new e.constructor;for(t in e)e.hasOwnProperty(t)&&(r[t]=e[t]);return r}function a(e){var t=g.font_n;if(t){var r="",n=t.indexOf("Italic"),a=100,i=t.indexOf("Oblique"),s=t.indexOf("Bold"),o=0;s>0&&(r=' font-weight="bold"',a=s,o=2),(n>0||i>0)&&(n>0&&(r+=' font-style="italic"',n<a&&(a=n),o|=4),i>0&&(r+=' font-style="oblique"',i<a&&(a=i),o=8)),100!=a&&("-"==t[a-1]&&a--,t=t.slice(0,a)),e&&(!(2&o)&&w.indexOf("Bold")>=0&&(r+=' font-weight="normal"'),12&o||!(w.indexOf("Italic")>=0||w.indexOf("Oblique")>=0)||(r+=' font-style="normal"')),h+=' font-family="'+t+'"'+r+' font-size="'+g.font_s+'"'}}function i(){d||(o(1),g.px=g.cx,g.py=g.cy,d='<path d="m'+(g.xoffs+g.cx).toFixed(2)+" "+(g.yoffs-g.cy).toFixed(2)+"\n")}function s(){h+=d,d=""}function o(e){2==y&&(h+="</text>\n",y=1),0==e?y&&(y=0,h+="</g>\n",g.rotate&&(g.xoffs=b,g.yoffs=x,b=0,x=0)):p&&r()}function c(e){return e.length*g.font_s*.5}function l(e,t,r,n,a,s){var o,c,l,u;n>=360&&(n-=360),a>=360&&(a-=360),o=e+r*Math.cos(n*Math.PI/180),c=t+r*Math.sin(n*Math.PI/180),void 0!=g.cx?d?(o!=g.cx||c!=g.cy?d+="l":d+="m",d+=(o-g.cx).toFixed(2)+" "+(-(c-g.cy)).toFixed(2)):(g.cx=o,g.cy=c,i()):(d&&(d=""),g.cx=o,g.cy=c,i()),n==a?(a=180-n,l=e+r*Math.cos(a*Math.PI/180),u=t+r*Math.sin(a*Math.PI/180),d+="a"+r.toFixed(2)+" "+r.toFixed(2)+" 0 0 "+(s?"1 ":"0 ")+(l-o).toFixed(2)+" "+(c-u).toFixed(2)+" "+r.toFixed(2)+" "+r.toFixed(2)+" 0 0 "+(s?"1 ":"0 ")+(o-l).toFixed(2)+" "+(u-c).toFixed(2)+"\n",g.cx=o,g.cy=c):(l=e+r*Math.cos(a*Math.PI/180),u=t+r*Math.sin(a*Math.PI/180),d+="a"+r.toFixed(2)+" "+r.toFixed(2)+" 0 0 "+(s?"1 ":"0 ")+(l-o).toFixed(2)+" "+(c-u).toFixed(2)+"\n",g.cx=l,g.cy=u)}function u(e,t){i(),d+=0==e?"\tv"+(-t).toFixed(2)+"\n":0==t?"\th"+e.toFixed(2)+"\n":"\tl"+e.toFixed(2)+" "+(-t).toFixed(2)+"\n",g.cx+=e,g.cy+=t}function f(e){e&&o(0),h&&(_.out_svg(h),h="")}function $(e,t,r,n){return g.xorig=g.xoffs=_.sx(0),g.yorig=g.yoffs=_.sy(0),g.cx=0,g.cy=0,m.parse(n+(t/_.stv_g().scale).toFixed(2)+" "+r.toFixed(2)+" "+e),f(!0),!0}var p,d,h="",_=e,m=new Wps(this),y=0,g={cx:0,cy:0,xoffs:0,yoffs:0,xscale:1,yscale:1,rotate:0,sin:0,cos:1,linewidth:.7,dash:""},v=[],b=0,x=0,w="";Psvg.prototype.strw=c,Psvg.prototype.arc=l,Psvg.prototype.arcn=function(e,t,r,n,a){l(e,t,r,n,a,!0)},Psvg.prototype.closepath=function(){d&&g.cx&&u(g.px-g.cx,g.py-g.cy)},Psvg.prototype.cx=function(){return g.cx},Psvg.prototype.cy=function(){return g.cy},Psvg.prototype.curveto=function(e,t,r,n,a,s){i(),d+="\tC"+(g.xoffs+e).toFixed(2)+" "+(g.yoffs-t).toFixed(2)+" "+(g.xoffs+r).toFixed(2)+" "+(g.yoffs-n).toFixed(2)+" "+(g.xoffs+a).toFixed(2)+" "+(g.yoffs-s).toFixed(2)+"\n",g.cx=a,g.cy=s},Psvg.prototype.eofill=function(){s(),h+='" fill-rule="evenodd" fill="currentColor"/>\n'},Psvg.prototype.fill=function(){s(),h+='" fill="currentColor"/>\n'},Psvg.prototype.gsave=function(){v.push(n(g))},Psvg.prototype.grestore=function(){g=v.pop(),p=!0},Psvg.prototype.lineto=function(e,t){i(),e==g.cx?d+="\tv"+(g.cy-t).toFixed(2)+"\n":t==g.cy?d+="\th"+(e-g.cx).toFixed(2)+"\n":d+="\tl"+(e-g.cx).toFixed(2)+" "+(g.cy-t).toFixed(2)+"\n",g.cx=e,g.cy=t},Psvg.prototype.moveto=function(e,t){g.cx=e,g.cy=t,d?d+="\tM"+(g.xoffs+g.cx).toFixed(2)+" "+(g.yoffs-g.cy).toFixed(2)+"\n":2==y&&(h+="</text>\n",y=1)},Psvg.prototype.newpath=function(){g.cx=g.cy=void 0},Psvg.prototype.rcurveto=function(e,t,r,n,a,s){i(),d+="\tc"+e.toFixed(2)+" "+(-t).toFixed(2)+" "+r.toFixed(2)+" "+(-n).toFixed(2)+" "+a.toFixed(2)+" "+(-s).toFixed(2)+"\n",g.cx+=a,g.cy+=s},Psvg.prototype.rlineto=u,Psvg.prototype.rmoveto=function(e,t){d?d+="\tm"+e.toFixed(2)+" "+(-t).toFixed(2)+"\n":2==y&&(h+="</text>\n",y=1),g.cx+=e,g.cy+=t},Psvg.prototype.rotate=function(e){o(0);var t,r=g.xoffs,n=g.yoffs,a=g.sin,i=g.cos;t=r*i-n*a,n=r*a+n*i,g.xoffs=t/g.xscale,g.yoffs=n/g.yscale,r=g.cx,n=g.cy,t=r*i-n*a,n=-r*a+n*i,g.cx=t/g.xscale,g.cy=n/g.yscale,e=360-e,g.rotate+=e,g.rotate>180?g.rotate-=360:g.rotate<=-180&&(g.rotate+=360),e=g.rotate*Math.PI/180,g.sin=a=Math.sin(e),g.cos=i=Math.cos(e),t=g.cx,g.cx=(t*i+g.cy*a)*g.xscale,g.cy=(-t*a+g.cy*i)*g.yscale,t=g.xoffs,g.xoffs=(t*i+g.yoffs*a)*g.xscale,g.yoffs=(-t*a+g.yoffs*i)*g.yscale,p=!0},Psvg.prototype.scale=function(e,t){g.xoffs/=e,g.yoffs/=t,g.cx/=e,g.cy/=t,g.xscale*=e,g.yscale*=t,p=!0},Psvg.prototype.selectfont=function(e,t){e=e.nm,0==t&&""==e||(g.font_n_old=g.font_n,g.font_n=e,g.font_s=t,p=!0)},
Psvg.prototype.setdash=function(e,t){var r,n=e.length;if(0==n)return void(g.dash="");for(g.dash=' stroke-dashoffset="'+t+'"  stroke-dasharray="',r=0;;){if(g.dash+=e[r],0==--n)break;g.dash+=" "}g.dash+='"'},Psvg.prototype.setlinewidth=function(e){g.linewidth=e},Psvg.prototype.setrgbcolor=function(e,t,r){var n=16777216+(Math.floor(255*e)<<16)+(Math.floor(255*t)<<8)+Math.floor(255*r);n=n.toString(16),(n=n.replace("1","#"))!=g.rgb&&(g.rgb=n,p=!0)},Psvg.prototype.show=function(e){var t,n,i;p&&(2==y?t=!0:r()),n=g.cx,i=g.cy,t?(h+="<tspan\n\t",a(!0),h+=">"):2!=y&&(h+='<text x="'+(n+g.xoffs).toFixed(2)+'" y="'+(g.yoffs-i).toFixed(2)+'">',y=2),h+=e.replace(/<|>|&|  /g,function(e){switch(e){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";case"  ":return" "}}),t&&(h+="</tspan>"),g.cx=n+c(e)},Psvg.prototype.stroke=function(){s(),.7!=g.linewidth&&(h+='" stroke-width="'+g.linewidth.toFixed(2)),h+='" stroke="currentColor" fill="none"'+g.dash+"/>\n"},Psvg.prototype.translate=function(e,t){g.xoffs+=e,g.yoffs-=t,g.cx-=e,g.cy-=t},Psvg.prototype.arp=function(e,r,n){var a=t();f(),_.out_arp((r+a[0])*_.stv_g().scale,n-a[1],e)},Psvg.prototype.ltr=function(e,r,n){var a=t();f(),_.out_ltr((r+a[0])*_.stv_g().scale,n-a[1],e)},Psvg.prototype.xygl=function(e,r,n){var a=t();f(),_.xygl((e+a[0])*_.stv_g().scale,r-a[1],n)},Psvg.prototype.xygls=function(e,r,n,a){var i=t();f(),_.out_deco_str((r+i[0])*_.stv_g().scale,n-i[1],a,e)},Psvg.prototype.xyglv=function(e,r,n,a){var i=t();f(),_.out_deco_val((r+i[0])*_.stv_g().scale,n-i[1],a,e)},Psvg.prototype.y0=function(e){return e+_.get_staff_tb()[0].y},Psvg.prototype.y1=function(e){return e+_.get_staff_tb()[1].y},Psvg.prototype.ps_flush=f,Psvg.prototype.ps_eval=function(e){m.parse(e),f()},Psvg.prototype.psdeco=function(e,t,r,n){var a,i,s,o,c=m.parse("/"+e+" where"),l=c.pop(),u=_.get_staff_tb();return!!l&&(o=0,n.defl.nost&&(o=1),n.defl.noen&&(o|=2),n.s.stem>=0&&(o|=4),c.pop(),s="/defl "+o+" def ",n.lden&&(s+=t.toFixed(2)+" "+r.toFixed(2)+" ",i=n.start,t=i.x,r=i.y+u[i.st].y,t>n.x-20&&(t=n.x-20)),a=n.dd,n.has_val?s+=n.val+" ":a.str&&(s+="("+a.str+") ",r+=.2*a.h),$(e,t,r,s))},Psvg.prototype.psxygl=function(e,t,r){var n=m.parse("/"+r+" where");return!!n.pop()&&(n.pop(),$(r,e,t,"dlw "))},Psvg.prototype.svgcall=function(e,r,n,a,i){var s=t();f(),e((r+s[0])*_.stv_g().scale,n-s[1],a,i)},m.parse("currentdict/systemdict currentdict put\nsystemdict/{/mark cvx put\nsystemdict/[/mark cvx put\nsystemdict/]\n/counttomark cvx\n/array cvx\n/astore cvx\n/exch cvx\n/pop cvx\n5 array astore cvx put\nsystemdict/}/] cvx/cvx cvx 2 array astore cvx put\nsystemdict/def{currentdict 2 index 2 index put pop pop}put\n\n/maxlength 1000 def % TODO\n/.bdef{bind def}bind def\n/.xdef{exch def}.bdef\n/dup{0 index}.bdef\n/load{dup where pop exch get}.bdef\n/.ldef{load def}.bdef\n/if{{}ifelse}.bdef\n/cleartomark{array pop}.bdef\n/known{exch begin where{currentdict eq}{false}if end}.bdef\n/store{1 index where{3 1 roll put}{def}ifelse}.bdef\n/not{{false}{true}ifelse}.bdef\n%/.logand{{{true}{false}ifelse}{pop false}ifelse}.bdef\n%/and/.logand .ldef % TODO numeric and\n/.logor{{pop true}{{true}{false}ifelse}ifelse}.bdef\n/or/.logor .ldef % TODO numeric or\n/ne{eq not}.bdef\n/ge{lt not}.bdef\n/le{1 index 1 index eq 3 1 roll lt or}.bdef\n/gt{le not}.bdef\n/.repeat{1 1 4 2 roll for}.bdef\n\n%% math\n\n/floor{.math(floor)1 .call}.bdef\n\n/neg{0 exch sub}.bdef\n/add{neg sub}.bdef\n/idiv{div floor}.bdef\n\n/.pi{.math(PI)get}.bdef\n\n/abs{.math(abs)1 .call}.bdef\n%/.acos{.math(acos)1 .call}.bdef\n%/.asin{.math(asin)1 .call}.bdef\n/atan{.math(atan2)2 .call 180 mul .pi div}.bdef\n%/.atan2{.math(atan2)2 .call}.bdef\n%/ceiling{.math(ceil)1 .call}.bdef\n/cos{.pi mul 180 div .math(cos)1 .call}.bdef\n%/.exp{.math(exp)1 .call}.bdef\n%/log{.math(log)1 .call}.bdef\n%/.max{.math(max)2 .call}.bdef\n%/.min{.math(min)2 .call}.bdef\n%/.pow{.math(pow)2 .call}.bdef\n%/.random{.math(random)0 .call}.bdef\n%/rand{.random}.bdef % TODO follow spec\n%/round{.math(round)1 .call}.bdef\n%/sin{.math(sin)1 .call}.bdef\n%/sqrt{.math(sqrt)1 .call}.bdef\n%/.tan{.math(tan)1 .call}.bdef\n%/truncate{.math(truncate)1 .call}.bdef % TODO Math.truncate does not exist!\n\n% graphic\n/arc{.svg(arc)5 .call0}.bdef\n/arcn{.svg(arcn)5 .call0}.bdef\n/closepath{.svg(closepath)0 .call}.bdef\n/currentpoint{.svg(cx)0 .call .svg(cy)0 .call}.bdef\n/curveto{.svg(curveto)6 .call0}.bdef\n/eofill{.svg(eofill)0 .call0}.bdef\n/fill{.svg(fill)0 .call0}.bdef\n/grestore{.svg(grestore)0 .call0}.bdef\n/gsave{.svg(gsave)0 .call0}.bdef\n/lineto{.svg(lineto)2 .call0}.bdef\n/moveto{.svg(moveto)2 .call0}.bdef\n/newpath{.svg(newpath)0 .call0}.bdef\n/rcurveto{.svg(rcurveto)6 .call0}.bdef\n/rlineto{.svg(rlineto)2 .call0}.bdef\n/rmoveto{.svg(rmoveto)2 .call0}.bdef\n/rotate{.svg(rotate)1 .call0}.bdef\n/scale{.svg(scale)2 .call0}.bdef\n/selectfont{.svg(selectfont)2 .call0}.bdef\n/setdash{.svg(setdash)2 .call0}.bdef\n/setlinewidth{.svg(setlinewidth)1 .call0}.bdef\n/setrgbcolor{.svg(setrgbcolor)3 .call0}.bdef\n/show{.svg(show)1 .call0}.bdef\n/stroke{.svg(stroke)0 .call0}.bdef\n/stringwidth{.svg(strw)1 .call 1}.bdef\t\t%fixme: height KO\n/translate{.svg(translate)2 .call0}.bdef\n\n/setgray{255 mul dup dup setrgbcolor}.bdef\n% abcm2ps syms.c\n/!{bind def}bind def\n/T/translate load def\n/M/moveto load def\n/RM/rmoveto load def\n/L/lineto load def\n/RL/rlineto load def\n/C/curveto load def\n/RC/rcurveto load def\n/SLW/setlinewidth load def\n/defl 0 def\n/dlw{0.7 SLW}!\n/xymove{/x 2 index def/y 1 index def M}!\n/showc{dup stringwidth pop .5 mul neg 0 RM show}!\n%\n% abcm2ps internal glyphs\n/arp{.svg(arp)3 .call0}.bdef\n/ltr{.svg(ltr)3 .call0}.bdef\n/ft0{(acc-1).svg(xygl)3 .call0}.bdef\n/nt0{(acc3).svg(xygl)3 .call0}.bdef\n/sh0{(acc1).svg(xygl)3 .call0}.bdef\n/dsh0{(acc2).svg(xygl)3 .call0}.bdef\n/trl{(trl).svg(xygl)3 .call0}.bdef\n/lmrd{(lmrd).svg(xygl)3 .call0}.bdef\n/turn{(turn).svg(xygl)3 .call0}.bdef\n/umrd{(umrd).svg(xygl)3 .call0}.bdef\n/y0{.svg(y0)1 .call}.bdef\n/y1{.svg(y1)1 .call}.bdef\n")}navigator={},function(e){function t(e,t,r){"string"==typeof e?e[t]=r:Object.defineProperty(e,t,{value:r,enumerable:!1,configurable:!0,writable:!0})}function r(e,t){if(e)return e.$$const[t]}function n(e,t){var r,n,a;if(0!==e.length)for(r=0,n=e.length;r<n;r++)if(null!=(a=e[r].$$const[t]))return a}function a(e,t){var r,n,a;if(null!=e)for(a=L.ancestors(e),r=0,n=a.length;r<n;r++)if(a[r].$$const&&P.call(a[r].$$const,t))return a[r].$$const[t]}function i(e,t){if(null==e||e.$$is_module)return a(C,t)}function s(e,t,r){if(!r)return(e||C).$const_missing(t)}function o(e,t){var n=r(e,t);if(n){if(!n.$$is_class)throw L.TypeError.$new(t+" is not a class");return n}}function c(e,t){if(e.$$super!==t)throw L.TypeError.$new("superclass mismatch for class "+e.$$name)}function l(e,t){var n=r(e,t);if(null==n&&e===C&&(n=a(C,t)),n&&!n.$$is_module&&n!==C)throw L.TypeError.$new(t+" is not a module");return n}function u(e){return e.hasOwnProperty("$$iclass")&&e.hasOwnProperty("$$root")}function f(e){for(var t,r=[],n=Object.getPrototypeOf(e.$$prototype);n&&!n.hasOwnProperty("$$class");)t=m(n),t&&r.push(t),n=Object.getPrototypeOf(n);return r}function $(e){var t,r=[],n=Object.getPrototypeOf(e.$$prototype);if(e.$$prototype.hasOwnProperty("$$dummy"))for(;n&&n!==e.$$prototype.$$define_methods_on;)t=m(n),t&&r.push(t),n=Object.getPrototypeOf(n);return r}function p(e){for(var t=e.$$prototype,r=Object.getOwnPropertyNames(t),n=0;n<r.length;n++){var a=r[n];L.is_method(a)&&delete t[a]}}function d(e){var t=h(e);return e.$$is_module&&e.$$iclasses.push(t),t}function h(e){var r={},n=e.$$prototype;n.hasOwnProperty("$$dummy")&&(n=n.$$define_methods_on);var a,i=Object.getOwnPropertyNames(n),s=i.length;for(a=0;a<s;a++){var o=i[a];t(r,o,n[o])}return t(r,"$$iclass",!0),t(r,"$$module",e),r}function _(e){var r=e.length,n=e[0];if(t(n,"$$root",!0),1===r)return{first:n,last:n};for(var a=n,i=1;i<r;i++){var s=e[i];T(a,s),a=s}return{first:e[0],last:e[r-1]}}function m(e){if(!e.hasOwnProperty("$$dummy"))return e.hasOwnProperty("$$iclass")?e.$$module:e.hasOwnProperty("$$class")?e.$$class:void 0}function y(e){return e.$$own_prepended_modules.concat([e]).concat(e.$$own_included_modules)}function g(e){return"function"==typeof e&&!e.$$stub}function v(){}function b(){}function x(){}function w(){}function A(){}var k,E=this;if("undefined"!=typeof global&&(E=global),"undefined"!=typeof window&&(E=window),k="object"==typeof E.console?E.console:null==E.console?E.console={}:{},"log"in k||(k.log=function(){}),"warn"in k||(k.warn=k.log),void 0!==this.Opal)return k.warn("Opal already loaded. Loading twice can cause troubles, please fix your setup."),this.Opal;var S,N,C,I,O,L=this.Opal={};L.global=E,E.Opal=L,L.config={missing_require_severity:"error",unsupported_features_severity:"warning",enable_stack_trace:!0};var P=Object.hasOwnProperty,M=Function.prototype.bind,T=Object.setPrototypeOf,B=Array.prototype.slice,j=Array.prototype.splice,F=4;L.uid=function(){return F+=2},L.id=function(e){return e.$$is_number?2*e+1:null!=e.$$id?e.$$id:(t(e,"$$id",L.uid()),e.$$id)},L.gvars={},L.exit=function(e){L.gvars.DEBUG&&k.log("Exited with status "+e)},L.exceptions=[],L.pop_exception=function(){L.gvars["!"]=L.exceptions.pop()||S},L.inspect=function(t){return t===e?"undefined":null===t?"null":t.$$class?t.$inspect():t.toString()},L.defineProperty=t,L.slice=B,L.truthy=function(e){return e!==S&&null!=e&&(!e.$$is_boolean||1==e)},L.falsy=function(e){return e===S||null==e||e.$$is_boolean&&0==e},L.const_get_local=function(e,t,n){var a;if(null!=e){if("::"===e&&(e=C),!e.$$is_module&&!e.$$is_class)throw new L.TypeError(e.toString()+" is not a class/module");return null!=(a=r(e,t))?a:(a=s(e,t,n),null!=a?a:void 0)}},L.const_get_qualified=function(e,n,i){var o,c,l,u=L.const_cache_version;if(null!=e){if("::"===e&&(e=C),!e.$$is_module&&!e.$$is_class)throw new L.TypeError(e.toString()+" is not a class/module");return null==(c=e.$$const_cache)&&(t(e,"$$const_cache",Object.create(null)),c=e.$$const_cache),l=c[n],null==l||l[0]!==u?(null!=(o=r(e,n))||(o=a(e,n)),c[n]=[u,o]):o=l[1],null!=o?o:s(e,n,i)}},L.const_cache_version=1,L.const_get_relative=function(e,o,c){var l,u,f,$=e[0],p=L.const_cache_version;return null==(u=e.$$const_cache)&&(t(e,"$$const_cache",Object.create(null)),u=e.$$const_cache),f=u[o],null==f||f[0]!==p?(null!=(l=r($,o))||null!=(l=n(e,o))||null!=(l=a($,o))||(l=i($,o)),u[o]=[p,l]):l=f[1],null!=l?l:s($,o,c)},L.const_set=function(e,r,n){return null!=e&&"::"!==e||(e=C),n.$$is_a_module&&(null!=n.$$name&&n.$$name!==S||(n.$$name=r),null==n.$$base_module&&(n.$$base_module=e)),e.$$const=e.$$const||Object.create(null),e.$$const[r]=n,e.$$=e.$$const,L.const_cache_version++,e===C&&(L[r]=n),t(e,r,n),n},L.constants=function(e,t){null==t&&(t=!0);var r,n,a,i,s=[e],o={};for(t&&(s=s.concat(L.ancestors(e))),t&&e.$$is_module&&(s=s.concat([L.Object]).concat(L.ancestors(L.Object))),n=0,a=s.length;n<a&&(r=s[n],e===C||r!=C);n++)for(i in r.$$const)o[i]=!0;return Object.keys(o)},L.const_remove=function(e,t){if(L.const_cache_version++,null!=e.$$const[t]){var r=e.$$const[t];return delete e.$$const[t],r}if(null!=e.$$autoload&&null!=e.$$autoload[t])return delete e.$$autoload[t],S;throw L.NameError.$new("constant "+e+"::"+e.$name()+" not defined")},L.allocate_class=function(e,r){var n,a;return a=null!=r&&r.$$bridge?function(){var e=B.call(arguments),t=new(M.apply(r.$$constructor,[null].concat(e)));return T(t,n.$$prototype),t}:function(){},e&&t(a,"displayName","::"+e),n=a,t(n,"$$name",e),t(n,"$$constructor",a),t(n,"$$prototype",a.prototype),t(n,"$$const",{}),t(n,"$$is_class",!0),t(n,"$$is_a_module",!0),t(n,"$$super",r),t(n,"$$cvars",{}),t(n,"$$own_included_modules",[]),t(n,"$$own_prepended_modules",[]),t(n,"$$ancestors",[]),t(n,"$$ancestors_cache_version",null),t(n.$$prototype,"$$class",n),L.Class&&T(n,L.Class.prototype),null!=r&&(T(n.$$prototype,r.$$prototype),r.$$meta&&L.build_class_singleton_class(n)),n},L.klass=function(e,t,r){var n;null==e?e=C:e.$$is_class||e.$$is_module||(e=e.$$class),null==t||t.hasOwnProperty("$$is_class")||(n=t,t=C);var a=o(e,r);return a?(t&&c(a,t),a):(null==t&&(t=C),a=L.allocate_class(r,t),L.const_set(e,r,a),t.$inherited&&t.$inherited(a),n&&L.bridge(n,a),a)},L.allocate_module=function(e){var r=function(){};e&&t(r,"displayName",e+".$$constructor");var n=r;return e&&t(r,"displayName",e+".constructor"),t(n,"$$name",e),t(n,"$$prototype",r.prototype),t(n,"$$const",{}),t(n,"$$is_module",!0),t(n,"$$is_a_module",!0),t(n,"$$cvars",{}),t(n,"$$iclasses",[]),t(n,"$$own_included_modules",[]),t(n,"$$own_prepended_modules",[]),t(n,"$$ancestors",[n]),t(n,"$$ancestors_cache_version",null),T(n,L.Module.prototype),n},L.module=function(e,t){var r;return null==e?e=C:e.$$is_class||e.$$is_module||(e=e.$$class),(r=l(e,t))?r:(r=L.allocate_module(t),L.const_set(e,t,r),r)},L.get_singleton_class=function(e){return e.$$meta?e.$$meta:e.hasOwnProperty("$$is_class")?L.build_class_singleton_class(e):e.hasOwnProperty("$$is_module")?L.build_module_singletin_class(e):L.build_object_singleton_class(e)},L.build_class_singleton_class=function(e){var r,n;return e.$$meta?e.$$meta:(r=e===N?O:L.get_singleton_class(e.$$super),n=L.allocate_class(null,r,function(){}),t(n,"$$is_singleton",!0),t(n,"$$singleton_of",e),t(e,"$$meta",n),T(e,n.$$prototype),t(e,"$$class",L.Class),n)},L.build_module_singletin_class=function(e){if(e.$$meta)return e.$$meta;var r=L.allocate_class(null,L.Module,function(){});return t(r,"$$is_singleton",!0),t(r,"$$singleton_of",e),t(e,"$$meta",r),T(e,r.$$prototype),t(e,"$$class",L.Module),r},L.build_object_singleton_class=function(e){var r=e.$$class,n=L.allocate_class(S,r,function(){});return t(n,"$$is_singleton",!0),t(n,"$$singleton_of",e),delete n.$$prototype.$$class,t(e,"$$meta",n),T(e,e.$$meta.$$prototype),n},L.is_method=function(e){return"$"===e[0]&&"$"!==e[1]},L.instance_methods=function(e){for(var t=[],r=[],n=L.ancestors(e),a=0,i=n.length;a<i;a++){var s=n[a],o=s.$$prototype;o.hasOwnProperty("$$dummy")&&(o=o.$$define_methods_on);for(var c=Object.getOwnPropertyNames(o),l=0,u=c.length;l<u;l++){var f=c[l];if(L.is_method(f)){var $=f.slice(1),p=o[f];p.$$stub&&-1===t.indexOf($)&&t.push($),p.$$stub||-1!==r.indexOf($)||-1!==t.indexOf($)||r.push($)}}}return r},L.own_instance_methods=function(e){var t=[],r=e.$$prototype;r.hasOwnProperty("$$dummy")&&(r=r.$$define_methods_on);for(var n=Object.getOwnPropertyNames(r),a=0,i=n.length;a<i;a++){var s=n[a];if(L.is_method(s)){if(!r[s].$$stub){var o=s.slice(1);t.push(o)}}}return t},L.methods=function(e){return L.instance_methods(L.get_singleton_class(e))},L.own_methods=function(e){return L.own_instance_methods(L.get_singleton_class(e))},L.receiver_methods=function(e){var t=L.get_singleton_class(e),r=L.own_instance_methods(t),n=L.own_instance_methods(t.$$super);return r.concat(n)},L.class_variables=function(e){var t,r=L.ancestors(e),n=r.length,a={};for(t=n-1;t>=0;t--){var i=r[t];for(var s in i.$$cvars)a[s]=i.$$cvars[s]}return a},L.class_variable_set=function(e,t,r){var n,a=L.ancestors(e),i=a.length;for(n=i-2;n>=0;n--){var s=a[n];if(P.call(s.$$cvars,t))return s.$$cvars[t]=r,r}return e.$$cvars[t]=r,r},L.append_features=function(e,r){var n=L.ancestors(e),a=[];if(-1!==n.indexOf(r))throw L.ArgumentError.$new("cyclic include detected");for(var i=0,s=n.length;i<s;i++){var o=n[i],c=d(o);t(c,"$$included",!0),a.push(c)}var l,$,p=L.ancestors(r),h=_(a);if(-1===p.indexOf(e))l=r.$$prototype,$=Object.getPrototypeOf(r.$$prototype);else{for(var m=r.$$prototype,y=m,g=Object.getPrototypeOf(y);null!=g&&(!u(g)||g.$$module!==e);)y=g,g=Object.getPrototypeOf(g);for(var v=Object.getPrototypeOf(g);v.hasOwnProperty("$$iclass")&&!u(v);)v=Object.getPrototypeOf(v);l=y,$=v}T(l,h.first),T(h.last,$),r.$$own_included_modules=f(r),L.const_cache_version++},L.prepend_features=function(e,r){var n=L.ancestors(e),a=[];if(-1!==n.indexOf(r))throw L.ArgumentError.$new("cyclic prepend detected");for(var i=0,s=n.length;i<s;i++){var o=n[i],c=d(o);t(c,"$$prepended",!0),a.push(c)}var l,u,f,m=_(a),y=r.$$prototype,g=Object.getPrototypeOf(y);if(y.hasOwnProperty("$$dummy")?l=y.$$define_methods_on:(l=h(r),p(r),t(y,"$$dummy",!0),t(y,"$$define_methods_on",l),T(y,l),T(l,g)),-1!==L.ancestors(r).indexOf(e))throw L.RuntimeError.$new("Prepending a module multiple times is not supported");for(u=y,f=Object.getPrototypeOf(y);null!=f&&!f.hasOwnProperty("$$root")&&f!==l&&f.hasOwnProperty("$$iclass");)f=Object.getPrototypeOf(f);T(u,m.first),T(m.last,f),r.$$own_prepended_modules=$(r),L.const_cache_version++},L.bridge=function(e,r){if(e.hasOwnProperty("$$bridge"))throw L.ArgumentError.$new("already bridged");r.$$super||L.Object;r.$$prototype;t(e,"$$bridge",r),T(e.prototype,(r.$$super||L.Object).$$prototype),t(r,"$$prototype",e.prototype),t(r.$$prototype,"$$class",r),t(r,"$$constructor",e),t(r,"$$bridge",!0)},L.ancestors=function(e){if(!e)return[];if(e.$$ancestors_cache_version===L.const_cache_version)return e.$$ancestors;var t,r,n,a=[];for(t=0,r=y(e),n=r.length;t<n;t++)a.push(r[t]);if(e.$$super)for(t=0,r=L.ancestors(e.$$super),n=r.length;t<n;t++)a.push(r[t]);return e.$$ancestors_cache_version=L.const_cache_version,e.$$ancestors=a,a},L.included_modules=function(e){for(var t=[],r=null,n=Object.getPrototypeOf(e.$$prototype);n&&Object.getPrototypeOf(n);n=Object.getPrototypeOf(n))(r=m(n))&&r.$$is_module&&n.$$iclass&&n.$$included&&t.push(r);return t},L.add_stubs=function(e){for(var t=L.BasicObject.$$prototype,r=0,n=e.length;r<n;r++){var a=e[r],i=t[a];(null==i||i.$$stub)&&L.add_stub_for(t,a)}},L.add_stub_for=function(e,r){t(e,r,L.stub_for(r))},L.stub_for=function(e){function t(){this.$method_missing.$$p=t.$$p,t.$$p=null;for(var r=new Array(arguments.length),n=0,a=r.length;n<a;n++)r[n]=arguments[n];return this.$method_missing.apply(this,[e.slice(1)].concat(r))}return t.$$stub=!0,t},L.ac=function(e,t,r,n){var a="";throw r.$$is_a_module?a+=r.$$name+".":a+=r.$$class.$$name+"#",a+=n,L.ArgumentError.$new("["+a+"] wrong number of arguments("+e+" for "+t+")")},L.block_ac=function(e,t,r){var n="`block in "+r+"'";throw L.ArgumentError.$new(n+": wrong number of arguments ("+e+" for "+t+")")},L.find_super_dispatcher=function(e,t,r,n,a){var i,s,o="$"+t;i=e.hasOwnProperty("$$meta")?L.ancestors(e.$$meta):L.ancestors(e.$$class);for(var c=i.indexOf(r.$$owner),l=c+1;l<i.length;l++){var u=i[l],f=u.$$prototype;if(f.hasOwnProperty("$$dummy")&&(f=f.$$define_methods_on),f.hasOwnProperty(o)){var $=f[o];$.$$stub||(s=$);break}}if(!n&&null==s&&L.Kernel.$method_missing===e.$method_missing)throw L.NoMethodError.$new("super: no superclass method `"+t+"' for "+e,t);return s},L.find_iter_super_dispatcher=function(e,t,r,n,a){var i=t;if(!r)throw L.RuntimeError.$new("super called outside of method");if(a&&r.$$define_meth)throw L.RuntimeError.$new("implicit argument passing of super from method defined by define_method() is not supported. Specify all arguments explicitly");return r.$$def&&(i=r.$$jsid),L.find_super_dispatcher(e,i,r,n)},L.ret=function(e){throw L.returner.$v=e,L.returner},L.brk=function(e,t){throw t.$v=e,t},L.new_brk=function(){return new Error("unexpected break")},L.yield1=function(e,t){if("function"!=typeof e)throw L.LocalJumpError.$new("no block given");var r=e.$$has_top_level_mlhs_arg,n=e.$$has_trailing_comma_in_args;return(e.length>1||(r||n)&&1===e.length)&&(t=L.to_ary(t)),(e.length>1||n&&1===e.length)&&t.$$is_array?e.apply(null,t):e(t)},L.yieldX=function(e,t){if("function"!=typeof e)throw L.LocalJumpError.$new("no block given");if(e.length>1&&1===t.length&&t[0].$$is_array)return e.apply(null,t[0]);if(!t.$$is_array){for(var r=new Array(t.length),n=0,a=r.length;n<a;n++)r[n]=t[n];return e.apply(null,r)}return e.apply(null,t)},L.rescue=function(e,t){for(var r=0;r<t.length;r++){var n=t[r];if(n.$$is_array){var a=L.rescue(e,n);if(a)return a}else{if(n===L.JS.Error)return n;if(n["$==="](e))return n}}return null},L.is_a=function(e,t){if(null!=t&&e.$$meta===t||e.$$class===t)return!0;if(e.$$is_number&&t.$$is_number_class)return!0;var r,n,a=L.ancestors(e.$$is_class?L.get_singleton_class(e):e.$$meta||e.$$class);for(r=0,n=a.length;r<n;r++)if(a[r]===t)return!0;return!1},L.to_hash=function(e){if(e.$$is_hash)return e;if(e["$respond_to?"]("to_hash",!0)){var t=e.$to_hash();if(t.$$is_hash)return t;throw L.TypeError.$new("Can't convert "+e.$$class+" to Hash ("+e.$$class+"#to_hash gives "+t.$$class+")")}throw L.TypeError.$new("no implicit conversion of "+e.$$class+" into Hash")},L.to_ary=function(e){if(e.$$is_array)return e;if(e["$respond_to?"]("to_ary",!0)){var t=e.$to_ary();if(t===S)return[e];if(t.$$is_array)return t;throw L.TypeError.$new("Can't convert "+e.$$class+" to Array ("+e.$$class+"#to_ary gives "+t.$$class+")")}return[e]},L.to_a=function(e){if(e.$$is_array)return e.slice();if(e["$respond_to?"]("to_a",!0)){var t=e.$to_a();if(t===S)return[e];if(t.$$is_array)return t;throw L.TypeError.$new("Can't convert "+e.$$class+" to Array ("+e.$$class+"#to_a gives "+t.$$class+")")}return[e]},L.extract_kwargs=function(e){var t=e[e.length-1];return null!=t&&t["$respond_to?"]("to_hash",!0)?(j.call(e,e.length-1,1),t.$to_hash()):L.hash2([],{})},L.kwrestargs=function(e,t){var r,n=[],a={},i=e.$$smap;for(r in i)t[r]||(n.push(r),a[r]=i[r]);return L.hash2(n,a)},L.send=function(e,t,r,n){var a="string"==typeof t?e["$"+t]:t;return null!=a?("function"==typeof n&&(a.$$p=n),a.apply(e,r)):e.$method_missing.apply(e,[t].concat(r))},L.lambda=function(e){return e.$$is_lambda=!0,e},L.def=function(e,t,r){e===L.top?L.defn(L.Object,t,r):!e.$$eval&&e.$$is_a_module?L.defn(e,t,r):L.defs(e,t,r)},L.defn=function(e,r,n){n.displayName=r,n.$$owner=e;var a=e.$$prototype;if(a.hasOwnProperty("$$dummy")&&(a=a.$$define_methods_on),t(a,r,n),e.$$is_module){e.$$module_function&&L.defs(e,r,n);for(var i=0,s=e.$$iclasses,o=s.length;i<o;i++){t(s[i],r,n)}}var c=e.$$singleton_of;!e.$method_added||e.$method_added.$$stub||c?c&&c.$singleton_method_added&&!c.$singleton_method_added.$$stub&&c.$singleton_method_added(r.substr(1)):e.$method_added(r.substr(1))},L.defs=function(e,t,r){if(e.$$is_string||e.$$is_number)throw L.TypeError.$new("can't define singleton");L.defn(L.get_singleton_class(e),t,r)},L.rdef=function(e,t){if(!P.call(e.$$prototype,t))throw L.NameError.$new("method '"+t.substr(1)+"' not defined in "+e.$name());delete e.$$prototype[t],e.$$is_singleton?e.$$prototype.$singleton_method_removed&&!e.$$prototype.$singleton_method_removed.$$stub&&e.$$prototype.$singleton_method_removed(t.substr(1)):e.$method_removed&&!e.$method_removed.$$stub&&e.$method_removed(t.substr(1))},L.udef=function(e,t){if(!e.$$prototype[t]||e.$$prototype[t].$$stub)throw L.NameError.$new("method '"+t.substr(1)+"' not defined in "+e.$name());L.add_stub_for(e.$$prototype,t),e.$$is_singleton?e.$$prototype.$singleton_method_undefined&&!e.$$prototype.$singleton_method_undefined.$$stub&&e.$$prototype.$singleton_method_undefined(t.substr(1)):e.$method_undefined&&!e.$method_undefined.$$stub&&e.$method_undefined(t.substr(1))},L.alias=function(e,t,r){var n,a="$"+t,i="$"+r,s=e.$$prototype["$"+r];if(e.$$eval)return L.alias(L.get_singleton_class(e),t,r);if(!g(s)){for(var o=e.$$super;"function"!=typeof s&&o;)s=o[i],o=o.$$super;if(!g(s)&&e.$$is_module&&(s=L.Object.$$prototype[i]),!g(s))throw L.NameError.$new("undefined method `"+r+"' for class `"+e.$name()+"'")}return s.$$alias_of&&(s=s.$$alias_of),n=function(){var e,t,r,a=n.$$p;for(e=new Array(arguments.length),t=0,r=arguments.length;t<r;t++)e[t]=arguments[t];return null!=a&&(n.$$p=null),L.send(this,s,e,a)},n.displayName=t,n.length=s.length,n.$$arity=s.$$arity,n.$$parameters=s.$$parameters,n.$$source_location=s.$$source_location,n.$$alias_of=s,n.$$alias_name=t,L.defn(e,a,n),e},L.alias_native=function(e,t,r){var n="$"+t,a=e.$$prototype[r];if("function"!=typeof a||a.$$stub)throw L.NameError.$new("undefined native method `"+r+"' for class `"+e.$name()+"'");return L.defn(e,n,a),e},L.hash_init=function(e){e.$$smap=Object.create(null),e.$$map=Object.create(null),e.$$keys=[]},L.hash_clone=function(e,t){t.$$none=e.$$none,t.$$proc=e.$$proc;for(var r,n,a=0,i=e.$$keys,s=e.$$smap,o=i.length;a<o;a++)r=i[a],r.$$is_string?n=s[r]:(n=r.value,r=r.key),L.hash_put(t,r,n)},L.hash_put=function(t,r,n){if(r.$$is_string)return P.call(t.$$smap,r)||t.$$keys.push(r),void(t.$$smap[r]=n);var a,i,s;if(a=t.$$by_identity?L.id(r):r.$hash(),!P.call(t.$$map,a))return i={key:r,key_hash:a,value:n},t.$$keys.push(i),void(t.$$map[a]=i);for(i=t.$$map[a];i;){if(r===i.key||r["$eql?"](i.key)){s=e,i.value=n;break}s=i,i=i.next}s&&(i={key:r,key_hash:a,value:n},t.$$keys.push(i),s.next=i)},L.hash_get=function(e,t){if(t.$$is_string){if(P.call(e.$$smap,t))return e.$$smap[t]}else{var r,n;if(r=e.$$by_identity?L.id(t):t.$hash(),P.call(e.$$map,r))for(n=e.$$map[r];n;){if(t===n.key||t["$eql?"](n.key))return n.value;n=n.next}}},L.hash_delete=function(e,t){var r,n,a=e.$$keys,i=a.length;if(t.$$is_string){if(!P.call(e.$$smap,t))return;for(r=0;r<i;r++)if(a[r]===t){a.splice(r,1);break}return n=e.$$smap[t],delete e.$$smap[t],n}var s=t.$hash();if(P.call(e.$$map,s))for(var o,c=e.$$map[s];c;){if(t===c.key||t["$eql?"](c.key)){for(n=c.value,r=0;r<i;r++)if(a[r]===c){a.splice(r,1);break}return o&&c.next?o.next=c.next:o?delete o.next:c.next?e.$$map[s]=c.next:delete e.$$map[s],n}o=c,c=c.next}},L.hash_rehash=function(t){for(var r,n,a,i=0,s=t.$$keys.length;i<s;i++)if(!t.$$keys[i].$$is_string&&(r=t.$$keys[i].key.$hash())!==t.$$keys[i].key_hash){for(n=t.$$map[t.$$keys[i].key_hash],a=e;n;){if(n===t.$$keys[i]){a&&n.next?a.next=n.next:a?delete a.next:n.next?t.$$map[t.$$keys[i].key_hash]=n.next:delete t.$$map[t.$$keys[i].key_hash];break}a=n,n=n.next}if(t.$$keys[i].key_hash=r,P.call(t.$$map,r)){for(n=t.$$map[r],a=e;n;){if(n===t.$$keys[i]){a=e;break}a=n,n=n.next}a&&(a.next=t.$$keys[i])}else t.$$map[r]=t.$$keys[i]}},L.hash=function(){var e,t,r,n,a,i,s=arguments.length;if(1===s&&arguments[0].$$is_hash)return arguments[0];if(t=new L.Hash,L.hash_init(t),1===s&&arguments[0].$$is_array){for(e=arguments[0],n=e.length,r=0;r<n;r++){if(2!==e[r].length)throw L.ArgumentError.$new("value not of length 2: "+e[r].$inspect());a=e[r][0],i=e[r][1],L.hash_put(t,a,i)}return t}if(1===s){e=arguments[0];for(a in e)P.call(e,a)&&(i=e[a],L.hash_put(t,a,i));return t}if(s%2!=0)throw L.ArgumentError.$new("odd number of arguments for Hash");for(r=0;r<s;r+=2)a=arguments[r],i=arguments[r+1],L.hash_put(t,a,i);return t},L.hash2=function(e,t){var r=new L.Hash;return r.$$smap=t,r.$$map=Object.create(null),r.$$keys=e,r},L.range=function(e,t,r){var n=new L.Range;return n.begin=e,n.end=t,n.excl=r,n},L.ivar=function(e){return"constructor"===e||"displayName"===e||"__count__"===e||"__noSuchMethod__"===e||"__parent__"===e||"__proto__"===e||"hasOwnProperty"===e||"valueOf"===e?e+"$":e},L.escape_regexp=function(e){return e.replace(/([-[\]\/{}()*+?.^$\\| ])/g,"\\$1").replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r").replace(/[\f]/g,"\\f").replace(/[\t]/g,"\\t")},L.global_regexp=function(e){return e.global?e:(null==e.$$g?e.$$g=new RegExp(e.source,(e.multiline?"gm":"g")+(e.ignoreCase?"i":"")):e.$$g.lastIndex=null,e.$$g)},L.global_multiline_regexp=function(e){var t;if(e.multiline){if(e.global)return e;t=null!=e.$$g?e.$$g:e.$$g=new RegExp(e.source,"gm"+(e.ignoreCase?"i":""))}else t=null!=e.$$gm?e.$$gm:e.$$gm=new RegExp(e.source,"gm"+(e.ignoreCase?"i":""));return t.lastIndex=null,t},L.modules={},L.loaded_features=["corelib/runtime"],L.current_dir=".",L.require_table={"corelib/runtime":!0},L.normalize=function(e){var t,r,n=[];"."!==L.current_dir&&(e=L.current_dir.replace(/\/*$/,"/")+e),e=e.replace(/^\.\//,""),e=e.replace(/\.(rb|opal|js)$/,""),t=e.split("/");for(var a=0,i=t.length;a<i;a++)""!==(r=t[a])&&(".."===r?n.pop():n.push(r));return n.join("/")},L.loaded=function(e){var t,r,n;for(t=0,r=e.length;t<r;t++)n=L.normalize(e[t]),L.require_table[n]||(L.loaded_features.push(n),L.require_table[n]=!0)},L.load=function(e){e=L.normalize(e),L.loaded([e]);var t=L.modules[e];if(t)t(L);else{var r=L.config.missing_require_severity,n="cannot load such file -- "+e;if("error"===r)throw L.LoadError?L.LoadError.$new(n):n;"warning"===r&&k.warn("WARNING: LoadError: "+n)}return!0},L.require=function(e){return e=L.normalize(e),!L.require_table[e]&&L.load(e)},L.BasicObject=N=L.allocate_class("BasicObject",null,v),L.Object=C=L.allocate_class("Object",L.BasicObject,b),L.Module=I=L.allocate_class("Module",L.Object,x),L.Class=O=L.allocate_class("Class",L.Module,w),T(L.BasicObject,L.Class.$$prototype),T(L.Object,L.Class.$$prototype),T(L.Module,L.Class.$$prototype),T(L.Class,L.Class.$$prototype),N.$$const.BasicObject=N,L.const_set(C,"BasicObject",N),L.const_set(C,"Object",C),L.const_set(C,"Module",I),L.const_set(C,"Class",O),N.$$class=O,C.$$class=O,I.$$class=O,O.$$class=O,t(C.$$prototype,"toString",function(){var e=this.$to_s();return e.$$is_string&&"object"==typeof e?e.valueOf():e}),t(C.$$prototype,"$require",L.require),L.$$=C.$$,L.top=new C,L.top.$to_s=L.top.$inspect=function(){return"main"},L.NilClass=L.allocate_class("NilClass",L.Object,A),L.const_set(C,"NilClass",L.NilClass),S=L.nil=new L.NilClass,S.$$id=4,S.call=S.apply=function(){throw L.LocalJumpError.$new("no block given")},L.breaker=new Error("unexpected break (old)"),L.returner=new Error("unexpected return"),TypeError.$$super=Error}.call(this),Opal.loaded(["corelib/runtime.js"]),Opal.modules["corelib/helpers"]=function(e){var t=(e.top,[]),r=e.nil,n=(e.const_get_qualified,e.const_get_relative),a=(e.breaker,e.slice,e.module),i=e.truthy;return e.add_stubs(["$new","$class","$===","$respond_to?","$raise","$type_error","$__send__","$coerce_to","$nil?","$<=>","$coerce_to!","$!=","$[]","$upcase"]),function(t,s){var o,c,l,u,f,$,p,d,h,_,m,y,g,v,b=a(t,"Opal"),x=[b].concat(s);e.defs(b,"$bridge",o=function(t,r){return e.bridge(t,r)},o.$$arity=2),e.defs(b,"$type_error",c=function(e,t,a,s){var o;return null==a&&(a=r),null==s&&(s=r),i(i(o=a)?s:o)?n(x,"TypeError").$new("can't convert "+e.$class()+" into "+t+" ("+e.$class()+"#"+a+" gives "+s.$class()+")"):n(x,"TypeError").$new("no implicit conversion of "+e.$class()+" into "+t)},c.$$arity=-3),e.defs(b,"$coerce_to",l=function(e,t,r){var n=this;return i(t["$==="](e))?e:(i(e["$respond_to?"](r))||n.$raise(n.$type_error(e,t)),e.$__send__(r))},l.$$arity=3),e.defs(b,"$coerce_to!",u=function(e,t,n){var a=this,s=r;return s=a.$coerce_to(e,t,n),i(t["$==="](s))||a.$raise(a.$type_error(e,t,n,s)),s},u.$$arity=3),e.defs(b,"$coerce_to?",f=function(e,t,n){var a=this,s=r;return i(e["$respond_to?"](n))?(s=a.$coerce_to(e,t,n),i(s["$nil?"]())?r:(i(t["$==="](s))||a.$raise(a.$type_error(e,t,n,s)),s)):r},f.$$arity=3),e.defs(b,"$try_convert",$=function(e,t,n){return i(t["$==="](e))?e:i(e["$respond_to?"](n))?e.$__send__(n):r},$.$$arity=3),e.defs(b,"$compare",p=function(e,t){var a=this,s=r;return s=e["$<=>"](t),i(s===r)&&a.$raise(n(x,"ArgumentError"),"comparison of "+e.$class()+" with "+t.$class()+" failed"),s},p.$$arity=2),e.defs(b,"$destructure",d=function(e){if(1==e.length)return e[0];if(e.$$is_array)return e;for(var t=new Array(e.length),r=0,n=t.length;r<n;r++)t[r]=e[r];return t},d.$$arity=1),e.defs(b,"$respond_to?",h=function(e,t,r){return null==r&&(r=!1),!(null==e||!e.$$class)&&e["$respond_to?"](t,r)},h.$$arity=-3),e.defs(b,"$inspect_obj",_=function(t){return e.inspect(t)},_.$$arity=1),e.defs(b,"$instance_variable_name!",m=function(e){var t=this;return e=n(x,"Opal")["$coerce_to!"](e,n(x,"String"),"to_str"),i(/^@[a-zA-Z_][a-zA-Z0-9_]*?$/.test(e))||t.$raise(n(x,"NameError").$new("'"+e+"' is not allowed as an instance variable name",e)),e},m.$$arity=1),e.defs(b,"$class_variable_name!",y=function(e){var t=this;return e=n(x,"Opal")["$coerce_to!"](e,n(x,"String"),"to_str"),i(e.length<3||"@@"!==e.slice(0,2))&&t.$raise(n(x,"NameError").$new("`"+e+"' is not allowed as a class variable name",e)),e},y.$$arity=1),e.defs(b,"$const_name!",g=function(e){var t=this;return e=n(x,"Opal")["$coerce_to!"](e,n(x,"String"),"to_str"),i(e["$[]"](0)["$!="](e["$[]"](0).$upcase()))&&t.$raise(n(x,"NameError"),"wrong constant name "+e),e},g.$$arity=1),e.defs(b,"$pristine",v=function(t,n){var a,i;a=e.slice.call(arguments,1,arguments.length),i=a
;for(var s,o,c=i.length-1;c>=0;c--)s=i[c],(o=t.$$prototype["$"+s])&&!o.$$stub&&(o.$$pristine=!0);return r},v.$$arity=-2)}(t[0],t)},Opal.modules["corelib/module"]=function(Opal){function $rb_lt(e,t){return"number"==typeof e&&"number"==typeof t?e<t:e["$<"](t)}function $rb_gt(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}var self=Opal.top,$nesting=[],nil=Opal.nil,$$$=Opal.const_get_qualified,$$=Opal.const_get_relative,$breaker=Opal.breaker,$slice=Opal.slice,$klass=Opal.klass,$send=Opal.send,$truthy=Opal.truthy,$lambda=Opal.lambda,$range=Opal.range,$hash2=Opal.hash2;return Opal.add_stubs(["$module_eval","$to_proc","$===","$raise","$equal?","$<","$>","$nil?","$attr_reader","$attr_writer","$class_variable_name!","$new","$const_name!","$=~","$inject","$split","$const_get","$==","$!~","$start_with?","$bind","$call","$class","$append_features","$included","$name","$cover?","$size","$merge","$compile","$proc","$any?","$prepend_features","$prepended","$to_s","$__id__","$constants","$include?","$copy_class_variables","$copy_constants"]),function($base,$super,$parent_nesting){var self=$klass($base,$super,"Module"),$nesting=[self].concat($parent_nesting),$Module_allocate$1,$Module_initialize$2,$Module_$eq_eq_eq$3,$Module_$lt$4,$Module_$lt_eq$5,$Module_$gt$6,$Module_$gt_eq$7,$Module_$lt_eq_gt$8,$Module_alias_method$9,$Module_alias_native$10,$Module_ancestors$11,$Module_append_features$12,$Module_attr_accessor$13,$Module_attr_reader$14,$Module_attr_writer$15,$Module_autoload$16,$Module_class_variables$17,$Module_class_variable_get$18,$Module_class_variable_set$19,$Module_class_variable_defined$ques$20,$Module_remove_class_variable$21,$Module_constants$22,$Module_constants$23,$Module_nesting$24,$Module_const_defined$ques$25,$Module_const_get$26,$Module_const_missing$28,$Module_const_set$29,$Module_public_constant$30,$Module_define_method$31,$Module_remove_method$33,$Module_singleton_class$ques$34,$Module_include$35,$Module_included_modules$36,$Module_include$ques$37,$Module_instance_method$38,$Module_instance_methods$39,$Module_included$40,$Module_extended$41,$Module_extend_object$42,$Module_method_added$43,$Module_method_removed$44,$Module_method_undefined$45,$Module_module_eval$46,$Module_module_exec$48,$Module_method_defined$ques$49,$Module_module_function$50,$Module_name$51,$Module_prepend$52,$Module_prepend_features$53,$Module_prepended$54,$Module_remove_const$55,$Module_to_s$56,$Module_undef_method$57,$Module_instance_variables$58,$Module_dup$59,$Module_copy_class_variables$60,$Module_copy_constants$61;return Opal.defs(self,"$allocate",$Module_allocate$1=function(){var e=this,t=Opal.allocate_module(nil,function(){});return e!==Opal.Module&&Object.setPrototypeOf(t,e.$$prototype),t},$Module_allocate$1.$$arity=0),Opal.def(self,"$initialize",$Module_initialize$2=function(){var e=$Module_initialize$2.$$p,t=e||nil,r=this;return e&&($Module_initialize$2.$$p=null),e&&($Module_initialize$2.$$p=null),t!==nil?$send(r,"module_eval",[],t.$to_proc()):nil},$Module_initialize$2.$$arity=0),Opal.def(self,"$===",$Module_$eq_eq_eq$3=function(e){var t=this;return!$truthy(null==e)&&Opal.is_a(e,t)},$Module_$eq_eq_eq$3.$$arity=1),Opal.def(self,"$<",$Module_$lt$4=function(e){var t=this;$truthy($$($nesting,"Module")["$==="](e))||t.$raise($$($nesting,"TypeError"),"compared with non class/module");var r,n,a,i=t;if(i===e)return!1;for(n=0,r=Opal.ancestors(t),a=r.length;n<a;n++)if(r[n]===e)return!0;for(n=0,r=Opal.ancestors(e),a=r.length;n<a;n++)if(r[n]===t)return!1;return nil},$Module_$lt$4.$$arity=1),Opal.def(self,"$<=",$Module_$lt_eq$5=function(e){var t,r=this;return $truthy(t=r["$equal?"](e))?t:$rb_lt(r,e)},$Module_$lt_eq$5.$$arity=1),Opal.def(self,"$>",$Module_$gt$6=function(e){var t=this;return $truthy($$($nesting,"Module")["$==="](e))||t.$raise($$($nesting,"TypeError"),"compared with non class/module"),$rb_lt(e,t)},$Module_$gt$6.$$arity=1),Opal.def(self,"$>=",$Module_$gt_eq$7=function(e){var t,r=this;return $truthy(t=r["$equal?"](e))?t:$rb_gt(r,e)},$Module_$gt_eq$7.$$arity=1),Opal.def(self,"$<=>",$Module_$lt_eq_gt$8=function(e){var t=this,r=nil;return t===e?0:$truthy($$($nesting,"Module")["$==="](e))?(r=$rb_lt(t,e),$truthy(r["$nil?"]())?nil:$truthy(r)?-1:1):nil},$Module_$lt_eq_gt$8.$$arity=1),Opal.def(self,"$alias_method",$Module_alias_method$9=function(e,t){var r=this;return Opal.alias(r,e,t),r},$Module_alias_method$9.$$arity=2),Opal.def(self,"$alias_native",$Module_alias_native$10=function(e,t){var r=this;return null==t&&(t=e),Opal.alias_native(r,e,t),r},$Module_alias_native$10.$$arity=-2),Opal.def(self,"$ancestors",$Module_ancestors$11=function(){var e=this;return Opal.ancestors(e)},$Module_ancestors$11.$$arity=0),Opal.def(self,"$append_features",$Module_append_features$12=function(e){var t=this;return Opal.append_features(t,e),t},$Module_append_features$12.$$arity=1),Opal.def(self,"$attr_accessor",$Module_attr_accessor$13=function(e){var t,r,n=this;return t=Opal.slice.call(arguments,0,arguments.length),r=t,$send(n,"attr_reader",Opal.to_a(r)),$send(n,"attr_writer",Opal.to_a(r))},$Module_attr_accessor$13.$$arity=-1),Opal.alias(self,"attr","attr_accessor"),Opal.def(self,"$attr_reader",$Module_attr_reader$14=function(e){var t,r,n=this;t=Opal.slice.call(arguments,0,arguments.length),r=t;for(var a=n.$$prototype,i=r.length-1;i>=0;i--){var s=r[i],o="$"+s,c=Opal.ivar(s),l=function(e){return function(){return null==this[e]?nil:this[e]}}(c);Opal.defineProperty(a,c,nil),l.$$parameters=[],l.$$arity=0,Opal.defn(n,o,l)}return nil},$Module_attr_reader$14.$$arity=-1),Opal.def(self,"$attr_writer",$Module_attr_writer$15=function(e){var t,r,n=this;t=Opal.slice.call(arguments,0,arguments.length),r=t;for(var a=n.$$prototype,i=r.length-1;i>=0;i--){var s=r[i],o="$"+s+"=",c=Opal.ivar(s),l=function(e){return function(t){return this[e]=t}}(c);l.$$parameters=[["req"]],l.$$arity=1,Opal.defineProperty(a,c,nil),Opal.defn(n,o,l)}return nil},$Module_attr_writer$15.$$arity=-1),Opal.def(self,"$autoload",$Module_autoload$16=function(e,t){var r=this;return null==r.$$autoload&&(r.$$autoload={}),Opal.const_cache_version++,r.$$autoload[e]=t,nil},$Module_autoload$16.$$arity=2),Opal.def(self,"$class_variables",$Module_class_variables$17=function(){var e=this;return Object.keys(Opal.class_variables(e))},$Module_class_variables$17.$$arity=0),Opal.def(self,"$class_variable_get",$Module_class_variable_get$18=function(e){var t=this;e=$$($nesting,"Opal")["$class_variable_name!"](e);var r=Opal.class_variables(t)[e];return null==r&&t.$raise($$($nesting,"NameError").$new("uninitialized class variable "+e+" in "+t,e)),r},$Module_class_variable_get$18.$$arity=1),Opal.def(self,"$class_variable_set",$Module_class_variable_set$19=function(e,t){var r=this;return e=$$($nesting,"Opal")["$class_variable_name!"](e),Opal.class_variable_set(r,e,t)},$Module_class_variable_set$19.$$arity=2),Opal.def(self,"$class_variable_defined?",$Module_class_variable_defined$ques$20=function(e){var t=this;return e=$$($nesting,"Opal")["$class_variable_name!"](e),Opal.class_variables(t).hasOwnProperty(e)},$Module_class_variable_defined$ques$20.$$arity=1),Opal.def(self,"$remove_class_variable",$Module_remove_class_variable$21=function(e){var t=this;if(e=$$($nesting,"Opal")["$class_variable_name!"](e),Opal.hasOwnProperty.call(t.$$cvars,e)){var r=t.$$cvars[e];return delete t.$$cvars[e],r}t.$raise($$($nesting,"NameError"),"cannot remove "+e+" for "+t)},$Module_remove_class_variable$21.$$arity=1),Opal.def(self,"$constants",$Module_constants$22=function(e){var t=this;return null==e&&(e=!0),Opal.constants(t,e)},$Module_constants$22.$$arity=-1),Opal.defs(self,"$constants",$Module_constants$23=function(e){var t=this;if(null==e){var r,n,a,i=(t.$$nesting||[]).concat(Opal.Object),s={};for(n=0,a=i.length;n<a;n++)for(r in i[n].$$const)s[r]=!0;return Object.keys(s)}return Opal.constants(t,e)},$Module_constants$23.$$arity=-1),Opal.defs(self,"$nesting",$Module_nesting$24=function(){return this.$$nesting||[]},$Module_nesting$24.$$arity=0),Opal.def(self,"$const_defined?",$Module_const_defined$ques$25=function(e,t){var r=this;null==t&&(t=!0),e=$$($nesting,"Opal")["$const_name!"](e),$truthy(e["$=~"]($$$($$($nesting,"Opal"),"CONST_NAME_REGEXP")))||r.$raise($$($nesting,"NameError").$new("wrong constant name "+e,e));var n,a,i,s=[r];for(t&&(s=s.concat(Opal.ancestors(r)),r.$$is_module&&(s=s.concat([Opal.Object]).concat(Opal.ancestors(Opal.Object)))),a=0,i=s.length;a<i;a++)if(n=s[a],null!=n.$$const[e])return!0;return!1},$Module_const_defined$ques$25.$$arity=-2),Opal.def(self,"$const_get",$Module_const_get$26=function(e,t){var r,n=this;return null==t&&(t=!0),e=$$($nesting,"Opal")["$const_name!"](e),0===e.indexOf("::")&&"::"!==e&&(e=e.slice(2)),$truthy(-1!=e.indexOf("::")&&"::"!=e)?$send(e.$split("::"),"inject",[n],(r=function(e,t){r.$$s;return null==e&&(e=nil),null==t&&(t=nil),e.$const_get(t)},r.$$s=n,r.$$arity=2,r)):($truthy(e["$=~"]($$$($$($nesting,"Opal"),"CONST_NAME_REGEXP")))||n.$raise($$($nesting,"NameError").$new("wrong constant name "+e,e)),t?$$([n],e):Opal.const_get_local(n,e))},$Module_const_get$26.$$arity=-2),Opal.def(self,"$const_missing",$Module_const_missing$28=function(e){var t=this,r=nil;if(t.$$autoload){var n=t.$$autoload[e];if(n)return t.$require(n),t.$const_get(e)}return r=function(){return t["$=="]($$($nesting,"Object"))?e:t+"::"+e}(),t.$raise($$($nesting,"NameError").$new("uninitialized constant "+r,e))},$Module_const_missing$28.$$arity=1),Opal.def(self,"$const_set",$Module_const_set$29=function(e,t){var r,n=this;return e=$$($nesting,"Opal")["$const_name!"](e),$truthy($truthy(r=e["$!~"]($$$($$($nesting,"Opal"),"CONST_NAME_REGEXP")))?r:e["$start_with?"]("::"))&&n.$raise($$($nesting,"NameError").$new("wrong constant name "+e,e)),Opal.const_set(n,e,t),t},$Module_const_set$29.$$arity=2),Opal.def(self,"$public_constant",$Module_public_constant$30=function(e){return nil},$Module_public_constant$30.$$arity=1),Opal.def(self,"$define_method",$Module_define_method$31=function(e,t){var r,n,a=$Module_define_method$31.$$p,i=a||nil,s=this,o=nil;a&&($Module_define_method$31.$$p=null),a&&($Module_define_method$31.$$p=null),$truthy(void 0===t&&i===nil)&&s.$raise($$($nesting,"ArgumentError"),"tried to create a Proc object without a block"),i=$truthy(r=i)?r:function(){return o=t,$$($nesting,"Proc")["$==="](o)?t:$$($nesting,"Method")["$==="](o)?t.$to_proc().$$unbound:$$($nesting,"UnboundMethod")["$==="](o)?$lambda((n=function(e){var r,a,i=n.$$s||this,s=nil;return r=Opal.slice.call(arguments,0,arguments.length),a=r,s=t.$bind(i),$send(s,"call",Opal.to_a(a))},n.$$s=s,n.$$arity=-1,n)):s.$raise($$($nesting,"TypeError"),"wrong argument type "+i.$class()+" (expected Proc/Method)")}();var c="$"+e;return i.$$jsid=e,i.$$s=null,i.$$def=i,i.$$define_meth=!0,Opal.defn(s,c,i),e},$Module_define_method$31.$$arity=-2),Opal.def(self,"$remove_method",$Module_remove_method$33=function(e){var t,r,n=this;t=Opal.slice.call(arguments,0,arguments.length),r=t;for(var a=0,i=r.length;a<i;a++)Opal.rdef(n,"$"+r[a]);return n},$Module_remove_method$33.$$arity=-1),Opal.def(self,"$singleton_class?",$Module_singleton_class$ques$34=function(){return!!this.$$is_singleton},$Module_singleton_class$ques$34.$$arity=0),Opal.def(self,"$include",$Module_include$35=function(e){var t,r,n=this;t=Opal.slice.call(arguments,0,arguments.length),r=t;for(var a=r.length-1;a>=0;a--){var i=r[a];i.$$is_module||n.$raise($$($nesting,"TypeError"),"wrong argument type "+i.$class()+" (expected Module)"),i.$append_features(n),i.$included(n)}return n},$Module_include$35.$$arity=-1),Opal.def(self,"$included_modules",$Module_included_modules$36=function(){var e=this;return Opal.included_modules(e)},$Module_included_modules$36.$$arity=0),Opal.def(self,"$include?",$Module_include$ques$37=function(e){var t=this;e.$$is_module||t.$raise($$($nesting,"TypeError"),"wrong argument type "+e.$class()+" (expected Module)");var r,n,a,i=Opal.ancestors(t);for(r=0,n=i.length;r<n;r++)if((a=i[r])===e&&a!==t)return!0;return!1},$Module_include$ques$37.$$arity=1),Opal.def(self,"$instance_method",$Module_instance_method$38=function(e){var t=this,r=t.$$prototype["$"+e];return r&&!r.$$stub||t.$raise($$($nesting,"NameError").$new("undefined method `"+e+"' for class `"+t.$name()+"'",e)),$$($nesting,"UnboundMethod").$new(t,r.$$owner||t,r,e)},$Module_instance_method$38.$$arity=1),Opal.def(self,"$instance_methods",$Module_instance_methods$39=function(e){var t=this;return null==e&&(e=!0),$truthy(e)?Opal.instance_methods(t):Opal.own_instance_methods(t)},$Module_instance_methods$39.$$arity=-1),Opal.def(self,"$included",$Module_included$40=function(e){return nil},$Module_included$40.$$arity=1),Opal.def(self,"$extended",$Module_extended$41=function(e){return nil},$Module_extended$41.$$arity=1),Opal.def(self,"$extend_object",$Module_extend_object$42=function(e){return nil},$Module_extend_object$42.$$arity=1),Opal.def(self,"$method_added",$Module_method_added$43=function(e){return Opal.slice.call(arguments,0,arguments.length),nil},$Module_method_added$43.$$arity=-1),Opal.def(self,"$method_removed",$Module_method_removed$44=function(e){return Opal.slice.call(arguments,0,arguments.length),nil},$Module_method_removed$44.$$arity=-1),Opal.def(self,"$method_undefined",$Module_method_undefined$45=function(e){return Opal.slice.call(arguments,0,arguments.length),nil},$Module_method_undefined$45.$$arity=-1),Opal.def(self,"$module_eval",$Module_module_eval$46=function $$module_eval($a){var $iter=$Module_module_eval$46.$$p,block=$iter||nil,$post_args,args,$b,$$47,self=this,string=nil,file=nil,_lineno=nil,default_eval_options=nil,compiling_options=nil,compiled=nil;$iter&&($Module_module_eval$46.$$p=null),$iter&&($Module_module_eval$46.$$p=null),$post_args=Opal.slice.call(arguments,0,arguments.length),args=$post_args,$truthy($truthy($b=block["$nil?"]())?!!Opal.compile:$b)?($truthy($range(1,3,!1)["$cover?"](args.$size()))||$$($nesting,"Kernel").$raise($$($nesting,"ArgumentError"),"wrong number of arguments (0 for 1..3)"),$b=[].concat(Opal.to_a(args)),string=null==$b[0]?nil:$b[0],file=null==$b[1]?nil:$b[1],_lineno=null==$b[2]?nil:$b[2],default_eval_options=$hash2(["file","eval"],{file:$truthy($b=file)?$b:"(eval)",eval:!0}),compiling_options=Opal.hash({arity_check:!1}).$merge(default_eval_options),compiled=$$($nesting,"Opal").$compile(string,compiling_options),block=$send($$($nesting,"Kernel"),"proc",[],($$47=function(){var self=$$47.$$s||this;return function(self){return eval(compiled)}(self)},$$47.$$s=self,$$47.$$arity=0,$$47))):$truthy(args["$any?"]())&&$$($nesting,"Kernel").$raise($$($nesting,"ArgumentError"),"wrong number of arguments ("+args.$size()+" for 0)\n\n  NOTE:If you want to enable passing a String argument please add \"require 'opal-parser'\" to your script\n");var old=block.$$s,result;return block.$$s=null,result=block.apply(self,[self]),block.$$s=old,result},$Module_module_eval$46.$$arity=-1),Opal.alias(self,"class_eval","module_eval"),Opal.def(self,"$module_exec",$Module_module_exec$48=function(e){var t,r,n=$Module_module_exec$48.$$p,a=n||nil,i=this;n&&($Module_module_exec$48.$$p=null),n&&($Module_module_exec$48.$$p=null),t=Opal.slice.call(arguments,0,arguments.length),r=t,a===nil&&i.$raise($$($nesting,"LocalJumpError"),"no block given");var s,o=a.$$s;return a.$$s=null,s=a.apply(i,r),a.$$s=o,s},$Module_module_exec$48.$$arity=-1),Opal.alias(self,"class_exec","module_exec"),Opal.def(self,"$method_defined?",$Module_method_defined$ques$49=function(e){var t=this,r=t.$$prototype["$"+e];return!!r&&!r.$$stub},$Module_method_defined$ques$49.$$arity=1),Opal.def(self,"$module_function",$Module_module_function$50=function(e){var t,r,n=this;if(t=Opal.slice.call(arguments,0,arguments.length),r=t,0===r.length)n.$$module_function=!0;else for(var a=0,i=r.length;a<i;a++){var s=r[a],o="$"+s,c=n.$$prototype[o];Opal.defs(n,o,c)}return n},$Module_module_function$50.$$arity=-1),Opal.def(self,"$name",$Module_name$51=function(){var e=this;if(e.$$full_name)return e.$$full_name;for(var t=[],r=e;r;){if(r.$$name===nil||null==r.$$name)return nil;if(t.unshift(r.$$name),(r=r.$$base_module)===Opal.Object)break}return 0===t.length?nil:e.$$full_name=t.join("::")},$Module_name$51.$$arity=0),Opal.def(self,"$prepend",$Module_prepend$52=function(e){var t,r,n=this;t=Opal.slice.call(arguments,0,arguments.length),r=t,0===r.length&&n.$raise($$($nesting,"ArgumentError"),"wrong number of arguments (given 0, expected 1+)");for(var a=r.length-1;a>=0;a--){var i=r[a];i.$$is_module||n.$raise($$($nesting,"TypeError"),"wrong argument type "+i.$class()+" (expected Module)"),i.$prepend_features(n),i.$prepended(n)}return n},$Module_prepend$52.$$arity=-1),Opal.def(self,"$prepend_features",$Module_prepend_features$53=function(e){var t=this;return t.$$is_module||t.$raise($$($nesting,"TypeError"),"wrong argument type "+t.$class()+" (expected Module)"),Opal.prepend_features(t,e),t},$Module_prepend_features$53.$$arity=1),Opal.def(self,"$prepended",$Module_prepended$54=function(e){return nil},$Module_prepended$54.$$arity=1),Opal.def(self,"$remove_const",$Module_remove_const$55=function(e){var t=this;return Opal.const_remove(t,e)},$Module_remove_const$55.$$arity=1),Opal.def(self,"$to_s",$Module_to_s$56=function(){var e,t=this;return $truthy(e=Opal.Module.$name.call(t))?e:"#<"+(t.$$is_module?"Module":"Class")+":0x"+t.$__id__().$to_s(16)+">"},$Module_to_s$56.$$arity=0),Opal.def(self,"$undef_method",$Module_undef_method$57=function(e){var t,r,n=this;t=Opal.slice.call(arguments,0,arguments.length),r=t;for(var a=0,i=r.length;a<i;a++)Opal.udef(n,"$"+r[a]);return n},$Module_undef_method$57.$$arity=-1),Opal.def(self,"$instance_variables",$Module_instance_variables$58=function(){var e=this,t=nil;Opal.Module.$$nesting=$nesting,t=e.$constants();var r=[];for(var n in e)e.hasOwnProperty(n)&&"$"!==n.charAt(0)&&"constructor"!==n&&!t["$include?"](n)&&r.push("@"+n);return r},$Module_instance_variables$58.$$arity=0),Opal.def(self,"$dup",$Module_dup$59=function(){var e=$Module_dup$59.$$p,t=this,r=nil,n=nil,a=nil,i=nil;for(e&&($Module_dup$59.$$p=null),a=0,i=arguments.length,n=new Array(i);a<i;a++)n[a]=arguments[a];return r=$send(t,Opal.find_super_dispatcher(t,"dup",$Module_dup$59,!1),n,e),r.$copy_class_variables(t),r.$copy_constants(t),r},$Module_dup$59.$$arity=0),Opal.def(self,"$copy_class_variables",$Module_copy_class_variables$60=function(e){var t=this;for(var r in e.$$cvars)t.$$cvars[r]=e.$$cvars[r]},$Module_copy_class_variables$60.$$arity=1),Opal.def(self,"$copy_constants",$Module_copy_constants$61=function(e){var t,r=this,n=e.$$const;for(t in n)Opal.const_set(r,t,n[t])},$Module_copy_constants$61.$$arity=1),nil&&"copy_constants"}($nesting[0],null,$nesting)},Opal.modules["corelib/class"]=function(e){var t=e.top,r=[],n=e.nil,a=(e.const_get_qualified,e.const_get_relative),i=(e.breaker,e.slice,e.klass),s=e.send;return e.add_stubs(["$require","$class_eval","$to_proc","$initialize_copy","$allocate","$name","$to_s"]),t.$require("corelib/module"),function(t,r,o){var c,l,u,f,$,p,d,h=i(t,null,"Class"),_=[h].concat(o);return e.defs(h,"$new",c=function(t){var r=c.$$p,i=r||n;if(r&&(c.$$p=null),r&&(c.$$p=null),null==t&&(t=a(_,"Object")),!t.$$is_class)throw e.TypeError.$new("superclass must be a Class");var o=e.allocate_class(n,t);return t.$inherited(o),function(){i!==n&&s(o,"class_eval",[],i.$to_proc())}(),o},c.$$arity=-1),e.def(h,"$allocate",l=function(){var t=this,r=new t.$$constructor;return r.$$id=e.uid(),r},l.$$arity=0),e.def(h,"$inherited",u=function(e){return n},u.$$arity=1),e.def(h,"$initialize_dup",f=function(e){var t=this;t.$initialize_copy(e),t.$$name=null,t.$$full_name=null},f.$$arity=1),e.def(h,"$new",$=function(t){var r,a,i=$.$$p,s=i||n,o=this;i&&($.$$p=null),i&&($.$$p=null),r=e.slice.call(arguments,0,arguments.length),a=r;var c=o.$allocate();return e.send(c,c.$initialize,a,s),c},$.$$arity=-1),e.def(h,"$superclass",p=function(){return this.$$super||n},p.$$arity=0),e.def(h,"$to_s",d=function(){var t=d.$$p,r=this;t&&(d.$$p=null);var n=r.$$singleton_of;return n&&n.$$is_a_module?"#<Class:"+n.$name()+">":n?"#<Class:#<"+n.$$class.$name()+":0x"+e.id(n).$to_s(16)+">>":s(r,e.find_super_dispatcher(r,"to_s",d,!1),[],null)},d.$$arity=0),n&&"to_s"}(r[0],0,r)},Opal.modules["corelib/basic_object"]=function(Opal){var self=Opal.top,$nesting=[],nil=Opal.nil,$$$=Opal.const_get_qualified,$$=Opal.const_get_relative,$breaker=Opal.breaker,$slice=Opal.slice,$klass=Opal.klass,$truthy=Opal.truthy,$range=Opal.range,$hash2=Opal.hash2,$send=Opal.send;return Opal.add_stubs(["$==","$!","$nil?","$cover?","$size","$raise","$merge","$compile","$proc","$any?","$inspect","$new"]),function($base,$super,$parent_nesting){var self=$klass($base,$super,"BasicObject"),$nesting=[self].concat($parent_nesting),$BasicObject_initialize$1,$BasicObject_$eq_eq$2,$BasicObject_eql$ques$3,$BasicObject___id__$4,$BasicObject___send__$5,$BasicObject_$excl$6,$BasicObject_$not_eq$7,$BasicObject_instance_eval$8,$BasicObject_instance_exec$10,$BasicObject_singleton_method_added$11,$BasicObject_singleton_method_removed$12,$BasicObject_singleton_method_undefined$13,$BasicObject_class$14,$BasicObject_method_missing$15;return Opal.def(self,"$initialize",$BasicObject_initialize$1=function(e){return Opal.slice.call(arguments,0,arguments.length),nil},$BasicObject_initialize$1.$$arity=-1),Opal.def(self,"$==",$BasicObject_$eq_eq$2=function(e){return this===e},$BasicObject_$eq_eq$2.$$arity=1),Opal.def(self,"$eql?",$BasicObject_eql$ques$3=function(e){return this["$=="](e)},$BasicObject_eql$ques$3.$$arity=1),Opal.alias(self,"equal?","=="),Opal.def(self,"$__id__",$BasicObject___id__$4=function(){var e=this;return null!=e.$$id?e.$$id:(Opal.defineProperty(e,"$$id",Opal.uid()),e.$$id)},$BasicObject___id__$4.$$arity=0),Opal.def(self,"$__send__",$BasicObject___send__$5=function(e,t){var r,n,a=$BasicObject___send__$5.$$p,i=a||nil,s=this;a&&($BasicObject___send__$5.$$p=null),a&&($BasicObject___send__$5.$$p=null),r=Opal.slice.call(arguments,1,arguments.length),n=r;var o=s["$"+e];return o?(i!==nil&&(o.$$p=i),o.apply(s,n)):(i!==nil&&(s.$method_missing.$$p=i),s.$method_missing.apply(s,[e].concat(n)))},$BasicObject___send__$5.$$arity=-2),Opal.def(self,"$!",$BasicObject_$excl$6=function(){return!1},$BasicObject_$excl$6.$$arity=0),Opal.def(self,"$!=",$BasicObject_$not_eq$7=function(e){return this["$=="](e)["$!"]()},$BasicObject_$not_eq$7.$$arity=1),Opal.def(self,"$instance_eval",$BasicObject_instance_eval$8=function $$instance_eval($a){var $iter=$BasicObject_instance_eval$8.$$p,block=$iter||nil,$post_args,args,$b,$$9,self=this,string=nil,file=nil,_lineno=nil,default_eval_options=nil,compiling_options=nil,compiled=nil;$iter&&($BasicObject_instance_eval$8.$$p=null),$iter&&($BasicObject_instance_eval$8.$$p=null),$post_args=Opal.slice.call(arguments,0,arguments.length),args=$post_args,$truthy($truthy($b=block["$nil?"]())?!!Opal.compile:$b)?($truthy($range(1,3,!1)["$cover?"](args.$size()))||$$$("::","Kernel").$raise($$$("::","ArgumentError"),"wrong number of arguments (0 for 1..3)"),$b=[].concat(Opal.to_a(args)),string=null==$b[0]?nil:$b[0],file=null==$b[1]?nil:$b[1],_lineno=null==$b[2]?nil:$b[2],default_eval_options=$hash2(["file","eval"],{file:$truthy($b=file)?$b:"(eval)",eval:!0}),compiling_options=Opal.hash({arity_check:!1}).$merge(default_eval_options),compiled=$$$("::","Opal").$compile(string,compiling_options),block=$send($$$("::","Kernel"),"proc",[],($$9=function(){var self=$$9.$$s||this;return function(self){return eval(compiled)}(self)},$$9.$$s=self,$$9.$$arity=0,$$9))):$truthy(args["$any?"]())&&$$$("::","Kernel").$raise($$$("::","ArgumentError"),"wrong number of arguments ("+args.$size()+" for 0)");var old=block.$$s,result;if(block.$$s=null,self.$$is_a_module){self.$$eval=!0;try{result=block.call(self,self)}finally{self.$$eval=!1}}else result=block.call(self,self);return block.$$s=old,result},$BasicObject_instance_eval$8.$$arity=-1),Opal.def(self,"$instance_exec",$BasicObject_instance_exec$10=function(e){var t,r,n=$BasicObject_instance_exec$10.$$p,a=n||nil,i=this;n&&($BasicObject_instance_exec$10.$$p=null),n&&($BasicObject_instance_exec$10.$$p=null),t=Opal.slice.call(arguments,0,arguments.length),r=t,$truthy(a)||$$$("::","Kernel").$raise($$$("::","ArgumentError"),"no block given");var s,o=a.$$s;if(a.$$s=null,i.$$is_a_module){i.$$eval=!0;try{s=a.apply(i,r)}finally{i.$$eval=!1}}else s=a.apply(i,r);return a.$$s=o,s},$BasicObject_instance_exec$10.$$arity=-1),Opal.def(self,"$singleton_method_added",$BasicObject_singleton_method_added$11=function(e){return Opal.slice.call(arguments,0,arguments.length),nil},$BasicObject_singleton_method_added$11.$$arity=-1),Opal.def(self,"$singleton_method_removed",$BasicObject_singleton_method_removed$12=function(e){return Opal.slice.call(arguments,0,arguments.length),nil},$BasicObject_singleton_method_removed$12.$$arity=-1),Opal.def(self,"$singleton_method_undefined",$BasicObject_singleton_method_undefined$13=function(e){return Opal.slice.call(arguments,0,arguments.length),nil},$BasicObject_singleton_method_undefined$13.$$arity=-1),Opal.def(self,"$class",$BasicObject_class$14=function(){return this.$$class},$BasicObject_class$14.$$arity=0),Opal.def(self,"$method_missing",$BasicObject_method_missing$15=function(e,t){var r,n=$BasicObject_method_missing$15.$$p,a=this,i=nil;return n&&($BasicObject_method_missing$15.$$p=null),n&&($BasicObject_method_missing$15.$$p=null),r=Opal.slice.call(arguments,1,arguments.length),r,i=function(){return $truthy(a.$inspect&&!a.$inspect.$$stub)?"undefined method `"+e+"' for "+a.$inspect()+":"+a.$$class:"undefined method `"+e+"' for "+a.$$class}(),$$$("::","Kernel").$raise($$$("::","NoMethodError").$new(i,e))},$BasicObject_method_missing$15.$$arity=-2),nil&&"method_missing"}($nesting[0],null,$nesting)},Opal.modules["corelib/kernel"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e<=t:e["$<="](t)}var r=(e.top,[]),n=e.nil,a=e.const_get_qualified,i=e.const_get_relative,s=(e.breaker,e.slice,e.module),o=e.truthy,c=e.gvars,l=e.hash2,u=e.send,f=e.klass;return e.add_stubs(["$raise","$new","$inspect","$!","$=~","$==","$object_id","$class","$coerce_to?","$<<","$allocate","$copy_instance_variables","$copy_singleton_methods","$initialize_clone","$initialize_copy","$define_method","$singleton_class","$to_proc","$initialize_dup","$for","$empty?","$pop","$call","$coerce_to","$append_features","$extend_object","$extended","$__id__","$to_s","$instance_variable_name!","$respond_to?","$to_int","$coerce_to!","$Integer","$nil?","$===","$enum_for","$result","$any?","$print","$format","$puts","$each","$<=","$length","$[]","$exception","$is_a?","$rand","$respond_to_missing?","$try_convert!","$expand_path","$join","$start_with?","$new_seed","$srand","$sym","$arg","$open","$include"]),function(r,f){var $,p,d,h,_,m,y,g,v,b,x,w,A,k,E,S,N,C,I,O,L,P,M,T,B,j,F,R,D,z,q,U,H,G,Y,V,Q,X,W,J,K,Z,ee,te,re,ne,ae,ie,se,oe,ce,le,ue,fe,$e,pe,de,he,_e,me,ye,ge,ve,be,xe,we=s(r,"Kernel"),Ae=[we].concat(f);e.def(we,"$method_missing",$=function(t,r){var n,a,s=$.$$p,o=this;return s&&($.$$p=null),s&&($.$$p=null),n=e.slice.call(arguments,1,arguments.length),a=n,o.$raise(i(Ae,"NoMethodError").$new("undefined method `"+t+"' for "+o.$inspect(),t,a))},$.$$arity=-2),e.def(we,"$=~",p=function(e){return!1},p.$$arity=1),e.def(we,"$!~",d=function(e){return this["$=~"](e)["$!"]()},d.$$arity=1),e.def(we,"$===",h=function(e){var t,r=this;return o(t=r.$object_id()["$=="](e.$object_id()))?t:r["$=="](e)},h.$$arity=1),e.def(we,"$<=>",_=function(e){var t=this;t.$$comparable=!0;var r=t["$=="](e);return r&&r!==n?0:n},_.$$arity=1),e.def(we,"$method",m=function(e){var t=this,r=t["$"+e];return r&&!r.$$stub||t.$raise(i(Ae,"NameError").$new("undefined method `"+e+"' for class `"+t.$class()+"'",e)),i(Ae,"Method").$new(t,r.$$owner||t.$class(),r,e)},m.$$arity=1),e.def(we,"$methods",y=function(t){var r=this;return null==t&&(t=!0),o(t)?e.methods(r):e.own_methods(r)},y.$$arity=-1),e.def(we,"$public_methods",g=function(t){var r=this;return null==t&&(t=!0),o(t)?e.methods(r):e.receiver_methods(r)},g.$$arity=-1),e.def(we,"$Array",v=function(e){var t;return e===n?[]:e.$$is_array?e:(t=i(Ae,"Opal")["$coerce_to?"](e,i(Ae,"Array"),"to_ary"))!==n?t:(t=i(Ae,"Opal")["$coerce_to?"](e,i(Ae,"Array"),"to_a"),t!==n?t:[e])},v.$$arity=1),e.def(we,"$at_exit",b=function(){var e,t=b.$$p,r=t||n;return null==c.__at_exit__&&(c.__at_exit__=n),t&&(b.$$p=null),t&&(b.$$p=null),c.__at_exit__=o(e=c.__at_exit__)?e:[],c.__at_exit__["$<<"](r)},b.$$arity=0),e.def(we,"$caller",x=function(t){var r;return r=e.slice.call(arguments,0,arguments.length),r,[]},x.$$arity=-1),e.def(we,"$class",w=function(){return this.$$class},w.$$arity=0),e.def(we,"$copy_instance_variables",A=function(e){var t,r,n,a=this,i=Object.keys(e);for(t=0,r=i.length;t<r;t++)n=i[t],"$"!==n.charAt(0)&&e.hasOwnProperty(n)&&(a[n]=e[n])},A.$$arity=1),e.def(we,"$copy_singleton_methods",k=function(t){var r,n,a,i,s=this;if(t.hasOwnProperty("$$meta")){var o=e.get_singleton_class(t),c=e.get_singleton_class(s);for(a=Object.getOwnPropertyNames(o.$$prototype),r=0,i=a.length;r<i;r++)n=a[r],e.is_method(n)&&(c.$$prototype[n]=o.$$prototype[n]);c.$$const=Object.assign({},o.$$const),Object.setPrototypeOf(c.$$prototype,Object.getPrototypeOf(o.$$prototype))}for(r=0,a=Object.getOwnPropertyNames(t),i=a.length;r<i;r++)n=a[r],"$"===n.charAt(0)&&"$"!==n.charAt(1)&&t.hasOwnProperty(n)&&(s[n]=t[n])},k.$$arity=1),e.def(we,"$clone",E=function(t){var r,a=this,i=n;if(null==t)t=l([],{});else if(!t.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return r=t.$$smap.freeze,null==r&&(r=!0),i=a.$class().$allocate(),i.$copy_instance_variables(a),i.$copy_singleton_methods(a),i.$initialize_clone(a),i},E.$$arity=-1),e.def(we,"$initialize_clone",S=function(e){return this.$initialize_copy(e)},S.$$arity=1),e.def(we,"$define_singleton_method",N=function(e,t){var r=N.$$p,a=r||n,i=this;return r&&(N.$$p=null),r&&(N.$$p=null),u(i.$singleton_class(),"define_method",[e,t],a.$to_proc())},N.$$arity=-2),e.def(we,"$dup",C=function(){var e=this,t=n;return t=e.$class().$allocate(),t.$copy_instance_variables(e),t.$initialize_dup(e),t},C.$$arity=0),e.def(we,"$initialize_dup",I=function(e){return this.$initialize_copy(e)},I.$$arity=1),e.def(we,"$enum_for",O=function(t,r){var a,s,o,c=O.$$p,l=c||n,f=this;return c&&(O.$$p=null),c&&(O.$$p=null),a=e.slice.call(arguments,0,arguments.length),a.length>0&&(s=a[0],a.splice(0,1)),null==s&&(s="each"),o=a,u(i(Ae,"Enumerator"),"for",[f,s].concat(e.to_a(o)),l.$to_proc())},O.$$arity=-1),e.alias(we,"to_enum","enum_for"),e.def(we,"$equal?",L=function(e){return this===e},L.$$arity=1),e.def(we,"$exit",P=function(t){var r,a=n;for(null==c.__at_exit__&&(c.__at_exit__=n),null==t&&(t=!0),c.__at_exit__=o(r=c.__at_exit__)?r:[];!o(c.__at_exit__["$empty?"]());)a=c.__at_exit__.$pop(),a.$call();return t=t.$$is_boolean?t?0:1:i(Ae,"Opal").$coerce_to(t,i(Ae,"Integer"),"to_int"),e.exit(t),n},P.$$arity=-1),e.def(we,"$extend",M=function(t){var r,n,a=this;r=e.slice.call(arguments,0,arguments.length),n=r;for(var s=a.$singleton_class(),o=n.length-1;o>=0;o--){var c=n[o];c.$$is_module||a.$raise(i(Ae,"TypeError"),"wrong argument type "+c.$class()+" (expected Module)"),c.$append_features(s),c.$extend_object(a),c.$extended(a)}return a},M.$$arity=-1),e.def(we,"$hash",T=function(){return this.$__id__()},T.$$arity=0),e.def(we,"$initialize_copy",B=function(e){return n},B.$$arity=1),e.def(we,"$inspect",j=function(){return this.$to_s()},j.$$arity=0),e.def(we,"$instance_of?",F=function(e){var t=this;return e.$$is_class||e.$$is_module||t.$raise(i(Ae,"TypeError"),"class or module required"),t.$$class===e},F.$$arity=1),e.def(we,"$instance_variable_defined?",R=function(t){var r=this;return t=i(Ae,"Opal")["$instance_variable_name!"](t),e.hasOwnProperty.call(r,t.substr(1))},R.$$arity=1),e.def(we,"$instance_variable_get",D=function(t){var r=this;t=i(Ae,"Opal")["$instance_variable_name!"](t);var a=r[e.ivar(t.substr(1))];return null==a?n:a},D.$$arity=1),e.def(we,"$instance_variable_set",z=function(t,r){var n=this;return t=i(Ae,"Opal")["$instance_variable_name!"](t),
n[e.ivar(t.substr(1))]=r},z.$$arity=2),e.def(we,"$remove_instance_variable",q=function(t){var r=this;t=i(Ae,"Opal")["$instance_variable_name!"](t);var n,a=e.ivar(t.substr(1));return r.hasOwnProperty(a)?(n=r[a],delete r[a],n):r.$raise(i(Ae,"NameError"),"instance variable "+t+" not defined")},q.$$arity=1),e.def(we,"$instance_variables",U=function(){var e,t=this,r=[];for(var n in t)t.hasOwnProperty(n)&&"$"!==n.charAt(0)&&(e="$"===n.substr(-1)?n.slice(0,n.length-1):n,r.push("@"+e));return r},U.$$arity=0),e.def(we,"$Integer",H=function(e,t){var r,a,s,o=this;return e.$$is_string?"0"===e?0:(void 0===t?t=0:(1===(t=i(Ae,"Opal").$coerce_to(t,i(Ae,"Integer"),"to_int"))||t<0||t>36)&&o.$raise(i(Ae,"ArgumentError"),"invalid radix "+t),a=e.toLowerCase(),a=a.replace(/(\d)_(?=\d)/g,"$1"),a=a.replace(/^(\s*[+-]?)(0[bodx]?)/,function(r,n,a){switch(a){case"0b":if(0===t||2===t)return t=2,n;case"0":case"0o":if(0===t||8===t)return t=8,n;case"0d":if(0===t||10===t)return t=10,n;case"0x":if(0===t||16===t)return t=16,n}o.$raise(i(Ae,"ArgumentError"),'invalid value for Integer(): "'+e+'"')}),t=0===t?10:t,s="0-"+(t<=10?t-1:"9a-"+String.fromCharCode(t-11+97)),new RegExp("^\\s*[+-]?["+s+"]+\\s*$").test(a)||o.$raise(i(Ae,"ArgumentError"),'invalid value for Integer(): "'+e+'"'),r=parseInt(a,t),isNaN(r)&&o.$raise(i(Ae,"ArgumentError"),'invalid value for Integer(): "'+e+'"'),r):(void 0!==t&&o.$raise(i(Ae,"ArgumentError"),"base specified for non string value"),e===n&&o.$raise(i(Ae,"TypeError"),"can't convert nil into Integer"),e.$$is_number?((e===1/0||e===-1/0||isNaN(e))&&o.$raise(i(Ae,"FloatDomainError"),e),Math.floor(e)):e["$respond_to?"]("to_int")&&(r=e.$to_int())!==n?r:i(Ae,"Opal")["$coerce_to!"](e,i(Ae,"Integer"),"to_i"))},H.$$arity=-2),e.def(we,"$Float",G=function(e){var t,r=this;return e===n&&r.$raise(i(Ae,"TypeError"),"can't convert nil into Float"),e.$$is_string?(t=e.toString(),t=t.replace(/(\d)_(?=\d)/g,"$1"),/^\s*[-+]?0[xX][0-9a-fA-F]+\s*$/.test(t)?r.$Integer(t):(/^\s*[-+]?[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?\s*$/.test(t)||r.$raise(i(Ae,"ArgumentError"),'invalid value for Float(): "'+e+'"'),parseFloat(t))):i(Ae,"Opal")["$coerce_to!"](e,i(Ae,"Float"),"to_f")},G.$$arity=1),e.def(we,"$Hash",Y=function(e){var t;return o(o(t=e["$nil?"]())?t:e["$=="]([]))?l([],{}):o(i(Ae,"Hash")["$==="](e))?e:i(Ae,"Opal")["$coerce_to!"](e,i(Ae,"Hash"),"to_hash")},Y.$$arity=1),e.def(we,"$is_a?",V=function(t){var r=this;return t.$$is_class||t.$$is_module||r.$raise(i(Ae,"TypeError"),"class or module required"),e.is_a(r,t)},V.$$arity=1),e.def(we,"$itself",Q=function(){return this},Q.$$arity=0),e.alias(we,"kind_of?","is_a?"),e.def(we,"$lambda",X=function(){var t=X.$$p,r=t||n;return t&&(X.$$p=null),t&&(X.$$p=null),e.lambda(r)},X.$$arity=0),e.def(we,"$load",W=function(t){return t=i(Ae,"Opal")["$coerce_to!"](t,i(Ae,"String"),"to_str"),e.load(t)},W.$$arity=1),e.def(we,"$loop",J=function(){var t,r=J.$$p,s=r||n,c=this,l=n;if(r&&(J.$$p=null),s===n)return u(c,"enum_for",["loop"],(t=function(){t.$$s;return a(i(Ae,"Float"),"INFINITY")},t.$$s=c,t.$$arity=0,t));for(;o(!0);)try{e.yieldX(s,[])}catch(t){if(!e.rescue(t,[i(Ae,"StopIteration")]))throw t;l=t;try{return l.$result()}finally{e.pop_exception()}}return c},J.$$arity=0),e.def(we,"$nil?",K=function(){return!1},K.$$arity=0),e.alias(we,"object_id","__id__"),e.def(we,"$printf",Z=function(t){var r,a,i=this;return r=e.slice.call(arguments,0,arguments.length),a=r,o(a["$any?"]())&&i.$print(u(i,"format",e.to_a(a))),n},Z.$$arity=-1),e.def(we,"$proc",ee=function(){var e=ee.$$p,t=e||n,r=this;return e&&(ee.$$p=null),e&&(ee.$$p=null),o(t)||r.$raise(i(Ae,"ArgumentError"),"tried to create Proc object without a block"),t.$$is_lambda=!1,t},ee.$$arity=0),e.def(we,"$puts",te=function(t){var r,a;return null==c.stdout&&(c.stdout=n),r=e.slice.call(arguments,0,arguments.length),a=r,u(c.stdout,"puts",e.to_a(a))},te.$$arity=-1),e.def(we,"$p",re=function(r){var a,i,s,l=this;return a=e.slice.call(arguments,0,arguments.length),i=a,u(i,"each",[],(s=function(e){s.$$s;return null==c.stdout&&(c.stdout=n),null==e&&(e=n),c.stdout.$puts(e.$inspect())},s.$$s=l,s.$$arity=1,s)),o(t(i.$length(),1))?i["$[]"](0):i},re.$$arity=-1),e.def(we,"$print",ne=function(t){var r,a;return null==c.stdout&&(c.stdout=n),r=e.slice.call(arguments,0,arguments.length),a=r,u(c.stdout,"print",e.to_a(a))},ne.$$arity=-1),e.def(we,"$warn",ae=function(t){var r,a,i;return null==c.VERBOSE&&(c.VERBOSE=n),null==c.stderr&&(c.stderr=n),r=e.slice.call(arguments,0,arguments.length),a=r,o(o(i=c.VERBOSE["$nil?"]())?i:a["$empty?"]())?n:u(c.stderr,"puts",e.to_a(a))},ae.$$arity=-1),e.def(we,"$raise",ie=function(t,r,a){if(null==c["!"]&&(c["!"]=n),null==r&&(r=n),null==a&&(a=n),null==t&&c["!"]!==n)throw c["!"];throw null==t?t=i(Ae,"RuntimeError").$new():t.$$is_string?t=i(Ae,"RuntimeError").$new(t):t.$$is_class&&t["$respond_to?"]("exception")?t=t.$exception(r):t["$is_a?"](i(Ae,"Exception"))||(t=i(Ae,"TypeError").$new("exception class/object expected")),c["!"]!==n&&e.exceptions.push(c["!"]),c["!"]=t,t},ie.$$arity=-1),e.alias(we,"fail","raise"),e.def(we,"$rand",se=function(e){return void 0===e?a(i(Ae,"Random"),"DEFAULT").$rand():(e.$$is_number&&(e<0&&(e=Math.abs(e)),e%1!=0&&(e=e.$to_i()),0===e&&(e=void 0)),a(i(Ae,"Random"),"DEFAULT").$rand(e))},se.$$arity=-1),e.def(we,"$respond_to?",oe=function(e,t){var r=this;if(null==t&&(t=!1),o(r["$respond_to_missing?"](e,t)))return!0;var n=r["$"+e];return"function"==typeof n&&!n.$$stub},oe.$$arity=-2),e.def(we,"$respond_to_missing?",ce=function(e,t){return null==t&&(t=!1),!1},ce.$$arity=-2),e.def(we,"$require",le=function(t){return t=i(Ae,"Opal")["$coerce_to!"](t,i(Ae,"String"),"to_str"),e.require(t)},le.$$arity=1),e.def(we,"$require_relative",ue=function(t){return i(Ae,"Opal")["$try_convert!"](t,i(Ae,"String"),"to_str"),t=i(Ae,"File").$expand_path(i(Ae,"File").$join(e.current_file,"..",t)),e.require(t)},ue.$$arity=1),e.def(we,"$require_tree",fe=function(t){var r=[];t=i(Ae,"File").$expand_path(t),"."===(t=e.normalize(t))&&(t="");for(var n in e.modules)n["$start_with?"](t)&&r.push([n,e.require(n)]);return r},fe.$$arity=1),e.alias(we,"send","__send__"),e.alias(we,"public_send","__send__"),e.def(we,"$singleton_class",$e=function(){var t=this;return e.get_singleton_class(t)},$e.$$arity=0),e.def(we,"$sleep",pe=function(t){var r=this;null==t&&(t=n),t===n&&r.$raise(i(Ae,"TypeError"),"can't convert NilClass into time interval"),t.$$is_number||r.$raise(i(Ae,"TypeError"),"can't convert "+t.$class()+" into time interval"),t<0&&r.$raise(i(Ae,"ArgumentError"),"time interval must be positive");for(var a=e.global.performance?function(){return performance.now()}:function(){return new Date},s=a();a()-s<=1e3*t;);return t},pe.$$arity=-1),e.def(we,"$srand",de=function(e){return null==e&&(e=i(Ae,"Random").$new_seed()),i(Ae,"Random").$srand(e)},de.$$arity=-1),e.def(we,"$String",he=function(e){var t;return o(t=i(Ae,"Opal")["$coerce_to?"](e,i(Ae,"String"),"to_str"))?t:i(Ae,"Opal")["$coerce_to!"](e,i(Ae,"String"),"to_s")},he.$$arity=1),e.def(we,"$tap",_e=function(){var t=_e.$$p,r=t||n,a=this;return t&&(_e.$$p=null),t&&(_e.$$p=null),e.yield1(r,a),a},_e.$$arity=0),e.def(we,"$to_proc",me=function(){return this},me.$$arity=0),e.def(we,"$to_s",ye=function(){var e=this;return"#<"+e.$class()+":0x"+e.$__id__().$to_s(16)+">"},ye.$$arity=0),e.def(we,"$catch",ge=function(t){var r=ge.$$p,a=r||n,s=this,o=n;r&&(ge.$$p=null);try{return e.yieldX(a,[])}catch(r){if(!e.rescue(r,[i(Ae,"UncaughtThrowError")]))throw r;o=r;try{return o.$sym()["$=="](t)?o.$arg():s.$raise()}finally{e.pop_exception()}}},ge.$$arity=1),e.def(we,"$throw",ve=function(t){var r,n,a=this;return r=e.slice.call(arguments,0,arguments.length),n=r,a.$raise(i(Ae,"UncaughtThrowError"),n)},ve.$$arity=-1),e.def(we,"$open",be=function(t){var r,a,s=be.$$p,o=s||n;return s&&(be.$$p=null),s&&(be.$$p=null),r=e.slice.call(arguments,0,arguments.length),a=r,u(i(Ae,"File"),"open",e.to_a(a),o.$to_proc())},be.$$arity=-1),e.def(we,"$yield_self",xe=function(){var t,r=xe.$$p,a=r||n,i=this;return r&&(xe.$$p=null),a===n?u(i,"enum_for",["yield_self"],(t=function(){t.$$s;return 1},t.$$s=i,t.$$arity=0,t)):e.yield1(a,i)},xe.$$arity=0)}(r[0],r),function(e,t,r){var n=f(e,null,"Object"),a=[n].concat(r);return n.$include(i(a,"Kernel"))}(r[0],0,r)},Opal.modules["corelib/error"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}var n=(e.top,[]),a=e.nil,i=(e.const_get_qualified,e.const_get_relative),s=(e.breaker,e.slice,e.klass),o=e.send,c=e.truthy,l=e.module,u=e.hash2;return e.add_stubs(["$new","$clone","$to_s","$empty?","$class","$raise","$+","$attr_reader","$[]","$>","$length","$inspect"]),function(t,r,n){var l,u,f,$,p,d,h,_,m,y=s(t,r,"Exception"),g=[y].concat(n);y.$$prototype.message=a;var v;e.defs(y,"$new",l=function(t){var r,n,i=this;r=e.slice.call(arguments,0,arguments.length),n=r;var s=n.length>0?n[0]:a,o=new i.$$constructor(s);return o.name=i.$$name,o.message=s,e.send(o,o.$initialize,n),e.config.enable_stack_trace&&Error.captureStackTrace&&Error.captureStackTrace(o,v),o},l.$$arity=-1),v=y.$new,e.defs(y,"$exception",u=function(t){var r,n,a=this;return r=e.slice.call(arguments,0,arguments.length),n=r,o(a,"new",e.to_a(n))},u.$$arity=-1),e.def(y,"$initialize",f=function(t){var r,n,i=this;return r=e.slice.call(arguments,0,arguments.length),n=r,i.message=n.length>0?n[0]:a},f.$$arity=-1),e.def(y,"$backtrace",$=function(){var e=this;if(e.backtrace)return e.backtrace;var t=e.stack;return"string"==typeof t?t.split("\n").slice(0,15):t?t.slice(0,15):[]},$.$$arity=0),e.def(y,"$exception",p=function(e){var t=this;if(null==e&&(e=a),e===a||t===e)return t;var r=t.$clone();return r.message=e,r.stack=t.stack,r},p.$$arity=-1),e.def(y,"$message",d=function(){return this.$to_s()},d.$$arity=0),e.def(y,"$inspect",h=function(){var e=this,t=a;return t=e.$to_s(),c(t["$empty?"]())?e.$class().$to_s():"#<"+e.$class().$to_s()+": "+e.$to_s()+">"},h.$$arity=0),e.def(y,"$set_backtrace",_=function(e){var t,r,n=this,s=!0;if(e===a)n.backtrace=a,n.stack="";else if(e.$$is_string)n.backtrace=[e],n.stack=e;else{if(e.$$is_array){for(t=0,r=e.length;t<r;t++)if(!e[t].$$is_string){s=!1;break}}else s=!1;!1===s&&n.$raise(i(g,"TypeError"),"backtrace must be Array of String"),n.backtrace=e,n.stack=e.join("\n")}return e},_.$$arity=1),e.def(y,"$to_s",m=function(){var e,t,r=this;return c(e=c(t=r.message)?r.message.$to_s():t)?e:r.$class().$to_s()},m.$$arity=0)}(n[0],Error,n),function(e,t,r){var n=s(e,t,"ScriptError");[n].concat(r)}(n[0],i(n,"Exception"),n),function(e,t,r){var n=s(e,t,"SyntaxError");[n].concat(r)}(n[0],i(n,"ScriptError"),n),function(e,t,r){var n=s(e,t,"LoadError");[n].concat(r)}(n[0],i(n,"ScriptError"),n),function(e,t,r){var n=s(e,t,"NotImplementedError");[n].concat(r)}(n[0],i(n,"ScriptError"),n),function(e,t,r){var n=s(e,t,"SystemExit");[n].concat(r)}(n[0],i(n,"Exception"),n),function(e,t,r){var n=s(e,t,"NoMemoryError");[n].concat(r)}(n[0],i(n,"Exception"),n),function(e,t,r){var n=s(e,t,"SignalException");[n].concat(r)}(n[0],i(n,"Exception"),n),function(e,t,r){var n=s(e,t,"Interrupt");[n].concat(r)}(n[0],i(n,"Exception"),n),function(e,t,r){var n=s(e,t,"SecurityError");[n].concat(r)}(n[0],i(n,"Exception"),n),function(e,t,r){var n=s(e,t,"StandardError");[n].concat(r)}(n[0],i(n,"Exception"),n),function(e,t,r){var n=s(e,t,"EncodingError");[n].concat(r)}(n[0],i(n,"StandardError"),n),function(e,t,r){var n=s(e,t,"ZeroDivisionError");[n].concat(r)}(n[0],i(n,"StandardError"),n),function(e,t,r){var n=s(e,t,"NameError");[n].concat(r)}(n[0],i(n,"StandardError"),n),function(e,t,r){var n=s(e,t,"NoMethodError");[n].concat(r)}(n[0],i(n,"NameError"),n),function(e,t,r){var n=s(e,t,"RuntimeError");[n].concat(r)}(n[0],i(n,"StandardError"),n),function(e,t,r){var n=s(e,t,"FrozenError");[n].concat(r)}(n[0],i(n,"RuntimeError"),n),function(e,t,r){var n=s(e,t,"LocalJumpError");[n].concat(r)}(n[0],i(n,"StandardError"),n),function(e,t,r){var n=s(e,t,"TypeError");[n].concat(r)}(n[0],i(n,"StandardError"),n),function(e,t,r){var n=s(e,t,"ArgumentError");[n].concat(r)}(n[0],i(n,"StandardError"),n),function(e,t,r){var n=s(e,t,"IndexError");[n].concat(r)}(n[0],i(n,"StandardError"),n),function(e,t,r){var n=s(e,t,"StopIteration");[n].concat(r)}(n[0],i(n,"IndexError"),n),function(e,t,r){var n=s(e,t,"KeyError");[n].concat(r)}(n[0],i(n,"IndexError"),n),function(e,t,r){var n=s(e,t,"RangeError");[n].concat(r)}(n[0],i(n,"StandardError"),n),function(e,t,r){var n=s(e,t,"FloatDomainError");[n].concat(r)}(n[0],i(n,"RangeError"),n),function(e,t,r){var n=s(e,t,"IOError");[n].concat(r)}(n[0],i(n,"StandardError"),n),function(e,t,r){var n=s(e,t,"SystemCallError");[n].concat(r)}(n[0],i(n,"StandardError"),n),function(r,n){var u=l(r,"Errno"),f=[u].concat(n);!function(r,n,i){var l,u=s(r,n,"EINVAL");[u].concat(i);e.defs(u,"$new",l=function(r){var n=l.$$p,i=this,s=a;return n&&(l.$$p=null),null==r&&(r=a),s="Invalid argument",c(r)&&(s=t(s," - "+r)),o(i,e.find_super_dispatcher(i,"new",l,!1,i.$$class.$$prototype),[s],null)},l.$$arity=-1)}(f[0],i(f,"SystemCallError"),f)}(n[0],n),function(t,n,i){var l,u=s(t,n,"UncaughtThrowError");[u].concat(i);u.$$prototype.sym=a,u.$attr_reader("sym","arg"),e.def(u,"$initialize",l=function(t){var n=l.$$p,a=this;return n&&(l.$$p=null),a.sym=t["$[]"](0),c(r(t.$length(),1))&&(a.arg=t["$[]"](1)),o(a,e.find_super_dispatcher(a,"initialize",l,!1),["uncaught throw "+a.sym.$inspect()],null)},l.$$arity=1)}(n[0],i(n,"ArgumentError"),n),function(t,r,n){var i,c=s(t,null,"NameError");[c].concat(n);c.$attr_reader("name"),e.def(c,"$initialize",i=function(t,r){var n=i.$$p,s=this;return n&&(i.$$p=null),null==r&&(r=a),o(s,e.find_super_dispatcher(s,"initialize",i,!1),[t],null),s.name=r},i.$$arity=-2)}(n[0],0,n),function(t,r,n){var i,c=s(t,null,"NoMethodError");[c].concat(n);c.$attr_reader("args"),e.def(c,"$initialize",i=function(t,r,n){var s=i.$$p,c=this;return s&&(i.$$p=null),null==r&&(r=a),null==n&&(n=[]),o(c,e.find_super_dispatcher(c,"initialize",i,!1),[t,r],null),c.args=n},i.$$arity=-2)}(n[0],0,n),function(e,t,r){var n=s(e,null,"StopIteration");[n].concat(r);n.$attr_reader("result")}(n[0],0,n),function(t,r,n){var l,f,$,p=s(t,null,"KeyError"),d=[p].concat(n);p.$$prototype.receiver=p.$$prototype.key=a,e.def(p,"$initialize",l=function(t,r){var n,i,s=l.$$p,c=this;if(s&&(l.$$p=null),null==r)r=u([],{});else if(!r.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return n=r.$$smap.receiver,null==n&&(n=a),i=r.$$smap.key,null==i&&(i=a),o(c,e.find_super_dispatcher(c,"initialize",l,!1),[t],null),c.receiver=n,c.key=i},l.$$arity=-2),e.def(p,"$receiver",f=function(){var e,t=this;return c(e=t.receiver)?e:t.$raise(i(d,"ArgumentError"),"no receiver is available")},f.$$arity=0),e.def(p,"$key",$=function(){var e,t=this;return c(e=t.key)?e:t.$raise(i(d,"ArgumentError"),"no key is available")},$.$$arity=0)}(n[0],0,n),function(e,t){var r=l(e,"JS"),n=[r].concat(t);!function(e,t,r){var n=s(e,null,"Error");[n].concat(r)}(n[0],0,n)}(n[0],n)},Opal.modules["corelib/constants"]=function(e){var t=(e.top,[]),r=(e.nil,e.const_get_qualified,e.const_get_relative);e.breaker,e.slice;return e.const_set(t[0],"RUBY_PLATFORM","opal"),e.const_set(t[0],"RUBY_ENGINE","opal"),e.const_set(t[0],"RUBY_VERSION","2.5.3"),e.const_set(t[0],"RUBY_ENGINE_VERSION","1.0.0"),e.const_set(t[0],"RUBY_RELEASE_DATE","2019-05-12"),e.const_set(t[0],"RUBY_PATCHLEVEL",0),e.const_set(t[0],"RUBY_REVISION",0),e.const_set(t[0],"RUBY_COPYRIGHT","opal - Copyright (C) 2013-2019 Adam Beynon and the Opal contributors"),e.const_set(t[0],"RUBY_DESCRIPTION","opal "+r(t,"RUBY_ENGINE_VERSION")+" ("+r(t,"RUBY_RELEASE_DATE")+" revision "+r(t,"RUBY_REVISION")+")")},Opal.modules["opal/base"]=function(e){var t=e.top;e.nil,e.const_get_qualified,e.const_get_relative,e.breaker,e.slice;return e.add_stubs(["$require"]),t.$require("corelib/runtime"),t.$require("corelib/helpers"),t.$require("corelib/module"),t.$require("corelib/class"),t.$require("corelib/basic_object"),t.$require("corelib/kernel"),t.$require("corelib/error"),t.$require("corelib/constants")},Opal.modules["corelib/nil"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}var r=(e.top,[]),n=e.nil,a=(e.const_get_qualified,e.const_get_relative),i=(e.breaker,e.slice,e.klass),s=e.hash2,o=e.truthy;return e.add_stubs(["$raise","$name","$new","$>","$length","$Rational"]),function(r,c,l){var u,f,$,p,d,h,_,m,y,g,v,b,x,w,A,k,E,S,N=i(r,null,"NilClass"),C=[N].concat(l);N.$$prototype.$$meta=N,function(t,r){var n,i=[t].concat(r);e.def(t,"$allocate",n=function(){var e=this;return e.$raise(a(i,"TypeError"),"allocator undefined for "+e.$name())},n.$$arity=0),e.udef(t,"$new")}(e.get_singleton_class(N),C),e.def(N,"$!",u=function(){return!0},u.$$arity=0),e.def(N,"$&",f=function(e){return!1},f.$$arity=1),e.def(N,"$|",$=function(e){return!1!==e&&e!==n},$.$$arity=1),e.def(N,"$^",p=function(e){return!1!==e&&e!==n},p.$$arity=1),e.def(N,"$==",d=function(e){return e===n},d.$$arity=1),e.def(N,"$dup",h=function(){return n},h.$$arity=0),e.def(N,"$clone",_=function(t){var r;if(null==t)t=s([],{});else if(!t.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return r=t.$$smap.freeze,null==r&&(r=!0),n},_.$$arity=-1),e.def(N,"$inspect",m=function(){return"nil"},m.$$arity=0),e.def(N,"$nil?",y=function(){return!0},y.$$arity=0),e.def(N,"$singleton_class",g=function(){return a(C,"NilClass")},g.$$arity=0),e.def(N,"$to_a",v=function(){return[]},v.$$arity=0),e.def(N,"$to_h",b=function(){return e.hash()},b.$$arity=0),e.def(N,"$to_i",x=function(){return 0},x.$$arity=0),e.alias(N,"to_f","to_i"),e.def(N,"$to_s",w=function(){return""},w.$$arity=0),e.def(N,"$to_c",A=function(){return a(C,"Complex").$new(0,0)},A.$$arity=0),e.def(N,"$rationalize",k=function(r){var n,i,s=this;return n=e.slice.call(arguments,0,arguments.length),i=n,o(t(i.$length(),1))&&s.$raise(a(C,"ArgumentError")),s.$Rational(0,1)},k.$$arity=-1),e.def(N,"$to_r",E=function(){return this.$Rational(0,1)},E.$$arity=0),e.def(N,"$instance_variables",S=function(){return[]},S.$$arity=0)}(r[0],0,r),e.const_set(r[0],"NIL",n)},Opal.modules["corelib/boolean"]=function(e){var t=(e.top,[]),r=e.nil,n=(e.const_get_qualified,e.const_get_relative),a=(e.breaker,e.slice,e.klass),i=e.hash2;return e.add_stubs(["$raise","$name"]),function(t,s,o){var c,l,u,f,$,p,d,h,_,m,y=a(t,s,"Boolean"),g=[y].concat(o);e.defineProperty(y.$$prototype,"$$is_boolean",!0),e.defineProperty(y.$$prototype,"$$meta",y),function(t,r){var a,i=[t].concat(r);e.def(t,"$allocate",a=function(){var e=this;return e.$raise(n(i,"TypeError"),"allocator undefined for "+e.$name())},a.$$arity=0),e.udef(t,"$new")}(e.get_singleton_class(y),g),e.def(y,"$__id__",c=function(){return this.valueOf()?2:0},c.$$arity=0),e.alias(y,"object_id","__id__"),e.def(y,"$!",l=function(){return 1!=this},l.$$arity=0),e.def(y,"$&",u=function(e){return 1==this&&!1!==e&&e!==r},u.$$arity=1),e.def(y,"$|",f=function(e){return 1==this||!1!==e&&e!==r},f.$$arity=1),e.def(y,"$^",$=function(e){return 1==this?!1===e||e===r:!1!==e&&e!==r},$.$$arity=1),e.def(y,"$==",p=function(e){return 1==this===e.valueOf()},p.$$arity=1),e.alias(y,"equal?","=="),e.alias(y,"eql?","=="),e.def(y,"$singleton_class",d=function(){return n(g,"Boolean")},d.$$arity=0),e.def(y,"$to_s",h=function(){return 1==this?"true":"false"},h.$$arity=0),e.def(y,"$dup",_=function(){return this},_.$$arity=0),e.def(y,"$clone",m=function(t){var r,n=this;if(null==t)t=i([],{});else if(!t.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return r=t.$$smap.freeze,null==r&&(r=!0),n},m.$$arity=-1)}(t[0],Boolean,t),e.const_set(t[0],"TrueClass",n(t,"Boolean")),e.const_set(t[0],"FalseClass",n(t,"Boolean")),e.const_set(t[0],"TRUE",!0),e.const_set(t[0],"FALSE",!1)},Opal.modules["corelib/comparable"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e<t:e["$<"](t)}var n=(e.top,[]),a=e.nil,i=(e.const_get_qualified,e.const_get_relative),s=(e.breaker,e.slice,e.module),o=e.truthy;return e.add_stubs(["$>","$<","$===","$raise","$class","$equal?","$<=>"]),function(n,c){function l(n){return e.is_a(n,e.Integer)?n:t(n,0)?1:r(n,0)?-1:0}function u(e,t){var r;!function(){v=t,r=a["$==="](v)||(!0)["$==="](v)||(!1)["$==="](v)||i(g,"Integer")["$==="](v)||i(g,"Float")["$==="](v)?t.$inspect():t.$$class}(),y.$raise(i(g,"ArgumentError"),"comparison of "+e.$class()+" with "+r+" failed")}var f,$,p,d,h,_,m,y=s(n,"Comparable"),g=[y].concat(c),v=a;e.def(y,"$==",f=function(t){var r=this,n=a;return!!o(r["$equal?"](t))||r["$<=>"]!=e.Kernel["$<=>"]&&(r.$$comparable?(delete r.$$comparable,!1):!!o(n=r["$<=>"](t))&&0==l(n))},f.$$arity=1),e.def(y,"$>",$=function(e){var t=this,r=a;return o(r=t["$<=>"](e))||u(t,e),l(r)>0},$.$$arity=1),e.def(y,"$>=",p=function(e){var t=this,r=a;return o(r=t["$<=>"](e))||u(t,e),l(r)>=0},p.$$arity=1),e.def(y,"$<",d=function(e){var t=this,r=a;return o(r=t["$<=>"](e))||u(t,e),l(r)<0},d.$$arity=1),e.def(y,"$<=",h=function(e){var t=this,r=a;return o(r=t["$<=>"](e))||u(t,e),l(r)<=0},h.$$arity=1),e.def(y,"$between?",_=function(e,n){var a=this;return!r(a,e)&&!t(a,n)},_.$$arity=2),e.def(y,"$clamp",m=function(e,t){var r=this,n=a;return n=e["$<=>"](t),o(n)||u(e,t),o(l(n)>0)&&r.$raise(i(g,"ArgumentError"),"min argument must be smaller than max argument"),o(l(r["$<=>"](e))<0)?e:o(l(r["$<=>"](t))>0)?t:r},m.$$arity=2)}(n[0],n)},Opal.modules["corelib/regexp"]=function(e){var t=(e.top,[]),r=e.nil,n=(e.const_get_qualified,e.const_get_relative),a=(e.breaker,e.slice,e.klass),i=e.send,s=e.truthy,o=e.gvars;return e.add_stubs(["$nil?","$[]","$raise","$escape","$options","$to_str","$new","$join","$coerce_to!","$!","$match","$coerce_to?","$begin","$coerce_to","$=~","$attr_reader","$===","$inspect","$to_a"]),function(e,t,r){var n=a(e,t,"RegexpError");[n].concat(r)}(t[0],n(t,"StandardError"),t),function(t,c,l){var u,f,$,p,d,h,_,m,y,g,v=a(t,c,"Regexp"),b=[v].concat(l);e.const_set(b[0],"IGNORECASE",1),e.const_set(b[0],"EXTENDED",2),e.const_set(b[0],"MULTILINE",4),e.defineProperty(v.$$prototype,"$$is_regexp",!0),function(t,a){var c,l,u,f,$,p=[t].concat(a);e.def(t,"$allocate",c=function(){var t=c.$$p,n=this,a=r,s=r,o=r,l=r;for(t&&(c.$$p=null),o=0,l=arguments.length,s=new Array(l);o<l;o++)s[o]=arguments[o];return a=i(n,e.find_super_dispatcher(n,"allocate",c,!1),s,t),a.uninitialized=!0,a},c.$$arity=0),e.def(t,"$escape",l=function(t){return e.escape_regexp(t)},l.$$arity=1),e.def(t,"$last_match",u=function(e){return null==o["~"]&&(o["~"]=r),null==e&&(e=r),s(e["$nil?"]())?o["~"]:o["~"]["$[]"](e)},u.$$arity=-1),e.alias(t,"quote","escape"),e.def(t,"$union",f=function(t){var r,a,i=this;r=e.slice.call(arguments,0,arguments.length),a=r;var s,o,c,l,u;if(0==a.length)return/(?!)/;if(1==a.length&&a[0].$$is_regexp)return a[0];s=a[0].$$is_array,a.length>1&&s&&i.$raise(n(p,"TypeError"),"no implicit conversion of Array into String"),s&&(a=a[0]),l=void 0,o=[];for(var f=0;f<a.length;f++)c=a[f],c.$$is_string?o.push(i.$escape(c)):c.$$is_regexp?(u=c.$options(),void 0!=l&&l!=u&&i.$raise(n(p,"TypeError"),"All expressions must use the same options"),l=u,o.push("("+c.source+")")):o.push(i.$escape(c.$to_str()));return i.$new(o.$join("|"),l)},f.$$arity=-1),e.def(t,"$new",$=function(e,t){var r=this;if(e.$$is_regexp)return new RegExp(e);if(e=n(p,"Opal")["$coerce_to!"](e,n(p,"String"),"to_str"),"\\"===e.charAt(e.length-1)&&"\\"!==e.charAt(e.length-2)&&r.$raise(n(p,"RegexpError"),"too short escape sequence: /"+e+"/"),void 0===t||t["$!"]())return new RegExp(e);if(t.$$is_number){var a="";n(p,"IGNORECASE")&t&&(a+="i"),n(p,"MULTILINE")&t&&(a+="m"),t=a}else t="i";return new RegExp(e,t)},$.$$arity=-2)}(e.get_singleton_class(v),b),e.def(v,"$==",u=function(e){var t=this;return e instanceof RegExp&&t.toString()===e.toString()},u.$$arity=1),e.def(v,"$===",f=function(e){return this.$match(n(b,"Opal")["$coerce_to?"](e,n(b,"String"),"to_str"))!==r},f.$$arity=1),e.def(v,"$=~",$=function(e){var t,n=this;return null==o["~"]&&(o["~"]=r),s(t=n.$match(e))?o["~"].$begin(0):t},$.$$arity=1),e.alias(v,"eql?","=="),e.def(v,"$inspect",p=function(){var e=this,t=/^\/(.*)\/([^\/]*)$/,r=e.toString(),n=t.exec(r);if(n){for(var a=n[1],i=n[2],s=a.split(""),o=s.length,c=!1,l="",u=0;u<o;u++){var f=s[u];c||"/"!=f||(l=l.concat("\\")),l=l.concat(f),c="\\"==f&&!c}return"/"+l+"/"+i}return r},p.$$arity=0),e.def(v,"$match",d=function(t,a){var i=d.$$p,s=i||r,c=this;if(null==o["~"]&&(o["~"]=r),i&&(d.$$p=null),i&&(d.$$p=null),c.uninitialized&&c.$raise(n(b,"TypeError"),"uninitialized Regexp"),void 0===a){if(t===r)return o["~"]=r;var l=c.exec(n(b,"Opal").$coerce_to(t,n(b,"String"),"to_str"));return l?(o["~"]=n(b,"MatchData").$new(c,l),s===r?o["~"]:e.yield1(s,o["~"])):o["~"]=r}if(a=n(b,"Opal").$coerce_to(a,n(b,"Integer"),"to_int"),t===r)return o["~"]=r;if(t=n(b,"Opal").$coerce_to(t,n(b,"String"),"to_str"),a<0&&(a+=t.length)<0)return o["~"]=r;for(var u,f=e.global_regexp(c);;){if(null===(u=f.exec(t)))return o["~"]=r;if(u.index>=a)return o["~"]=n(b,"MatchData").$new(f,u),s===r?o["~"]:e.yield1(s,o["~"]);f.lastIndex=u.index+1}},d.$$arity=-2),e.def(v,"$match?",h=function(t,a){var i=this;if(i.uninitialized&&i.$raise(n(b,"TypeError"),"uninitialized Regexp"),void 0===a)return t!==r&&i.test(n(b,"Opal").$coerce_to(t,n(b,"String"),"to_str"));if(a=n(b,"Opal").$coerce_to(a,n(b,"Integer"),"to_int"),t===r)return!1;if(t=n(b,"Opal").$coerce_to(t,n(b,"String"),"to_str"),a<0&&(a+=t.length)<0)return!1;var s;return!(null===(s=e.global_regexp(i).exec(t))||s.index<a)},h.$$arity=-2),e.def(v,"$~",_=function(){var e=this;return null==o._&&(o._=r),e["$=~"](o._)},_.$$arity=0),e.def(v,"$source",m=function(){return this.source},m.$$arity=0),e.def(v,"$options",y=function(){var e=this;e.uninitialized&&e.$raise(n(b,"TypeError"),"uninitialized Regexp");var t=0;return e.multiline&&(t|=n(b,"MULTILINE")),e.ignoreCase&&(t|=n(b,"IGNORECASE")),t},y.$$arity=0),e.def(v,"$casefold?",g=function(){return this.ignoreCase},g.$$arity=0),e.alias(v,"to_s","source")}(t[0],RegExp,t),function(t,c,l){var u,f,$,p,d,h,_,m,y,g,v,b,x=a(t,null,"MatchData"),w=[x].concat(l);return x.$$prototype.matches=r,x.$attr_reader("post_match","pre_match","regexp","string"),e.def(x,"$initialize",u=function(e,t){var n=this;o["~"]=n,n.regexp=e,n.begin=t.index,n.string=t.input,n.pre_match=t.input.slice(0,t.index),n.post_match=t.input.slice(t.index+t[0].length),n.matches=[];for(var a=0,i=t.length;a<i;a++){var s=t[a];null==s?n.matches.push(r):n.matches.push(s)}},u.$$arity=2),e.def(x,"$[]",f=function(t){var r,n,a=this;return r=e.slice.call(arguments,0,arguments.length),n=r,i(a.matches,"[]",e.to_a(n))},f.$$arity=-1),e.def(x,"$offset",$=function(e){var t=this;return 0!==e&&t.$raise(n(w,"ArgumentError"),"MatchData#offset only supports 0th element"),[t.begin,t.begin+t.matches[e].length]},$.$$arity=1),e.def(x,"$==",p=function(e){var t,r,a,i,o=this;return!!s(n(w,"MatchData")["$==="](e))&&(s(t=s(r=s(a=s(i=o.string==e.string)?o.regexp.toString()==e.regexp.toString():i)?o.pre_match==e.pre_match:a)?o.post_match==e.post_match:r)?o.begin==e.begin:t)},p.$$arity=1),e.alias(x,"eql?","=="),e.def(x,"$begin",d=function(e){var t=this;return 0!==e&&t.$raise(n(w,"ArgumentError"),"MatchData#begin only supports 0th element"),t.begin},d.$$arity=1),e.def(x,"$end",h=function(e){var t=this;return 0!==e&&t.$raise(n(w,"ArgumentError"),"MatchData#end only supports 0th element"),t.begin+t.matches[e].length},h.$$arity=1),e.def(x,"$captures",_=function(){return this.matches.slice(1)},_.$$arity=0),e.def(x,"$inspect",m=function(){for(var e=this,t="#<MatchData "+e.matches[0].$inspect(),r=1,n=e.matches.length;r<n;r++)t+=" "+r+":"+e.matches[r].$inspect();return t+">"},m.$$arity=0),e.def(x,"$length",y=function(){return this.matches.length},y.$$arity=0),e.alias(x,"size","length"),e.def(x,"$to_a",g=function(){return this.matches},g.$$arity=0),e.def(x,"$to_s",v=function(){return this.matches[0]},v.$$arity=0),e.def(x,"$values_at",b=function(t){var a,i,s=this;a=e.slice.call(arguments,0,arguments.length),i=a;var o,c,l,u=[];for(o=0;o<i.length;o++)i[o].$$is_range&&(c=i[o].$to_a(),c.unshift(o,1),Array.prototype.splice.apply(i,c)),l=n(w,"Opal")["$coerce_to!"](i[o],n(w,"Integer"),"to_int"),l<0&&(l+=s.matches.length)<0?u.push(r):u.push(s.matches[l]);return u},b.$$arity=-1),r&&"values_at"}(t[0],0,t)},Opal.modules["corelib/string"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e/t:e["$/"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}var n=e.top,a=[],i=e.nil,s=e.const_get_qualified,o=e.const_get_relative,c=(e.breaker,e.slice,e.klass),l=e.truthy,u=e.send,f=e.gvars;return e.add_stubs(["$require","$include","$coerce_to?","$coerce_to","$raise","$===","$format","$to_s","$respond_to?","$to_str","$<=>","$==","$=~","$new","$force_encoding","$casecmp","$empty?","$ljust","$ceil","$/","$+","$rjust","$floor","$to_a","$each_char","$to_proc","$coerce_to!","$copy_singleton_methods","$initialize_clone","$initialize_dup","$enum_for","$size","$chomp","$[]","$to_i","$each_line","$encoding","$class","$match","$match?","$captures","$proc","$succ","$escape"]),n.$require("corelib/comparable"),n.$require("corelib/regexp"),function(n,a,$){function p(e){function t(e,t){if(0===e.length)return t;var r,n,a="",i=e.length;for(r=0;r<i;r++)n=e.charAt(r),-1!==t.indexOf(n)&&(a+=n);return a}var r,n,a,i,s,c,l="",u="";for(r=0,n=e.length;r<n;r++)a=o(je,"Opal").$coerce_to(e[r],o(je,"String"),"to_str"),i="^"===a.charAt(0)&&a.length>1,a=function(e){var t,r,n,a,i,s,c="",l=e.length;for(t=0;t<l;t++)if("-"===(r=e.charAt(t))&&t>0&&t<l-1&&!n){for(a=e.charCodeAt(t-1),i=e.charCodeAt(t+1),a>i&&Be.$raise(o(je,"ArgumentError"),'invalid range "'+a+"-"+i+'" in string transliteration'),s=a+1;s<i+1;s++)c+=String.fromCharCode(s);n=!0,t++}else n="\\"===r,c+=r;return c}(i?a.slice(1):a),i?u=t(u,a):l=t(l,a);if(l.length>0&&u.length>0){for(c="",r=0,n=l.length;r<n;r++)s=l.charAt(r),-1===u.indexOf(s)&&(c+=s);l=c,u=""}return l.length>0?"["+o(je,"Regexp").$escape(l)+"]":u.length>0?"[^"+o(je,"Regexp").$escape(u)+"]":null}var d,h,_,m,y,g,v,b,x,w,A,k,E,S,N,C,I,O,L,P,M,T,B,j,F,R,D,z,q,U,H,G,Y,V,Q,X,W,J,K,Z,ee,te,re,ne,ae,ie,se,oe,ce,le,ue,fe,$e,pe,de,he,_e,me,ye,ge,ve,be,xe,we,Ae,ke,Ee,Se,Ne,Ce,Ie,Oe,Le,Pe,Me,Te,Be=c(n,a,"String"),je=[Be].concat($);Be.$include(o(je,"Comparable")),e.defineProperty(Be.$$prototype,"$$is_string",!0),e.defineProperty(Be.$$prototype,"$$cast",function(e){var t=this.$$class;return t.$$constructor===String?e:new t.$$constructor(e)}),e.def(Be,"$__id__",d=function(){return this.toString()},d.$$arity=0),e.alias(Be,"object_id","__id__"),e.defs(Be,"$try_convert",h=function(e){return o(je,"Opal")["$coerce_to?"](e,o(je,"String"),"to_str")},h.$$arity=1),e.defs(Be,"$new",_=function(e){var t=this;return null==e&&(e=""),e=o(je,"Opal").$coerce_to(e,o(je,"String"),"to_str"),new t.$$constructor(e)},_.$$arity=-1),e.def(Be,"$initialize",m=function(e){var t=this;return void 0===e?t:t.$raise(o(je,"NotImplementedError"),"Mutable strings are not supported in Opal.")},m.$$arity=-1),e.def(Be,"$%",y=function(t){var r=this;return l(o(je,"Array")["$==="](t))?u(r,"format",[r].concat(e.to_a(t))):r.$format(r,t)},y.$$arity=1),e.def(Be,"$*",g=function(e){var t=this;if(e=o(je,"Opal").$coerce_to(e,o(je,"Integer"),"to_int"),e<0&&t.$raise(o(je,"ArgumentError"),"negative argument"),0===e)return t.$$cast("");var r="",n=t.toString();for(n.length*e>=1<<28&&t.$raise(o(je,"RangeError"),"multiply count must not overflow maximum string size");1==(1&e)&&(r+=n),0!==(e>>>=1);)n+=n;return t.$$cast(r)},g.$$arity=1),e.def(Be,"$+",v=function(e){var t=this;return e=o(je,"Opal").$coerce_to(e,o(je,"String"),"to_str"),t+e.$to_s()},v.$$arity=1),e.def(Be,"$<=>",b=function(e){var t=this;if(l(e["$respond_to?"]("to_str")))return e=e.$to_str().$to_s(),t>e?1:t<e?-1:0;var r=e["$<=>"](t);return r===i?i:r>0?-1:r<0?1:0},b.$$arity=1),e.def(Be,"$==",x=function(e){var t=this;return e.$$is_string?t.toString()===e.toString():!!o(je,"Opal")["$respond_to?"](e,"to_str")&&e["$=="](t)},x.$$arity=1),
e.alias(Be,"eql?","=="),e.alias(Be,"===","=="),e.def(Be,"$=~",w=function(e){var t=this;return e.$$is_string&&t.$raise(o(je,"TypeError"),"type mismatch: String given"),e["$=~"](t)},w.$$arity=1),e.def(Be,"$[]",A=function(e,t){var r,n=this,a=n.length;if(e.$$is_range)return r=e.excl,t=o(je,"Opal").$coerce_to(e.end,o(je,"Integer"),"to_int"),e=o(je,"Opal").$coerce_to(e.begin,o(je,"Integer"),"to_int"),Math.abs(e)>a?i:(e<0&&(e+=a),t<0&&(t+=a),r||(t+=1),t-=e,t<0&&(t=0),n.$$cast(n.substr(e,t)));if(e.$$is_string)return null!=t&&n.$raise(o(je,"TypeError")),-1!==n.indexOf(e)?n.$$cast(e):i;if(e.$$is_regexp){var s=n.match(e);return null===s?(f["~"]=i,i):(f["~"]=o(je,"MatchData").$new(e,s),null==t?n.$$cast(s[0]):(t=o(je,"Opal").$coerce_to(t,o(je,"Integer"),"to_int"),t<0&&-t<s.length?n.$$cast(s[t+=s.length]):t>=0&&t<s.length?n.$$cast(s[t]):i))}return e=o(je,"Opal").$coerce_to(e,o(je,"Integer"),"to_int"),e<0&&(e+=a),null==t?e>=a||e<0?i:n.$$cast(n.substr(e,1)):(t=o(je,"Opal").$coerce_to(t,o(je,"Integer"),"to_int"),t<0?i:e>a||e<0?i:n.$$cast(n.substr(e,t)))},A.$$arity=-2),e.alias(Be,"byteslice","[]"),e.def(Be,"$b",k=function(){return this.$force_encoding("binary")},k.$$arity=0),e.def(Be,"$capitalize",E=function(){var e=this;return e.$$cast(e.charAt(0).toUpperCase()+e.substr(1).toLowerCase())},E.$$arity=0),e.def(Be,"$casecmp",S=function(e){var t=this;if(!l(e["$respond_to?"]("to_str")))return i;e=o(je,"Opal").$coerce_to(e,o(je,"String"),"to_str").$to_s();var r=/^[\x00-\x7F]*$/;return r.test(t)&&r.test(e)&&(t=t.toLowerCase(),e=e.toLowerCase()),t["$<=>"](e)},S.$$arity=1),e.def(Be,"$casecmp?",N=function(e){var t=this,r=t.$casecmp(e);return r===i?i:0===r},N.$$arity=1),e.def(Be,"$center",C=function(e,n){var a=this;if(null==n&&(n=" "),e=o(je,"Opal").$coerce_to(e,o(je,"Integer"),"to_int"),n=o(je,"Opal").$coerce_to(n,o(je,"String"),"to_str").$to_s(),l(n["$empty?"]())&&a.$raise(o(je,"ArgumentError"),"zero width padding"),l(e<=a.length))return a;var i=a.$ljust(t(r(e,a.length),2).$ceil(),n),s=a.$rjust(t(r(e,a.length),2).$floor(),n);return a.$$cast(s+i.slice(a.length))},C.$$arity=-2),e.def(Be,"$chars",I=function(){var e=I.$$p,t=e||i,r=this;return e&&(I.$$p=null),e&&(I.$$p=null),l(t)?u(r,"each_char",[],t.$to_proc()):r.$each_char().$to_a()},I.$$arity=0),e.def(Be,"$chomp",O=function(e){var t=this;if(null==f["/"]&&(f["/"]=i),null==e&&(e=f["/"]),l(e===i||0===t.length))return t;e=o(je,"Opal")["$coerce_to!"](e,o(je,"String"),"to_str").$to_s();var r;if("\n"===e)r=t.replace(/\r?\n?$/,"");else if(""===e)r=t.replace(/(\r?\n)+$/,"");else if(t.length>=e.length){var n=t.substr(t.length-e.length,e.length);n===e&&(r=t.substr(0,t.length-e.length))}return null!=r?t.$$cast(r):t},O.$$arity=-1),e.def(Be,"$chop",L=function(){var e,t=this,r=t.length;return e=r<=1?"":"\n"===t.charAt(r-1)&&"\r"===t.charAt(r-2)?t.substr(0,r-2):t.substr(0,r-1),t.$$cast(e)},L.$$arity=0),e.def(Be,"$chr",P=function(){return this.charAt(0)},P.$$arity=0),e.def(Be,"$clone",M=function(){var e=this,t=i;return t=e.slice(),t.$copy_singleton_methods(e),t.$initialize_clone(e),t},M.$$arity=0),e.def(Be,"$dup",T=function(){var e=this,t=i;return t=e.slice(),t.$initialize_dup(e),t},T.$$arity=0),e.def(Be,"$count",B=function(t){var r,n,a=this;r=e.slice.call(arguments,0,arguments.length),n=r,0===n.length&&a.$raise(o(je,"ArgumentError"),"ArgumentError: wrong number of arguments (0 for 1+)");var i=p(n);return null===i?0:a.length-a.replace(new RegExp(i,"g"),"").length},B.$$arity=-1),e.def(Be,"$delete",j=function(t){var r,n,a=this;r=e.slice.call(arguments,0,arguments.length),n=r,0===n.length&&a.$raise(o(je,"ArgumentError"),"ArgumentError: wrong number of arguments (0 for 1+)");var i=p(n);return null===i?a:a.$$cast(a.replace(new RegExp(i,"g"),""))},j.$$arity=-1),e.def(Be,"$delete_prefix",F=function(e){var t=this;return e.$$is_string||(e=o(je,"Opal").$coerce_to(e,o(je,"String"),"to_str")),t.slice(0,e.length)===e?t.$$cast(t.slice(e.length)):t},F.$$arity=1),e.def(Be,"$delete_suffix",R=function(e){var t=this;return e.$$is_string||(e=o(je,"Opal").$coerce_to(e,o(je,"String"),"to_str")),t.slice(t.length-e.length)===e?t.$$cast(t.slice(0,t.length-e.length)):t},R.$$arity=1),e.def(Be,"$downcase",D=function(){var e=this;return e.$$cast(e.toLowerCase())},D.$$arity=0),e.def(Be,"$each_char",z=function(){var t,r=z.$$p,n=r||i,a=this;if(r&&(z.$$p=null),r&&(z.$$p=null),n===i)return u(a,"enum_for",["each_char"],(t=function(){return(t.$$s||this).$size()},t.$$s=a,t.$$arity=0,t));for(var s=0,o=a.length;s<o;s++)e.yield1(n,a.charAt(s));return a},z.$$arity=0),e.def(Be,"$each_line",q=function(t){var r=q.$$p,n=r||i,a=this;if(null==f["/"]&&(f["/"]=i),r&&(q.$$p=null),r&&(q.$$p=null),null==t&&(t=f["/"]),n===i)return a.$enum_for("each_line",t);if(t===i)return e.yield1(n,a),a;t=o(je,"Opal").$coerce_to(t,o(je,"String"),"to_str");var s,c,l,u,$,p,d;if(0===t.length){for(s=a.split(/(\n{2,})/),c=0,l=s.length;c<l;c+=2)if(s[c]||s[c+1]){var h=(s[c]||"")+(s[c+1]||"");e.yield1(n,a.$$cast(h))}return a}for($=a.$chomp(t),p=a.length!=$.length,d=$.split(t),c=0,u=d.length;c<u;c++)c<u-1||p?e.yield1(n,a.$$cast(d[c]+t)):e.yield1(n,a.$$cast(d[c]));return a},q.$$arity=-1),e.def(Be,"$empty?",U=function(){return 0===this.length},U.$$arity=0),e.def(Be,"$end_with?",H=function(t){var r,n,a=this;r=e.slice.call(arguments,0,arguments.length),n=r;for(var i=0,s=n.length;i<s;i++){var c=o(je,"Opal").$coerce_to(n[i],o(je,"String"),"to_str").$to_s();if(a.length>=c.length&&a.substr(a.length-c.length,c.length)==c)return!0}return!1},H.$$arity=-1),e.alias(Be,"equal?","==="),e.def(Be,"$gsub",G=function(t,r){var n=G.$$p,a=n||i,s=this;if(n&&(G.$$p=null),n&&(G.$$p=null),void 0===r&&a===i)return s.$enum_for("gsub",t);var c,l,u="",$=i,p=0;t.$$is_regexp?t=e.global_multiline_regexp(t):(t=o(je,"Opal").$coerce_to(t,o(je,"String"),"to_str"),t=new RegExp(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gm"));for(var d;;){if(null===(c=t.exec(s))){f["~"]=i,u+=s.slice(p);break}$=o(je,"MatchData").$new(t,c),void 0===r?(d=t.lastIndex,l=a(c[0]),t.lastIndex=d):r.$$is_hash?l=r["$[]"](c[0]).$to_s():(r.$$is_string||(r=o(je,"Opal").$coerce_to(r,o(je,"String"),"to_str")),l=r.replace(/([\\]+)([0-9+&`'])/g,function(e,t,r){if(t.length%2==0)return e;switch(r){case"+":for(var n=c.length-1;n>0;n--)if(void 0!==c[n])return t.slice(1)+c[n];return"";case"&":return t.slice(1)+c[0];case"`":return t.slice(1)+s.slice(0,c.index);case"'":return t.slice(1)+s.slice(c.index+c[0].length);default:return t.slice(1)+(c[r]||"")}}).replace(/\\\\/g,"\\")),t.lastIndex===c.index?(u+=l+s.slice(p,c.index+1),t.lastIndex+=1):u+=s.slice(p,c.index)+l,p=t.lastIndex}return f["~"]=$,s.$$cast(u)},G.$$arity=-2),e.def(Be,"$hash",Y=function(){return this.toString()},Y.$$arity=0),e.def(Be,"$hex",V=function(){return this.$to_i(16)},V.$$arity=0),e.def(Be,"$include?",Q=function(e){var t=this;return e.$$is_string||(e=o(je,"Opal").$coerce_to(e,o(je,"String"),"to_str")),-1!==t.indexOf(e)},Q.$$arity=1),e.def(Be,"$index",X=function(t,r){var n,a,s,c=this;if(void 0===r)r=0;else if((r=o(je,"Opal").$coerce_to(r,o(je,"Integer"),"to_int"))<0&&(r+=c.length)<0)return i;if(t.$$is_regexp)for(s=e.global_multiline_regexp(t);;){if(null===(a=s.exec(c))){f["~"]=i,n=-1;break}if(a.index>=r){f["~"]=o(je,"MatchData").$new(s,a),n=a.index;break}s.lastIndex=a.index+1}else t=o(je,"Opal").$coerce_to(t,o(je,"String"),"to_str"),n=0===t.length&&r>c.length?-1:c.indexOf(t,r);return-1===n?i:n},X.$$arity=-2),e.def(Be,"$inspect",W=function(){var e=this,t=/[\\\"\x00-\x1f\u007F-\u009F\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,r={"":"\\a","":"\\e","\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r","\v":"\\v",'"':'\\"',"\\":"\\\\"};return'"'+e.replace(t,function(e){return r[e]||"\\u"+("0000"+e.charCodeAt(0).toString(16).toUpperCase()).slice(-4)}).replace(/\#[\$\@\{]/g,"\\$&")+'"'},W.$$arity=0),e.def(Be,"$intern",J=function(){return this.toString()},J.$$arity=0),e.def(Be,"$lines",K=function(e){var t=K.$$p,r=t||i,n=this,a=i;return null==f["/"]&&(f["/"]=i),t&&(K.$$p=null),t&&(K.$$p=null),null==e&&(e=f["/"]),a=u(n,"each_line",[e],r.$to_proc()),l(r)?n:a.$to_a()},K.$$arity=-1),e.def(Be,"$length",Z=function(){return this.length},Z.$$arity=0),e.def(Be,"$ljust",ee=function(e,t){var r=this;if(null==t&&(t=" "),e=o(je,"Opal").$coerce_to(e,o(je,"Integer"),"to_int"),t=o(je,"Opal").$coerce_to(t,o(je,"String"),"to_str").$to_s(),l(t["$empty?"]())&&r.$raise(o(je,"ArgumentError"),"zero width padding"),l(e<=r.length))return r;var n=-1,a="";for(e-=r.length;++n<e;)a+=t;return r.$$cast(r+a.slice(0,e))},ee.$$arity=-2),e.def(Be,"$lstrip",te=function(){return this.replace(/^\s*/,"")},te.$$arity=0),e.def(Be,"$ascii_only?",re=function(){var e=this;return!e.$encoding()["$=="](s(o(je,"Encoding"),"UTF_16BE"))&&/^[\x00-\x7F]*$/.test(e)},re.$$arity=0),e.def(Be,"$match",ne=function(e,t){var r,n=ne.$$p,a=n||i,s=this;return n&&(ne.$$p=null),n&&(ne.$$p=null),l(l(r=o(je,"String")["$==="](e))?r:e["$respond_to?"]("to_str"))&&(e=o(je,"Regexp").$new(e.$to_str())),l(o(je,"Regexp")["$==="](e))||s.$raise(o(je,"TypeError"),"wrong argument type "+e.$class()+" (expected Regexp)"),u(e,"match",[s,t],a.$to_proc())},ne.$$arity=-2),e.def(Be,"$match?",ae=function(e,t){var r,n=this;return l(l(r=o(je,"String")["$==="](e))?r:e["$respond_to?"]("to_str"))&&(e=o(je,"Regexp").$new(e.$to_str())),l(o(je,"Regexp")["$==="](e))||n.$raise(o(je,"TypeError"),"wrong argument type "+e.$class()+" (expected Regexp)"),e["$match?"](n,t)},ae.$$arity=-2),e.def(Be,"$next",ie=function(){var e=this,t=e.length;if(0===t)return e.$$cast("");for(var r,n=e,a=e.search(/[a-zA-Z0-9]/),i=!1;t--;){if((r=e.charCodeAt(t))>=48&&r<=57||r>=65&&r<=90||r>=97&&r<=122)switch(r){case 57:i=!0,r=48;break;case 90:i=!0,r=65;break;case 122:i=!0,r=97;break;default:i=!1,r+=1}else-1===a?255===r?(i=!0,r=0):(i=!1,r+=1):i=!0;if(n=n.slice(0,t)+String.fromCharCode(r)+n.slice(t+1),i&&(0===t||t===a)){switch(r){case 65:case 97:break;default:r+=1}n=0===t?String.fromCharCode(r)+n:n.slice(0,t)+String.fromCharCode(r)+n.slice(t),i=!1}if(!i)break}return e.$$cast(n)},ie.$$arity=0),e.def(Be,"$oct",se=function(){var e,t=this,r=t,n=8;return/^\s*_/.test(r)?0:(r=r.replace(/^(\s*[+-]?)(0[bodx]?)(.+)$/i,function(e,t,r,a){switch(a.charAt(0)){case"+":case"-":return e;case"0":if("x"===a.charAt(1)&&"0x"===r)return e}switch(r){case"0b":n=2;break;case"0":case"0o":n=8;break;case"0d":n=10;break;case"0x":n=16}return t+a}),e=parseInt(r.replace(/_(?!_)/g,""),n),isNaN(e)?0:e)},se.$$arity=0),e.def(Be,"$ord",oe=function(){return this.charCodeAt(0)},oe.$$arity=0),e.def(Be,"$partition",ce=function(e){var t,r,n=this;return e.$$is_regexp?(r=e.exec(n),null===r?t=-1:(o(je,"MatchData").$new(e,r),e=r[0],t=r.index)):(e=o(je,"Opal").$coerce_to(e,o(je,"String"),"to_str"),t=n.indexOf(e)),-1===t?[n,"",""]:[n.slice(0,t),n.slice(t,t+e.length),n.slice(t+e.length)]},ce.$$arity=1),e.def(Be,"$reverse",le=function(){return this.split("").reverse().join("")},le.$$arity=0),e.def(Be,"$rindex",ue=function(t,r){var n,a,s,c,l=this;if(void 0===r)r=l.length;else if((r=o(je,"Opal").$coerce_to(r,o(je,"Integer"),"to_int"))<0&&(r+=l.length)<0)return i;if(t.$$is_regexp){for(a=null,s=e.global_multiline_regexp(t);;){if(null===(c=s.exec(l))||c.index>r)break;a=c,s.lastIndex=a.index+1}null===a?(f["~"]=i,n=-1):(o(je,"MatchData").$new(s,a),n=a.index)}else t=o(je,"Opal").$coerce_to(t,o(je,"String"),"to_str"),n=l.lastIndexOf(t,r);return-1===n?i:n},ue.$$arity=-2),e.def(Be,"$rjust",fe=function(e,t){var r=this;if(null==t&&(t=" "),e=o(je,"Opal").$coerce_to(e,o(je,"Integer"),"to_int"),t=o(je,"Opal").$coerce_to(t,o(je,"String"),"to_str").$to_s(),l(t["$empty?"]())&&r.$raise(o(je,"ArgumentError"),"zero width padding"),l(e<=r.length))return r;var n=Math.floor(e-r.length),a=Math.floor(n/t.length),i=Array(a+1).join(t),s=n-i.length;return r.$$cast(i+t.slice(0,s)+r)},fe.$$arity=-2),e.def(Be,"$rpartition",$e=function(t){var r,n,a,i,s=this;if(t.$$is_regexp){for(n=null,a=e.global_multiline_regexp(t);;){if(null===(i=a.exec(s)))break;n=i,a.lastIndex=n.index+1}null===n?r=-1:(o(je,"MatchData").$new(a,n),t=n[0],r=n.index)}else t=o(je,"Opal").$coerce_to(t,o(je,"String"),"to_str"),r=s.lastIndexOf(t);return-1===r?["","",s]:[s.slice(0,r),s.slice(r,r+t.length),s.slice(r+t.length)]},$e.$$arity=1),e.def(Be,"$rstrip",pe=function(){return this.replace(/[\s\u0000]*$/,"")},pe.$$arity=0),e.def(Be,"$scan",de=function(t){var r=de.$$p,n=r||i,a=this;r&&(de.$$p=null),r&&(de.$$p=null);var s,c=[],l=i;for(t.$$is_regexp?t=e.global_multiline_regexp(t):(t=o(je,"Opal").$coerce_to(t,o(je,"String"),"to_str"),t=new RegExp(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gm"));null!=(s=t.exec(a));)l=o(je,"MatchData").$new(t,s),n===i?1==s.length?c.push(s[0]):c.push(l.$captures()):1==s.length?n(s[0]):n.call(a,l.$captures()),t.lastIndex===s.index&&(t.lastIndex+=1);return f["~"]=l,n!==i?a:c},de.$$arity=1),e.alias(Be,"size","length"),e.alias(Be,"slice","[]"),e.def(Be,"$split",he=function(t,r){function n(){for(u=0;u<p.length;u++)p[u]=s.$$cast(p[u])}var a,s=this;if(null==f[";"]&&(f[";"]=i),0===s.length)return[];if(void 0===r)r=0;else if(1===(r=o(je,"Opal")["$coerce_to!"](r,o(je,"Integer"),"to_int")))return[s];void 0!==t&&t!==i||(t=l(a=f[";"])?a:" ");var c,u,$,p=[],d=s.toString(),h=0;if(t.$$is_regexp?t=e.global_multiline_regexp(t):(t=o(je,"Opal").$coerce_to(t,o(je,"String"),"to_str").$to_s()," "===t?(t=/\s+/gm,d=d.replace(/^\s+/,"")):t=new RegExp(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gm")),p=d.split(t),1===p.length&&p[0]===d)return[s.$$cast(p[0])];for(;-1!==(u=p.indexOf(void 0));)p.splice(u,1);if(0===r){for(;""===p[p.length-1];)p.length-=1;return n(),p}if(c=t.exec(d),r<0){if(null!==c&&""===c[0]&&-1===t.source.indexOf("(?="))for(u=0,$=c.length;u<$;u++)p.push("");return n(),p}if(null!==c&&""===c[0])return p.splice(r-1,p.length-1,p.slice(r-1).join("")),n(),p;if(r>=p.length)return n(),p;for(u=0;null!==c&&(u++,h=t.lastIndex,u+1!==r);)c=t.exec(d);return p.splice(r-1,p.length-1,d.slice(h)),n(),p},he.$$arity=-1),e.def(Be,"$squeeze",_e=function(t){var r,n,a=this;if(r=e.slice.call(arguments,0,arguments.length),n=r,0===n.length)return a.$$cast(a.replace(/(.)\1+/g,"$1"));var i=p(n);return null===i?a:a.$$cast(a.replace(new RegExp("("+i+")\\1+","g"),"$1"))},_e.$$arity=-1),e.def(Be,"$start_with?",me=function(t){var r,n,a=this;r=e.slice.call(arguments,0,arguments.length),n=r;for(var i=0,s=n.length;i<s;i++){var c=o(je,"Opal").$coerce_to(n[i],o(je,"String"),"to_str").$to_s();if(0===a.indexOf(c))return!0}return!1},me.$$arity=-1),e.def(Be,"$strip",ye=function(){return this.replace(/^\s*/,"").replace(/[\s\u0000]*$/,"")},ye.$$arity=0),e.def(Be,"$sub",ge=function(e,t){var r=ge.$$p,n=r||i,a=this;r&&(ge.$$p=null),r&&(ge.$$p=null),e.$$is_regexp||(e=o(je,"Opal").$coerce_to(e,o(je,"String"),"to_str"),e=new RegExp(e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")));var s,c=e.exec(a);return null===c?(f["~"]=i,s=a.toString()):(o(je,"MatchData").$new(e,c),void 0===t?(n===i&&a.$raise(o(je,"ArgumentError"),"wrong number of arguments (1 for 2)"),s=a.slice(0,c.index)+n(c[0])+a.slice(c.index+c[0].length)):t.$$is_hash?s=a.slice(0,c.index)+t["$[]"](c[0]).$to_s()+a.slice(c.index+c[0].length):(t=o(je,"Opal").$coerce_to(t,o(je,"String"),"to_str"),t=t.replace(/([\\]+)([0-9+&`'])/g,function(e,t,r){if(t.length%2==0)return e;switch(r){case"+":for(var n=c.length-1;n>0;n--)if(void 0!==c[n])return t.slice(1)+c[n];return"";case"&":return t.slice(1)+c[0];case"`":return t.slice(1)+a.slice(0,c.index);case"'":return t.slice(1)+a.slice(c.index+c[0].length);default:return t.slice(1)+(c[r]||"")}}).replace(/\\\\/g,"\\"),s=a.slice(0,c.index)+t+a.slice(c.index+c[0].length))),a.$$cast(s)},ge.$$arity=-2),e.alias(Be,"succ","next"),e.def(Be,"$sum",ve=function(e){var t=this;null==e&&(e=16),e=o(je,"Opal").$coerce_to(e,o(je,"Integer"),"to_int");for(var r=0,n=t.length,a=0;a<n;a++)r+=t.charCodeAt(a);return e<=0?r:r&Math.pow(2,e)-1},ve.$$arity=-1),e.def(Be,"$swapcase",be=function(){var e=this,t=e.replace(/([a-z]+)|([A-Z]+)/g,function(e,t,r){return t?e.toUpperCase():e.toLowerCase()});return e.constructor===String?t:e.$class().$new(t)},be.$$arity=0),e.def(Be,"$to_f",xe=function(){var e=this;if("_"===e.charAt(0))return 0;var t=parseFloat(e.replace(/_/g,""));return isNaN(t)||t==1/0||t==-1/0?0:t},xe.$$arity=0),e.def(Be,"$to_i",we=function(e){var t=this;null==e&&(e=10);var r,n=t.toLowerCase(),a=o(je,"Opal").$coerce_to(e,o(je,"Integer"),"to_int");return(1===a||a<0||a>36)&&t.$raise(o(je,"ArgumentError"),"invalid radix "+a),/^\s*_/.test(n)?0:(n=n.replace(/^(\s*[+-]?)(0[bodx]?)(.+)$/,function(e,t,r,n){switch(n.charAt(0)){case"+":case"-":return e;case"0":if("x"===n.charAt(1)&&"0x"===r&&(0===a||16===a))return e}switch(r){case"0b":if(0===a||2===a)return a=2,t+n;break;case"0":case"0o":if(0===a||8===a)return a=8,t+n;break;case"0d":if(0===a||10===a)return a=10,t+n;break;case"0x":if(0===a||16===a)return a=16,t+n}return e}),r=parseInt(n.replace(/_(?!_)/g,""),a),isNaN(r)?0:r)},we.$$arity=-1),e.def(Be,"$to_proc",Ae=function(){var t,n=Ae.$$p,a=this,s=i;return n&&(Ae.$$p=null),s=r("$",a.valueOf()),u(a,"proc",[],(t=function(r){var n,a,c=t.$$s||this,l=t.$$p,u=l||i;l&&(t.$$p=null),n=e.slice.call(arguments,0,arguments.length),a=n,0===a.length&&c.$raise(o(je,"ArgumentError"),"no receiver given");var f=a[0];null==f&&(f=i);var $=f[s];return $?("function"==typeof u&&($.$$p=u),1===a.length?$.call(f):$.apply(f,a.slice(1))):f.$method_missing.apply(f,a)},t.$$s=a,t.$$arity=-1,t))},Ae.$$arity=0),e.def(Be,"$to_s",ke=function(){return this.toString()},ke.$$arity=0),e.alias(Be,"to_str","to_s"),e.alias(Be,"to_sym","intern"),e.def(Be,"$tr",Ee=function(e,t){var r=this;if(e=o(je,"Opal").$coerce_to(e,o(je,"String"),"to_str").$to_s(),t=o(je,"Opal").$coerce_to(t,o(je,"String"),"to_str").$to_s(),0==e.length||e===t)return r;var n,a,i,s,c,l,u,f={},$=e.split(""),p=$.length,d=t.split(""),h=d.length,_=!1,m=null;"^"===$[0]&&$.length>1&&(_=!0,$.shift(),m=d[h-1],p-=1);var y=[],g=null;for(a=!1,n=0;n<p;n++)if(s=$[n],null==g)g=s,y.push(s);else if("-"===s)"-"===g?(y.push("-"),y.push("-")):n==p-1?y.push("-"):a=!0;else if(a){for(c=g.charCodeAt(0),l=s.charCodeAt(0),c>l&&r.$raise(o(je,"ArgumentError"),'invalid range "'+String.fromCharCode(c)+"-"+String.fromCharCode(l)+'" in string transliteration'),i=c+1;i<l;i++)y.push(String.fromCharCode(i));y.push(s),a=null,g=null}else y.push(s);if($=y,p=$.length,_)for(n=0;n<p;n++)f[$[n]]=!0;else{if(h>0){var v=[],b=null;for(a=!1,n=0;n<h;n++)if(s=d[n],null==b)b=s,v.push(s);else if("-"===s)"-"===b?(v.push("-"),v.push("-")):n==h-1?v.push("-"):a=!0;else if(a){for(c=b.charCodeAt(0),l=s.charCodeAt(0),c>l&&r.$raise(o(je,"ArgumentError"),'invalid range "'+String.fromCharCode(c)+"-"+String.fromCharCode(l)+'" in string transliteration'),i=c+1;i<l;i++)v.push(String.fromCharCode(i));v.push(s),a=null,b=null}else v.push(s);d=v,h=d.length}var x=p-h;if(x>0){var w=h>0?d[h-1]:"";for(n=0;n<x;n++)d.push(w)}for(n=0;n<p;n++)f[$[n]]=d[n]}var A="";for(n=0,u=r.length;n<u;n++){s=r.charAt(n);var k=f[s];A+=_?null==k?m:s:null!=k?k:s}return r.$$cast(A)},Ee.$$arity=2),e.def(Be,"$tr_s",Se=function(e,t){var r=this;if(e=o(je,"Opal").$coerce_to(e,o(je,"String"),"to_str").$to_s(),t=o(je,"Opal").$coerce_to(t,o(je,"String"),"to_str").$to_s(),0==e.length)return r;var n,a,i,s,c,l,u,f={},$=e.split(""),p=$.length,d=t.split(""),h=d.length,_=!1,m=null;"^"===$[0]&&$.length>1&&(_=!0,$.shift(),m=d[h-1],p-=1);var y=[],g=null;for(a=!1,n=0;n<p;n++)if(s=$[n],null==g)g=s,y.push(s);else if("-"===s)"-"===g?(y.push("-"),y.push("-")):n==p-1?y.push("-"):a=!0;else if(a){for(c=g.charCodeAt(0),l=s.charCodeAt(0),c>l&&r.$raise(o(je,"ArgumentError"),'invalid range "'+String.fromCharCode(c)+"-"+String.fromCharCode(l)+'" in string transliteration'),i=c+1;i<l;i++)y.push(String.fromCharCode(i));y.push(s),a=null,g=null}else y.push(s);if($=y,p=$.length,_)for(n=0;n<p;n++)f[$[n]]=!0;else{if(h>0){var v=[];for(a=!1,n=0;n<h;n++)if(s=d[n],null==g)g=s,v.push(s);else if("-"===s)n==h-1?v.push("-"):a=!0;else if(a){for(c=g.charCodeAt(0),l=s.charCodeAt(0),c>l&&r.$raise(o(je,"ArgumentError"),'invalid range "'+String.fromCharCode(c)+"-"+String.fromCharCode(l)+'" in string transliteration'),i=c+1;i<l;i++)v.push(String.fromCharCode(i));v.push(s),a=null,g=null}else v.push(s);d=v,h=d.length}var b=p-h;if(b>0){var x=h>0?d[h-1]:"";for(n=0;n<b;n++)d.push(x)}for(n=0;n<p;n++)f[$[n]]=d[n]}var w="",A=null;for(n=0,u=r.length;n<u;n++){s=r.charAt(n);var k=f[s];_?null==k?null==A&&(w+=m,A=!0):(w+=s,A=null):null!=k?null!=A&&A===k||(w+=k,A=k):(w+=s,A=null)}return r.$$cast(w)},Se.$$arity=2),e.def(Be,"$upcase",Ne=function(){var e=this;return e.$$cast(e.toUpperCase())},Ne.$$arity=0),e.def(Be,"$upto",Ce=function(e,t){var r=Ce.$$p,n=r||i,a=this;if(r&&(Ce.$$p=null),r&&(Ce.$$p=null),null==t&&(t=!1),n===i)return a.$enum_for("upto",e,t);e=o(je,"Opal").$coerce_to(e,o(je,"String"),"to_str");var s,c,l=a.toString();if(1===l.length&&1===e.length)for(s=l.charCodeAt(0),c=e.charCodeAt(0);s<=c&&(!t||s!==c);)n(String.fromCharCode(s)),s+=1;else if(parseInt(l,10).toString()===l&&parseInt(e,10).toString()===e)for(s=parseInt(l,10),c=parseInt(e,10);s<=c&&(!t||s!==c);)n(s.toString()),s+=1;else for(;l.length<=e.length&&l<=e&&(!t||l!==e);)n(l),l=l.$succ();return a},Ce.$$arity=-2),e.def(Be,"$instance_variables",Ie=function(){return[]},Ie.$$arity=0),e.defs(Be,"$_load",Oe=function(t){var r,n,a=this;return r=e.slice.call(arguments,0,arguments.length),n=r,u(a,"new",e.to_a(n))},Oe.$$arity=-1),e.def(Be,"$unicode_normalize",Le=function(e){return this.toString()},Le.$$arity=-1),e.def(Be,"$unicode_normalized?",Pe=function(e){return!0},Pe.$$arity=-1),e.def(Be,"$unpack",Me=function(e){return this.$raise("To use String#unpack, you must first require 'corelib/string/unpack'.")},Me.$$arity=1),e.def(Be,"$unpack1",Te=function(e){return this.$raise("To use String#unpack1, you must first require 'corelib/string/unpack'.")},Te.$$arity=1)}(a[0],String,a),e.const_set(a[0],"Symbol",o(a,"String"))},Opal.modules["corelib/enumerable"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e*t:e["$*"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e<t:e["$<"](t)}function a(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}function i(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function s(e,t){return"number"==typeof e&&"number"==typeof t?e/t:e["$/"](t)}function o(e,t){return"number"==typeof e&&"number"==typeof t?e<=t:e["$<="](t)}var c=(e.top,[]),l=e.nil,u=e.const_get_qualified,f=e.const_get_relative,$=(e.breaker,e.slice,e.module),p=e.truthy,d=e.send,h=e.falsy,_=e.hash2,m=e.lambda;return e.add_stubs(["$each","$public_send","$destructure","$to_enum","$enumerator_size","$new","$yield","$raise","$slice_when","$!","$enum_for","$flatten","$map","$warn","$proc","$==","$nil?","$respond_to?","$coerce_to!","$>","$*","$coerce_to","$try_convert","$<","$+","$-","$ceil","$/","$size","$__send__","$length","$<=","$[]","$push","$<<","$[]=","$===","$inspect","$<=>","$first","$reverse","$sort","$to_proc","$compare","$call","$dup","$to_a","$sort!","$map!","$key?","$values","$zip"]),function(c,y){function g(e){return 0===e.length&&(e=[l]),e.length>1&&(e=[e]),e}var v,b,x,w,A,k,E,S,N,C,I,O,L,P,M,T,B,j,F,R,D,z,q,U,H,G,Y,V,Q,X,W,J,K,Z,ee,te,re,ne,ae,ie,se,oe,ce,le,ue,fe,$e,pe,de=$(c,"Enumerable"),he=[de].concat(y);e.def(de,"$all?",v=function(t){try{var r,n,a,i=v.$$p,s=i||l,o=this;return i&&(v.$$p=null),i&&(v.$$p=null),p(void 0!==t)?d(o,"each",[],(r=function(n){var a,i,s=(r.$$s,l);if(a=e.slice.call(arguments,0,arguments.length),i=a,s=g(i),p(d(t,"public_send",["==="].concat(e.to_a(s)))))return l;e.ret(!1)},r.$$s=o,r.$$arity=-1,r)):s!==l?d(o,"each",[],(n=function(t){var r,a;n.$$s;if(r=e.slice.call(arguments,0,arguments.length),a=r,p(e.yieldX(s,e.to_a(a))))return l;e.ret(!1)},n.$$s=o,n.$$arity=-1,n)):d(o,"each",[],(a=function(t){var r,n;a.$$s;if(r=e.slice.call(arguments,0,arguments.length),n=r,p(f(he,"Opal").$destructure(n)))return l;e.ret(!1)},a.$$s=o,a.$$arity=-1,a)),!0}catch(t){if(t===e.returner)return t.$v;throw t}},v.$$arity=-1),e.def(de,"$any?",b=function(t){try{var r,n,a,i=b.$$p,s=i||l,o=this;return i&&(b.$$p=null),i&&(b.$$p=null),p(void 0!==t)?d(o,"each",[],(r=function(n){var a,i,s=(r.$$s,l);if(a=e.slice.call(arguments,0,arguments.length),i=a,s=g(i),!p(d(t,"public_send",["==="].concat(e.to_a(s)))))return l;e.ret(!0)},r.$$s=o,r.$$arity=-1,r)):s!==l?d(o,"each",[],(n=function(t){var r,a;n.$$s;if(r=e.slice.call(arguments,0,arguments.length),a=r,!p(e.yieldX(s,e.to_a(a))))return l;e.ret(!0)},n.$$s=o,n.$$arity=-1,n)):d(o,"each",[],(a=function(t){var r,n;a.$$s;if(r=e.slice.call(arguments,0,arguments.length),n=r,!p(f(he,"Opal").$destructure(n)))return l;e.ret(!0)},a.$$s=o,a.$$arity=-1,a)),!1}catch(t){if(t===e.returner)return t.$v;throw t}},b.$$arity=-1),e.def(de,"$chunk",x=function(){var t,r,n=x.$$p,a=n||l,i=this;return n&&(x.$$p=null),n&&(x.$$p=null),a===l?d(i,"to_enum",["chunk"],(t=function(){return(t.$$s||this).$enumerator_size()},t.$$s=i,t.$$arity=0,t)):d(u("::","Enumerator"),"new",[],(r=function(t){function n(){o.length>0&&t.$yield(s,o)}var i=r.$$s||this;null==t&&(t=l);var s=l,o=[];i.$each.$$p=function(t){var r=e.yield1(a,t);r===l?(n(),o=[],s=l):(s===l||s===r?o.push(t):(n(),o=[t]),s=r)},i.$each(),n()},r.$$s=i,r.$$arity=1,r))},x.$$arity=0),e.def(de,"$chunk_while",w=function(){var t,r=w.$$p,n=r||l,a=this;return r&&(w.$$p=null),r&&(w.$$p=null),n!==l||a.$raise(f(he,"ArgumentError"),"no block given"),d(a,"slice_when",[],(t=function(r,a){t.$$s;return null==r&&(r=l),null==a&&(a=l),e.yieldX(n,[r,a])["$!"]()},t.$$s=a,t.$$arity=2,t))},w.$$arity=0),e.def(de,"$collect",A=function(){var t,r=A.$$p,n=r||l,a=this;if(r&&(A.$$p=null),r&&(A.$$p=null),n===l)return d(a,"enum_for",["collect"],(t=function(){return(t.$$s||this).$enumerator_size()},t.$$s=a,t.$$arity=0,t));var i=[];return a.$each.$$p=function(){var t=e.yieldX(n,arguments);i.push(t)},a.$each(),i},A.$$arity=0),e.def(de,"$collect_concat",k=function(){var t,r,n=k.$$p,a=n||l,i=this;return n&&(k.$$p=null),n&&(k.$$p=null),a===l?d(i,"enum_for",["collect_concat"],(t=function(){return(t.$$s||this).$enumerator_size()},t.$$s=i,t.$$arity=0,t)):d(i,"map",[],(r=function(t){r.$$s;return null==t&&(t=l),e.yield1(a,t)},r.$$s=i,r.$$arity=1,r)).$flatten(1)},k.$$arity=0),e.def(de,"$count",E=function(t){var r,n,a,i=E.$$p,s=i||l,o=this,c=l;return i&&(E.$$p=null),i&&(E.$$p=null),c=0,null!=t&&s!==l&&o.$warn("warning: given block not used"),p(null!=t)?s=d(o,"proc",[],(r=function(n){var a,i;r.$$s;return a=e.slice.call(arguments,0,arguments.length),i=a,f(he,"Opal").$destructure(i)["$=="](t)},r.$$s=o,r.$$arity=-1,r)):p(s["$nil?"]())&&(s=d(o,"proc",[],(n=function(){n.$$s;return!0},n.$$s=o,n.$$arity=0,n))),d(o,"each",[],(a=function(t){var r,n;a.$$s;return r=e.slice.call(arguments,0,arguments.length),n=r,p(e.yieldX(s,n))?c++:l},a.$$s=o,a.$$arity=-1,a)),c},E.$$arity=-1),e.def(de,"$cycle",S=function(n){var a,i=S.$$p,s=i||l,o=this;if(i&&(S.$$p=null),i&&(S.$$p=null),null==n&&(n=l),s===l)return d(o,"enum_for",["cycle",n],(a=function(){var e=a.$$s||this;return p(n["$nil?"]())?p(e["$respond_to?"]("size"))?u(f(he,"Float"),"INFINITY"):l:(n=f(he,"Opal")["$coerce_to!"](n,f(he,"Integer"),"to_int"),p(t(n,0))?r(e.$enumerator_size(),n):0)},a.$$s=o,a.$$arity=0,a));if(p(n["$nil?"]()));else if(n=f(he,"Opal")["$coerce_to!"](n,f(he,"Integer"),"to_int"),p(n<=0))return l;var c,$,h=[];if(o.$each.$$p=function(){var t=f(he,"Opal").$destructure(arguments);e.yield1(s,t);h.push(t)},o.$each(),0===h.length)return l;if(n===l)for(;;)for(c=0,$=h.length;c<$;c++)e.yield1(s,h[c]);else for(;n>1;){for(c=0,$=h.length;c<$;c++)e.yield1(s,h[c]);n--}},S.$$arity=-1),e.def(de,"$detect",N=function(t){try{var r,n=N.$$p,a=n||l,i=this;return n&&(N.$$p=null),(n&&(N.$$p=null),a===l)?i.$enum_for("detect",t):(d(i,"each",[],(r=function(t){var n,i,s=(r.$$s,l);if(n=e.slice.call(arguments,0,arguments.length),i=n,s=f(he,"Opal").$destructure(i),!p(e.yield1(a,s)))return l;e.ret(s)},r.$$s=i,r.$$arity=-1,r)),void 0!==t?"function"==typeof t?t():t:l)}catch(t){if(t===e.returner)return t.$v;throw t}},N.$$arity=-1),e.def(de,"$drop",C=function(e){var t=this;e=f(he,"Opal").$coerce_to(e,f(he,"Integer"),"to_int"),p(e<0)&&t.$raise(f(he,"ArgumentError"),"attempt to drop negative size");var r=[],n=0;return t.$each.$$p=function(){e<=n&&r.push(f(he,"Opal").$destructure(arguments)),n++},t.$each(),r},C.$$arity=1),e.def(de,"$drop_while",I=function(){var t=I.$$p,r=t||l,n=this;if(t&&(I.$$p=null),t&&(I.$$p=null),r===l)return n.$enum_for("drop_while");var a=[],i=!0;return n.$each.$$p=function(){var t=f(he,"Opal").$destructure(arguments);if(i){var n=e.yield1(r,t);h(n)&&(i=!1,a.push(t))}else a.push(t)},n.$each(),a},I.$$arity=0),e.def(de,"$each_cons",O=function(t){var r,s=O.$$p,o=s||l,c=this;if(s&&(O.$$p=null),s&&(O.$$p=null),p(1!=arguments.length)&&c.$raise(f(he,"ArgumentError"),"wrong number of arguments ("+arguments.length+" for 1)"),t=f(he,"Opal").$try_convert(t,f(he,"Integer"),"to_int"),p(t<=0)&&c.$raise(f(he,"ArgumentError"),"invalid size"),o===l)return d(c,"enum_for",["each_cons",t],(r=function(){var e,s=r.$$s||this,o=l;return o=s.$enumerator_size(),p(o["$nil?"]())?l:p(p(e=o["$=="](0))?e:n(o,t))?0:a(i(o,t),1)},r.$$s=c,r.$$arity=0,r));var u=[],$=l;return c.$each.$$p=function(){var r=f(he,"Opal").$destructure(arguments);u.push(r),u.length>t&&u.shift(),u.length==t&&e.yield1(o,u.slice(0,t))},c.$each(),$},O.$$arity=1),e.def(de,"$each_entry",L=function(t){var r,n,a,i=L.$$p,s=i||l,o=this;return i&&(L.$$p=null),i&&(L.$$p=null),r=e.slice.call(arguments,0,arguments.length),n=r,s===l?d(o,"to_enum",["each_entry"].concat(e.to_a(n)),(a=function(){return(a.$$s||this).$enumerator_size()},a.$$s=o,a.$$arity=0,a)):(o.$each.$$p=function(){var t=f(he,"Opal").$destructure(arguments);e.yield1(s,t)},o.$each.apply(o,n),o)},L.$$arity=-1),e.def(de,"$each_slice",P=function(t){var r,n=P.$$p,a=n||l,i=this;if(n&&(P.$$p=null),n&&(P.$$p=null),t=f(he,"Opal").$coerce_to(t,f(he,"Integer"),"to_int"),p(t<=0)&&i.$raise(f(he,"ArgumentError"),"invalid slice size"),a===l)return d(i,"enum_for",["each_slice",t],(r=function(){var e=r.$$s||this;return p(e["$respond_to?"]("size"))?s(e.$size(),t).$ceil():l},r.$$s=i,r.$$arity=0,r));var o=[];return i.$each.$$p=function(){var r=f(he,"Opal").$destructure(arguments);o.push(r),o.length===t&&(e.yield1(a,o),o=[])},i.$each(),o.length>0&&e.yield1(a,o),l},P.$$arity=1),e.def(de,"$each_with_index",M=function(t){var r,n,a,i=M.$$p,s=i||l,o=this;if(i&&(M.$$p=null),i&&(M.$$p=null),r=e.slice.call(arguments,0,arguments.length),n=r,s===l)return d(o,"enum_for",["each_with_index"].concat(e.to_a(n)),(a=function(){return(a.$$s||this).$enumerator_size()},a.$$s=o,a.$$arity=0,a));var c=0;return o.$each.$$p=function(){var e=f(he,"Opal").$destructure(arguments);s(e,c),c++},o.$each.apply(o,n),o},M.$$arity=-1),e.def(de,"$each_with_object",T=function(e){var t,r=T.$$p,n=r||l,a=this;if(r&&(T.$$p=null),r&&(T.$$p=null),n===l)return d(a,"enum_for",["each_with_object",e],(t=function(){return(t.$$s||this).$enumerator_size()},t.$$s=a,t.$$arity=0,t));return a.$each.$$p=function(){var t=f(he,"Opal").$destructure(arguments);n(t,e)},a.$each(),e},T.$$arity=1),e.def(de,"$entries",B=function(t){var r,n,a=this;r=e.slice.call(arguments,0,arguments.length),n=r;var i=[];return a.$each.$$p=function(){i.push(f(he,"Opal").$destructure(arguments))},a.$each.apply(a,n),i},B.$$arity=-1),e.alias(de,"find","detect"),e.def(de,"$find_all",j=function(){var t,r=j.$$p,n=r||l,a=this;if(r&&(j.$$p=null),r&&(j.$$p=null),n===l)return d(a,"enum_for",["find_all"],(t=function(){return(t.$$s||this).$enumerator_size()},t.$$s=a,t.$$arity=0,t));var i=[];return a.$each.$$p=function(){var t=f(he,"Opal").$destructure(arguments),r=e.yield1(n,t);p(r)&&i.push(t)},a.$each(),i},j.$$arity=0),e.def(de,"$find_index",F=function(t){try{var r,n,a=F.$$p,i=a||l,s=this,o=l;return a&&(F.$$p=null),(a&&(F.$$p=null),p(void 0===t&&i===l))?s.$enum_for("find_index"):(null!=t&&i!==l&&s.$warn("warning: given block not used"),o=0,p(null!=t)?d(s,"each",[],(r=function(n){var a,i;r.$$s;return a=e.slice.call(arguments,0,arguments.length),i=a,
f(he,"Opal").$destructure(i)["$=="](t)&&e.ret(o),o+=1},r.$$s=s,r.$$arity=-1,r)):d(s,"each",[],(n=function(t){var r,a;n.$$s;return r=e.slice.call(arguments,0,arguments.length),a=r,p(e.yieldX(i,e.to_a(a)))&&e.ret(o),o+=1},n.$$s=s,n.$$arity=-1,n)),l)}catch(t){if(t===e.returner)return t.$v;throw t}},F.$$arity=-1),e.def(de,"$first",R=function(t){try{var r,n,a=this,i=l,s=l;return p(void 0===t)?d(a,"each",[],(r=function(t){r.$$s;null==t&&(t=l),e.ret(t)},r.$$s=a,r.$$arity=1,r)):(i=[],t=f(he,"Opal").$coerce_to(t,f(he,"Integer"),"to_int"),p(t<0)&&a.$raise(f(he,"ArgumentError"),"attempt to take negative size"),p(0==t)?[]:(s=0,d(a,"each",[],(n=function(r){var a,o;n.$$s;if(a=e.slice.call(arguments,0,arguments.length),o=a,i.push(f(he,"Opal").$destructure(o)),!p(t<=++s))return l;e.ret(i)},n.$$s=a,n.$$arity=-1,n)),i))}catch(t){if(t===e.returner)return t.$v;throw t}},R.$$arity=-1),e.alias(de,"flat_map","collect_concat"),e.def(de,"$grep",D=function(r){var n,a=D.$$p,i=a||l,s=this,c=l;return a&&(D.$$p=null),a&&(D.$$p=null),c=[],d(s,"each",[],(n=function(a){var s,u,f=(n.$$s,l);return s=e.slice.call(arguments,0,arguments.length),u=s,f=g(u),p(d(r,"__send__",["==="].concat(e.to_a(f))))?(i!==l?(p(t(u.$length(),1))&&(u=[u]),u=e.yieldX(i,e.to_a(u))):p(o(u.$length(),1))&&(u=u["$[]"](0)),c.$push(u)):l},n.$$s=s,n.$$arity=-1,n)),c},D.$$arity=1),e.def(de,"$grep_v",z=function(r){var n,a=z.$$p,i=a||l,s=this,c=l;return a&&(z.$$p=null),a&&(z.$$p=null),c=[],d(s,"each",[],(n=function(a){var s,u,f=(n.$$s,l);return s=e.slice.call(arguments,0,arguments.length),u=s,f=g(u),p(d(r,"__send__",["==="].concat(e.to_a(f))))?l:(i!==l?(p(t(u.$length(),1))&&(u=[u]),u=e.yieldX(i,e.to_a(u))):p(o(u.$length(),1))&&(u=u["$[]"](0)),c.$push(u))},n.$$s=s,n.$$arity=-1,n)),c},z.$$arity=1),e.def(de,"$group_by",q=function(){var t,r,n=q.$$p,a=n||l,s=this,o=l,c=l;if(n&&(q.$$p=null),n&&(q.$$p=null),a===l)return d(s,"enum_for",["group_by"],(t=function(){return(t.$$s||this).$enumerator_size()},t.$$s=s,t.$$arity=0,t));o=_([],{});return s.$each.$$p=function(){var t=f(he,"Opal").$destructure(arguments),n=e.yield1(a,t);(p(r=o["$[]"](n))?r:(c=[n,[]],d(o,"[]=",e.to_a(c)),c[i(c.length,1)]))["$<<"](t)},s.$each(),o},q.$$arity=0),e.def(de,"$include?",U=function(t){try{var r,n=this;return d(n,"each",[],(r=function(n){var a,i;r.$$s;if(a=e.slice.call(arguments,0,arguments.length),i=a,!f(he,"Opal").$destructure(i)["$=="](t))return l;e.ret(!0)},r.$$s=n,r.$$arity=-1,r)),!1}catch(t){if(t===e.returner)return t.$v;throw t}},U.$$arity=1),e.def(de,"$inject",H=function(t,r){var n=H.$$p,a=n||l,i=this;n&&(H.$$p=null),n&&(H.$$p=null);var s=t;return a!==l&&void 0===r?i.$each.$$p=function(){var t=f(he,"Opal").$destructure(arguments);if(void 0===s)return void(s=t);t=e.yieldX(a,[s,t]),s=t}:(void 0===r&&(f(he,"Symbol")["$==="](t)||i.$raise(f(he,"TypeError"),t.$inspect()+" is not a Symbol"),r=t,s=void 0),i.$each.$$p=function(){var e=f(he,"Opal").$destructure(arguments);if(void 0===s)return void(s=e);s=s.$__send__(r,e)}),i.$each(),void 0==s?l:s},H.$$arity=-1),e.def(de,"$lazy",G=function(){var t,r=this;return d(u(f(he,"Enumerator"),"Lazy"),"new",[r,r.$enumerator_size()],(t=function(r,n){var a,i;t.$$s;return null==r&&(r=l),a=e.slice.call(arguments,1,arguments.length),i=a,d(r,"yield",e.to_a(i))},t.$$s=r,t.$$arity=-2,t))},G.$$arity=0),e.def(de,"$enumerator_size",Y=function(){var e=this;return p(e["$respond_to?"]("size"))?e.$size():l},Y.$$arity=0),e.alias(de,"map","collect"),e.def(de,"$max",V=function(t){var r=V.$$p,n=r||l,a=this;if(r&&(V.$$p=null),r&&(V.$$p=null),void 0===t||t===l){var i,s;return a.$each.$$p=function(){var t=f(he,"Opal").$destructure(arguments);if(void 0===i)return void(i=t);s=n!==l?e.yieldX(n,[t,i]):t["$<=>"](i),s===l&&a.$raise(f(he,"ArgumentError"),"comparison failed"),s>0&&(i=t)},a.$each(),void 0===i?l:i}return t=f(he,"Opal").$coerce_to(t,f(he,"Integer"),"to_int"),d(a,"sort",[],n.$to_proc()).$reverse().$first(t)},V.$$arity=-1),e.def(de,"$max_by",Q=function(){var t,r=Q.$$p,n=r||l,a=this;if(r&&(Q.$$p=null),r&&(Q.$$p=null),!p(n))return d(a,"enum_for",["max_by"],(t=function(){return(t.$$s||this).$enumerator_size()},t.$$s=a,t.$$arity=0,t));var i,s;return a.$each.$$p=function(){var t=f(he,"Opal").$destructure(arguments),r=e.yield1(n,t);if(void 0===i)return i=t,void(s=r);r["$<=>"](s)>0&&(i=t,s=r)},a.$each(),void 0===i?l:i},Q.$$arity=0),e.alias(de,"member?","include?"),e.def(de,"$min",X=function(){var e=X.$$p,t=e||l,r=this;e&&(X.$$p=null),e&&(X.$$p=null);var n;return r.$each.$$p=t!==l?function(){var e=f(he,"Opal").$destructure(arguments);if(void 0===n)return void(n=e);var a=t(e,n);a===l&&r.$raise(f(he,"ArgumentError"),"comparison failed"),a<0&&(n=e)}:function(){var e=f(he,"Opal").$destructure(arguments);if(void 0===n)return void(n=e);f(he,"Opal").$compare(e,n)<0&&(n=e)},r.$each(),void 0===n?l:n},X.$$arity=0),e.def(de,"$min_by",W=function(){var t,r=W.$$p,n=r||l,a=this;if(r&&(W.$$p=null),r&&(W.$$p=null),!p(n))return d(a,"enum_for",["min_by"],(t=function(){return(t.$$s||this).$enumerator_size()},t.$$s=a,t.$$arity=0,t));var i,s;return a.$each.$$p=function(){var t=f(he,"Opal").$destructure(arguments),r=e.yield1(n,t);if(void 0===i)return i=t,void(s=r);r["$<=>"](s)<0&&(i=t,s=r)},a.$each(),void 0===i?l:i},W.$$arity=0),e.def(de,"$minmax",J=function(){var e,t,r=J.$$p,n=r||l,a=this;r&&(J.$$p=null),r&&(J.$$p=null),n=p(e=n)?e:d(a,"proc",[],(t=function(e,r){t.$$s;return null==e&&(e=l),null==r&&(r=l),e["$<=>"](r)},t.$$s=a,t.$$arity=2,t));var i=l,s=l,o=!0;return a.$each.$$p=function(){var e=f(he,"Opal").$destructure(arguments);if(o)i=s=e,o=!1;else{var t=n.$call(i,e);t===l?a.$raise(f(he,"ArgumentError"),"comparison failed"):t>0&&(i=e);var r=n.$call(s,e);r===l?a.$raise(f(he,"ArgumentError"),"comparison failed"):r<0&&(s=e)}},a.$each(),[i,s]},J.$$arity=0),e.def(de,"$minmax_by",K=function(){var e=K.$$p,t=this;return e&&(K.$$p=null),e&&(K.$$p=null),t.$raise(f(he,"NotImplementedError"))},K.$$arity=0),e.def(de,"$none?",Z=function(t){try{var r,n,a,i=Z.$$p,s=i||l,o=this;return i&&(Z.$$p=null),i&&(Z.$$p=null),p(void 0!==t)?d(o,"each",[],(r=function(n){var a,i,s=(r.$$s,l);if(a=e.slice.call(arguments,0,arguments.length),i=a,s=g(i),!p(d(t,"public_send",["==="].concat(e.to_a(s)))))return l;e.ret(!1)},r.$$s=o,r.$$arity=-1,r)):s!==l?d(o,"each",[],(n=function(t){var r,a;n.$$s;if(r=e.slice.call(arguments,0,arguments.length),a=r,!p(e.yieldX(s,e.to_a(a))))return l;e.ret(!1)},n.$$s=o,n.$$arity=-1,n)):d(o,"each",[],(a=function(t){var r,n,i=(a.$$s,l);if(r=e.slice.call(arguments,0,arguments.length),n=r,i=f(he,"Opal").$destructure(n),!p(i))return l;e.ret(!1)},a.$$s=o,a.$$arity=-1,a)),!0}catch(t){if(t===e.returner)return t.$v;throw t}},Z.$$arity=-1),e.def(de,"$one?",ee=function(r){try{var n,i,s,o=ee.$$p,c=o||l,u=this,$=l;return o&&(ee.$$p=null),o&&(ee.$$p=null),$=0,p(void 0!==r)?d(u,"each",[],(n=function(i){var s,o,c=(n.$$s,l);return s=e.slice.call(arguments,0,arguments.length),o=s,c=g(o),p(d(r,"public_send",["==="].concat(e.to_a(c))))?($=a($,1),p(t($,1))?void e.ret(!1):l):l},n.$$s=u,n.$$arity=-1,n)):c!==l?d(u,"each",[],(i=function(r){var n,s;i.$$s;return n=e.slice.call(arguments,0,arguments.length),s=n,p(e.yieldX(c,e.to_a(s)))?($=a($,1),p(t($,1))?void e.ret(!1):l):l},i.$$s=u,i.$$arity=-1,i)):d(u,"each",[],(s=function(r){var n,i;s.$$s;return n=e.slice.call(arguments,0,arguments.length),i=n,p(f(he,"Opal").$destructure(i))?($=a($,1),p(t($,1))?void e.ret(!1):l):l},s.$$s=u,s.$$arity=-1,s)),$["$=="](1)}catch(t){if(t===e.returner)return t.$v;throw t}},ee.$$arity=-1),e.def(de,"$partition",te=function(){var t,r=te.$$p,n=r||l,a=this;if(r&&(te.$$p=null),r&&(te.$$p=null),n===l)return d(a,"enum_for",["partition"],(t=function(){return(t.$$s||this).$enumerator_size()},t.$$s=a,t.$$arity=0,t));var i=[],s=[];return a.$each.$$p=function(){var t=f(he,"Opal").$destructure(arguments),r=e.yield1(n,t);p(r)?i.push(t):s.push(t)},a.$each(),[i,s]},te.$$arity=0),e.alias(de,"reduce","inject"),e.def(de,"$reject",re=function(){var t,r=re.$$p,n=r||l,a=this;if(r&&(re.$$p=null),r&&(re.$$p=null),n===l)return d(a,"enum_for",["reject"],(t=function(){return(t.$$s||this).$enumerator_size()},t.$$s=a,t.$$arity=0,t));var i=[];return a.$each.$$p=function(){var t=f(he,"Opal").$destructure(arguments),r=e.yield1(n,t);h(r)&&i.push(t)},a.$each(),i},re.$$arity=0),e.def(de,"$reverse_each",ne=function(){var t,r=ne.$$p,n=r||l,a=this;if(r&&(ne.$$p=null),r&&(ne.$$p=null),n===l)return d(a,"enum_for",["reverse_each"],(t=function(){return(t.$$s||this).$enumerator_size()},t.$$s=a,t.$$arity=0,t));var i=[];a.$each.$$p=function(){i.push(arguments)},a.$each();for(var s=i.length-1;s>=0;s--)e.yieldX(n,i[s]);return i},ne.$$arity=0),e.alias(de,"select","find_all"),e.def(de,"$slice_before",ae=function(t){var r,n=ae.$$p,a=n||l,i=this;return n&&(ae.$$p=null),n&&(ae.$$p=null),p(void 0===t&&a===l)&&i.$raise(f(he,"ArgumentError"),"both pattern and block are given"),p(void 0!==t&&a!==l||arguments.length>1)&&i.$raise(f(he,"ArgumentError"),"wrong number of arguments ("+arguments.length+" expected 1)"),d(f(he,"Enumerator"),"new",[],(r=function(n){var i=r.$$s||this;null==n&&(n=l);var s=[];i.$each.$$p=a!==l?void 0===t?function(){var t=f(he,"Opal").$destructure(arguments),r=e.yield1(a,t);p(r)&&s.length>0&&(n["$<<"](s),s=[]),s.push(t)}:function(){var e=f(he,"Opal").$destructure(arguments),r=a(e,t.$dup());p(r)&&s.length>0&&(n["$<<"](s),s=[]),s.push(e)}:function(){var e=f(he,"Opal").$destructure(arguments),r=t["$==="](e);p(r)&&s.length>0&&(n["$<<"](s),s=[]),s.push(e)},i.$each(),s.length>0&&n["$<<"](s)},r.$$s=i,r.$$arity=1,r))},ae.$$arity=-1),e.def(de,"$slice_after",ie=function(t){var r,n,a=ie.$$p,i=a||l,s=this;return a&&(ie.$$p=null),a&&(ie.$$p=null),p(void 0===t&&i===l)&&s.$raise(f(he,"ArgumentError"),"both pattern and block are given"),p(void 0!==t&&i!==l||arguments.length>1)&&s.$raise(f(he,"ArgumentError"),"wrong number of arguments ("+arguments.length+" expected 1)"),p(void 0!==t)&&(i=d(s,"proc",[],(r=function(e){r.$$s;return null==e&&(e=l),t["$==="](e)},r.$$s=s,r.$$arity=1,r))),d(f(he,"Enumerator"),"new",[],(n=function(t){var r=n.$$s||this;null==t&&(t=l);var a;r.$each.$$p=function(){var r=f(he,"Opal").$destructure(arguments),n=e.yield1(i,r);null==a&&(a=[]),p(n)?(a.push(r),t.$yield(a),a=null):a.push(r)},r.$each(),null!=a&&t.$yield(a)},n.$$s=s,n.$$arity=1,n))},ie.$$arity=-1),e.def(de,"$slice_when",se=function(){var t,r=se.$$p,n=r||l,a=this;return r&&(se.$$p=null),r&&(se.$$p=null),n!==l||a.$raise(f(he,"ArgumentError"),"wrong number of arguments (0 for 1)"),d(f(he,"Enumerator"),"new",[],(t=function(r){var a=t.$$s||this;null==r&&(r=l);var i=l,s=l;a.$each_cons.$$p=function(){var t=f(he,"Opal").$destructure(arguments),a=t[0],o=t[1],c=e.yieldX(n,[a,o]);s=o,i===l&&(i=[]),p(c)?(i.push(a),r.$yield(i),i=[]):i.push(a)},a.$each_cons(2),i!==l&&(i.push(s),r.$yield(i))},t.$$s=a,t.$$arity=1,t))},se.$$arity=0),e.def(de,"$sort",oe=function(){var e,t=oe.$$p,r=t||l,n=this,a=l;return t&&(oe.$$p=null),t&&(oe.$$p=null),a=n.$to_a(),r!==l||(r=m((e=function(t,r){e.$$s;return null==t&&(t=l),null==r&&(r=l),t["$<=>"](r)},e.$$s=n,e.$$arity=2,e))),d(a,"sort",[],r.$to_proc())},oe.$$arity=0),e.def(de,"$sort_by",ce=function(){var t,r,n,a,i=ce.$$p,s=i||l,o=this,c=l;return i&&(ce.$$p=null),i&&(ce.$$p=null),s===l?d(o,"enum_for",["sort_by"],(t=function(){return(t.$$s||this).$enumerator_size()},t.$$s=o,t.$$arity=0,t)):(c=d(o,"map",[],(r=function(){var t=(r.$$s,l);return t=f(he,"Opal").$destructure(arguments),[e.yield1(s,t),t]},r.$$s=o,r.$$arity=0,r)),d(c,"sort!",[],(n=function(e,t){n.$$s;return null==e&&(e=l),null==t&&(t=l),e[0]["$<=>"](t[0])},n.$$s=o,n.$$arity=2,n)),d(c,"map!",[],(a=function(e){a.$$s;return null==e&&(e=l),e[1]},a.$$s=o,a.$$arity=1,a)))},ce.$$arity=0),e.def(de,"$sum",le=function(t){var r,n=le.$$p,i=n||l,s=this,o=l;return n&&(le.$$p=null),null==t&&(t=0),o=t,d(s,"each",[],(r=function(t){var n,s,c=(r.$$s,l);return n=e.slice.call(arguments,0,arguments.length),s=n,c=function(){return i!==l?e.yieldX(i,e.to_a(s)):f(he,"Opal").$destructure(s)}(),o=a(o,c)},r.$$s=s,r.$$arity=-1,r)),o},le.$$arity=-1),e.def(de,"$take",ue=function(e){return this.$first(e)},ue.$$arity=1),e.def(de,"$take_while",fe=function(){try{var t,r=fe.$$p,n=r||l,a=this,i=l;return r&&(fe.$$p=null),(r&&(fe.$$p=null),p(n))?(i=[],d(a,"each",[],(t=function(r){var a,s,o=(t.$$s,l);return a=e.slice.call(arguments,0,arguments.length),s=a,o=f(he,"Opal").$destructure(s),p(e.yield1(n,o))||e.ret(i),i.push(o)},t.$$s=a,t.$$arity=-1,t))):a.$enum_for("take_while")}catch(t){if(t===e.returner)return t.$v;throw t}},fe.$$arity=0),e.def(de,"$uniq",$e=function(){var t,r=$e.$$p,n=r||l,a=this,s=l;return r&&($e.$$p=null),r&&($e.$$p=null),s=_([],{}),d(a,"each",[],(t=function(r){var a,o,c=(t.$$s,l),u=l,$=l;return a=e.slice.call(arguments,0,arguments.length),o=a,c=f(he,"Opal").$destructure(o),u=function(){return n!==l?e.yield1(n,c):c}(),p(s["$key?"](u))?l:($=[u,c],d(s,"[]=",e.to_a($)),$[i($.length,1)])},t.$$s=a,t.$$arity=-1,t)),s.$values()},$e.$$arity=0),e.alias(de,"to_a","entries"),e.def(de,"$zip",pe=function(t){var r,n,a=pe.$$p,i=this;return a&&(pe.$$p=null),a&&(pe.$$p=null),r=e.slice.call(arguments,0,arguments.length),n=r,d(i.$to_a(),"zip",e.to_a(n))},pe.$$arity=-1)}(c[0],c)},Opal.modules["corelib/enumerator"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e<t:e["$<"](t)}var n=e.top,a=[],i=e.nil,s=(e.const_get_qualified,e.const_get_relative),o=e.breaker,c=e.slice,l=e.klass,u=e.truthy,f=e.send,$=e.falsy;return e.add_stubs(["$require","$include","$allocate","$new","$to_proc","$coerce_to","$nil?","$empty?","$+","$class","$__send__","$===","$call","$enum_for","$size","$destructure","$inspect","$any?","$[]","$raise","$yield","$each","$enumerator_size","$respond_to?","$try_convert","$<","$for"]),n.$require("corelib/enumerable"),function(n,a,p){var d,h,_,m,y,g,v=l(n,null,"Enumerator"),b=[v].concat(p);return v.$$prototype.size=v.$$prototype.args=v.$$prototype.object=v.$$prototype.method=i,v.$include(s(b,"Enumerable")),v.$$prototype.$$is_enumerator=!0,e.defs(v,"$for",d=function(t,r,n){var a,s,o,c=d.$$p,l=c||i,u=this;c&&(d.$$p=null),c&&(d.$$p=null),a=e.slice.call(arguments,1,arguments.length),a.length>0&&(s=a[0],a.splice(0,1)),null==s&&(s="each"),o=a;var f=u.$allocate();return f.object=t,f.size=l,f.method=s,f.args=o,f},d.$$arity=-2),e.def(v,"$initialize",h=function(t){var r=h.$$p,n=r||i,a=this;return r&&(h.$$p=null),r&&(h.$$p=null),e.slice.call(arguments,0,arguments.length),u(n)?(a.object=f(s(b,"Generator"),"new",[],n.$to_proc()),a.method="each",a.args=[],a.size=arguments[0]||i,u(a.size)?a.size=s(b,"Opal").$coerce_to(a.size,s(b,"Integer"),"to_int"):i):(a.object=arguments[0],a.method=arguments[1]||"each",a.args=c.call(arguments,2),a.size=i)},h.$$arity=-1),e.def(v,"$each",_=function(r){var n,a,s,o=_.$$p,c=o||i,l=this;return o&&(_.$$p=null),o&&(_.$$p=null),n=e.slice.call(arguments,0,arguments.length),a=n,u(u(s=c["$nil?"]())?a["$empty?"]():s)?l:(a=t(l.args,a),u(c["$nil?"]())?f(l.$class(),"new",[l.object,l.method].concat(e.to_a(a))):f(l.object,"__send__",[l.method].concat(e.to_a(a)),c.$to_proc()))},_.$$arity=-1),e.def(v,"$size",m=function(){var t=this;return u(s(b,"Proc")["$==="](t.size))?f(t.size,"call",e.to_a(t.args)):t.size},m.$$arity=0),e.def(v,"$with_index",y=function(e){var t,r=y.$$p,n=r||i,a=this;if(r&&(y.$$p=null),r&&(y.$$p=null),null==e&&(e=0),e=function(){return u(e)?s(b,"Opal").$coerce_to(e,s(b,"Integer"),"to_int"):0}(),!u(n))return f(a,"enum_for",["with_index",e],(t=function(){return(t.$$s||this).$size()},t.$$s=a,t.$$arity=0,t));var o=e;return a.$each.$$p=function(){var e=s(b,"Opal").$destructure(arguments),t=n(e,o);return o++,t},a.$each()},y.$$arity=-1),e.alias(v,"with_object","each_with_object"),e.def(v,"$inspect",g=function(){var e=this,r=i;return r="#<"+e.$class()+": "+e.object.$inspect()+":"+e.method,u(e.args["$any?"]())&&(r=t(r,"("+e.args.$inspect()["$[]"](s(b,"Range").$new(1,-2))+")")),t(r,">")},g.$$arity=0),function(t,r,n){var a,c,$=l(t,null,"Generator"),p=[$].concat(n);$.$$prototype.block=i,$.$include(s(p,"Enumerable")),e.def($,"$initialize",a=function(){var e=a.$$p,t=e||i,r=this;return e&&(a.$$p=null),e&&(a.$$p=null),u(t)||r.$raise(s(p,"LocalJumpError"),"no block given"),r.block=t},a.$$arity=0),e.def($,"$each",c=function(t){var r,n,a=c.$$p,l=a||i,u=this,$=i;a&&(c.$$p=null),a&&(c.$$p=null),r=e.slice.call(arguments,0,arguments.length),n=r,$=f(s(p,"Yielder"),"new",[],l.$to_proc());try{n.unshift($),e.yieldX(u.block,n)}catch(e){if(e===o)return o.$v;throw e}return u},c.$$arity=-1)}(b[0],0,b),function(t,r,n){var a,s,c,u=l(t,null,"Yielder");[u].concat(n);u.$$prototype.block=i,e.def(u,"$initialize",a=function(){var e=a.$$p,t=e||i,r=this;return e&&(a.$$p=null),e&&(a.$$p=null),r.block=t},a.$$arity=0),e.def(u,"$yield",s=function(t){var r,n,a=this;r=e.slice.call(arguments,0,arguments.length),n=r;var i=e.yieldX(a.block,n);if(i===o)throw o;return i},s.$$arity=-1),e.def(u,"$<<",c=function(t){var r,n,a=this;return r=e.slice.call(arguments,0,arguments.length),n=r,f(a,"yield",e.to_a(n)),a},c.$$arity=-1)}(b[0],0,b),function(n,a,o){var c,p,d,h,_,m,y,g,v,b,x,w,A,k=l(n,a,"Lazy"),E=[k].concat(o);return k.$$prototype.enumerator=i,function(e,t,r){var n=l(e,t,"StopLazyError");[n].concat(r)}(E[0],s(E,"Exception"),E),e.def(k,"$initialize",c=function(t,r){var n,a=c.$$p,o=a||i,l=this;return a&&(c.$$p=null),a&&(c.$$p=null),null==r&&(r=i),o!==i||l.$raise(s(E,"ArgumentError"),"tried to call lazy new without a block"),l.enumerator=t,f(l,e.find_super_dispatcher(l,"initialize",c,!1),[r],(n=function(r,a){var c,l,u,$=n.$$s||this;null==r&&(r=i),c=e.slice.call(arguments,1,arguments.length),l=c;try{return f(t,"each",e.to_a(l),(u=function(t){var n,a;u.$$s;n=e.slice.call(arguments,0,arguments.length),a=n,a.unshift(r),e.yieldX(o,a)},u.$$s=$,u.$$arity=-1,u))}catch(t){if(!e.rescue(t,[s(E,"Exception")]))throw t;try{return i}finally{e.pop_exception()}}},n.$$s=l,n.$$arity=-2,n))},c.$$arity=-2),e.alias(k,"force","to_a"),e.def(k,"$lazy",p=function(){return this},p.$$arity=0),e.def(k,"$collect",d=function(){var t,r=d.$$p,n=r||i,a=this;return r&&(d.$$p=null),r&&(d.$$p=null),u(n)||a.$raise(s(E,"ArgumentError"),"tried to call lazy map without a block"),f(s(E,"Lazy"),"new",[a,a.$enumerator_size()],(t=function(r,a){var s,o;t.$$s;null==r&&(r=i),s=e.slice.call(arguments,1,arguments.length),o=s;var c=e.yieldX(n,o);r.$yield(c)},t.$$s=a,t.$$arity=-2,t))},d.$$arity=0),e.def(k,"$collect_concat",h=function(){var t,r=h.$$p,n=r||i,a=this;return r&&(h.$$p=null),r&&(h.$$p=null),u(n)||a.$raise(s(E,"ArgumentError"),"tried to call lazy map without a block"),f(s(E,"Lazy"),"new",[a,i],(t=function(r,a){var o,c,l,u,$=t.$$s||this;null==r&&(r=i),o=e.slice.call(arguments,1,arguments.length),c=o;var p=e.yieldX(n,c);if(p["$respond_to?"]("force")&&p["$respond_to?"]("each"))f(p,"each",[],(l=function(e){l.$$s;return null==e&&(e=i),r.$yield(e)},l.$$s=$,l.$$arity=1,l));else{s(E,"Opal").$try_convert(p,s(E,"Array"),"to_ary")===i?r.$yield(p):f(p,"each",[],(u=function(e){u.$$s;return null==e&&(e=i),r.$yield(e)},u.$$s=$,u.$$arity=1,u))}},t.$$s=a,t.$$arity=-2,t))},h.$$arity=0),e.def(k,"$drop",_=function(n){var a,o=this,c=i,l=i,$=i;return n=s(E,"Opal").$coerce_to(n,s(E,"Integer"),"to_int"),u(r(n,0))&&o.$raise(s(E,"ArgumentError"),"attempt to drop negative size"),c=o.$enumerator_size(),l=function(){return u(s(E,"Integer")["$==="](c))&&u(r(n,c))?n:c}(),$=0,f(s(E,"Lazy"),"new",[o,l],(a=function(s,o){var c,l;a.$$s;return null==s&&(s=i),c=e.slice.call(arguments,1,arguments.length),l=c,u(r($,n))?$=t($,1):f(s,"yield",e.to_a(l))},a.$$s=o,a.$$arity=-2,a))},_.$$arity=1),e.def(k,"$drop_while",m=function(){var t,r=m.$$p,n=r||i,a=this,o=i;return r&&(m.$$p=null),r&&(m.$$p=null),u(n)||a.$raise(s(E,"ArgumentError"),"tried to call lazy drop_while without a block"),o=!0,f(s(E,"Lazy"),"new",[a,i],(t=function(r,a){var s,c;t.$$s;if(null==r&&(r=i),s=e.slice.call(arguments,1,arguments.length),c=s,!u(o))return f(r,"yield",e.to_a(c));var l=e.yieldX(n,c);$(l)&&(o=!1,f(r,"yield",e.to_a(c)))},t.$$s=a,t.$$arity=-2,t))},m.$$arity=0),e.def(k,"$enum_for",y=function(t,r){var n,a,s,o=y.$$p,c=o||i,l=this;return o&&(y.$$p=null),o&&(y.$$p=null),n=e.slice.call(arguments,0,arguments.length),n.length>0&&(a=n[0],n.splice(0,1)),null==a&&(a="each"),s=n,f(l.$class(),"for",[l,a].concat(e.to_a(s)),c.$to_proc())},y.$$arity=-1),e.def(k,"$find_all",g=function(){var t,r=g.$$p,n=r||i,a=this;return r&&(g.$$p=null),r&&(g.$$p=null),u(n)||a.$raise(s(E,"ArgumentError"),"tried to call lazy select without a block"),f(s(E,"Lazy"),"new",[a,i],(t=function(r,a){var s,o;t.$$s;null==r&&(r=i),s=e.slice.call(arguments,1,arguments.length),o=s;var c=e.yieldX(n,o);u(c)&&f(r,"yield",e.to_a(o))},t.$$s=a,t.$$arity=-2,t))},g.$$arity=0),e.alias(k,"flat_map","collect_concat"),e.def(k,"$grep",v=function(t){var r,n,a=v.$$p,o=a||i,c=this;return a&&(v.$$p=null),a&&(v.$$p=null),u(o)?f(s(E,"Lazy"),"new",[c,i],(r=function(n,a){var c,l;r.$$s;null==n&&(n=i),c=e.slice.call(arguments,1,arguments.length),l=c;var f=s(E,"Opal").$destructure(l),$=t["$==="](f);u($)&&($=e.yield1(o,f),n.$yield(e.yield1(o,f)))},r.$$s=c,r.$$arity=-2,r)):f(s(E,"Lazy"),"new",[c,i],(n=function(r,a){var o,c;n.$$s;null==r&&(r=i),o=e.slice.call(arguments,1,arguments.length),c=o;var l=s(E,"Opal").$destructure(c),f=t["$==="](l);u(f)&&r.$yield(l)},n.$$s=c,n.$$arity=-2,n))},v.$$arity=1),e.alias(k,"map","collect"),e.alias(k,"select","find_all"),e.def(k,"$reject",b=function(){var t,r=b.$$p,n=r||i,a=this;return r&&(b.$$p=null),r&&(b.$$p=null),u(n)||a.$raise(s(E,"ArgumentError"),"tried to call lazy reject without a block"),f(s(E,"Lazy"),"new",[a,i],(t=function(r,a){var s,o;t.$$s;null==r&&(r=i),s=e.slice.call(arguments,1,arguments.length),o=s;var c=e.yieldX(n,o);$(c)&&f(r,"yield",e.to_a(o))},t.$$s=a,t.$$arity=-2,t))},b.$$arity=0),e.def(k,"$take",x=function(n){var a,o=this,c=i,l=i,$=i;return n=s(E,"Opal").$coerce_to(n,s(E,"Integer"),"to_int"),u(r(n,0))&&o.$raise(s(E,"ArgumentError"),"attempt to take negative size"),c=o.$enumerator_size(),l=function(){return u(s(E,"Integer")["$==="](c))&&u(r(n,c))?n:c}(),$=0,f(s(E,"Lazy"),"new",[o,l],(a=function(o,c){var l,p,d=a.$$s||this;return null==o&&(o=i),l=e.slice.call(arguments,1,arguments.length),p=l,u(r($,n))?(f(o,"yield",e.to_a(p)),$=t($,1)):d.$raise(s(E,"StopLazyError"))},a.$$s=o,a.$$arity=-2,a))},x.$$arity=1),e.def(k,"$take_while",w=function(){var t,r=w.$$p,n=r||i,a=this;return r&&(w.$$p=null),r&&(w.$$p=null),u(n)||a.$raise(s(E,"ArgumentError"),"tried to call lazy take_while without a block"),f(s(E,"Lazy"),"new",[a,i],(t=function(r,a){var o,c,l=t.$$s||this;null==r&&(r=i),o=e.slice.call(arguments,1,arguments.length),c=o;var $=e.yieldX(n,c);u($)?f(r,"yield",e.to_a(c)):l.$raise(s(E,"StopLazyError"))},t.$$s=a,t.$$arity=-2,t))},w.$$arity=0),e.alias(k,"to_enum","enum_for"),e.def(k,"$inspect",A=function(){var e=this;return"#<"+e.$class()+": "+e.enumerator.$inspect()+">"},A.$$arity=0),i&&"inspect"}(b[0],v,b)}(a[0],0,a)},Opal.modules["corelib/numeric"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e*t:e["$*"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e<t:e["$<"](t)}function a(e,t){return"number"==typeof e&&"number"==typeof t?e/t:e["$/"](t)}function i(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}var s=e.top,o=[],c=e.nil,l=e.const_get_qualified,u=e.const_get_relative,f=(e.breaker,e.slice,e.klass),$=e.truthy,p=e.hash2;return e.add_stubs(["$require","$include","$instance_of?","$class","$Float","$respond_to?","$coerce","$__send__","$===","$raise","$equal?","$-","$*","$div","$<","$-@","$ceil","$to_f","$denominator","$to_r","$==","$floor","$/","$%","$Complex","$zero?","$numerator","$abs","$arg","$coerce_to!","$round","$to_i","$truncate","$>"]),s.$require("corelib/comparable"),function(s,o,d){var h,_,m,y,g,v,b,x,w,A,k,E,S,N,C,I,O,L,P,M,T,B,j,F,R,D,z,q,U,H,G,Y,V,Q,X,W,J,K=f(s,null,"Numeric"),Z=[K].concat(d);return K.$include(u(Z,"Comparable")),e.def(K,"$coerce",h=function(e){var t=this;return $(e["$instance_of?"](t.$class()))?[e,t]:[t.$Float(e),t.$Float(t)]},h.$$arity=1),e.def(K,"$__coerced__",_=function(t,r){var n,a,i=this,s=c,o=c,l=c;return $(r["$respond_to?"]("coerce"))?(a=r.$coerce(i),n=e.to_ary(a),s=null==n[0]?c:n[0],o=null==n[1]?c:n[1],s.$__send__(t,o)):function(){return l=t,"+"["$==="](l)||"-"["$==="](l)||"*"["$==="](l)||"/"["$==="](l)||"%"["$==="](l)||"&"["$==="](l)||"|"["$==="](l)||"^"["$==="](l)||"**"["$==="](l)?i.$raise(u(Z,"TypeError"),r.$class()+" can't be coerced into Numeric"):">"["$==="](l)||">="["$==="](l)||"<"["$==="](l)||"<="["$==="](l)||"<=>"["$==="](l)?i.$raise(u(Z,"ArgumentError"),"comparison of "+i.$class()+" with "+r.$class()+" failed"):c}()},_.$$arity=2),e.def(K,"$<=>",m=function(e){return $(this["$equal?"](e))?0:c},m.$$arity=1),e.def(K,"$+@",y=function(){return this},y.$$arity=0),e.def(K,"$-@",g=function(){return t(0,this)},g.$$arity=0),e.def(K,"$%",v=function(e){var n=this;return t(n,r(e,n.$div(e)))},v.$$arity=1),e.def(K,"$abs",b=function(){var e=this;return n(e,0)?e["$-@"]():e},b.$$arity=0),e.def(K,"$abs2",x=function(){var e=this;return r(e,e)},x.$$arity=0),e.def(K,"$angle",w=function(){return n(this,0)?l(u(Z,"Math"),"PI"):0},w.$$arity=0),e.alias(K,"arg","angle"),e.def(K,"$ceil",A=function(e){var t=this;return null==e&&(e=0),t.$to_f().$ceil(e)},A.$$arity=-1),e.def(K,"$conj",k=function(){return this},k.$$arity=0),e.alias(K,"conjugate","conj"),e.def(K,"$denominator",E=function(){return this.$to_r().$denominator()},E.$$arity=0),e.def(K,"$div",S=function(e){var t=this;return e["$=="](0)&&t.$raise(u(Z,"ZeroDivisionError"),"divided by o"),a(t,e).$floor()},S.$$arity=1),e.def(K,"$divmod",N=function(e){var t=this;return[t.$div(e),t["$%"](e)]},N.$$arity=1),e.def(K,"$fdiv",C=function(e){return a(this.$to_f(),e)},C.$$arity=1),e.def(K,"$floor",I=function(e){var t=this;return null==e&&(e=0),t.$to_f().$floor(e)},I.$$arity=-1),e.def(K,"$i",O=function(){var e=this;return e.$Complex(0,e)},O.$$arity=0),e.def(K,"$imag",L=function(){return 0},L.$$arity=0),e.alias(K,"imaginary","imag"),e.def(K,"$integer?",P=function(){return!1},P.$$arity=0),e.alias(K,"magnitude","abs"),e.alias(K,"modulo","%"),e.def(K,"$nonzero?",M=function(){var e=this;return $(e["$zero?"]())?c:e},M.$$arity=0),e.def(K,"$numerator",T=function(){return this.$to_r().$numerator()},T.$$arity=0),e.alias(K,"phase","arg"),e.def(K,"$polar",B=function(){var e=this;return[e.$abs(),e.$arg()]},B.$$arity=0),e.def(K,"$quo",j=function(e){var t=this;return a(u(Z,"Opal")["$coerce_to!"](t,u(Z,"Rational"),"to_r"),e)},j.$$arity=1),e.def(K,"$real",F=function(){return this},F.$$arity=0),e.def(K,"$real?",R=function(){return!0},R.$$arity=0),e.def(K,"$rect",D=function(){return[this,0]},D.$$arity=0),e.alias(K,"rectangular","rect"),e.def(K,"$round",z=function(e){return this.$to_f().$round(e)},z.$$arity=-1),e.def(K,"$to_c",q=function(){var e=this;return e.$Complex(e,0)},q.$$arity=0),e.def(K,"$to_int",U=function(){return this.$to_i()},U.$$arity=0),e.def(K,"$truncate",H=function(e){var t=this;return null==e&&(e=0),t.$to_f().$truncate(e)},H.$$arity=-1),e.def(K,"$zero?",G=function(){return this["$=="](0)},G.$$arity=0),e.def(K,"$positive?",Y=function(){return i(this,0)},Y.$$arity=0),e.def(K,"$negative?",V=function(){return n(this,0)},V.$$arity=0),e.def(K,"$dup",Q=function(){return this},Q.$$arity=0),e.def(K,"$clone",X=function(t){var r,n=this;if(null==t)t=p([],{});else if(!t.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return r=t.$$smap.freeze,null==r&&(r=!0),n},X.$$arity=-1),e.def(K,"$finite?",W=function(){return!0},W.$$arity=0),e.def(K,"$infinite?",J=function(){return c},J.$$arity=0),c&&"infinite?"}(o[0],0,o)},Opal.modules["corelib/array"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e*t:e["$*"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e>=t:e["$>="](t)}function a(e,t){return"number"==typeof e&&"number"==typeof t?e<t:e["$<"](t)}function i(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}var s=e.top,o=[],c=e.nil,l=e.const_get_qualified,u=e.const_get_relative,f=(e.breaker,e.slice,e.klass),$=e.truthy,p=e.hash2,d=e.send,h=e.gvars;return e.add_stubs(["$require","$include","$to_a","$warn","$raise","$replace","$respond_to?","$to_ary","$coerce_to","$coerce_to?","$===","$join","$to_str","$class","$hash","$<=>","$==","$object_id","$inspect","$enum_for","$bsearch_index","$to_proc","$nil?","$coerce_to!","$>","$*","$enumerator_size","$empty?","$size","$map","$equal?","$dup","$each","$[]","$dig","$eql?","$length","$begin","$end","$exclude_end?","$flatten","$__id__","$to_s","$new","$max","$min","$!","$>=","$**","$delete_if","$reverse","$rotate","$rand","$at","$keep_if","$shuffle!","$<","$sort","$sort_by","$!=","$times","$[]=","$-","$<<","$values","$is_a?","$last","$first","$upto","$reject","$pristine","$singleton_class"]),s.$require("corelib/enumerable"),s.$require("corelib/numeric"),function(s,o,_){function m(t,r){return r.$$name===e.Array?t:r.$allocate().$replace(t.$to_a())}function y(t,r){var n,a,i,s,o=t.length;return n=r.excl,a=e.Opal.$coerce_to(r.begin,e.Integer,"to_int"),i=e.Opal.$coerce_to(r.end,e.Integer,"to_int"),a<0&&(a+=o)<0?c:a>o?c:i<0&&(i+=o)<0?[]:(n||(i+=1),s=t.slice(a,i),m(s,t.$class()))}function g(t,r,n){var a,i=t.length;return(r=e.Opal.$coerce_to(r,e.Integer,"to_int"))<0&&(r+=i)<0?c:void 0===n?r>=i||r<0?c:t[r]:(n=e.Opal.$coerce_to(n,e.Integer,"to_int"))<0||r>i||r<0?c:(a=t.slice(r,r+n),m(a,t.$class()))}function v(e,t){return e===t||0===t?1:t>0&&e>t?v(e-1,t-1)+v(e-1,t):0}function b(e,t){for(var r=t>=0?1:0;t;)r*=e,e--,t--;return r}var x,w,A,k,E,S,N,C,I,O,L,P,M,T,B,j,F,R,D,z,q,U,H,G,Y,V,Q,X,W,J,K,Z,ee,te,re,ne,ae,ie,se,oe,ce,le,ue,fe,$e,pe,de,he,_e,me,ye,ge,ve,be,xe,we,Ae,ke,Ee,Se,Ne,Ce,Ie,Oe,Le,Pe,Me,Te,Be,je,Fe,Re,De,ze,qe,Ue,He,Ge,Ye,Ve,Qe,Xe,We,Je,Ke,Ze,et,tt,rt,nt,at,it,st,ot=f(s,o,"Array"),ct=[ot].concat(_);return ot.$include(u(ct,"Enumerable")),e.defineProperty(ot.$$prototype,"$$is_array",!0),e.defs(ot,"$[]",x=function(t){var r,n,a=this;return r=e.slice.call(arguments,0,arguments.length),n=r,m(n,a)},x.$$arity=-1),e.def(ot,"$initialize",w=function(e,t){var r=w.$$p,n=r||c,a=this;if(r&&(w.$$p=null),r&&(w.$$p=null),null==e&&(e=c),null==t&&(t=c),t!==c&&n!==c&&a.$warn("warning: block supersedes default value argument"),e>l(u(ct,"Integer"),"MAX")&&a.$raise(u(ct,"ArgumentError"),"array size too big"),arguments.length>2&&a.$raise(u(ct,"ArgumentError"),"wrong number of arguments ("+arguments.length+" for 0..2)"),0===arguments.length)return a.splice(0,a.length),a;if(1===arguments.length){if(e.$$is_array)return a.$replace(e.$to_a()),a;if(e["$respond_to?"]("to_ary"))return a.$replace(e.$to_ary()),a}e=u(ct,"Opal").$coerce_to(e,u(ct,"Integer"),"to_int"),e<0&&a.$raise(u(ct,"ArgumentError"),"negative array size"),a.splice(0,a.length);var i,s;if(n===c)for(i=0;i<e;i++)a.push(t);else for(i=0,s;i<e;i++)s=n(i),a[i]=s;return a},w.$$arity=-1),e.defs(ot,"$try_convert",A=function(e){return u(ct,"Opal")["$coerce_to?"](e,u(ct,"Array"),"to_ary")},A.$$arity=1),e.def(ot,"$&",k=function(t){var r=this;t=function(){return $(u(ct,"Array")["$==="](t))?t.$to_a():u(ct,"Opal").$coerce_to(t,u(ct,"Array"),"to_ary").$to_a()}();var n,a,i,s=[],o=p([],{});for(n=0,a=t.length;n<a;n++)e.hash_put(o,t[n],!0);for(n=0,a=r.length;n<a;n++)i=r[n],void 0!==e.hash_delete(o,i)&&s.push(i);return s},k.$$arity=1),e.def(ot,"$|",E=function(t){var r=this;t=function(){return $(u(ct,"Array")["$==="](t))?t.$to_a():u(ct,"Opal").$coerce_to(t,u(ct,"Array"),"to_ary").$to_a()}();var n,a,i=p([],{});for(n=0,a=r.length;n<a;n++)e.hash_put(i,r[n],!0);for(n=0,a=t.length;n<a;n++)e.hash_put(i,t[n],!0);return i.$keys()},E.$$arity=1),e.def(ot,"$*",S=function(e){var t=this;if($(e["$respond_to?"]("to_str")))return t.$join(e.$to_str());e=u(ct,"Opal").$coerce_to(e,u(ct,"Integer"),"to_int"),$(e<0)&&t.$raise(u(ct,"ArgumentError"),"negative argument");for(var r=[],n=t.$to_a(),a=0;a<e;a++)r=r.concat(n)
;return m(r,t.$class())},S.$$arity=1),e.def(ot,"$+",N=function(e){var t=this;return e=function(){return $(u(ct,"Array")["$==="](e))?e.$to_a():u(ct,"Opal").$coerce_to(e,u(ct,"Array"),"to_ary").$to_a()}(),t.concat(e)},N.$$arity=1),e.def(ot,"$-",C=function(t){var r=this;if(t=function(){return $(u(ct,"Array")["$==="](t))?t.$to_a():u(ct,"Opal").$coerce_to(t,u(ct,"Array"),"to_ary").$to_a()}(),$(0===r.length))return[];if($(0===t.length))return r.slice();var n,a,i,s=[],o=p([],{});for(n=0,a=t.length;n<a;n++)e.hash_put(o,t[n],!0);for(n=0,a=r.length;n<a;n++)i=r[n],void 0===e.hash_get(o,i)&&s.push(i);return s},C.$$arity=1),e.def(ot,"$<<",I=function(e){var t=this;return t.push(e),t},I.$$arity=1),e.def(ot,"$<=>",O=function(e){var t=this;if($(u(ct,"Array")["$==="](e)))e=e.$to_a();else{if(!$(e["$respond_to?"]("to_ary")))return c;e=e.$to_ary().$to_a()}if(t.$hash()===e.$hash())return 0;for(var r=Math.min(t.length,e.length),n=0;n<r;n++){var a=t[n]["$<=>"](e[n]);if(0!==a)return a}return t.length["$<=>"](e.length)},O.$$arity=1),e.def(ot,"$==",L=function(e){function t(e,r){var a,i,s,o;if(e===r)return!0;if(!r.$$is_array)return!!u(ct,"Opal")["$respond_to?"](r,"to_ary")&&r["$=="](e);if(e.$$constructor!==Array&&(e=e.$to_a()),r.$$constructor!==Array&&(r=r.$to_a()),e.length!==r.length)return!1;for(n[e.$object_id()]=!0,a=0,i=e.length;a<i;a++)if(s=e[a],o=r[a],s.$$is_array){if(o.$$is_array&&o.length!==s.length)return!1;if(!n.hasOwnProperty(s.$object_id())&&!t(s,o))return!1}else if(!s["$=="](o))return!1;return!0}var r=this,n={};return t(r,e)},L.$$arity=1),e.def(ot,"$[]",P=function(e,t){var r=this;return e.$$is_range?y(r,e):g(r,e,t)},P.$$arity=-2),e.def(ot,"$[]=",M=function(e,t,r){var n,a=this,i=c,s=c,o=a.length;if($(u(ct,"Range")["$==="](e))){i=function(){return $(u(ct,"Array")["$==="](t))?t.$to_a():$(t["$respond_to?"]("to_ary"))?t.$to_ary().$to_a():[t]}();var l=e.excl,f=u(ct,"Opal").$coerce_to(e.begin,u(ct,"Integer"),"to_int"),p=u(ct,"Opal").$coerce_to(e.end,u(ct,"Integer"),"to_int");if(f<0&&(f+=o)<0&&a.$raise(u(ct,"RangeError"),e.$inspect()+" out of range"),p<0&&(p+=o),l||(p+=1),f>o)for(n=o;n<f;n++)a[n]=c;return p<0?a.splice.apply(a,[f,0].concat(i)):a.splice.apply(a,[f,p-f].concat(i)),t}$(void 0===r)?s=1:(s=t,t=r,i=function(){return $(u(ct,"Array")["$==="](t))?t.$to_a():$(t["$respond_to?"]("to_ary"))?t.$to_ary().$to_a():[t]}());var d;if(e=u(ct,"Opal").$coerce_to(e,u(ct,"Integer"),"to_int"),s=u(ct,"Opal").$coerce_to(s,u(ct,"Integer"),"to_int"),e<0&&(d=e,(e+=o)<0&&a.$raise(u(ct,"IndexError"),"index "+d+" too small for array; minimum "+-a.length)),s<0&&a.$raise(u(ct,"IndexError"),"negative length ("+s+")"),e>o)for(n=o;n<e;n++)a[n]=c;return void 0===r?a[e]=t:a.splice.apply(a,[e,s].concat(i)),t},M.$$arity=-3),e.def(ot,"$any?",T=function(t){var r=T.$$p,n=this,a=c,i=c,s=c;for(r&&(T.$$p=null),i=0,s=arguments.length,a=new Array(s);i<s;i++)a[i]=arguments[i];return r&&(T.$$p=null),0!==n.length&&d(n,e.find_super_dispatcher(n,"any?",T,!1),a,r)},T.$$arity=-1),e.def(ot,"$assoc",B=function(e){for(var t,r=this,n=0,a=r.length;n<a;n++)if(t=r[n],t.length&&t[0]["$=="](e))return t;return c},B.$$arity=1),e.def(ot,"$at",j=function(e){var t=this;return e=u(ct,"Opal").$coerce_to(e,u(ct,"Integer"),"to_int"),e<0&&(e+=t.length),e<0||e>=t.length?c:t[e]},j.$$arity=1),e.def(ot,"$bsearch_index",F=function(){var t=F.$$p,r=t||c,n=this;if(t&&(F.$$p=null),t&&(F.$$p=null),r===c)return n.$enum_for("bsearch_index");for(var a,i,s,o=0,l=n.length,f=!1,$=c;o<l;){if(a=o+Math.floor((l-o)/2),i=n[a],!0===(s=e.yield1(r,i)))$=a,f=!0;else if(!1===s||s===c)f=!1;else if(s.$$is_number){if(0===s)return a;f=s<0}else n.$raise(u(ct,"TypeError"),"wrong argument type "+s.$class()+" (must be numeric, true, false or nil)");f?l=a:o=a+1}return $},F.$$arity=0),e.def(ot,"$bsearch",R=function(){var e=R.$$p,t=e||c,r=this,n=c;return e&&(R.$$p=null),e&&(R.$$p=null),t===c?r.$enum_for("bsearch"):(n=d(r,"bsearch_index",[],t.$to_proc()),null!=n&&n.$$is_number?r[n]:n)},R.$$arity=0),e.def(ot,"$cycle",D=function(n){var a,i,s=D.$$p,o=s||c,f=this;if(s&&(D.$$p=null),s&&(D.$$p=null),null==n&&(n=c),o===c)return d(f,"enum_for",["cycle",n],(a=function(){var e=a.$$s||this;return $(n["$nil?"]())?l(u(ct,"Float"),"INFINITY"):(n=u(ct,"Opal")["$coerce_to!"](n,u(ct,"Integer"),"to_int"),$(t(n,0))?r(e.$enumerator_size(),n):0)},a.$$s=f,a.$$arity=0,a));if($($(i=f["$empty?"]())?i:n["$=="](0)))return c;var p,h;if(n===c)for(;;)for(p=0,h=f.length;p<h;p++)e.yield1(o,f[p]);else{if((n=u(ct,"Opal")["$coerce_to!"](n,u(ct,"Integer"),"to_int"))<=0)return f;for(;n>0;){for(p=0,h=f.length;p<h;p++)e.yield1(o,f[p]);n--}}return f},D.$$arity=-1),e.def(ot,"$clear",z=function(){var e=this;return e.splice(0,e.length),e},z.$$arity=0),e.def(ot,"$count",q=function(t){var r,n=q.$$p,a=n||c,i=this,s=c,o=c,l=c;for(n&&(q.$$p=null),o=0,l=arguments.length,s=new Array(l);o<l;o++)s[o]=arguments[o];return n&&(q.$$p=null),null==t&&(t=c),$($(r=t)?r:a)?d(i,e.find_super_dispatcher(i,"count",q,!1),s,n):i.$size()},q.$$arity=-1),e.def(ot,"$initialize_copy",U=function(e){return this.$replace(e)},U.$$arity=1),e.def(ot,"$collect",H=function(){var t,r=H.$$p,n=r||c,a=this;if(r&&(H.$$p=null),r&&(H.$$p=null),n===c)return d(a,"enum_for",["collect"],(t=function(){return(t.$$s||this).$size()},t.$$s=a,t.$$arity=0,t));for(var i=[],s=0,o=a.length;s<o;s++){var l=e.yield1(n,a[s]);i.push(l)}return i},H.$$arity=0),e.def(ot,"$collect!",G=function(){var t,r=G.$$p,n=r||c,a=this;if(r&&(G.$$p=null),r&&(G.$$p=null),n===c)return d(a,"enum_for",["collect!"],(t=function(){return(t.$$s||this).$size()},t.$$s=a,t.$$arity=0,t));for(var i=0,s=a.length;i<s;i++){var o=e.yield1(n,a[i]);a[i]=o}return a},G.$$arity=0),e.def(ot,"$combination",Y=function(t){var r,n=Y.$$p,a=n||c,i=this,s=c;if(n&&(Y.$$p=null),s=u(ct,"Opal")["$coerce_to!"](t,u(ct,"Integer"),"to_int"),a===c)return d(i,"enum_for",["combination",s],(r=function(){return v((r.$$s||this).length,s)},r.$$s=i,r.$$arity=0,r));var o,l,f,$,p,h,_;if(0===s)e.yield1(a,[]);else if(1===s)for(o=0,l=i.length;o<l;o++)e.yield1(a,[i[o]]);else if(s===i.length)e.yield1(a,i.slice());else if(s>=0&&s<i.length){for(f=[],o=0;o<=s+1;o++)f.push(0);for($=[],p=0,h=!1,f[0]=-1;!h;){for($[p]=i[f[p+1]];p<s-1;)p++,_=f[p+1]=f[p]+1,$[p]=i[_];e.yield1(a,$.slice()),p++;do{h=0===p,f[p]++,p--}while(f[p+1]+s===i.length+p+1)}}return i},Y.$$arity=1),e.def(ot,"$repeated_combination",V=function(t){function r(t,n,a,s){if(a.length==t){var o=a.slice();return void e.yield1(i,o)}for(var c=n;c<s.length;c++)a.push(s[c]),r(t,c,a,s),a.pop()}var n,a=V.$$p,i=a||c,s=this,o=c;return a&&(V.$$p=null),o=u(ct,"Opal")["$coerce_to!"](t,u(ct,"Integer"),"to_int"),i===c?d(s,"enum_for",["repeated_combination",o],(n=function(){return v((n.$$s||this).length+o-1,o)},n.$$s=s,n.$$arity=0,n)):(o>=0&&r(o,0,[],s),s)},V.$$arity=1),e.def(ot,"$compact",Q=function(){for(var e,t=this,r=[],n=0,a=t.length;n<a;n++)(e=t[n])!==c&&r.push(e);return r},Q.$$arity=0),e.def(ot,"$compact!",X=function(){for(var e=this,t=e.length,r=0,n=e.length;r<n;r++)e[r]===c&&(e.splice(r,1),n--,r--);return e.length===t?c:e},X.$$arity=0),e.def(ot,"$concat",W=function(t){var r,n,a,i,s=this;return r=e.slice.call(arguments,0,arguments.length),n=r,n=d(n,"map",[],(a=function(e){var t=a.$$s||this;return null==e&&(e=c),e=function(){return $(u(ct,"Array")["$==="](e))?e.$to_a():u(ct,"Opal").$coerce_to(e,u(ct,"Array"),"to_ary").$to_a()}(),$(e["$equal?"](t))&&(e=e.$dup()),e},a.$$s=s,a.$$arity=1,a)),d(n,"each",[],(i=function(e){var t=i.$$s||this;null==e&&(e=c);for(var r=0,n=e.length;r<n;r++)t.push(e[r])},i.$$s=s,i.$$arity=1,i)),s},W.$$arity=-1),e.def(ot,"$delete",J=function(t){var r=J.$$p,n=r||c,a=this;r&&(J.$$p=null);for(var i=a.length,s=0,o=i;s<o;s++)a[s]["$=="](t)&&(a.splice(s,1),o--,s--);return a.length===i?n!==c?e.yieldX(n,[]):c:t},J.$$arity=1),e.def(ot,"$delete_at",K=function(e){var t=this;if(e=u(ct,"Opal").$coerce_to(e,u(ct,"Integer"),"to_int"),e<0&&(e+=t.length),e<0||e>=t.length)return c;var r=t[e];return t.splice(e,1),r},K.$$arity=1),e.def(ot,"$delete_if",Z=function(){var e,t=Z.$$p,r=t||c,n=this;if(t&&(Z.$$p=null),t&&(Z.$$p=null),r===c)return d(n,"enum_for",["delete_if"],(e=function(){return(e.$$s||this).$size()},e.$$s=n,e.$$arity=0,e));for(var a,i=0,s=n.length;i<s;i++)!1!==(a=r(n[i]))&&a!==c&&(n.splice(i,1),s--,i--);return n},Z.$$arity=0),e.def(ot,"$dig",ee=function(t,r){var n,a,i=this,s=c;return n=e.slice.call(arguments,1,arguments.length),a=n,(s=i["$[]"](t))===c||0===a.length?s:($(s["$respond_to?"]("dig"))||i.$raise(u(ct,"TypeError"),s.$class()+" does not have #dig method"),d(s,"dig",e.to_a(a)))},ee.$$arity=-2),e.def(ot,"$drop",te=function(e){var t=this;return e<0&&t.$raise(u(ct,"ArgumentError")),t.slice(e)},te.$$arity=1),e.def(ot,"$dup",re=function(){var t=re.$$p,r=this,n=c,a=c,i=c;for(t&&(re.$$p=null),a=0,i=arguments.length,n=new Array(i);a<i;a++)n[a]=arguments[a];return r.$$class===e.Array&&r.$$class.$allocate.$$pristine&&r.$copy_instance_variables.$$pristine&&r.$initialize_dup.$$pristine?r.slice(0):d(r,e.find_super_dispatcher(r,"dup",re,!1),n,t)},re.$$arity=0),e.def(ot,"$each",ne=function(){var t,r=ne.$$p,n=r||c,a=this;if(r&&(ne.$$p=null),r&&(ne.$$p=null),n===c)return d(a,"enum_for",["each"],(t=function(){return(t.$$s||this).$size()},t.$$s=a,t.$$arity=0,t));for(var i=0,s=a.length;i<s;i++){e.yield1(n,a[i])}return a},ne.$$arity=0),e.def(ot,"$each_index",ae=function(){var t,r=ae.$$p,n=r||c,a=this;if(r&&(ae.$$p=null),r&&(ae.$$p=null),n===c)return d(a,"enum_for",["each_index"],(t=function(){return(t.$$s||this).$size()},t.$$s=a,t.$$arity=0,t));for(var i=0,s=a.length;i<s;i++){e.yield1(n,i)}return a},ae.$$arity=0),e.def(ot,"$empty?",ie=function(){return 0===this.length},ie.$$arity=0),e.def(ot,"$eql?",se=function(e){function t(e,r){var a,i,s,o;if(!r.$$is_array)return!1;if(r=r.$to_a(),e.length!==r.length)return!1;for(n[e.$object_id()]=!0,a=0,i=e.length;a<i;a++)if(s=e[a],o=r[a],s.$$is_array){if(o.$$is_array&&o.length!==s.length)return!1;if(!n.hasOwnProperty(s.$object_id())&&!t(s,o))return!1}else if(!s["$eql?"](o))return!1;return!0}var r=this,n={};return t(r,e)},se.$$arity=1),e.def(ot,"$fetch",oe=function(e,t){var r=oe.$$p,n=r||c,a=this;r&&(oe.$$p=null),r&&(oe.$$p=null);var i=e;return e=u(ct,"Opal").$coerce_to(e,u(ct,"Integer"),"to_int"),e<0&&(e+=a.length),e>=0&&e<a.length?a[e]:(n!==c&&null!=t&&a.$warn("warning: block supersedes default value argument"),n!==c?n(i):null!=t?t:void(0===a.length?a.$raise(u(ct,"IndexError"),"index "+i+" outside of array bounds: 0...0"):a.$raise(u(ct,"IndexError"),"index "+i+" outside of array bounds: -"+a.length+"..."+a.length)))},oe.$$arity=-2),e.def(ot,"$fill",ce=function(t){var r,n,a,i,s=ce.$$p,o=s||c,l=this,f=c,p=c,d=c,h=c,_=c;s&&(ce.$$p=null),s&&(ce.$$p=null),r=e.slice.call(arguments,0,arguments.length),n=r;var m,y;if($(o)?($(n.length>2)&&l.$raise(u(ct,"ArgumentError"),"wrong number of arguments ("+n.$length()+" for 0..2)"),i=n,a=e.to_ary(i),f=null==a[0]?c:a[0],p=null==a[1]?c:a[1]):($(0==n.length)?l.$raise(u(ct,"ArgumentError"),"wrong number of arguments (0 for 1..3)"):$(n.length>3)&&l.$raise(u(ct,"ArgumentError"),"wrong number of arguments ("+n.$length()+" for 1..3)"),i=n,a=e.to_ary(i),d=null==a[0]?c:a[0],f=null==a[1]?c:a[1],p=null==a[2]?c:a[2]),$(u(ct,"Range")["$==="](f))){if($(p)&&l.$raise(u(ct,"TypeError"),"length invalid with range"),h=u(ct,"Opal").$coerce_to(f.$begin(),u(ct,"Integer"),"to_int"),$(h<0)&&(h+=this.length),$(h<0)&&l.$raise(u(ct,"RangeError"),f.$inspect()+" out of range"),_=u(ct,"Opal").$coerce_to(f.$end(),u(ct,"Integer"),"to_int"),$(_<0)&&(_+=this.length),$(f["$exclude_end?"]())||(_+=1),$(_<=h))return l}else if($(f))if(h=u(ct,"Opal").$coerce_to(f,u(ct,"Integer"),"to_int"),$(h<0)&&(h+=this.length),$(h<0)&&(h=0),$(p)){if(_=u(ct,"Opal").$coerce_to(p,u(ct,"Integer"),"to_int"),$(0==_))return l;_+=h}else _=this.length;else h=0,_=this.length;if($(h>this.length))for(m=this.length;m<_;m++)l[m]=c;if($(_>this.length)&&(this.length=_),$(o))for(this.length;h<_;h++)y=o(h),l[h]=y;else for(this.length;h<_;h++)l[h]=d;return l},ce.$$arity=-1),e.def(ot,"$first",le=function(e){var t=this;return null==e?0===t.length?c:t[0]:(e=u(ct,"Opal").$coerce_to(e,u(ct,"Integer"),"to_int"),e<0&&t.$raise(u(ct,"ArgumentError"),"negative array size"),t.slice(0,e))},le.$$arity=-1),e.def(ot,"$flatten",ue=function(e){function t(e,n){var a,i,s,o,l=[];for(e=e.$to_a(),a=0,i=e.length;a<i;a++)if(s=e[a],u(ct,"Opal")["$respond_to?"](s,"to_ary",!0))if((o=s.$to_ary())!==c)switch(o.$$is_array||r.$raise(u(ct,"TypeError")),o===r&&r.$raise(u(ct,"ArgumentError")),n){case void 0:l=l.concat(t(o));break;case 0:l.push(o);break;default:l.push.apply(l,t(o,n-1))}else l.push(s);else l.push(s);return l}var r=this;return void 0!==e&&(e=u(ct,"Opal").$coerce_to(e,u(ct,"Integer"),"to_int")),m(t(r,e),r.$class())},ue.$$arity=-1),e.def(ot,"$flatten!",fe=function(e){var t=this,r=t.$flatten(e);if(t.length==r.length){for(var n=0,a=t.length;n<a&&t[n]===r[n];n++);if(n==a)return c}return t.$replace(r),t},fe.$$arity=-1),e.def(ot,"$hash",$e=function(){var t,r,n,a=this,i=void 0===e.hash_ids,s=["A"],o=a.$object_id();try{if(i&&(e.hash_ids=Object.create(null)),e.hash_ids[o])return"self";for(n in e.hash_ids)if(t=e.hash_ids[n],a["$eql?"](t))return"self";for(e.hash_ids[o]=a,r=0;r<a.length;r++)t=a[r],s.push(t.$hash());return s.join(",")}finally{i&&(e.hash_ids=void 0)}},$e.$$arity=0),e.def(ot,"$include?",pe=function(e){for(var t=this,r=0,n=t.length;r<n;r++)if(t[r]["$=="](e))return!0;return!1},pe.$$arity=1),e.def(ot,"$index",de=function(e){var t=de.$$p,r=t||c,n=this;t&&(de.$$p=null),t&&(de.$$p=null);var a,i,s;if(null!=e&&r!==c&&n.$warn("warning: given block not used"),null!=e){for(a=0,i=n.length;a<i;a++)if(n[a]["$=="](e))return a}else{if(r===c)return n.$enum_for("index");for(a=0,i=n.length;a<i;a++)if(!1!==(s=r(n[a]))&&s!==c)return a}return c},de.$$arity=-1),e.def(ot,"$insert",he=function(t,r){var n,a,i=this;if(n=e.slice.call(arguments,1,arguments.length),a=n,t=u(ct,"Opal").$coerce_to(t,u(ct,"Integer"),"to_int"),a.length>0){if(t<0&&(t+=i.length+1)<0&&i.$raise(u(ct,"IndexError"),t+" is out of bounds"),t>i.length)for(var s=i.length;s<t;s++)i.push(c);i.splice.apply(i,[t,0].concat(a))}return i},he.$$arity=-2),e.def(ot,"$inspect",_e=function(){for(var e=this,t=[],r=e.$__id__(),n=0,a=e.length;n<a;n++){var i=e["$[]"](n);i.$__id__()===r?t.push("[...]"):t.push(i.$inspect())}return"["+t.join(", ")+"]"},_e.$$arity=0),e.def(ot,"$join",me=function(t){var r=this;if(null==h[","]&&(h[","]=c),null==t&&(t=c),$(0===r.length))return"";$(t===c)&&(t=h[","]);var n,a,i,s,o=[];for(n=0,a=r.length;n<a;n++)i=r[n],u(ct,"Opal")["$respond_to?"](i,"to_str")&&(s=i.$to_str())!==c?o.push(s.$to_s()):u(ct,"Opal")["$respond_to?"](i,"to_ary")&&(s=i.$to_ary(),s===r&&r.$raise(u(ct,"ArgumentError")),s!==c)?o.push(s.$join(t)):u(ct,"Opal")["$respond_to?"](i,"to_s")&&(s=i.$to_s())!==c?o.push(s):r.$raise(u(ct,"NoMethodError").$new(e.inspect(i)+" doesn't respond to #to_str, #to_ary or #to_s","to_str"));return t===c?o.join(""):o.join(u(ct,"Opal")["$coerce_to!"](t,u(ct,"String"),"to_str").$to_s())},me.$$arity=-1),e.def(ot,"$keep_if",ye=function(){var e,t=ye.$$p,r=t||c,n=this;if(t&&(ye.$$p=null),t&&(ye.$$p=null),r===c)return d(n,"enum_for",["keep_if"],(e=function(){return(e.$$s||this).$size()},e.$$s=n,e.$$arity=0,e));for(var a,i=0,s=n.length;i<s;i++)!1!==(a=r(n[i]))&&a!==c||(n.splice(i,1),s--,i--);return n},ye.$$arity=0),e.def(ot,"$last",ge=function(e){var t=this;return null==e?0===t.length?c:t[t.length-1]:(e=u(ct,"Opal").$coerce_to(e,u(ct,"Integer"),"to_int"),e<0&&t.$raise(u(ct,"ArgumentError"),"negative array size"),e>t.length&&(e=t.length),t.slice(t.length-e,t.length))},ge.$$arity=-1),e.def(ot,"$length",ve=function(){return this.length},ve.$$arity=0),e.alias(ot,"map","collect"),e.alias(ot,"map!","collect!"),e.def(ot,"$max",be=function(e){var t=be.$$p,r=t||c,n=this;return t&&(be.$$p=null),t&&(be.$$p=null),d(n.$each(),"max",[e],r.$to_proc())},be.$$arity=-1),e.def(ot,"$min",xe=function(){var e=xe.$$p,t=e||c,r=this;return e&&(xe.$$p=null),e&&(xe.$$p=null),d(r.$each(),"min",[],t.$to_proc())},xe.$$arity=0),e.def(ot,"$permutation",we=function(t){var r,n=we.$$p,a=n||c,i=this,s=c,o=c;if(n&&(we.$$p=null),n&&(we.$$p=null),a===c)return d(i,"enum_for",["permutation",t],(r=function(){var e=r.$$s||this;return b(e.length,void 0===t?e.length:t)},r.$$s=i,r.$$arity=0,r));var l,f,$;if((t=void 0===t?i.length:u(ct,"Opal").$coerce_to(t,u(ct,"Integer"),"to_int"))<0||i.length<t);else if(0===t)e.yield1(a,[]);else if(1===t)for(var p=0;p<i.length;p++)e.yield1(a,[i[p]]);else s=u(ct,"Array").$new(t),o=u(ct,"Array").$new(i.length,!1),l=function(t,r,n,a,s){i=this;for(var o=0;o<i.length;o++)if(a["$[]"](o)["$!"]())if(r[n]=o,n<t-1)a[o]=!0,l.call(i,t,r,n+1,a,s),a[o]=!1;else{$=[];for(var c=0;c<r.length;c++)$.push(i[r[c]]);e.yield1(s,$)}},a!==c?(f=i.slice(),l.call(f,t,s,0,o,a)):l.call(i,t,s,0,o,a);return i},we.$$arity=-1),e.def(ot,"$repeated_permutation",Ae=function(t){function r(t,n,a){if(n.length==t){var i=n.slice();return void e.yield1(s,i)}for(var o=0;o<a.length;o++)n.push(a[o]),r(t,n,a),n.pop()}var a,i=Ae.$$p,s=i||c,o=this,l=c;return i&&(Ae.$$p=null),l=u(ct,"Opal")["$coerce_to!"](t,u(ct,"Integer"),"to_int"),s===c?d(o,"enum_for",["repeated_permutation",l],(a=function(){var e=a.$$s||this;return $(n(l,0))?e.$size()["$**"](l):0},a.$$s=o,a.$$arity=0,a)):(r(l,[],o.slice()),o)},Ae.$$arity=1),e.def(ot,"$pop",ke=function(e){var t=this;return $(void 0===e)?$(0===t.length)?c:t.pop():(e=u(ct,"Opal").$coerce_to(e,u(ct,"Integer"),"to_int"),$(e<0)&&t.$raise(u(ct,"ArgumentError"),"negative array size"),$(0===t.length)?[]:$(e>t.length)?t.splice(0,t.length):t.splice(t.length-e,t.length))},ke.$$arity=-1),e.def(ot,"$product",Ee=function(t){var r,n,a=Ee.$$p,i=a||c,s=this;a&&(Ee.$$p=null),a&&(Ee.$$p=null),r=e.slice.call(arguments,0,arguments.length),n=r;var o,l,f,$,p=i!==c?null:[],d=n.length+1,h=new Array(d),_=new Array(d),m=new Array(d),y=1;for(m[0]=s,o=1;o<d;o++)m[o]=u(ct,"Opal").$coerce_to(n[o-1],u(ct,"Array"),"to_ary");for(o=0;o<d;o++){if(0===($=m[o].length))return p||s;y*=$,y>2147483647&&s.$raise(u(ct,"RangeError"),"too big to product"),_[o]=$,h[o]=0}e:for(;;){for(f=[],o=0;o<d;o++)f.push(m[o][h[o]]);for(p?p.push(f):e.yield1(i,f),l=d-1,h[l]++;h[l]===_[l];){if(h[l]=0,--l<0)break e;h[l]++}}return p||s},Ee.$$arity=-1),e.def(ot,"$push",Se=function(t){var r,n,a=this;r=e.slice.call(arguments,0,arguments.length),n=r;for(var i=0,s=n.length;i<s;i++)a.push(n[i]);return a},Se.$$arity=-1),e.alias(ot,"append","push"),e.def(ot,"$rassoc",Ne=function(e){for(var t,r=this,n=0,a=r.length;n<a;n++)if(t=r[n],t.length&&void 0!==t[1]&&t[1]["$=="](e))return t;return c},Ne.$$arity=1),e.def(ot,"$reject",Ce=function(){var e,t=Ce.$$p,r=t||c,n=this;if(t&&(Ce.$$p=null),t&&(Ce.$$p=null),r===c)return d(n,"enum_for",["reject"],(e=function(){return(e.$$s||this).$size()},e.$$s=n,e.$$arity=0,e));for(var a,i=[],s=0,o=n.length;s<o;s++)!1!==(a=r(n[s]))&&a!==c||i.push(n[s]);return i},Ce.$$arity=0),e.def(ot,"$reject!",Ie=function(){var e,t=Ie.$$p,r=t||c,n=this,a=c;return t&&(Ie.$$p=null),t&&(Ie.$$p=null),r===c?d(n,"enum_for",["reject!"],(e=function(){return(e.$$s||this).$size()},e.$$s=n,e.$$arity=0,e)):(a=n.$length(),d(n,"delete_if",[],r.$to_proc()),n.$length()["$=="](a)?c:n)},Ie.$$arity=0),e.def(ot,"$replace",Oe=function(e){var t=this;return e=function(){return $(u(ct,"Array")["$==="](e))?e.$to_a():u(ct,"Opal").$coerce_to(e,u(ct,"Array"),"to_ary").$to_a()}(),t.splice(0,t.length),t.push.apply(t,e),t},Oe.$$arity=1),e.def(ot,"$reverse",Le=function(){return this.slice(0).reverse()},Le.$$arity=0),e.def(ot,"$reverse!",Pe=function(){return this.reverse()},Pe.$$arity=0),e.def(ot,"$reverse_each",Me=function(){var e,t=Me.$$p,r=t||c,n=this;return t&&(Me.$$p=null),t&&(Me.$$p=null),r===c?d(n,"enum_for",["reverse_each"],(e=function(){return(e.$$s||this).$size()},e.$$s=n,e.$$arity=0,e)):(d(n.$reverse(),"each",[],r.$to_proc()),n)},Me.$$arity=0),e.def(ot,"$rindex",Te=function(e){var t=Te.$$p,r=t||c,n=this;t&&(Te.$$p=null),t&&(Te.$$p=null);var a,i;if(null!=e&&r!==c&&n.$warn("warning: given block not used"),null!=e){for(a=n.length-1;a>=0&&!(a>=n.length);a--)if(n[a]["$=="](e))return a}else if(r!==c){for(a=n.length-1;a>=0&&!(a>=n.length);a--)if(!1!==(i=r(n[a]))&&i!==c)return a}else if(null==e)return n.$enum_for("rindex");return c},Te.$$arity=-1),e.def(ot,"$rotate",Be=function(e){var t=this;null==e&&(e=1),e=u(ct,"Opal").$coerce_to(e,u(ct,"Integer"),"to_int");var r,n,a,i;return 1===t.length?t.slice():0===t.length?[]:(r=t.slice(),n=e%r.length,a=r.slice(n),i=r.slice(0,n),a.concat(i))},Be.$$arity=-1),e.def(ot,"$rotate!",je=function(e){var t=this,r=c;return null==e&&(e=1),0===t.length||1===t.length?t:(e=u(ct,"Opal").$coerce_to(e,u(ct,"Integer"),"to_int"),r=t.$rotate(e),t.$replace(r))},je.$$arity=-1),function(t,r,n){var a,i,s=f(t,null,"SampleRandom"),o=[s].concat(n);s.$$prototype.rng=c,e.def(s,"$initialize",a=function(e){return this.rng=e},a.$$arity=1),e.def(s,"$rand",i=function(e){var t=this,r=c;return r=u(o,"Opal").$coerce_to(t.rng.$rand(e),u(o,"Integer"),"to_int"),$(r<0)&&t.$raise(u(o,"RangeError"),"random value must be >= 0"),$(r<e)||t.$raise(u(o,"RangeError"),"random value must be less than Array size"),r},i.$$arity=1)}(ct[0],0,ct),e.def(ot,"$sample",Fe=function(e,t){var r,n=this,a=c,i=c;if($(void 0===e))return n.$at(u(ct,"Kernel").$rand(n.length));if($(void 0===t)?$(a=u(ct,"Opal")["$coerce_to?"](e,u(ct,"Hash"),"to_hash"))?(t=a,e=c):(t=c,e=u(ct,"Opal").$coerce_to(e,u(ct,"Integer"),"to_int")):(e=u(ct,"Opal").$coerce_to(e,u(ct,"Integer"),"to_int"),t=u(ct,"Opal").$coerce_to(t,u(ct,"Hash"),"to_hash")),$($(r=e)?e<0:r)&&n.$raise(u(ct,"ArgumentError"),"count must be greater than 0"),$(t)&&(i=t["$[]"]("random")),i=function(){return $($(r=i)?i["$respond_to?"]("rand"):r)?u(ct,"SampleRandom").$new(i):u(ct,"Kernel")}(),!$(e))return n[i.$rand(n.length)];var s,o,l,f,p,d,h,_;switch(e>n.length&&(e=n.length),e){case 0:return[];case 1:return[n[i.$rand(n.length)]];case 2:return f=i.$rand(n.length),p=i.$rand(n.length),f===p&&(p=0===f?f+1:f-1),[n[f],n[p]];default:if(n.length/e>3){for(s=!1,o=0,l=u(ct,"Array").$new(e),f=1,l[0]=i.$rand(n.length);f<e;){for(d=i.$rand(n.length),p=0;p<f;){for(;d===l[p];){if(++o>100){s=!0;break}d=i.$rand(n.length)}if(s)break;p++}if(s)break;l[f]=d,f++}if(!s){for(f=0;f<e;)l[f]=n[l[f]],f++;return l}}l=n.slice();for(var m=0;m<e;m++)h=i.$rand(n.length),_=l[m],l[m]=l[h],l[h]=_;return e===n.length?l:l["$[]"](0,e)}},Fe.$$arity=-1),e.def(ot,"$select",Re=function(){var t,r=Re.$$p,n=r||c,a=this;if(r&&(Re.$$p=null),r&&(Re.$$p=null),n===c)return d(a,"enum_for",["select"],(t=function(){return(t.$$s||this).$size()},t.$$s=a,t.$$arity=0,t));for(var i,s,o=[],l=0,u=a.length;l<u;l++)i=a[l],s=e.yield1(n,i),e.truthy(s)&&o.push(i);return o},Re.$$arity=0),e.def(ot,"$select!",De=function(){var e,t=De.$$p,r=t||c,n=this;if(t&&(De.$$p=null),t&&(De.$$p=null),r===c)return d(n,"enum_for",["select!"],(e=function(){return(e.$$s||this).$size()},e.$$s=n,e.$$arity=0,e));var a=n.length;return d(n,"keep_if",[],r.$to_proc()),n.length===a?c:n},De.$$arity=0),e.def(ot,"$shift",ze=function(e){var t=this;return $(void 0===e)?$(0===t.length)?c:t.shift():(e=u(ct,"Opal").$coerce_to(e,u(ct,"Integer"),"to_int"),$(e<0)&&t.$raise(u(ct,"ArgumentError"),"negative array size"),$(0===t.length)?[]:t.splice(0,e))},ze.$$arity=-1),e.alias(ot,"size","length"),e.def(ot,"$shuffle",qe=function(e){return this.$dup().$to_a()["$shuffle!"](e)},qe.$$arity=-1),e.def(ot,"$shuffle!",Ue=function(e){var t,r,n,a=this,i=a.length;for(void 0!==e&&(e=u(ct,"Opal")["$coerce_to?"](e,u(ct,"Hash"),"to_hash"))!==c&&(e=e["$[]"]("random"))!==c&&e["$respond_to?"]("rand")&&(t=e);i;)t?(r=t.$rand(i).$to_int(),r<0&&a.$raise(u(ct,"RangeError"),"random number too small "+r),r>=i&&a.$raise(u(ct,"RangeError"),"random number too big "+r)):r=a.$rand(i),n=a[--i],a[i]=a[r],a[r]=n;return a},Ue.$$arity=-1),e.alias(ot,"slice","[]"),e.def(ot,"$slice!",He=function(e,t){var r=this,n=c,a=c,i=c,s=c,o=c;if(n=c,$(void 0===t))if($(u(ct,"Range")["$==="](e))){a=e,n=r["$[]"](a),i=u(ct,"Opal").$coerce_to(a.$begin(),u(ct,"Integer"),"to_int"),s=u(ct,"Opal").$coerce_to(a.$end(),u(ct,"Integer"),"to_int"),i<0&&(i+=r.length),s<0?s+=r.length:s>=r.length&&(s=r.length-1,a.excl&&(s+=1));var l=s-i;a.excl?s-=1:l+=1,i<r.length&&i>=0&&s<r.length&&s>=0&&l>0&&r.splice(i,l)}else{if(o=u(ct,"Opal").$coerce_to(e,u(ct,"Integer"),"to_int"),o<0&&(o+=r.length),o<0||o>=r.length)return c;n=r[o],0===o?r.shift():r.splice(o,1)}else{if(o=u(ct,"Opal").$coerce_to(e,u(ct,"Integer"),"to_int"),(t=u(ct,"Opal").$coerce_to(t,u(ct,"Integer"),"to_int"))<0)return c;n=r["$[]"](o,t),o<0&&(o+=r.length),o+t>r.length&&(t=r.length-o),o<r.length&&o>=0&&r.splice(o,t)}return n},He.$$arity=-2),e.def(ot,"$sort",Ge=function(){var e=Ge.$$p,r=e||c,n=this;return e&&(Ge.$$p=null),e&&(Ge.$$p=null),$(n.length>1)?(r===c&&(r=function(e,t){return e["$<=>"](t)}),n.slice().sort(function(e,i){var s=r(e,i);return s===c&&n.$raise(u(ct,"ArgumentError"),"comparison of "+e.$inspect()+" with "+i.$inspect()+" failed"),t(s,0)?1:a(s,0)?-1:0})):n},Ge.$$arity=0),e.def(ot,"$sort!",Ye=function(){var e=Ye.$$p,t=e||c,r=this;e&&(Ye.$$p=null),e&&(Ye.$$p=null);var n;n=t!==c?d(r.slice(),"sort",[],t.$to_proc()):r.slice().$sort(),r.length=0;for(var a=0,i=n.length;a<i;a++)r.push(n[a]);return r},Ye.$$arity=0),e.def(ot,"$sort_by!",Ve=function(){var e,t=Ve.$$p,r=t||c,n=this;return t&&(Ve.$$p=null),t&&(Ve.$$p=null),r===c?d(n,"enum_for",["sort_by!"],(e=function(){return(e.$$s||this).$size()},e.$$s=n,e.$$arity=0,e)):n.$replace(d(n,"sort_by",[],r.$to_proc()))},Ve.$$arity=0),e.def(ot,"$take",Qe=function(e){var t=this;return e<0&&t.$raise(u(ct,"ArgumentError")),t.slice(0,e)},Qe.$$arity=1),e.def(ot,"$take_while",Xe=function(){var e=Xe.$$p,t=e||c,r=this;e&&(Xe.$$p=null),e&&(Xe.$$p=null);for(var n,a,i=[],s=0,o=r.length;s<o;s++){if(n=r[s],!1===(a=t(n))||a===c)return i;i.push(n)}return i},Xe.$$arity=0),e.def(ot,"$to_a",We=function(){return this},We.$$arity=0),e.alias(ot,"to_ary","to_a"),e.def(ot,"$to_h",Je=function(){var t,r,n,a,i=this,s=i.length,o=p([],{});for(t=0;t<s;t++)r=u(ct,"Opal")["$coerce_to?"](i[t],u(ct,"Array"),"to_ary"),r.$$is_array||i.$raise(u(ct,"TypeError"),"wrong element type "+r.$class()+" at "+t+" (expected array)"),2!==r.length&&i.$raise(u(ct,"ArgumentError"),"wrong array length at "+t+" (expected 2, was "+r.$length()+")"),n=r[0],a=r[1],e.hash_put(o,n,a);return o},Je.$$arity=0),e.alias(ot,"to_s","inspect"),e.def(ot,"$transpose",Ke=function(){var t,r=this,n=c,a=c;return $(r["$empty?"]())?[]:(n=[],a=c,d(r,"each",[],(t=function(r){var s,o,l=t.$$s||this;return null==r&&(r=c),r=function(){return $(u(ct,"Array")["$==="](r))?r.$to_a():u(ct,"Opal").$coerce_to(r,u(ct,"Array"),"to_ary").$to_a()}(),a=$(s=a)?s:r.length,$(r.length["$!="](a))&&l.$raise(u(ct,"IndexError"),"element size differs ("+r.length+" should be "+a+")"),d(r.length,"times",[],(o=function(t){var a,s=(o.$$s,c),l=c;return null==t&&(t=c),s=$(a=n["$[]"](t))?a:(l=[t,[]],d(n,"[]=",e.to_a(l)),l[i(l.length,1)]),s["$<<"](r.$at(t))},o.$$s=l,o.$$arity=1,o))},t.$$s=r,t.$$arity=1,t)),n)},Ke.$$arity=0),e.def(ot,"$uniq",Ze=function(){var t=Ze.$$p,r=t||c,n=this;t&&(Ze.$$p=null),t&&(Ze.$$p=null);var a,i,s,o,l=p([],{});if(r===c)for(a=0,i=n.length;a<i;a++)s=n[a],void 0===e.hash_get(l,s)&&e.hash_put(l,s,s);else for(a=0,i=n.length;a<i;a++)s=n[a],o=e.yield1(r,s),void 0===e.hash_get(l,o)&&e.hash_put(l,o,s);return m(l.$values(),n.$class())},Ze.$$arity=0),e.def(ot,"$uniq!",et=function(){var t=et.$$p,r=t||c,n=this;t&&(et.$$p=null),t&&(et.$$p=null);var a,i,s,o,l=n.length,u=p([],{});for(a=0,i=l;a<i;a++)s=n[a],o=r===c?s:e.yield1(r,s),void 0!==e.hash_get(u,o)?(n.splice(a,1),i--,a--):e.hash_put(u,o,s);return n.length===l?c:n},et.$$arity=0),e.def(ot,"$unshift",tt=function(t){var r,n,a=this;r=e.slice.call(arguments,0,arguments.length),n=r;for(var i=n.length-1;i>=0;i--)a.unshift(n[i]);return a},tt.$$arity=-1),e.alias(ot,"prepend","unshift"),e.def(ot,"$values_at",rt=function(t){var r,n,a,i=this,s=c;return r=e.slice.call(arguments,0,arguments.length),n=r,s=[],d(n,"each",[],(a=function(e){var t,r=a.$$s||this,n=c,i=c,o=c;return null==e&&(e=c),$(e["$is_a?"](u(ct,"Range")))?(n=u(ct,"Opal").$coerce_to(e.$last(),u(ct,"Integer"),"to_int"),(i=u(ct,"Opal").$coerce_to(e.$first(),u(ct,"Integer"),"to_int"))<0?(i+=r.length,c):(n<0&&(n+=r.length),e["$exclude_end?"]()&&n--,n<i?c:d(i,"upto",[n],(t=function(e){var r=t.$$s||this;return null==e&&(e=c),s["$<<"](r.$at(e))},t.$$s=r,t.$$arity=1,t)))):(o=u(ct,"Opal").$coerce_to(e,u(ct,"Integer"),"to_int"),s["$<<"](r.$at(o)))},a.$$s=i,a.$$arity=1,a)),s},rt.$$arity=-1),e.def(ot,"$zip",nt=function(t){var r,n,a,i=nt.$$p,s=i||c,o=this;i&&(nt.$$p=null),i&&(nt.$$p=null),r=e.slice.call(arguments,0,arguments.length),n=r;var l,f,p,d,h,_=[],m=o.length;for(d=0,h=n.length;d<h;d++)f=n[d],f.$$is_array||(f.$$is_enumerator?f.$size()===1/0?n[d]=f.$take(m):n[d]=f.$to_a():n[d]=($(a=u(ct,"Opal")["$coerce_to?"](f,u(ct,"Array"),"to_ary"))?a:u(ct,"Opal")["$coerce_to!"](f,u(ct,"Enumerator"),"each")).$to_a());for(p=0;p<m;p++){for(l=[o[p]],d=0,h=n.length;d<h;d++)f=n[d][p],null==f&&(f=c),l[d+1]=f;_[p]=l}if(s!==c){for(p=0;p<m;p++)s(_[p]);return c}return _},nt.$$arity=-1),e.defs(ot,"$inherited",at=function(e){e.$$prototype.$to_a=function(){return this.slice(0,this.length)}},at.$$arity=1),e.def(ot,"$instance_variables",it=function(){var t,r=it.$$p,n=this,a=c,i=c,s=c;for(r&&(it.$$p=null),i=0,s=arguments.length,a=new Array(s);i<s;i++)a[i]=arguments[i];return d(d(n,e.find_super_dispatcher(n,"instance_variables",it,!1),a,r),"reject",[],(t=function(e){var r;t.$$s;return null==e&&(e=c),$(r=/^@\d+$/.test(e))?r:e["$=="]("@length")},t.$$s=n,t.$$arity=1,t))},it.$$arity=0),u(ct,"Opal").$pristine(ot.$singleton_class(),"allocate"),u(ct,"Opal").$pristine(ot,"copy_instance_variables","initialize_dup"),e.def(ot,"$pack",st=function(t){var r,n=this;return r=e.slice.call(arguments,0,arguments.length),r,n.$raise("To use Array#pack, you must first require 'corelib/array/pack'.")},st.$$arity=-1),c&&"pack"}(o[0],Array,o)},Opal.modules["corelib/hash"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e>=t:e["$>="](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}var a=e.top,i=[],s=e.nil,o=(e.const_get_qualified,e.const_get_relative),c=(e.breaker,e.slice,e.klass),l=e.send,u=e.hash2,f=e.truthy;return e.add_stubs(["$require","$include","$coerce_to?","$[]","$merge!","$allocate","$raise","$coerce_to!","$each","$fetch","$>=","$>","$==","$compare_by_identity","$lambda?","$abs","$arity","$enum_for","$size","$respond_to?","$class","$dig","$new","$inspect","$map","$to_proc","$flatten","$eql?","$default","$dup","$default_proc","$default_proc=","$-","$default=","$proc"]),a.$require("corelib/enumerable"),function(a,i,$){var p,d,h,_,m,y,g,v,b,x,w,A,k,E,S,N,C,I,O,L,P,M,T,B,j,F,R,D,z,q,U,H,G,Y,V,Q,X,W,J,K,Z,ee,te,re,ne,ae,ie,se,oe,ce,le,ue,fe,$e,pe,de,he,_e,me,ye,ge,ve,be=c(a,null,"Hash"),xe=[be].concat($);be.$include(o(xe,"Enumerable")),be.$$prototype.$$is_hash=!0,e.defs(be,"$[]",p=function(t){var r,n,a=this;r=e.slice.call(arguments,0,arguments.length),n=r;var i,c,l=n.length;if(1===l){if((i=o(xe,"Opal")["$coerce_to?"](n["$[]"](0),o(xe,"Hash"),"to_hash"))!==s)return a.$allocate()["$merge!"](i);for(n=o(xe,"Opal")["$coerce_to?"](n["$[]"](0),o(xe,"Array"),"to_ary"),n===s&&a.$raise(o(xe,"ArgumentError"),"odd number of arguments for Hash"),l=n.length,i=a.$allocate(),c=0;c<l;c++)if(n[c].$$is_array)switch(n[c].length){case 1:i.$store(n[c][0],s);break;case 2:i.$store(n[c][0],n[c][1]);break;default:a.$raise(o(xe,"ArgumentError"),"invalid number of elements ("+n[c].length+" for 1..2)")}return i}for(l%2!=0&&a.$raise(o(xe,"ArgumentError"),"odd number of arguments for Hash"),i=a.$allocate(),c=0;c<l;c+=2)i.$store(n[c],n[c+1]);return i},p.$$arity=-1),e.defs(be,"$allocate",d=function(){var t=this,r=new t.$$constructor;return e.hash_init(r),r.$$none=s,r.$$proc=s,r},d.$$arity=0),e.defs(be,"$try_convert",h=function(e){return o(xe,"Opal")["$coerce_to?"](e,o(xe,"Hash"),"to_hash")},h.$$arity=1),e.def(be,"$initialize",_=function(e){
var t=_.$$p,r=t||s,n=this;return t&&(_.$$p=null),t&&(_.$$p=null),void 0!==e&&r!==s&&n.$raise(o(xe,"ArgumentError"),"wrong number of arguments (1 for 0)"),n.$$none=void 0===e?s:e,n.$$proc=r,n},_.$$arity=-1),e.def(be,"$==",m=function(t){var r=this;if(r===t)return!0;if(!t.$$is_hash)return!1;if(r.$$keys.length!==t.$$keys.length)return!1;for(var n,a,i,s=0,o=r.$$keys,c=o.length;s<c;s++)if(n=o[s],n.$$is_string?(a=r.$$smap[n],i=t.$$smap[n]):(a=n.value,i=e.hash_get(t,n.key)),void 0===i||!a["$eql?"](i))return!1;return!0},m.$$arity=1),e.def(be,"$>=",y=function(e){var t,r=this,n=s;return e=o(xe,"Opal")["$coerce_to!"](e,o(xe,"Hash"),"to_hash"),!(r.$$keys.length<e.$$keys.length)&&(n=!0,l(e,"each",[],(t=function(e,r){var a=t.$$s||this,i=s;if(null==e&&(e=s),null==r&&(r=s),null==(i=a.$fetch(e,null))||i!==r)return void(n=!1)},t.$$s=r,t.$$arity=2,t)),n)},y.$$arity=1),e.def(be,"$>",g=function(e){var r=this;return e=o(xe,"Opal")["$coerce_to!"](e,o(xe,"Hash"),"to_hash"),!(r.$$keys.length<=e.$$keys.length)&&t(r,e)},g.$$arity=1),e.def(be,"$<",v=function(e){var t=this;return e=o(xe,"Opal")["$coerce_to!"](e,o(xe,"Hash"),"to_hash"),r(e,t)},v.$$arity=1),e.def(be,"$<=",b=function(e){var r=this;return e=o(xe,"Opal")["$coerce_to!"](e,o(xe,"Hash"),"to_hash"),t(e,r)},b.$$arity=1),e.def(be,"$[]",x=function(t){var r=this,n=e.hash_get(r,t);return void 0!==n?n:r.$default(t)},x.$$arity=1),e.def(be,"$[]=",w=function(t,r){var n=this;return e.hash_put(n,t,r),r},w.$$arity=2),e.def(be,"$assoc",A=function(e){for(var t,r=this,n=0,a=r.$$keys,i=a.length;n<i;n++)if(t=a[n],t.$$is_string){if(t["$=="](e))return[t,r.$$smap[t]]}else if(t.key["$=="](e))return[t.key,t.value];return s},A.$$arity=1),e.def(be,"$clear",k=function(){var t=this;return e.hash_init(t),t},k.$$arity=0),e.def(be,"$clone",E=function(){var t=this,r=new t.$$class;return e.hash_init(r),e.hash_clone(t,r),r},E.$$arity=0),e.def(be,"$compact",S=function(){for(var t,r,n=this,a=e.hash(),i=0,o=n.$$keys,c=o.length;i<c;i++)t=o[i],t.$$is_string?r=n.$$smap[t]:(r=t.value,t=t.key),r!==s&&e.hash_put(a,t,r);return a},S.$$arity=0),e.def(be,"$compact!",N=function(){for(var t,r,n=this,a=!1,i=0,o=n.$$keys,c=o.length;i<c;i++)t=o[i],t.$$is_string?r=n.$$smap[t]:(r=t.value,t=t.key),r===s&&void 0!==e.hash_delete(n,t)&&(a=!0,c--,i--);return a?n:s},N.$$arity=0),e.def(be,"$compare_by_identity",C=function(){var t,r,n,a,i=this,s=i.$$keys;if(i.$$by_identity)return i;if(0===i.$$keys.length)return i.$$by_identity=!0,i;for(a=u([],{}).$compare_by_identity(),t=0,r=s.length;t<r;t++)n=s[t],n.$$is_string||(n=n.key),e.hash_put(a,n,e.hash_get(i,n));return i.$$by_identity=!0,i.$$map=a.$$map,i.$$smap=a.$$smap,i},C.$$arity=0),e.def(be,"$compare_by_identity?",I=function(){return!0===this.$$by_identity},I.$$arity=0),e.def(be,"$default",O=function(e){var t=this;return void 0!==e&&t.$$proc!==s&&void 0!==t.$$proc?t.$$proc.$call(t,e):void 0===t.$$none?s:t.$$none},O.$$arity=-1),e.def(be,"$default=",L=function(e){var t=this;return t.$$proc=s,t.$$none=e,e},L.$$arity=1),e.def(be,"$default_proc",P=function(){var e=this;return void 0!==e.$$proc?e.$$proc:s},P.$$arity=0),e.def(be,"$default_proc=",M=function(e){var t=this,r=e;return r!==s&&(r=o(xe,"Opal")["$coerce_to!"](r,o(xe,"Proc"),"to_proc"),r["$lambda?"]()&&2!==r.$arity().$abs()&&t.$raise(o(xe,"TypeError"),"default_proc takes two arguments")),t.$$none=s,t.$$proc=r,e},M.$$arity=1),e.def(be,"$delete",T=function(t){var r=T.$$p,n=r||s,a=this;r&&(T.$$p=null),r&&(T.$$p=null);var i=e.hash_delete(a,t);return void 0!==i?i:n!==s?e.yield1(n,t):s},T.$$arity=1),e.def(be,"$delete_if",B=function(){var t,r=B.$$p,n=r||s,a=this;if(r&&(B.$$p=null),r&&(B.$$p=null),!f(n))return l(a,"enum_for",["delete_if"],(t=function(){return(t.$$s||this).$size()},t.$$s=a,t.$$arity=0,t));for(var i,o,c,u=0,$=a.$$keys,p=$.length;u<p;u++)i=$[u],i.$$is_string?o=a.$$smap[i]:(o=i.value,i=i.key),!1!==(c=n(i,o))&&c!==s&&void 0!==e.hash_delete(a,i)&&(p--,u--);return a},B.$$arity=0),e.alias(be,"dup","clone"),e.def(be,"$dig",j=function(t,r){var n,a,i=this,c=s;return n=e.slice.call(arguments,1,arguments.length),a=n,(c=i["$[]"](t))===s||0===a.length?c:(f(c["$respond_to?"]("dig"))||i.$raise(o(xe,"TypeError"),c.$class()+" does not have #dig method"),l(c,"dig",e.to_a(a)))},j.$$arity=-2),e.def(be,"$each",F=function(){var t,r=F.$$p,n=r||s,a=this;if(r&&(F.$$p=null),r&&(F.$$p=null),!f(n))return l(a,"enum_for",["each"],(t=function(){return(t.$$s||this).$size()},t.$$s=a,t.$$arity=0,t));for(var i,o,c=0,u=a.$$keys,$=u.length;c<$;c++)i=u[c],i.$$is_string?o=a.$$smap[i]:(o=i.value,i=i.key),e.yield1(n,[i,o]);return a},F.$$arity=0),e.def(be,"$each_key",R=function(){var e,t=R.$$p,r=t||s,n=this;if(t&&(R.$$p=null),t&&(R.$$p=null),!f(r))return l(n,"enum_for",["each_key"],(e=function(){return(e.$$s||this).$size()},e.$$s=n,e.$$arity=0,e));for(var a,i=0,o=n.$$keys,c=o.length;i<c;i++)a=o[i],r(a.$$is_string?a:a.key);return n},R.$$arity=0),e.alias(be,"each_pair","each"),e.def(be,"$each_value",D=function(){var e,t=D.$$p,r=t||s,n=this;if(t&&(D.$$p=null),t&&(D.$$p=null),!f(r))return l(n,"enum_for",["each_value"],(e=function(){return(e.$$s||this).$size()},e.$$s=n,e.$$arity=0,e));for(var a,i=0,o=n.$$keys,c=o.length;i<c;i++)a=o[i],r(a.$$is_string?n.$$smap[a]:a.value);return n},D.$$arity=0),e.def(be,"$empty?",z=function(){return 0===this.$$keys.length},z.$$arity=0),e.alias(be,"eql?","=="),e.def(be,"$fetch",q=function(t,r){var n=q.$$p,a=n||s,i=this;n&&(q.$$p=null),n&&(q.$$p=null);var c=e.hash_get(i,t);return void 0!==c?c:a!==s?a(t):void 0!==r?r:i.$raise(o(xe,"KeyError").$new("key not found: "+t.$inspect(),u(["key","receiver"],{key:t,receiver:i})))},q.$$arity=-2),e.def(be,"$fetch_values",U=function(t){var r,n,a,i=U.$$p,o=i||s,c=this;return i&&(U.$$p=null),i&&(U.$$p=null),r=e.slice.call(arguments,0,arguments.length),n=r,l(n,"map",[],(a=function(e){var t=a.$$s||this;return null==e&&(e=s),l(t,"fetch",[e],o.$to_proc())},a.$$s=c,a.$$arity=1,a))},U.$$arity=-1),e.def(be,"$flatten",H=function(e){var t=this;null==e&&(e=1),e=o(xe,"Opal")["$coerce_to!"](e,o(xe,"Integer"),"to_int");for(var r,n,a=[],i=0,s=t.$$keys,c=s.length;i<c;i++)if(r=s[i],r.$$is_string?n=t.$$smap[r]:(n=r.value,r=r.key),a.push(r),n.$$is_array){if(1===e){a.push(n);continue}a=a.concat(n.$flatten(e-2))}else a.push(n);return a},H.$$arity=-1),e.def(be,"$has_key?",G=function(t){var r=this;return void 0!==e.hash_get(r,t)},G.$$arity=1),e.def(be,"$has_value?",Y=function(e){for(var t,r=this,n=0,a=r.$$keys,i=a.length;n<i;n++)if(t=a[n],(t.$$is_string?r.$$smap[t]:t.value)["$=="](e))return!0;return!1},Y.$$arity=1),e.def(be,"$hash",V=function(){var t,r,n=this,a=void 0===e.hash_ids,i=n.$object_id(),s=["Hash"];try{if(a&&(e.hash_ids=Object.create(null)),e[i])return"self";for(t in e.hash_ids)if(r=e.hash_ids[t],n["$eql?"](r))return"self";e.hash_ids[i]=n;for(var o=0,c=n.$$keys,l=c.length;o<l;o++)t=c[o],t.$$is_string?s.push([t,n.$$smap[t].$hash()]):s.push([t.key_hash,t.value.$hash()]);return s.sort().join()}finally{a&&(e.hash_ids=void 0)}},V.$$arity=0),e.alias(be,"include?","has_key?"),e.def(be,"$index",Q=function(e){for(var t,r,n=this,a=0,i=n.$$keys,o=i.length;a<o;a++)if(t=i[a],t.$$is_string?r=n.$$smap[t]:(r=t.value,t=t.key),r["$=="](e))return t;return s},Q.$$arity=1),e.def(be,"$indexes",X=function(t){var r,n,a=this;r=e.slice.call(arguments,0,arguments.length),n=r;for(var i,s,o=[],c=0,l=n.length;c<l;c++)i=n[c],s=e.hash_get(a,i),void 0!==s?o.push(s):o.push(a.$default());return o},X.$$arity=-1),e.alias(be,"indices","indexes");var we;return e.def(be,"$inspect",W=function(){var e=this,t=void 0===we,r=e.$object_id(),n=[];try{if(t&&(we={}),we.hasOwnProperty(r))return"{...}";we[r]=!0;for(var a,i,s=0,o=e.$$keys,c=o.length;s<c;s++)a=o[s],a.$$is_string?i=e.$$smap[a]:(i=a.value,a=a.key),n.push(a.$inspect()+"=>"+i.$inspect());return"{"+n.join(", ")+"}"}finally{t&&(we=void 0)}},W.$$arity=0),e.def(be,"$invert",J=function(){for(var t,r,n=this,a=e.hash(),i=0,s=n.$$keys,o=s.length;i<o;i++)t=s[i],t.$$is_string?r=n.$$smap[t]:(r=t.value,t=t.key),e.hash_put(a,r,t);return a},J.$$arity=0),e.def(be,"$keep_if",K=function(){var t,r=K.$$p,n=r||s,a=this;if(r&&(K.$$p=null),r&&(K.$$p=null),!f(n))return l(a,"enum_for",["keep_if"],(t=function(){return(t.$$s||this).$size()},t.$$s=a,t.$$arity=0,t));for(var i,o,c,u=0,$=a.$$keys,p=$.length;u<p;u++)i=$[u],i.$$is_string?o=a.$$smap[i]:(o=i.value,i=i.key),!1!==(c=n(i,o))&&c!==s||void 0!==e.hash_delete(a,i)&&(p--,u--);return a},K.$$arity=0),e.alias(be,"key","index"),e.alias(be,"key?","has_key?"),e.def(be,"$keys",Z=function(){for(var e,t=this,r=[],n=0,a=t.$$keys,i=a.length;n<i;n++)e=a[n],e.$$is_string?r.push(e):r.push(e.key);return r},Z.$$arity=0),e.def(be,"$length",ee=function(){return this.$$keys.length},ee.$$arity=0),e.alias(be,"member?","has_key?"),e.def(be,"$merge",te=function(e){var t=te.$$p,r=t||s,n=this;return t&&(te.$$p=null),t&&(te.$$p=null),l(n.$dup(),"merge!",[e],r.$to_proc())},te.$$arity=1),e.def(be,"$merge!",re=function(t){var r=re.$$p,n=r||s,a=this;r&&(re.$$p=null),r&&(re.$$p=null),t.$$is_hash||(t=o(xe,"Opal")["$coerce_to!"](t,o(xe,"Hash"),"to_hash"));var i,c,l,u,f=t.$$keys,$=f.length;if(n===s){for(i=0;i<$;i++)c=f[i],c.$$is_string?u=t.$$smap[c]:(u=c.value,c=c.key),e.hash_put(a,c,u);return a}for(i=0;i<$;i++)c=f[i],c.$$is_string?u=t.$$smap[c]:(u=c.value,c=c.key),l=e.hash_get(a,c),void 0!==l?e.hash_put(a,c,n(c,l,u)):e.hash_put(a,c,u);return a},re.$$arity=1),e.def(be,"$rassoc",ne=function(e){for(var t,r,n=this,a=0,i=n.$$keys,o=i.length;a<o;a++)if(t=i[a],t.$$is_string?r=n.$$smap[t]:(r=t.value,t=t.key),r["$=="](e))return[t,r];return s},ne.$$arity=1),e.def(be,"$rehash",ae=function(){var t=this;return e.hash_rehash(t),t},ae.$$arity=0),e.def(be,"$reject",ie=function(){var t,r=ie.$$p,n=r||s,a=this;if(r&&(ie.$$p=null),r&&(ie.$$p=null),!f(n))return l(a,"enum_for",["reject"],(t=function(){return(t.$$s||this).$size()},t.$$s=a,t.$$arity=0,t));for(var i,o,c,u=e.hash(),$=0,p=a.$$keys,d=p.length;$<d;$++)i=p[$],i.$$is_string?o=a.$$smap[i]:(o=i.value,i=i.key),!1!==(c=n(i,o))&&c!==s||e.hash_put(u,i,o);return u},ie.$$arity=0),e.def(be,"$reject!",se=function(){var t,r=se.$$p,n=r||s,a=this;if(r&&(se.$$p=null),r&&(se.$$p=null),!f(n))return l(a,"enum_for",["reject!"],(t=function(){return(t.$$s||this).$size()},t.$$s=a,t.$$arity=0,t));for(var i,o,c,u=!1,$=0,p=a.$$keys,d=p.length;$<d;$++)i=p[$],i.$$is_string?o=a.$$smap[i]:(o=i.value,i=i.key),!1!==(c=n(i,o))&&c!==s&&void 0!==e.hash_delete(a,i)&&(u=!0,d--,$--);return u?a:s},se.$$arity=0),e.def(be,"$replace",oe=function(t){var r=this,a=s;t=o(xe,"Opal")["$coerce_to!"](t,o(xe,"Hash"),"to_hash"),e.hash_init(r);for(var i,c,u=0,$=t.$$keys,p=$.length;u<p;u++)i=$[u],i.$$is_string?c=t.$$smap[i]:(c=i.value,i=i.key),e.hash_put(r,i,c);return f(t.$default_proc())?(a=[t.$default_proc()],l(r,"default_proc=",e.to_a(a)),a[n(a.length,1)]):(a=[t.$default()],l(r,"default=",e.to_a(a)),a[n(a.length,1)]),r},oe.$$arity=1),e.def(be,"$select",ce=function(){var t,r=ce.$$p,n=r||s,a=this;if(r&&(ce.$$p=null),r&&(ce.$$p=null),!f(n))return l(a,"enum_for",["select"],(t=function(){return(t.$$s||this).$size()},t.$$s=a,t.$$arity=0,t));for(var i,o,c,u=e.hash(),$=0,p=a.$$keys,d=p.length;$<d;$++)i=p[$],i.$$is_string?o=a.$$smap[i]:(o=i.value,i=i.key),!1!==(c=n(i,o))&&c!==s&&e.hash_put(u,i,o);return u},ce.$$arity=0),e.def(be,"$select!",le=function(){var t,r=le.$$p,n=r||s,a=this;if(r&&(le.$$p=null),r&&(le.$$p=null),!f(n))return l(a,"enum_for",["select!"],(t=function(){return(t.$$s||this).$size()},t.$$s=a,t.$$arity=0,t));for(var i,o,c,u=s,$=0,p=a.$$keys,d=p.length;$<d;$++)i=p[$],i.$$is_string?o=a.$$smap[i]:(o=i.value,i=i.key),!1!==(c=n(i,o))&&c!==s||(void 0!==e.hash_delete(a,i)&&(d--,$--),u=a);return u},le.$$arity=0),e.def(be,"$shift",ue=function(){var t,r=this,n=r.$$keys;return n.length>0?(t=n[0],t=t.$$is_string?t:t.key,[t,e.hash_delete(r,t)]):r.$default(s)},ue.$$arity=0),e.alias(be,"size","length"),e.def(be,"$slice",fe=function(t){var r,n,a=this;r=e.slice.call(arguments,0,arguments.length),n=r;for(var i=e.hash(),s=0,o=n.length;s<o;s++){var c=n[s],l=e.hash_get(a,c);void 0!==l&&e.hash_put(i,c,l)}return i},fe.$$arity=-1),e.alias(be,"store","[]="),e.def(be,"$to_a",$e=function(){for(var e,t,r=this,n=[],a=0,i=r.$$keys,s=i.length;a<s;a++)e=i[a],e.$$is_string?t=r.$$smap[e]:(t=e.value,e=e.key),n.push([e,t]);return n},$e.$$arity=0),e.def(be,"$to_h",pe=function(){var t=this;if(t.$$class===e.Hash)return t;var r=new e.Hash;return e.hash_init(r),e.hash_clone(t,r),r},pe.$$arity=0),e.def(be,"$to_hash",de=function(){return this},de.$$arity=0),e.def(be,"$to_proc",he=function(){var e,t=this;return l(t,"proc",[],(e=function(t){var r=e.$$s||this;return null==t&&r.$raise(o(xe,"ArgumentError"),"no key given"),r["$[]"](t)},e.$$s=t,e.$$arity=-1,e))},he.$$arity=0),e.alias(be,"to_s","inspect"),e.def(be,"$transform_keys",_e=function(){var t,r=_e.$$p,n=r||s,a=this;if(r&&(_e.$$p=null),r&&(_e.$$p=null),!f(n))return l(a,"enum_for",["transform_keys"],(t=function(){return(t.$$s||this).$size()},t.$$s=a,t.$$arity=0,t));for(var i,o,c=e.hash(),u=0,$=a.$$keys,p=$.length;u<p;u++)i=$[u],i.$$is_string?o=a.$$smap[i]:(o=i.value,i=i.key),i=e.yield1(n,i),e.hash_put(c,i,o);return c},_e.$$arity=0),e.def(be,"$transform_keys!",me=function(){var t,r=me.$$p,n=r||s,a=this;if(r&&(me.$$p=null),r&&(me.$$p=null),!f(n))return l(a,"enum_for",["transform_keys!"],(t=function(){return(t.$$s||this).$size()},t.$$s=a,t.$$arity=0,t));var i,o,c,u,$=e.slice.call(a.$$keys),p=$.length;for(i=0;i<p;i++)o=$[i],o.$$is_string?c=a.$$smap[o]:(c=o.value,o=o.key),u=e.yield1(n,o),e.hash_delete(a,o),e.hash_put(a,u,c);return a},me.$$arity=0),e.def(be,"$transform_values",ye=function(){var t,r=ye.$$p,n=r||s,a=this;if(r&&(ye.$$p=null),r&&(ye.$$p=null),!f(n))return l(a,"enum_for",["transform_values"],(t=function(){return(t.$$s||this).$size()},t.$$s=a,t.$$arity=0,t));for(var i,o,c=e.hash(),u=0,$=a.$$keys,p=$.length;u<p;u++)i=$[u],i.$$is_string?o=a.$$smap[i]:(o=i.value,i=i.key),o=e.yield1(n,o),e.hash_put(c,i,o);return c},ye.$$arity=0),e.def(be,"$transform_values!",ge=function(){var t,r=ge.$$p,n=r||s,a=this;if(r&&(ge.$$p=null),r&&(ge.$$p=null),!f(n))return l(a,"enum_for",["transform_values!"],(t=function(){return(t.$$s||this).$size()},t.$$s=a,t.$$arity=0,t));for(var i,o,c=0,u=a.$$keys,$=u.length;c<$;c++)i=u[c],i.$$is_string?o=a.$$smap[i]:(o=i.value,i=i.key),o=e.yield1(n,o),e.hash_put(a,i,o);return a},ge.$$arity=0),e.alias(be,"update","merge!"),e.alias(be,"value?","has_value?"),e.alias(be,"values_at","indexes"),e.def(be,"$values",ve=function(){for(var e,t=this,r=[],n=0,a=t.$$keys,i=a.length;n<i;n++)e=a[n],e.$$is_string?r.push(t.$$smap[e]):r.push(e.value);return r},ve.$$arity=0),s&&"values"}(i[0],0,i)},Opal.modules["corelib/number"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e<t:e["$<"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}function a(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function i(e,t){return"number"==typeof e&&"number"==typeof t?e/t:e["$/"](t)}function s(e,t){return"number"==typeof e&&"number"==typeof t?e*t:e["$*"](t)}function o(e,t){return"number"==typeof e&&"number"==typeof t?e<=t:e["$<="](t)}function c(e,t){return"number"==typeof e&&"number"==typeof t?e>=t:e["$>="](t)}var l=e.top,u=[],f=e.nil,$=e.const_get_qualified,p=e.const_get_relative,d=(e.breaker,e.slice,e.klass),h=e.truthy,_=e.send,m=e.hash2;return e.add_stubs(["$require","$bridge","$raise","$name","$class","$Float","$respond_to?","$coerce_to!","$__coerced__","$===","$!","$>","$**","$new","$<","$to_f","$==","$nan?","$infinite?","$enum_for","$+","$-","$gcd","$lcm","$%","$/","$frexp","$to_i","$ldexp","$rationalize","$*","$<<","$to_r","$truncate","$-@","$size","$<=","$>=","$<=>","$compare","$any?"]),l.$require("corelib/numeric"),function(l,u,y){var g,v,b,x,w,A,k,E,S,N,C,I,O,L,P,M,T,B,j,F,R,D,z,q,U,H,G,Y,V,Q,X,W,J,K,Z,ee,te,re,ne,ae,ie,se,oe,ce,le,ue,fe,$e,pe,de,he,_e,me,ye,ge,ve,be,xe,we,Ae,ke,Ee,Se,Ne,Ce,Ie,Oe,Le,Pe,Me,Te,Be,je=d(l,u,"Number"),Fe=[je].concat(y);p(Fe,"Opal").$bridge(Number,je),e.defineProperty(je.$$prototype,"$$is_number",!0),je.$$is_number_class=!0,function(t,r){var n,a=[t].concat(r);e.def(t,"$allocate",n=function(){var e=this;return e.$raise(p(a,"TypeError"),"allocator undefined for "+e.$name())},n.$$arity=0),e.udef(t,"$new")}(e.get_singleton_class(je),Fe),e.def(je,"$coerce",g=function(e){var t=this;if(e===f)t.$raise(p(Fe,"TypeError"),"can't convert "+e.$class()+" into Float");else{if(e.$$is_string)return[t.$Float(e),t];if(e["$respond_to?"]("to_f"))return[p(Fe,"Opal")["$coerce_to!"](e,p(Fe,"Float"),"to_f"),t];if(e.$$is_number)return[e,t];t.$raise(p(Fe,"TypeError"),"can't convert "+e.$class()+" into Float")}},g.$$arity=1),e.def(je,"$__id__",v=function(){return 2*this+1},v.$$arity=0),e.alias(je,"object_id","__id__"),e.def(je,"$+",b=function(e){var t=this;return e.$$is_number?t+e:t.$__coerced__("+",e)},b.$$arity=1),e.def(je,"$-",x=function(e){var t=this;return e.$$is_number?t-e:t.$__coerced__("-",e)},x.$$arity=1),e.def(je,"$*",w=function(e){var t=this;return e.$$is_number?t*e:t.$__coerced__("*",e)},w.$$arity=1),e.def(je,"$/",A=function(e){var t=this;return e.$$is_number?t/e:t.$__coerced__("/",e)},A.$$arity=1),e.alias(je,"fdiv","/"),e.def(je,"$%",k=function(e){var t=this;return e.$$is_number?e==-1/0?e:0!=e?e<0||t<0?(t%e+e)%e:t%e:void t.$raise(p(Fe,"ZeroDivisionError"),"divided by 0"):t.$__coerced__("%",e)},k.$$arity=1),e.def(je,"$&",E=function(e){var t=this;return e.$$is_number?t&e:t.$__coerced__("&",e)},E.$$arity=1),e.def(je,"$|",S=function(e){var t=this;return e.$$is_number?t|e:t.$__coerced__("|",e)},S.$$arity=1),e.def(je,"$^",N=function(e){var t=this;return e.$$is_number?t^e:t.$__coerced__("^",e)},N.$$arity=1),e.def(je,"$<",C=function(e){var t=this;return e.$$is_number?t<e:t.$__coerced__("<",e)},C.$$arity=1),e.def(je,"$<=",I=function(e){var t=this;return e.$$is_number?t<=e:t.$__coerced__("<=",e)},I.$$arity=1),e.def(je,"$>",O=function(e){var t=this;return e.$$is_number?t>e:t.$__coerced__(">",e)},O.$$arity=1),e.def(je,"$>=",L=function(e){var t=this;return e.$$is_number?t>=e:t.$__coerced__(">=",e)},L.$$arity=1);var Re=function(e,t){return t.$$is_number?isNaN(e)||isNaN(t)?f:e>t?1:e<t?-1:0:e.$__coerced__("<=>",t)};e.def(je,"$<=>",P=function(t){var r=this;try{return Re(r,t)}catch(t){if(!e.rescue(t,[p(Fe,"ArgumentError")]))throw t;try{return f}finally{e.pop_exception()}}},P.$$arity=1),e.def(je,"$<<",M=function(e){var t=this;return e=p(Fe,"Opal")["$coerce_to!"](e,p(Fe,"Integer"),"to_int"),e>0?t<<e:t>>-e},M.$$arity=1),e.def(je,"$>>",T=function(e){var t=this;return e=p(Fe,"Opal")["$coerce_to!"](e,p(Fe,"Integer"),"to_int"),e>0?t>>e:t<<-e},T.$$arity=1),e.def(je,"$[]",B=function(e){var t=this;return e=p(Fe,"Opal")["$coerce_to!"](e,p(Fe,"Integer"),"to_int"),e<0?0:e>=32?t<0?1:0:t>>e&1},B.$$arity=1),e.def(je,"$+@",j=function(){return+this},j.$$arity=0),e.def(je,"$-@",F=function(){return-this},F.$$arity=0),e.def(je,"$~",R=function(){return~this},R.$$arity=0),e.def(je,"$**",D=function(e){var n,a,i=this;return h(p(Fe,"Integer")["$==="](e))?h(h(n=p(Fe,"Integer")["$==="](i)["$!"]())?n:t(e,0))?Math.pow(i,e):p(Fe,"Rational").$new(i,1)["$**"](e):h((n=r(i,0))?h(a=p(Fe,"Float")["$==="](e))?a:p(Fe,"Rational")["$==="](e):r(i,0))?p(Fe,"Complex").$new(i,0)["$**"](e.$to_f()):h(null!=e.$$is_number)?Math.pow(i,e):i.$__coerced__("**",e)},D.$$arity=1),e.def(je,"$===",z=function(e){var t=this;return e.$$is_number?t.valueOf()===e.valueOf():!!e["$respond_to?"]("==")&&e["$=="](t)},z.$$arity=1),e.def(je,"$==",q=function(e){var t=this;return e.$$is_number?t.valueOf()===e.valueOf():!!e["$respond_to?"]("==")&&e["$=="](t)},q.$$arity=1),e.def(je,"$abs",U=function(){var e=this;return Math.abs(e)},U.$$arity=0),e.def(je,"$abs2",H=function(){var e=this;return Math.abs(e*e)},H.$$arity=0),e.def(je,"$allbits?",G=function(e){var t=this;return e=p(Fe,"Opal")["$coerce_to!"](e,p(Fe,"Integer"),"to_int"),(t&e)==e},G.$$arity=1),e.def(je,"$anybits?",Y=function(e){var t=this;return e=p(Fe,"Opal")["$coerce_to!"](e,p(Fe,"Integer"),"to_int"),0!=(t&e)},Y.$$arity=1),e.def(je,"$angle",V=function(){var e=this;return h(e["$nan?"]())?e:0==e?1/e>0?0:Math.PI:e<0?Math.PI:0},V.$$arity=0),e.alias(je,"arg","angle"),e.alias(je,"phase","angle"),e.def(je,"$bit_length",Q=function(){var e=this;if(h(p(Fe,"Integer")["$==="](e))||e.$raise(p(Fe,"NoMethodError").$new("undefined method `bit_length` for "+e+":Float","bit_length")),0===e||-1===e)return 0;for(var t=0,r=e<0?~e:e;0!=r;)t+=1,r>>>=1;return t},Q.$$arity=0),e.def(je,"$ceil",X=function(e){var t=this;null==e&&(e=0);var r=t.$to_f();if(r%1==0&&e>=0)return r;var n=Math.pow(10,e),a=Math.ceil(r*n)/n;return r%1==0&&(a=Math.round(a)),a},X.$$arity=-1),e.def(je,"$chr",W=function(e){var t=this;return String.fromCharCode(t)},W.$$arity=-1),e.def(je,"$denominator",J=function(){var t,r=J.$$p,n=this,a=f,i=f,s=f;for(r&&(J.$$p=null),i=0,s=arguments.length,a=new Array(s);i<s;i++)a[i]=arguments[i];return h(h(t=n["$nan?"]())?t:n["$infinite?"]())?1:_(n,e.find_super_dispatcher(n,"denominator",J,!1),a,r)},J.$$arity=0),e.def(je,"$downto",K=function(e){var r,i=K.$$p,s=i||f,o=this;if(i&&(K.$$p=null),i&&(K.$$p=null),s===f)return _(o,"enum_for",["downto",e],(r=function(){var i=r.$$s||this;return h(p(Fe,"Numeric")["$==="](e))||i.$raise(p(Fe,"ArgumentError"),"comparison of "+i.$class()+" with "+e.$class()+" failed"),h(t(e,i))?0:n(a(i,e),1)},r.$$s=o,r.$$arity=0,r));e.$$is_number||o.$raise(p(Fe,"ArgumentError"),"comparison of "+o.$class()+" with "+e.$class()+" failed");for(var c=o;c>=e;c--)s(c);return o},K.$$arity=1),e.alias(je,"eql?","=="),e.def(je,"$equal?",Z=function(e){var t,r=this;return h(t=r["$=="](e))?t:isNaN(r)&&isNaN(e)},Z.$$arity=1),e.def(je,"$even?",ee=function(){return this%2==0},ee.$$arity=0),e.def(je,"$floor",te=function(e){var t=this;null==e&&(e=0);var r=t.$to_f();if(r%1==0&&e>=0)return r;var n=Math.pow(10,e),a=Math.floor(r*n)/n;return r%1==0&&(a=Math.round(a)),a},te.$$arity=-1),e.def(je,"$gcd",re=function(e){var t=this;h(p(Fe,"Integer")["$==="](e))||t.$raise(p(Fe,"TypeError"),"not an integer");for(var r=Math.abs(t),n=Math.abs(e);r>0;){var a=r;r=n%r,n=a}return n},re.$$arity=1),e.def(je,"$gcdlcm",ne=function(e){var t=this;return[t.$gcd(),t.$lcm()]},ne.$$arity=1),e.def(je,"$integer?",ae=function(){return this%1==0},ae.$$arity=0),e.def(je,"$is_a?",ie=function(t){var r=ie.$$p,n=this,a=f,i=f,s=f;for(r&&(ie.$$p=null),i=0,s=arguments.length,a=new Array(s);i<s;i++)a[i]=arguments[i];return!!h(t["$=="](p(Fe,"Integer"))?p(Fe,"Integer")["$==="](n):t["$=="](p(Fe,"Integer")))||(!!h(t["$=="](p(Fe,"Integer"))?p(Fe,"Integer")["$==="](n):t["$=="](p(Fe,"Integer")))||(!!h(t["$=="](p(Fe,"Float"))?p(Fe,"Float")["$==="](n):t["$=="](p(Fe,"Float")))||_(n,e.find_super_dispatcher(n,"is_a?",ie,!1),a,r)))},ie.$$arity=1),e.alias(je,"kind_of?","is_a?"),e.def(je,"$instance_of?",se=function(t){var r=se.$$p,n=this,a=f,i=f,s=f;for(r&&(se.$$p=null),i=0,s=arguments.length,a=new Array(s);i<s;i++)a[i]=arguments[i];return!!h(t["$=="](p(Fe,"Integer"))?p(Fe,"Integer")["$==="](n):t["$=="](p(Fe,"Integer")))||(!!h(t["$=="](p(Fe,"Integer"))?p(Fe,"Integer")["$==="](n):t["$=="](p(Fe,"Integer")))||(!!h(t["$=="](p(Fe,"Float"))?p(Fe,"Float")["$==="](n):t["$=="](p(Fe,"Float")))||_(n,e.find_super_dispatcher(n,"instance_of?",se,!1),a,r)))},se.$$arity=1),e.def(je,"$lcm",oe=function(e){var t=this;return h(p(Fe,"Integer")["$==="](e))||t.$raise(p(Fe,"TypeError"),"not an integer"),0==t||0==e?0:Math.abs(t*e/t.$gcd(e))},oe.$$arity=1),e.alias(je,"magnitude","abs"),e.alias(je,"modulo","%"),e.def(je,"$next",ce=function(){return this+1},ce.$$arity=0),e.def(je,"$nobits?",le=function(e){var t=this;return e=p(Fe,"Opal")["$coerce_to!"](e,p(Fe,"Integer"),"to_int"),0==(t&e)},le.$$arity=1),e.def(je,"$nonzero?",ue=function(){var e=this;return 0==e?f:e},ue.$$arity=0),e.def(je,"$numerator",fe=function(){var t,r=fe.$$p,n=this,a=f,i=f,s=f;for(r&&(fe.$$p=null),i=0,s=arguments.length,a=new Array(s);i<s;i++)a[i]=arguments[i];return h(h(t=n["$nan?"]())?t:n["$infinite?"]())?n:_(n,e.find_super_dispatcher(n,"numerator",fe,!1),a,r)},fe.$$arity=0),e.def(je,"$odd?",$e=function(){return this%2!=0},$e.$$arity=0),e.def(je,"$ord",pe=function(){return this},pe.$$arity=0),e.def(je,"$pow",de=function(e,t){var r=this;return 0==r&&r.$raise(p(Fe,"ZeroDivisionError"),"divided by 0"),void 0===t?r["$**"](e):(p(Fe,"Integer")["$==="](e)||r.$raise(p(Fe,"TypeError"),"Integer#pow() 2nd argument not allowed unless a 1st argument is integer"),e<0&&r.$raise(p(Fe,"TypeError"),"Integer#pow() 1st argument cannot be negative when 2nd argument specified"),p(Fe,"Integer")["$==="](t)||r.$raise(p(Fe,"TypeError"),"Integer#pow() 2nd argument not allowed unless all arguments are integers"),0===t&&r.$raise(p(Fe,"ZeroDivisionError"),"divided by 0"),r["$**"](e)["$%"](t))},de.$$arity=-2),e.def(je,"$pred",he=function(){return this-1},he.$$arity=0),e.def(je,"$quo",_e=function(t){var r=_e.$$p,n=this,a=f,s=f,o=f;for(r&&(_e.$$p=null),s=0,o=arguments.length,a=new Array(o);s<o;s++)a[s]=arguments[s];return h(p(Fe,"Integer")["$==="](n))?_(n,e.find_super_dispatcher(n,"quo",_e,!1),a,r):i(n,t)},_e.$$arity=1),e.def(je,"$rationalize",me=function(t){var r,n,i=this,o=f,c=f;return arguments.length>1&&i.$raise(p(Fe,"ArgumentError"),"wrong number of arguments ("+arguments.length+" for 0..1)"),h(p(Fe,"Integer")["$==="](i))?p(Fe,"Rational").$new(i,1):h(i["$infinite?"]())?i.$raise(p(Fe,"FloatDomainError"),"Infinity"):h(i["$nan?"]())?i.$raise(p(Fe,"FloatDomainError"),"NaN"):h(null==t)?(n=p(Fe,"Math").$frexp(i),r=e.to_ary(n),o=null==r[0]?f:r[0],c=null==r[1]?f:r[1],o=p(Fe,"Math").$ldexp(o,$(p(Fe,"Float"),"MANT_DIG")).$to_i(),c=a(c,$(p(Fe,"Float"),"MANT_DIG")),p(Fe,"Rational").$new(s(2,o),1["$<<"](a(1,c))).$rationalize(p(Fe,"Rational").$new(1,1["$<<"](a(1,c))))):i.$to_r().$rationalize(t)},me.$$arity=-1),e.def(je,"$remainder",ye=function(e){var t=this;return a(t,s(e,i(t,e).$truncate()))},ye.$$arity=1),e.def(je,"$round",ge=function(s){var l,u,d=this,_=f;if(h(p(Fe,"Integer")["$==="](d))){if(h(null==s))return d;if(h(h(l=p(Fe,"Float")["$==="](s))?s["$infinite?"]():l)&&d.$raise(p(Fe,"RangeError"),"Infinity"),s=p(Fe,"Opal")["$coerce_to!"](s,p(Fe,"Integer"),"to_int"),h(r(s,$(p(Fe,"Integer"),"MIN")))&&d.$raise(p(Fe,"RangeError"),"out of bounds"),h(s>=0))return d;if(.415241*(s=s["$-@"]())-.125>d.$size())return 0;var m=Math.pow(10,s),y=Math.floor((Math.abs(y)+m/2)/m)*m;return d<0?-y:y}if(h(h(l=d["$nan?"]())?null==s:l)&&d.$raise(p(Fe,"FloatDomainError"),"NaN"),s=p(Fe,"Opal")["$coerce_to!"](s||0,p(Fe,"Integer"),"to_int"),h(o(s,0)))h(d["$nan?"]())?d.$raise(p(Fe,"RangeError"),"NaN"):h(d["$infinite?"]())&&d.$raise(p(Fe,"FloatDomainError"),"Infinity");else{if(s["$=="](0))return Math.round(d);if(h(h(l=d["$nan?"]())?l:d["$infinite?"]()))return d}return u=p(Fe,"Math").$frexp(d),l=e.to_ary(u),null==l[0]?f:l[0],_=null==l[1]?f:l[1],h(c(s,a(n($(p(Fe,"Float"),"DIG"),2),function(){return h(t(_,0))?i(_,4):a(i(_,3),1)}())))?d:h(r(s,function(){return h(t(_,0))?n(i(_,3),1):i(_,4)}()["$-@"]()))?0:Math.round(d*Math.pow(10,s))/Math.pow(10,s)},ge.$$arity=-1),e.def(je,"$step",ve=function(t,r,n){function a(){void 0!==d&&(l=d),void 0===l&&(l=f),u===f&&b.$raise(p(Fe,"TypeError"),"step must be numeric"),0===u&&b.$raise(p(Fe,"ArgumentError"),"step can't be 0"),void 0!==h&&(u=h),u!==f&&null!=u||(u=1);var e=u["$<=>"](0);e===f&&b.$raise(p(Fe,"ArgumentError"),"0 can't be coerced into "+u.$class()),l!==f&&null!=l||(l=e>0?$(p(Fe,"Float"),"INFINITY"):$(p(Fe,"Float"),"INFINITY")["$-@"]()),p(Fe,"Opal").$compare(b,l)}function i(){if(u>0&&b>l||u<0&&b<l)return 0;if(u===1/0||u===-1/0)return 1;var e=Math.abs,t=Math.floor,r=(e(b)+e(l)+e(l-b))/e(u)*$(p(Fe,"Float"),"EPSILON");return r===1/0||r===-1/0?0:(r>.5&&(r=.5),t((l-b)/u+r)+1)}function s(){if(a(),0===u)return 1/0;if(u%1!=0)return i();if(u>0&&b>l||u<0&&b<l)return 0;var e=Math.ceil,t=Math.abs;return e((t(b-l)+1)/t(u))}var o,c,l,u,d,h,y,g=ve.$$p,v=g||f,b=this,x=f,w=f;if(g&&(ve.$$p=null),g&&(ve.$$p=null),o=e.slice.call(arguments,0,arguments.length),null==(c=e.extract_kwargs(o)))c=m([],{});else if(!c.$$is_hash)throw e.ArgumentError.$new("expected kwargs");if(o.length>0&&(l=o[0],o.splice(0,1)),o.length>0&&(u=o[0],o.splice(0,1)),d=c.$$smap.to,h=c.$$smap.by,void 0!==l&&void 0!==d&&b.$raise(p(Fe,"ArgumentError"),"to is given twice"),void 0!==u&&void 0!==h&&b.$raise(p(Fe,"ArgumentError"),"step is given twice"),v===f)return x=[],w=m([],{}),void 0!==l&&x.push(l),void 0!==u&&x.push(u),void 0!==d&&e.hash_put(w,"to",d),void 0!==h&&e.hash_put(w,"by",h),w["$any?"]()&&x.push(w),_(b,"enum_for",["step"].concat(e.to_a(x)),(y=function(){y.$$s;return s()},y.$$s=b,y.$$arity=0,y));if(a(),0===u)for(;;)v(b);if(b%1!=0||l%1!=0||u%1!=0){var A=i();if(A>0)if(u===1/0||u===-1/0)v(b);else{var k,E=0;if(u>0)for(;E<A;)k=E*u+b,l<k&&(k=l),v(k),E+=1;else for(;E<A;)k=E*u+b,l>k&&(k=l),v(k),E+=1}}else{var S=b;if(u>0)for(;S<=l;)v(S),S+=u;else for(;S>=l;)v(S),S+=u}return b},ve.$$arity=-1),e.alias(je,"succ","next"),e.def(je,"$times",be=function(){var e,t=be.$$p,r=t||f,n=this;if(t&&(be.$$p=null),t&&(be.$$p=null),!h(r))return _(n,"enum_for",["times"],(e=function(){return e.$$s||this},e.$$s=n,e.$$arity=0,e));for(var a=0;a<n;a++)r(a);return n},be.$$arity=0),e.def(je,"$to_f",xe=function(){return this},xe.$$arity=0),e.def(je,"$to_i",we=function(){var e=this;return parseInt(e,10)},we.$$arity=0),e.alias(je,"to_int","to_i"),e.def(je,"$to_r",Ae=function(){var t,r,n=this,i=f,o=f;return h(p(Fe,"Integer")["$==="](n))?p(Fe,"Rational").$new(n,1):(r=p(Fe,"Math").$frexp(n),t=e.to_ary(r),i=null==t[0]?f:t[0],o=null==t[1]?f:t[1],i=p(Fe,"Math").$ldexp(i,$(p(Fe,"Float"),"MANT_DIG")).$to_i(),o=a(o,$(p(Fe,"Float"),"MANT_DIG")),s(i,$(p(Fe,"Float"),"RADIX")["$**"](o)).$to_r())},Ae.$$arity=0),e.def(je,"$to_s",ke=function(e){var n,a=this;return null==e&&(e=10),e=p(Fe,"Opal")["$coerce_to!"](e,p(Fe,"Integer"),"to_int"),h(h(n=r(e,2))?n:t(e,36))&&a.$raise(p(Fe,"ArgumentError"),"invalid radix "+e),a.toString(e)},ke.$$arity=-1),e.def(je,"$truncate",Ee=function(e){var t=this;null==e&&(e=0);var r=t.$to_f();if(r%1==0&&e>=0)return r;var n=Math.pow(10,e),a=parseInt(r*n,10)/n;return r%1==0&&(a=Math.round(a)),a},Ee.$$arity=-1),e.alias(je,"inspect","to_s"),e.def(je,"$digits",Se=function(e){var t=this;null==e&&(e=10),r(t,0)&&t.$raise($(p(Fe,"Math"),"DomainError"),"out of domain"),e=p(Fe,"Opal")["$coerce_to!"](e,p(Fe,"Integer"),"to_int"),h(r(e,2))&&t.$raise(p(Fe,"ArgumentError"),"invalid radix "+e);for(var n=t,a=[];0!==n;)a.push(n%e),n=parseInt(n/e,10);return a},Se.$$arity=-1),e.def(je,"$divmod",Ne=function(t){var r,n=Ne.$$p,a=this,i=f,s=f,o=f;for(n&&(Ne.$$p=null),s=0,o=arguments.length,i=new Array(o);s<o;s++)i[s]=arguments[s];return h(h(r=a["$nan?"]())?r:t["$nan?"]())?a.$raise(p(Fe,"FloatDomainError"),"NaN"):h(a["$infinite?"]())?a.$raise(p(Fe,"FloatDomainError"),"Infinity"):_(a,e.find_super_dispatcher(a,"divmod",Ne,!1),i,n)},Ne.$$arity=1),e.def(je,"$upto",Ce=function(e){var t,i=Ce.$$p,s=i||f,o=this;if(i&&(Ce.$$p=null),i&&(Ce.$$p=null),s===f)return _(o,"enum_for",["upto",e],(t=function(){var i=t.$$s||this;return h(p(Fe,"Numeric")["$==="](e))||i.$raise(p(Fe,"ArgumentError"),"comparison of "+i.$class()+" with "+e.$class()+" failed"),h(r(e,i))?0:n(a(e,i),1)},t.$$s=o,t.$$arity=0,t));e.$$is_number||o.$raise(p(Fe,"ArgumentError"),"comparison of "+o.$class()+" with "+e.$class()+" failed");for(var c=o;c<=e;c++)s(c);return o},Ce.$$arity=1),e.def(je,"$zero?",Ie=function(){return 0==this},Ie.$$arity=0),e.def(je,"$size",Oe=function(){return 4},Oe.$$arity=0),e.def(je,"$nan?",Le=function(){var e=this;return isNaN(e)},Le.$$arity=0),e.def(je,"$finite?",Pe=function(){var e=this;return e!=1/0&&e!=-1/0&&!isNaN(e)},Pe.$$arity=0),e.def(je,"$infinite?",Me=function(){var e=this;return e==1/0?1:e==-1/0?-1:f},Me.$$arity=0),e.def(je,"$positive?",Te=function(){var e=this;return 0!=e&&(e==1/0||1/e>0)},Te.$$arity=0),e.def(je,"$negative?",Be=function(){var e=this;return e==-1/0||1/e<0},Be.$$arity=0)}(u[0],p(u,"Numeric"),u),e.const_set(u[0],"Fixnum",p(u,"Number")),function(t,r,n){var a=d(t,r,"Integer"),i=[a].concat(n);a.$$is_number_class=!0,function(t,r){
var n,a,i,s=[t].concat(r);e.def(t,"$allocate",n=function(){var e=this;return e.$raise(p(s,"TypeError"),"allocator undefined for "+e.$name())},n.$$arity=0),e.udef(t,"$new"),e.def(t,"$===",a=function(e){return!!e.$$is_number&&e%1==0},a.$$arity=1),e.def(t,"$sqrt",i=function(e){var t=this;return e=p(s,"Opal")["$coerce_to!"](e,p(s,"Integer"),"to_int"),e<0&&t.$raise($(p(s,"Math"),"DomainError"),'Numerical argument is out of domain - "isqrt"'),parseInt(Math.sqrt(e),10)},i.$$arity=1)}(e.get_singleton_class(a),i),e.const_set(i[0],"MAX",Math.pow(2,30)-1),e.const_set(i[0],"MIN",-Math.pow(2,30))}(u[0],p(u,"Numeric"),u),function(t,r,n){var a=d(t,r,"Float"),i=[a].concat(n);return a.$$is_number_class=!0,function(t,r){var n,a,i=[t].concat(r);e.def(t,"$allocate",n=function(){var e=this;return e.$raise(p(i,"TypeError"),"allocator undefined for "+e.$name())},n.$$arity=0),e.udef(t,"$new"),e.def(t,"$===",a=function(e){return!!e.$$is_number},a.$$arity=1)}(e.get_singleton_class(a),i),e.const_set(i[0],"INFINITY",1/0),e.const_set(i[0],"MAX",Number.MAX_VALUE),e.const_set(i[0],"MIN",Number.MIN_VALUE),e.const_set(i[0],"NAN",NaN),e.const_set(i[0],"DIG",15),e.const_set(i[0],"MANT_DIG",53),e.const_set(i[0],"RADIX",2),e.const_set(i[0],"EPSILON",Number.EPSILON||2.220446049250313e-16)}(u[0],p(u,"Numeric"),u)},Opal.modules["corelib/range"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e<=t:e["$<="](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e<t:e["$<"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}function a(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function i(e,t){return"number"==typeof e&&"number"==typeof t?e/t:e["$/"](t)}function s(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}function o(e,t){return"number"==typeof e&&"number"==typeof t?e*t:e["$*"](t)}function c(e,t){return"number"==typeof e&&"number"==typeof t?e>=t:e["$>="](t)}var l=e.top,u=[],f=e.nil,$=e.const_get_qualified,p=e.const_get_relative,d=(e.breaker,e.slice,e.klass),h=e.truthy,_=e.send;return e.add_stubs(["$require","$include","$attr_reader","$raise","$<=>","$include?","$<=","$<","$enum_for","$upto","$to_proc","$respond_to?","$class","$succ","$!","$==","$===","$exclude_end?","$eql?","$begin","$end","$last","$to_a","$>","$-","$abs","$to_i","$coerce_to!","$ceil","$/","$size","$loop","$+","$*","$>=","$each_with_index","$%","$bsearch","$inspect","$[]","$hash"]),l.$require("corelib/enumerable"),function(l,u,m){var y,g,v,b,x,w,A,k,E,S,N,C,I,O,L,P,M,T,B=d(l,null,"Range"),j=[B].concat(m);return B.$$prototype.begin=B.$$prototype.end=B.$$prototype.excl=f,B.$include(p(j,"Enumerable")),B.$$prototype.$$is_range=!0,B.$attr_reader("begin","end"),e.def(B,"$initialize",y=function(e,t,r){var n=this;return null==r&&(r=!1),h(n.begin)&&n.$raise(p(j,"NameError"),"'initialize' called twice"),h(e["$<=>"](t))||n.$raise(p(j,"ArgumentError"),"bad value for range"),n.begin=e,n.end=t,n.excl=r},y.$$arity=-3),e.def(B,"$==",g=function(e){var t=this;return!!e.$$is_range&&(t.excl===e.excl&&t.begin==e.begin&&t.end==e.end)},g.$$arity=1),e.def(B,"$===",v=function(e){return this["$include?"](e)},v.$$arity=1),e.def(B,"$cover?",b=function(e){var n,a=this,i=f,s=f;return i=a.begin["$<=>"](e),!!h(h(n=i)?t(i,0):n)&&(s=e["$<=>"](a.end),h(a.excl)?h(n=s)?r(s,0):n:h(n=s)?t(s,0):n)},b.$$arity=1),e.def(B,"$each",x=function(){var t,n=x.$$p,a=n||f,i=this,s=f,o=f;if(n&&(x.$$p=null),n&&(x.$$p=null),a===f)return i.$enum_for("each");var c,l;if(i.begin.$$is_number&&i.end.$$is_number){for(i.begin%1==0&&i.end%1==0||i.$raise(p(j,"TypeError"),"can't iterate from Float"),c=i.begin,l=i.end+function(){return h(i.excl)?0:1}();c<l;c++)a(c);return i}if(i.begin.$$is_string&&i.end.$$is_string)return _(i.begin,"upto",[i.end,i.excl],a.$to_proc()),i;for(s=i.begin,o=i.end,h(s["$respond_to?"]("succ"))||i.$raise(p(j,"TypeError"),"can't iterate from "+s.$class());h(r(s["$<=>"](o),0));)e.yield1(a,s),s=s.$succ();return h(h(t=i.excl["$!"]())?s["$=="](o):t)&&e.yield1(a,s),i},x.$$arity=0),e.def(B,"$eql?",w=function(e){var t,r,n=this;return!!h(p(j,"Range")["$==="](e))&&(h(t=h(r=n.excl["$==="](e["$exclude_end?"]()))?n.begin["$eql?"](e.$begin()):r)?n.end["$eql?"](e.$end()):t)},w.$$arity=1),e.def(B,"$exclude_end?",A=function(){return this.excl},A.$$arity=0),e.def(B,"$first",k=function(t){var r=k.$$p,n=this,a=f,i=f,s=f;for(r&&(k.$$p=null),i=0,s=arguments.length,a=new Array(s);i<s;i++)a[i]=arguments[i];return h(null==t)?n.begin:_(n,e.find_super_dispatcher(n,"first",k,!1),a,r)},k.$$arity=-1),e.alias(B,"include?","cover?"),e.def(B,"$last",E=function(e){var t=this;return h(null==e)?t.end:t.$to_a().$last(e)},E.$$arity=-1),e.def(B,"$max",S=function(){var t,r=S.$$p,a=r||f,i=this,s=f,o=f,c=f;for(r&&(S.$$p=null),o=0,c=arguments.length,s=new Array(c);o<c;o++)s[o]=arguments[o];return a!==f?_(i,e.find_super_dispatcher(i,"max",S,!1),s,r):h(n(i.begin,i.end))?f:h(h(t=i.excl)?i.begin["$=="](i.end):t)?f:i.excl?i.end-1:i.end},S.$$arity=0),e.alias(B,"member?","cover?"),e.def(B,"$min",N=function(){var t,r=N.$$p,a=r||f,i=this,s=f,o=f,c=f;for(r&&(N.$$p=null),o=0,c=arguments.length,s=new Array(c);o<c;o++)s[o]=arguments[o];return a!==f?_(i,e.find_super_dispatcher(i,"min",N,!1),s,r):h(n(i.begin,i.end))?f:h(h(t=i.excl)?i.begin["$=="](i.end):t)?f:i.begin},N.$$arity=0),e.def(B,"$size",C=function(){var e,t=this,n=f,i=f,s=f;return n=t.begin,i=t.end,h(t.excl)&&(i=a(i,1)),h(h(e=p(j,"Numeric")["$==="](n))?p(j,"Numeric")["$==="](i):e)?h(r(i,n))?0:(s=$(p(j,"Float"),"INFINITY"),h([n.$abs(),i.$abs()]["$include?"](s))?s:(Math.abs(i-n)+1).$to_i()):f},C.$$arity=0),e.def(B,"$step",I=function(t){function r(){t.$$is_number||(t=p(j,"Opal")["$coerce_to!"](t,p(j,"Integer"),"to_int")),t<0?g.$raise(p(j,"ArgumentError"),"step can't be negative"):0===t&&g.$raise(p(j,"ArgumentError"),"step can't be 0")}function a(){if(!g.begin["$respond_to?"]("succ"))return f;if(g.begin.$$is_string&&g.end.$$is_string)return f;if(t%1==0)return i(g.$size(),t).$ceil();var e,r=g.begin,n=g.end,a=Math.abs,s=Math.floor,o=(a(r)+a(n)+a(n-r))/a(t)*$(p(j,"Float"),"EPSILON");return o>.5&&(o=.5),g.excl?(e=s((n-r)/t-o))*t+r<n&&e++:e=s((n-r)/t+o)+1,e}var l,u,d,m=I.$$p,y=m||f,g=this,v=f;return m&&(I.$$p=null),null==t&&(t=1),y===f?_(g,"enum_for",["step",t],(l=function(){l.$$s;return r(),a()},l.$$s=g,l.$$arity=0,l)):(r(),h(g.begin.$$is_number&&g.end.$$is_number)?(v=0,function(){var r=e.new_brk();try{_(g,"loop",[],(u=function(){var a=u.$$s||this,i=f;return null==a.begin&&(a.begin=f),null==a.excl&&(a.excl=f),null==a.end&&(a.end=f),i=s(a.begin,o(v,t)),h(a.excl)?h(c(i,a.end))&&e.brk(f,r):h(n(i,a.end))&&e.brk(f,r),e.yield1(y,i),v=s(v,1)},u.$$s=g,u.$$brk=r,u.$$arity=0,u))}catch(e){if(e===r)return e.$v;throw e}}()):(g.begin.$$is_string&&g.end.$$is_string&&t%1!=0&&g.$raise(p(j,"TypeError"),"no implicit conversion to float from string"),_(g,"each_with_index",[],(d=function(r,n){d.$$s;return null==r&&(r=f),null==n&&(n=f),n["$%"](t)["$=="](0)?e.yield1(y,r):f},d.$$s=g,d.$$arity=2,d))),g)},I.$$arity=-1),e.def(B,"$bsearch",O=function(){var e=O.$$p,t=e||f,r=this;return e&&(O.$$p=null),e&&(O.$$p=null),t===f?r.$enum_for("bsearch"):(h(r.begin.$$is_number&&r.end.$$is_number)||r.$raise(p(j,"TypeError"),"can't do binary search for "+r.begin.$class()),_(r.$to_a(),"bsearch",[],t.$to_proc()))},O.$$arity=0),e.def(B,"$to_s",L=function(){var e=this;return""+e.begin+function(){return h(e.excl)?"...":".."}()+e.end},L.$$arity=0),e.def(B,"$inspect",P=function(){var e=this;return""+e.begin.$inspect()+function(){return h(e.excl)?"...":".."}()+e.end.$inspect()},P.$$arity=0),e.def(B,"$marshal_load",M=function(e){var t=this;return t.begin=e["$[]"]("begin"),t.end=e["$[]"]("end"),t.excl=e["$[]"]("excl")},M.$$arity=1),e.def(B,"$hash",T=function(){var e=this;return[e.begin,e.end,e.excl].$hash()},T.$$arity=0),f&&"hash"}(u[0],0,u)},Opal.modules["corelib/proc"]=function(e){var t=(e.top,[]),r=e.nil,n=(e.const_get_qualified,e.const_get_relative),a=(e.breaker,e.slice),i=e.klass,s=e.truthy;return e.add_stubs(["$raise","$coerce_to!"]),function(t,o,c){var l,u,f,$,p,d,h,_,m,y,g=i(t,o,"Proc"),v=[g].concat(c);return e.defineProperty(g.$$prototype,"$$is_proc",!0),e.defineProperty(g.$$prototype,"$$is_lambda",!1),e.defs(g,"$new",l=function(){var e=l.$$p,t=e||r,a=this;return e&&(l.$$p=null),e&&(l.$$p=null),s(t)||a.$raise(n(v,"ArgumentError"),"tried to create a Proc object without a block"),t},l.$$arity=0),e.def(g,"$call",u=function(t){var n,a,i=u.$$p,s=i||r,o=this;i&&(u.$$p=null),i&&(u.$$p=null),n=e.slice.call(arguments,0,arguments.length),a=n,s!==r&&(o.$$p=s);var c,l=o.$$brk;if(l)try{c=o.$$is_lambda?o.apply(null,a):e.yieldX(o,a)}catch(e){if(e===l)return l.$v;throw e}else c=o.$$is_lambda?o.apply(null,a):e.yieldX(o,a);return c},u.$$arity=-1),e.alias(g,"[]","call"),e.alias(g,"===","call"),e.alias(g,"yield","call"),e.def(g,"$to_proc",f=function(){return this},f.$$arity=0),e.def(g,"$lambda?",$=function(){return!!this.$$is_lambda},$.$$arity=0),e.def(g,"$arity",p=function(){var e=this;return e.$$is_curried?-1:e.$$arity},p.$$arity=0),e.def(g,"$source_location",d=function(){return this.$$is_curried,r},d.$$arity=0),e.def(g,"$binding",h=function(){var e=this;return e.$$is_curried&&e.$raise(n(v,"ArgumentError"),"Can't create Binding"),r},h.$$arity=0),e.def(g,"$parameters",_=function(){var e=this;if(e.$$is_curried)return[["rest"]];if(e.$$parameters){if(e.$$is_lambda)return e.$$parameters;var t,r,n=[];for(t=0,r=e.$$parameters.length;t<r;t++){var a=e.$$parameters[t];"req"===a[0]&&(a=["opt",a[1]]),n.push(a)}return n}return[]},_.$$arity=0),e.def(g,"$curry",m=function(e){function t(){var i,s=a.call(arguments),o=s.length;return o>e&&r.$$is_lambda&&!r.$$is_curried&&r.$raise(n(v,"ArgumentError"),"wrong number of arguments ("+o+" for "+e+")"),o>=e?r.$call.apply(r,s):(i=function(){return t.apply(null,s.concat(a.call(arguments)))},i.$$is_lambda=r.$$is_lambda,i.$$is_curried=!0,i)}var r=this;return void 0===e?e=r.length:(e=n(v,"Opal")["$coerce_to!"](e,n(v,"Integer"),"to_int"),r.$$is_lambda&&e!==r.length&&r.$raise(n(v,"ArgumentError"),"wrong number of arguments ("+e+" for "+r.length+")")),t.$$is_lambda=r.$$is_lambda,t.$$is_curried=!0,t},m.$$arity=-1),e.def(g,"$dup",y=function(){var e=this,t=e.$$original_proc||e,r=function(){return t.apply(this,arguments)};for(var n in e)e.hasOwnProperty(n)&&(r[n]=e[n]);return r},y.$$arity=0),e.alias(g,"clone","dup")}(t[0],Function,t)},Opal.modules["corelib/method"]=function(e){var t=(e.top,[]),r=e.nil,n=(e.const_get_qualified,e.const_get_relative),a=(e.breaker,e.slice,e.klass),i=e.truthy;return e.add_stubs(["$attr_reader","$arity","$new","$class","$join","$source_location","$raise"]),function(t,s,o){var c,l,u,f,$,p,d,h,_,m=a(t,null,"Method"),y=[m].concat(o);m.$$prototype.method=m.$$prototype.receiver=m.$$prototype.owner=m.$$prototype.name=r,m.$attr_reader("owner","receiver","name"),e.def(m,"$initialize",c=function(e,t,r,n){var a=this;return a.receiver=e,a.owner=t,a.name=n,a.method=r},c.$$arity=4),e.def(m,"$arity",l=function(){return this.method.$arity()},l.$$arity=0),e.def(m,"$parameters",u=function(){return this.method.$$parameters},u.$$arity=0),e.def(m,"$source_location",f=function(){var e;return i(e=this.method.$$source_location)?e:["(eval)",0]},f.$$arity=0),e.def(m,"$comments",$=function(){var e;return i(e=this.method.$$comments)?e:[]},$.$$arity=0),e.def(m,"$call",p=function(t){var n,a,i=p.$$p,s=i||r,o=this;return i&&(p.$$p=null),i&&(p.$$p=null),n=e.slice.call(arguments,0,arguments.length),a=n,o.method.$$p=s,o.method.apply(o.receiver,a)},p.$$arity=-1),e.alias(m,"[]","call"),e.def(m,"$unbind",d=function(){var e=this;return n(y,"UnboundMethod").$new(e.receiver.$class(),e.owner,e.method,e.name)},d.$$arity=0),e.def(m,"$to_proc",h=function(){var e=this,t=e.$call.bind(e);return t.$$unbound=e.method,t.$$is_lambda=!0,t.$$arity=e.method.$$arity,t.$$parameters=e.method.$$parameters,t},h.$$arity=0),e.def(m,"$inspect",_=function(){var e=this;return"#<"+e.$class()+": "+e.receiver.$class()+"#"+e.name+" (defined in "+e.owner+" in "+e.$source_location().$join(":")+")>"},_.$$arity=0)}(t[0],0,t),function(t,s,o){var c,l,u,f,$,p,d,h=a(t,null,"UnboundMethod"),_=[h].concat(o);return h.$$prototype.method=h.$$prototype.owner=h.$$prototype.name=h.$$prototype.source=r,h.$attr_reader("source","owner","name"),e.def(h,"$initialize",c=function(e,t,r,n){var a=this;return a.source=e,a.owner=t,a.method=r,a.name=n},c.$$arity=4),e.def(h,"$arity",l=function(){return this.method.$arity()},l.$$arity=0),e.def(h,"$parameters",u=function(){return this.method.$$parameters},u.$$arity=0),e.def(h,"$source_location",f=function(){var e;return i(e=this.method.$$source_location)?e:["(eval)",0]},f.$$arity=0),e.def(h,"$comments",$=function(){var e;return i(e=this.method.$$comments)?e:[]},$.$$arity=0),e.def(h,"$bind",p=function(t){var r=this;if(r.owner.$$is_module||e.is_a(t,r.owner))return n(_,"Method").$new(t,r.owner,r.method,r.name);r.$raise(n(_,"TypeError"),"can't bind singleton method to a different class (expected "+t+".kind_of?("+r.owner+" to be true)")},p.$$arity=1),e.def(h,"$inspect",d=function(){var e=this;return"#<"+e.$class()+": "+e.source+"#"+e.name+" (defined in "+e.owner+" in "+e.$source_location().$join(":")+")>"},d.$$arity=0),r&&"inspect"}(t[0],0,t)},Opal.modules["corelib/variables"]=function(e){var t=(e.top,[]),r=e.nil,n=(e.const_get_qualified,e.const_get_relative),a=(e.breaker,e.slice,e.gvars),i=e.hash2;return e.add_stubs(["$new"]),a["&"]=a["~"]=a["`"]=a["'"]=r,a.LOADED_FEATURES=a['"']=e.loaded_features,a.LOAD_PATH=a[":"]=[],a["/"]="\n",a[","]=r,e.const_set(t[0],"ARGV",[]),e.const_set(t[0],"ARGF",n(t,"Object").$new()),e.const_set(t[0],"ENV",i([],{})),a.VERBOSE=!1,a.DEBUG=!1,a.SAFE=0},Opal.modules["opal/regexp_anchors"]=function(e){var t=(e.top,[]),r=e.nil,n=(e.const_get_qualified,e.const_get_relative),a=(e.breaker,e.slice,e.module);return e.add_stubs(["$==","$new"]),function(t,i){var s=a(t,"Opal"),o=[s].concat(i);e.const_set(o[0],"REGEXP_START",function(){return n(o,"RUBY_ENGINE")["$=="]("opal")?"^":r}()),e.const_set(o[0],"REGEXP_END",function(){return n(o,"RUBY_ENGINE")["$=="]("opal")?"$":r}()),e.const_set(o[0],"FORBIDDEN_STARTING_IDENTIFIER_CHARS","\\u0001-\\u002F\\u003A-\\u0040\\u005B-\\u005E\\u0060\\u007B-\\u007F"),e.const_set(o[0],"FORBIDDEN_ENDING_IDENTIFIER_CHARS","\\u0001-\\u0020\\u0022-\\u002F\\u003A-\\u003E\\u0040\\u005B-\\u005E\\u0060\\u007B-\\u007F"),e.const_set(o[0],"INLINE_IDENTIFIER_REGEXP",n(o,"Regexp").$new("[^"+n(o,"FORBIDDEN_STARTING_IDENTIFIER_CHARS")+"]*[^"+n(o,"FORBIDDEN_ENDING_IDENTIFIER_CHARS")+"]")),e.const_set(o[0],"FORBIDDEN_CONST_NAME_CHARS","\\u0001-\\u0020\\u0021-\\u002F\\u003B-\\u003F\\u0040\\u005B-\\u005E\\u0060\\u007B-\\u007F"),e.const_set(o[0],"CONST_NAME_REGEXP",n(o,"Regexp").$new(n(o,"REGEXP_START")+"(::)?[A-Z][^"+n(o,"FORBIDDEN_CONST_NAME_CHARS")+"]*"+n(o,"REGEXP_END")))}(t[0],t)},Opal.modules["opal/mini"]=function(e){var t=e.top;e.nil,e.const_get_qualified,e.const_get_relative,e.breaker,e.slice;return e.add_stubs(["$require"]),t.$require("opal/base"),t.$require("corelib/nil"),t.$require("corelib/boolean"),t.$require("corelib/string"),t.$require("corelib/comparable"),t.$require("corelib/enumerable"),t.$require("corelib/enumerator"),t.$require("corelib/array"),t.$require("corelib/hash"),t.$require("corelib/number"),t.$require("corelib/range"),t.$require("corelib/proc"),t.$require("corelib/method"),t.$require("corelib/regexp"),t.$require("corelib/variables"),t.$require("opal/regexp_anchors")},Opal.modules["corelib/kernel/format"]=function(e){var t=(e.top,[]),r=e.nil,n=(e.const_get_qualified,e.const_get_relative),a=(e.breaker,e.slice,e.module),i=e.truthy,s=e.gvars;return e.add_stubs(["$==","$length","$respond_to?","$[]","$coerce_to?","$nil?","$to_a","$raise","$to_int","$fetch","$Integer","$Float","$to_ary","$to_str","$coerce_to","$inspect","$to_s"]),function(t,o){var c,l=a(t,"Kernel"),u=[l].concat(o);e.def(l,"$format",c=function(t,a){function o(){T&z&&y.$raise(n(u,"ArgumentError"),"flag after width"),T&q&&y.$raise(n(u,"ArgumentError"),"flag after precision")}function c(){T&z&&y.$raise(n(u,"ArgumentError"),"width given twice"),T&q&&y.$raise(n(u,"ArgumentError"),"width after precision")}function l(e){return e>=m.length&&y.$raise(n(u,"ArgumentError"),"too few arguments"),m[e]}function f(){switch(D){case-1:y.$raise(n(u,"ArgumentError"),"unnumbered("+R+") mixed with numbered");case-2:y.$raise(n(u,"ArgumentError"),"unnumbered("+R+") mixed with named")}return D=R++,l(D-1)}function $(e){return D>0&&y.$raise(n(u,"ArgumentError"),"numbered("+e+") after unnumbered("+D+")"),-2===D&&y.$raise(n(u,"ArgumentError"),"numbered("+e+") after named"),e<1&&y.$raise(n(u,"ArgumentError"),"invalid index - "+e+"$"),D=-1,l(e-1)}function p(){return void 0===M?f():M}function d(e){for(var r,a="";;b++){if(b===F&&y.$raise(n(u,"ArgumentError"),"malformed format string - %*[0-9]"),t.charCodeAt(b)<48||t.charCodeAt(b)>57)return b--,r=parseInt(a,10)||0,r>2147483647&&y.$raise(n(u,"ArgumentError"),e+" too big"),r;a+=t.charAt(b)}}function h(e){var r,n=d(e);return"$"===t.charAt(b+1)?(b++,r=$(n)):r=f(),r.$to_int()}var _,m,y=this,g=r;null==s.DEBUG&&(s.DEBUG=r),_=e.slice.call(arguments,1,arguments.length),m=_,i(m.$length()["$=="](1)?m["$[]"](0)["$respond_to?"]("to_ary"):m.$length()["$=="](1))&&(g=n(u,"Opal")["$coerce_to?"](m["$[]"](0),n(u,"Array"),"to_ary"),i(g["$nil?"]())||(m=g.$to_a()));var v,b,x,w,A,k,E,S,N,C,I,O,L,P,M,T,B="",j=0,F=t.length,R=1,D=0,z=32,q=128;for(b=t.indexOf("%");-1!==b;b=t.indexOf("%",b)){switch(w=void 0,T=0,k=-1,E=-1,M=void 0,v=b,b++,t.charAt(b)){case"%":j=b;case"":case"\n":case"\0":b++;continue}e:for(;b<F;b++)switch(t.charAt(b)){case" ":o(),T|=16;continue e;case"#":o(),T|=1;continue e;case"+":o(),T|=4;continue e;case"-":o(),T|=2;continue e;case"0":o(),T|=8;continue e;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":if(S=d("width"),"$"===t.charAt(b+1)){if(b+2===F){w="%",b++;break e}void 0!==M&&y.$raise(n(u,"ArgumentError"),"value given twice - %"+S+"$"),M=$(S),b++}else c(),T|=z,k=S;continue e;case"<":case"{":for(C="<"===t.charAt(b)?">":"}",N="",b++;;b++){if(b===F&&y.$raise(n(u,"ArgumentError"),"malformed name - unmatched parenthesis"),t.charAt(b)===C){if(D>0&&y.$raise(n(u,"ArgumentError"),"named "+N+" after unnumbered("+D+")"),-1===D&&y.$raise(n(u,"ArgumentError"),"named "+N+" after numbered"),D=-2,void 0!==m[0]&&m[0].$$is_hash||y.$raise(n(u,"ArgumentError"),"one hash required"),M=m[0].$fetch(N),">"===C)continue e;if(w=M.toString(),-1!==E&&(w=w.slice(0,E)),2&T)for(;w.length<k;)w+=" ";else for(;w.length<k;)w=" "+w;break e}N+=t.charAt(b)}case"*":b++,c(),T|=z,k=h("width"),k<0&&(T|=2,k=-k);continue e;case".":if(T&q&&y.$raise(n(u,"ArgumentError"),"precision given twice"),T|=64|q,E=0,b++,"*"===t.charAt(b)){b++,E=h("precision"),E<0&&(T&=-65);continue e}E=d("precision");continue e;case"d":case"i":case"u":if((x=y.$Integer(p()))>=0){for(w=x.toString();w.length<E;)w="0"+w;if(2&T)for((4&T||16&T)&&(w=(4&T?"+":" ")+w);w.length<k;)w+=" ";else if(8&T&&-1===E){for(;w.length<k-(4&T||16&T?1:0);)w="0"+w;(4&T||16&T)&&(w=(4&T?"+":" ")+w)}else for((4&T||16&T)&&(w=(4&T?"+":" ")+w);w.length<k;)w=" "+w}else{for(w=(-x).toString();w.length<E;)w="0"+w;if(2&T)for(w="-"+w;w.length<k;)w+=" ";else if(8&T&&-1===E){for(;w.length<k-1;)w="0"+w;w="-"+w}else for(w="-"+w;w.length<k;)w=" "+w}break e;case"b":case"B":case"o":case"x":case"X":switch(t.charAt(b)){case"b":case"B":I=2,O="0b",L=/^1+/,P="1";break;case"o":I=8,O="0",L=/^3?7+/,P="7";break;case"x":case"X":I=16,O="0x",L=/^f+/,P="f"}if((x=y.$Integer(p()))>=0){for(w=x.toString(I);w.length<E;)w="0"+w;if(2&T)for((4&T||16&T)&&(w=(4&T?"+":" ")+w),1&T&&0!==x&&(w=O+w);w.length<k;)w+=" ";else if(8&T&&-1===E){for(;w.length<k-(4&T||16&T?1:0)-(1&T&&0!==x?O.length:0);)w="0"+w;1&T&&0!==x&&(w=O+w),(4&T||16&T)&&(w=(4&T?"+":" ")+w)}else for(1&T&&0!==x&&(w=O+w),(4&T||16&T)&&(w=(4&T?"+":" ")+w);w.length<k;)w=" "+w}else if(4&T||16&T){for(w=(-x).toString(I);w.length<E;)w="0"+w;if(2&T)for(1&T&&(w=O+w),w="-"+w;w.length<k;)w+=" ";else if(8&T&&-1===E){for(;w.length<k-1-(1&T?2:0);)w="0"+w;1&T&&(w=O+w),w="-"+w}else for(1&T&&(w=O+w),w="-"+w;w.length<k;)w=" "+w}else{for(w=(x>>>0).toString(I).replace(L,P);w.length<E-2;)w=P+w;if(2&T)for(w=".."+w,1&T&&(w=O+w);w.length<k;)w+=" ";else if(8&T&&-1===E){for(;w.length<k-2-(1&T?O.length:0);)w=P+w;w=".."+w,1&T&&(w=O+w)}else for(w=".."+w,1&T&&(w=O+w);w.length<k;)w=" "+w}t.charAt(b)===t.charAt(b).toUpperCase()&&(w=w.toUpperCase());break e;case"f":case"e":case"E":case"g":case"G":if((x=y.$Float(p()))>=0||isNaN(x)){if(x===1/0)w="Inf";else switch(t.charAt(b)){case"f":w=x.toFixed(-1===E?6:E);break;case"e":case"E":w=x.toExponential(-1===E?6:E);break;case"g":case"G":w=x.toExponential(),A=parseInt(w.split("e")[1],10),A<-4||A>=(-1===E?6:E)||(w=x.toPrecision(-1===E?1&T?6:void 0:E))}if(2&T)for((4&T||16&T)&&(w=(4&T?"+":" ")+w);w.length<k;)w+=" ";else if(8&T&&x!==1/0&&!isNaN(x)){for(;w.length<k-(4&T||16&T?1:0);)w="0"+w;(4&T||16&T)&&(w=(4&T?"+":" ")+w)}else for((4&T||16&T)&&(w=(4&T?"+":" ")+w);w.length<k;)w=" "+w}else{if(x===-1/0)w="Inf";else switch(t.charAt(b)){case"f":w=(-x).toFixed(-1===E?6:E);break;case"e":case"E":w=(-x).toExponential(-1===E?6:E);break;case"g":case"G":w=(-x).toExponential(),A=parseInt(w.split("e")[1],10),A<-4||A>=(-1===E?6:E)||(w=(-x).toPrecision(-1===E?1&T?6:void 0:E))}if(2&T)for(w="-"+w;w.length<k;)w+=" ";else if(8&T&&x!==-1/0){for(;w.length<k-1;)w="0"+w;w="-"+w}else for(w="-"+w;w.length<k;)w=" "+w}t.charAt(b)!==t.charAt(b).toUpperCase()||x===1/0||x===-1/0||isNaN(x)||(w=w.toUpperCase()),w=w.replace(/([eE][-+]?)([0-9])$/,"$10$2");break e;case"a":case"A":y.$raise(n(u,"NotImplementedError"),"`A` and `a` format field types are not implemented in Opal yet");case"c":if(x=p(),x["$respond_to?"]("to_ary")&&(x=x.$to_ary()[0]),w=x["$respond_to?"]("to_str")?x.$to_str():String.fromCharCode(n(u,"Opal").$coerce_to(x,n(u,"Integer"),"to_int")),1!==w.length&&y.$raise(n(u,"ArgumentError"),"%c requires a character"),2&T)for(;w.length<k;)w+=" ";else for(;w.length<k;)w=" "+w;break e;case"p":if(w=p().$inspect(),-1!==E&&(w=w.slice(0,E)),2&T)for(;w.length<k;)w+=" ";else for(;w.length<k;)w=" "+w;break e;case"s":if(w=p().$to_s(),-1!==E&&(w=w.slice(0,E)),2&T)for(;w.length<k;)w+=" ";else for(;w.length<k;)w=" "+w;break e;default:y.$raise(n(u,"ArgumentError"),"malformed format string - %"+t.charAt(b))}void 0===w&&y.$raise(n(u,"ArgumentError"),"malformed format string - %"),B+=t.slice(j,v)+w,j=b+1}return s.DEBUG&&D>=0&&R<m.length&&y.$raise(n(u,"ArgumentError"),"too many arguments for format string"),B+t.slice(j)},c.$$arity=-2),e.alias(l,"sprintf","format")}(t[0],t)},Opal.modules["corelib/string/encoding"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}var r,n,a,i,s,o=e.top,c=[],l=e.nil,u=e.const_get_qualified,f=e.const_get_relative,$=(e.breaker,e.slice,e.klass),p=e.hash2,d=e.truthy,h=e.send;return e.add_stubs(["$require","$+","$[]","$new","$to_proc","$each","$const_set","$sub","$==","$default_external","$upcase","$raise","$attr_accessor","$attr_reader","$register","$length","$bytes","$to_a","$each_byte","$bytesize","$enum_for","$each_codepoint","$force_encoding","$dup","$coerce_to!","$find","$getbyte"]),o.$require("corelib/string"),function(r,n,a){var i,s,o,c,u,_,m,y,g,v,b=$(r,null,"Encoding"),x=[b].concat(a);b.$$prototype.ascii=b.$$prototype.dummy=b.$$prototype.name=l,e.defineProperty(b,"$$register",{}),e.defs(b,"$register",i=function(e,r){var n,a,s=i.$$p,o=s||l,c=this,u=l,$=l,_=l;return s&&(i.$$p=null),s&&(i.$$p=null),null==r&&(r=p([],{})),u=t([e],d(n=r["$[]"]("aliases"))?n:[]),$=h(f(x,"Class"),"new",[c],o.$to_proc()).$new(e,u,!!d(n=r["$[]"]("ascii"))&&n,!!d(n=r["$[]"]("dummy"))&&n),_=c.$$register,h(u,"each",[],(a=function(e){var t=a.$$s||this;return null==e&&(e=l),t.$const_set(e.$sub("-","_"),$),_["$$"+e]=$},a.$$s=c,a.$$arity=1,a))},i.$$arity=-2),e.defs(b,"$find",s=function(e){var t,r=this,n=l,a=l;return e["$=="]("default_external")?r.$default_external():(n=r.$$register,a=d(t=n["$$"+e])?t:n["$$"+e.$upcase()],d(a)||r.$raise(f(x,"ArgumentError"),"unknown encoding name - "+e),a)},s.$$arity=1),function(e,t){[e].concat(t);e.$attr_accessor("default_external")}(e.get_singleton_class(b),x),b.$attr_reader("name","names"),e.def(b,"$initialize",o=function(e,t,r,n){var a=this;return a.name=e,a.names=t,a.ascii=r,a.dummy=n},o.$$arity=4),e.def(b,"$ascii_compatible?",c=function(){return this.ascii},c.$$arity=0),e.def(b,"$dummy?",u=function(){return this.dummy},u.$$arity=0),e.def(b,"$to_s",_=function(){return this.name},_.$$arity=0),e.def(b,"$inspect",m=function(){var e=this;return"#<Encoding:"+e.name+function(){return d(e.dummy)?" (dummy)":l}()+">"},m.$$arity=0),e.def(b,"$each_byte",y=function(t){var r=this;return e.slice.call(arguments,0,arguments.length),r.$raise(f(x,"NotImplementedError"))},y.$$arity=-1),e.def(b,"$getbyte",g=function(t){var r=this;return e.slice.call(arguments,0,arguments.length),r.$raise(f(x,"NotImplementedError"))},g.$$arity=-1),e.def(b,"$bytesize",v=function(t){var r=this;return e.slice.call(arguments,0,arguments.length),r.$raise(f(x,"NotImplementedError"))},v.$$arity=-1),function(e,t,r){var n=$(e,t,"EncodingError");[n].concat(r)}(x[0],f(x,"StandardError"),x),function(e,t,r){var n=$(e,t,"CompatibilityError");[n].concat(r)}(x[0],f(x,"EncodingError"),x)}(c[0],0,c),h(f(c,"Encoding"),"register",["UTF-8",p(["aliases","ascii"],{aliases:["CP65001"],ascii:!0})],(r=function(){var t,n,a=r.$$s||this;return e.def(a,"$each_byte",t=function(r){var n=t.$$p,a=n||l;n&&(t.$$p=null),n&&(t.$$p=null);for(var i=0,s=r.length;i<s;i++){var o=r.charCodeAt(i);if(o<=127)e.yield1(a,o);else for(var c=encodeURIComponent(r.charAt(i)).substr(1).split("%"),u=0,f=c.length;u<f;u++)e.yield1(a,parseInt(c[u],16))}},t.$$arity=1),e.def(a,"$bytesize",n=function(e){return e.$bytes().$length()},n.$$arity=1),l&&"bytesize"},r.$$s=o,r.$$arity=0,r)),h(f(c,"Encoding"),"register",["UTF-16LE"],(n=function(){var t,r,a=n.$$s||this;return e.def(a,"$each_byte",t=function(r){var n=t.$$p,a=n||l;n&&(t.$$p=null),n&&(t.$$p=null);for(var i=0,s=r.length;i<s;i++){var o=r.charCodeAt(i);e.yield1(a,255&o),e.yield1(a,o>>8)}},t.$$arity=1),e.def(a,"$bytesize",r=function(e){return e.$bytes().$length()},r.$$arity=1),l&&"bytesize"},n.$$s=o,n.$$arity=0,n)),h(f(c,"Encoding"),"register",["UTF-16BE"],(a=function(){var t,r,n=a.$$s||this;return e.def(n,"$each_byte",t=function(r){var n=t.$$p,a=n||l;n&&(t.$$p=null),n&&(t.$$p=null);for(var i=0,s=r.length;i<s;i++){var o=r.charCodeAt(i);e.yield1(a,o>>8),e.yield1(a,255&o)}},t.$$arity=1),e.def(n,"$bytesize",r=function(e){return e.$bytes().$length()},r.$$arity=1),l&&"bytesize"},a.$$s=o,a.$$arity=0,a)),h(f(c,"Encoding"),"register",["UTF-32LE"],(i=function(){var t,r,n=i.$$s||this;return e.def(n,"$each_byte",t=function(r){var n=t.$$p,a=n||l;n&&(t.$$p=null),n&&(t.$$p=null);for(var i=0,s=r.length;i<s;i++){var o=r.charCodeAt(i);e.yield1(a,255&o),e.yield1(a,o>>8)}},t.$$arity=1),e.def(n,"$bytesize",r=function(e){return e.$bytes().$length()},r.$$arity=1),l&&"bytesize"},i.$$s=o,i.$$arity=0,i)),h(f(c,"Encoding"),"register",["ASCII-8BIT",p(["aliases","ascii","dummy"],{aliases:["BINARY","US-ASCII","ASCII"],ascii:!0,dummy:!0})],(s=function(){var t,r,n=s.$$s||this;return e.def(n,"$each_byte",t=function(r){var n=t.$$p,a=n||l;n&&(t.$$p=null),n&&(t.$$p=null);for(var i=0,s=r.length;i<s;i++){var o=r.charCodeAt(i);e.yield1(a,255&o),e.yield1(a,o>>8)}},t.$$arity=1),e.def(n,"$bytesize",r=function(e){return e.$bytes().$length()},r.$$arity=1),l&&"bytesize"},s.$$s=o,s.$$arity=0,s)),function(t,r,n){var a,i,s,o,c,p,d,_,m,y=$(t,null,"String"),g=[y].concat(n);return y.$$prototype.encoding=l,y.$attr_reader("encoding"),e.defineProperty(String.prototype,"encoding",u(f(g,"Encoding"),"UTF_16LE")),e.def(y,"$bytes",a=function(){return this.$each_byte().$to_a()},a.$$arity=0),e.def(y,"$bytesize",i=function(){var e=this;return e.encoding.$bytesize(e)},i.$$arity=0),e.def(y,"$each_byte",s=function(){var e=s.$$p,t=e||l,r=this;return e&&(s.$$p=null),e&&(s.$$p=null),t===l?r.$enum_for("each_byte"):(h(r.encoding,"each_byte",[r],t.$to_proc()),r)},s.$$arity=0),e.def(y,"$each_codepoint",o=function(){var t=o.$$p,r=t||l,n=this;if(t&&(o.$$p=null),t&&(o.$$p=null),r===l)return n.$enum_for("each_codepoint");for(var a=0,i=n.length;a<i;a++)e.yield1(r,n.codePointAt(a));return n},o.$$arity=0),e.def(y,"$codepoints",c=function(){var e=c.$$p,t=e||l,r=this;return e&&(c.$$p=null),e&&(c.$$p=null),t!==l?h(r,"each_codepoint",[],t.$to_proc()):r.$each_codepoint().$to_a()},c.$$arity=0),e.def(y,"$encode",p=function(e){return this.$dup().$force_encoding(e)},p.$$arity=1),e.def(y,"$force_encoding",d=function(e){var t=this;return e===t.encoding?t:(e=f(g,"Opal")["$coerce_to!"](e,f(g,"String"),"to_s"),(e=f(g,"Encoding").$find(e))===t.encoding?t:(t.encoding=e,t))},d.$$arity=1),e.def(y,"$getbyte",_=function(e){var t=this;return t.encoding.$getbyte(t,e)},_.$$arity=1),e.def(y,"$valid_encoding?",m=function(){return!0},m.$$arity=0),l&&"valid_encoding?"}(c[0],0,c)},Opal.modules["corelib/math"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e/t:e["$/"](t)}var n=(e.top,[]),a=(e.nil,e.const_get_qualified),i=e.const_get_relative,s=(e.breaker,e.slice,e.module),o=e.truthy;return e.add_stubs(["$new","$raise","$Float","$type_error","$Integer","$module_function","$checked","$float!","$===","$gamma","$-","$integer!","$/","$infinite?"]),function(n,c){var l,u,f,$,p,d,h,_,m,y,g,v,b,x,w,A,k,E,S,N,C,I,O,L,P,M,T,B,j,F=s(n,"Math"),R=[F].concat(c);e.const_set(R[0],"E",Math.E),e.const_set(R[0],"PI",Math.PI),e.const_set(R[0],"DomainError",i(R,"Class").$new(i(R,"StandardError"))),e.defs(F,"$checked",l=function(t,r){var n,a,s=this;if(n=e.slice.call(arguments,1,arguments.length),a=n,isNaN(a[0])||2==a.length&&isNaN(a[1]))return NaN;var o=Math[t].apply(null,a);return isNaN(o)&&s.$raise(i(R,"DomainError"),'Numerical argument is out of domain - "'+t+'"'),o},l.$$arity=-2),e.defs(F,"$float!",u=function(t){var r=this;try{return r.$Float(t)}catch(n){if(!e.rescue(n,[i(R,"ArgumentError")]))throw n;try{return r.$raise(i(R,"Opal").$type_error(t,i(R,"Float")))}finally{e.pop_exception()}}},u.$$arity=1),e.defs(F,"$integer!",f=function(t){var r=this;try{return r.$Integer(t)}catch(n){if(!e.rescue(n,[i(R,"ArgumentError")]))throw n;try{return r.$raise(i(R,"Opal").$type_error(t,i(R,"Integer")))}finally{e.pop_exception()}}},f.$$arity=1),F.$module_function(),e.def(F,"$acos",$=function(e){return i(R,"Math").$checked("acos",i(R,"Math")["$float!"](e))},$.$$arity=1),o(void 0!==Math.acosh)||(Math.acosh=function(e){return Math.log(e+Math.sqrt(e*e-1))}),e.def(F,"$acosh",p=function(e){return i(R,"Math").$checked("acosh",i(R,"Math")["$float!"](e))},p.$$arity=1),e.def(F,"$asin",d=function(e){return i(R,"Math").$checked("asin",i(R,"Math")["$float!"](e))},d.$$arity=1),o(void 0!==Math.asinh)||(Math.asinh=function(e){return Math.log(e+Math.sqrt(e*e+1))}),e.def(F,"$asinh",h=function(e){return i(R,"Math").$checked("asinh",i(R,"Math")["$float!"](e))},h.$$arity=1),e.def(F,"$atan",_=function(e){return i(R,"Math").$checked("atan",i(R,"Math")["$float!"](e))},_.$$arity=1),e.def(F,"$atan2",m=function(e,t){return i(R,"Math").$checked("atan2",i(R,"Math")["$float!"](e),i(R,"Math")["$float!"](t))},m.$$arity=2),o(void 0!==Math.atanh)||(Math.atanh=function(e){return.5*Math.log((1+e)/(1-e))}),e.def(F,"$atanh",y=function(e){return i(R,"Math").$checked("atanh",i(R,"Math")["$float!"](e))},y.$$arity=1),o(void 0!==Math.cbrt)||(Math.cbrt=function(e){if(0==e)return 0;if(e<0)return-Math.cbrt(-e);for(var t=e,r=0;t<.125;)t*=8,r--;for(;t>1;)t*=.125,r++;for(t=(-.46946116*t+1.072302)*t+.3812513;r<0;)t*=.5,r++;for(;r>0;)t*=2,r--;return t=2/3*t+1/3*e/(t*t),t=2/3*t+1/3*e/(t*t),t=2/3*t+1/3*e/(t*t),t=2/3*t+1/3*e/(t*t)}),e.def(F,"$cbrt",g=function(e){return i(R,"Math").$checked("cbrt",i(R,"Math")["$float!"](e))},g.$$arity=1),e.def(F,"$cos",v=function(e){return i(R,"Math").$checked("cos",i(R,"Math")["$float!"](e))},v.$$arity=1),o(void 0!==Math.cosh)||(Math.cosh=function(e){
return(Math.exp(e)+Math.exp(-e))/2}),e.def(F,"$cosh",b=function(e){return i(R,"Math").$checked("cosh",i(R,"Math")["$float!"](e))},b.$$arity=1),o(void 0!==Math.erf)||e.defineProperty(Math,"erf",function(e){var t=1;e<0&&(t=-1),e=Math.abs(e);var r=1/(1+.3275911*e);return t*(1-((((1.061405429*r-1.453152027)*r+1.421413741)*r-.284496736)*r+.254829592)*r*Math.exp(-e*e))}),e.def(F,"$erf",x=function(e){return i(R,"Math").$checked("erf",i(R,"Math")["$float!"](e))},x.$$arity=1),o(void 0!==Math.erfc)||e.defineProperty(Math,"erfc",function(e){var t=Math.abs(e),r=1/(.5*t+1),n=.17087277*r-.82215223,a=r*n+1.48851587,i=r*a-1.13520398,s=r*i+.27886807,o=r*s-.18628806,c=r*o+.09678418,l=r*c+.37409196,u=r*l+1.00002368,f=r*u,$=-t*t-1.26551223+f,p=r*Math.exp($);return e<0?2-p:p}),e.def(F,"$erfc",w=function(e){return i(R,"Math").$checked("erfc",i(R,"Math")["$float!"](e))},w.$$arity=1),e.def(F,"$exp",A=function(e){return i(R,"Math").$checked("exp",i(R,"Math")["$float!"](e))},A.$$arity=1),e.def(F,"$frexp",k=function(e){if(e=i(R,"Math")["$float!"](e),isNaN(e))return[NaN,0];var t=Math.floor(Math.log(Math.abs(e))/Math.log(2))+1;return[e/Math.pow(2,t),t]},k.$$arity=1),e.def(F,"$gamma",E=function(e){var r=this;e=i(R,"Math")["$float!"](e);var n,a,s,o,c,l,u,f,$,p=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22];if(isNaN(e))return NaN;if(0===e&&1/e<0)return-1/0;if(-1!==e&&e!==-1/0||r.$raise(i(R,"DomainError"),'Numerical argument is out of domain - "gamma"'),i(R,"Integer")["$==="](e)){if(e<=0)return isFinite(e)?1/0:NaN;if(e>171)return 1/0;for(o=e-2,c=e-1;o>1;)c*=o,o--;return 0==c&&(c=1),c}if(e<.5)return Math.PI/(Math.sin(Math.PI*e)*i(R,"Math").$gamma(t(1,e)));if(e>=171.35)return 1/0;if(e>85)return l=e*e,u=l*e,f=u*e,$=f*e,Math.sqrt(2*Math.PI/e)*Math.pow(e/Math.E,e)*(1+1/(12*e)+1/(288*l)-139/(51840*u)-571/(2488320*f)+163879/(209018880*$)+5246819/(75246796800*$*e));for(e-=1,s=p[0],n=1;n<p.length;++n)s+=p[n]/(e+n);return a=e+4.7421875+.5,Math.sqrt(2*Math.PI)*Math.pow(a,e+.5)*Math.exp(-a)*s},E.$$arity=1),o(void 0!==Math.hypot)||(Math.hypot=function(e,t){return Math.sqrt(e*e+t*t)}),e.def(F,"$hypot",S=function(e,t){return i(R,"Math").$checked("hypot",i(R,"Math")["$float!"](e),i(R,"Math")["$float!"](t))},S.$$arity=2),e.def(F,"$ldexp",N=function(e,t){var r=this;return e=i(R,"Math")["$float!"](e),t=i(R,"Math")["$integer!"](t),isNaN(t)&&r.$raise(i(R,"RangeError"),"float NaN out of range of integer"),e*Math.pow(2,t)},N.$$arity=2),e.def(F,"$lgamma",C=function(e){return-1==e?[1/0,1]:[Math.log(Math.abs(i(R,"Math").$gamma(e))),i(R,"Math").$gamma(e)<0?-1:1]},C.$$arity=1),e.def(F,"$log",I=function(e,t){var n=this;return o(i(R,"String")["$==="](e))&&n.$raise(i(R,"Opal").$type_error(e,i(R,"Float"))),o(null==t)?i(R,"Math").$checked("log",i(R,"Math")["$float!"](e)):(o(i(R,"String")["$==="](t))&&n.$raise(i(R,"Opal").$type_error(t,i(R,"Float"))),r(i(R,"Math").$checked("log",i(R,"Math")["$float!"](e)),i(R,"Math").$checked("log",i(R,"Math")["$float!"](t))))},I.$$arity=-2),o(void 0!==Math.log10)||(Math.log10=function(e){return Math.log(e)/Math.LN10}),e.def(F,"$log10",O=function(e){var t=this;return o(i(R,"String")["$==="](e))&&t.$raise(i(R,"Opal").$type_error(e,i(R,"Float"))),i(R,"Math").$checked("log10",i(R,"Math")["$float!"](e))},O.$$arity=1),o(void 0!==Math.log2)||(Math.log2=function(e){return Math.log(e)/Math.LN2}),e.def(F,"$log2",L=function(e){var t=this;return o(i(R,"String")["$==="](e))&&t.$raise(i(R,"Opal").$type_error(e,i(R,"Float"))),i(R,"Math").$checked("log2",i(R,"Math")["$float!"](e))},L.$$arity=1),e.def(F,"$sin",P=function(e){return i(R,"Math").$checked("sin",i(R,"Math")["$float!"](e))},P.$$arity=1),o(void 0!==Math.sinh)||(Math.sinh=function(e){return(Math.exp(e)-Math.exp(-e))/2}),e.def(F,"$sinh",M=function(e){return i(R,"Math").$checked("sinh",i(R,"Math")["$float!"](e))},M.$$arity=1),e.def(F,"$sqrt",T=function(e){return i(R,"Math").$checked("sqrt",i(R,"Math")["$float!"](e))},T.$$arity=1),e.def(F,"$tan",B=function(e){return e=i(R,"Math")["$float!"](e),o(e["$infinite?"]())?a(i(R,"Float"),"NAN"):i(R,"Math").$checked("tan",i(R,"Math")["$float!"](e))},B.$$arity=1),o(void 0!==Math.tanh)||(Math.tanh=function(e){return e==1/0?1:e==-1/0?-1:(Math.exp(e)-Math.exp(-e))/(Math.exp(e)+Math.exp(-e))}),e.def(F,"$tanh",j=function(e){return i(R,"Math").$checked("tanh",i(R,"Math")["$float!"](e))},j.$$arity=1)}(n[0],n)},Opal.modules["corelib/complex"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e*t:e["$*"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function a(e,t){return"number"==typeof e&&"number"==typeof t?e/t:e["$/"](t)}function i(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}var s=e.top,o=[],c=e.nil,l=e.const_get_qualified,u=e.const_get_relative,f=(e.breaker,e.slice,e.klass),$=e.truthy,p=e.module;return e.add_stubs(["$require","$===","$real?","$raise","$new","$*","$cos","$sin","$attr_reader","$class","$==","$real","$imag","$Complex","$-@","$+","$__coerced__","$-","$nan?","$/","$conj","$abs2","$quo","$polar","$exp","$log","$>","$!=","$divmod","$**","$hypot","$atan2","$lcm","$denominator","$finite?","$infinite?","$numerator","$abs","$arg","$rationalize","$to_f","$to_i","$to_r","$inspect","$positive?","$zero?","$Rational"]),s.$require("corelib/numeric"),function(s,o,p){var d,h,_,m,y,g,v,b,x,w,A,k,E,S,N,C,I,O,L,P,M,T,B,j,F,R,D,z,q,U,H,G=f(s,o,"Complex"),Y=[G].concat(p);G.$$prototype.real=G.$$prototype.imag=c,e.defs(G,"$rect",d=function(e,t){var r,n,a,i=this;return null==t&&(t=0),$($(r=$(n=$(a=u(Y,"Numeric")["$==="](e))?e["$real?"]():a)?u(Y,"Numeric")["$==="](t):n)?t["$real?"]():r)||i.$raise(u(Y,"TypeError"),"not a real"),i.$new(e,t)},d.$$arity=-2),function(t,r){[t].concat(r);e.alias(t,"rectangular","rect")}(e.get_singleton_class(G),Y),e.defs(G,"$polar",h=function(e,r){var n,a,i,s=this;return null==r&&(r=0),$($(n=$(a=$(i=u(Y,"Numeric")["$==="](e))?e["$real?"]():i)?u(Y,"Numeric")["$==="](r):a)?r["$real?"]():n)||s.$raise(u(Y,"TypeError"),"not a real"),s.$new(t(e,u(Y,"Math").$cos(r)),t(e,u(Y,"Math").$sin(r)))},h.$$arity=-2),G.$attr_reader("real","imag"),e.def(G,"$initialize",_=function(e,t){var r=this;return null==t&&(t=0),r.real=e,r.imag=t},_.$$arity=-2),e.def(G,"$coerce",m=function(e){var t,r=this;return $(u(Y,"Complex")["$==="](e))?[e,r]:$($(t=u(Y,"Numeric")["$==="](e))?e["$real?"]():t)?[u(Y,"Complex").$new(e,0),r]:r.$raise(u(Y,"TypeError"),e.$class()+" can't be coerced into Complex")},m.$$arity=1),e.def(G,"$==",y=function(e){var t,r=this;return $(u(Y,"Complex")["$==="](e))?(t=r.real["$=="](e.$real()))?r.imag["$=="](e.$imag()):r.real["$=="](e.$real()):$($(t=u(Y,"Numeric")["$==="](e))?e["$real?"]():t)?(t=r.real["$=="](e))?r.imag["$=="](0):r.real["$=="](e):e["$=="](r)},y.$$arity=1),e.def(G,"$-@",g=function(){var e=this;return e.$Complex(e.real["$-@"](),e.imag["$-@"]())},g.$$arity=0),e.def(G,"$+",v=function(e){var t,n=this;return $(u(Y,"Complex")["$==="](e))?n.$Complex(r(n.real,e.$real()),r(n.imag,e.$imag())):$($(t=u(Y,"Numeric")["$==="](e))?e["$real?"]():t)?n.$Complex(r(n.real,e),n.imag):n.$__coerced__("+",e)},v.$$arity=1),e.def(G,"$-",b=function(e){var t,r=this;return $(u(Y,"Complex")["$==="](e))?r.$Complex(n(r.real,e.$real()),n(r.imag,e.$imag())):$($(t=u(Y,"Numeric")["$==="](e))?e["$real?"]():t)?r.$Complex(n(r.real,e),r.imag):r.$__coerced__("-",e)},b.$$arity=1),e.def(G,"$*",x=function(e){var a,i=this;return $(u(Y,"Complex")["$==="](e))?i.$Complex(n(t(i.real,e.$real()),t(i.imag,e.$imag())),r(t(i.real,e.$imag()),t(i.imag,e.$real()))):$($(a=u(Y,"Numeric")["$==="](e))?e["$real?"]():a)?i.$Complex(t(i.real,e),t(i.imag,e)):i.$__coerced__("*",e)},x.$$arity=1),e.def(G,"$/",w=function(e){var r,n,i,s,o=this;return $(u(Y,"Complex")["$==="](e))?$($(r=$(n=$(i=$(s=u(Y,"Number")["$==="](o.real))?o.real["$nan?"]():s)?i:$(s=u(Y,"Number")["$==="](o.imag))?o.imag["$nan?"]():s)?n:$(i=u(Y,"Number")["$==="](e.$real()))?e.$real()["$nan?"]():i)?r:$(n=u(Y,"Number")["$==="](e.$imag()))?e.$imag()["$nan?"]():n)?u(Y,"Complex").$new(l(u(Y,"Float"),"NAN"),l(u(Y,"Float"),"NAN")):a(t(o,e.$conj()),e.$abs2()):$($(r=u(Y,"Numeric")["$==="](e))?e["$real?"]():r)?o.$Complex(o.real.$quo(e),o.imag.$quo(e)):o.$__coerced__("/",e)},w.$$arity=1),e.def(G,"$**",A=function(s){var o,l,f,p,d=this,h=c,_=c,m=c,y=c,g=c,v=c,b=c,x=c,w=c,A=c,k=c;if(s["$=="](0))return u(Y,"Complex").$new(1,0);if($(u(Y,"Complex")["$==="](s)))return l=d.$polar(),o=e.to_ary(l),h=null==o[0]?c:o[0],_=null==o[1]?c:o[1],m=s.$real(),y=s.$imag(),g=u(Y,"Math").$exp(n(t(m,u(Y,"Math").$log(h)),t(y,_))),v=r(t(_,m),t(y,u(Y,"Math").$log(h))),u(Y,"Complex").$polar(g,v);if($(u(Y,"Integer")["$==="](s))){if($(i(s,0))){for(b=d,x=b,w=n(s,1);$(w["$!="](0));){for(f=w.$divmod(2),l=e.to_ary(f),A=null==l[0]?c:l[0],k=null==l[1]?c:l[1];k["$=="](0);)b=d.$Complex(n(t(b.$real(),b.$real()),t(b.$imag(),b.$imag())),t(t(2,b.$real()),b.$imag())),w=A,p=w.$divmod(2),f=e.to_ary(p),A=null==f[0]?c:f[0],k=null==f[1]?c:f[1];x=t(x,b),w=n(w,1)}return x}return a(u(Y,"Rational").$new(1,1),d)["$**"](s["$-@"]())}return $($(o=u(Y,"Float")["$==="](s))?o:u(Y,"Rational")["$==="](s))?(l=d.$polar(),o=e.to_ary(l),h=null==o[0]?c:o[0],_=null==o[1]?c:o[1],u(Y,"Complex").$polar(h["$**"](s),t(_,s))):d.$__coerced__("**",s)},A.$$arity=1),e.def(G,"$abs",k=function(){var e=this;return u(Y,"Math").$hypot(e.real,e.imag)},k.$$arity=0),e.def(G,"$abs2",E=function(){var e=this;return r(t(e.real,e.real),t(e.imag,e.imag))},E.$$arity=0),e.def(G,"$angle",S=function(){var e=this;return u(Y,"Math").$atan2(e.imag,e.real)},S.$$arity=0),e.alias(G,"arg","angle"),e.def(G,"$conj",N=function(){var e=this;return e.$Complex(e.real,e.imag["$-@"]())},N.$$arity=0),e.alias(G,"conjugate","conj"),e.def(G,"$denominator",C=function(){var e=this;return e.real.$denominator().$lcm(e.imag.$denominator())},C.$$arity=0),e.alias(G,"divide","/"),e.def(G,"$eql?",I=function(e){var t,r,n=this;return $(t=$(r=u(Y,"Complex")["$==="](e))?n.real.$class()["$=="](n.imag.$class()):r)?n["$=="](e):t},I.$$arity=1),e.def(G,"$fdiv",O=function(e){var t=this;return $(u(Y,"Numeric")["$==="](e))||t.$raise(u(Y,"TypeError"),e.$class()+" can't be coerced into Complex"),a(t,e)},O.$$arity=1),e.def(G,"$finite?",L=function(){var e,t=this;return $(e=t.real["$finite?"]())?t.imag["$finite?"]():e},L.$$arity=0),e.def(G,"$hash",P=function(){var e=this;return"Complex:"+e.real+":"+e.imag},P.$$arity=0),e.alias(G,"imaginary","imag"),e.def(G,"$infinite?",M=function(){var e,t=this;return $(e=t.real["$infinite?"]())?e:t.imag["$infinite?"]()},M.$$arity=0),e.def(G,"$inspect",T=function(){return"("+this+")"},T.$$arity=0),e.alias(G,"magnitude","abs"),e.udef(G,"$negative?"),e.def(G,"$numerator",B=function(){var e=this,r=c;return r=e.$denominator(),e.$Complex(t(e.real.$numerator(),a(r,e.real.$denominator())),t(e.imag.$numerator(),a(r,e.imag.$denominator())))},B.$$arity=0),e.alias(G,"phase","arg"),e.def(G,"$polar",j=function(){var e=this;return[e.$abs(),e.$arg()]},j.$$arity=0),e.udef(G,"$positive?"),e.alias(G,"quo","/"),e.def(G,"$rationalize",F=function(e){var t=this;return arguments.length>1&&t.$raise(u(Y,"ArgumentError"),"wrong number of arguments ("+arguments.length+" for 0..1)"),$(t.imag["$!="](0))&&t.$raise(u(Y,"RangeError"),"can't' convert "+t+" into Rational"),t.$real().$rationalize(e)},F.$$arity=-1),e.def(G,"$real?",R=function(){return!1},R.$$arity=0),e.def(G,"$rect",D=function(){var e=this;return[e.real,e.imag]},D.$$arity=0),e.alias(G,"rectangular","rect"),e.def(G,"$to_f",z=function(){var e=this;return e.imag["$=="](0)||e.$raise(u(Y,"RangeError"),"can't convert "+e+" into Float"),e.real.$to_f()},z.$$arity=0),e.def(G,"$to_i",q=function(){var e=this;return e.imag["$=="](0)||e.$raise(u(Y,"RangeError"),"can't convert "+e+" into Integer"),e.real.$to_i()},q.$$arity=0),e.def(G,"$to_r",U=function(){var e=this;return e.imag["$=="](0)||e.$raise(u(Y,"RangeError"),"can't convert "+e+" into Rational"),e.real.$to_r()},U.$$arity=0),e.def(G,"$to_s",H=function(){var e,t,n,a=this,i=c;return i=a.real.$inspect(),i=r(i,function(){return $($(e=$(t=$(n=u(Y,"Number")["$==="](a.imag))?a.imag["$nan?"]():n)?t:a.imag["$positive?"]())?e:a.imag["$zero?"]())?"+":"-"}()),i=r(i,a.imag.$abs().$inspect()),$($(e=u(Y,"Number")["$==="](a.imag))?$(t=a.imag["$nan?"]())?t:a.imag["$infinite?"]():e)&&(i=r(i,"*")),r(i,"i")},H.$$arity=0),e.const_set(Y[0],"I",G.$new(0,1))}(o[0],u(o,"Numeric"),o),function(t,r){var n,a=p(t,"Kernel"),i=[a].concat(r);e.def(a,"$Complex",n=function(e,t){return null==t&&(t=c),$(t)?u(i,"Complex").$new(e,t):u(i,"Complex").$new(e,0)},n.$$arity=-2)}(o[0],o),function(t,r,n){var a,i=f(t,null,"String");[i].concat(n);return e.def(i,"$to_c",a=function(){function e(){return o.test(s)}function t(){var e=s.match(o),t=e[0];return s=s.slice(t.length),t.replace(/_/g,"")}function r(){if(e()){var r=parseFloat(t());if("/"===s[0]){if(s=s.slice(1),e()){var n=parseFloat(t());return i.$Rational(r,n)}return s="/"+s,r}return r}return null}var n,a,i=this,s=i,o=/[+-]?[\d_]+(\.[\d_]+)?(e\d+)?/;s.match(o);return(n=r())?(a=r(),a?i.$Complex(n,a):"i"===s[0]?i.$Complex(0,n):i.$Complex(n,0)):"i"===s[0]?i.$Complex(0,1):"-"===s[0]&&"i"===s[1]?i.$Complex(0,-1):"+"===s[0]&&"i"===s[1]?i.$Complex(0,1):i.$Complex(0,0)},a.$$arity=0),c&&"to_c"}(o[0],0,o)},Opal.modules["corelib/rational"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e<t:e["$<"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e/t:e["$/"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function a(e,t){return"number"==typeof e&&"number"==typeof t?e*t:e["$*"](t)}function i(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}function s(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}function o(e,t){return"number"==typeof e&&"number"==typeof t?e<=t:e["$<="](t)}var c=e.top,l=[],u=e.nil,f=e.const_get_qualified,$=e.const_get_relative,p=(e.breaker,e.slice,e.klass),d=e.truthy,h=e.module;return e.add_stubs(["$require","$to_i","$==","$raise","$<","$-@","$new","$gcd","$/","$nil?","$===","$reduce","$to_r","$equal?","$!","$coerce_to!","$to_f","$numerator","$denominator","$<=>","$-","$*","$__coerced__","$+","$Rational","$>","$**","$abs","$ceil","$with_precision","$floor","$<=","$truncate","$send","$convert"]),c.$require("corelib/numeric"),function(c,l,h){var _,m,y,g,v,b,x,w,A,k,E,S,N,C,I,O,L,P,M,T,B,j,F,R,D,z,q=p(c,l,"Rational"),U=[q].concat(h);q.$$prototype.num=q.$$prototype.den=u,e.defs(q,"$reduce",_=function(e,n){var a=this,i=u;if(e=e.$to_i(),n=n.$to_i(),n["$=="](0))a.$raise($(U,"ZeroDivisionError"),"divided by 0");else if(d(t(n,0)))e=e["$-@"](),n=n["$-@"]();else if(n["$=="](1))return a.$new(e,n);return i=e.$gcd(n),a.$new(r(e,i),r(n,i))},_.$$arity=2),e.defs(q,"$convert",m=function(e,t){var n,a,i=this;return d(d(n=e["$nil?"]())?n:t["$nil?"]())&&i.$raise($(U,"TypeError"),"cannot convert nil into Rational"),d(d(n=$(U,"Integer")["$==="](e))?$(U,"Integer")["$==="](t):n)?i.$reduce(e,t):(d(d(n=d(a=$(U,"Float")["$==="](e))?a:$(U,"String")["$==="](e))?n:$(U,"Complex")["$==="](e))&&(e=e.$to_r()),d(d(n=d(a=$(U,"Float")["$==="](t))?a:$(U,"String")["$==="](t))?n:$(U,"Complex")["$==="](t))&&(t=t.$to_r()),d(d(n=t["$equal?"](1))?$(U,"Integer")["$==="](e)["$!"]():n)?$(U,"Opal")["$coerce_to!"](e,$(U,"Rational"),"to_r"):d(d(n=$(U,"Numeric")["$==="](e))?$(U,"Numeric")["$==="](t):n)?r(e,t):i.$reduce(e,t))},m.$$arity=2),e.def(q,"$initialize",y=function(e,t){var r=this;return r.num=e,r.den=t},y.$$arity=2),e.def(q,"$numerator",g=function(){return this.num},g.$$arity=0),e.def(q,"$denominator",v=function(){return this.den},v.$$arity=0),e.def(q,"$coerce",b=function(e){var t=this,r=u;return function(){return r=e,$(U,"Rational")["$==="](r)?[e,t]:$(U,"Integer")["$==="](r)?[e.$to_r(),t]:$(U,"Float")["$==="](r)?[e,t.$to_f()]:u}()},b.$$arity=1),e.def(q,"$==",x=function(e){var t,r=this,n=u;return function(){return n=e,$(U,"Rational")["$==="](n)?(t=r.num["$=="](e.$numerator()))?r.den["$=="](e.$denominator()):r.num["$=="](e.$numerator()):$(U,"Integer")["$==="](n)?(t=r.num["$=="](e))?r.den["$=="](1):r.num["$=="](e):$(U,"Float")["$==="](n)?r.$to_f()["$=="](e):e["$=="](r)}()},x.$$arity=1),e.def(q,"$<=>",w=function(e){var t=this,r=u;return function(){return r=e,$(U,"Rational")["$==="](r)?n(a(t.num,e.$denominator()),a(t.den,e.$numerator()))["$<=>"](0):$(U,"Integer")["$==="](r)?n(t.num,a(t.den,e))["$<=>"](0):$(U,"Float")["$==="](r)?t.$to_f()["$<=>"](e):t.$__coerced__("<=>",e)}()},w.$$arity=1),e.def(q,"$+",A=function(e){var t=this,r=u,n=u,s=u;return function(){return r=e,$(U,"Rational")["$==="](r)?(n=i(a(t.num,e.$denominator()),a(t.den,e.$numerator())),s=a(t.den,e.$denominator()),t.$Rational(n,s)):$(U,"Integer")["$==="](r)?t.$Rational(i(t.num,a(e,t.den)),t.den):$(U,"Float")["$==="](r)?i(t.$to_f(),e):t.$__coerced__("+",e)}()},A.$$arity=1),e.def(q,"$-",k=function(e){var t=this,r=u,i=u,s=u;return function(){return r=e,$(U,"Rational")["$==="](r)?(i=n(a(t.num,e.$denominator()),a(t.den,e.$numerator())),s=a(t.den,e.$denominator()),t.$Rational(i,s)):$(U,"Integer")["$==="](r)?t.$Rational(n(t.num,a(e,t.den)),t.den):$(U,"Float")["$==="](r)?n(t.$to_f(),e):t.$__coerced__("-",e)}()},k.$$arity=1),e.def(q,"$*",E=function(e){var t=this,r=u,n=u,i=u;return function(){return r=e,$(U,"Rational")["$==="](r)?(n=a(t.num,e.$numerator()),i=a(t.den,e.$denominator()),t.$Rational(n,i)):$(U,"Integer")["$==="](r)?t.$Rational(a(t.num,e),t.den):$(U,"Float")["$==="](r)?a(t.$to_f(),e):t.$__coerced__("*",e)}()},E.$$arity=1),e.def(q,"$/",S=function(e){var t=this,n=u,i=u,s=u;return function(){return n=e,$(U,"Rational")["$==="](n)?(i=a(t.num,e.$denominator()),s=a(t.den,e.$numerator()),t.$Rational(i,s)):$(U,"Integer")["$==="](n)?e["$=="](0)?r(t.$to_f(),0):t.$Rational(t.num,a(t.den,e)):$(U,"Float")["$==="](n)?r(t.$to_f(),e):t.$__coerced__("/",e)}()},S.$$arity=1),e.def(q,"$**",N=function(e){var r,n=this,a=u;return function(){return a=e,$(U,"Integer")["$==="](a)?d((r=n["$=="](0))?t(e,0):n["$=="](0))?f($(U,"Float"),"INFINITY"):d(s(e,0))?n.$Rational(n.num["$**"](e),n.den["$**"](e)):d(t(e,0))?n.$Rational(n.den["$**"](e["$-@"]()),n.num["$**"](e["$-@"]())):n.$Rational(1,1):$(U,"Float")["$==="](a)?n.$to_f()["$**"](e):$(U,"Rational")["$==="](a)?e["$=="](0)?n.$Rational(1,1):e.$denominator()["$=="](1)?d(t(e,0))?n.$Rational(n.den["$**"](e.$numerator().$abs()),n.num["$**"](e.$numerator().$abs())):n.$Rational(n.num["$**"](e.$numerator()),n.den["$**"](e.$numerator())):d((r=n["$=="](0))?t(e,0):n["$=="](0))?n.$raise($(U,"ZeroDivisionError"),"divided by 0"):n.$to_f()["$**"](e):n.$__coerced__("**",e)}()},N.$$arity=1),e.def(q,"$abs",C=function(){var e=this;return e.$Rational(e.num.$abs(),e.den.$abs())},C.$$arity=0),e.def(q,"$ceil",I=function(e){var t=this;return null==e&&(e=0),e["$=="](0)?r(t.num["$-@"](),t.den)["$-@"]().$ceil():t.$with_precision("ceil",e)},I.$$arity=-1),e.alias(q,"divide","/"),e.def(q,"$floor",O=function(e){var t=this;return null==e&&(e=0),e["$=="](0)?r(t.num["$-@"](),t.den)["$-@"]().$floor():t.$with_precision("floor",e)},O.$$arity=-1),e.def(q,"$hash",L=function(){var e=this;return"Rational:"+e.num+":"+e.den},L.$$arity=0),e.def(q,"$inspect",P=function(){return"("+this+")"},P.$$arity=0),e.alias(q,"quo","/"),e.def(q,"$rationalize",M=function(e){var t=this;if(arguments.length>1&&t.$raise($(U,"ArgumentError"),"wrong number of arguments ("+arguments.length+" for 0..1)"),null==e)return t;for(var a,s,c,l,u,f=e.$abs(),p=n(t,f),d=i(t,f),h=0,_=1,m=1,y=0;;){if(c=p.$ceil(),o(c,d))break;l=c-1,a=l*_+h,s=l*y+m,u=r(1,n(d,l)),d=r(1,n(p,l)),p=u,h=_,m=y,_=a,y=s}return t.$Rational(c*_+h,c*y+m)},M.$$arity=-1),e.def(q,"$round",T=function(e){var n=this,s=u,o=u,c=u;return null==e&&(e=0),e["$=="](0)?n.num["$=="](0)?0:n.den["$=="](1)?n.num:(s=i(a(n.num.$abs(),2),n.den),o=a(n.den,2),c=r(s,o).$truncate(),d(t(n.num,0))?c["$-@"]():c):n.$with_precision("round",e)},T.$$arity=-1),e.def(q,"$to_f",B=function(){var e=this;return r(e.num,e.den)},B.$$arity=0),e.def(q,"$to_i",j=function(){return this.$truncate()},j.$$arity=0),e.def(q,"$to_r",F=function(){return this},F.$$arity=0),e.def(q,"$to_s",R=function(){var e=this;return e.num+"/"+e.den},R.$$arity=0),e.def(q,"$truncate",D=function(e){var r=this;return null==e&&(e=0),e["$=="](0)?d(t(r.num,0))?r.$ceil():r.$floor():r.$with_precision("truncate",e)},D.$$arity=-1),e.def(q,"$with_precision",z=function(e,n){var i=this,s=u,o=u;return d($(U,"Integer")["$==="](n))||i.$raise($(U,"TypeError"),"not an Integer"),s=10["$**"](n),o=a(i,s),d(t(n,1))?r(o.$send(e),s).$to_i():i.$Rational(o.$send(e),s)},z.$$arity=2)}(l[0],$(l,"Numeric"),l),function(t,r){var n,a=h(t,"Kernel"),i=[a].concat(r);e.def(a,"$Rational",n=function(e,t){return null==t&&(t=1),$(i,"Rational").$convert(e,t)},n.$$arity=-2)}(l[0],l),function(t,r,n){var a,i=p(t,null,"String");[i].concat(n);return e.def(i,"$to_r",a=function(){function e(){return s.test(i)}function t(){var e=i.match(s),t=e[0];return i=i.slice(t.length),t.replace(/_/g,"")}var r,n,a=this,i=a.trimLeft(),s=/^[+-]?[\d_]+(\.[\d_]+)?/;i.match(s);return e()?(r=parseFloat(t()),"/"===i[0]?(i=i.slice(1),e()?(n=parseFloat(t()),a.$Rational(r,n)):a.$Rational(r,1)):a.$Rational(r,1)):a.$Rational(0,1)},a.$$arity=0),u&&"to_r"}(l[0],0,l)},Opal.modules["corelib/time"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e<t:e["$<"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}function a(e,t){return"number"==typeof e&&"number"==typeof t?e/t:e["$/"](t)}function i(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function s(e,t){return"number"==typeof e&&"number"==typeof t?e<=t:e["$<="](t)}var o=e.top,c=[],l=e.nil,u=(e.const_get_qualified,e.const_get_relative),f=(e.breaker,e.slice),$=e.klass,p=e.truthy,d=e.range;return e.add_stubs(["$require","$include","$===","$raise","$coerce_to!","$respond_to?","$to_str","$to_i","$new","$<=>","$to_f","$nil?","$>","$<","$strftime","$year","$month","$day","$+","$round","$/","$-","$copy_instance_variables","$initialize_dup","$is_a?","$zero?","$wday","$utc?","$mon","$yday","$hour","$min","$sec","$rjust","$ljust","$zone","$to_s","$[]","$cweek_cyear","$isdst","$<=","$!=","$==","$ceil"]),o.$require("corelib/comparable"),function(o,c,h){function _(e,t,r,n,a,i){if(e=e.$$is_string?parseInt(e,10):u(se,"Opal")["$coerce_to!"](e,u(se,"Integer"),"to_int"),t===l)t=1;else if(!t.$$is_number)if(t["$respond_to?"]("to_str"))switch(t=t.$to_str(),t.toLowerCase()){case"jan":t=1;break;case"feb":t=2;break;case"mar":t=3;break;case"apr":t=4;break;case"may":t=5;break;case"jun":t=6;break;case"jul":t=7;break;case"aug":t=8;break;case"sep":t=9;break;case"oct":t=10;break;case"nov":t=11;break;case"dec":t=12;break;default:t=t.$to_i()}else t=u(se,"Opal")["$coerce_to!"](t,u(se,"Integer"),"to_int");return(t<1||t>12)&&ie.$raise(u(se,"ArgumentError"),"month out of range: "+t),t-=1,r=r===l?1:r.$$is_string?parseInt(r,10):u(se,"Opal")["$coerce_to!"](r,u(se,"Integer"),"to_int"),(r<1||r>31)&&ie.$raise(u(se,"ArgumentError"),"day out of range: "+r),n=n===l?0:n.$$is_string?parseInt(n,10):u(se,"Opal")["$coerce_to!"](n,u(se,"Integer"),"to_int"),(n<0||n>24)&&ie.$raise(u(se,"ArgumentError"),"hour out of range: "+n),a=a===l?0:a.$$is_string?parseInt(a,10):u(se,"Opal")["$coerce_to!"](a,u(se,"Integer"),"to_int"),(a<0||a>59)&&ie.$raise(u(se,"ArgumentError"),"min out of range: "+a),i===l?i=0:i.$$is_number||(i=i.$$is_string?parseInt(i,10):u(se,"Opal")["$coerce_to!"](i,u(se,"Integer"),"to_int")),(i<0||i>60)&&ie.$raise(u(se,"ArgumentError"),"sec out of range: "+i),[e,t,r,n,a,i]}var m,y,g,v,b,x,w,A,k,E,S,N,C,I,O,L,P,M,T,B,j,F,R,D,z,q,U,H,G,Y,V,Q,X,W,J,K,Z,ee,te,re,ne,ae,ie=$(o,c,"Time"),se=[ie].concat(h);ie.$include(u(se,"Comparable"));var oe=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],ce=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],le=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],ue=["January","February","March","April","May","June","July","August","September","October","November","December"];return e.defs(ie,"$at",m=function(e,t){var r,n=this;return u(se,"Time")["$==="](e)?(void 0!==t&&n.$raise(u(se,"TypeError"),"can't convert Time into an exact number"),r=new Date(e.getTime()),r.is_utc=e.is_utc,r):(e.$$is_number||(e=u(se,"Opal")["$coerce_to!"](e,u(se,"Integer"),"to_int")),void 0===t?new Date(1e3*e):(t.$$is_number||(t=u(se,"Opal")["$coerce_to!"](t,u(se,"Integer"),"to_int")),new Date(1e3*e+t/1e3)))},m.$$arity=-2),e.defs(ie,"$new",y=function(e,t,r,n,a,i,s){var o=this;null==t&&(t=l),null==r&&(r=l),null==n&&(n=l),null==a&&(a=l),null==i&&(i=l),null==s&&(s=l);var c,f;return void 0===e?new Date:(s!==l&&o.$raise(u(se,"ArgumentError"),"Opal does not support explicitly specifying UTC offset for Time"),c=_(e,t,r,n,a,i),e=c[0],t=c[1],r=c[2],n=c[3],a=c[4],i=c[5],f=new Date(e,t,r,n,a,0,1e3*i),e<100&&f.setFullYear(e),f)},y.$$arity=-1),e.defs(ie,"$local",g=function(e,t,r,n,a,i,s,o,c,u){null==t&&(t=l),null==r&&(r=l),null==n&&(n=l),null==a&&(a=l),null==i&&(i=l),null==s&&(s=l),null==o&&(o=l),null==c&&(c=l),null==u&&(u=l);var $,p;return 10===arguments.length&&($=f.call(arguments),e=$[5],t=$[4],r=$[3],n=$[2],a=$[1],i=$[0]),$=_(e,t,r,n,a,i),e=$[0],t=$[1],r=$[2],n=$[3],a=$[4],i=$[5],p=new Date(e,t,r,n,a,0,1e3*i),e<100&&p.setFullYear(e),p},g.$$arity=-2),e.defs(ie,"$gm",v=function(e,t,r,n,a,i,s,o,c,u){null==t&&(t=l),null==r&&(r=l),null==n&&(n=l),null==a&&(a=l),null==i&&(i=l),null==s&&(s=l),null==o&&(o=l),null==c&&(c=l),null==u&&(u=l);var $,p;return 10===arguments.length&&($=f.call(arguments),e=$[5],t=$[4],r=$[3],n=$[2],a=$[1],i=$[0]),$=_(e,t,r,n,a,i),e=$[0],t=$[1],r=$[2],n=$[3],a=$[4],i=$[5],p=new Date(Date.UTC(e,t,r,n,a,0,1e3*i)),e<100&&p.setUTCFullYear(e),p.is_utc=!0,p},v.$$arity=-2),function(t,r){[t].concat(r);e.alias(t,"mktime","local"),e.alias(t,"utc","gm")}(e.get_singleton_class(ie),se),e.defs(ie,"$now",b=function(){return this.$new()},b.$$arity=0),e.def(ie,"$+",x=function(e){var t=this;p(u(se,"Time")["$==="](e))&&t.$raise(u(se,"TypeError"),"time + time?"),e.$$is_number||(e=u(se,"Opal")["$coerce_to!"](e,u(se,"Integer"),"to_int"));var r=new Date(t.getTime()+1e3*e);return r.is_utc=t.is_utc,r},x.$$arity=1),e.def(ie,"$-",w=function(e){var t=this;if(p(u(se,"Time")["$==="](e)))return(t.getTime()-e.getTime())/1e3;e.$$is_number||(e=u(se,"Opal")["$coerce_to!"](e,u(se,"Integer"),"to_int"));var r=new Date(t.getTime()-1e3*e);return r.is_utc=t.is_utc,r},w.$$arity=1),e.def(ie,"$<=>",A=function(e){var n=this,a=l;return p(u(se,"Time")["$==="](e))?n.$to_f()["$<=>"](e.$to_f()):(a=e["$<=>"](n),p(a["$nil?"]())?l:p(t(a,0))?-1:p(r(a,0))?1:0)},A.$$arity=1),e.def(ie,"$==",k=function(e){var t,r=this;return p(t=u(se,"Time")["$==="](e))?r.$to_f()===e.$to_f():t},k.$$arity=1),e.def(ie,"$asctime",E=function(){return this.$strftime("%a %b %e %H:%M:%S %Y")},E.$$arity=0),e.alias(ie,"ctime","asctime"),e.def(ie,"$day",S=function(){var e=this;return e.is_utc?e.getUTCDate():e.getDate()},S.$$arity=0),e.def(ie,"$yday",N=function(){var e=this,t=l,r=l,s=l;return t=u(se,"Time").$new(e.$year()).$to_i(),r=u(se,"Time").$new(e.$year(),e.$month(),e.$day()).$to_i(),s=86400,n(a(i(r,t),s).$round(),1)},N.$$arity=0),e.def(ie,"$isdst",C=function(){var e=this,t=new Date(e.getFullYear(),0,1),r=new Date(e.getFullYear(),6,1);return e.getTimezoneOffset()<Math.max(t.getTimezoneOffset(),r.getTimezoneOffset())},C.$$arity=0),e.alias(ie,"dst?","isdst"),e.def(ie,"$dup",I=function(){var e=this,t=l;return t=new Date(e.getTime()),t.$copy_instance_variables(e),t.$initialize_dup(e),t},I.$$arity=0),e.def(ie,"$eql?",O=function(e){var t,r=this;return p(t=e["$is_a?"](u(se,"Time")))?r["$<=>"](e)["$zero?"]():t},O.$$arity=1),e.def(ie,"$friday?",L=function(){return 5==this.$wday()},L.$$arity=0),e.def(ie,"$hash",P=function(){return"Time:"+this.getTime()},P.$$arity=0),e.def(ie,"$hour",M=function(){var e=this;return e.is_utc?e.getUTCHours():e.getHours()},M.$$arity=0),e.def(ie,"$inspect",T=function(){var e=this;return p(e["$utc?"]())?e.$strftime("%Y-%m-%d %H:%M:%S UTC"):e.$strftime("%Y-%m-%d %H:%M:%S %z")},T.$$arity=0),e.alias(ie,"mday","day"),e.def(ie,"$min",B=function(){var e=this;return e.is_utc?e.getUTCMinutes():e.getMinutes()},B.$$arity=0),e.def(ie,"$mon",j=function(){var e=this;return(e.is_utc?e.getUTCMonth():e.getMonth())+1},j.$$arity=0),e.def(ie,"$monday?",F=function(){return 1==this.$wday()},F.$$arity=0),e.alias(ie,"month","mon"),e.def(ie,"$saturday?",R=function(){return 6==this.$wday()},R.$$arity=0),e.def(ie,"$sec",D=function(){var e=this;return e.is_utc?e.getUTCSeconds():e.getSeconds()},D.$$arity=0),e.def(ie,"$succ",z=function(){var e=this,t=new Date(e.getTime()+1e3);return t.is_utc=e.is_utc,t},z.$$arity=0),e.def(ie,"$usec",q=function(){return 1e3*this.getMilliseconds()},q.$$arity=0),e.def(ie,"$zone",U=function(){var e,t=this,r=t.toString();return e=-1==r.indexOf("(")?r.match(/[A-Z]{3,4}/)[0]:r.match(/\((.+)\)(?:\s|$)/)[1],"GMT"==e&&/(GMT\W*\d{4})/.test(r)?RegExp.$1:e},U.$$arity=0),e.def(ie,"$getgm",H=function(){var e=this,t=new Date(e.getTime());return t.is_utc=!0,t},H.$$arity=0),e.alias(ie,"getutc","getgm"),e.def(ie,"$gmtime",G=function(){var e=this;return e.is_utc=!0,e},G.$$arity=0),e.alias(ie,"utc","gmtime"),e.def(ie,"$gmt?",Y=function(){return!0===this.is_utc},Y.$$arity=0),e.def(ie,"$gmt_offset",V=function(){var e=this;return e.is_utc?0:60*-e.getTimezoneOffset()},V.$$arity=0),e.def(ie,"$strftime",Q=function(e){var t=this;return e.replace(/%([\-_#^0]*:{0,2})(\d+)?([EO]*)(.)/g,function(e,r,n,a,i){var s="",o=-1!==r.indexOf("0"),c=-1===r.indexOf("-"),l=-1!==r.indexOf("_"),u=-1!==r.indexOf("^"),f=-1!==r.indexOf("#"),$=(r.match(":")||[]).length;switch(n=parseInt(n,10),o&&l&&(r.indexOf("0")<r.indexOf("_")?o=!1:l=!1),i){case"Y":s+=t.$year();break;case"C":o=!l,s+=Math.round(t.$year()/100);break;case"y":o=!l,s+=t.$year()%100;break;case"m":o=!l,s+=t.$mon();break;case"B":s+=ue[t.$mon()-1];break;case"b":case"h":l=!o,s+=le[t.$mon()-1];break;case"d":o=!l,s+=t.$day();break;case"e":l=!o,s+=t.$day();break;case"j":s+=t.$yday();break;case"H":o=!l,s+=t.$hour();break;case"k":l=!o,s+=t.$hour();break;case"I":o=!l,s+=t.$hour()%12||12;break;case"l":l=!o,s+=t.$hour()%12||12;break;case"P":s+=t.$hour()>=12?"pm":"am";break;case"p":s+=t.$hour()>=12?"PM":"AM";break;case"M":o=!l,s+=t.$min();break;case"S":o=!l,s+=t.$sec();break;case"L":o=!l,n=isNaN(n)?3:n,s+=t.getMilliseconds();break;case"N":n=isNaN(n)?9:n,s+=t.getMilliseconds().toString().$rjust(3,"0"),s=s.$ljust(n,"0");break;case"z":var p=t.getTimezoneOffset(),h=Math.floor(Math.abs(p)/60),_=Math.abs(p)%60;s+=p<0?"+":"-",s+=h<10?"0":"",s+=h,$>0&&(s+=":"),s+=_<10?"0":"",s+=_,$>1&&(s+=":00");break;case"Z":s+=t.$zone();break;case"A":s+=oe[t.$wday()];break;case"a":s+=ce[t.$wday()];break;case"u":s+=t.$wday()+1;break;case"w":s+=t.$wday();break;case"V":s+=t.$cweek_cyear()["$[]"](0).$to_s().$rjust(2,"0");break;case"G":s+=t.$cweek_cyear()["$[]"](1);break;case"g":s+=t.$cweek_cyear()["$[]"](1)["$[]"](d(-2,-1,!1));break;case"s":s+=t.$to_i();break;case"n":s+="\n";break;case"t":s+="\t";break;case"%":s+="%";break;case"c":s+=t.$strftime("%a %b %e %T %Y");break;case"D":case"x":s+=t.$strftime("%m/%d/%y");break;case"F":s+=t.$strftime("%Y-%m-%d");break;case"v":s+=t.$strftime("%e-%^b-%4Y");break;case"r":s+=t.$strftime("%I:%M:%S %p");break;case"R":s+=t.$strftime("%H:%M");break;case"T":case"X":s+=t.$strftime("%H:%M:%S");break;default:return e}return u&&(s=s.toUpperCase()),f&&(s=s.replace(/[A-Z]/,function(e){e.toLowerCase()}).replace(/[a-z]/,function(e){e.toUpperCase()})),c&&(o||l)&&(s=s.$rjust(isNaN(n)?2:n,l?" ":"0")),s})},Q.$$arity=1),e.def(ie,"$sunday?",X=function(){return 0==this.$wday()},X.$$arity=0),e.def(ie,"$thursday?",W=function(){return 4==this.$wday()},W.$$arity=0),e.def(ie,"$to_a",J=function(){var e=this
;return[e.$sec(),e.$min(),e.$hour(),e.$day(),e.$month(),e.$year(),e.$wday(),e.$yday(),e.$isdst(),e.$zone()]},J.$$arity=0),e.def(ie,"$to_f",K=function(){return this.getTime()/1e3},K.$$arity=0),e.def(ie,"$to_i",Z=function(){var e=this;return parseInt(e.getTime()/1e3,10)},Z.$$arity=0),e.alias(ie,"to_s","inspect"),e.def(ie,"$tuesday?",ee=function(){return 2==this.$wday()},ee.$$arity=0),e.alias(ie,"tv_sec","to_i"),e.alias(ie,"tv_usec","usec"),e.alias(ie,"utc?","gmt?"),e.alias(ie,"gmtoff","gmt_offset"),e.alias(ie,"utc_offset","gmt_offset"),e.def(ie,"$wday",te=function(){var e=this;return e.is_utc?e.getUTCDay():e.getDay()},te.$$arity=0),e.def(ie,"$wednesday?",re=function(){return 3==this.$wday()},re.$$arity=0),e.def(ie,"$year",ne=function(){var e=this;return e.is_utc?e.getUTCFullYear():e.getFullYear()},ne.$$arity=0),e.def(ie,"$cweek_cyear",ae=function(){var e,t=this,r=l,o=l,c=l,f=l,$=l,d=l,h=l;return r=u(se,"Time").$new(t.$year(),1,1),o=r.$wday(),0,c=t.$year(),p(p(e=s(o,4))?o["$!="](0):e)?f=i(o,1):(f=i(i(o,7),1),f["$=="](-8)&&(f=-1)),$=a(n(t.$yday(),f),7).$ceil(),p(s($,0))?u(se,"Time").$new(i(t.$year(),1),12,31).$cweek_cyear():($["$=="](53)&&(d=u(se,"Time").$new(t.$year(),12,31),h=d.$wday(),p(p(e=s(h,3))?h["$!="](0):e)&&($=1,c=n(c,1))),[$,c])},ae.$$arity=0),l&&"cweek_cyear"}(c[0],Date,c)},Opal.modules["corelib/struct"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e<t:e["$<"](t)}function a(e,t){return"number"==typeof e&&"number"==typeof t?e>=t:e["$>="](t)}function i(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}var s=e.top,o=[],c=e.nil,l=(e.const_get_qualified,e.const_get_relative),u=(e.breaker,e.slice,e.klass),f=e.hash2,$=e.truthy,p=e.send;return e.add_stubs(["$require","$include","$const_name!","$unshift","$map","$coerce_to!","$new","$each","$define_struct_attribute","$allocate","$initialize","$alias_method","$module_eval","$to_proc","$const_set","$==","$raise","$<<","$members","$define_method","$instance_eval","$class","$last","$>","$length","$-","$keys","$any?","$join","$[]","$[]=","$each_with_index","$hash","$===","$<","$-@","$size","$>=","$include?","$to_sym","$instance_of?","$__id__","$eql?","$enum_for","$name","$+","$each_pair","$inspect","$each_with_object","$flatten","$to_a","$respond_to?","$dig"]),s.$require("corelib/enumerable"),function(s,o,d){var h,_,m,y,g,v,b,x,w,A,k,E,S,N,C,I,O,L,P,M=u(s,null,"Struct"),T=[M].concat(d);return M.$include(l(T,"Enumerable")),e.defs(M,"$new",h=function(t,r,n){var a,i,s,o,u,d,_=h.$$p,m=_||c,y=this,g=c;if(_&&(h.$$p=null),_&&(h.$$p=null),a=e.slice.call(arguments,1,arguments.length),null==(i=e.extract_kwargs(a)))i=f([],{});else if(!i.$$is_hash)throw e.ArgumentError.$new("expected kwargs");if(s=a,o=i.$$smap.keyword_init,null==o&&(o=!1),$(t))try{t=l(T,"Opal")["$const_name!"](t)}catch(r){if(!e.rescue(r,[l(T,"TypeError"),l(T,"NameError")]))throw r;try{s.$unshift(t),t=c}finally{e.pop_exception()}}return p(s,"map",[],(u=function(e){u.$$s;return null==e&&(e=c),l(T,"Opal")["$coerce_to!"](e,l(T,"String"),"to_str")},u.$$s=y,u.$$arity=1,u)),g=p(l(T,"Class"),"new",[y],(d=function(){var t,r=d.$$s||this;return p(s,"each",[],(t=function(e){var r=t.$$s||this;return null==e&&(e=c),r.$define_struct_attribute(e)},t.$$s=r,t.$$arity=1,t)),function(t,r){var n;[t].concat(r);return e.def(t,"$new",n=function(t){var r,n,a=this,i=c;return r=e.slice.call(arguments,0,arguments.length),n=r,i=a.$allocate(),i.$$data={},p(i,"initialize",e.to_a(n)),i},n.$$arity=-1),t.$alias_method("[]","new")}(e.get_singleton_class(r),T)},d.$$s=y,d.$$arity=0,d)),$(m)&&p(g,"module_eval",[],m.$to_proc()),g.$$keyword_init=o,$(t)&&l(T,"Struct").$const_set(t,g),g},h.$$arity=-2),e.defs(M,"$define_struct_attribute",_=function(e){var t,r,n=this;return n["$=="](l(T,"Struct"))&&n.$raise(l(T,"ArgumentError"),"you cannot define attributes to the Struct class"),n.$members()["$<<"](e),p(n,"define_method",[e],(t=function(){return(t.$$s||this).$$data[e]},t.$$s=n,t.$$arity=0,t)),p(n,"define_method",[e+"="],(r=function(t){var n=r.$$s||this;return null==t&&(t=c),n.$$data[e]=t},r.$$s=n,r.$$arity=1,r))},_.$$arity=1),e.defs(M,"$members",m=function(){var e,t=this;return null==t.members&&(t.members=c),t["$=="](l(T,"Struct"))&&t.$raise(l(T,"ArgumentError"),"the Struct class has no members"),t.members=$(e=t.members)?e:[]},m.$$arity=0),e.defs(M,"$inherited",y=function(e){var t,r=this,n=c;return null==r.members&&(r.members=c),n=r.members,p(e,"instance_eval",[],(t=function(){return(t.$$s||this).members=n},t.$$s=r,t.$$arity=0,t))},y.$$arity=1),e.def(M,"$initialize",g=function(n){var a,i,s,o,u,d=this,h=c,_=c;return a=e.slice.call(arguments,0,arguments.length),i=a,$(d.$class().$$keyword_init)?(h=$(s=i.$last())?s:f([],{}),$($(s=t(i.$length(),1))?s:1===i.length&&!h.$$is_hash)&&d.$raise(l(T,"ArgumentError"),"wrong number of arguments (given "+i.$length()+", expected 0)"),_=r(h.$keys(),d.$class().$members()),$(_["$any?"]())&&d.$raise(l(T,"ArgumentError"),"unknown keywords: "+_.$join(", ")),p(d.$class().$members(),"each",[],(o=function(t){var n=o.$$s||this,a=c;return null==t&&(t=c),a=[t,h["$[]"](t)],p(n,"[]=",e.to_a(a)),a[r(a.length,1)]},o.$$s=d,o.$$arity=1,o))):($(t(i.$length(),d.$class().$members().$length()))&&d.$raise(l(T,"ArgumentError"),"struct size differs"),p(d.$class().$members(),"each_with_index",[],(u=function(t,n){var a=u.$$s||this,s=c;return null==t&&(t=c),null==n&&(n=c),s=[t,i["$[]"](n)],p(a,"[]=",e.to_a(s)),s[r(s.length,1)]},u.$$s=d,u.$$arity=2,u)))},g.$$arity=-1),e.def(M,"$members",v=function(){return this.$class().$members()},v.$$arity=0),e.def(M,"$hash",b=function(){var e=this;return l(T,"Hash").$new(e.$$data).$hash()},b.$$arity=0),e.def(M,"$[]",x=function(e){var t=this;return $(l(T,"Integer")["$==="](e))?($(n(e,t.$class().$members().$size()["$-@"]()))&&t.$raise(l(T,"IndexError"),"offset "+e+" too small for struct(size:"+t.$class().$members().$size()+")"),$(a(e,t.$class().$members().$size()))&&t.$raise(l(T,"IndexError"),"offset "+e+" too large for struct(size:"+t.$class().$members().$size()+")"),e=t.$class().$members()["$[]"](e)):$(l(T,"String")["$==="](e))?t.$$data.hasOwnProperty(e)||t.$raise(l(T,"NameError").$new("no member '"+e+"' in struct",e)):t.$raise(l(T,"TypeError"),"no implicit conversion of "+e.$class()+" into Integer"),e=l(T,"Opal")["$coerce_to!"](e,l(T,"String"),"to_str"),t.$$data[e]},x.$$arity=1),e.def(M,"$[]=",w=function(e,t){var r=this;return $(l(T,"Integer")["$==="](e))?($(n(e,r.$class().$members().$size()["$-@"]()))&&r.$raise(l(T,"IndexError"),"offset "+e+" too small for struct(size:"+r.$class().$members().$size()+")"),$(a(e,r.$class().$members().$size()))&&r.$raise(l(T,"IndexError"),"offset "+e+" too large for struct(size:"+r.$class().$members().$size()+")"),e=r.$class().$members()["$[]"](e)):$(l(T,"String")["$==="](e))?$(r.$class().$members()["$include?"](e.$to_sym()))||r.$raise(l(T,"NameError").$new("no member '"+e+"' in struct",e)):r.$raise(l(T,"TypeError"),"no implicit conversion of "+e.$class()+" into Integer"),e=l(T,"Opal")["$coerce_to!"](e,l(T,"String"),"to_str"),r.$$data[e]=t},w.$$arity=2),e.def(M,"$==",A=function(e){function t(e,r){var i,s,o;n[e.$__id__()]=!0,a[r.$__id__()]=!0;for(i in e.$$data)if(s=e.$$data[i],o=r.$$data[i],l(T,"Struct")["$==="](s)){if(!(n.hasOwnProperty(s.$__id__())&&a.hasOwnProperty(o.$__id__())||t(s,o)))return!1}else if(!s["$=="](o))return!1;return!0}var r=this;if(!$(e["$instance_of?"](r.$class())))return!1;var n={},a={};return t(r,e)},A.$$arity=1),e.def(M,"$eql?",k=function(e){function t(e,r){var i,s,o;n[e.$__id__()]=!0,a[r.$__id__()]=!0;for(i in e.$$data)if(s=e.$$data[i],o=r.$$data[i],l(T,"Struct")["$==="](s)){if(!(n.hasOwnProperty(s.$__id__())&&a.hasOwnProperty(o.$__id__())||t(s,o)))return!1}else if(!s["$eql?"](o))return!1;return!0}var r=this;if(!$(e["$instance_of?"](r.$class())))return!1;var n={},a={};return t(r,e)},k.$$arity=1),e.def(M,"$each",E=function(){var t,r,n=E.$$p,a=n||c,i=this;return n&&(E.$$p=null),a===c?p(i,"enum_for",["each"],(t=function(){return(t.$$s||this).$size()},t.$$s=i,t.$$arity=0,t)):(p(i.$class().$members(),"each",[],(r=function(t){var n=r.$$s||this;return null==t&&(t=c),e.yield1(a,n["$[]"](t))},r.$$s=i,r.$$arity=1,r)),i)},E.$$arity=0),e.def(M,"$each_pair",S=function(){var t,r,n=S.$$p,a=n||c,i=this;return n&&(S.$$p=null),a===c?p(i,"enum_for",["each_pair"],(t=function(){return(t.$$s||this).$size()},t.$$s=i,t.$$arity=0,t)):(p(i.$class().$members(),"each",[],(r=function(t){var n=r.$$s||this;return null==t&&(t=c),e.yield1(a,[t,n["$[]"](t)])},r.$$s=i,r.$$arity=1,r)),i)},S.$$arity=0),e.def(M,"$length",N=function(){return this.$class().$members().$length()},N.$$arity=0),e.alias(M,"size","length"),e.def(M,"$to_a",C=function(){var e,t=this;return p(t.$class().$members(),"map",[],(e=function(t){var r=e.$$s||this;return null==t&&(t=c),r["$[]"](t)},e.$$s=t,e.$$arity=1,e))},C.$$arity=0),e.alias(M,"values","to_a"),e.def(M,"$inspect",I=function(){var e,t,r=this,n=c;return n="#<struct ",$($(e=l(T,"Struct")["$==="](r))?r.$class().$name():e)&&(n=i(n,r.$class()+" ")),n=i(n,p(r.$each_pair(),"map",[],(t=function(e,r){t.$$s;return null==e&&(e=c),null==r&&(r=c),e+"="+r.$inspect()},t.$$s=r,t.$$arity=2,t)).$join(", ")),n=i(n,">")},I.$$arity=0),e.alias(M,"to_s","inspect"),e.def(M,"$to_h",O=function(){var t,n=this;return p(n.$class().$members(),"each_with_object",[f([],{})],(t=function(n,a){var i=t.$$s||this,s=c;return null==n&&(n=c),null==a&&(a=c),s=[n,i["$[]"](n)],p(a,"[]=",e.to_a(s)),s[r(s.length,1)]},t.$$s=n,t.$$arity=2,t))},O.$$arity=0),e.def(M,"$values_at",L=function(t){var r,n,a,i=this;r=e.slice.call(arguments,0,arguments.length),n=r,n=p(n,"map",[],(a=function(e){a.$$s;return null==e&&(e=c),e.$$is_range?e.$to_a():e},a.$$s=i,a.$$arity=1,a)).$flatten();for(var s=[],o=0,u=n.length;o<u;o++)n[o].$$is_number||i.$raise(l(T,"TypeError"),"no implicit conversion of "+n[o].$class()+" into Integer"),s.push(i["$[]"](n[o]));return s},L.$$arity=-1),e.def(M,"$dig",P=function(t,r){var n,a,i=this,s=c;return n=e.slice.call(arguments,1,arguments.length),a=n,(s=function(){return $(t.$$is_string&&i.$$data.hasOwnProperty(t))?i.$$data[t]||c:c}())===c||0===a.length?s:($(s["$respond_to?"]("dig"))||i.$raise(l(T,"TypeError"),s.$class()+" does not have #dig method"),p(s,"dig",e.to_a(a)))},P.$$arity=-2),c&&"dig"}(o[0],0,o)},Opal.modules["corelib/io"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}var r=(e.top,[]),n=e.nil,a=e.const_get_qualified,i=e.const_get_relative,s=(e.breaker,e.slice,e.klass),o=e.module,c=e.send,l=e.gvars,u=e.truthy,f=n;e.add_stubs(["$attr_accessor","$size","$write","$join","$map","$String","$empty?","$concat","$chomp","$getbyte","$getc","$raise","$new","$write_proc=","$-","$extend"]),function(t,r,a){var f,$,p,d,h=s(t,null,"IO"),_=[h].concat(a);h.$$prototype.tty=h.$$prototype.closed=n,e.const_set(_[0],"SEEK_SET",0),e.const_set(_[0],"SEEK_CUR",1),e.const_set(_[0],"SEEK_END",2),e.def(h,"$tty?",f=function(){return this.tty},f.$$arity=0),e.def(h,"$closed?",$=function(){return this.closed},$.$$arity=0),h.$attr_accessor("write_proc"),e.def(h,"$write",p=function(e){return this.write_proc(e),e.$size()},p.$$arity=1),h.$attr_accessor("sync","tty"),e.def(h,"$flush",d=function(){return n},d.$$arity=0),function(t,r){var a,i,s,f=o(t,"Writable");[f].concat(r);e.def(f,"$<<",a=function(e){var t=this;return t.$write(e),t},a.$$arity=1),e.def(f,"$print",i=function(t){var r,a,i,s=this;return null==l[","]&&(l[","]=n),r=e.slice.call(arguments,0,arguments.length),a=r,s.$write(c(a,"map",[],(i=function(e){var t=i.$$s||this;return null==e&&(e=n),t.$String(e)},i.$$s=s,i.$$arity=1,i)).$join(l[","])),n},i.$$arity=-1),e.def(f,"$puts",s=function(t){var r,a,i,s=this,o=n;return null==l["/"]&&(l["/"]=n),r=e.slice.call(arguments,0,arguments.length),a=r,o=l["/"],u(a["$empty?"]())?s.$write(l["/"]):s.$write(c(a,"map",[],(i=function(e){var t=i.$$s||this;return null==e&&(e=n),t.$String(e).$chomp()},i.$$s=s,i.$$arity=1,i)).$concat([n]).$join(o)),n},s.$$arity=-1)}(_[0],_),function(t,r){var a,s,c,u,f=o(t,"Readable"),$=[f].concat(r);e.def(f,"$readbyte",a=function(){return this.$getbyte()},a.$$arity=0),e.def(f,"$readchar",s=function(){return this.$getc()},s.$$arity=0),e.def(f,"$readline",c=function(e){var t=this;return null==l["/"]&&(l["/"]=n),null==e&&(e=l["/"]),t.$raise(i($,"NotImplementedError"))},c.$$arity=-1),e.def(f,"$readpartial",u=function(e,t){var r=this;return null==t&&(t=n),r.$raise(i($,"NotImplementedError"))},u.$$arity=-2)}(_[0],_)}(r[0],0,r),e.const_set(r[0],"STDERR",l.stderr=i(r,"IO").$new()),e.const_set(r[0],"STDIN",l.stdin=i(r,"IO").$new()),e.const_set(r[0],"STDOUT",l.stdout=i(r,"IO").$new());var $=e.global.console;return f=["object"==typeof process&&"object"==typeof process.stdout?function(e){process.stdout.write(e)}:function(e){$.log(e)}],c(i(r,"STDOUT"),"write_proc=",e.to_a(f)),f[t(f.length,1)],f=["object"==typeof process&&"object"==typeof process.stderr?function(e){process.stderr.write(e)}:function(e){$.warn(e)}],c(i(r,"STDERR"),"write_proc=",e.to_a(f)),f[t(f.length,1)],i(r,"STDOUT").$extend(a(i(r,"IO"),"Writable")),i(r,"STDERR").$extend(a(i(r,"IO"),"Writable"))},Opal.modules["corelib/main"]=function(e){var t,r,n=e.top,a=[],i=e.nil,s=(e.const_get_qualified,e.const_get_relative);e.breaker,e.slice;return e.add_stubs(["$include"]),e.defs(n,"$to_s",t=function(){return"main"},t.$$arity=0),e.defs(n,"$include",r=function(e){return s(a,"Object").$include(e)},r.$$arity=1),i&&"include"},Opal.modules["corelib/dir"]=function(e){var t=(e.top,[]),r=e.nil,n=(e.const_get_qualified,e.const_get_relative),a=(e.breaker,e.slice,e.klass),i=e.truthy;return e.add_stubs(["$[]"]),function(t,s,o){var c=a(t,null,"Dir"),l=[c].concat(o);return function(t,a){var s,o,c,l=[t].concat(a);return e.def(t,"$chdir",s=function(t){var n=s.$$p,a=n||r,i=r;return n&&(s.$$p=null),function(){try{return i=e.current_dir,e.current_dir=t,e.yieldX(a,[])}finally{e.current_dir=i}}()},s.$$arity=1),e.def(t,"$pwd",o=function(){return e.current_dir||"."},o.$$arity=0),e.alias(t,"getwd","pwd"),e.def(t,"$home",c=function(){var e;return i(e=n(l,"ENV")["$[]"]("HOME"))?e:"."},c.$$arity=0),r&&"home"}(e.get_singleton_class(c),l)}(t[0],0,t)},Opal.modules["corelib/file"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}var n=(e.top,[]),a=e.nil,i=(e.const_get_qualified,e.const_get_relative),s=(e.breaker,e.slice,e.klass),o=e.truthy,c=e.range,l=e.send;return e.add_stubs(["$respond_to?","$to_path","$pwd","$split","$sub","$+","$unshift","$join","$home","$raise","$start_with?","$absolute_path","$coerce_to!","$basename","$empty?","$rindex","$[]","$nil?","$==","$-","$length","$gsub","$find","$=~","$map","$each_with_index","$flatten","$reject","$to_proc","$end_with?"]),function(n,u,f){var $=s(n,u,"File"),p=[$].concat(f),d=a;return e.const_set(p[0],"Separator",e.const_set(p[0],"SEPARATOR","/")),e.const_set(p[0],"ALT_SEPARATOR",a),e.const_set(p[0],"PATH_SEPARATOR",":"),e.const_set(p[0],"FNM_SYSCASE",0),d=/^[a-zA-Z]:(?:\\|\/)/,function(n,s){function u(e){return o(e["$respond_to?"]("to_path"))&&(e=e.$to_path()),e=i(x,"Opal")["$coerce_to!"](e,i(x,"String"),"to_str")}function f(){return i(x,"ALT_SEPARATOR")===a?e.escape_regexp(i(x,"SEPARATOR")):e.escape_regexp(t(i(x,"SEPARATOR"),i(x,"ALT_SEPARATOR")))}var $,p,h,_,m,y,g,v,b,x=[n].concat(s);return e.def(n,"$absolute_path",$=function(e,r){var n,s=a,c=a,l=a,u=a,$=a,p=a,h=a,_=a,m=a;null==r&&(r=a),s=i(x,"SEPARATOR"),c=f(),l=[],e=function(){return o(e["$respond_to?"]("to_path"))?e.$to_path():e}(),r=o(n=r)?n:i(x,"Dir").$pwd(),u=e.substr(0,s.length)===s||d.test(e),$=r.substr(0,s.length)===s||d.test(r),o(u)?(p=e.$split(new RegExp("["+c+"]")),h=d.test(e)?"":e.$sub(new RegExp("^(["+c+"]+).*$"),"\\1"),_=!0):(p=t(r.$split(new RegExp("["+c+"]")),e.$split(new RegExp("["+c+"]"))),h=d.test(r)?"":r.$sub(new RegExp("^(["+c+"]+).*$"),"\\1"),_=$);for(var y,g=0,v=p.length;g<v;g++)(y=p[g])===a||""===y&&(0===l.length||_)||"."===y&&(0===l.length||_)||(".."===y?l.pop():l.push(y));return _||"."===p[0]||l.$unshift("."),m=l.$join(s),o(_)&&(m=t(h,m)),m},$.$$arity=-2),e.def(n,"$expand_path",p=function(e,r){var n=this,s=a,c=a,l=a,u=a,$=a;return null==r&&(r=a),s=i(x,"SEPARATOR"),c=f(),o("~"===e[0]||r&&"~"===r[0])&&(l=i(x,"Dir").$home(),o(l)||n.$raise(i(x,"ArgumentError"),"couldn't find HOME environment -- expanding `~'"),u=d.test(l)?"":l.$sub(new RegExp("^(["+c+"]+).*$"),"\\1"),o(l["$start_with?"](u))||n.$raise(i(x,"ArgumentError"),"non-absolute home"),l=t(l,s),$=new RegExp("^\\~(?:"+s+"|$)"),e=e.$sub($,l),o(r)&&(r=r.$sub($,l))),n.$absolute_path(e,r)},p.$$arity=-2),e.alias(n,"realpath","expand_path"),e.def(n,"$dirname",h=function(e){var t=a;t=f(),e=u(e);var r=e.match(new RegExp("^["+t+"]"));return e=e.replace(new RegExp("["+t+"]+$"),""),e=e.replace(new RegExp("[^"+t+"]+$"),""),e=e.replace(new RegExp("["+t+"]+$"),""),""===e?r?"/":".":e},h.$$arity=1),e.def(n,"$basename",_=function(t,r){var n=a;return null==r&&(r=a),n=f(),t=u(t),0==t.length?t:(r=r!==a?i(x,"Opal")["$coerce_to!"](r,i(x,"String"),"to_str"):null,t=t.replace(new RegExp("(.)["+n+"]*$"),"$1"),t=t.replace(new RegExp("^(?:.*["+n+"])?([^"+n+"]+)$"),"$1"),".*"===r?t=t.replace(/\.[^\.]+$/,""):null!==r&&(r=e.escape_regexp(r),t=t.replace(new RegExp(r+"$"),"")),t)},_.$$arity=-2),e.def(n,"$extname",m=function(n){var i,s=this,l=a,f=a;return n=u(n),l=s.$basename(n),o(l["$empty?"]())?"":(f=l["$[]"](c(1,-1,!1)).$rindex("."),o(o(i=f["$nil?"]())?i:t(f,1)["$=="](r(l.$length(),1)))?"":l["$[]"](e.Range.$new(t(f,1),-1,!1)))},m.$$arity=1),e.def(n,"$exist?",y=function(t){return null!=e.modules[t]},y.$$arity=1),e.alias(n,"exists?","exist?"),e.def(n,"$directory?",g=function(t){var r,n=this,s=a;s=[];for(var o in e.modules)s.push(o);return t=t.$gsub(new RegExp("(^."+i(x,"SEPARATOR")+"+|"+i(x,"SEPARATOR")+"+$)")),l(s,"find",[],(r=function(e){r.$$s;return null==e&&(e=a),e["$=~"](new RegExp("^"+t))},r.$$s=n,r.$$arity=1,r))},g.$$arity=1),e.def(n,"$join",v=function(r){var n,s,c,u,f=this,$=a;return n=e.slice.call(arguments,0,arguments.length),s=n,o(s["$empty?"]())?"":($="",s=l(s.$flatten().$each_with_index(),"map",[],(c=function(e,r){c.$$s;return null==e&&(e=a),null==r&&(r=a),o(r["$=="](0)?e["$empty?"]():r["$=="](0))?i(x,"SEPARATOR"):o(s.$length()["$=="](t(r,1))?e["$empty?"]():s.$length()["$=="](t(r,1)))?i(x,"SEPARATOR"):e},c.$$s=f,c.$$arity=2,c)),s=l(s,"reject",[],"empty?".$to_proc()),l(s,"each_with_index",[],(u=function(e,r){var n,c=(u.$$s,a);return null==e&&(e=a),null==r&&(r=a),c=s["$[]"](t(r,1)),o(c["$nil?"]())?$=""+$+e:(o(o(n=e["$end_with?"](i(x,"SEPARATOR")))?c["$start_with?"](i(x,"SEPARATOR")):n)&&(e=e.$sub(new RegExp(i(x,"SEPARATOR")+"+$"),"")),$=function(){return o(o(n=e["$end_with?"](i(x,"SEPARATOR")))?n:c["$start_with?"](i(x,"SEPARATOR")))?""+$+e:""+$+e+i(x,"SEPARATOR")}())},u.$$s=f,u.$$arity=2,u)),$)},v.$$arity=-1),e.def(n,"$split",b=function(e){return e.$split(i(x,"SEPARATOR"))},b.$$arity=1),a&&"split"}(e.get_singleton_class($),p)}(n[0],i(n,"IO"),n)},Opal.modules["corelib/process"]=function(e){var t=(e.top,[]),r=e.nil,n=e.const_get_qualified,a=e.const_get_relative,i=(e.breaker,e.slice,e.klass),s=e.truthy;return e.add_stubs(["$const_set","$size","$<<","$__register_clock__","$to_f","$now","$new","$[]","$raise"]),function(t,o,c){var l,u,f,$,p=i(t,null,"Process"),d=[p].concat(c),h=r;if(p.__clocks__=[],e.defs(p,"$__register_clock__",l=function(e,t){var n=this;return null==n.__clocks__&&(n.__clocks__=r),n.$const_set(e,n.__clocks__.$size()),n.__clocks__["$<<"](t)},l.$$arity=2),p.$__register_clock__("CLOCK_REALTIME",function(){return Date.now()}),h=!1,e.global.performance)h=function(){return performance.now()};else if(e.global.process&&process.hrtime){var _=process.hrtime();h=function(){var e=process.hrtime(_),t=e[1]/1e3|0;return 1e3*e[0]+t/1e3}}s(h)&&p.$__register_clock__("CLOCK_MONOTONIC",h),e.defs(p,"$pid",u=function(){return 0},u.$$arity=0),e.defs(p,"$times",f=function(){var e=r;return e=a(d,"Time").$now().$to_f(),n(a(d,"Benchmark"),"Tms").$new(e,e,e,e,e)},f.$$arity=0),e.defs(p,"$clock_gettime",$=function(e,t){var i=this,o=r;null==i.__clocks__&&(i.__clocks__=r),null==t&&(t="float_second"),s(o=i.__clocks__["$[]"](e))||i.$raise(n(a(d,"Errno"),"EINVAL"),"clock_gettime("+e+") "+i.__clocks__["$[]"](e));var c=o();switch(t){case"float_second":return c/1e3;case"float_millisecond":return c/1;case"float_microsecond":return 1e3*c;case"second":return c/1e3|0;case"millisecond":return c/1|0;case"microsecond":return 1e3*c|0;case"nanosecond":return 1e6*c|0;default:i.$raise(a(d,"ArgumentError"),"unexpected unit: "+t)}},$.$$arity=-2)}(t[0],0,t),function(t,n,a){var s,o=i(t,null,"Signal");[o].concat(a);e.defs(o,"$trap",s=function(t){return e.slice.call(arguments,0,arguments.length),r},s.$$arity=-1)}(t[0],0,t),function(t,n,a){var s,o=i(t,null,"GC");[o].concat(a);return e.defs(o,"$start",s=function(){return r},s.$$arity=0),r&&"start"}(t[0],0,t)},Opal.modules["corelib/random"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e<t:e["$<"](t)}var r=(e.top,[]),n=e.nil,a=(e.const_get_qualified,e.const_get_relative),i=(e.breaker,e.slice,e.klass),s=e.truthy,o=e.send;return e.add_stubs(["$attr_reader","$new_seed","$coerce_to!","$reseed","$rand","$seed","$<","$raise","$encode","$join","$new","$chr","$===","$==","$state","$const_defined?","$const_set"]),function(r,c,l){var u,f,$,p,d,h,_,m,y,g,v=i(r,null,"Random"),b=[v].concat(l);return v.$attr_reader("seed","state"),e.def(v,"$initialize",u=function(e){var t=this;return null==e&&(e=a(b,"Random").$new_seed()),e=a(b,"Opal")["$coerce_to!"](e,a(b,"Integer"),"to_int"),t.state=e,t.$reseed(e)},u.$$arity=-1),e.def(v,"$reseed",f=function(t){var r=this;return r.seed=t,r.$rng=e.$$rand.reseed(t)},f.$$arity=1),e.defs(v,"$new_seed",$=function(){return e.$$rand.new_seed()},$.$$arity=0),e.defs(v,"$rand",p=function(e){return a(b,"DEFAULT").$rand(e)},p.$$arity=-1),e.defs(v,"$srand",d=function(e){var t=n;return null==e&&(e=a(b,"Random").$new_seed()),e=a(b,"Opal")["$coerce_to!"](e,a(b,"Integer"),"to_int"),t=a(b,"DEFAULT").$seed(),a(b,"DEFAULT").$reseed(e),t},d.$$arity=-1),e.defs(v,"$urandom",h=function(e){var r,n=this;return e=a(b,"Opal")["$coerce_to!"](e,a(b,"Integer"),"to_int"),s(t(e,0))&&n.$raise(a(b,"ArgumentError"),"negative string size (or size too big)"),o(a(b,"Array"),"new",[e],(r=function(){return(r.$$s||this).$rand(255).$chr()},r.$$s=n,r.$$arity=0,r)).$join().$encode("ASCII-8BIT")},h.$$arity=1),e.def(v,"$==",_=function(e){var t=this;return!!s(a(b,"Random")["$==="](e))&&(t.$seed()["$=="](e.$seed())?t.$state()["$=="](e.$state()):t.$seed()["$=="](e.$seed()))},_.$$arity=1),e.def(v,"$bytes",m=function(e){var t,r=this;return e=a(b,"Opal")["$coerce_to!"](e,a(b,"Integer"),"to_int"),o(a(b,"Array"),"new",[e],(t=function(){return(t.$$s||this).$rand(255).$chr()},t.$$s=r,t.$$arity=0,t)).$join().$encode("ASCII-8BIT")},m.$$arity=1),e.def(v,"$rand",y=function(t){function r(){return s.state++,e.$$rand.rand(s.$rng)}function i(){return Math.floor(r()*t)}var s=this;return null==t?r():t.$$is_range?function(){var e=t.begin,r=t.end;if(e===n||r===n)return n;var a=r-e;return a<0?n:0===a?e:(r%1!=0||e%1!=0||t.excl||a++,s.$rand(a)+e)}():t.$$is_number?(t<=0&&s.$raise(a(b,"ArgumentError"),"invalid argument - "+t),t%1==0?i():r()*t):(t=a(b,"Opal")["$coerce_to!"](t,a(b,"Integer"),"to_int"),t<=0&&s.$raise(a(b,"ArgumentError"),"invalid argument - "+t),i())},y.$$arity=-1),e.defs(v,"$generator=",g=function(t){var r=this;return e.$$rand=t,s(r["$const_defined?"]("DEFAULT"))?a(b,"DEFAULT").$reseed():r.$const_set("DEFAULT",r.$new(r.$new_seed()))},g.$$arity=1),n&&"generator="}(r[0],0,r)};var MersenneTwister=function(){function e(e){var r={left:0,next:s,state:new Array(s)};return t(r,e),r}function t(e,t){var r;for(e.state[0]=t>>>0,r=1;r<s;r++)e.state[r]=1812433253*(e.state[r-1]^e.state[r-1]>>30>>>0)+r,e.state[r]&=4294967295;e.left=1,e.next=s}function r(e){var t,r=0,n=e.state;for(e.left=s,e.next=0,t=s-o+1;--t;r++)n[r]=n[r+o]^l(n[r+0],n[r+1]);for(t=o;--t;r++)n[r]=n[r+(o-s)]^l(n[r+0],n[r+1]);n[r]=n[r+(o-s)]^l(n[r+0],n[0])}function n(e){var t;return--e.left<=0&&r(e),t=e.state[e.next++],t^=t>>>11,t^=t<<7&2636928640,t^=t<<15&4022730752,(t^=t>>>18)>>>0}function a(e,t){return e>>>=5,t>>>=6,(67108864*e+t)*(1/9007199254740992)}function i(e){return a(n(e),n(e))}var s=624,o=397,c=function(e,t){return 2147483648&e|2147483647&t},l=function(e,t){return c(e,t)>>>1^(1&t?2567483615:0)};return{genrand_real:i,init:e}}();Opal.loaded(["corelib/random/MersenneTwister.js"]),Opal.modules["corelib/random/mersenne_twister"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}var r=e.top,n=[],a=e.nil,i=(e.const_get_qualified,e.const_get_relative),s=(e.breaker,e.slice,e.klass),o=e.send;return e.add_stubs(["$require","$generator=","$-"]),r.$require("corelib/random/MersenneTwister"),function(r,n,c){var l=s(r,null,"Random"),u=[l].concat(c),f=a,$=Number.MAX_SAFE_INTEGER||Math.pow(2,53)-1;return e.const_set(u[0],"MERSENNE_TWISTER_GENERATOR",{new_seed:function(){return Math.round(Math.random()*$)},reseed:function(e){return MersenneTwister.init(e)},rand:function(e){return MersenneTwister.genrand_real(e)}}),f=[i(u,"MERSENNE_TWISTER_GENERATOR")],o(l,"generator=",e.to_a(f)),f[t(f.length,1)]}(n[0],0,n)},Opal.modules["corelib/unsupported"]=function(e){function t(t){switch(e.config.unsupported_features_severity){case"error":c(s,"Kernel").$raise(c(s,"NotImplementedError"),t);break;case"warning":r(t)}}function r(e){f[e]||(f[e]=!0,i.$warn(e))}var n,a,i=e.top,s=[],o=e.nil,c=(e.const_get_qualified,e.const_get_relative),l=(e.breaker,e.slice,e.klass),u=e.module;e.add_stubs(["$raise","$warn","$%"]);var f={};return function(t,r,n){var a,i,s,o,u,f,$,p,d,h,_,m,y,g,v,b,x,w,A,k,E,S,N,C=l(t,null,"String"),I=[C].concat(n),O="String#%s not supported. Mutable String methods are not supported in Opal.";e.def(C,"$<<",a=function(t){var r=this;return e.slice.call(arguments,0,arguments.length),r.$raise(c(I,"NotImplementedError"),O["$%"]("<<"))},a.$$arity=-1),e.def(C,"$capitalize!",i=function(t){var r=this;return e.slice.call(arguments,0,arguments.length),r.$raise(c(I,"NotImplementedError"),O["$%"]("capitalize!"))},i.$$arity=-1),e.def(C,"$chomp!",s=function(t){var r=this;return e.slice.call(arguments,0,arguments.length),r.$raise(c(I,"NotImplementedError"),O["$%"]("chomp!"))},s.$$arity=-1),e.def(C,"$chop!",o=function(t){var r=this;return e.slice.call(arguments,0,arguments.length),r.$raise(c(I,"NotImplementedError"),O["$%"]("chop!"))},o.$$arity=-1),e.def(C,"$downcase!",u=function(t){var r=this;return e.slice.call(arguments,0,arguments.length),r.$raise(c(I,"NotImplementedError"),O["$%"]("downcase!"))},u.$$arity=-1),e.def(C,"$gsub!",f=function(t){var r=this;return e.slice.call(arguments,0,arguments.length),r.$raise(c(I,"NotImplementedError"),O["$%"]("gsub!"))},f.$$arity=-1),e.def(C,"$lstrip!",$=function(t){var r=this;return e.slice.call(arguments,0,arguments.length),r.$raise(c(I,"NotImplementedError"),O["$%"]("lstrip!"))},$.$$arity=-1),e.def(C,"$next!",p=function(t){var r=this;return e.slice.call(arguments,0,arguments.length),r.$raise(c(I,"NotImplementedError"),O["$%"]("next!"))},p.$$arity=-1),e.def(C,"$reverse!",d=function(t){var r=this;return e.slice.call(arguments,0,arguments.length),r.$raise(c(I,"NotImplementedError"),O["$%"]("reverse!"))},d.$$arity=-1),e.def(C,"$slice!",h=function(t){var r=this;return e.slice.call(arguments,0,arguments.length),r.$raise(c(I,"NotImplementedError"),O["$%"]("slice!"))},h.$$arity=-1),e.def(C,"$squeeze!",_=function(t){var r=this;return e.slice.call(arguments,0,arguments.length),r.$raise(c(I,"NotImplementedError"),O["$%"]("squeeze!"))},_.$$arity=-1),e.def(C,"$strip!",m=function(t){var r=this;return e.slice.call(arguments,0,arguments.length),r.$raise(c(I,"NotImplementedError"),O["$%"]("strip!"))},m.$$arity=-1),e.def(C,"$sub!",y=function(t){var r=this;return e.slice.call(arguments,0,arguments.length),r.$raise(c(I,"NotImplementedError"),O["$%"]("sub!"))},y.$$arity=-1),e.def(C,"$succ!",g=function(t){var r=this;return e.slice.call(arguments,0,arguments.length),r.$raise(c(I,"NotImplementedError"),O["$%"]("succ!"))},g.$$arity=-1),e.def(C,"$swapcase!",v=function(t){var r=this;return e.slice.call(arguments,0,arguments.length),r.$raise(c(I,"NotImplementedError"),O["$%"]("swapcase!"))},v.$$arity=-1),e.def(C,"$tr!",b=function(t){var r=this;return e.slice.call(arguments,0,arguments.length),r.$raise(c(I,"NotImplementedError"),O["$%"]("tr!"))},b.$$arity=-1),e.def(C,"$tr_s!",x=function(t){var r=this;return e.slice.call(arguments,0,arguments.length),r.$raise(c(I,"NotImplementedError"),O["$%"]("tr_s!"))},x.$$arity=-1),e.def(C,"$upcase!",w=function(t){var r=this;return e.slice.call(arguments,0,arguments.length),r.$raise(c(I,"NotImplementedError"),O["$%"]("upcase!"))},w.$$arity=-1),e.def(C,"$prepend",A=function(t){var r=this;return e.slice.call(arguments,0,arguments.length),r.$raise(c(I,"NotImplementedError"),O["$%"]("prepend"))},A.$$arity=-1),e.def(C,"$[]=",k=function(t){var r=this;return e.slice.call(arguments,0,arguments.length),r.$raise(c(I,"NotImplementedError"),O["$%"]("[]="))},k.$$arity=-1),e.def(C,"$clear",E=function(t){var r=this;return e.slice.call(arguments,0,arguments.length),r.$raise(c(I,"NotImplementedError"),O["$%"]("clear"))},E.$$arity=-1),e.def(C,"$encode!",S=function(t){var r=this;return e.slice.call(arguments,0,arguments.length),r.$raise(c(I,"NotImplementedError"),O["$%"]("encode!"))},S.$$arity=-1),e.def(C,"$unicode_normalize!",N=function(t){var r=this;return e.slice.call(arguments,0,arguments.length),r.$raise(c(I,"NotImplementedError"),O["$%"]("unicode_normalize!"))},N.$$arity=-1)}(s[0],0,s),function(r,n){var a,i,s=u(r,"Kernel"),o=([s].concat(n),"Object freezing is not supported by Opal");e.def(s,"$freeze",a=function(){var e=this;return t(o),e},a.$$arity=0),e.def(s,"$frozen?",i=function(){return t(o),!1},i.$$arity=0)}(s[0],s),function(r,n){var a,i,s,o=u(r,"Kernel"),c=([o].concat(n),"Object tainting is not supported by Opal");e.def(o,"$taint",a=function(){var e=this;return t(c),e},a.$$arity=0),e.def(o,"$untaint",i=function(){var e=this;return t(c),e},i.$$arity=0),e.def(o,"$tainted?",s=function(){return t(c),!1},s.$$arity=0)}(s[0],s),function(t,r,n){var a,i,s,c,u=l(t,null,"Module");[u].concat(n);e.def(u,"$public",a=function(t){var r,n,a=this;return r=e.slice.call(arguments,0,arguments.length),n=r,0===n.length&&(a.$$module_function=!1),o},a.$$arity=-1),e.alias(u,"private","public"),e.alias(u,"protected","public"),e.alias(u,"nesting","public"),e.def(u,"$private_class_method",i=function(t){var r=this;return e.slice.call(arguments,0,arguments.length),r},i.$$arity=-1),e.alias(u,"public_class_method","private_class_method"),e.def(u,"$private_method_defined?",s=function(e){return!1},s.$$arity=1),e.def(u,"$private_constant",c=function(t){return e.slice.call(arguments,0,arguments.length),o},c.$$arity=-1),e.alias(u,"protected_method_defined?","private_method_defined?"),e.alias(u,"public_instance_methods","instance_methods"),e.alias(u,"public_instance_method","instance_method"),e.alias(u,"public_method_defined?","method_defined?")}(s[0],0,s),function(t,r){var n,a=u(t,"Kernel");[a].concat(r);e.def(a,"$private_methods",n=function(t){return e.slice.call(arguments,0,arguments.length),[]},n.$$arity=-1),e.alias(a,"private_instance_methods","private_methods")}(s[0],s),function(t,r){var n,a=u(t,"Kernel"),i=[a].concat(r);e.def(a,"$eval",n=function(t){var r=this;return e.slice.call(arguments,0,arguments.length),r.$raise(c(i,"NotImplementedError"),"To use Kernel#eval, you must first require 'opal-parser'. See https://github.com/opal/opal/blob/"+c(i,"RUBY_ENGINE_VERSION")+"/docs/opal_parser.md for details.")},n.$$arity=-1)}(s[0],s),e.defs(i,"$public",n=function(t){return e.slice.call(arguments,0,arguments.length),o},n.$$arity=-1),e.defs(i,"$private",a=function(t){
return e.slice.call(arguments,0,arguments.length),o},a.$$arity=-1),o&&"private"},Opal.modules.opal=function(e){var t=e.top;e.nil,e.const_get_qualified,e.const_get_relative,e.breaker,e.slice;return e.add_stubs(["$require"]),t.$require("opal/base"),t.$require("opal/mini"),t.$require("corelib/kernel/format"),t.$require("corelib/string/encoding"),t.$require("corelib/math"),t.$require("corelib/complex"),t.$require("corelib/rational"),t.$require("corelib/time"),t.$require("corelib/struct"),t.$require("corelib/io"),t.$require("corelib/main"),t.$require("corelib/dir"),t.$require("corelib/file"),t.$require("corelib/process"),t.$require("corelib/random"),t.$require("corelib/random/mersenne_twister.js"),t.$require("corelib/unsupported")},Opal.modules["opal-platform"]=function(e){var t=(e.top,[]),r=e.nil,n=(e.const_get_qualified,e.const_get_relative,e.breaker,e.slice,e.truthy),a=r,i=r,s=r;return"undefined"!=typeof document,a="undefined"!=typeof process&&process.versions&&process.versions.node,i="undefined"!=typeof Java&&Java.type,s="undefined"!=typeof navigator&&/\bHeadlessChrome\//.test(navigator.userAgent),e.const_set(t[0],"OPAL_PLATFORM",function(){return n(i)?"nashorn":n(a)?"nodejs":n(s)?"headless-chrome":r}())},Opal.modules["vector2d/calculations"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e*t:e["$*"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}var a=(e.top,[]),i=e.nil,s=(e.const_get_qualified,e.const_get_relative),o=(e.breaker,e.slice,e.klass),c=e.module,l=e.truthy;return e.add_stubs(["$-","$*","$x","$y","$+","$normalized?","$normalize","$acos","$dot_product","$calculate_each","$sqrt","$squared_distance","$coerce","$class","$cross_product","$angle_between","$private","$new","$send"]),function(a,u,f){var $=o(a,null,"Vector2d"),p=[$].concat(f);return function(a,o){var u,f,$,p,d,h,_,m,y,g,v=c(a,"Calculations"),b=[v].concat(o);!function(a,o){var u,f,$,p=c(a,"ClassMethods"),d=[p].concat(o);e.def(p,"$cross_product",u=function(e,n){return t(r(e.$x(),n.$y()),r(e.$y(),n.$x()))},u.$$arity=2),e.def(p,"$dot_product",f=function(e,t){return n(r(e.$x(),t.$x()),r(e.$y(),t.$y()))},f.$$arity=2),e.def(p,"$angle_between",$=function(e,t){var r=this,n=i,a=i;return n=function(){return l(e["$normalized?"]())?e:e.$normalize()}(),a=function(){return l(t["$normalized?"]())?t:t.$normalize()}(),s(d,"Math").$acos(r.$dot_product(n,a))},$.$$arity=2)}(b[0],b),e.def(v,"$*",u=function(e){return this.$calculate_each("*",e)},u.$$arity=1),e.def(v,"$/",f=function(e){return this.$calculate_each("/",e)},f.$$arity=1),e.def(v,"$+",$=function(e){return this.$calculate_each("+",e)},$.$$arity=1),e.def(v,"$-",p=function(e){return this.$calculate_each("-",e)},p.$$arity=1),e.def(v,"$distance",d=function(e){var t=this;return s(b,"Math").$sqrt(t.$squared_distance(e))},d.$$arity=1),e.def(v,"$squared_distance",h=function(a){var s,o,c=this,l=i,u=i,f=i;return o=c.$coerce(a),s=e.to_ary(o),l=null==s[0]?i:s[0],null==s[1]?i:s[1],u=t(l.$x(),c.$x()),f=t(l.$y(),c.$y()),n(r(u,u),r(f,f))},h.$$arity=1),e.def(v,"$dot_product",_=function(t){var r,n,a=this,s=i;return n=a.$coerce(t),r=e.to_ary(n),s=null==r[0]?i:r[0],null==r[1]?i:r[1],a.$class().$dot_product(a,s)},_.$$arity=1),e.def(v,"$cross_product",m=function(t){var r,n,a=this,s=i;return n=a.$coerce(t),r=e.to_ary(n),s=null==r[0]?i:r[0],null==r[1]?i:r[1],a.$class().$cross_product(a,s)},m.$$arity=1),e.def(v,"$angle_between",y=function(t){var r,n,a=this,s=i;return n=a.$coerce(t),r=e.to_ary(n),s=null==r[0]?i:r[0],null==r[1]?i:r[1],a.$class().$angle_between(a,s)},y.$$arity=1),v.$private(),e.def(v,"$calculate_each",g=function(t,r){var n,a,s=this,o=i;return a=s.$coerce(r),n=e.to_ary(a),o=null==n[0]?i:n[0],null==n[1]?i:n[1],s.$class().$new(s.$x().$send(t,o.$x()),s.$y().$send(t,o.$y()))},g.$$arity=2)}(p[0],p)}(a[0],0,a)},Opal.modules["vector2d/coercions"]=function(e){var t=(e.top,[]),r=e.nil,n=(e.const_get_qualified,e.const_get_relative),a=(e.breaker,e.slice,e.klass),i=e.module,s=e.hash2;return e.add_stubs(["$===","$parse","$raise","$class","$x","$y","$new","$to_i","$to_f"]),function(t,o,c){var l=a(t,null,"Vector2d"),u=[l].concat(c);return function(t,a){var o,c,l,u,f,$,p,d=i(t,"Coercions"),h=[d].concat(a);e.def(d,"$coerce",o=function(e){var t=this,a=r;return function(){return a=e,n(h,"Vector2d")["$==="](a)?[e,t]:n(h,"Array")["$==="](a)||n(h,"Numeric")["$==="](a)||n(h,"String")["$==="](a)||n(h,"Hash")["$==="](a)?[n(h,"Vector2d").$parse(e),t]:t.$raise(n(h,"TypeError"),t.$class()+" can't be coerced into "+e.$class())}()},o.$$arity=1),e.def(d,"$inspect",c=function(){var e=this;return"Vector2d("+e.$x()+","+e.$y()+")"},c.$$arity=0),e.def(d,"$to_a",l=function(){var e=this;return[e.$x(),e.$y()]},l.$$arity=0),e.def(d,"$to_hash",u=function(){var e=this;return s(["x","y"],{x:e.$x(),y:e.$y()})},u.$$arity=0),e.def(d,"$to_i_vector",f=function(){var e=this;return e.$class().$new(e.$x().$to_i(),e.$y().$to_i())},f.$$arity=0),e.def(d,"$to_f_vector",$=function(){var e=this;return e.$class().$new(e.$x().$to_f(),e.$y().$to_f())},$.$$arity=0),e.def(d,"$to_s",p=function(){var e=this;return e.$x()+"x"+e.$y()},p.$$arity=0)}(u[0],u)}(t[0],0,t)},Opal.modules["vector2d/fitting"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e/t:e["$/"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e*t:e["$*"](t)}function a(e,t){return"number"==typeof e&&"number"==typeof t?e<t:e["$<"](t)}var i=(e.top,[]),s=e.nil,o=(e.const_get_qualified,e.const_get_relative,e.breaker,e.slice,e.klass),c=e.module,l=e.truthy;return e.add_stubs(["$coerce","$>","$x","$y","$fit","$/","$to_f_vector","$*","$==","$<","$alias_method"]),function(i,u,f){var $=o(i,null,"Vector2d"),p=[$].concat(f);return function(i,o){var u,f,$,p=c(i,"Fitting");[p].concat(o);e.def(p,"$contain",u=function(r){var n,a,i=this,o=s;return a=i.$coerce(r),n=e.to_ary(a),o=null==n[0]?s:n[0],null==n[1]?s:n[1],l(l(n=t(o.$x(),i.$x()))?n:t(o.$y(),i.$y()))?r.$fit(i):r},u.$$arity=1),e.def(p,"$fit",f=function(i){var o,c,u=this,f=s,$=s;return c=u.$coerce(i),o=e.to_ary(c),f=null==o[0]?s:o[0],null==o[1]?s:o[1],$=r(f.$to_f_vector(),u),n(u,function(){return l(l(o=$.$y()["$=="](0))?o:l(c=t($.$x(),0))?a($.$x(),$.$y()):c)?$.$x():$.$y()}())},f.$$arity=1),p.$alias_method("constrain_both","fit"),e.def(p,"$fit_either",$=function(i){var o,c,u=this,f=s,$=s;return c=u.$coerce(i),o=e.to_ary(c),f=null==o[0]?s:o[0],null==o[1]?s:o[1],$=r(f.$to_f_vector(),u),l(l(o=t($.$x(),0))?t($.$y(),0):o)?($=function(){return l(a($.$x(),$.$y()))?$.$y():$.$x()}(),n(u,$)):u.$fit(f)},$.$$arity=1),p.$alias_method("constrain_one","fit_either")}(p[0],p)}(i[0],0,i)},Opal.modules["vector2d/properties"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e/t:e["$/"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e*t:e["$*"](t)}var a=(e.top,[]),i=(e.nil,e.const_get_qualified,e.const_get_relative),s=(e.breaker,e.slice,e.klass),o=e.module;return e.add_stubs(["$atan2","$y","$x","$abs","$/","$to_f","$sqrt","$squared_length","$+","$*","$==","$length"]),function(a,c,l){var u=s(a,null,"Vector2d"),f=[u].concat(l);return function(a,s){var c,l,u,f,$,p=o(a,"Properties"),d=[p].concat(s);e.def(p,"$angle",c=function(){var e=this;return i(d,"Math").$atan2(e.$y(),e.$x())},c.$$arity=0),e.def(p,"$aspect_ratio",l=function(){var e=this;return t(e.$x().$to_f(),e.$y().$to_f()).$abs()},l.$$arity=0),e.def(p,"$length",u=function(){var e=this;return i(d,"Math").$sqrt(e.$squared_length())},u.$$arity=0),e.def(p,"$squared_length",f=function(){var e=this;return r(n(e.$x(),e.$x()),n(e.$y(),e.$y()))},f.$$arity=0),e.def(p,"$normalized?",$=function(){return this.$length().$to_f()["$=="](1)},$.$$arity=0)}(f[0],f)}(a[0],0,a)},Opal.modules["vector2d/transformations"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e*t:e["$*"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e/t:e["$/"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function a(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}var i=(e.top,[]),s=(e.nil,e.const_get_qualified,e.const_get_relative),o=(e.breaker,e.slice,e.klass),c=e.module;return e.add_stubs(["$new","$class","$ceil","$x","$y","$floor","$resize","$-@","$*","$/","$length","$-","$cos","$sin","$+","$round","$min"]),function(i,l,u){var f=o(i,null,"Vector2d"),$=[f].concat(u);return function(i,o){var l,u,f,$,p,d,h,_,m,y=c(i,"Transformations"),g=[y].concat(o);e.def(y,"$ceil",l=function(){var e=this;return e.$class().$new(e.$x().$ceil(),e.$y().$ceil())},l.$$arity=0),e.def(y,"$floor",u=function(){var e=this;return e.$class().$new(e.$x().$floor(),e.$y().$floor())},u.$$arity=0),e.def(y,"$normalize",f=function(){return this.$resize(1)},f.$$arity=0),e.def(y,"$perpendicular",$=function(){var e=this;return s(g,"Vector2d").$new(e.$y()["$-@"](),e.$x())},$.$$arity=0),e.def(y,"$resize",p=function(e){var n=this;return t(n,r(e,n.$length()))},p.$$arity=1),e.def(y,"$reverse",d=function(){var e=this;return e.$class().$new(e.$x()["$-@"](),e.$y()["$-@"]())},d.$$arity=0),e.def(y,"$rotate",h=function(e){var r=this;return s(g,"Vector2d").$new(n(t(r.$x(),s(g,"Math").$cos(e)),t(r.$y(),s(g,"Math").$sin(e))),a(t(r.$x(),s(g,"Math").$sin(e)),t(r.$y(),s(g,"Math").$cos(e))))},h.$$arity=1),e.def(y,"$round",_=function(e){var t=this;return null==e&&(e=0),t.$class().$new(t.$x().$round(e),t.$y().$round(e))},_.$$arity=-1),e.def(y,"$truncate",m=function(e){var t=this;return t.$resize([e,t.$length()].$min())},m.$$arity=1)}($[0],$)}(i[0],0,i)},Opal.modules["vector2d/version"]=function(e){var t=(e.top,[]),r=(e.nil,e.const_get_qualified,e.const_get_relative,e.breaker,e.slice,e.klass);return function(t,n,a){var i=r(t,null,"Vector2d"),s=[i].concat(a);return e.const_set(s[0],"VERSION","2.1.0")}(t[0],0,t)},Opal.modules.vector2d=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}var r,n=e.top,a=[],i=e.nil,s=e.const_get_qualified,o=e.const_get_relative,c=(e.breaker,e.slice,e.klass),l=e.truthy,u=e.send;return e.add_stubs(["$require","$extend","$include","$nil?","$parse_single_arg","$new","$private","$===","$parse","$parse_str","$parse_hash","$dup","$has_key?","$[]","$[]=","$-","$=~","$map","$split","$to_proc","$raise","$attr_reader","$x","$y"]),n.$require("vector2d/calculations"),n.$require("vector2d/coercions"),n.$require("vector2d/fitting"),n.$require("vector2d/properties"),n.$require("vector2d/transformations"),n.$require("vector2d/version"),function(r,n,a){var f,$,p=c(r,null,"Vector2d"),d=[p].concat(a);p.$extend(s(s(o(d,"Vector2d"),"Calculations"),"ClassMethods")),p.$include(s(o(d,"Vector2d"),"Calculations")),p.$include(s(o(d,"Vector2d"),"Coercions")),p.$include(s(o(d,"Vector2d"),"Fitting")),p.$include(s(o(d,"Vector2d"),"Properties")),p.$include(s(o(d,"Vector2d"),"Transformations")),function(r,n){var a,s,c,f,$=[r].concat(n);e.def(r,"$parse",a=function(e,t){var r=this;return null==t&&(t=i),l(t["$nil?"]())?r.$parse_single_arg(e):r.$new(e,t)},a.$$arity=-2),r.$private(),e.def(r,"$parse_single_arg",s=function(t){var r=this,n=i;return function(){return n=t,o($,"Vector2d")["$==="](n)?t:o($,"Array")["$==="](n)?u(r,"parse",e.to_a(t)):o($,"String")["$==="](n)?r.$parse_str(t):o($,"Hash")["$==="](n)?r.$parse_hash(t.$dup()):r.$new(t,t)}()},s.$$arity=1),e.def(r,"$parse_hash",c=function(r){var n=this,a=i;return l(r["$has_key?"]("x"))&&(l(r["$[]"]("x"))||(a=["x",r["$[]"]("x")],u(r,"[]=",e.to_a(a)),a[t(a.length,1)])),l(r["$has_key?"]("y"))&&(l(r["$[]"]("y"))||(a=["y",r["$[]"]("y")],u(r,"[]=",e.to_a(a)),a[t(a.length,1)])),n.$new(r["$[]"]("x"),r["$[]"]("y"))},c.$$arity=1),e.def(r,"$parse_str",f=function(t){var r=this;return l(t["$=~"](/^[\s]*[\d\.]*[\s]*x[\s]*[\d\.]*[\s]*$/))?u(r,"new",e.to_a(u(t.$split("x"),"map",[],"to_f".$to_proc()))):r.$raise(o($,"ArgumentError"),"not a valid string input")},f.$$arity=1)}(e.get_singleton_class(p),d),p.$attr_reader("x","y"),e.def(p,"$initialize",f=function(e,t){var r,n=this;return r=[e,t],n.x=r[0],n.y=r[1],r},f.$$arity=2),e.def(p,"$==",$=function(e){var t,r=this;return l(t=e.$x()["$==="](r.$x()))?e.$y()["$==="](r.$y()):t},$.$$arity=1)}(a[0],0,a),e.def(n,"$Vector2d",r=function(t){var r,n;return r=e.slice.call(arguments,0,arguments.length),n=r,u(o(a,"Vector2d"),"parse",e.to_a(n))},r.$$arity=-1),i&&"Vector2d"},Opal.modules.json=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}var r=(e.top,[]),n=e.nil,a=e.const_get_qualified,i=e.const_get_relative,s=(e.breaker,e.slice,e.module),o=e.klass,c=e.send,l=e.hash2,u=e.truthy;return e.add_stubs(["$raise","$new","$push","$[]=","$-","$[]","$create_id","$json_create","$const_get","$attr_accessor","$create_id=","$===","$parse","$generate","$from_object","$merge","$to_json","$responds_to?","$to_io","$write","$to_s","$to_a","$strftime"]),function(r,f){function $(e){try{return JSON.parse(e)}catch(e){b.$raise(a(i(x,"JSON"),"ParserError"),e.message)}}function p(r,s){var o,l,u,f,$,d;switch(typeof r){case"string":case"number":return r;case"boolean":return!!r;case"null":return n;case"object":if(!r)return n;if(r.$$is_array){for(l=s.array_class.$new(),f=0,$=r.length;f<$;f++)l.$push(p(r[f],s));return l}u=s.object_class.$new();for(d in r)A.call(r,d)&&(w=[d,p(r[d],s)],c(u,"[]=",e.to_a(w)),w[t(w.length,1)]);return s.parse||(o=u["$[]"](i(x,"JSON").$create_id()))==n?u:a("::","Object").$const_get(o).$json_create(u)}}var d,h,_,m,y,g,v,b=s(r,"JSON"),x=[b].concat(f),w=n;!function(e,t,r){var n=o(e,t,"JSONError");[n].concat(r)}(x[0],i(x,"StandardError"),x),function(e,t,r){var n=o(e,t,"ParserError");[n].concat(r)}(x[0],i(x,"JSONError"),x);var A=e.hasOwnProperty;!function(e,t){[e].concat(t);e.$attr_accessor("create_id")}(e.get_singleton_class(b),x),w=["json_class"],c(b,"create_id=",e.to_a(w)),w[t(w.length,1)],e.defs(b,"$[]",d=function(e,t){var r=this;return null==t&&(t=l([],{})),u(i(x,"String")["$==="](e))?r.$parse(e,t):r.$generate(e,t)},d.$$arity=-2),e.defs(b,"$parse",h=function(e,t){var r=this;return null==t&&(t=l([],{})),r.$from_object($(e),t.$merge(l(["parse"],{parse:!0})))},h.$$arity=-2),e.defs(b,"$parse!",_=function(e,t){var r=this;return null==t&&(t=l([],{})),r.$parse(e,t)},_.$$arity=-2),e.defs(b,"$load",m=function(e,t){var r=this;return null==t&&(t=l([],{})),r.$from_object($(e),t)},m.$$arity=-2),e.defs(b,"$from_object",y=function(r,a){var s=n;return null==a&&(a=l([],{})),u(a["$[]"]("object_class"))||(s=["object_class",i(x,"Hash")],c(a,"[]=",e.to_a(s)),s[t(s.length,1)]),u(a["$[]"]("array_class"))||(s=["array_class",i(x,"Array")],c(a,"[]=",e.to_a(s)),s[t(s.length,1)]),p(r,a.$$smap)},y.$$arity=-2),e.defs(b,"$generate",g=function(e,t){return null==t&&(t=l([],{})),e.$to_json(t)},g.$$arity=-2),e.defs(b,"$dump",v=function(e,t,r){var a=this,i=n;return null==t&&(t=n),null==r&&(r=n),i=a.$generate(e),u(t)?(u(t["$responds_to?"]("to_io"))&&(t=t.$to_io()),t.$write(i),t):i},v.$$arity=-2)}(r[0],r),function(t,r,n){var a,i=o(t,null,"Object");[i].concat(n);e.def(i,"$to_json",a=function(){return this.$to_s().$to_json()},a.$$arity=0)}(r[0],0,r),function(t,r){var n,a=s(t,"Enumerable");[a].concat(r);e.def(a,"$to_json",n=function(){return this.$to_a().$to_json()},n.$$arity=0)}(r[0],r),function(t,r,n){var a,i=o(t,null,"Array");[i].concat(n);e.def(i,"$to_json",a=function(){for(var e=this,t=[],r=0,n=e.length;r<n;r++)t.push(e[r].$to_json());return"["+t.join(", ")+"]"},a.$$arity=0)}(r[0],0,r),function(t,r,n){var a,i=o(t,null,"Boolean");[i].concat(n);e.def(i,"$to_json",a=function(){return 1==this?"true":"false"},a.$$arity=0)}(r[0],0,r),function(t,r,n){var a,i=o(t,null,"Hash");[i].concat(n);e.def(i,"$to_json",a=function(){for(var e,t,r=this,n=[],a=0,i=r.$$keys,s=i.length;a<s;a++)e=i[a],e.$$is_string?t=r.$$smap[e]:(t=e.value,e=e.key),n.push(e.$to_s().$to_json()+":"+t.$to_json());return"{"+n.join(", ")+"}"},a.$$arity=0)}(r[0],0,r),function(t,r,n){var a,i=o(t,null,"NilClass");[i].concat(n);e.def(i,"$to_json",a=function(){return"null"},a.$$arity=0)}(r[0],0,r),function(t,r,n){var a,i=o(t,null,"Numeric");[i].concat(n);e.def(i,"$to_json",a=function(){return this.toString()},a.$$arity=0)}(r[0],0,r),function(t,r,n){var a=o(t,null,"String");[a].concat(n);e.alias(a,"to_json","inspect")}(r[0],0,r),function(t,r,n){var a,i=o(t,null,"Time");[i].concat(n);e.def(i,"$to_json",a=function(){return this.$strftime("%FT%T%z").$to_json()},a.$$arity=0)}(r[0],0,r),function(t,r,a){var i,s,c=o(t,null,"Date");[c].concat(a);return e.def(c,"$to_json",i=function(){return this.$to_s().$to_json()},i.$$arity=0),e.def(c,"$as_json",s=function(){return this.$to_s()},s.$$arity=0),n&&"as_json"}(r[0],0,r)},Opal.modules["opal-neatjson"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}var r=e.top,n=[],a=e.nil,i=(e.const_get_qualified,e.const_get_relative),s=(e.breaker,e.slice,e.truthy),o=e.module,c=e.gvars,l=e.hash2,u=e.send;return e.add_stubs(["$==","$require","$has_key?","$lambda","$[]","$[]=","$-","$to_n"]),s(i(n,"RUBY_ENGINE")["$=="]("opal"))?(r.$require("json"),function(r,n){var f,$=o(r,"JSON"),p=[$].concat(n);i(p,"OPAL_PLATFORM")["$=="]("nodejs"),c.neatJSON=neatJSON,e.defs($,"$neat_generate",f=function(r,n){var i,o=this,f=a;return null==c.neatJSON&&(c.neatJSON=a),null==n&&(n=l(["explicit_sort"],{explicit_sort:[]})),s(n["$has_key?"]("explicit_sort"))&&(f=["sort",u(o,"lambda",[],(i=function(e,t,r){var o;i.$$s;return null==e&&(e=a),null==t&&(t=a),null==r&&(r=a),s(o=n["$[]"]("explicit_sort")["$[]"](e))?o:"_9999_"+e},i.$$s=o,i.$$arity=3,i))],u(n,"[]=",e.to_a(f)),f[t(f.length,1)]),c.neatJSON(JSON.parse(JSON.stringify(r.$to_n())),n.$to_n())},f.$$arity=-2)}(n[0],n)):a},Opal.modules["opal-ajv"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}var a=(e.top,[]),i=e.nil,s=(e.const_get_qualified,e.const_get_relative),o=(e.breaker,e.slice,e.module),c=e.klass,l=e.truthy,u=e.send,f=e.range,$=e.gvars,p=e.hash2,d=e.hash;return e.add_stubs(["$==","$add_schema","$_schema","$to_n","$each","$start_with?","$gsub","$[]","$push","$error","$new","$strict=","$-","$get","$keys","$validate","$validate_filenameparts","$select","$include?","$map","$keep_if","$group_by","$>","$length","$empty?","$+","$t","$join"]),function(a,h){var _=o(a,"Ajv"),m=[_].concat(h);!function(a,o,h){var _,m,y,g,v,b,x=c(a,null,"JsonValidator"),w=[x].concat(h);x.$$prototype.root=i,e.def(x,"$initialize",_=function(){var e=this,t=i;return t=i,t=(s(w,"OPAL_PLATFORM")["$=="]("nodejs"),Ajv),e.root=t({allErrors:!0,jsonPointers:!0,extendRefs:!0}),e.$add_schema(e.$_schema(),"zupfnoter")},_.$$arity=0),e.def(x,"$add_schema",m=function(e,t){return this.root.addSchema(e.$to_n(),t),i},m.$$arity=2),e.def(x,"$validate",y=function(e,t){var r,n=this,a=i,s=i,o=i;return a=!1,a=n.root.validate(e,t.$to_n()),s=[],l(a)||(o=n.root.errors,u(o,"each",[],(r=function(e){var t=(r.$$s,i),n=i;return null==$.log&&($.log=i),null==e&&(e=i),t=e.dataPath,l(t["$start_with?"]("/"))&&(t=t["$[]"](f(1,-1,!1)).$gsub("/",".")),s.$push(t),n=t+": "+e.message+"\n"+JSON.stringify(e.params,null," "),$.log.$error(n)},r.$$s=n,r.$$arity=1,r))),s},y.$$arity=2),e.def(x,"$validate_conf",g=function(r){var n,a=this,o=i,c=i,l=i;return o=s(w,"Confstack").$new(),c=[!1],u(o,"strict=",e.to_a(c)),c[t(c.length,1)],o.$push(r.$get()),l=o.$get("extract.0"),u(o.$get("extract").$keys(),"each",[],(n=function(e){n.$$s;return null==e&&(e=i),o.$push(p(["extract"],{extract:d(e,l)}))},n.$$s=a,n.$$arity=1,n)),o.$push(p(["extract"],{extract:r.$get("extract")})),o.$get(),a.$validate("zupfnoter",o.$get()),a.$validate_filenameparts(o)},g.$$arity=1),e.def(x,"$validate_filenameparts",v=function(e){var t,a,o,c,f,p=this,d=i,h=i,_=i,m=i;return null==$.log&&($.log=i),d=u(e.$keys(),"select",[],(t=function(e){t.$$s;return null==e&&(e=i),e["$include?"]("filenamepart")},t.$$s=p,t.$$arity=1,t)),h=u(d,"map",[],(a=function(t){a.$$s;return null==t&&(t=i),e["$[]"](t)},a.$$s=p,a.$$arity=1,a)),_=u(u(h,"group_by",[],(o=function(e){o.$$s;return null==e&&(e=i),e},o.$$s=p,o.$$arity=1,o)),"keep_if",[],(c=function(e,t){c.$$s;return null==e&&(e=i),null==t&&(t=i),r(t.$length(),1)},c.$$s=p,c.$$arity=2,c)).$keys(),l(_["$empty?"]())||(m=n(s(w,"I18n").$t("duplicate filenameparts"),": "+u(_,"map",[],(f=function(e){f.$$s;return null==e&&(e=i),'"'+e+'"'},f.$$s=p,f.$$arity=1,f)).$join(", ")),$.log.$error(m)),i},v.$$arity=1),e.def(x,"$_schema",b=function(){return p(["$schema","description","type","required","definitions","properties"],{$schema:"http://json-schema.org/draft-04/schema#",description:"Generated from x.json with shasum 0b1781e0803dc084178858e9fbe2b4e0b65c08e7",type:"object",required:["produce","abc_parser","restposition","wrap","defaults","templates","annotations","extract","layout","neatjson"],definitions:p(["apanchor","pos","notes_entry","minc_entry","nconf_entry","align","notebound_pos","notebound_repeat","annotated_bezier","extract_layout"],{apanchor:p(["type","enum"],{type:"string",enum:["manual","box","center"]}),pos:p(["type","minItems","uniqueItems","items"],{type:"array",minItems:2,uniqueItems:!1,items:p(["type"],{type:"number"})}),notes_entry:p(["type","required","properties"],{type:"object",required:["pos","text","style"],properties:p(["pos","text","align","style"],{pos:p(["$ref"],{$ref:"#/definitions/pos"}),text:p(["type"],{type:"string"}),align:p(["$ref"],{$ref:"#/definitions/align"}),style:p(["type"],{type:"string"})})}),minc_entry:p(["type","required","additionalProperties","properties"],{type:"object",required:["minc_f"],additionalProperties:!1,properties:p(["minc_f"],{minc_f:p(["type"],{type:"number"})})}),nconf_entry:p(["type","additionalProperties","patternProperties"],{type:"object",additionalProperties:!1,patternProperties:p(["t_d*"],{"t_d*":p(["type","additionalProperties","patternProperties"],{type:"object",additionalProperties:!1,patternProperties:p(["n_d*"],{"n_d*":p(["type","additionalProperties","properties"],{type:"object",additionalProperties:!1,properties:p(["nshift"],{nshift:p(["type"],{type:"number"})})})})})})}),align:p(["type","enum"],{type:"string",enum:["l","r","auto"]}),notebound_pos:p(["type","additionalProperties","patternProperties"],{type:"object",additionalProperties:!1,patternProperties:p(["v_d*"],{"v_d*":p(["type","additionalProperties","patternProperties"],{type:"object",additionalProperties:!1,patternProperties:p(["t_d*|d*"],{"t_d*|d*":p(["type","additionalProperties","properties"],{type:"object",additionalProperties:!1,properties:p(["pos","align"],{pos:p(["$ref"],{$ref:"#/definitions/pos"}),align:p(["$ref"],{$ref:"#/definitions/align"})})})})})})}),notebound_repeat:p(["type","additionalProperties","patternProperties"],{type:"object",additionalProperties:!1,patternProperties:p(["v_d*"],{"v_d*":p(["text","style","pos"],{text:"integer",style:p(["type"],{type:"string"}),pos:p(["$ref"],{$ref:"#/definitions/pos"})})})}),annotated_bezier:p(["type","properties"],{type:"object",properties:p(["cp1","cp2","pos","shape","show","style"],{cp1:p(["$ref"],{$ref:"#/definitions/pos"}),cp2:p(["$ref"],{$ref:"#/definitions/pos"}),pos:p(["$ref"],{$ref:"#/definitions/pos"}),shape:p(["type","minItems","uniqueItems","items"],{type:"array",minItems:0,uniqueItems:!0,items:p(["type"],{type:"string"})}),show:p(["type"],{type:"boolean"}),style:p(["type"],{type:"string"})})}),extract_layout:p(["type","requiredx","additionalProperties","properties"],{type:"object",requiredx:["limit_a3","LINE_THIN","LINE_MEDIUM","LINE_THICK","ELLIPSE_SIZE","REST_SIZE","grid"],additionalProperties:!1,properties:p(["limit_a3","beams","bottomup","jumpline_anchor","jumpline_vcut","LINE_THIN","LINE_MEDIUM","LINE_THICK","PITCH_OFFSET","X_SPACING","X_OFFSET","instrument","DRAWING_AREA_SIZE","ELLIPSE_SIZE","REST_SIZE","grid","color","packer"],{limit_a3:p(["type"],{type:"boolean"}),beams:p(["type"],{type:"boolean"}),bottomup:p(["type"],{type:"boolean"}),jumpline_anchor:p(["$ref"],{$ref:"#/definitions/pos"}),jumpline_vcut:p(["type"],{type:"number"}),LINE_THIN:p(["type"],{type:"number"}),LINE_MEDIUM:p(["type"],{type:"number"}),LINE_THICK:p(["type"],{type:"number"}),PITCH_OFFSET:p(["type"],{type:"integer"}),X_SPACING:p(["type"],{type:"number"}),X_OFFSET:p(["type"],{type:"number"}),instrument:p(["type"],{type:"string"}),DRAWING_AREA_SIZE:p(["type","minItems","items"],{type:"array",minItems:2,items:p(["type"],{type:"number"})}),ELLIPSE_SIZE:p(["type","minItems","items"],{type:"array",minItems:2,items:p(["type"],{type:"number"})}),REST_SIZE:p(["type","minItems","items"],{type:"array",minItems:2,items:p(["type"],{type:"number"})}),grid:p(["type"],{type:"boolean"}),color:p(["type","properties"],{type:"object",properties:p(["color_default","color_variant1","color_variant2"],{color_default:p(["type"],{type:"string"}),color_variant1:p(["type"],{type:"string"}),color_variant2:p(["type"],{type:"string"})})}),packer:p(["type","properties"],{type:"object",properties:p(["pack_method","pack_max_spread_factor","pack_min_increment"],{pack_method:p(["type"],{type:"integer"}),pack_max_spread_factor:p(["type"],{type:"number"}),pack_min_increment:p(["type"],{type:"number"})})})})})}),properties:p(["confstack","produce","template","abc_parser","restposition","wrap","defaults","templates","annotations","extract","layout","neatjson"],{confstack:p(["type","required","properties"],{type:"object",required:["env"],properties:p(["env"],{env:p(["type"],{type:"string"})})}),produce:p(["type","minItems","uniqueItems","items"],{type:"array",minItems:0,uniqueItems:!0,items:p(["type"],{type:"integer"})}),template:p(["type","additionalProperties","properties"],{type:"object",additionalProperties:!1,properties:p(["filebase","title"],{filebase:p(["type"],{type:"string"}),title:p(["type"],{type:"string"})})}),abc_parser:p(["type"],{type:"string"}),restposition:p(["type","additionalProperties","required","properties"],{type:"object",additionalProperties:!1,required:["default","repeatstart","repeatend"],properties:p(["default","repeatstart","repeatend"],{default:p(["type"],{type:"string"}),repeatstart:p(["type"],{type:"string"}),repeatend:p(["type"],{type:"string"})})}),wrap:p(["type"],{type:"integer"}),defaults:p(["type","required","properties"],{type:"object",required:["notebound"],properties:p(["notebound"],{notebound:p(["type","required","properties"],{type:"object",required:["annotation","partname","variantend","tuplet"],properties:p(["annotation","partname","variantend","tuplet"],{annotation:p(["type","required","properties"],{type:"object",required:["pos"],properties:p(["pos","style"],{pos:p(["$ref"],{$ref:"#/definitions/pos"}),style:p(["type"],{type:"string"})})}),partname:p(["type","required","properties"],{type:"object",required:["pos"],properties:p(["pos","style"],{pos:p(["$ref"],{$ref:"#/definitions/pos"}),style:p(["type"],{type:"string"})})}),variantend:p(["type","required","properties"],{type:"object",required:["pos"],properties:p(["pos","style"],{pos:p(["$ref"],{$ref:"#/definitions/pos"}),style:p(["type"],{type:"string"})})}),tuplet:p(["$ref","required"],{$ref:"#/definitions/annotated_bezier",required:["cp1","cp2","shape"]})})})})}),templates:p(["type","required","properties"],{type:"object",required:["notes","lyrics","tuplet","annotations"],properties:p(["notes","lyrics","tuplet","annotations"],{notes:p(["$ref"],{$ref:"#/definitions/notes_entry"}),lyrics:p(["type","required","properties"],{type:"object",required:["verses","pos"],properties:p(["verses","pos","style"],{verses:p(["type","minItems","uniqueItems","items"],{type:"array",minItems:1,uniqueItems:!0,items:p(["type"],{type:"integer"})}),pos:p(["$ref"],{$ref:"#/definitions/pos"}),style:p(["type"],{type:"string"})})}),tuplet:p(["type","required","properties"],{type:"object",required:["cp1","cp2","shape"],properties:p(["cp1","cp2","shape"],{cp1:p(["$ref"],{$ref:"#/definitions/pos"}),cp2:p(["$ref"],{$ref:"#/definitions/pos"}),shape:p(["type","minItems","uniqueItems","items"],{type:"array",minItems:1,uniqueItems:!0,items:p(["type"],{type:"string"})})})}),annotations:p(["type","required","properties"],{type:"object",required:["text","pos"],properties:p(["text","pos","style"],{text:p(["type"],{type:"string"}),pos:p(["$ref"],{$ref:"#/definitions/pos"}),style:p(["type"],{type:"string"})})})})}),annotations:p(["type","required","properties"],{type:"object",required:["vl","vt","vr"],properties:p(["vl","vt","vr"],{vl:p(["type","required","properties"],{type:"object",required:["text","pos"],properties:p(["text","pos"],{text:p(["type"],{type:"string"}),pos:p(["$ref"],{$ref:"#/definitions/pos"})})}),vt:p(["type","required","properties"],{type:"object",required:["text","pos"],properties:p(["text","pos"],{text:p(["type"],{type:"string"}),pos:p(["$ref"],{$ref:"#/definitions/pos"})})}),vr:p(["type","required","properties"],{type:"object",required:["text","pos"],properties:p(["text","pos"],{text:p(["type"],{type:"string"}),pos:p(["$ref"],{$ref:"#/definitions/pos"})})})})}),extract:p(["type","patternProperties"],{type:"object",patternProperties:p(["d*","4","5"],{"d*":p(["type","additionalProperties","requiredx","properties"],{type:"object",additionalProperties:!1,requiredx:["title","filenamepart","startpos","voices","synchlines","flowlines","subflowlines","jumplines","repeatsigns","layoutlines","legend","lyrics","layout","nonflowrest","notes","barnumbers","countnotes","stringnames","printer"],properties:p(["title","filenamepart","startpos","voices","synchlines","flowlines","subflowlines","jumplines","repeatsigns","layoutlines","legend","lyrics","layout","nonflowrest","notes","notebound","tuplets","barnumbers","countnotes","stringnames","sortmark","printer","images"],{title:p(["type"],{type:"string"}),filenamepart:p([],{}),startpos:p(["type"],{type:"integer"}),voices:p(["type","minItems","uniqueItems","items"],{type:"array",minItems:1,uniqueItems:!0,items:p(["type"],{type:"integer"})}),synchlines:p(["type","minItems","uniqueItems","items"],{type:"array",minItems:0,uniqueItems:!0,items:p(["type","minItems","uniqueItems","items"],{type:"array",minItems:1,uniqueItems:!0,items:p(["type"],{type:"integer"})})}),flowlines:p(["type","minItems","uniqueItems","items"],{type:"array",minItems:1,uniqueItems:!0,items:p(["type"],{type:"integer"})}),subflowlines:p(["type","minItems","uniqueItems","items"],{type:"array",minItems:1,uniqueItems:!0,items:p(["type"],{type:"integer"})}),jumplines:p(["type","minItems","uniqueItems","items"],{type:"array",minItems:1,uniqueItems:!0,items:p(["type"],{type:"integer"})}),repeatsigns:p(["type","requiredx","properties"],{type:"object",requiredx:["voices","left","right"],properties:p(["voices","left","right"],{voices:p(["type","minItems","uniqueItems","items"],{type:"array",minItems:0,uniqueItems:!0,items:p([],{})}),left:p(["type","required","properties"],{type:"object",required:["pos","text","style"],properties:p(["pos","text","style"],{pos:p(["$ref"],{$ref:"#/definitions/pos"}),text:p(["type"],{type:"string"}),style:p(["type"],{type:"string"})})}),right:p(["type","required","properties"],{type:"object",required:["pos","text","style"],properties:p(["pos","text","style"],{pos:p(["$ref"],{$ref:"#/definitions/pos"}),text:p(["type"],{type:"string"}),style:p(["type"],{type:"string"})})})})}),layoutlines:p(["type","minItems","uniqueItems","items"],{type:"array",minItems:0,uniqueItems:!0,items:p(["type"],{type:"integer"})}),legend:p(["type","required","properties"],{type:"object",required:["spos","pos"],properties:p(["spos","pos","align","style"],{spos:p(["$ref"],{$ref:"#/definitions/pos"}),pos:p(["$ref"],{$ref:"#/definitions/pos"}),align:p(["$ref"],{$ref:"#/definitions/align"}),style:p(["type"],{type:"string"})})}),lyrics:p(["type","patternProperties"],{type:"object",patternProperties:p([".*"],{".*":p(["type","required"],{type:"object",
required:["verses","pos"]})})}),layout:p(["$ref"],{$ref:"#/definitions/extract_layout"}),nonflowrest:p(["type"],{type:"boolean"}),notes:p(["patternProperties"],{patternProperties:p([".*"],{".*":p(["$ref"],{$ref:"#/definitions/notes_entry"})})}),notebound:p(["type","additionalProperties","properties"],{type:"object",additionalProperties:!1,properties:p(["annotation","barnumber","c_jumplines","countnote","decoration","flowline","minc","nconf","partname","repeat_begin","repeat_end","tuplet","variantend"],{annotation:p(["$ref"],{$ref:"#/definitions/notebound_pos"}),barnumber:p(["$ref","align"],{$ref:"#/definitions/notebound_pos",align:p(["$ref"],{$ref:"#/definitions/align"})}),c_jumplines:p(["type","additionalProperties","patternProperties"],{type:"object",additionalProperties:!1,patternProperties:p(["v_d*"],{"v_d*":p(["p_repeat","p_begin","p_end","p_follow"],{p_repeat:p(["type"],{type:"number"}),p_begin:p(["type"],{type:"number"}),p_end:p(["type"],{type:"number"}),p_follow:p(["type"],{type:"number"})})})}),countnote:p(["$ref"],{$ref:"#/definitions/notebound_pos"}),decoration:p(["$ref"],{$ref:"#/definitions/notebound_pos"}),flowline:p(["type","patternProperties"],{type:"object",patternProperties:p(["v_d+"],{"v_d+":p(["type","patternProperties"],{type:"object",patternProperties:p(["d*"],{"d*":p(["$ref"],{$ref:"#/definitions/annotated_bezier"})})})})}),minc:p(["type","additionalProperties","patternProperties"],{type:"object",additionalProperties:!1,patternProperties:p(["d*"],{"d*":p(["$ref"],{$ref:"#/definitions/minc_entry"})})}),nconf:p(["type","additionalProperties","patternProperties"],{type:"object",additionalProperties:!1,patternProperties:p(["v_d*"],{"v_d*":p(["$ref"],{$ref:"#/definitions/nconf_entry"})})}),partname:p(["$ref"],{$ref:"#/definitions/notebound_pos"}),repeat_begin:p(["$ref"],{$ref:"#/definitions/notebound_pos"}),repeat_end:p(["$ref"],{$ref:"#/definitions/notebound_repeat"}),tuplet:p(["type","patternProperties"],{type:"object",patternProperties:p(["v_d*"],{"v_d*":p(["type","patternProperties"],{type:"object",patternProperties:p(["d*"],{"d*":p(["$ref"],{$ref:"#/definitions/annotated_bezier"})})})})}),variantend:p(["$ref"],{$ref:"#/definitions/notebound_pos"})})}),tuplets:p(["type","properties"],{type:"object",properties:p(["text"],{text:p(["type"],{type:"string"})})}),barnumbers:p(["type","required","properties"],{type:"object",required:["voices","pos","autopos","style","prefix"],properties:p(["voices","pos","autopos","apanchor","style","prefix"],{voices:p(["type","minItems","uniqueItems","items"],{type:"array",minItems:0,uniqueItems:!0,items:p([],{})}),pos:p(["$ref"],{$ref:"#/definitions/pos"}),autopos:p(["type"],{type:"boolean"}),apanchor:p(["$ref"],{$ref:"#/definitions/apanchor"}),style:p(["type"],{type:"string"}),prefix:p(["type"],{type:"string"})})}),countnotes:p(["type","required","properties"],{type:"object",required:["voices","pos","autopos","style"],properties:p(["voices","pos","autopos","apanchor","style"],{voices:p(["type","minItems","uniqueItems","items"],{type:"array",minItems:0,uniqueItems:!0,items:p([],{})}),pos:p(["$ref"],{$ref:"#/definitions/pos"}),autopos:p(["type"],{type:"boolean"}),apanchor:p(["$ref"],{$ref:"#/definitions/apanchor"}),style:p(["type"],{type:"string"})})}),stringnames:p(["type","required","properties"],{type:"object",required:["text","vpos","style","marks"],properties:p(["text","vpos","style","marks"],{text:p(["type"],{type:"string"}),vpos:p(["type","minItems","uniqueItems","items"],{type:"array",minItems:0,uniqueItems:!0,items:p([],{})}),style:p(["type"],{type:"string"}),marks:p(["type","required","properties"],{type:"object",required:["vpos","hpos"],properties:p(["vpos","hpos"],{vpos:p(["type","minItems","uniqueItems","items"],{type:"array",minItems:1,uniqueItems:!0,items:p(["type"],{type:"integer"})}),hpos:p(["type","minItems","uniqueItems","items"],{type:"array",minItems:1,uniqueItems:!0,items:p(["type"],{type:"integer"})})})})})}),sortmark:p(["type","properties"],{type:"object",properties:p(["show"],{show:p(["type"],{type:"boolean"})})}),printer:p(["type","required","properties"],{type:"object",required:["a3_offset","a4_offset","show_border"],properties:p(["a3_offset","a4_offset","show_border"],{a3_offset:p(["type","minItems","axItems","uniqueItems","items"],{type:"array",minItems:2,axItems:2,uniqueItems:!1,items:p(["type"],{type:"integer"})}),a4_offset:p(["type","minItems","uniqueItems","items"],{type:"array",minItems:2,uniqueItems:!1,items:p(["type"],{type:"integer"})}),show_border:p(["type"],{type:"boolean"})})}),images:p(["type","patternProperties"],{type:"object",patternProperties:p(["d*"],{"d*":p(["type","properties"],{type:"object",properties:p(["imagename","show","pos","height"],{imagename:p(["type"],{type:"string"}),show:p(["type"],{type:"boolean"}),pos:p(["$ref"],{$ref:"#/definitions/pos"}),height:p(["type"],{type:"number"})})})})})})}),4:p(["type","required","properties"],{type:"object",required:["title","voices"],properties:p(["title","filenamepart","voices"],{title:p(["type"],{type:"string"}),filenamepart:p([],{}),voices:p(["type","minItems","uniqueItems","items"],{type:"array",minItems:1,uniqueItems:!0,items:p(["type"],{type:"integer"})})})}),5:p(["type","required","properties"],{type:"object",required:["title","voices"],properties:p(["title","filenamepart","voices"],{title:p(["type"],{type:"string"}),filenamepart:p([],{}),voices:p(["type","minItems","uniqueItems","items"],{type:"array",minItems:1,uniqueItems:!0,items:p(["type"],{type:"integer"})})})})})}),layout:p(["type","required","properties"],{type:"object",required:["grid","limit_a3","SHOW_SLUR","LINE_THIN","LINE_MEDIUM","LINE_THICK","ELLIPSE_SIZE","REST_SIZE","X_SPACING","X_OFFSET","Y_SCALE","DRAWING_AREA_SIZE","BEAT_RESOLUTION","SHORTEST_NOTE","BEAT_PER_DURATION","PITCH_OFFSET","FONT_STYLE_DEF","MM_PER_POINT","DURATION_TO_STYLE","REST_TO_GLYPH"],properties:p(["grid","limit_a3","SHOW_SLUR","LINE_THIN","LINE_MEDIUM","LINE_THICK","ELLIPSE_SIZE","REST_SIZE","X_SPACING","X_OFFSET","Y_SCALE","DRAWING_AREA_SIZE","BEAT_RESOLUTION","SHORTEST_NOTE","BEAT_PER_DURATION","PITCH_OFFSET","FONT_STYLE_DEF","MM_PER_POINT","DURATION_TO_STYLE","REST_TO_GLYPH"],{grid:p(["type"],{type:"boolean"}),limit_a3:p(["type"],{type:"boolean"}),SHOW_SLUR:p(["type"],{type:"boolean"}),LINE_THIN:p(["type"],{type:"number"}),LINE_MEDIUM:p(["type"],{type:"number"}),LINE_THICK:p(["type"],{type:"number"}),ELLIPSE_SIZE:p(["type","minItems","uniqueItems","items"],{type:"array",minItems:1,uniqueItems:!0,items:p(["type"],{type:"number"})}),REST_SIZE:p(["type","minItems","uniqueItems","items"],{type:"array",minItems:1,uniqueItems:!0,items:p(["type"],{type:"number"})}),X_SPACING:p(["type"],{type:"number"}),X_OFFSET:p(["type"],{type:"number"}),Y_SCALE:p(["type"],{type:"integer"}),DRAWING_AREA_SIZE:p(["type","minItems","uniqueItems","items"],{type:"array",minItems:1,uniqueItems:!0,items:p(["type"],{type:"integer"})}),BEAT_RESOLUTION:p(["type"],{type:"integer"}),SHORTEST_NOTE:p(["type"],{type:"integer"}),BEAT_PER_DURATION:p(["type"],{type:"integer"}),PITCH_OFFSET:p(["type"],{type:"integer"}),FONT_STYLE_DEF:p(["type","required","patternProperties"],{type:"object",required:["bold","italic","large","regular","small_bold","small_italic","small","smaller"],patternProperties:p([".*"],{".*":p(["type","required","properties"],{type:"object",required:["text_color","font_size","font_style"],properties:p(["text_color","font_size","font_style"],{text_color:p(["type","minItems","uniqueItems","items"],{type:"array",minItems:3,uniqueItems:!1,items:p(["type"],{type:"integer"})}),font_size:p(["type"],{type:"integer"}),font_style:p(["type"],{type:"string"})})})})}),MM_PER_POINT:p(["type"],{type:"number"}),DURATION_TO_STYLE:p(["type","required","patternProperties"],{type:"object",required:["err","d64","d48","d32","d24","d16","d12","d8","d6","d4","d3","d2","d1"],patternProperties:p([".*"],{".*":p(["type","minItems","uniqueItems","items"],{type:"array",minItems:3,uniqueItems:!1,items:p(["type"],{type:["number","string","boolean"]})})})}),REST_TO_GLYPH:p(["type","patternProperties"],{type:"object",patternProperties:p([".*"],{".*":p(["type","minItems","uniqueItems","items"],{type:"array",minItems:1,uniqueItems:!0,items:[p(["type","minItems","uniqueItems","items"],{type:"array",minItems:1,uniqueItems:!1,items:p(["type"],{type:"number"})}),p(["type"],{type:"string"}),p(["type"],{type:"boolean"})]})})})})}),neatjson:p(["type","required","properties"],{type:"object",required:["wrap","aligned","after_comma","after_colon_1","after_colon_n","before_colon_n","explicit_sort"],properties:p(["wrap","aligned","after_comma","after_colon_1","after_colon_n","before_colon_n","sorted","explicit_sort"],{wrap:p(["type"],{type:"integer"}),aligned:p(["type"],{type:"boolean"}),after_comma:p(["type"],{type:"integer"}),after_colon_1:p(["type"],{type:"integer"}),after_colon_n:p(["type"],{type:"integer"}),before_colon_n:p(["type"],{type:"integer"}),sorted:p(["type"],{type:"boolean"}),explicit_sort:p(["type"],{type:"object"})})})})})},b.$$arity=0)}(m[0],0,m)}(a[0],a)},Opal.modules.consolelogger=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e<=t:e["$<="](t)}function a(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}var i=(e.top,[]),s=e.nil,o=(e.const_get_qualified,e.const_get_relative),c=(e.breaker,e.slice,e.hash2),l=e.klass,u=e.send,f=e.truthy,$=e.gvars;return e.add_stubs(["$attr_reader","$[]","$now","$clear_errors","$clear_annotations","$send","$push","$add_annotation","$==","$loglevel","$join","$write","$loglevel?","$info","$-","$>","$count","$call","$to_sym","$message","$invert","$<=","$keys","$private","$first","$+","$last","$<<","$strftime","$puts","$write_html"]),e.const_set(i[0],"LOGLEVELS",c(["message","error","warning","info","debug"],{message:0,error:1,warning:2,info:3,debug:4})),e.const_set(i[0],"LOGICONS",c(["message","error","warning","info","debug"],{message:"icon-info-circled",error:"icon-error-alt",warning:"icon-attention",info:"icon-info-circled",debug:"icon-minus-squared"})),function(i,p,d){var h,_,m,y,g,v,b,x,w,A,k,E,S,N,C,I,O,L,P,M,T,B,j,F=l(i,null,"Logger"),R=[F].concat(d);F.$$prototype.captured_errors=F.$$prototype.timestamp=F.$$prototype.annotations=F.$$prototype.loglevel=s,F.$attr_reader("annotations"),e.def(F,"$clear_annotations",h=function(){return this.annotations=[]},h.$$arity=0),e.def(F,"$initialize",_=function(e){var t=this;return t.console=e,t.loglevel=o(R,"LOGLEVELS")["$[]"]("info"),t.timestamp=o(R,"Time").$now(),t.$clear_errors(),t.$clear_annotations()},_.$$arity=1),e.def(F,"$clear_annotations",m=function(){return this.annotations=[]},m.$$arity=0),e.def(F,"$log_from_worker",y=function(t){return u(this,"send",[t["$[]"]("type")].concat(e.to_a(t["$[]"]("args"))))},y.$$arity=1),e.def(F,"$error",g=function(e,t,r,n){var a=this,i=s;return null==t&&(t=s),null==r&&(r=s),null==n&&(n=[]),a.captured_errors.$push(e),a.$add_annotation(e,t,r,"error"),a.$loglevel()["$=="]("debug")&&(i=n.$join("\n")),a.$write("error",""+e+i)},g.$$arity=-2),e.def(F,"$warning",v=function(e,t,r){var n=this;return null==t&&(t=s),null==r&&(r=s),f(n["$loglevel?"]("warning"))&&n.$add_annotation(e,t,r,"warning"),n.$write("warning",e)},v.$$arity=-2),e.def(F,"$info",b=function(e,t,r){var n=this;return null==t&&(t=s),null==r&&(r=s),n.$add_annotation(e,t,r,"info"),n.$write("info",e)},b.$$arity=-2),e.def(F,"$debug",x=function(e,t,r){var n=this;return null==t&&(t=s),null==r&&(r=s),n.$add_annotation(e,t,r,"debug"),n.$write("debug",e)},x.$$arity=-2),e.def(F,"$message",w=function(e,t,r){var n=this;return null==t&&(t=s),null==r&&(r=s),n.$add_annotation(e,t,r,"message"),n.$write("message",e)},w.$$arity=-2),e.def(F,"$timestamp",A=function(e,r,n){var a=this;return null==$.log&&($.log=s),null==r&&(r=s),null==n&&(n=s),$.log.$info("Timestamp "+t(o(R,"Time").$now(),a.timestamp)+" sec: "+e)},A.$$arity=-2),e.def(F,"$timestamp_start",k=function(){return this.timestamp=o(R,"Time").$now()},k.$$arity=0),e.def(F,"$clear_errors",E=function(){return this.captured_errors=[]},E.$$arity=0),e.def(F,"$has_errors?",S=function(){return r(this.captured_errors.$count(),0)},S.$$arity=0),e.def(F,"$get_errors",N=function(){return this.captured_errors},N.$$arity=0),e.def(F,"$get_status",C=function(){var e=this;return c(["annotations","captured_errors"],{annotations:e.annotations,captured_errors:e.captured_errors})},C.$$arity=0),e.def(F,"$set_status",I=function(e){var t=this;return t.annotations=e["$[]"]("annotations"),t.captured_errors=e["$[]"]("captured_errors")},I.$$arity=1),e.def(F,"$benchmark",O=function(e){var r=O.$$p,n=r||s,a=s,i=s;return null==$.log&&($.log=s),r&&(O.$$p=null),r&&(O.$$p=null),a=o(R,"Time").$now(),i=n.$call(),$.log.$info("  elapsed "+t(o(R,"Time").$now(),a)+" sec for "+e),i},O.$$arity=1),e.def(F,"$loglevel=",L=function(e){var t,r=this;return null==$.log&&($.log=s),r.loglevel=f(t=o(R,"LOGLEVELS")["$[]"](e.$to_sym()))?t:o(R,"LOGLEVELS")["$[]"]("debug"),$.log.$message("logging messages up to "+o(R,"LOGLEVELS").$invert()["$[]"](r.loglevel))},L.$$arity=1),e.def(F,"$loglevel",P=function(){var e=this;return o(R,"LOGLEVELS").$invert()["$[]"](e.loglevel)},P.$$arity=0),e.def(F,"$loglevel?",M=function(e){var t,r=this;return n(f(t=o(R,"LOGLEVELS")["$[]"](e))?t:o(R,"LOGLEVELS")["$[]"]("warning"),r.loglevel)},M.$$arity=1),e.def(F,"$loglevels",T=function(){return o(R,"LOGLEVELS").$keys()},T.$$arity=0),F.$private(),e.def(F,"$add_annotation",B=function(e,t,r,n){var i,o=this,l=s,u=s;return f(t)&&(l=t,u=f(i=r)?i:[l.$first(),a(l.$last(),1)],o.annotations["$<<"](c(["start_pos","end_pos","text","type"],{start_pos:l,end_pos:u,text:e,type:n}))),s},B.$$arity=4),e.def(F,"$write",j=function(e,t){var r=this;return f(r["$loglevel?"](e))?(o(R,"Time").$now().$strftime("%H:%M:%S"),r.$puts(t)):s},j.$$arity=2)}(i[0],0,i),function(t,r,a){var i,c=l(t,r,"NodeLogger"),u=[c].concat(a);c.$$prototype.loglevel=s,e.def(c,"$write",i=function(e,t){var r,a=this,i=s;return i=f(r=o(u,"LOGLEVELS")["$[]"](e))?r:o(u,"LOGLEVELS")["$[]"]("warning"),f(n(i,a.loglevel))?(o(u,"Time").$now().$strftime("%H:%M:%S"),a.$puts(t)):s},i.$$arity=2)}(i[0],o(i,"Logger"),i),function(t,r,a){var i,c,$=l(t,r,"ConsoleLogger"),p=[$].concat(a);return $.$$prototype.loglevel=$.$$prototype.console=s,e.def($,"$initialize",i=function(t){var r=i.$$p,n=this,a=s,o=s,c=s;for(r&&(i.$$p=null),o=0,c=arguments.length,a=new Array(c);o<c;o++)a[o]=arguments[o];return u(n,e.find_super_dispatcher(n,"initialize",i,!1),a,r),n.console=t},i.$$arity=1),e.def($,"$write",c=function(e,t){var r,a=this,i=s,c=s;return i=f(r=o(p,"LOGLEVELS")["$[]"](e))?r:o(p,"LOGLEVELS")["$[]"]("warning"),f(n(i,a.loglevel))?(c=o(p,"Time").$now().$strftime("%H:%M:%S"),a.console.$write_html("<li class='"+e+"'><i class=\""+o(p,"LOGICONS")["$[]"](e)+"\"><span class='time'>"+c+"</span><span class='msg'>"+t+"</span></li>"),a.$puts(t)):s},c.$$arity=2),s&&"write"}(i[0],o(i,"Logger"),i)},Opal.modules.harpnotes=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e/t:e["$/"](t)}function a(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}function i(e,t){return"number"==typeof e&&"number"==typeof t?e*t:e["$*"](t)}function s(e,t){return"number"==typeof e&&"number"==typeof t?e<t:e["$<"](t)}function o(e,t){return"number"==typeof e&&"number"==typeof t?e<=t:e["$<="](t)}function c(e,t){return"number"==typeof e&&"number"==typeof t?e>=t:e["$>="](t)}var l=(e.top,[]),u=e.nil,f=e.const_get_qualified,$=e.const_get_relative,p=(e.breaker,e.slice,e.module),d=e.klass,h=e.send,_=e.truthy,m=e.hash2,y=e.gvars,g=e.hash,v=e.range;return e.add_stubs(["$attr_accessor","$first","$last","$to_json","$[]","$+","$class","$map","$-","$instance_variables","$instance_variable_get","$is_a?","$raise","$pitch","$beat","$duration","$first_in_part","$attr_reader","$nil?","$uniq","$flatten","$measure_start","$proxy_note","$alias_method","$each","$beat=","$get_proxy_object","$variant","$sheet_drawable","$prev_playable","$prev_playable=","$next_playable","$next_playable=","$!","$companion=","$visible?","$update_beats","$<<","$compact","$expanded_beat_maps","$select","$left","$right","$product","$min_by","$abs","$new","$max","$keys","$last_beat","$private","$inject","$index","$/","$time","$floor","$>","$start_pos","$error","$tuplet","$[]=","$index=","$==","$reset","$_check1","$center","$size","$conf_key","$origin","$_rect_overlap?","$empty?","$warning","$t","$count","$push","$shapes","$get","$clone","$dotted?","$dotted","$gsub","$length","$strip","$*","$to_f","$include","$set_instrument_handlers","$lambda","$===","$each_with_index","$split","$to_i","$line_width=","$call","$join","$tap","$Vector2d","$conf_key=","$conf_value=","$draginfo=","$%","$get_print_options","$initialize","$layout_debug_grid","$layout_images","$benchmark","$compute_beat_compression","$values","$<","$min","$include?","$build_synch_points","$synched_notes","$voices","$layout_voice","$loglevel?","$check_annotations","$notes","$compute_color_by_variant_no","$color=","$layout_stringnames","$meta_data","$align=","$strftime","$now","$checksum","$harpnote_options","$squeeze","$delete","$layout_sortmark","$resolve_placeholder","$message","$printer_config=","$pop","$strict=","$upcase","$ord","$-@","$make_sheetmark_path","$to_a","$<=>","$visible=","$visible","$layout_playable","$proxy","$decorations","$make_decorations_per_playable","$more_conf_keys","$layout_barnumbers_countnotes","$znid","$make_annotated_bezier_path","$first_in_part?","$tuplet_start?","$tuplet_end?","$round","$to_s","$tie_end?","$make_slur_path","$tie_start?","$slur_starts","$slur_ends","$policy","$debug","$from","$to","$compute_vertical_cut","$make_path_from_jumpline","$make_repeatsign_annotation","$position","$style","$companion","$text","$<=","$next_pitch","$prev_pitch","$&","$size_with_dot","$reverse","$compute_note_position","$count_note","$!=","$measure_start?","$measure_count","$compute_beat_compression_1","$compute_beat_compression_2","$compute_beat_compression_10","$compute_beat_compression_0","$group_by","$sort","$beat_maps","$duration_to_id","$get_minc_factor","$notes_on_beat","$>=","$next_first_in_part","$layout_note","$layout_accord","$layout_pause","$convert_pitch_to_xpos","$compute_ellipse_properties_from_note","$layout_note_shift","$sheet_drawable=","$layout_note_flags","$times","$odd?","$check_duration","$shift","$sort_by","$unshift","$x","$y","$normalize","$to_sym","$start_pos_to_s","$end_pos","$rotate","$angle","$perpendicular","$scan"]),function(l,b){var x=p(l,"Harpnotes"),w=[x].concat(b);!function(i,s){var o=p(i,"Music"),c=[o].concat(s);!function(n,a,i){var s,o,c,l,f=d(n,null,"MusicEntity"),p=[f].concat(i);f.$$prototype.visible=f.$$prototype.start_pos=u,f.$attr_accessor("beat","conf_key","count_note","decorations","end_pos","next_pitch","next_first_in_part","next_playable","prev_pitch","prev_playable","start_pos","time","endtime","visible","variant","znid","origin","sheet_drawable"),e.def(f,"$initialize",s=function(){var e=this;return e.visible=!0,e.origin=[u,e.decorations=[]]},s.$$arity=0),e.def(f,"$visible?",o=function(){return this.visible},o.$$arity=0),e.def(f,"$start_pos_to_s",c=function(){var e=this;return"["+e.start_pos.$first()+":"+e.start_pos.$last()+"]"},c.$$arity=0),e.def(f,"$to_json",l=function(){var e,n=this;return $(p,"Hash")["$[]"](t([["class",n.$class()]],h(r(n.$instance_variables(),["@constructor","@toString"]),"map",[],(e=function(t){var r=e.$$s||this;return null==t&&(t=u),[t,r.$instance_variable_get(t)]},e.$$s=n,e.$$arity=1,e)))).$to_json()},l.$$arity=0)}(c[0],0,c),function(t,r,n){var a,i,s,o,c=d(t,r,"NonPlayable"),l=[c].concat(n);c.$$prototype.companion=u,c.$attr_accessor("companion"),e.def(c,"$companion=",a=function(e){var t=this;return _(e["$is_a?"](f(f($(l,"Harpnotes"),"Music"),"Playable")))||t.$raise("Companion must be playable"),t.companion=e},a.$$arity=1),e.def(c,"$pitch",i=function(){var t=this;try{return t.companion.$pitch()}catch(t){if(!e.rescue(t,[$(l,"StandardError")]))throw t;try{return u}finally{e.pop_exception()}}},i.$$arity=0),e.def(c,"$beat",s=function(){var t=this;try{return t.companion.$beat()}catch(t){if(!e.rescue(t,[$(l,"StandardError")]))throw t;try{return u}finally{e.pop_exception()}}},s.$$arity=0),e.def(c,"$duration",o=function(){var t=this;try{return t.companion.$duration()}catch(t){if(!e.rescue(t,[$(l,"StandardError")]))throw t;try{return u}finally{e.pop_exception()}}},o.$$arity=0)}(c[0],$(c,"MusicEntity"),c),function(t,r,n){var a,i,s,o,c,l,f,$,p,_,m=d(t,r,"Playable");[m].concat(n);m.$$prototype.tie_end=m.$$prototype.tie_start=m.$$prototype.tuplet_start=m.$$prototype.tuplet_end=m.$$prototype.measure_start=u,m.$attr_accessor("first_in_part","jump_starts","jump_ends","slur_starts","slur_ends","tie_start","tie_end","duration","tuplet","tuplet_start","tuplet_end","shift","count_note","measure_count","measure_start"),e.def(m,"$initialize",a=function(){var t=a.$$p,r=this,n=u,i=u,s=u;for(t&&(a.$$p=null),i=0,s=arguments.length,n=new Array(s);i<s;i++)n[i]=arguments[i];return h(r,e.find_super_dispatcher(r,"initialize",a,!1),n,t),r.slur_starts=[],r.slur_ends=[],r.tie_start=!1,r.tie_end=!1,r.tuplet=1,r.tuplet_start=!1,r.tuplet_end=!1,r.count_note=u},a.$$arity=0),e.def(m,"$first_in_part?",i=function(){return this.$first_in_part()},i.$$arity=0),e.def(m,"$tie_end?",s=function(){return this.tie_end},s.$$arity=0),e.def(m,"$tie_start?",o=function(){return this.tie_start},o.$$arity=0),e.def(m,"$tuplet_start?",c=function(){return this.tuplet_start},c.$$arity=0),e.def(m,"$tuplet_end?",l=function(){return this.tuplet_end},l.$$arity=0),e.def(m,"$measure_start?",f=function(){return this.measure_start},f.$$arity=0),e.def(m,"$proxy_note",$=function(){return this},$.$$arity=0),e.def(m,"$left",p=function(){return this},p.$$arity=0),e.def(m,"$right",_=function(){return this},_.$$arity=0)}(c[0],$(c,"MusicEntity"),c),function(t,r,n){var a,i=d(t,r,"Note");[i].concat(n);i.$attr_reader("pitch","duration"),e.def(i,"$initialize",a=function(t,r){var n=a.$$p,i=this;return n&&(a.$$p=null),h(i,e.find_super_dispatcher(i,"initialize",a,!1),[],null),_(t["$nil?"]())&&i.$raise("trying to create a note with undefined pitch"),i.pitch=t,i.next_pitch=t,i.next_playable=i,i.prev_pitch=t,i.prev_playable=i,i.duration=r},a.$$arity=2)}(c[0],$(c,"Playable"),c),function(t,n,a){var i,s,o,c,l,f,p,m,y,g,v,b,x,w,A,k=d(t,n,"SynchPoint"),E=[k].concat(a);k.$$prototype.notes=u,k.$attr_reader("notes","synched_notes"),e.def(k,"$initialize",i=function(t,r){var n=i.$$p,a=this;return n&&(i.$$p=null),null==r&&(r=[]),h(a,e.find_super_dispatcher(a,"initialize",i,!1),[],null),_(t["$is_a?"]($(E,"Array")))||a.$raise("Notes must be an array"),a.notes=t,a.synched_notes=[t,r].$flatten().$uniq()},i.$$arity=-2),e.def(k,"$measure_start",s=function(){return this.$proxy_note().$measure_start()},s.$$arity=0),k.$alias_method("measure_start?","measure_start"),e.def(k,"$duration",o=function(){return this.$proxy_note().$duration()},o.$$arity=0),e.def(k,"$beat=",c=function(t){var n,a=this;return a.beat=t,h(a.notes,"each",[],(n=function(a){var i=(n.$$s,u);return null==a&&(a=u),i=[t],h(a,"beat=",e.to_a(i)),i[r(i.length,1)]},n.$$s=a,n.$$arity=1,n))},c.$$arity=1),e.def(k,"$pitch",l=function(){return this.$proxy_note().$pitch()},l.$$arity=0),e.def(k,"$proxy_note",f=function(){var e=this;return e.$get_proxy_object(e.notes)},f.$$arity=0),e.def(k,"$variant",p=function(){return this.$proxy_note().$variant()},p.$$arity=0),e.def(k,"$sheet_drawable",m=function(){return this.$proxy_note().$sheet_drawable()},m.$$arity=0),e.def(k,"$prev_playable",y=function(){return this.$proxy_note().$prev_playable()},y.$$arity=0),e.def(k,"$prev_playable=",g=function(t){var n=this,a=u;return a=[t],h(n.$proxy_note(),"prev_playable=",e.to_a(a)),a[r(a.length,1)]},g.$$arity=1),e.def(k,"$next_playable",v=function(){return this.$proxy_note().$next_playable()},v.$$arity=0),e.def(k,"$next_playable=",b=function(t){var n=this,a=u;return a=[t],h(n.$proxy_note(),"next_playable=",e.to_a(a)),a[r(a.length,1)]},b.$$arity=1),e.def(k,"$get_proxy_object",x=function(e){return e.$last()},x.$$arity=1),e.def(k,"$left",w=function(){return this.notes.$first()},w.$$arity=0),e.def(k,"$right",A=function(){return this.notes.$last()},A.$$arity=0)}(c[0],$(c,"Playable"),c),function(t,r,n){var a,i,s,o=d(t,r,"Pause");[o].concat(n);o.$$prototype.visible=o.$$prototype.invisible=u,o.$attr_accessor("duration","pitch"),o.$attr_accessor("invisible"),e.def(o,"$initialize",a=function(t,r){var n=a.$$p,i=this;return n&&(a.$$p=null),h(i,e.find_super_dispatcher(i,"initialize",a,!1),[],null),_(t["$nil?"]())&&i.$raise("trying to create a rest with undefined pitch"),i.pitch=t,i.duration=r,i.next_playable=i,i.prev_pitch=t,i.prev_playable=i},a.$$arity=2),e.def(o,"$visible=",i=function(e){return this.visible=e},i.$$arity=1),e.def(o,"$visible?",s=function(){var e,t=this;return _(e=t.visible)?t.invisible["$!"]():e},s.$$arity=0)}(c[0],$(c,"Playable"),c),function(t,n,a){var i,s=d(t,n,"MeasureStart");[s].concat(a);e.def(s,"$initialize",i=function(t){var n=i.$$p,a=this,s=u;return n&&(i.$$p=null),h(a,e.find_super_dispatcher(a,"initialize",i,!1),[],null),s=[t],h(a,"companion=",e.to_a(s)),s[r(s.length,1)],a.visible=t["$visible?"]()},i.$$arity=1)}(c[0],$(c,"NonPlayable"),c),function(t,r,n){var a,i=d(t,r,"NewPart");[i].concat(n);i.$attr_reader("name"),e.def(i,"$initialize",a=function(t,r){var n=a.$$p,i=this;return n&&(a.$$p=null),null==r&&(r=u),h(i,e.find_super_dispatcher(i,"initialize",a,!1),[],null),i.conf_key=r,i.name=t},a.$$arity=-2)}(c[0],$(c,"NonPlayable"),c),function(t,n,a){var i,s,o,c,l,f=d(t,n,"NoteBoundAnnotation");[f].concat(a);f.$$prototype.annotations=u,e.def(f,"$initialize",i=function(t,n,a){var s=i.$$p,o=this,c=u;return s&&(i.$$p=null),null==a&&(a=u),h(o,e.find_super_dispatcher(o,"initialize",i,!1),[],null),c=[t],h(o,"companion=",e.to_a(c)),c[r(c.length,1)],o.conf_key=a,o.annotations=n},i.$$arity=-3),e.def(f,"$style",s=function(){var e;return _(e=this.annotations["$[]"]("style"))?e:"regular"},s.$$arity=0),e.def(f,"$text",o=function(){return this.annotations["$[]"]("text")},o.$$arity=0),e.def(f,"$position",c=function(){return this.annotations["$[]"]("pos")},c.$$arity=0),e.def(f,"$policy",l=function(){return this.annotations["$[]"]("policy")},l.$$arity=0)}(c[0],$(c,"NonPlayable"),c),function(t,r,n){var a,i=d(t,r,"Goto"),s=[i].concat(n);i.$attr_reader("from","to","policy"),e.def(i,"$initialize",a=function(t,r,n){var i=a.$$p,o=this;return i&&(a.$$p=null),h(o,e.find_super_dispatcher(o,"initialize",a,!1),[],null),_(t["$is_a?"](f(f($(s,"Harpnotes"),"Music"),"Playable")))||o.$raise("End point of Jump ("+t.$class()+") must be a Playable"),_(r["$is_a?"](f(f($(s,"Harpnotes"),"Music"),"Playable")))||o.$raise("Start point of Jump ("+r.$class()+") must be a Playable"),o.from=t,o.to=r,o.policy=n,o.conf_key=n["$[]"]("conf_key")},a.$$arity=3)}(c[0],$(c,"MusicEntity"),c),function(t,r,n){var a,i=d(t,r,"BeatMap");[i].concat(n);i.$attr_accessor("index"),e.def(i,"$initialize",a=function(e){return this.index=e},a.$$arity=1)}(c[0],$(c,"Hash"),c),function(t,i,s){var o,c,l,f,p,g,v,b=d(t,null,"Song"),x=[b].concat(s);b.$$prototype.voices=b.$$prototype.beat_maps=b.$$prototype.meta_data=b.$$prototype.harpnote_options=u,b.$attr_reader("voices","beat_maps"),b.$attr_accessor("meta_data","harpnote_options","checksum"),e.def(b,"$to_json",o=function(){var e=this;return m(["voices","beat_maps","meta_data","harpnote_options"],{voices:e.voices,beat_maps:e.beat_maps,meta_data:e.meta_data,harpnote_options:e.harpnote_options}).$to_json()},o.$$arity=0),e.def(b,"$initialize",c=function(e,t,r){var n=this;return null==e&&(e=[]),null==t&&(t=8),null==r&&(r=m([],{})),n.voices=e,n.note_length_in_beats=t,n.meta_data=r,n.views=[],n.$update_beats()},c.$$arity=-1),e.def(b,"$<<",l=function(e){var t=this;return t.voices["$<<"](e),t.$update_beats()},l.$$arity=1),e.def(b,"$build_synch_points",f=function(e){var t,n=this;return null==e&&(e=u),h(n.$expanded_beat_maps(),"map",[],(t=function(n){var a,i,s,o=t.$$s||this,c=u,l=u,f=u,p=u,d=u,m=u,y=u,g=u,v=u,b=u;return null==n&&(n=u),c=h([n["$[]"](e.$first()),n["$[]"](e.$last())].$compact(),"select",[],(a=function(e){a.$$s;return null==e&&(e=u),e["$visible?"]()},a.$$s=o,a.$$arity=1,a)),l=c["$[]"](0),f=c["$[]"](1),_(_(i=l)?f:i)&&(p=l.$left(),d=l.$right(),m=f.$left(),y=f.$right(),g=[p,d].$product([m,y])),_(g)&&(v=h(g,"min_by",[],(s=function(e){s.$$s;return null==e&&(e=u),r(e.$last().$pitch(),e.$first().$pitch()).$abs()},s.$$s=o,s.$$arity=1,s)),b=$(x,"SynchPoint").$new(v,g)),b},t.$$s=n,t.$$arity=1,t)).$flatten().$compact()},f.$$arity=-1),e.def(b,"$last_beat",p=function(){var e,t=this;return h(t.beat_maps,"map",[],(e=function(t){var r;e.$$s;return null==t&&(t=u),_(r=t.$keys().$max())?r:0},e.$$s=t,e.$$arity=1,e)).$max()},p.$$arity=0),e.def(b,"$expanded_beat_maps",g=function(){var t,r=this;return h(e.Range.$new(0,r.$last_beat(),!1),"map",[],(t=function(e){var r,n=t.$$s||this;return null==n.beat_maps&&(n.beat_maps=u),null==e&&(e=u),h(n.beat_maps,"map",[],(r=function(t){r.$$s;return null==t&&(t=u),t["$[]"](e)},r.$$s=n,r.$$arity=1,r))},t.$$s=r,t.$$arity=1,t))},g.$$arity=0),b.$private(),e.def(b,"$update_beats",v=function(){var t,i=this;return i.beat_maps=h(i.voices,"map",[],(t=function(i){var s,o,c=t.$$s||this,l=u;return null==i&&(i=u),l=0,h(h(i,"select",[],(s=function(e){s.$$s;return null==e&&(e=u),e["$is_a?"]($(x,"Playable"))},s.$$s=c,s.$$arity=1,s)),"inject",[$(x,"BeatMap").$new(i.$index())],(o=function(t,s){var c=(o.$$s,u),f=u,$=u,p=u;return null==y.log&&(y.log=u),null==t&&(t=u),null==s&&(s=u),l=n(s.$time(),8),c=l.$floor(0),f=r(l,c),_(a(f,0))&&($=s.$start_pos(),y.log.$error("unsupported tuplet "+s.$tuplet()+" "+f,$),l=c),p=[l,s],h(t,"[]=",e.to_a(p)),p[r(p.length,1)],p=[l],h(s,"beat=",e.to_a(p)),p[r(p.length,1)],p=[i.$index()],h(t,"index=",e.to_a(p)),p[r(p.length,1)],t},o.$$s=c,o.$$arity=2,o))},t.$$s=i,t.$$arity=1,t)),u},v.$$arity=0)}(c[0],0,c),function(t,r,n){var a,i,s,o,c=d(t,r,"Voice");[c].concat(n);c.$$prototype.show_voice=c.$$prototype.show_flowline=c.$$prototype.show_jumpline=u,c.$attr_accessor("index","name","show_voice","show_flowline","show_jumpline"),e.def(c,"$initialize",a=function(){var t=a.$$p,r=this,n=u,i=u,s=u;for(t&&(a.$$p=null),i=0,s=arguments.length,n=new Array(s);i<s;i++)n[i]=arguments[i];return r.show_voice=!0,r.show_flowline=!0,r.show_jumpline=!0,h(r,e.find_super_dispatcher(r,"initialize",a,!1),n,t)},a.$$arity=0),e.def(c,"$show_voice?",i=function(){return this.show_voice["$=="](!0)},i.$$arity=0),e.def(c,"$show_flowline?",s=function(){return this.show_flowline["$=="](!0)},s.$$arity=0),e.def(c,"$show_jumpline?",o=function(){return this.show_jumpline["$=="](!0)},o.$$arity=0)}(c[0],$(c,"Array"),c)}(w[0],w),function(n,s){var o=p(n,"Drawing"),c=[o].concat(s);!function(r,n,i){var s,o,c,l,f,p=d(r,null,"CollisionDetector"),m=[p].concat(i);p.$$prototype.coll_stack=u,e.def(p,"$initialize",s=function(){return this.$reset()},s.$$arity=0),e.def(p,"$check_annotations",o=function(e){var t,r,n=this;return h(h(e,"select",[],(t=function(e){t.$$s;return null==e&&(e=u),e["$is_a?"]($(m,"Annotation"))},t.$$s=n,t.$$arity=1,t)),"each",[],(r=function(e){var t=r.$$s||this;return null==e&&(e=u),t.$_check1(e.$center(),e.$size(),e.$conf_key(),e.$origin())},r.$$s=n,r.$$arity=1,r))},o.$$arity=1),e.def(p,"$reset",c=function(){return this.coll_stack=[]},c.$$arity=0),e.def(p,"$_check1",l=function(r,n,a,i){var s,o,c,l=this,f=u,p=u,d=u,g=u,v=u,b=u,x=u;if(null==y.log&&(y.log=u),o=r,s=e.to_ary(o),f=null==s[0]?u:s[0],p=null==s[1]?u:s[1],o=n,s=e.to_ary(o),d=null==s[0]?u:s[0],g=null==s[1]?u:s[1],v=[f,p,t(f,d),t(p,g)],b=h(l.coll_stack,"select",[],(c=function(e){var t=c.$$s||this;return null==e&&(e=u),t["$_rect_overlap?"](e,v)},c.$$s=l,c.$$arity=1,c)),x=[0,0],_(b["$empty?"]()));else{try{
x=i["$[]"]("start_pos")}catch(t){if(!e.rescue(t,[$(m,"StandardError")]))throw t;try{y.log.$error("BUG: Annotation without origin "+"./harpnotes.rb".$force_encoding("US-ASCII")+" 749")}finally{e.pop_exception()}}y.log.$warning(t($(m,"I18n").$t("annotations too close ["),b.$count()+"] "+a),x)}return l.coll_stack.$push(v),r},l.$$arity=4),e.def(p,"$_rect_overlap?",f=function(t,r){var n,i,s,o=u,c=u,l=u,f=u,$=u,p=u,d=u,h=u;return i=t,n=e.to_ary(i),o=null==n[0]?u:n[0],c=null==n[1]?u:n[1],l=null==n[2]?u:n[2],f=null==n[3]?u:n[3],i=r,n=e.to_ary(i),$=null==n[0]?u:n[0],p=null==n[1]?u:n[1],d=null==n[2]?u:n[2],h=null==n[3]?u:n[3],_(n=_(i=_(s=a(l,$))?a(d,o):s)?a(f,p):i)?a(h,c):n},f.$$arity=2)}(c[0],0,c),function(t,r,n){var a,i=d(t,null,"Sheet");[i].concat(n);i.$attr_reader("children","active_voices"),i.$attr_accessor("printer_config"),e.def(i,"$initialize",a=function(e,t){var r=this;return null==y.conf&&(y.conf=u),r.children=e,r.active_voices=t,r.printer_config=y.conf["$[]"]("printer")},a.$$arity=2)}(c[0],0,c),function(r,n,a){var i,s,o,c=d(r,null,"CompoundDrawable");[c].concat(a);c.$$prototype.shapes=u,c.$attr_accessor("shapes","proxy"),e.def(c,"$initialize",i=function(e,t){var r=this;return r.shapes=e,r.proxy=t},i.$$arity=2),e.def(c,"$push",s=function(e){return this.shapes["$<<"](e)},s.$$arity=1),e.def(c,"$merge",o=function(e){var r=this;return r.shapes=t(r.shapes,e.$shapes())},o.$$arity=1)}(c[0],0,c),function(n,a,i){var s,o,c,l,f,$,p,m,g,v=d(n,null,"Drawable");[v].concat(i);v.$$prototype.visible=v.$$prototype.line_width=v.$$prototype.color=v.$$prototype.size=u,v.$attr_accessor("conf_key","conf_value","draginfo","color","size","more_conf_keys"),e.def(v,"$initialize",s=function(){var e=this;return null==y.conf&&(y.conf=u),e.visible=!0,e.line_width=y.conf.$get("layout.LINE_THIN"),e.conf_key=u,e.more_conf_keys=[],e.color=y.conf.$get("layout.color.color_default"),e.size=[1,1]},s.$$arity=0),e.def(v,"$center",o=function(){var e=this;return e.$raise("center not implemented for "+e.$class())},o.$$arity=0),e.def(v,"$visible?",c=function(){return this.visible},c.$$arity=0),e.def(v,"$visible=",l=function(e){return this.visible=e},l.$$arity=1),e.def(v,"$line_width=",f=function(e){return this.line_width=e},f.$$arity=1),e.def(v,"$line_width",$=function(){return this.line_width},$.$$arity=0),e.def(v,"$color=",p=function(e){return this.color=e},p.$$arity=1),e.def(v,"$color",m=function(){return this.color},m.$$arity=0),e.def(v,"$size_with_dot",g=function(){var n=this,a=u,i=u;return a=n.size.$clone(),_(n["$dotted?"]())&&(i=[0,t(a["$[]"](0),1)],h(a,"[]=",e.to_a(i)),i[r(i.length,1)]),a},g.$$arity=0)}(c[0],0,c),function(t,r,n){var a,i,s,o=d(t,r,"Symbol");[o].concat(n);o.$$prototype.dotted=o.$$prototype.hasbarover=u,o.$attr_accessor("dotted","hasbarover"),e.def(o,"$iniitalize",a=function(){var t=a.$$p,r=this,n=u,i=u,s=u;for(t&&(a.$$p=null),i=0,s=arguments.length,n=new Array(s);i<s;i++)n[i]=arguments[i];return h(r,e.find_super_dispatcher(r,"iniitalize",a,!1),n,t)},a.$$arity=0),e.def(o,"$dotted?",i=function(){return this.dotted},i.$$arity=0),e.def(o,"$hasbarover?",s=function(){return this.hasbarover},s.$$arity=0)}(c[0],$(c,"Drawable"),c),function(t,r,n){var a,i,s,o=d(t,r,"FlowLine");[o].concat(n);o.$$prototype.style=u,o.$attr_reader("from","to","style"),e.def(o,"$initialize",a=function(t,r,n){var i=a.$$p,s=this;return i&&(a.$$p=null),null==n&&(n="solid"),h(s,e.find_super_dispatcher(s,"initialize",a,!1),[],null),s.from=t,s.to=r,s.style=n},a.$$arity=-3),e.def(o,"$dashed?",i=function(){return this.style["$=="]("dashed")},i.$$arity=0),e.def(o,"$dotted?",s=function(){return this.style["$=="]("dotted")},s.$$arity=0)}(c[0],$(c,"Drawable"),c),function(t,r,n){var a,i=d(t,r,"Image");[i].concat(n);i.$attr_reader("url","llpos","height","opacity","origin"),e.def(i,"$initialize",a=function(e,t,r,n){var a=this;return null==n&&(n=u),a.url=e,a.llpos=t,a.height=r,a.origin=u},a.$$arity=-4)}(c[0],$(c,"Drawable"),c),function(t,r,n){var a,i,s=d(t,r,"Path");[s].concat(n);s.$$prototype.fill=u,s.$attr_reader("path","style","origin"),e.def(s,"$initialize",a=function(t,r,n){var i=a.$$p,s=this;return i&&(a.$$p=null),null==r&&(r=u),null==n&&(n=u),h(s,e.find_super_dispatcher(s,"initialize",a,!1),[],null),s.path=t,s.fill=r,s.origin=n},a.$$arity=-2),e.def(s,"$filled?",i=function(){return this.fill["$=="]("filled")},i.$$arity=0)}(c[0],$(c,"Drawable"),c),function(t,r,n){var a,i,s,o,c,l=d(t,r,"Ellipse");[l].concat(n);l.$$prototype.size=l.$$prototype.fill=l.$$prototype.rect=u,l.$attr_reader("center","size","fill","origin","color"),e.def(l,"$initialize",a=function(t,r,n,i,s,o){var c=a.$$p,l=this;return c&&(a.$$p=null),null==n&&(n="filled"),null==i&&(i=!1),null==s&&(s=u),null==o&&(o=!1),h(l,e.find_super_dispatcher(l,"initialize",a,!1),[],null),l.center=t,l.size=r,l.fill=n,l.dotted=i,l.rect=o,l.origin=s},a.$$arity=-3),e.def(l,"$height",i=function(){return this.size.$last()},i.$$arity=0),e.def(l,"$dotted?",s=function(){return this.$dotted()},s.$$arity=0),e.def(l,"$filled?",o=function(){return this.fill["$=="]("filled")},o.$$arity=0),e.def(l,"$rect?",c=function(){return this.rect["$=="](!0)},c.$$arity=0)}(c[0],$(c,"Symbol"),c),function(t,r,n){var s,o,c=d(t,r,"Annotation");[c].concat(n);c.$$prototype.text=c.$$prototype.style=u,c.$attr_reader("center","text","style","origin"),c.$attr_accessor("conf_key","conf_value","align","baseline"),e.def(c,"$initialize",s=function(t,r,n,a,i,o){var c=s.$$p,l=this,f=u;return c&&(s.$$p=null),null==n&&(n="regular"),null==a&&(a=u),null==i&&(i=u),null==o&&(o=m([],{})),h(l,e.find_super_dispatcher(l,"initialize",s,!1),[],null),f=r.$gsub(/[]/,m(["","","","","",""],{"":'"',"":'"',"":"'","":"'","":"-","":"-"})),l.center=t,l.text=f,l.style=n,l.align="left",l.baseline="alphabetic",l.origin=a,l.conf_key=i,l.conf_value=o},s.$$arity=-3),e.def(c,"$size",o=function(){var e,t=this,r=u,n=u,s=u;return null==y.conf&&(y.conf=u),null==y.log&&(y.log=u),_(_(e=t.text)?a(t.text.$strip().$length(),0):e)?(r=y.conf.$get("layout.FONT_STYLE_DEF."+t.style+".font_size"),_(r)||(r=10,y.log.$error("unsupported style for annotation: "+t.style)),n=i(r,y.conf.$get("layout.MM_PER_POINT").$to_f()),s=i(t.text.$length(),n)):(e=[1.5,2],s=e[0],n=e[1]),[s,n]},o.$$arity=0)}(c[0],$(c,"Drawable"),c),function(t,r,n){var a,i,s,o,c=d(t,r,"Glyph"),l=[c].concat(n);c.$$prototype.size=c.$$prototype.fill=u,c.$attr_reader("center","size","glyph","origin"),e.const_set(l[0],"GLYPHS",m(["rest_1","rest_4","rest_8","rest_16","fermata","emphasis","error"],{rest_1:m(["d","w","h"],{d:[["M",-10,-5],["l",20,0],["l",0,10],["l",-20,0],["l",0,-10],["z"]],w:20,h:10}),rest_4:m(["d","w","h"],{d:[["M",-1,-10],["c",.12,-.06,.24,-.06,.36,-.03],["c",.09,.06,4.74,5.58,4.86,5.82],["c",.21,.39,.15,.78,-.15,1.26],["c",-.24,.33,-.72,.81,-1.62,1.56],["c",-.45,.36,-.87,.75,-.96,.84],["c",-.93,.99,-1.14,2.49,-.6,3.63],["c",.18,.39,.27,.48,1.32,1.68],["c",1.92,2.25,1.83,2.16,1.83,2.34],["c",0,.18,-.18,.36,-.36,.39],["c",-.15,0,-.27,-.06,-.48,-.27],["c",-.75,-.75,-2.46,-1.29,-3.39,-1.08],["c",-.45,.09,-.69,.27,-.9,.69],["c",-.12,.3,-.21,.66,-.24,1.14],["c",-.03,.66,.09,1.35,.3,2.01],["c",.15,.42,.24,.66,.45,.96],["c",.18,.24,.18,.33,.03,.42],["c",-.12,.06,-.18,.03,-.45,-.3],["c",-1.08,-1.38,-2.07,-3.36,-2.4,-4.83],["c",-.27,-1.05,-.15,-1.77,.27,-2.07],["c",.21,-.12,.42,-.15,.87,-.15],["c",.87,.06,2.1,.39,3.3,.9],["l",.39,.18],["l",-1.65,-1.95],["c",-2.52,-2.97,-2.61,-3.09,-2.7,-3.27],["c",-.09,-.24,-.12,-.48,-.03,-.75],["c",.15,-.48,.57,-.96,1.83,-2.01],["c",.45,-.36,.84,-.72,.93,-.78],["c",.69,-.75,1.02,-1.8,.9,-2.79],["c",-.06,-.33,-.21,-.84,-.39,-1.11],["c",-.09,-.15,-.45,-.6,-.81,-1.05],["c",-.36,-.42,-.69,-.81,-.72,-.87],["c",-.09,-.18,0,-.42,.21,-.51],["z"]],w:7.888,h:21.435}),rest_8:m(["d","w","h"],{d:[["M",-2,-6.7],["c",.66,-.09,1.23,.09,1.68,.51],["c",.27,.3,.39,.54,.57,1.26],["c",.09,.33,.18,.66,.21,.72],["c",.12,.27,.33,.45,.6,.48],["c",.12,0,.18,0,.33,-.09],["c",.39,-.18,1.32,-1.29,1.68,-1.98],["c",.09,-.21,.24,-.3,.39,-.3],["c",.12,0,.27,.09,.33,.18],["c",.03,.06,-.27,1.11,-1.86,6.42],["c",-1.02,3.48,-1.89,6.39,-1.92,6.42],["c",0,.03,-.12,.12,-.24,.15],["c",-.18,.09,-.21,.09,-.45,.09],["c",-.24,0,-.3,0,-.48,-.06],["c",-.09,-.06,-.21,-.12,-.21,-.15],["c",-.06,-.03,.15,-.57,1.68,-4.92],["c",.96,-2.67,1.74,-4.89,1.71,-4.89],["l",-.51,.15],["c",-1.08,.36,-1.74,.48,-2.55,.48],["c",-.66,0,-.84,-.03,-1.32,-.27],["c",-1.32,-.63,-1.77,-2.16,-1.02,-3.3],["c",.33,-.45,.84,-.81,1.38,-.9],["z"]],w:7.534,h:13.883}),rest_16:m(["d","w","h"],{d:[["M",-1.33,-11.12],["c",.66,-.09,1.23,.09,1.68,.51],["c",.27,.3,.39,.54,.57,1.26],["c",.09,.33,.18,.66,.21,.72],["c",.15,.39,.57,.57,.87,.42],["c",.39,-.18,1.2,-1.23,1.62,-2.07],["c",.06,-.15,.24,-.24,.36,-.24],["c",.12,0,.27,.09,.33,.18],["c",.03,.06,-.45,1.86,-2.67,10.17],["c",-1.5,5.55,-2.73,10.14,-2.76,10.17],["c",-.03,.03,-.12,.12,-.24,.15],["c",-.18,.09,-.21,.09,-.45,.09],["c",-.24,0,-.3,0,-.48,-.06],["c",-.09,-.06,-.21,-.12,-.21,-.15],["c",-.06,-.03,.12,-.57,1.44,-4.92],["c",.81,-2.67,1.47,-4.86,1.47,-4.89],["c",-.03,0,-.27,.06,-.54,.15],["c",-1.08,.36,-1.77,.48,-2.58,.48],["c",-.66,0,-.84,-.03,-1.32,-.27],["c",-1.32,-.63,-1.77,-2.16,-1.02,-3.3],["c",.72,-1.05,2.22,-1.23,3.06,-.42],["c",.3,.33,.42,.6,.6,1.38],["c",.09,.45,.21,.78,.33,.9],["c",.09,.09,.27,.18,.45,.21],["c",.12,0,.18,0,.33,-.09],["c",.33,-.15,1.02,-.93,1.41,-1.59],["c",.12,-.21,.18,-.39,.39,-1.08],["c",.66,-2.1,1.17,-3.84,1.17,-3.87],["c",0,0,-.21,.06,-.42,.15],["c",-.51,.15,-1.2,.33,-1.68,.42],["c",-.33,.06,-.51,.06,-.96,.06],["c",-.66,0,-.84,-.03,-1.32,-.27],["c",-1.32,-.63,-1.77,-2.16,-1.02,-3.3],["c",.33,-.45,.84,-.81,1.38,-.9],["z"]],w:9.724,h:21.383}),fermata:m(["d","w","h"],{d:[["M",-.75,-5.34],["c",.12,0,.45,-.03,.69,-.03],["c",2.91,-.03,5.55,1.53,7.41,4.35],["c",1.17,1.71,1.95,3.72,2.43,6.03],["c",.12,.51,.12,.57,.03,.69],["c",-.12,.21,-.48,.27,-.69,.12],["c",-.12,-.09,-.18,-.24,-.27,-.69],["c",-.78,-3.63,-3.42,-6.54,-6.78,-7.38],["c",-.78,-.21,-1.2,-.24,-2.07,-.24],["c",-.63,0,-.84,0,-1.2,.06],["c",-1.83,.27,-3.42,1.08,-4.8,2.37],["c",-1.41,1.35,-2.4,3.21,-2.85,5.19],["c",-.09,.45,-.15,.6,-.27,.69],["c",-.21,.15,-.57,.09,-.69,-.12],["c",-.09,-.12,-.09,-.18,.03,-.69],["c",.33,-1.62,.78,-3,1.47,-4.38],["c",1.77,-3.54,4.44,-5.67,7.56,-5.97],["z"],["M",-.5,1.5],["c",1.38,-.3,2.58,.9,2.31,2.25],["c",-.15,.72,-.78,1.35,-1.47,1.5],["c",-1.38,.27,-2.58,-.93,-2.31,-2.31],["c",.15,-.69,.78,-1.29,1.47,-1.44],["z"]],w:19.748,h:11.289}),emphasis:m(["d","w","h"],{d:[["M",-6.45,-3.69],["c",.06,-.03,.15,-.06,.18,-.06],["c",.06,0,2.85,.72,6.24,1.59],["l",6.33,1.65],["c",.33,.06,.45,.21,.45,.51],["c",0,.3,-.12,.45,-.45,.51],["l",-6.33,1.65],["c",-3.39,.87,-6.18,1.59,-6.21,1.59],["c",-.21,0,-.48,-.24,-.51,-.45],["c",0,-.15,.06,-.36,.18,-.45],["c",.09,-.06,.87,-.27,3.84,-1.05],["c",2.04,-.54,3.84,-.99,4.02,-1.02],["c",.15,-.06,1.14,-.24,2.22,-.42],["c",1.05,-.18,1.92,-.36,1.92,-.36],["c",0,0,-.87,-.18,-1.92,-.36],["c",-1.08,-.18,-2.07,-.36,-2.22,-.42],["c",-.18,-.03,-1.98,-.48,-4.02,-1.02],["c",-2.97,-.78,-3.75,-.99,-3.84,-1.05],["c",-.12,-.09,-.18,-.3,-.18,-.45],["c",.03,-.15,.15,-.3,.3,-.39],["z"]],w:13.5,h:7.5}),error:m(["d","w","h"],{d:[["M",-10,-5],["l",0,10],["l",20,-10],["l",0,10],["z"]],w:20,h:10})})),e.def(c,"$initialize",a=function(t,r,n,i,s,o,c){var f=a.$$p,p=this,d=u;return null==y.log&&(y.log=u),f&&(a.$$p=null),null==i&&(i=$(l,"FALSE")),null==s&&(s=u),null==o&&(o=u),null==c&&(c=m([],{})),h(p,e.find_super_dispatcher(p,"initialize",a,!1),[],null),d=$(l,"GLYPHS")["$[]"](n),_(d)||(_(d)||y.log.$error("BUG: unsuppoerted glyph "+n),d=$(l,"GLYPHS")["$[]"]("error")),p.center=t,p.glyph_name=n,p.glyph=d,p.size=r,p.dotted=i,p.origin=s,p.filled=!0,p.conf_key=o,p.conf_value=c,p.coll_stack=[]},a.$$arity=-4),e.def(c,"$height",i=function(){return this.size.$last()},i.$$arity=0),e.def(c,"$dotted?",s=function(){return this.$dotted()},s.$$arity=0),e.def(c,"$filled?",o=function(){return this.fill["$=="]("filled")},o.$$arity=0)}(c[0],$(c,"Symbol"),c)}(w[0],w),function(l,b){var x=p(l,"Layout"),w=[x].concat(b);!function(l,p,b){var x,w,A,k,E,S,N,C,I,O,L,P,M,T,B,j,F,R,D,z,q,U,H,G,Y,V,Q,X,W,J,K,Z,ee,te,re,ne,ae=d(l,null,"Default"),ie=[ae].concat(b);ae.$$prototype.placeholders=ae.$$prototype.y_offset=ae.$$prototype.beat_spacing=ae.$$prototype.print_options_raw=ae.$$prototype.bottom_annotation_positions=ae.$$prototype.uri=ae.$$prototype.draw_instrument=ae.$$prototype.slur_index=ae.$$prototype.color_default=ae.$$prototype.conf_beat_resolution=ae.$$prototype.layout_minc=ae.$$prototype.instrument_orientation=ae.$$prototype.pitch_to_xpos=ae.$$prototype.color_variant1=ae.$$prototype.color_variant2=ae.$$prototype.print_options_keys=u,ae.$include(f($(ie,"Harpnotes"),"Music")),ae.$include(f($(ie,"Harpnotes"),"Drawing")),ae.$attr_accessor("uri","placeholders"),e.const_set(ie[0],"MM_PER_POINT",.3),e.def(ae,"$initialize",x=function(){var e=this;return null==y.conf&&(y.conf=u),e.beat_spacing=n(i(y.conf.$get("layout.Y_SCALE"),1),y.conf.$get("layout.BEAT_RESOLUTION")),e.slur_index=m([],{}),e.y_offset=5,e.conf_beat_resolution=y.conf.$get("layout.BEAT_RESOLUTION"),e.layout_minc=m([],{}),e.color_default=y.conf.$get("layout.color.color_default"),e.color_variant1=y.conf.$get("layout.color.color_variant1"),e.color_variant2=y.conf.$get("layout.color.color_variant2"),e.draw_instrument=u,_(e.placeholders)||(e.placeholders=m([],{})),e.$set_instrument_handlers()},x.$$arity=0),e.def(ae,"$set_instrument_handlers",w=function(){var n,a,s,o,c,l,p,d,m,v,b=this,x=u,w=u,A=u,k=u,E=u,S=u,N=u,C=u,I=u;return null==y.conf&&(y.conf=u),x=y.conf["$[]"]("layout.X_OFFSET"),w=y.conf["$[]"]("layout.X_SPACING"),A=y.conf.$get("layout.PITCH_OFFSET"),b.bottom_annotation_positions=[[150,289],[325,289],[380,289]],b.pitch_to_xpos=h(b,"lambda",[],(n=function(e){n.$$s;return null==e&&(e=u),t(i(t(A,e),w),x)},n.$$s=b,n.$$arity=1,n)),function(){return k=y.conf["$[]"]("layout.instrument"),"Zipino"["$==="](k)?(E="54 55 57 59 60 62 64 66 67 69 71 72 74 76 78",S=$(ie,"Hash")["$[]"](h(E.$split(" ").$each_with_index(),"map",[],(a=function(e,t){a.$$s;return null==e&&(e=u),null==t&&(t=u),[e.$to_i(),t]},a.$$s=b,a.$$arity=2,a))),b.pitch_to_xpos=h(b,"lambda",[],(s=function(e){var r=(s.$$s,u),n=u;return null==e&&(e=u),r=S["$[]"](t(e,A)),n=0,_(r["$nil?"]())||(n=t(i(r,w),x)),n},s.$$s=b,s.$$arity=1,s)),b.bottom_annotation_positions=[[x,287],[x,290],[t(x,100),290]],b.draw_instrument=h(b,"lambda",[],(o=function(){var n=(o.$$s,u),a=u;return null==y.conf&&(y.conf=u),n=f(f($(ie,"Harpnotes"),"Drawing"),"Path").$new([["M",t(x,30),20],["L",t(x,190),100],["M",t(x,190),200],["L",t(x,30),281]],"open"),a=[y.conf.$get("layout.LINE_MEDIUM")],h(n,"line_width=",e.to_a(a)),a[r(a.length,1)],[n]},o.$$s=b,o.$$arity=0,o)),b.instrument_orientation="horizontal"):"saitenspiel"["$==="](k)?(b.pitch_to_xpos=h(b,"lambda",[],(c=function(e){var r=(c.$$s,u),n=u;return null==e&&(e=u),r=$(ie,"Hash")["$[]"]([[31,0],[36,1],[38,2],[40,3],[41,4],[43,5],[45,6],[47,7],[48,8],[50,9]]),r=r["$[]"](t(e,A)),n=0,_(r)&&(n=t(i(r,w),x)),n},c.$$s=b,c.$$arity=1,c)),b.bottom_annotation_positions=[[x,287],[x,290],[t(x,100),290]],b.draw_instrument=h(b,"lambda",[],(l=function(){var n=(l.$$s,u),a=u;return null==y.conf&&(y.conf=u),n=f(f($(ie,"Harpnotes"),"Drawing"),"Path").$new([["M",t(x,30),6],["L",t(x,180),81],["L",t(x,180),216],["L",t(x,30),291]],"open"),a=[y.conf.$get("layout.LINE_MEDIUM")],h(n,"line_width=",e.to_a(a)),a[r(a.length,1)],[n]},l.$$s=b,l.$$arity=0,l))):"okon-f"["$==="](k)||"okon-g"["$==="](k)||"okon-c"["$==="](k)||"okon-d"["$==="](k)?(N="",E="",k=y.conf["$[]"]("layout.instrument"),"okon-f"["$==="](k)?(E="55 57 58 60 62 64 65 67 69 70 72 74 76 77 79 81 82 84",N=""):"okon-g"["$==="](k)?(E="55 57 59 60 62 64 66 67 69 71 72 74 76 78 79 81 83 84",N="      59          66       71          78       83 "):"okon-c"["$==="](k)?(E="55 57 59 60 62 64 65 67 69 71 72 74 76 77 79 81 83 84",N="      59                   71                   83"):"okon-d"["$==="](k)&&(E="55 57 59 61 62 64 66 67 69 71 73 74 76 78 79 81 83 85",N="      59 61       66       71 73       78       83"),C=g(59,7,61,7,66,7,71,7,73,20,78,65,83,110),S=$(ie,"Hash")["$[]"](h(E.$split(" ").$each_with_index(),"map",[],(p=function(e,t){p.$$s;return null==e&&(e=u),null==t&&(t=u),[e.$to_i(),t]},p.$$s=b,p.$$arity=2,p))),I=h(N.$split(" "),"map",[],(d=function(e){d.$$s;return null==e&&(e=u),e.$to_i()},d.$$s=b,d.$$arity=1,d)),b.pitch_to_xpos=h(b,"lambda",[],(m=function(e){var r=(m.$$s,u),n=u;return null==e&&(e=u),r=S["$[]"](t(e,A)),n=0,_(r)&&(n=t(i(r,w),x)),n},m.$$s=b,m.$$arity=1,m)),b.bottom_annotation_positions=[[x,290],[t(x,200),290],[t(x,270),290]],b.draw_instrument=h(b,"lambda",[],(v=function(){var n,a=v.$$s||this,i=u,s=u,o=u;return null==y.conf&&(y.conf=u),i=[],h(I,"each",[],(n=function(e){var t=n.$$s||this;return null==t.pitch_to_xpos&&(t.pitch_to_xpos=u),null==e&&(e=u),i.$push(f(f($(ie,"Harpnotes"),"Drawing"),"Annotation").$new([t.pitch_to_xpos.$call(e),C["$[]"](e)],"*","large"))},n.$$s=a,n.$$arity=1,n)),s=f(f($(ie,"Harpnotes"),"Drawing"),"Path").$new([["M",r(x,15),280],["L",r(x,15),0],["M",t(x,135),0],["L",t(x,290),157],["L",t(x,290),280]],"open"),o=[y.conf.$get("layout.LINE_MEDIUM")],h(s,"line_width=",e.to_a(o)),o[r(o.length,1)],i.$push(s)},v.$$s=b,v.$$arity=0,v))):"21-strings-a-f"["$==="](k)?b.bottom_annotation_positions=[[190,287],[190,290],[250,290]]:"18-strings-b-e"["$==="](k)?b.bottom_annotation_positions=[[210,287],[210,290],[280,290]]:u}()},w.$$arity=0),e.def(ae,"$layout_images",A=function(t,n){var a,i=this,s=u,o=u;return s=[],o=t["$[]"]("images"),_(o["$nil?"]())||h(o,"each",[],(a=function(t,i){var o,c=a.$$s||this,l=u;return null==y.resources&&(y.resources=u),null==t&&(t=u),null==i&&(i=u),i["$[]"]("show")["$=="](!0)?(l=y.resources["$[]"](i["$[]"]("imagename")),_(l["$is_a?"]($(ie,"Array")))&&(l=l.$join()),_(l)?s.$push(h(f(f($(ie,"Harpnotes"),"Drawing"),"Image").$new(l,r(c.$Vector2d(i["$[]"]("pos")),[0,i["$[]"]("height")]),i["$[]"]("height")),"tap",[],(o=function(a){var s=(o.$$s,u);return null==a&&(a=u),s=["extract."+n+".images."+t+".pos"],h(a,"conf_key=",e.to_a(s)),s[r(s.length,1)],s=[i["$[]"]("pos")],h(a,"conf_value=",e.to_a(s)),s[r(s.length,1)],s=[m(["handler"],{handler:"annotation"})],h(a,"draginfo=",e.to_a(s)),s[r(s.length,1)]},o.$$s=c,o.$$arity=1,o))):u):u},a.$$s=i,a.$$arity=2,a)),s},A.$$arity=2),e.def(ae,"$layout_debug_grid",k=function(){var t,a,s,o,c=this,l=u,p=u,d=u,_=u,y=u;return l=m(["size","emphasis","line","emphline"],{size:1,emphasis:10,line:.02,emphline:.2}),p=l["$[]"]("size"),d=i(l["$[]"]("emphasis"),p),_=[420,297],y=[],h(h(e.Range.$new(0,n(_.$first(),p),!1),"map",[],(t=function(e){t.$$s;return null==e&&(e=u),i(e,p)},t.$$s=c,t.$$arity=1,t)),"each",[],(a=function(t){var n=(a.$$s,u),i=u;return null==t&&(t=u),n=f(f($(ie,"Harpnotes"),"Drawing"),"Path").$new([["M",t,0],["l",0,_.$last()]]),i=[l["$[]"]("line")],h(n,"line_width=",e.to_a(i)),i[r(i.length,1)],t["$%"](d)["$=="](0)&&(i=[l["$[]"]("emphline")],h(n,"line_width=",e.to_a(i)),i[r(i.length,1)]),y["$<<"](n)},a.$$s=c,a.$$arity=1,a)),h(h(e.Range.$new(0,n(_.$last(),p),!1),"map",[],(s=function(e){s.$$s;return null==e&&(e=u),i(e,p)},s.$$s=c,s.$$arity=1,s)),"each",[],(o=function(t){var n=(o.$$s,u),a=u;return null==t&&(t=u),n=f(f($(ie,"Harpnotes"),"Drawing"),"Path").$new([["M",0,t],["l",_.$first(),0]]),a=[l["$[]"]("line")],h(n,"line_width=",e.to_a(a)),a[r(a.length,1)],t["$%"](d)["$=="](0)&&(a=[l["$[]"]("emphline")],h(n,"line_width=",e.to_a(a)),a[r(a.length,1)]),y["$<<"](n)},o.$$s=c,o.$$arity=1,o)),y},k.$$arity=0),e.def(ae,"$layout",E=function(o,c,l,p){var d,g,b,x,w,A,k,E,S,N,C,I,O,L,P,M,T=this,B=u,j=u,F=u,R=u,D=u,z=u,q=u,U=u,H=u,G=u,Y=u,V=u,Q=u,X=u,W=u,J=u,K=u,Z=u,ee=u,te=u,re=u,ne=u,ae=u,se=u,oe=u,ce=u,le=u,ue=u,fe=u,$e=u,pe=u,de=u,he=u,_e=u,me=u,ye=u,ge=u,ve=u,be=u,xe=u,we=u;null==y.conf&&(y.conf=u),null==y.log&&(y.log=u),null==c&&(c=u),null==l&&(l=0),null==p&&(p="A4"),B=T.$get_print_options(l),T.print_options_raw=B,j=B.$get(),F=_(d=j["$[]"]("layout"))?d:m([],{}),y.conf.$push(m(["layout"],{layout:F})),y.conf.$push(m(["printer"],{printer:_(d=j["$[]"]("printer"))?d:m([],{})})),T.$initialize(),R=[],_(y.conf["$[]"]("layout.grid"))&&(R=T.$layout_debug_grid()),D=T.$layout_images(j,l),T.layout_minc=_(d=B["$[]"]("notebound.minc"))?d:m([],{}),T.y_offset=j["$[]"]("startpos"),T.y_size=y.conf.$get("layout.DRAWING_AREA_SIZE").$last(),z=u,h(y.log,"benchmark",["compute beat compression map"],(g=function(){var e=g.$$s||this,r=u;return r=t(j["$[]"]("voices"),j["$[]"]("layoutlines").$uniq()),z=e.$compute_beat_compression(o,r)},g.$$s=T,g.$$arity=0,g)),q=_(d=z.$values().$max())?d:0,U=n(r(y.conf.$get("layout.DRAWING_AREA_SIZE").$last(),T.y_offset),q),_(s(U,T.beat_spacing))&&(H=n(T.beat_spacing,U),y.log.$warning("note distance too small (factor "+H+")")),T.beat_spacing=[U,i(y.conf.$get("layout.packer.pack_max_spreadfactor"),T.beat_spacing)].$min(),c=_(y.conf.$get("layout.bottomup"))?_(d=c)?d:h($(ie,"Proc"),"new",[],(b=function(e){var t=b.$$s||this;return null==t.y_size&&(t.y_size=u),null==t.beat_spacing&&(t.beat_spacing=u),null==e&&(e=u),t.y_size-e*t.beat_spacing},b.$$s=T,b.$$arity=1,b)):_(d=c)?d:h($(ie,"Proc"),"new",[],(x=function(e){var t=x.$$s||this;return null==t.beat_spacing&&(t.beat_spacing=u),null==t.y_offset&&(t.y_offset=u),null==e&&(e=u),e*t.beat_spacing+t.y_offset},x.$$s=T,x.$$arity=1,x)),G=h($(ie,"Proc"),"new",[],(w=function(e){w.$$s;return null==e&&(e=u),c.$call(z["$[]"](e))},w.$$s=T,w.$$arity=1,w)),Y=h(j["$[]"]("synchlines"),"select",[],(A=function(e){var t;A.$$s;return null==e&&(e=u),_(t=j["$[]"]("voices")["$include?"](e.$first()))?j["$[]"]("voices")["$include?"](e.$last()):t},A.$$s=T,A.$$arity=1,A)),V=[],h(y.log,"benchmark",["build_syncpoints"],(k=function(){var e,t=k.$$s||this;return V=h(Y,"map",[],(e=function(t){var r,n=e.$$s||this,a=u;return null==t&&(t=u),a=o.$build_synch_points(t),h(a,"map",[],(r=function(e){r.$$s;return null==e&&(e=u),e.$synched_notes()},r.$$s=n,r.$$arity=1,r))},e.$$s=t,e.$$arity=1,e)).$flatten()},k.$$s=T,k.$$arity=0,k)),Q=j["$[]"]("voices"),X=h(o.$voices().$each_with_index(),"map",[],(E=function(e,t){var r=E.$$s||this,n=u,a=u;return null==e&&(e=u),null==t&&(t=u),_(Q["$include?"](t))?(n=j["$[]"]("countnotes"),_(n["$[]"]("voices")["$include?"](t))||(n=u),a=j["$[]"]("barnumbers"),_(a["$[]"]("voices")["$include?"](t))||(a=u),r.$layout_voice(e,G,l,m(["voice_nr","nonflowrest","flowline","subflowline","jumpline","repeatsigns","synched_notes","countnotes","barnumbers","print_options_raw"],{voice_nr:t,nonflowrest:j["$[]"]("nonflowrest"),flowline:j["$[]"]("flowlines")["$include?"](t),subflowline:j["$[]"]("subflowlines")["$include?"](t),jumpline:j["$[]"]("jumplines")["$include?"](t),repeatsigns:j["$[]"]("repeatsigns"),synched_notes:V,countnotes:n,barnumbers:a,print_options_raw:B}))):u},E.$$s=T,E.$$arity=2,E)).$flatten().$compact(),_(y.log["$loglevel?"]("warning"))&&(W=$(ie,"CollisionDetector").$new(),W.$check_annotations(X)),J=h(Y,"map",[],(S=function(t){var n,a=S.$$s||this,i=u;return null==t&&(t=u),i=o.$build_synch_points(t),h(i,"map",[],(n=function(t){var a=n.$$s||this,i=u,s=u;return null==t&&(t=u),i=$(ie,"FlowLine").$new(t.$notes().$first().$sheet_drawable(),t.$notes().$last().$sheet_drawable(),"dashed"),s=[a.$compute_color_by_variant_no(t.$notes().$first().$variant())],h(i,"color=",e.to_a(s)),s[r(s.length,1)],i},n.$$s=a,n.$$arity=1,n))},S.$$s=T,S.$$arity=1,S)).$flatten(),K=T.$layout_stringnames(j,l),_((d=p["$=="]("A4"))?a(y.conf["$[]"]("printer.a4_pages").$length(),1):p["$=="]("A4"))&&(Z=i(12,y.conf.$get("layout.X_SPACING")),h(v(1,2,!1),"each",[],(N=function(e){var r,n=N.$$s||this;return null==e&&(e=u),h([4,290],"each",[],(r=function(n){r.$$s;return null==y.conf&&(y.conf=u),null==n&&(n=u),K["$<<"](f(f($(ie,"Harpnotes"),"Drawing"),"Annotation").$new([t(t(i(.25,y.conf.$get("layout.X_SPACING")),y.conf.$get("layout.X_OFFSET")),i(Z,e)),n],"x","small",u))},r.$$s=n,r.$$arity=1,r))},N.$$s=T,N.$$arity=1,N))),ee=[],te=_(d=o.$meta_data()["$[]"]("title"))?d:"untitled",re=o.$meta_data()["$[]"]("filename"),ne=o.$meta_data()["$[]"]("meter"),_(ne)&&(ne=ne.$last().$split("=").$first()),ae=o.$meta_data()["$[]"]("key"),se=o.$meta_data()["$[]"]("composer"),oe=o.$meta_data()["$[]"]("tempo_display"),ce=j["$[]"]("title"),le=j["$[]"]("legend")["$[]"]("pos"),ue=_(d=T.print_options_raw.$get("legend.align"))?d:"r",ue=function(){return _(ue["$=="]("l"))?"right":"left"}(),fe=j["$[]"]("legend")["$[]"]("spos"),$e=ce+"\n"+se+"\nTakt: "+ne+" ("+oe+")\nTonart: "+ae,pe=_(d=T.print_options_raw.$get("legend.style"))?d:"regular",ee["$<<"](h(f(f($(ie,"Harpnotes"),"Drawing"),"Annotation").$new(le,te,"large",u,"extract."+l+".legend.pos",le),"tap",[],(C=function(t){var n=(C.$$s,u);return null==t&&(t=u),n=[m(["handler"],{handler:"annotation"})],h(t,"draginfo=",e.to_a(n)),n[r(n.length,1)],n=[ue],h(t,"align=",e.to_a(n)),n[r(n.length,1)]},C.$$s=T,C.$$arity=1,C))),_(B["$[]"]("notes.T06_legend")["$nil?"]())&&ee["$<<"](h(f(f($(ie,"Harpnotes"),"Drawing"),"Annotation").$new(fe,$e,pe,u,"extract."+l+".legend.spos",fe),"tap",[],(I=function(t){var n=(I.$$s,u);return null==t&&(t=u),n=[m(["handler"],{handler:"annotation"})],h(t,"draginfo=",e.to_a(n)),n[r(n.length,1)]},I.$$s=T,I.$$arity=1,I))),de=$(ie,"Time").$now().$strftime("%Y-%m-%d %H:%M:%S"),ee["$<<"](f(f($(ie,"Harpnotes"),"Drawing"),"Annotation").$new(T.bottom_annotation_positions["$[]"](0),re+" - created "+de+" by Zupfnoter "+$(ie,"VERSION")+" ["+T.uri["$[]"]("hostname")+"]","smaller")),ee["$<<"](f(f($(ie,"Harpnotes"),"Drawing"),"Annotation").$new(T.bottom_annotation_positions["$[]"](1),"Zupfnoter: https://www.zupfnoter.de","smaller")),ee["$<<"](f(f($(ie,"Harpnotes"),"Drawing"),"Annotation").$new(T.bottom_annotation_positions["$[]"](2),o.$checksum(),"smaller")),he=j["$[]"]("lyrics"),_e=o.$harpnote_options()["$[]"]("lyrics")["$[]"]("text"),_(_e)&&(me=_e.$join("\n"),_(he)&&(ye=h(me.$gsub("\t"," ").$squeeze(" ").$split(/\n\n+/),"map",[],(O=function(e){O.$$s;return null==e&&(e=u),e.$strip()},O.$$s=T,O.$$arity=1,O)),he.$delete("versepos"),h(he,"each",[],(L=function(t,n){var i,o,c,p=L.$$s||this,d=u,y=u,g=u,v=u;return null==p.print_options_raw&&(p.print_options_raw=u),null==t&&(t=u),null==n&&(n=u),d=n["$[]"]("pos"),y=h(_(i=n["$[]"]("verses"))?i:[],"map",[],(o=function(e){var t=(o.$$s,u);return null==e&&(e=u),e["$=="](0)&&(t=9999),_(s(e,0))&&(t=e),_(a(e,0))&&(t=r(e,1)),ye["$[]"](t)},o.$$s=p,o.$$arity=1,o)).$join("\n\n"),g="lyrics."+t,v="extract."+l+"."+g,pe=_(i=p.print_options_raw.$get(g+".style"))?i:"regular",ee["$<<"](h(f(f($(ie,"Harpnotes"),"Drawing"),"Annotation").$new(d,y,pe,u,v+".pos",d),"tap",[],(c=function(t){var n=(c.$$s,u);return null==t&&(t=u),n=[m(["handler"],{handler:"annotation"})],h(t,"draginfo=",e.to_a(n)),n[r(n.length,1)]},c.$$s=p,c.$$arity=1,c)))},L.$$s=T,L.$$arity=2,L)))),ge=j["$[]"]("sortmark"),_(ge["$[]"]("show"))&&K["$<<"](T.$layout_sortmark(te,ge));try{h(j["$[]"]("notes"),"each",[],(P=function(t,n){var a,i,s=P.$$s||this,o=u,c=u;return null==t&&(t=u),null==n&&(n=u),o="extract."+l+".notes."+t,c=_(a=n["$[]"]("align"))?a:"r",c=function(){return _(c["$=="]("r"))?"left":"right"}(),_(n["$[]"]("pos"))||s.$raise($(ie,"I18n").$t("missing pos")+" in "+o),_(n["$[]"]("text"))||s.$raise($(ie,"I18n").$t("missing text")+" in "+o),ee["$<<"](h(f(f($(ie,"Harpnotes"),"Drawing"),"Annotation").$new(n["$[]"]("pos"),s.$resolve_placeholder(n["$[]"]("text"),o),n["$[]"]("style"),u,o+".pos",n["$[]"]("pos")),"tap",[],(i=function(t){var n=(i.$$s,u);return null==t&&(t=u),n=[c],h(t,"align=",e.to_a(n)),n[r(n.length,1)],n=[m(["handler"],{handler:"annotation"})],h(t,"draginfo=",e.to_a(n)),n[r(n.length,1)]},i.$$s=s,i.$$arity=1,i)))},P.$$s=T,P.$$arity=2,P))}catch(t){if(!e.rescue(t,[$(ie,"Exception")]))throw t;ve=t;try{y.log.$error(ve.$message())}finally{e.pop_exception()}}return _(T.draw_instrument)&&h(T.draw_instrument.$call(),"each",[],(M=function(e){M.$$s;return null==e&&(e=u),K.$push(e)},M.$$s=T,M.$$arity=1,M)),be=t(t(t(t(t(D,R),J),X),ee),K),xe=f(f($(ie,"Harpnotes"),"Drawing"),"Sheet").$new(be,Q),we=[y.conf["$[]"]("printer")],h(xe,"printer_config=",e.to_a(we)),we[r(we.length,1)],y.conf.$pop(),y.conf.$pop(),xe},E.$$arity=-2),e.def(ae,"$get_print_options",S=function(t){var n=u,a=u,i=u;return null==y.conf&&(y.conf=u),null==y.log&&(y.log=u),n=$(ie,"Confstack").$new(),a=[!1],h(n,"strict=",e.to_a(a)),a[r(a.length,1)],n.$push(y.conf.$get("extract.0")),i=y.conf.$get("extract."+t),_(i)?n.$push(i):y.log.$warning("selected print variant ["+t+"] not available using [0]: '"+n.$get("title")+"'"),_(n["$[]"]("layout.beams"))&&n.$push(m(["layout"],{layout:m(["DURATION_TO_STYLE"],{DURATION_TO_STYLE:y.conf["$[]"]("layout.DURATION_TO_BEAMS")})})),n},S.$$arity=1),e.def(ae,"$layout_sortmark",N=function(a,s){var o,c,l,p=this,d=u,g=u,v=u,b=u,x=u,w=u,A=u,k=u;return null==y.conf&&(y.conf=u),d=a.$upcase().$gsub(/[YZ]/,m(["","","","","Y","Z"],{"":"AE","":"OE","":"UE","":"ss",Y:"X",Z:"X"})).$gsub(/[^A-Za-z]/,""),g=h(t(d,"AAAA").$split(""),"map",[],(o=function(e){o.$$s;return null==e&&(e=u),r(e.$ord(),"A".$ord())},o.$$s=p,o.$$arity=1,o)),v=t(g["$[]"](0),n(i(t(t(i(.1,g["$[]"](1)),i(.01,g["$[]"](2))),i(.001,g["$[]"](3))),.5),2.4)),l=s["$[]"]("size"),c=e.to_ary(l),b=null==c[0]?u:c[0],x=null==c[1]?u:c[1],w=function(){return _(s["$[]"]("fill"))?"filled":"open"}(),A=i(t(12.5,v),y.conf.$get("layout.X_SPACING")),k=[["M",A,0],["l",n(b["$-@"](),2),x],["l",b,0],["l",n(b["$-@"](),2),x["$-@"]()],["l",0,x],["l",0,x["$-@"]()],["z"]],f(f($(ie,"Harpnotes"),"Drawing"),"Path").$new(k,w)},N.$$arity=2),e.def(ae,"$layout_stringnames",C=function(a,s){var o,c,l=this,p=u,d=u,m=u,g=u,v=u,b=u,x=u,w=u,A=u,k=u,E=u;return null==y.conf&&(y.conf=u),p=a["$[]"]("stringnames")["$[]"]("vpos"),d=a["$[]"]("stringnames")["$[]"]("marks")["$[]"]("hpos"),m="stringnames",g=[],_(d["$empty?"]())||(g=t(g,h(d,"inject",[[]],(o=function(e,t){var r,n=o.$$s||this;return null==e&&(e=u),null==t&&(t=u),h(a["$[]"]("stringnames")["$[]"]("marks")["$[]"]("vpos"),"each",[],(r=function(n){var a=r.$$s||this,i=u;return null==a.pitch_to_xpos&&(a.pitch_to_xpos=u),null==n&&(n=u),i=a.$make_sheetmark_path([a.pitch_to_xpos.$call(t),n]),e["$<<"](f(f($(ie,"Harpnotes"),"Drawing"),"Path").$new(i,"filled"))},r.$$s=n,r.$$arity=1,r)),e},o.$$s=l,o.$$arity=2,o)))),_(p["$empty?"]())||(v=37,b=a["$[]"]("stringnames")["$[]"]("text").$split(" "),b=i(b,t(n(v,b.$length()),1)),x=y.conf.$get("layout.PITCH_OFFSET")["$-@"](),w=r(t(x,v),1),p=a["$[]"]("stringnames")["$[]"]("vpos"),A=a["$[]"]("stringnames")["$[]"]("style"),k=y.conf.$get("layout.X_SPACING"),E=r(y.conf.$get("layout.X_OFFSET"),1),g=t(g,h(e.Range.$new(x,w,!1).$to_a(),"inject",[[]],(c=function(e,n){var a,s=c.$$s||this,o=u;return null==e&&(e=u),null==n&&(n=u),o=t(i(t(x["$-@"](),n),k),E),h(p,"each",[],(a=function(t){a.$$s;return null==t&&(t=u),e["$<<"](f(f($(ie,"Harpnotes"),"Drawing"),"Annotation").$new([o,t],b["$[]"](r(n,x)),A,u,m))},a.$$s=s,a.$$arity=1,a)),e},c.$$s=l,c.$$arity=2,c)))),g},C.$$arity=2),e.const_set(ie[0],"NOTE_POSITION_LOOKUP",m(["11","12","13","21","22","23","31","32","33"],{11:["r","r"],12:["r","l"],13:["r","l"],21:["r","r"],22:["r","l"],23:["l","l"],31:["l","r"],32:["l","r"],33:["l","l"]})),e.def(ae,"$compute_note_position",I=function(e,r,n,i){var o=u,c=u;return o=t(e["$<=>"](r),2),c=t(n["$<=>"](r),2),_(s(r,10))?["r","r"]:_(a(r,410))?["l","l"]:$(ie,"NOTE_POSITION_LOOKUP")["$[]"](""+o+c)},I.$$arity=4),e.def(ae,"$layout_voice",O=function(n,s,o,c){var l,p,d,g,v,b,x,w,A,k,E,S,N,C,I,O,L,P,M,T=this,B=u,j=u,F=u,R=u,D=u,z=u,q=u,U=u,H=u,G=u,Y=u,V=u,Q=u,X=u,W=u,J=u,K=u,Z=u,ee=u,te=u,re=u,ne=u,ae=u;return null==y.log&&(y.log=u),null==y.settings&&(y.settings=u),null==y.conf&&(y.conf=u),T.print_options_keys=T.print_options_raw.$keys(),B=c["$[]"]("voice_nr"),j=h(n,"select",[],(l=function(e){l.$$s;return null==e&&(e=u),e["$is_a?"]($(ie,"Playable"))},l.$$s=T,l.$$arity=1,l)),_(c["$[]"]("nonflowrest"))||(F=u,h(j,"each",[],(p=function(t){var n,a,i=(p.$$s,u);return null==t&&(t=u),_(_(n=t["$is_a?"]($(ie,"Pause")))?c["$[]"]("flowline")["$!"]():n)&&(i=[!1],h(t,"visible=",e.to_a(i)),i[r(i.length,1)]),
_(_(n=_(a=t["$is_a?"]($(ie,"Pause")))?c["$[]"]("subflowline")["$!"]():a)?c["$[]"]("flowline")["$!"]():n)&&(i=[!1],h(t,"visible=",e.to_a(i)),i[r(i.length,1)]),_(_(n=_(a=c["$[]"]("flowline")["$!"]())?t.$visible():a)?c["$[]"]("synched_notes")["$include?"](t.$proxy_note())["$!"]():n)&&(_(F["$nil?"]())||(i=[!0],h(F,"visible=",e.to_a(i)),i[r(i.length,1)])),F=t},p.$$s=T,p.$$arity=1,p))),R=[],D=h(j,"map",[],(d=function(e){var t=d.$$s||this,r=u,n=u,a=u,i=u;return null==e&&(e=u),r="notebound.nconf.v_"+B+".t_"+e.$time(),n="extract."+o+"."+r,a=t.$layout_playable(e,s,n),i=a.$proxy(),R.$push(function(){return _(e.$decorations()["$empty?"]())?[]:t.$make_decorations_per_playable(e,i,o,c,B)}()),i.$more_conf_keys().$push(m(["conf_key","text","icon","value"],{conf_key:i.$conf_key().$gsub(/\.[^\.]+$/,"")+".nshift",text:$(ie,"I18n").$t("shift left"),icon:"fa fa-arrow-left",value:-.5})),i.$more_conf_keys().$push(m(["conf_key","text","icon","value"],{conf_key:i.$conf_key().$gsub(/\.[^\.]+$/,"")+".nshift",text:$(ie,"I18n").$t("shift right"),icon:"fa fa-arrow-right",value:.5})),i.$more_conf_keys().$push(m(["text","icon","value"],{text:"---",icon:"fa fa-arrows-v",value:.5})),i.$more_conf_keys().$push(m(["conf_key","text","icon"],{conf_key:"extract."+o+".notebound.minc."+e.$time()+".minc_f",text:$(ie,"I18n").$t("Edit Minc"),icon:"fa fa-arrows-v"})),i.$more_conf_keys().$push(m(["conf_key","text","icon","value"],{conf_key:"extract."+o+".notebound.minc."+e.$time()+".minc_f",text:$(ie,"I18n").$t("increase Minc"),icon:"fa fa-arrow-down",value:.5})),i.$more_conf_keys().$push(m(["conf_key","text","icon","value"],{conf_key:"extract."+o+".notebound.minc."+e.$time()+".minc_f",text:$(ie,"I18n").$t("decrease Minc"),icon:"fa fa-arrow-up",value:-.5})),a.$shapes()},d.$$s=T,d.$$arity=1,d)).$flatten().$compact(),R=R.$flatten().$compact(),v=h(y.log,"benchmark",["countnotes / barnumbers"],(b=function(){return(b.$$s||this).$layout_barnumbers_countnotes(j,o,c,B)},b.$$s=T,b.$$arity=0,b)),g=e.to_ary(v),z=null==g[0]?u:g[0],q=null==g[1]?u:g[1],F=u,U=y.settings["$[]"]("flowconf")["$=="]("true"),H=y.conf["$[]"]("defaults.notebound.flowline"),G="notebound.flowline.v_"+B,Y=_(g=c["$[]"]("print_options_raw")["$[]"](G))?g:m([],{}),V=h(h(n,"select",[],(x=function(e){x.$$s;return null==e&&(e=u),e["$is_a?"]($(ie,"Playable"))},x.$$s=T,x.$$arity=1,x)),"map",[],(w=function(n){var a,i,s,c=w.$$s||this,l=u,p=u,d=u,g=u,v=u,b=u,x=u,A=u,k=u,E=u,S=u,N=u,C=u,I=u;if(null==y.conf&&(y.conf=u),null==n&&(n=u),l=u,_(F["$nil?"]()));else{if(_(!0))if(p=""+n.$znid(),d=Y["$[]"](p),_(_(a=d)?a:U["$=="](!0))){g="extract."+o+"."+G+"."+p,v=t(g,".*"),b=c.$Vector2d(F.$sheet_drawable().$center()),x=c.$Vector2d(n.$sheet_drawable().$center()),A=$(ie,"Confstack").$new(),A.$push(H);try{A.$push(d)}catch(t){if(!e.rescue(t,[$(ie,"StandardError")]))throw t;e.pop_exception()}i=c.$make_annotated_bezier_path([b,x],A),a=e.to_ary(i),k=null==a[0]?u:a[0],E=null==a[1]?u:a[1],S=null==a[2]?u:a[2],N=null==a[3]?u:a[3],C=U["$=="](!0)?m(["handler","p1","p2","cp1","cp2","mp","tuplet_options","conf_key","callback"],{handler:"tuplet",p1:b.$to_a(),p2:x.$to_a(),cp1:S.$to_a(),cp2:N.$to_a(),mp:E,tuplet_options:A,conf_key:g,callback:u}):u,l=h(f(f($(ie,"Harpnotes"),"Drawing"),"Path").$new(k),"tap",[],(s=function(t){var n=(s.$$s,u);return null==t&&(t=u),n=[v],h(t,"conf_key=",e.to_a(n)),n[r(n.length,1)],n=[C],h(t,"draginfo=",e.to_a(n)),n[r(n.length,1)]},s.$$s=c,s.$$arity=1,s))}else l=f(f($(ie,"Harpnotes"),"Drawing"),"FlowLine").$new(F.$sheet_drawable(),n.$sheet_drawable());I=[y.conf.$get("layout.LINE_MEDIUM")],h(l,"line_width=",e.to_a(I)),I[r(I.length,1)],_(F["$visible?"]())||(l=u)}return _(n["$first_in_part?"]())&&(l=u),_(n["$visible?"]())||(l=u),F=n,l},w.$$s=T,w.$$arity=1,w)).$compact(),F=u,Q=h(h(n,"select",[],(A=function(e){var t;A.$$s;return null==e&&(e=u),_(t=e["$is_a?"]($(ie,"Playable")))?t:e["$is_a?"]($(ie,"SynchPoint"))},A.$$s=T,A.$$arity=1,A)),"map",[],(k=function(e){var t,r,n=(k.$$s,u);return null==e&&(e=u),_(c["$[]"]("synched_notes")["$include?"](e.$proxy_note()))||(n=u,_(_(t=_(r=F["$nil?"]()["$!"]())?F.$visible():r)?e.$visible():t)&&(n=$(ie,"FlowLine").$new(F.$sheet_drawable(),e.$sheet_drawable(),"dotted")),_(e["$first_in_part?"]())&&(n=u)),F=e,n},k.$$s=T,k.$$arity=1,k)).$compact(),_(c["$[]"]("subflowline"))||(Q=[]),_(c["$[]"]("flowline"))||(V=[]),_(c["$[]"]("countnotes"))||(q=[]),_(c["$[]"]("barnumbers"))||(z=[]),X=j.$first(),W=[],J=h(j,"inject",[[]],(E=function(n,a){var i,s,l,p,d,g,v=E.$$s||this,b=u,x=u,w=u,A=u,k=u,S=u,N=u,C=u,I=u,O=u,L=u,P=u,M=u,T=u,j=u,F=u,R=u,D=u;if(null==y.conf&&(y.conf=u),null==n&&(n=u),null==a&&(a=u),_(a["$tuplet_start?"]())&&(X=a),_(X)&&W.$push(a.$time()),_(a["$tuplet_end?"]())){b="notebound.tuplet.v_"+B+"."+X.$znid(),x="extract."+o+"."+b,w="pos",A=$(ie,"Confstack").$new(),A.$push(y.conf["$[]"]("defaults.notebound.tuplet"));try{A.$push(c["$[]"]("print_options_raw")["$[]"](b))}catch(t){if(!e.rescue(t,[$(ie,"StandardError")]))throw t;e.pop_exception()}k=v.$Vector2d(X.$sheet_drawable().$center()),S=v.$Vector2d(a.$sheet_drawable().$center()),s=v.$make_annotated_bezier_path([k,S],A),i=e.to_ary(s),N=null==i[0]?u:i[0],C=null==i[1]?u:i[1],I=null==i[2]?u:i[2],O=null==i[3]?u:i[3],L=function(){try{return A["$[]"]("pos")}catch(t){if(!e.rescue(t,[$(ie,"StandardError")]))throw t;try{return[0,0]}finally{e.pop_exception()}}}(),P=t(C,L),M=h(r(P,C).$to_a(),"map",[],(l=function(e){l.$$s;return null==e&&(e=u),e.$round(0)},l.$$s=v,l.$$arity=1,l)),T=h(v,"lambda",[],(p=function(e){p.$$s;return null==e&&(e=u),u},p.$$s=v,p.$$arity=1,p)),A["$[]"]("show")["$=="](!1)||(j=t(x,".*"),F=_(i=c["$[]"]("print_options_raw")["$[]"]("tuplets.style"))?i:"small",R=m(["handler","p1","p2","cp1","cp2","mp","tuplet_options","conf_key","callback"],{handler:"tuplet",p1:k.$to_a(),p2:S.$to_a(),cp1:I.$to_a(),cp2:O.$to_a(),mp:C,tuplet_options:A,conf_key:x,callback:T}),D=_(i=c["$[]"]("print_options_raw")["$[]"]("tuplets.text"))?i:a.$tuplet().$to_s(),D=D.$gsub("{{tuplet}}",a.$tuplet().$to_s()),n.$push(h(f(f($(ie,"Harpnotes"),"Drawing"),"Path").$new(N),"tap",[],(d=function(t){var n=(d.$$s,u);return null==y.conf&&(y.conf=u),null==t&&(t=u),n=[j],h(t,"conf_key=",e.to_a(n)),n[r(n.length,1)],n=[y.conf.$get("layout.LINE_THIN")],h(t,"line_width=",e.to_a(n)),n[r(n.length,1)],n=[R],h(t,"draginfo=",e.to_a(n)),n[r(n.length,1)]},d.$$s=v,d.$$arity=1,d))),n.$push(h(f(f($(ie,"Harpnotes"),"Drawing"),"Annotation").$new(P.$to_a(),D,F,X.$origin(),t(x,"."+w),M.$to_a()),"tap",[],(g=function(t){var n=(g.$$s,u);return null==t&&(t=u),n=[m(["handler"],{handler:"annotation"})],h(t,"draginfo=",e.to_a(n)),n[r(n.length,1)]},g.$$s=v,g.$$arity=1,g)))),W=[],X=u}return n},E.$$s=T,E.$$arity=2,E)),K=["first_playable",j.$first()],h(T.slur_index,"[]=",e.to_a(K)),K[r(K.length,1)],Z=j.$first(),ee=h(j,"inject",[[]],(S=function(n,a){var i,s,o,c,l=S.$$s||this,p=u,d=u,m=u;return null==l.slur_index&&(l.slur_index=u),null==y.conf&&(y.conf=u),null==n&&(n=u),null==a&&(a=u),_(a["$tie_end?"]())&&(p=t(l.$Vector2d(Z.$sheet_drawable().$center()),[3,0]),d=t(l.$Vector2d(a.$sheet_drawable().$center()),[3,0]),m=function(){return _(y.conf["$[]"]("layout.bottomup"))?l.$make_slur_path(d,p):l.$make_slur_path(p,d)}(),n.$push(h(f(f($(ie,"Harpnotes"),"Drawing"),"Path").$new(m),"tap",[],(i=function(t){i.$$s;return null==y.conf&&(y.conf=u),null==t&&(t=u),K=[y.conf.$get("layout.LINE_MEDIUM")],h(t,"line_width=",e.to_a(K)),K[r(K.length,1)]},i.$$s=l,i.$$arity=1,i))),_(a["$is_a?"](f(f($(ie,"Harpnotes"),"Music"),"SynchPoint")))&&h(a.$notes(),"each_with_index",[],(s=function(a,i){var o,c=s.$$s||this;null==y.log&&(y.log=u),null==a&&(a=u),null==i&&(i=u);try{return p=Z.$notes()["$[]"](i),p=t(c.$Vector2d(p.$sheet_drawable().$center()),[3,0]),d=t(c.$Vector2d(a.$sheet_drawable().$center()),[3,0]),m=c.$make_slur_path(p,d),n.$push(h(f(f($(ie,"Harpnotes"),"Drawing"),"Path").$new(m),"tap",[],(o=function(t){o.$$s;return null==y.conf&&(y.conf=u),null==t&&(t=u),K=[y.conf.$get("layout.LINE_MEDIUM")],h(t,"line_width=",e.to_a(K)),K[r(K.length,1)]},o.$$s=c,o.$$arity=1,o)))}catch(t){if(!e.rescue(t,[$(ie,"Exception")]))throw t;t;try{return y.log.$error("tied chords which doesn't have same number of notes",a.$start_pos())}finally{e.pop_exception()}}},s.$$s=l,s.$$arity=2,s))),_(a["$tie_start?"]())&&(Z=a),h(a.$slur_starts(),"each",[],(o=function(t){var n=o.$$s||this;return null==n.slur_index&&(n.slur_index=u),null==t&&(t=u),K=[t,a],h(n.slur_index,"[]=",e.to_a(K)),K[r(K.length,1)]},o.$$s=l,o.$$arity=1,o)),K=[a.$slur_starts().$first(),a],h(l.slur_index,"[]=",e.to_a(K)),K[r(K.length,1)],h(a.$slur_ends(),"each",[],(c=function(i){var s,o,l=c.$$s||this,m=u,g=u;return null==l.slur_index&&(l.slur_index=u),null==y.conf&&(y.conf=u),null==i&&(i=u),m=_(s=l.slur_index["$[]"](i))?s:l.slur_index["$[]"]("first_playable"),p=t(l.$Vector2d(m.$sheet_drawable().$center()),[3,0]),d=t(l.$Vector2d(a.$sheet_drawable().$center()),[3,0]),g=l.$make_slur_path(p,d),_(y.conf.$get("layout.SHOW_SLUR"))?n.$push(h(f(f($(ie,"Harpnotes"),"Drawing"),"Path").$new(g),"tap",[],(o=function(t){o.$$s;return null==y.conf&&(y.conf=u),null==t&&(t=u),K=[y.conf.$get("layout.LINE_MEDIUM")],h(t,"line_width=",e.to_a(K)),K[r(K.length,1)]},o.$$s=l,o.$$arity=1,o))):u},c.$$s=l,c.$$arity=1,c)),n},S.$$s=T,S.$$arity=2,S)),te=h(h(n,"select",[],(N=function(e){N.$$s;return null==e&&(e=u),e["$is_a?"]($(ie,"Goto"))},N.$$s=T,N.$$arity=1,N)),"map",[],(C=function(n){var s,l,p=C.$$s||this,d=u,g=u,v=u,b=u,x=u,w=u,A=u,k=u,E=u,S=u,N=u,I=u,O=u,L=u,P=u;return null==y.log&&(y.log=u),null==y.conf&&(y.conf=u),null==n&&(n=u),_(n.$conf_key())&&(d="extract."+o+"."+n.$conf_key(),g=c["$[]"]("print_options_raw")["$[]"](n.$conf_key()),_(g)||(v=d.$gsub(/(.*)\.(\d+)\.(\d+)\.(\w+)/,"\\1.\\2.\\4"),g=c["$[]"]("print_options_raw")["$[]"](v))),_(g)||(g=n.$policy()["$[]"]("distance")),_(g)||(g=1),b=function(){return!g["$=="](0)}(),_(a(g,0))&&(g=r(g,1)),x=_(s=n.$policy()["$[]"]("from_anchor"))?s:"after",w=_(s=n.$policy()["$[]"]("to_anchor"))?s:"before",A=_(s=n.$policy()["$[]"]("vertical_anchor"))?s:"from",y.log.$debug("vertical line x offset: "+g+" "+"./harpnotes.rb".$force_encoding("US-ASCII")+":2131"),k=i(t(g,.5),y.conf.$get("layout.X_SPACING")),E=n.$from().$sheet_drawable(),S=n.$to().$sheet_drawable(),_(y.conf["$[]"]("layout.bottomup"))&&(N=m(["before","after"],{before:"after",after:"before"}),x=N["$[]"](x),w=N["$[]"](w)),I=p.$compute_vertical_cut(E,S),O=m(["from","to","vertical","vertical_anchor","padding","xspacing","jumpline_anchor","verticalcut"],{from:m(["center","size","anchor"],{center:E.$center(),size:E.$size(),anchor:x}),to:m(["center","size","anchor"],{center:S.$center(),size:S.$size(),anchor:w}),vertical:k,vertical_anchor:A,padding:n.$policy()["$[]"]("padding"),xspacing:y.conf["$[]"]("layout.X_SPACING"),jumpline_anchor:y.conf["$[]"]("layout.jumpline_anchor"),verticalcut:I}),L=f(f($(ie,"Harpnotes"),"Layout"),"Default").$make_path_from_jumpline(O),P=m(["handler","jumpline","xspacing"],{handler:"jumpline",jumpline:O,xspacing:y.conf.$get("layout.X_SPACING")}),_(b)?_(_(s=n.$policy()["$[]"]("is_repeat"))?c["$[]"]("repeatsigns")["$[]"]("voices")["$include?"](c["$[]"]("voice_nr")):s)?u:[h(f(f($(ie,"Harpnotes"),"Drawing"),"Path").$new(L["$[]"](0),u,n.$from()),"tap",[],(l=function(t){l.$$s;return null==y.conf&&(y.conf=u),null==t&&(t=u),K=[d],h(t,"conf_key=",e.to_a(K)),K[r(K.length,1)],K=[g],h(t,"conf_value=",e.to_a(K)),K[r(K.length,1)],K=[y.conf.$get("layout.LINE_THICK")],h(t,"line_width=",e.to_a(K)),K[r(K.length,1)],K=[P],h(t,"draginfo=",e.to_a(K)),K[r(K.length,1)]},l.$$s=p,l.$$arity=1,l)),f(f($(ie,"Harpnotes"),"Drawing"),"Path").$new(L["$[]"](1),"filled",n.$from()),f(f($(ie,"Harpnotes"),"Drawing"),"Path").$new(L["$[]"](2),"filled",n.$from())]:u},C.$$s=T,C.$$arity=1,C)).$flatten().$compact(),_(c["$[]"]("jumpline"))||(te=[]),re=T.color_default,h(te,"each",[],(I=function(t){I.$$s;return null==t&&(t=u),K=[re],h(t,"color=",e.to_a(K)),K[r(K.length,1)]},I.$$s=T,I.$$arity=1,I)),ne=[],_(c["$[]"]("repeatsigns")["$[]"]("voices")["$include?"](c["$[]"]("voice_nr")))&&(ne=h(h(n,"select",[],(O=function(e){var t;O.$$s;return null==e&&(e=u),_(t=e["$is_a?"]($(ie,"Goto")))?e.$policy()["$[]"]("is_repeat"):t},O.$$s=T,O.$$arity=1,O)),"map",[],(L=function(e){var t=L.$$s||this,r=u,n=u;return null==e&&(e=u),r=t.$make_repeatsign_annotation(e,"begin",o,c,B),n=t.$make_repeatsign_annotation(e,"end",o,c,B),[n,r]},L.$$s=T,L.$$arity=1,L)).$flatten()),ae=h(h(n,"select",[],(P=function(e){P.$$s;return null==e&&(e=u),e["$is_a?"]($(ie,"NoteBoundAnnotation"))},P.$$s=T,P.$$arity=1,P)),"map",[],(M=function(n){var a,i,s=M.$$s||this,l=u,p=u,d=u,y=u,g=u,v=u,b=u,x=u;return null==n&&(n=u),l=t(n.$conf_key(),".pos"),p=c["$[]"]("print_options_raw").$get(t(n.$conf_key(),".show")),d=function(){return!!_(p["$nil?"]())||p}(),_(l)?(y="extract."+o+"."+l,g=function(){try{return c["$[]"]("print_options_raw").$get(l)}catch(t){if(!e.rescue(t,[$(ie,"StandardError")]))throw t;try{return u}finally{e.pop_exception()}}}(),_(g)||(g=n.$position())):(g=n.$position(),y=u),v=_(a=c["$[]"]("print_options_raw").$get(t(n.$conf_key(),".style")))?a:n.$style(),b=t(s.$Vector2d(n.$companion().$sheet_drawable().$center()),g),x=h(f(f($(ie,"Harpnotes"),"Drawing"),"Annotation").$new(b.$to_a(),n.$text(),v,n.$companion().$origin(),y,g),"tap",[],(i=function(t){i.$$s;return null==t&&(t=u),K=[m(["handler"],{handler:"annotation"})],h(t,"draginfo=",e.to_a(K)),K[r(K.length,1)]},i.$$s=s,i.$$arity=1,i)),_((a=n.$policy()["$=="]("Goto"))?c["$[]"]("jumpline")["$!"]():n.$policy()["$=="]("Goto"))&&(x=u),d["$=="](!1)&&(x=u),x},M.$$s=T,M.$$arity=1,M)),t(t(t(t(t(t(t(t(t(t(V,Q),ee),J),D),q),z),R),te),ae),ne).$compact()},O.$$arity=4),e.def(ae,"$make_decorations_per_playable",L=function(a,s,o,c,l){var p,d,y=this,g=u,v=u,b=u,x=u,w=u;return g=u,g=a.$decorations(),_(g["$empty?"]())||(v=function(){return _(a.$measure_start())?2:1}(),b=.8,x=h(s.$size(),"map",[],(p=function(e){p.$$s;return null==e&&(e=u),i(e,b)},p.$$s=y,p.$$arity=1,p)),w=[],h(g,"each_with_index",[],(d=function(i,p){var y,g=d.$$s||this,A=u,k=u,E=u,S=u,N=u;return null==i&&(i=u),null==p&&(p=u),A="notebound.decoration.v_"+l+".t_"+a.$znid()+"."+p+".pos",k="extract."+o+"."+A,E=function(){try{return c["$[]"]("print_options_raw")["$[]"](A)}catch(t){if(!e.rescue(t,[$(ie,"StandardError")]))throw t;try{return u}finally{e.pop_exception()}}}(),_(E)||(E=[0,r(n(s.$size().$last()["$-@"](),b),v).$round()]),S=[t(s.$center().$first(),E.$first()),t(s.$center().$last(),E.$last())],N=f(f($(ie,"Harpnotes"),"Drawing"),"Glyph").$new(S,x,i,!1,u,k,E),h(N,"tap",[],(y=function(t){var n=(y.$$s,u);return null==t&&(t=u),n=[m(["handler"],{handler:"annotation"})],h(t,"draginfo=",e.to_a(n)),n[r(n.length,1)]},y.$$s=g,y.$$arity=1,y)),w.$push([N])},d.$$s=y,d.$$arity=2,d))),w},L.$$arity=5),e.def(ae,"$make_repeatsign_annotation",P=function(n,a,i,s,c){var l,p,d=this,y=u,g=u,v=u,b=u,x=u,w=u,A=u,k=u,E=u,S=u;return _(l=n.$policy()["$[]"]("from_anchor"))?l:"after",_(l=n.$policy()["$[]"]("to_anchor"))?l:"before",a["$=="]("begin")?(y=n.$to(),g=n.$to()["$=="](n.$from())?"left":function(){return _(o(y.$pitch(),y.$next_pitch()))?"left":"right"}()):(y=n.$from(),g=n.$to()["$=="](n.$from())?"right":function(){return _(o(y.$prev_pitch(),y.$pitch()))?"right":"left"}()),v="notebound.repeat_"+a.$to_s()+".v_"+c+"."+y.$znid(),b=v+".pos",x="extract."+i+"."+b,w=s["$[]"]("repeatsigns")["$[]"](g),A=function(){try{return s["$[]"]("print_options_raw")["$[]"](b)}catch(t){if(!e.rescue(t,[$(ie,"StandardError")]))throw t;try{return u}finally{e.pop_exception()}}}(),_(A)||(A=w["$[]"]("pos")),k=_(l=s["$[]"]("print_options_raw")["$[]"](v+".text"))?l:w["$[]"]("text"),E=_(l=s["$[]"]("print_options_raw")["$[]"](v+".style"))?l:w["$[]"]("style"),S=t(d.$Vector2d(y.$sheet_drawable().$center()),A),h(f(f($(ie,"Harpnotes"),"Drawing"),"Annotation").$new(S.$to_a(),k,E,y.$origin(),x,A),"tap",[],(p=function(t){var n=(p.$$s,u);return null==t&&(t=u),n=[m(["handler"],{handler:"annotation"})],h(t,"draginfo=",e.to_a(n)),n[r(n.length,1)]},p.$$s=d,p.$$arity=1,p))},P.$$arity=5),ae.$private(),e.def(ae,"$compute_vertical_cut",M=function(e,n){var a,i=u,s=u,o=u,c=u,l=u;return null==y.conf&&(y.conf=u),i=_(a=y.conf["$[]"]("layout.jumpline_vcut"))?a:0,s=r([e.$origin().$prev_playable(),e.$origin().$next_playable()],[e.$origin()]),o=r([n.$origin().$prev_playable(),n.$origin().$next_playable()],[n.$origin()]),c=[e.$origin(),n.$origin()].$compact(),l=t(s,o)["$&"](c),_(l["$empty?"]())||(i=0),i},M.$$arity=2),e.def(ae,"$layout_barnumbers_countnotes",T=function(n,a,i,s){var o,c,l,p,d=this,g=u,v=u,b=u,x=u,w=u,A=u,k=u,E=u,S=u,N=u,C=u,I=u,O=u,L=u,P=u,M=u,T=u,B=u,j=u,F=u,R=u,D=u;return null==y.conf&&(y.conf=u),g=y.conf["$[]"]("layout.limit_a3")["$=="](!0),v=y.conf["$[]"]("layout.bottomup")["$=="](!0),b=i["$[]"]("countnotes"),x=i["$[]"]("barnumbers"),w=[],A=[],_(_(o=b)?o:x)&&(k=h(n,"select",[],(c=function(e){c.$$s;return null==e&&(e=u),e["$visible?"]()},c.$$s=d,c.$$arity=1,c)),_(b)&&(E=b["$[]"]("style"),o=[1,1],o[0],S=o[1],N=b["$[]"]("apanchor"),C=b["$[]"]("autopos"),I=b["$[]"]("pos"),l=b["$[]"]("apbase"),o=e.to_ary(l),O=null==o[0]?u:o[0],L=null==o[1]?u:o[1]),_(x)&&(P=x["$[]"]("style"),o=[2.7,2.7],o[0],M=o[1],T=x["$[]"]("apanchor"),B=x["$[]"]("autopos"),j=x["$[]"]("pos"),l=x["$[]"]("apbase"),o=e.to_ary(l),F=null==o[0]?u:o[0],R=null==o[1]?u:o[1],D=x["$[]"]("prefix")),h(k,"each",[],(p=function(n){var i,o,c,l,d=p.$$s||this,y=u,k=u,z=u,q=u,U=u,H=u,G=u,Y=u,V=u,Q=u,X=u,W=u,J=u,K=u,Z=u,ee=u,te=u,re=u,ne=u,ae=u,se=u,oe=u,ce=u,le=u,ue=u,fe=u,$e=u,pe=u,de=u,he=u,_e=u,me=u;return null==d.print_options_keys&&(d.print_options_keys=u),null==d.print_options_raw&&(d.print_options_raw=u),null==n&&(n=u),y=n.$sheet_drawable(),k=y.$center(),o=k,i=e.to_ary(o),z=null==i[0]?u:i[0],null==i[1]?u:i[1],o=y.$size(),i=e.to_ary(o),q=null==i[0]?u:i[0],U=null==i[1]?u:i[1],o=y.$size_with_dot(),i=e.to_ary(o),H=null==i[0]?u:i[0],null==i[1]?u:i[1],o=n.$prev_playable().$sheet_drawable().$center(),i=e.to_ary(o),G=null==i[0]?u:i[0],null==i[1]?u:i[1],o=n.$next_playable().$sheet_drawable().$center(),i=e.to_ary(o),Y=null==i[0]?u:i[0],null==i[1]?u:i[1],o=function(){return _(v)?d.$compute_note_position(Y,z,G,g).$reverse():d.$compute_note_position(G,z,Y,g)}(),i=e.to_ary(o),V=null==i[0]?u:i[0],Q=null==i[1]?u:i[1],_(b)&&(X="notebound.countnote.v_"+s+".t_"+n.$time(),W=X+".pos",J=X+".align",K=_(i=n.$count_note())?i:"",Z=function(){return _("center"["$=="](N))?0:U}(),_(d.print_options_keys["$include?"](W))&&(ee=d.print_options_raw["$[]"](W)),_(_(i=d.print_options_keys["$include?"](J))?d.print_options_raw["$[]"](J)["$!="]("auto"):i)&&(Q=d.print_options_raw["$[]"](J)),te=function(){return C["$=="](!0)&&_(Q["$=="]("l"))?"right":"left"}(),_(ee)||(C["$=="](!0)?(re=function(){return _((i=Q["$=="]("r"))?n["$tie_start?"]():Q["$=="]("r"))?1.5:0}(),ne=t(re,function(){return Q["$=="]("l")?t(q,O)["$-@"]():t(H,O)}()),ae=function(){return _(v)?t(t(Z,L),S)["$-@"]():t(Z,L)}(),ee=[ne,ae]):ee=I),se=t(d.$Vector2d(k),ee),w.$push(h(f(f($(ie,"Harpnotes"),"Drawing"),"Annotation").$new(se.$to_a(),K,E,n.$origin(),"extract."+a+"."+W,ee),"tap",[],(c=function(t){var n=(c.$$s,u);return null==t&&(t=u),n=[te],h(t,"align=",e.to_a(n)),n[r(n.length,1)],n=[m(["handler"],{handler:"annotation"})],h(t,"draginfo=",e.to_a(n)),n[r(n.length,1)],t.$more_conf_keys().$push(m(["conf_key","text","icon","value"],{conf_key:"extract."+a+"."+J,text:$(ie,"I18n").$t("countnote left"),icon:"fa fa-arrow-left",value:"l"})),t.$more_conf_keys().$push(m(["conf_key","text","icon","value"],{conf_key:"extract."+a+"."+J,text:$(ie,"I18n").$t("countnote right"),icon:"fa fa-arrow-right",value:"r"}))},c.$$s=d,c.$$arity=1,c)))),_(_(i=x)?n["$measure_start?"]():i)?(X="notebound.countnote.v_"+s+".t_"+n.$time(),W=X+".pos",J=X+".align","extract."+a+"."+X,K=_(i=n.$count_note())?i:"",oe="notebound.barnumber.v_"+s+".t_"+n.$time(),ce=oe+".pos",le=oe+".align","extract."+a+"."+ce,ue=_(i=""+D+n.$measure_count().$to_s())?i:"",fe=function(){return _("center"["$=="](T))?0:U}(),_(d.print_options_keys["$include?"](ce))&&($e=d.print_options_raw["$[]"](ce)),_(_(i=d.print_options_keys["$include?"](le))?d.print_options_raw["$[]"](le)["$!="]("auto"):i)&&(V=d.print_options_raw["$[]"](le)),pe=function(){return B["$=="](!0)&&_(V["$=="]("l"))?"right":"left"}(),_($e)||(B["$=="](!0)?(de=function(){return _((i=V["$=="]("r"))?n["$tie_start?"]():V["$=="]("r"))?1:0}(),he=t(de,function(){return V["$=="]("l")?t(q,F)["$-@"]():t(H,F)}()),_e=function(){return _(v)?t(fe,R):t(t(fe,R),M)["$-@"]()}(),$e=[he,_e]):$e=j),me=t(d.$Vector2d(k),$e),A.$push(h(f(f($(ie,"Harpnotes"),"Drawing"),"Annotation").$new(me.$to_a(),ue,P,n.$origin(),"extract."+a+"."+ce,$e),"tap",[],(l=function(t){var n=(l.$$s,u);return null==t&&(t=u),n=[pe],h(t,"align=",e.to_a(n)),n[r(n.length,1)],n=[m(["handler"],{handler:"annotation"})],h(t,"draginfo=",e.to_a(n)),n[r(n.length,1)],t.$more_conf_keys().$push(m(["conf_key","text","icon","value"],{conf_key:"extract."+a+"."+le,text:$(ie,"I18n").$t("barnumber left"),icon:"fa fa-arrow-left",value:"l"})),t.$more_conf_keys().$push(m(["conf_key","text","icon","value"],{conf_key:"extract."+a+"."+le,text:$(ie,"I18n").$t("barnumber right"),icon:"fa fa-arrow-right",value:"r"}))},l.$$s=d,l.$$arity=1,l)))):u},p.$$s=d,p.$$arity=1,p))),[A,w]},T.$$arity=4),e.def(ae,"$compute_beat_compression",B=function(e,t){var r,n=this,a=u;return null==y.conf&&(y.conf=u),y.conf.$get("layout.packer.pack_method")["$=="](1)&&(a=n.$compute_beat_compression_1(e,t)),y.conf.$get("layout.packer.pack_method")["$=="](2)&&(a=n.$compute_beat_compression_2(e,t)),y.conf.$get("layout.packer.pack_method")["$=="](10)&&(a=n.$compute_beat_compression_10(e,t)),(_(r=y.conf.$get("layout.packer.pack_method"))?r:0)["$=="](0)&&(a=n.$compute_beat_compression_0(e,t)),a},B.$$arity=2),e.def(ae,"$compute_beat_compression_2",j=function(t,n){var a,s,o,c,l,p,d,_=this,y=u,g=u,v=u,b=u;return y=m([],{}),g=h(h(h(n,"map",[],(a=function(e){a.$$s;return null==e&&(e=u),t.$voices()["$[]"](e)},a.$$s=_,a.$$arity=1,a)),"inject",[[]],(s=function(e,t){s.$$s;return null==e&&(e=u),null==t&&(t=u),e.$push(t)},s.$$s=_,s.$$arity=2,s)).$flatten(),"select",[],(o=function(e){o.$$s;return null==e&&(e=u),e["$is_a?"](f(f($(ie,"Harpnotes"),"Music"),"Playable"))},o.$$s=_,o.$$arity=1,o)),v=h(h(g,"select",[],(c=function(e){c.$$s;return null==e&&(e=u),e["$is_a?"](f(f($(ie,"Harpnotes"),"Music"),"SynchPoint"))},c.$$s=_,c.$$arity=1,c)),"map",[],(l=function(e){l.$$s;return null==e&&(e=u),e.$notes()},l.$$s=_,l.$$arity=1,l)),g=g.$push(v).$flatten(),b=h(g,"group_by",[],(p=function(e){p.$$s;return null==e&&(e=u),e.$beat()},p.$$s=_,p.$$arity=1,p)),h(b.$keys().$sort(),"each",[],(d=function(t){var n=(d.$$s,u);return null==t&&(t=u),n=[t,i(t,8)],h(y,"[]=",e.to_a(n)),n[r(n.length,1)]},d.$$s=_,d.$$arity=1,d)),y},j.$$arity=2),e.def(ae,"$compute_beat_compression_10",F=function(r,a){var i,s,o,c,l=this,f=u,p=u,d=u,m=u,g=u;return null==y.conf&&(y.conf=u),h(r.$beat_maps(),"map",[],(i=function(e){i.$$s;return null==e&&(e=u),e.$keys().$max()},i.$$s=l,i.$$arity=1,i)).$max(),f=0,p=0,d=h(a,"inject",[[]],(s=function(e,t){s.$$s;return null==e&&(e=u),null==t&&(t=u),e.$push(r.$beat_maps()["$[]"](t))},s.$$s=l,s.$$arity=2,s)).$compact(),m=h(r.$beat_maps(),"inject",[[]],(o=function(e,t){o.$$s;return null==e&&(e=u),null==t&&(t=u),e.$push(t.$keys()),e},o.$$s=l,o.$$arity=2,o)).$flatten().$uniq().$sort(),g=y.conf.$get("layout.DURATION_TO_STYLE"),$(ie,"Hash")["$[]"](h(m,"map",[],(c=function(r){var a,i,s,o,l=c.$$s||this,m=u,v=u,b=u,x=u,w=u,A=u,k=u;if(null==l.conf_beat_resolution&&(l.conf_beat_resolution=u),null==y.log&&(y.log=u),null==r&&(r=u),m=h(d,"map",[],(a=function(e){a.$$s;return null==e&&(e=u),e["$[]"](r)},a.$$s=l,a.$$arity=1,a)).$flatten().$compact(),v=h(m,"map",[],(i=function(e){i.$$s;return null==e&&(e=u),e.$duration()},i.$$s=l,i.$$arity=1,i)).$max(),b=m["$empty?"](),x=h(m,"select",[],(s=function(e){s.$$s;return null==e&&(e=u),e["$first_in_part?"]()},s.$$s=l,s.$$arity=1,s)),w=h(m,"select",[],(o=function(e){o.$$s;return null==e&&(e=u),e["$measure_start?"]()},o.$$s=l,o.$$arity=1,o)).$first(),_(b));else{try{A=l.conf_beat_resolution*g["$[]"](l.$duration_to_id(v)).$first()}catch(t){if(!e.rescue(t,[$(ie,"Exception")]))throw t;t;try{y.log.$error("BUG: unsupported duration: "+v+" on beat "+r+",  "+m.$to_json())}finally{e.pop_exception()}}k=n(t(A,p),2),p=A,_(w)&&(k=t(k,n(k,4))),_(x["$empty?"]())||(k=t(k,k)),k=t(k,l.$get_minc_factor(m.$first().$time(),k)),f=t(f,k)}return[r,f]},c.$$s=l,c.$$arity=1,c)))},F.$$arity=2),e.def(ae,"$get_minc_factor",R=function(t,r){var n=this,a=u;if(null==r&&(r=n.conf_beat_resolution),a=n.layout_minc["$[]"](t.$to_s()),!_(a))return 0;try{return i(a["$[]"]("minc_f"),r)}catch(t){if(!e.rescue(t,[$(ie,"StandardError")]))throw t;try{return 0}finally{e.pop_exception()}}},R.$$arity=-2),e.def(ae,"$compute_beat_compression_0",D=function(a,s){var o,c,l,p,d,g,v,b,x=this,w=u,A=u,k=u,E=u,S=u,N=u,C=u;return null==y.conf&&(y.conf=u),w=y.conf.$get("layout.DURATION_TO_STYLE"),i(_(o=y.conf.$get("layout.packer.pack_min_increment"))?o:0,x.conf_beat_resolution),A=0,k=m([],{}),E=0,S=h(h(h(s,"map",[],(c=function(e){c.$$s;return null==e&&(e=u),a.$voices()["$[]"](e)},c.$$s=x,c.$$arity=1,c)),"inject",[[]],(l=function(e,t){l.$$s;return null==e&&(e=u),null==t&&(t=u),e.$push(t)},l.$$s=x,l.$$arity=2,l)).$flatten(),"select",[],(p=function(e){p.$$s;return null==e&&(e=u),e["$is_a?"](f(f($(ie,"Harpnotes"),"Music"),"Playable"))},p.$$s=x,p.$$arity=1,p)),N=h(h(S,"select",[],(d=function(e){d.$$s;return null==e&&(e=u),e["$is_a?"](f(f($(ie,"Harpnotes"),"Music"),"SynchPoint"))},d.$$s=x,d.$$arity=1,d)),"map",[],(g=function(e){g.$$s;return null==e&&(e=u),e.$notes()},g.$$s=x,g.$$arity=1,g)),S=S.$push(N).$flatten(),C=h(S,"group_by",[],(v=function(e){v.$$s;return null==e&&(e=u),e.$beat()},v.$$s=x,v.$$arity=1,v)),h(C.$keys().$sort(),"each",[],(b=function(a){var i,s,o,c=b.$$s||this,l=u,f=u,p=u,d=u,m=u,g=u,v=u,x=u;null==c.conf_beat_resolution&&(c.conf_beat_resolution=u),null==y.log&&(y.log=u),null==a&&(a=u),l=C["$[]"](a),f=h(l,"map",[],(i=function(e){i.$$s;return null==e&&(e=u),e.$duration()},i.$$s=c,i.$$arity=1,i)).$max(),p=h(l,"select",[],(s=function(e){s.$$s;return null==e&&(e=u),e["$first_in_part?"]()},s.$$s=c,s.$$arity=1,s)),d=h(l,"select",[],(o=function(e){o.$$s;return null==e&&(e=u),e["$measure_start?"]()},o.$$s=c,o.$$arity=1,o));try{m=c.conf_beat_resolution*w["$[]"](c.$duration_to_id(f)).$first()}catch(t){if(!e.rescue(t,[$(ie,"Exception")]))throw t;t;try{y.log.$error("BUG: unsupported duration: "+f+" on beat "+a+",  "+c.$notes_on_beat().$to_json())}finally{e.pop_exception()}}return g=n(t(m,E),2),E=m,v=g,_(p["$empty?"]())||(v=t(v,g)),_(d["$empty?"]())||(v=t(v,n(v,4))),v=t(v,c.$get_minc_factor(l.$first().$time(),g)),A=t(A,v),x=[a,A],h(k,"[]=",e.to_a(x)),x[r(x.length,1)]},b.$$s=x,b.$$arity=1,b)),k},D.$$arity=2),e.def(ae,"$compute_beat_compression_1",z=function(a,s){var o,l,p,d,g,v,b,x,w=this,A=u,k=u,E=u,S=u,N=u,C=u,I=u,O=u,L=u,P=u;return null==y.conf&&(y.conf=u),A=y.conf.$get("layout.DURATION_TO_STYLE"),k=i(_(o=y.conf.$get("layout.packer.pack_min_increment"))?o:0,w.conf_beat_resolution),E=m([],{}),S=m([],{}),N=0,C=0,I=0,O=h(h(h(s,"map",[],(l=function(e){l.$$s;return null==e&&(e=u),a.$voices()["$[]"](e)},l.$$s=w,l.$$arity=1,l)),"inject",[[]],(p=function(e,t){p.$$s;return null==e&&(e=u),null==t&&(t=u),e.$push(t)},p.$$s=w,p.$$arity=2,p)).$flatten(),"select",[],(d=function(e){d.$$s;return null==e&&(e=u),e["$is_a?"](f(f($(ie,"Harpnotes"),"Music"),"Playable"))},d.$$s=w,d.$$arity=1,d)),L=h(h(O,"select",[],(g=function(e){g.$$s;return null==e&&(e=u),e["$is_a?"](f(f($(ie,"Harpnotes"),"Music"),"SynchPoint"))},g.$$s=w,g.$$arity=1,g)),"map",[],(v=function(e){v.$$s;return null==e&&(e=u),e.$notes()},v.$$s=w,v.$$arity=1,v)),O=O.$push(L).$flatten(),P=h(O,"group_by",[],(b=function(e){b.$$s;return null==e&&(e=u),e.$beat()},b.$$s=w,b.$$arity=1,b)),h(P.$keys().$sort(),"each",[],(x=function(a){var i,s,o,l,f,p,d=x.$$s||this,m=u,g=u,v=u,b=u,w=u,O=u,L=u,M=u,T=u,B=u;null==d.conf_beat_resolution&&(d.conf_beat_resolution=u),null==y.log&&(y.log=u),null==a&&(a=u),m=P["$[]"](a),g=h(m,"map",[],(i=function(e){i.$$s;return null==e&&(e=u),e.$duration()},i.$$s=d,i.$$arity=1,i)).$max();try{v=d.conf_beat_resolution*A["$[]"](d.$duration_to_id(g)).$first()}catch(t){if(!e.rescue(t,[$(ie,"Exception")]))throw t;t;try{y.log.$error("BUG: unsupported duration: "+g+" on beat "+a+",  "+d.$notes_on_beat().$to_json())}finally{e.pop_exception()}}return b=n(t(v,I),2),I=v,w=h(m,"select",[],(s=function(e){var t;s.$$s;return null==e&&(e=u),c(_(t=E["$[]"](e.$pitch()))?t:-1,r(N,k))},s.$$s=d,s.$$arity=1,s)),O=h(m,"select",[],(o=function(e){var t,r=(o.$$s,u),n=u;return null==e&&(e=u),r=[_(t=e.$prev_pitch())?t:e.$pitch(),e.$pitch(),_(t=e.$next_pitch())?t:e.$pitch()],n=(_(t=r.$sort().$reverse()["$=="](r))?t:r.$sort()["$=="](r))["$!"](),_(e.$next_first_in_part())&&(n=!1),n},o.$$s=d,o.$$arity=1,o)),L=h(m,"select",[],(l=function(e){l.$$s;return null==e&&(e=u),e["$first_in_part?"]()},l.$$s=d,l.$$arity=1,l)),M=h(m,"select",[],(f=function(e){f.$$s;return null==e&&(e=u),e["$measure_start?"]()},f.$$s=d,f.$$arity=1,f)),T=C,C=k,_(w["$empty?"]()["$!"]())?T=b:_(O["$empty?"]()["$!"]())&&(C=n(b,2),T=C),_(L["$empty?"]())||(T=t(T,b),C=k),_(M["$empty?"]())||(T=t(T,n(T,4))),T=t(T,d.$get_minc_factor(m.$first().$time(),b)),N=t(N,T),h(m,"each",[],(p=function(t){var n=(p.$$s,u);return null==t&&(t=u),n=[t.$pitch(),N],h(E,"[]=",e.to_a(n)),n[r(n.length,1)]},p.$$s=d,p.$$arity=1,p)),B=[a,N],h(S,"[]=",e.to_a(B)),B[r(B.length,1)]},x.$$s=w,x.$$arity=1,x)),S},z.$$arity=2),e.def(ae,"$layout_playable",q=function(e,t,r){var n=this;return null==y.log&&(y.log=u),function(){return _(e["$is_a?"]($(ie,"Note")))?n.$layout_note(e,t,r+".n_0"):_(e["$is_a?"]($(ie,"SynchPoint")))?n.$layout_accord(e,t,r):_(e["$is_a?"]($(ie,"Pause")))?n.$layout_pause(e,t,r+".n_0"):y.log.$error("BUG: Missing Music -> Sheet transform: "+e)}()},q.$$arity=3),e.def(ae,"$layout_note",U=function(a,i,s){var o,c,l=this,f=u,p=u,d=u,m=u,g=u,v=u,b=u,x=u,w=u,A=u,k=u,E=u,S=u;return null==y.conf&&(y.conf=u),f=l.$convert_pitch_to_xpos(a),p=i.$call(a.$beat()),c=l.$compute_ellipse_properties_from_note(a),o=e.to_ary(c),d=null==o[0]?u:o[0],m=null==o[1]?u:o[1],g=null==o[2]?u:o[2],v=null==o[3]?u:o[3],b=l.$layout_note_shift(a,g,f,d,s),x=l.$compute_color_by_variant_no(a.$variant()),w=$(ie,"Ellipse").$new([t(f,b),p],g,m,d,a),A=[t(s,".***")],h(w,"conf_key=",e.to_a(A)),A[r(A.length,1)],A=[w],h(a,"sheet_drawable=",e.to_a(A)),A[r(A.length,1)],A=[x],h(w,"color=",e.to_a(A)),A[r(A.length,1)],A=[y.conf.$get("layout.LINE_THICK")],h(w,"line_width=",e.to_a(A)),A[r(A.length,1)],k=$(ie,"CompoundDrawable").$new([w],w),_(v)&&k.$push(l.$layout_note_flags(f,p,g,b,x,v)),_(a.$measure_start())&&(E=t(g.$last(),y.conf.$get("layout.LINE_THICK")),_(y.conf.$get("layout.bottomup"))&&(E=E["$-@"]()),S=function(){return _(_(o=v)?y.conf.$get("layout.bottomup")["$!"]():o)?y.conf.$get("layout.LINE_THICK"):0}(),w=$(ie,"Ellipse").$new([r(t(f,b),S),r(p,E)],[r(g.$first(),S),n(y.conf.$get("layout.LINE_THICK"),2)],"filled",!1,u,!0),A=[x],h(w,"color=",e.to_a(A)),A[r(A.length,1)],A=[y.conf.$get("layout.LINE_THIN")],h(w,"line_width=",e.to_a(A)),A[r(A.length,1)],k.$push(w)),k},U.$$arity=3),e.def(ae,"$layout_note_flags",H=function(a,s,o,c,l,p){var d,_,m,g=this,v=u,b=u,x=u,w=u,A=u,k=u,E=u,S=u,N=u,C=u,I=u,O=u,L=u;return null==y.conf&&(y.conf=u),g.instrument_orientation["$=="]("horizontal")?(d=[i(2,o["$[]"](1)),.1],v=d[0],b=d[1],x=y.conf.$get("layout.LINE_MEDIUM"),w=t(a,n(c,2)),A=r(t(s,o["$[]"](1)),n(x,2)),k=[["M",w,A],["l",v,b]],d=[i(-.6,o["$[]"](0)),i(.6,o["$[]"](1))],E=d[0],S=d[1],N=E,C=function(){try{return n(i(b,N),v)}catch(t){if(!e.rescue(t,[$(ie,"StandardError")]))throw t;try{return 0}finally{e.pop_exception()}}}(),I=["l",E,S],h(p,"times",[],(_=function(e){_.$$s;return null==e&&(e=u),k=t(k,[["M",t(t(w,v),i(e,N)),t(A,b)],I])},_.$$s=g,_.$$arity=1,_))):(d=[.1,i(2,o["$[]"](1))],v=d[0],b=d[1],x=y.conf.$get("layout.LINE_MEDIUM"),w=r(t(t(a,c),o["$[]"](0)),n(x,2)),A=s,k=[["M",w,A],["l",v,b["$-@"]()]],d=[i(1.3,o["$[]"](1)),i(.6,o["$[]"](1))],E=d[0],S=d[1],C=S,N=function(){try{return n(i(v,C),b)}catch(t){
if(!e.rescue(t,[$(ie,"StandardError")]))throw t;try{return 0}finally{e.pop_exception()}}}(),I=["l",E,S],h(p,"times",[],(m=function(e){m.$$s;return null==e&&(e=u),k=t(k,[["M",r(t(w,v),i(e,N)),t(r(s,b),i(e,C))],I])},m.$$s=g,m.$$arity=1,m))),O=f(f($(ie,"Harpnotes"),"Drawing"),"Path").$new(k,"open"),L=[x],h(O,"line_width=",e.to_a(L)),L[r(L.length,1)],L=[l],h(O,"color=",e.to_a(L)),L[r(L.length,1)],O},H.$$arity=6),e.def(ae,"$convert_pitch_to_xpos",G=function(e){return this.pitch_to_xpos.$call(e.$pitch())},G.$$arity=1),e.def(ae,"$compute_color_by_variant_no",Y=function(e){var t=this;return e["$=="](0)?t.color_default:function(){return _(e["$odd?"]())?t.color_variant1:t.color_variant2}()},Y.$$arity=1),e.def(ae,"$compute_ellipse_properties_from_note",V=function(t){var r,n,a,s=this,o=u,c=u,l=u,f=u,$=u;return null==y.conf&&(y.conf=u),n=y.conf.$get("layout.DURATION_TO_STYLE")["$[]"](s.$check_duration(t)),r=e.to_ary(n),o=null==r[0]?u:r[0],c=null==r[1]?u:r[1],l=null==r[2]?u:r[2],f=null==r[3]?u:r[3],$=h(y.conf.$get("layout.ELLIPSE_SIZE"),"map",[],(a=function(e){a.$$s;return null==e&&(e=u),i(e,o)},a.$$s=s,a.$$arity=1,a)),[l,c,$,f]},V.$$arity=1),e.def(ae,"$layout_note_shift",Q=function(e,n,o,c,l){var f=this,$=u,p=u,d=u;return null==y.conf&&(y.conf=u),$=0,_(y.conf.$get("layout.limit_a3"))&&(_(s(o,5))&&($=t($,n.$first())),_(a(o,415))&&($=t($,n.$first()["$-@"]()),_(c)&&($=r($,1.5)))),_(e.$shift())&&($=e.$shift()["$[]"]("dir")["$=="](-1)?t($,n.$first()["$-@"]()):t($,n.$first())),_(l)&&(p=l.$gsub(/extract\.(\d+)\./,""),_(f.print_options_keys["$include?"](p+".nshift"))&&(d=f.print_options_raw["$[]"](p+".nshift"),$=i(i(n.$first(),2),d))),$},Q.$$arity=5),e.def(ae,"$layout_accord",X=function(e,t,r){var n,a,i,s,o=this,c=u,l=u,f=u;return c=h(e.$notes().$reverse().$each_with_index(),"map",[],(n=function(e,a){var i=n.$$s||this;return null==e&&(e=u),null==a&&(a=u),i.$layout_note(e,t,r+".n_"+a)},n.$$s=o,n.$$arity=2,n)).$reverse(),l=e.$get_proxy_object(c).$proxy(),f=h(h(c,"map",[],(a=function(e){a.$$s;return null==e&&(e=u),e.$proxy()},a.$$s=o,a.$$arity=1,a)),"sort_by",[],(i=function(e){i.$$s;return null==e&&(e=u),e.$center().$first()},i.$$s=o,i.$$arity=1,i)),c=h(c,"map",[],(s=function(e){s.$$s;return null==e&&(e=u),e.$shapes()},s.$$s=o,s.$$arity=1,s)),c.$unshift($(ie,"FlowLine").$new(f.$first(),f.$last(),"dashed")),$(ie,"CompoundDrawable").$new(c,l)},X.$$arity=3),e.def(ae,"$layout_pause",W=function(a,s,o){var c,l,p=this,d=u,m=u,g=u,v=u,b=u,x=u,w=u,A=u,k=u,E=u,S=u,N=u,C=u;return null==y.conf&&(y.conf=u),d=p.$convert_pitch_to_xpos(a),m=s.$call(a.$beat()),l=y.conf.$get("layout.REST_TO_GLYPH")["$[]"](p.$check_duration(a)),c=e.to_ary(l),g=null==c[0]?u:c[0],v=null==c[1]?u:c[1],b=null==c[2]?u:c[2],x=y.conf.$get("layout.REST_SIZE"),w=[i(x.$first(),g.$first()),i(x.$last(),g.$last())],A=p.$layout_note_shift(a,w,d,b,o),k=p.$compute_color_by_variant_no(a.$variant()),E=u,E=f(f($(ie,"Harpnotes"),"Drawing"),"Glyph").$new([t(d,A),m],w,v,b,a),S=[t(o,".***")],h(E,"conf_key=",e.to_a(S)),S[r(S.length,1)],S=[E],h(a,"sheet_drawable=",e.to_a(S)),S[r(S.length,1)],S=[k],h(E,"color=",e.to_a(S)),S[r(S.length,1)],S=[y.conf.$get("layout.LINE_THICK")],h(E,"line_width=",e.to_a(S)),S[r(S.length,1)],_(a["$visible?"]())||(S=[!1],h(E,"visible=",e.to_a(S)),S[r(S.length,1)]),N=$(ie,"CompoundDrawable").$new([E],E),_(a.$measure_start())&&(C=t(w.$last(),y.conf.$get("layout.LINE_THICK")),_(y.conf.$get("layout.bottomup"))&&(C=C["$-@"]()),E=$(ie,"Ellipse").$new([t(d,A),r(m,C)],[w.$first(),n(y.conf.$get("layout.LINE_THICK"),2)],"filled",!1,u,!0),S=[k],h(E,"color=",e.to_a(S)),S[r(S.length,1)],S=[y.conf.$get("layout.LINE_THIN")],h(E,"line_width=",e.to_a(S)),S[r(S.length,1)],_(a["$visible?"]())||(S=[!1],h(E,"visible=",e.to_a(S)),S[r(S.length,1)]),N.$push(E)),N},W.$$arity=3),e.defs(ae,"$make_path_from_jumpline",J=function(n){var s,o,c=this,l=u,f=u,$=u,p=u,d=u,h=u,m=u,y=u,g=u,v=u,b=u,x=u,w=u,A=u,k=u,E=u,S=u,N=u,C=u,I=u,O=u,L=u,P=u,M=u,T=u,B=u,j=u,F=u,R=u,D=u,z=u,q=u,U=u;return o=n["$[]"]("jumpline_anchor"),s=e.to_ary(o),l=null==s[0]?u:s[0],f=null==s[1]?u:s[1],$=c.$Vector2d(n["$[]"]("from")["$[]"]("center")),p=t(c.$Vector2d(n["$[]"]("from")["$[]"]("size")),[l,f]),d=function(){return n["$[]"]("from")["$[]"]("anchor")["$=="]("before")?-1:1}(),h=c.$Vector2d(n["$[]"]("to")["$[]"]("center")),m=t(c.$Vector2d(n["$[]"]("to")["$[]"]("size")),[l,f]),y=function(){return n["$[]"]("to")["$[]"]("anchor")["$=="]("before")?-1:1}(),g=n["$[]"]("vertical"),v=n["$[]"]("verticalcut"),b=$,n["$[]"]("vertical_anchor")["$=="]("to")&&(b=h),x=c.$Vector2d(t(b.$x(),g),$.$y()),w=c.$Vector2d(t(b.$x(),g),h.$y()),A=c.$Vector2d(i(r(x,$),[1,0]).$normalize().$x(),0),k=c.$Vector2d(i(r(w,h),[1,0]).$normalize().$x(),0),E=c.$Vector2d(0,i(r(x,w),[0,1]).$normalize().$y()),S=i(p,[A.$x(),d]),N=i(m,[k.$x(),y]),x=t(x,i(S,[0,1])),w=t(w,i(N,[0,1])),C=t($,S),I=x,O=w,L=t(h,N),P=t(t(h,N),i(k,[2,0])),M=t(t(L,i(k,2.5)),[0,1]),T=r(t(L,i(k,2.5)),[0,1]),B=r(O.$y(),I.$y()),j=function(){return _(a(B,0))?v:v["$-@"]()}(),v["$=="](0)&&(j=B),F=t(I,[0,j]),R=t(F,E),D=r(O,[0,j]),z=t(t(F,i(E,1.5)),[.5,0]),q=r(t(F,i(E,1.5)),[.5,0]),U=v["$=="](0)?[]:[["M"].concat(e.to_a(F)),["l"].concat(e.to_a(r(z,F))),["l"].concat(e.to_a(r(q,z))),["l"].concat(e.to_a(r(F,q))),["z"]],[[["M"].concat(e.to_a(C)),["l"].concat(e.to_a(r(I,C))),["l"].concat(e.to_a(r(R,I))),["M"].concat(e.to_a(D)),["L"].concat(e.to_a(O)),["L"].concat(e.to_a(P))],[["M"].concat(e.to_a(L)),["l"].concat(e.to_a(r(M,L))),["l"].concat(e.to_a(r(T,M))),["l"].concat(e.to_a(r(L,T))),["z"]],U]},J.$$arity=1),e.def(ae,"$duration_to_id",K=function(e){var t=u;return null==y.conf&&(y.conf=u),t=("d"+e).$to_sym(),_(y.conf.$get("layout.DURATION_TO_STYLE")["$[]"](t)["$nil?"]())&&(t="err"),t},K.$$arity=1),e.def(ae,"$check_duration",Z=function(e){var t=this,r=u;return null==y.log&&(y.log=u),r=t.$duration_to_id(e.$duration()),_(r["$==="]("err"))&&y.log.$error("unsupported duration at "+e.$start_pos_to_s(),e.$start_pos(),e.$end_pos()),r},Z.$$arity=1),e.def(ae,"$make_sheetmark_path",ee=function(e){var t,a=this,s=u,o=u,c=u,l=u,f=u;return s=.5,o=5,c=r(a.$Vector2d(e),[s,n(o,2)]),l=[a.$Vector2d(s,i(2,s)["$-@"]()),a.$Vector2d(s,i(2,s)),a.$Vector2d(0,o),a.$Vector2d(s["$-@"](),i(2,s)),a.$Vector2d(s["$-@"](),i(-2,s)),a.$Vector2d(0,o["$-@"]())],f=[["M",c.$x(),c.$y()]],h(l,"each",[],(t=function(e){t.$$s;return null==e&&(e=u),f["$<<"](["l",e.$x(),e.$y()])},t.$$s=a,t.$$arity=1,t)),f},ee.$$arity=1),e.def(ae,"$make_slur_path",te=function(e,n){var a=this,s=u,o=u,c=u,l=u;return s=r(n,e),o=a.$Vector2d(i(.3,s.$length()),0).$rotate(s.$angle()),c=o.$rotate(-.4),l=t(s,o.$reverse().$rotate(.4)),[["M",e.$x(),e.$y()],["c",c.$x(),c.$y(),l.$x(),l.$y(),s.$x(),s.$y()]]},te.$$arity=2),e.def(ae,"$make_annotated_bezier_path",re=function(e,a){var s,c=this,l=u,p=u,d=u,h=u,m=u,g=u,v=u,b=u,x=u,w=u,A=u,k=u,E=u,S=u,N=u,C=u,I=u,O=u,L=u,P=u,M=u;return null==y.log&&(y.log=u),l=e.$first(),p=e.$last(),d=r(p,l),h=c.$Vector2d(a["$[]"]("cp1")),m=c.$Vector2d(a["$[]"]("cp2")),g=i(f($(ie,"Math"),"PI"),-.5),v=h.$rotate(d.$angle()).$rotate(g),b=m.$rotate(d.$angle()).$rotate(g),b=t(d,b),y.log.$debug(v.$to_s()+" - "+b.$to_s()),x=t(l,v),w=t(l,b),A=n(t(l,x),2),k=n(t(p,w),2),E=n(t(x,w),2),S=n(t(A,E),2),N=n(t(k,E),2),C=S["$=="](N)?c.$Vector2d([0,0]):r(S,N).$perpendicular().$normalize(),I=_(_(s=o(x.$x(),l.$x()))?o(l.$x(),p.$x()):s)?r(t(n(t(S,N),2),i(C,-2)),[2,0]):t(n(t(S,N),2),i(C,2)),I=t(I,[0,-2]),O=[["M",l.$x(),l.$y()]],L=[["c",v.$x(),v.$y(),b.$x(),b.$y(),d.$x(),d.$y()]],P=[["l",v.$x(),v.$y()],["L",w.$x(),w.$y()],["L",p.$x(),p.$y()]],M=[],_(a["$[]"]("shape")["$include?"]("c"))&&(M=t(M,t(O,L))),_(a["$[]"]("shape")["$include?"]("l"))&&(M=t(M,t(O,P))),[M,I,x,w]},re.$$arity=2),e.def(ae,"$resolve_placeholder",ne=function(e,t){var r,n=this,a=u,i=u;return a=e,i=a.$scan(/\{\{([^\}]+)\}\}/),h(i,"each",[],(r=function(n){var i=r.$$s||this,s=u;return null==i.placeholders&&(i.placeholders=u),null==y.log&&(y.log=u),null==n&&(n=u),s=i.placeholders["$[]"](n.$first()),_(s)?(e=s.$call(),_(e)||(y.log.$error($(ie,"I18n").$t("no placeholder value found in ")+" in '"+t+"': '"+n.$first()+"'"),e=""),a=a.$gsub("{{"+n+"}}",e)):y.log.$error($(ie,"I18n").$t("wrong placeholder: ")+" in '"+t+"': '"+n.$first()+"'")},r.$$s=n,r.$$arity=1,r)),a},ne.$$arity=2)}(w[0],0,w)}(w[0],w)}(l[0],l)},Opal.modules.abc_to_harpnotes_factory=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}var n=(e.top,[]),a=e.nil,i=e.const_get_qualified,s=e.const_get_relative,o=(e.breaker,e.slice,e.module),c=e.klass,l=e.gvars,u=e.truthy,f=e.hash2,$=e.send;return e.add_stubs(["$===","$new","$error","$split","$[]","$count","$length","$last","$each","$match","$parse","$[]=","$-","$first","$<<","$message","$+","$inject","$each_with_index","$include?","$t","$strip","$==","$get_metadata","$map","$select","$nil?","$join","$compact","$flatten"]),function(n,p){var d=o(n,"Harpnotes"),h=[d].concat(p);!function(n,p){var d=o(n,"Input"),h=[d].concat(p);!function(t,r,n){var o,u=c(t,null,"ABCToHarpnotesFactory"),f=[u].concat(n);e.defs(u,"$create_engine",o=function(e){var t=a,r=a;return null==l.log&&(l.log=a),t=e,"ABC2SVG"["$==="](t)?r=i(i(s(f,"Harpnotes"),"Input"),"Abc2svgToHarpnotes").$new():(l.log.$error("Undefined abc parser: "+e),r=i(i(s(f,"Harpnotes"),"Input"),"Abc2svgToHarpnotes").$new()),r},o.$$arity=1)}(h[0],0,h),function(n,i,o){var p,d,h,_,m,y=c(n,null,"AbstractAbcToHarpnotes"),g=[y].concat(o);y.$$prototype.abc_code=a,e.def(y,"$initialize",p=function(){var e=this;return e.abc_code=a,e.previous_new_part=[]},p.$$arity=0),e.def(y,"$charpos_to_line_column",d=function(e){var t,r=this,n=a,i=a,s=a,o=a;return n=u(t=e)?t:1,i=r.abc_code["$[]"](1,n).$split("\n"),s=i.$count(),o=i.$last().$length(),[s,o]},d.$$arity=1),e.def(y,"$parse_harpnote_config",h=function(n){var i,o=this,c=a,p=a,d=a;return c=f([],{}),p=1,$(n.$split("\n"),"each",[],(i=function(n){var o,f=i.$$s||this,d=a,h=a,_=a,m=a,y=a;if(null==l.log&&(l.log=a),null==n&&(n=a),d=$(n,"match",[/^%%%%hn\.(print|legend|note|annotation|lyrics) (.*)/],(o=function(e){o.$$s;return null==e&&(e=a),[e["$[]"](1),e["$[]"](2)]},o.$$s=f,o.$$arity=1,o)),u(d))try{h=s(g,"JSON").$parse(d.$last()),_=["line_no",p],$(h,"[]=",e.to_a(_)),_[t(_.length,1)],u(c["$[]"](d.$first()))||(_=[d.$first(),[]],$(c,"[]=",e.to_a(_)),_[t(_.length,1)]),c["$[]"](d.$first())["$<<"](h)}catch(t){if(!e.rescue(t,[s(g,"Exception")]))throw t;m=t;try{y="error in harpnote commands: "+m.$message()+" ["+p+":"+d+"]",l.log.$error(y,[p,1],[p,2])}finally{e.pop_exception()}}return p=r(p,1)},i.$$s=o,i.$$arity=1,i)),u(c["$[]"]("legend"))&&(d=["legend",c["$[]"]("legend").$first()],$(c,"[]=",e.to_a(d)),d[t(d.length,1)]),u(c["$[]"]("lyrics"))&&(d=["lyrics",c["$[]"]("lyrics").$first()],$(c,"[]=",e.to_a(d)),d[t(d.length,1)]),c},h.$$arity=1),e.def(y,"$get_metadata",_=function(n){var i,o=this;return $(n.$split("\n").$each_with_index(),"inject",[f([],{})],(i=function(n,o){var c,f,p,d=i.$$s||this,h=a,_=a,m=a,y=a,v=a,b=a;return null==l.log&&(l.log=a),null==n&&(n=a),null==o&&(o=a),f=o,c=e.to_ary(f),h=null==c[0]?a:c[0],_=null==c[1]?a:c[1],m=$(h,"match",[/^([A-Z]):\s*(.*)/],(p=function(e){p.$$s;return null==e&&(e=a),[e["$[]"](1),e["$[]"](2)]},p.$$s=d,p.$$arity=1,p)),u(m)&&(y=m.$first(),u(n["$[]"](y))?(u(["F","X"]["$include?"](y))&&l.log.$error(s(g,"I18n").$t("more than one line found for ")+" ':"+y+"'",[r(_,1),1]),n["$[]"](y)["$<<"](m.$last().$strip())):(y["$=="]("F")&&(v=m.$last().$strip(),u(v["$include?"]("{{"))||u(v.$match(/^[a-zA-z0-9_\-\.]+$/))||l.log.$error('"'+v+'": '+s(g,"I18n").$t("bad characters in filename"),[r(_,1),1])),b=[y,[m.$last().$strip()]],$(n,"[]=",e.to_a(b)),b[t(b.length,1)])),n},i.$$s=o,i.$$arity=2,i.$$has_top_level_mlhs_arg=!0,i))},_.$$arity=1),e.def(y,"$add_metadata",m=function(e,t){var r,n,i=this,s=a,o=a;return s=i.$get_metadata(e),o=$($(t,"select",[],(r=function(e,t){r.$$s;return null==e&&(e=a),null==t&&(t=a),s["$[]"](e)["$nil?"]()},r.$$s=i,r.$$arity=2,r)),"map",[],(n=function(e,t){n.$$s;return null==e&&(e=a),null==t&&(t=a),e+":"+t},n.$$s=i,n.$$arity=2,n)),[o,e].$flatten().$compact().$join("\n")},m.$$arity=2)}(h[0],0,h)}(h[0],h)}(n[0],n)},Opal.modules.native=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e>=t:e["$>="](t)}var n=e.top,a=[],i=e.nil,s=e.const_get_qualified,o=e.const_get_relative,c=(e.breaker,e.slice,e.module),l=e.truthy,u=e.send,f=e.hash2,$=e.range,p=e.klass,d=e.gvars;return e.add_stubs(["$try_convert","$native?","$respond_to?","$to_n","$raise","$inspect","$Native","$proc","$map!","$end_with?","$define_method","$[]","$convert","$call","$to_proc","$new","$each","$native_reader","$native_writer","$extend","$warn","$include","$is_a?","$map","$to_a","$_Array","$method_missing","$bind","$instance_method","$slice","$-","$length","$[]=","$enum_for","$===","$>=","$<<","$each_pair","$_initialize","$name","$native_module"]),function(t,r){var n,a,p,d,h,_,m=c(t,"Native"),y=[m].concat(r);e.defs(m,"$is_a?",n=function(e,t){var r=this;try{return e instanceof r.$try_convert(t)}catch(e){return!1}},n.$$arity=2),e.defs(m,"$try_convert",a=function(e,t){var r=this;return null==t&&(t=i),r["$native?"](e)?e:e["$respond_to?"]("to_n")?e.$to_n():t},a.$$arity=-2),e.defs(m,"$convert",p=function(e){var t=this;return t["$native?"](e)?e:e["$respond_to?"]("to_n")?e.$to_n():void t.$raise(o(y,"ArgumentError"),e.$inspect()+" isn't native")},p.$$arity=1),e.defs(m,"$call",d=function(t,r,n){var a,s,o=d.$$p,c=o||i,l=this;o&&(d.$$p=null),o&&(d.$$p=null),a=e.slice.call(arguments,2,arguments.length),s=a;var u=t[r];if(u instanceof Function){for(var f=new Array(s.length),$=0,p=s.length;$<p;$++){var h=s[$],_=l.$try_convert(h);f[$]=_===i?h:_}return c!==i&&f.push(c),l.$Native(u.apply(t,f))}return l.$Native(u)},d.$$arity=-3),e.defs(m,"$proc",h=function(){var t,r=h.$$p,n=r||i,a=this;return r&&(h.$$p=null),r&&(h.$$p=null),l(n)||a.$raise(o(y,"LocalJumpError"),"no block given"),u(s("::","Kernel"),"proc",[],(t=function(r){var a,s,o,c=t.$$s||this,l=i;if(a=e.slice.call(arguments,0,arguments.length),s=a,u(s,"map!",[],(o=function(e){var t=o.$$s||this;return null==e&&(e=i),t.$Native(e)},o.$$s=c,o.$$arity=1,o)),l=c.$Native(this),this===e.global)return n.apply(c,s);var f=n.$$s;n.$$s=null;try{return n.apply(l,s)}finally{n.$$s=f}},t.$$s=a,t.$$arity=-1,t))},h.$$arity=0),function(t,r){var n,a,s,p,d=c(t,"Helpers"),h=[d].concat(r);e.def(d,"$alias_native",n=function(t,r,a){var s,c,p,d,_,m,y,g=n.$$p,v=this;if(g&&(n.$$p=null),s=e.slice.call(arguments,1,arguments.length),null==(c=e.extract_kwargs(s)))c=f([],{});else if(!c.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return s.length>0&&(p=s[0],s.splice(0,1)),null==p&&(p=t),d=c.$$smap.as,null==d&&(d=i),l(p["$end_with?"]("="))?u(v,"define_method",[t],(_=function(e){var t=_.$$s||this;return null==t.native&&(t.native=i),null==e&&(e=i),t.native[p["$[]"]($(0,-2,!1))]=o(h,"Native").$convert(e),e},_.$$s=v,_.$$arity=1,_)):l(d)?u(v,"define_method",[t],(m=function(t){var r,n,a=m.$$s||this,s=m.$$p,c=s||i,f=i;return null==a.native&&(a.native=i),s&&(m.$$p=null),r=e.slice.call(arguments,0,arguments.length),n=r,f=u(o(h,"Native"),"call",[a.native,p].concat(e.to_a(n)),c.$to_proc()),l(f)?d.$new(f.$to_n()):i},m.$$s=v,m.$$arity=-1,m)):u(v,"define_method",[t],(y=function(t){var r,n,a=y.$$s||this,s=y.$$p,c=s||i;return null==a.native&&(a.native=i),s&&(y.$$p=null),r=e.slice.call(arguments,0,arguments.length),n=r,u(o(h,"Native"),"call",[a.native,p].concat(e.to_a(n)),c.$to_proc())},y.$$s=v,y.$$arity=-1,y))},n.$$arity=-2),e.def(d,"$native_reader",a=function(t){var r,n,a,s=this;return r=e.slice.call(arguments,0,arguments.length),n=r,u(n,"each",[],(a=function(e){var t,r=a.$$s||this;return null==e&&(e=i),u(r,"define_method",[e],(t=function(){var r=t.$$s||this;return null==r.native&&(r.native=i),r.$Native(r.native[e])},t.$$s=r,t.$$arity=0,t))},a.$$s=s,a.$$arity=1,a))},a.$$arity=-1),e.def(d,"$native_writer",s=function(t){var r,n,a,s=this;return r=e.slice.call(arguments,0,arguments.length),n=r,u(n,"each",[],(a=function(e){var t,r=a.$$s||this;return null==e&&(e=i),u(r,"define_method",[e+"="],(t=function(r){var n=t.$$s||this;return null==n.native&&(n.native=i),null==r&&(r=i),n.$Native(n.native[e]=r)},t.$$s=r,t.$$arity=1,t))},a.$$s=s,a.$$arity=1,a))},s.$$arity=-1),e.def(d,"$native_accessor",p=function(t){var r,n,a=this;return r=e.slice.call(arguments,0,arguments.length),n=r,u(a,"native_reader",e.to_a(n)),u(a,"native_writer",e.to_a(n))},p.$$arity=-1)}(y[0],y),function(t,r){var n,a,u,f=c(t,"Wrapper"),$=[f].concat(r);e.def(f,"$initialize",n=function(e){var t=this;return l(s("::","Kernel")["$native?"](e))||s("::","Kernel").$raise(o($,"ArgumentError"),e.$inspect()+" isn't native"),t.native=e},n.$$arity=1),e.def(f,"$to_n",a=function(){var e=this;return null==e.native&&(e.native=i),e.native},a.$$arity=0),e.defs(f,"$included",u=function(e){return e.$extend(o($,"Helpers"))},u.$$arity=1)}(y[0],y),e.defs(m,"$included",_=function(e){return this.$warn("Including ::Native is deprecated. Please include Native::Wrapper instead."),e.$include(o(y,"Wrapper"))},_.$$arity=1)}(a[0],a),function(t,r){var n,a,f,$=c(t,"Kernel"),p=[$].concat(r);e.def($,"$native?",n=function(e){return null==e||!e.$$class},n.$$arity=1),e.def($,"$Native",a=function(t){var r,n,c=a.$$p,f=this;return c&&(a.$$p=null),l(null==t)?i:l(f["$native?"](t))?s(o(p,"Native"),"Object").$new(t):l(t["$is_a?"](o(p,"Array")))?u(t,"map",[],(r=function(e){var t=r.$$s||this;return null==e&&(e=i),t.$Native(e)},r.$$s=f,r.$$arity=1,r)):l(t["$is_a?"](o(p,"Proc")))?u(f,"proc",[],(n=function(r){var a,s,o=n.$$s||this,c=n.$$p,l=c||i;return c&&(n.$$p=null),a=e.slice.call(arguments,0,arguments.length),s=a,o.$Native(u(t,"call",e.to_a(s),l.$to_proc()))},n.$$s=f,n.$$arity=-1,n)):t},a.$$arity=1),e.alias($,"_Array","Array"),e.def($,"$Array",f=function(t,r){var n,a,c=f.$$p,$=c||i,d=this;return c&&(f.$$p=null),c&&(f.$$p=null),n=e.slice.call(arguments,1,arguments.length),a=n,l(d["$native?"](t))?u(s(o(p,"Native"),"Array"),"new",[t].concat(e.to_a(a)),$.$to_proc()).$to_a():d.$_Array(t)},f.$$arity=-2)}(a[0],a),function(r,n,a){var o,c,$,d,h,_,m,y,g,v,b,x,w,A,k,E=p(r,n,"Object");[E].concat(a);E.$$prototype.native=i,E.$include(s(s("::","Native"),"Wrapper")),e.def(E,"$==",o=function(e){return this.native===s("::","Native").$try_convert(e)},o.$$arity=1),e.def(E,"$has_key?",c=function(t){var r=this;return e.hasOwnProperty.call(r.native,t)},c.$$arity=1),e.alias(E,"key?","has_key?"),e.alias(E,"include?","has_key?"),e.alias(E,"member?","has_key?"),e.def(E,"$each",$=function(t){var r,n,a=$.$$p,s=a||i,o=this;if(a&&($.$$p=null),r=e.slice.call(arguments,0,arguments.length),n=r,s!==i){for(var c in o.native)e.yieldX(s,[c,o.native[c]]);return o}return u(o,"method_missing",["each"].concat(e.to_a(n)))},$.$$arity=-1),e.def(E,"$[]",d=function(e){var t=this,r=t.native[e];return r instanceof Function?r:s("::","Native").$call(t.native,e)},d.$$arity=1),e.def(E,"$[]=",h=function(e,t){var r=this,n=i;return n=s("::","Native").$try_convert(t),l(n===i)?r.native[e]=t:r.native[e]=n},h.$$arity=2),e.def(E,"$merge!",_=function(e){var t=this;e=s("::","Native").$convert(e);for(var r in e)t.native[r]=e[r];return t},_.$$arity=1),e.def(E,"$respond_to?",m=function(e,t){var r=this;return null==t&&(t=!1),s("::","Kernel").$instance_method("respond_to?").$bind(r).$call(e,t)},m.$$arity=-2),e.def(E,"$respond_to_missing?",y=function(t,r){var n=this;return null==r&&(r=!1),e.hasOwnProperty.call(n.native,t)},y.$$arity=-2),e.def(E,"$method_missing",g=function(r,n){var a,o,c=g.$$p,l=c||i,f=this,$=i;return c&&(g.$$p=null),c&&(g.$$p=null),a=e.slice.call(arguments,1,arguments.length),o=a,"="===r.charAt(r.length-1)?($=[r.$slice(0,t(r.$length(),1)),o["$[]"](0)],u(f,"[]=",e.to_a($)),$[t($.length,1)]):u(s("::","Native"),"call",[f.native,r].concat(e.to_a(o)),l.$to_proc())},g.$$arity=-2),e.def(E,"$nil?",v=function(){return!1},v.$$arity=0),e.def(E,"$is_a?",b=function(t){var r=this;return e.is_a(r,t)},b.$$arity=1),e.alias(E,"kind_of?","is_a?"),e.def(E,"$instance_of?",x=function(e){return this.$$class===e},x.$$arity=1),e.def(E,"$class",w=function(){return this.$$class},w.$$arity=0),e.def(E,"$to_a",A=function(e){var t=A.$$p,r=t||i,n=this;return t&&(A.$$p=null),t&&(A.$$p=null),null==e&&(e=f([],{})),u(s(s("::","Native"),"Array"),"new",[n.native,e],r.$to_proc()).$to_a()},A.$$arity=-1),e.def(E,"$inspect",k=function(){var e=this;return"#<Native:"+String(e.native)+">"},k.$$arity=0)}(o(a,"Native"),o(a,"BasicObject"),a),function(n,a,c){var $,d,h,_,m,y,g,v=p(n,null,"Array"),b=[v].concat(c);v.$$prototype.named=v.$$prototype.native=v.$$prototype.get=v.$$prototype.block=v.$$prototype.set=v.$$prototype.length=i,v.$include(s(o(b,"Native"),"Wrapper")),v.$include(o(b,"Enumerable")),e.def(v,"$initialize",$=function(t,r){var n,a=$.$$p,s=a||i,c=this;return a&&($.$$p=null),a&&($.$$p=null),null==r&&(r=f([],{})),u(c,e.find_super_dispatcher(c,"initialize",$,!1),[t],null),c.get=l(n=r["$[]"]("get"))?n:r["$[]"]("access"),c.named=r["$[]"]("named"),c.set=l(n=r["$[]"]("set"))?n:r["$[]"]("access"),c.length=l(n=r["$[]"]("length"))?n:"length",c.block=s,l(null==c.$length())?c.$raise(o(b,"ArgumentError"),"no length found on the array-like object"):i},$.$$arity=-2),e.def(v,"$each",d=function(){var t=d.$$p,r=t||i,n=this;if(t&&(d.$$p=null),t&&(d.$$p=null),!l(r))return n.$enum_for("each");for(var a=0,s=n.$length();a<s;a++)e.yield1(r,n["$[]"](a));return n},d.$$arity=0),e.def(v,"$[]",h=function(e){var t=this,r=i,n=i;return r=function(){return n=e,o(b,"String")["$==="](n)||o(b,"Symbol")["$==="](n)?l(t.named)?t.native[t.named](e):t.native[e]:o(b,"Integer")["$==="](n)?l(t.get)?t.native[t.get](e):t.native[e]:i}(),l(r)?l(t.block)?t.block.$call(r):t.$Native(r):i},h.$$arity=1),e.def(v,"$[]=",_=function(e,t){var r=this;return l(r.set)?r.native[r.set](e,o(b,"Native").$convert(t)):r.native[e]=o(b,"Native").$convert(t)},_.$$arity=2),e.def(v,"$last",m=function(e){var n=this,a=i,s=i;if(null==e&&(e=i),l(e)){for(a=t(n.$length(),1),s=[];l(r(a,0));)s["$<<"](n["$[]"](a)),a=t(a,1);return s}return n["$[]"](t(n.$length(),1))},m.$$arity=-1),e.def(v,"$length",y=function(){var e=this;return e.native[e.length]},y.$$arity=0),e.alias(v,"to_ary","to_a"),e.def(v,"$inspect",g=function(){return this.$to_a().$inspect()},g.$$arity=0)}(o(a,"Native"),0,a),function(t,r,n){var a,i=p(t,null,"Numeric");[i].concat(n);e.def(i,"$to_n",a=function(){return this.valueOf()},a.$$arity=0)}(a[0],0,a),function(t,r,n){var a,i=p(t,null,"Proc");[i].concat(n);e.def(i,"$to_n",a=function(){return this},a.$$arity=0)}(a[0],0,a),function(t,r,n){var a,i=p(t,null,"String");[i].concat(n);e.def(i,"$to_n",a=function(){return this.valueOf()},a.$$arity=0)}(a[0],0,a),function(t,r,n){var a,i=p(t,null,"Regexp");[i].concat(n);e.def(i,"$to_n",a=function(){return this.valueOf()},a.$$arity=0)}(a[0],0,a),function(t,r,n){var a,s=p(t,null,"MatchData");[s].concat(n);s.$$prototype.matches=i,e.def(s,"$to_n",a=function(){return this.matches},a.$$arity=0)}(a[0],0,a),function(t,r,n){var a,s=p(t,null,"Struct"),c=[s].concat(n);e.def(s,"$to_n",a=function(){var e,t=this,r=i;return r={},u(t,"each_pair",[],(e=function(t,n){e.$$s;return null==t&&(t=i),null==n&&(n=i),r[t]=o(c,"Native").$try_convert(n,n)},e.$$s=t,e.$$arity=2,e)),r},a.$$arity=0)}(a[0],0,a),function(t,r,n){var a,i=p(t,null,"Array"),s=[i].concat(n);e.def(i,"$to_n",a=function(){for(var e=this,t=[],r=0,n=e.length;r<n;r++){var a=e[r];t.push(o(s,"Native").$try_convert(a,a))}return t},a.$$arity=0)}(a[0],0,a),function(t,r,n){var a,i=p(t,null,"Boolean");[i].concat(n);e.def(i,"$to_n",a=function(){return this.valueOf()},a.$$arity=0)}(a[0],0,a),function(t,r,n){var a,i=p(t,null,"Time");[i].concat(n);e.def(i,"$to_n",a=function(){return this},a.$$arity=0)}(a[0],0,a),function(t,r,n){var a,i=p(t,null,"NilClass");[i].concat(n);e.def(i,"$to_n",a=function(){return null},a.$$arity=0)}(a[0],0,a),function(t,r,n){var a,s,c=p(t,null,"Hash"),l=[c].concat(n);e.alias(c,"_initialize","initialize"),e.def(c,"$initialize",a=function(e){var t=a.$$p,r=t||i,n=this;if(t&&(a.$$p=null),t&&(a.$$p=null),null!=e&&(void 0===e.constructor||e.constructor===Object)){var s,c,f=n.$$smap,$=n.$$keys;for(s in e)c=e[s],!c||void 0!==c.constructor&&c.constructor!==Object?c&&c.$$is_array?(c=c.map(function(e){return!e||void 0!==e.constructor&&e.constructor!==Object?n.$Native(e):o(l,"Hash").$new(e)}),f[s]=c):f[s]=n.$Native(c):f[s]=o(l,"Hash").$new(c),$.push(s);return n}return u(n,"_initialize",[e],r.$to_proc())},a.$$arity=-1),e.def(c,"$to_n",s=function(){for(var e,t,r=this,n={},a=r.$$keys,i=r.$$smap,s=0,c=a.length;s<c;s++)e=a[s],e.$$is_string?t=i[e]:(e=e.key,t=e.value),n[e]=o(l,"Native").$try_convert(t,t);return n},s.$$arity=0)}(a[0],0,a),function(t,r,n){var a,i=p(t,null,"Module");[i].concat(n);e.def(i,"$native_module",a=function(){var t=this;return e.global[t.$name()]=t},a.$$arity=0)}(a[0],0,a),function(t,r,n){var a,i,s=p(t,null,"Class"),c=[s].concat(n);e.def(s,"$native_alias",a=function(e,t){var r=this,n=r.prototype["$"+t];n||r.$raise(o(c,"NameError").$new("undefined method `"+t+"' for class `"+r.$inspect()+"'",t)),r.prototype[e]=n},a.$$arity=2),e.def(s,"$native_class",i=function(){var e=this;return e.$native_module(),e.new=e.$new},i.$$arity=0)}(a[0],0,a),d.$=d.global=n.$Native(e.global)},Opal.modules.abc2svg_to_harpnotes=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e/t:e["$/"](t)}function a(e,t){return"number"==typeof e&&"number"==typeof t?e>=t:e["$>="](t)}function i(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}function s(e,t){return"number"==typeof e&&"number"==typeof t?e*t:e["$*"](t)}function o(e,t){return"number"==typeof e&&"number"==typeof t?e<t:e["$<"](t)}var c=e.top,l=[],u=e.nil,f=e.const_get_qualified,$=e.const_get_relative,p=(e.breaker,e.slice,e.module),d=e.klass,h=e.send,_=e.hash2,m=e.gvars,y=e.truthy,g=e.hash,v=e.range;return e.add_stubs(["$require","$attr_reader","$get","$_reset_state","$get_metadata","$new","$abcplay=","$-","$get_abcmodel","$nil?","$raise","$t","$_make_metadata","$_transform_voices","$meta_data=","$_make_harpnote_options","$harpnote_options=","$[]","$meta_data","$empty?","$error","$[]=","$compact","$map","$gsub","$strip","$+","$_get_key_by_accidentals","$first","$==","$/","$to_i","$join","$>=","$private","$match","$charpos_to_line_column","$flatten","$to_a","$each_with_index","$_transform_voice","$_make_variant_ending_jumps","$unshift","$to_s","$_investigate_first_bar","$each","$send","$inject","$<<","$_make_jumplines","$_make_notebound_annotations","$count","$last","$select","$!","$=~","$_extract_goto_info_from_bar","$!=","$length","$push","$_bar_is_repetition_end?","$>","$pop","$_transform_bar_repeat_end","$include?","$_parse_origin","$_parse_tuplet_info","$_parse_decorations","$_transform_measure_start","$_convert_duration","$decorations=","$measure_count=","$_transform_count_note","$count_note=","$time=","$_mkznid","$znid=","$origin=","$start_pos=","$end_pos=","$tuplet=","$tuplet_start=","$tuplet_end=","$variant=","$time","$duration","$duration=","$origin","$start_pos","$end_pos","$tuplet","$tuplet_start","$tuplet_end","$tie_end=","$tie_start=","$_parse_slur","$_push_slur","$slur_starts=","$_pop_slur","$slur_ends=","$measure_start=","$_make_repeats_jumps_annotations","$*","$%","$ceil","$split","$zip","$min","$round","$floor","$visible=","$invisible=","$is_a?","$prev_pitch","$pitch=","$znid","$warning","$start_pos_to_s","$_extract_chord_lines","$===","$shift=","$notes","$to_f","$pitch","$next_pitch=","$next_playable=","$next_first_in_part=","$prev_pitch=","$prev_playable=","$first_in_part=","$<","$start_with?","$to_sym","$&","$>>"]),c.$require("native"),function(c,l){var b=p(c,"Harpnotes"),x=[b].concat(l);!function(c,l){var b=p(c,"Input"),x=[b].concat(l);!function(c,l,p){var b,x,w,A,k,E,S,N,C,I,O,L,P,M,T,B,j,F,R,D,z,q,U,H,G,Y,V,Q,X,W,J,K,Z,ee,te,re,ne,ae,ie,se,oe,ce,le=d(c,l,"Abc2svgToHarpnotes"),ue=[le].concat(p);le.$$prototype.abc_code=le.$$prototype.abcplay=le.$$prototype.abc_model=le.$$prototype.meta_data=le.$$prototype.info_fields=le.$$prototype.remark_table=le.$$prototype.score_statements=le.$$prototype.wmeasure=le.$$prototype.measure_start_time=le.$$prototype.next_note_marks=le.$$prototype.variant_no=le.$$prototype.variant_endings=le.$$prototype.previous_note=le.$$prototype.repetition_stack=le.$$prototype.pushed_variant_ending_repeat=le.$$prototype.part_table=le.$$prototype.measure_count=le.$$prototype.tie_started=le.$$prototype.countby=le.$$prototype._shortest_note=le.$$prototype.pitch_providers=le.$$prototype.slurstack=le.$$prototype.tuplet_p=u,e.const_set(ue[0],"ABC2SVG_DURATION_FACTOR",1536),le.$attr_reader("abc_model"),e.def(le,"$initialize",b=function(){var t=b.$$p,r=this,n=u,a=u,i=u;for(null==m.conf&&(m.conf=u),t&&(b.$$p=null),a=0,i=arguments.length,n=new Array(i);a<i;a++)n[a]=arguments[a];return h(r,e.find_super_dispatcher(r,"initialize",b,!1),n,t),r.abcplay=u,r.abc_code=u,r.previous_new_part=[],r.score_statements=[],r.part_table=_([],{}),r.abc_model=_([],{}),r._shortest_note=m.conf.$get("layout.SHORTEST_NOTE"),r.$_reset_state()},b.$$arity=0),e.def(le,"$transform",x=function(r){var n,a,i=this,s=u,o=u,c=u,l=u,p=u;return null==m.conf&&(m.conf=u),null==m.log&&(m.log=u),i.abc_code=r,i.annotations=m.conf.$get("annotations"),i.info_fields=i.$get_metadata(i.abc_code),s=f($(ue,"ABC2SVG"),"Abc2Svg").$new(u,_(["mode"],{mode:"model"})),y(i.abcplay)&&(o=[i.abcplay],h(s,"abcplay=",e.to_a(o)),o[t(o.length,1)]),a=s.$get_abcmodel(r),n=e.to_ary(a),i.abc_model=null==n[0]?u:n[0],c=null==n[1]?u:n[1],y(i.abc_model["$nil?"]())&&i.$raise($(ue,"I18n").$t("no suitable ABC found")),i.$_make_metadata(),l=i.$_transform_voices(),o=[i.meta_data],h(l,"meta_data=",e.to_a(o)),o[t(o.length,1)],o=[i.$_make_harpnote_options()],h(l,"harpnote_options=",e.to_a(o)),o[t(o.length,1)],p=l.$meta_data()["$[]"]("filename"),y(p["$empty?"]())&&m.log.$error($(ue,"I18n").$t("Filename not specified in song add an F: instruction"),[1,1]),[l,c]},x.$$arity=1),e.def(le,"$_make_harpnote_options",w=function(){var n,a=this,i=u,s=u;return null==m.conf&&(m.conf=u),i=_(["lyrics"],{lyrics:_(["text"],{text:a.info_fields["$[]"]("W")})}),s=["template",m.conf.$get("template")],h(i,"[]=",e.to_a(s)),s[t(s.length,1)],s=["print",h(m.conf.$get("produce"),"map",[],(n=function(e){var t,a=(n.$$s,u),i=u;return null==m.conf&&(m.conf=u),null==m.log&&(m.log=u),null==e&&(e=u),a=m.conf.$get("extract."+e+".title"),y(a)?(i=(y(t=m.conf.$get("extract."+e+".filenamepart"))?t:a).$strip().$gsub(/[^a-zA-Z0-9\-\_]/,"_"),_(["title","view_id","filenamepart"],{title:a,view_id:e,filenamepart:i})):(m.log.$error(r($(ue,"I18n").$t("could not find extract with number")," "+e),[1,1],[1e3,1e3]),u)},n.$$s=a,n.$$arity=1,n)).$compact()],h(i,"[]=",e.to_a(s)),s[t(s.length,1)],i},w.$$arity=0),e.def(le,"$_get_key_by_accidentals",A=function(e){return g(7,["C#","D#Dor","E#Phr","F#Lyd","G#Mix","A#m","B#Loc"],6,["F#","G#Dor","A#Phr","BLyd","C#Mix","D#m","E#Loc"],5,["B","C#Dor","D#Phr","ELyd","F#Mix","G#m","A#Loc"],4,["E","F#Dor","G#Phr","ALyd","BMix","C#m","D#Loc"],3,["A","BDor","C#Phr","DLyd","EMix","F#m","G#Loc"],2,["D","EDor","F#Phr","GLyd","AMix","Bm","C#Loc"],1,["G","ADor","BPhr","CLyd","DMix","Em","F#Loc"],0,["C","DDor","EPhr","FLyd","GMix","Am","BLoc"],-1,["F","GDor","APhr","BbLyd","CMix","Dm","ELoc"],-2,["Bb","CDor","DPhr","EbLyd","FMix","Gm","ALoc"],-3,["Eb","FDor","GPhr","AbLyd","BbMix","Cm","DLoc"],-4,["Ab","BbDor","CPhr","DbLyd","EbMix","Fm","GLoc"],-5,["Db","EbDor","FPhr","GbLyd","AbMix","Bbm","CLoc"],-6,["Gb","AbDor","BbPhrCbLyd","DbMix","Ebm","FLoc"],-7,["CbDbDor","EbPhrFbLyd","GbMix","Abm","BbLoc"])["$[]"](e["$[]"]("k_sf"))["$[]"](e["$[]"]("k_mode"))},A.$$arity=1),e.def(le,"$_make_metadata",k=function(){var t,r,i=this,s=u,o=u,c=u,l=u,f=u,p=u,d=u;return s=i.$_get_key_by_accidentals(i.abc_model["$[]"]("voices").$first()["$[]"]("voice_properties")["$[]"]("key")),
o=i.$_get_key_by_accidentals(i.abc_model["$[]"]("voices").$first()["$[]"]("voice_properties")["$[]"]("okey")),c="",s["$=="](o)||(c="(Original in "+o+")"),l=function(){try{return i.abc_model["$[]"]("voices").$first()["$[]"]("voice_properties")["$[]"]("sym")}catch(t){if(!e.rescue(t,[$(ue,"StandardError")]))throw t;try{return u}finally{e.pop_exception()}}}(),y(y(t=l)?l["$[]"]("tempo_notes"):t)?(f=h(l["$[]"]("tempo_notes"),"map",[],(r=function(e){r.$$s;return null==e&&(e=u),n(e,$(ue,"ABC2SVG_DURATION_FACTOR"))},r.$$s=i,r.$$arity=1,r)),p=l["$[]"]("tempo").$to_i(),d=i.info_fields["$[]"]("Q").$join(" ")):(f=[.25],p=120,d="1/4=120"),y(a(p,1))||(p=120),i.meta_data=_(["number","composer","title","filename","tempo","tempo_display","meter","key","o_key"],{number:i.info_fields["$[]"]("X").$first(),composer:(y(t=i.info_fields["$[]"]("C"))?t:[]).$join("\n"),title:(y(t=i.info_fields["$[]"]("T"))?t:[]).$join("\n"),filename:(y(t=i.info_fields["$[]"]("F"))?t:[]).$join("\n"),tempo:_(["duration","bpm","sym"],{duration:f,bpm:p,sym:l}),tempo_display:d,meter:i.info_fields["$[]"]("M"),key:s,o_key:c})},k.$$arity=0),le.$private(),e.def(le,"$_mkznid",E=function(e){var t=this,r=u,n=u,a=u;return null==m.log&&(m.log=u),r=t.remark_table["$[]"](e["$[]"]("time")),y(r)?y(r.$match(/[a-z][a-zA-Z0-9_]*/))||(n=t.$charpos_to_line_column(e["$[]"]("istart")),a=t.$charpos_to_line_column(e["$[]"]("iend")),m.log.$error("illegal character in of [r:] (must be of [a-z][a-z0.9_])",n,a),r=u):y(r)||(r=""+e["$[]"]("time")),r},E.$$arity=1),e.def(le,"$_reset_state",S=function(){var e,t=this;return t.countnames=h(v(1,32,!1).$to_a(),"map",[],(e=function(t){e.$$s;return null==t&&(t=u),[t,"e","u","e"]},e.$$s=t,e.$$arity=1,e)).$flatten(),t.jumptargets=_([],{}),t.is_first_measure=!0,t.measure_start_time=0,t.measure_count=0,t.next_note_marks=_(["measure","repeat_start","variant_ending","variant_followup"],{measure:!1,repeat_start:!1,variant_ending:!1,variant_followup:!1}),t.previous_new_part=[],t.previous_note=u,t.remark_table=_([],{}),t.repetition_stack=[],t.variant_endings=[[]],t.tie_started=!1,t.variant_no=0,t.slurstack=0,t.tuplet_count=1,t.tuplet_down_count=1,t.countby=u,t.wmeasure=0},S.$$arity=0),e.def(le,"$_transform_voices",N=function(){var e,t=this,n=u;return n=h(t.abc_model["$[]"]("voices").$each_with_index(),"map",[],(e=function(t,n){var a=e.$$s||this,i=u,s=u;return null==t&&(t=u),null==n&&(n=u),i="v_"+r(n,1),s=a.$_transform_voice(t,i),y(s["$empty?"]())||(s=r(s,a.$_make_variant_ending_jumps(i))),s},e.$$s=t,e.$$arity=2,e)).$compact(),n.$unshift(n.$first()),f(f($(ue,"Harpnotes"),"Music"),"Song").$new(n)},N.$$arity=0),e.def(le,"$_transform_voice",C=function(n,a){var i,s,o,c,l,f,p=this,d=u,_=u,g=u,v=u,b=u;return null==m.log&&(m.log=u),d=p.abc_model["$[]"]("music_type_ids")["$[]"]("note").$to_s(),p.$_reset_state(),p.wmeasure=n["$[]"]("voice_properties")["$[]"]("meter")["$[]"]("wmeasure"),p.countby=function(){try{return n["$[]"]("voice_properties")["$[]"]("meter")["$[]"]("a_meter").$first()["$[]"]("bot").$to_i()}catch(t){if(!e.rescue(t,[$(ue,"StandardError")]))throw t;try{return u}finally{e.pop_exception()}}}(),p.$_investigate_first_bar(n),h(n["$[]"]("symbols"),"each",[],(i=function(r){var n=i.$$s||this,a=u;return null==r&&(r=u),a=["start_pos",n.$charpos_to_line_column(r["$[]"]("istart"))],h(r,"[]=",e.to_a(a)),a[t(a.length,1)],a=["end_pos",n.$charpos_to_line_column(r["$[]"]("iend"))],h(r,"[]=",e.to_a(a)),a[t(a.length,1)]},i.$$s=p,i.$$arity=1,i)),p.pitch_providers=h(n["$[]"]("symbols"),"map",[],(s=function(e){s.$$s;return null==e&&(e=u),e["$[]"]("type").$to_s()["$=="](d)?e:u},s.$$s=p,s.$$arity=1,s)),_=h(n["$[]"]("symbols").$each_with_index(),"map",[],(o=function(t,r){var n=o.$$s||this,i=u,s=u;null==n.abc_model&&(n.abc_model=u),null==m.log&&(m.log=u),null==t&&(t=u),null==r&&(r=u),i=n.abc_model["$[]"]("music_types")["$[]"](t["$[]"]("type"));try{_=n.$send("_transform_"+i,t,r,a)}catch(r){if(!e.rescue(r,[$(ue,"Exception")]))throw r;s=r;try{m.log.$error("Bug: "+s,n.$charpos_to_line_column(t["$[]"]("istart")))}finally{e.pop_exception()}}return _},o.$$s=p,o.$$arity=2,o)),_=_.$flatten(),g=h(_,"inject",[[]],(c=function(e,t){var r=c.$$s||this;return null==e&&(e=u),null==t&&(t=u),e["$<<"](r.$_make_jumplines(t,a)),e},c.$$s=p,c.$$arity=2,c)),v=h(_,"inject",[[]],(l=function(e,t){var r=l.$$s||this;return null==e&&(e=u),null==t&&(t=u),e["$<<"](r.$_make_notebound_annotations(t,a))},l.$$s=p,l.$$arity=2,l)),_=r(_,r(g,v)),_=_.$flatten().$compact(),y(_.$count()["$=="](0))&&(b=a.$gsub("v_","").$to_i(),y(y(f=p.score_statements.$last())?p.score_statements.$last()["$[]"]("sy")["$[]"]("voices")["$[]"](t(b,1))["$[]"]("range")["$=="](-1):f)||m.log.$error($(ue,"I18n").$t("Empty voice")+" "+b+":  V:"+n["$[]"]("voice_properties")["$[]"]("id"))),_},C.$$arity=2),e.def(le,"$_investigate_first_bar",I=function(r){var n,a,i=this,s=u,o=u,c=u;return s=i.abc_model["$[]"]("music_type_ids")["$[]"]("bar").$to_s(),o=h(r["$[]"]("symbols"),"select",[],(n=function(e){n.$$s;return null==e&&(e=u),e["$[]"]("type").$to_s()["$=="](s)?e["$[]"]("invisible")["$!"]():e["$[]"]("type").$to_s()["$=="](s)},n.$$s=i,n.$$arity=1,n)).$compact(),i.measure_start_time=0,y(o.$first())?(i.measure_start_time=t(o.$first()["$[]"]("time"),i.wmeasure),y(y(a=o.$first())?i.measure_start_time["$=="](0):a)?(c=["measure",!0],h(i.next_note_marks,"[]=",e.to_a(c)),c[t(c.length,1)]):u):u},I.$$arity=1),e.def(le,"$_bar_is_repetition_end?",O=function(e){return e["$=~"](/^:.*$/)},O.$$arity=1),e.def(le,"$_transform_bar",L=function(n,a,s){var o,c,l=this,f=u,p=u,d=u,g=u,v=u;return null==m.log&&(m.log=u),f=[],p=n["$[]"]("bar_type"),d=n["$[]"]("text"),g=function(){try{return l.$_extract_goto_info_from_bar(n).$last()["$[]"]("distance")}catch(t){if(!e.rescue(t,[$(ue,"StandardError")]))throw t;try{return[-10,10,15]}finally{e.pop_exception()}}}(),y(y(o=n["$[]"]("invisible"))?o:p["$=~"](/^\:?([\[\]]+)$/))||(v=["measure",!0],h(l.next_note_marks,"[]=",e.to_a(v)),v[t(v.length,1)]),y(p["$=~"](/^.*:$/))&&(v=["repeat_start",!0],h(l.next_note_marks,"[]=",e.to_a(v)),v[t(v.length,1)]),n["$[]"]("rbstart")["$=="](2)&&(l.variant_no=r(l.variant_no,1),v=["variant_ending",_(["text"],{text:d})],h(l.next_note_marks,"[]=",e.to_a(v)),v[t(v.length,1)]),y((o=n["$[]"]("rbstart")["$=="](2))?l.variant_endings.$last()["$empty?"]():n["$[]"]("rbstart")["$=="](2))&&(y(g.$length()["$!="](3))&&(m.log.$error("you need to specify 3 values: "+g,l.$charpos_to_line_column(n["$[]"]("istart")),l.$charpos_to_line_column(n["$[]"]("iend"))),g=[-10,10,15]),l.variant_endings.$last().$push(_(["rbstop","distance"],{rbstop:l.previous_note,distance:g}))),y(y(o=y(c=n["$[]"]("rbstop")["$=="](2))?l.variant_endings.$last().$last()["$nil?"]()["$!"]():c)?l.variant_endings.$last().$last()["$[]"]("rbstart"):o)&&(v=["rbstop",l.previous_note],h(l.variant_endings.$last().$last(),"[]=",e.to_a(v)),v[t(v.length,1)],y(l["$_bar_is_repetition_end?"](p))&&(v=["repeat_end",!0],h(l.variant_endings.$last().$last(),"[]=",e.to_a(v)),v[t(v.length,1)]),y(l["$_bar_is_repetition_end?"](p))?(l.pushed_variant_ending_repeat=!0,l.repetition_stack.$push(l.repetition_stack.$last())):y(y(o=l.pushed_variant_ending_repeat)?i(l.repetition_stack.$count(),1):o)&&l.repetition_stack.$pop(),n["$[]"]("rbstart")["$=="](2)||(v=["variant_followup",!0],h(l.next_note_marks,"[]=",e.to_a(v)),v[t(v.length,1)],l.variant_endings.$push([]),l.variant_no=0)),y(l["$_bar_is_repetition_end?"](p))&&f["$<<"](l.$_transform_bar_repeat_end(n,a,s)),y(p["$include?"](":"))&&(y(!1)||t(n["$[]"]("time"),l.measure_start_time)["$=="](l.wmeasure)||(v=["measure",!1],h(l.next_note_marks,"[]=",e.to_a(v)),v[t(v.length,1)])),l.is_first_measure=!1,f},L.$$arity=3),e.def(le,"$_transform_part",P=function(n,a,i){var s=this,o=u,c=u,l=u;return null==m.log&&(m.log=u),y(s.part_table["$[]"](n["$[]"]("time")))&&(o=s.$charpos_to_line_column(n["$[]"]("istart")),c=s.$charpos_to_line_column(n["$[]"]("iend")),m.log.$error(r("abc:"+o.$first()+":"+o.$last()+" Error: ",$(ue,"I18n").$t("Multiple parts for same note")),o,c)),l=[n["$[]"]("time"),n["$[]"]("text")],h(s.part_table,"[]=",e.to_a(l)),l[t(l.length,1)],u},P.$$arity=3),e.def(le,"$_transform_remark",M=function(n,a,i){var s=this,o=u,c=u,l=u;return null==m.log&&(m.log=u),y(s.remark_table["$[]"](n["$[]"]("time")))&&(o=s.$charpos_to_line_column(n["$[]"]("istart")),c=s.$charpos_to_line_column(n["$[]"]("iend")),m.log.$error(r("abc:"+o.$first()+":"+o.$last()+" Error: ",$(ue,"I18n").$t("Multiple remarks for same note")),o,c)),l=[n["$[]"]("time"),n["$[]"]("text")],h(s.remark_table,"[]=",e.to_a(l)),l[t(l.length,1)],u},M.$$arity=3),e.def(le,"$_transform_note",T=function(r,n,a){var i,s,o,c,l,p,d=this,_=u,m=u,g=u,v=u,b=u,x=u,w=u,A=u,k=u,E=u,S=u,N=u,C=u,I=u;return _=d.$_parse_origin(r),i=[_["$[]"]("startChar"),_["$[]"]("endChar")],m=i[0],g=i[1],s=d.$_parse_tuplet_info(r),i=e.to_ary(s),v=null==i[0]?u:i[0],b=null==i[1]?u:i[1],x=null==i[2]?u:i[2],w=d.$_parse_decorations(r),d.$_transform_measure_start(r),A=d.$_convert_duration(r["$[]"]("notes").$first()["$[]"]("dur")),k=h(r["$[]"]("notes"),"map",[],(o=function(n){var a=o.$$s||this,i=u,s=u;return null==a.measure_count&&(a.measure_count=u),null==a.variant_no&&(a.variant_no=u),null==n&&(n=u),i=f(f($(ue,"Harpnotes"),"Music"),"Note").$new(n["$[]"]("midi"),A),s=[w],h(i,"decorations=",e.to_a(s)),s[t(s.length,1)],s=[a.measure_count],h(i,"measure_count=",e.to_a(s)),s[t(s.length,1)],s=[a.$_transform_count_note(r)],h(i,"count_note=",e.to_a(s)),s[t(s.length,1)],s=[r["$[]"]("time")],h(i,"time=",e.to_a(s)),s[t(s.length,1)],s=[a.$_mkznid(r)],h(i,"znid=",e.to_a(s)),s[t(s.length,1)],s=[_],h(i,"origin=",e.to_a(s)),s[t(s.length,1)],s=[a.$charpos_to_line_column(m)],h(i,"start_pos=",e.to_a(s)),s[t(s.length,1)],s=[a.$charpos_to_line_column(g)],h(i,"end_pos=",e.to_a(s)),s[t(s.length,1)],s=[v],h(i,"tuplet=",e.to_a(s)),s[t(s.length,1)],s=[x],h(i,"tuplet_start=",e.to_a(s)),s[t(s.length,1)],s=[b],h(i,"tuplet_end=",e.to_a(s)),s[t(s.length,1)],s=[a.variant_no],h(i,"variant=",e.to_a(s)),s[t(s.length,1)],i},o.$$s=d,o.$$arity=1,o)),E=[],k.$count()["$=="](1)?E["$<<"](k.$first()):(S=f(f($(ue,"Harpnotes"),"Music"),"SynchPoint").$new(k),N=k.$first(),C=[d.$_mkznid(r)],h(S,"znid=",e.to_a(C)),C[t(C.length,1)],C=[w],h(S,"decorations=",e.to_a(C)),C[t(C.length,1)],C=[d.measure_count],h(S,"measure_count=",e.to_a(C)),C[t(C.length,1)],C=[d.$_transform_count_note(r)],h(S,"count_note=",e.to_a(C)),C[t(C.length,1)],C=[N.$time()],h(S,"time=",e.to_a(C)),C[t(C.length,1)],C=[N.$duration()],h(S,"duration=",e.to_a(C)),C[t(C.length,1)],C=[N.$origin()],h(S,"origin=",e.to_a(C)),C[t(C.length,1)],C=[N.$start_pos()],h(S,"start_pos=",e.to_a(C)),C[t(C.length,1)],C=[N.$end_pos()],h(S,"end_pos=",e.to_a(C)),C[t(C.length,1)],C=[N.$tuplet()],h(S,"tuplet=",e.to_a(C)),C[t(C.length,1)],C=[N.$tuplet_start()],h(S,"tuplet_start=",e.to_a(C)),C[t(C.length,1)],C=[N.$tuplet_end()],h(S,"tuplet_end=",e.to_a(C)),C[t(C.length,1)],E["$<<"](S)),y(d.repetition_stack["$empty?"]())&&d.repetition_stack["$<<"](E.$last()),C=[d.tie_started],h(E.$first(),"tie_end=",e.to_a(C)),C[t(C.length,1)],d.tie_started=r["$[]"]("ti1")["$nil?"]()["$!"](),C=[d.tie_started],h(E.$first(),"tie_start=",e.to_a(C)),C[t(C.length,1)],C=[h(d.$_parse_slur(r["$[]"]("slur_start")),"map",[],(c=function(e){var t=c.$$s||this;return null==e&&(e=u),t.$_push_slur()},c.$$s=d,c.$$arity=1,c))],h(E.$first(),"slur_starts=",e.to_a(C)),C[t(C.length,1)],I=y(i=r["$[]"]("slur_end"))?i:0,C=[h(e.Range.$new(1,I,!1),"map",[],(l=function(){return(l.$$s||this).$_pop_slur()},l.$$s=d,l.$$arity=0,l))],h(E.$first(),"slur_ends=",e.to_a(C)),C[t(C.length,1)],y(d.next_note_marks["$[]"]("measure"))&&(h(k,"each",[],(p=function(r){p.$$s;return null==r&&(r=u),C=[!0],h(r,"measure_start=",e.to_a(C)),C[t(C.length,1)]},p.$$s=d,p.$$arity=1,p)),C=["measure",!1],h(d.next_note_marks,"[]=",e.to_a(C)),C[t(C.length,1)]),d.$_make_repeats_jumps_annotations(E,r,a),E},T.$$arity=3),e.def(le,"$_transform_measure_start",B=function(e){var t=this;return y(t.next_note_marks["$[]"]("measure"))?(t.measure_count=r(t.measure_count,1),t.measure_start_time=e["$[]"]("time")):u},B.$$arity=1),e.def(le,"$_transform_count_note",j=function(i){var o,c,l,f,p=this,d=u,_=u,m=u,g=u,v=u,b=u;return y(p.countby)?(d=n($(ue,"ABC2SVG_DURATION_FACTOR"),p.countby),_=n(s(4,t(i["$[]"]("time"),p.measure_start_time)),d),m=r(_,n(s(4,i["$[]"]("dur")),d)),g=y(y(o=_["$%"](1)["$=="](0))?m["$%"](1)["$=="](0):o)?h(e.Range.$new(_,m,!0).$to_a(),"map",[],(c=function(e){var t=c.$$s||this;return null==t.countnames&&(t.countnames=u),null==e&&(e=u),t.countnames["$[]"](e)},c.$$s=p,c.$$arity=1,c)).$join():_["$%"](1)["$=="](0)?h(e.Range.$new(_,m.$ceil(),!0).$to_a(),"map",[],(l=function(e){var t=l.$$s||this;return null==t.countnames&&(t.countnames=u),null==e&&(e=u),t.countnames["$[]"](e)},l.$$s=p,l.$$arity=1,l)).$join(""):"",v=g.$split(/[eui\?]+/),b=g.$split(/[0-9]+/),y(b["$empty?"]())&&(b=[""]),h(b,"each_with_index",[],(f=function(r,n){var i=(f.$$s,u);return null==r&&(r=u),null==n&&(n=u),y(a(n,1))?(i=[n,u],h(b,"[]=",e.to_a(i)),i[t(i.length,1)]):u},f.$$s=p,f.$$arity=2,f)),g=b.$zip(v).$flatten().$compact().$join(" ").$strip().$split().$join("-"),g=g.$gsub("ue","u")):u},j.$$arity=1),e.def(le,"$_convert_duration",F=function(e){var t=this;return[128,s(n(e,$(ue,"ABC2SVG_DURATION_FACTOR")),t._shortest_note).$round()].$min()},F.$$arity=1),e.def(le,"$_transform_staves",R=function(e,t,r){var n=this,a=u,s=u;return null==m.log&&(m.log=u),y(n.score_statements)||(n.score_statements=[]),n.score_statements.$push(e),y(i(n.score_statements.$length(),1))?(a=n.$charpos_to_line_column(e["$[]"]("istart")),s=n.$charpos_to_line_column(e["$[]"]("iend")),m.log.$error($(ue,"I18n").$t("you have multiple %%score statements")+": "+n.score_statements.$length(),a,s)):u},R.$$arity=3),e.def(le,"$_transform_rest",D=function(r,a,i){var s,o,c,l=this,p=u,d=u,_=u,g=u,v=u,b=u,x=u,w=u,A=u,k=u,E=u,S=u;return null==m.conf&&(m.conf=u),p=l.$_parse_origin(r),s=[p["$[]"]("startChar"),p["$[]"]("endChar")],d=s[0],_=s[1],g=[l.pitch_providers["$[]"](e.Range.$new(0,a,!1)).$compact().$last(),l.pitch_providers["$[]"](e.Range.$new(a,-1,!1)).$compact().$first()],m.conf["$[]"]("restposition.default")["$=="]("previous")&&(g=[y(s=g.$first())?s:g.$last()]),m.conf["$[]"]("restposition.default")["$=="]("next")&&(g=[y(s=g.$last())?s:g.$first()]),v=l.$_parse_decorations(r),g=g.$compact(),y(g["$empty?"]())?b=60:(g=h(g,"map",[],(o=function(e){o.$$s;return null==e&&(e=u),e["$[]"]("notes").$last()["$[]"]("midi")},o.$$s=l,o.$$arity=1,o)),b=n(g.$inject("+"),g.$length()).$floor().$to_i()),y(b["$nil?"]())&&(l.$raise("undefined pitch"),b=60),l.$_transform_measure_start(r),x=r["$[]"]("notes"),x=function(){return y(x)?x.$first()["$[]"]("dur"):r["$[]"]("dur")}(),x=l.$_convert_duration(x),c=l.$_parse_tuplet_info(r),s=e.to_ary(c),w=null==s[0]?u:s[0],A=null==s[1]?u:s[1],k=null==s[2]?u:s[2],E=f(f($(ue,"Harpnotes"),"Music"),"Pause").$new(b,x),S=[l.measure_count],h(E,"measure_count=",e.to_a(S)),S[t(S.length,1)],S=[v],h(E,"decorations=",e.to_a(S)),S[t(S.length,1)],S=[l.$_transform_count_note(r)],h(E,"count_note=",e.to_a(S)),S[t(S.length,1)],S=[l.$_mkznid(r)],h(E,"znid=",e.to_a(S)),S[t(S.length,1)],S=[r["$[]"]("time")],h(E,"time=",e.to_a(S)),S[t(S.length,1)],S=[l.$_parse_origin(r)],h(E,"origin=",e.to_a(S)),S[t(S.length,1)],S=[l.$charpos_to_line_column(d)],h(E,"start_pos=",e.to_a(S)),S[t(S.length,1)],S=[l.$charpos_to_line_column(_)],h(E,"end_pos=",e.to_a(S)),S[t(S.length,1)],S=[l.variant_no],h(E,"variant=",e.to_a(S)),S[t(S.length,1)],S=[w],h(E,"tuplet=",e.to_a(S)),S[t(S.length,1)],S=[k],h(E,"tuplet_start=",e.to_a(S)),S[t(S.length,1)],S=[A],h(E,"tuplet_end=",e.to_a(S)),S[t(S.length,1)],y(r["$[]"]("invis"))&&(S=[!1],h(E,"visible=",e.to_a(S)),S[t(S.length,1)]),S=[r["$[]"]("invis")],h(E,"invisible=",e.to_a(S)),S[t(S.length,1)],y(l.repetition_stack["$empty?"]())&&l.repetition_stack["$<<"](E),E=[E],y(l.next_note_marks["$[]"]("measure"))&&(S=[!0],h(E.$first(),"measure_start=",e.to_a(S)),S[t(S.length,1)],S=["measure",!1],h(l.next_note_marks,"[]=",e.to_a(S)),S[t(S.length,1)]),l.$_make_repeats_jumps_annotations(E,r,i),E},D.$$arity=3),e.def(le,"$_transform_tempo",z=function(e,t,n){var a=this,i=u,s=u;return null==m.log&&(m.log=u),e["$[]"]("istart")["$=="](a.meta_data["$[]"]("tempo")["$[]"]("sym")["$[]"]("istart"))?u:(i=a.$charpos_to_line_column(e["$[]"]("istart")),s=a.$charpos_to_line_column(e["$[]"]("iend")),m.log.$error(r("abc:"+i.$first()+":"+i.$last()+" Error: ",$(ue,"I18n").$t("tempo change not suported by zupfnoter")),i,s))},z.$$arity=3),e.def(le,"$_transform_yspace",q=function(e,t){return u},q.$$arity=2),e.def(le,"$_transform_bar_repeat_end",U=function(r,n,a){var s=this,o=u,c=u,l=u,p=u,d=u,g=u,v=u;return null==m.conf&&(m.conf=u),o=s.repetition_stack.$length(),c=o["$=="](1)?s.repetition_stack.$last():s.repetition_stack.$pop(),l=s.$_extract_goto_info_from_bar(r),p=function(){try{return l.$last()["$[]"]("distance")}catch(t){if(!e.rescue(t,[$(ue,"StandardError")]))throw t;try{return[2]}finally{e.pop_exception()}}}(),y(i(p.$count(),1))&&s.$raise("too many distance values for repeat end. Need only one "+p),y(s.previous_note["$is_a?"](f(f($(ue,"Harpnotes"),"Music"),"Pause")))&&m.conf["$[]"]("restposition.repeatend")["$=="]("previous")&&(d=[s.previous_note.$prev_pitch()],h(s.previous_note,"pitch=",e.to_a(d)),d[t(d.length,1)]),p=p.$first(),d=["first_in_part",!0],h(s.next_note_marks,"[]=",e.to_a(d)),d[t(d.length,1)],g=s.previous_note,v="notebound.c_jumplines."+a+"."+g.$znid()+".p_repeat",[f(f($(ue,"Harpnotes"),"Music"),"Goto").$new(s.previous_note,c,_(["distance","is_repeat","level","conf_key"],{distance:p,is_repeat:!0,level:o,conf_key:v}))]},U.$$arity=3),e.def(le,"$_transform_grace",H=function(){return u},H.$$arity=0),e.def(le,"$_transform_format",G=function(e){return u},G.$$arity=1),e.def(le,"$_transform_key",Y=function(e){return u},Y.$$arity=1),e.def(le,"$_transform_meter",V=function(t){var n=this,a=u,i=u;return null==m.log&&(m.log=u),y(n.next_note_marks["$[]"]("measure"))||(a=n.$charpos_to_line_column(t["$[]"]("istart")),i=n.$charpos_to_line_column(t["$[]"]("iend")),m.log.$warning(r("abc:"+a.$first()+":"+a.$last()+" Error: ",$(ue,"I18n").$t("Meter change not at beginning of measure")),a,i)),n.is_first_measure=!0,n.wmeasure=t["$[]"]("wmeasure"),n.countby=function(){try{return t["$[]"]("a_meter").$first()["$[]"]("bot").$to_i()}catch(t){if(!e.rescue(t,[$(ue,"StandardError")]))throw t;try{return u}finally{e.pop_exception()}}}(),u},V.$$arity=1),e.def(le,"$_transform_block",Q=function(e){return u},Q.$$arity=1),e.def(le,"$_transform_clef",X=function(e){return u},X.$$arity=1),e.def(le,"$_make_variant_ending_jumps",W=function(t){var r,n=this,a=u,i=u;return a=[],i=function(){return y(n.variant_endings.$last()["$empty?"]())?-2:-1}(),h(n.variant_endings["$[]"](e.Range.$new(0,i,!1)),"each",[],(r=function(n){var i,s,o=r.$$s||this,c=u,l=u,p=u,d=u,m=u;return null==n&&(n=u),c=n["$[]"](0)["$[]"]("distance"),l=n.$first()["$[]"]("rbstop"),p="notebound.c_jumplines."+t+"."+l.$znid(),d=y(n["$[]"](-1)["$[]"]("is_followup"))?-2:-1,h(n["$[]"](e.Range.$new(1,d,!1)),"each_with_index",[],(i=function(e,t){var r=(i.$$s,u);return null==e&&(e=u),null==t&&(t=u),r=p+"."+t+".p_begin",a["$<<"](f(f($(ue,"Harpnotes"),"Music"),"Goto").$new(n["$[]"](0)["$[]"]("rbstop"),e["$[]"]("rbstart"),_(["conf_key","distance","from_anchor","to_anchor"],{conf_key:r,distance:c["$[]"](0),from_anchor:"after",to_anchor:"before"})))},i.$$s=o,i.$$arity=2,i)),h(n["$[]"](v(1,-3,!1)),"each_with_index",[],(s=function(e,t){var r=(s.$$s,u);return null==e&&(e=u),null==t&&(t=u),y(e["$[]"]("repeat_end"))?u:(r=p+".p_end",a["$<<"](f(f($(ue,"Harpnotes"),"Music"),"Goto").$new(e["$[]"]("rbstop"),n["$[]"](-1)["$[]"]("rbstart"),_(["conf_key","distance","from_anchor","to_anchor","vertical_anchor"],{conf_key:r,distance:c["$[]"](1),from_anchor:"after",to_anchor:"before",vertical_anchor:"to"}))))},s.$$s=o,s.$$arity=2,s)),y(n["$[]"](-1)["$[]"]("is_followup"))?(m=p+".p_follow",a["$<<"](f(f($(ue,"Harpnotes"),"Music"),"Goto").$new(n["$[]"](-2)["$[]"]("rbstop"),n["$[]"](-1)["$[]"]("rbstart"),_(["conf_key","distance","from_anchor","to_anchor","vertical_anchor"],{conf_key:m,distance:c["$[]"](2),from_anchor:"after",to_anchor:"before",vertical_anchor:"to"})))):u},r.$$s=n,r.$$arity=1,r)),a},W.$$arity=1),e.def(le,"$_make_jumplines",J=function(e,t){var r,n=this,a=u;return y(e["$is_a?"](f(f($(ue,"Harpnotes"),"Music"),"Playable")))?(a=n.$_extract_goto_info_from_bar(e.$origin()["$[]"]("raw_voice_element")),h(a,"inject",[[]],(r=function(n,a){var i,s=r.$$s||this,o=u,c=u,l=u,p=u;return null==s.jumptargets&&(s.jumptargets=u),null==m.log&&(m.log=u),null==n&&(n=u),null==a&&(a=u),o=a["$[]"]("target"),c=s.jumptargets["$[]"](o),l="notebound.c_jumplines."+t+"."+e.$znid()+".p_goto",p=y(i=a["$[]"]("distance").$first())?i:2,y(c["$nil?"]())?m.log.$error("target '"+o+"' not found in voice at "+e.$start_pos_to_s(),e.$start_pos(),e.$end_pos()):n["$<<"](f(f($(ue,"Harpnotes"),"Music"),"Goto").$new(e,c,_(["conf_key","distance"],{conf_key:l,distance:p}))),n},r.$$s=n,r.$$arity=2,r))):u},J.$$arity=2),e.def(le,"$_make_notebound_annotations",K=function(r,n){var a,s=this,o=u,c=u;return o=[],y(r["$is_a?"](f(f($(ue,"Harpnotes"),"Music"),"Playable")))&&(c=s.$_extract_chord_lines(r.$origin()["$[]"]("raw_voice_element")),h(c,"each_with_index",[],(a=function(s,c){var l,p,d,g,v,b=a.$$s||this,x=u,w=u,A=u,k=u,E=u,S=u,N=u,C=u,I=u,O=u,L=u;return null==b.annotations&&(b.annotations=u),null==m.log&&(m.log=u),null==m.conf&&(m.conf=u),null==s&&(s=u),null==c&&(c=u),x=s.$match(/^([!#\<\>])([^\@]+)?(\@(\-?[0-9\.]+),(\-?[0-9\.]+))?$/),y(x)?(w=x["$[]"](1),A=x["$[]"](2),y(x["$[]"](4))&&(k=x["$[]"](4)),y(x["$[]"](5))&&(E=x["$[]"](5)),S=w,"#"["$==="](S)?(N=b.annotations["$[]"](A),y(N)||m.log.$error("could not find annotation "+A,r.$start_pos(),r.$end_pos())):"!"["$==="](S)?N=_(["text","style"],{text:A,style:"regular"}):"<"["$==="](S)?(C=[_(["dir","size","style"],{dir:-1,size:A,style:"regular"})],h(r,"shift=",e.to_a(C)),C[t(C.length,1)],y(r["$is_a?"](f(f($(ue,"Harpnotes"),"Music"),"SynchPoint")))&&h(r.$notes(),"each",[],(l=function(r){l.$$s;return null==r&&(r=u),C=[_(["dir","size","style"],{dir:-1,size:A,style:"regular"})],h(r,"shift=",e.to_a(C)),C[t(C.length,1)]},l.$$s=b,l.$$arity=1,l))):">"["$==="](S)?(C=[_(["dir","size","style"],{dir:1,size:A,style:"regular"})],h(r,"shift=",e.to_a(C)),C[t(C.length,1)],y(r["$is_a?"](f(f($(ue,"Harpnotes"),"Music"),"SynchPoint")))&&h(r.$notes(),"each",[],(p=function(r){p.$$s;return null==r&&(r=u),C=[_(["dir","size","style"],{dir:1,size:A,style:"regular"})],h(r,"shift=",e.to_a(C)),C[t(C.length,1)]},p.$$s=b,p.$$arity=1,p))):N=u,y(N)?(y(k)&&(I=h([k,E],"map",[],(d=function(e){d.$$s;return null==e&&(e=u),e.$to_f()},d.$$s=b,d.$$arity=1,d))),O=y(g=y(v=I)?v:N["$[]"]("pos"))?g:m.conf["$[]"]("defaults.notebound.annotation.pos"),y(r.$znid())&&(L="notebound.annotation."+n+"."+r.$znid()),y(i(c,0))&&(L="notebound.annotation."+n+"."+r.$znid()+"."+c),o["$<<"](f(f($(ue,"Harpnotes"),"Music"),"NoteBoundAnnotation").$new(r,_(["style","pos","text"],{style:N["$[]"]("style"),pos:O,text:N["$[]"]("text")}),L))):u):u},a.$$s=s,a.$$arity=2,a))),o},K.$$arity=2),e.def(le,"$_make_repeats_jumps_annotations",Z=function(r,n,a){var i,s,o=this,c=u,l=u,p=u,d=u,g=u,b=u,x=u,w=u;return null==m.conf&&(m.conf=u),c=r.$first(),l=o.part_table["$[]"](n["$[]"]("time")),y(o.previous_note)&&(p=[c.$pitch()],h(o.previous_note,"next_pitch=",e.to_a(p)),p[t(p.length,1)],p=[c],h(o.previous_note,"next_playable=",e.to_a(p)),p[t(p.length,1)],y(l)&&(p=[!0],h(o.previous_note,"next_first_in_part=",e.to_a(p)),p[t(p.length,1)]),p=[o.previous_note.$pitch()],h(c,"prev_pitch=",e.to_a(p)),p[t(p.length,1)],p=[o.previous_note],h(c,"prev_playable=",e.to_a(p)),p[t(p.length,1)]),o.previous_note=c,d=c.$znid(),y(l)&&(y(d)&&(g="notebound.partname."+a+"."+d),b=m.conf["$[]"]("defaults.notebound.partname.pos"),p=[!0],h(r.$first(),"first_in_part=",e.to_a(p)),p[t(p.length,1)],r["$<<"](f(f($(ue,"Harpnotes"),"Music"),"NoteBoundAnnotation").$new(r.$first(),_(["style","pos","text"],{style:"regular",pos:b,text:l}),g))),y(o.next_note_marks["$[]"]("repeat_start"))&&(p=[!0],h(o.previous_note,"first_in_part=",e.to_a(p)),p[t(p.length,1)],o.repetition_stack["$<<"](r.$first()),p=["repeat_start",!1],h(o.next_note_marks,"[]=",e.to_a(p)),p[t(p.length,1)]),y(o.next_note_marks["$[]"]("first_in_part"))&&(p=[!0],h(o.previous_note,"first_in_part=",e.to_a(p)),p[t(p.length,1)],p=["first_in_part",!1],h(o.next_note_marks,"[]=",e.to_a(p)),p[t(p.length,1)]),y(o.next_note_marks["$[]"]("variant_ending"))&&(x=o.next_note_marks["$[]"]("variant_ending")["$[]"]("text"),y(d)&&(g="notebound.variantend."+a+"."+d),b=m.conf["$[]"]("defaults.notebound.variantend.pos"),p=[!0],h(r.$first(),"first_in_part=",e.to_a(p)),p[t(p.length,1)],r["$<<"](f(f($(ue,"Harpnotes"),"Music"),"NoteBoundAnnotation").$new(r.$first(),_(["style","pos","text","policy"],{style:"regular",pos:b,text:x,policy:"Goto"}),g)),p=["variant_ending",u],h(o.next_note_marks,"[]=",e.to_a(p)),p[t(p.length,1)],o.variant_endings.$last().$push(_([],{})),p=["rbstart",o.previous_note],h(o.variant_endings.$last().$last(),"[]=",e.to_a(p)),p[t(p.length,1)]),y(o.next_note_marks["$[]"]("variant_followup"))&&(p=[!0],h(o.previous_note,"first_in_part=",e.to_a(p)),p[t(p.length,1)],o.variant_endings["$[]"](-2).$push(_(["rbstart","is_followup"],{rbstart:o.previous_note,is_followup:!0})),p=["variant_followup",!1],h(o.next_note_marks,"[]=",e.to_a(p)),p[t(p.length,1)]),w=o.$_extract_chord_lines(n),h(h(w,"select",[],(i=function(e){i.$$s;return null==e&&(e=u),e["$[]"](0)["$=="](":")},i.$$s=o,i.$$arity=1,i)),"each",[],(s=function(n){var a,i=s.$$s||this;return null==i.jumptargets&&(i.jumptargets=u),null==n&&(n=u),p=[n["$[]"](v(1,-1,!1)),h(r,"select",[],(a=function(e){a.$$s;return null==e&&(e=u),e["$is_a?"](f(f($(ue,"Harpnotes"),"Music"),"Playable"))},a.$$s=i,a.$$arity=1,a)).$last()],h(i.jumptargets,"[]=",e.to_a(p)),p[t(p.length,1)]},s.$$s=o,s.$$arity=1,s))},Z.$$arity=3),e.def(le,"$_get_extra",ee=function(t,r){var n,a,i=this;return function(){try{return y(n=t["$[]"]("extra"))?h(t["$[]"]("extra"),"select",[],(a=function(e){a.$$s;return null==e&&(e=u),e["$[]"]("type").$to_s()["$=="](r.$to_s())},a.$$s=i,a.$$arity=1,a)).$first():n}catch(t){if(!e.rescue(t,[$(ue,"StandardError")]))throw t;try{return u}finally{e.pop_exception()}}}()},ee.$$arity=2),e.def(le,"$_push_slur",te=function(){var e=this;return e.slurstack=r(e.slurstack,1)},te.$$arity=0),e.def(le,"$_pop_slur",re=function(){var e=this,r=u;return r=e.slurstack,e.slurstack=t(e.slurstack,1),y(o(e.slurstack,0))&&(e.slurstack=0),r},re.$$arity=0),e.def(le,"$_extract_chord_lines",ne=function(r){var n,a,i=this,s=u;return s=r["$[]"]("a_gch"),y(s)?h(h(s,"select",[],(n=function(r){var a=(n.$$s,u);return null==r&&(r=u),a=["type","^"],h(r,"[]=",e.to_a(a)),a[t(a.length,1)]},n.$$s=i,n.$$arity=1,n)),"map",[],(a=function(e){a.$$s;return null==e&&(e=u),e["$[]"]("text")},a.$$s=i,a.$$arity=1,a)):[]},ne.$$arity=1),e.def(le,"$_extract_goto_info_from_bar",ae=function(e){var t,r=this,n=u;return n=r.$_extract_chord_lines(e),h(n,"inject",[[]],(t=function(r,n){var a,i=t.$$s||this,s=u,o=u,c=u,l=u,f=u;return null==m.log&&(m.log=u),null==r&&(r=u),null==n&&(n=u),y(n["$start_with?"]("@"))&&(s=n.$match(/^^@([^\@]*)@(\-?\d*)(,(\-?\d*),(\-?\d*))?$/),y(s)?(o=s["$[]"](1),c=h([2,4,5],"map",[],(a=function(e){a.$$s;return null==e&&(e=u),y(s["$[]"](e))?s["$[]"](e).$to_i():u},a.$$s=i,a.$$arity=1,a)).$compact(),r.$push(_(["target","distance"],{target:o,distance:c}))):(l=i.$charpos_to_line_column(e["$[]"]("istart")),f=i.$charpos_to_line_column(e["$[]"]("iend")),m.log.$error("Syntax-Error in Jump anotation",l,f))),r},t.$$s=r,t.$$arity=2,t))},ae.$$arity=1),e.def(le,"$_parse_decorations",ie=function(e){var t,r,n,a=this,i=u,s=u;return i=y(t=e["$[]"]("a_dd"))?t:[],s=h(i,"map",[],(r=function(e){r.$$s;return null==e&&(e=u),s=e["$[]"]("name").$to_sym()},r.$$s=a,r.$$arity=1,r)),h(s.$flatten(),"select",[],(n=function(e){n.$$s;return null==e&&(e=u),["fermata","emphasis"]["$include?"](e)},n.$$s=a,n.$$arity=1,n))},ie.$$arity=1),e.def(le,"$_parse_origin",se=function(e){return _(["startChar","endChar","start_pos","end_pos","raw_voice_element"],{startChar:e["$[]"]("istart"),endChar:e["$[]"]("iend"),start_pos:e["$[]"]("start_pos"),end_pos:e["$[]"]("end_pos"),raw_voice_element:e})},se.$$arity=1),e.def(le,"$_parse_slur",oe=function(e){var t,r=u,n=u;for(r=y(t=e)?t:0,n=[];y(i(r,0));)n.$push(r["$&"](15)),r=r["$>>"](4);return n},oe.$$arity=1),e.def(le,"$_parse_tuplet_info",ce=function(e){var t=this,n=u,a=u,i=u,s=u,o=u;return null==m.log&&(m.log=u),y(e["$[]"]("in_tuplet"))?(y(e["$[]"]("tp1"))&&(n=t.$charpos_to_line_column(e["$[]"]("istart")),a=t.$charpos_to_line_column(e["$[]"]("iend")),m.log.$error(r("abc:"+n.$first()+":"+n.$last()+" Error: ",$(ue,"I18n").$t("Nested Tuplet")),n,a)),y(e["$[]"]("tp0"))?(t.tuplet_p=e["$[]"]("tp0"),i=!0):i=u,s=t.tuplet_p,o=!!y(e["$[]"]("te0"))||u):(s=1,i=u,o=u),[s,o,i]},ce.$$arity=1)}(x[0],$(x,"AbstractAbcToHarpnotes"),x)}(x[0],x)}(l[0],l)},Opal.modules["opal-jspdf"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e*t:e["$*"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}function a(e,t){return"number"==typeof e&&"number"==typeof t?e/t:e["$/"](t)}var i=e.top,s=[],o=e.nil,c=(e.const_get_qualified,e.const_get_relative,e.breaker,e.slice,e.klass),l=e.truthy,u=e.send;return e.add_stubs(["$require","$attr_accessor","$apply_offset_to_point","$[]","$nil?","$start_with?","$raise","$to_n","$map","$*","$-","$==","$+","$/","$private","$first","$last"]),i.$require("native"),function(i,s,f){var $,p,d,h,_,m,y,g,v,b,x,w,A,k,E,S,N,C,I,O,L,P,M=c(i,null,"JsPDF");[M].concat(f);return M.$$prototype.native_jspdf=M.$$prototype.x_offset=M.$$prototype.y_offset=o,M.$attr_accessor("x_offset","y_offset"),e.def(M,"$initialize",$=function(e,t,r){var n=this;return null==e&&(e="p"),null==t&&(t="mm"),null==r&&(r="a4"),n.x_offset=0,n.y_offset=0,n.native_jspdf=new jsPDF(e,t,r)},$.$$arity=-1),e.defs(M,"$jspdfversion",p=function(){return jsPDF.version},p.$$arity=0),e.def(M,"$line",d=function(e,t){var r=this,n=o,a=o;return n=r.$apply_offset_to_point(e),a=r.$apply_offset_to_point(t),r.native_jspdf.lines([[a[0]-n[0],a[1]-n[1]]],n[0],n[1])},d.$$arity=2),e.def(M,"$line_cap=",h=function(e){return this.native_jspdf.setLineCap(e)},h.$$arity=1),e.def(M,"$ellipse",_=function(e,t,r){var n=this,a=o;return null==r&&(r=void 0),a=n.$apply_offset_to_point(e),n.native_jspdf.ellipse(a["$[]"](0),a["$[]"](1),t["$[]"](0),t["$[]"](1),r)},_.$$arity=-3),e.def(M,"$fill=",m=function(e){return this.native_jspdf.setFillColor(e[0],e[1],e[2])},m.$$arity=1),e.def(M,"$stroke=",y=function(e){return this.native_jspdf.setDrawColor(e[0],e[1],e[2])},y.$$arity=1),e.def(M,"$line_width=",g=function(e){return this.native_jspdf.setLineWidth(e)},g.$$arity=1),e.def(M,"$line_dash=",v=function(e){var t=this;return null==e&&(e=3),l(e["$nil?"]())&&(e=void 0),t.native_jspdf.setLineDash([e,e],e)},v.$$arity=-1),e.def(M,"$text_color=",b=function(e){return this.native_jspdf.setTextColor(e[0],e[1],e[2])},b.$$arity=1),e.def(M,"$font_size=",x=function(e){return this.native_jspdf.setFontSize(e)},x.$$arity=1),e.def(M,"$font_style=",w=function(e){return this.native_jspdf.setFontStyle(e)},w.$$arity=1),e.def(M,"$use_solid_lines",A=function(){return this.native_jspdf.setLineDash("",0)},A.$$arity=0),e.def(M,"$image",k=function(t,r,n,a){var i,s,c=this,u=o,f=o,$=o;return s=c.$apply_offset_to_point([r,n]),i=e.to_ary(s),u=null==i[0]?o:i[0],f=null==i[1]?o:i[1],$=o,l(t["$start_with?"]("data:image/jpeg"))&&($="jpeg"),l(t["$start_with?"]("data:image/png"))&&($="png"),l($)?c.native_jspdf.addImage(t,$,u,f,0,a):c.$raise("image format not supported for pdf: "+$)},k.$$arity=4),e.def(M,"$text",E=function(t,r,n,a){var i,s,c=this,l=o,u=o;return null==a&&(a=o),s=c.$apply_offset_to_point([t,r]),i=e.to_ary(s),l=null==i[0]?o:i[0],u=null==i[1]?o:i[1],c.native_jspdf.text(l,u,n,a.$to_n())},E.$$arity=-4),e.def(M,"$rect_like_ellipse",S=function(e,n,a){
var i,s=this,c=o,l=o;return null==a&&(a="undefined"),c=s.$apply_offset_to_point(e),l=u(n,"map",[],(i=function(e){i.$$s;return null==e&&(e=o),t(2,e)},i.$$s=s,i.$$arity=1,i)),s.native_jspdf.rect(r(c["$[]"](0),n["$[]"](0)),r(c["$[]"](1),n["$[]"](1)),l["$[]"](0),l["$[]"](1),a)},S.$$arity=-3),e.def(M,"$rect",N=function(t,r,n,a,i){var s,c,l=this,u=o,f=o;return null==i&&(i="undefined"),c=l.$apply_offset_to_point([t,r]),s=e.to_ary(c),u=null==s[0]?o:s[0],f=null==s[1]?o:s[1],l.native_jspdf.rect(u,f,n,a,i)},N.$$arity=-5),e.def(M,"$lines",C=function(t,r,n,a,i,s){var c,l,u=this,f=o,$=o;return l=u.$apply_offset_to_point([r,n]),c=e.to_ary(l),f=null==c[0]?o:c[0],$=null==c[1]?o:c[1],u.native_jspdf.lines(t,f,$,a,i,s)},C.$$arity=6),e.def(M,"$output",I=function(e,t){var r=this;return null==e&&(e="raw"),null==t&&(t=o),e["$=="]("raw")&&(e=void 0),l(t["$nil?"]())&&(t=void 0),r.native_jspdf.output(e,t)},I.$$arity=-1),e.def(M,"$left_arrowhead",O=function(t,i){var s,c,l=this,u=o,f=o,$=o,p=o,d=o,h=o,_=o;return u=1,c=l.$apply_offset_to_point([t,i]),s=e.to_ary(c),f=null==s[0]?o:s[0],$=null==s[1]?o:s[1],p=f,d=n(f,u),h=n($,a(u,2)),_=r($,a(u,2)),l.native_jspdf.triangle(p,$,d,h,d,_,p,$,"FD")},O.$$arity=2),e.def(M,"$addPage",L=function(){return this.native_jspdf.addPage()},L.$$arity=0),M.$private(),e.def(M,"$apply_offset_to_point",P=function(e){var t=this;return[n(e.$first(),t.x_offset),n(e.$last(),t.y_offset)]},P.$$arity=1),o&&"apply_offset_to_point"}(s[0],0,s)},Opal.modules["opal-jszip"]=function(e){var t=(e.top,[]),r=e.nil,n=(e.const_get_qualified,e.const_get_relative),a=(e.breaker,e.slice,e.module),i=e.klass;return e.add_stubs(["$new","$to_blob"]),function(t,s){var o=a(t,"JSZip"),c=[o].concat(s);!function(t,a,s){var o,c,l,u,f,$,p=i(t,null,"ZipFile"),d=[p].concat(s);e.def(p,"$initialize",o=function(){return this.zip=new JSZip},o.$$arity=0),e.def(p,"$folder",c=function(e){var t=this;return n(d,"Folder").$new(t.zip.folder(e))},c.$$arity=1),e.def(p,"$file",l=function(e,t){return this.zip.file(e,t)},l.$$arity=2),e.def(p,"$to_blob",u=function(){return this.zip.generate({type:"blob"})},u.$$arity=0),e.def(p,"$to_blob_url",f=function(){var e=this,t=r;return t=e.$to_blob(),window.URL.createObjectURL(t)},f.$$arity=0),e.def(p,"$to_base64",$=function(){return this.zip.generate()},$.$$arity=0)}(c[0],0,c),function(t,r,n){var a,s,o=i(t,null,"Folder");[o].concat(n);e.def(o,"$initialize",a=function(e){return this.folder=e},a.$$arity=1),e.def(o,"$file",s=function(e,t){return this.folder.file(e,t)},s.$$arity=2)}(c[0],0,c)}(t[0],t)},Opal.modules.pdf_engine=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e*t:e["$*"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}function a(e,t){return"number"==typeof e&&"number"==typeof t?e/t:e["$/"](t)}var i=e.top,s=[],o=e.nil,c=e.const_get_qualified,l=e.const_get_relative,u=(e.breaker,e.slice,e.module),f=e.klass,$=e.hash2,p=e.gvars,d=e.send,h=e.truthy,_=e.range;return e.add_stubs(["$require","$include","$attr_reader","$new","$*","$[]","$last","$printer_config","$y_offset=","$-","$each","$draw_segment","$+","$first","$x_offset=","$draw_sheet","$addPage","$rect","$children","$line_width","$line_width=","$is_a?","$visible?","$draw_ellipse","$draw_flowline","$draw_glyph","$draw_path","$draw_annotation","$draw_image","$error","$class","$private","$get","$style","$text_color=","$font_size=","$font_style=","$align","$gsub","$text","$==","$split","$empty?","$center","$color","$filled?","$size","$stroke=","$fill=","$rect?","$rect_like_ellipse","$ellipse","$fill","$map","$/","$dotted?","$draw_the_dot","$hasbarover","$draw_the_barover","$glyph","$===","$lines","$push","$hasbarover?","$dashed?","$line_dash=","$line","$from","$to","$use_solid_lines","$clone","$[]=","$distance","$nil?","$level","$left_arrowhead","$Vector2d","$llpos","$height","$image","$url","$x","$y","$opacity","$line_cap=","$path","$inject","$flatten"]),i.$require("opal-jspdf"),i.$require("harpnotes"),function(i,s){var m=u(i,"Harpnotes"),y=[m].concat(s);!function(i,s,u){var m,y,g,v,b,x,w,A,k,E,S,N,C,I,O=f(i,null,"PDFEngine"),L=[O].concat(u);O.$$prototype.pdf=o,O.$include(c(l(L,"Harpnotes"),"Drawing")),O.$attr_reader("pdf"),e.const_set(L[0],"PADDING",4),e.const_set(L[0],"JUMPLINE_INDENT",10),e.const_set(L[0],"JUMPLINE_INDENT",10),e.const_set(L[0],"DOTTED_SIZE",.5),e.const_set(L[0],"COLORS",$(["black","white","grey","lightgrey","darkgrey","dimgrey"],{black:[0,0,0],white:[255,255,255],grey:[128,128,128],lightgrey:[211,211,211],darkgrey:[169,169,169],dimgrey:[105,105,105]})),e.def(O,"$initialize",m=function(){return this.pdf=l(L,"JsPDF").$new("l","mm","a3")},m.$$arity=0),e.def(O,"$draw_in_segments",y=function(a){var i,s,c=this,u=o,f=o,$=o,_=o;return null==p.conf&&(p.conf=o),u=t(-12,p.conf["$[]"]("layout.X_SPACING")),c.pdf=l(L,"JsPDF").$new("p","mm","a4"),f=[a.$printer_config()["$[]"]("a4_offset").$last()],d(c.pdf,"y_offset=",e.to_a(f)),f[r(f.length,1)],$=!1,_=h(i=a.$printer_config()["$[]"]("a4_pages"))?i:[0,1,2],d(_,"each",[],(s=function(e){var r=s.$$s||this;return null==e&&(e=o),r.$draw_segment(n(n(30,a.$printer_config()["$[]"]("a4_offset").$first()),t(e,u)),a,$),$=!0},s.$$s=c,s.$$arity=1,s)),c.pdf},y.$$arity=1),e.def(O,"$draw",g=function(t){var r,n,a=this;return n=t.$printer_config()["$[]"]("a3_offset"),r=e.to_ary(n),a.pdf["$x_offset="](null==r[0]?o:r[0]),a.pdf["$y_offset="](null==r[1]?o:r[1]),a.$draw_sheet(t)},g.$$arity=1),e.def(O,"$draw_segment",v=function(t,n,a){var i=this,s=o;return null==a&&(a=!1),s=[t],d(i.pdf,"x_offset=",e.to_a(s)),s[r(s.length,1)],h(a)&&i.pdf.$addPage(),i.$draw_sheet(n)},v.$$arity=-3),e.def(O,"$draw_sheet",b=function(t){var n,a=this;return h(t.$printer_config()["$[]"]("show_border"))&&(a.pdf.$rect(1,1,418,295),a.pdf.$rect(0,0,420,297)),d(t.$children(),"each",[],(n=function(t){var a=n.$$s||this,i=o;return null==a.pdf&&(a.pdf=o),null==p.log&&(p.log=o),null==t&&(t=o),i=[t.$line_width()],d(a.pdf,"line_width=",e.to_a(i)),i[r(i.length,1)],h(t["$is_a?"](l(L,"Ellipse")))?h(t["$visible?"]())?a.$draw_ellipse(t):o:h(t["$is_a?"](l(L,"FlowLine")))?h(t["$visible?"]())?a.$draw_flowline(t):o:h(t["$is_a?"](c(c(l(L,"Harpnotes"),"Drawing"),"Glyph")))?h(t["$visible?"]())?a.$draw_glyph(t):o:h(t["$is_a?"](c(c(l(L,"Harpnotes"),"Drawing"),"Path")))?h(t["$visible?"]())?a.$draw_path(t):o:h(t["$is_a?"](c(c(l(L,"Harpnotes"),"Drawing"),"Annotation")))?h(t["$visible?"]())?a.$draw_annotation(t):o:h(t["$is_a?"](c(c(l(L,"Harpnotes"),"Drawing"),"Image")))?a.$draw_image(t):(p.log.$error("BUG: don't know how to draw "+t.$class()+" ("+"./pdf_engine.rb".$force_encoding("US-ASCII")+" 74)"),o)},n.$$s=a,n.$$arity=1,n)),a.pdf},b.$$arity=1),O.$private(),e.def(O,"$draw_annotation",x=function(a){var i,s,c=this,l=o,u=o,f=o,_=o,m=o;return null==p.conf&&(p.conf=o),l=h(i=p.conf.$get("layout.FONT_STYLE_DEF")["$[]"](a.$style()))?i:p.conf.$get("layout.FONT_STYLE_DEF")["$[]"]("regular"),u=p.conf.$get("layout.MM_PER_POINT"),f=[l["$[]"]("text_color")],d(c.pdf,"text_color=",e.to_a(f)),f[r(f.length,1)],f=[t(l["$[]"]("font_size"),.983)],d(c.pdf,"font_size=",e.to_a(f)),f[r(f.length,1)],f=[l["$[]"]("font_style")],d(c.pdf,"font_style=",e.to_a(f)),f[r(f.length,1)],_=h(i=a.$align())?i:"left",m=d(a.$text(),"gsub",[/(\\?)(~)/],(s=function(e){s.$$s;return null==e&&(e=o),e["$[]"](0)["$=="]("\\")?e["$[]"](1):" "},s.$$s=c,s.$$arity=1,s)),m=m.$split("\n"),h(m["$empty?"]())&&(m=[""]),c.pdf.$text(a.$center().$first(),n(a.$center().$last(),t(l["$[]"]("font_size"),u)),m,$(["align"],{align:_}))},x.$$arity=1),e.def(O,"$draw_ellipse",w=function(t){var n,i=this,s=o,c=o,u=o,f=o;return s=l(L,"COLORS")["$[]"](t.$color()),c=function(){return h(t["$filled?"]())?"F":"FD"}(),u=t.$size(),f=[0],d(i.pdf,"line_width=",e.to_a(f)),f[r(f.length,1)],f=[s],d(i.pdf,"stroke=",e.to_a(f)),f[r(f.length,1)],f=[function(){return h(t["$filled?"]())?s:l(L,"COLORS")["$[]"]("white")}()],d(i.pdf,"fill=",e.to_a(f)),f[r(f.length,1)],h(t["$rect?"]())?i.pdf.$rect_like_ellipse(t.$center(),u,c):i.pdf.$ellipse(t.$center(),u,c),t.$fill()["$=="]("filled")||(f=[t.$line_width()],d(i.pdf,"line_width=",e.to_a(f)),f[r(f.length,1)],u=d(u,"map",[],(n=function(e){n.$$s;return null==e&&(e=o),r(e,a(t.$line_width(),2))},n.$$s=i,n.$$arity=1,n)),h(t["$rect?"]())?i.pdf.$rect_like_ellipse(t.$center(),u,c):i.pdf.$ellipse(t.$center(),u,c)),h(t["$dotted?"]())&&i.$draw_the_dot(t),h(t.$hasbarover())&&i.$draw_the_barover(t),f=[l(L,"COLORS")["$[]"]("black")],d(i.pdf,"stroke=",e.to_a(f)),f[r(f.length,1)],f=[l(L,"COLORS")["$[]"]("black")],d(i.pdf,"fill=",e.to_a(f)),f[r(f.length,1)]},w.$$arity=1),e.def(O,"$draw_glyph",A=function(i){var s,c,u,f=this,$=o,m=o,y=o,g=o,v=o,b=o,x=o,w=o;return i["$filled?"]("FD","FD"),$=[d(_(0,3,!0),"map",[],(s=function(){s.$$s;return h(i["$filled?"]())?0:128},s.$$s=f,s.$$arity=0,s))],d(f.pdf,"fill=",e.to_a($)),$[r($.length,1)],m=[r(i.$center().$first(),i.$size().$first()),r(i.$center().$last(),i.$size().$last())],m=[i.$center().$first(),i.$center().$last()],y=[t(i.$size().$first(),2),t(i.$size().$last(),2)],g=a(y.$last(),i.$glyph()["$[]"]("h")),[i.$glyph()["$[]"]("w"),i.$glyph()["$[]"]("h")],d([i.$glyph()["$[]"]("w"),i.$glyph()["$[]"]("h")],"map",[],(c=function(e){c.$$s;return null==e&&(e=o),t(a(e,2),g)},c.$$s=f,c.$$arity=1,c)),v=l(L,"COLORS")["$[]"]("white"),$=[v],d(f.pdf,"fill=",e.to_a($)),$[r($.length,1)],$=[v],d(f.pdf,"stroke=",e.to_a($)),$[r($.length,1)],f.pdf.$rect_like_ellipse(i.$center(),i.$size(),"FD"),v=l(L,"COLORS")["$[]"](i.$color()),$=[v],d(f.pdf,"fill=",e.to_a($)),$[r($.length,1)],$=[v],d(f.pdf,"stroke=",e.to_a($)),$[r($.length,1)],b=[g,g],x=[],w=[],$=[1e-4],d(f.pdf,"line_width=",e.to_a($)),$[r($.length,1)],d(i.$glyph()["$[]"]("d"),"each",[],(u=function(e){var r=u.$$s||this,a=o;return null==r.pdf&&(r.pdf=o),null==p.log&&(p.log=o),null==e&&(e=o),function(){return a=e.$first(),"M"["$==="](a)?(x=[],w=[n(m.$first(),t(e["$[]"](1),b.$first())),n(m.$last(),t(e["$[]"](2),b.$last()))],h(x["$empty?"]())?o:r.pdf.$lines(x,w.$first(),w.$last(),b,"FD",!1)):"l"["$==="](a)?x.$push(e["$[]"](_(1,-1,!1))):"m"["$==="](a)?x.$push(e["$[]"](_(1,-1,!1))):"c"["$==="](a)?x.$push(e["$[]"](_(1,-1,!1))):"z"["$==="](a)?(h(x["$empty?"]())||r.pdf.$lines(x,w.$first(),w.$last(),b,"FD",!0),x=[]):p.log.$error("BUG: unsupported Pdf Path command '"+e.$first()+"' in glyph ("+"./pdf_engine.rb".$force_encoding("US-ASCII")+" 195)")}()},u.$$s=f,u.$$arity=1,u)),$=[[0,0,0]],d(f.pdf,"stroke=",e.to_a($)),$[r($.length,1)],h(i["$dotted?"]())&&f.$draw_the_dot(i),h(i["$hasbarover?"]())?f.$draw_the_barover(i):o},A.$$arity=1),e.def(O,"$draw_the_dot",k=function(t){var a=this,i=o,s=o,c=o,u=o,f=o,$=o;return i=l(L,"COLORS")["$[]"](t.$color()),s=n(l(L,"DOTTED_SIZE"),t.$line_width()),c=n(l(L,"DOTTED_SIZE"),t.$line_width()),u=n(t.$center().$first(),n(t.$size().$first(),s)),f=t.$center().$last(),$=[0],d(a.pdf,"line_width=",e.to_a($)),$[r($.length,1)],$=[[255,255,255]],d(a.pdf,"fill=",e.to_a($)),$[r($.length,1)],$=[[255,255,255]],d(a.pdf,"stroke=",e.to_a($)),$[r($.length,1)],a.pdf.$ellipse([u,f],[c,c],"FD"),$=[i],d(a.pdf,"fill=",e.to_a($)),$[r($.length,1)],$=[i],d(a.pdf,"stroke=",e.to_a($)),$[r($.length,1)],a.pdf.$ellipse([u,f],[l(L,"DOTTED_SIZE"),l(L,"DOTTED_SIZE")],"FD")},k.$$arity=1),e.def(O,"$draw_the_barover",E=function(n){var a=this,i=o,s=o,c=o;return i=[l(L,"COLORS")["$[]"](n.$color())],d(a.pdf,"fill=",e.to_a(i)),i[r(i.length,1)],s=[n.$center().$first(),r(r(n.$center().$last(),n.$size().$last()),t(1.3,n.$line_width()))],c=[n.$size().$first(),.2],a.pdf.$rect_like_ellipse(s,c,"F")},E.$$arity=1),e.def(O,"$draw_flowline",S=function(t){var n=this,i=o,s=o;return i=l(L,"COLORS")["$[]"](t.$color()),s=[i],d(n.pdf,"stroke=",e.to_a(s)),s[r(s.length,1)],h(t["$dashed?"]())&&(s=[a(3,2.84)],d(n.pdf,"line_dash=",e.to_a(s)),s[r(s.length,1)]),h(t["$dotted?"]())&&(s=[a(1.5,2.84)],d(n.pdf,"line_dash=",e.to_a(s)),s[r(s.length,1)]),n.pdf.$line(t.$from().$center(),t.$to().$center()),n.pdf.$use_solid_lines()},S.$$arity=1),e.def(O,"$draw_jumpline",N=function(i){var s,c=this,u=o,f=o,$=o,p=o,m=o;return u=i.$from().$center().$clone(),f=[0,n(u["$[]"](0),l(L,"PADDING"))],d(u,"[]=",e.to_a(f)),f[r(f.length,1)],f=[1,r(u["$[]"](1),a(l(L,"PADDING"),4))],d(u,"[]=",e.to_a(f)),f[r(f.length,1)],$=i.$to().$center().$clone(),f=[0,n($["$[]"](0),l(L,"PADDING"))],d($,"[]=",e.to_a(f)),f[r(f.length,1)],f=[1,n($["$[]"](1),a(l(L,"PADDING"),4))],d($,"[]=",e.to_a(f)),f[r(f.length,1)],p=i.$distance(),m=h(p["$nil?"]())?r(418,t(i.$level(),l(L,"JUMPLINE_INDENT"))):n($["$[]"](0),p),f=[d(_(0,3,!0),"map",[],(s=function(){s.$$s;return 0},s.$$s=c,s.$$arity=0,s))],d(c.pdf,"stroke=",e.to_a(f)),f[r(f.length,1)],c.pdf.$line($,[m,$["$[]"](1)]),c.pdf.$line([m,$["$[]"](1)],[m,u["$[]"](1)]),c.pdf.$line([m,u["$[]"](1)],u),c.pdf.$left_arrowhead(u["$[]"](0),u["$[]"](1))},N.$$arity=1),e.def(O,"$draw_image",C=function(e){var t=this,r=o;return r=n(n(t.$Vector2d([0,0]),e.$llpos()),[0,e.$height()]),t.pdf.$image(e.$url(),r.$x(),r.$y(),e.$height(),e.$opacity())},C.$$arity=1),e.def(O,"$draw_path",I=function(t){var a,i=this,s=o,c=o,u=o,f=o,$=o,m=o;return s=[],c=[1,1],u=[],f=function(){return h(t["$filled?"]())?"FD":"S"}(),$=l(L,"COLORS")["$[]"](t.$color()),m=[function(){return h(t["$filled?"]())?$:l(L,"COLORS")["$[]"]("white")}()],d(i.pdf,"fill=",e.to_a(m)),m[r(m.length,1)],m=[$],d(i.pdf,"stroke=",e.to_a(m)),m[r(m.length,1)],m=["round"],d(i.pdf,"line_cap=",e.to_a(m)),m[r(m.length,1)],d(t.$path(),"each",[],(a=function(e){var t,i=a.$$s||this,l=o,$=o;return null==i.pdf&&(i.pdf=o),null==p.log&&(p.log=o),null==e&&(e=o),function(){return l=e.$first(),"M"["$==="](l)?(h(s["$empty?"]())||i.pdf.$lines(s,u.$first(),u.$last(),c,f,!1),s=[],u=e["$[]"](_(1,2,!1))):"L"["$==="](l)?($=d([[u],s].$flatten(1),"inject",[[0,0]],(t=function(e,r){t.$$s;return null==e&&(e=o),null==r&&(r=o),[n(r["$[]"](0),e["$[]"](-2)),n(r["$[]"](1),e["$[]"](-1))]},t.$$s=i,t.$$arity=2,t)),h(s["$empty?"]())||i.pdf.$lines(s,u.$first(),u.$last(),c,f,!1),s=[],u=$,s.$push([r(e["$[]"](1),$.$first()),r(e["$[]"](2),$.$last())])):"l"["$==="](l)?s.$push(e["$[]"](_(1,-1,!1))):"c"["$==="](l)?s.$push(e["$[]"](_(1,-1,!1))):"z"["$==="](l)?(h(s["$empty?"]())||i.pdf.$lines(s,u.$first(),u.$last(),c,"FD",!0),s=[]):p.log.$error("BUG: unsupported command '"+e.$first()+"' in glyph ("+"./pdf_engine.rb".$force_encoding("US-ASCII")+" 328)")}()},a.$$s=i,a.$$arity=1,a)),h(s["$empty?"]())?o:i.pdf.$lines(s,u.$first(),u.$last(),c,f,!1)},I.$$arity=1)}(y[0],0,y)}(s[0],s)},Opal.modules.init_conf=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}var r=(e.top,[]),n=e.nil,a=(e.const_get_qualified,e.const_get_relative),i=(e.breaker,e.slice,e.module),s=e.send,o=e.truthy,c=e.hash2,l=e.gvars,u=e.range;return e.add_stubs(["$join","$map","$each_with_index","$split","$between?","$lambda","$[]","$get","$cut_string_names","$year","$now","$t","$to_a","$first","$+","$last"]),function(r,f){var $,p,d=i(r,"InitConf"),h=[d].concat(f);e.defs(d,"$cut_string_names",$=function(e,t,r){var a,i=this;return s(e.$split(" ").$each_with_index(),"map",[],(a=function(e,i){a.$$s;return null==e&&(e=n),null==i&&(i=n),o(i["$between?"](t,r))?e:"~"},a.$$s=i,a.$$arity=2,a)).$join(" ")},$.$$arity=3),e.defs(d,"$init_conf",p=function(){var e,r,i,o,f,$,p,d,_,m,y,g,v,b,x,w,A,k,E,S,N,C,I,O,L,P,M,T,B,j,F,R,D=this,z=n;return z=["produce","annotations","restposition","default","repeatstart","repeatend","extract","title","filenamepart","startpos","voices","flowlines","subflowlines","synchlines","jumplines","repeatsigns","layoutlines","barnumbers","countnotes","legend","nonflowrest","lyrics","notes","images","tuplets","layout","printer","annotation","decoration","partname","variantend","countnote","c_jumplines","tuplet","minc","flowline","imagename","stringnames","limit_a3","LINE_THIN","LINE_MEDIUM","LINE_THICK","ELLIPSE_SIZE","REST_SIZE","DRAWING_AREA_SIZE","instrument","bottomup","beams","packer","pack_method","pack_max_spreadfactor","pack_min_increment","sortmark","show","fill","size","PITCH_OFFSET","X_OFFSET","X_SPACING","jumpline_anchor","jumpline_vcut","a3_offset","a4_offset","a4_pages","T01_number","T01_number_extract","T02_copyright_music","T03_copyright_harpnotes","T04_to_order","T05_printed_extracts","T99_do_not_copy","0","1","2","3","4","5","6","verses","cp1","cp2","shape","pos","hpos","height","vpos","spos","autopos","apbase","text","style","marks","resources","d64","d48","d32","d24","d16","d12","d8","d6","d4","d3","d2","d1"],c(["produce","abc_parser","restposition","template","wrap","defaults","templates","presets","annotations","extract","layout","neatjson"],{produce:[0],abc_parser:"ABC2SVG",restposition:c(["default","repeatstart","repeatend"],{default:"center",repeatstart:"next",repeatend:"default"}),template:c(["filebase","title"],{filebase:"-no-template-",title:"- no template -"}),wrap:60,defaults:c(["notebound"],{notebound:c(["annotation","partname","variantend","tuplet","flowline"],{annotation:c(["pos"],{pos:[5,-7]}),partname:c(["pos"],{pos:[-4,-7]}),variantend:c(["pos"],{pos:[-4,-7]}),tuplet:c(["cp1","cp2","shape","show"],{cp1:[5,2],cp2:[5,-2],shape:["c"],show:!0}),flowline:c(["cp1","cp2","shape","show"],{cp1:[0,10],cp2:[0,-10],shape:["c"],show:!0})})}),templates:c(["notes","lyrics","images","tuplet","annotations","extracts"],{notes:c(["pos","text","style"],{pos:[320,6],text:"ENTER_NOTE",style:"large"}),lyrics:c(["verses","pos","style"],{verses:[1],pos:[350,70],style:"regular"}),images:c(["imagename","show","pos","height"],{imagename:"",show:!0,pos:[10,10],height:100}),tuplet:c(["cp1","cp2","shape","show"],{cp1:[5,2],cp2:[5,-2],shape:["c"],show:!0}),annotations:c(["text","pos"],{text:"_vorlage_",pos:[-5,-6]}),extracts:c(["title","filenamepart","notes"],{title:"",filenamepart:"-",notes:c(["T01_number_extract"],{T01_number_extract:c(["text"],{text:"{{extract_filename}}"})})})}),presets:c(["barnumbers_countnotes","stdextract","layout","instrument","notes","printer"],{barnumbers_countnotes:c(["anchor_at_box","anchor_at_center"],{anchor_at_box:c(["barnumbers","countnotes"],{barnumbers:c(["apanchor","apbase"],{apanchor:"box",apbase:[1,1]}),countnotes:c(["apanchor","apbase"],{apanchor:"box",apbase:[1,-.5]})}),anchor_at_center:c(["barnumbers","countnotes"],{barnumbers:c(["apanchor","apbase"],{apanchor:"center",apbase:[1,.3]}),countnotes:c(["apanchor","apbase"],{apanchor:"center",apbase:[1,0]})})}),stdextract:c([],{}),layout:c(["notes_small","notes_regular","notes_large","notes_with_beams","-","packer_compact","packer_regular","--","color_on","color_off","---","jumpline_anchor_close","jumpline_anchor_medium","jumpline_anchor_wide","jumpline_open","jumpline_close"],{notes_small:c(["LINE_MEDIUM","LINE_THICK","ELLIPSE_SIZE","REST_SIZE","beams"],{LINE_MEDIUM:.2,LINE_THICK:.3,ELLIPSE_SIZE:[3.5,1.3],REST_SIZE:[4,1.5],beams:!1}),notes_regular:c(["LINE_MEDIUM","LINE_THICK","ELLIPSE_SIZE","REST_SIZE","beams"],{LINE_MEDIUM:s(D,"lambda",[],(e=function(){e.$$s;return null==l.conf&&(l.conf=n),l.conf["$[]"]("extract.0.layout.LINE_MEDIUM")},e.$$s=D,e.$$arity=0,e)),LINE_THICK:s(D,"lambda",[],(r=function(){r.$$s;return null==l.conf&&(l.conf=n),l.conf["$[]"]("extract.0.layout.LINE_THICK")},r.$$s=D,r.$$arity=0,r)),ELLIPSE_SIZE:s(D,"lambda",[],(i=function(){i.$$s;return null==l.conf&&(l.conf=n),l.conf["$[]"]("extract.0.layout.ELLIPSE_SIZE")},i.$$s=D,i.$$arity=0,i)),REST_SIZE:s(D,"lambda",[],(o=function(){o.$$s;return null==l.conf&&(l.conf=n),l.conf["$[]"]("extract.0.layout.REST_SIZE")},o.$$s=D,o.$$arity=0,o)),beams:!1}),notes_large:c(["LINE_MEDIUM","LINE_THICK","ELLIPSE_SIZE","REST_SIZE","beams"],{LINE_MEDIUM:.3,LINE_THICK:.7,ELLIPSE_SIZE:[4,2],REST_SIZE:[4,2],beams:!1}),notes_with_beams:c(["LINE_THIN","LINE_MEDIUM","LINE_THICK","ELLIPSE_SIZE","REST_SIZE","beams"],{LINE_THIN:.1,LINE_MEDIUM:.2,LINE_THICK:.5,ELLIPSE_SIZE:[1.3,1],REST_SIZE:[2,1.3],beams:!0}),"-":c([],{}),packer_compact:c(["packer"],{packer:c(["pack_method","pack_max_spreadfactor","pack_min_increment"],{pack_method:1,pack_max_spreadfactor:2,pack_min_increment:.2})}),packer_regular:c(["packer"],{packer:s(D,"lambda",[],(f=function(){f.$$s;return null==l.conf&&(l.conf=n),l.conf.$get("extract.0.layout.packer")},f.$$s=D,f.$$arity=0,f))}),"--":c([],{}),color_on:c(["color"],{color:c(["color_default","color_variant1","color_variant2"],{color_default:"black",color_variant1:"grey",color_variant2:"darkgrey"})}),color_off:c(["color"],{color:c(["color_default","color_variant1","color_variant2"],{color_default:"black",color_variant1:"black",color_variant2:"black"})}),"---":c([],{}),jumpline_anchor_close:c(["jumpline_anchor"],{jumpline_anchor:[3,1]}),jumpline_anchor_medium:c(["jumpline_anchor"],{jumpline_anchor:[5,1]}),jumpline_anchor_wide:c(["jumpline_anchor"],{jumpline_anchor:[10,1]}),jumpline_open:c(["jumpline_vcut"],{jumpline_vcut:3}),jumpline_close:c(["jumpline_vcut"],{jumpline_vcut:0})}),instrument:c(["37-strings-g-g","25-strings-g-g","25-strings-G-g Bass","21-strings-a-f","18-strings-b-e","saitenspiel","Zipino","Okon-Harfe"],{"37-strings-g-g":c(["layout","stringnames","printer"],{layout:c(["instrument","limit_a3","beams","bottomup","PITCH_OFFSET","X_SPACING","X_OFFSET"],{instrument:"37-strings-g-g",limit_a3:!0,beams:!1,bottomup:!1,PITCH_OFFSET:s(D,"lambda",[],($=function(){$.$$s;return null==l.conf&&(l.conf=n),l.conf["$[]"]("extract.0.layout.PITCH_OFFSET")},$.$$s=D,$.$$arity=0,$)),X_SPACING:s(D,"lambda",[],(p=function(){p.$$s;return null==l.conf&&(l.conf=n),l.conf["$[]"]("extract.0.layout.X_SPACING")},p.$$s=D,p.$$arity=0,p)),X_OFFSET:s(D,"lambda",[],(d=function(){d.$$s;return null==l.conf&&(l.conf=n),l.conf["$[]"]("extract.0.layout.X_OFFSET")},d.$$s=D,d.$$arity=0,d))}),stringnames:c(["text","marks"],{text:s(D,"lambda",[],(_=function(){_.$$s;return null==l.conf&&(l.conf=n),l.conf["$[]"]("extract.0.stringnames.text")},_.$$s=D,_.$$arity=0,_)),marks:c(["hpos"],{hpos:[43,79]})}),printer:c(["a4_pages","a4_offset","a3_offset"],{a4_pages:[0,1,2],a4_offset:s(D,"lambda",[],(m=function(){m.$$s;return null==l.conf&&(l.conf=n),l.conf["$[]"]("extract.0.printer.a4_offset")},m.$$s=D,m.$$arity=0,m)),a3_offset:s(D,"lambda",[],(y=function(){y.$$s;return null==l.conf&&(l.conf=n),l.conf["$[]"]("extract.0.printer.a3_offset")},y.$$s=D,y.$$arity=0,y))})}),"25-strings-g-g":c(["layout","stringnames","printer"],{layout:c(["instrument","limit_a3","beams","bottomup","PITCH_OFFSET","X_SPACING","X_OFFSET"],{instrument:"25-strings-g-g",limit_a3:!1,beams:!1,bottomup:!1,PITCH_OFFSET:s(D,"lambda",[],(g=function(){g.$$s;return null==l.conf&&(l.conf=n),l.conf["$[]"]("extract.0.layout.PITCH_OFFSET")},g.$$s=D,g.$$arity=0,g)),X_SPACING:s(D,"lambda",[],(v=function(){v.$$s;return null==l.conf&&(l.conf=n),l.conf["$[]"]("extract.0.layout.X_SPACING")},v.$$s=D,v.$$arity=0,v)),X_OFFSET:s(D,"lambda",[],(b=function(){b.$$s;return null==l.conf&&(l.conf=n),l.conf["$[]"]("extract.0.layout.X_OFFSET")},b.$$s=D,b.$$arity=0,b))}),stringnames:c(["text","marks"],{text:s(D,"lambda",[],(x=function(){var e=x.$$s||this;return null==l.conf&&(l.conf=n),e.$cut_string_names(l.conf["$[]"]("extract.0.stringnames.text"),12,36)},x.$$s=D,x.$$arity=0,x)),marks:c(["hpos"],{hpos:[55,79]})}),printer:c(["a4_pages","a3_offset","a4_offset"],{a4_pages:[1,2],a3_offset:[-5,0],a4_offset:s(D,"lambda",[],(w=function(){w.$$s;return null==l.conf&&(l.conf=n),l.conf["$[]"]("extract.0.printer.a4_offset")},w.$$s=D,w.$$arity=0,w))})}),"25-strings-G-g Bass":c(["layout","stringnames","printer"],{layout:c(["instrument","limit_a3","beams","bottomup","PITCH_OFFSET","X_SPACING","X_OFFSET"],{instrument:"25-strings-g-g",limit_a3:!1,beams:!1,bottomup:!1,PITCH_OFFSET:s(D,"lambda",[],(A=function(){A.$$s;return-31},A.$$s=D,A.$$arity=0,A)),X_SPACING:s(D,"lambda",[],(k=function(){k.$$s;return null==l.conf&&(l.conf=n),l.conf["$[]"]("extract.0.layout.X_SPACING")},k.$$s=D,k.$$arity=0,k)),X_OFFSET:s(D,"lambda",[],(E=function(){E.$$s;return null==l.conf&&(l.conf=n),l.conf["$[]"]("extract.0.layout.X_OFFSET")},E.$$s=D,E.$$arity=0,E))}),stringnames:c(["text","marks"],{text:s(D,"lambda",[],(S=function(){var e=S.$$s||this;return null==l.conf&&(l.conf=n),e.$cut_string_names(l.conf["$[]"]("extract.0.stringnames.text"),12,36)},S.$$s=D,S.$$arity=0,S)),marks:c(["hpos"],{hpos:[43,67]})}),printer:c(["a4_pages","a3_offset","a4_offset"],{a4_pages:[1,2],a3_offset:[-5,0],a4_offset:s(D,"lambda",[],(N=function(){N.$$s;return null==l.conf&&(l.conf=n),l.conf["$[]"]("extract.0.printer.a4_offset")},N.$$s=D,N.$$arity=0,N))})}),"21-strings-a-f":c(["layout","stringnames","printer"],{layout:c(["instrument","limit_a3","beams","bottomup","PITCH_OFFSET","X_SPACING","X_OFFSET"],{instrument:"21-strings-a-f",limit_a3:!1,beams:!1,bottomup:!1,PITCH_OFFSET:s(D,"lambda",[],(C=function(){C.$$s;return null==l.conf&&(l.conf=n),l.conf["$[]"]("extract.0.layout.PITCH_OFFSET")},C.$$s=D,C.$$arity=0,C)),X_SPACING:s(D,"lambda",[],(I=function(){I.$$s;return null==l.conf&&(l.conf=n),l.conf["$[]"]("extract.0.layout.X_SPACING")},I.$$s=D,I.$$arity=0,I)),X_OFFSET:23}),stringnames:c(["text","marks"],{text:s(D,"lambda",[],(O=function(){var e=O.$$s||this;return null==l.conf&&(l.conf=n),e.$cut_string_names(l.conf["$[]"]("extract.0.stringnames.text"),14,34)},O.$$s=D,O.$$arity=0,O)),marks:c(["hpos"],{hpos:[57,77]})}),printer:c(["a4_pages","a3_offset","a4_offset"],{a4_pages:[1,2],a3_offset:[-5,0],a4_offset:s(D,"lambda",[],(L=function(){L.$$s;return null==l.conf&&(l.conf=n),l.conf["$[]"]("extract.0.printer.a4_offset")},L.$$s=D,L.$$arity=0,L))})}),"18-strings-b-e":c(["layout","stringnames","printer"],{layout:c(["instrument","limit_a3","beams","bottomup","PITCH_OFFSET","X_SPACING","X_OFFSET"],{instrument:"18-strings-b-e",limit_a3:!1,beams:!1,bottomup:!1,PITCH_OFFSET:s(D,"lambda",[],(P=function(){P.$$s;return null==l.conf&&(l.conf=n),l.conf["$[]"]("extract.0.layout.PITCH_OFFSET")},P.$$s=D,P.$$arity=0,P)),X_SPACING:s(D,"lambda",[],(M=function(){M.$$s;return null==l.conf&&(l.conf=n),l.conf["$[]"]("extract.0.layout.X_SPACING")},M.$$s=D,M.$$arity=0,M)),X_OFFSET:28.5}),stringnames:c(["text","marks"],{text:s(D,"lambda",[],(T=function(){var e=T.$$s||this;return null==l.conf&&(l.conf=n),e.$cut_string_names(l.conf["$[]"]("extract.0.stringnames.text"),16,33)},T.$$s=D,T.$$arity=0,T)),marks:c(["hpos"],{hpos:[59,76]})}),printer:c(["a4_pages","a3_offset","a4_offset"],{a4_pages:[2],a3_offset:[0,0],a4_offset:[40,0]})}),saitenspiel:c(["layout","stringnames","printer"],{layout:c(["instrument","limit_a3","beams","bottomup","PITCH_OFFSET","X_SPACING","X_OFFSET"],{instrument:"saitenspiel",limit_a3:!1,beams:!1,bottomup:!1,PITCH_OFFSET:-24,X_SPACING:14.5,X_OFFSET:240}),stringnames:c(["text","marks"],{text:"G C D E F G A B C D  ~ ~ ~ ~ ~ ~ ~",marks:c(["hpos"],{hpos:[55,74]})}),printer:c(["a4_pages","a3_offset","a4_offset"],{a4_pages:[2],a3_offset:[0,0],a4_offset:[35,0]})}),Zipino:c(["layout","stringnames","printer"],{layout:c(["instrument","limit_a3","beams","bottomup","PITCH_OFFSET","X_SPACING","X_OFFSET","ELLIPSE_SIZE","REST_SIZE"],{instrument:"Zipino",limit_a3:!0,beams:!0,bottomup:!1,PITCH_OFFSET:0,X_SPACING:12.5,X_OFFSET:230,ELLIPSE_SIZE:[2,2],REST_SIZE:[2,2]}),stringnames:c(["text","marks"],{text:"F# G A B C D E F# G A B C D E F# ~ ~ ~ ~ ~ ~  ~",marks:c(["hpos"],{hpos:[54]})}),printer:c(["a4_pages","a3_offset","a4_offset"],{a4_pages:[2],a3_offset:[0,0],a4_offset:[35,0]})}),"Okon-Harfe":c(["layout","stringnames","printer"],{layout:c(["instrument","beams","bottomup","limit_a3","PITCH_OFFSET","X_SPACING","X_OFFSET"],{instrument:"okon-f",beams:!0,bottomup:!0,limit_a3:!1,PITCH_OFFSET:0,X_SPACING:15,X_OFFSET:50}),stringnames:c(["text","marks"],{text:"G A B C D E F G A B C D E F G A B C ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~",marks:c(["hpos"],{hpos:[55,74]})}),printer:c(["a4_pages","a3_offset","a4_offset"],{a4_pages:[1,2],a3_offset:[-35,0],a4_offset:[70,0]})})}),notes:c(["T01_number","T01_number_extract","T01_number_extract_value","T02_copyright_music","T03_copyright_harpnotes","T04_to_order","T05_printed_extracts","T06_legend","T99_do_not_copy","T01_T99"],{T01_number:c(["value"],{value:c(["pos","text","style","align"],{pos:[410,17],text:"XXX-{{number}}",style:"bold",align:"l"})}),T01_number_extract:c(["value"],{value:c(["pos","text","style"],{pos:[411,17],text:"{{extract_filename}}",style:"bold"})}),T01_number_extract_value:c(["key","value"],{key:"T01_number_extract",value:c(["text"],{text:"{{extract_filename}}"})}),T02_copyright_music:c(["value"],{value:c(["pos","text","style"],{pos:[340,251],text:s(D,"lambda",[],(B=function(){B.$$s;return" "+a(h,"Time").$now().$year()+"\n"+a(h,"I18n").$t("Private copy")},B.$$s=D,B.$$arity=0,B)),style:"small"})}),T03_copyright_harpnotes:c(["value"],{value:c(["pos","text","style"],{pos:[340,260],text:" "+a(h,"Time").$now().$year()+" Notenbild: zupfnoter.de",style:"small"})}),T04_to_order:c(["value"],{value:c(["pos","text","style"],{pos:[340,242],text:s(D,"lambda",[],(j=function(){j.$$s;return a(h,"I18n").$t("provided by\n")},j.$$s=D,j.$$arity=0,j)),style:"small"})}),T05_printed_extracts:c(["value"],{value:c(["pos","text","style","align"],{pos:[410,22],text:"{{printed_extracts}}",style:"smaller",align:"l"})}),T06_legend:c(["value"],{value:c(["pos","text","style"],{pos:[360,30],text:"{{extract_title}}\n{{composer}}\nTakt: {{meter}} ({{tempo}})\nTonart: {{key}}",style:"small"})}),T99_do_not_copy:c(["value"],{value:c(["pos","text","style"],{pos:[380,284],text:s(D,"lambda",[],(F=function(){F.$$s;return a(h,"I18n").$t("Please do not copy")},F.$$s=D,F.$$arity=0,F)),style:"small_bold"})}),T01_T99:c(["value"],{value:c([],{})})}),printer:c(["printer_left","printer_centric","printer_right"],{printer_left:c(["printer","layout"],{printer:c(["a3_offset","a4_offset","show_border"],{a3_offset:[-10,0],a4_offset:[-5,0],show_border:!1}),layout:c(["limit_a3"],{limit_a3:!1})}),printer_centric:c(["printer","layout"],{printer:c(["a3_offset","a4_offset","show_border"],{a3_offset:[0,0],a4_offset:[5,0],show_border:!1}),layout:c(["limit_a3"],{limit_a3:!0})}),printer_right:c(["printer","layout"],{printer:c(["a3_offset","a4_offset","show_border"],{a3_offset:[10,0],a4_offset:[5,0],show_border:!1}),layout:c(["limit_a3"],{limit_a3:!1})})})}),annotations:c(["vl","vt","vr"],{vl:c(["text","pos"],{text:"v",pos:[-5,-5]}),vt:c(["text","pos"],{text:"v",pos:[-1,-5]}),vr:c(["text","pos"],{text:"v",pos:[2,-5]})}),extract:c(["0","1","2","3","4","5"],{0:c(["title","startpos","voices","synchlines","flowlines","subflowlines","jumplines","repeatsigns","layoutlines","legend","lyrics","images","layout","sortmark","nonflowrest","notes","tuplets","barnumbers","countnotes","stringnames","printer"],{title:"alle Stimmen",startpos:15,voices:[1,2,3,4],synchlines:[[1,2],[3,4]],flowlines:[1,3],subflowlines:[2,4],jumplines:[1,3],repeatsigns:c(["voices","left","right"],{voices:[],left:c(["pos","text","style"],{pos:[-7,-2],text:"|:",style:"bold"}),right:c(["pos","text","style"],{pos:[5,-2],text:":|",style:"bold"})}),layoutlines:[1,2,3,4],legend:c(["spos","pos"],{spos:[320,27],pos:[320,7]}),lyrics:c([],{}),images:c([],{}),layout:c(["limit_a3","bottomup","beams","jumpline_anchor","color","LINE_THIN","LINE_MEDIUM","LINE_THICK","PITCH_OFFSET","X_SPACING","X_OFFSET","ELLIPSE_SIZE","REST_SIZE","DRAWING_AREA_SIZE","instrument","packer"],{limit_a3:!0,bottomup:!1,beams:!1,jumpline_anchor:[3,1],color:c(["color_default","color_variant1","color_variant2"],{color_default:"black",color_variant1:"grey",color_variant2:"dimgrey"}),LINE_THIN:.1,LINE_MEDIUM:.3,LINE_THICK:.5,PITCH_OFFSET:-43,X_SPACING:11.5,X_OFFSET:2.8,ELLIPSE_SIZE:[3.5,1.7],REST_SIZE:[4,2],DRAWING_AREA_SIZE:[400,282],instrument:"37-strings-g-g",packer:c(["pack_method","pack_max_spreadfactor","pack_min_increment"],{pack_method:0,pack_max_spreadfactor:2,pack_min_increment:.2})}),sortmark:c(["size","fill","show"],{size:[2,4],fill:!0,show:!1}),nonflowrest:!1,notes:c([],{}),tuplets:c(["text"],{text:"{{tuplet}}"}),barnumbers:c(["voices","pos","autopos","apanchor","apbase","style","prefix"],{voices:[],pos:[6,-4],autopos:!0,apanchor:"box",apbase:[1,1],style:"small_bold",
prefix:""}),countnotes:c(["voices","pos","autopos","apbase","apanchor","style"],{voices:[],pos:[3,-2],autopos:!0,apbase:[1,-.5],apanchor:"box",style:"smaller"}),stringnames:c(["text","vpos","style","marks"],{text:"G G# A A# B C C# D D# E F F# G G# A A# B C C# D D# E F F# G G# A A# B C C# D D# E F F# G",vpos:[],style:"small",marks:c(["vpos","hpos"],{vpos:[11],hpos:[43,55,79]})}),printer:c(["a3_offset","a4_offset","a4_pages","show_border"],{a3_offset:[0,0],a4_offset:[-5,0],a4_pages:[0,1,2],show_border:!1})}),1:c(["title","voices"],{title:"Sopran, Alt",voices:[1,2]}),2:c(["title","voices"],{title:"Tenor, Bass",voices:[3,4]}),3:c(["title","voices"],{title:"Melodie",voices:[1]}),4:c(["title","voices"],{title:"Extract 4",voices:[1]}),5:c(["title","voices"],{title:"Extract 5",voices:[1]})}),layout:c(["grid","limit_a3","SHOW_SLUR","LINE_THIN","LINE_MEDIUM","LINE_THICK","ELLIPSE_SIZE","REST_SIZE","X_SPACING","X_OFFSET","Y_SCALE","DRAWING_AREA_SIZE","BEAT_RESOLUTION","SHORTEST_NOTE","BEAT_PER_DURATION","PITCH_OFFSET","FONT_STYLE_DEF","MM_PER_POINT","DURATION_TO_STYLE","DURATION_TO_BEAMS","REST_TO_GLYPH"],{grid:!1,limit_a3:!0,SHOW_SLUR:!1,LINE_THIN:.1,LINE_MEDIUM:.3,LINE_THICK:.5,ELLIPSE_SIZE:[3.5,1.7],REST_SIZE:[4,2],X_SPACING:11.5,X_OFFSET:2.8,Y_SCALE:4,DRAWING_AREA_SIZE:[400,282],BEAT_RESOLUTION:192,SHORTEST_NOTE:64,BEAT_PER_DURATION:3,PITCH_OFFSET:-43,FONT_STYLE_DEF:c(["bold","italic","large","regular","small_bold","small_italic","small","smaller"],{bold:c(["text_color","font_size","font_style"],{text_color:[0,0,0],font_size:12,font_style:"bold"}),italic:c(["text_color","font_size","font_style"],{text_color:[0,0,0],font_size:12,font_style:"italic"}),large:c(["text_color","font_size","font_style"],{text_color:[0,0,0],font_size:20,font_style:"bold"}),regular:c(["text_color","font_size","font_style"],{text_color:[0,0,0],font_size:12,font_style:"normal"}),small_bold:c(["text_color","font_size","font_style"],{text_color:[0,0,0],font_size:9,font_style:"bold"}),small_italic:c(["text_color","font_size","font_style"],{text_color:[0,0,0],font_size:9,font_style:"italic"}),small:c(["text_color","font_size","font_style"],{text_color:[0,0,0],font_size:9,font_style:"normal"}),smaller:c(["text_color","font_size","font_style"],{text_color:[0,0,0],font_size:6,font_style:"normal"})}),MM_PER_POINT:.3,DURATION_TO_STYLE:c(["err","d64","d48","d32","d24","d16","d12","d8","d6","d4","d3","d2","d1"],{err:[2,"filled",!1],d64:[1,"empty",!1],d48:[.75,"empty",!0],d32:[.75,"empty",!1],d24:[.75,"filled",!0],d16:[.75,"filled",!1],d12:[.5,"filled",!0],d8:[.5,"filled",!1],d6:[.3,"filled",!0],d4:[.3,"filled",!1],d3:[.1,"filled",!0],d2:[.1,"filled",!1],d1:[.05,"filled",!1]}),DURATION_TO_BEAMS:c(["d64","d48","d32","d24","d16","d12","d8","d6","d4","d3","d2","d1"],{d64:[1,"empty",!1],d48:[1,"empty",!0,0],d32:[1,"empty",!1,0],d24:[1,"filled",!0,0],d16:[1,"filled",!1,0],d12:[1,"filled",!0,1],d8:[1,"filled",!1,1],d6:[1,"filled",!0,2],d4:[1,"filled",!1,2],d3:[1,"filled",!0,3],d2:[1,"filled",!1,3],d1:[1,"filled",!1,4]}),REST_TO_GLYPH:c(["err","d64","d48","d32","d24","d16","d12","d8","d6","d4","d3","d2","d1"],{err:[[2,2],"rest_1",!1],d64:[[1,.8],"rest_1",!1],d48:[[.5,.4],"rest_1",!0],d32:[[.5,.4],"rest_1",!1],d24:[[.4,.75],"rest_4",!0],d16:[[.4,.75],"rest_4",!1],d12:[[.4,.5],"rest_8",!0],d8:[[.4,.5],"rest_8",!1],d6:[[.4,.3],"rest_16",!0],d4:[[.3,.3],"rest_16",!1],d3:[[.3,.5],"rest_32",!0],d2:[[.3,.5],"rest_32",!1],d1:[[.3,.5],"rest_64",!1]})}),neatjson:c(["wrap","aligned","after_comma","after_colon_1","after_colon_n","before_colon_n","short","afterComma","afterColon1","afterColonN","beforeColonN","decimals","explicit_sort"],{wrap:60,aligned:!0,after_comma:1,after_colon_1:1,after_colon_n:1,before_colon_n:1,short:!1,afterComma:1,afterColon1:1,afterColonN:1,beforeColonN:1,decimals:2,explicit_sort:a(h,"Hash")["$[]"](s(z.$each_with_index().$to_a(),"map",[],(R=function(e){R.$$s;return null==e&&(e=n),[e.$first(),t("_",("000"+e.$last())["$[]"](u(-4,-1,!1)))]},R.$$s=D,R.$$arity=1,R)))})})},p.$$arity=0)}(r[0],r),e.const_set(r[0],"DBX_APIKEY_FULL","zwydv2vbgp30e05"),e.const_set(r[0],"DBX_APIKEY_APP","xr3zna7wrp75zax"),e.const_set(r[0],"CONFIG_SEPARATOR","%%%%zupfnoter.config")},Opal.modules.text_pane=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}var a=(e.top,[]),i=e.nil,s=e.const_get_qualified,o=e.const_get_relative,c=(e.breaker,e.slice,e.module),l=e.klass,u=e.hash2,f=e.truthy,$=e.send,p=e.gvars,d=e.range;return e.add_stubs(["$attr_accessor","$reset","$push","$[]","$pop","$empty?","$reverse","$flatten","$lambda","$new","$_clean_models","$create_lyrics_editor","$from_lyrics","$on","$Native","$getSession","$save_to_localstorage","$clear_markers","$call","$editor","$raise","$t","$==","$gsub","$get_selection_positions","$min","$first","$max","$last","$strip","$_get_abc_from_editor","$+","$_get_config_json","$_has_resources?","$_get_resources_json","$_split_parts","$map","$-","$set_markers","$to_n","$each","$add_marker","$join","$split","$<<","$clear","$_get_config_model","$scan","$to_s","$[]=","$do","$_set_config_model","$get","$set_config_model","$_set_config_json","$token","$get_selection_info","$type","$replace_range","$startpos","$endpos","$start_with?","$delete","$deep_dup","$get_lyrics_raw","$>","$count","$get_abc_part","$error","$clear_errors","$get_lyrics","$replace_text","$call_consumers","$nil?","$_set_abc_to_editor","$_set_resources_json","$set_text","$parse","$select","$clean_localstorage","$each_with_index","$benchmark","$neat_generate","$undo","$info","$dig","$redo","$undo_history","$redo_history","$!"]),function(a,h){var _=c(a,"Harpnotes"),m=[_].concat(h);!function(a,c,h){var _,m,y,g,v,b,x,w,A,k,E,S,N,C,I,O,L,P,M,T,B,j,F,R,D,z,q,U,H,G,Y,V,Q,X,W,J,K,Z,ee,te,re,ne,ae,ie,se,oe,ce,le,ue,fe,$e,pe,de,he,_e,me,ye,ge,ve,be=l(a,null,"TextPane"),xe=[be].concat(h);be.$$prototype.editor=be.$$prototype.range=be.$$prototype.config_separator=be.$$prototype.markers=be.$$prototype.config_models=be.$$prototype.dirty=be.$$prototype.config_undo=be.$$prototype.on_change=be.$$prototype.lyrics_editor=be.$$prototype.controller=be.$$prototype.handle_from_lyrics=i,be.$attr_accessor("editor","controller","autofold"),function(t,r,n){var a,s,o,c,$,p,d,h=l(t,null,"UndoManager");[h].concat(n);h.$$prototype.undostack=h.$$prototype.currentstate=h.$$prototype.redostack=i,e.def(h,"$initialize",a=function(){return this.$reset()},a.$$arity=0),e.def(h,"$reset",s=function(){var e=this;return e.undostack=[],e.redostack=[],e.currentstate=u(["title","state"],{title:"init state",state:u([],{})})},s.$$arity=0),e.def(h,"$do",o=function(e,t){var r=this;return r.undostack.$push(r.currentstate),r.redostack=[],r.currentstate=u(["title","state"],{title:t,state:e}),r.currentstate},o.$$arity=2),e.def(h,"$undo",c=function(){var e=this,t=i;return f(e.undostack["$[]"](1))?(t=e.undostack.$pop(),e.redostack.$push(e.currentstate),e.currentstate=t):i},c.$$arity=0),e.def(h,"$redo",$=function(){var e=this,t=i;return f(e.redostack["$empty?"]())?i:(t=e.redostack.$pop(),e.undostack.$push(e.currentstate),e.currentstate=t)},$.$$arity=0),e.def(h,"$undo_history",p=function(){var e=this;return[e.undostack,e.currentstate].$flatten().$reverse()},p.$$arity=0),e.def(h,"$redo_history",d=function(){return[this.redostack].$flatten().$reverse()},d.$$arity=0)}(xe[0],0,xe),e.def(be,"$initialize",_=function(e){var t,r=this,n=ace.require("ace/ext/language_tools");n.setCompleters([n.snippetCompleter]);var a=ace.edit(e);return a.commands.bindKey("Cmd-L",null),a.commands.bindKey("Ctrl-L",null),a.commands.bindKey("Ctrl-P",null),a.commands.bindKey("Ctrl-K",null),a.$blockScrolling=1/0,a.getSession().setMode("ace/mode/abc"),a.setTheme("ace/theme/abc"),a.setOptions({highlightActiveLine:!0,enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!1}),r.editor=a,r.range=ace.require("ace/range").Range,r.inhibit_callbacks=!1,r.markers=[],r.autofold=!0,r.on_change=$(r,"lambda",[],(t=function(){t.$$s;return i},t.$$s=r,t.$$arity=0,t)),r.config_separator="%%%%zupfnoter",r.dirty=u([],{}),r.config_undo=o(xe,"UndoManager").$new(),r.$_clean_models(),r.$create_lyrics_editor("abcLyrics")},_.$$arity=1),e.def(be,"$create_lyrics_editor",m=function(e){var t=this,r=ace.require("ace/ext/language_tools");r.setCompleters([r.snippetCompleter]);var n=ace.edit(e);return n.$blockScrolling=1/0,n.getSession().setMode("ace/mode/markdown"),n.setTheme("ace/theme/abc"),n.setOptions({highlightActiveLine:!0,enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!1}),n.on("change",function(){t.$from_lyrics()}),t.lyrics_editor=n,t.lyrics_range=ace.require("ace/range").Range,t.lyrics_inhibit_callbacks=!1,t.lyrics_markers=[]},m.$$arity=1),e.def(be,"$on_change",y=function(){var e,t=y.$$p,r=t||i,n=this;return t&&(y.$$p=null),t&&(y.$$p=null),n.on_change=r,$(n.$Native(n.$Native(n.editor).$getSession()),"on",["change"],(e=function(t){var r=e.$$s||this;return null==r.on_change&&(r.on_change=i),null==t&&(t=i),r.$save_to_localstorage("zn_abc"),r.$clear_markers(),r.on_change.$call(t)},e.$$s=n,e.$$arity=1,e))},y.$$arity=0),e.def(be,"$on_selection_change",g=function(){var e,t=g.$$p,r=t||i,n=this;return t&&(g.$$p=null),t&&(g.$$p=null),$(n.$Native(n.$Native(n.editor)["$[]"]("selection")),"on",["changeSelection"],(e=function(t){var n=e.$$s||this;return null==n.inhibit_callbacks&&(n.inhibit_callbacks=i),null==t&&(t=i),f(n.inhibit_callbacks)?i:r.$call(t)},e.$$s=n,e.$$arity=1,e))},g.$$arity=0),e.def(be,"$on_cursor_change",v=function(){var e,t=v.$$p,r=t||i,n=this;return t&&(v.$$p=null),t&&(v.$$p=null),r.$call(i),$(n.$Native(n.$Native(n.editor)["$[]"]("selection")),"on",["changeCursor"],(e=function(t){var n=e.$$s||this;return null==n.inhibit_callbacks&&(n.inhibit_callbacks=i),null==t&&(t=i),f(n.inhibit_callbacks)?i:r.$call(t)},e.$$s=n,e.$$arity=1,e))},v.$$arity=0),e.def(be,"$clear_selection",b=function(){this.editor.selection.clearSelection()},b.$$arity=0),e.def(be,"$edit_unisons",x=function(e){var t,r,n,a=this,s=i,c=i,l=i,u=i;return s=a.editor.selection.getRange(),c=a.editor.getSession().doc.getTextRange(a.$editor().selection.getRange()),f(c["$empty?"]())?a.$raise(o(xe,"I18n").$t("Selection is empty")):(l=/\[([\^\_=]?[a-zA-Z][',]*)\s*(([\^\_=]?[a-zA-Z][',]*\s*)*)([\^\_=]?[a-zA-Z][',]*)+\]/,u=c,e["$=="]("replaceByFirst")&&(u=$(c,"gsub",[l],(t=function(e){var r;t.$$s;return null==e&&(e=i),""+((r=p["~"])===i?i:r["$[]"](1))},t.$$s=a,t.$$arity=1,t))),e["$=="]("replaceByLast")&&(u=$(c,"gsub",[l],(r=function(e){var t;r.$$s;return null==e&&(e=i),""+((t=p["~"])===i?i:t["$[]"](4))},r.$$s=a,r.$$arity=1,r))),e["$=="]("swapFirstWithLast")&&(u=$(c,"gsub",[l],(n=function(e){var t;n.$$s;return null==e&&(e=i),"["+((t=p["~"])===i?i:t["$[]"](4))+((t=p["~"])===i?i:t["$[]"](2))+((t=p["~"])===i?i:t["$[]"](1))+"]"},n.$$s=a,n.$$arity=1,n))),a.$editor().session.replace(s,u)),i},x.$$arity=1),e.def(be,"$get_selection_positions",w=function(){var e=this;return doc=e.editor.selection.doc,range=e.editor.selection.getRange(),range_start=doc.positionToIndex(range.start,0),range_end=doc.positionToIndex(range.end,0),[range_start,range_end]},w.$$arity=0),e.def(be,"$get_selection_ranges",A=function(){var e=this,t=e.editor.selection.doc;return e.editor.selection.getAllRanges().map(function(e){return[t.positionToIndex(e.start,0),t.positionToIndex(e.end,0)]})},A.$$arity=0),e.def(be,"$get_selection_info",k=function(){var e=this;return doc=e.editor.selection.doc,range=e.editor.selection.getRange(),token=e.editor.session.getTokenAt(range.start.row,range.start.column),token&&(token.startpos=[range.start.row,token.start],token.endpos=[range.start.row,token.start+token.value.length]),e.$Native({selection:[[range.start.row+1,range.start.column+1],[range.end.row+1,range.end.column+1]],token:token})},k.$$arity=0),e.def(be,"$select_range_by_position",E=function(e,t,r){var n=this,a=i,s=i,o=i;null==r&&(r=!1),a=f(r)?n.$get_selection_positions():[e,t],s=[a.$first(),e].$min(),o=[a.$last(),t].$max(),doc=n.editor.selection.doc,startrange=doc.indexToPosition(s),endrange=doc.indexToPosition(o),range=new n.range(startrange.row,startrange.column,endrange.row,endrange.column),myrange={start:startrange,end:endrange},n.editor.focus(),n.editor.selection.setSelectionRange(myrange,!1)},E.$$arity=-3),e.def(be,"$set_focus",S=function(){return this.editor.focus()},S.$$arity=0),e.def(be,"$select_add_range_by_position",N=function(e,t,r){var n=this,a=i,s=i,o=i;null==r&&(r=!1),a=f(r)?n.$get_selection_positions():[e,t],s=[a.$first(),e].$min(),o=[a.$last(),t].$max(),doc=n.editor.selection.doc,startrange=doc.indexToPosition(s),endrange=doc.indexToPosition(o),range=new n.range(startrange.row,startrange.column,endrange.row,endrange.column),myrange={start:startrange,end:endrange},n.editor.focus(),n.editor.selection.addRange(range,!1)},N.$$arity=-3),e.def(be,"$get_text",C=function(){var e=this,r=i;return r=e.$_get_abc_from_editor().$strip(),r=t(r,t("\n\n"+e.config_separator+".config\n\n",e.$_get_config_json())),f(e["$_has_resources?"]())&&(r=t(r,t("\n\n"+e.config_separator+".resources\n\n",e.$_get_resources_json()))),r},C.$$arity=0),e.def(be,"$set_text",I=function(e){return this.$_split_parts(e)},I.$$arity=1),e.def(be,"$replace_range",O=function(e,t,r){var n=this;therange=new n.range(e[0],e[1],t[0],t[1]),n.$editor().getSession().replace(therange,r)},O.$$arity=3),e.def(be,"$replace_text",L=function(e,t){return this.editor.replace(t,{needle:e}),i},L.$$arity=2),e.def(be,"$set_annotations",P=function(e){var t,n=this,a=i;return a=$(e,"map",[],(t=function(e){t.$$s;return null==e&&(e=i),u(["row","text","type"],{row:r(e["$[]"]("start_pos").$first(),1),text:e["$[]"]("text"),type:e["$[]"]("type")})},t.$$s=n,t.$$arity=1,t)),n.$set_markers(e),n.editor.getSession().setAnnotations(a.$to_n()),i},P.$$arity=1),e.def(be,"$set_markers",M=function(e){var t,r=this;return r.$clear_markers(),$(e,"each",[],(t=function(e){var r=t.$$s||this;return null==e&&(e=i),r.$add_marker(e)},t.$$s=r,t.$$arity=1,t))},M.$$arity=1),e.def(be,"$prepend_comment",T=function(e){var r,n=this,a=i;a=t($(e.$split(/\r?\n/),"map",[],(r=function(e){r.$$s;return null==e&&(e=i),"% "+e},r.$$s=n,r.$$arity=1,r)).$join("\n"),"\n%\n"),n.editor.selection.moveCursorFileStart(),n.editor.insert(a)},T.$$arity=1),e.def(be,"$append_text",B=function(e){var t=this;t.editor.selection.moveCursorFileEnd(),t.editor.insert(e)},B.$$arity=1),e.def(be,"$add_marker",j=function(e){var t=this,n=i,a=i,s=i;return n=u(["row","col"],{row:e["$[]"]("start_pos").$first(),col:e["$[]"]("start_pos").$last()}),a=u(["row","col"],{row:e["$[]"]("end_pos").$first(),col:e["$[]"]("end_pos").$last()}),s=t.editor.getSession().addMarker(new t.range(r(n["$[]"]("row"),1),r(n["$[]"]("col"),1),r(a["$[]"]("row"),1),r(a["$[]"]("col"),1)),"marked","line",!0),t.markers["$<<"](u(["from","to","id"],{from:[n["$[]"]("row"),n["$[]"]("col")],to:[a["$[]"]("row"),a["$[]"]("col")],id:s})),i},j.$$arity=1),e.def(be,"$clear_markers",F=function(){var e,t=this;return $(t.markers,"each",[],(e=function(t){var r=e.$$s||this;return null==r.editor&&(r.editor=i),null==t&&(t=i),r.editor.session.removeMarker(t["$[]"]("id"))},e.$$s=t,e.$$arity=1,e)),t.markers.$clear()},F.$$arity=0),e.def(be,"$get_abc_part",R=function(){return this.editor.getSession().getValue()},R.$$arity=0),e.def(be,"$get_config_part",D=function(){return this.config_models["$[]"]("config")},D.$$arity=0),e.def(be,"$get_config_model",z=function(){var e=this,t=i;return t=e.$_get_config_model(),f(t)?[e.$_get_config_model(),!0]:[u([],{}),!1]},z.$$arity=0),e.def(be,"$get_checksum",q=function(){var e=this,t=i;t=e.$_get_abc_from_editor().$strip();var r,n=305419896;for(r=0;r<t.length;r++)n+=t.charCodeAt(r)*(r+1);return n.$to_s().$scan(/...?/).$join(" ")},q.$$arity=0),e.def(be,"$resize",U=function(){return this.editor.resize()},U.$$arity=0),e.def(be,"$set_config_model",H=function(t,n,a){var s=this,o=i;return null==n&&(n="no desc"),null==a&&(a=!0),o=["zn_config",!0],$(s.dirty,"[]=",e.to_a(o)),o[r(o.length,1)],a["$=="](!0)&&s.config_undo.$do(t,n),s.$_set_config_model(t)},H.$$arity=-2),e.def(be,"$patch_config_part",G=function(t,n,a){var c=this,l=i,u=i,f=i;return null==a&&(a=t),l=s(o(xe,"Confstack"),"Confstack").$new(!1),u=s(o(xe,"Confstack"),"Confstack").$new(!1),l.$push(c.$_get_config_model()),f=[t,n],$(u,"[]=",e.to_a(f)),f[r(f.length,1)],l.$push(u.$get()),c.$set_config_model(l.$get(),a,!0)},G.$$arity=-3),e.def(be,"$copy_config_part_to_extract",Y=function(t,n,a){var c=this,l=i,u=i,f=i,p=i;return null==a&&(a=t),l=s(o(xe,"Confstack"),"Confstack").$new(!1),u=s(o(xe,"Confstack"),"Confstack").$new(!1),l.$push(c.$_get_config_model()),f=t.$gsub(/^extract\.\d+/,"extract."+n),p=[f,l.$get(t)],$(u,"[]=",e.to_a(p)),p[r(p.length,1)],l.$push(u.$get()),c.$set_config_model(l.$get(),a,!0)},Y.$$arity=-3),e.def(be,"$neat_config_part",V=function(){var e=this;return e.$_set_config_json(e.$_get_config_json(),"neat config_part",!1)},V.$$arity=0),e.def(be,"$patch_resources",Q=function(t,n){var a=this,s=i;return null==p.resources&&(p.resources=i),s=["zn_resources",!0],$(a.dirty,"[]=",e.to_a(s)),s[r(s.length,1)],s=[t,n],$(p.resources,"[]=",e.to_a(s)),s[r(s.length,1)],a.$save_to_localstorage("zn_resources"),a.on_change.$call(i)},Q.$$arity=2),e.def(be,"$patch_token",X=function(e,t,r){var n=this,a=i;return a=n.$get_selection_info().$token(),a.$type().$to_s()["$=="](e.$to_s())||n.$raise("cannot patch token if there is a name mismatch '"+a.$type()+"' - '"+e+"'"),n.$replace_range(a.$startpos(),a.$endpos(),r)},X.$$arity=3),e.def(be,"$extend_config_part",W=function(t,n){var a=this,c=i,l=i,u=i;return c=s(o(xe,"Confstack"),"Confstack").$new(!1),l=s(o(xe,"Confstack"),"Confstack").$new(!1),c.$push(a.$_get_config_model()),u=[t,n],$(l,"[]=",e.to_a(u)),u[r(u.length,1)],c.$push(l.$get()),c.$push(a.$_get_config_model()),a.$set_config_model(c.$get(),"extend "+t,!0)},W.$$arity=2),e.def(be,"$delete_config_part",J=function(t){var n=this,a=i,c=i;return null==p.resources&&(p.resources=i),f(t["$start_with?"]("$resources"))?p.resources.$delete(t.$split(".").$last()):(a=s(o(xe,"Confstack"),"Confstack").$new(!1),a.$push(n.$_get_config_model().$deep_dup()),c=[t,s(o(xe,"Confstack"),"DeleteMe")],$(a,"[]=",e.to_a(c)),c[r(c.length,1)],n.$set_config_model(a.$get(),"delete "+t,!0))},J.$$arity=1),e.def(be,"$get_config_part_value",K=function(e){var t=this,r=i;return r=s(o(xe,"Confstack"),"Confstack").$new(!1),r.$push(t.$_get_config_model()),r["$[]"](e)},K.$$arity=1),e.def(be,"$get_lyrics",Z=function(){var e,t=this,r=i;return r=t.$get_lyrics_raw(),f(n(r.$count(),0))?$(r,"map",[],(e=function(t){e.$$s;return null==t&&(t=i),t.$first().$gsub(/\nW\:[ \t]*/,"\n")},e.$$s=t,e.$$arity=1,e)).$join().$strip():i},Z.$$arity=0),e.def(be,"$get_lyrics_raw",ee=function(){var e=this,t=i,r=i,a=i;return null==p.log&&(p.log=i),t=/((\n((W\:)([^\n]*)\n)+)+)/,r=e.$get_abc_part(),a=r.$scan(t),f(n(a.$count(),1))&&p.log.$error("you have more than one lyrics section in your abc code"),a},ee.$$arity=0),e.def(be,"$to_lyrics",te=function(){var e=this,r=i,n=i,a=i;return null==p.log&&(p.log=i),p.log.$clear_errors(),r=e.$get_lyrics(),f(r)||(n=e.$get_abc_part(),a=t(n.$strip(),"\n%\nW:\n%\n%\n"),e.$replace_text(n,a)),e.handle_from_lyrics=!1,e.lyrics_editor.getSession().setValue(e.$get_lyrics()),e.handle_from_lyrics=!0,e.controller.$call_consumers("error_alert"),i},te.$$arity=0),e.def(be,"$from_lyrics",re=function(){var e,t=this,r=i,n=i,a=i;return f(t.handle_from_lyrics)&&(r=t.$get_lyrics_raw(),n=r.$first().$first(),a=t.lyrics_editor.getSession().getValue(),f(a["$empty?"]())&&(a=" "),a=$(a.$split("\n"),"map",[],(e=function(t){e.$$s;return null==t&&(t=i),"W:"+t},e.$$s=t,e.$$arity=1,e)).$join("\n"),a="\n"+a+"\n",t.$replace_text(n,a)),i},re.$$arity=0),e.def(be,"$restore_from_localstorage",ne=function(){var e,t=this,r=i,n=i,a=i,s=i;return r=t.$Native(localStorage.getItem("abc_data")),f(r["$nil?"]())?(n=t.$Native(localStorage.getItem("zn_abc")),f(n)&&t.$_set_abc_to_editor(n),a=f(e=t.$Native(localStorage.getItem("zn_config")))?e:u([],{}),t.config_undo.$reset(),f(a)&&t.$_set_config_json(a,"from localstore zn_config",!0),s=t.$Native(localStorage.getItem("zn_resources")),f(s)&&t.$_set_resources_json(s)):(localStorage.removeItem("abc_data"),f(r["$nil?"]())||t.$set_text(r)),t.dirty=u([],{})},ne.$$arity=0),e.def(be,"$save_to_localstorage",ae=function(t){var n=this,a=i;return null==t&&(t=i),f(t)&&(a=[t,!0],$(n.dirty,"[]=",e.to_a(a)),a[r(a.length,1)]),n.dirty["$[]"]("zn_abc")["$=="](!0)&&localStorage.setItem("zn_abc",n.$_get_abc_from_editor()),n.dirty["$[]"]("zn_config")["$=="](!0)&&localStorage.setItem("zn_config",n.$_get_config_json()),n.dirty["$[]"]("zn_resources")["$=="](!0)&&localStorage.setItem("zn_resources",n.$_get_resources_json()),n.dirty=u([],{})},ae.$$arity=-1),e.def(be,"$clean_localstorage",ie=function(){return localStorage.removeItem("zn_abc"),localStorage.removeItem("zn_config"),localStorage.removeItem("zn_resources"),i},ie.$$arity=0),e.def(be,"$get_config_from_text",se=function(e){var t,r=this;return o(xe,"JSON").$parse($(e.$split(r.config_separator),"select",[],(t=function(e){t.$$s;return null==e&&(e=i),e["$start_with?"](".config")},t.$$s=r,t.$$arity=1,t)).$first().$gsub(".config",""))},se.$$arity=1),e.def(be,"$_split_parts",oe=function(e){var r,n=this;return n.$_clean_models(),n.$clean_localstorage(),$(e.$split(n.config_separator),"each_with_index",[],(r=function(e,n){var a=r.$$s||this;return null==a.config_undo&&(a.config_undo=i),null==p.log&&(p.log=i),null==e&&(e=i),null==n&&(n=i),n["$=="](0)?a.$_set_abc_to_editor(e):f(e["$start_with?"](".config"))?(a.config_undo.$reset(),a.$_set_config_json(e.$split(".config").$last(),"from loaded abc",!0)):f(e["$start_with?"](".resources"))?a.$_set_resources_json(e.$split(".resources").$last()):p.log.$error(t(o(xe,"I18n").$t("unsupported section found in abc file: "),e["$[]"](d(0,10,!1))))},r.$$s=n,r.$$arity=2,r))},oe.$$arity=1),e.def(be,"$_set_abc_to_editor",ce=function(e){var t=this;return t.inhibit_callbacks=!0,t.editor.getSession().setValue(e),t.inhibit_callbacks=!1,t.$save_to_localstorage("zn_abc")},ce.$$arity=1),e.def(be,"$_get_abc_from_editor",le=function(){return this.editor.getSession().getValue()},le.$$arity=0),e.def(be,"$_set_config_json",ue=function(e,t,r){var n=this;return null==t&&(t="no desc"),null==r&&(r=!0),n.$set_config_model(o(xe,"JSON").$parse(e),t,r)},ue.$$arity=-2),e.def(be,"$_get_config_json",fe=function(){var e,t=this,r=i;return null==p.conf&&(p.conf=i),null==p.log&&(p.log=i),r=p.conf["$[]"]("neatjson"),$(p.log,"benchmark",["neat_json",736,"./text_pane.rb".$force_encoding("US-ASCII")],(e=function(){var t=e.$$s||this;return o(xe,"JSON").$neat_generate(t.$_get_config_model(),r)},e.$$s=t,e.$$arity=0,e))},fe.$$arity=0),e.def(be,"$_get_config_model",$e=function(){var e;return f(e=this.config_models["$[]"]("config"))?e:u([],{})},$e.$$arity=0),e.def(be,"$_set_config_model",pe=function(t){var n=this,a=i;return a=["config",t],$(n.config_models,"[]=",e.to_a(a)),a[r(a.length,1)],n.$save_to_localstorage("zn_config"),n.on_change.$call(i)},pe.$$arity=1),e.def(be,"$undo_config",de=function(){var e=this,t=i;return null==p.log&&(p.log=i),t=e.config_undo.$undo(),f(t)?(p.log.$info("undo: "+t["$[]"]("title")+": "+t["$[]"]("state").$dig("extract","0","legend","pos")),f(t)?e.$set_config_model(t["$[]"]("state"),t["$[]"]("title"),!1):i):i},de.$$arity=0),e.def(be,"$redo_config",he=function(){var e=this,t=i;return null==p.log&&(p.log=i),t=e.config_undo.$redo(),f(t)?(p.log.$info("redo: "+t["$[]"]("title")+": "+t["$[]"]("state").$dig("extract","0","legend","pos")),f(t)?e.$set_config_model(t["$[]"]("state"),t["$[]"]("title"),!1):i):i},he.$$arity=0),e.def(be,"$history_config",_e=function(){var e=this;return u(["undo","redo"],{undo:e.config_undo.$undo_history(),redo:e.config_undo.$redo_history()})},_e.$$arity=0),e.def(be,"$_set_resources_json",me=function(e){var t=this;return p.resources=o(xe,"JSON").$parse(e),t.$save_to_localstorage("zn_resources"),t.on_change.$call(i)},me.$$arity=1),e.def(be,"$_get_resources_json",ye=function(){return null==p.resources&&(p.resources=i),null==p.conf&&(p.conf=i),o(xe,"JSON").$neat_generate(p.resources,p.conf["$[]"]("neatjson"))},ye.$$arity=0),e.def(be,"$_has_resources?",ge=function(){return null==p.resources&&(p.resources=i),p.resources["$empty?"]()["$!"]()},ge.$$arity=0),e.def(be,"$_clean_models",ve=function(){var e=this;return p.resources=u([],{}),e.config_models=u([],{}),e.dirty=u([],{})},ve.$$arity=0)}(m[0],0,m)}(a[0],a)},Opal.modules["command-controller"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}var r=(e.top,[]),n=e.nil,a=(e.const_get_qualified,e.const_get_relative),i=(e.breaker,e.slice,e.module),s=e.klass,o=e.truthy,c=e.send,l=e.hash2,u=e.range;return e.add_stubs(["$attr_reader","$call","$lambda","$raise","$new","$set_help","$set_default","$push","$!","$start_with?","$to_s","$each","$name","$[]","$get_default","$[]=","$-","$get_help","$empty?","$get_clean_argument_values","$perform","$undoable?","$clear","$can_undo?","$pop","$invert","$can_redo?","$map","$scan","$first","$select","$nil?","$to_sym","$parse_string","$gsub","$each_with_index","$parameter_name","$clone","$unshift","$to_a","$is_public?","$last","$join","$parameters"]),function(r,f){var $=i(r,"CommandController"),p=[$].concat(f);!function(t,r,a){var i,c,l,u,f,$=s(t,null,"Parameter");[$].concat(a);$.$$prototype.default_action=$.$$prototype.name=$.$$prototype.help_action=n,$.$attr_reader("name"),e.def($,"$initialize",i=function(e,t){var r=this;return r.name=e,r.type=t},i.$$arity=2),e.def($,"$set_help",c=function(){var e=c.$$p,t=e||n,r=this;return e&&(c.$$p=null),e&&(c.$$p=null),r.help_action=t},c.$$arity=0),e.def($,"$set_default",l=function(){var e=l.$$p,t=e||n,r=this;return e&&(l.$$p=null),e&&(l.$$p=null),r.default_action=t},l.$$arity=0),e.def($,"$get_help",u=function(){var e=this,t=n;return t=e.default_action.$call(),o(t)&&(t="["+t+"]"),"{"+e.name+"}"+t+" = "+e.help_action.$call()},u.$$arity=0),e.def($,"$get_default",f=function(){return this.default_action.$call()},f.$$arity=0)}(p[0],0,p),function(r,i,u){var f,$,p,d,h,_,m,y,g,v,b,x,w,A,k,E=s(r,null,"Command"),S=[E].concat(u);E.$$prototype.parameters=E.$$prototype.name=E.$$prototype.action=E.$$prototype.inverse_action=E.$$prototype.help_action=E.$$prototype.undoable=n,E.$attr_reader("name","parameters"),e.def(E,"$initialize",f=function(e){var t,r,a,i=this;return i.name=e,i.help_action=c(i,"lambda",[],(t=function(){t.$$s;return"no help defined for "+e},t.$$s=i,t.$$arity=0,t)),i.parameters=[],i.action=c(i,"lambda",[],(r=function(t){var a=r.$$s||this;return null==t&&(t=n),a.$raise("No action defined for "+e)},r.$$s=i,r.$$arity=1,r)),i.inverse_action=c(i,"lambda",[],(a=function(t){var r=a.$$s||this;return null==t&&(t=n),r.$raise("No  undo defined fore "+e)},a.$$s=i,a.$$arity=1,a)),i.undoable=!0},f.$$arity=1),e.def(E,"$add_parameter",$=function(e,t,r,i){var s,o,l=$.$$p,u=l||n,f=this,p=n;return l&&($.$$p=null),l&&($.$$p=null),null==r&&(r=n),null==i&&(i=n),p=a(S,"Parameter").$new(e,t),c(p,"set_help",[],(s=function(){s.$$s;return r},s.$$s=f,s.$$arity=0,s)),c(p,"set_default",[],(o=function(){o.$$s;return i},o.$$s=f,o.$$arity=0,o)),u!==n&&u.$call(p),f.parameters.$push(p)},$.$$arity=-3),e.def(E,"$as_action",p=function(){var e=p.$$p,t=e||n,r=this;return e&&(p.$$p=null),e&&(p.$$p=null),r.action=t},p.$$arity=0),e.def(E,"$as_inverse",d=function(){var e=d.$$p,t=e||n,r=this;return e&&(d.$$p=null),e&&(d.$$p=null),r.inverse_action=t},d.$$arity=0),e.def(E,"$is_public?",h=function(){return this.name.$to_s()["$start_with?"]("_")["$!"]()},h.$$arity=0),e.def(E,"$set_help",_=function(){var e=_.$$p,t=e||n,r=this;return e&&(_.$$p=null),e&&(_.$$p=null),r.help_action=t},_.$$arity=0),e.def(E,"$perform",m=function(e){return this.action.$call(e)},m.$$arity=1),e.def(E,"$invert",y=function(e){return this.inverse_action.$call(e)},y.$$arity=1),e.def(E,"$get_clean_argument_values",g=function(r){var a,i=this,s=n;return s=l([],{}),c(i.parameters,"each",[],(a=function(i){var l,u=(a.$$s,n);return null==i&&(i=n),u=[i.$name(),o(l=r["$[]"](i.$name()))?l:i.$get_default()],c(s,"[]=",e.to_a(u)),u[t(u.length,1)]},a.$$s=i,a.$$arity=1,a)),s},g.$$arity=1),e.def(E,"$get_help",v=function(){return this.help_action.$call()},v.$$arity=0),e.def(E,"$parameter_name",b=function(e){return this.parameters["$[]"](e).$name()},b.$$arity=1),e.def(E,"$parameter_help",x=function(e){return this.parameters["$[]"](e).$get_help()},x.$$arity=1),e.def(E,"$parameter_default",w=function(e){return this.parameters["$[]"](e).$get_default()},w.$$arity=1),e.def(E,"$undoable?",A=function(){return this.undoable},A.$$arity=0),e.def(E,"$undoable=",k=function(e){return this.undoable=e},k.$$arity=1)}(p[0],0,p),function(r,i,f){var $,p,d,h,_,m,y,g,v,b,x,w,A,k,E=s(r,null,"CommandStack"),S=[E].concat(f);E.$$prototype.commands=E.$$prototype.undo_stack=E.$$prototype.redo_stack=E.$$prototype.history_stack=n,e.def(E,"$initialize",$=function(){var e=this;return e.commands=l([],{}),e.undo_stack=[],e.redo_stack=[],e.history_stack=[]},$.$$arity=0),e.def(E,"$add_command",p=function(r){var i=p.$$p,s=i||n,o=this,l=n,u=n;return i&&(p.$$p=null),i&&(p.$$p=null),l=a(S,"Command").$new(r),s.$call(l),u=[l.$name(),l],c(o.commands,"[]=",e.to_a(u)),u[t(u.length,1)]},p.$$arity=1),e.def(E,"$can_undo?",d=function(){return this.undo_stack["$empty?"]()["$!"]()},d.$$arity=0),e.def(E,"$can_redo?",h=function(){return this.redo_stack["$empty?"]()["$!"]()},h.$$arity=0),e.def(E,"$perform",_=function(e,t){var r=this,a=n;return a=e.$get_clean_argument_values(t),e.$perform(a),o(e["$undoable?"]())&&(r.undo_stack.$push([e,a]),r.redo_stack.$clear()),r.history_stack.$push(["  do",e,a])},_.$$arity=2),e.def(E,"$undo",m=function(){var t,r,a=this,i=n,s=n;return o(a["$can_undo?"]())?(r=a.undo_stack.$pop(),t=e.to_ary(r),i=null==t[0]?n:t[0],s=null==t[1]?n:t[1],a.redo_stack.$push([i,s]),a.history_stack.$push(["undo",i,s]),i.$invert(s)):a.$raise("nothing to undo")},m.$$arity=0),e.def(E,"$redo",y=function(){var t,r,a=this,i=n,s=n;return o(a["$can_redo?"]())?(r=a.redo_stack.$pop(),t=e.to_ary(r),i=null==t[0]?n:t[0],s=null==t[1]?n:t[1],a.$perform(i,s)):a.$raise("nothing to redo")},y.$$arity=0),e.const_set(S[0],"STRING_COMMAND_REGEX",/([^ \\\^"{]+)|"(([^\\"]|\\["n\\])*)"|(\{.+\})/),e.def(E,"$parse_string",g=function(e){var t,r=this;return c(e.$scan(a(S,"STRING_COMMAND_REGEX")),"map",[],(t=function(e){var r,a=t.$$s||this;return null==e&&(e=n),c(e,"select",[],(r=function(e){r.$$s;return null==e&&(e=n),e["$nil?"]()["$!"]()},r.$$s=a,r.$$arity=1,r)).$first()},t.$$s=r,t.$$arity=1,t))},g.$$arity=1),e.def(E,"$run_parsed_command",v=function(e,t){var r=this,a=n;return a=r.commands["$[]"](e.$to_sym()),r.$perform(a,t)},v.$$arity=2),e.def(E,"$run_string",b=function(r){var i,s,f=this,$=n,p=n,d=n;return $=l([],{}),p=f.$parse_string(r),o(p["$empty?"]())&&(p=["help"]),p=c(p,"map",[],(i=function(e){i.$$s;return null==e&&(e=n),e.$gsub("\\\\","\\")},i.$$s=f,i.$$arity=1,i)),d=f.commands["$[]"](p.$first().$to_sym()),o(d)||f.$raise("wrong command: "+r),c(p["$[]"](u(1,-1,!1)),"each_with_index",[],(s=function(i,o){var l=s.$$s||this,u=n;null==i&&(i=n),null==o&&(o=n);try{return u=[d.$parameter_name(o),i],c($,"[]=",e.to_a(u)),u[t(u.length,1)]}catch(t){if(!e.rescue(t,[a(S,"StandardError")]))throw t;try{return l.$raise("too many arguments in '"+r+"'")}finally{e.pop_exception()}}},s.$$s=f,s.$$arity=2,s)),f.$perform(d,$)},b.$$arity=1),e.def(E,"$history",x=function(){return this.history_stack.$clone()},x.$$arity=0),e.def(E,"$undostack",w=function(){var e,t=this;return c(t.undo_stack,"map",[],(e=function(t){e.$$s;return null==t&&(t=n),t.$clone().$unshift("undo")},e.$$s=t,e.$$arity=1,e))},w.$$arity=0),e.def(E,"$redostack",A=function(){var e,t=this;return c(t.redo_stack,"map",[],(e=function(t){e.$$s;return null==t&&(t=n),t.$clone().$unshift("redo")},e.$$s=t,e.$$arity=1,e))},A.$$arity=0),e.def(E,"$help_string_style",k=function(){var e,t,r=this
;return c(c(r.commands.$to_a(),"select",[],(e=function(t){e.$$s;return null==t&&(t=n),t.$last()["$is_public?"]()},e.$$s=r,e.$$arity=1,e)),"map",[],(t=function(e,r){var a,i=t.$$s||this,s=n;return null==e&&(e=n),null==r&&(r=n),s=c(r.$parameters(),"map",[],(a=function(e){a.$$s;return null==e&&(e=n),"{"+e.$name()+"}"},a.$$s=i,a.$$arity=1,a)).$join(" "),r.$name()+" "+s+" : "+r.$get_help()},t.$$s=r,t.$$arity=2,t))},k.$$arity=0)}(p[0],0,p)}(r[0],r)},Opal.modules.controller=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e<=t:e["$<="](t)}function a(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}var i=(e.top,[]),s=e.nil,o=e.const_get_qualified,c=e.const_get_relative,l=(e.breaker,e.slice,e.klass),u=e.truthy,f=e.hash2,p=e.gvars,d=e.send,h=e.range;return e.add_stubs(["$nil?","$Native","$now","$load_dir","$save_dir","$[]","$warning","$update","$to_json","$[]=","$-","$parse","$clone","$private","$attr_accessor","$html","$find","$new","$post_named_message","$downcase","$locale","$call_consumers","$to_n","$phrases","$load_from_loacalstorage","$on_command","$save_to_localstorage","$handle_command","$info","$jspdfversion","$check_suppoerted_browser","$strict=","$push","$_init_conf","$controller=","$each","$select","$methods","$=~","$send","$setup_tune_preview","$setup_harpnote_preview","$setup_harpnote_player","$setup_worker_listners","$get_uri","$class","$last","$cleanup_localstorage","$empty?","$get_abc_part","$load_demo_tune","$set_status","$loglevel","$get_current_template","$load_from_uri","$==","$get_lyrics","$ok?","$render_previews","$error","$t","$setup_ui_listener","$show_message_of_the_day","$year","$lambda","$has_errors?","$join","$get_errors","$get_notes","$map","$to_s","$call","$get_config_form_menu_entries","$clear_errors","$timestamp_start","$timestamp","$run_string","$message","$backtrace","$run_parsed_command","$include?","$systemstatus","$uniq","$always","$fail","$then","$get","$set_text","$body","$alert","$restore_from_localstorage","$match","$first","$draw","$layout_harpnotes","$draw_in_segments","$migrate_config_lyrics","$migrate_notes","$migrate_config_cleanup","$delete","$inject","$split","$gsub","$to_i","$+","$count","$is_a?","$resolve","$tap","$is_playing?","$stop_play_abc","$is_stopped?","$play_auto","$play_song","$play_selection","$play_from_selection","$stop","$set_active","$tweak_abc_text","$benchmark","$compute_tune_preview","$get_checksum","$set_svg","$set_inactive","$start_with?","$get_config_from_editor","$debug","$load_song","$active_voices","$harpnote_preview_printer","$save_scroll_position","$resize","$clear_annotations","$render_previews_in_worker","$render_previews_in_uithread","$render_tunepreview__in_worker","$clear","$size","$render_harpnotepreview_in_worker","$render_tunepreview_in_uithread","$render_harpnotepreview_callback","$bind_elements","$set_annotations","$annotations","$file","$get_text","$output","$render_a4","$render_a3","$to_blob","$strftime","$load_music_model","$keys","$set_extracts_menu","$validate_conf","$uri=","$get_placeholder_replacers","$placeholders=","$layout","$pop","$meta_data","$reset_to","$transform","$abc_model","$player_model_abc=","$checksum=","$get_config_model","$migrate_config","$set_config_model","$add_class","$scroll_into_view","$has_class?","$scroll_to_element","$remove_class","$select_range_by_position","$range_highlight_more","$range_unhighlight_more","$range_unhighlight","$highlight_abc_object","$!","$between?","$select_add_range_by_position","$get_selection_ranges","$to_a","$compact","$flatten","$merge!","$loglevel=","$app_name","$app_id","$dig","$set_harppreview_size","$set_view_box","$on_select","$select_abc_object","$on_drag_start","$on_drag_end","$zip","$patch_config_part","$refresh_form","$on_mouseover","$on_mouseout","$on_draggable_rightcklick","$set_canvas","$on_named_message","$<=","$shift","$set_worker_model","$log_from_worker","$on_change","$request_refresh","$on_selection_change","$get_selection_info","$unhighlight_all","$range_highlight","$on_cursor_change","$on_noteon","$highlight_abc_object_by_player_callback","$on_noteoff","$on_songoff","$on","$shift_key","$alt_key","$meta_key","$ctrl_key","$key_code","$===","$ord","$prevent","$play_abc","$toggle_console","$chr","$key","$newValue","$present_message_of_the_day","$>","$init_conf"]),function(t,r,n){var a,i,o,u=l(t,null,"LastRenderMonitor"),f=[u].concat(n);e.def(u,"$ok?",a=function(){var e=this,t=s;return t=localStorage.getItem("lastrender"),e.$Native(t)["$nil?"]()},a.$$arity=0),e.def(u,"$set_active",i=function(){return localStorage.setItem("lastrender",c(f,"Time").$now()),!0},i.$$arity=0),e.def(u,"$clear",o=function(){return localStorage.removeItem("lastrender"),!1},o.$$arity=0)}(i[0],0,i),function(r,n,a){var i,o,$,h,_,m,y,g,v,b=l(r,null,"LocalStore"),x=[b].concat(a);b.$$prototype.directory=b.$$prototype.name=s,e.def(b,"$initialize",i=function(e){var t=this;return t.name=e,t.$load_dir(),u(t.directory)?s:(t.directory=f([],{}),t.$save_dir())},i.$$arity=1),e.def(b,"$create",o=function(e,t,r){var n=this;return null==p.log&&(p.log=s),null==r&&(r=s),u(n.directory["$[]"](e))?p.log.$warning("local storage: key '"+e+"' already exists"):n.$update(e,t,r,!0)},o.$$arity=-3),e.def(b,"$update",$=function(r,n,a,i){var o,c=this,l=s,$=s;return null==p.log&&(p.log=s),null==a&&(a=s),null==i&&(i=!1),l=f(["p","title"],{p:n,title:a}).$to_json(),u(u(o=c.directory["$[]"](r))?o:i)?(localStorage.setItem(c.$mangle_key(r),l),$=[r,a],d(c.directory,"[]=",e.to_a($)),$[t($.length,1)],c.$save_dir()):p.log.$warning("local storage update: key '"+r+"' does not exist")},$.$$arity=-3),e.def(b,"$retrieve",h=function(e){var t=this,r=s,n=s;return r=c(x,"JSON").$parse(localStorage.getItem(t.$mangle_key(e))),u(r)&&(n=r["$[]"]("p")),n},h.$$arity=1),e.def(b,"$delete",_=function(r){var n=this,a=s;return null==p.log&&(p.log=s),u(n.directory["$[]"](r))?p.log.$warning("local storage: key '"+r+"' does not exist"):(localStorage.removeItem(n.$mangle_key(r)),a=[r,s],d(n.directory,"[]=",e.to_a(a)),a[t(a.length,1)],n.$save_dir())},_.$$arity=1),e.def(b,"$list",m=function(){return this.directory.$clone()},m.$$arity=0),b.$private(),e.def(b,"$mangle_key",y=function(e){return this.name+"."+e},y.$$arity=1),e.def(b,"$load_dir",g=function(){var e=this,t=s;return t=e.name+"__dir",e.directory=c(x,"JSON").$parse(localStorage.getItem(t))},g.$$arity=0),e.def(b,"$save_dir",v=function(){var e=this,t=s,r=s;return t=e.directory.$to_json(),r=e.name+"__dir",localStorage.setItem(r,t)},v.$$arity=0)}(i[0],0,i),function(i,_,m){var y,g,v,b,x,w,A,k,E,S,N,C,I,O,L,P,M,T,B,j,F,R,D,z,q,U,H,G,Y,V,Q,X,W,J,K,Z,ee,te,re,ne,ae,ie,se,oe,ce,le,ue,fe,$e,pe,de,he,_e,me,ye,ge,ve,be,xe,we,Ae,ke=l(i,null,"Controller"),Ee=[ke].concat(m);return ke.$$prototype.worker=ke.$$prototype.console=ke.$$prototype.editor=ke.$$prototype.systemstatus=ke.$$prototype.worker_info=ke.$$prototype.systemstatus_consumers=ke.$$prototype.commands=ke.$$prototype.dropboxpath=ke.$$prototype.harpnote_player=ke.$$prototype.harpnote_preview_printer=ke.$$prototype.music_model=ke.$$prototype.tune_preview_printer=ke.$$prototype.expand_selection=ke.$$prototype.abc_model=ke.$$prototype.dropboxclient=ke.$$prototype.dropboxloginstate=ke.$$prototype.worker_tunepreview=ke.$$prototype.info_url=ke.$$prototype.refresh_timer=s,ke.$attr_accessor("dropped_abc","dropboxclient","dropboxpath","editor","harpnote_preview_printer","info_url","tune_preview_printer","systemstatus","zupfnoter_ui"),e.def(ke,"$initialize",y=function(){var r,n,a,i,l,$=this,h=s,_=s,m=s,y=s,g=s,v=s,b=s,x=s,w=s;return null==p.log&&(p.log=s),null==p.conf&&(p.conf=s),h=c(Ee,"Time").$now(),h=c(Ee,"Element").$find("#buster").$html(),h=c(Ee,"JSON").$parse(h)["$[]"]("buster"),$.worker=c(Ee,"NamedWebworker").$new("public/znworker.js"+h),$.worker_tunepreview=$.worker,$.worker_info=f(["version"],{version:"unknown"}),$.worker.$post_named_message("get_worker_info",s),_=f(["de","de-de","en","en-us"],{de:"de-de","de-de":"de-de",en:"en-US","en-us":"en-US"}),m=function(){try{return navigator.language.$downcase()}catch(t){if(!e.rescue(t,[c(Ee,"StandardError")]))throw t;try{return"de-de"}finally{e.pop_exception()}}}(),y=u(r=_["$[]"](m))?r:"de-de",$.info_url="https://www.zupfnoter.de/category/info_"+y,$.refresh_timer=[],$.render_stack=[],$.version=c(Ee,"VERSION"),u(m)&&d(c(Ee,"I18n"),"locale",[y],(n=function(){var e=n.$$s||this,t=s;return null==e.worker&&(e.worker=s),e.$call_consumers("localizedtexts"),t=JSON.stringify(c(Ee,"I18n").$phrases().$to_n()),e.worker.$post_named_message("i18n_set_locale",t)},n.$$s=$,n.$$arity=0,n)),$.zupfnoter_ui=new init_w2ui($),$.console=o(c(Ee,"JqConsole"),"JqConsole").$new("commandconsole","zupfnoter> "),$.console.$load_from_loacalstorage(),d($.console,"on_command",[],(a=function(e){var t=a.$$s||this;return null==t.console&&(t.console=s),null==e&&(e=s),t.console.$save_to_localstorage(),t.$handle_command(e)},a.$$s=$,a.$$arity=1,a)),$.dropped_abc="T: nothing dropped yet",p.log=c(Ee,"ConsoleLogger").$new($.console),p.log.$info("Welcome to Zupfnoter"),p.log.$info("Zupfnoter "+c(Ee,"VERSION")),p.log.$info("Opal:     "+c(Ee,"RUBY_ENGINE_VERSION")),p.log.$info("Ruby:     "+c(Ee,"RUBY_VERSION")),p.log.$info("Abc2svg:  "+abc2svg.version),p.log.$info("JsPdf:    "+c(Ee,"JsPDF").$jspdfversion()),p.log.$info("Browser:  "+bowser.name+"  "+bowser.version),p.log.$info("Language: "+y),$.$check_suppoerted_browser(),p.conf=c(Ee,"Confstack").$new(s),g=[!1],d(p.conf,"strict=",e.to_a(g)),g[t(g.length,1)],p.conf.$push($.$_init_conf()),p.resources=f([],{}),p.settings=f(["autoscroll","follow"],{autoscroll:"true",follow:"true"}),$.$call_consumers("settings_menu"),$.json_validator=o(c(Ee,"Ajv"),"JsonValidator").$new(),$.editor=o(c(Ee,"Harpnotes"),"TextPane").$new("abcEditor"),g=[$],d($.editor,"controller=",e.to_a(g)),g[t(g.length,1)],$.songbook=c(Ee,"LocalStore").$new("songbook"),$.abc_transformer=o(o(c(Ee,"Harpnotes"),"Input"),"Abc2svgToHarpnotes").$new(),$.dropboxclient=o(o(c(Ee,"Opal"),"DropboxJs"),"NilClient").$new(),$.systemstatus=f(["version","dropboxpathlist"],{version:c(Ee,"VERSION"),dropboxpathlist:[]}),$.commands=o(c(Ee,"CommandController"),"CommandStack").$new(),d(d($.$methods(),"select",[],(i=function(e){i.$$s;return null==e&&(e=s),e["$=~"](/__ic.*/)},i.$$s=$,i.$$arity=1,i)),"each",[],(l=function(e){var t=l.$$s||this;return null==e&&(e=s),t.$send(e)},l.$$s=$,l.$$arity=1,l)),$.$setup_tune_preview(),$.$setup_harpnote_preview(),$.$setup_harpnote_player(),$.$setup_worker_listners(),v=$.$class().$get_uri(),b=function(){try{return v["$[]"]("parsed_search")["$[]"]("mode").$last()}catch(t){if(!e.rescue(t,[c(Ee,"StandardError")]))throw t;try{return"work"}finally{e.pop_exception()}}}(),$.$cleanup_localstorage(),$.$load_from_loacalstorage(),u($.editor.$get_abc_part()["$empty?"]())&&$.$load_demo_tune(),u($.systemstatus["$[]"]("view"))||$.$set_status(f(["dropbox","music_model","loglevel","autorefresh","view","mode"],{dropbox:"not connected",music_model:"unchanged",loglevel:p.log.$loglevel(),autorefresh:"off",view:0,mode:b})),$.$set_status(f(["mode"],{mode:b})),u($.systemstatus["$[]"]("saveformat"))||$.$set_status(f(["saveformat"],{saveformat:"A3-A4"})),$.$get_current_template(),$.$handle_command("dreconnect"),x=function(){try{return v["$[]"]("parsed_search")["$[]"]("load")}catch(t){if(!e.rescue(t,[c(Ee,"StandardError")]))throw t;try{return s}finally{e.pop_exception()}}}(),u(x)&&$.$load_from_uri(v["$[]"]("parsed_search")["$[]"]("load")),$.systemstatus["$[]"]("mode")["$=="]("demo")?$.$handle_command("view 0"):($.editor.$get_lyrics(),w=c(Ee,"LastRenderMonitor").$new(),u(w["$ok?"]())?u(v["$[]"]("parsed_search")["$[]"]("debug"))||$.$render_previews():(p.log.$error(c(Ee,"I18n").$t("last session failed. Did not render. Cleanup ABC, then render manually")),$.$call_consumers("error_alert"))),$.$setup_ui_listener(),$.$show_message_of_the_day()},y.$$arity=0),e.def(ke,"$about_zupfnoter",g=function(){var e=this;return"<p>"+c(Ee,"I18n").$t("Free software to create sheets for table harps")+"</p>\n         <table>\n          <tbody>\n          <tr><td>Zupfnoter:</td><td>"+c(Ee,"VERSION")+"</td></tr>\n          <tr><td>Worker:</td><td>"+e.worker_info["$[]"]("version")+'</td></tr>\n          <tr><td><a target="_blank" href="http://opalrb.com">Opal</a>:</td><td>'+c(Ee,"RUBY_ENGINE_VERSION")+"</td></tr>\n          <tr><td>Ruby:</td><td>"+c(Ee,"RUBY_VERSION")+'</td></tr>\n          <tr><td><a target="_blank" href="http://moinejf.free.fr/js/index.html">abc2svg</a>:</td><td>'+abc2svg.version+'</td></tr>\n          <tr><td><a target="_blank" href="https://wim.vree.org/js/xml2abc-js_index.html">xml2abc.js</a>:</td><td>'+xml2abc_VERSION+'</td></tr>\n          <tr><td><a target="_blank" href="https://parall.ax/products/jspdf">jsPDF</a>:</td><td>'+c(Ee,"JsPDF").$jspdfversion()+"</td></tr>\n         </tbody>\n        </table>\n        <p> "+c(Ee,"Time").$now().$year()+' Bernhard Weichel - info@zupfnoter.de</p>\n        <p><a target="_blank" href="https://www.zupfnoter.de">Website: https://www.zupfnoter.de</a></p>\n    '},g.$$arity=0),e.def(ke,"$call_consumers",v=function(e){var t,r,n,a,i,o,c,l,$,h,_,m,y,g,v,b,x,w,A,k=this;return k.systemstatus_consumers=f(["systemstatus","lock","unlock","localizedtexts","statusline","error_alert","play_start","play_stop","play_stopping","disable_save","enable_save","before_open","document_title","current_notes","settings_menu","extracts","harp_preview_size","render_status","show_config_tab"],{systemstatus:[d(k,"lambda",[],(t=function(){var e=t.$$s||this;return null==e.systemstatus&&(e.systemstatus=s),update_systemstatus_w2ui(e.systemstatus.$to_n())},t.$$s=k,t.$$arity=0,t))],lock:[d(k,"lambda",[],(r=function(){r.$$s;return lockscreen()},r.$$s=k,r.$$arity=0,r))],unlock:[d(k,"lambda",[],(n=function(){n.$$s;return unlockscreen()},n.$$s=k,n.$$arity=0,n))],localizedtexts:[d(k,"lambda",[],(a=function(){a.$$s;return update_localized_texts()},a.$$s=k,a.$$arity=0,a))],statusline:[],error_alert:[d(k,"lambda",[],(i=function(){i.$$s;return null==p.log&&(p.log=s),u(p.log["$has_errors?"]())?window.update_error_status_w2ui(p.log.$get_errors().$join("<br/>\n")):s},i.$$s=k,i.$$arity=0,i))],play_start:[d(k,"lambda",[],(o=function(){o.$$s;return update_play_w2ui("start")},o.$$s=k,o.$$arity=0,o))],play_stop:[d(k,"lambda",[],(c=function(){c.$$s;return update_play_w2ui("stop")},c.$$s=k,c.$$arity=0,c))],play_stopping:[d(k,"lambda",[],(l=function(){l.$$s;return update_play_w2ui("stopping")},l.$$s=k,l.$$arity=0,l))],disable_save:[d(k,"lambda",[],($=function(){$.$$s;return disable_save()},$.$$s=k,$.$$arity=0,$))],enable_save:[d(k,"lambda",[],(h=function(){h.$$s;return enable_save()},h.$$s=k,h.$$arity=0,h))],before_open:[d(k,"lambda",[],(_=function(){_.$$s;return before_open()},_.$$s=k,_.$$arity=0,_))],document_title:[d(k,"lambda",[],(m=function(){var e=m.$$s||this;return null==e.document_title&&(e.document_title=s),document.title=e.document_title},m.$$s=k,m.$$arity=0,m))],current_notes:[d(k,"lambda",[],(y=function(){var e=y.$$s||this;return null==e.harpnote_player&&(e.harpnote_player=s),update_current_notes_w2ui(e.harpnote_player.$get_notes().$join(", "))},y.$$s=k,y.$$arity=0,y))],settings_menu:[d(k,"lambda",[],(g=function(){g.$$s;return null==p.settings&&(p.settings=s),update_settings_menu(p.settings.$to_n())},g.$$s=k,g.$$arity=0,g))],extracts:[d(k,"lambda",[],(v=function(){var e,t=v.$$s||this,r=s;return null==t.extracts&&(t.extracts=s),r=d(t.extracts,"map",[],(e=function(t,r){e.$$s;return null==t&&(t=s),null==r&&(r=s),f(["id","text"],{id:t,text:t+": "+r})},e.$$s=t,e.$$arity=2,e)),set_extract_menu(r.$to_n()),t.$call_consumers("systemstatus")},v.$$s=k,v.$$arity=0,v))],harp_preview_size:[d(k,"lambda",[],(b=function(){var e=b.$$s||this;return null==e.harp_preview_size&&(e.harp_preview_size=s),set_harp_preview_size(e.harp_preview_size)},b.$$s=k,b.$$arity=0,b))],render_status:[d(k,"lambda",[],(x=function(){var e=x.$$s||this;return null==e.systemstatus&&(e.systemstatus=s),null==e.render_stack&&(e.render_stack=s),set_render_status(e.systemstatus["$[]"]("autorefresh")+" "+e.render_stack.$to_s())},x.$$s=k,x.$$arity=0,x))],show_config_tab:[d(k,"lambda",[],(w=function(){w.$$s;return show_config_tab()},w.$$s=k,w.$$arity=0,w))]}),d(k.systemstatus_consumers["$[]"](e),"each",[],(A=function(e){A.$$s;return null==e&&(e=s),e.$call()},A.$$s=k,A.$$arity=1,A))},v.$$arity=1),e.def(ke,"$get_config_form_menu_entries",b=function(){return c(Ee,"ConfstackEditor").$get_config_form_menu_entries()},b.$$arity=0),e.def(ke,"$handle_command",x=function(t){var r=this,n=s;null==p.log&&(p.log=s),p.log.$clear_errors();try{p.log.$timestamp_start(),p.log.$timestamp(t),r.commands.$run_string(t)}catch(r){if(!e.rescue(r,[c(Ee,"Exception")]))throw r;n=r;try{p.log.$error(n.$message()+' in command "'+t+'"',s,s,n.$backtrace())}finally{e.pop_exception()}}return r.$call_consumers("error_alert")},x.$$arity=1),e.def(ke,"$handle_parsed_command",w=function(t,r){var n=this,a=s;null==p.log&&(p.log=s),p.log.$clear_errors();try{p.log.$timestamp_start(),p.log.$timestamp(t),n.commands.$run_parsed_command(t,n.$Native(r))}catch(r){if(!e.rescue(r,[c(Ee,"Exception")]))throw r;a=r;try{p.log.$error(a.$message()+' in command "'+t+'"',s,s,a.$backtrace())}finally{e.pop_exception()}}return n.$call_consumers("error_alert")},w.$$arity=2),e.def(ke,"$save_to_localstorage",A=function(){var e,t=this,r=s;return r=d(t.systemstatus,"select",[],(e=function(t,r){e.$$s;return null==t&&(t=s),null==r&&(r=s),["last_read_info_id","zndropboxlogincmd","music_model","view","autorefresh","loglevel","nwworkingdir","dropboxapp","dropboxpath","dropboxpathlist","dropboxloginstate","perspective","saveformat","zoom"]["$include?"](t)},e.$$s=t,e.$$arity=2,e)).$to_json(),t.systemstatus["$[]"]("mode")["$=="]("work")&&localStorage.setItem("systemstatus",r),t.editor.$save_to_localstorage()},A.$$arity=0),e.def(ke,"$push_to_dropboxpathlist",k=function(){var e,t=this,r=s;return r=u(e=t.$systemstatus()["$[]"]("dropboxpathlist"))?e:[],r.$push(t.dropboxpath),r=r.$uniq().$last(10),t.$set_status(f(["dropboxpathlist"],{dropboxpathlist:r}))},k.$$arity=0),e.def(ke,"$load_from_uri",E=function(e){var t,r,n,a=this;return d(d(d(c(Ee,"HTTP").$get(e),"then",[],(t=function(e){var r=t.$$s||this;return null==r.editor&&(r.editor=s),null==e&&(e=s),r.editor.$set_text(e.$body())},t.$$s=a,t.$$arity=1,t)),"fail",[],(r=function(t){var n=r.$$s||this;return null==t&&(t=s),n.$alert("could not load from URL: "+e)},r.$$s=a,r.$$arity=1,r)),"always",[],(n=function(e){n.$$s;return null==e&&(e=s),s},n.$$s=a,n.$$arity=1,n))},E.$$arity=1),e.def(ke,"$load_from_loacalstorage",S=function(){var e=this,t=s;return e.editor.$restore_from_localstorage(),t=c(Ee,"JSON").$parse(localStorage.getItem("systemstatus")),u(t)&&e.$set_status(t),s},S.$$arity=0),e.def(ke,"$cleanup_localstorage",N=function(){var e,t=this,r=s,n=s;return r=Object.keys(localStorage),n=d(r,"select",[],(e=function(t){e.$$s;return null==t&&(t=s),t.$match(/dropbox\-auth:default:/)},e.$$s=t,e.$$arity=1,e)),u(n["$empty?"]())||(localStorage.removeItem(n.$first()),localStorage.removeItem("systemstatus")),localStorage.setItem("zupfnoterVersion",c(Ee,"VERSION")),s},N.$$arity=0),e.def(ke,"$load_demo_tune",C=function(){var e,t=this,r=s;return r="public/demos/zndemo_42_Ich_steh_an_deiner_krippen_hier.abc",d(c(Ee,"HTTP"),"get",[r,f(["async"],{async:!1})],(e=function(t){var r=e.$$s||this;return null==r.editor&&(r.editor=s),null==t&&(t=s),r.editor.$set_text(t.$body()),t.$body()},e.$$s=t,e.$$arity=1,e))},C.$$arity=0),e.def(ke,"$render_a3",I=function(r){var n=this,a=s,i=s,l=s;return null==p.settings&&(p.settings=s),null==r&&(r=n.systemstatus["$[]"]("view")),a=p.settings["$[]"]("flowconf"),i=["flowconf",!1],d(p.settings,"[]=",e.to_a(i)),i[t(i.length,1)],l=o(c(Ee,"Harpnotes"),"PDFEngine").$new().$draw(n.$layout_harpnotes(r,"A3")),i=["flowconf",a],d(p.settings,"[]=",e.to_a(i)),i[t(i.length,1)],l},I.$$arity=-1),e.def(ke,"$render_a4",O=function(r){var n=this,a=s,i=s,l=s;return null==p.settings&&(p.settings=s),null==r&&(r=n.systemstatus["$[]"]("view")),a=p.settings["$[]"]("flowconf"),i=["flowconf",!1],d(p.settings,"[]=",e.to_a(i)),i[t(i.length,1)],l=o(c(Ee,"Harpnotes"),"PDFEngine").$new().$draw_in_segments(n.$layout_harpnotes(r,"A4")),i=["flowconf",a],d(p.settings,"[]=",e.to_a(i)),i[t(i.length,1)],l},O.$$arity=-1),e.def(ke,"$migrate_config",L=function(r){var n=this,a=s,i=s,o=s,l=s,$=s,h=s,_=s;return null==p.version&&(p.version=s),a=c(Ee,"Confstack").$new(!1),i=[!1],d(a,"strict=",e.to_a(i)),i[t(i.length,1)],o=c(Ee,"Confstack").$new(!1),i=[!1],d(o,"strict=",e.to_a(i)),i[t(i.length,1)],o.$push(r.$clone()),a.$push(r),u(r["$[]"]("extract"))&&(l=n.$migrate_config_lyrics(a),a.$push(l),$=n.$migrate_notes(a),a.$push($)),i=["$schema",c(Ee,"SCHEMA_VERSION")],d(a,"[]=",e.to_a(i)),i[t(i.length,1)],h=n.$migrate_config_cleanup(a.$get()),_=o.$get()["$=="](h)?f(["changed","message","oldversion"],{changed:!1,message:"",oldversion:o["$[]"](p.version)}):f(["changed","message","oldversion"],{changed:!0,message:c(Ee,"I18n").$t(c(Ee,"I18n").$t("Please double check the generated sheets.\n\nYour abc file was automatically migrated\nto Zupfnoter version"))+" "+c(Ee,"VERSION"),oldversion:o["$[]"]("$version")}),i=["$version",c(Ee,"VERSION")],d(h,"[]=",e.to_a(i)),i[t(i.length,1)],[h,_]},L.$$arity=1),e.def(ke,"$migrate_config_cleanup",P=function(e){var t,r=this;return u(e["$[]"]("extract"))&&d(e["$[]"]("extract"),"each",[],(t=function(e,r){var n=(t.$$s,s);return null==e&&(e=s),null==r&&(r=s),n=r["$[]"]("lyrics"),u(n)?n.$delete("versepos"):s},t.$$s=r,t.$$arity=2,t)),e},P.$$arity=1),e.def(ke,"$migrate_config_lyrics",M=function(n){var a,i=this,o=s;return o=d(n["$[]"]("extract"),"inject",[f([],{})],(a=function(n,i){var o,c=a.$$s||this,l=s,$=s,p=s;return null==n&&(n=s),null==i&&(i=s),l=i.$last()["$[]"]("lyrics"),u(l)&&(l=l["$[]"]("versepos")),u(l)&&($=d(l,"inject",[f([],{})],(o=function(n,a){var i,c=o.$$s||this,l=s,u=s;return null==n&&(n=s),null==a&&(a=s),l=d(a.$first().$gsub(","," ").$split(" "),"map",[],(i=function(e){i.$$s;return null==e&&(e=s),e.$to_i()},i.$$s=c,i.$$arity=1,i)),u=[r(n.$count(),1).$to_s(),f(["verses","pos"],{verses:l,pos:a.$last()})],d(n,"[]=",e.to_a(u)),u[t(u.length,1)],n},o.$$s=c,o.$$arity=2,o)),p=[i.$first(),f(["lyrics"],{lyrics:$})],d(n,"[]=",e.to_a(p)),p[t(p.length,1)]),n},a.$$s=i,a.$$arity=2,a)),f(["extract"],{extract:o})},M.$$arity=1),e.def(ke,"$migrate_notes",T=function(n){var a,i=this,o=s;return o=d(n["$[]"]("extract"),"inject",[f([],{})],(a=function(n,i){var o,l=a.$$s||this,$=s,p=s,h=s;return null==n&&(n=s),null==i&&(i=s),$=i.$last()["$[]"]("notes"),u($["$is_a?"](c(Ee,"Array")))&&(p=d($,"inject",[f([],{})],(o=function(n,a){var i=(o.$$s,s);return null==n&&(n=s),null==a&&(a=s),i=[r(n.$count(),1).$to_s(),a],d(n,"[]=",e.to_a(i)),i[t(i.length,1)],n},o.$$s=l,o.$$arity=2,o)),h=[i.$first(),f(["notes"],{notes:p})],d(n,"[]=",e.to_a(h)),h[t(h.length,1)]),n},a.$$s=i,a.$$arity=2,a)),f(["extract"],{extract:o})},T.$$arity=1),e.def(ke,"$play_abc",B=function(e){var t,r,n=this,a=s;return null==e&&(e="music_model"),a=u(n.systemstatus["$[]"]("harpnotes_dirty"))?n.$render_previews():c(Ee,"Promise").$new().$resolve(),d(d(a,"then",[],(t=function(){var r,n=t.$$s||this;return d(c(Ee,"Promise").$new(),"tap",[],(r=function(t){var n=r.$$s||this;return null==n.harpnote_player&&(n.harpnote_player=s),null==t&&(t=s),u(n.harpnote_player["$is_playing?"]())?(n.$call_consumers("play_stopping"),n.$stop_play_abc()):u(n.harpnote_player["$is_stopped?"]())&&(n.$call_consumers("play_start"),e["$=="]("auto")&&n.harpnote_player.$play_auto(),e["$=="]("music_model")&&n.harpnote_player.$play_song(),e["$=="]("selection")&&n.harpnote_player.$play_selection(),e["$=="]("selection_ff")&&n.harpnote_player.$play_from_selection()),t.$resolve()},r.$$s=n,r.$$arity=1,r))},t.$$s=n,t.$$arity=0,t)),"fail",[],(r=function(e){var t=r.$$s||this;return null==p.log&&(p.log=s),null==e&&(e=s),p.log.$error("bug: Error in player "+e,"./controller.rb".$force_encoding("US-ASCII"),530),t.$call_consumers("error_alert")},r.$$s=n,r.$$arity=1,r))},B.$$arity=-1),e.def(ke,"$stop_play_abc",j=function(){return this.harpnote_player.$stop()},j.$$arity=0),e.def(ke,"$render_tunepreview_in_uithread",F=function(){var t,r=this,n=s,a=s;null==p.log&&(p.log=s),r.$set_active("#tunePreview"),r.$setup_tune_preview();try{n=r.$tweak_abc_text(),d(p.log,"benchmark",["render tune preview"],(t=function(){var e=t.$$s||this,r=s;return null==e.tune_preview_printer&&(e.tune_preview_printer=s),null==e.editor&&(e.editor=s),r=e.tune_preview_printer.$compute_tune_preview(n,e.editor.$get_checksum()),e.tune_preview_printer.$set_svg(r),e.$set_inactive("#tunePreview")},t.$$s=r,t.$$arity=0,t))}catch(t){if(!e.rescue(t,[c(Ee,"Exception")]))throw t;a=t;try{p.log.$error("Bug "+a.$message(),s,s,a.$backtrace())}finally{e.pop_exception()}}return s},F.$$arity=0),e.def(ke,"$render_tunepreview__in_worker",R=function(){var t,r=this,n=s,a=s;null==p.log&&(p.log=s),r.$set_active("#tunePreview"),r.$setup_tune_preview();try{n=r.$tweak_abc_text(),d(p.log,"benchmark",["render tune preview by worker"],(t=function(){var e=t.$$s||this;return null==e.worker_tunepreview&&(e.worker_tunepreview=s),null==e.editor&&(e.editor=s),e.worker_tunepreview.$post_named_message("compute_tune_preview",f(["abc","checksum"],{abc:n,checksum:e.editor.$get_checksum()}))},t.$$s=r,t.$$arity=0,t))}catch(t){if(!e.rescue(t,[c(Ee,"Exception")]))throw t;a=t;try{p.log.$error("Bug "+a.$message(),s,s,a.$backtrace())}finally{e.pop_exception()}}return s},R.$$arity=0),e.def(ke,"$tweak_abc_text",D=function(){var e,t=this,r=s;return r=t.editor.$get_abc_part(),r=d(r.$split("\n"),"map",[],(e=function(t){var r,n=e.$$s||this,a=s;return null==t&&(t=s),a=t,u(t["$start_with?"]("W:"))&&(a=d(a,"gsub",[/(\\?)(~)/],(r=function(e){r.$$s;return null==e&&(e=s),e["$[]"](0)["$=="]("\\")?e["$[]"](1):" "},r.$$s=n,r.$$arity=1,r))),a},e.$$s=t,e.$$arity=1,e)).$join("\n")},D.$$arity=0),e.def(ke,"$render_harpnotepreview_in_worker",z=function(){var e,t=this;return null==p.log&&(p.log=s),d(p.log,"benchmark",["render_harpnotepreview_callback_by_worker"],(e=function(){var t=e.$$s||this;return null==t.worker&&(t.worker=s),null==t.systemstatus&&(t.systemstatus=s),null==t.editor&&(t.editor=s),null==p.settings&&(p.settings=s),null==p.resources&&(p.resources=s),t.$set_active("#harpPreview"),t.worker.$post_named_message("compute_harpnotes_preview",f(["settings","resources","systemstatus","uri","config_from_editor","page_format","abc_part_from_editor","checksum"],{settings:p.settings,resources:p.resources,systemstatus:t.systemstatus,uri:f(["hostname"],{hostname:t.$class().$get_uri()["$[]"]("hostname")}),config_from_editor:t.$get_config_from_editor(),page_format:"A3",abc_part_from_editor:t.editor.$get_abc_part(),checksum:t.editor.$get_checksum()}))},e.$$s=t,e.$$arity=0,e)),s},z.$$arity=0),e.def(ke,"$render_harpnotepreview_callback",q=function(){var t,r=this;return null==p.log&&(p.log=s),d(p.log,"benchmark",["render_harpnotepreview_callback"],(t=function(){var r,n,a=t.$$s||this,i=s;null==a.systemstatus&&(a.systemstatus=s),null==a.song_harpnotes&&(a.song_harpnotes=s),null==p.log&&(p.log=s);try{p.log.$debug("viewid: "+a.systemstatus["$[]"]("view")+" "+"./controller.rb".$force_encoding("US-ASCII")+" 612"),a.song_harpnotes=a.$layout_harpnotes(a.systemstatus["$[]"]("view"),"A3"),u(a.song_harpnotes)&&(d(p.log,"benchmark",["loading music to player"],(r=function(){var e=r.$$s||this;return null==e.harpnote_player&&(e.harpnote_player=s),null==e.music_model&&(e.music_model=s),null==e.song_harpnotes&&(e.song_harpnotes=s),e.harpnote_player.$load_song(e.music_model,e.song_harpnotes.$active_voices())},r.$$s=a,r.$$arity=0,r)),d(p.log,"benchmark",["drawing preview sheet"],(n=function(){var e=n.$$s||this,t=s;return null==e.harpnote_preview_printer&&(e.harpnote_preview_printer=s),null==e.song_harpnotes&&(e.song_harpnotes=s),t=e.harpnote_preview_printer.$draw(e.song_harpnotes),e.harpnote_preview_printer.$set_svg(t),e.$harpnote_preview_printer().$draw(e.song_harpnotes),e.$set_inactive("#harpPreview")},n.$$s=a,n.$$arity=0,n)),a.$set_status(f(["harpnotes_dirty"],{harpnotes_dirty:!1})))}catch(t){if(!e.rescue(t,[c(Ee,"Exception")]))throw t;i=t;try{p.log.$error("Bug "+i.$message(),s,s,i.$backtrace())}finally{e.pop_exception()}}return a.$set_status(f(["refresh"],{refresh:!1}))},t.$$s=r,t.$$arity=0,t)),s},q.$$arity=0),e.def(ke,"$render_previews",U=function(){var e=this;return null==p.log&&(p.log=s),c(Ee,"LastRenderMonitor").$new().$set_active(),e.$save_to_localstorage(),e.harpnote_preview_printer.$save_scroll_position(),e.editor.$resize(),p.log.$info("rendering"),e.$set_status(f(["harpnotes_dirty"],{harpnotes_dirty:!0})),p.log.$clear_errors(),p.log.$clear_annotations(),e.systemstatus["$[]"]("autorefresh")["$=="]("on")?e.$render_previews_in_worker():e.$render_previews_in_uithread()},U.$$arity=0),e.def(ke,"$render_previews_in_worker",H=function(){var e,t,n,a=this;return a.$render_tunepreview__in_worker(),d(d(d(c(Ee,"Promise").$new(),"tap",[],(e=function(t){e.$$s;return null==t&&(t=s),t.$resolve()},e.$$s=a,e.$$arity=1,e)),"fail",[],(t=function(){return(t.$$s||this).$alert("fail")},t.$$s=a,t.$$arity=0,t)),"then",[],(n=function(){var e,t,a=n.$$s||this;return d(d(c(Ee,"Promise").$new(),"tap",[],(e=function(t){var n=e.$$s||this;return null==n.harpnote_preview_printer&&(n.harpnote_preview_printer=s),null==n.render_stack&&(n.render_stack=s),null==t&&(t=s),n.harpnote_preview_printer.$clear(),n.render_stack.$push(r(n.render_stack.$count(),1)),n.$call_consumers("render_status"),n.render_stack.$size()["$=="](1)&&n.$render_harpnotepreview_in_worker(),t.$resolve()},e.$$s=a,e.$$arity=1,e)),"fail",[],(t=function(){return(t.$$s||this).$alert("BUG - This should never happen in render Previews "+"./controller.rb".$force_encoding("US-ASCII")+" 683")},t.$$s=a,t.$$arity=0,t))},n.$$s=a,n.$$arity=0,n))},H.$$arity=0),e.def(ke,"$render_previews_in_uithread",G=function(){var e,t,r,n=this;return n.$render_tunepreview_in_uithread(),d(d(d(c(Ee,"Promise").$new(),"tap",[],(e=function(t){e.$$s;return null==t&&(t=s),t.$resolve()},e.$$s=n,e.$$arity=1,e)),"then",[],(t=function(){var e,r,n=t.$$s||this;return d(d(c(Ee,"Promise").$new(),"tap",[],(e=function(t){var r=e.$$s||this;return null==r.harpnote_preview_printer&&(r.harpnote_preview_printer=s),null==t&&(t=s),r.harpnote_preview_printer.$clear(),r.$set_active("#harpPreview"),setTimeout(function(){r.$render_harpnotepreview_callback(),t.$resolve()},0)},e.$$s=n,e.$$arity=1,e)),"fail",[],(r=function(){return(r.$$s||this).$alert("BUG - This should never happen in render Previews "+"./controller.rb".$force_encoding("US-ASCII")+" 711")},r.$$s=n,r.$$arity=0,r))},t.$$s=n,t.$$arity=0,t)),"then",[],(r=function(){var e,t=r.$$s||this;return d(c(Ee,"Promise").$new(),"tap",[],(e=function(t){var r=e.$$s||this;return null==r.harpnote_preview_printer&&(r.harpnote_preview_printer=s),null==r.editor&&(r.editor=s),null==p.log&&(p.log=s),null==t&&(t=s),r.harpnote_preview_printer.$bind_elements(),r.$call_consumers("error_alert"),r.editor.$set_annotations(p.log.$annotations()),c(Ee,"LastRenderMonitor").$new().$clear(),t.$resolve()},e.$$s=t,e.$$arity=1,e))},r.$$s=n,r.$$arity=0,r))},G.$$arity=0),e.def(ke,"$save_file",Y=function(){var e=this,t=s,r=s,n=s;return t=o(c(Ee,"JSZip"),"ZipFile").$new(),t.$file("song.abc",e.editor.$get_text()),t.$file("harpnotes_a4.pdf",e.$render_a4().$output("blob")),t.$file("harpnotes_a3.pdf",e.$render_a3().$output("blob")),r=t.$to_blob(),n="song"+c(Ee,"Time").$now().$strftime("%d%m%Y%H%M%S")+".zip",window.saveAs(r,n)},Y.$$arity=0),e.def(ke,"$layout_harpnotes",V=function(r,n){var a,i,l,f=this,$=s,h=s;null==p.log&&(p.log=s),null==p.conf&&(p.conf=s),null==r&&(r=0),null==n&&(n="A4"),d(p.log,"benchmark",["transforming music model"],(a=function(){return(a.$$s||this).$load_music_model()},a.$$s=f,a.$$arity=0,a)),p.image_list=function(){try{return p.conf.$get()["$[]"]("resources").$keys()}catch(t){
if(!e.rescue(t,[c(Ee,"StandardError")]))throw t;try{return s}finally{e.pop_exception()}}}(),f.$set_extracts_menu();try{try{d(p.log,"benchmark",["validate default conf"],(i=function(){var e,t=i.$$s||this;return null==t.json_validator&&(t.json_validator=s),null==p.log&&(p.log=s),null==p.settings&&(p.settings=s),null==p.conf&&(p.conf=s),t.validation_errors=[],u(u(e=p.log.$loglevel()["$=="]("debug"))?e:p.settings["$[]"]("validate")["$=="]("true"))?t.validation_errors=t.json_validator.$validate_conf(p.conf):s},i.$$s=f,i.$$arity=0,i)),f.$call_consumers("document_title"),$=s,d(p.log,"benchmark",["computing layout"],(l=function(){var a=l.$$s||this,i=s,u=s;return null==a.music_model&&(a.music_model=s),i=o(o(c(Ee,"Harpnotes"),"Layout"),"Default").$new(),u=[a.$class().$get_uri()],d(i,"uri=",e.to_a(u)),u[t(u.length,1)],u=[a.$get_placeholder_replacers(r)],d(i,"placeholders=",e.to_a(u)),u[t(u.length,1)],$=i.$layout(a.music_model,s,r,n)},l.$$s=f,l.$$arity=0,l)),f.editor.$set_annotations(p.log.$annotations())}catch(t){if(!e.rescue(t,[c(Ee,"Exception")]))throw t;h=t;try{p.log.$error(""+h.$message(),s,s,h.$backtrace())}finally{e.pop_exception()}}}finally{p.conf.$pop()}return $},V.$$arity=-1),e.def(ke,"$get_placeholder_replacers",Q=function(e){var t,r,n,a,i,o,l,$,h,_,m,y,g=this;return f(["composer","key","meter","number","o_key","tempo","title","extract_title","extract_filename","printed_extracts","watermark","current_year"],{composer:d(g,"lambda",[],(t=function(){var e=t.$$s||this;return null==e.music_model&&(e.music_model=s),e.music_model.$meta_data()["$[]"]("composer")},t.$$s=g,t.$$arity=0,t)),key:d(g,"lambda",[],(r=function(){var e=r.$$s||this;return null==e.music_model&&(e.music_model=s),e.music_model.$meta_data()["$[]"]("key")},r.$$s=g,r.$$arity=0,r)),meter:d(g,"lambda",[],(n=function(){var e=n.$$s||this;return null==e.music_model&&(e.music_model=s),e.music_model.$meta_data()["$[]"]("meter").$join(" ")},n.$$s=g,n.$$arity=0,n)),number:d(g,"lambda",[],(a=function(){var e=a.$$s||this;return null==e.music_model&&(e.music_model=s),e.music_model.$meta_data()["$[]"]("number")},a.$$s=g,a.$$arity=0,a)),o_key:d(g,"lambda",[],(i=function(){var e=i.$$s||this;return null==e.music_model&&(e.music_model=s),e.music_model.$meta_data()["$[]"]("o_key")},i.$$s=g,i.$$arity=0,i)),tempo:d(g,"lambda",[],(o=function(){var e=o.$$s||this;return null==e.music_model&&(e.music_model=s),e.music_model.$meta_data()["$[]"]("tempo_display")},o.$$s=g,o.$$arity=0,o)),title:d(g,"lambda",[],(l=function(){var e=l.$$s||this;return null==e.music_model&&(e.music_model=s),e.music_model.$meta_data()["$[]"]("title")},l.$$s=g,l.$$arity=0,l)),extract_title:d(g,"lambda",[],($=function(){$.$$s;return null==p.conf&&(p.conf=s),p.conf["$[]"]("extract."+e+".title")},$.$$s=g,$.$$arity=0,$)),extract_filename:d(g,"lambda",[],(h=function(){h.$$s;return null==p.conf&&(p.conf=s),p.conf["$[]"]("extract."+e+".filenamepart")},h.$$s=g,h.$$arity=0,h)),printed_extracts:d(g,"lambda",[],(_=function(){var e,t=_.$$s||this;return null==p.conf&&(p.conf=s),d(p.conf["$[]"]("produce"),"map",[],(e=function(t){e.$$s;return null==p.conf&&(p.conf=s),null==t&&(t=s),p.conf["$[]"]("extract."+t+".filenamepart")},e.$$s=t,e.$$arity=1,e)).$join(" ")},_.$$s=g,_.$$arity=0,_)),watermark:d(g,"lambda",[],(m=function(){var e;m.$$s;return null==p.settings&&(p.settings=s),u(e=p.settings["$[]"]("watermark"))?e:""},m.$$s=g,m.$$arity=0,m)),current_year:d(g,"lambda",[],(y=function(){y.$$s;return c(Ee,"Time").$now().$year().$to_s()},y.$$s=g,y.$$arity=0,y))})},Q.$$arity=1),e.def(ke,"$load_music_model",X=function(){var r,n,a=this,i=s,l=s,u=s,f=s;return null==p.conf&&(p.conf=s),i=a.$get_config_from_editor(),p.conf.$reset_to(1),p.conf.$push(i),l=o(o(c(Ee,"Harpnotes"),"Input"),"Abc2svgToHarpnotes").$new(),n=l.$transform(a.editor.$get_abc_part()),r=e.to_ary(n),a.music_model=null==r[0]?s:r[0],u=null==r[1]?s:r[1],a.abc_model=l.$abc_model(),f=[u],d(a.harpnote_player,"player_model_abc=",e.to_a(f)),f[t(f.length,1)],f=[a.editor.$get_checksum()],d(a.music_model,"checksum=",e.to_a(f)),f[t(f.length,1)],a.document_title=a.music_model.$meta_data()["$[]"]("filename")},X.$$arity=0),e.def(ke,"$get_config_from_editor",W=function(){var t,r,n=this,a=s,i=s;return null==p.log&&(p.log=s),r=n.editor.$get_config_model(),t=e.to_ary(r),a=null==t[0]?s:t[0],i=null==t[1]?s:t[1],u(i)&&(r=n.$migrate_config(a),t=e.to_ary(r),a=null==t[0]?s:t[0],i=null==t[1]?s:t[1],u(i["$[]"]("changed"))&&(p.log.$info(i["$[]"]("message")),n.editor.$set_config_model(a,"{migrated config}",!0))),a},W.$$arity=0),e.defs(ke,"$get_uri",J=function(){var e=this,t=s;t=s,t=new URL(window.location.href);var r={};return t.search.substr(1).split("&").forEach(function(e){var t=e.split("="),n=t[0],a=t[1]&&decodeURIComponent(t[1]);(r[n]=r[n]||[]).push(a)}),t.parsed_search=r,e.$Native(t)},J.$$arity=0),e.def(ke,"$highlight_abc_object_by_player_callback",K=function(e,t){var r,n,a=this,i=s,o=s;return i=c(Ee,"Element").$find("._"+e+"_"),u(t)?(i.$add_class("highlightplay"),a.tune_preview_printer.$scroll_into_view(i.$first()),o=d(i,"select",[],(r=function(e){r.$$s;return null==e&&(e=s),e["$has_class?"]("znref")},r.$$s=a,r.$$arity=1,r)).$last(),u(o)&&a.harpnote_preview_printer.$scroll_to_element(d(i,"select",[],(n=function(e){n.$$s;return null==e&&(e=s),e["$has_class?"]("znref")},n.$$s=a,n.$$arity=1,n)).$last())):i.$remove_class("highlightplay"),s},K.$$arity=2),e.def(ke,"$highlight_abc_object",Z=function(e){var r=this,n=s,a=s,i=s;return n=r.$Native(e),a=n["$[]"]("startChar"),i=n["$[]"]("endChar"),i["$=="](a)&&(i=t(i,5)),u(r.harpnote_player["$is_playing?"]())||(r.editor.$select_range_by_position(a,i,r.expand_selection),r.$call_consumers("current_notes")),r.tune_preview_printer.$range_highlight_more(n["$[]"]("startChar"),n["$[]"]("endChar")),r.harpnote_preview_printer.$range_highlight_more(n["$[]"]("startChar"),n["$[]"]("endChar"))},Z.$$arity=1),e.def(ke,"$unhighlight_abc_object",ee=function(e){var t=this,r=s;return r=t.$Native(e),t.tune_preview_printer.$range_unhighlight_more(r["$[]"]("startChar"),r["$[]"]("endChar")),t.harpnote_preview_printer.$range_unhighlight(r["$[]"]("startChar"),r["$[]"]("endChar"))},ee.$$arity=1),e.def(ke,"$select_abc_object",te=function(e){return this.$highlight_abc_object(e)},te.$$arity=1),e.def(ke,"$select_by_time_segments",re=function(t){var r,n,a,i=this,o=s,c=s;return o=[],c=d(i.abc_model["$[]"]("voices"),"map",[],(r=function(e){r.$$s;return null==e&&(e=s),e["$[]"]("symbols")},r.$$s=i,r.$$arity=1,r)),d(t,"each",[],(n=function(t){var r,a=n.$$s||this;return null==t&&(t=s),d(c,"each",[],(r=function(n){var a,i,c=r.$$s||this,l=s;return null==n&&(n=s),l=d(d(n,"select",[],(a=function(e){a.$$s;return null==e&&(e=s),[5,6,12,14]["$include?"](e["$[]"]("type"))["$!"]()},a.$$s=c,a.$$arity=1,a)),"select",[],(i=function(r){i.$$s;return null==r&&(r=s),d(r["$[]"]("time"),"between?",e.to_a(t))},i.$$s=c,i.$$arity=1,i)),u(l["$empty?"]())?s:o.$push([l.$first(),l.$last()])},r.$$s=a,r.$$arity=1,r))},n.$$s=i,n.$$arity=1,n)),d(o,"each",[],(a=function(e){var t=a.$$s||this;return null==t.editor&&(t.editor=s),null==e&&(e=s),e["$=="](o.$first())?t.editor.$select_range_by_position(e.$first()["$[]"]("istart"),e.$last()["$[]"]("iend")):t.editor.$select_add_range_by_position(e.$first()["$[]"]("istart"),e.$last()["$[]"]("iend"))},a.$$s=i,a.$$arity=1,a))},re.$$arity=1),e.def(ke,"$get_selected_time_segments",ne=function(){var n,a=this,i=s;return null==p.log&&(p.log=s),i=a.editor.$get_selection_ranges(),p.log.$info(i.$to_json()),d(i,"map",[],(n=function(a){var i,o=n.$$s||this,l=s,f=s,$=s,h=s;return null==o.abc_model&&(o.abc_model=s),null==p.log&&(p.log=s),null==a&&(a=s),l=a.$to_a(),l.$first()["$=="](l.$last())||(l=[l.$first(),t(l.$last(),1)]),f=d(o.abc_model["$[]"]("voices"),"map",[],(i=function(t){var r,n=i.$$s||this;return null==t&&(t=s),d(t["$[]"]("symbols"),"select",[],(r=function(t){var n,a;r.$$s;return null==t&&(t=s),u(n=(u(a=t["$[]"]("iend")["$nil?"]())?a:t["$[]"]("istart")["$nil?"]())["$!"]())?u(a=d(t["$[]"]("istart"),"between?",e.to_a(l)))?a:d(t["$[]"]("iend"),"between?",e.to_a(l)):n},r.$$s=n,r.$$arity=1,r))},i.$$s=o,i.$$arity=1,i)),$=f.$flatten().$compact(),p.log.$info($.$to_json()),u($["$empty?"]())?(p.log.$error(c(Ee,"I18n").$t("your cursor is not within a voice")),h=[0,0]):h=[$.$first()["$[]"]("time"),t(r($.$last()["$[]"]("time"),$.$last()["$[]"]("dur")),1)],h},n.$$s=a,n.$$arity=1,n))},ne.$$arity=0),e.def(ke,"$set_status",ae=function(r){var n=this,a=s;return null==p.log&&(p.log=s),n.systemstatus["$merge!"](r),p.log.$debug("sytemstatus: "+n.systemstatus.$to_s()+" "+"./controller.rb".$force_encoding("US-ASCII")+" 995"),n.systemstatus["$[]"]("loglevel")["$=="](p.log.$loglevel())||(a=[n.systemstatus["$[]"]("loglevel")],d(p.log,"loglevel=",e.to_a(a)),a[t(a.length,1)]),n.$save_to_localstorage(),n.$call_consumers("systemstatus"),s},ae.$$arity=1),e.def(ke,"$set_status_dropbox_status",ie=function(){var e=this;return e.$set_status(f(["dropbox","dropboxapp","dropboxpath","dropboxloginstate"],{dropbox:e.dropboxclient.$app_name()+": "+e.dropboxpath,dropboxapp:e.dropboxclient.$app_id(),dropboxpath:e.dropboxpath,dropboxloginstate:e.dropboxloginstate}))},ie.$$arity=0),e.def(ke,"$clear_status_dropbox_status",se=function(){var e=this;return e.$set_status(f(["dropbox","dropboxapp","dropboxpath","dropboxloginstate"],{dropbox:e.dropboxclient.$app_name()+": "+e.dropboxpath,dropboxapp:s,dropboxpath:s,dropboxloginstate:s}))},se.$$arity=0),e.def(ke,"$set_extracts_menu",oe=function(){var e,t=this;return null==p.log&&(p.log=s),d(p.log,"benchmark",["prepare extract menu"],(e=function(){var t,r=e.$$s||this,n=s;return null==p.conf&&(p.conf=s),n=p.conf["$[]"]("produce"),r.extracts=d(p.conf.$get("extract"),"inject",[[]],(t=function(e,r){var a=(t.$$s,s),i=s,o=s;return null==e&&(e=s),null==r&&(r=s),a=r.$last().$dig("filenamepart"),i=function(){return u(n["$include?"](r.$first().$to_i()))?"*  ":" "}(),o=""+i+a+" "+r.$last()["$[]"]("title")+" ",e.$push([r.$first(),o])},t.$$s=r,t.$$arity=2,t)),r.$call_consumers("extracts")},e.$$s=t,e.$$arity=0,e))},oe.$$arity=0),e.def(ke,"$setup_harpnote_preview",ce=function(){var e,t,n,a,i,l,p=this;return p.harpnote_preview_printer=o(c(Ee,"Harpnotes"),"SvgEngine").$new("harpPreview",10,10),p.$set_harppreview_size([2200,1400]),p.harpnote_preview_printer.$set_view_box(0,0,420,297),d(p.harpnote_preview_printer,"on_select",[],(e=function(t){var r=e.$$s||this;return null==t&&(t=s),r.$select_abc_object(t["$[]"]("origin"))},e.$$s=p,e.$$arity=1,e)),d(p.harpnote_preview_printer,"on_drag_start",[],(t=function(e){t.$$s;return null==e&&(e=s),s},t.$$s=p,t.$$arity=1,t)),d(p.harpnote_preview_printer,"on_drag_end",[],(n=function(e){var t,a=n.$$s||this,i=s,o=s;return null==a.editor&&(a.editor=s),null==a.config_form_editor&&(a.config_form_editor=s),null==e&&(e=s),i=e["$[]"]("conf_key"),o=e["$[]"]("conf_value_new"),u(o)||(o=d(e["$[]"]("conf_value")["$[]"]("pos").$zip(e["$[]"]("delta")),"map",[],(t=function(e){t.$$s;return null==e&&(e=s),r(e.$first(),e.$last())},t.$$s=a,t.$$arity=1,t))),a.editor.$patch_config_part(i,o,"drag "+i),u(a.config_form_editor)?a.config_form_editor.$refresh_form():s},n.$$s=p,n.$$arity=1,n)),d(p.harpnote_preview_printer,"on_mouseover",[],(a=function(e){a.$$s;return null==e&&(e=s),update_mouseover_status_w2ui(e["$[]"]("conf_key"))},a.$$s=p,a.$$arity=1,a)),d(p.harpnote_preview_printer,"on_mouseout",[],(i=function(e){i.$$s;return null==e&&(e=s),update_mouseover_status_w2ui("")},i.$$s=p,i.$$arity=1,i)),d(p.harpnote_preview_printer,"on_draggable_rightcklick",[],(l=function(e){var t,r=l.$$s||this,n=s;return null==e&&(e=s),n=[],u(e["$[]"]("conf_key"))&&n.$push(f(["id","text","icon"],{id:e["$[]"]("conf_key"),text:c(Ee,"I18n").$t("Edit Config"),icon:"fa fa-gear"})),d(e["$[]"]("more_conf_keys"),"each",[],(t=function(e){var r=(t.$$s,s),a=s,i=s,o=s;return null==e&&(e=s),r=e["$[]"]("conf_key"),a=e["$[]"]("text"),i=e["$[]"]("icon"),o=e["$[]"]("value"),n.$push(f(["id","text","icon","value"],{id:r,text:a,icon:i,value:o}))},t.$$s=r,t.$$arity=1,t)),$(e["$[]"]("element")).w2menu({items:n.$to_n(),onSelect:function(e){w2ui.layout_left_tabs.click("configtab"),null!=e.item.value&&r.$handle_command("cconf "+e.item.id+" "+e.item.value),r.$handle_command("editconf "+e.item.id.$gsub(/\.[^\.]+$/,"")),null!=e.item.value&&r.$handle_command("render")}}),!1},l.$$s=p,l.$$arity=1,l))},ce.$$arity=0),e.def(ke,"$setup_tune_preview",le=function(){var e,t=this;return t.tune_preview_printer=o(c(Ee,"ABC2SVG"),"Abc2Svg").$new(c(Ee,"Element").$find("#tunePreview")),d(t.tune_preview_printer,"on_select",[],(e=function(t){var r=e.$$s||this;return null==t&&(t=s),r.$Native(t),r.$select_abc_object(t)},e.$$s=t,e.$$arity=1,e))},le.$$arity=0),e.def(ke,"$setup_harpnote_player",ue=function(){var r=this,n=s;return r.harpnote_player=o(o(c(Ee,"Harpnotes"),"Music"),"HarpnotePlayer").$new(),n=[r],d(r.harpnote_player,"controller=",e.to_a(n)),n[t(n.length,1)]},ue.$$arity=0),e.def(ke,"$set_harppreview_size",fe=function(e){var t=this;return t.harp_preview_size=e,t.harpnote_preview_printer.$set_canvas(e),t.$call_consumers("harp_preview_size")},fe.$$arity=1),e.def(ke,"$toggle_autorefresh",$e=function(){var e=this;return e.systemstatus["$[]"]("autorefresh")["$=="]("on")?e.$handle_command("autorefresh off"):e.$handle_command("autorefresh on"),e.$call_consumers("render_status")},$e.$$arity=0),e.def(ke,"$toggle_console",pe=function(){var e=this;w2ui.layout.toggle("bottom",!0),e.editor.$resize()},pe.$$arity=0),e.def(ke,"$show_console",de=function(){var e=this;w2ui.layout.show("bottom",!0),e.editor.$resize()},de.$$arity=0),e.def(ke,"$setup_worker_listners",he=function(){var r,a,i,o,l,$,h,_,m,y,g,v=this;return d(v.worker_tunepreview,"on_named_message",["compute_tune_preview"],(r=function(e){var t,n=r.$$s||this;return null==p.log&&(p.log=s),null==e&&(e=s),d(p.log,"benchmark",["preocessing reply from compute_tune_preview"],(t=function(){var r=t.$$s||this,n=s;return null==r.tune_preview_printer&&(r.tune_preview_printer=s),n=e["$[]"]("payload"),r.$set_inactive("#tunePreview"),r.tune_preview_printer.$set_svg(n)},t.$$s=n,t.$$arity=0,t))},r.$$s=v,r.$$arity=1,r)),d(v.worker,"on_named_message",["get_worker_info"],(a=function(e){var t=a.$$s||this;return null==e&&(e=s),t.worker_info=e["$[]"]("payload")},a.$$s=v,a.$$arity=1,a)),d(v.worker,"on_named_message",["set_logger_status"],(i=function(e){var t=i.$$s||this;return null==t.editor&&(t.editor=s),null==p.log&&(p.log=s),null==e&&(e=s),t.editor.$set_annotations(p.log.$annotations())},i.$$s=v,i.$$arity=1,i)),d(v.worker,"on_named_message",["compute_harpnotes_preview"],(o=function(e){var t,r=o.$$s||this;return null==p.log&&(p.log=s),null==e&&(e=s),d(p.log,"benchmark",["processing reply from compute_harpnotes_preview"],(t=function(){var r=t.$$s||this,a=s;return null==r.render_stack&&(r.render_stack=s),null==r.harpnote_preview_printer&&(r.harpnote_preview_printer=s),null==r.harp_preview_size&&(r.harp_preview_size=s),null==r.editor&&(r.editor=s),null==p.log&&(p.log=s),a=e["$[]"]("payload"),u(n(r.render_stack.$size(),1))&&(r.harpnote_preview_printer.$set_svg(a),r.$set_harppreview_size(r.harp_preview_size),r.$set_status(f(["harpnotes_dirty"],{harpnotes_dirty:!1})),r.$set_status(f(["refresh"],{refresh:!1})),r.$set_inactive("#harpPreview"),c(Ee,"LastRenderMonitor").$new().$clear(),r.editor.$set_annotations(p.log.$annotations())),r.render_stack.$shift(),r.$call_consumers("render_status"),u(r.render_stack["$empty?"]())||(r.render_stack.$clear(),r.$render_previews()),s},t.$$s=r,t.$$arity=0,t))},o.$$s=v,o.$$arity=1,o)),d(v.worker,"on_named_message",["error_alert"],(l=function(e){var t=l.$$s||this;return null==e&&(e=s),t.$call_consumers("error_alert")},l.$$s=v,l.$$arity=1,l)),d(v.worker,"on_named_message",["update_ui"],($=function(e){var t=$.$$s||this;return null==e&&(e=s),t.extracts=e["$[]"]("payload")["$[]"]("extracts"),t.$call_consumers("extracts"),t.document_title=e["$[]"]("payload")["$[]"]("document_title"),t.$call_consumers("document_title")},$.$$s=v,$.$$arity=1,$)),d(v.worker,"on_named_message",["load_player_model_abc"],(h=function(r){var n,a=h.$$s||this;return null==p.log&&(p.log=s),null==r&&(r=s),d(p.log,"benchmark",["preocessing reply from load_player_model_abc"],(n=function(){var a=n.$$s||this,i=s;return null==a.harpnote_player&&(a.harpnote_player=s),i=[JSON.parse(r["$[]"]("payload"))],d(a.harpnote_player,"player_model_abc=",e.to_a(i)),i[t(i.length,1)]},n.$$s=a,n.$$arity=0,n))},h.$$s=v,h.$$arity=1,h)),d(v.worker,"on_named_message",["load_player_from_worker"],(_=function(e){var t,r=_.$$s||this;return null==p.log&&(p.log=s),null==e&&(e=s),d(p.log,"benchmark",["preocessing reply from load_player_model"],(t=function(){var r=t.$$s||this;return null==r.harpnote_player&&(r.harpnote_player=s),r.harpnote_player.$set_worker_model(e["$[]"]("payload"))},t.$$s=r,t.$$arity=0,t))},_.$$s=v,_.$$arity=1,_)),d(v.worker,"on_named_message",["load_abc_model"],(m=function(e){var t,r=m.$$s||this;return null==p.log&&(p.log=s),null==e&&(e=s),d(p.log,"benchmark",["preocessing reply from load_abc_model"],(t=function(){return(t.$$s||this).abc_model=e["$[]"]("payload")},t.$$s=r,t.$$arity=0,t))},m.$$s=v,m.$$arity=1,m)),d(v.worker,"on_named_message",["log"],(y=function(e){y.$$s;return null==p.log&&(p.log=s),null==e&&(e=s),p.log.$log_from_worker(e["$[]"]("payload"))},y.$$s=v,y.$$arity=1,y)),d(v.worker,"on_named_message",["rescue_from_worker_error"],(g=function(e){var t=g.$$s||this;return null==t.render_stack&&(t.render_stack=s),null==e&&(e=s),t.render_stack.$clear(),t.$call_consumers("error_alert"),t.$call_consumers("render_status")},g.$$s=v,g.$$arity=1,g))},he.$$arity=0),e.def(ke,"$setup_ui_listener",_e=function(){var e,t,n,a,i,o,l,$,_,m=this;return null==p.window&&(p.window=s),d(m.editor,"on_change",[],(e=function(t){var r=e.$$s||this;return null==t&&(t=s),r.$set_status(f(["music_model"],{music_model:"changed"})),r.$set_status(f(["harpnotes_dirty"],{harpnotes_dirty:!0})),r.$request_refresh(!0),s},e.$$s=m,e.$$arity=1,e)),d(m.editor,"on_selection_change",[],(t=function(e){var r,n=t.$$s||this,a=s;return null==n.editor&&(n.editor=s),null==n.harpnote_preview_printer&&(n.harpnote_preview_printer=s),null==n.tune_preview_printer&&(n.tune_preview_printer=s),null==e&&(e=s),a=n.editor.$get_selection_ranges(),n.editor.$get_selection_info(),n.harpnote_preview_printer.$unhighlight_all(),n.tune_preview_printer.$unhighlight_all(),d(a,"each",[],(r=function(e){var t=r.$$s||this;return null==t.harpnote_preview_printer&&(t.harpnote_preview_printer=s),null==t.tune_preview_printer&&(t.tune_preview_printer=s),null==t.harpnote_player&&(t.harpnote_player=s),null==e&&(e=s),t.harpnote_preview_printer.$range_highlight_more(e.$first(),e.$last()),t.tune_preview_printer.$range_highlight_more(e.$first(),e.$last()),t.harpnote_player.$range_highlight(e.$first(),e.$last())},r.$$s=n,r.$$arity=1,r))},t.$$s=m,t.$$arity=1,t)),d(m.editor,"on_cursor_change",[],(n=function(e){var t=n.$$s||this,a=s,i=s,o=s,c=s,l=s,$=s;return null==t.editor&&(t.editor=s),null==e&&(e=s),t.$request_refresh(!1),a=t.editor.$get_selection_info(),i=t.editor.$get_selection_ranges(),o=a["$[]"]("selection"),c=o.$first().$first()+":"+o.$first().$last(),o.$first()["$=="](o.$last())||(c=r(c," - "+o.$last().$first()+":"+o.$last().$last())),l=u(a["$[]"]("token"))?a["$[]"]("token"):f(["type","value"],{type:"",value:""}),$=f(["position","tokeninfo","token","selections"],{position:c,tokeninfo:l["$[]"]("type")+" ["+l["$[]"]("value")+"]",token:l,selections:i}),update_editor_status_w2ui($.$to_n())},n.$$s=m,n.$$arity=1,n)),d(m.harpnote_player,"on_noteon",[],(a=function(e){var t=a.$$s||this;return null==p.settings&&(p.settings=s),null==e&&(e=s),p.settings["$[]"]("follow")["$=="]("false")?s:t.$highlight_abc_object_by_player_callback(e["$[]"]("startChar"),!0)},a.$$s=m,a.$$arity=1,a)),d(m.harpnote_player,"on_noteoff",[],(i=function(e){var t=i.$$s||this;return null==p.settings&&(p.settings=s),null==e&&(e=s),p.settings["$[]"]("follow")["$=="]("false")?s:t.$highlight_abc_object_by_player_callback(e["$[]"]("startChar"),!1)},i.$$s=m,i.$$arity=1,i)),d(m.harpnote_player,"on_songoff",[],(o=function(){var e=o.$$s||this;return e.$stop_play_abc(),e.$call_consumers("play_stop")},o.$$s=m,o.$$arity=0,o)),d(p.window,"on",["mousedown"],(l=function(e){var t=l.$$s||this;return null==e&&(e=s),t.expand_selection=e.$shift_key(),!0},l.$$s=m,l.$$arity=1,l)),d(c(Ee,"Element").$find("body"),"on",["keydown"],($=function(e){var t,r,n=$.$$s||this,a=s;return null==n.editor&&(n.editor=s),null==n.zupfnoter_ui&&(n.zupfnoter_ui=s),null==e&&(e=s),u(e.$alt_key())?s:u(u(t=e.$meta_key())?t:e.$ctrl_key())?function(){return a=e.$key_code(),"A".$ord()["$==="](a)?n.editor.$select_range_by_position(0,1e4):"R".$ord()["$==="](a)||13["$==="](a)?(e.$prevent(),n.$handle_command("render")):"S".$ord()["$==="](a)?(e.$prevent(),n.$handle_command("dsave")):"P".$ord()["$==="](a)?(e.$prevent(),n.$play_abc("auto")):"K".$ord()["$==="](a)?(e.$prevent(),n.$toggle_console()):"L".$ord()["$==="](a)?(n.zupfnoter_ui.toggle_full_screen(),e.$prevent()):function(e){for(var t=0,r=e.length;t<r;t++)if(e[t]["$==="](a))return!0;return!1}(d(h(0,9,!1),"map",[],(r=function(e){r.$$s;return null==e&&(e=s),e.$to_s().$ord()},r.$$s=n,r.$$arity=1,r)))?(e.$prevent(),n.$handle_command("view "+e.$key_code().$chr())):s}():s},$.$$s=m,$.$$arity=1,$)),d(c(Ee,"Element").$find(window),"on",["storage"],(_=function(e){var t,r=_.$$s||this,n=s,a=s;return null==r.systemstatus&&(r.systemstatus=s),null==p.log&&(p.log=s),null==e&&(e=s),n=r.$Native(e["$[]"]("originalEvent")).$key(),a=r.$Native(e["$[]"]("originalEvent")).$newValue(),p.log.$debug("got storage event "+n+": "+a+" ("+"./controller.rb".$force_encoding("US-ASCII")+" 1372)"),u(u(t=r.systemstatus["$[]"]("autorefresh")["$=="]("remote")?n["$=="]("command"):r.systemstatus["$[]"]("autorefresh")["$=="]("remote"))?a["$=="]("render"):t)?r.$load_from_loacalstorage():s},_.$$s=m,_.$$arity=1,_))},_e.$$arity=0),e.def(ke,"$show_message_of_the_day",me=function(){var e=this,t=s,r=s;t=[],r=e.info_url+"/feed/",$.get(r,function(r){$(r).find("item").each(function(){var e=$(this);t.push({title:e.find("title").text(),description:e.find("description").text(),link:e.find("link").text(),pubDate:e.find("pubDate").text(),postId:e.find("post-id").text()})}),e.$present_message_of_the_day(t)})},me.$$arity=0),e.def(ke,"$present_message_of_the_day",ye=function(e){var t,n,i,o,l=this,$=s,p=s,h=s,_=s,m=s,y=s;if($=l.$Native(e.$first())["$[]"]("postId").$to_i(),p=u(t=l.$systemstatus()["$[]"]("last_read_info_id"))?t:0,h=d(l,"lambda",[],(n=function(){return(n.$$s||this).$set_status(f(["last_read_info_id"],{last_read_info_id:$}))},n.$$s=l,n.$$arity=0,n)),_=d(l,"lambda",[],(i=function(){i.$$s;return s},i.$$s=l,i.$$arity=0,i)),m='<h3><a href="'+l.info_url+'" target="_blank">'+c(Ee,"I18n").$t("read now")+"</a></h3>",m=r(m,d(e,"map",[],(o=function(e){var t=o.$$s||this,r=s,n=s;return null==e&&(e=s),r=t.$Native(e),n=r["$[]"]("postId"),r["$[]"]("description"),'<div style="text-align:left;"><p>'+n+": "+r["$[]"]("title")+"</p></div>"},o.$$s=l,o.$$arity=1,o)).$join()),y=f(["msg","title","width","height","modal","btn_yes","btn_no","callBack"],{msg:m,title:c(Ee,"I18n").$t("There is new unread information"),width:600,height:200,modal:!0,btn_yes:f(["text","class","style","callBack"],{text:c(Ee,"I18n").$t("already read"),class:"",style:"",callBack:h}),btn_no:f(["text","class","style","callBack"],{text:c(Ee,"I18n").$t("read later"),class:"",style:"",callBack:_}),callBack:s}),!u(a($,p)))return s;w2confirm(y.$to_n())},ye.$$arity=1),e.def(ke,"$request_refresh",ge=function(e){var t,r=this,n=s;return u(e)&&r.$set_status(f(["refresh"],{refresh:!0})),u(r.refresh_timer["$empty?"]())||d(r.refresh_timer,"each",[],(t=function(e){var r=t.$$s||this;return null==r.refresh_timer&&(r.refresh_timer=s),null==e&&(e=s),clearTimeout(e),r.refresh_timer.$pop()},t.$$s=r,t.$$arity=1,t)),u(r.systemstatus["$[]"]("refresh"))?(r.$stop_play_abc(),function(){return n=r.systemstatus["$[]"]("autorefresh"),"on"["$==="](n)?r.refresh_timer.$push(setTimeout(function(){r.$render_previews()},600)):"off"["$==="](n)?r.refresh_timer.$push(setTimeout(function(){r.$render_tunepreview_in_uithread()},600)):("remote"["$==="](n),s)}()):s},ge.$$arity=1),e.def(ke,"$send_remote_command",ve=function(e){return localStorage.setItem("command",""),localStorage.setItem("command",e)},ve.$$arity=1),e.def(ke,"$set_active",be=function(e){return c(Ee,"Element").$find(e).$add_class("spinner")},be.$$arity=1),e.def(ke,"$set_inactive",xe=function(e){return c(Ee,"Element").$find(e).$remove_class("spinner")},xe.$$arity=1),e.def(ke,"$check_suppoerted_browser",we=function(){var e=s,t=s;return null==p.log&&(p.log=s),e=["Chrome","Firefox","Vivaldi","Opera"],u(e["$include?"](bowser.name))?s:(t=r(c(Ee,"I18n").$t("Unsupported browser. Please use one of "),e.$to_s()),p.log.$warning(t),alert(t))},we.$$arity=0),e.def(ke,"$_init_conf",Ae=function(){return c(Ee,"InitConf").$init_conf()},Ae.$$arity=0),s&&"_init_conf"}(i[0],0,i)},Opal.modules["controller-cli"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}var n=(e.top,[]),a=e.nil,i=e.const_get_qualified,s=e.const_get_relative,o=(e.breaker,e.slice,e.klass),c=e.hash2,l=e.gvars,u=e.send,f=e.truthy,$=e.module,p=e.range;return e.add_stubs(["$new","$loglevel=","$-","$info","$strict=","$push","$_init_conf","$set_text","$patch_config_part","$get_config_from_editor","$reset_to","$get","$create_engine","$transform","$get_abc_part","$get_checksum","$checksum=","$layout_harpnotes","$include?","$[]","$meta_data","$dig","$harpnote_options","$raise","$each","$output","$render_a3","$[]=","$t","$jspdfversion","$last","$split","$get_candidate_keys","$map","$join","$to_s","$first","$compact","$gsub","$length","$+","$reverse","$lambda","$_split_parts","$_clean_models","$each_with_index","$==","$start_with?","$_set_config_json","$_set_resources_json","$error"]),function(t,r,n){var a,i=o(t,null,"Controller");[i].concat(n);e.defs(i,"$get_uri",a=function(){return c(["hostname"],{hostname:"zupfnoter-cli"})},a.$$arity=0)}(n[0],0,n),function(r,n,$){var p,d,h,_,m,y,g,v=o(r,n,"CliController"),b=[v].concat($);v.$$prototype.editor=v.$$prototype.music_model=a,e.def(v,"$initialize",p=function(){var r=this,n=a;return null==l.log&&(l.log=a),null==l.conf&&(l.conf=a),l.log=s(b,"NodeLogger").$new("x.log"),n=["warning"],u(l.log,"loglevel=",e.to_a(n)),n[t(n.length,1)],l.log.$info("Welcome to Zupfnoter"),l.log.$info("Zupfnoter "+s(b,"VERSION")),l.log.$info("Opal:     "+s(b,"RUBY_ENGINE_VERSION")),l.log.$info("Ruby:     "+s(b,"RUBY_VERSION")),l.log.$info("Abc2svg:  "+abc2svg.version),l.conf=s(b,"Confstack").$new(a),n=[!1],u(l.conf,"strict=",e.to_a(n)),n[t(n.length,1)],l.conf.$push(r.$_init_conf()),l.settings=c([],{}),r.editor=s(b,"TextPaneEmulatorForCli").$new(),r.json_validator=i(s(b,"Ajv"),"JsonValidator").$new()},p.$$arity=0),e.def(v,"$set_abc_input",d=function(e){return this.editor.$set_text(e)},d.$$arity=1),e.def(v,"$call_consumers",h=function(e){return a},h.$$arity=1),e.def(v,"$apply_config",_=function(e){return this.editor.$patch_config_part("",e,"from json file")},_.$$arity=1),e.def(v,"$load_music_model",m=function(){var r,n,o=this,c=a,f=a,$=a,p=a;return null==l.conf&&(l.conf=a),c=o.$get_config_from_editor(),l.conf.$reset_to(1),l.conf.$push(c),f=l.conf.$get("abc_parser"),$=i(i(s(b,"Harpnotes"),"Input"),"ABCToHarpnotesFactory").$create_engine(f),n=$.$transform(o.editor.$get_abc_part()),r=e.to_ary(n),o.music_model=null==r[0]?a:r[0],o.player_model_abc=null==r[1]?a:r[1],p=[o.editor.$get_checksum()],u(o.music_model,"checksum=",e.to_a(p)),p[t(p.length,1)]},m.$$arity=0),e.def(v,"$produce_pdfs",y=function(r){var n,i=this,s=a,o=a,l=a,$=a;return i.$layout_harpnotes(),f(i.music_model.$meta_data()["$[]"]("filename")["$include?"]("{{"))?(!0,s=i.music_model.$harpnote_options().$dig("template","filebase"),f(s)||i.$raise("no filebase given for template"),o=[]):(o=i.music_model.$harpnote_options()["$[]"]("print"),s=i.music_model.$meta_data()["$[]"]("filename")),l=r,$=c([],{}),u(o,"each",[],(n=function(r){var i=n.$$s||this,o=a,c=a;return null==r&&(r=a),o=r["$[]"]("view_id"),c=[l+"/"+s+"_"+r["$[]"]("filenamepart")+"_a3.pdf",i.$render_a3(o).$output("raw")],u($,"[]=",e.to_a(c)),c[t(c.length,1)],a},n.$$s=i,n.$$arity=1,n)),$},y.$$arity=1),e.def(v,"$about_zupfnoter",g=function(){return s(b,"I18n").$t("Free software to create sheets for table harps")+"\n          Zupfnoter: "+s(b,"VERSION")+"\n          Opal     : "+s(b,"RUBY_ENGINE_VERSION")+"\n          Ruby     : "+s(b,"RUBY_VERSION")+"\n          abc2svg  : "+abc2svg.version+"\n          jsPD     : "+s(b,"JsPDF").$jspdfversion()+"\n          Website  : https://www.zupfnoter.de\n    "},g.$$arity=0)}(n[0],s(n,"Controller"),n),function(n,i){var s,o,c,p,d,h,_=$(n,"I18n");[_].concat(i);e.defs(_,"$t",s=function(e){return e},s.$$arity=1),e.defs(_,"$t_key",o=function(e){return this.$t(e.$split(".").$last())},o.$$arity=1),e.defs(_,"$t_help",c=function(e){var t,r,n,i=this,s=a,o=a,c=a;return s=i.$get_candidate_keys(e),o=u(s,"map",[],(t=function(e){t.$$s;return null==l.conf_helptext&&(l.conf_helptext=a),null==e&&(e=a),l.conf_helptext["$[]"](e.$join("."))},t.$$s=i,t.$$arity=1,t)),s=u(s,"map",[],(r=function(e){r.$$s;return null==e&&(e=a),e.$join(".")},r.$$s=i,r.$$arity=1,r)).$to_s(),c=f(n=o.$compact().$first())?n:"no help for "+s,"<h2>"+e+'</h2><div style="padding:0.5em;width:30em;">'+c+"</div>"},c.$$arity=1),e.defs(_,"$get_candidate_keys",p=function(n){var i,s,o,c,f,$,p=this,d=a,h=a,_=a,m=a;return d=n,d=u(d,"gsub",[/^(extract\.)(\d+)(.*)$/],(i=function(){var e;i.$$s;return((e=l["~"])===a?a:e["$[]"](1))+"0"+((e=l["~"])===a?a:e["$[]"](3))},i.$$s=p,i.$$arity=0,i)),d=u(d,"gsub",[/^(extract\.0\.lyrics\.)(\d+)(.*)$/],(s=function(){var e;s.$$s;return((e=l["~"])===a?a:e["$[]"](1))+"0"+((e=l["~"])===a?a:e["$[]"](3))},s.$$s=p,s.$$arity=0,s)),d=u(d,"gsub",[/^(extract\.0\.images\.)(\d+)(.*)$/],(o=function(){var e;o.$$s;return((e=l["~"])===a?a:e["$[]"](1))+"0"+((e=l["~"])===a?a:e["$[]"](3))},o.$$s=p,o.$$arity=0,o)),d=u(d,"gsub",[/^(extract\.0\.notes\.)([a-zA-SU-Z_0-9]+)(.*)$/],(c=function(){var e;c.$$s;return((e=l["~"])===a?a:e["$[]"](1))+"0"+((e=l["~"])===a?a:e["$[]"](3))},c.$$s=p,c.$$arity=0,c)),d=u(d,"gsub",[/^(extract\.0\.tuplet\.)([a-zA-SU-Z_0-9]+)(.*)$/],(f=function(){var e;f.$$s;return((e=l["~"])===a?a:e["$[]"](1))+"0"+((e=l["~"])===a?a:e["$[]"](3))},f.$$s=p,f.$$arity=0,f)),h=d.$split("."),_=[],m=[],u(e.Range.$new(0,t(h.$length(),1),!1),"each",[],($=function(t){$.$$s;return null==t&&(t=a),m.$push(h["$[]"](e.Range.$new(t,-1,!1)))},$.$$s=p,$.$$arity=1,$)),r(m,_.$reverse())},p.$$arity=1),e.defs(_,"$locale",d=function(e){return a},d.$$arity=1),e.defs(_,"$phrases",h=function(){return a},h.$$arity=0)}(n[0],n),function(t,n,i){var c,$,d,h,_,m,y,g,v,b,x,w=o(t,n,"TextPaneEmulatorForCli"),A=[w].concat(i);return w.$$prototype.abc_part=w.$$prototype.config_separator=a,e.def(w,"$initialize",c=function(){var e,t=this;return t.abc_text=a,t.config_separator="%%%%zupfnoter",t.on_change=u(t,"lambda",[],(e=function(){e.$$s;return a},e.$$s=t,e.$$arity=0,e)),t.config_undo=s(A,"UndoManager").$new()},c.$$arity=0),e.def(w,"$get_abc_part",$=function(){return this.abc_part},$.$$arity=0),e.def(w,"$set_text",d=function(e){return this.$_split_parts(e)},d.$$arity=1),e.def(w,"$_split_parts",h=function(e){var t,n=this;return n.$_clean_models(),u(e.$split(n.config_separator),"each_with_index",[],(t=function(e,n){var i=t.$$s||this;return null==l.log&&(l.log=a),null==e&&(e=a),null==n&&(n=a),n["$=="](0)?i.abc_part=e:f(e["$start_with?"](".config"))?i.$_set_config_json(e.$split(".config").$last(),"from loaded abc",!0):f(e["$start_with?"](".resources"))?i.$_set_resources_json(e.$split(".resources").$last()):l.log.$error(r(s(A,"I18n").$t("unsupported section found in abc file: "),e["$[]"](p(0,10,!1))))},t.$$s=n,t.$$arity=2,t))},h.$$arity=1),e.def(w,"$_get_abc_from_editor",_=function(){return this.abc_part},_.$$arity=0),e.def(w,"$set_config_part",m=function(e){return a},m.$$arity=1),
e.def(w,"$clear_markers",y=function(){return a},y.$$arity=0),e.def(w,"$set_markers",g=function(){return a},g.$$arity=0),e.def(w,"$set_annotations",v=function(){return a},v.$$arity=0),e.def(w,"$save_to_localstorage",b=function(e){return null==e&&(e=a),a},b.$$arity=-1),e.def(w,"$clean_localstorage",x=function(){return a},x.$$arity=0),a&&"clean_localstorage"}(n[0],i(s(n,"Harpnotes"),"TextPane"),n)},Opal.modules.confstack2=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}var n=e.top,a=[],i=e.nil,s=e.const_get_qualified,o=e.const_get_relative,c=(e.breaker,e.slice,e.klass),l=e.truthy,u=e.send,f=e.hash2,$=e.hash,p=e.range;return e.add_stubs(["$to_n","$duplicable?","$dup","$map","$to_proc","$each_pair","$===","$deep_dup","$[]=","$-","$delete","$deep_merge!","$[]","$is_a?","$deep_merge","$key?","$call","$inject","$respond_to?","$keys","$join","$compact","$push","$digkeys","$require","$attr_accessor","$+","$push_from_env","$first","$caller","$last","$count","$new","$get_from_env","$to_json","$push_to_env","$include?","$nil?","$parse","$pop","$get","$open","$puts","$to_yaml","$has_key?","$dig","$split","$!","$raise","$==","$_resolve_dependencies","$each","$each_with_index","$_get_one","$select","$to_i","$reverse","$private","$index","$class","$_resolve_value_dependency","$_resolve_hash_dependency","$_resolve_array_dependency"]),function(t,r,n){var a,i=c(t,null,"Object");[i].concat(n);e.def(i,"$duplicable?",a=function(){return!0},a.$$arity=0)}(a[0],0,a),function(t,r,n){var a,i=c(t,null,"NilClass");[i].concat(n);e.def(i,"$duplicable?",a=function(){return!1},a.$$arity=0)}(a[0],0,a),function(t,r,n){var a,i=c(t,null,"FalseClass");[i].concat(n);e.def(i,"$duplicable?",a=function(){return!1},a.$$arity=0)}(a[0],0,a),function(t,r,n){var a,i=c(t,null,"TrueClass");[i].concat(n);e.def(i,"$duplicable?",a=function(){return!1},a.$$arity=0)}(a[0],0,a),function(t,r,n){var a,i=c(t,null,"Symbol");[i].concat(n);e.def(i,"$duplicable?",a=function(){return!1},a.$$arity=0)}(a[0],0,a),function(t,r,n){var a,i=c(t,null,"Numeric");[i].concat(n);e.def(i,"$duplicable?",a=function(){return!1},a.$$arity=0)}(a[0],0,a),function(t,r,n){var a,i=c(t,null,"BigDecimal");[i].concat(n);e.def(i,"$duplicable?",a=function(){return!0},a.$$arity=0)}(a[0],0,a),function(t,r,n){var a,i=c(t,null,"Method");[i].concat(n);e.def(i,"$duplicable?",a=function(){return!1},a.$$arity=0)}(a[0],0,a),function(t,r,n){var a,i=c(t,null,"String");[i].concat(n);e.def(i,"$deep_dup",a=function(){return this.$to_n()},a.$$arity=0)}(a[0],0,a),function(t,r,n){var a,i=c(t,null,"Numerical");[i].concat(n);e.def(i,"$deep_dup",a=function(){return this.$to_n()},a.$$arity=0)}(a[0],0,a),function(t,r,n){var a,i=c(t,null,"Object");[i].concat(n);e.def(i,"$deep_dup",a=function(){var e=this;return l(e["$duplicable?"]())?e.$dup():e},a.$$arity=0)}(a[0],0,a),function(t,r,n){var a,i=c(t,null,"Array");[i].concat(n);e.def(i,"$deep_dup",a=function(){return u(this,"map",[],"deep_dup".$to_proc())},a.$$arity=0)}(a[0],0,a),function(r,n,a){var f,$,p,d=c(r,null,"Hash"),h=[d].concat(a);e.def(d,"$deep_dup",f=function(){var r,n=this,a=i;return a=n.$dup(),u(n,"each_pair",[],(r=function(n,o){var c,f=(r.$$s,i);return null==n&&(n=i),null==o&&(o=i),l(l(c=!1)?s("::","String")["$==="](n):c)?(f=[n,o.$deep_dup()],u(a,"[]=",e.to_a(f)),f[t(f.length,1)]):(a.$delete(n),f=[n.$deep_dup(),o.$deep_dup()],u(a,"[]=",e.to_a(f)),f[t(f.length,1)])},r.$$s=n,r.$$arity=2,r)),a},f.$$arity=0),e.def(d,"$deep_merge",$=function(e){var t=$.$$p,r=t||i,n=this;return t&&($.$$p=null),t&&($.$$p=null),u(n.$dup(),"deep_merge!",[e],r.$to_proc())},$.$$arity=1),e.def(d,"$deep_merge!",p=function(r){var n,a=p.$$p,s=a||i,c=this;return a&&(p.$$p=null),a&&(p.$$p=null),u(r,"each_pair",[],(n=function(r,a){var c,f=n.$$s||this,$=i,p=i;return null==r&&(r=i),null==a&&(a=i),$=f["$[]"](r),p=[r,function(){return l(l(c=$["$is_a?"](o(h,"Hash")))?a["$is_a?"](o(h,"Hash")):c)?u($,"deep_merge",[a],s.$to_proc()):l((c=s!==i)?f["$key?"](r):s!==i)?s.$call(r,$,a):a}()],u(f,"[]=",e.to_a(p)),p[t(p.length,1)]},n.$$s=c,n.$$arity=2,n)),c},p.$$arity=1)}(a[0],0,a),function(t,r,n){var a,s,o=c(t,null,"Hash");[o].concat(n);e.def(o,"$dig",a=function(t){var r,n,a,s=this;return r=e.slice.call(arguments,0,arguments.length),n=r,u(n,"inject",[s],(a=function(e,t){a.$$s;return null==e&&(e=i),null==t&&(t=i),l(e["$respond_to?"]("keys"))?e["$[]"](t):i},a.$$s=s,a.$$arity=2,a))},a.$$arity=-1),e.def(o,"$digkeys",s=function(e,t){var r,n=this;return null==e&&(e=[]),null==t&&(t=i),u(n.$keys(),"inject",[e],(r=function(e,n){var a=r.$$s||this,s=i;return null==e&&(e=i),null==n&&(n=i),s=[t,n].$compact().$join("."),e.$push(s),l(a["$[]"](n)["$respond_to?"]("keys"))&&a["$[]"](n).$digkeys(e,s),e},r.$$s=n,r.$$arity=2,r))},s.$$arity=-1)}(a[0],0,a),n.$require("json"),function(n,a,s){var d,h,_,m,y,g,v,b,x,w,A,k,E,S,N,C,I,O,L=c(n,null,"Confstack"),P=[L].concat(s);return L.$$prototype.confstack_name=L.$$prototype.sourcestack=L.$$prototype.confstack=L.$$prototype.lookup_cache=L.$$prototype.strict=L.$$prototype.confresult_cache=L.$$prototype.callstack=i,function(e,t,r){var n=c(e,null,"DeleteMe");[n].concat(r)}(P[0],0,P),L.$attr_accessor("strict"),e.def(L,"$initialize",d=function(e){var t=this;return null==e&&(e="default"),t.callstack=[],t.confstack=[f([],{})],t.lookup_cache=f([],{}),t.confresult_cache=f([],{}),t.sourcestack=[],t.strict=!0,l(e)&&(t.confstack_name=r("confstack__",e),t.$push(f(["confstack"],{confstack:f(["env"],{env:t.confstack_name})})),t.$push_from_env()),t},d.$$arity=-1),e.def(L,"$push",h=function(e){var t=this,r=i;return null==e&&(e=f([],{})),t.confresult_cache=f([],{}),t.lookup_cache=f([],{}),l(e["$is_a?"](o(P,"Hash")))&&(t.sourcestack.$push(t.$caller().$first()),r=t.confstack.$last().$deep_dup().$deep_merge(e),t.confstack.$push(r)),t.confstack.$count()},h.$$arity=-1),e.def(L,"$push_to_env",_=function(r){var n=this,a=i,s=i,c=i,l=i;return null==r&&(r=f([],{})),a=o(P,"Confstack").$new(!1),a.$push(n.$get_from_env()),a.$push(r),s=a["$[]"](),c=s.$to_json(),l=[n["$[]"]("confstack.env"),c],u(o(P,"ENV"),"[]=",e.to_a(l)),l[t(l.length,1)],n.$push(r)},_.$$arity=-1),e.def(L,"$push_from_env",m=function(){var e=this;return e.$push_to_env(e.$get_from_env())},m.$$arity=0),e.def(L,"$get_from_env",y=function(){var e=this,t=i,r=i;return t=f([],{}),l(e.$keys()["$include?"]("confstack.env"))&&(r=o(P,"ENV")["$[]"](e["$[]"]("confstack.env")),l(r["$nil?"]())||(t=o(P,"JSON").$parse(r))),t},y.$$arity=0),e.def(L,"$pop",g=function(){var e=this;return e.lookup_cache=f([],{}),e.sourcestack.$pop(),e.confstack.$pop(),e.confstack.$count()},g.$$arity=0),e.def(L,"$reset_to",v=function(t){var r=this;return r.lookup_cache=f([],{}),r.sourcestack=r.sourcestack["$[]"](e.Range.$new(0,t,!1)),r.confstack=r.confstack["$[]"](e.Range.$new(0,t,!1)),r.confstack.$count()},v.$$arity=1),e.def(L,"$save",b=function(e){var t,r,n=this,a=i;return a=n.$get(),u(o(P,"File"),"open",[e+".yaml","w"],(t=function(e){t.$$s;return null==e&&(e=i),e.$puts(a.$to_yaml())},t.$$s=n,t.$$arity=1,t)),u(o(P,"File"),"open",[e+".json","w"],(r=function(e){r.$$s;return null==e&&(e=i),e.$puts(a.$to_json())},r.$$s=n,r.$$arity=1,r))},b.$$arity=1),e.def(L,"$get",x=function(r,n){var a,s,o=this,c=i,$=i;return null==r&&(r=i),null==n&&(n=f(["resolve"],{resolve:!0})),l(r["$nil?"]())?c=o.confstack.$last():l(o.lookup_cache["$has_key?"](r))?c=o.lookup_cache["$[]"](r):(c=u(o.confstack.$last(),"dig",e.to_a(r.$split("."))),$=[r,c],u(o.lookup_cache,"[]=",e.to_a($)),$[t($.length,1)],l(c)||l(l(a=l(s=c["$nil?"]())?o.$keys()["$include?"](r)["$!"]():s)?o.strict:a)&&o.$raise("confstack: key not available: "+r)),n["$[]"]("resolve")["$=="](!0)&&(c=o.$_resolve_dependencies(r,c)),c},x.$$arity=-1),e.alias(L,"[]","get"),e.def(L,"$each",w=function(){var e,t=w.$$p,r=t||i,n=this;return t&&(w.$$p=null),t&&(w.$$p=null),u(n.$keys(),"each",[],(e=function(t){var n=e.$$s||this;return null==t&&(t=i),r.$call(t,n["$[]"](t))},e.$$s=n,e.$$arity=1,e))},w.$$arity=0),e.def(L,"$keys",A=function(){return this.confstack.$last().$digkeys()},A.$$arity=0),e.def(L,"$get_source",k=function(e){var t,r,n,a=this,s=i,o=i;return s=u(a.confstack.$each_with_index(),"map",[],(t=function(r,n){var a=t.$$s||this;return null==r&&(r=i),null==n&&(n=i),[a.$_get_one(r,e),n]},t.$$s=a,t.$$arity=2,t)),o=u(s,"select",[],(r=function(e){r.$$s;return null==e&&(e=i),e.$first()["$nil?"]()["$!"]()},r.$$s=a,r.$$arity=1,r)).$last(),u(a.confstack,"map",[],(n=function(t,r){var a=n.$$s||this;return null==t&&(t=i),null==r&&(r=i),a.$_get_one(t,e)},n.$$s=a,n.$$arity=2,n)).$compact().$last(),a.sourcestack["$[]"](o.$last().$to_i())},k.$$arity=1),e.def(L,"$[]=",E=function(e,t){var r,n=this,a=i,s=i;return l(t["$=="](o(P,"DeleteMe")))?n.$delete(e):(a=e.$split(".").$reverse(),s=u(a,"inject",[t],(r=function(e,t){r.$$s;return null==e&&(e=i),null==t&&(t=i),$(t,e)},r.$$s=n,r.$$arity=2,r)),n.$push(s))},E.$$arity=2),e.def(L,"$delete",S=function(t){var r=this,n=i;return n=t.$split("."),u(r.confstack.$last(),"dig",e.to_a(n["$[]"](p(0,-2,!1)))).$delete(n.$last())},S.$$arity=1),L.$private(),e.def(L,"$_resolve_value_dependency",N=function(n,a){var s,o=this,c=i,f=i,$=i;return l(o.confresult_cache["$has_key?"](a))?c=o.confresult_cache["$[]"](a):(l(o.callstack["$include?"](n))&&(f=o.callstack["$[]"](e.Range.$new(u(o.callstack,"index",[],(s=function(e){s.$$s;return null==e&&(e=i),e["$=="](n)},s.$$s=o,s.$$arity=1,s)),-1,!1)),o.callstack=[],o.$raise("circular conf dependency: "+r(f,[n+" ..."]))),o.callstack.$push(n),c=a.$call(),o.callstack.$pop(),$=[n,c],u(o.confresult_cache,"[]=",e.to_a($)),$[t($.length,1)]),c},N.$$arity=2),e.def(L,"$_resolve_array_dependency",C=function(e,t){var r,n=this;return u(t,"map",[],(r=function(e){var t=r.$$s||this;return null==e&&(e=i),t.$_resolve_dependencies(i,e)},r.$$s=n,r.$$arity=1,r))},C.$$arity=2),e.def(L,"$_resolve_hash_dependency",I=function(r,n){var a,s=this;return u(n,"inject",[f([],{})],(a=function(n,s){var o=a.$$s||this,c=i;return null==n&&(n=i),null==s&&(s=i),c=[s.$first(),o.$_resolve_dependencies([r,s.$first()],s.$last())],u(n,"[]=",e.to_a(c)),c[t(c.length,1)],n},a.$$s=s,a.$$arity=2,a))},I.$$arity=2),e.def(L,"$_resolve_dependencies",O=function(e,t){var r=this;return t.$class()["$=="](o(P,"Proc"))&&(t=r.$_resolve_value_dependency(e,t)),t.$class()["$=="](o(P,"Hash"))&&(t=r.$_resolve_hash_dependency(e,t)),t.$class()["$=="](o(P,"Array"))&&(t=r.$_resolve_array_dependency(e,t)),t},O.$$arity=2),i&&"_resolve_dependencies"}(a[0],0,a)},Opal.modules["opal-abc2svg"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}function a(e,t){return"number"==typeof e&&"number"==typeof t?e*t:e["$*"](t)}var i=(e.top,[]),s=e.nil,o=(e.const_get_qualified,e.const_get_relative),c=(e.breaker,e.slice,e.module),l=e.klass,u=e.hash2,f=e.send,$=e.truthy,p=e.gvars;return e.add_stubs(["$attr_accessor","$lambda","$phrases","$set_callback","$error","$+","$[]","$===","$_anno_start","$_anno_stop","$push","$_callback_get_abcmodel","$to_n","$unhighlight_all","$range_highlight_more","$nil?","$each","$get_elements_by_range","$find","$==","$scroll_into_view","$add_class","$remove_class","$id","$gsub","$t","$strip_js","$get_svg","$compute_tune_preview","$set_svg","$html","$join","$[]=","$-","$sort","$map","$>","$*","$first","$last","$private","$parse","$loglevel","$debug","$to_json","$split","$inject","$length","$_mk_id","$stopPropagation","$Native","$call"]),function(i,d){var h=c(i,"ABC2SVG"),_=[h].concat(d);!function(i,c,d){var h,_,m,y,g,v,b,x,w,A,k,E,S,N,C,I,O,L,P,M,T,B,j=l(i,null,"Abc2Svg"),F=[j].concat(d);j.$$prototype.user=j.$$prototype.root=j.$$prototype.printer=j.$$prototype.abc_source=j.$$prototype.interactive_elements=j.$$prototype.abc_model=j.$$prototype.player_model=j.$$prototype.svgbuf=j.$$prototype.on_select=s,j.$attr_accessor("abcplay"),e.def(j,"$initialize",h=function(e,r){var n,a,i,c,l,d,h,_=this,m=s,y=s;return null==p.log&&(p.log=s),null==r&&(r=u(["mode"],{mode:"svg"})),_.on_select=f(_,"lambda",[],(n=function(e){n.$$s;return null==e&&(e=s),s},n.$$s=_,n.$$arity=1,n)),_.printer=e,_.svgbuf=[],_.abc_source="",_.interactive_elements=u([],{}),_.abc_model=s,_.player_model=[],_.object_map=u([],{}),_.abcplay=s,_.user=u(["img_out","errmsg","read_file","annotate","page_format","keep_remark","textrans"],{img_out:s,errmsg:s,read_file:s,annotate:!0,page_format:!0,keep_remark:!0,textrans:o(F,"I18n").$phrases()}),f(_,"set_callback",["errmsg"],(a=function(e,r,n){a.$$s;return null==p.log&&(p.log=s),null==e&&(e=s),null==r&&(r=s),null==n&&(n=s),$(r)?p.log.$error(e,[t(r,1),t(n,1)]):p.log.$error(e)},a.$$s=_,a.$$arity=3,a)),m=r["$[]"]("mode"),"svg"["$==="](m)?(f(_,"set_callback",["anno_start"],(i=function(e,t,r,n,a,o,c){var l=i.$$s||this;return null==e&&(e=s),null==t&&(t=s),null==r&&(r=s),null==n&&(n=s),null==a&&(a=s),null==o&&(o=s),null==c&&(c=s),l.$_anno_start(e,t,r,n,a,o,c)},i.$$s=_,i.$$arity=7,i)),f(_,"set_callback",["anno_stop"],(c=function(e,t,r,n,a,i,o){var l=c.$$s||this;return null==e&&(e=s),null==t&&(t=s),null==r&&(r=s),null==n&&(n=s),null==a&&(a=s),null==i&&(i=s),null==o&&(o=s),l.$_anno_stop(e,t,r,n,a,i,o)},c.$$s=_,c.$$arity=7,c)),f(_,"set_callback",["img_out"],(l=function(e){var t=l.$$s||this;return null==t.svgbuf&&(t.svgbuf=s),null==e&&(e=s),t.svgbuf.$push(e)},l.$$s=_,l.$$arity=1,l)),f(_,"set_callback",["get_abcmodel"],(d=function(e,t,r,n){d.$$s;return null==e&&(e=s),null==t&&(t=s),null==r&&(r=s),null==n&&(n=s),s},d.$$s=_,d.$$arity=4,d))):"model"["$==="](m)?f(_,"set_callback",["get_abcmodel"],(h=function(e,t,r,n){var a=h.$$s||this;return null==e&&(e=s),null==t&&(t=s),null==r&&(r=s),null==n&&(n=s),a.$_callback_get_abcmodel(e,t,r,n)},h.$$s=_,h.$$arity=4,h)):p.log.$error("BUG: unsupported mode for abc2svg"),_.root=new abc2svg.Abc(_.user.$to_n()),y="\nI:titletrim 0\nI:measurenb 1\nI:contbarnb 1\nI:linewarn 0\nI:staffnonote 2\nI:stretchlast 1\n      ",_.root.tosvg("my_parameters",y),_.root},h.$$arity=-2),e.def(j,"$range_highlight",_=function(e,t){var r=this;return r.$unhighlight_all(),r.$range_highlight_more(e,t),s},_.$$arity=2),e.def(j,"$scroll_into_view",m=function(e){if($(e["$nil?"]()))return s;e.parents(".svg_block").get(0).scrollIntoView(!0)},m.$$arity=1),e.def(j,"$range_highlight_more",y=function(e,t){var r,n=this;return f(n.$get_elements_by_range(e,t),"each",[],(r=function(e){var t=r.$$s||this,n=s;return null==p.settings&&(p.settings=s),null==e&&(e=s),n=o(F,"Element").$find("#"+e),p.settings["$[]"]("autoscroll")["$=="]("false")||t.$scroll_into_view(n),n.$add_class("highlight")},r.$$s=n,r.$$arity=1,r)),s},y.$$arity=2),e.def(j,"$range_unhighlight_more",g=function(e,t){var r,n=this;return f(n.$get_elements_by_range(e,t),"each",[],(r=function(e){var t=(r.$$s,s);return null==e&&(e=s),t=o(F,"Element").$find("#"+e),t.$remove_class("highlight")},r.$$s=n,r.$$arity=1,r))},g.$$arity=2),e.def(j,"$unhighlight_all",v=function(){var e=this;return o(F,"Element").$find("#"+e.printer.$id()+" .highlight").$remove_class("highlight")},v.$$arity=0),e.def(j,"$on_select",b=function(){var e=b.$$p,t=e||s,r=this;return e&&(b.$$p=null),e&&(b.$$p=null),r.on_select=t},b.$$arity=0),e.def(j,"$strip_js",x=function(e){var t=s;return null==p.log&&(p.log=s),t=e.$gsub(/(I:|%%)(beginjs|endjs)/,"% removed "),e["$=="](t)||p.log.$error(o(F,"I18n").$t("CAUTION: your abc-code is vulnerable !!! removed beginjs / endjs"),[1,1]),t},x.$$arity=1),e.def(j,"$compute_tune_preview",w=function(e,r){var n=this,a=s;return null==r&&(r=""),a="\n%%textoption right\n%%textfont * * 8\n%%text "+r+"\n      ",n.abc_source=n.$strip_js(e),n.interactive_elements=u([],{}),n.svgbuf=[],n.root.tosvg("abc",t(n.abc_source,a)),u(["svg","interactive_elements"],{svg:n.$get_svg(),interactive_elements:n.interactive_elements})},w.$$arity=-2),e.def(j,"$draw",A=function(e,t){var r=this,n=s;return null==t&&(t=""),n=r.$compute_tune_preview(e,t=""),r.$set_svg(n)},A.$$arity=-2),e.def(j,"$set_svg",k=function(e){var t=this;return t.interactive_elements=e["$[]"]("interactive_elements"),t.printer.$html(e["$[]"]("svg")),s},k.$$arity=1),e.def(j,"$get_abcmodel",E=function(e){var t=this,r=s;return null==p.log&&(p.log=s),r=t.$strip_js(e),abc2svg.modules.load(r,function(){console.log("modules loaded")},function(e){p.log.$error(e)}),t.root.tosvg("abc",r),[t.abc_model,t.player_model]},E.$$arity=1),e.def(j,"$get_svg",S=function(){var e=this,t=s;return t=e.svgbuf.$join("\n"),t=t.$gsub("<svg ",'<div class="svg_block"><svg '),t=t.$gsub("</svg>","</svg></div>")},S.$$arity=0),e.def(j,"$get_html",N=function(){return'\n      <html>\n      <head>\n        <meta charset="utf-8"/>\n        <style type="text/css">\n           rect.abcref {fill-opacity:0.0}\n          .nobrk s\t{ white-space:nowrap; }\n          svg {display:block}\n        </style>\n      </head>\n      <body>\n         '+this.printer.$html()+"\n      </body>\n      "},N.$$arity=0),e.def(j,"$set_callback",C=function(t){var n=C.$$p,a=n||s,i=this,o=s;return n&&(C.$$p=null),n&&(C.$$p=null),o=[t,a],f(i.user,"[]=",e.to_a(o)),o[r(o.length,1)]},C.$$arity=1),e.def(j,"$get_elements_by_range",I=function(e,t){var i,o=this,c=s,l=s;return c=[e,t].$sort(),l=[],f(o.interactive_elements,"each",[],(i=function(e,t){var o,u=i.$$s||this,p=s;return null==e&&(e=s),null==t&&(t=s),p=f(["startChar","endChar"],"map",[],(o=function(e){o.$$s;return null==e&&(e=s),t["$[]"](e)},o.$$s=u,o.$$arity=1,o)).$sort(),$(n(a(r(c.$first(),p.$last()),r(p.$first(),c.$last())),0))?l.$push(e):s},i.$$s=o,i.$$arity=2,i)),l},I.$$arity=2),j.$private(),e.def(j,"$_callback_get_abcmodel",O=function(e,t,r,n){var a=this,i=s;null==p.log&&(p.log=s),i="",(new AbcMIDI).add(e,t),i=(new AbcJSON).gen_json(e,t,r,n);var c=new ToAudio;return c.add(e,t),a.player_model=c.clear(),a.abc_model=o(F,"JSON").$parse(i),p.log.$loglevel()["$=="]("debug")&&p.log.$debug(a.abc_model.$to_json()),a.abc_model},O.$$arity=4),e.def(j,"$_get_charpos",L=function(r,n,a){var i,o=this,c=s,l=s;return c=o.abc_source.$split("\n"),l=f(c["$[]"](e.Range.$new(0,n,!1)),"inject",[0],(i=function(e,r){i.$$s;return null==e&&(e=s),null==r&&(r=s),e=t(e,r.$length())},i.$$s=o,i.$$arity=2,i)),t(l,a)},L.$$arity=3),e.def(j,"$_anno_start",P=function(e,t,r,n,a,i,o){var c=this,l=s;return l=c.$_mk_id(e,t,r),c.root.out_svg('<g class="'+l+'">\n'),s},P.$$arity=7),e.def(j,"$_clickabcnote",M=function(e,t){var r=this;return r.$Native(e).$stopPropagation(),r.on_select.$call(r.interactive_elements["$[]"](t))},M.$$arity=2),e.def(j,"$_anno_stop",T=function(t,n,a,i,o,c,l){var $=this,p=s,d=s,h=s;return p=$.$_mk_id(t,n,a),d="onclick=\"Opal.top.uicontroller.tune_preview_printer.$_clickabcnote(evt, '"+p+"')\"",$.root.out_svg("</g>\n"),$.root.out_svg("<rect "+d+' class="abcref _'+n+'_" id="'+p+'" x="'),$.root.out_sxsy(i,'" y="',o),$.root.out_svg('" width="'+c.toFixed(2)+'" height="'+l.toFixed(2)+'"/>\n'),h=[p,u(["startChar","endChar"],{startChar:n,endChar:a})],f($.interactive_elements,"[]=",e.to_a(h)),h[r(h.length,1)]},T.$$arity=7),e.def(j,"$_mk_id",B=function(e,t,r){return"_"+e+"_"+t+"_"+r+"_"},B.$$arity=3)}(_[0],0,_)}(i[0],i)},Opal.modules["version-prod"]=function(e){var t=(e.top,[]),r=(e.nil,e.const_get_qualified,e.const_get_relative);e.breaker,e.slice;return e.add_stubs(["$year","$now"]),e.const_set(t[0],"VERSION","v_1.11.2-15-g26561a5f"),e.const_set(t[0],"SCHEMA_VERSION","https://zupfnoter.weichel21.de/schema/zupfnoter-config_1.0.json"),e.const_set(t[0],"COPYRIGHT"," "+r(t,"Time").$now().$year()+" https://www.zupfnoter.de")},abc2svg={C:{BLEN:1536,BAR:0,CLEF:1,CUSTOS:2,GRACE:4,KEY:5,METER:6,MREST:7,NOTE:8,PART:9,REST:10,SPACE:11,STAVES:12,STBRK:13,TEMPO:14,BLOCK:16,REMARK:17,FULL:0,EMPTY:1,OVAL:2,OVALBARS:3,SQUARE:4,SL_ABOVE:1,SL_BELOW:2,SL_AUTO:3,SL_HIDDEN:4,SL_DOTTED:8},Abc:function(user){"use strict";function clone(e,t){if(!e)return e;var r=new e.constructor;for(var n in e)e.hasOwnProperty(n)&&(t&&"object"==typeof e[n]?r[n]=clone(e[n],t-1):r[n]=e[n]);return r}function errbld(e,t,r,n){var a,i,s,o,c;if(user.errbld){switch(e){case 0:e="warn";break;case 1:e="error";break;default:e="fatal"}return void user.errbld(e,t,r,n)}if(void 0!=n&&n>=0){for(a=s=0;;){if((i=parse.file.indexOf("\n",a))<0||i>n)break;s++,a=i+1}o=n-a}switch(c="",r&&(c=r,s&&(c+=":"+(s+1)+":"+(o+1)),c+=" "),e){case 0:c+="Warning: ";break;case 1:c+="Error: ";break;default:c+="Internal bug: "}user.errmsg(c+t,s,o)}function error(e,t,r,n,a,i,s){var o;user.textrans&&(o=user.textrans[r])&&(r=o),arguments.length>3&&(r=r.replace(/\$./g,function(e){switch(e){case"$1":return n;case"$2":return a;case"$3":return i;default:return s}})),t&&t.fname?errbld(e,r,t.fname,t.istart):errbld(e,r)}function scanBuf(){this.index=0,scanBuf.prototype.char=function(){return this.buffer[this.index]},scanBuf.prototype.next_char=function(){return this.buffer[++this.index]},scanBuf.prototype.get_int=function(){for(var e=0,t=this.buffer[this.index];t>="0"&&t<="9";)e=10*e+Number(t),t=this.next_char();return e}}function syntax(e,t,r,n,a,i){error(e,{fname:parse.fname,istart:parse.istart+parse.line.index},t,r,n,a,i)}function js_inject(js){/eval *\(|Function|setTimeout|setInterval/.test(js)?syntax(1,"Unsecure code"):eval('"use strict"\n'+js)}function y_get(e,t,r,n){var a,i=staff_tb[e],s=r/realwidth*YSTEP|0,o=(r+n)/realwidth*YSTEP|0;if(s<0&&(s=0),o>=YSTEP&&(o=YSTEP-1,s>o&&(s=o)),t)for(a=i.top[s++];s<=o;)a<i.top[s]&&(a=i.top[s]),s++;else for(a=i.bot[s++];s<=o;)a>i.bot[s]&&(a=i.bot[s]),s++;return a}function y_set(e,t,r,n,a){var i=staff_tb[e],s=r/realwidth*YSTEP|0,o=(r+n)/realwidth*YSTEP|0;if(s<0&&(s=0),o>=YSTEP&&(o=YSTEP-1,s>o&&(s=o)),t)for(;s<=o;)i.top[s]<a&&(i.top[s]=a),s++;else for(;s<=o;)i.bot[s]>a&&(i.bot[s]=a),s++}function up_p(e,t){switch(t){case C.SL_ABOVE:return!0;case C.SL_BELOW:return!1}return e.multi&&0!=e.multi?e.multi>0:!!e.p_v.have_ly&&e.pos.voc!=C.SL_ABOVE}function d_arp(e){var t,r,n,a=e.s,i=e.dd,s=5;if(a.type==C.NOTE)for(t=0;t<=a.nhd;t++){if(a.notes[t].acc)n=5+a.notes[t].shac;else switch(n=6-a.notes[t].shhd,a.head){case C.SQUARE:n+=3.5;break;case C.OVALBARS:case C.OVAL:n+=2}n>s&&(s=n)}r=3*(a.notes[a.nhd].pit-a.notes[0].pit)+4,t=i.h,r<t&&(r=t),e.has_val=!0,e.val=r,e.x-=s,e.y=3*(a.notes[0].pit-18)-3}function d_cresc(e){if(!e.ldst){var t,r,n,a,i,s,o,c,l,u,f=e.s,$=e.start;t=$.s,i=t.x+3,c=$.ix,c>0&&(l=a_de[c-1]),e.st=f.st,e.lden=!1,e.has_val=!0,a=up_p(f,f.pos.dyn),a&&(e.up=!0),l&&l.s==t&&(e.up&&!l.up||!e.up&&l.up)&&(n=l.dd,f_staff[n.func]&&(o=l.x+l.val+4)>i&&(i=o)),e.defl.noen?(s=e.x-i)<20&&(i=e.x-20-3,s=20):(o=f.x,u=a_de[e.ix+1],u&&u.s==t&&(e.up&&!u.up||!e.up&&u.up)&&(n=u.dd,f_staff[n.func]&&(o-=5)),(s=o-i-4)<20&&(i-=.5*(20-s),s=20)),e.val=s,e.x=i,e.y=y_get(e.st,a,i,s),a||(r=e.dd,e.y-=r.h)}}function d_near(e){var t,r,n=e.s,a=e.dd;a.str||(r=n.multi?n.multi>0:n.stem<0,t=r?0|n.ymx:n.ymn-a.h|0,t>-6&&t<24&&(r&&(t+=3),t=6*((t+6)/6|0)-6),r?n.ymx=t+a.h:n.ymn=t,e.y=t,n.type==C.NOTE&&(e.x+=n.notes[n.stem>=0?0:n.nhd].shhd),"d"==a.name[0]&&n.nflags>=-1&&(r?n.stem>0&&(e.x+=3.5):n.stem<0&&(e.x-=3.5)))}function d_pf(e){var t,r,n,a,i,s=e.s,o=e.dd;e.val=o.wl+o.wr,a=up_p(s,s.pos.vol),a&&(e.up=!0),n=s.x-o.wl,e.ix>0&&(i=a_de[e.ix-1],i.s==s&&(e.up&&!i.up||!e.up&&i.up)&&(t=i.dd,f_staff[t.func]&&(r=i.x+i.val+4)>n&&(n=r))),e.x=n,e.y=y_get(s.st,a,n,e.val),a||(e.y-=o.h)}function d_slide(e){var t,r,n=e.s,a=n.notes[0].pit,i=5;for(t=0;t<=n.nhd;t++){if(n.notes[t].acc)r=4+n.notes[t].shac;else switch(r=5-n.notes[t].shhd,n.head){case C.SQUARE:r+=3.5;break;case C.OVALBARS:case C.OVAL:r+=2}n.notes[t].pit<=a+3&&r>i&&(i=r)}e.x-=i,e.y=3*(a-18)}function d_trill(e){if(!e.ldst){var t,r,n,a,i,s=e.s,o=s.st,c=e.start.s,l=c.x;if(e.prev&&(l=e.prev.x+10,n=e.prev.y),e.st=o,4!=e.dd.func)switch(e.dd.glyph){case"8va":case"15ma":r=1;break;default:r=s.multi>=0}e.defl.noen?(a=e.x-l)<20&&(l=e.x-20-3,a=20):(a=s.x-l-6,s.type==C.NOTE&&(a-=6),a<20&&(l-=.5*(20-a),a=20)),t=e.dd,n||(n=y_get(o,r,l,a)),r?(i=staff_tb[c.st].topbar+2,n<i&&(n=i)):(n-=t.h,i=staff_tb[c.st].botbar-2,n>i&&(n=i)),e.lden=!1,e.has_val=!0,e.val=a,e.x=l,e.y=n,r&&(n+=t.h),y_set(o,r,l,a,n),r?c.ymx=s.ymx=n:c.ymn=s.ymn=n}}function d_upstaff(e){if(!e.ldst){if(e.start)return void d_trill(e);var t,r,n,a=e.s,i=e.dd,s=a.x,o=i.wl+i.wr,c=staff_tb[a.st].topbar+2,l=staff_tb[a.st].botbar-2;if(a.nhd&&(s+=a.notes[a.stem>=0?0:a.nhd].shhd),r=-1,4==i.func)r=0;else if(a.pos)switch(a.pos.orn){case C.SL_ABOVE:r=1;break;case C.SL_BELOW:r=0}switch(i.glyph){case"accent":case"roll":!r||r<0&&(a.multi<0||!a.multi&&a.stem>0)?(t=y_get(a.st,!1,a.x-i.wl,o),t>l&&(t=l),t-=i.h,y_set(a.st,!1,a.x,0,t),n=!0,a.ymn=t):(t=y_get(a.st,!0,a.x,0),t<c&&(t=c),y_set(a.st,!0,a.x-i.wl,o,t+i.h),a.ymx=t+i.h);break;case"brth":case"lphr":case"mphr":case"sphr":for(t=c+1,"brth"==i.glyph&&t<a.ymx&&(t=a.ymx),a=a.ts_next;a&&!a.seqst;a=a.ts_next);s+=.45*((a?a.x:realwidth)-s);break;default:0==i.name.indexOf("invert")&&(n=!0),"invertedfermata"!=i.name&&(r>0||r<0&&a.multi>=0)?(t=y_get(a.st,!0,a.x-i.wl,o)+2,t<c&&(t=c),y_set(a.st,!0,a.x-i.wl,o,t+i.h),a.ymx=t+i.h):(t=y_get(a.st,!1,a.x-i.wl,o)-2,t>l&&(t=l),t-=i.h,y_set(a.st,!1,a.x-i.wl,o,t),"fermata"==i.name&&(n=!0),a.ymn=t)}n&&(t+=i.h,e.inv=!0),e.x=s,e.y=t}}function deco_add(e){var t=e.match(/(\S*)\s+(.*)/);decos[t[1]]=t[2]}function deco_def(e){var t,r,n,a,i,s,o=decos[e];if(!o)return void(cfmt.decoerr&&error(1,null,"Unknown decoration '$1'",e));if(!(t=o.match(/(\d+)\s+(.+?)\s+([0-9.]+)\s+([0-9.]+)\s+([0-9.]+)/)))return void error(1,null,"Invalid decoration '$1'",e);var c=Number(t[1]),l=parseFloat(t[3]),u=parseFloat(t[4]),f=parseFloat(t[5]);if(isNaN(c))return void error(1,null,"%%deco: bad C function value '$1'",t[1]);if((c<0||c>10)&&(c<32||c>41))return void error(1,null,"%%deco: bad C function index '$1'",c);if(l<0||u<0||f<0)return void error(1,null,"%%deco: cannot have a negative value '$1'",o);if(l>50||u>80||f>80)return void error(1,null,"%%deco: abnormal h/wl/wr value '$1'",o);if(r=dd_tb[e],r||(r={name:e},dd_tb[e]=r),r.func=0==r.name.indexOf("head-")?9:c,r.glyph=t[2],r.h=l,r.wl=u,r.wr=f,s=o.replace(t[0],"").trim(),s&&('"'==s[0]&&(s=s.slice(1,-1)),r.str=s),6==r.func&&void 0==r.str&&(r.str=r.name),"("==(i=r.name.slice(-1))||")"==i&&r.name.indexOf("(")<0)if(a=r.name.slice(0,-1)+("("==i?")":"("),n=dd_tb[a])"("==i?(r.dd_en=n,n.dd_st=r):(r.dd_st=n,n.dd_en=r);else if(!(n=deco_def(a)))return;return r}function deco_cnv(e,t,r){var n,a,i,s,o,c=e.length;for(n=0;n<c;n++)if(s=e[n],(i=dd_tb[s])||(i=deco_def(s))){switch(i.func){case 0:if(t.type==C.BAR&&"dot"==i.name){t.bar_dotted=!0;break}case 1:case 2:if(!t.notes){error(1,t,errs.must_note_rest,i.name);continue}break;case 8:if(t.type!=C.NOTE){error(1,t,errs.must_note,i.name);continue}o=t.notes[t.nhd],o.a_dcn||(o.a_dcn=[]),o.a_dcn.push(i.name);continue;case 9:if(!t.notes){error(1,t,errs.must_note_rest,i.name);continue}for(a=0;a<=t.nhd;a++)o=t.notes[a],o.a_dcn||(o.a_dcn=[]),o.a_dcn.push(i.name);continue;default:break;case 10:if(t.notes)for(a=0;a<=t.nhd;a++)t.notes[a].color=i.name;else t.color=i.name;continue;case 32:t.invis=!0;continue;case 33:if(t.type!=C.BAR){error(1,t,"!beamon! must be on a bar");continue}t.beam_on=!0;continue;case 34:if(t.type!=C.NOTE||!r||r.type!=C.NOTE||t.nflags!=r.nflags){error(1,t,"!$1! must be on the last of a couple of notes",i.name);continue}for(t.trem2=!0,t.beam_end=!0,r.trem2=!0,r.beam_st=!0,t.ntrem=r.ntrem=Number(i.name[4]),r.nflags=--t.nflags,r.head=++t.head,t.nflags>0?t.nflags+=t.ntrem:(t.nflags<=-2&&(t.stemless=!0,r.stemless=!0),t.nflags=t.ntrem),r.nflags=t.nflags,a=0;a<=t.nhd;a++)t.notes[a].dur*=2;for(a=0;a<=r.nhd;a++)r.notes[a].dur*=2;continue;case 35:if(t.type!=C.NOTE){error(1,t,"!xstem! must be on a note");continue}t.xstem=!0,t.nflags=0;continue;case 36:if(t.type!=C.NOTE){error(1,t,errs.must_note,i.name);continue}"1"==i.name[6]?t.beam_br1=!0:t.beam_br2=!0;continue;case 37:t.rbstop=1;continue;case 38:if(t.type!=C.NOTE){error(1,t,errs.must_note,i.name);continue}t.trem1=!0,t.ntrem=i.name.length,t.nflags>0?t.nflags+=t.ntrem:t.nflags=t.ntrem;continue;case 39:if(t.type!=C.NOTE){error(1,t,errs.must_note,i.name);continue}t.feathered_beam="a"==i.name[5]?1:-1;continue;case 40:t.stemless=!0;continue;case 41:t.rbstop=2;continue}t.a_dd||(t.a_dd=[]),t.a_dd.push(i)}}function deco_update(e,t){var r,n,a=a_de.length;for(r=0;r<a;r++)n=a_de[r],n.s==e&&(n.x+=t)}function deco_width(e){var t,r,n=0,a=e.a_dd,i=a.length;for(r=0;r<i;r++)switch(t=a[r],t.func){case 1:n<7&&(n=7);break;case 2:n<14&&(n=14);break;case 3:switch(t.glyph){case"brth":case"lphr":case"mphr":case"sphr":e.wr<20&&(e.wr=20)}}return 0!=n&&e.prev&&e.prev.type==C.BAR&&(n-=3),n}function draw_all_deco(){if(0!=a_de.length){var e,t,r,n,a,i,s,o,c,l,u,f,$,p,d=[],h=[];if(!cfmt.dynalign)for(i=nstaff,o=staff_tb[i].y;--i>=0;)c=staff_tb[i].y,h[i]=.5*(o+24+c),o=c;for(;;){if(!(e=a_de.shift()))break;t=e.dd,t&&(t.dd_en||(r=e.s,a=t.glyph,f=a.indexOf("/"),f>0&&(a=r.stem>=0?a.slice(0,f):a.slice(f+1)),f_staff[t.func]?set_sscale(r.st):set_scale(r),i=e.st,staff_tb[i].topbar&&(s=e.x,o=e.y+staff_tb[i].y,void 0!=e.m?(n=r.notes[e.m],s+=n.shhd*stv_g.scale):f_staff[t.func]&&!cfmt.dynalign&&(e.up&&i>0||!e.up&&i<nstaff)&&(l=e.up?h[--i]:h[i++],l-=.5*t.h,(e.up&&o<l||!e.up&&o>l)&&(c=y_get(i,!e.up,e.x,e.val)+staff_tb[i].y,e.up&&(c-=t.h),(e.up&&c>l||!e.up&&c<l)&&(o=l))),u=user[a],u&&"function"==typeof u?u(s,o,e):(anno_start(r,"deco"),e.inv&&(g_open(s,o,0,1,-1),s=o=0),e.has_val?(2!=t.func||stv_g.st<0?out_deco_val(s,o,a,e.val/stv_g.scale,e.defl):out_deco_val(s,o,a,e.val,e.defl),e.defl.noen&&d.push(e.start)):void 0!=t.str&&"sfz"!=t.str?($=t.str,"@"==$[0]&&(p=$.match(/^@([0-9.-]+),([0-9.-]+);?/),s+=Number(p[1]),o+=Number(p[2]),$=$.replace(p[0],"")),out_deco_str(s,o,a,$)):e.lden?out_deco_long(s,o,e):xygl(s,o,a),stv_g.g&&g_close(),anno_stop(r,"deco")))))}a_de=d}}function draw_deco_near(){function e(e){var t,r,n,a,i,s=e.a_dd.length;for(r=0;r<s;r++){switch(t=e.a_dd[r],t.func){default:n=0;break;case 3:case 4:case 5:if(ottava[t.name])if(i=t.name.slice(0,-1)+e.st.toString(),od[i]){if("("==t.name[t.name.length-1]){od[i]++;continue}if(od[i]--,e.v+1!=od[i]>>8||!od[i])continue;od[i]&=255}else"("==t.name[t.name.length-1]&&(od[i]=1+(e.v+1<<8));n=e.pos.orn;break;case 6:n=e.pos.vol;break;case 7:n=e.pos.dyn}n!=C.SL_HIDDEN&&(a={s:e,dd:t,st:e.st,ix:a_de.length,defl:{},x:e.x,y:e.y},a_de.push(a),t.dd_en?a.ldst=!0:t.dd_st&&(a.lden=!0,a.defl.nost=!0),f_near[t.func]&&func_tb[t.func](a))}}function t(e,t){var r,n,a,i,s=e.notes[t],o=s.a_dcn.length;for(n=0;n<o;n++)if(a=s.a_dcn[n],(i=dd_tb[a])||(i=deco_def(a))){switch(i.func){case 0:case 1:case 3:case 4:case 8:break;default:error(1,null,"Cannot have !$1! on a head",i.name);continue;case 9:s.invis=!0;break;case 10:s.color=i.name;continue;case 32:s.invis=!0;continue;case 40:e.stemless=!0;continue}r={s:e,dd:i,st:e.st,m:t,ix:0,defl:{},x:e.x,y:3*(s.pit-18)},a_de.push(r),i.dd_en?r.ldst=!0:i.dd_st&&(r.lden=!0,r.defl.nost=!0)}}function r(r){var n;if(r.a_dd&&e(r),r.notes)for(n=0;n<r.notes.length;n++)r.notes[n].a_dcn&&t(r,n)}var n,a;for(n=tsfirst;n;n=n.ts_next){switch(n.type){case C.CLEF:case C.KEY:case C.METER:continue}break}for(0!=a_de.length&&function(e){var t,r,n=e.x-e.wl,a=a_de.length;for(t=0;t<a;t++)r=a_de[t],r.ix=t,r.s.x=r.x=n,r.defl.nost=!0}(n);n;n=n.ts_next){switch(n.type){case C.BAR:case C.MREST:case C.NOTE:case C.REST:case C.SPACE:break;case C.GRACE:for(a=n.extra;a;a=a.next)r(a);default:continue}r(n)}!function(){var e,t,r,n,a,i,s,o,c,l=a_de.length;for(e=0;e<l;e++)if(r=a_de[e],r.ldst){for(a=r.dd,i=a.dd_en,o=r.s,s=o.v,t=e+1;t<l&&(n=a_de[t],n.start||n.dd!=i||n.s.v!=s);t++);if(t==l)for(c=o.st,t=e+1;t<l&&(n=a_de[t],n.start||n.dd!=i||n.s.st!=c);t++);t==l&&(n={s:r.s,st:r.st,dd:i,ix:a_de.length-1,x:realwidth-6,y:r.s.y,lden:!0,defl:{noen:!0}},n.x<o.x+10&&(n.x=o.x+10),void 0!=r.m&&(n.m=r.m),a_de.push(n)),n.start=r,n.defl.nost=r.defl.nost,"trill("==a.name&&e>0&&"trill"==a_de[e-1].dd.name&&(n.prev=a_de[e-1])}for(e=0;e<l;e++)n=a_de[e],n.lden&&!n.start&&(o=n.s,r={s:prev_scut(o),st:n.st,dd:n.dd.dd_st,ix:a_de.length-1,y:o.y,ldst:!0},r.x=r.s.x,void 0!=n.m&&(r.m=n.m),a_de.push(r),n.start=r)}()}
function draw_deco_note(){var e,t,r,n,a=a_de.length;for(e=0;e<a;e++)t=a_de[e],r=t.dd,n=r.func,f_note[n]&&void 0==t.m&&func_tb[n](t)}function draw_deco_staff(){var e,t,r,n,a,i,s,o,c,l,u,f,$,p,d,h=new Array(nstaff),_=a_de.length;for(s=0;s<=nstaff;s++)h[s]={ymin:0,ymax:0};for(s=0;s<_;s++)c=a_de[s],(l=c.dd)&&f_staff[l.func]&&void 0==c.m&&(func_tb[l.func](c),l.dd_en||cfmt.dynalign&&(c.up?c.y>h[c.st].ymax&&(h[c.st].ymax=c.y):c.y<h[c.st].ymin&&(h[c.st].ymin=c.y)));for(s=0;s<_;s++)c=a_de[s],(l=c.dd)&&!l.dd_en&&f_staff[l.func]&&(cfmt.dynalign?(a=c.up?h[c.st].ymax:h[c.st].ymin,c.y=a):a=c.y,c.up&&(a+=l.h),y_set(c.st,c.up,c.x,c.val,a));for(s=0;s<=nstaff;s++)h[s]={ymin:0,ymax:24};for(e=tsfirst;e;e=e.ts_next)if(e.a_gch){for(t||(t=e),f=null,$=0;$<e.a_gch.length&&(u=e.a_gch[$],!("g"==u.type&&(f=u,u.y<0)));$++);f&&(i=f.w,f.y>=0?(a=y_get(e.st,!0,e.x,i))>h[e.st].ymax&&(h[e.st].ymax=a):(a=y_get(e.st,!1,e.x,i))<h[e.st].ymin&&(h[e.st].ymin=a))}if(t){for(s=0;s<=nstaff;s++)d=staff_tb[s].botbar,h[s].ymin>d-4&&(h[s].ymin=d-4),p=staff_tb[s].topbar,h[s].ymax<p+4&&(h[s].ymax=p+4);for(set_dscale(-1),e=t;e;e=e.ts_next)e.a_gch&&draw_gchord(e,h[e.st].ymin,h[e.st].ymax)}for(o=0;o<voice_tb.length;o++)r=voice_tb[o],!r.second&&r.sym&&function(e){var t,r,a,i,s,o,c;for(a=staff_tb[e.st].topbar+25,t=e.sym;t;t=t.next)if(t.type==C.BAR&&t.rbstart&&!t.norepbra){if(!t.next)break;for(c||(c=t,set_font("repeat")),r=t;t.next&&(t=t.next,!t.rbstop););i=y_get(e.st,!0,r.x,t.x-r.x),a<i&&(a=i),r.text&&(o=strwh(r.text),i=y_get(e.st,!0,r.x+4,o[0]),i+=o[1],a<i&&(a=i)),t.rbstart&&(t=t.prev)}if(t=c)for(set_dscale(e.st,!0),i=a*staff_tb[e.st].staffscale;t;t=t.next)if(t.rbstart&&!t.norepbra){for(r=t;t.next&&(t=t.next,!t.rbstop););if(r==t)break;n=r.x,s=t.type!=C.BAR?t.rbstop?0:t.x-realwidth+4:t.bar_type.length>1&&"[]"!=t.bar_type||"]"==t.bar_type?r.st>0&&!(cur_sy.staves[r.st-1].flags&STOP_BAR)?t.wl:":"==t.bar_type.slice(-1)?12:":"!=t.bar_type[0]?0:8:t.rbstop?0:8,s=t.x-n-s,t.next||t.rbstop||e.bar_start||(e.bar_start=clone(t),e.bar_start.type=C.BAR,e.bar_start.bar_type="[",delete e.bar_start.text,e.bar_start.rbstart=1,delete e.bar_start.a_gch),r.text&&xy_str(n+4,i-gene.curfont.size-3,r.text),xypath(n,i),2==r.rbstart&&(output+="m0 20v-20"),output+="h"+s.toFixed(2),2==t.rbstop&&(output+="v20"),output+='"/>\n',y_set(r.st,!0,n,s,a+2),t.rbstart&&(t=t.prev)}}(r)}function draw_measnb(){var e,t,r,n,a,i,s,o,c=cur_sy;for(t=0;t<=nstaff&&!c.st_print[t];t++);if(!(t>nstaff)){if(set_dscale(t),1!=staff_tb[t].staffscale&&(o=get_font("measure").size,param_set_font("measurefont","* "+(o/staff_tb[t].staffscale).toString())),set_font("measure"),e=tsfirst,(r=gene.nbar)>1)if(0==cfmt.measurenb)s=!0,a=y_get(t,!0,0,20),a<staff_tb[t].topbar+14&&(a=staff_tb[t].topbar+14),cfmt.measurebox?xy_str_b(0,a,r.toString()):xy_str(0,a,r.toString()),y_set(t,!0,0,20,a+gene.curfont.size+2);else if(r%cfmt.measurenb==0){for(;;e=e.ts_next){switch(e.type){case C.METER:case C.CLEF:case C.KEY:case C.STBRK:continue}break}for(;e.st!=t;)e=e.ts_next;e.type==C.BAR&&e.bar_num||(e.prev&&e.prev.type!=C.CLEF&&(e=e.prev),n=e.x-e.wl,s=!0,i=cwid("0")*gene.curfont.swfac,r>=10&&(i*=r>=100?3:2),cfmt.measurebox&&(i+=4),a=y_get(t,!0,n,i),a<staff_tb[t].topbar+6&&(a=staff_tb[t].topbar+6),a+=2,cfmt.measurebox?(xy_str_b(n,a,r.toString()),a+=2,i+=3):xy_str(n,a,r.toString()),a+=gene.curfont.size,y_set(t,!0,n,i,a),e.ymx=a)}for(;e;e=e.ts_next){switch(e.type){case C.STAVES:for(c=e.sy,t=0;t<nstaff&&!c.st_print[t];t++);set_sscale(t);continue;default:continue;case C.BAR:if(!e.bar_num)continue}r=e.bar_num,0!=cfmt.measurenb&&r%cfmt.measurenb==0&&e.next&&(s||(s=!0),i=cwid("0")*gene.curfont.swfac,r>=10&&(i*=r>=100?3:2),cfmt.measurebox&&(i+=4),n=e.x-.4*i,a=y_get(t,!0,n,i),a<staff_tb[t].topbar+6&&(a=staff_tb[t].topbar+6),e.next.type==C.NOTE&&(e.next.stem>0?a<e.next.ys-gene.curfont.size&&(a=e.next.ys-gene.curfont.size):a<e.next.y&&(a=e.next.y)),a+=2,cfmt.measurebox?(xy_str_b(n,a,r.toString()),a+=2,i+=3):xy_str(n,a,r.toString()),a+=gene.curfont.size,y_set(t,!0,n,i,a),e.ymx=a)}gene.nbar=r,o&&param_set_font("measurefont","* "+o.toString())}}function draw_notempo(e,t,r,n,a){var i,s,o,c=identify_note(e,n),l=c[0],u=c[1],f=c[2];switch(out_XYAB('<g transform="translate(X,Y) scale(F)">\n',t+4,r+5,a),l){case C.OVAL:s="HD";break;case C.EMPTY:s="Hd";break;default:s="hd"}if(xygl(-posx,posy,s),i=4,u){switch(o=9,f>0&&(o+=4),l){case C.SQUARE:o+=3;break;case C.OVALBARS:case C.OVAL:o+=2;break;case C.EMPTY:o+=1}for(i=o*u,o-=posx;--u>=0;)xygl(o,posy,"dot"),o+=3.5}return n<C.BLEN&&(f<=0?out_stem(-posx,posy,21):(out_stem(-posx,posy,21,!1,f),i<6&&(i=6))),output+="</g>\n",(i+15)*a}function tempo_width(e){var t=0;return set_font("tempo"),e.tempo_str1&&(t=strwh(e.tempo_str1)[0]),e.tempo_ca&&(t+=strwh(e.tempo_ca)[0]),e.tempo_notes&&(t+=10*e.tempo_notes.length+6+cwid(" ")*gene.curfont.swfac*6+10),e.tempo_str2&&(t+=strwh(e.tempo_str2)[0]),t}function write_tempo(e,t,r){var n,a,i=.6*gene.curfont.size/15;if(set_font("tempo"),e.tempo_str1&&(xy_str(t,r,e.tempo_str1),t+=strwh(e.tempo_str1)[0]+3),e.tempo_notes){for(n=0;n<e.tempo_notes.length;n++)t+=draw_notempo(e,t,r,e.tempo_notes[n],i);xy_str(t,r,"="),t+=strwh("= ")[0],e.tempo_ca&&(xy_str(t,r,e.tempo_ca),t+=strwh(e.tempo_ca)[0]),e.tempo?(xy_str(t,r,e.tempo.toString()),a=cwid("0")*gene.curfont.swfac,t+=a+5,e.tempo>=10&&(t+=a,e.tempo>=100&&(t+=a))):t+=draw_notempo(e,t,r,e.new_beat,i)}e.tempo_str2&&xy_str(t,r,e.tempo_str2),e.del=!0}function draw_partempo(e,t){var r,n,a,i,s,o,c=0,l=0,u=staff_tb[e].topbar+8,f=0,$=1,p=0;for(r=tsfirst;r;r=r.ts_next)r.type!=C.TEMPO||r.del||(a||(a=r),s=tempo_width(r),o=y_get(e,!0,r.x-16,s),o>u&&(u=o),p>=r.x-16&&!(f&$>>1)&&(f|=$),$<<=1,p=r.x-16+s);if(a)for(set_sscale(-1),set_font("tempo"),l=gene.curfont.size+2+2,o=2-l,i=o-l,0!=f&&(l*=2),t<u+l&&(c=u+l-t),r=a;r;r=r.ts_next)r.type!=C.TEMPO||r.del||((user.anno_start||user.anno_stop)&&(r.wl=16,r.wr=30,r.ymn=1&f?i:o,r.ymx=r.ymn+14,anno_start(r)),write_tempo(r,r.x-16,1&f?i:o),anno_stop(r),f>>=1);for(u=staff_tb[e].topbar+8,r=tsfirst;r;r=r.ts_next)r.type==C.PART&&(n||(n=r,set_font("parts"),i=gene.curfont.size+2+2),s=strwh(r.text)[0],o=y_get(e,!0,r.x-10,s+3),u<o&&(u=o));if(n)for(set_sscale(-1),t<u+i+l&&(c=u+i+l-t),r=n;r;r=r.ts_next)r.type==C.PART&&(r.x-=10,(user.anno_start||user.anno_stop)&&(s=strwh(r.text)[0],r.wl=0,r.wr=s,r.ymn=-l-i,r.ymx=r.ymn+i,anno_start(r)),cfmt.partsbox?xy_str_b(r.x,2-l-i,r.text):xy_str(r.x,2-l-i,r.text),anno_stop(r));return c}function b_pos(e,t,r,n){function a(e){return 6*Math.round((e+12)/6)-12-e}var i,s,o,c,l=e?3.5:BEAM_SHIFT,u=e?1.8:BEAM_DEPTH;if(t>0){if((s=n-(r-1)*l-u)>26)return 0;i=n}else{if((i=n+(r-1)*l+u)<-2)return 0;s=n}return o=a(i-BEAM_OFFSET),c=a(s+BEAM_OFFSET),o*o>c*c?c:o}function sym_dup(e){var t,r,n=clone(e);for(n.invis=!0,delete n.text,delete n.a_gch,delete n.a_ly,delete n.a_dd,n.notes=clone(e.notes),t=0;t<=n.nhd;t++)r=n.notes[t]=clone(e.notes[t]),delete r.a_dcn;return n}function calculate_beam(e,t){var r,n,a,i,s,o,c,l,u,f,$,p,d,h,_,m,y,g,v,b,x,w;for(t.beam_st||(r=sym_dup(t),lkvsym(r,t),lktsym(r,t),r.x-=12,r.x>t.prev.x+12&&(r.x=t.prev.x+12),r.beam_st=!0,delete r.beam_end,r.tmp=!0,delete r.slur_start,delete r.slur_end,t=r),a=i=0,c=l=!1,s=t.st,o=t.v,v=t.grace?GSTEM_XOFF:3.5,n=t;n.type!=C.NOTE||(n.nflags>i&&(i=n.nflags),a++,n.st!=s&&(c=!0),n.stem!=t.stem&&(l=!0),x||n.invis||n.stemless&&!n.trem2||(x=!0),!n.beam_end);n=n.next)if(!n.next){for(;n.type!=C.NOTE;n=n.prev);r=sym_dup(n),r.next=n.next,r.next&&(r.next.prev=r),n.next=r,r.prev=n,r.ts_next=n.ts_next,r.ts_next&&(r.ts_next.ts_prev=r),n.ts_next=r,r.ts_prev=n,delete r.beam_st,r.beam_end=!0,r.tmp=!0,delete r.slur_start,delete r.slur_end,r.x+=12,r.x<realwidth-12&&(r.x=realwidth-12),n=r,a++;break}if(!x)return!1;if(e.s2=n,0==staff_tb[s].y){if(c)return!1}else if(!c)return e.s1=t,e.a=(t.ys-n.ys)/(t.xs-n.xs),e.b=t.ys-t.xs*e.a+staff_tb[s].y,e.nflags=i,!0;for(g=t,m=100,y=0,r=t;r.type!=C.NOTE||(1==(b=r.p_v.scale)&&(b=staff_tb[r.st].staffscale),r.stem>=0?(u=v+r.notes[0].shhd,r.notes[r.nhd].pit>y&&(y=r.notes[r.nhd].pit,g=r)):(u=-v+r.notes[r.nhd].shhd,r.notes[0].pit<m&&(m=r.notes[0].pit,g=r)),r.xs=r.x+u*b,r!=n);r=r.next);if(cfmt.flatbeams?p=0:!l&&a>=3&&g!=t&&g!=n&&(p=0),f=t.ys+staff_tb[s].y,void 0==p&&(p=(n.ys+staff_tb[n.st].y-f)/(n.xs-t.xs)),0!=p&&(p=p>0?BEAM_SLOPE*p/(BEAM_SLOPE+p):BEAM_SLOPE*p/(BEAM_SLOPE-p)),d=f-p*t.xs,_=0,r=t,l)$=.5*((t.grace?3.5:BEAM_SHIFT)*(i-1)+BEAM_DEPTH),t.stem!=n.stem&&t.nflags<n.nflags?$*=n.stem:$*=t.stem,d+=$;else if(t.grace)for(;$=p*r.xs+d-staff_tb[r.st].y,h=GSTEM-2,r.stem>0?h-=$-3*(r.notes[r.nhd].pit-18):h+=$-3*(r.notes[0].pit-18),h+=3*(r.nflags-1),h>_&&(_=h),r!=n;r=r.next);else{for(var A=BEAM_DEPTH+BEAM_SHIFT*(i-1);r.ts_prev&&r.ts_prev.type==C.NOTE&&r.ts_prev.time==r.time&&r.ts_prev.x>t.xs;)r=r.ts_prev;for(;r&&r.time<=n.time;r=r.ts_next)if(!(r.type!=C.NOTE||r.invis||r.st!=s&&r.v!=o)){if(u=r.v==o?r.xs:r.x,$=p*u+d-staff_tb[r.st].y,r.v==o)h=min_tb[0==r.nhd?0:1][r.nflags],r.stem>0?(r.notes[r.nhd].pit>26&&(h-=2,r.notes[r.nhd].pit>28&&(h-=2)),h-=$-3*(r.notes[r.nhd].pit-18)):(r.notes[0].pit<18&&(h-=2,r.notes[0].pit<16&&(h-=2)),h-=3*(r.notes[0].pit-18)-$),h+=BEAM_DEPTH+BEAM_SHIFT*(r.nflags-1);else{if(t.stem>0)if(r.stem>0){if(r.ymn>$+4||r.ymx<$-A-2)continue;h=r.v>o?r.ymx-$:r.ymn+8-$}else h=r.ymx-$;else if(r.stem<0){if(r.ymx<$-4||r.ymn>$-A-2)continue;h=r.v<o?$-r.ymn:$-r.ymx+8}else h=$-r.ymn;h+=2+A}h>_&&(_=h)}}if(_>0&&(d+=t.stem*_),!c&&!l)for(r=t.next;;r=r.next){var k;switch(r.type){case C.REST:if(!(k=r.ts_next)||k.st!=s||k.type!=C.NOTE&&k.type!=C.REST)break;case C.BAR:if(r.invis)break;case C.CLEF:f=p*r.x+d,t.stem>0?(f=r.ymx-f+BEAM_DEPTH+BEAM_SHIFT*(i-1)+2)>0&&(d+=f):(f=r.ymn-f-BEAM_DEPTH-BEAM_SHIFT*(i-1)-2)<0&&(d+=f);break;case C.GRACE:for(k=r.extra;k;k=k.next)f=p*k.x+d,t.stem>0?(f=k.ymx-f+BEAM_DEPTH+BEAM_SHIFT*(i-1)+2)>0&&(d+=f):(f=k.ymn-f-BEAM_DEPTH-BEAM_SHIFT*(i-1)-2)<0&&(d+=f)}if(r==n)break}for(0==p&&(d+=b_pos(t.grace,t.stem,i,d-staff_tb[s].y)),r=t;;r=r.next){switch(r.type){case C.NOTE:r.ys=p*r.xs+d-staff_tb[r.st].y,r.stem>0?(r.ymx=r.ys+2.5,r.ts_prev&&r.ts_prev.stem>0&&r.ts_prev.st==r.st&&r.ts_prev.ymn<r.ymx&&r.ts_prev.x==r.x&&0==r.notes[0].shhd&&(r.ts_prev.x-=3,r.ts_prev.xs-=3)):r.ymn=r.ys-2.5;break;case C.REST:if(f=p*r.x+d-staff_tb[r.st].y,w=BEAM_DEPTH+BEAM_SHIFT*(i-1)+(r.head!=C.FULL?4:9),t.stem>0){if(f-=w,0==t.multi&&f>12&&(f=12),r.y<=f)break}else if(f+=w,0==t.multi&&f<12&&(f=12),r.y>=f)break;r.head!=C.FULL&&(f=6*((f+3+12)/6|0)-12),r.y=f}if(r==n)break}return 0!=staff_tb[s].y&&(e.s1=t,e.a=p,e.b=d,e.nflags=i,!0)}function draw_beams(e){function t(e,t,r,n,a,i){var s,o,c=a.s1,l=c.nflags;c.ntrem&&(l-=c.ntrem),c.trem2&&i>l&&(c.dur>=C.BLEN/2?(e=c.x+6,t=a.s2.x-6):c.dur<C.BLEN/4&&(e+=5,t-=6)),s=a.a*e+a.b-r,t-=e,t/=stv_g.scale,o=a.a*t*stv_g.scale,xypath(e,s,!0),output+="l"+t.toFixed(2)+" "+(-o).toFixed(2)+"v"+n.toFixed(2)+"l"+(-t).toFixed(2)+" "+o.toFixed(2)+'z"/>\n'}var r,n,a,i,s,o,c,l,u,f,$,p,d=e.s1,h=e.s2;for(anno_start(d,"beam"),d.grace?(s=3.5,o=3.2,i=.29,c=1.8):(s=BEAM_SHIFT,o=BEAM_STUB,i=.34,c=BEAM_DEPTH),a=d.stem,d.stem!=h.stem&&d.nflags<h.nflags&&(a=h.stem),a<0&&(c=-c),t(d.xs-i,h.xs+i,0,c,e,1),l=0,r=d;r.type==C.NOTE&&r.stem!=a&&(r.ys=e.a*r.xs+e.b-staff_tb[r.st].y+s*(r.nflags-1)*r.stem-c),r!=h;r=r.next);for(d.feathered_beam&&(l=s/(h.xs-d.xs),d.feathered_beam>0?(l=-l,s=l*d.xs):s=l*h.xs,l*=a),i=0,n=2;n<=e.nflags;n++)for(i+=s,0!=l&&(e.a+=l),r=d;;r=r.next)if(r.type!=C.NOTE||r.nflags<n){if(r==h)break}else if(r.trem1&&n>r.nflags-r.ntrem){if(p=r.dur>=C.BLEN/2?r.x:r.xs,t(p-5,p+5,(i+2.5)*a,c,e,n),r==h)break}else{for(f=r;;){if(r==h)break;if(u=r.next,u.type==C.NOTE||u.type==C.REST)if(u.trem1){if(u.nflags-u.ntrem<n)break}else if(u.nflags<n)break;if(u.beam_br1||u.beam_br2&&n>2)break;r=u}for($=r;$.type!=C.NOTE;)$=$.prev;if(p=f.xs,f==$)if(f==d)p+=o;else if(f==h)p-=o;else if(f.beam_br1||f.beam_br2&&n>2)p+=o;else{for(u=f.next;u.type!=C.NOTE;)u=u.next;if(u.beam_br1||u.beam_br2&&n>2)p-=o;else{for(f=f.prev;f.type!=C.NOTE;)f=f.prev;f.nflags<u.nflags||f.nflags==u.nflags&&f.dots<u.dots?p+=o:p-=o}}if(t(p,$.xs,i*a,c,e,n),r==h)break}d.tmp?unlksym(d):h.tmp&&unlksym(h),anno_stop(d,"beam")}function draw_lstaff(e){function t(e,t,r){for(var n,a,i,s;!cur_sy.st_print[t];){if(cur_sy.staves[t].flags&r)return;t++}for(n=a=t;;){if(cur_sy.st_print[n]&&(a=n),cur_sy.staves[n].flags&r)break;n++}i=staff_tb[t].y+staff_tb[t].topbar*staff_tb[t].staffscale,s=staff_tb[a].y+staff_tb[a].botbar*staff_tb[a].staffscale,r&(CLOSE_BRACE|CLOSE_BRACE2)?out_brace(e,s,i-s):out_bracket(e,i,i-s)}var r,n,a,i,s=cur_sy.nstaff,o=0;for(r=0;(cur_sy.staves[r].flags&(OPEN_BRACE|OPEN_BRACKET)&&o++,!cur_sy.st_print[r])&&(cur_sy.staves[r].flags&(CLOSE_BRACE|CLOSE_BRACKET)&&o--,r!=s);r++);for(n=s;n>r&&!cur_sy.st_print[n];n--);if(r!=n||0!=o)for(a=staff_tb[n].y+staff_tb[n].botbar*staff_tb[n].staffscale,i=staff_tb[r].y+staff_tb[r].topbar*staff_tb[r].staffscale-a,xypath(e,a),output+="v"+(-i).toFixed(2)+'"/>\n',r=0;r<=s;r++)cur_sy.staves[r].flags&OPEN_BRACE&&t(e,r,CLOSE_BRACE),cur_sy.staves[r].flags&OPEN_BRACKET&&t(e,r,CLOSE_BRACKET),cur_sy.staves[r].flags&OPEN_BRACE2&&t(e-6,r,CLOSE_BRACE2),cur_sy.staves[r].flags&OPEN_BRACKET2&&t(e-6,r,CLOSE_BRACKET2)}function draw_meter(e,t){if(t.a_meter){var r,n,a,i,s=t.st,o=staff_tb[s],c=o.y;for("|||||"!=o.stafflines&&(c+=(o.topbar+o.botbar)/2-12),r=0;r<t.a_meter.length;r++){var l,u=t.a_meter[r];if(e=t.x+t.x_meter[r],u.bot){for(a=i="",n=0;n<u.top.length;n++)a+=tgls["meter"+u.top[n]].c;for(n=0;n<u.bot.length;n++)i+=tgls["meter"+u.bot[n]].c;out_XYAB('<g transform="translate(X,Y)" text-anchor="middle">\n\t<text y="-12">A</text>\n\t<text>B</text>\n</g>\n',e,c+6,a,i)}else switch(u.top[0]){case"C":l="|"!=u.top[1]?"csig":"ctsig",e-=5,c+=12;break;case"c":l="."!=u.top[1]?"imsig":"iMsig";break;case"o":l="."!=u.top[1]?"pmsig":"pMsig";break;default:for(a="",n=0;n<u.top.length;n++)a+=tgls["meter"+u.top[n]].c;out_XYAB('<text x="X" y="Y" text-anchor="middle">A</text>\n',e,c+12,a)}l&&xygl(e,c,l)}}}function draw_acc(e,t,r,n,a){if(n)if(n==a)r=-1==r?-2:2;else if(2*n!=a)return void xygl(e,t,"acc"+r+"_"+n+"_"+a);xygl(e,t,"acc"+r)}function draw_hl(e,t,r,n,a){var i,s,o=staff_tb[n],c=o.y,l=o.stafflines,u=6*(l.length-1),f=o.botline;if(/[\[|]/.test(l)){if(t%6&&(t+=3),r%6&&(r-=3),l.indexOf("-")>=0&&(t>f&&t<u||r>f&&r<u||t<=f&&r>=u)){for(i=t,s=r;i>f&&"-"==l[i/6];)i-=6;for(;s<u&&"-"==l[s/6];)s+=6;for(;i<s;i+=6)"-"==l[i/6]&&xygl(e,c+i,a)}for(;t<f;t+=6)xygl(e,c+t,a);for(;r>u;r-=6)xygl(e,c+r,a)}}function draw_keysig(e,t,r){if(!r.k_none){var n,a,i,s=r.k_old_sf,o=e.st,c=staff_tb[o].y,l=r.k_y_clef;for(1&l&&(l+=7),l/=2;l<0;)l+=7;if(l%=7,r.k_a_acc){if(r.k_a_acc.length){var u,f=r.k_a_acc[0].acc,$=100;for(n=0;n<r.k_a_acc.length;n++)u=r.k_a_acc[n],a=3*(r.k_y_clef+u.pit-18),0!=n&&(a>$+18||a<$-18)?t-=5.5:u.acc!=f&&(t+=3),f=u.acc,draw_hl(t,a,a,o,"hl"),$=a,draw_acc(t,c+a,u.acc,u.micro_n,u.micro_d),t+=5.5}}else{if((cfmt.cancelkey||0==r.k_sf)&&(0==r.k_sf||s*r.k_sf<0)){for(a=sharp_cl[l],i=a>9?sharp1:sharp2,n=0;n<s;n++)xygl(t,c+a,"acc3"),a+=i[n],t+=5.5;for(a=flat_cl[l],i=a<18?flat1:flat2,n=0;n>s;n--)xygl(t,c+a,"acc3"),a+=i[-n],t+=5.5;0!=r.k_sf&&(t+=3)}if(r.k_sf>0){for(a=sharp_cl[l],i=a>9?sharp1:sharp2,n=0;n<r.k_sf;n++)xygl(t,c+a,"acc1"),a+=i[n],t+=5.5;if(cfmt.cancelkey&&n<s)for(t+=2;n<s;n++)xygl(t,c+a,"acc3"),a+=i[n],t+=5.5}if(r.k_sf<0){for(a=flat_cl[l],i=a<18?flat1:flat2,n=0;n>r.k_sf;n--)xygl(t,c+a,"acc-1"),a+=i[-n],t+=5.5;if(cfmt.cancelkey&&n>s)for(t+=2;n>s;n--)xygl(t,c+a,"acc3"),a+=i[-n],t+=5.5}}}}function bar_cnv(e){switch(e){case"[":case"[]":return"";case"|:":case"|::":case"|:::":return"["+e;case":|":case"::|":case":::|":return e+"]";case"::":return cfmt.dblrepbar;case"||:":return"[|:"}return e}function draw_bar(e,t,r){var n,a,i,s,o=e.st,c=staff_tb[o],l=e.x;if(s=bar_cnv(e.bar_type)){if(0!=o&&e.ts_prev&&e.ts_prev.type!=C.BAR&&(r=c.topbar*c.staffscale),e.ymx=e.ymn+r,set_sscale(-1),anno_start(e),i=c.y+12,"|||||"!=c.stafflines&&(i+=(c.topbar+c.botbar)/2-12),e.bar_mrep)if(set_sscale(o),1==e.bar_mrep){for(a=e.prev;a.type!=C.REST;a=a.prev);xygl(a.x,i,"mrep")}else xygl(l,i,"mrep2"),e.v==cur_sy.top_voice&&(set_font("annotation"),xy_str(l,i+c.topbar-9,e.bar_mrep.toString(),"c"));for(n=s.length;--n>=0;){switch(s[n]){case"|":set_sscale(-1),out_bar(l,t,r,e.bar_dotted);break;default:l-=3,set_sscale(-1),out_thbar(l,t,r);break;case":":l-=2,set_sscale(o),xygl(l+1,i-12,"rdots")}l-=3}set_sscale(-1),anno_stop(e)}}function draw_rest(e){var t,r,n,a,i,s,o=staff_tb[e.st];if(o.topbar){if(e.dur==e.p_v.meter.wmeasure||e.rep_nb&&e.rep_nb>=0){for(t=e.ts_next;t&&t.time!=e.time+e.dur;)t=t.ts_next;for(a=t?t.x:realwidth,t=e;!t.seqst;)t=t.ts_prev;t=t.ts_prev,a=(a+t.x)/2,e.a_dd&&deco_update(e,a-e.x),e.x=a}else a=e.x,e.notes[0].shhd&&(a+=e.notes[0].shhd*stv_g.scale);if(!e.invis){if(s=o.y,e.rep_nb)return set_sscale(e.st),anno_start(e),"|||||"==o.stafflines?s+=12:s+=(o.topbar+o.botbar)/2,e.rep_nb<0?xygl(a,s,"srep"):(xygl(a,s,"mrep"),e.rep_nb>2&&e.v==cur_sy.top_voice&&(set_font("annotation"),xy_str(a,s+o.topbar-9,e.rep_nb.toString(),"c"))),void anno_stop(e);if(set_scale(e),anno_start(e),i=e.y,r=5-e.nflags,7==r&&12==i&&o.stafflines.length<=2&&(i-=6),xygl(a,i+s,e.notes[0].head?e.notes[0].head:rest_tb[r]),r>=6){switch(n=i/6,r){default:switch(o.stafflines[n+1]){case"|":case"[":break;default:xygl(a,i+6+s,"hl1")}9==r&&(i-=6,n--);break;case 7:i+=6,n++;case 6:}switch(o.stafflines[n]){case"|":case"[":break;default:xygl(a,i+s,"hl1")}}for(a+=8,i+=s+3,r=0;r<e.dots;r++)xygl(a,i,"dot"),a+=3.5;anno_stop(e)}}}function draw_gracenotes(e){var t,r,n,a,i,s,o,c,l,u,f,$,p,d,h,_,m={};for(d=e.extra;d&&(d.beam_st&&!d.beam_end&&calculate_beam(m,d)&&draw_beams(m),anno_start(d),draw_note(d,!m.s2),d==m.s2&&(m.s2=null),anno_stop(d),d.next);d=d.next);if(e.sappo&&(d=e.extra,d.next?(a=.5*(d.next.x-d.x)+4,i=.5*(d.ys+d.next.ys)-d.y,d.stem>0?i-=1:i+=1):(a=9,i=d.stem>0?5:-5),_=d.notes[d.stem<0?0:d.nhd],out_acciac(x_head(d,_),y_head(d,_),a,i,d.stem>0)),!e.p_v.key.k_bagpipe&&cfmt.graceslurs&&!e.slur_start&&e.next&&e.next.type==C.NOTE){if(h=d,h.stem>=0){for(t=127,d=e.extra;d;d=d.next)d.y<t&&(t=d.y,h=d);r=h.x,n=h.y-5,e.extra!=h&&(r-=4,n+=1),e=e.next,c=e.x-1,e.stem<0&&(c-=4),l=3*(e.notes[0].pit-18)-5,$=.4*(c-r),$>3&&($=3),p=$,u=.2,f=.8,n>l+7?(r=h.x-1,n+=.5,l+=6.5,c=e.x-5.5,$=.8*(n-l),p=.2*(n-l),u=0):l>n+4&&(l=n+4,r=h.x+2,n=h.y-4)}else{for(t=-127,d=e.extra;d;d=d.next)d.y>t&&(t=d.y,h=d);r=h.x,n=h.y+5,e.extra!=h&&(r-=4,n-=1),e=e.next,c=e.x-1,e.stem>=0&&(c-=2),l=3*(e.notes[e.nhd].pit-18)+5,$=.4*(r-c),$<-3&&($=-3),p=$,u=.2,f=.8,n<l-7?(r=h.x-1,n-=.5,l-=6.5,c=e.x-5.5,$=.8*(n-l),p=.2*(n-l),u=0):l<n-4&&(l=n-4,r=h.x+2,n=h.y+4)}a=u*c+(1-u)*r-r,i=u*l+(1-u)*n-$-n,s=f*c+(1-f)*r-r,o=f*l+(1-f)*n-p-n,anno_start(e,"slur"),xypath(r,n+staff_tb[e.st].y),output+="c"+a.toFixed(2)+" "+(-i).toFixed(2)+" "+s.toFixed(2)+" "+(-o).toFixed(2)+" "+(c-r).toFixed(2)+" "+(-l+n).toFixed(2)+'"/>\n',anno_stop(e,"slur")}}function setdoty(e,t){var r,n,a;for(r=0;r<=e.nhd;r++)a=3*(e.notes[r].pit-18),a%6==0&&(e.dot_low?a-=3:a+=3),t[r]=a;for(r=0;r<e.nhd;r++)if(!(t[r+1]>t[r])){for(n=r;n>0&&!(t[n]>t[n-1]+6);)n--;if(3*(e.notes[n].pit-18)-t[n]<t[r+1]-3*(e.notes[r+1].pit-18))for(;n<=r;)t[n++]-=6;else t[r+1]=t[r]+6}}function x_head(e,t){return e.x+t.shhd*stv_g.scale}function y_head(e,t){return staff_tb[e.st].y+3*(t.pit-18)}function draw_basic_note(e,t,r,n){var a,i,s,o,c,l=!1,u=t.notes[r],f=staff_tb[t.st].y,$=3*(u.pit-18),p=u.shhd*stv_g.scale,d=e+p,h=$+f,_=identify_note(t,u.dur),m=_[0],y=_[1];_[2];if($%6==0&&p!=(t.stem>0?t.notes[0].shhd:t.notes[t.nhd].shhd)&&(s=0,$>=30?(s=$)%6&&(s-=3):$<=-6&&(s=$)%6&&(s+=3),s&&xygl(d,s+f,"hl")),u.invis);else if(t.grace)i="ghd",d-=4.5*stv_g.scale;else if(u.map&&u.map[0])a=t.head,i=u.map[0][a],i||(i=u.map[0][u.map[0].length-1]),(a=i.indexOf("/"))>=0&&(i=t.stem>=0?i.slice(0,a):i.slice(a+1));else if(t.type==C.CUSTOS)i="custos";else switch(m){case C.OVAL:i="HD";break;case C.OVALBARS:if(t.head!=C.SQUARE){i="HDD";break}case C.SQUARE:i=u.dur<4*C.BLEN?"breve":"longa",tsnext||!t.next||t.next.type!=C.BAR||t.next.next||(y=0);break;case C.EMPTY:i="Hd";break;default:i="hd"}if(void 0!=u.color?l=set_color(u.color):u.map&&u.map[2]&&(l=set_color(u.map[2])),i&&xygl(d,h,i),y)for(o=e+(7.7+t.xmx)*stv_g.scale,void 0==n[r]&&(n[r]=3*(t.notes[r].pit-18),0==(1&t.notes[r].pit)&&(n[r]+=3)),c=n[r]+f;--y>=0;)xygl(o,c,"dot"),o+=3.5;u.acc&&(e-=u.shac*stv_g.scale,t.grace?(g_open(e,$+f,0,.75),draw_acc(0,0,u.acc,u.micro_n,u.micro_d),g_close()):draw_acc(e,$+f,u.acc,u.micro_n,u.micro_d)),void 0!=l&&set_color(l)}function draw_note(e,t){var r,n,a,i,s,o,c,l,a,u,f=new Array(e.nhd+1);if(e.dots&&setdoty(e,f),u=e.notes[e.stem<0?e.nhd:0],l=x_head(e,u),i=staff_tb[e.st].y,e.grace)o="ghl";else switch(e.head){default:o="hl";break;case C.OVAL:case C.OVALBARS:o="hl1";break;case C.SQUARE:o="hl2"}if(draw_hl(l,3*(e.notes[0].pit-18),3*(e.notes[e.nhd].pit-18),e.st,o),a=y_head(e,u),e.stemless?e.xstem&&(r=e.ts_prev,s=(r.stem>0?r.y:r.ys)-e.y,s+=staff_tb[r.st].y-i,s/=e.p_v.scale,out_stem(l,a,s)):(s=e.ys-e.y,c=e.nflags,e.ntrem&&(c-=e.ntrem),!t||c<=0?(e.nflags>0&&(e.stem>=0?s-=1:s+=1),out_stem(l,a,s,e.grace)):out_stem(l,a,s,e.grace,c,cfmt.straightflags)),t&&e.trem1){var $=e.ntrem||0,p=l;s=3*(e.notes[e.stem>0?e.nhd:0].pit-18),e.head==C.FULL||e.head==C.EMPTY?(p+=(e.grace?GSTEM_XOFF:3.5)*e.stem,e.stem>0?s+=6+5.4*$:s-=11.4):e.stem>0?s+=5+5.4*$:s-=10.4,s/=e.p_v.scale,out_trem(p,i+s,$)}for(l=e.x,n=0;n<=e.nhd;n++)draw_basic_note(l,e,n,f)}function next_scut(e){var t=e;for(e=e.next;e;e=e.next){if(e.rbstop)return e;t=e}return t}function prev_scut(e){for(;e.prev;)if(e=e.prev,e.rbstart)return e;for(e=e.p_v.sym;e.type!=C.CLEF;)e=e.ts_prev;return e.next&&e.next.type==C.KEY&&(e=e.next),e.next&&e.next.type==C.METER?e.next:e}function slur_direction(e,t){var r,n,a;if(e.grace&&e.stem>0)return-1;for(r=e;;r=r.next){if(r.type==C.NOTE){if(!r.stemless){if(r.stem<0)return 1;n=!0}r.notes[0].pit<22&&(a=!0)}if(r==t)break}return n||a?-1:1}function slur_out(e,t,r,n,a,i,s){var o,c,l,u=.3;c=n-t,c<0&&(c=-c),(o=r-e)>40&&c/o<.7&&(u=.3+.002*(o-40))>.7&&(u=.7);var f=.5*(e+r),$=.5*(t+n),p=f+u*(e-f),d=$+u*(t-$)+i;p=e+.45*(p-e),d=t+.45*(d-t);var h=f+u*(r-f),_=$+u*(n-$)+i;h=r+.45*(h-r),_=n+.45*(_-n),o=.03*(r-e),c=2*a,l=.2+.001*(r-e),l>.6&&(l=.6),l*=a;var m=stv_g.v?stv_g.scale:1;output+=s?'<path class="stroke" stroke-dasharray="5,5" d="M':'<path class="fill" d="M',out_sxsy(e," ",t),output+="c"+((p-e)/stv_g.scale).toFixed(2)+" "+((t-d)/m).toFixed(2)+" "+((h-e)/stv_g.scale).toFixed(2)+" "+((t-_)/m).toFixed(2)+" "+((r-e)/stv_g.scale).toFixed(2)+" "+((t-n)/m).toFixed(2),s||(output+="\n\tv"+(-l).toFixed(2)+"c"+((h-o-r)/stv_g.scale).toFixed(2)+" "+((n+l-_-c)/m).toFixed(2)+" "+((p+o-r)/stv_g.scale).toFixed(2)+" "+((n+l-d-c)/m).toFixed(2)+" "+((e-r)/stv_g.scale).toFixed(2)+" "+((n+l-t)/m).toFixed(2)),output+='"/>\n'}function slur_multi(e,t){for(;;){if(e.multi)return e.multi;if(e==t)break;e=e.next}return 0}function draw_slur(e,t,r,n,a){for(var i,s,o,c,l,u,f,$,p,d,h,_,m,y,g,v=e;v.v!=t.v;)v=v.ts_next;switch(7&a){case C.SL_ABOVE:g=1;break;case C.SL_BELOW:g=-1;break;default:g=slur_multi(v,t),g||(g=slur_direction(v,t))}var b=1,x=v.st,w=!1;if(v!=t)for(i=v.next;;){if(i.type!=C.NOTE&&i.type!=C.REST||(b++,i.st!=x&&(w=!0,i.st<x&&(x=i.st))),i==t)break;i=i.next}if(w&&error(2,v,"*** multi-staves slurs not treated yet"),o=e.x,e.notes&&e.notes[0].shhd&&(o+=e.notes[0].shhd),e!=t)l=t.x,t.notes&&(l+=t.notes[0].shhd);else{for(i=t.ts_next;i&&i.type!=C.STAVES;i=i.ts_next);l=i?i.x:realwidth}if(r>=0?c=3*(v.notes[r].pit-18)+5*g:(c=g>0?v.ymx+2:v.ymn-2,v.type==C.NOTE&&(g>0?v.stem>0&&(o+=5,v.beam_end&&v.nflags>=-1&&!v.in_tuplet&&(v.nflags>0?(o+=2,c=v.ys-3):c=v.ys-6)):v.stem<0&&(o-=1,t.grace?c=v.y-8:v.beam_end&&v.nflags>=-1&&(!v.in_tuplet||v.ys<c+3)&&(v.nflags>0?(o+=2,c=v.ys+3):c=v.ys+6)))),n>=0?u=3*(t.notes[n].pit-18)+5*g:(u=g>0?t.ymx+2:t.ymn-2,t.type==C.NOTE&&(g>0?t.stem>0&&(l+=1,t.beam_st&&t.nflags>=-1&&!t.in_tuplet&&(u=t.ys-6)):t.stem<0&&(l-=5,t.beam_st&&t.nflags>=-1&&!t.in_tuplet&&(u=t.ys+6)))),v.type!=C.NOTE&&(c=u+1.2*g,(o=v.x+.5*v.wr)>l-12&&(o=l-12)),t.type!=C.NOTE&&(u=v.type==C.NOTE?c+1.2*g:c,v!=t&&(l=t.x-.3*t.wl)),b>=3&&(v.next.type!=C.BAR&&v.next.x<o+48&&(g>0?(d=v.next.ymx-2,c<d&&(c=d)):(d=v.next.ymn+2,c>d&&(c=d))),t.prev&&t.prev.type!=C.BAR&&t.prev.x>l-48&&(g>0?(d=t.prev.ymx-2,u<d&&(u=d)):(d=t.prev.ymn+2,u>d&&(u=d)))),p=(u-c)/(l-o),(p>SLUR_SLOPE||p<-SLUR_SLOPE)&&(p=p>SLUR_SLOPE?SLUR_SLOPE:-SLUR_SLOPE,p*g>0?c=u-p*(l-o):u=c+p*(l-o)),d=u-c,d>8?d=8:d<-8&&(d=-8),h=d,h<0&&(h=-h),m=.5*h,y=.3*d,d*g>0?(l-=m,u-=y):(o+=m,c+=y),v.grace&&(o=v.x-.5*GSTEM_XOFF),t.grace&&(l=t.x+1.5*GSTEM_XOFF),_=0,p=(u-c)/(l-o),v!=t&&v.v==t.v){for($=c-p*o,i=v.next;i!=t;i=i.next)if(i.st==x)switch(i.type){case C.NOTE:case C.REST:g>0?(d=3*(i.notes[i.nhd].pit-18)+6,d<i.ymx&&(d=i.ymx),(d-=p*i.x+$)>_&&(_=d)):(d=3*(i.notes[0].pit-18)-6,d>i.ymn&&(d=i.ymn),(d-=p*i.x+$)<_&&(_=d));break;case C.GRACE:for(s=i.extra;s;s=s.next)g>0?(d=3*(s.notes[s.nhd].pit-18)+6,d<s.ymx&&(d=s.ymx),(d-=p*s.x+$)>_&&(_=d)):(d=3*(s.notes[0].pit-18)-6,d>s.ymn&&(d=s.ymn),(d-=p*s.x+$)<_&&(_=d))}c+=.45*_,u+=.45*_,_*=.65}if(f=b>3?(.08*(l-o)+12)*g:(.03*(l-o)+8)*g,g>0?(f<3*_&&(f=3*_),f>40&&(f=40)):(f>3*_&&(f=3*_),f<-40&&(f=-40)),d=u-c,d<0&&(d=-d),g>0?f<.8*d&&(f=.8*d):f>-.8*d&&(f=-.8*d),f*=cfmt.slurheight,slur_out(o,c,l,u,g,f,a&C.SL_DOTTED),m=l-o,p=(u-c)/m,$=c-p*o+.4*f,v.v==t.v)for(i=v;i!=t;i=i.next)i.st==x&&(d=p*i.x+$,i.ymx<d?i.ymx=d:i.ymn>d&&(i.ymn=d),i.next==t?(m=l,t.sl1&&(m-=5)):m=i.next.x,i!=v&&(o=i.x),m-=o,y_set(x,g>0,o,m,d));return(g>0?C.SL_ABOVE:C.SL_BELOW)|a&C.SL_DOTTED}function draw_slurs(e,t){for(var r,n,a,i,s,o,c,l,u=e;;){if(!u||u==t){if(!a||!(u=a.next)||u==t)break;a=null}if(u.type!=C.GRACE)if(u.type!=C.NOTE&&u.type!=C.REST&&u.type!=C.SPACE||!u.slur_start&&!u.sl1)u=u.next;else{n=null,r=u.next;for(var f=!1;;)if(r)if(r.type!=C.GRACE){if(r.type==C.BAR&&(":"==r.bar_type[0]||"|]"==r.bar_type||"[|"==r.bar_type||r.text&&"1"!=r.text[0])){n=r;break}if(r.type==C.NOTE||r.type==C.REST||r.type==C.SPACE){if(r.slur_end||r.sl2){n=r;break}if(r.slur_start||r.sl1){if(i){for(n=r;n.next;n=n.next);n.next=i.next,i.next&&(i.next.prev=n),n=null}draw_slurs(r,t),i&&i.next&&(i.next.prev.next=null,i.next.prev=i)}if(r==t)break;r=r.next}else r=r.next}else i=r,r=r.extra;else{if(i){r=i.next,i=null;continue}if(!a||f)break;r=a.next,f=!0}if(r){if(!n){if((u=r)==t)break;continue}}else n=next_scut(u);if(a){for(r=u;r.next;r=r.next);r.next=a.next,a.next&&(a.next.prev=r),a.slur_start=C.SL_AUTO}if(i&&(i.prev.next=i.extra,i.extra.prev=i.prev,i.slur_start=C.SL_AUTO),u.slur_start)c=15&u.slur_start,u.slur_start>>=4,s=-1;else{for(s=0;s<=u.nhd&&!u.notes[s].sl1;s++);c=15&u.notes[s].sl1,u.notes[s].sl1>>=4,u.sl1--}if(o=-1,l=0,n.type!=C.NOTE&&n.type!=C.REST&&n.type!=C.SPACE||!n.slur_end&&!n.sl2)n.type==C.BAR&&(":"==n.bar_type[0]||"|]"==n.bar_type||"[|"==n.bar_type||n.text&&"1"!=n.text[0])||(l=1);else if(n.slur_end)n.slur_end--;else{for(o=0;o<=n.nhd&&!n.notes[o].sl2;o++);n.notes[o].sl2--,n.sl2--}if(c=draw_slur(u,n,s,o,c),l&&(n.p_v.slur_start||(n.p_v.slur_start=0),n.p_v.slur_start<<=4,n.p_v.slur_start+=c),a&&a.next&&(a.next.prev.next=null,a.next.prev=a),i&&(i.prev.next=i,i.extra.prev=null),!u.slur_start&&!u.sl1){if(u==t)break;u=u.next}}else a=u,u=u.extra}}function draw_tuplet(e,t){var r,n,a,i,s,o,c,l,u,f,$,p,d,h,_,m,y,d,g,v,b,x,w;for(i=e.st,r=e;r;r=r.next)if(r.type==C.NOTE||r.type==C.REST){if((r.slur_start||r.slur_end||r.sl1||r.sl2)&&(o=!0),r.st<i&&(i=r.st),0==t){if(r.tp1&&draw_tuplet(r,1),r.te0)break}else if(r.te1)break}else if(r.type==C.GRACE)for(a=r.extra;a;a=a.next)(a.slur_start||a.sl1)&&(o=!0);if(!r)return error(1,e,"No end of tuplet in this music line"),void(0==t?e.tp0=0:e.tp1=0);if(o){if(draw_slurs(e,r),e.slur_start||e.sl1)return;for(n=e.next;n!=r;n=n.next)if(n.slur_start||n.slur_end||n.sl1||n.sl2)return;if(r.slur_end||r.sl2)return}if(0==t?(b=e.tp0,e.tp0=0,x=e.tq0):(b=e.tp1,e.tp1=0,x=e.tq1),1!=e.tf[0]){if(v=e.tf[3],v||(v=e.stem>0?C.SL_ABOVE:C.SL_BELOW),e==r)s=!0;else if(1==e.tf[1])s=!0,draw_slur(e,r,-1,-1,v);else if(2==e.tf[0]||e.type!=C.NOTE||r.type!=C.NOTE)s=!1;else{for(s=!0,n=e;;n=n.next){if(n.type!=C.NOTE&&n.type!=C.REST){if(n.type==C.GRACE||n.type==C.SPACE)continue;s=!1;break}if(n==r)break;if(n.beam_end){s=!1;break}}if(s&&!e.beam_st&&!e.beam_br1&&!e.beam_br2)for(n=e.prev;n;n=n.prev)if(n.type==C.NOTE||n.type==C.REST){n.nflags>=e.nflags&&(s=!1);break}if(s&&!r.beam_end)for(n=r.next;n;n=n.next)if(n.type==C.NOTE||n.type==C.REST){!n.beam_br1&&!n.beam_br2&&n.nflags>=r.nflags&&(s=!1);break}}if(s){if(1==e.tf[2])return;for($=(r.x+e.x)/2,d=e==r?0:(r.ys-e.ys)/(r.x-e.x),g=e.ys-d*e.x,_=d*$+g,v==C.SL_ABOVE?(p=y_get(i,1,$-4,8),p>_&&(g+=p-_),g+=2):(p=y_get(i,0,$-4,8),p<_&&(g+=p-_),g-=10),n=e;!(n.x>=$);n=n.next);return e.stem*r.stem>0&&(e.stem>0?$+=1.5:$-=1.5),p=d*$+g,0==e.tf[2]?out_bnum($,p,b):out_bnum($,p,b+":"+x),void(v==C.SL_ABOVE?(p+=10,n.ymx<p&&(n.ymx=p),y_set(i,!0,$-3,6,p)):(n.ymn>p&&(n.ymn=p),y_set(i,!1,$-3,6,p)))}if(0!=e.tf[1]&&error(2,e,"'what' value of %%tuplets not yet coded"),v=e.tf[3],v||(v=e.multi>=0?C.SL_ABOVE:C.SL_BELOW),v==C.SL_ABOVE){if(e.st==r.st?u=f=staff_tb[i].topbar+4:(u=e.ymx,f=r.ymx),c=e.x-4,e.st==i){for(n=e;!n.dur;n=n.next);p=y_get(i,1,n.x-4,8),p>u&&(u=p),e.stem>0&&(c+=3)}if(r.st==i){for(n=r;!n.dur;n=n.prev);p=y_get(i,1,n.x-4,8),p>f&&(f=p)}for(r.dur>r.prev.dur?l=r.next?r.next.x-r.next.wl-5:realwidth-6:(l=r.x+4,w=r.stem>=0?0:r.nhd,r.notes[w].shhd>0&&(l+=r.notes[w].shhd),r.st==i&&r.stem>0&&(l+=3.5)),$=.5*(c+l),p=.5*(u+f),d=(f-u)/(l-c),h=3*(r.notes[r.nhd].pit-e.notes[e.nhd].pit)/(l-c),h>0?d<0?d=0:d>h&&(d=h):d>0?d=0:d<h&&(d=h),d*d<.1*.1&&(d=0),y=0,n=e;;n=n.next)if(n.dur&&n.st==i){if(_=p+(n.x-$)*d,m=y_get(i,1,n.x-4,8)+2,m-_>y&&(y=m-_),n==r)break}else if(n==r)break;for(p+=y,u=p+d*(c-$),f=p+d*(l-$),p+=8,n=e;;n=n.next)if(n.st==i){if(_=p+(n.x-$)*d,n.ymx<_&&(n.ymx=_),n==r)break;y_set(i,!0,n.x,n.next.x-n.x,_)}else if(n==r)break}else{if(c=e.x-7,r.dur>r.prev.dur?l=r.next?r.next.x-r.next.wl-8:realwidth-6:(l=r.x+2,r.notes[r.nhd].shhd>0&&(l+=r.notes[r.nhd].shhd)),e.stem>=0&&(c+=2,l+=2),e.st==i){for(n=e;!n.dur;n=n.next);u=y_get(i,0,n.x-4,8)}else u=0;if(r.st==i){for(n=r;!n.dur;n=n.prev);f=y_get(i,0,n.x-4,8)}else f=0;for($=.5*(c+l),p=.5*(u+f),d=(f-u)/(l-c),h=3*(r.notes[0].pit-e.notes[0].pit)/(l-c),h>0?d<0?d=0:d>h&&(d=h):d>0?d=0:d<h&&(d=h),d*d<.1*.1&&(d=0),y=0,n=e;;n=n.next)if(n.dur&&n.st==i){if(_=p+(n.x-$)*d,m=y_get(i,0,n.x-4,8),m-_<y&&(y=m-_),n==r)break}else if(n==r)break;for(p+=y-10,u=p+d*(c-$),f=p+d*(l-$),p-=2,n=e;;n=n.next){if(n.st==i){if(n==r)break;_=p+(n.x-$)*d,n.ymn>_&&(n.ymn=_),y_set(i,!1,n.x,n.next.x-n.x,_)}if(n==r)break}}if(1==e.tf[2])return void out_tubr(c,u+4,l-c,f-u,v==C.SL_ABOVE);out_tubrn(c,u,l-c,f-u,v==C.SL_ABOVE,0==e.tf[2]?b.toString():b+":"+x),_=.5*(u+f),v==C.SL_ABOVE?y_set(i,!0,$-3,6,_+9):y_set(i,!1,$-3,6,_)}}function draw_note_ties(e,t,r,n,a){var i,s,o,c,l,u,f,$,p,d,h,_,m,y;for(i=0;i<r.length;i++){switch(o=r[i],l=e.notes[o].pit,c=n[i],u=2!=a?t.notes[c].pit:l,s=(7&e.notes[o].ti1)==C.SL_ABOVE?1:-1,d=e.x,m=e.notes[o].shhd,s>0?o<e.nhd&&l+1==e.notes[o+1].pit&&e.notes[o+1].shhd>m&&(m=e.notes[o+1].shhd):o>0&&l==e.notes[o-1].pit+1&&e.notes[o-1].shhd>m&&(m=e.notes[o-1].shhd),d+=.6*m,h=t.x,2!=a&&(m=t.notes[c].shhd,s>0?c<t.nhd&&u+1==t.notes[c+1].pit&&t.notes[c+1].shhd<m&&(m=t.notes[c+1].shhd):c>0&&u==t.notes[c-1].pit+1&&t.notes[c-1].shhd<m&&(m=t.notes[c-1].shhd),h+=.6*m),$=e.st,a){case 0:l==u||1&l||(l=u);break;case 3:s=-s;case 1:d=e.x,d>h-20&&(d=h-20),l=u,$=t.st;break;default:if(e!=t)h-=t.wl,t.type==C.BAR&&(h+=5);else{for(y=e.time+e.dur,p=e.ts_next;p&&!(p.time>y);p=p.ts_next);h=p?p.x:realwidth}h<d+16&&(h=d+16)}h-d>20?(d+=3.5,h-=3.5):(d+=1.5,h-=1.5),f=3*(l-18),_=(.04*(h-d)+10)*s,slur_out(d,staff_tb[$].y+f,h,staff_tb[$].y+f,s,_,e.notes[o].ti1&C.SL_DOTTED)}}function draw_ties(e,t,r){var n,a,i,s,o,c,l=[],u=[],f=[],$=e.nhd,p=e.time+e.dur;if(2==r){for(a=0;a<=$;a++)e.notes[a].ti1&&f.push(a);return void draw_note_ties(e,t||e,f,f,r)}for(a=0;a<=$;a++)if(e.notes[a].ti1){for(c=-1,o=e.notes[a].apit,s=t.nhd;s>=0;s--){switch(t.notes[s].apit-o){case 1:case-1:e.notes[a].acc!=t.notes[s].acc&&(c=s);default:continue;case 0:c=s}break}c>=0?(l.push(a),u.push(c)):f.push(a)}if(draw_note_ties(e,t,l,u,r),f.length){for(n=e.ts_next;n&&n.time<p;)n=n.ts_next
;for(;n&&n.time==p;)if(n.type==C.NOTE&&n.st==e.st){for(l.length=0,u.length=0,a=f.length;--a>=0;)for(i=f[a],o=e.notes[i].apit,s=n.nhd;s>=0;s--)if(n.notes[s].apit==o){l.push(i),u.push(s),f[a]=f.pop();break}if(l.length>0&&(draw_note_ties(e,n,l,u,1==r?1:0),0==f.length))return;n=n.ts_next}else n=n.ts_next;0!=f.length&&error(1,e,"Bad tie")}}function tie_comb(e){var t,r,n;for(r=e.time+e.dur,n=e.st,t=e.ts_next;t;t=t.ts_next)if(t.st==n)if(t.time!=r){if(t.time>r)return e}else if(t.type==C.NOTE)return t}function draw_all_ties(e){function t(e,t,r){var n;if(e.type==C.GRACE)for(n=e.extra;n;n=n.next)n.ti1&&draw_ties(n,t,r);else draw_ties(e,t,r)}var r,n,a,i,s,o,c,l,u;for(r=e.sym;r;r=r.next){switch(r.type){case C.CLEF:case C.KEY:case C.METER:continue}break}for(o=e.s_rtie,n=r;n&&(!n.dur&&n.type!=C.GRACE);n=n.next)n.type==C.BAR&&n.text&&("1"==n.text[0]?o=e.s_tie:e.s_tie=o);if(n){for(e.s_tie&&(e.s_tie.x=r.x+r.wr,r=e.s_tie,e.s_tie=null,r.st=n.st,r.ts_next=n.ts_next,r.time=n.time-r.dur,draw_ties(r,n,1));;){for(r=n;r&&!r.ti1;r=r.next)if(o&&r.type==C.BAR&&r.text)if("1"!=r.text[0]){if("|"!=r.bar_type){for(n=r.next;n&&n.type!=C.NOTE;n=n.next);if(!n){r=null;break}c=clone(o),c.x=r.x,c.next=n,c.st=n.st,c.time=n.time-c.dur,draw_ties(c,n,1)}}else o=null;if(!r)break;for(s=r.time+r.dur,n=r.next;n&&!n.dur;n=n.next)if(n.text){if("1"!=n.text[0])break;o=r}if(n){if(n.type!=C.NOTE&&n.type!=C.BAR){error(1,r,"Bad tie");continue}if(n.time!=s){if((a=tie_comb(r))==r){error(1,r,"Bad tie");continue}n=a}}else{for(n=r.ts_next;n;n=n.ts_next)if(n.st==r.st&&!(n.time<s)){if(n.time>s){n=null;break}if(n.dur)break}if(!n){t(r,null,2),e.s_tie=r;break}}for(a=r.ts_next;a;a=a.ts_next)if(a.st==r.st){if(a.time>s)break;a.type!=C.CLEF||(i=!0)}i||r.st!=n.st?(i=!1,u=.4*(n.x-r.x),l=n.x,n.x-=u,n.x>r.x+32&&(n.x=r.x+32),t(r,n,2),n.x=l,l=r.x,r.x+=u,r.x<n.x-24&&(r.x=n.x-24),draw_ties(r,n,3),r.x=l):t(r,n,n.type==C.NOTE?0:2)}e.s_rtie=o}}function draw_all_slurs(e){var t,r,n=e.sym,a=e.slur_start,i=0;if(n){if(a)for(e.slur_start=0;0!=a;)i<<=4,i|=15&a,a>>=4;for(draw_slurs(n,void 0);n;n=n.next)for(;n.slur_end||n.sl2;){if(n.slur_end)n.slur_end--,r=-1;else{for(r=0;r<=n.nhd&&!n.notes[r].sl2;r++);n.notes[r].sl2--,n.sl2--}a=15&i,t=prev_scut(n),draw_slur(t,n,-1,r,a),t.type==C.BAR&&(":"==t.bar_type[0]||"|]"==t.bar_type||"[|"==t.bar_type||t.text&&"1"!=t.text[0])||(i>>=4)}for(n=e.sym;0!=i;)a=15&i,i>>=4,t=next_scut(n),draw_slur(n,t,-1,-1,a),t.type==C.BAR&&(":"==t.bar_type[0]||"|]"==t.bar_type||"[|"==t.bar_type||t.text&&"1"!=t.text[0])||(e.slur_start||(e.slur_start=0),e.slur_start<<=4,e.slur_start+=a)}}function draw_sym_near(){var e,t,r,n,a,i,s,o,c,a,l,u,f,$;for($=output,output="",n=0;n<voice_tb.length;n++){var p={},d=!0;for(e=voice_tb[n],r=e.sym;r;r=r.next)switch(r.type){case C.GRACE:for(s=r.extra;s;s=s.next)s.beam_st&&!s.beam_end&&calculate_beam(p,s);break;case C.NOTE:(r.beam_st&&!r.beam_end||d&&!r.beam_st)&&(d=!1,calculate_beam(p,r))}}for(a=0;a<=nstaff;a++)for(t=staff_tb[a],t.top||(t.top=new Float32Array(YSTEP),t.bot=new Float32Array(YSTEP)),c=0;c<YSTEP;c++)t.top[c]=0,t.bot[c]=24;for(set_tie_room(),draw_deco_near(),r=tsfirst;r;r=r.ts_next)if(!r.invis){switch(r.type){case C.GRACE:for(s=r.extra;s;s=s.next)y_set(r.st,!0,s.x-2,4,s.ymx+1),y_set(r.st,!1,s.x-2,4,s.ymn-1);continue;case C.MREST:y_set(r.st,!0,r.x+16,32,r.ymx+2);continue;default:y_set(r.st,!0,r.x-r.wl,r.wl+r.wr,r.ymx+2),y_set(r.st,!1,r.x-r.wl,r.wl+r.wr,r.ymn-2);continue;case C.NOTE:}r.stem>0?(r.beam_st?(l=3,o=r.beam_end?4:10):(l=-8,o=r.beam_end?11:16),y_set(r.st,!0,r.x+l,o,r.ymx),y_set(r.st,!1,r.x-r.wl,r.wl+r.wr,r.ymn)):(y_set(r.st,!0,r.x-r.wl,r.wl+r.wr,r.ymx),r.beam_st?(l=-6,o=r.beam_end?4:10):(l=-8,o=r.beam_end?5:16),l+=r.notes[0].shhd,y_set(r.st,!1,r.x+l,o,r.ymn)),r.notes[r.nhd].acc&&(i=r.y+8,r.ymx<i&&(r.ymx=i),y_set(r.st,!0,r.x,0,i)),r.notes[0].acc&&(i=r.y,1==r.notes[0].acc||3==r.notes[0].acc?i-=7:i-=5,r.ymn>i&&(r.ymn=i),y_set(r.st,!1,r.x,0,i))}for(n=0;n<voice_tb.length;n++)if(e=voice_tb[n],r=e.sym){for(set_color(r.color),a=e.st,set_dscale(a);r;r=r.next)r.tp0&&draw_tuplet(r,0);for(draw_all_slurs(e),r=e.sym;r;r=r.next)r.tp0&&draw_tuplet(r,0)}for(a=0;a<=nstaff;a++)for(t=staff_tb[a],u=t.topbar+2,f=t.botbar-2,c=0;c<YSTEP;c++)u>t.top[c]&&(t.top[c]=u),f<t.bot[c]&&(t.bot[c]=f);for(set_color(void 0),draw_deco_note(),draw_deco_staff(),set_dscale(-1),n=0;n<voice_tb.length;n++)if(e=voice_tb[n],e.have_ly){draw_all_lyrics();break}cfmt.measurenb>=0&&draw_measnb(),set_dscale(-1),output=$}function draw_vname(e){var t,r,n,a,i,s,o,c,l=[];for(n=cur_sy.nstaff;n>=0&&!cur_sy.st_print[n];n--);if(!(n<0)){for(a=0;a<voice_tb.length;a++)if(t=voice_tb[a],t.sym&&(n=cur_sy.voices[a].st,cur_sy.st_print[n])){if(t.new_name){c=2;break}t.snm&&(c=1)}if(c){for(a=0;a<voice_tb.length;a++)if(t=voice_tb[a],t.sym&&(n=cur_sy.voices[a].st,cur_sy.st_print[n]&&(t.new_name&&delete t.new_name,s=2==c?t.nm:t.snm))){if(cur_sy.staves[n].flags&CLOSE_BRACE2)for(;!(cur_sy.staves[n].flags&OPEN_BRACE2);)n--;else if(cur_sy.staves[n].flags&CLOSE_BRACE)for(;!(cur_sy.staves[n].flags&OPEN_BRACE);)n--;l[n]?l[n]+="\\n"+s:l[n]=s}if(0!=l.length)for(set_font("voice"),e=.5*-e,n=0;n<l.length;n++)if(l[n]){if(i=l[n].split("\\n"),o=staff_tb[n].y+.5*staff_tb[n].topbar*staff_tb[n].staffscale+9*(i.length-1)-.3*gene.curfont.size,r=n,cur_sy.staves[n].flags&OPEN_BRACE2)for(;!(cur_sy.staves[r].flags&CLOSE_BRACE2);)r++;else if(cur_sy.staves[n].flags&OPEN_BRACE)for(;!(cur_sy.staves[r].flags&CLOSE_BRACE);)r++;for(r!=n&&(o-=.5*(staff_tb[n].y-staff_tb[r].y)),r=0;r<i.length;r++)s=i[r],xy_str(e,o,s,"c"),o-=18}}}}function set_staff(){var e,t,r,n,a,i,s,o,c,l,u,f;for(n=0;n<voice_tb.length;n++)u=voice_tb[n],1!=u.scale&&(u.scale_str='transform="scale('+u.scale.toFixed(2)+')"');for(t=0;t<=nstaff&&!gene.st_print[t];t++);if(a=0,t>nstaff)t--,f=staff_tb[t];else for(f=staff_tb[t],e=0;e<YSTEP;e++)l=f.top[e],a<l&&(a=l);if(a+=draw_partempo(t,a),!gene.st_print[t])return a;a*=f.staffscale,i=.5*cfmt.staffsep+f.topbar*f.staffscale,a<i&&(a=i),a<f.ann_top&&(a=f.ann_top),f.y=-a,r=t;var $=cur_sy.staves[r];for(t++;t<=nstaff;t++)if(f=staff_tb[t],gene.st_print[t]){if(i=$.sep||cfmt.sysstaffsep,o=$.maxsep||cfmt.maxsysstaffsep,s=0,f.staffscale==staff_tb[r].staffscale){for(e=0;e<YSTEP;e++)l=f.top[e]-staff_tb[r].bot[e],s<l&&(s=l);s*=f.staffscale}else for(e=0;e<YSTEP;e++)l=f.top[e]*f.staffscale-staff_tb[r].bot[e]*staff_tb[r].staffscale,s<l&&(s=l);i+=f.topbar*f.staffscale,s<i&&(s=i),o+=f.topbar*f.staffscale,s>o&&(s=o),a+=s,f.y=-a,r=t,$=cur_sy.staves[r]}for(c=0,e=0;e<YSTEP;e++)l=staff_tb[r].bot[e],c>l&&(c=l);for(c>f.ann_bot&&(c=f.ann_bot),c*=staff_tb[r].staffscale,t=0;t<=nstaff;t++)f=staff_tb[t],s=f.y,1!=f.staffscale&&(f.scale_str='transform="translate(0,'+(posy-s).toFixed(2)+") scale("+f.staffscale.toFixed(2)+')"');if(0==c){for(t=nstaff;t>=0&&!gene.st_print[t];t--);if(t<0)return a}return s=-c,i=.5*cfmt.staffsep,s<i&&(s=i),o=.5*cfmt.maxstaffsep,s>o&&(s=o),a+s}function draw_systems(e){function t(){var e,t,r,n,a=0;for(e=0;e<=cur_sy.nstaff;e++)f[e]<0?$[e]=p[e]=0:(t=staff_tb[e].staffscale,r=staff_tb[e].topbar*t,n=staff_tb[e].botbar*t,0==a&&(a=staff_tb[e].y+r),$[e]=staff_tb[e].y+n,p[e]=a-$[e],a=cur_sy.staves[e].flags&STOP_BAR?0:$[e])}function r(e,t,r){var n,a,i,s,o,c=0,l="",u=cur_sy.staves[e].stafflines,f=u.length;if(/[\[|]/.test(u)){if(n=r-t,set_sscale(e),a=n/stv_g.scale,cache&&cache.st_l==u&&cache.st_ws==a)return void xygl(t,staff_tb[e].y,"stdef"+cfmt.fullsvg);for(i=0;i<f;i++,c-=6)if("."!=u[i]){for(s=0;i<f;i++,c-=6,s-=6){switch(u[i]){case".":case"-":continue;case o:l+="m-"+a.toFixed(2)+" "+s+"h"+a.toFixed(2),s=0;continue}void 0!=o&&(l+='"/>\n'),o=u[i],l+='<path class="stroke"',"["==o&&(l+=' stroke-width="1.5"'),l+=' d="m0 '+c+"h"+a.toFixed(2),s=0}l+='"/>\n'}if(c=staff_tb[e].y,!cache&&n==get_lwidth())return cache={st_l:u,st_ws:a},i="stdef"+cfmt.fullsvg,glyphs[i]='<g id="'+i+'">\n'+l+"</g>",void xygl(t,c,i);out_XYAB('<g transform="translate(X, Y)">\n'+l+"</g>\n",t,c)}}var n,a,i,s,o,c,l,u,f=[],$=[],p=[];for(draw_vname(e),i=0;i<=nstaff;i++)f[i]=cur_sy.st_print[i]?0:-1;for(t(),draw_lstaff(0),n=tsfirst;n;n=n.ts_next){if(u&&n.time!=u){for(u=0,i=0;i<=nstaff;i++)cur_sy.st_print[i]||(f[i]=-1);t()}switch(n.type){case C.STAVES:if(!(l=n.ts_prev.type==C.BAR?n.ts_prev.x:0)){for(a=n.ts_next;a&&a.time==n.time;a=a.ts_next){switch(a.type){case C.BAR:case C.CLEF:case C.KEY:case C.METER:l=a.x;continue}break}a||(l=realwidth)}for(c=n.sy,i=0;i<=nstaff;i++)s=f[i],s<0?c.st_print[i]&&(f[i]=l||n.x-n.wl-2):c.st_print[i]&&c.staves[i].stafflines==cur_sy.staves[i].stafflines||(l?(o=l,u=n.time):(o=n.x-n.wl-2,f[i]=-1),r(i,s,o),c.st_print[i]&&(f[i]=o));cur_sy=c,t();continue;case C.BAR:if(i=n.st,n.second||n.invis)break;draw_bar(n,$[i],p[i]);break;case C.STBRK:if(0==cur_sy.voices[n.v].range&&n.xmx>14){for(var d=0,h=0;h<voice_tb.length;h++)cur_sy.voices[h].range>0&&d++;for(a=n.ts_next;a&&a.type==C.STBRK;a=a.ts_next)d--;0==d&&draw_lstaff(n.x)}if(!(a=n.prev))break;if(o=a.x,a.type!=C.BAR&&(o+=a.wr),i=n.st,(s=f[i])>=0){if(s>=o)continue;r(i,s,o)}f[i]=n.x}}for(i=0;i<=nstaff;i++)u&&!cur_sy.st_print[i]||(s=f[i])<0||s>=realwidth||r(i,s,realwidth)}function draw_symbols(e){var t,r,n,a,i={};for(t=e.sym;t;t=t.next){if(t.invis)switch(t.type){case C.KEY:e.key=t;default:continue;case C.NOTE:}switch(r=t.x,set_color(t.color),t.type){case C.NOTE:set_scale(t),t.beam_st&&!t.beam_end&&calculate_beam(i,t)&&draw_beams(i),t.invis||(anno_start(t),draw_note(t,!i.s2),anno_stop(t)),t==i.s2&&(i.s2=null);break;case C.REST:draw_rest(t);break;case C.BAR:break;case C.CLEF:if(a=t.st,t.time>staff_tb[a].clef.time&&(staff_tb[a].clef=t),t.second)break;if(!staff_tb[t.st].topbar)break;set_color(void 0),set_sscale(a),anno_start(t),n=staff_tb[a].y,t.clef_name?xygl(r,n+t.y,t.clef_name):t.clef_small?xygl(r,n+t.y,"s"+t.clef_type+"clef"):xygl(r,n+t.y,t.clef_type+"clef"),t.clef_octave&&(t.clef_octave>0?(n+=t.ymx-10,t.clef_small&&(n-=1)):(n+=t.ymn+2,t.clef_small&&(n+=1)),xygl(r-2,n,"oct")),anno_stop(t);break;case C.METER:if(e.meter=t,t.second||!staff_tb[t.st].topbar)break;if(cfmt.alignbars&&0!=t.st)break;set_color(void 0),set_sscale(t.st),anno_start(t),draw_meter(r,t),anno_stop(t);break;case C.KEY:if(e.key=t,t.second||!staff_tb[t.st].topbar)break;set_color(void 0),set_sscale(t.st),anno_start(t),draw_keysig(e,r,t),anno_stop(t);break;case C.MREST:set_scale(t),r+=32,anno_start(t),xygl(r,staff_tb[t.st].y+12,"mrest"),out_XYAB('<text style="font-family:serif; font-weight:bold; font-size: 15px"\n\tx ="X" y="Y" text-anchor="middle">A</text>\n',r,staff_tb[t.st].y+28,t.nmes),anno_stop(t);break;case C.GRACE:set_scale(t),draw_gracenotes(t);break;case C.SPACE:case C.STBRK:break;case C.CUSTOS:set_scale(t),draw_note(t,0);break;case C.BLOCK:case C.PART:case C.REMARK:case C.STAVES:case C.TEMPO:break;default:error(2,t,"draw_symbols - Cannot draw symbol "+t.type)}}set_scale(e.sym),draw_all_ties(e),set_color(void 0)}function draw_all_sym(){var e,t,r=voice_tb.length;for(t=0;t<r;t++)e=voice_tb[t],e.sym&&void 0!=e.sym.x&&draw_symbols(e);draw_all_deco(),set_sscale(-1)}function set_tie_dir(e){var t,r,n,a,i,s,o;for(t=e;t;t=t.next)if(t.ti1)if(0==t.multi){for(i=n=0,s=128,r=0;r<=t.nhd;r++)t.notes[r].ti1&&(n++,s<128&&t.notes[r].pit<=s+1&&i++,s=t.notes[r].pit);if(n<=1){for(a=t.stem<0?C.SL_ABOVE:C.SL_BELOW,r=0;r<=t.nhd;r++)if(o=t.notes[r].ti1){(7&o)==C.SL_AUTO&&(t.notes[r].ti1=o&C.SL_DOTTED|a);break}}else if(0!=i){for(s=128,r=0;r<=t.nhd;r++)if(t.notes[r].ti1){if(s<128&&t.notes[r].pit<=s+1){n=r;break}s=t.notes[r].pit}for(a=C.SL_BELOW,r=0;r<=t.nhd;r++)0!=(o=t.notes[r].ti1)&&(n==r&&(a=C.SL_ABOVE),(7&o)==C.SL_AUTO&&(t.notes[r].ti1=o&C.SL_DOTTED|a))}else{if(1&n){for(n=(n-1)/2,a=C.SL_BELOW,r=0;r<=t.nhd;r++)0!=(o=t.notes[r].ti1)&&(0==n&&t.notes[r].pit>=22&&(a=C.SL_ABOVE),(7&o)==C.SL_AUTO&&(t.notes[r].ti1=o&C.SL_DOTTED|a),0==n--&&(a=C.SL_ABOVE));continue}for(n/=2,a=C.SL_BELOW,r=0;r<=t.nhd;r++)0!=(o=t.notes[r].ti1)&&((7&o)==C.SL_AUTO&&(t.notes[r].ti1=o&C.SL_DOTTED|a),0==--n&&(a=C.SL_ABOVE))}}else for(a=t.multi>0?C.SL_ABOVE:C.SL_BELOW,r=0;r<=t.nhd;r++)(7&(o=t.notes[r].ti1))==C.SL_AUTO&&(t.notes[r].ti1=o&C.SL_DOTTED|a)}function set_tie_room(){var e,t,r,n,a,i,s;for(n=0;n<voice_tb.length;n++)if(e=voice_tb[n],(t=e.sym)&&(t=t.next))for(set_tie_dir(t);t;t=t.next)if(t.ti1){if(t.notes[0].pit<20&&(7&t.notes[0].ti1)==C.SL_BELOW);else if(!(t.notes[t.nhd].pit>24&&(7&t.notes[t.nhd].ti1)==C.SL_ABOVE))continue;for(r=t.next;r&&r.type!=C.NOTE;)r=r.next;if(r){if(r.st!=t.st)continue;a=r.x-t.x-10}else a=realwidth-t.x-10;s=a<100?9:a<300?12:16,t.notes[t.nhd].pit>24&&(i=3*(t.notes[t.nhd].pit-18)+s,t.ymx<i&&(t.ymx=i),r&&r.ymx<i&&(r.ymx=i),y_set(t.st,!0,t.x+5,a,i)),t.notes[0].pit<20&&(i=3*(t.notes[0].pit-18)-s,t.ymn>i&&(t.ymn=i),r&&r.ymn>i&&(r.ymn=i),y_set(t.st,!1,t.x+5,a,i))}}function get_bool(e){return!e||!/^(0|n|f)/i.test(e)}function get_font_scale(e){var t=e.split(/\s+/);if(!(t.length<=1)){var r=parseFloat(t[t.length-1]);if(isNaN(r)||t<=0)return void syntax(1,"Bad scale value in %%font");font_scale_tb[t[0]]=r;for(var n in font_tb)if(font_tb.hasOwnProperty(n)){var a=font_tb[n];a.name==t[0]&&(a.swfac=a.size*r)}}}function param_set_font(e,t){var r,n,a,i,s,o,c,l,u,f;if("-"==e[e.length-2]){if((i=e[e.length-1])<"1"||i>"9")return;e="u"+i+"font"}n=cfmt[e],n&&(r=font_tb[n])&&(a=r.name+"."+r.size,r.class&&(a+="."+r.class)),i=t.indexOf("class="),i>=0&&(i+=6,s=t.indexOf(" ",i),f=s>0?t.slice(i,s):t.slice(i),t=t.replace(new RegExp("class="+f),"").trim()),s=t.split(/\s+/),o=s[0],"*"==o&&r?o=r.name:(o=o.replace("Times-Roman","serif"),o=o.replace("Times","serif"),o=o.replace("Helvetica","sans-serif"),o=o.replace("Courier","monospace")),s.length>1?"*"==(l=s[s.length-1])&&r&&(l=r.size):r&&(l=r.size),l&&(c=o+"."+l,f&&(c+="."+f),c!=a&&(r=font_tb[c],r||(u=font_scale_tb[o],u||(u=1.1),r={name:o,size:Number(l),swfac:l*u},font_tb[c]=r),f&&(r.class=f),cfmt[e]=c))}function get_unit(e){var t=parseFloat(e);switch(e.slice(-2)){case"CM":case"cm":t*=CM;break;case"IN":case"in":t*=IN;break;case"PT":case"pt":t*=.75}return t}function set_infoname(e){for(var t=cfmt.infoname.split("\n"),r=e[0],n=0;n<t.length;n++){if(t[n][0]==r)return 1==e.length?t.splice(n,1):t[n]=e,void(cfmt.infoname=t.join("\n"))}cfmt.infoname+="\n"+e}function get_textopt(e){return textopt[e]}function set_pos(e,t){e=e.slice(0,3),"ste"==e&&(e="stm"),set_v_param("pos",e+" "+t)}function set_writefields(e){var t,r,n=e.split(/\s+/);if(get_bool(n[1]))for(r=0;r<n[0].length;r++)t=n[0][r],cfmt.writefields.indexOf(t)<0&&(cfmt.writefields+=t);else for(r=0;r<n[0].length;r++)t=n[0][r],cfmt.writefields.indexOf(t)>=0&&(cfmt.writefields=cfmt.writefields.replace(t,""))}function set_v_param(e,t){if(curvoice)return void set_vp([e+"=",t]);e=[e+"=",t];info.V||(info.V={}),info.V["*"]?Array.prototype.push.apply(info.V["*"],e):info.V["*"]=e}function set_page(){img.chg&&(img.chg=!1,img.lm=cfmt.leftmargin-cfmt.printmargin,img.lm<0&&(img.lm=0),img.rm=cfmt.rightmargin-cfmt.printmargin,img.rm<0&&(img.rm=0),img.width=cfmt.pagewidth-2*cfmt.printmargin,img.width-img.lm-img.rm<100&&(error(0,void 0,"Bad staff width"),img.width=img.lm+img.rm+150),set_posx())}function set_format(e,t,r){var n,a,i,s,o;if(r)fmt_lock[e]=!0;else if(fmt_lock[e])return;if(/.+font(-[\d])?$/.test(e))switch(" box"==t.slice(-4)&&(s=!0,t=t.slice(0,-4)),param_set_font(e,t),e){case"gchordfont":cfmt.gchordbox=s;break;case"measurefont":cfmt.measurebox=s;break;case"partsfont":cfmt.partsbox=s}else switch(e){case"aligncomposer":case"barsperstaff":case"infoline":case"measurefirst":case"measurenb":case"rbmax":case"rbmin":case"shiftunison":if(i=parseInt(t),isNaN(i)){syntax(1,"Bad integer value");break}cfmt[e]=i;break;case"microscale":if(n=parseInt(t),isNaN(n)||n<4||n>256||n%1){syntax(1,errs.bad_val,"%%"+e);break}set_v_param("uscale",n);break;case"bgcolor":case"dblrepbar":case"titleformat":cfmt[e]=t;break;case"breaklimit":case"lineskipfac":case"maxshrink":case"pagescale":case"parskipfac":case"scale":case"slurheight":case"stemheight":case"stretchlast":if(n=parseFloat(t),isNaN(n)){syntax(1,errs.bad_val,"%%"+e);break}switch(e){case"scale":n/=.75;case"pagescale":e="scale",img.chg=!0}cfmt[e]=n;break;case"bstemdown":case"breakoneoln":case"cancelkey":case"contbarnb":case"custos":case"decoerr":case"dynalign":case"flatbeams":case"gchordbox":case"graceslurs":case"graceword":case"hyphencont":case"keywarn":case"linewarn":case"measurebox":case"partsbox":case"rbdbstop":case"singleline":case"squarebreve":case"straightflags":case"stretchstaff":case"timewarn":case"titlecaps":case"titleleft":cfmt[e]=get_bool(t);break;case"chordnames":for(i=t.split(","),cfmt.chordnames={},o=0;o<i.length;o++)cfmt.chordnames["CDEFGAB"[o]]=i[o];break;case"composerspace":case"indent":case"infospace":case"maxstaffsep":case"maxsysstaffsep":case"musicspace":case"partsspace":case"staffsep":case"subtitlespace":case"sysstaffsep":case"textspace":case"titlespace":case"topspace":case"vocalspace":case"wordsspace":n=get_unit(t),isNaN(n)?syntax(1,errs.bad_val,"%%"+e):cfmt[e]=n;break;case"print-leftmargin":syntax(0,"$1 is deprecated - use %%printmargin instead","%%"+e),e="printmargin";case"printmargin":case"leftmargin":case"pagewidth":case"rightmargin":if(n=get_unit(t),isNaN(n)){syntax(1,errs.bad_val,"%%"+e);break}cfmt[e]=n,img.chg=!0;break;case"concert-score":cfmt.sound="concert";break;case"writefields":set_writefields(t);break;case"dynamic":case"gchord":case"gstemdir":case"ornament":case"stemdir":case"vocal":case"volume":set_pos(e,t);break;case"font":get_font_scale(t);break;case"fullsvg":if(0!=parse.state){syntax(1,"Cannot have %%fullsvg inside a tune");break}cfmt[e]=t;break;case"gracespace":for(i=t.split(/\s+/),o=0;o<3;o++)if(isNaN(Number(i[o]))){syntax(1,errs.bad_val,"%%gracespace");break}for(o=0;o<3;o++)cfmt[e]=Number(i[o]);break;case"tuplets":cfmt[e]=t.split(/\s+/),i=cfmt[e][3],i&&posval[i]&&(cfmt[e][3]=posval[i]);break;case"infoname":set_infoname(t);break;case"notespacingfactor":if(n=parseFloat(t),isNaN(n)||n<1||n>2){syntax(1,errs.bad_val,"%%"+e);break}for(o=5,a=space_tb[o];--o>=0;)a/=n,space_tb[o]=a;for(o=5,a=space_tb[o];++o<space_tb.length;)a*=n,space_tb[o]=a;break;case"play":cfmt.sound="play";break;case"pos":e=t.split(/\s+/),set_pos(e[0],e[1]);break;case"sounding-score":cfmt.sound="sounding";break;case"staffwidth":if(i=get_unit(t),isNaN(i)){syntax(1,errs.bad_val,"%%"+e);break}if(i<100){syntax(1,"%%staffwidth too small");break}if((i=cfmt.pagewidth-i-cfmt.leftmargin)<2){syntax(1,"%%staffwidth too big");break}cfmt.rightmargin=i,img.chg=!0;break;case"textoption":cfmt[e]=get_textopt(t);break;case"titletrim":i=Number(t),isNaN(i)?cfmt[e]=get_bool(t):cfmt[e]=i;break;case"combinevoices":syntax(1,"%%combinevoices is deprecated - use %%voicecombine instead");break;case"voicemap":set_v_param("map",t);break;case"voicescale":set_v_param("scale",t);break;default:0==parse.state&&(cfmt[e]=t)}}function font_init(){param_set_font("annotationfont","sans-serif 12"),param_set_font("composerfont","serifItalic 14"),param_set_font("footerfont","serif 16"),param_set_font("gchordfont","sans-serif 12"),param_set_font("headerfont","serif 16"),param_set_font("historyfont","serif 16"),param_set_font("infofont","serifItalic 14"),param_set_font("measurefont","serifItalic 14"),param_set_font("partsfont","serif 15"),param_set_font("repeatfont","serif 13"),param_set_font("subtitlefont","serif 16"),param_set_font("tempofont","serifBold 15"),param_set_font("textfont","serif 16"),param_set_font("titlefont","serif 20"),param_set_font("vocalfont","serifBold 13"),param_set_font("voicefont","serifBold 13"),param_set_font("wordsfont","serif 16")}function style_font(e){var t=e.split("."),r=t[1],n=e.indexOf("Italic"),a=100,i=e.indexOf("Oblique"),s=e.indexOf("Bold");return e=t[0],t="",s>0&&(t+="font-weight:bold; ",a=s),(n>0||i>0)&&(n>0&&(t+="font-style:italic; ",n<a&&(a=n)),i>0&&(t+="font-style:oblique; ",i<a&&(a=i))),100!=a&&("-"==e[a-1]&&a--,e=e.slice(0,a)),"font-family:"+e+"; "+t+"font-size:"+r+"px"}function font_class(e){return e.class?"f"+e.fid+cfmt.fullsvg+" "+e.class:"f"+e.fid+cfmt.fullsvg}function style_add_font(e){font_style+="\n.f"+e.fid+cfmt.fullsvg+" {"+style_font(e.name+"."+e.size)+"}"}function use_font(e){defined_font[e.fid]||(defined_font[e.fid]=!0,style_add_font(e))}function get_font(e){e+="font";var t=cfmt[e],r=font_tb[t];return r||(syntax(1,"Unknown font $1",e),r=gene.curfont),r.fid||(r.fid=fid++),use_font(r),r}function cnv_escape(e){for(var t,r,n,a,i="",s=0;;){if((n=e.indexOf("\\",s))<0)break;if(i+=e.slice(s,n),!(t=e[++n]))return i+"\\";switch(t){case"0":case"2":if("0"!=e[n+1])break;if(r=oct_acc[e[n+2]]){i+=r,s=n+3;continue}break;case"u":if(s=Number("0x"+e.slice(n+1,n+5)),isNaN(s)||s<32){i+=e[++n]+"",s=n+1;continue}if(a=[s],s>=55296&&s<=57343){if(s=Number("0x"+e.slice(n+7,n+11)),isNaN(s))break;a.push(s),s=n+11}else s=n+5;i+=String.fromCharCode.apply(null,a);continue;case"t":i+=" ",s=n+1;continue;default:if(r=abc_utf[e.slice(n,n+2)]){i+=r,s=n+2;continue}switch(t){case"`":i+=e[++n]+"",s=n+1;continue;case"'":i+=e[++n]+"",s=n+1;continue;case"^":i+=e[++n]+"",s=n+1;continue;case"~":i+=e[++n]+"",s=n+1;continue;case"=":i+=e[++n]+"",s=n+1;continue;case"_":i+=e[++n]+"",s=n+1;continue;case".":i+=e[++n]+"",s=n+1;continue;case'"':i+=e[++n]+"",s=n+1;continue;case"o":i+=e[++n]+"",s=n+1;continue;case"H":i+=e[++n]+"",s=n+1;continue;case"v":i+=e[++n]+"",s=n+1;continue;case"c":i+=e[++n]+"",s=n+1;continue;case";":i+=e[++n]+"",s=n+1;continue}}i+="\\"+t,s=n+1}return i+e.slice(s)}function do_include(e){var t,r;return user.read_file?include>2?void syntax(1,"Too many include levels"):(include++,(t=user.read_file(e))?(r=clone(parse),tosvg(e,t),parse=r,void include--):void syntax(1,"Cannot read file '$1'",e)):void syntax(1,"No read_file support")}function tosvg(e,t,r,n){function a(e,t){return e.indexOf("%")>=0&&(e=e.replace(/([^\\])%.*/,"$1").replace(/\\%/g,"%")),e=e.replace(/\s+$/,""),t&&e.indexOf("\\")>=0?cnv_escape(e):e}function i(){generate(),info.W&&put_words(info.W),put_history(),blk_flush(),parse.state=0,cfmt=g,info=v,char_tb=b,glovar=x,maps=w,mac=A,maci=k,init_tune(),img.chg=!0,set_page()}var s,r,o,c,l,u,f,$,p,d,h,_,m,y,g,v,b,x,w,A,k,E,S="\n";for(abc2svg.modules&&(abc2svg.modules.hooks.length||abc2svg.modules.g_hooks.length)&&set_hooks(),parse.file=t,parse.fname=e,void 0==r&&(r=0),n||(n=t.length);r<n;r=parse.eol+1){for(o=t.indexOf("\n",r),(o<0||o>n)&&(o=n),parse.eol=o;;){switch(o--,t[o]){case" ":case"\t":continue}break}if(++o!=r){if(parse.istart=parse.bol=r,parse.iend=o,parse.line.index=0,f=t[r],$=t[r+1],"%"==f){if(parse.prefix.indexOf($)<0)continue;"a"==t[r+2]&&"b"==t[r+3]&&"c"==t[r+4]&&" "==t[r+5]?(r+=6,f=t[r],$=t[r+1]):E=!0}else"I"==f&&":"==$&&(E=!0);if(E){for(E=!1,r+=2;;){switch(t[r]){case" ":case"\t":r++;continue}break}if(!(h=t.slice(r,o))||"%"==h[0])continue;switch(_=h.split(/\s+/,2),_[0]||_.shift(),_[0]){case"abcm2ps":case"ss-pref":parse.prefix=_[1];continue;case"abc-include":l=_[1].match(/.*\.(.*)/),l&&"abc"==l[1]&&do_include(_[1]);continue}if("begin"==_[0].slice(0,5)){if(m=_[0].substr(5),c="\n"+f+$+"end"+m,(s=t.indexOf(c,o))<0){syntax(1,"No $1 after %%$2",c.slice(1),_[0]),parse.eol=n;continue}do_begin_end(m,_[1],t.slice(o+1,s).replace(new RegExp("^"+f+$,"gm"),"")),parse.eol=t.indexOf("\n",s+6),parse.eol<0&&(parse.eol=n);continue}switch(_[0]){case"select":if(0!=parse.state){syntax(1,"%%select ignored");continue}if(u=a(h.slice(7),!1),'"'==u[0]&&(u=u.slice(1,-1)),!u){delete parse.select;continue}u=u.replace(/\(/g,"\\("),u=u.replace(/\)/g,"\\)"),parse.select=new RegExp(u,"m");continue;case"tune":syntax(1,"%%tune not treated yet");continue;case"voice":if(0!=parse.state){syntax(1,"%%voice ignored");continue}if(!(u=a(h.slice(6),!1))){parse.cur_tune_opts?parse.cur_tune_opts.voice_opts=null:parse.voice_opts=null;continue}if("end"==u)continue;for(parse.cur_tune_opts?(parse.cur_tune_opts.voice_opts||(parse.cur_tune_opts.voice_opts={}),d=parse.cur_tune_opts.voice_opts):(parse.voice_opts||(parse.voice_opts={}),d=parse.voice_opts),d[u]=[];;){if(r=++o,"%"!=t[r])break;if(o=t.indexOf("\n",o),t[r+1]==$){switch(r+=2,h=o<0?t.slice(r):t.slice(r,o),_=h.match(/\S+/),_[0]){default:d[u].push(a(h,!0));continue;case"score":case"staves":case"tune":case"voice":r-=2}break}}parse.eol=r-1;continue}do_pscom(a(h,!0))}else if(":"==$&&/[A-Za-z+]/.test(f)){for(r+=2;;){switch(t[r]){case" ":case"\t":r++;continue}break}if(h=a(t.slice(r,o),!0),"+"==f){if(!p){syntax(1,"+: without previous info field");continue}S=" ",f=p}switch(f){case"X":if(0!=parse.state){syntax(1,errs.ignored,f);continue}if(parse.select&&!function(){var e,a,i=t.indexOf("K:",r);return!(i<0)&&(i=t.indexOf("\n",i),!!parse.select.test(t.slice(parse.bol,i))||(e=/\n\w*\n/,e.lastIndex=i,a=e.exec(t),o=a?e.lastIndex:n,!1))}()){o=t.indexOf("\nX:",parse.eol),o<0&&(o=n),parse.eol=o;continue}g=clone(cfmt),cfmt.pos=clone(cfmt.pos),v=clone(info,1),b=clone(char_tb),x=clone(glovar),w=clone(maps,1),A=clone(mac),k=new Int8Array(maci),info.X=h,parse.state=1;continue;case"T":switch(parse.state){case 0:continue;case 1:void 0==info.T?info.T=h:info.T+="\n"+h;continue}y=new_block("title"),y.text=h;continue;case"K":switch(parse.state){case 0:continue;case 1:info.K=h}do_info(f,h);continue;case"W":if(0==parse.state||cfmt.writefields.indexOf(f)<0)break;void 0==info.W?info.W=h:info.W+=S+h;break;case"m":if(parse.state>=2){syntax(1,errs.ignored,f);continue}if((!cfmt.sound||"play"!=cfmt.sound)&&cfmt.writefields.indexOf(f)<0)break;if(!(_=h.match(/(.*?)[= ]+(.*)/))||!_[2]){syntax(1,errs.bad_val,"m:");continue}mac[_[1]]=_[2],maci[_[1].charCodeAt(0)]=1;break;case"s":if(3!=parse.state||cfmt.writefields.indexOf(f)<0)break;get_sym(h," "==S);break;case"w":if(3!=parse.state||cfmt.writefields.indexOf(f)<0)break;if(get_lyrics(h," "==S),"\\"==h.slice(-1)){S=" ",p=f;continue}break;case"|":if(parse.state<2)continue;parse.line.buffer=a(t.slice(r,o),!0),parse_music_line();continue;default:if("ABCDFGHOSZ".indexOf(f)>=0){if(parse.state>=2){syntax(1,errs.ignored,f);continue}info[f]?info[f]+=S+h:info[f]=h;break}do_info(f,h);continue}S="\n",p=f}else{if(p=void 0,parse.state<2)continue;parse.line.buffer=a(t.slice(r,o),!0),parse_music_line()}}else 1==parse.state?(parse.istart=r,syntax(1,"Empty line in tune header - ignored")):parse.state>=2&&(i(),parse.select&&(o=t.indexOf("\nX:",parse.eol),o<0&&(o=n),parse.eol=o))}include||(parse.state>=2&&i(),parse.state=0)}function set_head_shift(e){var t,r,n,a,i,s,o=dx_tb[e.head],c=e.stem,l=e.nhd;if(0!=l){s=.78*o,e.grace&&(s*=.5),c>=0?(r=1,n=l+1,i=e.notes[0].pit):(s=-s,r=l-1,n=-1,i=e.notes[l].pit);var u=!1,f=0;for(t=r;t!=n;t+=c){if(a=e.notes[t].pit-i,i=e.notes[t].pit,0==a){if(u){var $=e.notes[t].shhd=e.notes[t-c].shhd+s;f<$&&(f=$);continue}if(t+c!=n&&i+c==e.notes[t+c].pit){e.notes[t].shhd=-s,f<-s&&(f=-s);continue}}a<0&&(a=-a),a>3||a>=2&&e.head!=C.SQUARE?u=!1:(u=!u)&&(e.notes[t].shhd=s,f<s&&(f=s))}e.xmx=f}}function acc_shift(e,t){var r,n,a,i,s,o,c,l=e.length;for(r=l-1;--r>=0;)if((a=e[r].shhd)&&!(a>0))for(a=t-a,s=e[r].pit,n=l;--n>=0;)if(e[n].acc){if((o=e[n].pit)<s-3)break;o>s+3||e[n].shac<a&&(e[n].shac=a)}for(r=l;--r>=0;)if(c=e[r].acc){for(a=e[r].shac,a||(a=e[r].shhd,a=a<0?t-a:t),s=e[r].pit,n=l;--n>r;)e[n].acc&&((o=e[n].pit)>=s+4&&(o>s+4||c<0||e[n].acc<0)||a>e[n].shac-6&&(i=e[n].shac+7)>a&&(a=i));e[r].shac=a}}function set_acc_shft(){var e,t,r,n,a,r,i,s;for(e=tsfirst;e;)if(e.type!=C.NOTE||e.invis)e=e.ts_next;else{for(r=e.st,i=e.time,a=!1,t=e;t&&(t.time==i&&t.type==C.NOTE&&t.st==r);t=t.ts_next)if(!a)for(n=0;n<=t.nhd;n++)if(t.notes[n].acc){a=!0;break}if(a){for(s=dx_tb[e.head],r={notes:[]};e!=t;e=e.ts_next)r.notes=r.notes.concat(e.notes);sort_pitch(r),acc_shift(r.notes,s)}else e=t}}function lkvsym(e,t){e.next=t,e.prev=t.prev,e.prev?e.prev.next=e:e.p_v.sym=e,t.prev=e}function lktsym(e,t){t?(e.ts_next=t,e.ts_prev=t.ts_prev,e.ts_prev&&(e.ts_prev.ts_next=e),t.ts_prev=e):e.ts_next=e.ts_prev=null}function unlksym(e){e.next&&(e.next.prev=e.prev),e.prev?e.prev.next=e.next:e.p_v.sym=e.next,e.ts_next&&(e.seqst&&!e.ts_next.seqst&&(e.ts_next.seqst=!0,e.ts_next.shrink=e.shrink,e.ts_next.space=e.space),e.ts_next.ts_prev=e.ts_prev),e.ts_prev&&(e.ts_prev.ts_next=e.ts_next),tsfirst==e&&(tsfirst=e.ts_next),tsnext==e&&(tsnext=e.ts_next)}function insert_clef(e,t,r){var n,a=e.p_v,i=e.st;for(e.type==C.BAR&&e.prev&&e.prev.type==C.BAR&&(e=e.prev),a.last_sym=e.prev,a.last_sym||(a.sym=null),a.time=e.time,n=sym_add(a,C.CLEF),n.next=e,e.prev=n,n.clef_type=t,n.clef_line=r,n.st=i,n.clef_small=!0,delete n.second,n.notes=[],n.notes[0]={pit:e.notes[0].pit},n.nhd=0;!e.seqst;)e=e.ts_prev;return lktsym(n,e),n.ts_prev.type!=C.CLEF&&(n.seqst=!0),n}function set_float(){var e,t,r,n,a,i,s,o;for(n=0;n<voice_tb.length;n++)for(e=voice_tb[n],r=!1,t=e.st,a=e.sym;a;a=a.next){if(!a.floating){for(;a&&!a.floating;)a=a.next;if(!a)break;r=!1}if(a.dur)if(a.notes[0].pit>=19)r=!1;else if(a.notes[a.nhd].pit<=12)r=!0,a.st++;else{for(s=127,i=a.ts_prev;i&&(i.st==t&&i.v!=a.v);i=i.ts_prev)i.type==C.NOTE&&i.notes[0].pit<s&&(s=i.notes[0].pit);if(127!=s)if(a.notes[a.nhd].pit>s-3)r=!1;else{for(o=-127,i=a.ts_next;i&&(i.st==t+1&&i.v!=a.v);i=i.ts_next)i.type==C.NOTE&&i.notes[i.nhd].pit>o&&(o=i.notes[i.nhd].pit);if(-127!=o)if(a.notes[0].pit<o+3)r=!0,a.st++;else{if(s-=a.notes[a.nhd].pit,o=a.notes[0].pit-o,r){if(s<o-3){r=!1;continue}}else{if(s<o+3)continue;r=!0}a.st++}else r&&a.st++}else r&&a.st++}else r&&a.st++}}function set_graceoffs(e){var t,r,n,a,i=cfmt.gracespace[0],s=cfmt.gracespace[1],o=cfmt.gracespace[2],c=e.extra;for(e.prev&&e.prev.type==C.BAR&&(i-=3),a=i,c.beam_st=!0;;c=c.next){for(set_head_shift(c),acc_shift(c.notes,7),n=0,r=c.nhd;r>=0;r--)c.notes[r].shac>n&&(n=c.notes[r].shac);if(a+=n,c.x=a,c.nflags<=0&&(c.beam_st=!0,c.beam_end=!0),!(t=c.next)){c.beam_end=!0;break}t.nflags<=0&&(c.beam_end=!0),c.beam_end&&(t.beam_st=!0,a+=s/4),c.nflags<=0&&(a+=s/4),c.y>t.y+8&&(a-=1.5),a+=s}return t=e.next,t&&t.type==C.NOTE&&(c.y>=3*(t.notes[t.nhd].pit-18)?o-=1:c.beam_st&&c.y<3*(t.notes[t.nhd].pit-18)-4&&(o+=2)),a+=o}function gchord_width(e,t,r){var n,a,i,s,o,c=0,l=0,u=0,f=0;for(o=0;o<e.a_gch.length;o++)switch(a=e.a_gch[o],a.type){default:s=-a.x,s>c&&(c=s),i=a.w+2-s,i>l&&(l=i);break;case"<":i=a.w+t,i>u&&(u=i);break;case">":i=a.w+e.wr,i>f&&(f=i)}if(n=e.prev){if(n.a_gch)for(n=e.ts_prev;;n=n.ts_prev){if(n==e.prev){r<c&&(r=c);break}n.seqst&&(c-=n.shrink)}0!=u&&r<u&&(r=u)}if(n=e.next){if(n.a_gch)for(n=e.ts_next;;n=n.ts_next){if(n==e.next){e.wr<l&&(e.wr=l);break}n.seqst&&(l-=8)}0!=f&&e.wr<f&&(e.wr=u)}return r}function set_width(e){var t,r,n,a,i,s,o,c;switch(e.type){case C.NOTE:case C.REST:for(e.wr=s=hw_tb[e.head],e.xmx>0&&(e.wr+=e.xmx+4),t=e.prev;t&&0==w_tb[t.type];t=t.prev);if(t)switch(t.type){case C.BAR:case C.CLEF:case C.KEY:case C.METER:s+=3}for(n=0;n<=e.nhd;n++)if(a=e.notes[n].shhd,a<0&&s<5-a&&(s=5-a),e.notes[n].acc){var l=e.notes[n].shac+(e.notes[n].micro?5.5:3.5);s<l&&(s=l)}if(t)switch(t.type){case C.BAR:case C.CLEF:case C.KEY:case C.METER:s-=3}if(e.a_dd&&(s+=deco_width(e)),e.beam_st&&e.beam_end&&e.stem>0&&e.nflags>0&&e.wr<e.xmx+9&&(e.wr=e.xmx+9),e.dots>0){if(void 0==e.wl)switch(e.head){case C.SQUARE:e.xmx+=4;break;case C.OVALBARS:case C.OVAL:e.xmx+=2;break;case C.EMPTY:e.xmx+=1}e.wr<e.xmx+8&&(e.wr=e.xmx+8),e.dots>=2&&(e.wr+=3.5*(e.dots-1))}if(e.trem2&&e.beam_end&&s<20&&(s=20),o=s,t)switch(t.type){case C.NOTE:t.stem>0&&e.stem<0&&o<7&&(o=7),(e.y>27&&t.y>27||e.y<-3&&t.y<-3)&&o<6&&(o=6),t.ti1&&o<14&&(o=14);break;case C.CLEF:if(t.second||t.clef_small)break;o+=8;break;case C.KEY:o+=4}return e.a_gch&&(o=gchord_width(e,s,o)),e.a_ly&&(o=ly_width(e,o)),void(t&&t.type==C.GRACE?e.wl=s-4.5:e.wl=o);case C.SPACE:return a=e.width/2,e.wr=a,e.a_gch&&(a=gchord_width(e,a,a)),e.a_dd&&(a+=deco_width(e)),void(e.wl=a);case C.BAR:if(e.norepbra)break;if(e.invis)e.wl=e.wr=0;else{var u=e.bar_type;switch(u){case"|":i=7;break;case"|:":case":|":i=15;break;case"::":i=26;break;default:if(!u)break;for(i=4+3*u.length,r=0;r<u.length;r++)switch(u[r]){case"[":case"]":i+=3;break;case":":i+=2}}for(e.wl=i,e.next&&e.next.type!=C.METER?e.wr=7:e.wr=5,t=e.prev;t;t=t.prev)if(0!=w_tb[t.type]){t.type==C.GRACE&&(e.wl-=8);break}}return e.a_dd&&(e.wl+=deco_width(e)),void(e.text&&e.text.length<4&&e.next&&e.next.a_gch&&(set_font("repeat"),e.wr+=strwh(e.text)[0]+2));case C.CLEF:
return e.invis?void(e.wl=e.wr=1):void(e.wl=e.wr=e.clef_small?8:12);case C.KEY:var f,$,p;if(e.wl=3,p=4,e.k_a_acc){if(f=$=e.k_a_acc.length,$)var d=e.k_a_acc[0].acc;for(r=1;r<$;r++)c=e.k_a_acc[r],c.pit>e.k_a_acc[r-1].pit+6||c.pit<e.k_a_acc[r-1].pit-6?f--:c.acc!=d&&(p+=3),d=c.acc}else f=e.k_sf,$=e.k_old_sf&&(cfmt.cancelkey||0==f)?e.k_old_sf:0,f*$>=0?(f<0&&(f=-f),$<0&&($=-$),$>f&&(f=$)):(f-=$,f<0&&(f=-f),p+=3);return void(e.wr=5.5*f+p);case C.METER:for(o=0,e.x_meter=[],r=0;r<e.a_meter.length;r++){var h=e.a_meter[r];if("C"==h.top[0])e.x_meter[r]=o+6,o+=12;else{for(i=0,h=!h.bot||h.top.length>h.bot.length?h.top:h.bot,n=0;n<h.length;n++)switch(h[n]){case"(":o+=4;case")":case"1":i+=4;break;default:i+=12}e.x_meter[r]=o+i/2,o+=i}}return e.wl=0,void(e.wr=o+6);case C.MREST:return e.wl=6,void(e.wr=66);case C.GRACE:return e.wl=set_graceoffs(e),e.wr=0,void(e.a_ly&&ly_width(e,o));case C.STBRK:return e.wl=e.xmx,void(e.next&&e.next.type==C.CLEF?(e.wr=2,delete e.next.clef_small):e.wr=8);case C.CUSTOS:return void(e.wl=e.wr=4);case C.BLOCK:case C.PART:case C.REMARK:case C.STAVES:case C.TEMPO:break;default:error(2,e,"set_width - Cannot set width for symbol $1",e.type)}e.wl=e.wr=0}function time2space(e,t){var r,n,a;return smallest_duration>=C.BLEN/2?smallest_duration>=C.BLEN?t/=4:t/=2:!e.next&&t>=C.BLEN&&(t/=2),r=t>=C.BLEN/4?t<C.BLEN/2?5:t<C.BLEN?6:t<2*C.BLEN?7:t<4*C.BLEN?8:9:t>=C.BLEN/8?4:t>=C.BLEN/16?3:t>=C.BLEN/32?2:t>=C.BLEN/64?1:0,n=t-(C.BLEN/16/8<<r),a=space_tb[r],0!=n&&(n<0?a=space_tb[0]*t/(C.BLEN/16/8):(r>=9&&(r=8),a+=(space_tb[r+1]-space_tb[r])*n/t)),a}function set_space(e){var t,r,n=e.ts_prev.time,a=e.time-n;if(0==a){switch(e.type){case C.MREST:return e.wl}return 0}if(e.ts_prev.type==C.MREST)return 71;for(r=time2space(e,a);!e.dur;){switch(e.type){case C.BAR:return.9*r-7;case C.CLEF:return r-e.wl-e.wr;case C.BLOCK:case C.PART:case C.REMARK:case C.STAVES:case C.TEMPO:if(!(e=e.ts_next))return r;continue}break}if(e.beam_st||(r*=.9),e.type==C.NOTE&&e.nflags>=-1&&e.stem>0){var i=!0;for(t=e.ts_prev;t&&t.time==n;t=t.ts_prev)if(t.type==C.NOTE&&(t.nflags<-1||t.stem>0)){i=!1;break}if(i){for(t=e.ts_next;t&&t.time==e.time;t=t.ts_next)if(t.type==C.NOTE&&(t.nflags<-1||t.stem<0)){i=!1;break}i&&(r*=.9)}}return r}function set_sp_tup(e,t){var r=e.time,n=t.time-r,a=time2space(e,n/e.tq0)*e.tq0;for(e=e.ts_next;;){if(e.seqst&&(e.space=(e.time-r)/n*a),r=e.time,e==t)break;e=e.ts_next}}function add_end_bar(e){return{type:C.BAR,bar_type:"|",fname:e.fname,istart:e.istart,iend:e.iend,v:e.v,p_v:e.p_v,st:e.st,dur:0,seqst:!0,invis:!0,time:e.time+e.dur,nhd:0,notes:[{pit:e.notes[0].pit}],wl:0,wr:0}}function set_allsymwidth(e){for(var t,r,n,a=tsfirst,i=0,s=[],o=0,c=0;;){var l=i,u=a;do{set_width(a),t=(s[a.st]||0)+a.wl,t>l&&(l=t),a.tp0?1==++c&&(n=a,o|=1):a.te0&&0==--c&&(o=4),a=a.ts_next}while(a!=e&&!a.seqst);if(u.shrink=l-i,14&o||(u.ts_prev?u.space=set_space(u):u.space=0),o&&(8&o&&(set_sp_tup(r,u),o&=-9),1&o&&(r=n,o++),4&o&&(o+=4)),0==u.shrink&&0==u.space&&u.type==C.CLEF&&(delete u.seqst,u.time=u.ts_prev.time),a==e)break;i=l,a=u;do{(!s[a.st]||s[a.st]<i+a.wr)&&(s[a.st]=i+a.wr),a=a.ts_next}while(!a.seqst)}}function to_rest(e){e.type=C.REST,delete e.in_tuplet,delete e.sl1,delete e.sl2,delete e.a_dd,delete e.a_gch,e.slur_start=e.slur_end=0}function set_repeat(e){var t,r,n,a,i,s=e.repeat_n,o=e.repeat_k,c=e.st,l=e.v;if(e.repeat_n=0,s<0){for(s=-s,n=s,r=e.prev;r;r=r.prev)if(r.dur){if(--n<=0)break}else if(r.type==C.BAR)return void error(1,r,"Bar in repeat sequence");if(!r)return void error(1,e,errs.not_enough_n);for(i=e.time-r.time,n=o*s,t=e;t;t=t.next)if(t.dur){if(--n<=0)break}else if(t.type==C.BAR)return void error(1,t,"Bar in repeat sequence");if(!t||!t.next)return void error(1,e,errs.not_enough_n);for(t=e.prev;t!=r;t=t.prev)if(t.type==C.NOTE){t.beam_end=!0;break}for(a=o;--a>=0;){for(n=s,e.dur&&n--,t=e.ts_next;n>0;)t.st==c&&(unlksym(t),t.v==l&&t.dur&&n--),t=t.ts_next;for(to_rest(e),e.dur=e.notes[0].dur=i,e.rep_nb=-1,e.beam_st=!0,set_width(e),e.seqst&&(e.space=set_space(e)),e.head=C.SQUARE,e=t;e&&(e.st!=c||e.v!=l||!e.dur);e=e.ts_next);}}else{for(n=s,t=e.prev.prev;t&&(t.type!=C.BAR&&t.time!=tsfirst.time||!(--n<=0));t=t.prev);if(!t)return void error(1,e,errs.not_enough_m);for(i=e.time-t.time,n=1==s?o:s,t=e;t&&!(t.type==C.BAR&&--n<=0);t=t.next);if(!t)return void error(1,e,errs.not_enough_m);if(n=o,2==s&&n>1){if(!(t=t.next))return void error(1,e,errs.not_enough_m);t.repeat_n=s,t.repeat_k=--n}if(i/=s,2==s){for(r=e,t=e.ts_next;;t=t.ts_next)if(t.st==c){if(t.v==l&&t.type==C.BAR)break;unlksym(t)}for(to_rest(r),r.dur=r.notes[0].dur=i,r.invis=!0,r.seqst&&(r.space=set_space(r)),t.bar_mrep=2,t.seqst&&(t.space=set_space(t)),r=t.next,t=r.ts_next;;t=t.ts_next)if(t.st==c){if(t.v==l&&t.type==C.BAR)break;unlksym(t)}return to_rest(r),r.dur=r.notes[0].dur=i,r.invis=!0,set_width(r),r.seqst&&(r.space=set_space(r)),void(t.seqst&&(t.space=set_space(t)))}for(r=e,a=o;--a>=0;){for(t=r.ts_next;;t=t.ts_next)if(t.st==c){if(t.v==l&&t.type==C.BAR)break;unlksym(t)}if(to_rest(r),r.dur=r.notes[0].dur=i,r.beam_st=!0,r.seqst&&(r.space=set_space(r)),t.seqst&&(t.space=set_space(t)),1==o){r.rep_nb=1;break}r.rep_nb=o-a+1,r=t.next}}}function custos_add(e){for(var t,r,n,a=e;;){if(a.type==C.NOTE)break;if(!(a=a.next))return}for(t=e.p_v,t.last_sym=e.prev,t.time=e.time,r=sym_add(t,C.CUSTOS),r.next=e,e.prev=r,lktsym(r,e),r.seqst=!0,r.shrink=e.shrink,r.shrink<12&&(r.shrink=12),r.space=a.space,r.wl=0,r.wr=4,r.nhd=a.nhd,r.notes=[],n=0;n<e.notes.length;n++)r.notes[n]={pit:a.notes[n].pit,shhd:0,dur:C.BLEN/4};r.stemless=!0}function set_nl(e){function t(e){cfmt.custos&&1==voice_tb.length&&custos_add(e);for(var t=e.ts_next;t;t=t.ts_next)if(t.seqst){e.nl=!0;break}}function r(e){if(!e.next)return t(e),e;for(e=e.ts_next;e;e=e.ts_next)if(e.seqst){t(e);break}return e}var n;if(e.eoln&&!cfmt.keywarn&&!cfmt.timewarn)return r(e);switch(e.type){case C.CLEF:case C.BAR:case C.STAVES:break;case C.KEY:if(cfmt.keywarn&&!e.k_none)break;return r(e);case C.METER:if(cfmt.timewarn)break;return r(e);case C.GRACE:if(!(e=e.next))return e;default:return r(e)}for(;e;e=e.ts_prev)if(e.seqst){switch(e.type){case C.KEY:case C.CLEF:case C.METER:continue}break}for(n=0;;e=e.ts_next){if(!e)return e;if(e.seqst){if(n<0)break;switch(e.type){case C.STAVES:if(e.ts_prev&&e.ts_prev.type==C.BAR)break;for(;e.ts_next&&(0==w_tb[e.ts_next.type]||e.ts_next.type==C.CLEF);)e=e.ts_next;if(!e.ts_next||e.ts_next.type!=C.BAR)continue;e=e.ts_next;case C.BAR:if(n)break;n=1;continue;case C.STBRK:e.stbrk_forced?n=-1:unlksym(e);continue;case C.METER:if(!cfmt.timewarn)break;continue;case C.CLEF:if(n)break;continue;case C.KEY:if(!cfmt.keywarn||e.k_none)break;continue;default:if(!n||e.prev&&e.prev.type==C.GRACE)continue}break}}return t(e),e}function get_ck_width(){var e=voice_tb[0];return set_width(e.clef),set_width(e.key),set_width(e.meter),[e.clef.wl+e.clef.wr+e.key.wl+e.key.wr,e.meter.wl+e.meter.wr]}function get_width(e,t){var r,n,a=0,i=1-cfmt.maxshrink;do{if(e.seqst&&(r=e.shrink,(n=e.space)<r?a+=r:a+=r*cfmt.maxshrink+n*i,e.x=a),e==t)break;e=e.ts_next}while(e);return a}function set_lines(e,t,r,n){for(var a,i,s,o,c,l,u,f,$,p;t&&!t.eoln;t=t.ts_next);for(f=get_width(e,t)+n;;){if(($=Math.ceil(f/r))<=1)return t&&(t=set_nl(t)),t;for(i=a=e,c=e.x-e.shrink-n,u=c+r,l=c+f/$,c+=f/$*cfmt.breaklimit,e=e.ts_next;e!=t&&!(e.x&&(e.type==C.BAR&&(i=e),e.x>=c));e=e.ts_next);if(e==t)return t&&(t=set_nl(t)),t;for(p=!1,s=null;e!=t;e=e.ts_next)if(o=e.x){if(o>u)break;if(e.type==C.BAR)if(o<l)s=e;else{if(s&&!(e.x<l)){if(s>l)break;if(l-s.x<e.x-l)break;s=e;break}s=e}}if(s&&(e=s,p=!0),!p){var d=0,h=i.time;for(u-=8,e=i,s=null;e!=t;e=e.ts_next)if(e.beam_st&&d++,e.beam_end&&d>0&&d--,o=e.x){if(o+e.wr>=u)break;if(!d&&!e.in_tuplet)if((e.time-h)%(C.BLEN/4)!=0){if(s&&!(e.x<l)){if(s>l)break;if(l-s.x<e.x-l)break;s=e;break}s=e}else s=e}s&&(e=s,p=!0)}if(!p){for(s=e=i;e!=t;e=e.ts_next)if(o=e.x){if(!(e.x<l)){if(s>l)break;if(l-s.x<e.x-l)break;s=e;break}s=e}e=s}if(e.nl)for(error(0,e,"Line split problem - adjust maxshrink and/or breaklimit"),$=2,e=e.ts_next;e!=t&&!(e.x&&--$<=0);e=e.ts_next);if(!(e=set_nl(e))||t&&e.time>=t.time)break;f-=e.x-a.x,n=0}return e}function cut_tune(e,t){var r,n,a,i,s,r=tsfirst;if(0!=t&&(i=set_indent(),e-=i,t-=i),i=get_ck_width(),e-=i[0],t+=i[1],cfmt.custos&&1==voice_tb.length&&(e-=12),cfmt.barsperstaff)for(i=cfmt.barsperstaff,n=r;n;n=n.ts_next)n.type!=C.BAR||!n.bar_num||--i>0||(n.eoln=!0,i=cfmt.barsperstaff);for(s=t,n=r;r;r=r.ts_next)if(r.seqst||r.eoln){if((s+=r.shrink)>e)n=set_lines(n,r,e,t);else{if(!r.eoln)continue;if(delete r.eoln,r.dur){for(a=r.ts_next;a&&!(a.seqst||a.dur<r.dur);a=a.ts_next);n=a&&!a.seqst?set_lines(n,r,e,t):set_nl(r)}else n=set_nl(r)}if(!n)break;n.ts_prev?(s=n.shrink,r=n.ts_prev,t=0):delete n.nl}}function set_yval(e){switch(e.type){case C.CLEF:if(e.second||e.invis){e.ymx=e.ymn=12;break}switch(e.y=6*(e.clef_line-1),e.clef_type){default:e.ymx=e.y+28,e.ymn=e.y-14;break;case"c":e.ymx=e.y+13,e.ymn=e.y-11;break;case"b":e.ymx=e.y+7,e.ymn=e.y-12}e.clef_small&&(e.ymx-=2,e.ymn+=2),e.ymx<26&&(e.ymx=26),e.ymn>-1&&(e.ymn=-1),e.clef_octave&&(e.clef_octave>0?e.ymx+=12:e.ymn-=12);break;case C.KEY:e.k_sf>2?e.ymx=34:e.k_sf>0?e.ymx=30:e.ymx=26,e.ymn=-2;break;default:e.ymx=26,e.ymn=-2}}function set_auto_clef(e,t,r){var n,a,i,s,o,c;for(i=12,a=20,n=t;n&&(n.type!=C.STAVES||n==t);n=n.ts_next)if(n.st==e)if(n.type==C.NOTE)n.notes[0].pit<a?a=n.notes[0].pit:n.notes[n.nhd].pit>i&&(i=n.notes[n.nhd].pit);else if(n.type==C.CLEF){if("a"!=n.clef_type)break;unlksym(n)}if(a>=19||a>=13&&"b"!=r)return"t";if(i<=13||i<=19&&"t"!=r)return"b";"a"==r&&(r=(i+a)/2>=16?"t":"b");var l=r,u=n,f=null;for(n=t;n!=u&&(n.type!=C.STAVES||n==t);n=n.ts_next)if(n.st==e&&n.type==C.NOTE){if(s=n.time,"t"==l){if(n.notes[0].pit>12||n.notes[n.nhd].pit>20){n.notes[0].pit>20&&(f=n);continue}if((o=n.ts_prev)&&o.time==s&&o.st==e&&o.type==C.NOTE&&o.notes[0].pit>=19)continue;if((o=n.ts_next)&&o.st==e&&o.time==s&&o.type==C.NOTE&&o.notes[0].pit>=19)continue}else{if(n.notes[0].pit<12||n.notes[n.nhd].pit<20){n.notes[n.nhd].pit<12&&(f=n);continue}if((o=n.ts_prev)&&o.time==s&&o.st==e&&o.type==C.NOTE&&o.notes[0].pit<=13)continue;if((o=n.ts_next)&&o.st==e&&o.time==s&&o.type==C.NOTE&&o.notes[0].pit<=13)continue}if(f){for(c=n,o=n.ts_prev;o!=f;o=o.ts_prev)if(o.st==e){if(o.type==C.BAR&&o.v==n.v){c=o;break}o.type==C.NOTE&&o.beam_st&&!o.p_v.second&&(c=o)}c.time!=f.time?(f=n,l="t"==l?"b":"t",o=insert_clef(c,l,"t"==l?2:4),o.clef_auto=!0):f=n}else l=r="t"==l?"b":"t",f=n}return r}function set_clefs(){var e,t,r,n,a,i,s,o,c,l=new Array(nstaff),u=cur_sy,f=[];for(staff_tb=new Array(nstaff),r=0;r<=nstaff;r++)l[r]={autoclef:!0},staff_tb[r]={output:"",sc_out:""};for(n=0;n<voice_tb.length;n++)a=voice_tb[n],u.voices[n].range<0||(r=u.voices[n].st,u.voices[n].second||(void 0!=a.staffnonote&&(u.staves[r].staffnonote=a.staffnonote),a.staffscale&&(u.staves[r].staffscale=a.staffscale),u.voices[n].sep&&(u.staves[r].sep=u.voices[n].sep),u.voices[n].maxsep&&(u.staves[r].maxsep=u.voices[n].maxsep)),u.voices[n].second||a.clef.clef_auto||(l[r].autoclef=!1));for(n=0;n<voice_tb.length;n++)a=voice_tb[n],u.voices[n].range<0||u.voices[n].second||(r=u.voices[n].st,e=a.clef,l[r].autoclef&&(e.clef_type=set_auto_clef(r,tsfirst,e.clef_type),e.clef_line="t"==e.clef_type?2:4),l[r].clef=staff_tb[r].clef=e);for(r=0;r<=u.nstaff;r++)f[r]=3*(u.staves[r].stafflines.length-1);for(e=tsfirst;e;e=e.ts_next){switch(e.repeat_n&&set_repeat(e),e.type){case C.STAVES:for(u=e.sy,r=0;r<=nstaff;r++)l[r].autoclef=!0;for(n=0;n<voice_tb.length;n++)u.voices[n].range<0||(a=voice_tb[n],r=u.voices[n].st,u.voices[n].second||(void 0!=a.staffnonote&&(u.staves[r].staffnonote=a.staffnonote),a.staffscale&&(u.staves[r].staffscale=a.staffscale),u.voices[n].sep&&(u.staves[r].sep=u.voices[n].sep),u.voices[n].maxsep&&(u.staves[r].maxsep=u.voices[n].maxsep)),t=a.clef,t.clef_auto||(l[r].autoclef=!1));for(r=0;r<=u.nstaff;r++)f[r]=3*(u.staves[r].stafflines.length-1);for(n=0;n<voice_tb.length;n++)if(!(u.voices[n].range<0||u.voices[n].second))if(a=voice_tb[n],r=u.voices[n].st,t=a.clef,t.clef_auto?(s=set_auto_clef(r,e,l[r].clef?l[r].clef.clef_type:"a"),o="t"==s?2:4):(s=t.clef_type,o=t.clef_line),l[r].clef){if(s!=l[r].clef.clef_type||o!=l[r].clef.clef_line){for(i=e.ts_next;i&&(i.v!=n||i.st!=r);)i=i.ts_next;i&&(i.type!=C.CLEF&&(i=insert_clef(i,s,o),t.clef_auto&&(i.clef_auto=!0)),l[r].clef=a.clef=i)}}else t.clef_auto&&("a"!=t.type&&(a.clef=clone(a.clef)),a.clef.clef_type=s,a.clef.clef_line=o),staff_tb[r].clef=l[r].clef=a.clef;continue;default:e.mid=f[e.st];continue;case C.CLEF:}if("a"==e.clef_type&&(e.clef_type=set_auto_clef(e.st,e.ts_next,l[e.st].clef.clef_type),e.clef_line="t"==e.clef_type?2:4),a=e.p_v,a.clef=e,e.second)unlksym(e);else{if(r=e.st,l[r].clef){if(e.clef_type==l[r].clef.clef_type&&e.clef_line==l[r].clef.clef_line)continue}else staff_tb[r].clef=e;l[r].clef=e}}for(u=cur_sy,n=0;n<voice_tb.length;n++)if(!(u.voices[n].range<0)&&(t=voice_tb[n].sym)&&127==t.notes[0].pit){switch(r=u.voices[n].st,staff_tb[r].clef.clef_type){default:c=22;break;case"c":c=16;break;case"b":c=10}for(e=t;e;e=e.next)e.notes[0].pit=c}}function set_pitch(e){var t,r,n,a,i,s,o=C.BLEN,c=new Array(nstaff);for(n=0;n<=nstaff;n++)t=staff_tb[n].clef,c[n]=delta_tb[t.clef_type]+2*t.clef_line,t.clefpit&&(c[n]+=t.clefpit),cfmt.sound?t.clef_octave&&!t.clef_oct_transp&&(c[n]+=t.clef_octave):t.clef_oct_transp&&(c[n]-=t.clef_octave);for(t=tsfirst;t!=e;t=t.ts_next)switch(n=t.st,t.type){case C.CLEF:c[n]=delta_tb[t.clef_type]+2*t.clef_line,t.clefpit&&(c[n]+=t.clefpit),cfmt.sound?t.clef_octave&&!t.clef_oct_transp&&(c[n]+=t.clef_octave):t.clef_oct_transp&&(c[n]-=t.clef_octave),set_yval(t);break;case C.GRACE:for(r=t.extra;r;r=r.next){if(0!=(a=c[r.st])&&!t.p_v.key.k_drum)for(i=0;i<=r.nhd;i++)s=r.notes[i],s.pit+=a;r.ymn=3*(r.notes[0].pit-18)-2,r.ymx=3*(r.notes[r.nhd].pit-18)+2}set_yval(t);break;case C.KEY:t.k_y_clef=c[n];default:set_yval(t);break;case C.MREST:if(t.invis)break;t.y=12,t.ymx=39,t.ymn=-2;break;case C.REST:if(1==voice_tb.length){t.y=12,t.ymx=24,t.ymn=0;break}case C.NOTE:if(0!=(a=c[n])&&!t.p_v.key.k_drum)for(i=t.nhd;i>=0;i--)t.notes[i].pit+=a;t.type==C.NOTE?(t.ymx=3*(t.notes[t.nhd].pit-18)+4,t.ymn=3*(t.notes[0].pit-18)-4):(t.y=6*((t.notes[0].pit-18)/2|0),t.ymx=t.y+rest_sp[5-t.nflags][0],t.ymn=t.y-rest_sp[5-t.nflags][1]),t.dur<o&&(o=t.dur)}e||(smallest_duration=o)}function set_stem_dir(){for(var e,t,r,n,a,i,s,o,c,l,u=[],f=tsfirst,$=cur_sy,p=$.nstaff;f;){for(n=0;n<=p;n++)u[n]=[];for(l=[],t=f;t&&t.type!=C.BAR;t=t.ts_next)if(t.type!=C.STAVES){if(!(t.type!=C.NOTE&&t.type!=C.REST||t.invis)){if((n=t.st)>p){var d="*** fatal set_stem_dir(): bad staff number "+n+" max "+p;throw error(2,null,d),new Error(d)}for(i=t.v,s=l[i],s||(s={st1:-1,st2:-1},l[i]=s),s.st1<0?s.st1=n:s.st1!=n&&(n>s.st1?n>s.st2&&(s.st2=n):(s.st1>s.st2&&(s.st2=s.st1),s.st1=n)),o=u[n],a=$.voices[i].range,r=o.length;--r>=0&&(c=o[r],c.v!=a););if(r<0){for(c={v:a,ymx:0,ymn:24},r=0;r<o.length;r++)if(a<o[r].v){o.splice(r,0,c);break}r==o.length&&o.push(c)}t.type==C.NOTE&&(t.ymx>c.ymx&&(c.ymx=t.ymx),t.ymn<c.ymn&&(c.ymn=t.ymn),t.xstem&&(t.ts_prev.st!=n-1||t.ts_prev.type!=C.NOTE?(error(1,f,"Bad !xstem!"),t.xstem=!1):(t.ts_prev.multi=1,t.multi=1,t.stemless=!0)))}}else{if(t!=f)break;for($=f.sy,n=p;n<=$.nstaff;n++)u[n]=[];p=$.nstaff}for(;f!=t;f=f.ts_next)if(!f.multi){switch(f.type){default:continue;case C.REST:if(void 0!=f.combine&&f.combine<0||!f.ts_next||f.ts_next.type!=C.REST||f.ts_next.st!=f.st||f.time!=f.ts_next.time||f.dur!=f.ts_next.dur||f.invis)break;unlksym(f.ts_next);break;case C.NOTE:case C.GRACE:}if(n=f.st,i=f.v,s=l[i],o=u[n],s&&s.st2>=0)n==s.st1?f.multi=-1:n==s.st2&&(f.multi=1);else if(o.length<=1)f.floating&&(f.multi=n==voice_tb[i].st?-1:1);else{for(a=$.voices[i].range,r=o.length;--r>=0&&o[r].v!=a;);r<0||(r==o.length-1?f.multi=-1:(f.multi=1,0!=r&&r+2==o.length&&(o[r].ymn-cfmt.stemheight>o[r+1].ymx&&(f.multi=-1),e=f.ts_next,f.ts_prev&&f.ts_prev.time==f.time&&f.ts_prev.st==f.st&&f.notes[f.nhd].pit==f.ts_prev.notes[0].pit&&f.beam_st&&f.beam_end&&(!e||e.st!=f.st||e.time!=f.time)&&(f.multi=-1))))}}for(;f&&f.type==C.BAR;)f=f.ts_next}}function set_rest_offset(){var e,t,r,n,a,i,s,o,c,l,u,f=[],$=cur_sy;for(e=tsfirst;e;e=e.ts_next)if(!e.invis&&(e.type==C.STAVES&&($=e.sy),e.dur&&(i=f[e.v],i||(i={},f[e.v]=i),i.s=e,i.st=e.st,i.end_time=e.time+e.dur,e.type==C.REST))){for(o=-127,s=127,a=l=!1,r=0;r<=f.length;r++)(i=f[r])&&i.s&&i.st==e.st&&r!=e.v&&(i.end_time<=e.time||(a=!0,t=i.s,$.voices[r].range<$.voices[e.v].range?t.time==e.time?t.ymn<s&&(s=t.ymn,t.dots&&(l=!0)):t.y<s&&(s=t.y):t.time==e.time?t.ymx>o&&(o=t.ymx,t.dots&&(l=!0)):t.y>o&&(o=t.y)));for(n=e.time+e.dur,t=e.ts_next;t&&!(t.time>=n);t=t.ts_next)t.st==e.st&&t.dur&&!t.invis&&(a=!0,$.voices[t.v].range<$.voices[e.v].range?t.time==e.time?t.ymn<s&&(s=t.ymn,t.dots&&(l=!0)):t.y<s&&(s=t.y):t.time==e.time?t.ymx>o&&(o=t.ymx,t.dots&&(l=!0)):t.y>o&&(o=t.y));if(a)if(127==s&&e.y<12&&(c=12-e.y,e.y+=c,e.ymx+=c,e.ymn+=c),-127==o&&e.y>12&&(c=e.y-12,e.y-=c,e.ymx-=c,e.ymn-=c),(c=s-e.ymx)<0){if(c=6*Math.ceil(-c/6),e.ymn-c>=o){e.y-=c,e.ymx-=c,e.ymn-=c;continue}u=l?15:10,e.notes[0].shhd=u,e.xmx=u}else if((c=o-e.ymn)>0){if(c=6*Math.ceil(c/6),e.ymx+c<=s){e.y+=c,e.ymx+=c,e.ymn+=c;continue}u=l?15:10,e.notes[0].shhd=u,e.xmx=u}else;else e.y=12,e.ymx=24,e.ymn=0}}function new_sym(e,t,r){var n={type:e,fname:r.fname,v:t.v,p_v:t,st:t.st,time:r.time,next:t.last_sym.next};return n.next&&(n.next.prev=n),t.last_sym.next=n,n.prev=t.last_sym,t.last_sym=n,lktsym(n,r),n.ts_prev.type!=e&&(n.seqst=!0),r.type==e&&n.v!=r.v&&(delete r.seqst,r.shrink=0),n}function init_music_line(){var e,t,r,n,a,i,s=voice_tb.length;for(a=0;a<s;a++)if(!(cur_sy.voices[a].range<0)){for(e=voice_tb[a],e.second=cur_sy.voices[a].second,e.last_sym=e.sym,i=cur_sy.voices[a].st;i<nstaff&&!cur_sy.st_print[i];)i++;e.st=i}for(n=tsfirst;n.type==C.CLEF;)a=n.v,cur_sy.voices[a].range>=0&&!cur_sy.voices[a].second&&(delete n.clef_small,e=n.p_v,e.last_sym=e.sym=n),n=n.ts_next;for(a=0;a<s;a++)e=voice_tb[a],e.sym&&e.sym.type==C.CLEF||cur_sy.voices[a].range<0||cur_sy.voices[a].second&&!e.bar_start||(i=cur_sy.voices[a].st,staff_tb[i]&&staff_tb[i].clef&&(t=clone(staff_tb[i].clef),t.v=a,t.p_v=e,t.st=i,t.time=tsfirst.time,t.prev=null,t.next=e.sym,t.next&&(t.next.prev=t),e.sym=t,e.last_sym=t,t.ts_next=n,t.ts_prev=n?n.ts_prev:null,t.ts_prev?(t.ts_prev.ts_next=t,delete t.seqst):(tsfirst=t,t.seqst=!0),n&&(n.ts_prev=t,n.type==C.CLEF&&delete n.seqst),delete t.clef_small,t.second=cur_sy.voices[a].second,cur_sy.st_print[i]||(t.invis=!0)));for(a=0;a<s;a++)cur_sy.voices[a].range<0||cur_sy.voices[a].second||!cur_sy.st_print[cur_sy.voices[a].st]||(e=voice_tb[a],n&&n.v==a&&n.type==C.KEY?(e.last_sym=n,n.k_old_sf=n.k_sf,n=n.ts_next):(r=e.key,(r.k_sf||r.k_a_acc)&&(t=new_sym(C.KEY,e,n),t.k_sf=r.k_sf,t.k_old_sf=r.k_sf,t.k_none=r.k_none,t.k_a_acc=r.k_a_acc,t.istart=r.istart,t.iend=r.iend,r.k_bagpipe&&(t.k_bagpipe=r.k_bagpipe,"p"==t.k_bagpipe&&(t.k_old_sf=3)))));if(1&insert_meter){for(a=0;a<s;a++)e=voice_tb[a],r=e.meter,cur_sy.voices[a].range<0||cur_sy.voices[a].second||!cur_sy.st_print[cur_sy.voices[a].st]||0==r.a_meter.length||(n&&n.v==a&&n.type==C.METER?(e.last_sym=n,n=n.ts_next):(t=new_sym(C.METER,e,n),t.istart=r.istart,t.iend=r.iend,t.wmeasure=r.wmeasure,t.a_meter=r.a_meter));insert_meter&=-2}for(a=0;a<s;a++)e=voice_tb[a],n&&n.v==a&&n.type==C.BAR?(e.last_sym=n,n=n.ts_next):(r=e.bar_start)&&(e.bar_start=null,cur_sy.voices[a].range<0||!cur_sy.st_print[cur_sy.voices[a].st]||(r.next=e.last_sym.next,r.next&&(r.next.prev=r),e.last_sym.next=r,r.prev=e.last_sym,e.last_sym=r,lktsym(r,n),r.time=tsfirst.time,r.ts_prev.type!=r.type&&(r.seqst=!0),n&&n.type==r.type&&r.v!=n.v&&(delete n.seqst,n.shrink=0)));for(set_pitch(n),t=n;t;t=t.ts_next)if(t.seqst){for(t=t.ts_next;t&&!t.seqst;t=t.ts_next);break}set_allsymwidth(t)}function set_words(e){var t,r,n,a,i=!0,s=127;for(t=e.sym;t;t=t.next)if(t.type==C.NOTE){s=t.notes[0].pit;break}for(t=e.sym;t;t=t.next){switch(t.type){case C.MREST:i=!0;break;case C.BAR:t.beam_on||(i=!0),!t.next&&t.prev&&t.prev.head==C.OVALBARS&&(t.prev.head=C.SQUARE);break;case C.NOTE:case C.REST:if(t.trem2)break;n=t.nflags,t.ntrem&&(n+=t.ntrem),t.type==C.REST&&t.beam_end&&(t.beam_end=!1,i=!0),(i||n<=0)&&(a&&(a.beam_end=!0,a=null),n<=0?(t.beam_st=!0,t.beam_end=!0):t.type==C.NOTE&&(t.beam_st=!0,i=!1)),t.beam_end&&(i=!0),t.type==C.NOTE&&(a=t)}if(t.type==C.NOTE)for(0!=t.nhd&&sort_pitch(t),s=t.notes[0].pit,r=t.prev;r&&r.type==C.REST;r=r.prev)r.notes[0].pit=s;else t.notes||(t.notes=[],t.notes[0]={},t.nhd=0),t.notes[0].pit=s}a&&(a.beam_end=!0)}function set_rb(e){for(var t,r,n,a=e.sym;a;)if(a.type==C.BAR&&a.rbstart&&!a.norepbra){if(r=cfmt.rbmax,a.text&&"1"==a.text[0]){for(n=0,t=null,a=a.next;a;a=a.next)if(a.type==C.BAR){if(n++,a.rbstop){n<=cfmt.rbmax&&(r=n,t=null);break}n==cfmt.rbmin&&(t=a)}t&&(t.rbstop=1,r=cfmt.rbmin)}for(;a;){if(2!=a.rbstart){if(!(a=a.next))break;if(2!=a.rbstart){if(!(a=a.next))break;if(2!=a.rbstart)break}}for(n=0,t=null,a=a.next;a;a=a.next)if(a.type==C.BAR){if(n++,a.rbstop)break;a.next?n==r&&(a.rbstop=1):a.rbstop=2}}}else a=a.next}function set_global(){var e,t,r,n,a;for(a=cur_sy,t=a.nstaff;;){if(!(a=a.next))break;a.nstaff>t&&(t=a.nstaff)}for(nstaff=t,n=voice_tb.length,r=0;r<n;r++)e=voice_tb[r],set_words(e),set_rb(e);set_float(),set_clefs(),set_pitch(null)}function set_indent(e){var t,r,n,a,i,s,o,c,l=voice_tb.length,u=0;for(r=0;r<l;r++)if(a=voice_tb[r],!(cur_sy.voices[r].range<0)&&(t=cur_sy.voices[r].st,i=(e||a.new_name)&&a.nm?a.nm:a.snm))for(c||(c=get_font("voice"),set_font(c)),s=0;;){if(o=i.indexOf("\\n",s),n=strwh(o<0?i.slice(s):i.slice(s,o)),n=n[0],n>u&&(u=n),o<0)break;s=o+1}for(c&&(u+=4*cwid(" ")*c.swfac),n=.5,t=0;t<=cur_sy.nstaff;t++){if(cur_sy.staves[t].flags&(OPEN_BRACE2|OPEN_BRACKET2)){n=12;break}cur_sy.staves[t].flags&(OPEN_BRACE|OPEN_BRACKET)&&(n=6)}return u+=n,e&&(u+=cfmt.indent),u}function set_beams(e){var t,r,n,a,i,s,o,c,l,u=-1;for(t=e;t;t=t.next)if(t.type==C.NOTE){if(t.stem||0!=(t.stem=t.multi))t.beam_st&&!t.beam_end&&(n=!0);else if(o=t.mid/3+18,n)t.stem=u;else if(t.beam_st&&!t.beam_end){for(n=!0,c=t.notes[t.nhd].pit,l=t.notes[0].pit,r=t.next;r;r=r.next)if(r.type==C.NOTE){if(r.stem||r.multi){t.stem=r.stem||r.multi;break}if(r.notes[r.nhd].pit>c&&(c=r.notes[r.nhd].pit),r.notes[0].pit<l&&(l=r.notes[0].pit),r.beam_end)break}r.beam_end&&((c+l)/2<o?t.stem=1:(c+l)/2>o?t.stem=-1:cfmt.bstemdown&&(t.stem=-1)),t.stem||(t.stem=u)}else{if((i=(t.notes[t.nhd].pit+t.notes[0].pit)/2)==o){for(i=0,s=0;s<=t.nhd;s++)i+=t.notes[s].pit;i/=t.nhd+1}i<o?t.stem=1:i>o?t.stem=-1:cfmt.bstemdown?t.stem=-1:t.stem=u}if(t.beam_end&&(n=!1),u=t.stem,a){for(r=a.extra;r;r=r.next)r.stem=-u;a.stem=-u,a=null}}else{if(t.type!=C.GRACE)continue;if(r=t.extra,2==r.stem){a=t;continue}for(t.stem||0!=(t.stem=t.multi)||(t.stem=1);r;r=r.next)r.stem=t.stem,r.multi=t.multi}}function same_head(e,t){var r,n,a,i,s,o,c,l,u,f,$;if(e.shiftunison&&e.shiftunison>=3)return!1;if((a=e.dur)>=C.BLEN)return!1;if((i=t.dur)>=C.BLEN)return!1;if(e.stemless&&t.stemless)return!1;if(e.dots!=t.dots&&(e.shiftunison&&1&e.shiftunison||e.dots*t.dots!=0))return!1;if(e.stem*t.stem>0)return!1;if(r=n=0,e.notes[0].pit>t.notes[0].pit){if(e.stem<0)return!1;for(;t.notes[n].pit!=e.notes[0].pit;)if(++n>t.nhd)return!1}else if(e.notes[0].pit<t.notes[0].pit){if(t.stem<0)return!1;for(;t.notes[0].pit!=e.notes[r].pit;)if(++r>e.nhd)return!1}if(t.notes[n].acc!=e.notes[r].acc)return!1;o=r,l=n,f=e.notes[r].shhd,$=t.notes[n].shhd;do{if(r++,n++,r>e.nhd)break;if(n>t.nhd)break;if(t.notes[n].acc!=e.notes[r].acc)return!1;f<e.notes[r].shhd&&(f=e.notes[r].shhd),$<t.notes[n].shhd&&($=t.notes[n].shhd)}while(t.notes[n].pit==e.notes[r].pit);if(r<=e.nhd){if(n<=t.nhd)return!1;if(t.stem>0)return!1}else if(n<=t.nhd&&e.stem>0)return!1;if(c=r,u=n,s=0,a!=i)if(a<i&&(a=i,i=e.dur),a<C.BLEN/2)t.dots>0?s=2:e.dots>0&&(s=1);else{if(!(i<C.BLEN/4))return!1;if(e.shiftunison&&2&e.shiftunison)return!1;s=t.dur>=C.BLEN/2?2:1}if(0==s&&(s=e.p_v.scale<t.p_v.scale?2:1),1==s){for(n=l;n<u;n++)t.notes[n].invis=!0,delete t.notes[n].acc;for(n=0;n<=t.nhd;n++)t.notes[n].shhd+=f}else{for(r=o;r<c;r++)e.notes[r].invis=!0,delete e.notes[r].acc;for(r=0;r<=e.nhd;r++)e.notes[r].shhd+=$}return!0}function unison_acc(e,t,r,n){var a,i;if(t.notes[n].acc){for(i=2*w_note[e.head]+e.xmx+t.notes[n].shac+2,t.notes[n].micro&&(i+=2),e.dots&&(i+=6),a=0;a<=t.nhd;a++)t.notes[a].shhd+=i,t.notes[a].shac-=i;t.xmx+=i}else{for(i=2*w_note[t.head]+t.xmx+e.notes[r].shac+2,e.notes[r].micro&&(i+=2),t.dots&&(i+=6),a=0;a<=e.nhd;a++)e.notes[a].shhd+=i,e.notes[a].shac-=i;e.xmx+=i}}function set_left(e){var t,r,n,a,i=w_note[e.head],s=i,o=[];for(r=0;r<MAXPIT;r++)o.push(-100);if(e.nflags>-2)for(e.stem>0?(s=-s,r=2*e.notes[0].pit,n=2*(Math.ceil((e.ymx-2)/3)+18)):(r=2*(Math.ceil((e.ymn+2)/3)+18),n=2*e.notes[e.nhd].pit),r<0&&(r=0),n>=MAXPIT&&(n=MAXPIT-1);r<=n;)o[r++]=s;for(a=e.notes[e.stem>0?0:e.nhd].shhd,t=0;t<=e.nhd;t++)s=-e.notes[t].shhd+i+a,r=2*e.notes[t].pit,r<0?r=0:r>=MAXPIT-1&&(r=MAXPIT-2),s>o[r]&&(o[r]=s),e.head!=C.SQUARE&&(s-=1),s>o[r-1]&&(o[r-1]=s),s>o[r+1]&&(o[r+1]=s);return o}function set_right(e){var t,r,n,a,i,s=w_note[e.head],o=s,c=e.nflags>0&&e.beam_st&&e.beam_end,l=[];for(r=0;r<MAXPIT;r++)l.push(-100);if(e.nflags>-2)for(e.stem<0?(o=-o,r=2*(Math.ceil((e.ymn+2)/3)+18),n=2*e.notes[e.nhd].pit,a=r+4):(r=2*e.notes[0].pit,n=2*(Math.ceil((e.ymx-2)/3)+18)),r<0&&(r=0),n>MAXPIT&&(n=MAXPIT);r<n;)l[r++]=o;if(c)if(e.stem>0)for(r=0==e.xmx?2*e.notes[e.nhd].pit:2*e.notes[0].pit,r+=4,r<0&&(r=0);r<MAXPIT&&r<=n-4;r++)l[r]=11;else for(r=a,r<0&&(r=0);r<MAXPIT&&r<=2*e.notes[0].pit-4;r++)l[r]=3.5;for(i=e.notes[e.stem>0?0:e.nhd].shhd,t=0;t<=e.nhd;t++)o=e.notes[t].shhd+s-i,r=2*e.notes[t].pit,r<0?r=0:r>=MAXPIT-1&&(r=MAXPIT-2),o>l[r]&&(l[r]=o),e.head!=C.SQUARE&&(o-=1),o>l[r-1]&&(l[r-1]=o),o>l[r+1]&&(l[r+1]=o);return l}function set_overlap(){var e,t,r,n,a,i,s,o,c,l,u,f,$,p,d,h,_,m,y,g,v,b,x;for(e=tsfirst;e;e=e.ts_next)if(e.type==C.NOTE&&!e.invis){if(e.xstem&&e.ts_prev.stem<0)for(o=0;o<=e.nhd;o++)e.notes[o].shhd-=7,e.notes[o].shac+=16;for(r=e;;){if(!(r=r.ts_next))break;if(r.time!=e.time){r=null;break}if(r.type==C.NOTE&&!r.invis&&r.st==e.st)break}if(r&&(t=e,cur_sy.voices[t.v].range<cur_sy.voices[r.v].range?r.dot_low=!0:t.dot_low=!0,!(t.ymn>r.ymx||t.ymx<r.ymn||same_head(t,r)))){if(m=set_right(t),y=set_left(r),(n=t.ts_prev)&&n.time==t.time&&n.st==t.st&&n.type==C.NOTE&&!n.invis)for(v=set_right(n),a=0;a<MAXPIT;a++)v[a]>m[a]&&(m[a]=v[a]);else n=null;for(f=-10,a=0;a<MAXPIT;a++)y[a]+m[a]>f&&(f=y[a]+m[a]);if(!(f<-3&&(!t.dots||!r.dots||!r.dot_low||t.stem>0||r.stem<0||t.notes[t.nhd].pit+2!=r.notes[0].pit||1&r.notes[0].pit))){if(g=set_right(r),_=set_left(t),n)for(v=set_left(n),a=0;a<MAXPIT;a++)v[a]>_[a]&&(_[a]=v[a]);for($=p=d=-100,a=0;a<MAXPIT;a++)_[a]+g[a]>$&&($=_[a]+g[a]),g[a]>d&&(d=g[a]),m[a]>p&&(p=m[a]);for(l=0,i=t.nhd,s=r.nhd;;){switch(u=t.notes[i].pit-r.notes[s].pit){case 0:if(t.notes[i].acc!=r.notes[s].acc){l=-1;break}r.notes[s].acc&&(r.notes[s].acc=0),t.dots&&r.dots&&1&t.notes[i].pit&&(l=1);break;case-1:t.dots&&r.dots&&(1&t.notes[i].pit?(t.dot_low=!1,r.dot_low=!1):(t.dot_low=!0,r.dot_low=!0));break;case-2:if(t.dots&&r.dots&&!(1&t.notes[i].pit)){t.dot_low=!1,r.dot_low=!1;break}}if(l<0)break;if(u>=0&&--i<0)break;if(u<=0&&--s<0)break}if(l<0)unison_acc(t,r,i,s);else{if(c=0,t.dots?r.dots&&(l||(c=1)):r.dots&&$+p<f+d&&(c=1),b=y,x=g,!n&&$+p<f+d&&function(){t=r,r=e,f=$,b=_,x=m,d=p}(),f+=3,f<0&&(f=0),o=t.stem>=0?0:t.nhd,f+=t.notes[o].shhd,o=r.stem>=0?0:r.nhd,f-=r.notes[o].shhd,t.dots)if(h=7.7+t.xmx+3.5*t.dots-3.5+3,c){if(h<f+d+r.xmx){for($=0,i=0;i<=t.nhd;i++)a=t.notes[i].pit,1&a||(t.dot_low?a--:a++),a*=2,a<1?a=1:a>=MAXPIT-1&&(a=MAXPIT-2),x[a]>$&&($=x[a]),x[a-1]+1>$&&($=x[a-1]=1),x[a+1]+1>$&&($=x[a+1]+1);$>4.5&&7.7+t.xmx+2<f+$+r.xmx&&(r.xmx=$+3-7.7)}}else{for($=-100,i=0;i<=t.nhd;i++)a=t.notes[i].pit,1&a||(t.dot_low?a--:a++),a*=2,a<1?a=1:a>=MAXPIT-1&&(a=MAXPIT-2),b[a]>$&&($=b[a]),b[a-1]+1>$&&($=b[a-1]+1),b[a+1]+1>$&&($=b[a+1]+1);h+$+2>f&&(f=h+$+2)}for(o=r.nhd;o>=0;o--)r.notes[o].shhd+=f;r.xmx+=f,c&&(t.xmx=r.xmx)}}}}}function set_stems(){var e,t,r,n,a,i,s,o,c,l;for(e=tsfirst;e;e=e.ts_next)if(e.type==C.NOTE){if(set_head_shift(e),o=e.nflags,e.beam_st&&!e.beam_end){for(e.feathered_beam&&(o=++e.nflags),t=e.next;t.type!=C.NOTE||(e.feathered_beam&&t.nflags++,!t.beam_end);t=t.next);t.nflags>o&&(o=t.nflags)}else if(!e.beam_st&&e.beam_end){for(t=e.prev;!t.beam_st;t=t.prev);t.nflags>o&&(o=t.nflags)}switch(n=cfmt.stemheight,o){case 2:n+=2;break;case 3:n+=5;break;case 4:n+=10;break;case 5:n+=16}1!=(a=e.p_v.scale)&&(n*=.5*(a+1)),i=3*(e.notes[0].pit-18),e.nhd>0?(n-=2,s=3*(e.notes[e.nhd].pit-18)):s=i,e.ntrem&&(n+=2*e.ntrem),e.stemless?(e.stem>=0?(e.y=i,e.ys=s):(e.ys=i,e.y=s),-4==o&&(i-=6),e.ymx=s+4,e.ymn=i-4):e.stem>=0?(o>=2&&(n-=1),e.notes[e.nhd].pit>26&&(o<=0||!e.beam_st||!e.beam_end)&&(n-=2,e.notes[e.nhd].pit>28&&(n-=2)),e.y=i,e.notes[0].ti1&&(i-=3),e.ymn=i-4,e.ys=s+n,e.ys<e.mid&&(e.ys=e.mid),e.ymx=e.ys+2.5|0):(e.notes[0].pit<18&&(o<=0||!e.beam_st||!e.beam_end)&&(n-=2,e.notes[0].pit<16&&(n-=2)),e.ys=i-n,e.ys>e.mid&&(e.ys=e.mid),e.ymn=e.ys-2.5|0,e.y=s,e.notes[e.nhd].ti1&&(s+=3),e.ymx=s+4)}else{if(e.type!=C.GRACE)continue;for(c=l=e.mid,r=e.extra;r;r=r.next)n=GSTEM,r.nflags>1&&(n+=1.2*(r.nflags-1)),i=3*(r.notes[0].pit-18),s=3*(r.notes[r.nhd].pit-18),e.stem>=0?(r.y=i,r.ys=s+n,s=Math.round(r.ys)):(r.y=s,r.ys=i-n,i=Math.round(r.ys)),s+=2,i-=2,i<c?c=i:s>l&&(l=s),r.ymx=s,r.ymn=i;e.ymx=l,e.ymn=c}}function check_bar(e){for(var t,r,n=e.p_v;e.type==C.CLEF||e.type==C.KEY||e.type==C.METER;)if(e.type==C.METER&&e.time>n.sym.time&&(insert_meter|=1),!(e=e.prev))return;if(e.type==C.BAR&&(void 0!=e.text&&(n.bar_start=clone(e),n.bar_start.bar_type="[",delete e.text,delete e.a_gch),":"!=(t=e.bar_type)&&":"==t.slice(-1))){if(n.bar_start||(n.bar_start=clone(e)),":"!=t[0])return"||:"==t?(n.bar_start.bar_type="|:",void(e.bar_type="||")):(n.bar_start.bar_type=t,void(e.prev&&e.prev.type==C.BAR?unlksym(e):e.bar_type="|"));if("::"==t)return n.bar_start.bar_type="|:",void(e.bar_type=":|");if("||:"==t)return n.bar_start.bar_type="|:",void(e.bar_type="||");for(r=0;":"==t[r];)r++;if(r<t.length){for(e.bar_type=t.slice(0,r)+"|",r=t.length-1;":"==t[r];)r--;n.bar_start.bar_type="|"+t.slice(r+1)}else r=t.length/2|0,e.bar_type=t.slice(0,r)+"|",n.bar_start.bar_type="|"+t.slice(r)}}function sym_staff_move(e){for(var t=tsfirst;t&&!t.nl;t=t.ts_next)t.st==e&&t.type!=C.CLEF&&(t.st++,t.invis=!0)}function block_gen(e){switch(e.subtype){case"leftmargin":case"rightmargin":case"pagescale":case"pagewidth":case"scale":case"staffwidth":svg_flush(),set_format(e.subtype,e.param);break;case"ml":svg_flush(),user.img_out(e.text);break;case"newpage":blk_flush(),block.newpage=!0,blk_out();break;case"sep":set_page(),vskip(e.sk1),output+='<path class="stroke"\n\td="M',out_sxsy(e.x," ",0),output+="h"+e.l.toFixed(2)+'"/>\n',vskip(e.sk2);break;case"text":write_text(e.text,e.opt);break;case"title":write_title(e.text,!0);break;case"vskip":vskip(e.sk);break;default:error(2,e,"Block $1 not treated",e.subtype)}}function set_piece(){function e(e){var t=staff_tb[e],r=f.staves[e];t||(t=staff_tb[e]={}),t.y=0,t.stafflines=r.stafflines,t.staffscale=r.staffscale,t.ann_top=t.ann_bot=0}function t(){var e,t,r,n=f.staves.length;for(e=0;e<n;e++)if(f.staves[e].flags&(OPEN_BRACE|OPEN_BRACE2)){for(r=0,t=e;e<n&&(r|=l[e]?1:2,!(f.staves[e].flags&(CLOSE_BRACE|CLOSE_BRACE2)));)e++;if(3==r)for(;t<=e;)l[t]=!0,u[t++]=!0}}var r,n,a,i,s,o,c,l=[],u=[],f=cur_sy;for(nstaff=o=f.nstaff,i=0;i<=o;i++)e(i);for(r=tsfirst;r&&!r.nl;r=r.ts_next){switch(r.ts_next||(n=r),r.type){case C.STAVES:if(t(),f.st_print=new Uint8Array(l),f=r.sy,o=f.nstaff,nstaff<o){for(i=nstaff+1;i<=o;i++)e(i);nstaff=o}l=[];continue;case C.BLOCK:blocks.push(r),unlksym(r),n&&(n=r.ts_prev);continue}if(i=r.st,!l[i])switch(r.type){case C.CLEF:i>nstaff&&(staff_tb[i].clef=r,unlksym(r));break;case C.BAR:if(!f.staves[i].staffnonote||f.staves[i].staffnonote<=1)break;case C.GRACE:u[i]=l[i]=!0;break;case C.NOTE:case C.REST:case C.SPACE:case C.MREST:f.staves[i].staffnonote>1?u[i]=l[i]=!0:r.invis||0==f.staves[i].staffnonote&&r.type!=C.NOTE||(u[i]=l[i]=!0)}}for(tsnext=r,t(),f.st_print=new Uint8Array(l),
function(){var e,t,r,n;for(e=0;e<=nstaff;e++)if(t=staff_tb[e],u[e]){for(n=t.stafflines.length,t.topbar=6*(n-1),r=0;r<n-1&&"."==t.stafflines[r];r++);t.botline=t.botbar=6*r,r>=n-2&&("."!=t.stafflines[r]?(t.botbar-=6,t.topbar+=6):(t.botbar-=12,t.topbar+=12))}else t.botbar=t.topbar=0}(),i=0;i<nstaff;i++)u[i]||sym_staff_move(i);if(u[nstaff]||(staff_tb[nstaff].topbar=0),init_music_line(),gene.st_print=new Uint8Array(u),tsnext)for(r=tsnext,delete r.nl,n=r.ts_prev,n.ts_next=null,c=voice_tb.length,s=0;s<c;s++){if(a=voice_tb[s],a.sym&&a.sym.time<=tsnext.time){for(r=tsnext.ts_prev;r;r=r.ts_prev)if(r.v==s){a.s_next=r.next,r.next=null,check_bar(r);break}if(r)continue}a.s_next=a.sym,a.sym=null}n.type!=C.BAR&&(r=add_end_bar(n),r.prev=r.ts_prev=n,n.ts_next=n.next=r,r.shrink=n.wr+2,r.space=set_space(r),r.space<r.shrink&&n.type!=C.KEY&&(r.space=r.shrink))}function set_sym_glue(e){var t,r,n,a,i=0,s=0,o=0,c=0,l=0;for(t=tsfirst;t;t=t.ts_next)t.type!=C.GRACE||n||(n=t),t.seqst&&(i+=t.shrink,t.space?t.space<t.shrink?(l+=t.shrink,s+=t.shrink):s+=t.space:c+=t.shrink);if(0==s)return void(realwidth=0);if(i>=e||s==l){for(i>e&&error(1,t,"Line too much shrunk $1 $2 $3",i.toFixed(2),s.toFixed(2),e.toFixed(2)),o=0,t=tsfirst;t;t=t.ts_next)t.seqst&&(o+=t.shrink),t.x=o;spf_last=0}else if(s+c>e*(1-cfmt.stretchlast)||tsnext&&0==blocks.length&&tsnext.type!=C.BLOCK&&cfmt.stretchstaff){for(var u=4;--u>=0;){for(a=(e-c-l)/(s-l),s=0,l=0,o=0,t=tsfirst;t;t=t.ts_next)t.seqst&&(t.space?t.space*a<=t.shrink?(l+=t.shrink,s+=t.shrink,o+=t.shrink):(s+=t.space,o+=t.space*a):o+=t.shrink),t.x=o;if(Math.abs(o-e)<.1)break}spf_last=a}else for(a=(e-c-l)/s,spf_last<a&&(a=spf_last),t=tsfirst;t;t=t.ts_next)t.seqst&&(o+=t.space*a<=t.shrink?t.shrink:t.space*a),t.x=o;for(realwidth=o,t=n;t;t=t.ts_next)if(t.type==C.GRACE)for(o=t.gr_shift?t.prev.x+t.prev.wr:t.x-t.wl,r=t.extra;r;r=r.next)r.x+=o}function set_sym_line(){var e,t,r,n=voice_tb.length;for(r=0;r<n;r++)e=voice_tb[r],t=e.s_next,e.sym=t,t&&(t.prev=null)}function set_posx(){posx=img.lm/cfmt.scale}function gen_init(){for(var e=tsfirst,t=e.time;e;e=e.ts_next){if(e.time!=t)return void set_page();switch(e.type){case C.NOTE:case C.REST:case C.MREST:return void set_page();default:continue;case C.STAVES:cur_sy=e.sy;break;case C.BLOCK:block_gen(e)}unlksym(e),e.p_v.s_next==e&&(e.p_v.s_next=e.next)}tsfirst=null}function output_music(){var e,t,r,n;if(gen_init(),tsfirst){for(set_global(),voice_tb.length>1&&set_stem_dir(),e=0;e<voice_tb.length;e++)set_beams(voice_tb[e].sym);for(set_stems(),voice_tb.length>1&&(set_rest_offset(),set_overlap()),set_acc_shft(),set_allsymwidth(null),r=set_indent(!0),cfmt.singleline?(e=get_ck_width(),t=r+e[0]+e[1]+get_width(tsfirst,null),img.width=t*cfmt.scale+img.lm+img.rm+2):(t=get_lwidth(),cut_tune(t,r)),spf_last=1.2;;){if(set_piece(),set_sym_glue(t-r),0!=realwidth)for(0!=r&&(posx+=r),draw_sym_near(),n=set_staff(),delayed_update(),draw_systems(r),draw_all_sym(),vskip(n),0!=r&&(posx-=r,insert_meter&=-3);0!=blocks.length;)block_gen(blocks.shift());if(tsfirst=tsnext,svg_flush(),!tsnext)break;if(gen_init(),!tsfirst)break;tsfirst.ts_prev=null,set_sym_line(),t=get_lwidth(),r=set_indent()}}}function reset_gen(){insert_meter=cfmt.writefields.indexOf("M")>=0?3:2}function set_ref(e){e.fname=parse.fname,e.istart=parse.istart,e.iend=parse.iend}function new_clef(e){var t={type:C.CLEF,clef_line:2,clef_type:"t",v:curvoice.v,p_v:curvoice,time:curvoice.time,dur:0},r=1;switch(set_ref(t),e[0]){case'"':r=e.indexOf('"',1),t.clef_name=e.slice(1,r),r++;break;case"a":if("u"==e[1]){t.clef_type="a",t.clef_auto=!0,r=4;break}r=4;case"C":t.clef_type="c",t.clef_line=3;break;case"b":r=4;case"F":t.clef_type="b",t.clef_line=4;break;case"n":r=4,t.invis=!0;break;case"t":if("e"==e[1]){t.clef_type="c",t.clef_line=4;break}r=6;case"G":break;case"p":r=4;case"P":t.clef_type="p",t.clef_line=3,curvoice.key.k_sf=0;break;default:return void syntax(1,"Unknown clef '$1'",e)}if(e[r]>="1"&&e[r]<="9"&&(t.clef_line=Number(e[r]),r++),"8"!=e[r+1])return t;switch(e[r]){case"^":t.clef_oct_transp=!0;case"+":t.clef_octave=7;break;case"_":t.clef_oct_transp=!0;case"-":t.clef_octave=-7}return t}function get_transp(e,t){var r,n,a,i,s=[];if("0"==e[0])return 0;if("123456789-+".indexOf(e[0])>=0){if(n=3*parseInt(e),isNaN(n)||n<-108||n>108)return void syntax(1,"Bad transpose value");switch(e.slice(-1)){default:return n;case"#":n++;break;case"b":n+=2}return n>0?n:n-3}if("instr"==t)if(a=e.indexOf("/"),cfmt.sound)e=a<0?"c"+e:e.replace(/.*\//,"c");else{if(a<0)return 0;e=e.replace("/","")}for(a=new scanBuf,a.buffer=e,r=0;r<2;r++){if(!(i=parse_acc_pit(a)))return void syntax(1,"Bad transpose value");i.pit+=124,n=12*(i.pit/7|0)+note_pit[i.pit%7],i.acc&&3!=i.acc&&(n+=i.acc),s[r]=n}if(cfmt.sound&&(s[0]=252),n=3*(s[1]-s[0]),i)switch(i.acc){default:return n;case 2:case 1:n++;break;case-1:case-2:n+=2}return n>0?n:n-3}function set_linebreak(e){var t,r;for(t=0;t<128;t++)"\n"==char_tb[t]&&(char_tb[t]=nil);for(e=e.split(/\s+/),t=0;t<e.length;t++){switch(r=e[t]){case"!":case"$":case"*":case";":case"?":case"@":break;case"<none>":continue;case"<EOL>":r="\n";break;default:syntax(1,"Bad value '$1' in %%linebreak - ignored",r);continue}char_tb[r.charCodeAt(0)]="\n"}}function set_user(e){var t,r,n,a=e.match(/(.*?)[= ]*([!"].*[!"])/);if(!a)return void syntax(1,'Lack of starting ! or " in U: / %%user');if(r=a[1],n=a[2],n.slice(-1)!=n[0])return void syntax(1,"Lack of ending $1 in U:/%%user",n[0]);if("\\"==r[0]&&("t"==r[1]?r="\t":r[1]||(r=" ")),(t=r.charCodeAt(0))>=128)return void syntax(1,errs.not_ascii);switch(char_tb[t][0]){case"0":case"d":case"i":case" ":break;case'"':case"!":if(char_tb[t].length>1)break;default:return void syntax(1,"Bad user character '$1'",r)}switch(n){case"!beambreak!":n=" ";break;case"!ignore!":n="i";break;case"!nil!":case"!none!":n="d"}char_tb[t]=n}function get_st_lines(e){var t,r;if(e){if(/^[\]\[|.-]+$/.test(e))return e.replace(/\]/g,"[");switch(t=parseInt(e)){case 0:return"...";case 1:return"..|";case 2:return".||";case 3:return".|||"}if(!(isNaN(t)||t<0||t>16)){for(r="|";--t>0;)r+="|";return r}}}function new_block(e){var t={type:C.BLOCK,subtype:e,dur:0};2==parse.state&&goto_tune();var r=curvoice;return curvoice=voice_tb[par_sy.top_voice],sym_link(t),curvoice=r,t}function set_vp(e){for(var t,r,n,a,i;;){if(!(r=e.shift()))break;if("="==r[r.length-1]&&0==e.length){syntax(1,errs.bad_val,r);break}switch(r){case"clef=":t=e.shift();break;case"clefpitch=":if((r=e.shift())&&(a=ntb.indexOf(r[0]))>=0){switch(r[1]){case"'":a+=7;break;case",":a-=7,","==r[2]&&(a-=7)}i=4-a;break}syntax(1,errs.bad_val,r);break;case"octave=":case"uscale=":a=parseInt(e.shift()),isNaN(a)?syntax(1,errs.bad_val,r):curvoice[r.slice(0,-1)]=a;break;case"cue=":curvoice.scale="on"==e.shift()?.7:1;break;case"instrument=":curvoice.transp=get_transp(e.shift(),"instr");break;case"map=":"play"!=cfmt.sound&&(curvoice.map=e.shift());break;case"name=":case"nm=":curvoice.nm=e.shift(),'"'==curvoice.nm[0]&&(curvoice.nm=curvoice.nm.slice(1,-1)),curvoice.new_name=!0;break;case"stem=":case"pos=":if(r="pos="==r?e.shift().split(" "):["stm",e.shift()],void 0==(a=posval[r[1]])){syntax(1,errs.bad_val,r[0]);break}n||(n={}),n[r[0]]=a;break;case"scale=":a=parseFloat(e.shift()),isNaN(a)||a<.6||a>1.5?syntax(1,errs.bad_val,"%%voicescale"):curvoice.scale=a;break;case"score=":if(cfmt.sound)break;r=e.shift(),r.indexOf("/")<0&&(r+="/c"),curvoice.transp=get_transp(r);break;case"shift=":curvoice.shift=get_transp(e.shift());break;case"sound=":case"transpose=":if(!cfmt.sound)break;curvoice.transp=get_transp(e.shift());break;case"subname=":case"sname=":case"snm=":curvoice.snm=e.shift(),'"'==curvoice.snm[0]&&(curvoice.snm=curvoice.snm.slice(1,-1));break;case"stafflines=":a=get_st_lines(e.shift()),void 0==a?syntax(1,"Bad %%stafflines value"):void 0!=curvoice.st?par_sy.staves[curvoice.st].stafflines=a:curvoice.stafflines=a;break;case"staffnonote=":a=parseInt(e.shift()),isNaN(a)?syntax(1,"Bad %%staffnonote value"):curvoice.staffnonote=a;break;case"staffscale=":a=parseFloat(e.shift()),isNaN(a)||a<.3||a>2?syntax(1,"Bad %%staffscale value"):curvoice.staffscale=a;break;default:switch(r.slice(0,4)){case"treb":case"bass":case"alto":case"teno":case"perc":t=r;break;default:"GFC".indexOf(r[0])>=0?t=r:"="==r.slice(-1)&&e.shift()}}}if(n){curvoice.pos=clone(curvoice.pos);for(r in n)n.hasOwnProperty(r)&&(curvoice.pos[r]=n[r])}t&&(t=new_clef(t))&&(i&&(t.clefpit=i),get_clef(t))}function set_kv_parm(e){curvoice.init||(curvoice.init=!0,info.V&&(info.V["*"]&&(e=info.V["*"].concat(e)),info.V[curvoice.id]&&(e=info.V[curvoice.id].concat(e)))),0!=e.length&&set_vp(e)}function memo_kv_parm(e,t){0!=t.length&&(info.V||(info.V={}),info.V[e]?Array.prototype.push.apply(info.V[e],t):info.V[e]=t)}function new_key(e){var t,r,n,a,i=0,s={type:C.KEY,k_delta:0,dur:0};switch(set_ref(s),t=1,e[0]){case"A":s.k_sf=3;break;case"B":s.k_sf=5;break;case"C":s.k_sf=0;break;case"D":s.k_sf=2;break;case"E":s.k_sf=4;break;case"F":s.k_sf=-1;break;case"G":s.k_sf=1;break;case"H":switch(e[1]){case"P":case"p":s.k_bagpipe=e[1],s.k_sf="P"==e[1]?0:2,t++;break;default:syntax(1,"Unknown bagpipe-like key")}break;case"P":s.k_drum=!0,r=!0;break;case"n":0==e.indexOf("none")&&(s.k_sf=0,s.k_none=!0,t=4);default:r=!0}if(!r){switch(e[t]){case"#":s.k_sf+=7,t++;break;case"b":s.k_sf-=7,t++}switch(e=e.slice(t).trim(),e.slice(0,3).toLowerCase()){default:if("m"!=e[0]||" "!=e[1]&&"\t"!=e[1]&&"\n"!=e[1]){r=!0;break}case"aeo":case"m":case"min":s.k_sf-=3,i=5;break;case"dor":s.k_sf-=2,i=1;break;case"ion":case"maj":break;case"loc":s.k_sf-=5,i=6;break;case"lyd":s.k_sf+=1,i=3;break;case"mix":s.k_sf-=1,i=4;break;case"phr":s.k_sf-=4,i=2}if(r||(e=e.replace(/\w+\s*/,"")),0==e.indexOf("exp ")&&(e=e.replace(/\w+\s*/,""),e||syntax(1,"No accidental after 'exp'"),s.k_exp=!0),"^"==(n=e[0])||"_"==n||"="==n){s.k_a_acc=[],a=new scanBuf,a.buffer=e;do{var o=parse_acc_pit(a);if(!o)return[s,null];for(s.k_a_acc.push(o),n=e[a.index];" "==n;)n=e[++a.index]}while("^"==n||"_"==n||"="==n);e=e.slice(a.index)}else s.k_exp&&0==e.indexOf("none")&&(s.k_sf=0,e=e.replace(/\w+\s*/,""))}return s.k_delta=cgd2cde[(s.k_sf+7)%7],s.k_mode=i,[s,info_split(e,0)]}function new_meter(e){var t,r,n,a,i,s,o={type:C.METER,dur:0,a_meter:[]},c={},l=0,u=0,f=e;if(set_ref(o),0==f.indexOf("none"))u=4,i=1;else for(i=0;u<e.length&&"="!=f[u];){switch(f[u]){case"C":c.top=f[u++],"|"==f[u]&&(c.top+=f[u++]),l=4,n=4;break;case"c":case"o":l="c"==f[u]?4:3,n=4,c.top=f[u++],"."==f[u]&&(c.top+=f[u++]);break;case"(":for("("==f[u+1]&&(s=!0,c.top=f[u++],o.a_meter.push(c),c={}),a=u+1;a<e.length&&")"!=f[a]&&"/"!=f[a];)a++;if(")"==f[a]&&"/"==f[a+1]){u++;continue}case")":s="("==f[u],c.top=f[u++],o.a_meter.push(c),c={};continue;default:if(f[u]<="0"||f[u]>"9")return void syntax(1,"Bad char '$1' in M:",f[u]);for(n=2,c.top=f[u++];;){for(;f[u]>="0"&&f[u]<="9";)c.top+=f[u++];if(")"==f[u]){if("/"!=f[u+1])break;u++}if("/"==f[u]){if(u++,f[u]<="0"||f[u]>"9")return void syntax(1,"Bad char '$1' in M:",f[u]);for(c.bot=f[u++];f[u]>="0"&&f[u]<="9";)c.bot+=f[u++];break}if(" "!=f[u]&&"+"!=f[u])break;if(u>=e.length||"("==f[u+1])break;c.top+=f[u++]}l=parseInt(c.top)}for(s||(c.bot&&(n=parseInt(c.bot)),i+=l*C.BLEN/n),o.a_meter.push(c),c={};" "==f[u];)u++;"+"==f[u]&&(c.top=f[u++],o.a_meter.push(c),c={})}if("="==f[u]){if(!(t=f.substring(++u).match(/^(\d+)\/(\d+)$/)))return void syntax(1,"Bad duration '$1' in M:",f.substring(u));i=C.BLEN*t[1]/t[2]}if(o.wmeasure=i,3!=parse.state){if(info.M=e,glovar.meter=o,parse.state>=1)for(glovar.ulen||(i<=1||i>=3*C.BLEN/4?glovar.ulen=C.BLEN/8:glovar.ulen=C.BLEN/16),r=0;r<voice_tb.length;r++)voice_tb[r].meter=o,voice_tb[r].wmeasure=i}else curvoice.wmeasure=i,is_voice_sig()?(curvoice.meter=o,reset_gen()):sym_link(o)}function new_tempo(e){var t,r,n,a=0,i={type:C.TEMPO,dur:0};if(set_ref(i),cfmt.writefields.indexOf("Q")<0&&(i.del=!0),'"'==e[0]){if((a=e.indexOf('"',1))<0)return void syntax(1,"Unterminated string in Q:");for(i.tempo_str1=e.slice(1,a),a++;" "==e[a];)a++}for(n=new scanBuf,n.buffer=e,n.index=a;;){if(void 0==(t=e[n.index])||t<="0"||t>"9")break;for(r=parse_dur(n),i.tempo_notes||(i.tempo_notes=[]),i.tempo_notes.push(C.BLEN*r[0]/r[1]);;){if(" "!=(t=e[n.index]))break;n.index++}}if("="==t){for(t=e[++n.index];" "==t;)t=e[++n.index];for(a=n.index,"c"==t&&"a"==e[a+1]&&"."==e[a+2]&&" "==e[a+3]&&(i.tempo_ca="ca. ",n.index+=4),"/"!=e[n.index+1]?i.tempo=n.get_int():(r=parse_dur(n),i.new_beat=C.BLEN*r[0]/r[1]),t=e[n.index];" "==t;)t=e[++n.index]}if('"'==t){if(n.index++,(a=e.indexOf('"',n.index+1))<0)return void syntax(1,"Unterminated string in Q:");i.tempo_str2=e.slice(n.index,a)}if(3!=parse.state){if(1==parse.state)return info.Q=e,void(glovar.tempo=i);goto_tune()}curvoice.v==par_sy.top_voice&&(sym_link(i),glovar.tempo&&0==curvoice.time&&(glovar.tempo.del=!0))}function do_info(e,t){var r,n,a,i;switch(e){case"I":do_pscom(t);break;case"L":if(2==parse.state&&goto_tune(),i=t.match(/^1\/(\d+)(=(\d+)\/(\d+))?$/)){if(!(n=Number(i[1]))||0!=(n&n-1))break;if(n=C.BLEN/n,i[2]){if(!(a=Number(i[4]))||0!=(a&a-1)){a=0;break}a=Number(i[3])/a*C.BLEN}else a=n}else"auto"==t&&(n=a=-1);if(!a){syntax(1,"Bad L: value");break}parse.state<2?glovar.ulen=n:(curvoice.ulen=n,curvoice.dur_fact=a/n);break;case"M":new_meter(t);break;case"U":set_user(t);break;case"P":if(0==parse.state)break;if(1==parse.state){info.P=t;break}if(2==parse.state&&goto_tune(),cfmt.writefields.indexOf(e)<0)break;r={type:C.PART,text:t,dur:0};var s=voice_tb[par_sy.top_voice];if(curvoice.v!=s.v){if(curvoice.time!=s.time)break;if(s.last_sym&&s.last_sym.type==C.PART)break;var o=curvoice;curvoice=s,sym_link(r),curvoice=o}else sym_link(r);break;case"Q":if(0==parse.state)break;new_tempo(t);break;case"V":get_voice(t);break;case"K":if(0==parse.state)break;get_key(t);break;case"N":case"R":info[e]?info[e]+="\n"+t:info[e]=t;break;case"r":if(!user.keep_remark||3!=parse.state)break;r={type:C.REMARK,text:t,dur:0},sym_link(r);break;default:syntax(0,"'$1:' line ignored",e)}}function adjust_dur(e){var t,r,n,a,i;if((t=curvoice.last_sym)&&t.type!=C.MREST&&t.type!=C.BAR){for(;t.type!=C.BAR&&t.prev;)t=t.prev;if(r=t.time,n=curvoice.time-r,0==r){for(;t&&!t.dur;)t=t.next;t&&t.type==C.REST&&t.invis&&(r+=t.dur*curvoice.wmeasure/n,t.prev?t.prev.next=t.next:curvoice.sym=t.next,t.next&&(t.next.prev=t.prev),t=t.next)}if(curvoice.wmeasure!=n){for(;t;t=t.next)if(t.time=r,t.dur&&!t.grace&&(t.dur=t.dur*curvoice.wmeasure/n,t.dur_orig=t.dur_orig*curvoice.wmeasure/n,r+=t.dur,t.type==C.NOTE||t.type==C.REST)){for(a=0;a<=t.nhd;a++)t.notes[a].dur=t.notes[a].dur*curvoice.wmeasure/n;i=identify_note(t,t.dur_orig),t.head=i[0],t.dots=i[1],t.nflags=i[2],t.nflags<=-2?t.stemless=!0:delete t.stemless}curvoice.time=e.time=r}}}function new_bar(){var e,t,r,n=parse.line,a={type:C.BAR,fname:parse.fname,istart:parse.bol+n.index,dur:0,multi:0};for(vover&&vover.bar&&get_vover("|"),glovar.new_nbar&&(a.bar_num=glovar.new_nbar,glovar.new_nbar=0),r=n.char();;){switch(t=n.next_char()){case"|":case"[":case"]":case":":r+=t;continue}break}switch(":"==r[0]&&(1==r.length?(r="|",a.bar_dotted=!0):a.rbstop=2),a_gch&&gch_build(a),a_dcn&&(deco_cnv(a_dcn,a),a_dcn=null),r.slice(-1)){case"[":if(/[0-9" ]/.test(t))break;r=r.slice(0,-1),n.index--,t="[";break;case":":a.rbstop=2}if(t>"0"&&t<="9"){for("["==r.slice(-1)&&(r=r.slice(0,-1)),a.text=t;;){if(t=n.next_char(),"0123456789,.-".indexOf(t)<0)break;a.text+=t}a.rbstop=2,a.rbstart=2}else if('"'==t&&"["==r.slice(-1)){for(r=r.slice(0,-1),a.text="";;){if(!(t=n.next_char()))return void syntax(1,"No end of repeat string");if('"'==t){n.index++;break}"\\"==t&&(a.text+=t,t=n.next_char()),a.text+=t}a.text=cnv_escape(a.text),a.rbstop=2,a.rbstart=2}if("]"==r[0]&&(a.rbstop=2,1!=r.length?r=r.slice(1):a.invis=!0),a.iend=parse.bol+n.index,a.rbstart&&curvoice.norepbra&&!curvoice.second&&(a.norepbra=!0),curvoice.ulen<0&&adjust_dur(a),(e=curvoice.last_sym)&&e.type==C.SPACE)e.time--;else if(e&&e.type==C.BAR){if("["==r&&!e.text&&(0==curvoice.st||par_sy.staves[curvoice.st-1].flags&STOP_BAR||a.norepbra))return a.text&&(e.text=a.text),a.a_gch&&(e.a_gch=a.a_gch),a.norepbra&&(e.norepbra=a.norepbra),a.rbstart&&(e.rbstart=a.rbstart),void(a.rbstop&&(e.rbstop=a.rbstop));if("|:"==r){if(":|"==e.bar_type)return e.bar_type="::",void(e.rbstop=2);if("||"==e.bar_type)return e.bar_type="||:",void(e.rbstop=2)}}switch(r){case"[":a.rbstop=2;case"[]":case"[|]":a.invis=!0,r="[]";break;case":|:":case":||:":r="::";break;case"||":if(!cfmt.rbdbstop)break;case"[|":case"|]":a.rbstop=2}a.bar_type=r,curvoice.lyric_restart||(curvoice.lyric_restart=a),curvoice.sym_restart||(curvoice.sym_restart=a),!e||e.type!=C.KEY||e.prev&&e.prev.type==C.BAR?sym_link(a):(curvoice.last_sym=e.prev,e.prev||(curvoice.sym=e.prev),sym_link(a),a.next=e,e.prev=a,curvoice.last_sym=e),a.st=curvoice.st,a.rbstart&&!curvoice.norepbra&&curvoice.st>0&&!(par_sy.staves[curvoice.st-1].flags&STOP_BAR)&&(e={type:C.BAR,fname:a.fname,istart:a.istart,iend:a.iend,bar_type:"[",multi:0,invis:!0,text:a.text,rbstart:2},sym_link(e),e.st=curvoice.st,delete a.text,a.rbstart=0)}function parse_staves(e){for(var t,r=[],n=!1,a=0,i=0,s=0,o=0,c=0,l=0;l<e.length;){switch(e[l]){case" ":case"\t":break;case"[":if(o||i+s>=2){syntax(1,errs.misplaced,"["),n=!0;break}a|=i+s==0?OPEN_BRACKET:OPEN_BRACKET2,s++,c<<=8,c|=OPEN_BRACKET;break;case"{":if(o||i||s>=2){syntax(1,errs.misplaced,"{"),n=!0;break}a|=s?OPEN_BRACE2:OPEN_BRACE,i++,c<<=8,c|=OPEN_BRACE;break;case"(":if(o){syntax(1,errs.misplaced,"("),n=!0;break}a|=OPEN_PARENTH,o++,c<<=8,c|=OPEN_PARENTH;break;case"*":!i||o||a&(OPEN_BRACE|OPEN_BRACE2)||(a|=FL_VOICE);break;case"+":a|=MASTER_VOICE;break;default:if(!/\w/.test(e[l])){syntax(1,"Bad voice ID in %%staves"),n=!0;break}for(t="";l<e.length&&!(" \t()[]{}|*".indexOf(e[l])>=0);)t+=e[l++];for(;l<e.length;l++){switch(e[l]){case" ":case"\t":continue;case"]":if(!(c&OPEN_BRACKET)){syntax(1,errs.misplaced,"]"),n=!0;break}s--,a|=i+s==0?CLOSE_BRACKET:CLOSE_BRACKET2,c>>=8;continue;case"}":if(!(c&OPEN_BRACE)){syntax(1,errs.misplaced,"}"),n=!0;break}i--,a|=s?CLOSE_BRACE2:CLOSE_BRACE,a&=~FL_VOICE,c>>=8;continue;case")":if(!(c&OPEN_PARENTH)){syntax(1,errs.misplaced,")"),n=!0;break}o--,a|=CLOSE_PARENTH,c>>=8;continue;case"|":a|=STOP_BAR;continue}break}r.push([t,a]),a=0;continue}l++}if(0!=c&&(syntax(1,"'}', ')' or ']' missing in %%staves"),n=!0),!n&&0!=r.length)return r}function info_split(e){if(!e)return[];var t=e.match(/(".+?"|.+?)(\s+|=|$)/g);if(!t)return syntax(1,"Unterminated string"),[];for(var r=0;r<t.length;r++)t[r]=t[r].trim();return t}function identify_note(e,t){var r,n,a;for(t%12!=0&&syntax(1,"Invalid note duration $1",t),t/=12,0==t&&syntax(1,"Note too short"),a=5;0!=t&&!(1&t);t>>=1,a--);switch(t>>=1){case 0:n=0;break;case 1:n=1;break;case 3:n=2;break;default:n=3}if((a-=n)>=0)r=C.FULL;else switch(a){default:syntax(1,"Note too long"),a=-4;case-4:r=C.SQUARE;break;case-3:r=cfmt.squarebreve?C.SQUARE:C.OVALBARS;break;case-2:r=C.OVAL;break;case-1:r=C.EMPTY}return[r,n,a]}function parse_dur(e){var t,r,n;return reg_dur.lastIndex=e.index,t=reg_dur.exec(e.buffer),t[0]?(r=t[1]||1,n=t[3]||1,t[3]||(n*=1<<t[2].length),e.index=reg_dur.lastIndex,[r,n]):[1,1]}function parse_acc_pit(e){var t,r,n,a,i,s,o=e.char();switch(o){case"^":o=e.next_char(),"^"==o?(r=2,o=e.next_char()):r=1;break;case"=":r=3,o=e.next_char();break;case"_":o=e.next_char(),"_"==o?(r=-2,o=e.next_char()):r=-1}if((r&&3!=r&&o>="1"&&o<="9"||"/"==o)&&(s=parse_dur(e),n=s[0],a=s[1],1==a?a=curvoice?curvoice.uscale:1:a*=2,o=e.char()),i=ntb.indexOf(o)+16,o=e.next_char(),i<16)return void syntax(1,"'$1' is not a note",e.buffer[e.index-1]);for(;"'"==o;)i+=7,o=e.next_char();for(;","==o;)i-=7,o=e.next_char();return t={pit:i,apit:i,shhd:0,shac:0,ti1:0},r&&(t.acc=r,n&&(t.micro_n=n,t.micro_d=a)),t}function set_map(e){var t,r,n,a,i=maps[curvoice.map];for(t="abcdefg"[(e.pit+77)%7],r=e.acc?["__","_","","^","^^","="][e.acc+2]:"",n=r+t,a=e.pit;a>=28;a-=7)n+="'";for(a=e.pit;a<21;a+=7)n+=",";(i[n]||(n="octave,"+r+t,i[n]||(n="key,"+"abcdefg"[(e.pit+77-curvoice.ckey.k_delta)%7],i[n]||(n="all",i[n]))))&&(e.map=i[n],e.map[1]&&(e.apit=e.pit=e.map[1].pit,e.acc=e.map[1].acc))}function parse_basic_note(e,t){var r,n=parse_acc_pit(e);if(n)return"0"==e.char()&&(parse.stemless=!0,e.index++),r=parse_dur(e),n.dur=t*r[0]/r[1],n}function parse_vpos(){var e=parse.line,t=0;switch("."!=e.buffer[e.index-1]||a_dcn||(t=C.SL_DOTTED),e.next_char()){case"'":return e.index++,t+C.SL_ABOVE;case",":return e.index++,t+C.SL_BELOW}return t+C.SL_AUTO}function note_transp(e){var t,r,n,a,i,s,o,c,l,u,f=e.nhd,$=curvoice.okey.k_sf,p=curvoice.ckey.k_sf-$,d=cgd2cde[(p+28)%7],h=curvoice.vtransp;for(h<0&&0!=d&&(d-=7),d+=7*(h/3/12|0),t=0;t<=f;t++){if(u=e.notes[t],n=u.pit,u.pit+=d,u.apit=u.pit,o=cde2fcg[(n+5+112)%7],!(i=u.acc))if(curvoice.okey.a_acc){for(r=0;r<curvoice.okey.a_acc.length;r++)if(s=curvoice.okey.a_acc[r],(n+112-s.pit)%7==0){i=s.acc;break}}else $>0?o<$-1&&(i=1):$<0&&o>=$+6&&(i=-1);if(c=o+p,i&&3!=i&&(c+=7*i),o=(2+((c+1+21)/7|0)-3+160)%5,i=acc2[o],u.acc);else if(curvoice.ckey.k_none){if(3==i||acc_same_pitch(u.pit))continue}else{if(!curvoice.ckey.a_acc)continue;for(l=cgd2cde[(c+112)%7],r=0;r<curvoice.ckey.a_acc.length&&(l+112-curvoice.ckey.a_acc[r].pits)%7!=0;r++);if(r<curvoice.ckey.a_acc.length)continue}if(o=u.acc,(a=u.micro_d)&&o!=i)switch(n=u.micro_n,i){case 3:n>a/2?(n-=a/2,u.micro_n=n,i=o):i=-o;break;case 2:n>a/2?(u.pit+=1,u.apit=u.pit,n-=a/2):n+=a/2,i=o,u.micro_n=n;break;case-2:n>=a/2?(u.pit-=1,u.apit=u.pit,n-=a/2):n+=a/2,i=o,u.micro_n=n}u.acc=i}}function sort_pitch(e){e.notes=e.notes.sort(function(e,t){return e.pit-t.pit})}function new_note(e,t){var r,n,a,i,s,o,c,l,u,f,$,p,d,h=0,_=parse.line,m=a_dcn;switch(a_dcn=null,parse.stemless=!1,n={type:C.NOTE,fname:parse.fname,stem:0,multi:0,nhd:0,xmx:0},n.istart=parse.bol+_.index,curvoice.color&&(n.color=curvoice.color),e?n.grace=!0:(a_gch&&gch_build(n),parse.repeat_n&&(n.repeat_n=parse.repeat_n,n.repeat_k=parse.repeat_k,parse.repeat_n=0)),i=_.char()){case"X":n.invis=!0;case"Z":if(n.type=C.MREST,i=_.next_char(),n.nmes=i>"0"&&i<="9"?_.get_int():1,n.dur=curvoice.wmeasure*n.nmes,curvoice.second)return void(curvoice.time+=n.dur);break;case"y":n.type=C.SPACE,n.invis=!0,n.dur=0,i=_.next_char(),n.width=i>="0"&&i<="9"?_.get_int():10;break;case"x":n.invis=!0;case"z":n.type=C.REST,_.index++,f=parse_dur(_),n.dur_orig=(curvoice.ulen<0?15120:curvoice.ulen)*f[0]/f[1],n.dur=n.dur_orig*curvoice.dur_fact,n.notes=[{pit:18,dur:n.dur_orig}];break;case"[":a=!0,i=_.next_char();default:for(curvoice.uscale&&(n.uscale=curvoice.uscale),n.notes=[];;){if(a)for(;;){if(!i)break;if((c=i.charCodeAt(0))>=128)return void syntax(1,errs.not_ascii);switch(o=char_tb[c],o[0]){case"(":h<<=4,h+=parse_vpos(),i=_.char();continue;case"!":if(a_dcn||(a_dcn=[]),o.length>1)a_dcn.push(o.slice(1,-1));else{for(s="";;){if(!(i=_.next_char()))return void syntax(1,"No end of decoration");if("!"==i)break;s+=i}a_dcn.push(s)}i=_.next_char();continue}break}if(!(r=parse_basic_note(_,n.grace?C.BLEN/4:curvoice.ulen<0?15120:curvoice.ulen)))return;if(curvoice.octave&&(r.apit=r.pit+=7*curvoice.octave),curvoice.ottava&&(r.pit+=curvoice.ottava),h&&(r.sl1=h,n.sl1?n.sl1++:n.sl1=1,h=0),a_dcn&&(r.a_dcn=a_dcn,a_dcn=null),n.notes.push(r),!a)break;for(i=_.char();;){switch(i){case")":r.sl2?r.sl2++:r.sl2=1,n.sl2?n.sl2++:n.sl2=1,i=_.next_char();continue;case"-":r.ti1=parse_vpos(),n.ti1=!0,i=_.char();continue;case".":if("-"!=(i=_.next_char())){syntax(1,"Misplaced dot");break}continue}break}if("]"==i){for(_.index++,f=parse_dur(_),n.nhd=n.notes.length-1,c=0;c<=n.nhd;c++)r=n.notes[c],r.dur=r.dur*f[0]/f[1];break}}n.dur_orig=n.notes[0].dur,n.dur=n.notes[0].dur*curvoice.dur_fact}if(n.grace&&n.type!=C.NOTE)return void syntax(1,"Not a note in grace note sequence");if(n.notes){if(n.grace){var y=curvoice.key.k_bagpipe?8:4;for(c=0;c<=n.nhd;c++)n.notes[c].dur/=y;n.dur/=y,n.dur_orig/=y,e.stem&&(n.stem=e.stem)}else{switch(curvoice.pos.stm){case C.SL_ABOVE:n.stem=1;break;case C.SL_BELOW:n.stem=-1;break;case C.SL_HIDDEN:n.stemless=!0}if(n.dur*=t,p=curvoice.brk_rhythm){if(curvoice.brk_rhythm=0,u=curvoice.last_note,p>0){for(l=2*p-1,n.dur=n.dur*l/p,n.dur_orig=n.dur_orig*l/p,c=0;c<=n.nhd;c++)n.notes[c].dur=n.notes[c].dur*l/p;for(u.dur/=p,u.dur_orig/=p,c=0;c<=u.nhd;c++)u.notes[c].dur/=p}else{for(p=-p,l=2*p-1,n.dur/=p,n.dur_orig/=p,c=0;c<=n.nhd;c++)n.notes[c].dur/=p;for(u.dur=u.dur*l/p,u.dur_orig=u.dur_orig*l/p,c=0;c<=u.nhd;c++)u.notes[c].dur=u.notes[c].dur*l/p}for(curvoice.time=u.time+u.dur,$=identify_note(u,u.dur_orig),u.head=$[0],u.dots=$[1],u.nflags=$[2],u.nflags<=-2?u.stemless=!0:delete u.stemless,u=u.next;u;u=u.next)u.time=curvoice.time}}n.type==C.NOTE?($=identify_note(n,n.dur_orig),n.head=$[0],n.dots=$[1],n.nflags=$[2],n.nflags<=-2&&(n.stemless=!0)):(d=n.dur_orig,d==curvoice.wmeasure&&(d=d<2*C.BLEN?C.BLEN:d<4*C.BLEN?2*C.BLEN:4*C.BLEN),$=identify_note(n,d),n.head=$[0],n.dots=$[1],n.nflags=$[2]),curvoice.last_note=n}if(sym_link(n),n.type==C.NOTE&&(curvoice.vtransp&&note_transp(n),curvoice.map&&maps[curvoice.map]))for(c=0;c<=n.nhd;c++)set_map(n.notes[c]);return cfmt.shiftunison&&(n.shiftunison=cfmt.shiftunison),e||(curvoice.lyric_restart||(curvoice.lyric_restart=n),curvoice.sym_restart||(curvoice.sym_restart=n)),m&&deco_cnv(m,n,n.prev),parse.stemless&&(n.stemless=!0),n.iend=parse.bol+_.index,n}function parse_music_line(){function e(e){var t,r,n;for(t=1,r=h.index+1;t<e.length;t++,r++)if(e[t]!=h.buffer[r]){if("n"!=e[t])return;if((n=ntb.indexOf(h.buffer[r]))<0)return;for(;"'"==h.buffer[r+1];)n+=7,r++;for(;","==h.buffer[r+1];)n-=7,r++}return h.index=r,n}function t(e,t){var r,n,a="",s=e.length;for(i=0;i<s;i++)if((r=e[i])>="h"&&r<="z"){for(n=t+r.charCodeAt(0)-"n".charCodeAt(0),r="";n<0;)n+=7,r+=",";for(;n>14;)n-=7,r+="'";a+=ntb[n]+r}else a+=r;return a}function r(e,r){var a=h,i=parse.istart;parse.line=h=new scanBuf,parse.istart+=a.index,h.buffer=r?t(e,r):e,n(!0),parse.line=h=a,parse.istart=i}function n(t){for(var n,i,l,_,m,y,g,v,b;;){if(!(n=h.char()))break;if("."==n)switch(h.buffer[h.index+1]){case"(":case"-":case"|":n=h.next_char()}if((i=n.charCodeAt(0))>=128){syntax(1,errs.not_ascii),h.index++;break}if(!t&&maci[i]){v=0;for(_ in mac)if(mac.hasOwnProperty(_)&&_[0]==n){if(_.indexOf("n")<0){if(h.buffer.indexOf(_,h.index)!=h.index)continue;h.index+=_.length}else if(!(v=e(_)))continue;r(mac[_],v),v=1;break}if(v)continue}switch(l=char_tb[i],l[0]){case" ":m=curvoice.last_note,m&&(m.beam_end=!0,a&&(a.gr_shift=!0));break;case"\n":if(cfmt.barsperstaff)break;0==par_sy.voices[curvoice.v].range&&curvoice.last_sym&&(curvoice.last_sym.eoln=!0);break;case"&":if(a){syntax(1,errs.bad_char,n);break}if(")"==(n=h.next_char())){get_vover(")");break}get_vover("&");continue;case"(":if((n=h.next_char())>"0"&&n<="9"){var x=h.get_int(),w=qplet_tb[x],A=x,n=h.char();if(":"==n&&(n=h.next_char(),n>"0"&&n<="9"&&(w=h.get_int(),n=h.char()),":"==n)){if(!((n=h.next_char())>"0"&&n<="9")){syntax(1,"Invalid 'r' in tuplet");continue}A=h.get_int(),n=h.char()}0!=w&&void 0!=w||(w=curvoice.wmeasure%9==0?3:2),u=f[++$],u||(f[$]=u={}),u.p=x,u.q=w,u.r=A,u.f=cfmt.tuplets,u.fact=p*w/x,p=u.fact;continue}if("&"==n){if(a){syntax(1,errs.bad_char,n);break}get_vover("(");break}d<<=4,h.index--,d+=parse_vpos();continue;case")":if(curvoice.ignore)break;if(m=curvoice.last_sym)switch(m.type){case C.NOTE:case C.REST:case C.SPACE:break;default:m=null}if(!m){syntax(1,errs.bad_char,n);break}m.slur_end?m.slur_end++:m.slur_end=1;break;case"!":if(a_dcn||(a_dcn=[]),l.length>1)y=l.slice(1,-1);else{for(y="",g=h.index;;){if(!(n=h.next_char()))break;if("!"==n)break;y+=n}if(!n){h.index=g,syntax(1,"No end of decoration");break}}ottava[y]&&set_ottava(y),a_dcn.push(y);break;case'"':parse_gchord(l);break;case"-":var k=0;if(!curvoice.last_note||curvoice.last_note.type!=C.NOTE){syntax(1,"No note before '-'");break}for(k=parse_vpos(),m=curvoice.last_note,g=0;g<=m.nhd;g++)m.notes[g].ti1?0==m.nhd&&syntax(1,"Too many ties"):m.notes[g].ti1=k;m.ti1=!0,a&&(a.ti1=!0);continue;case"[":var E=h.buffer[h.index+1];if('|[]: "'.indexOf(E)>=0||E>="1"&&E<="9"){if(a){syntax(1,errs.bar_grace);break}new_bar();continue}if(":"==h.buffer[h.index+2]){if((g=h.buffer.indexOf("]",h.index+1))<0){syntax(1,"Lack of ']'");break}b=h.buffer.slice(h.index+3,g).trim(),parse.istart=parse.bol+h.index,parse.iend=parse.bol+ ++g,h.index=0,do_info(E,b),h.index=g;continue}case"n":if(!(m=new_note(a,p)))continue;if(m.type==C.NOTE&&d&&(m.slur_start=d,d=0),a){$>=0&&(m.in_tuplet=!0);continue}$>=0&&m.notes&&(m.in_tuplet=!0,$>0?(f[0].p&&(m.tp0=f[0].p,m.tq0=f[0].q,m.tf=f[0].f,f[0].p=0),f[0].r--,u.p&&(m.tp1=u.p,m.tq1=u.q,m.tf=u.f,u.p=0)):u.p&&(m.tp0=u.p,m.tq0=u.q,m.tf=u.f,u.p=0),0==--u.r&&(0==$--?(m.te0=!0,p=1,curvoice.time=Math.round(curvoice.time),m.dur=curvoice.time-m.time):(m.te1=!0,u=f[0],0==u.r?($--,m.te0=!0,p=1,curvoice.time=Math.round(curvoice.time),m.dur=curvoice.time-m.time):p=u.fact)));continue;case"<":if(!curvoice.last_note){syntax(1,"No note before '<'");break}if(a){syntax(1,"Cannot have a broken rhythm in grace notes");break}for(v="<"==n?1:-1;"<"==n||">"==n;)v*=2,n=h.next_char();curvoice.brk_rhythm=v;continue;case"i":break;case"{":if(a){syntax(1,"'{' in grace note");break}switch(s=curvoice.last_note,curvoice.last_note=null,o=a_dcn,a_dcn=void 0,a={type:C.GRACE,fname:parse.fname,istart:parse.bol+h.index,dur:0,multi:0},curvoice.pos.gst){case C.SL_ABOVE:a.stem=1;break;case C.SL_BELOW:a.stem=-1;break;case C.SL_HIDDEN:a.stem=2}if(sym_link(a),"/"==(n=h.next_char())){a.sappo=!0;break}continue;case"|":if(a){syntax(1,errs.bar_grace);break}n=h.buffer[h.index-1],new_bar(),"."==n&&(curvoice.last_sym.bar_dotted=!0);continue;case"}":if(m=curvoice.last_note,!a||!m){syntax(1,errs.bad_char,n);break}if(a_dcn&&syntax(1,"Decoration ignored"),m.gr_end=!0,a.extra=a.next,a.extra.prev=null,a.next=null,curvoice.last_sym=a,a=null,!m.prev&&!curvoice.key.k_bagpipe){for(g=0;g<=m.nhd;g++)m.notes[g].dur*=2;m.dur*=2,m.dur_orig*=2;var S=identify_note(m,m.dur_orig);m.head=S[0],m.dots=S[1],m.nflags=S[2]}curvoice.last_note=s,a_dcn=o;break;case"\\":if(!(n=h.buffer[h.index+1])){c=!0;break}default:syntax(1,errs.bad_char,n)}h.index++}}var a,s,o,c,l,u,f=[],$=-1,p=1,d=0,h=parse.line;if(3!=parse.state){if(2!=parse.state)return;goto_tune()}if(n(),$>=0)for(syntax(1,"No end of tuplet"),l=curvoice.last_note;l;l=l.prev)if(l.tp1&&(l.tp1=0),l.tp0){l.tp0=0;break}a&&(syntax(1,"No end of grace note sequence"),curvoice.last_sym=a.prev,curvoice.last_note=s,a.prev&&(a.prev.next=null)),cfmt.breakoneoln&&curvoice.last_note&&(curvoice.last_note.beam_end=!0),c||cfmt.barsperstaff||"\n"==char_tb["\n".charCodeAt(0)]&&0==par_sy.voices[curvoice.v].range&&curvoice.last_sym&&(curvoice.last_sym.eoln=!0)}function cwid(e){var t=e.charCodeAt(0);if(t>=128){if(t>=768&&t<880)return 0;t=97}return cw_tb[t]}function strwh(e){var t,r,n,a=gene.curfont,i=a.swfac,s=a.size,o=0,c=e.length;for(t=0;t<c;t++){switch(n=e[t]){case"$":if("0"==(n=e[t+1]))a=gene.deffont;else{if(!(n>="1"&&n<="9")){n="$";break}a=get_font("u"+n)}t++,i=a.swfac,a.size>s&&(s=a.size);continue;case"&":r=e.indexOf(";",t),r>0&&r-t<10&&(t=r,n="a")}o+=cwid(n)*i}return gene.curfont=a,[o,s]}function set_font(e){"string"==typeof e&&(e=get_font(e)),gene.curfont=gene.deffont=e}function out_str(e){var t,r=gene.curfont,n=r;output+=e.replace(/<|>|&.*?;|&|  |\$./g,function(e){switch(e[0]){case"<":return"&lt;";case">":return"&gt;";case"&":return"&"==e?"&amp;":e;case" ":return" ";case"$":if("0"==e[1])t=gene.deffont,use_font(t);else{if(!(e[1]>="1"&&e[1]<="9"))return e;t=get_font("u"+e[1])}return e="",t==n?e:(n!=r&&(e="</tspan>"),n=t,n==r?e:e+'<tspan\n\tclass="'+font_class(t)+'">')}}),n!=r&&(output+="</tspan>",gene.curfont=n)}function xy_str(e,t,r,n,a){switch(t+=.2*strwh(r)[1],output+='<text class="'+font_class(gene.curfont)+'" x="',out_sxsy(e,'" y="',t),n){case"c":output+='" text-anchor="middle">';break;case"j":output+='" textLength="'+a.toFixed(2)+'">';break;case"r":output+='" text-anchor="end">';break;default:output+='">'}out_str(r),output+="</text>\n"}function xy_str_b(e,t,r){var n=strwh(r);output+='<rect class="stroke" x="',out_sxsy(e-2,'" y="',t+n[1]+1),output+='" width="'+(n[0]+4).toFixed(2)+'" height="'+(n[1]+3).toFixed(2)+'"/>\n',xy_str(e,t,r)}function trim_title(e,t){
var r;return cfmt.titletrim&&(r=e.lastIndexOf(", "),r<0||e[r+2]<"A"||e[r+2]>"Z"?r=0:1==cfmt.titletrim?(r<e.length-7||e.indexOf(" ",r+3)>=0)&&(r=0):r<e.length-cfmt.titletrim-2&&(r=0)),!t&&cfmt.writefields.indexOf("X")>=0&&(e=info.X+".  "+e),r&&(e=e.slice(r+2).trim()+" "+e.slice(0,r)),cfmt.titlecaps?e.toUpperCase():e}function get_lwidth(){return(img.width-img.lm-img.rm-2)/cfmt.scale}function write_title(e,t){var r;e&&(set_page(),e=trim_title(e,t),t?(set_font("subtitle"),r=cfmt.subtitlespace):(set_font("title"),r=cfmt.titlespace),vskip(strwh(e)[1]+r),cfmt.titleleft?xy_str(0,0,e):xy_str(get_lwidth()/2,0,e,"c"))}function put_inf2r(e,t,r,n,a){if(!r){if(!n)return;r=n,n=null}n?xy_str(e,t,r+" ("+n+")",a):xy_str(e,t,r,a)}function str_skip(e){vskip(strwh(e)[1]*cfmt.lineskipfac)}function write_text(e,t){if("s"!=t){set_font("text"),set_page();var r,n,a,i,s,o,c,l,u=get_lwidth(),f=gene.curfont.size,$=f*cfmt.lineskipfac,p=f*cfmt.parskipfac,d=block.started?function(){}:blk_out,h=block.started?svg_flush:blk_flush;switch(d(),t){default:switch(t){case"c":a=u/2;break;case"r":a=u;break;default:a=0}for(n=0;;){if((r=e.indexOf("\n",n))<0){l=e.slice(n),str_skip(l),xy_str(a,0,l,t);break}if(r==n){for(vskip(p),h(),use_font(gene.curfont);"\n"==e[r+1];)vskip($),r++;if(r==e.length)break;d()}else l=e.slice(n,r),str_skip(l),xy_str(a,0,l,t);n=r+1}vskip(p),h();break;case"f":case"j":for(n=0;;){for(r=e.indexOf("\n\n",n),i=r<0?e.slice(n):e.slice(n,r),i=i.split(/\s+/),s=o=0,n=0;n<i.length;n++)c=strwh(i[n]+" ")[0],(s+=c)>=u&&(l=i.slice(o,n).join(" "),str_skip(l),xy_str(0,0,l,t,u),o=n,s=c);if(0!=s&&(l=i.slice(o).join(" "),str_skip(l),xy_str(0,0,l)),vskip(p),h(),r<0)break;for(;"\n"==e[r+2];)vskip($),r++;if(r==e.length)break;d(),use_font(gene.curfont),n=r+2}}}}function put_words(e){function t(e,t,r){var n,a,i=0;if("$"==e[i]&&e[i+1]>="0"&&e[i+1]<="9"&&(i+=2),a=0,n=i,e[i]>="0"&&e[i]<="9"||"."==e[i+1]){for(;i<e.length&&(i++," "!=e[i]&&":"!=e[i-1]&&"."!=e[i-1]););for(a=i;" "==e[i];)i++}return 0!=a&&xy_str(t,0,e.slice(n,a),"r"),i<e.length&&xy_str(t+5,0,e.slice(i),"l"),i>=e.length&&0==a}var r,n,a,i,s,o,c,l;blk_out(),set_font("words");var u=get_lwidth()/2,f=(u-45)/(cwid("a")*gene.curfont.swfac);for(i=0,e=e.split("\n"),s=e.length,n=0;n<s;n++){if(r=e[n],r.length>f){i=0;break}r?l=!0:l&&(i++,l=!1)}if(i>0){for(n=i=(i+1)/2|0,l=!1,c=0;c<s;c++){for(r=e[c],a=0;" "==r[a];)a++;if(a==r.length){if(l&&--n<=0)break;l=!1}else l=!0}o=c+1}else o=c=s;for(vskip(cfmt.wordsspace),n=0;n<c||o<s;n++)n<c&&0==e[n].length&&(blk_out(),use_font(gene.curfont)),vskip(cfmt.lineskipfac*gene.curfont.size),n<c&&t(e[n],45,0),o<s&&(t(e[o],20+u,1)&&0==--i&&(n<c?i++:o<e.length-1&&(u*=.6)),o++)}function put_history(){var e,t,r,n,a,i,s,o,c=cfmt.infoname.split("\n"),l=c.length;for(e=0;e<l;e++)if(r=c[e][0],!(cfmt.writefields.indexOf(r)<0)&&(n=info[r])){for(a||(a=!0,set_font("history"),vskip(cfmt.textspace),i=gene.curfont.size*cfmt.lineskipfac),o=c[e].slice(2),'"'==o[0]&&(o=o.slice(1,-1)),vskip(i),xy_str(0,0,o),s=strwh(o)[0],n=n.split("\n"),xy_str(s,0,n[0]),t=1;t<n.length;t++)vskip(i),xy_str(s,0,n[t]);vskip(.3*i),blk_out(),use_font(gene.curfont)}}function write_headform(e){for(var t,r,n,a,i,s,o,c={},l=clone(info_font_init),u={A:cfmt.infospace,C:cfmt.composerspace,O:cfmt.composerspace,R:cfmt.infospace},f={},$="",p=cfmt.titleformat,d=0,h=0;;){for(;" "==p[h];)h++;if(h>=p.length)break;if((t=p[h++])<"A"||t>"Z")if("+"==t){if(0==$.length||"+"==$.slice(-1))continue;$=$.slice(0,-1)+"+"}else","==t&&("+"==$.slice(-1)&&($=$.slice(0,-1)+"l"),$+="\n");else{if(c[t])f[t]++;else{if(!info[t])continue;c[t]=info[t].split("\n"),f[t]=1}switch($+=t,p[h]){case"-":$+="l",h++;break;case"0":$+="c",h++;break;case"1":$+="r",h++;break;default:$+="c"}}}"+"==$.slice(-1)&&($=$.slice(0,-1)+"l"),$+="\n";var _,m={l:cfmt.titlespace,c:cfmt.titlespace,r:cfmt.titlespace},y={l:0,c:.5*e,r:e},g={};for(p=$,h=0;;){for(g.l=g.c=g.r=s=0,d=h;;){if("\n"==(t=p[d++]))break;if("+"==(a=p[d++]))a=p[d+1];else if(0!=g[a])continue;_=c[t],_&&(n=l[t],n||(n="history"),r=get_font(n),o=1.1*r.size,u[t]&&(o+=u[t]),s<o&&(s=o),g[a]=o)}for(m.l+=s-g.l,m.c+=s-g.c,m.r+=s-g.r;;){if("\n"==(t=p[h++]))break;if(a=p[h++],0!=c[t].length){if(_=c[t].shift(),"+"==a&&(f[t]--,t=p[h++],a=p[h++],c[t].length>0&&(_?_+=" "+c[t].shift():_=" "+c[t].shift())),n=l[t],n||(n="history"),r=get_font(n),o=1.1*r.size,u[t]&&(o+=u[t]),set_font(r),i=y[a],s=m[a]+o,"Q"==t){if(!glovar.tempo.del){if("l"!=a){var v=tempo_width(glovar.tempo);"c"==a&&(v*=.5),i-=v}write_tempo(glovar.tempo,i,-s)}}else _&&xy_str(i,-s,_,a);if("T"==t&&(n=l.T="subtitle",u.T=cfmt.subtitlespace),f[t]<=1)for("T"==t&&(r=get_font(n),o=1.1*r.size,u[t]&&(o+=u[t]),set_font(r));c[t].length>0;)s+=o,_=c[t].shift(),xy_str(i,-s,_,a);f[t]--,m[a]=s}}if(m.c>m.l&&(m.l=m.c),m.r>m.l&&(m.l=m.r),h>=$.length)break;m.c=m.r=m.l}vskip(m.l)}function write_heading(){var e,t,r,n,a,i,s,o,c=get_lwidth();if(blk_out(),vskip(cfmt.topspace),cfmt.titleformat)return write_headform(c),void vskip(cfmt.musicspace);if(info.T&&cfmt.writefields.indexOf("T")>=0)for(e=0;;){if((t=info.T.indexOf("\n",e))<0){write_title(info.T.substring(e),0!=e);break}write_title(info.T.slice(e,t),0!=e),e=t+1}if(set_font("composer"),s=o=0,parse.ckey.k_bagpipe&&!cfmt.infoline&&cfmt.writefields.indexOf("R")>=0&&(i=info.R),i&&(xy_str(0,-cfmt.composerspace,i),s=cfmt.composerspace),r=info.A,cfmt.writefields.indexOf("C")>=0&&(n=info.C),cfmt.writefields.indexOf("O")>=0&&(a=info.O),n||a||cfmt.infoline){var l,u;if(vskip(cfmt.composerspace),cfmt.aligncomposer<0?(l=0,u=" "):0==cfmt.aligncomposer?(l=.5*c,u="c"):(l=c,u="r"),o=s,n||a){for(cfmt.aligncomposer>=0&&s!=o&&vskip(s-o),e=0;;){if(vskip(gene.curfont.size),(t=n?n.indexOf("\n",e):-1)<0){put_inf2r(l,0,n?n.substring(e):null,a,u);break}xy_str(l,0,n.slice(e,t),u),s+=gene.curfont.size,e=t+1}o>s&&vskip(o-s)}i=i?null:info.R,(i||r)&&cfmt.infoline&&(set_font("info"),vskip(gene.curfont.size+cfmt.infospace),put_inf2r(c,0,i,r,"r"),s+=gene.curfont.size+cfmt.infospace)}else o=cfmt.composerspace;info.P&&cfmt.writefields.indexOf("P")>=0&&(set_font("parts"),s=cfmt.partsspace+gene.curfont.size-s,s>0&&(o+=s),o>.01&&vskip(o),xy_str(0,0,info.P),o=0),vskip(o+cfmt.musicspace)}function def_use(e){var t,r,n;if(!defined_glyph[e]){if(defined_glyph[e]=!0,!(n=glyphs[e]))return void error(1,null,"Unknown glyph: '$1'",e);for(r=0;;){if((t=n.indexOf('xlink:href="#',r))<0)break;t+=13,r=n.indexOf('"',t),def_use(n.slice(t,r))}defs+="\n"+n}}function defs_add(e){var t,r,n,a,i,s=0;for(e=e.replace(/<!--.*?-->/g,"");;){if((i=e.indexOf("<",s))<0)break;if((t=e.indexOf('id="',i))<0)break;if(t+=4,(r=e.indexOf('"',t))<0)break;if(n=e.slice(t,r),(s=e.indexOf(">",r))<0)break;if("/"==e[s-1])s++;else{if((t=e.indexOf(" ",i))<0)break;if(a=e.slice(i+1,t),(s=e.indexOf("</"+a+">",s))<0)break;s+=3+a.length}"<filter"==e.substr(i,7)?fulldefs+="\n"+e.slice(i,s):glyphs[n]=e.slice(i,s)}}function set_g(){stv_g.started&&(stv_g.started=!1,output+="</g>\n"),(1!=stv_g.scale||stv_g.color)&&(output+="<g ",1!=stv_g.scale&&(stv_g.st>=0?output+=staff_tb[stv_g.st].scale_str:output+=voice_tb[stv_g.v].scale_str),stv_g.color&&(1!=stv_g.scale&&(output+=" "),output+='style="color:'+stv_g.color+'"'),output+=">\n",stv_g.started=!0)}function set_color(e){if(e!=stv_g.color){var t=stv_g.color;return stv_g.color=e,set_g(),t}}function set_sscale(e){var t,r;e!=stv_g.st&&1!=stv_g.scale&&(stv_g.scale=0),t=e>=0?staff_tb[e].staffscale:1,r=e>=0&&1!=t?staff_tb[e].y:posy,t==stv_g.scale&&r==stv_g.dy||(stv_g.scale=t,stv_g.dy=r,stv_g.st=e,set_g())}function set_scale(e){var t=e.p_v.scale;if(1==t)return void set_sscale(e.st);t==stv_g.scale&&stv_g.dy==posy||(stv_g.scale=t,stv_g.dy=posy,stv_g.st=-1,stv_g.v=e.v,set_g())}function set_dscale(e,t){output&&(stv_g.st<0?staff_tb[0].output+=output:1==stv_g.scale?staff_tb[stv_g.st].output+=output:staff_tb[stv_g.st].sc_out+=output,output=""),stv_g.scale=e<0?1:t?1:staff_tb[e].staffscale,stv_g.st=e,stv_g.dy=0}function delayed_update(){var e;for(e=0;e<=nstaff;e++)staff_tb[e].sc_out&&(output+='<g transform="translate(0,'+(posy-staff_tb[e].y).toFixed(2)+") scale("+staff_tb[e].staffscale.toFixed(2)+')">\n'+staff_tb[e].sc_out+"</g>\n",staff_tb[e].sc_out=""),staff_tb[e].output&&(output+='<g transform="translate(0,'+(-staff_tb[e].y).toFixed(2)+')">\n'+staff_tb[e].output+"</g>\n",staff_tb[e].output="")}function anno_out(e,t,r){if(void 0!=e.istart){var n=e.type,a=e.ymx-e.ymn+4,i=e.wl||2,s=e.wr||2;e.grace&&(n=C.GRACE),r(t||anno_type[n],e.istart,e.iend,e.x-i-2,staff_tb[e.st].y+e.ymn+a-2,i+s+4,a,e)}}function a_start(e,t){anno_out(e,t,user.anno_start)}function a_stop(e,t){anno_out(e,t,user.anno_stop)}function empty_function(){}function out_XYAB(e,t,r,n,a){t=sx(t),r=sy(r),output+=e.replace(/X|Y|A|B|F|G/g,function(e){switch(e){case"X":return t.toFixed(2);case"Y":return r.toFixed(2);case"A":return n;case"B":return a;case"F":return n.toFixed(2);default:return a.toFixed(2)}})}function g_open(e,t,r,n,a){out_XYAB('<g transform="translate(X,Y',e,t),r&&(output+=") rotate("+r.toFixed(2)),n&&(output+=a?") scale("+n.toFixed(2)+", "+a.toFixed(2):") scale("+n.toFixed(2)),output+=')">\n',stv_g.g++}function g_close(){stv_g.g--,output+="</g>\n"}function sx(e){return stv_g.g?e:(e+posx)/stv_g.scale}function sy(e){return stv_g.g?e:1==stv_g.scale?posy-e:stv_g.st<0?(posy-e)/stv_g.scale:stv_g.dy-e}function out_sxsy(e,t,r){e=sx(e),r=sy(r),output+=e.toFixed(2)+t+r.toFixed(2)}function xypath(e,t,r){out_XYAB('<path class="A" d="mX Y\n',e,t,r?"fill":"stroke")}function xygl(e,t,r){var n=tgls[r];return n&&!glyphs[r]?(e+=n.x*stv_g.scale,t+=n.y,void(n.sc?out_XYAB('<text transform="translate(X,Y) scale(F)">B</text>\n',e,t,n.sc,n.c):out_XYAB('<text x="X" y="Y">A</text>\n',e,t,n.c))):glyphs[r]?(def_use(r),void out_XYAB('<use x="X" y="Y" xlink:href="#A"/>\n',e,t,r)):void error(1,null,"no definition of $1",r)}function out_acciac(e,t,r,n,a){a?(e-=1,t+=4):(e-=5,t-=4),out_XYAB('<path class="stroke" d="mX YlF G"/>\n',e,t,r,-n)}function out_bar(e,t,r,n){output+='<path class="stroke" stroke-width="1" '+(n?'stroke-dasharray="5,5" ':"")+'d="m'+(e+posx).toFixed(2)+" "+(posy-t).toFixed(2)+"v"+(-r).toFixed(2)+'"/>\n'}function out_bnum(e,t,r){out_XYAB('<text style="font-family:serif; font-style:italic; font-size:12px"\n\tx="X" y="Y" text-anchor="middle">A</text>\n',e,t,r.toString())}function out_brace(e,t,r){e+=posx-6,t=posy-t,r/=24,output+='<text transform="translate('+e.toFixed(2)+","+t.toFixed(2)+") scale(2.5,"+r.toFixed(2)+')">'+tgls.brace.c+"</text>\n"}function out_bracket(e,t,r){e+=posx-5,t=posy-t-3,r+=2,output+='<path class="fill"\n\td="m'+e.toFixed(2)+" "+t.toFixed(2)+"\n\tc10.5 1 12 -4.5 12 -3.5c0 1 -3.5 5.5 -8.5 5.5\n\tv"+r.toFixed(2)+'\n\tc5 0 8.5 4.5 8.5 5.5c0 1 -1.5 -4.5 -12 -3.5"/>\n'}function out_hyph(e,t,r){var n,a=25+3*(r/20|0);n=r>15?(r-15)/a|0:0,e+=(r-a*n-5)/2,out_XYAB('<path class="stroke" stroke-width="1.2"\n\tstroke-dasharray="5,A"\n\td="mX YhB"/>\n',e,t+6,Math.round((a-5)/stv_g.scale),a*n+5)}function out_stem(e,t,r,n,a,i){var s=n?GSTEM_XOFF:3.5,o=-r;if(r<0&&(s=-s),e+=s*stv_g.scale,stv_g.st<0&&(o/=stv_g.scale),out_XYAB('<path class="stroke" d="mX YvF"/>\n',e,t,o),a){if(output+='<path class="fill"\n\td="',t+=r,r>0)if(i)if(n)for(;--a>=0;)out_XYAB("MX Yl3 1.5 0 2 -3 -1.5z\n",e,t),t-=3;else for(t+=1;--a>=0;)out_XYAB("MX Yl7 3.2 0 3.2 -7 -3.2z\n",e,t),t-=5.4;else if(n)if(1==a)out_XYAB("MX Yc0.6 3.4 5.6 3.8 3 10\n\t1.2 -4.4 -1.4 -7 -3 -7\n",e,t);else for(;--a>=0;)out_XYAB("MX Yc1 3.2 5.6 2.8 3.2 8\n\t1.4 -4.8 -2.4 -5.4 -3.2 -5.2\n",e,t),t-=3.5;else if(1==a)out_XYAB("MX Yc0.6 5.6 9.6 9 5.6 18.4\n\t1.6 -6 -1.3 -11.6 -5.6 -12.8\n",e,t);else for(;--a>=0;)out_XYAB("MX Yc0.9 3.7 9.1 6.4 6 12.4\n\t1 -5.4 -4.2 -8.4 -6 -8.4\n",e,t),t-=5.4;else if(i){if(!n)for(t+=1;--a>=0;)out_XYAB("MX Yl7 -3.2 0 -3.2 -7 3.2z\n",e,t),t+=5.4}else if(n)if(1==a)out_XYAB("MX Yc0.6 -3.4 5.6 -3.8 3 -10\n\t1.2 4.4 -1.4 7 -3 7\n",e,t);else for(;--a>=0;)out_XYAB("MX Yc1 -3.2 5.6 -2.8 3.2 -8\n\t1.4 4.8 -2.4 5.4 -3.2 5.2\n",e,t),t+=3.5;else if(1==a)out_XYAB("MX Yc0.6 -5.6 9.6 -9 5.6 -18.4\n\t1.6 6 -1.3 11.6 -5.6 12.8\n",e,t);else for(;--a>=0;)out_XYAB("MX Yc0.9 -3.7 9.1 -6.4 6 -12.4\n\t1 5.4 -4.2 8.4 -6 8.4\n",e,t),t+=5.4;output+='"/>\n'}}function out_thbar(e,t,r){e+=posx+1.5,t=posy-t,output+='<path class="stroke" stroke-width="3" d="m'+e.toFixed(2)+" "+t.toFixed(2)+"v"+(-r).toFixed(2)+'"/>\n'}function out_trem(e,t,r){for(out_XYAB('<path class="fill" d="mX Y\n\t',e-4.5,t);;){if(output+="l9 -3v3l-9 3z",--r<=0)break;output+="m0 5.4"}output+='"/>\n'}function out_tubr(e,t,r,n,a){var i=a?-3:3;t+=i,r/=stv_g.scale,output+='<path class="stroke" d="m',out_sxsy(e," ",t),output+="v"+i.toFixed(2)+"l"+r.toFixed(2)+" "+(-n).toFixed(2)+"v"+(-i).toFixed(2)+'"/>\n'}function out_tubrn(e,t,r,n,a,i){var s=10*i.length,o=a?-3:3;out_XYAB('<text style="font-family:serif; font-style:italic; font-size:12px"\n\tx="X" y="Y" text-anchor="middle">A</text>\n',e+r/2,t+n/2,i),r/=stv_g.scale,a||(t+=6),output+='<path class="stroke" d="m',out_sxsy(e," ",t),output+="v"+o.toFixed(2)+"m"+r.toFixed(2)+" "+(-n).toFixed(2)+"v"+(-o).toFixed(2)+'"/>\n<path class="stroke" stroke-dasharray="'+((r-s)/2).toFixed(2)+" "+s.toFixed(2)+'" d="m',out_sxsy(e," ",t-o),output+="l"+r.toFixed(2)+" "+(-n).toFixed(2)+'"/>\n'}function out_wln(e,t,r){out_XYAB('<path class="stroke" stroke-width="0.8" d="mX YhF"/>\n',e,t+3,r)}function out_deco_str(e,t,r,n){var a=deco_str_style[r];if(!a)return void xygl(e,t,r);e+=a.dx,t+=a.dy,a.def||(style+="\n."+r+" {"+a.style+"}",a.def=!0),out_XYAB('<text x="X" y="Y" class="A"B>',e,t,r,a.anchor||""),set_font("annotation"),out_str(n),output+="</text>\n"}function out_arp(e,t,r){for(g_open(e,t,270),e=0,t=-4,r=Math.ceil(r/6);--r>=0;)xygl(e,t,"ltr"),e+=6;g_close()}function out_cresc(e,t,r,n){e+=r,r=-r,out_XYAB('<path class="stroke"\n\td="mX YlA ',e,t+5,r),n.nost?output+="-2.2m0 -3.6l"+(-r).toFixed(2)+' -2.2"/>\n':output+="-4l"+(-r).toFixed(2)+' -4"/>\n'}function out_dim(e,t,r,n){out_XYAB('<path class="stroke"\n\td="mX YlA ',e,t+5,r),n.noen?output+="-2.2m0 -3.6l"+(-r).toFixed(2)+' -2.2"/>\n':output+="-4l"+(-r).toFixed(2)+' -4"/>\n'}function out_ltr(e,t,r){for(t+=4,r=Math.ceil(r/6);--r>=0;)xygl(e,t,"ltr"),e+=6}function out_8va(e,t,r,n){n.nost?r-=5:(out_XYAB('<text x="X" y="Y" style="font-family:serif; font-weight:bold; font-style:italic; font-size:12px">8<tspan dy="-4" style="font-size:10px">va</tspan></text>\n',e-8,t),e+=12,r-=12),t+=6,out_XYAB('<path class="stroke" stroke-dasharray="6,6" d="mX YhA"/>\n',e,t,r),n.noen||out_XYAB('<path class="stroke" d="mX Yv6"/>\n',e+r,t)}function out_8vb(e,t,r,n){n.nost?r-=5:(out_XYAB('<text x="X" y="Y" style="font-family:serif; font-weight:bold; font-style:italic; font-size:12px">8<tspan dy="-4" style="font-size:10px">vb</tspan></text>\n',e-8,t),e+=4,r-=4),out_XYAB('<path class="stroke" stroke-dasharray="6,6" d="mX YhA"/>\n',e,t,r),n.noen||out_XYAB('<path class="stroke" d="mX Yv-6"/>\n',e+r,t)}function out_15ma(e,t,r,n){n.nost?r-=5:(out_XYAB('<text x="X" y="Y" style="font-family:serif; font-weight:bold; font-style:italic; font-size:12px">15<tspan dy="-4" style="font-size:10px">ma</tspan></text>\n',e-10,t),e+=20,r-=20),t+=6,out_XYAB('<path class="stroke" stroke-dasharray="6,6" d="mX YhA"/>\n',e,t,r),n.noen||out_XYAB('<path class="stroke" d="mX Yv6"/>\n',e+r,t)}function out_15mb(e,t,r,n){n.nost?r-=5:(out_XYAB('<text x="X" y="Y" style="font-family:serif; font-weight:bold; font-style:italic; font-size:12px">15<tspan dy="-4" style="font-size:10px">mb</tspan></text>\n',e-10,t),e+=7,r-=7),out_XYAB('<path class="stroke" stroke-dasharray="6,6" d="mX YhA"/>\n',e,t,r),n.noen||out_XYAB('<path class="stroke" d="mX Yv-6"/>\n',e+r,t)}function out_deco_val(e,t,r,n,a){deco_val_tb[r]?deco_val_tb[r](e,t,n,a):error(1,null,"No function for decoration '$1'",r)}function out_glisq(e,t,r){var n=r.start,a=n.x,i=n.y+staff_tb[n.st].y,s=-Math.atan2(t-i,e-a),o=s/Math.PI*180,c=(e-a)/Math.cos(s);for(g_open(a,i,o),a=n.s.dots?13+n.s.xmx:8,c=(c-a-6)/6|0,c<1&&(c=1);--c>=0;)xygl(a,0,"ltr"),a+=6;g_close()}function out_gliss(e,t,r){var n=r.start,a=n.x,i=n.y+staff_tb[n.st].y,s=-Math.atan2(t-i,e-a),o=s/Math.PI*180,c=(e-a)/Math.cos(s);g_open(a,i,o),a=n.s.dots?13+n.s.xmx:8,c-=a+8,xypath(a,0),output+="l"+c.toFixed(2)+' 0" stroke-width="1"/>\n',g_close()}function out_deco_long(e,t,r){var n=r.dd.glyph;deco_l_tb[n]?deco_l_tb[n](e,t,r):error(1,null,"No function for decoration '$1'",n)}function vskip(e){posy+=e}function svg_flush(){if(!multicol&&output&&user.img_out&&0!=posy){var e='<svg xmlns="http://www.w3.org/2000/svg" version="1.1"\n\txmlns:xlink="http://www.w3.org/1999/xlink"\n\tcolor="black" class="music" stroke-width=".7"',t="";cfmt.bgcolor&&(e+=' style="background-color: '+cfmt.bgcolor+'"'),posy*=cfmt.scale,user.imagesize?e+="\n"+user.imagesize+' viewBox="0 0 '+img.width.toFixed(0)+" "+posy.toFixed(0)+'">\n':e+='\n\twidth="'+img.width.toFixed(0)+'px" height="'+posy.toFixed(0)+'px">\n',(style||font_style||musicfont)&&(e+='<style type="text/css">'+style+font_style,musicfont&&(musicfont.indexOf("(")>0?e+="\n.music {font-family: music; font-size: 24px; fill: currentColor}\n@font-face {\n  font-family: music;\n  src: "+musicfont+"}":e+="\n.music {font-family: "+musicfont+"; font-size: 24px; fill: currentColor}"),e+="\n</style>\n"),defs+=fulldefs,defs&&(e+="<defs>"+defs+"\n</defs>\n"),1!=cfmt.scale&&(e+='<g class="g" transform="scale('+cfmt.scale.toFixed(2)+')">\n',t="</g>\n"),psvg&&psvg.ps_flush(!0),user.img_out(e+output+t+"</svg>"),output="",font_style="",cfmt.fullsvg?(defined_glyph={},defined_font={}):(musicfont="",style="",fulldefs=""),defs="",posy=0}}function blk_out(){!multicol&&user.img_out&&(blk_flush(),user.page_format&&!block.started&&(block.started=!0,block.newpage?(block.newpage=!1,user.img_out('<div class="nobrk newpage">')):user.img_out('<div class="nobrk">')))}function blk_flush(){svg_flush(),block.started&&(block.started=!1,user.img_out("</div>"))}function voice_filter(){var e,t,r;for(e in parse.voice_opts)if(parse.voice_opts.hasOwnProperty(e)&&(t=new RegExp(e),t.test(curvoice.id)||t.test(curvoice.nm)))for(r in parse.voice_opts[e])parse.voice_opts[e].hasOwnProperty(r)&&do_pscom(parse.voice_opts[e][r])}function sym_link(e){e.fname||set_ref(e),curvoice.ignore||(parse.last_sym=e,e.prev=curvoice.last_sym,curvoice.last_sym?curvoice.last_sym.next=e:curvoice.sym=e,curvoice.last_sym=e),e.v=curvoice.v,e.p_v=curvoice,e.st=curvoice.cst,e.time=curvoice.time,e.dur&&!e.grace&&(curvoice.time+=e.dur),e.pos=curvoice.pos,curvoice.second&&(e.second=!0),curvoice.floating&&(e.floating=!0)}function sym_add(e,t){var r,n={type:t,dur:0},a=curvoice;return curvoice=e,sym_link(n),curvoice=a,r=n.prev,r||(r=n.next),r&&(n.fname=r.fname,n.istart=r.istart,n.iend=r.iend),n}function mrest_expand(e){var t,r,n,a=e.nmes,i=e.dur/a,s=e.a_dd;for(e.type=C.REST,e.dur=i,e.head=C.FULL,e.nflags=-2,n=e.next,t=e.p_v,t.last_sym=e,t.time=e.time+i,t.cst=e.st,r=e;--a>0;)r=sym_add(t,C.BAR),r.bar_type="|",r=sym_add(t,C.REST),e.invis&&(r.invis=!0),r.dur=i,r.head=C.FULL,r.nflags=-2,t.time+=i;r.next=n,n&&(n.prev=r),r.a_dd=s}function sort_all(){var e,t,r,n,a,i,s,o,c,l,u,f,$=voice_tb.length,p=[],d=[],h=-1;for(t=0;t<$;t++)p.push(voice_tb[t].sym);for(var _=1,m=cur_sy;;){if(m&&_)for(f=m,m=null,s=-1,d=[],t=0;t<$;t++)f.voices[t]?(i=f.voices[t].range)<0||(d[i]=t,s++):f.voices[t]={range:-1};for(a=r=1e6,i=0;i<$&&void 0!=(t=d[i]);i++)!(e=p[t])||e.time>r||(n=w_tb[e.type],e.time<r?(r=e.time,a=n):n<a&&(a=n),e.type==C.MREST&&(1==e.nmes?mrest_expand(e):s>0&&(h=r)));if(a>127)break;if(r==h){for(c=0,i=0;i<$&&void 0!=(t=d[i]);i++)if((e=p[t])&&e.time==r&&w_tb[e.type]==a){if(e.type!=C.MREST){h=-1;break}if(0==c)c=e.nmes;else if(c!=e.nmes){h=-1;break}}if(h<0)for(i=0;i<$&&void 0!=(t=d[i]);i++)(e=p[t])&&e.type==C.MREST&&mrest_expand(e)}for(i=0;i<$&&void 0!=(t=d[i]);i++)if((e=p[t])&&e.time==r&&w_tb[e.type]==a){if(e.type==C.STAVES){for(m=e.sy,l=0;l<$&&void 0!=d[l];l++);for(u=0;u<$;u++)m.voices[u]&&((i=m.voices[u].range)<0||f.voices[u].range>=0||(d[l++]=u))}_&&(_=0,e.seqst=!0),e.ts_prev=o,o?o.ts_next=e:tsfirst=e,o=e,p[t]=e.next}_=a}}function voice_adj(){var e,t,r,n;for(t=glovar.tempo,t&&staves_found<=0&&(n=par_sy.top_voice,e=voice_tb[n],e.sym&&e.sym.type!=C.TEMPO&&(t=clone(t),t.v=n,t.p_v=e,t.st=e.st,t.time=0,t.next=e.sym,t.next&&(t.next.prev=t),e.sym=t)),n=0;n<voice_tb.length;n++){for(e=voice_tb[n],e.ignore&&(e.ignore=!1),t=e.sym;t&&!(t.time>=staves_found);t=t.next);for(;t;t=t.next){switch(t.type){case C.GRACE:if(t.next&&t.next.type==C.BAR&&t.time--,!cfmt.graceword)continue;for(r=t.next;r;r=r.next){switch(r.type){case C.SPACE:continue;case C.NOTE:if(!r.a_ly)break;t.a_ly=r.a_ly,r.a_ly=null}break}continue}t.feathered_beam&&function(e){var t,r,n,a,i,s,o,a=e.dur,c=1;for(t=e;t&&!t.beam_end&&t.next;t=t.next)c++;if(c<=1)return void delete e.feathered_beam;if(r=t,i=a/2,o=a/(c-1),n=e.time,e.feathered_beam>0)for(t=e,s=c-1;t!=r;t=t.next,s--)a=(o*s|0)+i,t.dur=a,t.time=n,n+=a;else for(t=e,s=0;t!=r;t=t.next,s++)a=(o*s|0)+i,t.dur=a,t.time=n,n+=a;t.dur=t.time+t.dur-n,t.time=n}(t)}}}function dupl_voice(){var e,t,r,n,a,i,s,o,c=voice_tb.length;for(s=0;s<c;s++)if(e=voice_tb[s],t=e.clone){for(e.clone=null,r=e.sym;r&&!(r.time>=staves_found);r=r.next);for(t.clef=clone(e.clef),curvoice=t;r;r=r.next)if(r.type!=C.STAVES){if(n=clone(r),r.notes)for(n.notes=[],o=0;o<=r.nhd;o++)n.notes.push(clone(r.notes[o]));if(sym_link(n),t.second?n.second=!0:delete n.second,t.floating?n.floating=!0:delete n.floating,delete n.a_ly,a=n.extra)for(i=clone(a),n.extra=i,n=i,n.v=t.v,n.p_v=t,n.st=t.st,a=a.next;a;a=a.next){if(i=clone(a),a.notes)for(i.notes=[],o=0;o<=a.nhd;o++)i.notes.push(clone(a.notes[o]));n.next=i,i.prev=n,n=i,n.v=t.v,n.p_v=t,n.st=t.st}}}}function new_syst(e){var t,r,n={voices:[],staves:[],top_voice:0};if(e)return void(cur_sy=par_sy=n);for(r=0;r<voice_tb.length;r++){t=par_sy.voices[r].st;var a=par_sy.staves[t],i=voice_tb[r];void 0!=i.staffnonote&&(a.staffnonote=i.staffnonote),i.staffscale&&(a.staffscale=i.staffscale),n.voices[r]=clone(par_sy.voices[r]),n.voices[r].range=-1,delete n.voices[r].second}for(t=0;t<par_sy.staves.length;t++)n.staves[t]=clone(par_sy.staves[t]),n.staves[t].flags=0;par_sy.next=n,par_sy=n}function set_bar_num(){var e,t,r,n,a,i,s=cur_sy.top_voice,o=voice_tb[s].meter.wmeasure,c=gene.nbar;for(e=tsfirst;;e=e.ts_next){if(!e)return;switch(e.type){case C.METER:o=e.wmeasure;case C.CLEF:case C.KEY:case C.STBRK:continue;case C.BAR:if(e.bar_num){gene.nbar=e.bar_num;break}e.text&&!cfmt.contbarnb&&("1"==e.text[0]?c=gene.nbar:(gene.nbar=c,e.bar_num=gene.nbar))}break}if(n=e.time+o,0==e.time)for(t=e.ts_next;t;t=t.ts_next)if(t.type==C.BAR&&t.time){t.time<n&&(e=t,n=e.time+o);break}for(a=gene.nbar;e;e=e.ts_next)switch(e.type){case C.METER:o=e.wmeasure,e.time<n&&(n=e.time+o);break;case C.MREST:for(a+=e.nmes-1;e.ts_next&&e.ts_next.type!=C.BAR;)e=e.ts_next;break;case C.BAR:if(e.bar_num&&(a=e.bar_num),e.time<n){e.text&&"1"==e.text[0]&&(c=a,i=n-e.time);break}r=e.time,t=e;do{if(t.dur)break;if(t.type==C.BAR&&t.text)break;t=t.next}while(t&&t.time==r);if(a++,t&&t.type==C.BAR&&t.text)if("1"==t.text[0])i=0,c=a;else if(cfmt.contbarnb||(a=c),i){cfmt.contbarnb&&a--,n=r+i;break}for(e.bar_num=a,n=r+o;e.ts_next&&!e.ts_next.seqst;)e=e.ts_next}cfmt.measurenb<0&&(gene.nbar=a)}function get_map(e){if(e){var t,r,n,a,i,s,o=info_split(e,2);if(o.length<3)return void syntax(1,"Not enough parameters in %%map");if(s=o[1],0==s.indexOf("octave,")||0==s.indexOf("key,"))s=s.replace(/[,']+$/m,"").toLowerCase(),"k"==s[0]&&(s=s.replace(/[_=^]+/,""));else if("*"==s[0]||0==s.indexOf("all"))s="all";else{if(i=new scanBuf,i.buffer=o[1],!(r=parse_acc_pit(i)))return void syntax(1,"Bad note in %%map");for(s="abcdefg"[(r.pit+77)%7],r.acc&&(s=["__","_","","^","^^","="][r.acc+2]+s),t=r.pit;t>=28;t-=7)s+="'";for(t=r.pit;t<21;t+=7)s+=","}if(n=maps[o[0]],n||(maps[o[0]]=n={}),a=n[s],a||(n[s]=a=[]),o[2]){if(t=2,o[2].indexOf("=")<0){if("*"!=o[2][0]&&(i=new scanBuf,i.buffer=o[2],a[1]=parse_acc_pit(i)),!o[3])return;t++,o[3].indexOf("=")<0&&(a[0]=o[3].split(","),t++)}for(;t<o.length;t++)switch(o[t]){case"heads=":a[0]=o[++t].split(",");break;case"print=":i=new scanBuf,i.buffer=o[++t],a[1]=parse_acc_pit(i);break;case"color=":a[2]=o[++t]}}}}function set_transp(){var e,t,r;if(!curvoice.ckey.k_bagpipe&&!curvoice.ckey.k_drum&&(cfmt.transp&&curvoice.transp&&syntax(0,"Mix of old and new transposition syntaxes"),t=(cfmt.transp||0)+(curvoice.transp||0)+(curvoice.shift||0),r=curvoice.vtransp||0,t!=r)){if(curvoice.vtransp=t,!(e=curvoice.last_sym))return curvoice.key=clone(curvoice.okey),key_transp(curvoice.key),curvoice.ckey=clone(curvoice.key),void(curvoice.key.k_none&&(curvoice.key.k_sf=0));for(;;){if(e.type==C.KEY)break;if(!e.prev){e=curvoice.key;break}e=e.prev}key_transp(e),curvoice.ckey=clone(e),curvoice.key.k_none&&(e.k_sf=0)}}function set_ottava(e){if(!cfmt.sound)switch(e){case"15ma(":curvoice.ottava=-14;break;case"8va(":curvoice.ottava=-7;break;case"8vb(":curvoice.ottava=7;break;case"15mb(":curvoice.ottava=14;break;case"15ma)":case"8va)":case"8vb)":case"15mb)":curvoice.ottava=0}}function do_pscom(e){var t,r,n,a,i,s,o,c,l=!1;if(" lock"==e.slice(-5)&&(l=!0,e=e.slice(0,-5).trim()),a=e.match(/(\w|-)+/)){switch(a=a[0],i=e.replace(a,"").trim(),a){case"center":return parse.state>=2?(n=new_block("text"),n.text=cnv_escape(i),void(n.opt="c")):void write_text(cnv_escape(i),"c");case"clef":return void(parse.state>=2&&(2==parse.state&&goto_tune(),(n=new_clef(i))&&get_clef(n)));case"deco":return void deco_add(i);case"linebreak":return void set_linebreak(i);case"map":return void get_map(i);case"maxsysstaffsep":if(3==parse.state)return void(par_sy.voices[curvoice.v].maxsep=get_unit(i));break;case"multicol":switch(generate(),i){case"start":blk_out(),multicol={posy:posy,maxy:posy,lmarg:cfmt.leftmargin,rmarg:cfmt.rightmargin,state:parse.state};break;case"new":if(!multicol){syntax(1,"%%multicol new without start");break}posy>multicol.maxy&&(multicol.maxy=posy),cfmt.leftmargin=multicol.lmarg,cfmt.rightmargin=multicol.rmarg,img.chg=!0,set_page(),posy=multicol.posy;break;case"end":if(!multicol){syntax(1,"%%multicol end without start");break}posy<multicol.maxy&&(posy=multicol.maxy),cfmt.leftmargin=multicol.lmarg,cfmt.rightmargin=multicol.rmarg,multicol=void 0,blk_flush(),img.chg=!0,set_page();break;default:syntax(1,"Unknown keyword '$1' in %%multicol",i)}return;case"musicfont":return void(musicfont=i);case"ottava":if(3!=parse.state){if(2!=parse.state)return;goto_tune()}if(s=parseInt(i),isNaN(s)||s<-2||s>2)return void syntax(1,errs.bad_val,"%%ottava");switch(curvoice.ottava){case 14:c="15mb)";break;case 7:c="8vb)";break;case-7:c="8va)";break;case-14:c="15ma)"}switch(c&&(a_dcn||(a_dcn=[]),a_dcn.push(c),set_ottava(c)),s){case-2:c="15mb(";break;case-1:c="8vb(";break;case 0:return;case 1:c="8va(";break;case 2:c="15ma("}return a_dcn||(a_dcn=[]),a_dcn.push(c),void set_ottava(c);case"repbra":return void(parse.state>=2&&(2==parse.state&&goto_tune(),curvoice.norepbra=!get_bool(i)));case"repeat":if(3!=parse.state)return;if(!curvoice.last_sym)return void syntax(1,"%%repeat cannot start a tune");if(i.length){if(c=i.split(/\s+/),s=parseInt(c[0]),o=parseInt(c[1]),isNaN(s)||s<1||curvoice.last_sym.type==C.BAR&&s>2)return void syntax(1,"Incorrect 1st value in %%repeat");if(isNaN(o))o=1;else if(o<1)return void syntax(1,"Incorrect 2nd value in %%repeat")}else s=1,o=1;return parse.repeat_n=curvoice.last_sym.type==C.BAR?s:-s,void(parse.repeat_k=o);case"sep":var u,f,$,p;return set_page(),(p=img.width-img.lm-img.rm,t=u=f=0,i&&($=i.split(/\s+/),t=get_unit($[0]),$[1]&&(u=get_unit($[1]),$[2]&&(f=get_unit($[2])))),t<1&&(t=14),u<1&&(u=t),f<1&&(f=90),parse.state>=2)?(n=new_block(a),n.x=(p-f)/2/cfmt.scale,n.l=f/cfmt.scale,n.sk1=t,void(n.sk2=u)):(blk_out(),vskip(t),output+='<path class="stroke"\n\td="M',out_sxsy((p-f)/2/cfmt.scale," ",0),output+="h"+(f/cfmt.scale).toFixed(2)+'"/>\n',vskip(u),void blk_flush());case"setbarnb":return r=parseInt(i),void(isNaN(r)?syntax(1,"Bad %%setbarnb value"):parse.state>=2?glovar.new_nbar=r:cfmt.measurefirst=r);case"staff":if(3!=parse.state){if(2!=parse.state)return;goto_tune()}if(r=parseInt(i),isNaN(r))return void syntax(1,"Bad %%staff value '$1'",i);var d;return(d="+"==i[0]||"-"==i[0]?curvoice.cst+r:r-1)<0||d>nstaff?void syntax(1,"Bad %%staff number $1 (cur $2, max $3)",d,curvoice.cst,nstaff):(delete curvoice.floating,void(curvoice.cst=d));case"staffbreak":if(3!=parse.state){if(2!=parse.state)return;goto_tune()}return n={type:C.STBRK,dur:0},i[0]>="0"&&i[0]<="9"?(n.xmx=get_unit(i),"f"==i.slice(-1)&&(n.stbrk_forced=!0)):(n.xmx=14,"f"==i[0]&&(n.stbrk_forced=!0)),void sym_link(n);case"stafflines":case"staffscale":case"staffnonote":return void set_v_param(a,i);case"staves":case"score":if(0==parse.state)return;return void get_staves(a,i);case"sysstaffsep":if(3==parse.state)return void(par_sy.voices[curvoice.v].sep=get_unit(i));break;case"text":return parse.state>=2?(n=new_block(a),n.text=cnv_escape(i),void(n.opt=cfmt.textoption)):void write_text(cnv_escape(i),cfmt.textoption);case"transpose":if(cfmt.sound)return;switch(parse.state){case 0:cfmt.transp=0;case 1:case 2:return void(cfmt.transp=(cfmt.transp||0)+get_transp(i))}for(n=curvoice.last_sym;n;n=n.prev){switch(n.type){case C.NOTE:n=clone(curvoice.okey),n.k_old_sf=curvoice.ckey.k_sf,sym_link(n);break;case C.KEY:break;default:continue}break}return void do_info("V",curvoice.id+" shift="+i);case"tune":return;case"user":return void set_user(i);case"voicecolor":if(3!=parse.state){if(2!=parse.state)return;goto_tune()}return void(curvoice.color=i);case"vskip":return(r=get_unit(i))<0?void syntax(1,"%%vskip cannot be negative"):parse.state>=2?(n=new_block(a),void(n.sk=r)):void vskip(r);case"newpage":case"leftmargin":case"rightmargin":case"pagescale":case"pagewidth":case"printmargin":case"scale":case"staffwidth":if(3==parse.state)return n=new_block(a),void(n.param=i);if("newpage"==a)return blk_flush(),void(block.newpage=!0)}set_format(a,i,l)}}function do_begin_end(e,t,r){var n,a,i,s;switch(e){case"js":js_inject(r);break;case"ml":parse.state>=2?(s=new_block(e),s.text=r):(svg_flush(),user.img_out(r));break;case"svg":for(a=0;;){if((n=r.indexOf('<style type="text/css">\n',a))<0)break;if((a=r.indexOf("</style>",n))<0){syntax(1,"No </style> in %%beginsvg sequence");break}style+=r.slice(n+23,a).replace(/\s+$/,"")}for(a=0;;){if((n=r.indexOf("<defs>\n",a))<0)break;if((a=r.indexOf("</defs>",n))<0){syntax(1,"No </defs> in %%beginsvg sequence");break}defs_add(r.slice(n+6,a))}break;case"text":if(i=get_textopt(t),i||(i=cfmt.textoption),parse.state>=2){s=new_block(e),s.text=cnv_escape(r),s.opt=i;break}write_text(cnv_escape(r),i)}}function generate(){var e,t;if(vover&&(syntax(1,"No end of voice overlay"),get_vover(vover.bar?"|":")")),0!=voice_tb.length&&(voice_adj(),dupl_voice(),sort_all(),tsfirst&&(set_bar_num(),tsfirst))){for(user.get_abcmodel&&user.get_abcmodel(tsfirst,voice_tb,anno_type,info),user.img_out&&output_music(),e=0;e<voice_tb.length;e++)t=voice_tb[e],t.time=0,t.sym=t.last_sym=null,t.st=cur_sy.voices[e].st,t.second=cur_sy.voices[e].second,delete t.have_ly,t.hy_st=0,delete t.bar_start,delete t.slur_st,delete t.s_tie,delete t.s_rtie;staves_found=0}}function key_transp(e){var t=curvoice.vtransp/3|0,r=(-2&t)+7*(1&t)+e.k_sf;switch((curvoice.vtransp+210)%3){case 1:r=(r+4+48)%12-4;break;case 2:r=(r+7+48)%12-7;break;default:r=(r+5+48)%12-5}e.k_sf=r,e.k_delta=cgd2cde[(r+7)%7]}function set_k_acc(e){var t,r,n,a,i,s=[],o=[],c=[],l=[];if(e.k_sf>0)for(a=0;a<e.k_sf;a++)s[a]=1,o[a]=[26,23,27,24,21,25,22][a];else for(a=0;a<-e.k_sf;a++)s[a]=-1,o[a]=[22,25,21,24,20,23,26][a];for(n=e.k_a_acc.length,t=0;t<n;t++){for(i=e.k_a_acc[t],r=0;r<a;r++)if(o[r]==i.pit){s[r]=i.acc,i.micro_n&&(c[r]=i.micro_n,l[r]=i.micro_d);break}r==a&&(s[r]=i.acc,o[r]=i.pit,i.micro_n&&(c[r]=i.micro_n,l[r]=i.micro_d),a++)}for(t=0;t<a;t++)i=e.k_a_acc[t],i||(i=e.k_a_acc[t]={}),i.acc=s[t],i.pit=o[t],c[t]?(i.micro_n=c[t],i.micro_d=l[t]):(delete i.micro_n,delete i.micro_d)}function acc_same_pitch(e){var t,r,n=curvoice.last_sym.prev;if(n)for(r=n.time;n;n=n.prev)switch(n.type){case C.BAR:if(n.time<r)return;for(;;){if(!(n=n.prev))return;if(n.type==C.NOTE){if(n.time+n.dur==r)break;return}if(n.time<r)return}
for(t=0;t<=n.nhd;t++)if(n.notes[t].pit==e&&n.notes[t].ti1)return n.notes[t].acc;return;case C.NOTE:for(t=0;t<=n.nhd;t++)if(n.notes[t].pit==e)return n.notes[t].acc}}function get_staves(e,t){var r,n,a,i,s,o,c,l,u,f=parse_staves(t);if(f){0!=voice_tb.length&&(voice_adj(),dupl_voice());var $=0,p=!0;for(o=0;o<voice_tb.length;o++)n=voice_tb[o],n.time>$&&($=n.time),n.sym&&(p=!1);if(p||0==$&&staves_found<0)for(o=0;o<par_sy.voices.length;o++)par_sy.voices[o].range=-1;else{for(o=0;o<par_sy.voices.length;o++)if(par_sy.voices[o].range>=0){curvoice=voice_tb[o];break}curvoice.time=$,r={type:C.STAVES,dur:0},sym_link(r),par_sy.nstaff=nstaff,new_syst(),r.sy=par_sy}for(staves_found=$,o=0;o<voice_tb.length;o++)n=voice_tb[o],delete n.second,delete n.ignore,delete n.floating;for(u=0,i=0;i<f.length;i++){if(c=f[i][0],n=new_voice(c),n.time=$,o=n.v,0==i&&(par_sy.top_voice=n.v),par_sy.voices[o].range>=0){for(a=clone(n),par_sy.voices[voice_tb.length]=clone(par_sy.voices[o]),o=voice_tb.length,a.v=o,a.sym=a.last_sym=null,a.time=$,voice_tb.push(a),delete a.clone;n.clone;)n=n.clone;n.clone=a,n=a}f[i][0]=n,par_sy.voices[o].range=u++}if("t"==e[1])for(i=0;i<f.length;i++)(s=f[i][1])&(OPEN_BRACE|OPEN_BRACE2)&&(s&(OPEN_BRACE|CLOSE_BRACE))!=(OPEN_BRACE|CLOSE_BRACE)&&(s&(OPEN_BRACE2|CLOSE_BRACE2))!=(OPEN_BRACE2|CLOSE_BRACE2)&&0==f[i+1][1]&&(s&OPEN_PARENTH||f[i+2][1]&OPEN_PARENTH||(f[i+2][1]&(CLOSE_BRACE|CLOSE_BRACE2)?f[i+1][1]|=FL_VOICE:0==f[i+2][1]&&f[i+3][1]&(CLOSE_BRACE|CLOSE_BRACE2)&&(f[i][1]|=OPEN_PARENTH,f[i+1][1]|=CLOSE_PARENTH,f[i+2][1]|=OPEN_PARENTH,f[i+3][1]|=CLOSE_PARENTH)));for(l=-1,i=0;i<f.length;i++)if(s=f[i][1],(s&(OPEN_PARENTH|CLOSE_PARENTH))==(OPEN_PARENTH|CLOSE_PARENTH)&&(s&=~(OPEN_PARENTH|CLOSE_PARENTH),f[i][1]=s),n=f[i][0],s&FL_VOICE?(n.floating=!0,n.second=!0):(l++,par_sy.staves[l]||(par_sy.staves[l]={stafflines:"|||||",staffscale:1}),par_sy.staves[l].flags=0),o=n.v,n.st=n.cst=par_sy.voices[o].st=l,par_sy.staves[l].flags|=s,s&OPEN_PARENTH){for(a=n;i<f.length-1&&(n=f[++i][0],o=n.v,f[i][1]&MASTER_VOICE?(a.second=!0,a=n):n.second=!0,n.st=n.cst=par_sy.voices[o].st=l,!(f[i][1]&CLOSE_PARENTH)););par_sy.staves[l].flags|=f[i][1]}if(l<0&&(l=0),par_sy.nstaff=nstaff=l,"c"==e[1])for(l=0;l<nstaff;l++)par_sy.staves[l].flags^=STOP_BAR;for(o=0;o<voice_tb.length;o++)n=voice_tb[o],par_sy.voices[o].range<0?n.ignore=!0:(par_sy.voices[o].second=n.second,!((l=n.st)>0)||n.norepbra||par_sy.staves[l-1].flags&STOP_BAR||(n.norepbra=!0));curvoice=parse.state>=2?voice_tb[par_sy.top_voice]:null}}function get_vover(e){function t(e){var t,r;for(t=0;t<voice_tb.length;t++)if(r=voice_tb[t],r.id==e)return r;return r=clone(curvoice),r.v=voice_tb.length,r.id=e,r.sym=r.last_sym=null,delete r.nm,delete r.snm,delete r.new_name,delete r.lyric_restart,delete r.lyric_cont,delete r.ly_a_h,delete r.sym_restart,delete r.sym_cont,voice_tb.push(r),r}var r,n,a,i,s,o,c,l;parse.line;if(!curvoice.ignore){if("|"==e||")"==e)return curvoice.last_note?(curvoice.last_note.beam_end=!0,vover?(curvoice.time!=vover.p_voice.time&&(syntax(1,"Wrong duration in voice overlay"),curvoice.time>vover.p_voice.time&&(vover.p_voice.time=curvoice.time)),curvoice=vover.p_voice,void(vover=null)):void syntax(1,"Erroneous end of voice overlay")):void syntax(1,errs.nonote_vo);if("("==e)return vover?void syntax(1,"Voice overlay already started"):void(vover={p_voice:curvoice,time:curvoice.time});if(!curvoice.last_note)return void syntax(1,errs.nonote_vo);if(curvoice.last_note.beam_end=!0,!(r=curvoice.voice_down)){r=t(curvoice.id+"o"),curvoice.voice_down=r,r.time=0,r.second=!0,c=r.v,par_sy.voices[c]={st:curvoice.st,second:!0};var u=void 0!=curvoice.clone?1:0;for(a=par_sy.voices[curvoice.v].range,o=0;o<par_sy.voices.length;o++)par_sy.voices[o].range>a&&(par_sy.voices[o].range+=u+1);par_sy.voices[c].range=a+1,u&&(n=t(r.id+"c"),n.second=!0,l=n.v,par_sy.voices[l]={second:!0,range:a+2},r.clone=n)}if(r.ulen=curvoice.ulen,r.dur_fact=curvoice.dur_fact,curvoice.uscale&&(r.uscale=curvoice.uscale),vover)curvoice!=vover.p_voice&&curvoice.time!=vover.p_voice.time&&(syntax(1,"Wrong duration in voice overlay"),curvoice.time>vover.p_voice.time&&(vover.p_voice.time=curvoice.time));else{for(vover={bar:!0,p_voice:curvoice},s=r.time,i=curvoice.last_sym;!(i.type==C.BAR||i.time<=s);i=i.prev);vover.time=i.time}r.time=vover.time,curvoice=r}}function is_voice_sig(){var e;if(!curvoice.sym)return!0;if(0!=curvoice.time)return!1;for(e=curvoice.last_sym;e;e=e.prev)if(0!=w_tb[e.type])return!1;return!0}function get_clef(e){var t,r;if(is_voice_sig())return void(curvoice.clef=e);for(t=curvoice.last_sym;t&&t.prev&&t.time==curvoice.time&&0==w_tb[t.type];t=t.prev);if(t&&t.prev&&t.time==curvoice.time&&(t.type==C.KEY&&!t.k_none||t.type==C.BAR)){for(r=t;r.prev;r=r.prev){switch(r.prev.type){case C.KEY:case C.BAR:continue}break}t=curvoice.last_sym,curvoice.last_sym=r.prev,sym_link(e),e.next=r,r.prev=e,curvoice.last_sym=t}else sym_link(e);e.clef_small=!0}function get_key(e){var t,r,n,a,i=new_key(e),s=i[0];switch(i=i[1],s.k_sf&&!s.k_exp&&s.k_a_acc&&set_k_acc(s),parse.state){case 1:for(void 0!=s.k_sf||s.k_a_acc||(s.k_sf=0,s.k_none=!0),t=0;t<voice_tb.length;t++)r=voice_tb[t],r.key=clone(s),r.okey=clone(s),r.ckey=clone(s);return parse.okey=clone(s),parse.ckey=s,0!=i.length&&memo_kv_parm("*",i),glovar.ulen||(glovar.ulen=C.BLEN/8),parse.state=2,set_page(),write_heading(),reset_gen(),void(gene.nbar=cfmt.measurefirst);case 2:goto_tune(!0)}if(0!=i.length&&set_kv_parm(i),a=(cfmt.transp||0)+(curvoice.transp||0)+(curvoice.shift||0),void 0==s.k_sf){if(!s.k_a_acc&&!a)return;s.k_sf=curvoice.okey.k_sf}if(curvoice.okey=clone(s),a&&(curvoice.vtransp=a,key_transp(s)),s.k_old_sf=curvoice.ckey.k_sf,curvoice.ckey=s,is_voice_sig())return curvoice.key=clone(s),void(s.k_none&&(curvoice.key.k_sf=0));n=curvoice.last_sym,n&&n.type==C.METER?(curvoice.last_sym=n.prev,curvoice.last_sym||(curvoice.sym=null),sym_link(s),s.next=n,n.prev=s,curvoice.last_sym=n):sym_link(s)}function new_voice(e){var t,r,n,a=voice_tb.length;if(1==a&&voice_tb[0].default&&(delete voice_tb[0].default,0==voice_tb[0].time))return t=voice_tb[0],t.id=e,cfmt.transp&&parse.state>=2&&(n=curvoice,curvoice=t,set_transp(),curvoice=n),t;for(r=0;r<a;r++)if(t=voice_tb[r],t.id==e)return t;return t={v:r,id:e,time:0,new:!0,pos:{dyn:0,gch:0,gst:0,orn:0,stm:0,voc:0,vol:0},scale:1,ulen:glovar.ulen,dur_fact:1,key:clone(parse.ckey),ckey:clone(parse.ckey),okey:clone(parse.okey),meter:clone(glovar.meter),wmeasure:glovar.meter.wmeasure,clef:{type:C.CLEF,clef_auto:!0,clef_type:"a",time:0},hy_st:0},voice_tb.push(t),par_sy.voices[r]={range:-1},t}function init_tune(){nstaff=-1,voice_tb=[],curvoice=null,new_syst(!0),staves_found=-1,gene={},a_de=[],od={}}function do_cloning(e){for(var t,r,n=parse.file,a=parse.eol+1,i=a;;){if((r=n.indexOf("\n",i))<0){r=0;break}if(/%.*|\n.*|.:.|\[.:/.test(n.slice(r+1,r+4)))break;i=r+1}for(include++,tosvg(parse.fname,n,a,r),t=0;t<e.length;t++)get_voice(e[t]),tosvg(parse.fname,n,a,r);include--}function get_voice(e){var t,r,n=info_split(e,1),a=n.shift();if(a){if(a.indexOf(",")>0&&(r=a.split(","),a=r.shift()),parse.state<2)return 0!=n.length&&memo_kv_parm(a,n),void("*"!=a&&1==parse.state&&new_voice(a));if("*"==a)return void syntax(1,"Cannot have V:* in tune body");curvoice=new_voice(a),set_kv_parm(n),2==parse.state&&goto_tune(),set_transp(),t=curvoice.v,curvoice.new&&(delete curvoice.new,staves_found<0&&(curvoice.st=curvoice.cst=++nstaff,par_sy.nstaff=nstaff,par_sy.voices[t].st=nstaff,par_sy.voices[t].range=t,par_sy.staves[nstaff]={stafflines:"|||||",staffscale:1}),par_sy.voices[t].range<0&&staves_found>=0&&(curvoice.ignore=!0)),curvoice.stafflines&&(par_sy.staves[curvoice.st].stafflines=curvoice.stafflines,curvoice.stafflines=""),curvoice.filtered||curvoice.ignore||!parse.voice_opts||(curvoice.filtered=!0,voice_filter()),r&&do_cloning(r)}}function goto_tune(e){var t,r,n={type:C.STAVES,dur:0,sy:par_sy};for(parse.state=3,0==voice_tb.length?(curvoice=new_voice("1"),curvoice.clef.istart=curvoice.key.istart,curvoice.clef.iend=curvoice.key.iend,curvoice.default=!0):curvoice||(curvoice=voice_tb[staves_found<0?0:par_sy.top_voice]),curvoice.init||e||(set_kv_parm([]),set_transp()),t=0;t<voice_tb.length;t++)r=voice_tb[t],r.ulen=glovar.ulen,r.key.k_bagpipe&&!r.pos.stm&&(r.pos=clone(r.pos),r.pos.stm=C.SL_BELOW);if(staves_found<0){for(nstaff=voice_tb.length-1,t=0;t<=nstaff;t++)r=voice_tb[t],delete r.new,r.st=r.cst=par_sy.voices[t].st=par_sy.voices[t].range=t,par_sy.staves[t]={stafflines:"|||||",staffscale:1};par_sy.nstaff=nstaff}r=curvoice,curvoice=voice_tb[par_sy.top_voice],sym_link(n),staves_found<0&&(n.default=!0),curvoice=r}function get_sym(e,t){var r,n,a,i,s;if(!curvoice.ignore){if(t){if(!(r=curvoice.sym_cont))return void syntax(1,"+: symbol line without music")}else if(curvoice.sym_restart?(curvoice.sym_start=r=curvoice.sym_restart,curvoice.sym_restart=null):r=curvoice.sym_start,r||(r=curvoice.sym),!r)return void syntax(1,"s: without music");for(a=0;;){for(;" "==e[a]||"\t"==e[a];)a++;if(!(n=e[a]))break;switch(n){case"|":for(;r&&r.type!=C.BAR;)r=r.next;if(!r)return void syntax(1,"Not enough measure bars for symbol line");r=r.next,a++;continue;case"!":case'"':if(i=++a,(a=e.indexOf(n,i))<0){syntax(1,"!"==n?"No end of decoration":"No end of guitar chord"),a=e.length;continue}s=e.slice(i-1,a+1);break;case"*":break;default:if((s=n.charCodeAt(0))<128&&(s=char_tb[s],s.length>1&&("!"==s[0]||'"'==s[0]))){n=s[0];break}syntax(1,errs.bad_char,n)}for(;r&&(r.type!=C.NOTE||r.grace);)r=r.next;if(!r)return void syntax(1,"Too many elements in symbol line");switch(n){default:break;case"!":deco_cnv([s.slice(1,-1)],r,r.prev);break;case'"':a_gch=r.a_gch,parse_gchord(s),a_gch&&gch_build(r)}r=r.next,a++}curvoice.lyric_cont=r}}function get_lyrics(e,t){var r,n,a,i,s,o;if(!curvoice.ignore){if(curvoice.pos.voc!=C.SL_HIDDEN&&(curvoice.have_ly=!0),t){if(!(r=curvoice.lyric_cont))return void syntax(1,"+: lyric without music")}else if(set_font("vocal"),curvoice.lyric_restart?(curvoice.lyric_start=r=curvoice.lyric_restart,curvoice.lyric_restart=null,curvoice.lyric_line=0):(curvoice.lyric_line++,r=curvoice.lyric_start),r||(r=curvoice.sym),!r)return void syntax(1,"w: without music");for(a=e,i=0;;){for(;" "==a[i]||"\t"==a[i];)i++;if(!a[i])break;switch(s=parse.istart+i+2,a[i]){case"|":for(;r&&r.type!=C.BAR;)r=r.next;if(!r)return void syntax(1,"Not enough measure bars for lyric line");r=r.next,i++;continue;case"-":n="-\n";break;case"_":n="_\n";break;case"*":n="";break;default:if("\\"==a[i]&&i==a.length-1)return void(curvoice.lyric_cont=r);for(n="";;){if(!a[i])break;switch(a[i]){case"_":case"*":case"|":i--;case" ":case"\t":break;case"~":n+=" ",i++;continue;case"-":n+="\n";break;case"\\":n+=a[++i],i++;continue;default:n+=a[i++];continue}break}}for(;r&&(r.type!=C.NOTE||r.grace);)r=r.next;if(!r)return void syntax(1,"Too many words in lyric line");n&&r.pos.voc!=C.SL_HIDDEN&&(n.match(/^\$\d/)&&(set_font("0"==n[1]?"vocal":"u"+n[1]),n=n.slice(2)),o={t:n,font:gene.curfont,w:strwh(n)[0],istart:s,iend:s+n.length},r.a_ly||(r.a_ly=[]),r.a_ly[curvoice.lyric_line]=o),r=r.next,i++}curvoice.lyric_cont=r}}function ly_width(e,t){var r,n,a,i,s,o,c,l,u,f,$,p=e.a_ly;for(i=0,c=0;c<p.length;c++)if(r=p[c])if("-\n"!=($=r.t)&&"_\n"!=$){for(o=r.w,a=r.font.swfac,s=o+2*cwid(" ")*a,e.type==C.GRACE?f=e.wl:$[0]>="0"&&$[0]<="9"&&$.length>2||":"==$[1]||"("==$[0]||")"==$[0]?("("==$[0]?n=cwid("(")*a:(l=$.indexOf(" "),set_font(r.font),n=l>0?strwh($.slice(0,l))[0]:o),f=.4*(o-n+2*cwid(" ")*a),f>20&&(f=20),f+=n,r.t[0]>="0"&&r.t[0]<="9"&&f>i&&(i=f)):(f=.4*s)>20&&(f=20),r.shift=f,t<f&&(t=f),s-=f,f=2*cwid(" ")*a,u=e.next;u;u=u.next){switch(u.type){case C.NOTE:case C.REST:if(u.a_ly&&u.a_ly[c]&&0!=u.a_ly[c].w){if("-\n"!=u.a_ly[c].t&&"_\n"!=u.a_ly[c].t)break;s-=f}else s-=9;if(s<=0)break;continue;case C.CLEF:case C.METER:case C.KEY:s-=10;continue;default:s-=5}break}s>e.wr&&(e.wr=s)}else r.shift=0;if(i>0)for(c=0;c<p.length;c++)(r=p[c])&&r.t[0]>="0"&&r.t[0]<="9"&&(r.shift=i);return t}function draw_lyric_line(e,t,r){var n,a,i,s,o,c,l,u,f,$;for(e.hy_st&1<<t&&(l=!0,e.hy_st&=~(1<<t)),s=e.sym;s.type==C.CLEF||s.type==C.KEY||s.type==C.METER;s=s.next);for(a=s.prev?s.prev.x:tsfirst.x,f=0;s;s=s.next)if(c=s.a_ly?s.a_ly[t]:null)c.font!=gene.curfont&&(gene.curfont=c.font),n=c.t,i=c.w,$=c.shift,l&&("_\n"==n?n="-\n":"-\n"!=n&&(out_hyph(a,r,s.x-$-a),l=!1,a=s.x+s.wr)),u&&"_\n"!=n&&(out_wln(a+3,r,f-a+3),u=!1,a=s.x+s.wr),"-\n"!=n&&"_\n"!=n?(f=s.x-$,"\n"==n.slice(-1)&&(n=n.slice(0,-1),l=!0),(user.anno_start||user.anno_stop)&&(o={st:s.st,istart:c.istart,iend:c.iend,x:f,y:r,ymn:r,ymx:r+gene.curfont.size,wl:0,wr:i},anno_start(o,"lyrics")),xy_str(f,r,n),anno_stop(o,"lyrics"),a=f+i):(0==f&&a>s.x-18&&(a=s.x-18),"-"==n[0]?l=!0:u=!0,f=s.x-$);else switch(s.type){case C.REST:case C.MREST:u&&(out_wln(a+3,r,f-a),u=!1,a=s.x+s.wr)}for(l&&(l=!1,f=realwidth-10,f<a+10&&(f=a+10),out_hyph(a,r,f-a),cfmt.hyphencont&&(e.hy_st|=1<<t)),e.s_next;s;s=s.next)if(s.type==C.NOTE){if(!s.a_ly)break;c=s.a_ly[t],c&&"_\n"==c.t&&(u=!0,(f=realwidth-15)<a+12&&(f=a+12));break}u&&(out_wln(a+3,r,f-a+3),u=!1)}function draw_lyrics(e,t,r,n,a){var i,s,o=staff_tb[e.st].staffscale;if(set_font("vocal"),a>0){for(n>-cfmt.vocalspace&&(n=-cfmt.vocalspace),n*=o,i=0;i<t;i++)n-=1.1*r[i],draw_lyric_line(e,i,n);return(n-r[i-1]/6)/o}for(s=staff_tb[e.st].topbar+cfmt.vocalspace,n<s&&(n=s),n*=o,i=t;--i>=0;)draw_lyric_line(e,i,n),n+=1.1*r[i];return n/o}function draw_all_lyrics(){var e,t,r,n,a,i,s,o,c,l,u=new Array(nstaff),f=voice_tb.length,$=new Array(f),p=new Array(f),d=new Array(f),h=new Array(f),_=0,m=0,y=-1;for(r=0;r<f;r++)if(e=voice_tb[r],e.sym){if(e.st!=y&&(_=0,m=0,y=e.st),n=0,e.have_ly){for($[r]||($[r]=[]),t=e.sym;t;t=t.next)if(c=t.a_ly){for(i=t.x,o=10,a=0;a<c.length;a++)if((l=c[a])&&0!=l.w){i-=l.shift,o=l.w;break}for(s=y_get(e.st,1,i,o),_<s&&(_=s),s=y_get(e.st,0,i,o),m>s&&(m=s);n<c.length;)$[r][n++]=0;for(a=0;a<c.length;a++)(l=c[a])&&(!$[r][a]||l.font.size>$[r][a])&&($[r][a]=l.font.size)}}else s=y_get(e.st,1,0,realwidth),_<s&&(_=s),s=y_get(e.st,0,0,realwidth),m>s&&(m=s);u[y]||(u[y]={}),u[y].top=_,u[y].bot=m,p[r]=n,0!=n&&(e.pos.voc?d[r]=e.pos.voc==C.SL_ABOVE:voice_tb[r+1]&&voice_tb[r+1].st==y&&voice_tb[r+1].have_ly?d[r]=!0:d[r]=!1,d[r]?u[y].a=!0:u[y].b=!0)}for(a=0,r=0;r<f;r++)e=voice_tb[r],e.sym&&e.have_ly&&(d[r]?h[a++]=r:(y=e.st,set_dscale(y,!0),p[r]>0&&(u[y].bot=draw_lyrics(e,p[r],$[r],u[y].bot,1))));for(;--a>=0;)r=h[a],e=voice_tb[r],y=e.st,set_dscale(y,!0),u[y].top=draw_lyrics(e,p[r],$[r],u[y].top,-1);for(r=0;r<f;r++)if(e=voice_tb[r],e.sym){if(y=e.st,u[y].a)for(_=u[y].top+2,t=e.sym.next;t;t=t.next)t.a_ly&&y_set(y,1,t.x-2,10,_);if(u[y].b)if(m=u[y].bot-2,p[e.v]>0)for(t=e.sym.next;t;t=t.next)t.a_ly&&y_set(y,0,t.x-2,10,m);else y_set(y,0,0,realwidth,m)}}function parse_gchord(e){function t(){for(var e="";;){if(r=n[o++],"1234567890.-".indexOf(r)<0)return parseFloat(e);e+=r}}var r,n,a,i,s,e,o,c,l,u=get_font("annotation"),f=u.size,$=parse.line;if(c=parse.bol+$.index,e.length>1)n=e.slice(1,-1),l=c+1;else{for(n="";;){if(!(r=$.next_char()))return void syntax(1,"No end of guitar chord");if('"'==r)break;"\\"==r&&(n+=r,r=$.next_char()),n+=r}l=parse.bol+$.index+1}if(curvoice.pos.gch!=C.SL_HIDDEN)for(o=0,e="g";;){if(!(r=n[o]))break;switch(a={text:"",istart:c,iend:l,font:u},r){case"@":e=r,o++,i=t(),","!=r?(syntax(1,"',' lacking in annotation '@x,y'"),s=0):(s=t()," "!=r&&o--),a.x=i,a.y=s-f/2;break;case"^":case"_":case"<":case">":o++,e=r;break;default:switch(e){case"g":a.font=get_font("gchord");break;case"@":a.x=i,s-=f,a.y=s-f/2}}for(a.type=e;;){if(!(r=n[o]))break;switch(r){case"\\":if(!(r=n[++o])||"n"==r)break;a.text+="\\";default:a.text+=r,o++;continue;case"&":for(;;){switch(a.text+=r,r=n[++o]){default:continue;case";":case void 0:case"\\":}break}if(";"==r){a.text+=r;continue}break;case";":}o++;break}a_gch||(a_gch=[]),a_gch.push(a)}}function gch_tr1(e,t){var r,n,a,i,s,o,c,l,u=0;switch(e[0]){case"A":n=5;break;case"B":n=6;break;case"C":n=0;break;case"D":if("o"==e[1]){u++,n=0;break}n=1;break;case"E":n=2;break;case"F":"a"==e[1]&&u++,n=3;break;case"G":n=4;break;case"L":u++,n=5;break;case"M":u++,n=2;break;case"R":u++,n=1;break;case"S":u++,"o"==e[1]?(u++,n=4):n=6;break;case"/":u--;break;default:return e}if(o=0,c=u+1,u>=0){for(;"#"==e[c];)o++,c++;for(;"b"==e[c];)o--,c++;i=cde2fcg[n]+t+7*o,s=cgd2cde[(i+112)%7],a=(159+((i+22)/7|0))%5,r=(u?latin_names[s]:note_names[s])+acc_name[a]}else r="";return(l=e.indexOf("/",c))<0?r+e.slice(c):(n=note_names.indexOf(e[++l]))<0?r+e.slice(c):(r+=e.slice(c,l),o=0,"#"==e[++l]?(o++,"#"==e[++l]&&(o++,l++)):"b"==e[l]&&(o--,"b"==e[++l]&&(o--,l++)),i=cde2fcg[n]+t+7*o,s=cgd2cde[(i+112)%7],a=(159+((i+22)/7|0))%5,r+note_names[s]+acc_name[a]+e.slice(l))}function gch_transp(e){for(var t,r,n,a=0,i=curvoice.ckey.k_sf-curvoice.okey.k_sf;;){if(!(t=e.a_gch[a++]))return;"g"==t.type&&(r=t.text,n=r.indexOf("\t"),n>=0&&(n++,r=r.slice(0,n)+gch_tr1(r.slice(n),i)),t.text=gch_tr1(r,i))}}function gch_build(e){var t,r,n,a,i=curvoice.pos.gch==C.SL_BELOW?-1:1,s=0,o=0,c=0,l=0,u=cfmt.gchordbox;for(e.a_gch=a_gch,a_gch=null,curvoice.vtransp&&gch_transp(e),a=0;a<e.a_gch.length;a++){if(t=e.a_gch[a],"g"==t.type)cfmt.chordnames&&(t.otext=t.text,t.text=t.text.replace(/A|B|C|D|E|F|G/g,function(e){return cfmt.chordnames[e]}),"H"==cfmt.chordnames.B&&(t.text=t.text.replace(/Hb/g,"Bb"))),t.text=t.text.replace(/##|#|=|bb|b/g,function(e){switch(e){case"##":return"&#x1d12a;";case"#":return"";case"=":return"";case"b":return""}return"&#x1d12b;"});else if(t.text=cnv_escape(t.text),"@"==t.type&&!user.anno_start&&!user.anno_stop)continue;switch(gene.curfont=t.font,r=strwh(t.text),t.w=r[0],t.type){case"@":break;case"^":n=.4*r[0],n>8&&(n=8),t.x=-n,s-=r[1],t.y=s;break;case"_":n=.4*r[0],n>8&&(n=8),t.x=-n,o-=r[1],t.y=o;break;case"<":t.x=-(r[0]+6),c-=r[1],t.y=c+r[1]/2;break;case">":t.x=6,l-=r[1],t.y=l+r[1]/2;break;default:t.box=u,n=.4*r[0],n>8&&(n=8),t.x=-n,i<0?(o-=r[1],t.y=o,u&&(o-=2,t.y-=1)):(s-=r[1],t.y=s,u&&(s-=2,t.y-=1))}}for(c/=2,l/=2,a=0;a<e.a_gch.length;a++)switch(t=e.a_gch[a],t.type){case"^":t.y-=s;break;case"<":t.y-=c;break;case">":t.y-=l;break;case"g":i>0&&(t.y-=s)}}function draw_gchord(e,t,r){var n,a,i,s,o,c,l,u,f,$,p,d=e.a_gch[0].w,h=y_get(e.st,1,e.x-2,d),_=y_get(e.st,0,e.x-2,d),m=3*((e.notes[e.nhd].pit+e.notes[0].pit>>1)-18);for(s=0;s<e.a_gch.length&&(n=e.a_gch[s],!("g"==n.type&&(a=n,n.y<0)));s++);for(a&&(a.y>=0?h<r&&(h=r):_>t&&(_=t)),set_dscale(e.st),s=0;s<e.a_gch.length;s++){switch(n=e.a_gch[s],use_font(n.font),set_font(n.font),p=n.font.size,d=n.w,o=e.x+n.x,i=n.text,n.type){case"_":c=n.y+_,y_set(e.st,0,o,d,c-.2*p-2);break;case"^":c=n.y+h,y_set(e.st,1,o,d,c+.8*p+2);break;case"<":e.notes[0].acc&&(o-=e.notes[0].shac),c=n.y+m-p/2;break;case">":o+=e.xmx,e.dots>0&&(o+=1.5+3.5*e.dots),c=n.y+m-p/2;break;default:if($=n.box?3:2,n.y>=0?(c=n.y+h,y_set(e.st,!0,o,d,c+p+$)):(c=n.y+_,y_set(e.st,!1,o,d,c-$)),(u=i.indexOf("\t"))>=0){o=realwidth;for(var y=e.next;y;y=y.next){switch(y.type){default:continue;case C.NOTE:case C.REST:case C.BAR:o=y.x}break}for(f=2;!((u=i.indexOf("\t",u+1))<0);)f++;var g=(o-e.x)/f;for(o=e.x,c*=staff_tb[e.st].staffscale,user.anno_start&&user.anno_start("gchord",n.istart,n.iend,o-2,c+p+2,d+4,p+4,e),u=0,f=u;!((u=i.indexOf("\t",f))<0);)xy_str(o,c,i.slice(f,u),"c"),o+=g,f=u+1;xy_str(o,c,i.slice(f),"c"),user.anno_stop&&user.anno_stop("gchord",n.istart,n.iend,e.x-2,c+p+2,d+4,p+4,e);continue}break;case"@":c=n.y+m,c>0?(l=c+p)>staff_tb[e.st].ann_top&&(staff_tb[e.st].ann_top=l):c<staff_tb[e.st].ann_bot&&(staff_tb[e.st].ann_bot=c)}user.anno_start&&user.anno_start("annot",n.istart,n.iend,o-2,c+p+2,d+4,p+4,e),n.box?xy_str_b(o,c,i):xy_str(o,c,i),user.anno_stop&&user.anno_stop("annot",n.istart,n.iend,o-2,c+p+2,d+4,p+4,e)}}function psdeco(){return!1}function psxygl(){return!1}function set_hooks(){function set_hs(hs){for(var of,h,k=0;k<hs.length;k++)h=hs[k],"string"==typeof h?self[h]||eval("self."+h+"="+h):eval("of="+h[0]+";"+h[0]+"="+h[1]+".bind(self,of)")}var h=abc2svg.modules.hooks,gh=abc2svg.modules.g_hooks;hook_init?h.length&&(set_hs(h),gh.push.apply(gh,h),abc2svg.modules.hooks=[]):(h.length&&(gh.push.apply(gh,h),abc2svg.modules.hooks=[]),set_hs(gh),hook_init=!0)}var C=abc2svg.C,require=empty_function,system=empty_function,write=empty_function,XMLHttpRequest=empty_function;this.user=user;var OPEN_BRACE=1,CLOSE_BRACE=2,OPEN_BRACKET=4,CLOSE_BRACKET=8,OPEN_PARENTH=16,CLOSE_PARENTH=32,STOP_BAR=64,FL_VOICE=128,OPEN_BRACE2=256,CLOSE_BRACE2=512,OPEN_BRACKET2=1024,CLOSE_BRACKET2=2048,MASTER_VOICE=4096,IN=96,CM=37.8,YSTEP=256,errs={bad_char:"Bad character '$1'",bad_val:"Bad value in $1",bar_grace:"Cannot have a bar in grace notes",ignored:"$1: inside tune - ignored",misplaced:"Misplaced '$1' in %%staves",must_note:"!$1! must be on a note",must_note_rest:"!$1! must be on a note or a rest",nonote_vo:"No note in voice overlay",not_enough_n:"Not enough notes/rests for %%repeat",not_enough_m:"Not enough measures for %%repeat",not_ascii:"Not an ASCII character"},glovar={meter:{type:C.METER,wmeasure:1,a_meter:[]}},info={},mac={},maci=new Int8Array(128),parse={ctx:{},prefix:"%",state:0,line:new scanBuf},psvg,dd_tb={},a_de,od,decos={dot:"0 stc 5 1 1",tenuto:"0 emb 5 3 3",slide:"1 sld 3 7 0",arpeggio:"2 arp 12 10 0",roll:"3 roll 7 6 6",fermata:"3 hld 12 7 7",emphasis:"3 accent 7 4 4",lowermordent:"3 lmrd 10 5 5",coda:"3 coda 24 10 10",uppermordent:"3 umrd 10 5 5",segno:"3 sgno 22 8 8",trill:"3 trl 14 5 5",upbow:"3 upb 10 5 5",downbow:"3 dnb 9 5 5",gmark:"3 grm 6 5 5",wedge:"3 wedge 8 3 3",turnx:"3 turnx 10 0 5",breath:"3 brth 0 1 20",longphrase:"3 lphr 0 1 1",mediumphrase:"3 mphr 0 1 1",shortphrase:"3 sphr 0 1 1",invertedfermata:"3 hld 12 7 7",invertedturn:"3 turn 10 0 5",invertedturnx:"3 turnx 10 0 5",0:"3 fng 8 3 3 0",1:"3 fng 8 3 3 1",2:"3 fng 8 3 3 2",3:"3 fng 8 3 3 3",4:"3 fng 8 3 3 4",5:"3 fng 8 3 3 5",plus:"3 dplus 7 3 3","+":"3 dplus 7 3 3",accent:"3 accent 6 4 4",">":"3 accent 6 4 4",marcato:"3 marcato 9 3 3","^":"3 marcato 9 3 3",mordent:"3 lmrd 10 5 5",open:"3 opend 10 3 3",snap:"3 snap 14 3 3",thumb:"3 thumb 14 3 3",dacapo:"3 dacs 16 20 20 Da Capo",dacoda:"3 dacs 16 20 20 Da Coda","D.C.":"3 dacs 16 10 10 D.C.","D.S.":"3 dacs 16 10 10 D.S.","D.C.alcoda":"3 dacs 16 38 38 D.C. al Coda","D.S.alcoda":"3 dacs 16 38 38 D.S. al Coda","D.C.alfine":"3 dacs 16 38 38 D.C. al Fine","D.S.alfine":"3 dacs 16 38 38 D.S. al Fine",fine:"3 dacs 16 10 10 Fine",turn:"3 turn 10 0 5","trill(":"3 ltr 8 0 0","trill)":"3 ltr 8 0 0",f:"6 pf 18 1 7",ff:"6 pf 18 2 10",fff:"6 pf 18 4 13",ffff:"6 pf 18 6 16",mf:"6 pf 18 6 13",mp:"6 pf 18 6 16",p:"6 pf 18 2 8",pp:"6 pf 18 5 14",ppp:"6 pf 18 8 20",pppp:"6 pf 18 10 25",pralltriller:"3 umrd 10 5 5",sfz:'6 sfz 18 4 10 ""',ped:"4 ped 20 0 0","ped-up":"4 pedoff 20 0 0","crescendo(":"7 cresc 18 0 0","crescendo)":"7 cresc 18 0 0","<(":"7 cresc 18 0 0","<)":"7 cresc 18 0 0","diminuendo(":"7 dim 18 0 0","diminuendo)":"7 dim 18 0 0",">(":"7 dim 18 0 0",">)":"7 dim 18 0 0","-(":"8 gliss 0 0 0","-)":"8 gliss 0 0 0","~(":"8 glisq 0 0 0","~)":"8 glisq 0 0 0","8va(":"3 8va 10 0 0","8va)":"3 8va 10 0 0","8vb(":"4 8vb 10 0 0","8vb)":"4 8vb 10 0 0","15ma(":"3 15ma 10 0 0","15ma)":"3 15ma 10 0 0","15mb(":"4 15mb 10 0 0","15mb)":"4 15mb 10 0 0",invisible:"32 0 0 0 0",beamon:"33 0 0 0 0",trem1:"34 0 0 0 0",trem2:"34 0 0 0 0",trem3:"34 0 0 0 0",trem4:"34 0 0 0 0",xstem:"35 0 0 0 0",beambr1:"36 0 0 0 0",beambr2:"36 0 0 0 0",rbstop:"37 0 0 0 0","/":"38 0 0 6 6","//":"38 0 0 6 6","///":"38 0 0 6 6","beam-accel":"39 0 0 0 0","beam-rall":"39 0 0 0 0",stemless:"40 0 0 0 0",rbend:"41 0 0 0 0"},f_near=[!0,!0,!0],f_note=[!1,!1,!1,!0,!0,!0,!1,!1,!0],f_staff=[!1,!1,!1,!1,!1,!1,!0,!0],func_tb=[d_near,d_slide,d_arp,d_upstaff,d_upstaff,d_trill,d_pf,d_cresc],ottava={"8va(":1,"8va)":1,"15ma(":1,"15ma)":1,"8vb(":1,"8vb)":1,"15mb(":1,"15mb)":1
},STEM_MIN=16,STEM_MIN2=14,STEM_MIN3=12,STEM_MIN4=10,STEM_CH_MIN=14,STEM_CH_MIN2=10,STEM_CH_MIN3=9,STEM_CH_MIN4=9,BEAM_DEPTH=3.2,BEAM_OFFSET=.25,BEAM_SHIFT=5,BEAM_SLOPE=.4,BEAM_STUB=8,SLUR_SLOPE=.5,GSTEM=15,GSTEM_XOFF=2.3,cache,min_tb=[[STEM_MIN,STEM_MIN,STEM_MIN2,STEM_MIN3,STEM_MIN4,STEM_MIN4],[STEM_CH_MIN,STEM_CH_MIN,STEM_CH_MIN2,STEM_CH_MIN3,STEM_CH_MIN4,STEM_CH_MIN4]],sharp_cl=new Int8Array([24,9,15,21,6,12,18]),flat_cl=new Int8Array([12,18,24,9,15,21,6]),sharp1=new Int8Array([-9,12,-9,-9,12,-9]),sharp2=new Int8Array([12,-9,12,-9,12,-9]),flat1=new Int8Array([9,-12,9,-12,9,-12]),flat2=new Int8Array([-12,9,-12,9,-12,9]),rest_tb=["r128","r64","r32","r16","r8","r4","r2","r1","r0","r00"],musicfont='url("data:application/font-ttf;base64,AAEAAAANAIAAAwBQRkZUTX30pOoAACfYAAAAHE9TLzJYnlnxAAABWAAAAFZjbWFwN+qJgQAAAsAAAAIqY3Z0IAAiAogAAATsAAAABGdhc3D//wADAAAn0AAAAAhnbHlmirg/swAABXwAAB4caGVhZAsOgeEAAADcAAAANmhoZWEIoQEcAAABFAAAACRobXR4cVoAlAAAAbAAAAEObG9jYQpbAnAAAATwAAAAim1heHAAiwDcAAABOAAAACBuYW1lNpjajAAAI5gAAAGDcG9zdA9CdgsAACUcAAACsQABAAAAAQAAtjNVVF8PPPUACwQAAAAAANGXIhcAAAAA1qodLf+6/QwD9ASUAAAACAACAAAAAAAAAAEAAASU/QwAXAQN/7r/vwP0AAEAAAAAAAAAAAAAAAAAAABDAAEAAABEAKsABQAAAAAAAgAAAAEAAQAAAEAALgAAAAAAAQG7AZAABQAIApkCzAAAAI8CmQLMAAAB6wAzAQkAAAIABQMAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUGZFZABAAADpXAMz/zMAXASUAvQAAAABAAAAAAAAAXYAIgAAAAABVQAAAZAAAABXAAAB4P/cA14AegMLAAAC0gAAAr//ugHWAAADCwAAAw4AAAMn/8gBrgAAASIAAAGQAAABfAAAAZAAAAGQAAABgQAAAZAAAAGQAAABgQAAAZkACQGYAAkB9AAAAQQAFAEEAAoCEQAAAhwAAAHAAAABSQAAAUoAAAFK//4BLAAAAjAAAAHgAAABDQAyAMgAAAENAAABCwAUAW4AAAENADIBQP/9ARgAAAJYAAAAtgAAAIIAAACCAAABLAAAASwAAADuAAAA/wAAAUkAAAGPAAAB2AAAAdgAAANTAAACM//wAyD/4QG1AAABtQAAAkQADQJEAA0EDQAAAhwADAAAAAAAAAADAAAAAwAAABwAAQAAAAABJAADAAEAAAAcAAQBCAAAAD4AIAAEAB4AAOAA4EjgUOBc4GLgaeB84IzgleCk4Kngs+EB4efiZOKA5KDkrOTA5M7k6uTu5QHlZ+Vp5W3mUOZV6Vz//wAAAADgAOBH4FDgXOBi4GngeuCA4JTgoOCp4LPhAeHn4mDigOSg5KzkwOTO5OHk7uUA5WflaeVs5lDmVelc//8AAyAEH74ftx+sH6cfoR+RH44fhx99H3kfcB8jHj4dxh2rG4wbgRtuG2EbTxtMGzsa1hrVGtMZ8RntFucAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABBgAAAwAAAAAAAAABAgAAAAIAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACICiAAAACoAKgAqADYAZgDOARABpgI4ApICpgNCA9QELAROBGIEtAUEBSQFagWqBeQGMAZwBrYHEAckB0oHcAesB8gH9ggiCDwIVgiMCJoIrAjSCOwJHAlGCaIJyAnwCgAKKApOCloKZgpyCn4KoArGCvwLSguqDB4MNAxaDIgMzA0WDTANVA40DvAPDgAAAAIAIgAAATICqgADAAcALrEBAC88sgcEAO0ysQYF3DyyAwIA7TIAsQMALzyyBQQA7TKyBwYB/DyyAQIA7TIzESERJzMRIyIBEO7MzAKq/VYiAmYAAAEAAAAAAZEBkAADAAAxESERAZEBkP5wAAEAAAAAAFcEAwAgAAARNTY1NCcmNTQ3BhUUFxYVFAcWFRQHBhUUFyY1NDc2NTQ1IxJXPxUlTU0lFT9XEiMCAwIYQzZgOTRmOjJLIjlhTWEYGGZMYDklSjI6ZjQ5YDZIAAP/3AACAd4CswAHAA8ARwAAACImNDYyFhQEIiY0NjIWFBc0NjMyFhUUBxYzMjY1NCcmJwMnEyY1NDc2MhYVFAYjIiY1NDcmIyIGFRQXFhcTFwMWFRQHBiImAZ4gGBggGP5+IBgYIBhbGxQTHiwYKCdBMDxBzyvTmDgoYDgbFBMeLBgoJ0EwQTvUK9eYOChgOAFSGCAYGCBUGCAYGCDYEhwaER0OGC8lKDAtOP7eIAEmj2A1LxQzIRIcGhEdDhgvJSgwMTQBJh/+1pBgNS8UMwAFAHr/NANeAlQAFwAbAB8AIwAnAAABMxUeARczFSMOAQcVIzUuAScjNTM+ATcRIxYXNxU2NyczJicHNQYHAdgoVXgHiooHeFUoVXgHiooHeFVwBWsoawVwcAVrKGsFAlSJCItgKGCLCImJCItgKGKJCP7lug7IyA66KLoOyMkOuwAAAAAEAAD9gQKnBJQAPwBGAFoAZwAAATYzMhYXFhUUBwYHFxYVFAYjIiY1NDYzMhYVFAYHFjMyNTQvAQYjIiY1NDc+ATc+AjcuAjU0NjceARUUBgcbATY1NCYjCwEOARUUFy4BNTQ2NycOAQcSITIDBhUUFz4BNTQmJw4BAY8SCzVnID98QisQAkVPUWBAMi5CPjAbKmUBEQscr8E5El4mBi0wFwMKBW9ROx5beR8fq25OFSA3Ry8yM2BJEY9sAQUBLwQpBAdJcBgaO0UBCgIqJkR7lDwiBLsgDlBNWEEsQEQtKzIBD4ASCr4Bt6yEZiNkHgUoKBEhdUgdip4YQHlyiahf/rX+nieRQGr+ngFeCkAwLToMWjpGYhS9cpdn/tYEDiEuUiMxj0gpTw8HdwACAAD9/ALSAgAAZABoAAABMjY1NCcmIyIHDgIHJicmJxEjETMRNjc2Nx4DFxYzMjY1NCcmIyIHFhcUFhUUBisBJjU0NzY3NjMyFxYXFRQGBwYjIicHFzYzMhYXFh0BBgcGIyImNTQ3MzIWFRQGFQYHFgEzESMB3j5KDRpJRjwCBgoEIhoeLhwcLh4aIgYUDBkPJyUxPRIkUi8xMg0CMyEFRAUaVScjXlU3CFpIHy00PyIiPzRCZh4oCDdWXUxyRAUhMwIPMDX+TXt7/iB4Si0tbEkFDhsKYicrH/4EBAD+ER8rJ2ILKhcdCRt7QjE2YhoQKAMNBB4rGTIUC0QZDU80UxJObxwNF0tKFz4sOUMSUzRQTjwyGSseBA4EJhAcA978AAAAA/+6/aUCwwD/ACYAMQA9AAA3NDYzMhcWFRQHDgEHNjc2NzY1NCcuASMiBgc+ATMyFhUUBwYjIiYFIiY1NDYyFhUUBiciJjU0NjMyFhUUBhOMZqNLLJdU9oTwdVskCzgeOSg8Zg0XGxwuRychLThGAoIWHRkqHhoaFxsaFxQcGylgdm1Bb/aISm4HQH1erj0xfkEhGFJEHRBLLzIgHmeSHBcWHB0VFh3yHhkWGRsUGR4AAAAAAgAA/wYBcgD6AAMABwAANzMTIwMzEyPclAKW3JQClvr+DAH0/gwAAAQAAP4KAh8DqgAJACAAYgBtAAAlFhc+ATU0JiMiAwInDgEVFBcuATU0NjcmJw4BBx4BMzIXHgEfAR0BFCMiJjU0NjMyFhUUBgcWMzI2NTQvAQYjIiY1NDc+ATc+AjcmNTQ2Nx4BFRQGBx4BFzYzMhcWFRQHBgMGFRQXPgE1NCcGAUkTBk1HVkIODRgBLDkfICpMOwUJcVUBBW2CAyIDBgICejZTMyglNTEnFSIjLAENCRWNmS4OTB4FIycSDllALxlJYQIIBBIIXDkyYzZkAwY3XilfdcRbEk8zNlb+4AELEAk0JykmEkEpOE4QPlpaeVNxfhogQBcXGwd/SDEkMzckIigBDDM1DwmNAZKKalEcUBgEICENwgdufxMzYltth0wRbiQCQzZidzAbA1YeIjkkJXszRiYmAAIAAP5jAkIBmgBjAGcAAAEyNjU0JyYjIgcOAQcmJyYnESMRMxE2NzY3HgMXFjMyNjU0JyYjIgcWFxQWFRQGKwEmNTQ3Njc2MzIXFhcVFAYHBiMiJwcXNjMyFhcWHQEGBwYjIiY1NDczMhYVFAYVBgcWATMRIwF+MjsKFTo4MAIMBB0TGCUWFiUYEx0EEQoTDCAdJzEOHEMlJygKAioaBDYEFUQjGElGLQZIOhglKzEbGzQoNVIYIAYtRkk9WzYEGioCDCYr/qNiYv6AYDskJFc7BR0LUhwiGf5qAzP+dBkiHFIIIhIXCBZiNSsoThUNIAILAxgiFCgQCTUVC0ArQQ4+WhYKEjw7EzIjLjUPQStAPzAoFCMYAwsDHw0WAxj8zQAAAAAD/8j+HgI2AMwAJgAvADsAADc0NjMyFxYVFAcOAQc2NzY3NjU0Jy4BIyIGBz4BMzIWFRQHBiMiJgUiJjQ2MhYUBiciJjU0NjMyFhUUBg9wUoI8I3hDxmnAXkceCS0YLSAwUgoSFhYlOSAZJSw5AgISFxQiGBUVEhYVEhEWFSFNXlczWsZsO1cGM2RKjC8pZjMaFEI2Fw08JigaGFN1FyQWFyIYwhgUERQVEBMZAAAAAAIAAP8GAa4A+gALABQAADMUFjMyNjU0JiMiBgc0NjIWFAYiJooqIyIrJyYlKIp9tH19tH1ieHlhZXV2YWeQkdKRkgAAAQAA/wYBIgD6AAkAADE3MxEXFSM1NxFkfUHwQfr+Ph4UFB4BLAAAAAEAAP8GAY8A+gA8AAA3MhUUBw4DBzYzMhYzMjc+AjMOAgcGBwYjIiYjIgYjIjU0Jz4FNTQnIgcyFhUUBiMiNTQ+AcfIBQ02QG82EyAbZBwYHgUQDAEBBQUBBxAaKRp0FR9WAgcBAiw+RzwoU04aHCk3Hkw8WPp+Gg4hLh1ELQwjDgMNCwUWFgMpDhgnJhABAiFFODwyOBhiATUlHh8pZyg5GQAAAQAA/wYBdQD6ADkAADcyFhUUBiMiJjU0NzYzMhcWFRQGBx4BFRQHBiMiJicmNDYzMhYVFAYjFjMyNjU0JicmNDc+ATQmIyJmGyInIRsyHzNZRiZERj0+UUskTSdXGCMyICIqJRsMPyQrSC4WFi9LKSQ8qhwXGyMrIy8aKhMiSC5ECwtFLUMnExYUHUwuIRsZHikxJyY6CAQiBAk3UDAAAAEAAP8GAZAA+gARAAAFFyM3NSM1NjUzATM/AREzFSMBRTLIMuGTo/77sAFjS0vRKSkxKPKA/o6Wkf7ZKAAAAAABAAD/BwF+APoALwAAFzYzMhYVFAYjFjMyNz4BNTQnJiMiBxMhDgErAQc2MzIXHgEVFAcOAiMiJy4BNTQSHCEbKiAcGiQxHBMJHhwoTkgKAWILNSXVBjlCUzEhK0MWQCslPCsQHl8gIBccICEeFB8gORwaNQEiJDp5Hh8VQSVPLxAQAhQJMhIjAAAAAAIAAP8GAYEA+gAJACwAABcyNjU0JiMiBxYTFhUUBiMiJjU0NjMmIyIGFT4CMzIWFRQGIyImJz4BMzIWyCktKigsMAfdGyMYHiIbEBY3NS8VGC0eTE9xSGFmAQFsWzA/0kUsIjAlngGfGiYZKB4bDB4jeF8LCglANkRZgnhpkRIAAQAA/wYBkAD7ACgAADciDgMHNz4IMzIWMzI2Nw4EFSM2NzY3NjcGIyImYRQaFAkRBQoBDAILBQsJDRAJL3UjGjsRG0UaHgiCAQgRaB4tER4lYKEFDgkbBnQBCwIJAQYBAwEmFw5Dp0FcQitFGzaHJzkKKAADAAD/BgGEAPoADgAcADQAABcOARUUFjMyNjU0LgM3PgE1NCYiBhUUHgMHLgE1NDY3MhYVFAYHHgEVFAYjIiY1NDaaNixYLCo/DyAdMT4zI0RSMwocEjFwMSlmSktlKjA6MnVNTHY5KhkkGx0wKR8OFxINE1oaIhwdMCggDxcTChU/GDw1M00BRjInNBcaOjU3SkgwJDUAAAIAAP8GAYEA+gAJACwAADciBhUUFjMyNyYDJjU0NjMyFhUUBiMWMzI2NQ4CIyImNTQ2MzIWFw4BIyImuSktKigsMAfdGyMYHiIbEBY3NS8VGC0eTE9xSGFmAQFsWzA/0kUsIjAlnv5hGiYZKB4bDB4jeF8LCglANkRZgnhpkRIAAQAJ/woBmQD5ADAAACUwFzY1NCYjDgEVFBcWMzI3NjcUHgEVDgEHIicmJzQmNTQ3MhYXFhUUBiMiJjU+ATMBLxIEPB8yQSchMCsoHCoJCBtVVk87OwQB2yRAESIkHCApAiAapAMFCBQiAmVrjjMqIhhYAQQDAVVQATk5ZgIrAuYCHhQnJCU5LhwWJgACAAn+ogGZAV4AOAA/AAAlMBc2NTQmIyIHERYzMjc2NxQeARUOAQcjFSM1JicmJzQmNTQ3NTMVMjYzMhYXFhUUBiMiJjU+ATMDEQYVFBcWAS8SBDwfAxAMDCsoHCoJCBtRVQEjPS47BAGrIwMHAyRAESIkHCApAiAaej0nCqQDBQgUIgT+SwQiGFgBBAMBVFEBaGsJLTlmAisCyxlpZgEeFCckJTkuHBYm/pcBli6RjjMNAAABAAD/BgH0APoACwAANTM1MxUzFSMVIzUj10bX10bXI9fXRtfXAAAAAQAU/gYA4wIAABMAABMWBwYnJgI1NBI3NhcWBwYCFRQS3AcNCQVJa2tJCQsGBjxGR/4WCAUDBlcBIH18ASJWCwcGCEn+54iG/uUAAAEACv4CANwB/QATAAATNhI1NAInJjc2FxYSFRQCBwYnJhQ7R0Y8CQwKB0lra0kICwb+FkkBG4aIARlJCwQECVb+3nx9/uBXCQkEAAAEAAD/TAIRAKoAAwAHABsAJQAAJTMRIwEzESM3BhUUFx4BFzMyNzY0Jy4BJzAjIgQUBiMiJjU0NjIB6Sgo/hcnJ5cFAwpVLg0zEwUDCVYuDTYBQXlnZnp5zqr+ogFe/qLzDA4LCyJHBCMJHAsiRwQmeEVEOD9HAAACAAD/JAIcANwAAwAPAAA3FSE1JTMVITUzESM1IRUjGQHq/f0ZAeoZGf4WGUaMjJYyMv5IMjIAAAIAAP9/AcAAgQATAB0AADcGFRQXHgEXMzI3NjQnLgEnMCMiBBQGIyImNTQ2Mm8FAwpVLg0zEwUDCVYuDTYBQXlnZnp5zj8MDgsLIkcEIwkcCyJHBCZ4RUQ4P0cAAgAA/2wBSACUAA0AGwAAJSYjIgYVFBcWMzI2NTQ3FhUUBiMiJyY1NDYzMgEkDSU8lwYLJjyXEA9+SE8kD35IT0QXYSsKCRdhKwkXHh1DZ0MeHUNnAAAAAAEAAP90AUoAiwAOAAAVNDY3NjMyFhUUBwYjIiZdSB4RM0OlGBsxQSE+VBMHODJ1MAg5AAAB//7/bwFMAJEACwAAJzcXNxcHFwcnByc3AhuMjBuGhhyLixyGcSB2dSBwcCF1dSFwAAAABQAA/2oBLACWAAUACwARABcAHwAAFwcWMzI3LwEGFRQXPwEmIyIHHwE2NTQnBjQ2MhYUBiKWRx0qKR9dRx0dXEgfKSodXEcdHfJYfFhYfBJIHR1aSR8pKh1YSB0dWkgfKSodhXxYWHxYAAAAAQAA/wYCMAD6AAMAABUBMwEBuHj+R/oB9P4MAAEAAP/OAGQAMgAHAAAWIiY0NjIWFEcqHR0qHTIdKh0dKgAAAAIAMv9kAQ0BsAAKABYAADciBh0BNjc2NTQmNzIWFRQHBiMRMxE2lBUqHCwuIAciOU9SOiMjeh4SywNCPzYbJiYyI0VQUgJM/rw0AAACAAD+hgDFAXoAAwAMAAAXNzUHERU3ESM1BxE3HJCQqRmsAWUtli0BSeg0/cDiMwJDAQAAAgAA/o8BDAF1AAMAHwAANxU3NQMjNQc1NzUHNTc1MxU3NTMVNxUHFTcVBxUjNQdSZmYZOTk5ORlmGDw8PDwYZk20HLX+Ja8RVQ63EFcOsqoat68PUxK0D1MPsaodAAAAAQAU/4QBCwB6AB4AABc1JicHMBUjNTM3JzAjNTMVFhc3MDUzFSMGBxcwMxXDKAwzSDkzMzlIIRI0SDkhEzQ5fDsmDTM7SjIySDkiETM5RyIRNEgABAAA/2oBbAGwABAAHgAtADwAADcOAR0BMjc2NzY3NjU0JyYjNzIWFRQHBgcGIxEzETYXDgEdATI3Njc2NTQnJiM3MhYVFAcGBw4BIxEzETZOER4LGwQCHwwEChARGR0rCRgrNS8fGdERHQ0hHQsGCxAPFh8qCxkoFjcWHht9AR4QyyYFAys0DRkeFBUmOSESIDk0QAJG/sEyJgEdEcsuLzATExwWFSY2JBYcPi8bJQJG/sEyAAAAAAIAMv9kAQ0BsAAKABYAADciBhUUFxYXNTQmJzIXETMRIicmNTQ2qxcgLi4aKjM6IyM6Uk85eiYbMEVCA8sSHiY0AUT9tFJQRSMyAAAB//0AAAE/APQAGAAANwYjIiY1ND8BNi8BJjU0NjMyMRcFFhUUBxICAwcJBs8ODs0ICwcBAgEfDg4BARAICgNJBwZPAwsKEgFrBg4NBQAAAAEAAAAAARgBNQAFAAAxGwEjJweMjEFYWgE1/svGxgAAAgAAAAACWAFKAA4AGQAAMTQ2MzIeAhUjLgEiBgchIiY0NjMyFhUUBrN5OWtVMwoLpuKmCwEhFyUlFxkjI5iyLFGATW6Ghm4kMCQkGBkjAAABAAAAAAC2AS0AFwAAEzIWFxYVFAcOASMnJjU0NjU0Iy4BNTQ2VhsbEBoyGUQQBgFHFBsoLQEtDBEdMD08HS0DAQIIaxMPASYcHjEAAQAA/wYAggD6AAMAADUzEyOAAoL6/gwAAQAAAAAAggD6AAMAADUzFSOCgvr6AAAAAQAA/4MBLAAAAAMAADEhFSEBLP7UfQAAAQAAAAABLAB9AAMAADUhFSEBLP7UfX0AAQAA/n4A6wGHABMAABMXBxcmIyIGFRQXJjU0NjMyFyc3Kb1nbDI0HyY4eDQlIiKHZAGH5dnPLiQdNTRLTSMtFby0AAABAAD/DQEAAMAAFgAANw4CIyImNTQ2MhYVFAcyNjc2MhcDJ6sDGRoTKzcmOCkXIjMhAhUDljA8AQcEKSgfIB4ZHRshLAIC/m8QAAAAAQAA/gwBSADAACQAABcGIyImNTQ2MzIWFRQHMj8BBiMiJjU0NjMyFhUUBzI3NjIXAyerKCErNycbHCkXQQs8NhgrNycbHCkXSC4CFQPFLcQMKCggIB8ZHRsiygwpKB8gHhkdG00CAv1uDAAAAQAA/gwBjwHAADYAADcGIyImNTQ2MzIWFRQHMj8BIg4BIyImNTQ2MzIWFRQHMjc2MhcBJxMGIyImNTQ2MzIWFRQHMjf2KB8rNycbHCkXPws6ASAcEys3JxscKRdILgEWA/70LVUoISs3JxscKRdBCzwMKCggIB8ZHRsiywkEKSgfIB4ZHRtNAgL8bgwBJAwoKCAgHxkdGyIAAAAAAQAA/QwB2gHAAEUAABMGIyImNTQ2MzIWFRQHMj8BBiMiJjU0NjMyFhUUBzI/AQYjIiY1NDYzMhYVFAcyPwEiDgEjIiY1NDYyFhUUBzI3NjIXASerKCErNycbHCkXQQs6KCErNycbHCkXQQs6KB8rNycbHCkXPws6ASAcEys3JjgpF0guAhUD/qkt/jwMKCggIB8ZHRsiygwoKCAgHxkdGyLKDCgoICAfGR0bIssJBCkoHyAeGR0bTQIC+24MAAAAAQAA/QwCGQKuAFYAACUGIyImNTQ2MzIWFRQHMj8BBiMiJjU0NjMyFhUUBzI/ASIOASMiJjU0NjMyFhUUBzI3NjIXAScTBiMiJjU0NjMyFhUUBzI/AQYjIiY1NDYzMhYVFAcyNwE/KCErNycbHCkXQQs2KB8rNycbHCkXPws0ASAcEys3JxscKRdILgEWA/5qLVUoISs3JxscKRdBCzooISs3JxscKRdBCzQMKCggIB8ZHRsixAwoKCAgHxkdGyLHCQQpKB8gHhkdG00CAvqADAEkDCgoICAfGR0bIsgMKCggIB8ZHRsiAAEAAP8aA1IA5gALAAA1MxUhNTMRIzUhFSMZAyAZGfzgGeZ9ff40fX0AAAAAA//w/wYCJgD6AAcADwATAAA2IiY0NjIWFAAiJjQ2MhYUBQEzAVAyIyMyIwGIMiMjMiP90gG4fv5HSyMyIyMy/s8jMiMjMloB9P4MAAT/4f8GAwcA+gAHAA8AEwAXAAA2IiY0NjIWFAAiJjQ2MhYUBQEzATMBMwFBMiMjMiMCdzIjIzIj/OMBuHv+R3kBuHv+R0sjMiMjMv7PIzIjIzJaAfT+DAH0/gwAAQAA//0BtQDUAC8AACUyNjU0JwYjIjU+ATMyFhUUBwYjIi8BJiMiBhUUFzYzMhUUByInJjU0NzYzFh8BFgF2FRwWFBIcAQ8JIC0pFxwkHqggDxYcFRQTHBkZGBwoFiAoF6giJSkcJxAMGw8VQiYzJBUVghYoHicPDB0gAxoiLTMkEwIQghcAAAEAAP/NAbUBAwA2AAAXIiY1NDc2MxYfATUzFRcWMzI2NTQnBiMiNT4BMzIWFRQHBiMiLwEVIzUnJiMiBhUUFzYzMhUUTSAtKBYgKBcuHlwiDxUcFhQSHAEPCSAtKRccJB4uHlwgDxYcFRQTHANDJjMkEwIQJGmARxcpHCcQDBsPFUImMyQVFSRsg0cWKB4nDwwdIAABAA0AAAJFAOAACwAANyc3FzcXNxcHJwcnIhWOZXhqTRaSaXRpLhmZfHx8VBehfHx8AAAAAQAN/8sCRQERABMAACUHJwcnNxc3NTMXNxc3FwcnBxUjARZAaUsVjmUWGwFGak8UkmkZG0ZGfE4ZmXwXlntKfFUYoXwblgAABAAA//wD9AJ/AAkAlACgAKoAAAUiJjQ2MzIWFAYlJjU0NzYzMhYVFAcOBwcWMzI2NTQ2Ny4CPQEeARUUBiMiJwYjIiYnDgEiJicmIyIGBwYjIjU0Njc+CTc2NTQmNTQ/AQ4BFDMyNxcOASMiJjU0PgIzMhYVFAYjIiYnNxYzMjY1NCYnBwYVFBYVFA8BHgEzMj4GNz4BNTQnJiMiBhUUBTY1NCYnDgEVFAPWCxMTCwwSEf3pIxwgThsjCgQMCxAKEgcSASosFTJDXSCBXrq0UUJBIyQ8IkETMCYgGxwaEg0tA1csCjohDhsPEQYKAwcDCQMCQgI0WnIgNRwQKTYwFBcfPXFIfntCJR05EQ0aNCEsXF8mAkYBJhE7DwQHBwkHDAgSLDUiBAQWHC8BPFoXEj8zAhIYEhIYEl84JTUlKykfIRMJEQ4QCg8GDgEzMBpSXxksWTQGATyxa0ZfOTooGCkbFiAtIwE6BwszFAgRBgwCEAMZDCkOCAIWQR4HDNcHWFAwCEUsIRofSEcvXDwlPispDC0dGyNJBaAIBhlEGggEowxYAgIHBAsHDyAwLyAHDhI5KyJwBYEiSRUdWUM+AAIADAAKAdMBzwAKAI8AACU0JiMiBhQWMzI2Jw4BIyImNDYzMhYXNjU0JyYjIiY0NjMyFx4BFxYzMjU0Jy4BNTQ2MzIWFRQGBxQzMjc+ATc2MzIWFRQGIyIGBwYVFDMyNjMyFhQGIyImIyIGFRQXHgEXFhUUBiMiJy4BJyYjIhUUFhUUBiMiJjQ2NTQjIgcOAQcGIyImNTQ3NjMyNzY1NAEWGA8QFRYPEBeJGSYOGRsaGQ0qGCUMFBgdHBkXEhALAxQLEhQBAiceFBIbIwEWEA0RAQ0MGhMeGxIbFQ0QIRsrDhwbHRkPJxQXEgsUOA0OGRcTFAwBExEKEiogExIdJhcNDhIDERIMFBoNDBYjEg3uEBQTIhYVCgElGSobJQIDFg4KExwoHQwLPhYNGA0IFycPFxobFhEjGSoQEzgPDhsUESMGCw4PFicdKBomCAoWChIDCw0ZExsOCzkVDx8eMBMUGBokMRckDhI9DAcWFBgODRINDBoAAAACAAD95AIdANwAAwAPAAA3FSE1JTMVITUzEyMDIRUjGQHq/f0ZAeoZARkB/hYZRoyMljIy/QgBcjIAAAAAAAwAlgABAAAAAAABAAcAEAABAAAAAAACAAcAKAABAAAAAAADACIAdgABAAAAAAAEAAcAqQABAAAAAAAFAAsAyQABAAAAAAAGAAcA5QADAAEECQABAA4AAAADAAEECQACAA4AGAADAAEECQADAEQAMAADAAEECQAEAA4AmQADAAEECQAFABYAsQADAAEECQAGAA4A1QBhAGIAYwAyAHMAdgBnAABhYmMyc3ZnAABSAGUAZwB1AGwAYQByAABSZWd1bGFyAABGAG8AbgB0AEYAbwByAGcAZQAgADIALgAwACAAOgAgAGEAYgBjADIAcwB2AGcAIAA6ACAAOQAtADMALQAyADAAMQA4AABGb250Rm9yZ2UgMi4wIDogYWJjMnN2ZyA6IDktMy0yMDE4AABhAGIAYwAyAHMAdgBnAABhYmMyc3ZnAABWAGUAcgBzAGkAbwBuACAAMQAuADAAAFZlcnNpb24gMS4wAABhAGIAYwAyAHMAdgBnAABhYmMyc3ZnAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABEAAAAAQACAQIBAwEEAQUBBgEHAQgBCQEKAQsBDAENAQ4BDwEQAREBEgETARQBFQEWARcBGAEZARoBGwEcAR0BHgEfASABIQEiASMBJAElASYBJwEoASkBKgErASwBLQEuAS8BMAExATIBMwE0ATUBNgE3ATgBOQE6ATsBPAE9AT4BPwFAAUEBQgYubm9kZWYHdW5pRTAwMAd1bmlFMDQ3B3VuaUUwNDgHdW5pRTA1MAd1bmlFMDVDB3VuaUUwNjIHdW5pRTA2OQd1bmlFMDdBB3VuaUUwN0IHdW5pRTA3Qwd1bmlFMDgwB3VuaUUwODEHdW5pRTA4Mgd1bmlFMDgzB3VuaUUwODQHdW5pRTA4NQd1bmlFMDg2B3VuaUUwODcHdW5pRTA4OAd1bmlFMDg5B3VuaUUwOEEHdW5pRTA4Qgd1bmlFMDhDB3VuaUUwOTQHdW5pRTA5NQd1bmlFMEEwB3VuaUUwQTEHdW5pRTBBMgd1bmlFMEEzB3VuaUUwQTQHdW5pRTBBOQd1bmlFMEIzB3VuaUUxMDEHdW5pRTFFNwd1bmlFMjYwB3VuaUUyNjEHdW5pRTI2Mgd1bmlFMjYzB3VuaUUyNjQHdW5pRTI4MAd1bmlFNEEwB3VuaUU0QUMHdW5pRTRDMAd1bmlFNENFB3VuaUU0RTEHdW5pRTRFMgd1bmlFNEUzB3VuaUU0RTQHdW5pRTRFNQd1bmlFNEU2B3VuaUU0RTcHdW5pRTRFOAd1bmlFNEU5B3VuaUU0RUEHdW5pRTRFRQd1bmlFNTAwB3VuaUU1MDEHdW5pRTU2Nwd1bmlFNTY5B3VuaUU1NkMHdW5pRTU2RAd1bmlFNjUwB3VuaUU2NTUHdW5pRTk1QwAAAAAAAAH//wACAAAAAQAAAADVs2WlAAAAANGXIhcAAAAA1qodLQ==")',defined_font={},font_tb={},fid=1,font_scale_tb={serif:1.05,serifBold:1.05,"sans-serif":1.1,"sans-serifBold":1.1,Palatino:1.1,Mono:1.35},fmt_lock={},cfmt={aligncomposer:1,breaklimit:.7,breakoneoln:!0,cancelkey:!0,composerspace:6,dblrepbar:":][:",decoerr:!0,dynalign:!0,fullsvg:"",gracespace:new Float32Array([4,8,11]),graceslurs:!0,hyphencont:!0,indent:0,infoname:'R "Rhythm: "\nB "Book: "\nS "Source: "\nD "Discography: "\nN "Notes: "\nZ "Transcription: "\nH "History: "',infospace:0,keywarn:!0,leftmargin:1.4*CM,lineskipfac:1.1,linewarn:!0,maxshrink:.65,maxstaffsep:2e3,maxsysstaffsep:2e3,measurefirst:1,measurenb:-1,musicspace:6,parskipfac:.4,partsspace:8,pagewidth:21*CM,printmargin:0,rightmargin:1.4*CM,rbdbstop:!0,rbmax:4,rbmin:2,scale:1,slurheight:1,staffsep:46,stemheight:21,stretchlast:.25,stretchstaff:!0,subtitlespace:3,sysstaffsep:34,textspace:14,titlespace:6,titletrim:!0,topspace:22,tuplets:[0,0,0,0],vocalspace:10,writefields:"CMOPQsTWw",wordsspace:5},textopt={align:"j",center:"c",fill:"f",justify:"j",ragged:"f",right:"r",skip:"s"},posval={above:C.SL_ABOVE,auto:0,below:C.SL_BELOW,down:C.SL_BELOW,hidden:C.SL_HIDDEN,opposite:C.SL_HIDDEN,under:C.SL_BELOW,up:C.SL_ABOVE};Abc.prototype.style_font=style_font;var abc_utf={"=D":"","=H":"","=T":"","=d":"","=h":"","=t":"","/O":"","/o":"","/L":"","/l":"",vL:"",vl:"",vd:"",".i":"",AA:"",aa:"",AE:"",ae:"",DH:"",dh:"",OE:"",oe:"",ss:"",TH:"",th:""},oct_acc={1:"",2:"",3:"",4:"&#x1d12a;",5:"&#x1d12b;"},include=0;Abc.prototype.tosvg=tosvg;var gene,staff_tb,nstaff,tsnext,realwidth,insert_meter,spf_last,space_tb=new Float32Array([7,10,14.15,20,28.3,40,56.6,80,100,120]),smallest_duration,dx_tb=new Float32Array([10,10,11,13,13]),hw_tb=new Float32Array([4.5,5,6,7,8]),w_note=new Float32Array([3.5,3.7,5,6,7]),delta_tb={t:-4,c:0,b:4,p:-6},rest_sp=[[18,18],[12,18],[12,12],[0,12],[6,8],[10,10],[6,4],[10,0],[10,4],[10,10]],delpit=[0,-7,-14,0],MAXPIT=96,blocks=[],a_gch,a_dcn,multicol,maps={},qplet_tb=new Int8Array([0,1,3,2,3,0,2,0,3,0]),ntb="CDEFGABcdefgab",note_pit=new Int8Array([0,2,4,5,7,9,11]),reg_dur=/(\d*)(\/*)(\d*)/g,cde2fcg=new Int8Array([0,2,4,-1,1,3,5]),cgd2cde=new Int8Array([0,4,1,5,2,6,3]),acc2=new Int8Array([-2,-1,3,1,2]),nil=["0"],char_tb=[nil,nil,nil,nil,nil,nil,nil,nil,nil," ","\n",nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil," ","!",'"',"i","\n",nil,"&",nil,"(",")","i",nil,nil,"-","!dot!",nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,"|","i","<","n","<","i","i","n","n","n","n","n","n","n","!fermata!","d","d","d","!emphasis!","!lowermordent!","d","!coda!","!uppermordent!","d","d","!segno!","!trill!","d","d","d","n","d","n","[","\\","|","n","n","i","n","n","n","n","n","n","n","d","d","d","d","d","d","d","d","d","d","d","d","d","!upbow!","!downbow!","d","n","n","n","{","|","}","!gmark!",nil],cw_tb=new Float32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.25,.333,.408,.5,.5,.833,.778,.333,.333,.333,.5,.564,.25,.564,.25,.278,.5,.5,.5,.5,.5,.5,.5,.5,.5,.5,.278,.278,.564,.564,.564,.444,.921,.722,.667,.667,.722,.611,.556,.722,.722,.333,.389,.722,.611,.889,.722,.722,.556,.722,.667,.556,.611,.722,.722,.944,.722,.722,.611,.333,.278,.333,.469,.5,.333,.444,.5,.444,.5,.444,.333,.5,.5,.278,.278,.5,.278,.778,.5,.5,.5,.5,.333,.389,.278,.5,.5,.722,.5,.5,.444,.48,.2,.48,.541,.5]),info_font_init={A:"info",C:"composer",O:"composer",P:"parts",Q:"tempo",R:"info",T:"title",X:"title"},output="",style="\n.fill {fill: currentColor}\n.stroke {stroke: currentColor; fill: none}\n.music text, .music tspan {fill:currentColor}",font_style="",posx=cfmt.leftmargin/cfmt.scale,posy=0,img={width:cfmt.pagewidth,lm:cfmt.leftmargin,rm:cfmt.rightmargin},defined_glyph={},defs="",fulldefs="",stv_g={scale:1,dy:0,st:-1,v:0,g:0},block={},tgls={brace:{x:0,y:0,c:""},sgno:{x:-6,y:0,c:""},coda:{x:-12,y:6,c:""},tclef:{x:-8,y:0,c:""},cclef:{x:-8,y:0,c:""},bclef:{x:-8,y:0,c:""},pclef:{x:-6,y:0,c:""},stclef:{x:-8,y:0,c:""},scclef:{x:-8,y:0,c:""},sbclef:{x:-7,y:0,c:""},spclef:{x:-6,y:0,c:""},meter0:{c:""},meter1:{c:""},meter2:{c:""},meter3:{c:""},meter4:{c:""},meter5:{c:""},meter6:{c:""},meter7:{c:""},meter8:{c:""},meter9:{c:""},"meter+":{c:""},"meter(":{c:""},"meter)":{c:""},csig:{x:0,y:0,c:""},ctsig:{x:0,y:0,c:""},HDD:{x:-7,y:0,c:""},breve:{x:-6,y:0,c:""},HD:{x:-5.2,y:0,c:""},Hd:{x:-3.8,y:0,c:""},hd:{x:-3.7,y:0,c:""},ghd:{x:2,y:0,c:"",sc:.66},pshhd:{x:-3.7,y:0,c:""},pfthd:{x:-3.7,y:0,c:""},x:{x:-3.7,y:0,c:""},"circle-x":{x:-3.7,y:0,c:""},srep:{x:-5,y:0,c:""},dot:{x:-2,y:0,c:""},"acc-1":{x:-3,y:0,c:""},acc3:{x:-2,y:0,c:""},acc1:{x:-3,y:0,c:""},acc2:{x:-3,y:0,c:""},"acc-2":{x:-3,y:0,c:""},"acc-1_1_4":{x:-3,y:0,c:""},accent:{x:-3,y:2,c:""},marcato:{x:-3,y:0,c:""},hld:{x:-7,y:0,c:""},brth:{x:0,y:0,c:""},r00:{x:-1.5,y:0,c:""},r0:{x:-1.5,y:0,c:""},r1:{x:-3.5,y:6,c:""},r2:{x:-3.2,y:0,c:""},r4:{x:-3,y:0,c:""},r8:{x:-3,y:0,c:""},r16:{x:-4,y:0,c:""},r32:{x:-4,y:0,c:""},r64:{x:-4,y:0,c:""},r128:{x:-4,y:0,c:""},mrest:{x:-10,y:0,c:""},mrep:{x:-6,y:0,c:""},mrep2:{x:-9,y:0,c:""},turn:{x:-5,y:4,c:""},turnx:{x:-5,y:4,c:""},umrd:{x:-7,y:2,c:""},lmrd:{x:-7,y:2,c:""},ped:{x:-10,y:0,c:""},pedoff:{x:-5,y:0,c:""},longa:{x:-6,y:0,c:""}},glyphs={acc1_1_4:'<g id="acc1_1_4">\n\t<path d="m0 7.8v-15.4" class="stroke"/>\n\t<path class="fill" d="M-1.8 2.7l3.6 -1.1v2.2l-3.6 1.1v-2.2z\n\t\tM-1.8 -3.7l3.6 -1.1v2.2l-3.6 1.1v-2.2"/>\n</g>',acc1_3_4:'<g id="acc1_3_4">\n\t<path d="m-2.5 8.7v-15.4M0 7.8v-15.4M2.5 6.9v-15.4" class="stroke"/>\n\t<path class="fill" d="m-3.7 3.1l7.4 -2.2v2.2l-7.4 2.2v-2.2z\n\t\tM-3.7 -3.2l7.4 -2.2v2.2l-7.4 2.2v-2.2"/>\n</g>',"acc-1_3_4":'<g id="acc-1_3_4">\n    <path class="fill" d="m0.6 -2.7\n\tc-5.7 -3.1 -5.7 3.6 0 6.7c-3.9 -4 -4 -7.6 0 -5.8\n\tM1 -2.7c5.7 -3.1 5.7 3.6 0 6.7c3.9 -4 4 -7.6 0 -5.8"/>\n    <path d="m1.6 3.5v-13M0 3.5v-13" class="stroke" stroke-width=".6"/>\n</g>',pmsig:'<path id="pmsig" class="stroke" stroke-width="0.8"\n\td="m0 -7a5 5 0 0 1 0 -10a5 5 0 0 1 0 10"/>',pMsig:'<g id="pMsig">\n\t<use xlink:href="#pmsig"/>\n\t<path class="fill" d="m0 -10a2 2 0 0 1 0 -4a2 2 0 0 1 0 4"/>\n</g>',imsig:'<path id="imsig" class="stroke" stroke-width="0.8"\n\td="m3 -8a5 5 0 1 1 0 -8"/>',iMsig:'<g id="iMsig">\n\t<use xlink:href="#imsig"/>\n\t<path class="fill" d="m0 -10a2 2 0 0 1 0 -4a2 2 0 0 1 0 4"/>\n</g>',hl:'<path id="hl" class="stroke" stroke-width="1" d="m-6 0h12"/>',hl1:'<path id="hl1" class="stroke" stroke-width="1" d="m-7 0h14"/>',hl2:'<path id="hl2" class="stroke" stroke-width="1" d="m-9 0h18"/>',ghl:'<path id="ghl" class="stroke" d="m-3.5 0h7"/>',rdots:'<g id="rdots" class="fill">\n\t<circle cx="0" cy="-9" r="1.2"/>\n\t<circle cx="0" cy="-15" r="1.2"/>\n</g>',grm:'<path id="grm" class="fill" d="m-5 -2.5\n\tc5 -8.5 5.5 4.5 10 -2 -5 8.5 -5.5 -4.5 -10 2"/>',stc:'<circle id="stc" class="fill" cx="0" cy="-3" r="1.2"/>',sld:'<path id="sld" class="fill" d="m-7.2 4.8\n\tc1.8 .7 4.5 -.2 7.2 -4.8 -2.1 5 -5.4 6.8 -7.6 6"/>',emb:'<path id="emb" class="stroke" stroke-width="1.2" stroke-linecap="round"\n\td="m-2.5 -3h5"/>',roll:'<path id="roll" class="fill" d="m-6 0\n\tc0.4 -7.3 11.3 -7.3 11.7 0 -1.3 -6 -10.4 -6 -11.7 0"/>',upb:'<path id="upb" class="stroke" d="m-2.6 -9.4\n\tl2.6 8.8 2.6 -8.8"/>',dnb:'<g id="dnb">\n\t<path d="M-3.2 -2v-7.2m6.4 0v7.2" class="stroke"/>\n\t<path d="M-3.2 -6.8v-2.4l6.4 0v2.4" class="fill"/>\n</g>',dplus:'<path id="dplus" class="stroke" stroke-width="1.7"\n\td="m0 -.5v-6m-3 3h6"/>',lphr:'<path id="lphr" class="stroke" stroke-width="1.2"\n\td="m0 0v18"/>',mphr:'<path id="mphr" class="stroke" stroke-width="1.2"\n\td="m0 0v12"/>',sphr:'<path id="sphr" class="stroke" stroke-width="1.2"\n\td="m0 0v6"/>',sfz:'<text id="sfz" x="-5" y="-7" style="font-family:serif; font-style:italic; font-size:14px">\n\ts<tspan font-size="16" font-weight="bold">f</tspan>z</text>',trl:'<text id="trl" x="-2" y="-4"\n\tstyle="font-family:serif; font-weight:bold; font-style:italic; font-size:16px">tr</text>',opend:'<circle id="opend" class="stroke"\n\tcx="0" cy="-3" r="2.5"/>',snap:'<path id="snap" class="stroke" d="m-3 -6\n\tc0 -5 6 -5 6 0 0 5 -6 5 -6 0\n\tM0 -5v6"/>',thumb:'<path id="thumb" class="stroke" d="m-2.5 -7\n\tc0 -6 5 -6 5 0 0 6 -5 6 -5 0\n\tM-2.5 -9v4"/>',wedge:'<path id="wedge" class="fill" d="m0 -1l-1.5 -5h3l-1.5 5"/>',ltr:'<path id="ltr" class="fill"\n\td="m0 -.4c2 -1.5 3.4 -1.9 3.9 .4 0.2 .8 .7 .7 2.1 -.4\n\tv0.8c-2 1.5 -3.4 1.9 -3.9 -.4 -.2 -.8 -.7 -.7 -2.1 .4z"/>',custos:'<g id="custos">\n\t<path class="fill" d="m-4 0l2 2.5 2 -2.5 2 2.5 2 -2.5\n\t\t-2 -2.5 -2 2.5 -2 -2.5 -2 2.5"/>\n\t<path class="stroke" d="m3.5 0l5 -7"/>\n</g>',triangle:'<path id="triangle" class="fill" d="m-3.7 -3.2l7.4 0 -3.7 6.4 -3.7 -6.4"/>',diamond:'<path id="diamond" class="fill" d="m0 3.5l-3.7 -3.5 3.7 -3.5 3.7 3.5z"/>',oct:'<text id="oct" style="font-family:serif; font-size:12px">8</text>'},anno_type=["bar","clef","custos","","grace","key","meter","Zrest","note","part","rest","yspace","staves","Break","tempo","","block","remark"],anno_start=user.anno_start?a_start:empty_function,anno_stop=user.anno_stop?a_stop:empty_function;Abc.prototype.out_svg=function(e){output+=e},Abc.prototype.sx=sx,Abc.prototype.sy=sy,Abc.prototype.sh=function(e){return stv_g.st<0?e/stv_g.scale:e},Abc.prototype.ax=function(e){return e+posx},Abc.prototype.ay=function(e){return stv_g.st<0?posy-e:posy+(stv_g.dy-e)*stv_g.scale-stv_g.dy},Abc.prototype.ah=function(e){return stv_g.st<0?e:e*stv_g.scale},Abc.prototype.out_sxsy=out_sxsy,Abc.prototype.xypath=xypath;var deco_str_style={crdc:{dx:0,dy:5,style:"font-family:serif; font-style:italic; font-size:14px"},dacs:{dx:0,dy:3,style:"font-family:serif; font-size:16px",anchor:' text-anchor="middle"'},fng:{dx:0,dy:1,style:"font-family:Bookman; font-size:8px",anchor:' text-anchor="middle"'},pf:{dx:0,dy:5,style:"font-family:serif; font-weight:bold; font-style:italic; font-size:16px"},"@":{dx:0,dy:5,style:"font-family:sans-serif; font-size:12px"}},deco_val_tb={arp:out_arp,cresc:out_cresc,dim:out_dim,ltr:out_ltr,"8va":out_8va,"8vb":out_8vb,"15ma":out_15ma,"15mb":out_15mb},deco_l_tb={glisq:out_glisq,gliss:out_gliss};Abc.prototype.blk_out=blk_out,Abc.prototype.blk_flush=blk_flush;var par_sy,cur_sy,voice_tb,curvoice,staves_found,vover,tsfirst,w_tb=new Uint8Array([2,1,8,0,3,5,6,9,9,0,9,3,0,7,0,0,0,0]),note_names="CDEFGAB",latin_names=["Do","Re","Mi","Fa","Sol","La","Si"],acc_name=["bb","b","","#","##"];font_init(),init_tune(),Abc.prototype.add_style=function(e){style+=e},Abc.prototype.cfmt=function(){return cfmt},Abc.prototype.get_a_gch=function(){return a_gch},Abc.prototype.get_cur_sy=function(){return cur_sy},Abc.prototype.get_curvoice=function(){return curvoice},Abc.prototype.get_delta_tb=function(){return delta_tb},Abc.prototype.get_decos=function(){return decos},Abc.prototype.get_fname=function(){return parse.fname},Abc.prototype.get_font=get_font,Abc.prototype.get_font_style=function(){return font_style},Abc.prototype.get_glyphs=function(){return glyphs},Abc.prototype.get_img=function(){return img},Abc.prototype.get_maps=function(){return maps},Abc.prototype.get_multi=function(){return multicol},Abc.prototype.get_newpage=function(){if(block.newpage)return block.newpage=!1,!0},Abc.prototype.get_posy=function(){var e=posy;return posy=0,e},Abc.prototype.get_staff_tb=function(){return staff_tb},Abc.prototype.get_top_v=function(){return par_sy.top_voice},Abc.prototype.get_tsfirst=function(){return tsfirst},Abc.prototype.get_voice_tb=function(){return voice_tb},Abc.prototype.info=function(){return info},Abc.prototype.set_cur_sy=function(e){cur_sy=e},Abc.prototype.set_tsfirst=function(e){tsfirst=e},Abc.prototype.set_xhtml=function(e){var t=write_text;return write_text=e,t},Abc.prototype.sort_pitch=sort_pitch,Abc.prototype.stv_g=function(){return stv_g},Abc.prototype.svg_flush=svg_flush;var hook_init,self=this}};var Abc=abc2svg.Abc;"object"==typeof module&&"object"==typeof exports&&(exports.abc2svg=abc2svg,exports.Abc=Abc),abc2svg.loadjs=function(e,t,r){r&&r()},abc2svg.modules={ambitus:{fn:"ambitus-1.js"},beginps:{fn:"psvg-1.js"},break:{fn:"break-1.js"},capo:{fn:"capo-1.js"},clip:{fn:"clip-1.js"},voicecombine:{fn:"combine-1.js"},diagram:{fn:"diag-1.js"},equalbars:{fn:"equalbars-1.js"},grid:{fn:"grid-1.js"},grid2:{fn:"grid2-1.js"},MIDI:{fn:"MIDI-1.js"},percmap:{fn:"perc-1.js"},sth:{fn:"sth-1.js"},temperament:{fn:"temper-1.js"},nreq:0,hooks:[],g_hooks:[],load:function(e,t,r){var n,a=this.nreq,i=e.match(/(^|\n)(%%|I:).+?\b/g);if(!i)return!0;this.cbf=t||function(){},this.errmsg=r||function(){return"object"==typeof user&&user.errmsg?user.errmsg:"function"==typeof printErr?printErr:"function"==typeof alert?function(e){alert(e)}:"object"==typeof console?console.log:function(){}}();for(var s=0;s<i.length;s++)(n=abc2svg.modules[i[s].replace(/\n?(%%|I:)/,"")])&&!n.loaded&&(n.loaded=!0,this.nreq++,abc2svg.loadjs(n.fn,function(){0==--abc2svg.modules.nreq&&abc2svg.modules.cbf()},function(){abc2svg.modules.errmsg("error loading "+n.fn),0==--abc2svg.modules.nreq&&abc2svg.modules.cbf()}));return this.nreq==a}},abc2svg.version="1.17.8-4f07d34b4d",abc2svg.vdate="2018-08-24","object"==typeof module&&"object"==typeof exports&&(exports.ToAudio=ToAudio);var abcsf2=[];!function(e,t){"object"==typeof exports?(e.sf2=exports,t(exports)):"function"==typeof define&&define.amd?define(["exports"],function(r){return e.sf2=r,e.sf2,t(r)}):(e.sf2={},t(e.sf2))}(this,function(e){"use strict";var t=e;return t.Parser=function(e,t){t=t||{},this.input=e,this.parserOptions=t.parserOptions},t.Parser.prototype.parse=function(){var e,r=new t.Riff.Parser(this.input,this.parserOptions);if(r.parse(),1!==r.chunkList.length)throw new Error("wrong chunk length");if(null===(e=r.getChunk(0)))throw new Error("chunk not found");this.parseRiffChunk(e),this.input=null},t.Parser.prototype.parseRiffChunk=function(e){var r,n,a=this.input,i=e.offset;if("RIFF"!==e.type)throw new Error("invalid chunk type:"+e.type);if("sfbk"!==(n=String.fromCharCode(a[i++],a[i++],a[i++],a[i++])))throw new Error("invalid signature:"+n);if(r=new t.Riff.Parser(a,{index:i,length:e.size-4}),r.parse(),3!==r.getNumberOfChunks())throw new Error("invalid sfbk structure");this.parseInfoList(r.getChunk(0)),this.parseSdtaList(r.getChunk(1)),this.parsePdtaList(r.getChunk(2))},t.Parser.prototype.parseInfoList=function(e){var r,n,a=this.input,i=e.offset;if("LIST"!==e.type)throw new Error("invalid chunk type:"+e.type);if("INFO"!==(n=String.fromCharCode(a[i++],a[i++],a[i++],a[i++])))throw new Error("invalid signature:"+n);r=new t.Riff.Parser(a,{index:i,length:e.size-4}),r.parse()},t.Parser.prototype.parseSdtaList=function(e){var r,n,a=this.input,i=e.offset;if("LIST"!==e.type)throw new Error("invalid chunk type:"+e.type);if("sdta"!==(n=String.fromCharCode(a[i++],a[i++],a[i++],a[i++])))throw new Error("invalid signature:"+n);if(r=new t.Riff.Parser(a,{index:i,length:e.size-4}),r.parse(),1!==r.chunkList.length)throw new Error("TODO");this.samplingData=r.getChunk(0)},t.Parser.prototype.parsePdtaList=function(e){var r,n,a=this.input,i=e.offset;if("LIST"!==e.type)throw new Error("invalid chunk type:"+e.type);if("pdta"!==(n=String.fromCharCode(a[i++],a[i++],a[i++],a[i++])))throw new Error("invalid signature:"+n);if(r=new t.Riff.Parser(a,{index:i,length:e.size-4}),r.parse(),9!==r.getNumberOfChunks())throw new Error("invalid pdta chunk");this.parsePhdr(r.getChunk(0)),this.parsePbag(r.getChunk(1)),this.parsePmod(r.getChunk(2)),this.parsePgen(r.getChunk(3)),this.parseInst(r.getChunk(4)),this.parseIbag(r.getChunk(5)),this.parseImod(r.getChunk(6)),this.parseIgen(r.getChunk(7)),this.parseShdr(r.getChunk(8))},t.Parser.prototype.parsePhdr=function(e){var t=this.input,r=e.offset,n=this.presetHeader=[],a=e.offset+e.size;if("phdr"!==e.type)throw new Error("invalid chunk type:"+e.type);for(;r<a;)n.push({presetName:String.fromCharCode.apply(null,t.subarray(r,r+=20)),preset:t[r++]|t[r++]<<8,bank:t[r++]|t[r++]<<8,presetBagIndex:t[r++]|t[r++]<<8,library:(t[r++]|t[r++]<<8|t[r++]<<16|t[r++]<<24)>>>0,genre:(t[r++]|t[r++]<<8|t[r++]<<16|t[r++]<<24)>>>0,morphology:(t[r++]|t[r++]<<8|t[r++]<<16|t[r++]<<24)>>>0})},t.Parser.prototype.parsePbag=function(e){var t=this.input,r=e.offset,n=this.presetZone=[],a=e.offset+e.size;if("pbag"!==e.type)throw new Error("invalid chunk type:"+e.type);for(;r<a;)n.push({presetGeneratorIndex:t[r++]|t[r++]<<8,presetModulatorIndex:t[r++]|t[r++]<<8})},t.Parser.prototype.parsePmod=function(e){if("pmod"!==e.type)throw new Error("invalid chunk type:"+e.type);this.presetZoneModulator=this.parseModulator(e)},t.Parser.prototype.parsePgen=function(e){if("pgen"!==e.type)throw new Error("invalid chunk type:"+e.type);this.presetZoneGenerator=this.parseGenerator(e)},t.Parser.prototype.parseInst=function(e){var t=this.input,r=e.offset,n=this.instrument=[],a=e.offset+e.size;if("inst"!==e.type)throw new Error("invalid chunk type:"+e.type);for(;r<a;)n.push({instrumentName:String.fromCharCode.apply(null,t.subarray(r,r+=20)),instrumentBagIndex:t[r++]|t[r++]<<8})},t.Parser.prototype.parseIbag=function(e){var t=this.input,r=e.offset,n=this.instrumentZone=[],a=e.offset+e.size;if("ibag"!==e.type)throw new Error("invalid chunk type:"+e.type);for(;r<a;)n.push({instrumentGeneratorIndex:t[r++]|t[r++]<<8,instrumentModulatorIndex:t[r++]|t[r++]<<8})},t.Parser.prototype.parseImod=function(e){if("imod"!==e.type)throw new Error("invalid chunk type:"+e.type);this.instrumentZoneModulator=this.parseModulator(e)},t.Parser.prototype.parseIgen=function(e){if("igen"!==e.type)throw new Error("invalid chunk type:"+e.type);this.instrumentZoneGenerator=this.parseGenerator(e)},
t.Parser.prototype.parseShdr=function(e){var t,r,n,a,i,s,o,c,l,u,f=this.input,$=e.offset,p=this.sample=[],d=this.sampleHeader=[],h=e.offset+e.size;if("shdr"!==e.type)throw new Error("invalid chunk type:"+e.type);for(;$<h;){t=String.fromCharCode.apply(null,f.subarray($,$+=20)),r=f[$++]<<0|f[$++]<<8|f[$++]<<16|f[$++]<<24,n=f[$++]<<0|f[$++]<<8|f[$++]<<16|f[$++]<<24,a=f[$++]<<0|f[$++]<<8|f[$++]<<16|f[$++]<<24,i=f[$++]<<0|f[$++]<<8|f[$++]<<16|f[$++]<<24,s=f[$++]<<0|f[$++]<<8|f[$++]<<16|f[$++]<<24,o=f[$++],c=f[$++]<<24>>24,l=f[$++]|f[$++]<<8,u=f[$++]|f[$++]<<8;var _=new Int16Array(new Uint8Array(f.subarray(this.samplingData.offset+2*r,this.samplingData.offset+2*n)).buffer);if(a-=r,i-=r,s>0){var m=this.adjustSampleData(_,s);_=m.sample,s*=m.multiply,a*=m.multiply,i*=m.multiply}p.push(_),d.push({sampleName:t,startLoop:a,endLoop:i,sampleRate:s,originalPitch:o,pitchCorrection:c,sampleLink:l,sampleType:u})}},t.Parser.prototype.adjustSampleData=function(e,t){for(var r,n,a,i,s=1;t<22050;){for(r=new Int16Array(2*e.length),n=i=0,a=e.length;n<a;++n)r[i++]=e[n],r[i++]=e[n];e=r,s*=2,t*=2}return{sample:e,multiply:s}},t.Parser.prototype.parseModulator=function(e){for(var r,n,a=this.input,i=e.offset,s=e.offset+e.size,o=[];i<s;){if(i+=2,r=a[i++]|a[i++]<<8,void 0===(n=t.Parser.GeneratorEnumeratorTable[r]))o.push({type:n,value:{code:r,amount:a[i]|a[i+1]<<8<<16>>16,lo:a[i++],hi:a[i++]}});else switch(n){case"keyRange":case"velRange":case"keynum":case"velocity":o.push({type:n,value:{lo:a[i++],hi:a[i++]}});break;default:o.push({type:n,value:{amount:a[i++]|a[i++]<<8<<16>>16}})}i+=2,i+=2}return o},t.Parser.prototype.parseGenerator=function(e){for(var r,n,a=this.input,i=e.offset,s=e.offset+e.size,o=[];i<s;)if(r=a[i++]|a[i++]<<8,void 0!==(n=t.Parser.GeneratorEnumeratorTable[r]))switch(n){case"keynum":case"keyRange":case"velRange":case"velocity":o.push({type:n,value:{lo:a[i++],hi:a[i++]}});break;default:o.push({type:n,value:{amount:a[i++]|a[i++]<<8<<16>>16}})}else o.push({type:n,value:{code:r,amount:a[i]|a[i+1]<<8<<16>>16,lo:a[i++],hi:a[i++]}});return o},t.Parser.prototype.getInstruments=function(){var e,t,r,n,a,i,s,o,c,l=this.instrument,u=this.instrumentZone,f=[];for(i=0,s=l.length;i<s;++i){for(e=l[i].instrumentBagIndex,t=l[i+1]?l[i+1].instrumentBagIndex:u.length,r=[],o=e,c=t;o<c;++o)n=this.createInstrumentGenerator_(u,o),a=this.createInstrumentModulator_(u,o),r.push({generator:n.generator,modulator:a.modulator});f.push({name:l[i].instrumentName,info:r})}return f},t.Parser.prototype.createInstrumentGenerator_=function(e,t){return{generator:this.createBagModGen_(e,e[t].instrumentGeneratorIndex,e[t+1]?e[t+1].instrumentGeneratorIndex:this.instrumentZoneGenerator.length,this.instrumentZoneGenerator).modgen}},t.Parser.prototype.createInstrumentModulator_=function(e,t){return{modulator:this.createBagModGen_(e,e[t].presetModulatorIndex,e[t+1]?e[t+1].instrumentModulatorIndex:this.instrumentZoneModulator.length,this.instrumentZoneModulator).modgen}},t.Parser.prototype.createBagModGen_=function(e,t,r,n){var a,i,s,o={unknown:[],keyRange:{hi:127,lo:0}};for(i=t,s=r;i<s;++i)a=n[i],"unknown"===a.type?o.unknown.push(a.value):o[a.type]=a.value;return{modgen:o}},t.Parser.GeneratorEnumeratorTable=["startAddrsOffset","endAddrsOffset","startloopAddrsOffset","endloopAddrsOffset","startAddrsCoarseOffset","modLfoToPitch","vibLfoToPitch","modEnvToPitch","initialFilterFc","initialFilterQ","modLfoToFilterFc","modEnvToFilterFc","endAddrsCoarseOffset","modLfoToVolume",void 0,"chorusEffectsSend","reverbEffectsSend","pan",void 0,void 0,void 0,"delayModLFO","freqModLFO","delayVibLFO","freqVibLFO","delayModEnv","attackModEnv","holdModEnv","decayModEnv","sustainModEnv","releaseModEnv","keynumToModEnvHold","keynumToModEnvDecay","delayVolEnv","attackVolEnv","holdVolEnv","decayVolEnv","sustainVolEnv","releaseVolEnv","keynumToVolEnvHold","keynumToVolEnvDecay","instrument",void 0,"keyRange","velRange","startloopAddrsCoarseOffset","keynum","velocity","initialAttenuation",void 0,"endloopAddrsCoarseOffset","coarseTune","fineTune","sampleID","sampleModes",void 0,"scaleTuning","exclusiveClass","overridingRootKey"],t.Riff={},t.Riff.Parser=function(e,t){t=t||{},this.input=e,this.ip=t.index||0,this.length=t.length||e.length-this.ip,this.offset=this.ip,this.padding=void 0===t.padding||t.padding,this.bigEndian=void 0!==t.bigEndian&&t.bigEndian},t.Riff.Chunk=function(e,t,r){this.type=e,this.size=t,this.offset=r},t.Riff.Parser.prototype.parse=function(){var e=this.length+this.offset;for(this.chunkList=[];this.ip<e;)this.parseChunk()},t.Riff.Parser.prototype.parseChunk=function(){var e,r=this.input,n=this.ip;this.chunkList.push(new t.Riff.Chunk(String.fromCharCode(r[n++],r[n++],r[n++],r[n++]),e=this.bigEndian?r[n++]<<24|r[n++]<<16|r[n++]<<8|r[n++]:r[n++]|r[n++]<<8|r[n++]<<16|r[n++]<<24,n)),n+=e,1===(this.padding&&n-this.offset&1)&&n++,this.ip=n},t.Riff.Parser.prototype.getChunk=function(e){var t=this.chunkList[e];return void 0===t?null:t},t.Riff.Parser.prototype.getNumberOfChunks=function(){return this.chunkList.length},t}),navigator.requestMIDIAccess&&navigator.requestMIDIAccess({sysex:!0}).then(onMIDISuccess,onMIDIFailure1),abc2svg.ambitus={do_ambitus:function(){var e,t,r,n,a,i=abc2svg.C,s=this.get_voice_tb();for(t=0;t<s.length;t++)if(r=s[t],!r.second){for(n=100,a=-100,e=r.sym;e;e=e.next)e.type==i.NOTE&&(e.notes[e.nhd].pit>a&&(a=e.notes[e.nhd].pit),e.notes[0].pit<n&&(n=e.notes[0].pit));100!=n&&(e=r.clef,e.stem=1,e.head=i.FULL,e.stemless=!0,e.nhd=1,e.notes=[{dur:i.BLEN/4,pit:n,shhd:0},{dur:i.BLEN/4,pit:a,shhd:0}])}},draw_symbols:function(e,t){var r=this.get_staff_tb(),n=t.sym;void 0!=n.clef_type&&n.nhd>0&&(n.x-=26,this.set_scale(n),this.draw_note(n),n.notes[1].pit-n.notes[0].pit>4&&(this.xypath(n.x,3*(n.notes[1].pit-18)+r[n.st].y),this.out_svg("v"+(3*(n.notes[1].pit-n.notes[0].pit)).toFixed(2)+'" stroke-width=".6"/>\n')),n.x+=26,t.clef.nhd=0),e(t)},set_pitch:function(e,t){e(t),!t&&this.cfmt().ambitus&&abc2svg.ambitus.do_ambitus.call(this)},set_fmt:function(e,t,r,n){if("ambitus"==t)return void(this.cfmt().ambitus=r);e(t,r,n)},set_width:function(e,t){void 0!=t.clef_type&&t.nhd>0?(t.wl=40,t.wr=12):e(t)}},abc2svg.modules.hooks.push("draw_note","set_scale",["draw_symbols","abc2svg.ambitus.draw_symbols"],["set_pitch","abc2svg.ambitus.set_pitch"],["set_format","abc2svg.ambitus.set_fmt"],["set_width","abc2svg.ambitus.set_width"]),abc2svg.modules.ambitus.loaded=!0,abc2svg.break={get_break:function(e){var t,r,a,i,s=abc2svg.C,o=e.split(/[ ,]/),c=this.cfmt();for(c.break||(c.break=[]),n=1;n<o.length;n++)t=o[n],r=t.match(/(\d+)([a-z]?)(:\d+\/\d+)?/),r?(r[2]&&(i=r[2].charCodeAt(0)-97),r[3]?(a=r[3].match(/:(\d+)\/(\d+)/),!a||a[2]<1?this.syntax(1,"Bad denominator in %%break"):c.break.push({m:r[1],t:a[1]*s.BLEN/a[2],sq:i})):c.break.push({m:r[1],t:0,sq:i})):this.syntax(1,errs.bad_val,"%%break")},do_break:function(){var e,t,r,n,a,i=this.get_voice_tb();for(v=this.get_cur_sy().top_voice,s1=i[v].sym,cfmt=this.cfmt(),e=0;e<cfmt.break.length;e++){for(n=cfmt.break[e],t=n.m,s=s1;s&&s.bar_num!=t;s=s.next);if(s){if(n.sq){for(a=n.sq,s=s.ts_next;s&&(s.bar_num!=t||0!=--a);s=s.ts_next);if(!s)continue}if(r=n.t){for(r=s.time+r;s&&!(s.time>=r);s=s.next);if(!s)continue;s=s.prev}s.eoln=!0}}},do_pscom:function(e,t){"break "==t.slice(0,6)?abc2svg.break.get_break.call(this,t):e(t)},set_bar_num:function(e){e(),this.cfmt().break&&abc2svg.break.do_break.call(this)}},abc2svg.modules.hooks.push("errs","syntax",["do_pscom","abc2svg.break.do_pscom"],["set_bar_num","abc2svg.break.set_bar_num"]),abc2svg.modules.break.loaded=!0,abc2svg.capo={gch_capo:function(e){for(var t,r,n=this.cfmt(),a=n.capo,i=0;;){if(!(t=e[i++]))return;if("g"==t.type)break}r=Object.create(t),r.capo=!1,r.text=this.gch_tr1(r.text,[0,5,-2,3,-4,1,-6,-1,4,-3,2,-5][a%12]),this.capo_first||(this.capo_first=!0,r.text+="  (capo: "+a.toString()+")"),r.font=this.get_font(n.capofont?"capo":"annotation"),e.splice(i,0,r),t.capo=!0},gch_build:function(e,t){var r=this.get_a_gch();this.cfmt().capo&&r&&abc2svg.capo.gch_capo.call(this,r),e(t)},output_music:function(e){this.capo_first=!1,e()},set_fmt:function(e,t,r,n){if("capo"==t)return void(this.cfmt().capo=r);e(t,r,n)}},abc2svg.modules.hooks.push("gch_tr1","get_font",["set_format","abc2svg.capo.set_fmt"],["gch_build","abc2svg.capo.gch_build"],["output_music","abc2svg.capo.output_music"]),abc2svg.modules.capo.loaded=!0,abc2svg.clip={get_clip:function(e){function t(e){var t,r=e.match(/(\d+)([a-z]?)(:\d+\/\d+)?/);if(r){if(r[2]&&(t=r[2].charCodeAt(0)-97),!r[3])return{m:r[1],t:0,sq:t};if((e=r[3].match(/:(\d+)\/(\d+)/))&&!(e[2]<1))return{m:r[1],t:e[1]*a.BLEN/e[2],sq:t}}}var r,n,a=abc2svg.C,i=e.split(/[ -]/);return 3!=i.length?void this.syntax(1,this.errs.bad_val,"%%clip"):(r=i[1]?t(i[1]):{m:0,t:0},n=t(i[2]),r&&n?void(this.cfmt().clip=[r,n]):void this.syntax(1,this.errs.bad_val,"%%clip"))},do_clip:function(){function e(e,r){var n,a,i;if(r.m<=1){if(1==r.m){for(n=e;n&&(n.type!=t.BAR||0==n.time);n=n.ts_next);n.time<voice_tb[this.get_cur_sy().top_voice].meter.wmeasure&&(e=n)}}else{for(;e&&!(e.type==t.BAR&&e.bar_num>=r.m);e=e.ts_next);if(!e)return;if(r.sq){for(i=r.sq,e=e.ts_next;e&&(e.type!=t.BAR||e.bar_num!=r.m||0!=--i);e=e.ts_next);if(!e)return}}if(0==r.t)return e;for(a=e.time+r.t;e.time<a;)if(!(e=e.ts_next))return e;do{e=e.ts_prev}while(!e.seqst);return e}var t=abc2svg.C;voice_tb=this.get_voice_tb(),cfmt=this.cfmt();var r,n,a,i,s;if(r=this.get_tsfirst(),cfmt.clip[0].m>0||cfmt.clip[0].t>0){if(!(r=e(r,cfmt.clip[0])))return void this.set_tsfirst(null);for(a=this.get_cur_sy(),n=this.get_tsfirst();n!=r;n=n.ts_next)switch(n.type){case t.CLEF:n.p_v.clef=n;break;case t.KEY:n.p_v.key=this.clone(n.as.u.key);break;case t.METER:n.p_v.meter=this.clone(n.as.u.meter);break;case t.STAVES:a=n.sy,this.set_cur_sy(a)}for(s=0;s<voice_tb.length;s++){for(i=voice_tb[s],n=r;n;n=n.ts_next)if(n.v==s){delete n.prev;break}i.sym=n}this.set_tsfirst(r),delete r.ts_prev}if(r=e(r,cfmt.clip[1])){do{if(!(r=r.ts_next))return}while(!r.seqst);for(s=0;s<voice_tb.length;s++){for(i=voice_tb[s],n=r.ts_prev;n;n=n.ts_prev)if(n.v==s){delete n.next;break}n||(i.sym=null)}delete r.ts_prev.ts_next}},do_pscom:function(e,t){"clip "==t.slice(0,5)?abc2svg.clip.get_clip.call(this,t):e(t)},set_bar_num:function(e){e(),this.cfmt().clip&&abc2svg.clip.do_clip.call(this)}},abc2svg.modules.hooks.push("clone","errs","syntax",["do_pscom","abc2svg.clip.do_pscom"],["set_bar_num","abc2svg.clip.set_bar_num"]),abc2svg.modules.clip.loaded=!0,abc2svg.combine={comb_v:function(){function e(e){var t,r=e.ts_next;return!(!r||r.type!=i.NOTE&&r.type!=i.REST)&&(r.v!=e.v&&r.st==e.st&&r.time==e.time&&r.dur==e.dur&&(!(e.combine<=0&&r.type!=e.type)&&((!e.a_gch||!r.a_gch)&&(e.type==i.REST?!(e.type==r.type&&e.invis&&!r.invis):!(r.a_ly||r.sl1||r.sl2||r.slur_start||r.slur_end)&&(r.beam_st==e.beam_st&&r.beam_end==e.beam_end&&(t=r.nhd,!(e.combine<=1&&e.notes[0].pit<=r.notes[t].pit+1)))))))}function t(e,t){var r,n,a;if(e.notes=e.notes.concat(t.notes),e.nhd=r=e.notes.length-1,this.sort_pitch(e),e.combine>=3){for(a=r;a>0;a--)e.notes[a].pit==e.notes[a-1].pit&&e.notes[a].acc==e.notes[a-1].acc&&e.notes.splice(a,1);e.nhd=r=e.notes.length-1}e.ymx=3*(e.notes[r].pit-18)+4,e.ymn=3*(e.notes[0].pit-18)-4,n=e.notes[0].ti1,(15&n)==i.SL_AUTO&&(e.notes[0].ti1=i.SL_BELOW|n&~i.SL_DOTTED),(15&(n=e.notes[r].ti1))==i.SL_AUTO&&(e.notes[r].ti1=i.SL_ABOVE|n&~i.SL_DOTTED)}function r(r){for(var n;;)if(r.nhd,n=r.ts_next,n.nhd,r.type!=n.type?n.type!=i.REST&&(n=r,r=n.ts_next):r.type==i.REST?r.invis&&!n.invis&&delete r.invis:t.call(this,r,n),n.a_gch&&(r.a_gch=n.a_gch),n.a_dd&&(r.a_dd?r.a_dd=r.a_dd.concat(n.a_dd):r.a_dd=n.a_dd),this.unlksym(n),r.in_tuplet||!e.call(this,r))break}var n,a,i=abc2svg.C;for(n=this.get_tsfirst();n;n=n.ts_next){switch(n.type){case i.REST:if(void 0==n.combine||n.combine<0)continue;e.call(this,n)&&r.call(this,n);continue;default:continue;case i.NOTE:if(void 0==n.combine||n.combine<=0)continue}if(n.beam_st)if(n.beam_end)e.call(this,n)&&r.call(this,n);else{for(a=n;;){if(!e.call(this,a)){a=null;break}if(a.beam_end)break;do{a=a.next}while(a.type!=i.NOTE&&a.type!=i.REST)}if(a)for(a=n;;){if(r.call(this,a),a.beam_end)break;do{a=a.next}while(a.type!=i.NOTE&&a.type!=i.REST)}}}},do_pscom:function(e,t){"voicecombine "==t.slice(0,13)?this.set_v_param("combine",t.split(/[ \t]/)[1]):e(t)},new_note:function(e,t,r){var n=this.get_curvoice(),a=e(t,r);return a&&a.notes&&void 0!=n.combine&&(a.combine=n.combine),a},set_stem_dir:function(e){e(),abc2svg.combine.comb_v.call(this)},set_vp:function(e,t){var r,n=this.get_curvoice();for(r=0;r<t.length;r++)if("combine="==t[r]){n.combine=t[r+1];break}e(t)}},abc2svg.modules.hooks.push("set_v_param","sort_pitch","unlksym",["do_pscom","abc2svg.combine.do_pscom"],["new_note","abc2svg.combine.new_note"],["set_stem_dir","abc2svg.combine.set_stem_dir"],["set_vp","abc2svg.combine.set_vp"]),abc2svg.modules.voicecombine.loaded=!0,abc2svg.diag={do_diag:function(){var e=this.get_glyphs(),t=this.get_voice_tb();if(!e.fb){var r,n,a,i=this.get_decos();for(ns="CDEFGAB",ms=["","m","7","m7","maj7","sus4"],this.add_style("\n.diag {font:6px sans-serif}\n.frn {font:italic 7px sans-serif}"),r=0;r<ns.length;r++)for(n=0;n<ms.length;n++)a=ns[r]+ms[n],i[a]="3 "+a+" 40 0 0";for(n=0;n<ms.length;n++)a="F"+ms[n],i[a]="3 F#"+ms[n]+" 40 0 0";e.fb='<g id="fb">\n<path class="stroke" stroke-width="0.4" d="M-10 -34h20m0 6h-20m0 6h20m0 6h-20m0 6h20"/>\n<path class="stroke" stroke-width="0.5" d="M-10 -34v24m4 0v-24m4 0v24m4 0v-24m4 0v24m4 0v-24"/>\n</g>',e.nut='<path id="nut" class="stroke" stroke-width="1.6" d="M-10.2 -34.5h20.4"/>',e.barre='<path id="barre" class="stroke" stroke-width=".9" d="M-10.2 -31h20.4"/>',e.fr1='<text id="fr1" x="-20" y="-29" class="frn">fr1</text>',e.fr2='<text id="fr2" x="-20" y="-29" class="frn">fr2</text>',e.fr3='<text id="fr3" x="-20" y="-29" class="frn">fr3</text>',e.ddot='<circle id="ddot" class="fill" r="1.5"/>',e.C='<g id="C">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-8,-3,4" y="-36" class="diag">321</text>\n<use x="-6" y="-19" xlink:href="#ddot"/>\n<use x="-2" y="-25" xlink:href="#ddot"/>\n<use x="6" y="-31" xlink:href="#ddot"/>\n</g>',e.Cm='<g id="Cm">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr3"/>\n<use xlink:href="#fb"/>\n<text x="-4,0,4" y="-36" class="diag">342</text>\n<use x="2" y="-19" xlink:href="#ddot"/>\n<use x="-2" y="-19" xlink:href="#ddot"/>\n<use x="6" y="-25" xlink:href="#ddot"/>\n</g>',e.C7='<g id="C7">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-8,-4,0,4" y="-36" class="diag">3241</text>\n<use x="2" y="-19" xlink:href="#ddot"/>\n<use x="-6" y="-19" xlink:href="#ddot"/>\n<use x="-2" y="-25" xlink:href="#ddot"/>\n<use x="6" y="-31" xlink:href="#ddot"/>\n</g>',e.Cm7='<g id="Cm7">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr3"/>\n<use xlink:href="#fb"/>\n<text x="-12,-4,4" y="-36" class="diag">x32</text>\n<use x="-2" y="-19" xlink:href="#ddot"/>\n<use x="6" y="-25" xlink:href="#ddot"/>\n</g>',e.Cmaj7='<g id="Cmaj7">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-12,-8,-4" y="-36" class="diag">x21</text>\n<use x="-2" y="-25" xlink:href="#ddot"/>\n<use x="-6" y="-19" xlink:href="#ddot"/>\n</g>',e.Csus4='<g id="Csus4">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr3"/>\n<use xlink:href="#fb"/>\n<text x="-12,0,4" y="-36" class="diag">x34</text>\n<use x="6" y="-13" xlink:href="#ddot"/>\n<use x="2" y="-19" xlink:href="#ddot"/>\n</g>',e.D='<g id="D">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-12,0,4,8" y="-36" class="diag">x132</text>\n<use x="6" y="-19" xlink:href="#ddot"/>\n<use x="10" y="-25" xlink:href="#ddot"/>\n<use x="2" y="-25" xlink:href="#ddot"/>\n</g>',e.Dm='<g id="Dm">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-12,0,4,8" y="-36" class="diag">x231</text>\n<use x="6" y="-19" xlink:href="#ddot"/>\n<use x="2" y="-25" xlink:href="#ddot"/>\n<use x="10" y="-31" xlink:href="#ddot"/>\n</g>',e.D7='<g id="D7">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-12,0,4,8" y="-36" class="diag">x312</text>\n<use x="10" y="-25" xlink:href="#ddot"/>\n<use x="2" y="-25" xlink:href="#ddot"/>\n<use x="6" y="-31" xlink:href="#ddot"/>\n</g>',e.Dm7='<g id="Dm7">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-12,-8,0,4,8" y="-36" class="diag">xx211</text>\n<use x="2" y="-25" xlink:href="#ddot"/>\n<use x="10" y="-31" xlink:href="#ddot"/>\n<use x="6" y="-31" xlink:href="#ddot"/>\n</g>',e.Dmaj7='<g id="Dmaj7">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-12,-8,0,4,8" y="-36" class="diag">xx123</text>\n<use x="10" y="-25" xlink:href="#ddot"/>\n<use x="6" y="-25" xlink:href="#ddot"/>\n<use x="2" y="-25" xlink:href="#ddot"/>\n</g>',e.Dsus4='<g id="Dsus4">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-12,-8,0,4,8" y="-36" class="diag">xx123</text>\n<use x="10" y="-19" xlink:href="#ddot"/>\n<use x="6" y="-19" xlink:href="#ddot"/>\n<use x="2" y="-25" xlink:href="#ddot"/>\n</g>',e.E='<g id="E">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-8,-4,0" y="-36" class="diag">231</text>\n<use x="-2" y="-25" xlink:href="#ddot"/>\n<use x="-6" y="-25" xlink:href="#ddot"/>\n<use x="2" y="-31" xlink:href="#ddot"/>\n</g>',e.Em='<g id="Em">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-8,-4" y="-36" class="diag">23</text>\n<use x="-2" y="-25" xlink:href="#ddot"/>\n<use x="-6" y="-25" xlink:href="#ddot"/>\n</g>',e.E7='<g id="E7">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-8,0" y="-36" class="diag">21</text>\n<use x="2" y="-31" xlink:href="#ddot"/>\n<use x="-6" y="-25" xlink:href="#ddot"/>\n</g>',e.Em7='<g id="Em7">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-8" y="-36" class="diag">1</text>\n<use x="-6" y="-25" xlink:href="#ddot"/>\n</g>',e.Emaj7='<g id="Emaj7">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-8,-4,0" y="-36" class="diag">312</text>\n<use x="2" y="-31" xlink:href="#ddot"/>\n<use x="-2" y="-31" xlink:href="#ddot"/>\n<use x="-6" y="-25" xlink:href="#ddot"/>\n</g>',e.Esus4='<g id="Esus4">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-4,0" y="-36" class="diag">12</text>\n<use x="2" y="-25" xlink:href="#ddot"/>\n<use x="-2" y="-25" xlink:href="#ddot"/>\n</g>',e.F='<g id="F">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr1"/>\n<use xlink:href="#fb"/>\n<text x="-8,-4,0" y="-36" class="diag">342</text>\n<use x="-2" y="-19" xlink:href="#ddot"/>\n<use x="-6" y="-19" xlink:href="#ddot"/>\n<use x="2" y="-25" xlink:href="#ddot"/>\n</g>',e.Fm='<g id="Fm">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr1"/>\n<use xlink:href="#fb"/>\n<text x="-8,-4" y="-36" class="diag">34</text>\n<use x="-2" y="-19" xlink:href="#ddot"/>\n<use x="-6" y="-19" xlink:href="#ddot"/>\n</g>',e.F7='<g id="F7">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr1"/>\n<use xlink:href="#fb"/>\n<text x="-8,0" y="-36" class="diag">32</text>\n<use x="2" y="-25" xlink:href="#ddot"/>\n<use x="-6" y="-19" xlink:href="#ddot"/>\n</g>',e.Fm7='<g id="Fm7">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr1"/>\n<use xlink:href="#fb"/>\n<text x="-8" y="-36" class="diag">3</text>\n<use x="-6" y="-19" xlink:href="#ddot"/>\n</g>',e.Fmaj7='<g id="Fmaj7">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr1"/>\n<use xlink:href="#fb"/>\n<text x="-8,-4,0" y="-36" class="diag">423</text>\n<use x="2" y="-25" xlink:href="#ddot"/>\n<use x="-2" y="-25" xlink:href="#ddot"/>\n<use x="-6" y="-19" xlink:href="#ddot"/>\n</g>',e.Fsus4='<g id="Fsus4">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr1"/>\n<use xlink:href="#fb"/>\n<text x="-4,0" y="-36" class="diag">34</text>\n<use x="2" y="-19" xlink:href="#ddot"/>\n<use x="-2" y="-19" xlink:href="#ddot"/>\n</g>',e["F#"]='<g id="F#">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr2"/>\n<use xlink:href="#fb"/>\n<text x="-8,-4,0" y="-36" class="diag">342</text>\n<use x="-2" y="-19" xlink:href="#ddot"/>\n<use x="-6" y="-19" xlink:href="#ddot"/>\n<use x="2" y="-25" xlink:href="#ddot"/>\n</g>',e["F#m"]='<g id="F#m">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr2"/>\n<use xlink:href="#fb"/>\n<text x="-8,-4" y="-36" class="diag">34</text>\n<use x="-2" y="-19" xlink:href="#ddot"/>\n<use x="-6" y="-19" xlink:href="#ddot"/>\n</g>',e["F#7"]='<g id="F#7">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr2"/>\n<use xlink:href="#fb"/>\n<text x="-8,0" y="-36" class="diag">32</text>\n<use x="2" y="-25" xlink:href="#ddot"/>\n<use x="-6" y="-19" xlink:href="#ddot"/>\n</g>',e["F#m7"]='<g id="F#m7">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr2"/>\n<use xlink:href="#fb"/>\n<text x="-8" y="-36" class="diag">3</text>\n<use x="-6" y="-19" xlink:href="#ddot"/>\n</g>',e["F#maj7"]='<g id="F#maj7">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr2"/>\n<use xlink:href="#fb"/>\n<text x="-8,-4,0" y="-36" class="diag">423</text>\n<use x="2" y="-25" xlink:href="#ddot"/>\n<use x="-2" y="-25" xlink:href="#ddot"/>\n<use x="-6" y="-19" xlink:href="#ddot"/>\n</g>',e["F#sus4"]='<g id="F#sus4">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr2"/>\n<use xlink:href="#fb"/>\n<text x="-4,0" y="-36" class="diag">34</text>\n<use x="2" y="-19" xlink:href="#ddot"/>\n<use x="-2" y="-19" xlink:href="#ddot"/>\n</g>',e.G='<g id="G">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-12,-8,8" y="-36" class="diag">234</text>\n<use x="10" y="-19" xlink:href="#ddot"/>\n<use x="-10" y="-19" xlink:href="#ddot"/>\n<use x="-6" y="-25" xlink:href="#ddot"/>\n</g>',e.Gm='<g id="Gm">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr3"/>\n<use xlink:href="#fb"/>\n<text x="-8,-4" y="-36" class="diag">34</text>\n<use x="-2" y="-19" xlink:href="#ddot"/>\n<use x="-6" y="-19" xlink:href="#ddot"/>\n</g>',e.G7='<g id="G7">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-12,-8,8" y="-36" class="diag">321</text>\n<use x="-10" y="-19" xlink:href="#ddot"/>\n<use x="-6" y="-25" xlink:href="#ddot"/>\n<use x="10" y="-31" xlink:href="#ddot"/>\n</g>',e.Gm7='<g id="Gm7">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr3"/>\n<use xlink:href="#fb"/>\n<text x="-8" y="-36" class="diag">3</text>\n<use x="-6" y="-19" xlink:href="#ddot"/>\n</g>',e.Gmaj7='<g id="Gmaj7">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-12,-8,8" y="-36" class="diag">312</text>\n<use x="10" y="-25" xlink:href="#ddot"/>\n<use x="-6" y="-25" xlink:href="#ddot"/>\n<use x="-10" y="-19" xlink:href="#ddot"/>\n</g>',e.Gsus4='<g id="Gsus4">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr3"/>\n<use xlink:href="#fb"/>\n<text x="-4,0" y="-36" class="diag">34</text>\n<use x="2" y="-19" xlink:href="#ddot"/>\n<use x="-2" y="-19" xlink:href="#ddot"/>\n</g>',e.A='<g id="A">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-4,0,4" y="-36" class="diag">234</text>\n<use x="6" y="-25" xlink:href="#ddot"/>\n<use x="2" y="-25" xlink:href="#ddot"/>\n<use x="-2" y="-25" xlink:href="#ddot"/>\n</g>',e.Am='<g id="Am">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-4,0,4" y="-36" class="diag">231</text>\n<use x="2" y="-25" xlink:href="#ddot"/>\n<use x="-2" y="-25" xlink:href="#ddot"/>\n<use x="6" y="-31" xlink:href="#ddot"/>\n</g>',e.A7='<g id="A7">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-4,4" y="-36" class="diag">23</text>\n<use x="6" y="-25" xlink:href="#ddot"/>\n<use x="-2" y="-25" xlink:href="#ddot"/>\n</g>',e.Am7='<g id="Am7">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-4,4" y="-36" class="diag">21</text>\n<use x="6" y="-31" xlink:href="#ddot"/>\n<use x="-2" y="-25" xlink:href="#ddot"/>\n</g>',e.Amaj7='<g id="Amaj7">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-12,-4,0,4" y="-36" class="diag">x213</text>\n<use x="6" y="-25" xlink:href="#ddot"/>\n<use x="2" y="-31" xlink:href="#ddot"/>\n<use x="-2" y="-25" xlink:href="#ddot"/>\n</g>',e.Asus4='<g id="Asus4">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-12,0,4" y="-36" class="diag">x12</text>\n<use x="6" y="-19" xlink:href="#ddot"/>\n<use x="2" y="-25" xlink:href="#ddot"/>\n</g>',e.B='<g id="B">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr2"/>\n<use xlink:href="#fb"/>\n<text x="-4,0,4" y="-36" class="diag">234</text>\n<use x="6" y="-19" xlink:href="#ddot"/>\n<use x="2" y="-19" xlink:href="#ddot"/>\n<use x="-2" y="-19" xlink:href="#ddot"/>\n</g>',e.Bm='<g id="Bm">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr2"/>\n<use xlink:href="#fb"/>\n<text x="-4,0,4" y="-36" class="diag">341</text>\n<use x="6" y="-25" xlink:href="#ddot"/>\n<use x="2" y="-19" xlink:href="#ddot"/>\n<use x="-2" y="-19" xlink:href="#ddot"/>\n</g>',e.B7='<g id="B7">\n<use xlink:href="#nut"/>\n<use xlink:href="#fb"/>\n<text x="-12,-8,-4,0,8" y="-36" class="diag">x2134</text>\n<use x="10" y="-25" xlink:href="#ddot"/>\n<use x="2" y="-25" xlink:href="#ddot"/>\n<use x="-6" y="-25" xlink:href="#ddot"/>\n<use x="-2" y="-31" xlink:href="#ddot"/>\n</g>',e.Bm7='<g id="Bm7">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr2"/>\n<use xlink:href="#fb"/>\n<text x="-12,0,8" y="-36" class="diag">x32</text>\n<use x="-2" y="-19" xlink:href="#ddot"/>\n<use x="6" y="-25" xlink:href="#ddot"/>\n</g>',e.Bmaj7='<g id="Bmaj7">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr2"/>\n<use xlink:href="#fb"/>\n<text x="-12,-4,0,4" y="-36" class="diag">x324</text>\n<use x="6" y="-19" xlink:href="#ddot"/>\n<use x="2" y="-25" xlink:href="#ddot"/>\n<use x="-2" y="-19" xlink:href="#ddot"/>\n</g>',e.Bsus4='<g id="Bsus4">\n<use xlink:href="#barre"/>\n<use xlink:href="#fr2"/>\n<use xlink:href="#fb"/>\n<text x="-12,0,4" y="-36" class="diag">x34</text>\n<use x="6" y="-19" xlink:href="#ddot"/>\n<use x="2" y="-25" xlink:href="#ddot"/>\n</g>'}var s,r,o,c;for(s=t[0].sym;s;s=s.next)if(s.a_gch)for(r=0;r<s.a_gch.length;r++)(o=s.a_gch[r])&&"g"==o.type&&!o.capo&&(c=o.otext||o.text,this.deco_cnv(c.split(/[ \t\/]/,1),s,null))},output_music:function(e){this.cfmt().diag&&abc2svg.diag.do_diag.call(this),e()},set_fmt:function(e,t,r,n){if("diagram"==t)return void(this.cfmt().diag=r);e(t,r,n)}},abc2svg.modules.hooks.push("deco_cnv",["output_music","abc2svg.diag.output_music"],["set_format","abc2svg.diag.set_fmt"]),abc2svg.modules.diagram.loaded=!0,abc2svg.equalbars={output_music:function(e){this.equalbars_d=0,e()},set_fmt:function(e,t,r,n){"equalbars"==t?this.cfmt().equalbars=this.get_bool(r):e(t,r,n)},set_sym_glue:function(e,t){var r,n,a,i,s,o,c,l,u,$=abc2svg.C,p=[],h=this.get_tsfirst();if(e(t),this.cfmt().equalbars){for(n=h;n;n=n.ts_next)if(n.seqst){switch(n.type){default:continue;case $.BAR:case $.GRACE:case $.MREST:case $.NOTE:case $.REST:case $.SPACE:}break}if(n){for(r=n.ts_next,u=l=r.time;;){if(!r.ts_next){p.push([r,r.time-l]),l=r.time,r.dur&&(l+=r.dur);break}r.type==$.BAR&&r.seqst&&(p.push([r,r.time-l]),l=r.time),r=r.ts_next}if(0!=(s=p.length))for(o=n.type==$.GRACE?n.extra.x:n.x,d=this.equalbars_d,d||(d=this.equalbars_d=o),a=(t-d)/(l-u),i=0;i<s;i++){for(r=p[i][0],f=a*p[i][1]/(r.x-o);n!=r;n=n.ts_next)if(n.type==$.GRACE)for(c=n.extra;c;c=c.next)c.x=d+(c.x-o)*f;else n.x&&(n.x=d+(n.x-o)*f);for(d+=a*p[i][1],o=n.x;;)if(n.x=d,!(n=n.ts_next)||n.seqst)break;if(!n)break}}}}},abc2svg.modules.hooks.push("get_bool",["output_music","abc2svg.equalbars.output_music"],["set_format","abc2svg.equalbars.set_fmt"],["set_sym_glue","abc2svg.equalbars.set_sym_glue"]),abc2svg.modules.equalbars.loaded=!0,abc2svg.grid={do_grid:function(){function e(e){var t=p.BLEN/4;return e.a_meter[0]&&"C"!=e.a_meter[0].top[0]&&e.a_meter[0].bot?(t=p.BLEN/e.a_meter[0].bot[0]|0,8==e.a_meter[0].bot[0]&&e.a_meter[0].top[0]%3==0&&(t=p.BLEN/8*3),t):t}function t(e,t,i){var s,o,c,l,u,f,$,p,d,h,m,y,g,v=0,b=[],x=e.length%6==0?6:8;for(x>e.length&&(x=e.length),c=0,s=0;s<e.length;s++){if(s%x==0&&c++,$=e[s],0==$.length)p="%";else for(p="",o=0;o<$.length;o++)$[o]?(0!=o&&(p+=" / "),p+=$[o]):0==o&&(p+="%");u=t[s],":"==u[u.length-1]&&(p="  "+p),f=t[s+1],f&&":"==f[0]&&(p+="  "),b.push(p),":"==u[u.length-1]&&(p+="  "),f&&":"==f[0]&&(p+="  "),d=this.strwh(p)[0],d>v&&(v=d)}for(v<20&&(v=20),d=v*x,d>r.width&&(x/=2,c*=2,d/=2),h=i.size+8,l='<svg xmlns="http://www.w3.org/2000/svg" version="1.1"\n\txmlns:xlink="http://www.w3.org/1999/xlink"\n\tcolor="black" width="'+r.width.toFixed(0)+'px" height="'+(h*c+6).toFixed(0)+'px"',s=_.bgcolor,s&&(l+=' style="background-color: '+s+'"'),l+='>\n<style type="text/css">\n.mid {text-anchor:middle}\n',_.fullsvg&&(l+=".stroke {stroke: currentColor; fill: none}\n."+n+" {"+this.style_font(i.name+"."+i.size)+"}\n"),l+="</style>\n",l+='<path class="stroke" d="\n',m=(r.width-d)/2,g=1,o=0;o<=c;o++)l+="M"+m.toFixed(2)+" "+g.toFixed(2)+"h"+d.toFixed(2)+"\n",g+=h;for(y=m,s=0;s<=x;s++)l+="M"+y.toFixed(2)+" 1v"+(h*c).toFixed(2)+"\n",y+=v;for(l+='"/>\n',g=-1-.2*h,s=0;s<b.length;s++)s%x==0&&(g+=h,y=m+v/2),l+='<text class="'+a+'" x="'+y.toFixed(2)+'" y="'+g.toFixed(2)+'">'+b[s]+"</text>\n",y+=v;for(g=-1-.2*h,y=m,s=0;s<t.length;s++)u=t[s],":"==u[0]&&(l+='<text class="'+a+'" x="'+(y-5).toFixed(2)+'" y="'+g.toFixed(2)+'" style="font-weight:bold;font-size:'+(i.size+2).toFixed(2)+'">:|</text>\n'),s%x==0&&(g+=h,y=m),":"==u[u.length-1]&&(l+='<text class="'+a+'" x="'+(y+5).toFixed(2)+'" y="'+g.toFixed(2)+'" style="font-weight:bold;font-size:'+(i.size+2).toFixed(2)+'">|:</text>\n'),y+=v;return l+"</svg>"}var r,n,a,i,s,o,c,l,u,f,$,p=abc2svg.C,d=this.get_tsfirst(),h=this.get_voice_tb(),_=this.cfmt(),m=[],y=[],g=[];for(r=this.get_img(),s=e(h[0].meter),o=l=f=0,m.push("|"),i=h[0].sym;i;i=i.next){for(;i.time>o;)l++,o+=s;switch(i.type){case p.NOTE:case p.REST:if(i.a_gch)for(c=0;c<i.a_gch.length;c++)if("g"==i.a_gch[c].type){g[l]||(g[l]=i.a_gch[c].text,f++);break}break;case p.BAR:if(i.time<s){m[0]=i.bar_type,l=0,o=i.time;break}if(i.time!=o)break;y.push(g),m.push(i.bar_type),g=[],l=0;break;case p.METER:s=e(i)}}if(0!=f)if(0!=g.length&&(m.push(""),y.push(g)),this.cfmt().gridfont||this.param_set_font("gridfont","serif 16"),$=this.get_font("grid"),n=this.font_class($),a=n+" mid",this.set_font("grid"),u=h[this.get_top_v()],i={type:p.BLOCK,subtype:"ml",dur:0,time:0,p_v:u,v:u.v,text:t.call(this,y,m,$)},_.grid<0){for(var v=d;v.ts_next;v=v.ts_next);i.time=v.time,i.prev=u.last_sym,i.ts_prev=v,u.last_sym.next=i,v.ts_next=i}else i.time=0,i.next=u.sym,i.ts_next=d,d.ts_prev=i,d=i,this.set_tsfirst(i),u.sym.prev=i,u.sym=i},output_music:function(e){this.cfmt().grid&&abc2svg.grid.do_grid.call(this),e()},set_fmt:function(e,t,r,n){if("grid"==t)return void(this.cfmt().grid=r);e(t,r,n)}},abc2svg.modules.hooks.push("font_class","get_font","param_set_font","set_font","strwh",["output_music","abc2svg.grid.output_music"],["set_format","abc2svg.grid.set_fmt"]),abc2svg.modules.grid.loaded=!0,abc2svg.grid2={do_grid:function(){var e,t,r,n=this.get_voice_tb();for(t=0;t<n.length;t++)if(r=n[t],r.grid2)for(r.stafflines="...",r.clef.invis=!0,r.key.k_sf=r.key.k_a_acc=0,r.staffnonote=2,e=r.sym;e;e=e.next)e.dur&&(e.invis=!0,delete e.sl1,e.ti1=0)},draw_chosym:function(e){var t,r;for(this.set_dscale(e.st),t=0;t<e.a_gch.length;t++)r=e.a_gch[t],"g"==r.type&&(this.use_font(r.font),this.set_font(r.font),this.xy_str(e.x+r.x,r.y+6,r.text))},draw_gchord:function(e,t,r,n){t.p_v.grid2?abc2svg.grid2.draw_chosym.call(this,t):e(t,r,n)},output_music:function(e){abc2svg.grid2.do_grid.call(this),e()},set_format:function(e,t,r,n){if("grid2"==t){var a=this.get_curvoice();return void(a&&(a.grid2=r))}e(t,r,n)}},abc2svg.modules.hooks.push("set_dscale","set_font","use_font","xy_str",["draw_gchord","abc2svg.grid2.draw_gchord"],["output_music","abc2svg.grid2.output_music"],["set_format","abc2svg.grid2.set_format"]),abc2svg.modules.grid2.loaded=!0,abc2svg.MIDI={do_midi:function(e){var t,r,n=new Int8Array([0,0,1,2,2,3,3,4,5,5,6,6]),a=new Int8Array([0,1,0,-1,0,0,1,0,-1,0,-1,0]),i=this.get_maps(),s=e.split(/\s+/);switch(s[1]){case"channel":if("10"!=s[2])break;this.set_v_param("midictl","0 1");break;case"drummap":if("play"!=this.cfmt().sound)break;if(t=function(e){if(e.match(/^([_^]*)([A-Ga-g])([,']*)$/))return e.match(/[A-Z]/)&&(e=e.toLowerCase(),e.indexOf("'")>0?e=e.replace("'",""):e+=","),e}(s[2]),
r=function(e){var t=Number(e);if(!isNaN(t))return e=7*(t/12|0)-19,t%=12,e+=n[t],note={pit:e,apit:e},a[t]&&(note.acc=a[t]),note}(s[3]),!t||!r){this.syntax(1,abc.errs.bad_val,"%%MIDI drummap");break}i.MIDIdrum||(i.MIDIdrum={}),i.MIDIdrum[t]=[null,r],this.set_v_param("mididrum","MIDIdrum");break;case"program":if(r=void 0!=s[3]?s[3]:s[2],r=parseInt(r),isNaN(r)||r<0||r>127)return void this.syntax(1,"Bad program in %%MIDI");this.set_v_param("instr",r);break;case"control":if(t=parseInt(s[2]),isNaN(t)||t<0||t>127)return void this.syntax(1,"Bad controller number in %%MIDI");if(r=parseInt(s[3]),isNaN(r)||r<0||r>127)return void this.syntax(1,"Bad controller value in %%MIDI");this.set_v_param("midictl",s[2]+" "+s[3])}},set_midi:function(e){var t,r,n=this.get_curvoice();for(t=0;t<e.length;t++)switch(e[t]){case"instr=":n.instr=e[t+1];break;case"midictl=":n.midictl||(n.midictl={}),r=e[t+1].split(" "),n.midictl[r[0]]=Number(r[1]);break;case"mididrum=":n.map||(n.map={}),n.map=e[t+1]}},do_pscom:function(e,t){"MIDI "==t.slice(0,5)?abc2svg.MIDI.do_midi.call(this,t):e(t)},set_vp:function(e,t){abc2svg.MIDI.set_midi.call(this,t),e(t)}},abc2svg.modules.hooks.push("errs","set_v_param","syntax",["do_pscom","abc2svg.MIDI.do_pscom"],["set_vp","abc2svg.MIDI.set_vp"]),abc2svg.modules.MIDI.loaded=!0,abc2svg.modules.psvg={do_begin_end:function(e,t,r,n){if("ps"!=t)return void e(t,r,n);"nosvg"!=r&&(this.psvg||(this.psvg=new Psvg(this)),this.psvg.ps_eval.call(this.psvg,n))},psdeco:function(e,t,r,n,a){return!!this.psvg&&this.psvg.psdeco.call(this.psvg,t,r,n,a)},psxygl:function(e,t,r,n){return!!this.psvg&&this.psvg.psxygl.call(this.psvg,t,r,n)}},abc2svg.modules.hooks.push("out_arp","out_deco_str","out_deco_val","out_ltr","xygl",["do_begin_end","abc2svg.modules.psvg.do_begin_end"],["psdeco","abc2svg.modules.psvg.psdeco"],["psxygl","abc2svg.modules.psvg.psxygl"]),abc2svg.modules.beginps.loaded=!0,abc2svg.sth={recal_beam:function(e,t){var r=this.get_staff_tb(),n=t.st,a=e.s2;for(t.sth&&(t.ys=t.sth),a.sth&&(a.ys=a.sth),e.a=(t.ys-a.ys)/(t.xs-a.xs),e.b=t.ys-t.xs*e.a+r[n].y;;)if(t.ys=e.a*t.xs+e.b-r[n].y,t.stem>0?t.ymx=t.ys+2.5:t.ymn=t.ys-2.5,(t=t.next)==a)break},set_sth:function(){var e,t,r,n,a,i=this.get_voice_tb();for(r=0;r<i.length;r++)if(a=i[r],null==a.sth)for(n=[],e=a.sym;e;e=e.next)if(e.sth&&(n=e.sth,e.sth=null),!(0==n.length||e.nflags<=-2||e.stemless||!e.beam_st&&!e.beam_end)&&"*"!=(t=n.shift()))if("|"!=t)t=Number(t),!isNaN(t)&&t&&(e.stem>=0?(e.ys=e.y+t,e.ymx=e.ys+2.5|0):(e.ys=e.y-t,e.ymn=e.ys-2.5|0),e.sth=e.ys);else for(e=e.next;e&&!e.bar_type;e=e.next);},calculate_beam:function(e,t,r){var n=e(t,r);return n&&t.s2&&r.sth&&abc2svg.sth.recal_beam.call(this,t,r),n},new_note:function(e,t,r){var n=abc2svg.C,a=e(t,r),i=this.get_curvoice();return i.sth&&a&&a.type==n.NOTE&&(a.sth=i.sth,i.sth=null),a},set_format:function(e,t,r,n){if("sth"==t){var a=this.get_curvoice();return 2==this.parse.state&&this.goto_tune(),void(a&&(a.sth=r.split(/[ \t;-]+/)))}e(t,r,n)},set_stems:function(e){e(),abc2svg.sth.set_sth.call(this)}},abc2svg.modules.hooks.push("goto_tune","parse",["calculate_beam","abc2svg.sth.calculate_beam"],["new_note","abc2svg.sth.new_note"],["set_format","abc2svg.sth.set_format"],["set_stems","abc2svg.sth.set_stems"]),abc2svg.modules.sth.loaded=!0,abc2svg.temper={set_bar_num:function(e){if(e(),this.cfmt().temper){var t=this.get_voice_tb()[0];t.temper=new Float32Array(12);for(var r=0;r<12;r++)t.temper[r]=this.cfmt().temper[r]/100}},set_fmt:function(e,t,r,n){if("temperament"==t){var a=new Float32Array(r.split(/ +/)),i=a.length;if(12==i){for(;--i>=0&&!isNaN(parseInt(a[i])););if(i<0)return void(this.cfmt().temper=a)}return void this.syntax(1,errs.bad_val,"%%temperament")}e(t,r,n)}},abc2svg.modules.hooks.push("syntax",["set_bar_num","abc2svg.temper.set_bar_num"],["set_format","abc2svg.temper.set_fmt"]),abc2svg.modules.temperament.loaded=!0,Opal.loaded(["./abc2svg-1.js"]),function(e){var t,r,n=e.top,a=[],i=e.nil,s=(e.const_get_qualified,e.const_get_relative),o=(e.breaker,e.slice,e.truthy),c=e.send,l=e.gvars,u=i,f=i,$=i,p=i,d=i;e.add_stubs(["$require","$[]","$>=","$length","$puts","$about_zupfnoter","$new","$exit","$mkdir_p","$first","$sort","$each","$clear_errors","$read","$message","$set_abc_input","$exist?","$parse","$apply_config","$load_music_model","$produce_pdfs","$write","$basename","$join","$get_errors"]),global.window={document:{createElementNS:function(){return{}}}},global.navigator={},global.btoa=function(e){return Buffer.from(e).toString("base64")},global.atob=function(e){return Buffer.from(e,"base64").toString("binary")},jsPDF=require("../vendor/jspdf.node.debug.js"),Ajv=require("ajv"),neatJSON=require("./neatjson_js"),fs=require("fs"),glob=require("glob"),n.$require("opal"),n.$require("opal-platform"),n.$require("vector2d"),n.$require("opal-neatjson"),n.$require("opal-ajv"),n.$require("consolelogger"),n.$require("harpnotes"),n.$require("abc_to_harpnotes_factory"),n.$require("abc2svg_to_harpnotes"),n.$require("opal-jspdf"),n.$require("opal-jszip"),n.$require("pdf_engine"),n.$require("init_conf"),n.$require("text_pane"),n.$require("command-controller"),n.$require("controller"),n.$require("controller-cli"),n.$require("confstack2"),n.$require("opal-abc2svg"),n.$require("version-prod"),n.$require("abc2svg-1.js"),u=o(t=s(a,"ARGV")["$[]"](0))?t:"*.abc",f=o(t=s(a,"ARGV")["$[]"](1))?t:".",$=s(a,"ARGV")["$[]"](2),o(function(e,t){return"number"==typeof e&&"number"==typeof t?e>=t:e["$>="](t)}(s(a,"ARGV").$length(),2))||(n.$puts('usage: node --max_old_space_size=4096 zupfnoter-cli.js "/tmp/zntest/*.abc" /tmp/xxxd'),n.$puts(s(a,"CliController").$new().$about_zupfnoter()),n.$exit(0)),s(a,"FileUtils").$mkdir_p(f),n.$puts("processing "+s(a,"ARGV").$first()+" to "+f),p=s(a,"CliController").$new(),d=s(a,"Dir")["$[]"](u).$sort(),c(d,"each",[],(r=function(t){var n,u=r.$$s||this,d=i,h=i,_=i,m=i;null==l.log&&(l.log=i),null==t&&(t=i),l.log.$clear_errors();try{d=s(a,"File").$read(t)}catch(t){if(!e.rescue(t,[s(a,"Exception")]))throw t;h=t;try{u.$puts(h)}finally{e.pop_exception()}}return l.log.$message("processing: "+t),p=s(a,"CliController").$new(),p.$set_abc_input(d),o(s(a,"File")["$exist?"]($))&&(u.$puts("reading config"),_=s(a,"JSON").$parse(s(a,"File").$read($)),p.$apply_config(_)),p.$load_music_model(),m=p.$produce_pdfs("."),c(m,"each",[],(n=function(e,t){var r=n.$$s||this,a=i;null==e&&(e=i),null==t&&(t=i),a=f+"/"+e,r.$puts(e);var s=require("encoding"),o=s.convert(t,"Latin-1");return fs.writeFileSync(a,o),i},n.$$s=u,n.$$arity=2,n)),s(a,"File").$write(f+"/"+s(a,"File").$basename(t)+".err.log",l.log.$get_errors().$join("\n"))},r.$$s=n,r.$$arity=1,r))}(Opal)},{"../vendor/jspdf.node.debug.js":87,"./neatjson_js":1,ajv:2,encoding:47,fs:void 0,glob:52}],87:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e){function t(e){for(var t=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],r=0;r<64;r++){var n=w((t[r]*e+50)/100);n<1?n=1:n>255&&(n=255),A[D[r]]=n}for(var a=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],i=0;i<64;i++){var s=w((a[i]*e+50)/100);s<1?s=1:s>255&&(s=255),k[D[i]]=s}for(var o=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],c=0,l=0;l<8;l++)for(var u=0;u<8;u++)E[c]=1/(A[D[c]]*o[l]*o[u]*8),S[c]=1/(k[D[c]]*o[l]*o[u]*8),c++}function r(e,t){for(var r=0,n=0,a=new Array,i=1;i<=16;i++){for(var s=1;s<=e[i];s++)a[t[n]]=[],a[t[n]][0]=r,a[t[n]][1]=i,n++,r++;r*=2}return a}function n(){y=r(z,q),g=r(G,Y),v=r(U,H),b=r(V,Q)}function a(){for(var e=1,t=2,r=1;r<=15;r++){for(var n=e;n<t;n++)C[32767+n]=r,N[32767+n]=[],N[32767+n][1]=r,N[32767+n][0]=n;for(var a=-(t-1);a<=-e;a++)C[32767+a]=r,N[32767+a]=[],N[32767+a][1]=r,N[32767+a][0]=t-1+a;e<<=1,t<<=1}}function i(){for(var e=0;e<256;e++)R[e]=19595*e,R[e+256>>0]=38470*e,R[e+512>>0]=7471*e+32768,R[e+768>>0]=-11059*e,R[e+1024>>0]=-21709*e,R[e+1280>>0]=32768*e+8421375,R[e+1536>>0]=-27439*e,R[e+1792>>0]=-5329*e}function s(e){for(var t=e[0],r=e[1]-1;r>=0;)t&1<<r&&(P|=1<<M),r--,--M<0&&(255==P?(o(255),o(0)):o(P),M=7,P=0)}function o(e){L.push(e)}function c(e){o(e>>8&255),o(255&e)}function l(e,t){var r,n,a,i,s,o,c,l,u,f=0;for(u=0;u<8;++u){r=e[f],n=e[f+1],a=e[f+2],i=e[f+3],s=e[f+4],o=e[f+5],c=e[f+6],l=e[f+7];var $=r+l,p=r-l,d=n+c,h=n-c,_=a+o,m=a-o,y=i+s,g=i-s,v=$+y,b=$-y,x=d+_,w=d-_;e[f]=v+x,e[f+4]=v-x;var A=.707106781*(w+b);e[f+2]=b+A,e[f+6]=b-A,v=g+m,x=m+h,w=h+p;var k=.382683433*(v-w),E=.5411961*v+k,S=1.306562965*w+k,N=.707106781*x,C=p+N,O=p-N;e[f+5]=O+E,e[f+3]=O-E,e[f+1]=C+S,e[f+7]=C-S,f+=8}for(f=0,u=0;u<8;++u){r=e[f],n=e[f+8],a=e[f+16],i=e[f+24],s=e[f+32],o=e[f+40],c=e[f+48],l=e[f+56];var L=r+l,P=r-l,M=n+c,T=n-c,B=a+o,j=a-o,F=i+s,R=i-s,D=L+F,z=L-F,q=M+B,U=M-B;e[f]=D+q,e[f+32]=D-q;var H=.707106781*(U+z);e[f+16]=z+H,e[f+48]=z-H,D=R+j,q=j+T,U=T+P;var G=.382683433*(D-U),Y=.5411961*D+G,V=1.306562965*U+G,Q=.707106781*q,X=P+Q,W=P-Q;e[f+40]=W+Y,e[f+24]=W-Y,e[f+8]=X+V,e[f+56]=X-V,f++}var J;for(u=0;u<64;++u)J=e[u]*t[u],I[u]=J>0?J+.5|0:J-.5|0;return I}function u(){c(65504),c(16),o(74),o(70),o(73),o(70),o(0),o(1),o(1),o(0),c(1),c(1),o(0),o(0)}function f(e,t){c(65472),c(17),o(8),c(t),c(e),o(3),o(1),o(17),o(0),o(2),o(17),o(1),o(3),o(17),o(1)}function $(){c(65499),c(132),o(0);for(var e=0;e<64;e++)o(A[e]);o(1);for(var t=0;t<64;t++)o(k[t])}function p(){c(65476),c(418),o(0);for(var e=0;e<16;e++)o(z[e+1]);for(var t=0;t<=11;t++)o(q[t]);o(16);for(var r=0;r<16;r++)o(U[r+1]);for(var n=0;n<=161;n++)o(H[n]);o(1);for(var a=0;a<16;a++)o(G[a+1]);for(var i=0;i<=11;i++)o(Y[i]);o(17);for(var s=0;s<16;s++)o(V[s+1]);for(var l=0;l<=161;l++)o(Q[l])}function d(){c(65498),c(12),o(3),o(1),o(0),o(2),o(17),o(3),o(17),o(0),o(63),o(0)}function h(e,t,r,n,a){for(var i,o=a[0],c=a[240],u=l(e,t),f=0;f<64;++f)O[D[f]]=u[f];var $=O[0]-r;r=O[0],0==$?s(n[0]):(i=32767+$,s(n[C[i]]),s(N[i]));for(var p=63;p>0&&0==O[p];p--);if(0==p)return s(o),r;for(var d,h=1;h<=p;){for(var _=h;0==O[h]&&h<=p;++h);var m=h-_;if(m>=16){d=m>>4;for(var y=1;y<=d;++y)s(c);m&=15}i=32767+O[h],s(a[(m<<4)+C[i]]),s(N[i]),h++}return 63!=p&&s(o),r}function _(){for(var e=String.fromCharCode,t=0;t<256;t++)F[t]=e(t)}function m(e){if(e<=0&&(e=1),e>100&&(e=100),x!=e){var r=0;r=e<50?Math.floor(5e3/e):Math.floor(200-2*e),t(r),x=e}}var y,g,v,b,x,w=Math.floor,A=new Array(64),k=new Array(64),E=new Array(64),S=new Array(64),N=new Array(65535),C=new Array(65535),I=new Array(64),O=new Array(64),L=[],P=0,M=7,T=new Array(64),B=new Array(64),j=new Array(64),F=new Array(256),R=new Array(2048),D=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],z=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],q=[0,1,2,3,4,5,6,7,8,9,10,11],U=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],H=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],G=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],Y=[0,1,2,3,4,5,6,7,8,9,10,11],V=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],Q=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];this.encode=function(e,t){(new Date).getTime();t&&m(t),L=new Array,P=0,M=7,c(65496),u(),$(),f(e.width,e.height),p(),d();var r=0,n=0,a=0;P=0,M=7,this.encode.displayName="_encode_";for(var i,o,l,_,x,w,A,k,N,C=e.data,I=e.width,O=e.height,F=4*I,D=0;D<O;){for(i=0;i<F;){for(x=F*D+i,w=x,A=-1,k=0,N=0;N<64;N++)k=N>>3,A=4*(7&N),w=x+k*F+A,D+k>=O&&(w-=F*(D+1+k-O)),i+A>=F&&(w-=i+A-F+4),o=C[w++],l=C[w++],_=C[w++],T[N]=(R[o]+R[l+256>>0]+R[_+512>>0]>>16)-128,B[N]=(R[o+768>>0]+R[l+1024>>0]+R[_+1280>>0]>>16)-128,j[N]=(R[o+1280>>0]+R[l+1536>>0]+R[_+1792>>0]>>16)-128;r=h(T,E,r,y,v),n=h(B,S,n,g,b),a=h(j,S,a,g,b),i+=32}D+=8}if(M>=0){var z=[];z[1]=M+1,z[0]=(1<<M+1)-1,s(z)}return c(65497),new Uint8Array(L)},function(){(new Date).getTime();e||(e=50),_(),n(),a(),i(),m(e),(new Date).getTime()}()}function i(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,-1===["BM","BA","CI","CP","IC","PT"].indexOf(this.flag))throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function s(e){r.default=e}function o(){r.default=f}Object.defineProperty(r,"__esModule",{value:!0});var c=function(e){function r(t){if("object"!==n(t))throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var r={};this.subscribe=function(e,t,n){if(n=n||!1,"string"!=typeof e||"function"!=typeof t||"boolean"!=typeof n)throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");r.hasOwnProperty(e)||(r[e]={});var a=Math.random().toString(35);return r[e][a]=[t,!!n],a},this.unsubscribe=function(e){for(var t in r)if(r[t][e])return delete r[t][e],0===Object.keys(r[t]).length&&delete r[t],!0;return!1},this.publish=function(n){if(r.hasOwnProperty(n)){var a=Array.prototype.slice.call(arguments,1),i=[];for(var s in r[n]){var o=r[n][s];try{o[0].apply(t,a)}catch(t){e.console&&console.error("jsPDF PubSub Error",t.message,t)}o[1]&&i.push(s)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return r}}function a(t,i,s,o){var c={},l=[],u=1;"object"===n(t)&&(c=t,t=c.orientation,i=c.unit||i,s=c.format||s,o=c.compress||c.compressPdf||o,l=c.filters||(!0===o?["FlateEncode"]:l),u="number"==typeof c.userUnit?Math.abs(c.userUnit):1),i=i||"mm",t=(""+(t||"P")).toLowerCase();var f=c.putOnlyUsedFonts||!0,$={},p={internal:{},__private__:{}};p.__private__.PubSub=r;var d="1.3",h=p.__private__.getPdfVersion=function(){return d},_=(p.__private__.setPdfVersion=function(e){d=e},{a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]}),m=(p.__private__.getPageFormats=function(){return _},p.__private__.getPageFormat=function(e){return _[e]});"string"==typeof s&&(s=m(s)),s=s||m("a4");var y=p.f2=p.__private__.f2=function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.f2");return e.toFixed(2)},g=p.__private__.f3=function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.f3");return e.toFixed(3)},v="00000000000000000000000000000000",b=p.__private__.getFileId=function(){return v},x=p.__private__.setFileId=function(e){return e=e||"12345678901234567890123456789012".split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),v=e};p.setFileId=function(e){return x(e),this},p.getFileId=function(){return b()};var w,A=p.__private__.convertDateToPDFDate=function(e){var t=e.getTimezoneOffset(),r=t<0?"+":"-",n=Math.floor(Math.abs(t/60)),a=Math.abs(t%60),i=[r,T(n),"'",T(a),"'"].join("");return["D:",e.getFullYear(),T(e.getMonth()+1),T(e.getDate()),T(e.getHours()),T(e.getMinutes()),T(e.getSeconds()),i].join("")},k=p.__private__.convertPDFDateToDate=function(e){var t=parseInt(e.substr(2,4),10),r=parseInt(e.substr(6,2),10)-1,n=parseInt(e.substr(8,2),10),a=parseInt(e.substr(10,2),10),i=parseInt(e.substr(12,2),10),s=parseInt(e.substr(14,2),10);parseInt(e.substr(16,2),10),parseInt(e.substr(20,2),10);return new Date(t,r,n,a,i,s,0)},E=p.__private__.setCreationDate=function(e){var t,r=/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|\-0[0-9]|\-1[0-1])\'(0[0-9]|[1-5][0-9])\'?$/;if(void 0===e&&(e=new Date),"object"===n(e)&&"[object Date]"===Object.prototype.toString.call(e))t=A(e);else{if(!r.test(e))throw new Error("Invalid argument passed to jsPDF.setCreationDate");t=e}return w=t},S=p.__private__.getCreationDate=function(e){var t=w;return"jsDate"===e&&(t=k(w)),t};p.setCreationDate=function(e){return E(e),this},p.getCreationDate=function(e){return S(e)};var N,C,I,O,L,P,M,T=p.__private__.padd2=function(e){return("0"+parseInt(e)).slice(-2)},B=!1,j=[],F=[],R=0,D=(p.__private__.setCustomOutputDestination=function(e){C=e},p.__private__.resetCustomOutputDestination=function(e){C=void 0},p.__private__.out=function(e){var t;return e="string"==typeof e?e:e.toString(),t=void 0===C?B?j[N]:F:C,t.push(e),B||(R+=e.length+1),t}),z=p.__private__.write=function(e){return D(1===arguments.length?e.toString():Array.prototype.join.call(arguments," "))},q=p.__private__.getArrayBuffer=function(e){for(var t=e.length,r=new ArrayBuffer(t),n=new Uint8Array(r);t--;)n[t]=e.charCodeAt(t);return r},U=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]],H=(p.__private__.getStandardFonts=function(e){return U},c.fontSize||16),G=(p.__private__.setFontSize=p.setFontSize=function(e){return H=e,this},p.__private__.getFontSize=p.getFontSize=function(){return H}),Y=c.R2L||!1,V=(p.__private__.setR2L=p.setR2L=function(e){return Y=e,this},p.__private__.getR2L=p.getR2L=function(e){return Y},p.__private__.setZoomMode=function(e){var t=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^\d*\.?\d*\%$/.test(e))I=e;else if(isNaN(e)){if(-1===t.indexOf(e))throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+e+'" is not recognized.');I=e}else I=parseInt(e,10)}),Q=(p.__private__.getZoomMode=function(){return I},p.__private__.setPageMode=function(e){if(-1==[void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(e))throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+e+'" is not recognized.');O=e}),X=(p.__private__.getPageMode=function(){return O},p.__private__.setLayoutMode=function(e){if(-1==[void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(e))throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+e+'" is not recognized.');L=e}),W=(p.__private__.getLayoutMode=function(){return L},p.__private__.setDisplayMode=p.setDisplayMode=function(e,t,r){return V(e),X(t),Q(r),this},{title:"",subject:"",author:"",keywords:"",creator:""}),J=(p.__private__.getDocumentProperty=function(e){if(-1===Object.keys(W).indexOf(e))throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return W[e]},p.__private__.getDocumentProperties=function(e){return W},p.__private__.setDocumentProperties=p.setProperties=p.setDocumentProperties=function(e){for(var t in W)W.hasOwnProperty(t)&&e[t]&&(W[t]=e[t]);return this},p.__private__.setDocumentProperty=function(e,t){if(-1===Object.keys(W).indexOf(e))throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return W[e]=t},0),K=[],Z={},ee={},te=0,re=[],ne=[],ae=new r(p),ie=c.hotfixes||[],se=p.__private__.newObject=function(){var e=oe();return ce(e,!0),e},oe=p.__private__.newObjectDeferred=function(){return J++,K[J]=function(){return R},J},ce=function(e,t){return t="boolean"==typeof t&&t,K[e]=R,t&&D(e+" 0 obj"),e},le=p.__private__.newAdditionalObject=function(){var e=oe(),t={objId:e,content:""};return ne.push(t),t},ue=oe(),fe=oe(),$e=p.__private__.decodeColorString=function(e){var t=e.split(" ");if(2===t.length&&("g"===t[1]||"G"===t[1])){var r=parseFloat(t[0]);t=[r,r,r,"r"]}for(var n="#",a=0;a<3;a++)n+=("0"+Math.floor(255*parseFloat(t[a])).toString(16)).slice(-2);return n},pe=p.__private__.encodeColorString=function(e){var t;"string"==typeof e&&(e={ch1:e});var r=e.ch1,a=e.ch2,i=e.ch3,s=e.ch4,o=(e.precision,"draw"===e.pdfColorType?["G","RG","K"]:["g","rg","k"]);if("string"==typeof r&&"#"!==r.charAt(0)){var c=new RGBColor(r);if(c.ok)r=c.toHex();else if(!/^\d*\.?\d*$/.test(r))throw new Error('Invalid color "'+r+'" passed to jsPDF.encodeColorString.')}if("string"==typeof r&&/^#[0-9A-Fa-f]{3}$/.test(r)&&(r="#"+r[1]+r[1]+r[2]+r[2]+r[3]+r[3]),"string"==typeof r&&/^#[0-9A-Fa-f]{6}$/.test(r)){var l=parseInt(r.substr(1),16);r=l>>16&255,a=l>>8&255,i=255&l}if(void 0===a||void 0===s&&r===a&&a===i)if("string"==typeof r)t=r+" "+o[0];else switch(e.precision){case 2:t=y(r/255)+" "+o[0];break;case 3:default:t=g(r/255)+" "+o[0]}else if(void 0===s||"object"===n(s)){if(s&&!isNaN(s.a)&&0===s.a)return t=["1.000","1.000","1.000",o[1]].join(" ");if("string"==typeof r)t=[r,a,i,o[1]].join(" ");else switch(e.precision){case 2:t=[y(r/255),y(a/255),y(i/255),o[1]].join(" ");break;default:case 3:t=[g(r/255),g(a/255),g(i/255),o[1]].join(" ")}}else if("string"==typeof r)t=[r,a,i,s,o[2]].join(" ");else switch(e.precision){case 2:t=[y(r/255),y(a/255),y(i/255),y(s/255),o[2]].join(" ");break;case 3:default:t=[g(r/255),g(a/255),g(i/255),g(s/255),o[2]].join(" ")}return t},de=p.__private__.getFilters=function(){return l},he=p.__private__.putStream=function(e){e=e||{};var t=e.data||"",r=e.filters||de(),n=e.alreadyAppliedFilters||[],i=e.addLength1||!1,s=t.length,o={};!0===r&&(r=["FlateEncode"]);var c=e.additionalKeyValues||[];o=void 0!==a.API.processDataByFilters?a.API.processDataByFilters(t,r):{data:t,reverseChain:[]};var l=o.reverseChain+(Array.isArray(n)?n.join(" "):n.toString());0!==o.data.length&&(c.push({key:"Length",value:o.data.length}),!0===i&&c.push({key:"Length1",value:s})),0!=l.length&&(l.split("/").length-1==1?c.push({key:"Filter",value:l}):c.push({key:"Filter",value:"["+l+"]"})),D("<<");for(var u=0;u<c.length;u++)D("/"+c[u].key+" "+c[u].value);D(">>"),0!==o.data.length&&(D("stream"),D(o.data),D("endstream"))},_e=p.__private__.putPage=function(e){var t=(e.mediaBox,e.number),r=e.data,n=e.objId,a=e.contentsObjId;ce(n,!0);re[N].mediaBox.topRightX,re[N].mediaBox.bottomLeftX,re[N].mediaBox.topRightY,re[N].mediaBox.bottomLeftY;D("<</Type /Page"),D("/Parent "+e.rootDictionaryObjId+" 0 R"),D("/Resources "+e.resourceDictionaryObjId+" 0 R"),D("/MediaBox ["+parseFloat(y(e.mediaBox.bottomLeftX))+" "+parseFloat(y(e.mediaBox.bottomLeftY))+" "+y(re[N].mediaBox.topRightX)+" "+y(re[N].mediaBox.topRightY)+"]"),null!==e.cropBox&&D("/CropBox ["+y(e.cropBox.bottomLeftX)+" "+y(e.cropBox.bottomLeftY)+" "+y(e.cropBox.topRightX)+" "+y(e.cropBox.topRightY)+"]"),null!==e.bleedBox&&D("/BleedBox ["+y(e.bleedBox.bottomLeftX)+" "+y(e.bleedBox.bottomLeftY)+" "+y(e.bleedBox.topRightX)+" "+y(e.bleedBox.topRightY)+"]"),null!==e.trimBox&&D("/TrimBox ["+y(e.trimBox.bottomLeftX)+" "+y(e.trimBox.bottomLeftY)+" "+y(e.trimBox.topRightX)+" "+y(e.trimBox.topRightY)+"]"),null!==e.artBox&&D("/ArtBox ["+y(e.artBox.bottomLeftX)+" "+y(e.artBox.bottomLeftY)+" "+y(e.artBox.topRightX)+" "+y(e.artBox.topRightY)+"]"),"number"==typeof e.userUnit&&1!==e.userUnit&&D("/UserUnit "+e.userUnit),ae.publish("putPage",{objId:n,pageContext:re[t],pageNumber:t,page:r}),D("/Contents "+a+" 0 R"),D(">>"),D("endobj");var i=r.join("\n");return ce(a,!0),he({data:i,filters:de()}),D("endobj"),n},me=p.__private__.putPages=function(){var e,t,r=[];for(e=1;e<=te;e++)re[e].objId=oe(),re[e].contentsObjId=oe();for(e=1;e<=te;e++)r.push(_e({number:e,data:j[e],objId:re[e].objId,contentsObjId:re[e].contentsObjId,mediaBox:re[e].mediaBox,cropBox:re[e].cropBox,bleedBox:re[e].bleedBox,trimBox:re[e].trimBox,artBox:re[e].artBox,userUnit:re[e].userUnit,rootDictionaryObjId:ue,resourceDictionaryObjId:fe}));ce(ue,!0),D("<</Type /Pages");var n="/Kids [";for(t=0;t<te;t++)n+=r[t]+" 0 R ";D(n+"]"),D("/Count "+te),D(">>"),D("endobj"),ae.publish("postPutPages")},ye=function(e){ae.publish("putFont",{font:e,out:D,newObject:se,putStream:he}),!0!==e.isAlreadyPutted&&(e.objectNumber=se(),D("<<"),D("/Type /Font"),D("/BaseFont /"+e.postScriptName),D("/Subtype /Type1"),"string"==typeof e.encoding&&D("/Encoding /"+e.encoding),D("/FirstChar 32"),D("/LastChar 255"),D(">>"),D("endobj"))},ge=function(){for(var e in Z)Z.hasOwnProperty(e)&&(!1===f||!0===f&&$.hasOwnProperty(e))&&ye(Z[e])},ve=function(){D("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),D("/Font <<");for(var e in Z)Z.hasOwnProperty(e)&&(!1===f||!0===f&&$.hasOwnProperty(e))&&D("/"+e+" "+Z[e].objectNumber+" 0 R");D(">>"),D("/XObject <<"),ae.publish("putXobjectDict"),D(">>")},be=function(){ge(),ae.publish("putResources"),ce(fe,!0),D("<<"),ve(),D(">>"),D("endobj"),ae.publish("postPutResources")},xe=function(){ae.publish("putAdditionalObjects");for(var e=0;e<ne.length;e++){var t=ne[e];ce(t.objId,!0),D(t.content),D("endobj")}ae.publish("postPutAdditionalObjects")},we=function(e,t,r){ee.hasOwnProperty(t)||(ee[t]={}),ee[t][r]=e},Ae=function(e,t,r,n,a){a=a||!1;var i="F"+(Object.keys(Z).length+1).toString(10),s={id:i,postScriptName:e,fontName:t,fontStyle:r,encoding:n,isStandardFont:a,metadata:{}},o=this;return ae.publish("addFont",{font:s,instance:o}),void 0!==i&&(Z[i]=s,we(i,t,r)),i},ke=function(e,t){var r,n,a,i,s,o,c,l,u;if(t=t||{},a=t.sourceEncoding||"Unicode",s=t.outputEncoding,(t.autoencode||s)&&Z[P].metadata&&Z[P].metadata[a]&&Z[P].metadata[a].encoding&&(i=Z[P].metadata[a].encoding,!s&&Z[P].encoding&&(s=Z[P].encoding),!s&&i.codePages&&(s=i.codePages[0]),"string"==typeof s&&(s=i[s]),s)){for(c=!1,o=[],r=0,n=e.length;r<n;r++)l=s[e.charCodeAt(r)],l?o.push(String.fromCharCode(l)):o.push(e[r]),o[r].charCodeAt(0)>>8&&(c=!0);e=o.join("")}for(r=e.length;void 0===c&&0!==r;)e.charCodeAt(r-1)>>8&&(c=!0),r--;if(!c)return e;for(o=t.noBOM?[]:[254,255],r=0,n=e.length;r<n;r++){if(l=e.charCodeAt(r),(u=l>>8)>>8)throw new Error("Character at position "+r+" of string '"+e+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");o.push(u),o.push(l-(u<<8))}return String.fromCharCode.apply(void 0,o)},Ee=p.__private__.pdfEscape=p.pdfEscape=function(e,t){return ke(e,t).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Se=p.__private__.beginPage=function(e,t){var r,n="string"==typeof t&&t.toLowerCase();if("string"==typeof e&&m(e.toLowerCase())&&(e=m(e.toLowerCase())[0],t=m(e.toLowerCase())[1]),Array.isArray(e)&&(t=e[1],e=e[0]),(isNaN(e)||isNaN(t))&&(e=s[0],t=s[1]),n){switch(n.substr(0,1)){case"l":t>e&&(n="s");break;case"p":e>t&&(n="s")}"s"===n&&(r=e,e=t,t=r)}(e>14400||t>14400)&&(console.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),e=Math.min(14400,e),t=Math.min(14400,t)),s=[e,t],B=!0,j[++te]=[],re[te]={objId:0,contentsObjId:0,userUnit:Number(u),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(e),topRightY:Number(t)}},Ie(te)},Ne=function(){Se.apply(this,arguments),Xe(Qe),D(nt),0!==lt&&D(lt+" J"),0!==ft&&D(ft+" j"),ae.publish("addPage",{pageNumber:te})},Ce=function(e){e>0&&e<=te&&(j.splice(e,1),te--,N>te&&(N=te),this.setPage(N))},Ie=function(e){e>0&&e<=te&&(N=e)},Oe=p.__private__.getNumberOfPages=p.getNumberOfPages=function(){return j.length-1},Le=function(e,t,r){var n,a=void 0;return r=r||{},e=void 0!==e?e:Z[P].fontName,t=void 0!==t?t:Z[P].fontStyle,n=e.toLowerCase(),void 0!==ee[n]&&void 0!==ee[n][t]?a=ee[n][t]:void 0!==ee[e]&&void 0!==ee[e][t]?a=ee[e][t]:!1===r.disableWarning&&console.warn("Unable to look up font label for font '"+e+"', '"+t+"'. Refer to getFontList() for available fonts."),a||r.noFallback||null==(a=ee.times[t])&&(a=ee.times.normal),a},Pe=p.__private__.putInfo=function(){se(),D("<<"),D("/Producer (jsPDF "+a.version+")");for(var e in W)W.hasOwnProperty(e)&&W[e]&&D("/"+e.substr(0,1).toUpperCase()+e.substr(1)+" ("+Ee(W[e])+")");D("/CreationDate ("+w+")"),D(">>"),D("endobj")},Me=p.__private__.putCatalog=function(e){e=e||{};var t=e.rootDictionaryObjId||ue;switch(se(),D("<<"),D("/Type /Catalog"),D("/Pages "+t+" 0 R"),I||(I="fullwidth"),I){case"fullwidth":D("/OpenAction [3 0 R /FitH null]");break;case"fullheight":D("/OpenAction [3 0 R /FitV null]");break;case"fullpage":D("/OpenAction [3 0 R /Fit]");break;case"original":D("/OpenAction [3 0 R /XYZ null null 1]");break;default:var r=""+I;"%"===r.substr(r.length-1)&&(I=parseInt(I)/100),"number"==typeof I&&D("/OpenAction [3 0 R /XYZ null null "+y(I)+"]")}switch(L||(L="continuous"),L){case"continuous":D("/PageLayout /OneColumn");break;case"single":D("/PageLayout /SinglePage");break;case"two":case"twoleft":D("/PageLayout /TwoColumnLeft");break;case"tworight":D("/PageLayout /TwoColumnRight")}O&&D("/PageMode /"+O),ae.publish("putCatalog"),D(">>"),D("endobj")},Te=p.__private__.putTrailer=function(){D("trailer"),D("<<"),D("/Size "+(J+1)),D("/Root "+J+" 0 R"),D("/Info "+(J-1)+" 0 R"),D("/ID [ <"+v+"> <"+v+"> ]"),D(">>")},Be=p.__private__.putHeader=function(){D("%PDF-"+d),D("%")},je=p.__private__.putXRef=function(){var e=1,t="0000000000";for(D("xref"),D("0 "+(J+1)),D("0000000000 65535 f "),e=1;e<=J;e++){var r=K[e];D("function"==typeof r?(t+K[e]()).slice(-10)+" 00000 n ":void 0!==K[e]?(t+K[e]).slice(-10)+" 00000 n ":"0000000000 00000 n ")}},Fe=p.__private__.buildDocument=function(){B=!1,J=0,R=0,F=[],K=[],ne=[],ue=oe(),fe=oe(),ae.publish("buildDocument"),Be(),me(),xe(),be(),Pe(),Me();var e=R;return je(),Te(),D("startxref"),D(""+e),D("%%EOF"),B=!0,F.join("\n")},Re=p.__private__.getBlob=function(e){return new Blob([q(e)],{type:"application/pdf"})},De=p.output=p.__private__.output=function(t){return t.foo=function(){try{return t.apply(this,arguments)}catch(t){var r=t.stack||"";~r.indexOf(" at ")&&(r=r.split(" at ")[1]);var n="Error in function "+r.split("\n")[0].split("<")[0]+": "+t.message;if(!e.console)throw new Error(n);e.console.error(n,t),e.alert&&alert(n)}},t.foo.bar=t,t.foo}(function(t,r){r=r||{};var n=Fe();switch("string"==typeof r?r={filename:r}:r.filename=r.filename||"generated.pdf",t){case void 0:return n;case"save":p.save(r.filename);break;case"arraybuffer":return q(n);case"blob":return Re(n);case"bloburi":
case"bloburl":return e.URL&&e.URL.createObjectURL(Re(n))||void 0;case"datauristring":case"dataurlstring":return"data:application/pdf;filename="+r.filename+";base64,"+btoa(n);case"dataurlnewwindow":var a='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring")+'"></iframe></body></html>',i=e.open();if(null!==i&&i.document.write(a),i||"undefined"==typeof safari)return i;case"datauri":case"dataurl":return e.document.location.href="data:application/pdf;filename="+r.filename+";base64,"+btoa(n);default:return null}}),ze=function(e){return!0===Array.isArray(ie)&&ie.indexOf(e)>-1};switch(i){case"pt":M=1;break;case"mm":M=72/25.4;break;case"cm":M=72/2.54;break;case"in":M=72;break;case"px":M=1==ze("px_scaling")?.75:96/72;break;case"pc":case"em":M=12;break;case"ex":M=6;break;default:throw new Error("Invalid unit: "+i)}E(),x();var qe=p.__private__.getPageInfo=function(e){if(isNaN(e)||e%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:re[e].objId,pageNumber:e,pageContext:re[e]}},Ue=p.__private__.getPageInfoByObjId=function(e){for(var t in re)if(re[t].objId===e)break;if(isNaN(e)||e%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");return qe(t)},He=p.__private__.getCurrentPageInfo=function(){return{objId:re[N].objId,pageNumber:N,pageContext:re[N]}};p.addPage=function(){return Ne.apply(this,arguments),this},p.setPage=function(){return Ie.apply(this,arguments),this},p.insertPage=function(e){return this.addPage(),this.movePage(N,e),this},p.movePage=function(e,t){if(e>t){for(var r=j[e],n=re[e],a=e;a>t;a--)j[a]=j[a-1],re[a]=re[a-1];j[t]=r,re[t]=n,this.setPage(t)}else if(e<t){for(var r=j[e],n=re[e],a=e;a<t;a++)j[a]=j[a+1],re[a]=re[a+1];j[t]=r,re[t]=n,this.setPage(t)}return this},p.deletePage=function(){return Ce.apply(this,arguments),this};var Ge=(p.__private__.text=p.text=function(e,t,r,a){function i(e){return e=e.split("\t").join(Array(a.TabLen||9).join(" ")),Ee(e,l)}function s(e){for(var t,r=e.concat(),n=[],a=r.length;a--;)t=r.shift(),"string"==typeof t?n.push(t):Array.isArray(e)&&1===t.length?n.push(t[0]):n.push([t[0],t[1],t[2]]);return n}function o(e,t){var r;if("string"==typeof e)r=t(e)[0];else if(Array.isArray(e)){for(var n,a,i=e.concat(),s=[],o=i.length;o--;)n=i.shift(),"string"==typeof n?s.push(t(n)[0]):Array.isArray(n)&&"string"===n[0]&&(a=t(n[0],n[1],n[2]),s.push([a[0],a[1],a[2]]));r=s}return r}var c;"number"!=typeof e||"number"!=typeof t||"string"!=typeof r&&!Array.isArray(r)||(c=r,r=t,t=e,e=c);var l=arguments[3],u=arguments[4],f=arguments[5];if("object"===n(l)&&null!==l||("string"==typeof u&&(f=u,u=null),"string"==typeof l&&(f=l,l=null),"number"==typeof l&&(u=l,l=null),a={flags:l,angle:u,align:f}),l=l||{},l.noBOM=l.noBOM||!0,l.autoencode=l.autoencode||!0,isNaN(t)||isNaN(r)||void 0===e||null===e)throw new Error("Invalid arguments passed to jsPDF.text");if(0===e.length)return _;var p="",d=!1,h="number"==typeof a.lineHeightFactor?a.lineHeightFactor:Ve,_=a.scope||this,m=!1,v=!0;if("string"==typeof e)m=!0;else if(Array.isArray(e)){for(var b,x=e.concat(),w=[],A=x.length;A--;)("string"!=typeof(b=x.shift())||Array.isArray(b)&&"string"!=typeof b[0])&&(v=!1);m=v}if(!1===m)throw new Error('Type of text must be string or Array. "'+e+'" is not recognized.');var k=Z[P].encoding;"WinAnsiEncoding"!==k&&"StandardEncoding"!==k||(e=o(e,function(e,t,r){return[i(e),t,r]})),"string"==typeof e&&(e=e.match(/[\r?\n]/)?e.split(/\r\n|\r|\n/g):[e]);var E=H/_.internal.scaleFactor,S=E*(Ve-1);switch(a.baseline){case"bottom":r-=S;break;case"top":r+=E-S;break;case"hanging":r+=E-2*S;break;case"middle":r+=E/2-S}var N=a.maxWidth||0;N>0&&("string"==typeof e?e=_.splitTextToSize(e,N):"[object Array]"===Object.prototype.toString.call(e)&&(e=_.splitTextToSize(e.join(" "),N)));var C={text:e,x:t,y:r,options:a,mutex:{pdfEscape:Ee,activeFontKey:P,fonts:Z,activeFontSize:H}};ae.publish("preProcessText",C),e=C.text,a=C.options;var u=a.angle,I=_.internal.scaleFactor,O=[];if(u){u*=Math.PI/180;var L=Math.cos(u),M=Math.sin(u);O=[y(L),y(M),y(-1*M),y(L)]}var T=a.charSpace;void 0!==T&&(p+=g(T*I)+" Tc\n");var B=(a.lang,-1),j=void 0!==a.renderingMode?a.renderingMode:a.stroke,F=_.internal.getCurrentPageInfo().pageContext;switch(j){case 0:case!1:case"fill":B=0;break;case 1:case!0:case"stroke":B=1;break;case 2:case"fillThenStroke":B=2;break;case 3:case"invisible":B=3;break;case 4:case"fillAndAddForClipping":B=4;break;case 5:case"strokeAndAddPathForClipping":B=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":B=6;break;case 7:case"addToPathForClipping":B=7}var R=void 0!==F.usedRenderingMode?F.usedRenderingMode:-1;-1!==B?p+=B+" Tr\n":-1!==R&&(p+="0 Tr\n"),-1!==B&&(F.usedRenderingMode=B);var z,f=a.align||"left",q=H*h,U=_.internal.pageSize.getWidth(),I=_.internal.scaleFactor,G=Z[P],T=a.charSpace||ot,N=a.maxWidth||0,l={},V=[];if("[object Array]"===Object.prototype.toString.call(e)){var Q,X,z,w=s(e);"left"!==f&&(z=w.map(function(e){return _.getStringUnitWidth(e,{font:G,charSpace:T,fontSize:H})*H/I}));var W,X=Math.max.apply(Math,z),J=0;if("right"===f){t-=z[0],e=[];for(var K=0,A=w.length;K<A;K++)X-z[K],0===K?(W=Ze(t),Q=et(r)):(W=(J-z[K])*I,Q=-q),e.push([w[K],W,Q]),J=z[K]}else if("center"===f){t-=z[0]/2,e=[];for(var K=0,A=w.length;K<A;K++)(X-z[K])/2,0===K?(W=Ze(t),Q=et(r)):(W=(J-z[K])/2*I,Q=-q),e.push([w[K],W,Q]),J=z[K]}else if("left"===f){e=[];for(var K=0,A=w.length;K<A;K++)Q=0===K?et(r):-q,W=0===K?Ze(t):0,e.push(w[K])}else{if("justify"!==f)throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');e=[];for(var N=0!==N?N:U,K=0,A=w.length;K<A;K++)Q=0===K?et(r):-q,W=0===K?Ze(t):0,K<A-1&&V.push(((N-z[K])/(w[K].split(" ").length-1)*I).toFixed(2)),e.push([w[K],W,Q])}}!0===("boolean"==typeof a.R2L?a.R2L:Y)&&(e=o(e,function(e,t,r){return[e.split("").reverse().join(""),t,r]}));var C={text:e,x:t,y:r,options:a,mutex:{pdfEscape:Ee,activeFontKey:P,fonts:Z,activeFontSize:H}};ae.publish("postProcessText",C),e=C.text,d=C.mutex.isHex;var w=s(e);e=[];for(var ee,te,re,ne=0,A=w.length,ie="",K=0;K<A;K++)ie="",Array.isArray(w[K])?(ee=parseFloat(w[K][1]),te=parseFloat(w[K][2]),re=(d?"<":"(")+w[K][0]+(d?">":")"),ne=1):(ee=Ze(t),te=et(r),re=(d?"<":"(")+w[K]+(d?">":")")),void 0!==V&&void 0!==V[K]&&(ie=V[K]+" Tw\n"),0!==O.length&&0===K?e.push(ie+O.join(" ")+" "+ee.toFixed(2)+" "+te.toFixed(2)+" Tm\n"+re):1===ne||0===ne&&0===K?e.push(ie+ee.toFixed(2)+" "+te.toFixed(2)+" Td\n"+re):e.push(ie+re);e=0===ne?e.join(" Tj\nT* "):e.join(" Tj\n"),e+=" Tj\n";var se="BT\n/"+P+" "+H+" Tf\n"+(H*h).toFixed(2)+" TL\n"+it+"\n";return se+=p,se+=e,se+="ET",D(se),$[P]=!0,_},p.__private__.lstext=p.lstext=function(e,t,r,n){return console.warn("jsPDF.lstext is deprecated"),this.text(e,t,r,{charSpace:n})},p.__private__.clip=p.clip=function(e){D("evenodd"===e?"W*":"W"),D("n")},p.__private__.clip_fixed=p.clip_fixed=function(e){console.log("clip_fixed is deprecated"),p.clip(e)},p.__private__.isValidStyle=function(e){var t=[void 0,null,"S","F","DF","FD","f","f*","B","B*"],r=!1;return-1!==t.indexOf(e)&&(r=!0),r}),Ye=p.__private__.getStyle=function(e){var t="S";return"F"===e?t="f":"FD"===e||"DF"===e?t="B":"f"!==e&&"f*"!==e&&"B"!==e&&"B*"!==e||(t=e),t};p.__private__.line=p.line=function(e,t,r,n){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(n))throw new Error("Invalid arguments passed to jsPDF.line");return this.lines([[r-e,n-t]],e,t)},p.__private__.lines=p.lines=function(e,t,r,n,a,i){var s,o,c,l,u,f,$,p,d,h,_,m;if("number"==typeof e&&(m=r,r=t,t=e,e=m),n=n||[1,1],i=i||!1,isNaN(t)||isNaN(r)||!Array.isArray(e)||!Array.isArray(n)||!Ge(a)||"boolean"!=typeof i)throw new Error("Invalid arguments passed to jsPDF.lines");for(D(g(Ze(t))+" "+g(et(r))+" m "),s=n[0],o=n[1],l=e.length,h=t,_=r,c=0;c<l;c++)u=e[c],2===u.length?(h=u[0]*s+h,_=u[1]*o+_,D(g(Ze(h))+" "+g(et(_))+" l")):(f=u[0]*s+h,$=u[1]*o+_,p=u[2]*s+h,d=u[3]*o+_,h=u[4]*s+h,_=u[5]*o+_,D(g(Ze(f))+" "+g(et($))+" "+g(Ze(p))+" "+g(et(d))+" "+g(Ze(h))+" "+g(et(_))+" c"));return i&&D(" h"),null!==a&&D(Ye(a)),this},p.__private__.rect=p.rect=function(e,t,r,n,a){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(n)||!Ge(a))throw new Error("Invalid arguments passed to jsPDF.rect");return D([y(Ze(e)),y(et(t)),y(r*M),y(-n*M),"re"].join(" ")),null!==a&&D(Ye(a)),this},p.__private__.triangle=p.triangle=function(e,t,r,n,a,i,s){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(n)||isNaN(a)||isNaN(i)||!Ge(s))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[r-e,n-t],[a-r,i-n],[e-a,t-i]],e,t,[1,1],s,!0),this},p.__private__.roundedRect=p.roundedRect=function(e,t,r,n,a,i,s){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(n)||isNaN(a)||isNaN(i)||!Ge(s))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var o=4/3*(Math.SQRT2-1);return this.lines([[r-2*a,0],[a*o,0,a,i-i*o,a,i],[0,n-2*i],[0,i*o,-a*o,i,-a,i],[2*a-r,0],[-a*o,0,-a,-i*o,-a,-i],[0,2*i-n],[0,-i*o,a*o,-i,a,-i]],e+a,t,[1,1],s),this},p.__private__.ellipse=p.ellipse=function(e,t,r,n,a){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(n)||!Ge(a))throw new Error("Invalid arguments passed to jsPDF.ellipse");var i=4/3*(Math.SQRT2-1)*r,s=4/3*(Math.SQRT2-1)*n;return D([y(Ze(e+r)),y(et(t)),"m",y(Ze(e+r)),y(et(t-s)),y(Ze(e+i)),y(et(t-n)),y(Ze(e)),y(et(t-n)),"c"].join(" ")),D([y(Ze(e-i)),y(et(t-n)),y(Ze(e-r)),y(et(t-s)),y(Ze(e-r)),y(et(t)),"c"].join(" ")),D([y(Ze(e-r)),y(et(t+s)),y(Ze(e-i)),y(et(t+n)),y(Ze(e)),y(et(t+n)),"c"].join(" ")),D([y(Ze(e+i)),y(et(t+n)),y(Ze(e+r)),y(et(t+s)),y(Ze(e+r)),y(et(t)),"c"].join(" ")),null!==a&&D(Ye(a)),this},p.__private__.circle=p.circle=function(e,t,r,n){if(isNaN(e)||isNaN(t)||isNaN(r)||!Ge(n))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(e,t,r,r,n)};p.setFont=function(e,t){return P=Le(e,t,{disableWarning:!1}),this},p.setFontStyle=p.setFontType=function(e){return P=Le(void 0,e),this};p.__private__.getFontList=p.getFontList=function(){var e,t,r,n={};for(e in ee)if(ee.hasOwnProperty(e)){n[e]=r=[];for(t in ee[e])ee[e].hasOwnProperty(t)&&r.push(t)}return n};p.addFont=function(e,t,r,n){n=n||"Identity-H",Ae.call(this,e,t,r,n)};var Ve,Ve,Qe=c.lineWidth||.200025,Xe=p.__private__.setLineWidth=p.setLineWidth=function(e){return D((e*M).toFixed(2)+" w"),this},We=(p.__private__.setLineDash=a.API.setLineDash=function(e,t){if(e=e||[],t=t||0,isNaN(t)||!Array.isArray(e))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return e=e.map(function(e){return(e*M).toFixed(3)}).join(" "),t=parseFloat((t*M).toFixed(3)),D("["+e+"] "+t+" d"),this},p.__private__.getLineHeight=p.getLineHeight=function(){return H*Ve}),We=p.__private__.getLineHeight=p.getLineHeight=function(){return H*Ve},Je=p.__private__.setLineHeightFactor=p.setLineHeightFactor=function(e){return e=e||1.15,"number"==typeof e&&(Ve=e),this},Ke=p.__private__.getLineHeightFactor=p.getLineHeightFactor=function(){return Ve};Je(c.lineHeight);var Ze=p.__private__.getHorizontalCoordinate=function(e){return e*M},et=p.__private__.getVerticalCoordinate=function(e){return re[N].mediaBox.topRightY-re[N].mediaBox.bottomLeftY-e*M},tt=p.__private__.getHorizontalCoordinateString=function(e){return y(e*M)},rt=p.__private__.getVerticalCoordinateString=function(e){return y(re[N].mediaBox.topRightY-re[N].mediaBox.bottomLeftY-e*M)},nt=c.strokeColor||"0 G",at=(p.__private__.getStrokeColor=p.getDrawColor=function(){return $e(nt)},p.__private__.setStrokeColor=p.setDrawColor=function(e,t,r,n){return nt=pe({ch1:e,ch2:t,ch3:r,ch4:n,pdfColorType:"draw",precision:2}),D(nt),this},c.fillColor||"0 g"),it=(p.__private__.getFillColor=p.getFillColor=function(){return $e(at)},p.__private__.setFillColor=p.setFillColor=function(e,t,r,n){return at=pe({ch1:e,ch2:t,ch3:r,ch4:n,pdfColorType:"fill",precision:2}),D(at),this},c.textColor||"0 g"),st=p.__private__.getTextColor=p.getTextColor=function(){return $e(it)},ot=(p.__private__.setTextColor=p.setTextColor=function(e,t,r,n){return it=pe({ch1:e,ch2:t,ch3:r,ch4:n,pdfColorType:"text",precision:3}),this},c.charSpace||0),ct=p.__private__.getCharSpace=p.getCharSpace=function(){return ot},lt=(p.__private__.setCharSpace=p.setCharSpace=function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return ot=e,this},0);p.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2};var ut,ft=(p.__private__.setLineCap=p.setLineCap=function(e){var t=p.CapJoinStyles[e];if(void 0===t)throw new Error("Line cap style of '"+e+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return lt=t,D(t+" J"),this},0);p.__private__.setLineJoin=p.setLineJoin=function(e){var t=p.CapJoinStyles[e];if(void 0===t)throw new Error("Line join style of '"+e+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return ft=t,D(t+" j"),this},p.__private__.setMiterLimit=p.setMiterLimit=function(e){if(e=e||0,isNaN(e))throw new Error("Invalid argument passed to jsPDF.setMiterLimit");return ut=parseFloat(y(e*M)),D(ut+" M"),this};p.save=function(t,r){if(t=t||"generated.pdf",r=r||{},r.returnPromise=r.returnPromise||!1,!1!==r.returnPromise)return new Promise(function(r,n){try{var a=saveAs(Re(Fe()),t);"function"==typeof saveAs.unload&&e.setTimeout&&setTimeout(saveAs.unload,911),r(a)}catch(e){n(e.message)}});saveAs(Re(Fe()),t),"function"==typeof saveAs.unload&&e.setTimeout&&setTimeout(saveAs.unload,911)};for(var $t in a.API)a.API.hasOwnProperty($t)&&("events"===$t&&a.API.events.length?function(e,t){var r,n,a;for(a=t.length-1;-1!==a;a--)r=t[a][0],n=t[a][1],e.subscribe.apply(e,[r].concat("function"==typeof n?[n]:n))}(ae,a.API.events):p[$t]=a.API[$t]);return p.internal={pdfEscape:Ee,getStyle:Ye,getFont:function(){return Z[Le.apply(p,arguments)]},getFontSize:G,getCharSpace:ct,getTextColor:st,getLineHeight:We,getLineHeightFactor:Ke,write:z,getHorizontalCoordinate:Ze,getVerticalCoordinate:et,getCoordinateString:tt,getVerticalCoordinateString:rt,collections:{},newObject:se,newAdditionalObject:le,newObjectDeferred:oe,newObjectDeferredBegin:ce,getFilters:de,putStream:he,events:ae,scaleFactor:M,pageSize:{getWidth:function(){return(re[N].mediaBox.topRightX-re[N].mediaBox.bottomLeftX)/M},setWidth:function(e){re[N].mediaBox.topRightX=e*M+re[N].mediaBox.bottomLeftX},getHeight:function(){return(re[N].mediaBox.topRightY-re[N].mediaBox.bottomLeftY)/M},setHeight:function(e){re[N].mediaBox.topRightY=e*M+re[N].mediaBox.bottomLeftY}},output:De,getNumberOfPages:Oe,pages:j,out:D,f2:y,f3:g,getPageInfo:qe,getPageInfoByObjId:Ue,getCurrentPageInfo:He,getPDFVersion:h,hasHotfix:ze},Object.defineProperty(p.internal.pageSize,"width",{get:function(){return(re[N].mediaBox.topRightX-re[N].mediaBox.bottomLeftX)/M},set:function(e){re[N].mediaBox.topRightX=e*M+re[N].mediaBox.bottomLeftX},enumerable:!0,configurable:!0}),Object.defineProperty(p.internal.pageSize,"height",{get:function(){return(re[N].mediaBox.topRightY-re[N].mediaBox.bottomLeftY)/M},set:function(e){re[N].mediaBox.topRightY=e*M+re[N].mediaBox.bottomLeftY},enumerable:!0,configurable:!0}),function(e){for(var t=0,r=U.length;t<r;t++){var n=Ae(e[t][0],e[t][1],e[t][2],U[t][3],!0);$[n]=!0;var a=e[t][0].split("-");we(n,a[0],a[1]||"")}ae.publish("addFonts",{fonts:Z,dictionary:ee})}(U),P="F1",Ne(s,t),ae.publish("initialized"),p}return a.API={events:[]},a.version="1.5.2","function"==typeof define&&define.amd?define("jsPDF",function(){return a}):void 0!==t&&t.exports?(t.exports=a,t.exports.jsPDF=a):e.jsPDF=a,a}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||"undefined"!=typeof global&&global||Function('return typeof this === "object" && this.content')()||Function("return this")());window.tmp=c,function(e,t){function r(e,t,r){r||(r=1);for(var n,a=[];n=t.exec(e);)a.push(n[r]);return a}var a,i=1,s=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},o=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},c=function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.f2");return e.toFixed(2)},l=function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.f2");return e.toFixed(5)};e.__acroform__={};var u=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},f=function(e){return e*i},$=function(e){return e/i},p=function(e){var t=new j,r=J.internal.getHeight(e)||0,n=J.internal.getWidth(e)||0;return t.BBox=[0,0,Number(c(n)),Number(c(r))],t},d=e.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|=1<<t},h=e.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&=~(1<<t)},_=e.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return 0==(e&1<<t)?0:1},m=e.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return _(e,t-1)},y=e.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return d(e,t-1)},g=e.__acroform__.clearBitForPdf=function(e,t,r){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return h(e,t-1)},v=e.__acroform__.calculateCoordinates=function(e){var t=this.internal.getHorizontalCoordinate,r=this.internal.getVerticalCoordinate,n=e[0],a=e[1],i=e[2],s=e[3],o={};return o.lowerLeft_X=t(n)||0,o.lowerLeft_Y=r(a+s)||0,o.upperRight_X=t(n+i)||0,o.upperRight_Y=r(a)||0,[Number(c(o.lowerLeft_X)),Number(c(o.lowerLeft_Y)),Number(c(o.upperRight_X)),Number(c(o.upperRight_Y))]},b=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e.V||e.DV,n=x(e,r),i=a.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(a.__private__.encodeColorString(e.color)),t.push("/"+i+" "+c(n.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(n.text),t.push("ET"),t.push("Q"),t.push("EMC");var s=new p(e);return s.stream=t.join("\n"),s}},x=function(e,t){var r=e.maxFontSize||12,n=(e.fontName,{text:"",fontSize:""});t="("==t.substr(0,1)?t.substr(1):t,t=")"==t.substr(t.length-1)?t.substr(0,t.length-1):t;var i=t.split(" "),o=(a.__private__.encodeColorString(e.color),r),l=J.internal.getHeight(e)||0;l=l<0?-l:l;var u=J.internal.getWidth(e)||0;u=u<0?-u:u;o++;e:for(;;){var t="";o--;var f=w("3",e,o).height,$=e.multiline?l-o:(l-f)/2;$+=2;var p=-2,d=$,h=0,_=0,m=0;if(o<=0){o=12,t="(...) Tj\n",t+="% Width of Text: "+w(t,e,o).width+", FieldWidth:"+u+"\n";break}m=w(i[0]+" ",e,o).width;var y="",g=0;for(var v in i)if(i.hasOwnProperty(v)){y+=i[v]+" ",y=" "==y.substr(y.length-1)?y.substr(0,y.length-1):y;var b=parseInt(v);m=w(y+" ",e,o).width;var x=function(t,r,n){if(t+1<i.length){var a=r+" "+i[t+1];return w(a,e,n).width<=u-4}return!1}(b,y,o),A=v>=i.length-1;if(x&&!A){y+=" ";continue}if(x||A){if(A)_=b;else if(e.multiline&&(f+2)*(g+2)+2>l)continue e}else{if(!e.multiline)continue e;if((f+2)*(g+2)+2>l)continue e;_=b}for(var k="",E=h;E<=_;E++)k+=i[E]+" ";switch(k=" "==k.substr(k.length-1)?k.substr(0,k.length-1):k,m=w(k,e,o).width,e.textAlign){case"right":p=u-m-2;break;case"center":p=(u-m)/2;break;case"left":default:p=2}t+=c(p)+" "+c(d)+" Td\n",t+="("+s(k)+") Tj\n",t+=-c(p)+" 0 Td\n",d=-(o+2),m=0,h=_+1,g++,y=""}else;break}return n.text=t,n.fontSize=o,n},w=function(e,t,r){var n=a.internal.getFont(t.fontName,t.fontStyle),i=a.getStringUnitWidth(e,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:a.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:i}},A={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},k=function(){a.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var e=a.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var t in e)if(e.hasOwnProperty(t)){var r=e[t];r.objId=void 0,r.hasAnnotation&&S.call(a,r)}},E=function(e){a.internal.acroformPlugin.printedOut&&(a.internal.acroformPlugin.printedOut=!1,a.internal.acroformPlugin.acroFormDictionaryRoot=null),a.internal.acroformPlugin.acroFormDictionaryRoot||L.call(a),a.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e)},S=function(e){var t={type:"reference",object:e},r=function(e){return e.type===t.type&&e.object===t.object};void 0===a.internal.getPageInfo(e.page).pageContext.annotations.find(r)&&a.internal.getPageInfo(e.page).pageContext.annotations.push(t)},N=function(){if(void 0===a.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("putCatalogCallback: Root missing.");a.internal.write("/AcroForm "+a.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")},C=function(){a.internal.events.unsubscribe(a.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete a.internal.acroformPlugin.acroFormDictionaryRoot._eventID,a.internal.acroformPlugin.printedOut=!0},I=function(e){var t=!e;e||(a.internal.newObjectDeferredBegin(a.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),a.internal.acroformPlugin.acroFormDictionaryRoot.putStream());var e=e||a.internal.acroformPlugin.acroFormDictionaryRoot.Kids;for(var r in e)if(e.hasOwnProperty(r)){var i=e[r],s=[],o=i.Rect;if(i.Rect&&(i.Rect=v.call(this,i.Rect)),a.internal.newObjectDeferredBegin(i.objId,!0),i.DA=J.createDefaultAppearanceStream(i),"object"===n(i)&&"function"==typeof i.getKeyValueListForStream&&(s=i.getKeyValueListForStream()),i.Rect=o,i.hasAppearanceStream&&!i.appearanceStreamContent){var c=b.call(this,i);s.push({key:"AP",value:"<</N "+c+">>"}),a.internal.acroformPlugin.xForms.push(c)}if(i.appearanceStreamContent){var l="";for(var u in i.appearanceStreamContent)if(i.appearanceStreamContent.hasOwnProperty(u)){var f=i.appearanceStreamContent[u];if(l+="/"+u+" ",l+="<<",Object.keys(f).length>=1||Array.isArray(f)){for(var r in f)if(f.hasOwnProperty(r)){var $=f[r];"function"==typeof $&&($=$.call(this,i)),l+="/"+r+" "+$+" ",a.internal.acroformPlugin.xForms.indexOf($)>=0||a.internal.acroformPlugin.xForms.push($)}}else{var $=f;"function"==typeof $&&($=$.call(this,i)),l+="/"+r+" "+$,a.internal.acroformPlugin.xForms.indexOf($)>=0||a.internal.acroformPlugin.xForms.push($)}l+=">>"}s.push({key:"AP",value:"<<\n"+l+">>"})}a.internal.putStream({additionalKeyValues:s}),a.internal.out("endobj")}t&&O.call(this,a.internal.acroformPlugin.xForms)},O=function(e){for(var t in e)if(e.hasOwnProperty(t)){var r=t,i=e[t];a.internal.newObjectDeferredBegin(i&&i.objId,!0),"object"===n(i)&&"function"==typeof i.putStream&&i.putStream(),delete e[r]}},L=function(){if(void 0!==this.internal&&(void 0===this.internal.acroformPlugin||!1===this.internal.acroformPlugin.isInitialized)){if(a=this,R.FieldNum=0,this.internal.acroformPlugin=JSON.parse(JSON.stringify(A)),this.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");i=a.internal.scaleFactor,a.internal.acroformPlugin.acroFormDictionaryRoot=new F,a.internal.acroformPlugin.acroFormDictionaryRoot._eventID=a.internal.events.subscribe("postPutResources",C),a.internal.events.subscribe("buildDocument",k),a.internal.events.subscribe("putCatalog",N),a.internal.events.subscribe("postPutPages",I),a.internal.acroformPlugin.isInitialized=!0}},P=e.__acroform__.arrayToPdfArray=function(e){if(Array.isArray(e)){for(var t="[",r=0;r<e.length;r++)switch(0!==r&&(t+=" "),n(e[r])){case"boolean":case"number":case"object":t+=e[r].toString();break;case"string":"/"!==e[r].substr(0,1)?t+="("+s(e[r].toString())+")":t+=e[r].toString()}return t+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},M=function(e){var t=[];return"string"==typeof e&&(t=r(e,/\((.*?)\)/g)),t},T=function(e){return e=e||"",e.toString(),e="("+s(e)+")"},B=function(){var e;Object.defineProperty(this,"objId",{configurable:!0,get:function(){if(e||(e=a.internal.newObjectDeferred()),!e)throw new Error("AcroFormPDFObject: Couldn't create Object ID");return e},set:function(t){e=t}})};B.prototype.toString=function(){return this.objId+" 0 R"},B.prototype.putStream=function(){var e=this.getKeyValueListForStream();a.internal.putStream({data:this.stream,additionalKeyValues:e}),a.internal.out("endobj")},B.prototype.getKeyValueListForStream=function(){return function(e){var t=[],r=Object.getOwnPropertyNames(e).filter(function(e){return"content"!=e&&"appearanceStreamContent"!=e&&"_"!=e.substring(0,1)});for(var n in r)if(!1===Object.getOwnPropertyDescriptor(e,r[n]).configurable){var a=r[n],i=e[a];i&&(Array.isArray(i)?t.push({key:a,value:P(i)}):i instanceof B?t.push({key:a,value:i.objId+" 0 R"}):"function"!=typeof i&&t.push({key:a,value:i}))}return t}(this)};var j=function(){B.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writeable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writeable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writeable:!0});var e=[];Object.defineProperty(this,"BBox",{configurable:!1,writeable:!0,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writeable:!0});var t;Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(e){t=e.trim()},get:function(){return t||null}})};u(j,B);var F=function(){B.call(this);var e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}});var t;Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t)return"("+t+")"},set:function(e){t=e}})};u(F,B);var R=function e(){B.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(e){if(isNaN(e))throw new Error('Invalid value "'+e+'" for attribute F supplied.');t=e}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return Boolean(m(t,3))},set:function(e){!0===Boolean(e)?this.F=y(t,3):this.F=g(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(e){if(isNaN(e))throw new Error('Invalid value "'+e+'" for attribute Ff supplied.');r=e}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(0!==n.length)return n},set:function(e){n=void 0!==e?e:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:$(n[0])},set:function(e){n[0]=f(e)}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:$(n[1])},set:function(e){n[1]=f(e)}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:$(n[2])},set:function(e){n[2]=f(e)}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:$(n[3])},set:function(e){n[3]=f(e)}});var a="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return a},set:function(e){switch(e){case"/Btn":case"/Tx":case"/Ch":case"/Sig":a=e;break;default:throw new Error('Invalid value "'+e+'" for attribute FT supplied.')}}});var i=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!i||i.length<1){if(this instanceof V)return;i="FieldObject"+e.FieldNum++}return"("+s(i)+")"},set:function(e){i=e.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return i},set:function(e){i=e}});var c="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return c},set:function(e){c=e}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(e){l=e}});var u=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return $(u)},set:function(e){u=f(e)}});var p=50;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return $(p)},set:function(e){p=f(e)}});var d="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return d},set:function(e){d=e}});var h="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!h||this instanceof V||this instanceof X))return T(h)},set:function(e){e=e.toString(),h=e}});var _=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(_)return this instanceof H==!1?T(_):_},set:function(e){e=e.toString(),_=this instanceof H==!1?o("("===e.substr(0,1)?e.substr(1,e.length-2):e):e}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof H==!0?o(_.substr(1,_.length-1)):_},set:function(e){e=e.toString(),_=this instanceof H==!0?"/"+e:e}});var v=null;Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(v)return this instanceof H==!1?T(v):v},set:function(e){e=e.toString(),v=this instanceof H==!1?o("("===e.substr(0,1)?e.substr(1,e.length-2):e):e}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof H==!0?o(v.substr(1,v.length-1)):v},set:function(e){e=e.toString(),v=this instanceof H==!0?"/"+e:e}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var b=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,writeable:!0,get:function(){return b},set:function(e){e=Boolean(e),b=e}});var x;Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,writeable:!0,get:function(){if(x)return x},set:function(e){x=e}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return Boolean(m(this.Ff,1))},set:function(e){!0===Boolean(e)?this.Ff=y(this.Ff,1):this.Ff=g(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return Boolean(m(this.Ff,2))},set:function(e){!0===Boolean(e)?this.Ff=y(this.Ff,2):this.Ff=g(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return Boolean(m(this.Ff,3))},set:function(e){!0===Boolean(e)?this.Ff=y(this.Ff,3):this.Ff=g(this.Ff,3)}});var w=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(null!==w)return w},set:function(e){if(-1===[0,1,2].indexOf(e))throw new Error('Invalid value "'+e+'" for attribute Q supplied.');w=e}}),Object.defineProperty(this,"textAlign",{get:function(){var e="left";switch(w){case 0:default:e="left";break;case 1:e="center";break;case 2:e="right"}return e},configurable:!0,enumerable:!0,set:function(e){switch(e){case"right":case 2:w=2;break;case"center":case 1:w=1;break;case"left":case 0:default:w=0}}})};u(R,B);var D=function(){R.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){e=t}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return P(t)},set:function(e){t=M(e)}}),this.getOptions=function(){return t},this.setOptions=function(e){t=e,this.sort&&t.sort()},this.addOption=function(e){e=e||"",e=e.toString(),t.push(e),this.sort&&t.sort()},this.removeOption=function(e,r){for(r=r||!1,e=e||"",
e=e.toString();-1!==t.indexOf(e)&&(t.splice(t.indexOf(e),1),!1!==r););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return Boolean(m(this.Ff,18))},set:function(e){!0===Boolean(e)?this.Ff=y(this.Ff,18):this.Ff=g(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return Boolean(m(this.Ff,19))},set:function(e){!0===this.combo&&(!0===Boolean(e)?this.Ff=y(this.Ff,19):this.Ff=g(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return Boolean(m(this.Ff,20))},set:function(e){!0===Boolean(e)?(this.Ff=y(this.Ff,20),t.sort()):this.Ff=g(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return Boolean(m(this.Ff,22))},set:function(e){!0===Boolean(e)?this.Ff=y(this.Ff,22):this.Ff=g(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return Boolean(m(this.Ff,23))},set:function(e){!0===Boolean(e)?this.Ff=y(this.Ff,23):this.Ff=g(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return Boolean(m(this.Ff,27))},set:function(e){!0===Boolean(e)?this.Ff=y(this.Ff,27):this.Ff=g(this.Ff,27)}}),this.hasAppearanceStream=!1};u(D,R);var z=function(){D.call(this),this.fontName="helvetica",this.combo=!1};u(z,D);var q=function(){z.call(this),this.combo=!0};u(q,z);var U=function(){q.call(this),this.edit=!0};u(U,q);var H=function(){R.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return Boolean(m(this.Ff,15))},set:function(e){!0===Boolean(e)?this.Ff=y(this.Ff,15):this.Ff=g(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return Boolean(m(this.Ff,16))},set:function(e){!0===Boolean(e)?this.Ff=y(this.Ff,16):this.Ff=g(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return Boolean(m(this.Ff,17))},set:function(e){!0===Boolean(e)?this.Ff=y(this.Ff,17):this.Ff=g(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return Boolean(m(this.Ff,26))},set:function(e){!0===Boolean(e)?this.Ff=y(this.Ff,26):this.Ff=g(this.Ff,26)}});var e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){if(0!==Object.keys(e).length){var t=[];t.push("<<");var r;for(r in e)t.push("/"+r+" ("+e[r]+")");return t.push(">>"),t.join("\n")}},set:function(t){"object"===n(t)&&(e=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(t){"string"==typeof t&&(e.CA=t)}});var t;Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(e){t="/"+e}})};u(H,R);var G=function(){H.call(this),this.pushButton=!0};u(G,H);var Y=function(){H.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=void 0!==t?t:[]}})};u(Y,H);var V=function(){R.call(this);var e;Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(t){e=t}});var t;Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(e){t=e}});var r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var e=[];e.push("<<");var t;for(t in r)e.push("/"+t+" ("+r[t]+")");return e.push(">>"),e.join("\n")},set:function(e){"object"===n(e)&&(r=e)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(e){"string"==typeof e&&(r.CA=e)}});var a;Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return a},set:function(e){a=e}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return a.substr(1,a.length-1)},set:function(e){a="/"+e}}),this.optionName=name,this.caption="l",this.appearanceState="Off",this._AppearanceType=J.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(name)};u(V,R),Y.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e&&"getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},Y.prototype.createOption=function(e){var t=(this.Kids.length,new V);return t.Parent=this,t.optionName=e,this.Kids.push(t),K.call(this,t),t};var Q=function(){H.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=J.CheckBox.createAppearanceStream()};u(Q,H);var X=function(){R.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return Boolean(m(this.Ff,13))},set:function(e){!0===Boolean(e)?this.Ff=y(this.Ff,13):this.Ff=g(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return Boolean(m(this.Ff,21))},set:function(e){!0===Boolean(e)?this.Ff=y(this.Ff,21):this.Ff=g(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return Boolean(m(this.Ff,23))},set:function(e){!0===Boolean(e)?this.Ff=y(this.Ff,23):this.Ff=g(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return Boolean(m(this.Ff,24))},set:function(e){!0===Boolean(e)?this.Ff=y(this.Ff,24):this.Ff=g(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return Boolean(m(this.Ff,25))},set:function(e){!0===Boolean(e)?this.Ff=y(this.Ff,25):this.Ff=g(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return Boolean(m(this.Ff,26))},set:function(e){!0===Boolean(e)?this.Ff=y(this.Ff,26):this.Ff=g(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};u(X,R);var W=function(){X.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return Boolean(m(this.Ff,14))},set:function(e){!0===Boolean(e)?this.Ff=y(this.Ff,14):this.Ff=g(this.Ff,14)}}),this.password=!0};u(W,X);var J={CheckBox:{createAppearanceStream:function(){return{N:{On:J.CheckBox.YesNormal},D:{On:J.CheckBox.YesPushDown,Off:J.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=p(e),r=[],n=a.internal.getFont(e.fontName,e.fontStyle).id,i=a.__private__.encodeColorString(e.color),s=x(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+c(J.internal.getWidth(e))+" "+c(J.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+c(s.fontSize)+" Tf "+i),r.push("BT"),r.push(s.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join("\n"),t},YesNormal:function(e){var t=p(e),r=a.internal.getFont(e.fontName,e.fontStyle).id,n=a.__private__.encodeColorString(e.color),i=[],s=J.internal.getHeight(e),o=J.internal.getWidth(e),l=x(e,e.caption);return i.push("1 g"),i.push("0 0 "+c(o)+" "+c(s)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+c(o-1)+" "+c(s-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+r+" "+c(l.fontSize)+" Tf "+n),i.push(l.text),i.push("ET"),i.push("Q"),t.stream=i.join("\n"),t},OffPushDown:function(e){var t=p(e),r=[];return r.push("0.749023 g"),r.push("0 0 "+c(J.internal.getWidth(e))+" "+c(J.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join("\n"),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:J.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=J.RadioButton.Circle.YesNormal,t.D[e]=J.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=p(e),r=[],n=J.internal.getWidth(e)<=J.internal.getHeight(e)?J.internal.getWidth(e)/4:J.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=J.internal.Bezier_C,i=Number((n*a).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+l(J.internal.getWidth(e)/2)+" "+l(J.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),r.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),r.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),r.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join("\n"),t},YesPushDown:function(e){var t=p(e),r=[],n=J.internal.getWidth(e)<=J.internal.getHeight(e)?J.internal.getWidth(e)/4:J.internal.getHeight(e)/4,n=Number((.9*n).toFixed(5)),a=Number((2*n).toFixed(5)),i=Number((a*J.internal.Bezier_C).toFixed(5)),s=Number((n*J.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+l(J.internal.getWidth(e)/2)+" "+l(J.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),r.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),r.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),r.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+l(J.internal.getWidth(e)/2)+" "+l(J.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join("\n"),t},OffPushDown:function(e){var t=p(e),r=[],n=J.internal.getWidth(e)<=J.internal.getHeight(e)?J.internal.getWidth(e)/4:J.internal.getHeight(e)/4,n=Number((.9*n).toFixed(5)),a=Number((2*n).toFixed(5)),i=Number((a*J.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+l(J.internal.getWidth(e)/2)+" "+l(J.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),r.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),r.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),r.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join("\n"),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:J.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=J.RadioButton.Cross.YesNormal,t.D[e]=J.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=p(e),r=[],n=J.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+c(J.internal.getWidth(e)-2)+" "+c(J.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(c(n.x1.x)+" "+c(n.x1.y)+" m"),r.push(c(n.x2.x)+" "+c(n.x2.y)+" l"),r.push(c(n.x4.x)+" "+c(n.x4.y)+" m"),r.push(c(n.x3.x)+" "+c(n.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join("\n"),t},YesPushDown:function(e){var t=p(e),r=J.internal.calculateCross(e),n=[];return n.push("0.749023 g"),n.push("0 0 "+c(J.internal.getWidth(e))+" "+c(J.internal.getHeight(e))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+c(J.internal.getWidth(e)-2)+" "+c(J.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(c(r.x1.x)+" "+c(r.x1.y)+" m"),n.push(c(r.x2.x)+" "+c(r.x2.y)+" l"),n.push(c(r.x4.x)+" "+c(r.x4.y)+" m"),n.push(c(r.x3.x)+" "+c(r.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join("\n"),t},OffPushDown:function(e){var t=p(e),r=[];return r.push("0.749023 g"),r.push("0 0 "+c(J.internal.getWidth(e))+" "+c(J.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join("\n"),t}}},createDefaultAppearanceStream:function(e){var t=a.internal.getFont(e.fontName,e.fontStyle).id,r=a.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};J.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=J.internal.getWidth(e),r=J.internal.getHeight(e),n=Math.min(t,r);return{x1:{x:(t-n)/2,y:(r-n)/2+n},x2:{x:(t-n)/2+n,y:(r-n)/2},x3:{x:(t-n)/2,y:(r-n)/2},x4:{x:(t-n)/2+n,y:(r-n)/2+n}}}},J.internal.getWidth=function(e){var t=0;return"object"===n(e)&&(t=f(e.Rect[2])),t},J.internal.getHeight=function(e){var t=0;return"object"===n(e)&&(t=f(e.Rect[3])),t};var K=e.addField=function(e){if(L.call(this),!(e instanceof R))throw new Error("Invalid argument passed to jsPDF.addField.");return E.call(this,e),e.page=a.internal.getCurrentPageInfo().pageNumber,this};e.addButton=function(e){if(e instanceof H==!1)throw new Error("Invalid argument passed to jsPDF.addButton.");return K.call(this,e)},e.addTextField=function(e){if(e instanceof X==!1)throw new Error("Invalid argument passed to jsPDF.addTextField.");return K.call(this,e)},e.addChoiceField=function(e){if(e instanceof D==!1)throw new Error("Invalid argument passed to jsPDF.addChoiceField.");return K.call(this,e)};"object"==n(t)&&void 0===t.ChoiceField&&void 0===t.ListBox&&void 0===t.ComboBox&&void 0===t.EditBox&&void 0===t.Button&&void 0===t.PushButton&&void 0===t.RadioButton&&void 0===t.CheckBox&&void 0===t.TextField&&void 0===t.PasswordField?(t.ChoiceField=D,t.ListBox=z,t.ComboBox=q,t.EditBox=U,t.Button=H,t.PushButton=G,t.RadioButton=Y,t.CheckBox=Q,t.TextField=X,t.PasswordField=W,t.AcroForm={Appearance:J}):console.warn("AcroForm-Classes are not populated into global-namespace, because the class-Names exist already."),e.AcroFormChoiceField=D,e.AcroFormListBox=z,e.AcroFormComboBox=q,e.AcroFormEditBox=U,e.AcroFormButton=H,e.AcroFormPushButton=G,e.AcroFormRadioButton=Y,e.AcroFormCheckBox=Q,e.AcroFormTextField=X,e.AcroFormPasswordField=W,e.AcroFormAppearance=J,e.AcroForm={ChoiceField:D,ListBox:z,ComboBox:q,EditBox:U,Button:H,PushButton:G,RadioButton:Y,CheckBox:Q,TextField:X,PasswordField:W,Appearance:J}}(c.API,"undefined"!=typeof window&&window||"undefined"!=typeof global&&global),function(e){var t={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},r=e.getImageFileTypeByImageData=function(r,n){n=n||"UNKNOWN";var a,i,s,o,c,l="UNKNOWN";e.isArrayBufferView(r)&&(r=e.arrayBufferToBinaryString(r));for(c in t)for(s=t[c],a=0;a<s.length;a+=1){for(o=!0,i=0;i<s[a].length;i+=1)if(void 0!==s[a][i]&&s[a][i]!==r.charCodeAt(i)){o=!1;break}if(!0===o){l=c;break}}return"UNKNOWN"===l&&"UNKNOWN"!==n&&(console.warn('FileType of Image not recognized. Processing image as "'+n+'".'),l=n),l},a=function e(t){for(var r=this.internal.newObject(),n=this.internal.write,a=this.internal.putStream,i=this.internal.getFilters,s=i();-1!==s.indexOf("FlateEncode");)s.splice(s.indexOf("FlateEncode"),1);t.n=r;var o=[];if(o.push({key:"Type",value:"/XObject"}),o.push({key:"Subtype",value:"/Image"}),o.push({key:"Width",value:t.w}),o.push({key:"Height",value:t.h}),t.cs===this.color_spaces.INDEXED?o.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(t.pal.length/3-1)+" "+("smask"in t?r+2:r+1)+" 0 R]"}):(o.push({key:"ColorSpace",value:"/"+t.cs}),t.cs===this.color_spaces.DEVICE_CMYK&&o.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),o.push({key:"BitsPerComponent",value:t.bpc}),"dp"in t&&o.push({key:"DecodeParms",value:"<<"+t.dp+">>"}),"trns"in t&&t.trns.constructor==Array){for(var c="",l=0,u=t.trns.length;l<u;l++)c+=t.trns[l]+" "+t.trns[l]+" ";o.push({key:"Mask",value:"["+c+"]"})}"smask"in t&&o.push({key:"SMask",value:r+1+" 0 R"});var f=void 0!==t.f?["/"+t.f]:void 0;if(a({data:t.data,additionalKeyValues:o,alreadyAppliedFilters:f}),n("endobj"),"smask"in t){var $="/Predictor "+t.p+" /Colors 1 /BitsPerComponent "+t.bpc+" /Columns "+t.w,p={w:t.w,h:t.h,cs:"DeviceGray",bpc:t.bpc,dp:$,data:t.smask};"f"in t&&(p.f=t.f),e.call(this,p)}t.cs===this.color_spaces.INDEXED&&(this.internal.newObject(),a({data:this.arrayBufferToBinaryString(new Uint8Array(t.pal))}),n("endobj"))},i=function(){var e=this.internal.collections.addImage_images;for(var t in e)a.call(this,e[t])},s=function(){var e,t=this.internal.collections.addImage_images,r=this.internal.write;for(var n in t)e=t[n],r("/I"+e.i,e.n,"0","R")},o=function(t){return t&&"string"==typeof t&&(t=t.toUpperCase()),t in e.image_compression?t:e.image_compression.NONE},c=function(){var e=this.internal.collections.addImage_images;return e||(this.internal.collections.addImage_images=e={},this.internal.events.subscribe("putResources",i),this.internal.events.subscribe("putXobjectDict",s)),e},l=function(e){var t=0;return e&&(t=Object.keys?Object.keys(e).length:function(e){var t=0;for(var r in e)e.hasOwnProperty(r)&&t++;return t}(e)),t},u=function(e){return void 0===e||null===e||0===e.length},f=function(t){return"string"==typeof t?e.sHashCode(t):e.isArrayBufferView(t)?e.sHashCode(e.arrayBufferToBinaryString(t)):null},$=function(t){return"function"==typeof e["process"+t.toUpperCase()]},p=function(e){return"object"===n(e)&&1===e.nodeType},d=function(t,r){if("IMG"===t.nodeName&&t.hasAttribute("src")){var n=""+t.getAttribute("src");if(0===n.indexOf("data:image/"))return unescape(n);var a=e.loadFile(n);if(void 0!==a)return btoa(a)}if("CANVAS"===t.nodeName){var i=t;return t.toDataURL("image/jpeg",1)}var i=document.createElement("canvas");i.width=t.clientWidth||t.width,i.height=t.clientHeight||t.height;var s=i.getContext("2d");if(!s)throw"addImage requires canvas to be supported by browser.";return s.drawImage(t,0,0,i.width,i.height),i.toDataURL("png"==(""+r).toLowerCase()?"image/png":"image/jpeg")},h=function(e,t){var r;if(t)for(var n in t)if(e===t[n].alias){r=t[n];break}return r},_=function(e,t,r){return e||t||(e=-96,t=-96),e<0&&(e=-1*r.w*72/e/this.internal.scaleFactor),t<0&&(t=-1*r.h*72/t/this.internal.scaleFactor),0===e&&(e=t*r.w/r.h),0===t&&(t=e*r.h/r.w),[e,t]},m=function(e,t,r,n,a,i,s,o){var c=_.call(this,r,n,a),l=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString;if(r=c[0],n=c[1],s[i]=a,o){o*=Math.PI/180;var f=Math.cos(o),$=Math.sin(o),p=function(e){return e.toFixed(4)},d=[p(f),p($),p(-1*$),p(f),0,0,"cm"]}this.internal.write("q"),o?(this.internal.write([1,"0","0",1,l(e),u(t+n),"cm"].join(" ")),this.internal.write(d.join(" ")),this.internal.write([l(r),"0","0",l(n),"0","0","cm"].join(" "))):this.internal.write([l(r),"0","0",l(n),l(e),u(t+n),"cm"].join(" ")),this.internal.write("/I"+a.i+" Do"),this.internal.write("Q")};e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"},e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"},e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},e.sHashCode=function(e){e=e||"";var t,r,n=0;if(0===e.length)return n;for(t=0;t<e.length;t++)r=e.charCodeAt(t),n=(n<<5)-n+r,n|=0;return n},e.isString=function(e){return"string"==typeof e},e.validateStringAsBase64=function(e){e=e||"",e.toString().trim();var t=!0;return 0===e.length&&(t=!1),e.length%4!=0&&(t=!1),!1===/^[A-Za-z0-9+\/]+$/.test(e.substr(0,e.length-2))&&(t=!1),!1===/^[A-Za-z0-9\/][A-Za-z0-9+\/]|[A-Za-z0-9+\/]=|==$/.test(e.substr(-2))&&(t=!1),t},e.extractInfoFromBase64DataURI=function(e){return/^data:([\w]+?\/([\w]+?));\S*;*base64,(.+)$/g.exec(e)},e.extractImageFromDataUrl=function(e){e=e||"";var t=e.split("base64,"),r=null;if(2===t.length){var n=/^data:(\w*\/\w*);*(charset=[\w=-]*)*;*$/.exec(t[0]);Array.isArray(n)&&(r={mimeType:n[1],charset:n[2],data:t[1]})}return r},e.supportsArrayBuffer=function(){return"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array},e.isArrayBuffer=function(e){return!!this.supportsArrayBuffer()&&e instanceof ArrayBuffer},e.isArrayBufferView=function(e){return!!this.supportsArrayBuffer()&&("undefined"!=typeof Uint32Array&&(e instanceof Int8Array||e instanceof Uint8Array||"undefined"!=typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array))},e.binaryStringToUint8Array=function(e){for(var t=e.length,r=new Uint8Array(t),n=0;n<t;n++)r[n]=e.charCodeAt(n);return r},e.arrayBufferToBinaryString=function(e){if("function"==typeof atob)return atob(this.arrayBufferToBase64(e))},e.arrayBufferToBase64=function(e){for(var t,r,n,a,i,s="",o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c=new Uint8Array(e),l=c.byteLength,u=l%3,f=l-u,$=0;$<f;$+=3)i=c[$]<<16|c[$+1]<<8|c[$+2],t=(16515072&i)>>18,r=(258048&i)>>12,n=(4032&i)>>6,a=63&i,s+=o[t]+o[r]+o[n]+o[a];return 1==u?(i=c[f],t=(252&i)>>2,r=(3&i)<<4,s+=o[t]+o[r]+"=="):2==u&&(i=c[f]<<8|c[f+1],t=(64512&i)>>10,r=(1008&i)>>4,n=(15&i)<<2,s+=o[t]+o[r]+o[n]+"="),s},e.createImageInfo=function(e,t,r,n,a,i,s,o,c,l,u,f,$){var p={alias:o,w:t,h:r,cs:n,bpc:a,i:s,data:e};return i&&(p.f=i),c&&(p.dp=c),l&&(p.trns=l),u&&(p.pal=u),f&&(p.smask=f),$&&(p.p=$),p},e.addImage=function(t,r,a,i,s,_,y,g,v){var b="";if("string"!=typeof r){var x=_;_=s,s=i,i=a,a=r,r=x}if("object"===n(t)&&!p(t)&&"imageData"in t){var w=t;t=w.imageData,r=w.format||r||"UNKNOWN",a=w.x||a||0,i=w.y||i||0,s=w.w||s,_=w.h||_,y=w.alias||y,g=w.compression||g,v=w.rotation||w.angle||v}var A=this.internal.getFilters();if(void 0===g&&-1!==A.indexOf("FlateEncode")&&(g="SLOW"),"string"==typeof t&&(t=unescape(t)),isNaN(a)||isNaN(i))throw console.error("jsPDF.addImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addImage");var k,E,S=c.call(this);if(!((k=h(t,S))||(p(t)&&(t=d(t,r)),u(y)&&(y=f(t)),k=h(y,S)))){if(this.isString(t)&&(b=this.convertStringToImageData(t),""!==b?t=b:void 0!==(b=e.loadFile(t))&&(t=b)),r=this.getImageFileTypeByImageData(t,r),!$(r))throw new Error("addImage does not support files of type '"+r+"', please ensure that a plugin for '"+r+"' support is added.");if(this.supportsArrayBuffer()&&(t instanceof Uint8Array||(E=t,t=this.binaryStringToUint8Array(t))),!(k=this["process"+r.toUpperCase()](t,l(S),y,o(g),E)))throw new Error("An unknown error occurred whilst processing the image")}return m.call(this,a,i,s,_,k,k.i,S,v),this},e.convertStringToImageData=function(t){var r,n,a="";if(this.isString(t)){var r=this.extractImageFromDataUrl(t);n=null!==r?r.data:t;try{a=atob(n)}catch(t){throw e.validateStringAsBase64(n)?new Error("atob-Error in jsPDF.convertStringToImageData "+t.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertStringToImageData ")}}return a};var y=function(e){var t,n,a;if("JPEG"!==r(e))throw new Error("getJpegSize requires a binary string jpeg file");for(var i=256*e.charCodeAt(4)+e.charCodeAt(5),s=4,o=e.length;s<o;){if(s+=i,255!==e.charCodeAt(s))throw new Error("getJpegSize could not find the size of the image");if(192===e.charCodeAt(s+1)||193===e.charCodeAt(s+1)||194===e.charCodeAt(s+1)||195===e.charCodeAt(s+1)||196===e.charCodeAt(s+1)||197===e.charCodeAt(s+1)||198===e.charCodeAt(s+1)||199===e.charCodeAt(s+1))return n=256*e.charCodeAt(s+5)+e.charCodeAt(s+6),t=256*e.charCodeAt(s+7)+e.charCodeAt(s+8),a=e.charCodeAt(s+9),[t,n,a];s+=2,i=256*e.charCodeAt(s)+e.charCodeAt(s+1)}},g=function(e){if(65496!=(e[0]<<8|e[1]))throw new Error("Supplied data is not a JPEG");for(var t,r,n,a,i=e.length,s=(e[4]<<8)+e[5],o=4;o<i;){if(o+=s,t=v(e,o),s=(t[2]<<8)+t[3],(192===t[1]||194===t[1])&&255===t[0]&&s>7)return t=v(e,o+5),r=(t[2]<<8)+t[3],n=(t[0]<<8)+t[1],a=t[4],{width:r,height:n,numcomponents:a};o+=2}throw new Error("getJpegSizeFromBytes could not find the size of the image")},v=function(e,t){return e.subarray(t,t+5)};e.processJPEG=function(e,t,r,n,a,i){var s,o=this.decode.DCT_DECODE;if(!this.isString(e)&&!this.isArrayBuffer(e)&&!this.isArrayBufferView(e))return null;if(this.isString(e)&&(s=y(e)),this.isArrayBuffer(e)&&(e=new Uint8Array(e)),this.isArrayBufferView(e)&&(s=g(e),e=a||this.arrayBufferToBinaryString(e)),void 0===i)switch(s.numcomponents){case 1:i=this.color_spaces.DEVICE_GRAY;break;case 4:i=this.color_spaces.DEVICE_CMYK;break;default:case 3:i=this.color_spaces.DEVICE_RGB}return this.createImageInfo(e,s.width,s.height,i,8,o,t,r)},e.processJPG=function(){return this.processJPEG.apply(this,arguments)},e.getImageProperties=function(t){var r,n,a="";if(p(t)&&(t=d(t)),this.isString(t)&&(a=this.convertStringToImageData(t),""!==a?t=a:void 0!==(a=e.loadFile(t))&&(t=a)),n=this.getImageFileTypeByImageData(t),!$(n))throw new Error("addImage does not support files of type '"+n+"', please ensure that a plugin for '"+n+"' support is added.");if(this.supportsArrayBuffer()&&(t instanceof Uint8Array||(t=this.binaryStringToUint8Array(t))),!(r=this["process"+n.toUpperCase()](t)))throw new Error("An unknown error occurred whilst processing the image");return{fileType:n,width:r.w,height:r.h,colorSpace:r.cs,compressionMode:r.f,bitsPerComponent:r.bpc}}}(c.API),function(e){c.API.events.push(["addPage",function(e){this.internal.getPageInfo(e.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(e){for(var t=this.internal.getPageInfoByObjId(e.objId),r=e.pageContext.annotations,n=function(e){if(void 0!==e&&""!=e)return!0},a=!1,i=0;i<r.length&&!a;i++){var s=r[i];switch(s.type){case"link":if(n(s.options.url)||n(s.options.pageNumber)){a=!0;break}case"reference":case"text":case"freetext":a=!0}}if(0!=a){this.internal.write("/Annots [");for(var o=(this.internal.pageSize.height,this.internal.getCoordinateString),c=this.internal.getVerticalCoordinateString,i=0;i<r.length;i++){var s=r[i];switch(s.type){case"reference":this.internal.write(" "+s.object.objId+" 0 R ");break;case"text":var l=this.internal.newAdditionalObject(),u=this.internal.newAdditionalObject(),f=s.title||"Note",$="/Rect ["+o(s.bounds.x)+" "+c(s.bounds.y+s.bounds.h)+" "+o(s.bounds.x+s.bounds.w)+" "+c(s.bounds.y)+"] ";_="<</Type /Annot /Subtype /Text "+$+"/Contents ("+s.contents+")",_+=" /Popup "+u.objId+" 0 R",_+=" /P "+t.objId+" 0 R",_+=" /T ("+f+") >>",l.content=_;var p=l.objId+" 0 R",$="/Rect ["+o(s.bounds.x+30)+" "+c(s.bounds.y+s.bounds.h)+" "+o(s.bounds.x+s.bounds.w+30)+" "+c(s.bounds.y)+"] ";_="<</Type /Annot /Subtype /Popup "+$+" /Parent "+p,s.open&&(_+=" /Open true"),_+=" >>",u.content=_,this.internal.write(l.objId,"0 R",u.objId,"0 R");break;case"freetext":var $="/Rect ["+o(s.bounds.x)+" "+c(s.bounds.y)+" "+o(s.bounds.x+s.bounds.w)+" "+c(s.bounds.y+s.bounds.h)+"] ",d=s.color||"#000000";_="<</Type /Annot /Subtype /FreeText "+$+"/Contents ("+s.contents+")",_+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+d+")",_+=" /Border [0 0 0]",_+=" >>",this.internal.write(_);break;case"link":if(s.options.name){var h=this.annotations._nameMap[s.options.name];s.options.pageNumber=h.page,s.options.top=h.y}else s.options.top||(s.options.top=0);var $="/Rect ["+o(s.x)+" "+c(s.y)+" "+o(s.x+s.w)+" "+c(s.y+s.h)+"] ",_="";if(s.options.url)_="<</Type /Annot /Subtype /Link "+$+"/Border [0 0 0] /A <</S /URI /URI ("+s.options.url+") >>";else if(s.options.pageNumber){var m=this.internal.getPageInfo(s.options.pageNumber);switch(_="<</Type /Annot /Subtype /Link "+$+"/Border [0 0 0] /Dest ["+m.objId+" 0 R",s.options.magFactor=s.options.magFactor||"XYZ",s.options.magFactor){case"Fit":_+=" /Fit]";break;case"FitH":_+=" /FitH "+s.options.top+"]";break;case"FitV":s.options.left=s.options.left||0,_+=" /FitV "+s.options.left+"]";break;case"XYZ":default:var y=c(s.options.top);s.options.left=s.options.left||0,void 0===s.options.zoom&&(s.options.zoom=0),_+=" /XYZ "+s.options.left+" "+y+" "+s.options.zoom+"]"}}""!=_&&(_+=" >>",this.internal.write(_))}}this.internal.write("]")}}]),e.createAnnotation=function(e){var t=this.internal.getCurrentPageInfo();switch(e.type){case"link":this.link(e.bounds.x,e.bounds.y,e.bounds.w,e.bounds.h,e);break;case"text":case"freetext":t.pageContext.annotations.push(e)}},e.link=function(e,t,r,n,a){this.internal.getCurrentPageInfo().pageContext.annotations.push({x:e,y:t,w:r,h:n,options:a,type:"link"})},e.textWithLink=function(e,t,r,n){var a=this.getTextWidth(e),i=this.internal.getLineHeight()/this.internal.scaleFactor;return this.text(e,t,r),r+=.2*i,this.link(t,r-i,a,i,n),a},e.getTextWidth=function(e){var t=this.internal.getFontSize();return this.getStringUnitWidth(e)*t/this.internal.scaleFactor}}(c.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},a=[1570,1571,1573,1575];e.__arabicParser__={};var i=e.__arabicParser__.isInArabicSubstitutionA=function(e){return void 0!==t[e.charCodeAt(0)]},s=e.__arabicParser__.isArabicLetter=function(e){return"string"==typeof e&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(e)},o=e.__arabicParser__.isArabicEndLetter=function(e){return s(e)&&i(e)&&t[e.charCodeAt(0)].length<=2},c=e.__arabicParser__.isArabicAlfLetter=function(e){return s(e)&&a.indexOf(e.charCodeAt(0))>=0},l=(e.__arabicParser__.arabicLetterHasIsolatedForm=function(e){return s(e)&&i(e)&&t[e.charCodeAt(0)].length>=1},e.__arabicParser__.arabicLetterHasFinalForm=function(e){return s(e)&&i(e)&&t[e.charCodeAt(0)].length>=2}),u=(e.__arabicParser__.arabicLetterHasInitialForm=function(e){return s(e)&&i(e)&&t[e.charCodeAt(0)].length>=3},e.__arabicParser__.arabicLetterHasMedialForm=function(e){return s(e)&&i(e)&&4==t[e.charCodeAt(0)].length
}),f=e.__arabicParser__.resolveLigatures=function(e){var t=0,n=r,a=0,i="",s=0;for(t=0;t<e.length;t+=1)void 0!==n[e.charCodeAt(t)]?(s++,n=n[e.charCodeAt(t)],"number"==typeof n&&(a=$(e.charAt(t),e.charAt(t-s),e.charAt(t+1)),a=-1!==a?a:0,i+=String.fromCharCode(n),n=r,s=0),t===e.length-1&&(n=r,i+=e.charAt(t-(s-1)),t-=s-1,s=0)):(n=r,i+=e.charAt(t-s),t-=s,s=0);return i},$=(e.__arabicParser__.isArabicDiacritic=function(e){return void 0!==e&&void 0!==n[e.charCodeAt(0)]},e.__arabicParser__.getCorrectForm=function(e,t,r){return s(e)?!1===i(e)?-1:!l(e)||!s(t)&&!s(r)||!s(r)&&o(t)||o(e)&&!s(t)||o(e)&&c(t)||o(e)&&o(t)?0:u(e)&&s(t)&&!o(t)&&s(r)&&l(r)?3:o(e)||!s(r)?1:2:-1}),p=e.__arabicParser__.processArabic=e.processArabic=function(e){e=e||"";var r=0,n=0,a=0,i="",o="",c="",l=e.split("\\s+"),u=[];for(r=0;r<l.length;r+=1){for(u.push(""),n=0;n<l[r].length;n+=1)i=l[r][n],o=l[r][n-1],c=l[r][n+1],s(i)?(a=$(i,o,c),u[r]+=-1!==a?String.fromCharCode(t[i.charCodeAt(0)][a]):i):u[r]+=i;u[r]=f(u[r])}return u.join(" ")},d=function(e){var t=e.text,r=(e.x,e.y,e.options,e.mutex,[]);if("[object Array]"===Object.prototype.toString.call(t)){var n=0;for(r=[],n=0;n<t.length;n+=1)"[object Array]"===Object.prototype.toString.call(t[n])?r.push([p(t[n][0]),t[n][1],t[n][2]]):r.push([p(t[n])]);e.text=r}else e.text=p(t)};e.events.push(["preProcessText",d])}(c.API),function(e){e.autoPrint=function(e){var t;switch(e=e||{},e.variant=e.variant||"non-conform",e.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})}return this}}(c.API),function(e){var t=function(){var e=void 0;Object.defineProperty(this,"pdf",{get:function(){return e},set:function(t){e=t}});var t=150;Object.defineProperty(this,"width",{get:function(){return t},set:function(e){t=isNaN(e)||!1===Number.isInteger(e)||e<0?150:e,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=t+1)}});var r=300;Object.defineProperty(this,"height",{get:function(){return r},set:function(e){r=isNaN(e)||!1===Number.isInteger(e)||e<0?300:e,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=r+1)}});var n=[];Object.defineProperty(this,"childNodes",{get:function(){return n},set:function(e){n=e}});var a={};Object.defineProperty(this,"style",{get:function(){return a},set:function(e){a=e}}),Object.defineProperty(this,"parentNode",{get:function(){return!1}})};t.prototype.getContext=function(e,t){e=e||"2d";var r;if("2d"!==e)return null;for(r in t)this.pdf.context2d.hasOwnProperty(r)&&(this.pdf.context2d[r]=t[r]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(c.API),function(e){var t,r={x:void 0,y:void 0,w:void 0,h:void 0,ln:void 0},n=1,a=function(e,t,n,a,i){r={x:e,y:t,w:n,h:a,ln:i}},i=function(){return r},s={left:0,top:0,bottom:0};e.setHeaderFunction=function(e){t=e},e.getTextDimensions=function(e,t){var r=this.table_font_size||this.internal.getFontSize();this.internal.getFont().fontStyle;t=t||{};var n=t.scaleFactor||this.internal.scaleFactor,a=0,i=0,s=0,o=0;if("string"==typeof e)0!==(a=this.getStringUnitWidth(e)*r)&&(i=1);else{if("[object Array]"!==Object.prototype.toString.call(e))throw new Error("getTextDimensions expects text-parameter to be of type String or an Array of Strings.");for(var c=0;c<e.length;c++)o=this.getStringUnitWidth(e[c])*r,a<o&&(a=o);0!==a&&(i=e.length)}return a/=n,s=Math.max((i*r*this.getLineHeightFactor()-r*(this.getLineHeightFactor()-1))/n,0),{w:a,h:s}},e.cellAddPage=function(){var e=this.margins||s;this.addPage(),a(e.left,e.top,void 0,void 0),n+=1},e.cellInitialize=function(){r={x:void 0,y:void 0,w:void 0,h:void 0,ln:void 0},n=1},e.cell=function(e,t,r,n,o,c,l){var u=i(),f=!1;if(void 0!==u.ln)if(u.ln===c)e=u.x+u.w,t=u.y;else{var $=this.margins||s;u.y+u.h+n+13>=this.internal.pageSize.getHeight()-$.bottom&&(this.cellAddPage(),f=!0,this.printHeaders&&this.tableHeaderRow&&this.printHeaderRow(c,!0)),t=i().y+i().h,f&&(t=23)}if(void 0!==o[0])if(this.printingHeaderRow?this.rect(e,t,r,n,"FD"):this.rect(e,t,r,n),"right"===l){o instanceof Array||(o=[o]);for(var p=0;p<o.length;p++){var d=o[p],h=this.getStringUnitWidth(d)*this.internal.getFontSize();this.text(d,e+r-h-3,t+this.internal.getLineHeight()*(p+1))}}else this.text(o,e+3,t+this.internal.getLineHeight());return a(e,t,r,n,c),this},e.arrayMax=function(e,t){var r,n,a,i=e[0];for(r=0,n=e.length;r<n;r+=1)a=e[r],t?-1===t(i,a)&&(i=a):a>i&&(i=a);return i},e.table=function(t,a,i,o,c){if(!i)throw"No data for PDF table";var l,u,f,$,p,d,h,_,m,y,g=[],v=[],b={},x={},w=[],A=[],k=!1,E=!0,S=12,N=s;if(N.width=this.internal.pageSize.getWidth(),c&&(!0===c.autoSize&&(k=!0),!1===c.printHeaders&&(E=!1),c.fontSize&&(S=c.fontSize),c.css&&void 0!==c.css["font-size"]&&(S=16*c.css["font-size"]),c.margins&&(N=c.margins)),this.lnMod=0,r={x:void 0,y:void 0,w:void 0,h:void 0,ln:void 0},n=1,this.printHeaders=E,this.margins=N,this.setFontSize(S),this.table_font_size=S,void 0===o||null===o)g=Object.keys(i[0]);else if(o[0]&&"string"!=typeof o[0]){for(u=0,f=o.length;u<f;u+=1)l=o[u],g.push(l.name),v.push(l.prompt),x[l.name]=l.width*(19.049976/25.4)}else g=o;if(k)for(y=function(e){return e[l]},u=0,f=g.length;u<f;u+=1){for(l=g[u],b[l]=i.map(y),w.push(this.getTextDimensions(v[u]||l,{scaleFactor:1}).w),d=b[l],h=0,$=d.length;h<$;h+=1)p=d[h],w.push(this.getTextDimensions(p,{scaleFactor:1}).w);x[l]=e.arrayMax(w),w=[]}if(E){var C=this.calculateLineHeight(g,x,v.length?v:g);for(u=0,f=g.length;u<f;u+=1)l=g[u],A.push([t,a,x[l],C,String(v.length?v[u]:l)]);this.setTableHeaderRow(A),this.printHeaderRow(1,!1)}for(u=0,f=i.length;u<f;u+=1){var C;for(_=i[u],C=this.calculateLineHeight(g,x,_),h=0,m=g.length;h<m;h+=1)l=g[h],this.cell(t,a,x[l],C,_[l],u+2,l.align)}return this.lastCellPos=r,this.table_x=t,this.table_y=a,this},e.calculateLineHeight=function(e,t,r){for(var n,a=0,i=0;i<e.length;i++){n=e[i],r[n]=this.splitTextToSize(String(r[n]),t[n]-3);var s=this.internal.getLineHeight()*r[n].length+3;s>a&&(a=s)}return a},e.setTableHeaderRow=function(e){this.tableHeaderRow=e},e.printHeaderRow=function(e,r){if(!this.tableHeaderRow)throw"Property tableHeaderRow does not exist.";var i,s,o,c;if(this.printingHeaderRow=!0,void 0!==t){var l=t(this,n);a(l[0],l[1],l[2],l[3],-1)}this.setFontStyle("bold");var u=[];for(o=0,c=this.tableHeaderRow.length;o<c;o+=1)this.setFillColor(200,200,200),i=this.tableHeaderRow[o],r&&(this.margins.top=13,i[1]=this.margins&&this.margins.top||0,u.push(i)),s=[].concat(i),this.cell.apply(this,s.concat(e));u.length>0&&this.setTableHeaderRow(u),this.setFontStyle("normal"),this.printingHeaderRow=!1}}(c.API),function(e,t){var r,a,i,s,o,c,l=function(e){return e=e||{},this.isStrokeTransparent=e.isStrokeTransparent||!1,this.strokeOpacity=e.strokeOpacity||1,this.strokeStyle=e.strokeStyle||"#000000",this.fillStyle=e.fillStyle||"#000000",this.isFillTransparent=e.isFillTransparent||!1,this.fillOpacity=e.fillOpacity||1,this.font=e.font||"10px sans-serif",this.textBaseline=e.textBaseline||"alphabetic",this.textAlign=e.textAlign||"left",this.lineWidth=e.lineWidth||1,this.lineJoin=e.lineJoin||"miter",this.lineCap=e.lineCap||"butt",this.path=e.path||[],this.transform=void 0!==e.transform?e.transform.clone():new B,this.globalCompositeOperation=e.globalCompositeOperation||"normal",this.globalAlpha=e.globalAlpha||1,this.clip_path=e.clip_path||[],this.currentPoint=e.currentPoint||new M,this.miterLimit=e.miterLimit||10,this.lastPoint=e.lastPoint||new M,this.ignoreClearRect="boolean"!=typeof e.ignoreClearRect||e.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new u(this),r=this.internal.f2,a=this.internal.f3,i=this.internal.getCoordinateString,s=this.internal.getVerticalCoordinateString,o=this.internal.getHorizontalCoordinate,c=this.internal.getVerticalCoordinate}]);var u=function(e){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}}),Object.defineProperty(this,"pdf",{get:function(){return e}});var t=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return t},set:function(e){t=Boolean(e)}});var r=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return r},set:function(e){r=Boolean(e)}});var n=0;Object.defineProperty(this,"posX",{get:function(){return n},set:function(e){isNaN(e)||(n=e)}});var a=0;Object.defineProperty(this,"posY",{get:function(){return a},set:function(e){isNaN(e)||(a=e)}});var i=!1;Object.defineProperty(this,"autoPaging",{get:function(){return i},set:function(e){i=Boolean(e)}});var s=0;Object.defineProperty(this,"lastBreak",{get:function(){return s},set:function(e){s=e}});var o=[];Object.defineProperty(this,"pageBreaks",{get:function(){return o},set:function(e){o=e}});var c=new l;Object.defineProperty(this,"ctx",{get:function(){return c},set:function(e){e instanceof l&&(c=e)}}),Object.defineProperty(this,"path",{get:function(){return c.path},set:function(e){c.path=e}});var u=[];Object.defineProperty(this,"ctxStack",{get:function(){return u},set:function(e){u=e}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(e){var t;t=f(e),this.ctx.fillStyle=t.style,this.ctx.isFillTransparent=0===t.a,this.ctx.fillOpacity=t.a,this.pdf.setFillColor(t.r,t.g,t.b,{a:t.a}),this.pdf.setTextColor(t.r,t.g,t.b,{a:t.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(e){var t=f(e);this.ctx.strokeStyle=t.style,this.ctx.isStrokeTransparent=0===t.a,this.ctx.strokeOpacity=t.a,0===t.a?this.pdf.setDrawColor(255,255,255):(t.a,this.pdf.setDrawColor(t.r,t.g,t.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(e){-1!==["butt","round","square"].indexOf(e)&&(this.ctx.lineCap=e,this.pdf.setLineCap(e))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(e){isNaN(e)||(this.ctx.lineWidth=e,this.pdf.setLineWidth(e))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(e){-1!==["bevel","round","miter"].indexOf(e)&&(this.ctx.lineJoin=e,this.pdf.setLineJoin(e))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(e){isNaN(e)||(this.ctx.miterLimit=e,this.pdf.setMiterLimit(e))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(e){this.ctx.textBaseline=e}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(e){-1!==["right","end","center","left","start"].indexOf(e)&&(this.ctx.textAlign=e)}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(e){this.ctx.font=e;var t,r;if(t=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i,null!==(r=t.exec(e))){var n=r[1],a=(r[2],r[3]),i=r[4],s=r[5],o=r[6];i="px"===s?Math.floor(parseFloat(i)):"em"===s?Math.floor(parseFloat(i)*this.pdf.getFontSize()):Math.floor(parseFloat(i)),this.pdf.setFontSize(i);var c="";("bold"===a||parseInt(a,10)>=700||"bold"===n)&&(c="bold"),"italic"===n&&(c+="italic"),0===c.length&&(c="normal");for(var l="",u=o.toLowerCase().replace(/"|'/g,"").split(/\s*,\s*/),f={arial:"Helvetica",verdana:"Helvetica",helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",courier:"Courier",times:"Times",cursive:"Times",fantasy:"Times",serif:"Times"},$=0;$<u.length;$++){if(void 0!==this.pdf.internal.getFont(u[$],c,{noFallback:!0,disableWarning:!0})){l=u[$];break}if("bolditalic"===c&&void 0!==this.pdf.internal.getFont(u[$],"bold",{noFallback:!0,disableWarning:!0}))l=u[$],c="bold";else if(void 0!==this.pdf.internal.getFont(u[$],"normal",{noFallback:!0,disableWarning:!0})){l=u[$],c="normal";break}}if(""===l)for(var $=0;$<u.length;$++)if(f[u[$]]){l=f[u[$]];break}l=""===l?"Times":l,this.pdf.setFont(l,c)}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(e){this.ctx.globalCompositeOperation=e}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(e){this.ctx.globalAlpha=e}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(e){this.ctx.ignoreClearRect=Boolean(e)}})};u.prototype.fill=function(){m.call(this,"fill",!1)},u.prototype.stroke=function(){m.call(this,"stroke",!1)},u.prototype.beginPath=function(){this.path=[{type:"begin"}]},u.prototype.moveTo=function(e,t){if(isNaN(e)||isNaN(t))throw console.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var r=this.ctx.transform.applyToPoint(new M(e,t));this.path.push({type:"mt",x:r.x,y:r.y}),this.ctx.lastPoint=new M(e,t)},u.prototype.closePath=function(){var e=new M(0,0),t=0;for(t=this.path.length-1;-1!==t;t--)if("begin"===this.path[t].type&&"object"===n(this.path[t+1])&&"number"==typeof this.path[t+1].x){e=new M(this.path[t+1].x,this.path[t+1].y),this.path.push({type:"lt",x:e.x,y:e.y});break}"object"===n(this.path[t+2])&&"number"==typeof this.path[t+2].x&&this.path.push(JSON.parse(JSON.stringify(this.path[t+2]))),this.path.push({type:"close"}),this.ctx.lastPoint=new M(e.x,e.y)},u.prototype.lineTo=function(e,t){if(isNaN(e)||isNaN(t))throw console.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var r=this.ctx.transform.applyToPoint(new M(e,t));this.path.push({type:"lt",x:r.x,y:r.y}),this.ctx.lastPoint=new M(r.x,r.y)},u.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),m.call(this,null,!0)},u.prototype.quadraticCurveTo=function(e,t,r,n){if(isNaN(r)||isNaN(n)||isNaN(e)||isNaN(t))throw console.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var a=this.ctx.transform.applyToPoint(new M(r,n)),i=this.ctx.transform.applyToPoint(new M(e,t));this.path.push({type:"qct",x1:i.x,y1:i.y,x:a.x,y:a.y}),this.ctx.lastPoint=new M(a.x,a.y)},u.prototype.bezierCurveTo=function(e,t,r,n,a,i){if(isNaN(a)||isNaN(i)||isNaN(e)||isNaN(t)||isNaN(r)||isNaN(n))throw console.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var s=this.ctx.transform.applyToPoint(new M(a,i)),o=this.ctx.transform.applyToPoint(new M(e,t)),c=this.ctx.transform.applyToPoint(new M(r,n));this.path.push({type:"bct",x1:o.x,y1:o.y,x2:c.x,y2:c.y,x:s.x,y:s.y}),this.ctx.lastPoint=new M(s.x,s.y)},u.prototype.arc=function(e,t,r,n,a,i){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(n)||isNaN(a))throw console.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(i=Boolean(i),!this.ctx.transform.isIdentity){var s=this.ctx.transform.applyToPoint(new M(e,t));e=s.x,t=s.y;var o=this.ctx.transform.applyToPoint(new M(0,r)),c=this.ctx.transform.applyToPoint(new M(0,0));r=Math.sqrt(Math.pow(o.x-c.x,2)+Math.pow(o.y-c.y,2))}Math.abs(a-n)>=2*Math.PI&&(n=0,a=2*Math.PI),this.path.push({type:"arc",x:e,y:t,radius:r,startAngle:n,endAngle:a,counterclockwise:i})},u.prototype.arcTo=function(e,t,r,n,a){throw new Error("arcTo not implemented.")},u.prototype.rect=function(e,t,r,n){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(n))throw console.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(e,t),this.lineTo(e+r,t),this.lineTo(e+r,t+n),this.lineTo(e,t+n),this.lineTo(e,t),this.lineTo(e+r,t),this.lineTo(e,t)},u.prototype.fillRect=function(e,t,r,n){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(n))throw console.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!$.call(this)){var a={};"butt"!==this.lineCap&&(a.lineCap=this.lineCap,this.lineCap="butt"),"miter"!==this.lineJoin&&(a.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(e,t,r,n),this.fill(),a.hasOwnProperty("lineCap")&&(this.lineCap=a.lineCap),a.hasOwnProperty("lineJoin")&&(this.lineJoin=a.lineJoin)}},u.prototype.strokeRect=function(e,t,r,n){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(n))throw console.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");p.call(this)||(this.beginPath(),this.rect(e,t,r,n),this.stroke())},u.prototype.clearRect=function(e,t,r,n){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(n))throw console.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(e,t,r,n))},u.prototype.save=function(e){e="boolean"!=typeof e||e;for(var t=this.pdf.internal.getCurrentPageInfo().pageNumber,r=0;r<this.pdf.internal.getNumberOfPages();r++)this.pdf.setPage(r+1),this.pdf.internal.out("q");if(this.pdf.setPage(t),e){this.ctx.fontSize=this.pdf.internal.getFontSize();var n=new l(this.ctx);this.ctxStack.push(this.ctx),this.ctx=n}},u.prototype.restore=function(e){e="boolean"!=typeof e||e;for(var t=this.pdf.internal.getCurrentPageInfo().pageNumber,r=0;r<this.pdf.internal.getNumberOfPages();r++)this.pdf.setPage(r+1),this.pdf.internal.out("Q");this.pdf.setPage(t),e&&0!==this.ctxStack.length&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin)},u.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var f=function(e){var t,r,n,a,i=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,s=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d\.]+)\s*\)/,o=/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/;!0===e.isCanvasGradient&&(e=e.getColor());var c=new RGBColor(e);if(!e)return{r:0,g:0,b:0,a:0,style:e};if(o.test(e))t=0,r=0,n=0,a=0;else{var l=i.exec(e);null!==l?(t=parseInt(l[1]),r=parseInt(l[2]),n=parseInt(l[3]),a=1):(l=s.exec(e),null!==l?(t=parseInt(l[1]),r=parseInt(l[2]),n=parseInt(l[3]),a=parseFloat(l[4])):(a=1,"#"!==e.charAt(0)&&(e=c.ok?c.toHex():"#000000"),4===e.length?(t=e.substring(1,2),t+=t,r=e.substring(2,3),r+=r,n=e.substring(3,4),n+=n):(t=e.substring(1,3),r=e.substring(3,5),n=e.substring(5,7)),t=parseInt(t,16),r=parseInt(r,16),n=parseInt(n,16)))}return{r:t,g:r,b:n,a:a,style:e}},$=function(){return this.ctx.isFillTransparent||0==this.globalAlpha},p=function(){return Boolean(this.ctx.isStrokeTransparent||0==this.globalAlpha)};u.prototype.fillText=function(e,t,r,n){if(isNaN(t)||isNaN(r)||"string"!=typeof e)throw console.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(n=isNaN(n)?void 0:n,!$.call(this)){r=g.call(this,r);var a=I(this.ctx.transform.rotation),i=this.ctx.transform.scaleX;A.call(this,{text:e,x:t,y:r,scale:i,angle:a,align:this.textAlign,maxWidth:n})}},u.prototype.strokeText=function(e,t,r,n){if(isNaN(t)||isNaN(r)||"string"!=typeof e)throw console.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!p.call(this)){n=isNaN(n)?void 0:n,r=g.call(this,r);var a=I(this.ctx.transform.rotation),i=this.ctx.transform.scaleX;A.call(this,{text:e,x:t,y:r,scale:i,renderingMode:"stroke",angle:a,align:this.textAlign,maxWidth:n})}},u.prototype.measureText=function(e){if("string"!=typeof e)throw console.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var t=this.pdf,r=this.pdf.internal.scaleFactor,n=t.internal.getFontSize(),a=t.getStringUnitWidth(e)*n/t.internal.scaleFactor;return a*=Math.round(96*r/72*1e4)/1e4,new function(e){e=e||{};var t=e.width||0;return Object.defineProperty(this,"width",{get:function(){return t}}),this}({width:a})},u.prototype.scale=function(e,t){if(isNaN(e)||isNaN(t))throw console.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var r=new B(e,0,0,t,0,0);this.ctx.transform=this.ctx.transform.multiply(r)},u.prototype.rotate=function(e){if(isNaN(e))throw console.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var t=new B(Math.cos(e),Math.sin(e),-Math.sin(e),Math.cos(e),0,0);this.ctx.transform=this.ctx.transform.multiply(t)},u.prototype.translate=function(e,t){if(isNaN(e)||isNaN(t))throw console.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var r=new B(1,0,0,1,e,t);this.ctx.transform=this.ctx.transform.multiply(r)},u.prototype.transform=function(e,t,r,n,a,i){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(n)||isNaN(a)||isNaN(i))throw console.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var s=new B(e,t,r,n,a,i);this.ctx.transform=this.ctx.transform.multiply(s)},u.prototype.setTransform=function(e,t,r,n,a,i){e=isNaN(e)?1:e,t=isNaN(t)?0:t,r=isNaN(r)?0:r,n=isNaN(n)?1:n,a=isNaN(a)?0:a,i=isNaN(i)?0:i,this.ctx.transform=new B(e,t,r,n,a,i)},u.prototype.drawImage=function(e,t,r,n,a,i,s,o,c){var l=this.pdf.getImageProperties(e),u=1,f=1,$=1,p=1;void 0!==n&&void 0!==o&&($=o/n,p=c/a,u=l.width/n*o/n,f=l.height/a*c/a),void 0===i&&(i=t,s=r,t=0,r=0),void 0!==n&&void 0===o&&(o=n,c=a),void 0===n&&void 0===o&&(o=l.width,c=l.height);var h=this.ctx.transform.decompose(),m=I(h.rotate.shx);h.scale.sx,h.scale.sy;var g=new B;g=g.multiply(h.translate),g=g.multiply(h.skew),g=g.multiply(h.scale);for(var v=(g.applyToPoint(new M(o,c)),g.applyToRectangle(new T(i-t*$,s-r*p,n*u,a*f))),b=d.call(this,v),x=[],w=0;w<b.length;w+=1)-1===x.indexOf(b[w])&&x.push(b[w]);x.sort();var A;if(this.autoPaging)for(var k=x[0],E=x[x.length-1],S=k;S<E+1;S++){if(this.pdf.setPage(S),0!==this.ctx.clip_path.length){var N=this.path;A=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=_(A,this.posX,-1*this.pdf.internal.pageSize.height*(S-1)+this.posY),y.call(this,"fill",!0),this.path=N}var C=JSON.parse(JSON.stringify(v));C=_([C],this.posX,-1*this.pdf.internal.pageSize.height*(S-1)+this.posY)[0],this.pdf.addImage(e,"jpg",C.x,C.y,C.w,C.h,null,null,m)}else this.pdf.addImage(e,"jpg",v.x,v.y,v.w,v.h,null,null,m)};var d=function(e,t,r){var n=[];switch(t=t||this.pdf.internal.pageSize.width,r=r||this.pdf.internal.pageSize.height,e.type){default:case"mt":case"lt":n.push(Math.floor((e.y+this.posY)/r)+1);break;case"arc":n.push(Math.floor((e.y+this.posY-e.radius)/r)+1),n.push(Math.floor((e.y+this.posY+e.radius)/r)+1);break;case"qct":var a=L(this.ctx.lastPoint.x,this.ctx.lastPoint.y,e.x1,e.y1,e.x,e.y);n.push(Math.floor(a.y/r)+1),n.push(Math.floor((a.y+a.h)/r)+1);break;case"bct":var i=P(this.ctx.lastPoint.x,this.ctx.lastPoint.y,e.x1,e.y1,e.x2,e.y2,e.x,e.y);n.push(Math.floor(i.y/r)+1),n.push(Math.floor((i.y+i.h)/r)+1);break;case"rect":n.push(Math.floor((e.y+this.posY)/r)+1),n.push(Math.floor((e.y+e.h+this.posY)/r)+1)}for(var s=0;s<n.length;s+=1)for(;this.pdf.internal.getNumberOfPages()<n[s];)h.call(this);return n},h=function(){var e=this.fillStyle,t=this.strokeStyle,r=this.font,n=this.lineCap,a=this.lineWidth,i=this.lineJoin;this.pdf.addPage(),this.fillStyle=e,this.strokeStyle=t,this.font=r,this.lineCap=n,this.lineWidth=a,this.lineJoin=i},_=function(e,t,r){for(var n=0;n<e.length;n++)switch(e[n].type){case"bct":e[n].x2+=t,e[n].y2+=r;case"qct":e[n].x1+=t,e[n].y1+=r;case"mt":case"lt":case"arc":default:e[n].x+=t,e[n].y+=r}return e},m=function(e,t){for(var r,n,a=this.fillStyle,i=this.strokeStyle,s=(this.font,this.lineCap),o=this.lineWidth,c=this.lineJoin,l=JSON.parse(JSON.stringify(this.path)),u=JSON.parse(JSON.stringify(this.path)),f=[],$=0;$<u.length;$++)if(void 0!==u[$].x)for(var p=d.call(this,u[$]),m=0;m<p.length;m+=1)-1===f.indexOf(p[m])&&f.push(p[m]);for(var $=0;$<f.length;$++)for(;this.pdf.internal.getNumberOfPages()<f[$];)h.call(this);if(f.sort(),this.autoPaging)for(var g=f[0],v=f[f.length-1],$=g;$<v+1;$++){if(this.pdf.setPage($),this.fillStyle=a,this.strokeStyle=i,this.lineCap=s,this.lineWidth=o,this.lineJoin=c,0!==this.ctx.clip_path.length){var b=this.path;r=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=_(r,this.posX,-1*this.pdf.internal.pageSize.height*($-1)+this.posY),y.call(this,e,!0),this.path=b}n=JSON.parse(JSON.stringify(l)),this.path=_(n,this.posX,-1*this.pdf.internal.pageSize.height*($-1)+this.posY),!1!==t&&0!==$||y.call(this,e,t)}else y.call(this,e,t);this.path=l},y=function(e,t){if(("stroke"!==e||t||!p.call(this))&&("stroke"===e||t||!$.call(this))){var r=[];this.ctx.globalAlpha;this.ctx.fillOpacity<1&&this.ctx.fillOpacity;for(var n=this.path,a=0;a<n.length;a++){var i=n[a];switch(i.type){case"begin":r.push({begin:!0});break;case"close":r.push({close:!0});break;case"mt":r.push({start:i,deltas:[],abs:[]});break;case"lt":var s=r.length;if(!isNaN(n[a-1].x)){var o=[i.x-n[a-1].x,i.y-n[a-1].y];if(s>0)for(s;s>=0;s--)if(!0!==r[s-1].close&&!0!==r[s-1].begin){r[s-1].deltas.push(o),r[s-1].abs.push(i);break}}break;case"bct":var o=[i.x1-n[a-1].x,i.y1-n[a-1].y,i.x2-n[a-1].x,i.y2-n[a-1].y,i.x-n[a-1].x,i.y-n[a-1].y];r[r.length-1].deltas.push(o);break;case"qct":var c=n[a-1].x+2/3*(i.x1-n[a-1].x),l=n[a-1].y+2/3*(i.y1-n[a-1].y),u=i.x+2/3*(i.x1-i.x),f=i.y+2/3*(i.y1-i.y),d=i.x,h=i.y,o=[c-n[a-1].x,l-n[a-1].y,u-n[a-1].x,f-n[a-1].y,d-n[a-1].x,h-n[a-1].y];r[r.length-1].deltas.push(o);break;case"arc":r.push({deltas:[],abs:[],arc:!0}),Array.isArray(r[r.length-1].abs)&&r[r.length-1].abs.push(i)}}var _;_=t?null:"stroke"===e?"stroke":"fill";for(var a=0;a<r.length;a++){if(r[a].arc)for(var m=r[a].abs,y=0;y<m.length;y++){var g=m[y];if(void 0!==g.startAngle){var w=I(g.startAngle),A=I(g.endAngle),S=g.x,N=g.y;v.call(this,S,N,g.radius,w,A,g.counterclockwise,_,t)}else k.call(this,g.x,g.y)}if(!r[a].arc&&!0!==r[a].close&&!0!==r[a].begin){var S=r[a].start.x,N=r[a].start.y;E.call(this,r[a].deltas,S,N,null,null)}}_&&b.call(this,_),t&&x.call(this)}},g=function(e){var t=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,r=t*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return e-r;case"top":return e+t-r;case"hanging":return e+t-2*r;case"middle":return e+t/2-r;case"ideographic":return e;case"alphabetic":default:return e}};u.prototype.createLinearGradient=function(){var e=function(){};return e.colorStops=[],e.addColorStop=function(e,t){this.colorStops.push([e,t])},e.getColor=function(){return 0===this.colorStops.length?"#000000":this.colorStops[0][1]},e.isCanvasGradient=!0,e},u.prototype.createPattern=function(){return this.createLinearGradient()},u.prototype.createRadialGradient=function(){return this.createLinearGradient()};var v=function(e,t,r,n,a,i,s,o){for(var c=(this.pdf.internal.scaleFactor,O(n)),l=O(a),u=N.call(this,r,c,l,i),f=0;f<u.length;f++){var $=u[f];0===f&&w.call(this,$.x1+e,$.y1+t),S.call(this,e,t,$.x2,$.y2,$.x3,$.y3,$.x4,$.y4)}o?x.call(this):b.call(this,s)},b=function(e){switch(e){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},x=function(){this.pdf.clip()},w=function(e,t){this.pdf.internal.out(i(e)+" "+s(t)+" m")},A=function(e){var t;switch(e.align){case"right":case"end":t="right";break;case"center":t="center";break;case"left":case"start":default:t="left"}var r=this.ctx.transform.applyToPoint(new M(e.x,e.y)),n=this.ctx.transform.decompose(),a=new B;a=a.multiply(n.translate),a=a.multiply(n.skew),a=a.multiply(n.scale);for(var i=this.pdf.getTextDimensions(e.text),s=this.ctx.transform.applyToRectangle(new T(e.x,e.y,i.w,i.h)),o=a.applyToRectangle(new T(e.x,e.y-i.h,i.w,i.h)),c=d.call(this,o),l=[],u=0;u<c.length;u+=1)-1===l.indexOf(c[u])&&l.push(c[u]);l.sort();var f;if(!0===this.autoPaging)for(var $=l[0],p=l[l.length-1],h=$;h<p+1;h++){if(this.pdf.setPage(h),0!==this.ctx.clip_path.length){var m=this.path;f=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=_(f,this.posX,-1*this.pdf.internal.pageSize.height*(h-1)+this.posY),y.call(this,"fill",!0),this.path=m}var g=JSON.parse(JSON.stringify(s));if(g=_([g],this.posX,-1*this.pdf.internal.pageSize.height*(h-1)+this.posY)[0],e.scale>=.01){var v=this.pdf.internal.getFontSize();this.pdf.setFontSize(v*e.scale)}this.pdf.text(e.text,g.x,g.y,{angle:e.angle,align:t,renderingMode:e.renderingMode,maxWidth:e.maxWidth}),e.scale>=.01&&this.pdf.setFontSize(v)}else{if(e.scale>=.01){var v=this.pdf.internal.getFontSize();this.pdf.setFontSize(v*e.scale)}this.pdf.text(e.text,r.x+this.posX,r.y+this.posY,{angle:e.angle,align:t,renderingMode:e.renderingMode,maxWidth:e.maxWidth}),e.scale>=.01&&this.pdf.setFontSize(v)}},k=function(e,t,r,n){r=r||0,n=n||0,this.pdf.internal.out(i(e+r)+" "+s(t+n)+" l")},E=function(e,t,r){return this.pdf.lines(e,t,r,null,null)},S=function(e,t,n,a,i,s,l,u){this.pdf.internal.out([r(o(n+e)),r(c(a+t)),r(o(i+e)),r(c(s+t)),r(o(l+e)),r(c(u+t)),"c"].join(" "))},N=function(e,t,r,n){var a=2*Math.PI,i=t;(i<a||i>a)&&(i%=a);var s=r;(s<a||s>a)&&(s%=a);for(var o=[],c=Math.PI/2,l=n?-1:1,u=t,f=Math.min(a,Math.abs(s-i));f>1e-5;){var $=u+l*Math.min(f,c);o.push(C.call(this,e,u,$)),f-=Math.abs($-u),u=$}return o},C=function(e,t,r){var n=(r-t)/2,a=e*Math.cos(n),i=e*Math.sin(n),s=a,o=-i,c=s*s+o*o,l=c+s*a+o*i,u=4/3*(Math.sqrt(2*c*l)-l)/(s*i-o*a),f=s-u*o,$=o+u*s,p=f,d=-$,h=n+t,_=Math.cos(h),m=Math.sin(h);return{x1:e*Math.cos(t),y1:e*Math.sin(t),x2:f*_-$*m,y2:f*m+$*_,x3:p*_-d*m,y3:p*m+d*_,x4:e*Math.cos(r),y4:e*Math.sin(r)}},I=function(e){return 180*e/Math.PI},O=function(e){return e*Math.PI/180},L=function(e,t,r,n,a,i){var s=e+.5*(r-e),o=t+.5*(n-t),c=a+.5*(r-a),l=i+.5*(n-i),u=Math.min(e,a,s,c),f=Math.max(e,a,s,c),$=Math.min(t,i,o,l),p=Math.max(t,i,o,l);return new T(u,$,f-u,p-$)},P=function(e,t,r,n,a,i,s,o){for(var c,l,u,f,$,p,d,h,_,m,y,g,v,b,x,w,A,k,E,S,N,C,I,O,L=r-e,P=n-t,M=a-r,B=i-n,j=s-a,F=o-i,b=0;b<41;b++)c=b/40,l=e+c*L,u=t+c*P,f=r+c*M,$=n+c*B,p=a+c*j,d=i+c*F,E=f-l,S=$-u,N=p-f,C=d-$,m=l+c*E,y=u+c*S,h=f+c*N,_=$+c*C,I=h-m,O=_-y,g=m+c*I,v=y+c*O,0==b?(x=g,w=v,A=g,k=v):(x=Math.min(x,g),w=Math.min(w,v),A=Math.max(A,g),k=Math.max(k,v));return new T(Math.round(x),Math.round(w),Math.round(A-x),Math.round(k-w))},M=function(e,t){var r=e||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return r},set:function(e){isNaN(e)||(r=parseFloat(e))}});var n=t||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return n},set:function(e){isNaN(e)||(n=parseFloat(e))}});var a="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return a},set:function(e){a=e.toString()}}),this},T=function(e,t,r,n){M.call(this,e,t),this.type="rect";var a=r||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return a},set:function(e){isNaN(e)||(a=parseFloat(e))}});var i=n||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return i},set:function(e){isNaN(e)||(i=parseFloat(e))}}),this},B=function(e,t,r,n,a,i){var s=[];return Object.defineProperty(this,"sx",{get:function(){return s[0]},set:function(e){s[0]=Math.round(1e5*e)/1e5}}),
Object.defineProperty(this,"shy",{get:function(){return s[1]},set:function(e){s[1]=Math.round(1e5*e)/1e5}}),Object.defineProperty(this,"shx",{get:function(){return s[2]},set:function(e){s[2]=Math.round(1e5*e)/1e5}}),Object.defineProperty(this,"sy",{get:function(){return s[3]},set:function(e){s[3]=Math.round(1e5*e)/1e5}}),Object.defineProperty(this,"tx",{get:function(){return s[4]},set:function(e){s[4]=Math.round(1e5*e)/1e5}}),Object.defineProperty(this,"ty",{get:function(){return s[5]},set:function(e){s[5]=Math.round(1e5*e)/1e5}}),Object.defineProperty(this,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(this,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(this,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(this,"isIdentity",{get:function(){return 1===this.sx&&(0===this.shy&&(0===this.shx&&(1===this.sy&&(0===this.tx&&0===this.ty))))}}),this.sx=isNaN(e)?1:e,this.shy=isNaN(t)?0:t,this.shx=isNaN(r)?0:r,this.sy=isNaN(n)?1:n,this.tx=isNaN(a)?0:a,this.ty=isNaN(i)?0:i,this};B.prototype.multiply=function(e){var t=e.sx*this.sx+e.shy*this.shx,r=e.sx*this.shy+e.shy*this.sy,n=e.shx*this.sx+e.sy*this.shx,a=e.shx*this.shy+e.sy*this.sy,i=e.tx*this.sx+e.ty*this.shx+this.tx,s=e.tx*this.shy+e.ty*this.sy+this.ty;return new B(t,r,n,a,i,s)},B.prototype.decompose=function(){var e=this.sx,t=this.shy,r=this.shx,n=this.sy,a=this.tx,i=this.ty,s=Math.sqrt(e*e+t*t);e/=s,t/=s;var o=e*r+t*n;r-=e*o,n-=t*o;var c=Math.sqrt(r*r+n*n);return r/=c,n/=c,o/=c,e*n<t*r&&(e=-e,t=-t,o=-o,s=-s),{scale:new B(s,0,0,c,0,0),translate:new B(1,0,0,1,a,i),rotate:new B(e,t,-t,e,0,0),skew:new B(1,0,o,1,0,0)}},B.prototype.applyToPoint=function(e){var t=e.x*this.sx+e.y*this.shx+this.tx,r=e.x*this.shy+e.y*this.sy+this.ty;return new M(t,r)},B.prototype.applyToRectangle=function(e){var t=this.applyToPoint(e),r=this.applyToPoint(new M(e.x+e.w,e.y+e.h));return new T(t.x,t.y,r.x-t.x,r.y-t.y)},B.prototype.clone=function(){var e=this.sx,t=this.shy,r=this.shx,n=this.sy,a=this.tx,i=this.ty;return new B(e,t,r,n,a,i)}}(c.API,"undefined"!=typeof self&&self||"undefined"!=typeof window&&window||"undefined"!=typeof global&&global||Function('return typeof this === "object" && this.content')()||Function("return this")()),function(e){var t=function(e){var t,r,n,a,i,s,o,c,l,u;for(/[^\x00-\xFF]/.test(e),t="\0\0\0\0".slice(e.length%4||4),e+=t,r=[],n=0,a=e.length;a>n;n+=4)i=(e.charCodeAt(n)<<24)+(e.charCodeAt(n+1)<<16)+(e.charCodeAt(n+2)<<8)+e.charCodeAt(n+3),0!==i?(u=i%85,i=(i-u)/85,l=i%85,i=(i-l)/85,c=i%85,i=(i-c)/85,o=i%85,i=(i-o)/85,s=i%85,r.push(s+33,o+33,c+33,l+33,u+33)):r.push(122);return function(e,t){for(var r=t;r>0;r--)e.pop()}(r,t.length),String.fromCharCode.apply(String,r)+"~>"},r=function(e){var t,r,n,a,i,s=String,o="length",c=255,l="charCodeAt",u="slice",f="replace";for(e[u](-2),e=e[u](0,-2)[f](/\s/g,"")[f]("z","!!!!!"),t="uuuuu"[u](e[o]%5||5),e+=t,n=[],a=0,i=e[o];i>a;a+=5)r=52200625*(e[l](a)-33)+614125*(e[l](a+1)-33)+7225*(e[l](a+2)-33)+85*(e[l](a+3)-33)+(e[l](a+4)-33),n.push(c&r>>24,c&r>>16,c&r>>8,c&r);return function(e,t){for(var r=t;r>0;r--)e.pop()}(n,t[o]),s.fromCharCode.apply(s,n)},n=function(e){for(var t,r="",t=0;t<e.length;t+=1)r+=("0"+e.charCodeAt(t).toString(16)).slice(-2);return r+=">"},a=function(e){var t=new RegExp(/^([0-9A-Fa-f]{2})+$/);if(e=e.replace(/\s/g,""),-1!==e.indexOf(">")&&(e=e.substr(0,e.indexOf(">"))),e.length%2&&(e+="0"),!1===t.test(e))return"";for(var r,n="",r=0;r<e.length;r+=2)n+=String.fromCharCode("0x"+(e[r]+e[r+1]));return n},i=function(t,r){r=Object.assign({predictor:1,colors:1,bitsPerComponent:8,columns:1},r);for(var n,a,i=[],s=t.length;s--;)i[s]=t.charCodeAt(s);return n=e.adler32cs.from(t),a=new Deflater(6),a.append(new Uint8Array(i)),t=a.flush(),i=new Uint8Array(t.length+6),i.set(new Uint8Array([120,156])),i.set(t,2),i.set(new Uint8Array([255&n,n>>8&255,n>>16&255,n>>24&255]),t.length+2),t=String.fromCharCode.apply(null,i)};e.processDataByFilters=function(e,s){var o=0,c=e||"",l=[];for(s=s||[],"string"==typeof s&&(s=[s]),o=0;o<s.length;o+=1)switch(s[o]){case"ASCII85Decode":case"/ASCII85Decode":c=r(c),l.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":c=t(c),l.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":c=a(c),l.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":c=n(c),l.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":c=i(c),l.push("/FlateDecode");break;default:throw'The filter: "'+s[o]+'" is not implemented'}return{data:c,reverseChain:l.reverse().join(" ")}}}(c.API),function(e){e.loadFile=function(e,t,r){t=t||!0,r=r||function(){};var n;try{n=function(e,t,r){var n=new XMLHttpRequest,a=[],i=0,s=function(e){var t=e.length,r=String.fromCharCode;for(i=0;i<t;i+=1)a.push(r(255&e.charCodeAt(i)));return a.join("")};return n.open("GET",e,!t),n.overrideMimeType("text/plain; charset=x-user-defined"),!1===t&&(n.onload=function(){return s(this.responseText)}),n.send(null),200!==n.status?void console.warn('Unable to load file "'+e+'"'):t?s(n.responseText):void 0}(e,t)}catch(e){n=void 0}return n},e.loadImageFile=e.loadFile}(c.API),function(e,t){var r=function(e){var t=n(e);return"undefined"===t?"undefined":"string"===t||e instanceof String?"string":"number"===t||e instanceof Number?"number":"function"===t||e instanceof Function?"function":e&&e.constructor===Array?"array":e&&1===e.nodeType?"element":"object"===t?"object":"unknown"},a=function(e,t){var r=document.createElement(e);if(t.className&&(r.className=t.className),t.innerHTML){r.innerHTML=t.innerHTML;for(var n=r.getElementsByTagName("script"),a=n.length;a-- >0;null)n[a].parentNode.removeChild(n[a])}for(var i in t.style)r.style[i]=t.style[i];return r},i=function e(t,r){for(var n=3===t.nodeType?document.createTextNode(t.nodeValue):t.cloneNode(!1),a=t.firstChild;a;a=a.nextSibling)!0!==r&&1===a.nodeType&&"SCRIPT"===a.nodeName||n.appendChild(e(a,r));return 1===t.nodeType&&("CANVAS"===t.nodeName?(n.width=t.width,n.height=t.height,n.getContext("2d").drawImage(t,0,0)):"TEXTAREA"!==t.nodeName&&"SELECT"!==t.nodeName||(n.value=t.value),n.addEventListener("load",function(){n.scrollTop=t.scrollTop,n.scrollLeft=t.scrollLeft},!0)),n},s=function e(t){var r=Object.assign(e.convert(Promise.resolve()),JSON.parse(JSON.stringify(e.template))),n=e.convert(Promise.resolve(),r);return n=n.setProgress(1,e,1,[e]),n=n.set(t)};s.prototype=Object.create(Promise.prototype),s.prototype.constructor=s,s.convert=function(e,t){return e.__proto__=t||s.prototype,e},s.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{}}},s.prototype.from=function(e,t){function n(e){switch(r(e)){case"string":return"string";case"element":return"canvas"===e.nodeName.toLowerCase?"canvas":"element";default:return"unknown"}}return this.then(function(){switch(t=t||n(e)){case"string":return this.set({src:a("div",{innerHTML:e})});case"element":return this.set({src:e});case"canvas":return this.set({canvas:e});case"img":return this.set({img:e});default:return this.error("Unknown source type.")}})},s.prototype.to=function(e){switch(e){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},s.prototype.toContainer=function(){var e=[function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}];return this.thenList(e).then(function(){var e={position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0},t={position:"relative",display:"inline-block",width:Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:"white"},r=i(this.prop.src,this.opt.html2canvas.javascriptEnabled);"BODY"===r.tagName&&(t.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=a("div",{className:"html2pdf__overlay",style:e}),this.prop.container=a("div",{className:"html2pdf__container",style:t}),this.prop.container.appendChild(r),this.prop.container.firstChild.appendChild(a("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},s.prototype.toCanvas=function(){var e=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(e).then(function(){var e=Object.assign({},this.opt.html2canvas);if(delete e.onrendered,this.isHtml2CanvasLoaded())return html2canvas(this.prop.container,e)}).then(function(e){(this.opt.html2canvas.onrendered||function(){})(e),this.prop.canvas=e,document.body.removeChild(this.prop.overlay)})},s.prototype.toContext2d=function(){var e=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(e).then(function(){var e=this.opt.jsPDF,t=Object.assign({async:!0,allowTaint:!0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete t.onrendered,e.context2d.autoPaging=!0,e.context2d.posX=this.opt.x,e.context2d.posY=this.opt.y,t.windowHeight=t.windowHeight||0,t.windowHeight=0==t.windowHeight?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):t.windowHeight,this.isHtml2CanvasLoaded())return html2canvas(this.prop.container,t)}).then(function(e){(this.opt.html2canvas.onrendered||function(){})(e),this.prop.canvas=e,document.body.removeChild(this.prop.overlay)})},s.prototype.toImg=function(){var e=[function(){return this.prop.canvas||this.toCanvas()}];return this.thenList(e).then(function(){var e=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=e})},s.prototype.toPdf=function(){var e=[function(){return this.toContext2d()}];return this.thenList(e).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},s.prototype.output=function(e,t,r){return r=r||"pdf","img"===r.toLowerCase()||"image"===r.toLowerCase()?this.outputImg(e,t):this.outputPdf(e,t)},s.prototype.outputPdf=function(e,t){var r=[function(){return this.prop.pdf||this.toPdf()}];return this.thenList(r).then(function(){return this.prop.pdf.output(e,t)})},s.prototype.outputImg=function(e,t){var r=[function(){return this.prop.img||this.toImg()}];return this.thenList(r).then(function(){switch(e){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+e+'" is not supported.'}})},s.prototype.isHtml2CanvasLoaded=function(){var e=void 0!==t.html2canvas;return e||console.error("html2canvas not loaded."),e},s.prototype.save=function(e){var t=[function(){return this.prop.pdf||this.toPdf()}];if(this.isHtml2CanvasLoaded())return this.thenList(t).set(e?{filename:e}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},s.prototype.doCallback=function(e){var t=[function(){return this.prop.pdf||this.toPdf()}];if(this.isHtml2CanvasLoaded())return this.thenList(t).then(function(){this.prop.callback(this.prop.pdf)})},s.prototype.set=function(e){if("object"!==r(e))return this;var t=Object.keys(e||{}).map(function(t){if(t in s.template.prop)return function(){this.prop[t]=e[t]};switch(t){case"margin":return this.setMargin.bind(this,e.margin);case"jsPDF":return function(){return this.opt.jsPDF=e.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,e.pageSize);default:return function(){this.opt[t]=e[t]}}},this);return this.then(function(){return this.thenList(t)})},s.prototype.get=function(e,t){return this.then(function(){var r=e in s.template.prop?this.prop[e]:this.opt[e];return t?t(r):r})},s.prototype.setMargin=function(e){return this.then(function(){switch(r(e)){case"number":e=[e,e,e,e];case"array":if(2===e.length&&(e=[e[0],e[1],e[0],e[1]]),4===e.length)break;default:return this.error("Invalid margin array.")}this.opt.margin=e}).then(this.setPageSize)},s.prototype.setPageSize=function(e){function t(e,t){return Math.floor(e*t/72*96)}return this.then(function(){e=e||c.getPageSize(this.opt.jsPDF),e.hasOwnProperty("inner")||(e.inner={width:e.width-this.opt.margin[1]-this.opt.margin[3],height:e.height-this.opt.margin[0]-this.opt.margin[2]},e.inner.px={width:t(e.inner.width,e.k),height:t(e.inner.height,e.k)},e.inner.ratio=e.inner.height/e.inner.width),this.prop.pageSize=e})},s.prototype.setProgress=function(e,t,r,n){return null!=e&&(this.progress.val=e),null!=t&&(this.progress.state=t),null!=r&&(this.progress.n=r),null!=n&&(this.progress.stack=n),this.progress.ratio=this.progress.val/this.progress.state,this},s.prototype.updateProgress=function(e,t,r,n){return this.setProgress(e?this.progress.val+e:null,t||null,r?this.progress.n+r:null,n?this.progress.stack.concat(n):null)},s.prototype.then=function(e,t){var r=this;return this.thenCore(e,t,function(e,t){return r.updateProgress(null,null,1,[e]),Promise.prototype.then.call(this,function(t){return r.updateProgress(null,e),t}).then(e,t).then(function(e){return r.updateProgress(1),e})})},s.prototype.thenCore=function(e,t,r){r=r||Promise.prototype.then;var n=this;e&&(e=e.bind(n)),t&&(t=t.bind(n));var a=-1!==Promise.toString().indexOf("[native code]")&&"Promise"===Promise.name,i=a?n:s.convert(Object.assign({},n),Promise.prototype),o=r.call(i,e,t);return s.convert(o,n.__proto__)},s.prototype.thenExternal=function(e,t){return Promise.prototype.then.call(this,e,t)},s.prototype.thenList=function(e){var t=this;return e.forEach(function(e){t=t.thenCore(e)}),t},s.prototype.catch=function(e){e&&(e=e.bind(this));var t=Promise.prototype.catch.call(this,e);return s.convert(t,this)},s.prototype.catchExternal=function(e){return Promise.prototype.catch.call(this,e)},s.prototype.error=function(e){return this.then(function(){throw new Error(e)})},s.prototype.using=s.prototype.set,s.prototype.saveAs=s.prototype.save,s.prototype.export=s.prototype.output,s.prototype.run=s.prototype.then,c.getPageSize=function(e,t,r){if("object"===n(e)){var a=e;e=a.orientation,t=a.unit||t,r=a.format||r}t=t||"mm",r=r||"a4",e=(""+(e||"P")).toLowerCase();var i=(""+r).toLowerCase(),s={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(t){case"pt":var o=1;break;case"mm":var o=72/25.4;break;case"cm":var o=72/2.54;break;case"in":var o=72;break;case"px":var o=.75;break;case"pc":case"em":var o=12;break;case"ex":var o=6;break;default:throw"Invalid unit: "+t}if(s.hasOwnProperty(i))var c=s[i][1]/o,l=s[i][0]/o;else try{var c=r[1],l=r[0]}catch(e){throw new Error("Invalid format: "+r)}if("p"===e||"portrait"===e){if(e="p",l>c){var u=l;l=c,c=u}}else{if("l"!==e&&"landscape"!==e)throw"Invalid orientation: "+e;if(e="l",c>l){var u=l;l=c,c=u}}return{width:l,height:c,unit:t,k:o}},e.html=function(e,t){t=t||{},t.callback=t.callback||function(){},t.html2canvas=t.html2canvas||{},t.html2canvas.canvas=t.html2canvas.canvas||this.canvas,t.jsPDF=t.jsPDF||this;var r=(t.jsPDF,new s(t));return t.worker?r:r.from(e).doCallback()}}(c.API,"undefined"!=typeof window&&window||"undefined"!=typeof global&&global),function(e){var t,r,n;e.addJS=function(e){return n=e,this.internal.events.subscribe("postPutResources",function(e){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(t+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),r=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+n+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){void 0!==t&&void 0!==r&&this.internal.out("/Names <</JavaScript "+t+" 0 R>>")}),this}}(c.API),function(e){e.events.push(["postPutResources",function(){var e=this,t=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var r=e.outline.render().split(/\r\n/),n=0;n<r.length;n++){var a=r[n],i=t.exec(a);if(null!=i){var s=i[1];e.internal.newObjectDeferredBegin(s,!1)}e.internal.write(a)}if(this.outline.createNamedDestinations){for(var o=this.internal.pages.length,c=[],n=0;n<o;n++){var l=e.internal.newObject();c.push(l);var u=e.internal.getPageInfo(n+1);e.internal.write("<< /D["+u.objId+" 0 R /XYZ null null null]>> endobj")}var f=e.internal.newObject();e.internal.write("<< /Names [ ");for(var n=0;n<c.length;n++)e.internal.write("(page_"+(n+1)+")"+c[n]+" 0 R");e.internal.write(" ] >>","endobj");e.internal.newObject();e.internal.write("<< /Dests "+f+" 0 R"),e.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){var e=this;e.outline.root.children.length>0&&(e.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&e.internal.write("/Names "+namesOid+" 0 R"))}]),e.events.push(["initialized",function(){var e=this;e.outline={createNamedDestinations:!1,root:{children:[]}},e.outline.add=function(e,t,r){var n={title:t,options:r,children:[]};return null==e&&(e=this.root),e.children.push(n),n},e.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=e,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},e.outline.genIds_r=function(t){t.id=e.internal.newObjectDeferred();for(var r=0;r<t.children.length;r++)this.genIds_r(t.children[r])},e.outline.renderRoot=function(e){this.objStart(e),this.line("/Type /Outlines"),e.children.length>0&&(this.line("/First "+this.makeRef(e.children[0])),this.line("/Last "+this.makeRef(e.children[e.children.length-1]))),this.line("/Count "+this.count_r({count:0},e)),this.objEnd()},e.outline.renderItems=function(t){for(var r=(this.ctx.pdf.internal.getCoordinateString,this.ctx.pdf.internal.getVerticalCoordinateString),n=0;n<t.children.length;n++){var a=t.children[n];this.objStart(a),this.line("/Title "+this.makeString(a.title)),this.line("/Parent "+this.makeRef(t)),n>0&&this.line("/Prev "+this.makeRef(t.children[n-1])),n<t.children.length-1&&this.line("/Next "+this.makeRef(t.children[n+1])),a.children.length>0&&(this.line("/First "+this.makeRef(a.children[0])),this.line("/Last "+this.makeRef(a.children[a.children.length-1])));var i=this.count=this.count_r({count:0},a);if(i>0&&this.line("/Count "+i),a.options&&a.options.pageNumber){var s=e.internal.getPageInfo(a.options.pageNumber);this.line("/Dest ["+s.objId+" 0 R /XYZ 0 "+r(0)+" 0]")}this.objEnd()}for(var n=0;n<t.children.length;n++){var a=t.children[n];this.renderItems(a)}},e.outline.line=function(e){this.ctx.val+=e+"\r\n"},e.outline.makeRef=function(e){return e.id+" 0 R"},e.outline.makeString=function(t){return"("+e.internal.pdfEscape(t)+")"},e.outline.objStart=function(e){this.ctx.val+="\r\n"+e.id+" 0 obj\r\n<<\r\n"},e.outline.objEnd=function(e){this.ctx.val+=">> \r\nendobj\r\n"},e.outline.count_r=function(e,t){for(var r=0;r<t.children.length;r++)e.count++,this.count_r(e,t.children[r]);return e.count}}])}(c.API),function(e){var t=function(){return"function"!=typeof PNG||"function"!=typeof u},r=function(t){return t!==e.image_compression.NONE&&n()},n=function(){var e="function"==typeof Deflater;if(!e)throw new Error("requires deflate.js for compression");return e},a=function(t,r,n,a){var c=5,u=f;switch(a){case e.image_compression.FAST:c=3,u=l;break;case e.image_compression.MEDIUM:c=6,u=$;break;case e.image_compression.SLOW:c=9,u=p}t=o(t,r,n,u);var d=new Uint8Array(i(c)),h=s(t),_=new Deflater(c),m=_.append(t),y=_.flush(),g=d.length+m.length+y.length,v=new Uint8Array(g+4);return v.set(d),v.set(m,d.length),v.set(y,d.length+m.length),v[g++]=h>>>24&255,v[g++]=h>>>16&255,v[g++]=h>>>8&255,v[g++]=255&h,e.arrayBufferToBinaryString(v)},i=function(e,t){var r=Math.LOG2E*Math.log(32768)-8,n=r<<4|8,a=n<<8;return a|=Math.min(3,(t-1&255)>>1)<<6,a|=0,a+=31-a%31,[n,255&a]},s=function(e,t){for(var r,n=1,a=0,i=e.length,s=0;i>0;){r=i>t?t:i,i-=r;do{n+=e[s++],a+=n}while(--r);n%=65521,a%=65521}return(a<<16|n)>>>0},o=function(e,t,r,n){for(var a,i,s,o=e.length/t,c=new Uint8Array(e.length+o),l=h(),u=0;u<o;u++){if(s=u*t,a=e.subarray(s,s+t),n)c.set(n(a,r,i),s+u);else{for(var f=0,$=l.length,p=[];f<$;f++)p[f]=l[f](a,r,i);var d=_(p.concat());c.set(p[d],s+u)}i=a}return c},c=function(e,t,r){var n=Array.apply([],e);return n.unshift(0),n},l=function(e,t,r){var n,a=[],i=0,s=e.length;for(a[0]=1;i<s;i++)n=e[i-t]||0,a[i+1]=e[i]-n+256&255;return a},f=function(e,t,r){var n,a=[],i=0,s=e.length;for(a[0]=2;i<s;i++)n=r&&r[i]||0,a[i+1]=e[i]-n+256&255;return a},$=function(e,t,r){var n,a,i=[],s=0,o=e.length;for(i[0]=3;s<o;s++)n=e[s-t]||0,a=r&&r[s]||0,i[s+1]=e[s]+256-(n+a>>>1)&255;return i},p=function(e,t,r){var n,a,i,s,o=[],c=0,l=e.length;for(o[0]=4;c<l;c++)n=e[c-t]||0,a=r&&r[c]||0,i=r&&r[c-t]||0,s=d(n,a,i),o[c+1]=e[c]-s+256&255;return o},d=function(e,t,r){var n=e+t-r,a=Math.abs(n-e),i=Math.abs(n-t),s=Math.abs(n-r);return a<=i&&a<=s?e:i<=s?t:r},h=function(){return[c,l,f,$,p]},_=function(e){for(var t,r,n,a=0,i=e.length;a<i;)t=m(e[a].slice(1)),(t<r||!r)&&(r=t,n=a),a++;return n},m=function(e){for(var t=0,r=e.length,n=0;t<r;)n+=Math.abs(e[t++]);return n},y=function(t){var r;switch(t){case e.image_compression.FAST:r=11;break;case e.image_compression.MEDIUM:r=13;break;case e.image_compression.SLOW:r=14;break;default:r=12}return r};e.processPNG=function(e,n,i,s,o){var c,l,u,f,$,p,d=this.color_spaces.DEVICE_RGB,h=this.decode.FLATE_DECODE,_=8;if(this.isArrayBuffer(e)&&(e=new Uint8Array(e)),this.isArrayBufferView(e)){if(t())throw new Error("PNG support requires png.js and zlib.js");if(c=new PNG(e),e=c.imgData,_=c.bits,d=c.colorSpace,f=c.colors,-1!==[4,6].indexOf(c.colorType)){if(8===c.bits)for(var m,g,v=32==c.pixelBitlength?new Uint32Array(c.decodePixels().buffer):16==c.pixelBitlength?new Uint16Array(c.decodePixels().buffer):new Uint8Array(c.decodePixels().buffer),b=v.length,x=new Uint8Array(b*c.colors),w=new Uint8Array(b),A=c.pixelBitlength-c.bits,k=0,E=0;k<b;k++){for(m=v[k],g=0;g<A;)x[E++]=m>>>g&255,g+=c.bits;w[k]=m>>>g&255}if(16===c.bits){for(var m,v=new Uint32Array(c.decodePixels().buffer),b=v.length,x=new Uint8Array(b*(32/c.pixelBitlength)*c.colors),w=new Uint8Array(b*(32/c.pixelBitlength)),S=c.colors>1,k=0,E=0,N=0;k<b;)m=v[k++],x[E++]=m>>>0&255,S&&(x[E++]=m>>>16&255,m=v[k++],x[E++]=m>>>0&255),w[N++]=m>>>16&255;_=8}r(s)?(e=a(x,c.width*c.colors,c.colors,s),p=a(w,c.width,1,s)):(e=x,p=w,h=null)}if(3===c.colorType&&(d=this.color_spaces.INDEXED,$=c.palette,c.transparency.indexed)){for(var C=c.transparency.indexed,I=0,k=0,b=C.length;k<b;++k)I+=C[k];if((I/=255)===b-1&&-1!==C.indexOf(0))u=[C.indexOf(0)];else if(I!==b){for(var v=c.decodePixels(),w=new Uint8Array(v.length),k=0,b=v.length;k<b;k++)w[k]=C[v[k]];p=a(w,c.width,1)}}var O=y(s);return l=h===this.decode.FLATE_DECODE?"/Predictor "+O+" /Colors "+f+" /BitsPerComponent "+_+" /Columns "+c.width:"/Colors "+f+" /BitsPerComponent "+_+" /Columns "+c.width,(this.isArrayBuffer(e)||this.isArrayBufferView(e))&&(e=this.arrayBufferToBinaryString(e)),(p&&this.isArrayBuffer(p)||this.isArrayBufferView(p))&&(p=this.arrayBufferToBinaryString(p)),this.createImageInfo(e,c.width,c.height,d,_,h,n,i,l,u,$,p,O)}throw new Error("Unsupported PNG image data, try using JPEG instead.")}}(c.API),function(e){e.processGIF89A=function(t,r,n,i,s){var o=new GifReader(t),c=o.width,l=o.height,u=[];o.decodeAndBlitFrameRGBA(0,u);var f={data:u,width:c,height:l},$=new a(100),p=$.encode(f,100);return e.processJPEG.call(this,p,r,n,i)},e.processGIF87A=e.processGIF89A}(c.API),function(e){e.processBMP=function(t,r,n,s,o){var c=new i(t,!1),l=c.width,u=c.height,f=c.getData(),$={data:f,width:l,height:u},p=new a(100),d=p.encode($,100);return e.processJPEG.call(this,d,r,n,s)}}(c.API),function(e){e.setLanguage=function(e){var t={af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"FYRO Macedonian",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"};return void 0===this.internal.languageSettings&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),void 0!==t[e]&&(this.internal.languageSettings.languageCode=e,!1===this.internal.languageSettings.isSubscribed&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this}}(c.API),function(e){var t=e.getCharWidthsArray=function(e,t){t=t||{};var r,n,a,i=t.font||this.internal.getFont(),s=t.fontSize||this.internal.getFontSize(),o=t.charSpace||this.internal.getCharSpace(),c=t.widths?t.widths:i.metadata.Unicode.widths,l=c.fof?c.fof:1,u=t.kerning?t.kerning:i.metadata.Unicode.kerning,f=u.fof?u.fof:1,$=0,p=c[0]||l,d=[];for(r=0,n=e.length;r<n;r++)a=e.charCodeAt(r),"function"==typeof i.metadata.widthOfString?d.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(a))+o*(1e3/s)||0)/1e3):d.push((c[a]||p)/l+(u[a]&&u[a][$]||0)/f),$=a;return d},r=e.getArraySum=function(e){for(var t=e.length,r=0;t;)t--,r+=e[t];return r},n=e.getStringUnitWidth=function(e,n){n=n||{};var a=n.fontSize||this.internal.getFontSize(),i=n.font||this.internal.getFont(),s=n.charSpace||this.internal.getCharSpace();return"function"==typeof i.metadata.widthOfString?i.metadata.widthOfString(e,a,s)/a:r(t.apply(this,arguments))},a=function(e,t,r,n){for(var a=[],i=0,s=e.length,o=0;i!==s&&o+t[i]<r;)o+=t[i],i++;a.push(e.slice(0,i));var c=i;for(o=0;i!==s;)o+t[i]>n&&(a.push(e.slice(c,i)),o=0,c=i),o+=t[i],i++;return c!==i&&a.push(e.slice(c,i)),a},i=function(e,i,s){s||(s={});var o,c,l,u,f,$,p=[],d=[p],h=s.textIndent||0,_=0,m=0,y=e.split(" "),g=t.apply(this,[" ",s])[0];if($=-1===s.lineIndent?y[0].length+2:s.lineIndent||0){var v=Array($).join(" "),b=[];y.map(function(e){e=e.split(/\s*\n/),e.length>1?b=b.concat(e.map(function(e,t){return(t&&e.length?"\n":"")+e})):b.push(e[0])}),y=b,$=n.apply(this,[v,s])}for(l=0,u=y.length;l<u;l++){var x=0;if(o=y[l],$&&"\n"==o[0]&&(o=o.substr(1),x=1),c=t.apply(this,[o,s]),m=r(c),h+_+m>i||x){if(m>i){for(f=a.apply(this,[o,c,i-(h+_),i]),p.push(f.shift()),p=[f.pop()];f.length;)d.push([f.shift()]);m=r(c.slice(o.length-(p[0]?p[0].length:0)))}else p=[o];d.push(p),h=m+$,_=g}else p.push(o),h+=_+m,_=g}if($)var w=function(e,t){return(t?v:"")+e.join(" ")};else var w=function(e){return e.join(" ")};return d.map(w)};e.splitTextToSize=function(e,t,r){r=r||{};var n,a=r.fontSize||this.internal.getFontSize(),s=function(e){var t={0:1},r={};if(e.widths&&e.kerning)return{widths:e.widths,kerning:e.kerning};var n=this.internal.getFont(e.fontName,e.fontStyle);return n.metadata.Unicode?{widths:n.metadata.Unicode.widths||t,kerning:n.metadata.Unicode.kerning||r}:{font:n.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}.call(this,r);n=Array.isArray(e)?e:e.split(/\r?\n/);var o=1*this.internal.scaleFactor*t/a
;s.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/a:0,s.lineIndent=r.lineIndent;var c,l,u=[];for(c=0,l=n.length;c<l;c++)u=u.concat(i.apply(this,[n[c],o,s]));return u}}(c.API),function(e){var t=function(e){for(var t={},r=0;r<"klmnopqrstuvwxyz".length;r++)t["klmnopqrstuvwxyz"[r]]="0123456789abcdef"[r];var n,a,i,s,o={},c=1,l=o,u=[],f="",$="",p=e.length-1;for(r=1;r!=p;)s=e[r],r+=1,"'"==s?n?(i=n.join(""),n=void 0):n=[]:n?n.push(s):"{"==s?(u.push([l,i]),l={},i=void 0):"}"==s?(a=u.pop(),a[0][a[1]]=l,i=void 0,l=a[0]):"-"==s?c=-1:void 0===i?t.hasOwnProperty(s)?(f+=t[s],i=parseInt(f,16)*c,c=1,f=""):f+=s:t.hasOwnProperty(s)?($+=t[s],l[i]=parseInt($,16)*c,c=1,i=void 0,$=""):$+=s;return o},r={codePages:["WinAnsiEncoding"],WinAnsiEncoding:t("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},n={Unicode:{Courier:r,"Courier-Bold":r,"Courier-BoldOblique":r,"Courier-Oblique":r,Helvetica:r,"Helvetica-Bold":r,"Helvetica-BoldOblique":r,"Helvetica-Oblique":r,"Times-Roman":r,"Times-Bold":r,"Times-BoldItalic":r,"Times-Italic":r}},a={Unicode:{"Courier-Oblique":t("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":t("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":t("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:t("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":t("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":t("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:t("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:t("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":t("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:t("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":t("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":t("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":t("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":t("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(e){var t,r,i,s=e.font;t=a.Unicode[s.postScriptName],t&&(r=s.metadata.Unicode?s.metadata.Unicode:s.metadata.Unicode={},r.widths=t.widths,r.kerning=t.kerning),(i=n.Unicode[s.postScriptName])&&(r=s.metadata.Unicode?s.metadata.Unicode:s.metadata.Unicode={},r.encoding=i,i.codePages&&i.codePages.length&&(s.encoding=i.codePages[0]))}])}(c.API),function(e,t){e.API.events.push(["addFont",function(t){var r=t.font,n=t.instance;if(void 0!==n&&n.existsFileInVFS(r.postScriptName))r.metadata=e.API.TTFFont.open(r.postScriptName,r.fontName,n.getFileFromVFS(r.postScriptName),r.encoding),r.metadata.Unicode=r.metadata.Unicode||{encoding:{},kerning:{},widths:[]},r.metadata.glyIdsUsed=[0];else if(!1===r.isStandardFont)throw new Error("Font does not exist in FileInVFS, import fonts or remove declaration doc.addFont('"+r.postScriptName+"').")}])}(c,"undefined"!=typeof self&&self||"undefined"!=typeof global&&global||"undefined"!=typeof window&&window||Function("return this")()),function(e){e.addSvg=function(e,t,r,n,a){function i(e,t){var r=t.createElement("style");r.type="text/css",r.styleSheet?r.styleSheet.cssText=e:r.appendChild(t.createTextNode(e)),t.getElementsByTagName("head")[0].appendChild(r)}if(void 0===t||void 0===r)throw new Error("addSVG needs values for 'x' and 'y'");var s=function(e){var t=e.createElement("iframe");return i(".jsPDF_sillysvg_iframe {display:none;position:absolute;}",e),t.name="childframe",t.setAttribute("width",0),t.setAttribute("height",0),t.setAttribute("frameborder","0"),t.setAttribute("scrolling","no"),t.setAttribute("seamless","seamless"),t.setAttribute("class","jsPDF_sillysvg_iframe"),e.body.appendChild(t),t}(document),o=function(e,t){var r=(t.contentWindow||t.contentDocument).document;return r.write(e),r.close(),r.getElementsByTagName("svg")[0]}(e,s),c=[1,1],l=parseFloat(o.getAttribute("width")),u=parseFloat(o.getAttribute("height"));l&&u&&(n&&a?c=[n/l,a/u]:n?c=[n/l,n/l]:a&&(c=[a/u,a/u]));var f,$,p,d,h=o.childNodes;for(f=0,$=h.length;f<$;f++)p=h[f],p.tagName&&"PATH"===p.tagName.toUpperCase()&&(d=function(e){for(var t=parseFloat(e[1]),r=parseFloat(e[2]),n=[],a=3,i=e.length;a<i;)"c"===e[a]?(n.push([parseFloat(e[a+1]),parseFloat(e[a+2]),parseFloat(e[a+3]),parseFloat(e[a+4]),parseFloat(e[a+5]),parseFloat(e[a+6])]),a+=7):"l"===e[a]?(n.push([parseFloat(e[a+1]),parseFloat(e[a+2])]),a+=3):a+=1;return[t,r,n]}(p.getAttribute("d").split(" ")),d[0]=d[0]*c[0]+t,d[1]=d[1]*c[1]+r,this.lines.call(this,d[2],d[0],d[1],c));return this},e.addSVG=e.addSvg,e.addSvgAsImage=function(e,t,r,n,a,i,s,o){if(isNaN(t)||isNaN(r))throw console.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(a))throw console.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=n,c.height=a;var l=c.getContext("2d");return l.fillStyle="#fff",l.fillRect(0,0,c.width,c.height),canvg(c,e,{ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0}),this.addImage(c.toDataURL("image/jpeg",1),t,r,n,a,s,o),this}}(c.API),function(e){e.putTotalPages=function(e){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var a=0;a<this.internal.pages[n].length;a++)this.internal.pages[n][a]=this.internal.pages[n][a].replace(t,r);return this}}(c.API),function(e){e.viewerPreferences=function(e,t){function r(e,t){var r,n=!1;for(r=0;r<e.length;r+=1)e[r]===t&&(n=!0);return n}e=e||{},t=t||!1;var a,i,s,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},c=Object.keys(o),l=[],u=0,f=0,$=0,p=!0;if(void 0===this.internal.viewerpreferences&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),a=this.internal.viewerpreferences.configuration,"reset"===e||!0===t){var d=c.length;for($=0;$<d;$+=1)a[c[$]].value=a[c[$]].defaultValue,a[c[$]].explicitSet=!1}if("object"===n(e))for(i in e)if(s=e[i],r(c,i)&&void 0!==s){if("boolean"===a[i].type&&"boolean"==typeof s)a[i].value=s;else if("name"===a[i].type&&r(a[i].valueSet,s))a[i].value=s;else if("integer"===a[i].type&&Number.isInteger(s))a[i].value=s;else if("array"===a[i].type){for(u=0;u<s.length;u+=1)if(p=!0,1===s[u].length&&"number"==typeof s[u][0])l.push(String(s[u]-1));else if(s[u].length>1){for(f=0;f<s[u].length;f+=1)"number"!=typeof s[u][f]&&(p=!1);!0===p&&l.push([s[u][0]-1,s[u][1]-1].join(" "))}a[i].value="["+l.join(" ")+"]"}else a[i].value=a[i].defaultValue;a[i].explicitSet=!0}return!1===this.internal.viewerpreferences.isSubscribed&&(this.internal.events.subscribe("putCatalog",function(){var e,t=[];for(e in a)!0===a[e].explicitSet&&("name"===a[e].type?t.push("/"+e+" /"+a[e].value):t.push("/"+e+" "+a[e].value));0!==t.length&&this.internal.write("/ViewerPreferences\n<<\n"+t.join("\n")+"\n>>")}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=a,this}}(c.API),function(e){var t="",r="",n="";e.addMetadata=function(e,a){return r=a||"http://jspdf.default.namespaceuri/",t=e,this.internal.events.subscribe("postPutResources",function(){if(t){var e='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+r+'"><jspdf:metadata>',a=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),i=unescape(encodeURIComponent(e)),s=unescape(encodeURIComponent(t)),o=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),l=i.length+s.length+o.length+a.length+c.length;n=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+l+" >>"),this.internal.write("stream"),this.internal.write(a+i+s+o+c),this.internal.write("endstream"),this.internal.write("endobj")}else n=""}),this.internal.events.subscribe("putCatalog",function(){n&&this.internal.write("/Metadata "+n+" 0 R")}),this}}(c.API),function(e,t){function r(e){for(var t="",r=0;r<e.length;r++)t+=""+e.charCodeAt(r).toString(16);return t}var n=e.API,a=n.pdfEscape16=function(e,t){for(var r,n=t.metadata.Unicode.widths,a=["","0","00","000","0000"],i=[""],s=0,o=e.length;s<o;++s){if(r=t.metadata.characterToGlyph(e.charCodeAt(s)),t.metadata.glyIdsUsed.push(r),t.metadata.toUnicode[r]=e.charCodeAt(s),-1==n.indexOf(r)&&(n.push(r),n.push([parseInt(t.metadata.widthOfGlyph(r),10)])),"0"==r)return i.join("");r=r.toString(16),i.push(a[4-r.length],r)}return i.join("")},i=function(e){var t,r,n,a,i,s,o;for(i="/CIDInit /ProcSet findresource begin\n12 dict begin\nbegincmap\n/CIDSystemInfo <<\n  /Registry (Adobe)\n  /Ordering (UCS)\n  /Supplement 0\n>> def\n/CMapName /Adobe-Identity-UCS def\n/CMapType 2 def\n1 begincodespacerange\n<0000><ffff>\nendcodespacerange",r=Object.keys(e).sort(function(e,t){return e-t}),n=[],s=0,o=r.length;s<o;s++)t=r[s],n.length>=100&&(i+="\n"+n.length+" beginbfchar\n"+n.join("\n")+"\nendbfchar",n=[]),a=("0000"+e[t].toString(16)).slice(-4),t=("0000"+(+t).toString(16)).slice(-4),n.push("<"+t+"><"+a+">");return n.length&&(i+="\n"+n.length+" beginbfchar\n"+n.join("\n")+"\nendbfchar\n"),i+="endcmap\nCMapName currentdict /CMap defineresource pop\nend\nend"},s=function(t,r,n,a){if(t.metadata instanceof e.API.TTFFont&&"Identity-H"===t.encoding){for(var s=t.metadata.Unicode.widths,o=t.metadata.subset.encode(t.metadata.glyIdsUsed,1),c=o,l="",u=0;u<c.length;u++)l+=String.fromCharCode(c[u]);var f=n();a({data:l,addLength1:!0}),r("endobj");var $=n();a({data:i(t.metadata.toUnicode),addLength1:!0}),r("endobj");var p=n();r("<<"),r("/Type /FontDescriptor"),r("/FontName /"+t.fontName),r("/FontFile2 "+f+" 0 R"),r("/FontBBox "+e.API.PDFObject.convert(t.metadata.bbox)),r("/Flags "+t.metadata.flags),r("/StemV "+t.metadata.stemV),r("/ItalicAngle "+t.metadata.italicAngle),r("/Ascent "+t.metadata.ascender),r("/Descent "+t.metadata.decender),r("/CapHeight "+t.metadata.capHeight),r(">>"),r("endobj");var d=n();r("<<"),r("/Type /Font"),r("/BaseFont /"+t.fontName),r("/FontDescriptor "+p+" 0 R"),r("/W "+e.API.PDFObject.convert(s)),r("/CIDToGIDMap /Identity"),r("/DW 1000"),r("/Subtype /CIDFontType2"),r("/CIDSystemInfo"),r("<<"),r("/Supplement 0"),r("/Registry (Adobe)"),r("/Ordering ("+t.encoding+")"),r(">>"),r(">>"),r("endobj"),t.objectNumber=n(),r("<<"),r("/Type /Font"),r("/Subtype /Type0"),r("/ToUnicode "+$+" 0 R"),r("/BaseFont /"+t.fontName),r("/Encoding /"+t.encoding),r("/DescendantFonts ["+d+" 0 R]"),r(">>"),r("endobj"),t.isAlreadyPutted=!0}};n.events.push(["putFont",function(e){s(e.font,e.out,e.newObject,e.putStream)}]);var o=function(t,r,n,a){if(t.metadata instanceof e.API.TTFFont&&"WinAnsiEncoding"===t.encoding){for(var s=(t.metadata.Unicode.widths,t.metadata.rawData),o=s,c="",l=0;l<o.length;l++)c+=String.fromCharCode(o[l]);var u=n();a({data:c,addLength1:!0}),r("endobj");var f=n();a({data:i(t.metadata.toUnicode),addLength1:!0}),r("endobj");var $=n();r("<<"),r("/Descent "+t.metadata.decender),r("/CapHeight "+t.metadata.capHeight),r("/StemV "+t.metadata.stemV),r("/Type /FontDescriptor"),r("/FontFile2 "+u+" 0 R"),r("/Flags 96"),r("/FontBBox "+e.API.PDFObject.convert(t.metadata.bbox)),r("/FontName /"+t.fontName),r("/ItalicAngle "+t.metadata.italicAngle),r("/Ascent "+t.metadata.ascender),r(">>"),r("endobj"),t.objectNumber=n();for(var l=0;l<t.metadata.hmtx.widths.length;l++)t.metadata.hmtx.widths[l]=parseInt(t.metadata.hmtx.widths[l]*(1e3/t.metadata.head.unitsPerEm));r("<</Subtype/TrueType/Type/Font/ToUnicode "+f+" 0 R/BaseFont/"+t.fontName+"/FontDescriptor "+$+" 0 R/Encoding/"+t.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(t.metadata.hmtx.widths)+">>"),r("endobj"),t.isAlreadyPutted=!0}};n.events.push(["putFont",function(e){o(e.font,e.out,e.newObject,e.putStream)}]);var c=function(e){var t,n,i=e.text||"",s=e.x,o=e.y,c=e.options||{},l=e.mutex||{},u=l.pdfEscape,f=l.activeFontKey,$=l.fonts,p=(l.activeFontSize,""),d=0,h="",t=f,_=$[t].encoding;if("Identity-H"!==$[t].encoding)return{text:i,x:s,y:o,options:c,mutex:l};for(h=i,t=f,"[object Array]"===Object.prototype.toString.call(i)&&(h=i[0]),d=0;d<h.length;d+=1)$[t].metadata.hasOwnProperty("cmap")&&(n=$[t].metadata.cmap.unicode.codeMap[h[d].charCodeAt(0)]),n?p+=h[d]:h[d].charCodeAt(0)<256&&$[t].metadata.hasOwnProperty("Unicode")?p+=h[d]:p+="";var m="";return parseInt(t.slice(1))<14||"WinAnsiEncoding"===_?m=r(u(p,t)):"Identity-H"===_&&(m=a(p,$[t])),l.isHex=!0,{text:m,x:s,y:o,options:c,mutex:l}},l=function(e){var t=e.text||"",r=e.x,n=e.y,a=e.options,i=e.mutex,s=(a.lang,[]),o={text:t,x:r,y:n,options:a,mutex:i};if("[object Array]"===Object.prototype.toString.call(t)){var l=0;for(l=0;l<t.length;l+=1)"[object Array]"===Object.prototype.toString.call(t[l])&&3===t[l].length?s.push([c(Object.assign({},o,{text:t[l][0]})).text,t[l][1],t[l][2]]):s.push(c(Object.assign({},o,{text:t[l]})).text);e.text=s}else e.text=c(Object.assign({},o,{text:t})).text};n.events.push(["postProcessText",l])}(c,"undefined"!=typeof self&&self||"undefined"!=typeof global&&global||"undefined"!=typeof window&&window||Function("return this")()),function(e){var t=function(e){return void 0!==e&&(void 0===e.vFS&&(e.vFS={}),!0)};e.existsFileInVFS=function(e){return!!t(this.internal)&&void 0!==this.internal.vFS[e]},e.addFileToVFS=function(e,r){return t(this.internal),this.internal.vFS[e]=r,this},e.getFileFromVFS=function(e){return t(this.internal),void 0!==this.internal.vFS[e]?this.internal.vFS[e]:null}}(c.API),function(e,t){e.API.adler32cs=function(){var e="function"==typeof ArrayBuffer&&"function"==typeof Uint8Array,t=null,r=function(){return e?function(e){return e instanceof ArrayBuffer||null!==t&&e instanceof t}:function(){return!1}}(),n=function(){return null!==t?function(e){return new t(e,"utf8").toString("binary")}:function(e){return unescape(encodeURIComponent(e))}}(),a=function(e,t){for(var r=65535&e,n=e>>>16,a=0,i=t.length;a<i;a++)r=(r+(255&t.charCodeAt(a)))%65521,n=(n+r)%65521;return(n<<16|r)>>>0},i=function(e,t){for(var r=65535&e,n=e>>>16,a=0,i=t.length;a<i;a++)r=(r+t[a])%65521,n=(n+r)%65521;return(n<<16|r)>>>0},s={},o=s.Adler32=function(){var t=function(e){if(!(this instanceof t))throw new TypeError("Constructor cannot called be as a function.");if(!isFinite(e=null==e?1:+e))throw new Error("First arguments needs to be a finite number.");this.checksum=e>>>0},s=t.prototype={};return s.constructor=t,t.from=function(e){return e.prototype=s,e}(function(e){if(!(this instanceof t))throw new TypeError("Constructor cannot called be as a function.");if(null==e)throw new Error("First argument needs to be a string.");this.checksum=a(1,e.toString())}),t.fromUtf8=function(e){return e.prototype=s,e}(function(e){if(!(this instanceof t))throw new TypeError("Constructor cannot called be as a function.");if(null==e)throw new Error("First argument needs to be a string.");var r=n(e.toString());this.checksum=a(1,r)}),e&&(t.fromBuffer=function(e){return e.prototype=s,e}(function(e){if(!(this instanceof t))throw new TypeError("Constructor cannot called be as a function.");if(!r(e))throw new Error("First argument needs to be ArrayBuffer.");var n=new Uint8Array(e);return this.checksum=i(1,n)})),s.update=function(e){if(null==e)throw new Error("First argument needs to be a string.");return e=e.toString(),this.checksum=a(this.checksum,e)},s.updateUtf8=function(e){if(null==e)throw new Error("First argument needs to be a string.");var t=n(e.toString());return this.checksum=a(this.checksum,t)},e&&(s.updateBuffer=function(e){if(!r(e))throw new Error("First argument needs to be ArrayBuffer.");var t=new Uint8Array(e);return this.checksum=i(this.checksum,t)}),s.clone=function(){return new o(this.checksum)},t}();return s.from=function(e){if(null==e)throw new Error("First argument needs to be a string.");return a(1,e.toString())
},s.fromUtf8=function(e){if(null==e)throw new Error("First argument needs to be a string.");var t=n(e.toString());return a(1,t)},e&&(s.fromBuffer=function(e){if(!r(e))throw new Error("First argument need to be ArrayBuffer.");var t=new Uint8Array(e);return i(1,t)}),s}()}(c),function(e){var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"];e.__bidiEngine__=e.prototype.__bidiEngine__=function(e){var t,n,a,i,s,o,c,l=r,u=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],f=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],$={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},p={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},d=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],h=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),_=!1,m=0;this.__bidiEngine__={};var y=function(e,t){if(t)for(var r=0;r<e.length;r++)t[r]=r;void 0===i&&(i=v(e)),void 0===o&&(o=v(e))},g=function(e){var t=e.charCodeAt(),r=t>>8,n=p[r];return void 0!==n?l[256*n+(255&t)]:252===r||253===r?"AL":h.test(r)?"L":8===r?"R":"N"},v=function(e){for(var t,r=0;r<e.length;r++){if("L"===(t=g(e.charAt(r))))return!1;if("R"===t)return!0}return!1},b=function(e,r,s,o){var c,l,u,f,$=r[o];switch($){case"L":case"R":_=!1;break;case"N":case"AN":break;case"EN":_&&($="AN");break;case"AL":_=!0,$="R";break;case"WS":$="N";break;case"CS":o<1||o+1>=r.length||"EN"!==(c=s[o-1])&&"AN"!==c||"EN"!==(l=r[o+1])&&"AN"!==l?$="N":_&&(l="AN"),$=l===c?l:"N";break;case"ES":c=o>0?s[o-1]:"B",$="EN"===c&&o+1<r.length&&"EN"===r[o+1]?"EN":"N";break;case"ET":if(o>0&&"EN"===s[o-1]){$="EN";break}if(_){$="N";break}for(u=o+1,f=r.length;u<f&&"ET"===r[u];)u++;$=u<f&&"EN"===r[u]?"EN":"N";break;case"NSM":if(a&&!i){for(f=r.length,u=o+1;u<f&&"NSM"===r[u];)u++;if(u<f){var p=e[o],d=p>=1425&&p<=2303||64286===p;if(c=r[u],d&&("R"===c||"AL"===c)){$="R";break}}}$=o<1||"B"===(c=r[o-1])?"N":s[o-1];break;case"B":_=!1,t=!0,$=m;break;case"S":n=!0,$="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":_=!1;break;case"BN":$="N"}return $},x=function(e,t,r){for(var n=0;n<r;n++)if("S"===e[n]){t[n]=m;for(var a=n-1;a>=0&&"WS"===e[a];a--)t[a]=m}},w=function(e,t,r){var n=e.split("");return r&&A(n,r,{hiLevel:m}),n.reverse(),t&&t.reverse(),n.join("")},A=function(e,r,a){var i,s,o,c,l,p=-1,d=e.length,h=0,y=[],v=m?f:u,w=[];for(_=!1,t=!1,n=!1,s=0;s<d;s++)w[s]=g(e[s]);for(o=0;o<d;o++){if(l=h,y[o]=b(e,w,y,o),h=v[l][$[y[o]]],i=240&h,h&=15,r[o]=c=v[h][5],i>0)if(16===i){for(s=p;s<o;s++)r[s]=1;p=-1}else p=-1;if(v[h][6])-1===p&&(p=o);else if(p>-1){for(s=p;s<o;s++)r[s]=c;p=-1}"B"===w[o]&&(r[o]=0),a.hiLevel|=c}n&&x(w,r,d)},k=function(e,r,n,a,i){if(!(i.hiLevel<e)){if(1===e&&1===m&&!t)return r.reverse(),void(n&&n.reverse());for(var s,o,c,l,u=r.length,f=0;f<u;){if(a[f]>=e){for(c=f+1;c<u&&a[c]>=e;)c++;for(l=f,o=c-1;l<o;l++,o--)s=r[l],r[l]=r[o],r[o]=s,n&&(s=n[l],n[l]=n[o],n[o]=s);f=c}f++}}},E=function(e,t,r){if(0!==r.hiLevel&&c)for(var n,a=0;a<e.length;a++)1===t[a]&&(n=d.indexOf(e[a]))>=0&&(e[a]=d[n+1])},S=function(e,t,r){var n=e.split(""),a={hiLevel:m};return r||(r=[]),A(n,r,a),E(n,r,a),k(2,n,t,r,a),k(1,n,t,r,a),n.join("")};return this.__bidiEngine__.doBidiReorder=function(e,t,r){if(y(e,t),a||!s||o)if(a&&s&&i^o)m=i?1:0,e=w(e,t,r);else if(!a&&s&&o)m=i?1:0,e=S(e,t,r),e=w(e,t);else if(!a||i||s||o){if(a&&!s&&i^o)e=w(e,t),i?(m=0,e=S(e,t,r)):(m=1,e=S(e,t,r),e=w(e,t));else if(a&&i&&!s&&o)m=1,e=S(e,t,r),e=w(e,t);else if(!a&&!s&&i^o){var n=c;i?(m=1,e=S(e,t,r),m=0,c=!1,e=S(e,t,r),c=n):(m=0,e=S(e,t,r),e=w(e,t),m=1,c=!1,e=S(e,t,r),c=n,e=w(e,t))}}else m=0,e=S(e,t,r);else m=i?1:0,e=S(e,t,r);return e},this.__bidiEngine__.setOptions=function(e){e&&(a=e.isInputVisual,s=e.isOutputVisual,i=e.isInputRtl,o=e.isOutputRtl,c=e.isSymmetricSwapping)},this.__bidiEngine__.setOptions(e),this.__bidiEngine__};var r=t,n=new e.__bidiEngine__({isInputVisual:!0}),a=function(e){var t=e.text,r=(e.x,e.y,e.options,e.mutex,[]);if("[object Array]"===Object.prototype.toString.call(t)){var a=0;for(r=[],a=0;a<t.length;a+=1)"[object Array]"===Object.prototype.toString.call(t[a])?r.push([n.doBidiReorder(t[a][0]),t[a][1],t[a][2]]):r.push([n.doBidiReorder(t[a])]);e.text=r}else e.text=n.doBidiReorder(t)};e.API.events.push(["postProcessText",a])}(c);try{t.exports=a}catch(e){}i.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,16===this.bitPP&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=0===this.colors?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:a,green:n,blue:r,quad:i}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},i.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(e){console.log("bit decode error:"+e)}},i.prototype.bit1=function(){for(var e=Math.ceil(this.width/8),t=e%4,r=this.height>=0?this.height-1:-this.height,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<e;a++)for(var i=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+8*a*4,o=0;o<8&&8*a+o<this.width;o++){var c=this.palette[i>>7-o&1];this.data[s+4*o]=c.blue,this.data[s+4*o+1]=c.green,this.data[s+4*o+2]=c.red,this.data[s+4*o+3]=255}0!=t&&(this.pos+=4-t)}},i.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<e;a++){var i=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+2*a*4,o=i>>4,c=15&i,l=this.palette[o];if(this.data[s]=l.blue,this.data[s+1]=l.green,this.data[s+2]=l.red,this.data[s+3]=255,2*a+1>=this.width)break;l=this.palette[c],this.data[s+4]=l.blue,this.data[s+4+1]=l.green,this.data[s+4+2]=l.red,this.data[s+4+3]=255}0!=t&&(this.pos+=4-t)}},i.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var a=this.datav.getUint8(this.pos++,!0),i=r*this.width*4+4*n;if(a<this.palette.length){var s=this.palette[a];this.data[i]=s.red,this.data[i+1]=s.green,this.data[i+2]=s.blue,this.data[i+3]=255}else this.data[i]=255,this.data[i+1]=255,this.data[i+2]=255,this.data[i+3]=255}0!=e&&(this.pos+=4-e)}},i.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=t,n=this.height-1;n>=0;n--){for(var a=this.bottom_up?n:this.height-1-n,i=0;i<this.width;i++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(s&r)/r*255|0,c=(s>>5&r)/r*255|0,l=(s>>10&r)/r*255|0,u=s>>15?255:0,f=a*this.width*4+4*i;this.data[f]=l,this.data[f+1]=c,this.data[f+2]=o,this.data[f+3]=u}this.pos+=e}},i.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=t,n=parseInt("111111",2),a=n,i=this.height-1;i>=0;i--){for(var s=this.bottom_up?i:this.height-1-i,o=0;o<this.width;o++){var c=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(c&r)/r*255|0,u=(c>>5&a)/a*255|0,f=(c>>11)/r*255|0,$=s*this.width*4+4*o;this.data[$]=f,this.data[$+1]=u,this.data[$+2]=l,this.data[$+3]=255}this.pos+=e}},i.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=t*this.width*4+4*r;this.data[s]=i,this.data[s+1]=a,this.data[s+2]=n,this.data[s+3]=255}this.pos+=this.width%4}},i.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*r;this.data[o]=i,this.data[o+1]=a,this.data[o+2]=n,this.data[o+3]=s}},i.prototype.getData=function(){return this.data};try{t.exports=function(e){var t=new i(e);return{data:t.getData(),width:t.width,height:t.height}}}catch(e){}window.tmp=i,function(e){function t(){function e(e){var t,r,a,i,s,o,l=n.dyn_tree,u=n.stat_desc.static_tree,f=n.stat_desc.extra_bits,$=n.stat_desc.extra_base,d=n.stat_desc.max_length,h=0;for(i=0;i<=c;i++)e.bl_count[i]=0;for(l[2*e.heap[e.heap_max]+1]=0,t=e.heap_max+1;t<p;t++)r=e.heap[t],i=l[2*l[2*r+1]+1]+1,i>d&&(i=d,h++),l[2*r+1]=i,r>n.max_code||(e.bl_count[i]++,s=0,r>=$&&(s=f[r-$]),o=l[2*r],e.opt_len+=o*(i+s),u&&(e.static_len+=o*(u[2*r+1]+s)));if(0!==h){do{for(i=d-1;0===e.bl_count[i];)i--;e.bl_count[i]--,e.bl_count[i+1]+=2,e.bl_count[d]--,h-=2}while(h>0);for(i=d;0!==i;i--)for(r=e.bl_count[i];0!==r;)(a=e.heap[--t])>n.max_code||(l[2*a+1]!=i&&(e.opt_len+=(i-l[2*a+1])*l[2*a],l[2*a+1]=i),r--)}}function t(e,t){var r=0;do{r|=1&e,e>>>=1,r<<=1}while(--t>0);return r>>>1}function r(e,r,n){var a,i,s,o=[],l=0;for(a=1;a<=c;a++)o[a]=l=l+n[a-1]<<1;for(i=0;i<=r;i++)0!==(s=e[2*i+1])&&(e[2*i]=t(o[s]++,s))}var n=this;n.build_tree=function(t){var a,i,s,o=n.dyn_tree,c=n.stat_desc.static_tree,l=n.stat_desc.elems,u=-1;for(t.heap_len=0,t.heap_max=p,a=0;a<l;a++)0!==o[2*a]?(t.heap[++t.heap_len]=u=a,t.depth[a]=0):o[2*a+1]=0;for(;t.heap_len<2;)s=t.heap[++t.heap_len]=u<2?++u:0,o[2*s]=1,t.depth[s]=0,t.opt_len--,c&&(t.static_len-=c[2*s+1]);for(n.max_code=u,a=Math.floor(t.heap_len/2);a>=1;a--)t.pqdownheap(o,a);s=l;do{a=t.heap[1],t.heap[1]=t.heap[t.heap_len--],t.pqdownheap(o,1),i=t.heap[1],t.heap[--t.heap_max]=a,t.heap[--t.heap_max]=i,o[2*s]=o[2*a]+o[2*i],t.depth[s]=Math.max(t.depth[a],t.depth[i])+1,o[2*a+1]=o[2*i+1]=s,t.heap[1]=s++,t.pqdownheap(o,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],e(t),r(o,n.max_code,t.bl_count)}}function r(e,t,r,n,a){var i=this;i.static_tree=e,i.extra_bits=t,i.extra_base=r,i.elems=n,i.max_length=a}function n(e,t,r,n,a){var i=this;i.good_length=e,i.max_lazy=t,i.nice_length=r,i.max_chain=n,i.func=a}function a(e,t,r,n){var a=e[2*t],i=e[2*r];return a<i||a==i&&n[t]<=n[r]}function i(){function e(){var e;for(Ce=2*ke,Oe[Pe-1]=0,e=0;e<Pe-1;e++)Oe[e]=0;Ye=R[Ve].max_lazy,Xe=R[Ve].good_length,We=R[Ve].nice_length,Ge=R[Ve].max_chain,ze=0,je=0,Ue=0,Fe=He=Z-1,De=0,Le=0}function n(){var e;for(e=0;e<$;e++)Je[2*e]=0;for(e=0;e<l;e++)Ke[2*e]=0;for(e=0;e<u;e++)Ze[2*e]=0;Je[2*d]=1,et.opt_len=et.static_len=0,st=ct=0}function i(){tt.dyn_tree=Je,tt.stat_desc=r.static_l_desc,rt.dyn_tree=Ke,rt.stat_desc=r.static_d_desc,nt.dyn_tree=Ze,nt.stat_desc=r.static_bl_desc,ut=0,ft=0,lt=8,n()}function s(e,t){var r,n,a=-1,i=e[1],s=0,o=7,c=4;for(0===i&&(o=138,c=3),e[2*(t+1)+1]=65535,r=0;r<=t;r++)n=i,i=e[2*(r+1)+1],++s<o&&n==i||(s<c?Ze[2*n]+=s:0!==n?(n!=a&&Ze[2*n]++,Ze[2*h]++):s<=10?Ze[2*_]++:Ze[2*m]++,s=0,a=n,0===i?(o=138,c=3):n==i?(o=6,c=3):(o=7,c=4))}function o(){var e;for(s(Je,tt.max_code),s(Ke,rt.max_code),nt.build_tree(et),e=u-1;e>=3&&0===Ze[2*t.bl_order[e]+1];e--);return et.opt_len+=3*(e+1)+5+5+4,e}function c(e){et.pending_buf[et.pending++]=e}function p(e){c(255&e),c(e>>>8&255)}function P(e){c(e>>8&255),c(255&e)}function re(e,t){var r,n=t;ft>y-n?(r=e,ut|=r<<ft&65535,p(ut),ut=r>>>y-ft,ft+=n-y):(ut|=e<<ft&65535,ft+=n)}function ne(e,t){var r=2*e;re(65535&t[r],65535&t[r+1])}function ae(e,t){var r,n,a=-1,i=e[1],s=0,o=7,c=4;for(0===i&&(o=138,c=3),r=0;r<=t;r++)if(n=i,i=e[2*(r+1)+1],!(++s<o&&n==i)){if(s<c)do{ne(n,Ze)}while(0!=--s);else 0!==n?(n!=a&&(ne(n,Ze),s--),ne(h,Ze),re(s-3,2)):s<=10?(ne(_,Ze),re(s-3,3)):(ne(m,Ze),re(s-11,7));s=0,a=n,0===i?(o=138,c=3):n==i?(o=6,c=3):(o=7,c=4)}}function ie(e,r,n){var a;for(re(e-257,5),re(r-1,5),re(n-4,4),a=0;a<n;a++)re(Ze[2*t.bl_order[a]+1],3);ae(Je,e-1),ae(Ke,r-1)}function se(){16==ft?(p(ut),ut=0,ft=0):ft>=8&&(c(255&ut),ut>>>=8,ft-=8)}function oe(){re(J<<1,3),ne(d,r.static_ltree),se(),1+lt+10-ft<9&&(re(J<<1,3),ne(d,r.static_ltree),se()),lt=7}function ce(e,r){var n,a,i;if(et.pending_buf[ot+2*st]=e>>>8&255,et.pending_buf[ot+2*st+1]=255&e,et.pending_buf[at+st]=255&r,st++,0===e?Je[2*r]++:(ct++,e--,Je[2*(t._length_code[r]+f+1)]++,Ke[2*t.d_code(e)]++),0==(8191&st)&&Ve>2){for(n=8*st,a=ze-je,i=0;i<l;i++)n+=Ke[2*i]*(5+t.extra_dbits[i]);if(n>>>=3,ct<Math.floor(st/2)&&n<Math.floor(a/2))return!0}return st==it-1}function le(e,r){var n,a,i,s,o=0;if(0!==st)do{n=et.pending_buf[ot+2*o]<<8&65280|255&et.pending_buf[ot+2*o+1],a=255&et.pending_buf[at+o],o++,0===n?ne(a,e):(i=t._length_code[a],ne(i+f+1,e),s=t.extra_lbits[i],0!==s&&(a-=t.base_length[i],re(a,s)),n--,i=t.d_code(n),ne(i,r),0!==(s=t.extra_dbits[i])&&(n-=t.base_dist[i],re(n,s)))}while(o<st);ne(d,e),lt=e[2*d+1]}function ue(){ft>8?p(ut):ft>0&&c(255&ut),ut=0,ft=0}function fe(e,t,r){ue(),lt=8,r&&(p(t),p(~t)),et.pending_buf.set(Ne.subarray(e,e+t),et.pending),et.pending+=t}function $e(e,t,r){re((W<<1)+(r?1:0),3),fe(e,t,!0)}function pe(e,t,a){var i,s,c=0;Ve>0?(tt.build_tree(et),rt.build_tree(et),c=o(),i=et.opt_len+3+7>>>3,(s=et.static_len+3+7>>>3)<=i&&(i=s)):i=s=t+5,t+4<=i&&-1!=e?$e(e,t,a):s==i?(re((J<<1)+(a?1:0),3),le(r.static_ltree,r.static_dtree)):(re((K<<1)+(a?1:0),3),ie(tt.max_code+1,rt.max_code+1,c+1),le(Je,Ke)),n(),a&&ue()}function de(e){pe(je>=0?je:-1,ze-je,e),je=ze,be.flush_pending()}function he(){var e,t,r,n;do{if(0===(n=Ce-Ue-ze)&&0===ze&&0===Ue)n=ke;else if(-1==n)n--;else if(ze>=ke+ke-te){Ne.set(Ne.subarray(ke,ke+ke),0),qe-=ke,ze-=ke,je-=ke,e=Pe,r=e;do{t=65535&Oe[--r],Oe[r]=t>=ke?t-ke:0}while(0!=--e);e=ke,r=e;do{t=65535&Ie[--r],Ie[r]=t>=ke?t-ke:0}while(0!=--e);n+=ke}if(0===be.avail_in)return;e=be.read_buf(Ne,ze+Ue,n),Ue+=e,Ue>=Z&&(Le=255&Ne[ze],Le=(Le<<Be^255&Ne[ze+1])&Te)}while(Ue<te&&0!==be.avail_in)}function _e(e){var t,r=65535;for(r>we-5&&(r=we-5);;){if(Ue<=1){if(he(),0===Ue&&e==w)return z;if(0===Ue)break}if(ze+=Ue,Ue=0,t=je+r,(0===ze||ze>=t)&&(Ue=ze-t,ze=t,de(!1),0===be.avail_out))return z;if(ze-je>=ke-te&&(de(!1),0===be.avail_out))return z}return de(e==E),0===be.avail_out?e==E?U:z:e==E?H:q}function me(e){var t,r,n=Ge,a=ze,i=He,s=ze>ke-te?ze-(ke-te):0,o=We,c=Se,l=ze+ee,u=Ne[a+i-1],f=Ne[a+i];He>=Xe&&(n>>=2),o>Ue&&(o=Ue);do{if(t=e,Ne[t+i]==f&&Ne[t+i-1]==u&&Ne[t]==Ne[a]&&Ne[++t]==Ne[a+1]){a+=2,t++;do{}while(Ne[++a]==Ne[++t]&&Ne[++a]==Ne[++t]&&Ne[++a]==Ne[++t]&&Ne[++a]==Ne[++t]&&Ne[++a]==Ne[++t]&&Ne[++a]==Ne[++t]&&Ne[++a]==Ne[++t]&&Ne[++a]==Ne[++t]&&a<l);if(r=ee-(l-a),a=l-ee,r>i){if(qe=e,i=r,r>=o)break;u=Ne[a+i-1],f=Ne[a+i]}}}while((e=65535&Ie[e&c])>s&&0!=--n);return i<=Ue?i:Ue}function ye(e){for(var t,r=0;;){if(Ue<te){if(he(),Ue<te&&e==w)return z;if(0===Ue)break}if(Ue>=Z&&(Le=(Le<<Be^255&Ne[ze+(Z-1)])&Te,r=65535&Oe[Le],Ie[ze&Se]=Oe[Le],Oe[Le]=ze),0!==r&&(ze-r&65535)<=ke-te&&Qe!=b&&(Fe=me(r)),Fe>=Z)if(t=ce(ze-qe,Fe-Z),Ue-=Fe,Fe<=Ye&&Ue>=Z){Fe--;do{ze++,Le=(Le<<Be^255&Ne[ze+(Z-1)])&Te,r=65535&Oe[Le],Ie[ze&Se]=Oe[Le],Oe[Le]=ze}while(0!=--Fe);ze++}else ze+=Fe,Fe=0,Le=255&Ne[ze],Le=(Le<<Be^255&Ne[ze+1])&Te;else t=ce(0,255&Ne[ze]),Ue--,ze++;if(t&&(de(!1),0===be.avail_out))return z}return de(e==E),0===be.avail_out?e==E?U:z:e==E?H:q}function ge(e){for(var t,r,n=0;;){if(Ue<te){if(he(),Ue<te&&e==w)return z;if(0===Ue)break}if(Ue>=Z&&(Le=(Le<<Be^255&Ne[ze+(Z-1)])&Te,n=65535&Oe[Le],Ie[ze&Se]=Oe[Le],Oe[Le]=ze),He=Fe,Re=qe,Fe=Z-1,0!==n&&He<Ye&&(ze-n&65535)<=ke-te&&(Qe!=b&&(Fe=me(n)),Fe<=5&&(Qe==v||Fe==Z&&ze-qe>4096)&&(Fe=Z-1)),He>=Z&&Fe<=He){r=ze+Ue-Z,t=ce(ze-1-Re,He-Z),Ue-=He-1,He-=2;do{++ze<=r&&(Le=(Le<<Be^255&Ne[ze+(Z-1)])&Te,n=65535&Oe[Le],Ie[ze&Se]=Oe[Le],Oe[Le]=ze)}while(0!=--He);if(De=0,Fe=Z-1,ze++,t&&(de(!1),0===be.avail_out))return z}else if(0!==De){if(t=ce(0,255&Ne[ze-1]),t&&de(!1),ze++,Ue--,0===be.avail_out)return z}else De=1,ze++,Ue--}return 0!==De&&(t=ce(0,255&Ne[ze-1]),De=0),de(e==E),0===be.avail_out?e==E?U:z:e==E?H:q}function ve(t){return t.total_in=t.total_out=0,t.msg=null,et.pending=0,et.pending_out=0,xe=V,Ae=w,i(),e(),S}var be,xe,we,Ae,ke,Ee,Se,Ne,Ce,Ie,Oe,Le,Pe,Me,Te,Be,je,Fe,Re,De,ze,qe,Ue,He,Ge,Ye,Ve,Qe,Xe,We,Je,Ke,Ze,et=this,tt=new t,rt=new t,nt=new t;et.depth=[];var at,it,st,ot,ct,lt,ut,ft;et.bl_count=[],et.heap=[],Je=[],Ke=[],Ze=[],et.pqdownheap=function(e,t){for(var r=et.heap,n=r[t],i=t<<1;i<=et.heap_len&&(i<et.heap_len&&a(e,r[i+1],r[i],et.depth)&&i++,!a(e,n,r[i],et.depth));)r[t]=r[i],t=i,i<<=1;r[t]=n},et.deflateInit=function(e,t,r,n,a,i){return n||(n=X),a||(a=T),i||(i=x),e.msg=null,t==g&&(t=6),a<1||a>M||n!=X||r<9||r>15||t<0||t>9||i<0||i>b?I:(e.dstate=et,Ee=r,ke=1<<Ee,Se=ke-1,Me=a+7,Pe=1<<Me,Te=Pe-1,Be=Math.floor((Me+Z-1)/Z),Ne=new Uint8Array(2*ke),Ie=[],Oe=[],it=1<<a+6,et.pending_buf=new Uint8Array(4*it),we=4*it,ot=Math.floor(it/2),at=3*it,Ve=t,Qe=i,ve(e))},et.deflateEnd=function(){return xe!=Y&&xe!=V&&xe!=Q?I:(et.pending_buf=null,Oe=null,Ie=null,Ne=null,et.dstate=null,xe==V?O:S)},et.deflateParams=function(e,t,r){var n=S;return t==g&&(t=6),t<0||t>9||r<0||r>b?I:(R[Ve].func!=R[t].func&&0!==e.total_in&&(n=e.deflate(A)),Ve!=t&&(Ve=t,Ye=R[Ve].max_lazy,Xe=R[Ve].good_length,We=R[Ve].nice_length,Ge=R[Ve].max_chain),Qe=r,n)},et.deflateSetDictionary=function(e,t,r){var n,a=r,i=0;if(!t||xe!=Y)return I;if(a<Z)return S;for(a>ke-te&&(a=ke-te,i=r-a),Ne.set(t.subarray(i,i+a),0),ze=a,je=a,Le=255&Ne[0],Le=(Le<<Be^255&Ne[1])&Te,n=0;n<=a-Z;n++)Le=(Le<<Be^255&Ne[n+(Z-1)])&Te,Ie[n&Se]=Oe[Le],Oe[Le]=n;return S},et.deflate=function(e,t){var r,n,a,i,s;if(t>E||t<0)return I;if(!e.next_out||!e.next_in&&0!==e.avail_in||xe==Q&&t!=E)return e.msg=D[C-I],I;if(0===e.avail_out)return e.msg=D[C-L],L;if(be=e,i=Ae,Ae=t,xe==Y&&(n=X+(Ee-8<<4)<<8,a=(Ve-1&255)>>1,a>3&&(a=3),n|=a<<6,0!==ze&&(n|=G),n+=31-n%31,xe=V,P(n)),0!==et.pending){if(be.flush_pending(),0===be.avail_out)return Ae=-1,S}else if(0===be.avail_in&&t<=i&&t!=E)return be.msg=D[C-L],L;if(xe==Q&&0!==be.avail_in)return e.msg=D[C-L],L;if(0!==be.avail_in||0!==Ue||t!=w&&xe!=Q){switch(s=-1,R[Ve].func){case B:s=_e(t);break;case j:s=ye(t);break;case F:s=ge(t)}if(s!=U&&s!=H||(xe=Q),s==z||s==U)return 0===be.avail_out&&(Ae=-1),S;if(s==q){if(t==A)oe();else if($e(0,0,!1),t==k)for(r=0;r<Pe;r++)Oe[r]=0;if(be.flush_pending(),0===be.avail_out)return Ae=-1,S}}return t!=E?S:N}}function s(){var e=this;e.next_in_index=0,e.next_out_index=0,e.avail_in=0,e.total_in=0,e.avail_out=0,e.total_out=0}function o(e){var t=this,r=new s,n=w,a=new Uint8Array(512),i=e?e.level:g;void 0===i&&(i=g),r.deflateInit(i),r.next_out=a,t.append=function(e,t){var i,s=[],o=0,c=0,l=0;if(e.length){r.next_in_index=0,r.next_in=e,r.avail_in=e.length;do{if(r.next_out_index=0,r.avail_out=512,r.deflate(n)!=S)throw new Error("deflating: "+r.msg);r.next_out_index&&(512==r.next_out_index?s.push(new Uint8Array(a)):s.push(new Uint8Array(a.subarray(0,r.next_out_index)))),l+=r.next_out_index,t&&r.next_in_index>0&&r.next_in_index!=o&&(t(r.next_in_index),o=r.next_in_index)}while(r.avail_in>0||0===r.avail_out);return i=new Uint8Array(l),s.forEach(function(e){i.set(e,c),c+=e.length}),i}},t.flush=function(){var e,t,n=[],i=0,s=0;do{if(r.next_out_index=0,r.avail_out=512,(e=r.deflate(E))!=N&&e!=S)throw new Error("deflating: "+r.msg);512-r.avail_out>0&&n.push(new Uint8Array(a.subarray(0,r.next_out_index))),s+=r.next_out_index}while(r.avail_in>0||0===r.avail_out);return r.deflateEnd(),t=new Uint8Array(s),n.forEach(function(e){t.set(e,i),i+=e.length}),t}}var c=15,l=30,u=19,f=256,$=f+1+29,p=2*$+1,d=256,h=16,_=17,m=18,y=16,g=-1,v=1,b=2,x=0,w=0,A=1,k=3,E=4,S=0,N=1,C=2,I=-2,O=-3,L=-5,P=[0,1,2,3,4,4,5,5,6,6,6,6,7,7,7,7,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,0,0,16,17,18,18,19,19,20,20,20,20,21,21,21,21,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29];t._length_code=[0,1,2,3,4,5,6,7,8,8,9,9,10,10,11,11,12,12,12,12,13,13,13,13,14,14,14,14,15,15,15,15,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,28],t.base_length=[0,1,2,3,4,5,6,7,8,10,12,14,16,20,24,28,32,40,48,56,64,80,96,112,128,160,192,224,0],t.base_dist=[0,1,2,3,4,6,8,12,16,24,32,48,64,96,128,192,256,384,512,768,1024,1536,2048,3072,4096,6144,8192,12288,16384,24576],t.d_code=function(e){
return e<256?P[e]:P[256+(e>>>7)]},t.extra_lbits=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],t.extra_dbits=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],t.extra_blbits=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],t.bl_order=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],r.static_ltree=[12,8,140,8,76,8,204,8,44,8,172,8,108,8,236,8,28,8,156,8,92,8,220,8,60,8,188,8,124,8,252,8,2,8,130,8,66,8,194,8,34,8,162,8,98,8,226,8,18,8,146,8,82,8,210,8,50,8,178,8,114,8,242,8,10,8,138,8,74,8,202,8,42,8,170,8,106,8,234,8,26,8,154,8,90,8,218,8,58,8,186,8,122,8,250,8,6,8,134,8,70,8,198,8,38,8,166,8,102,8,230,8,22,8,150,8,86,8,214,8,54,8,182,8,118,8,246,8,14,8,142,8,78,8,206,8,46,8,174,8,110,8,238,8,30,8,158,8,94,8,222,8,62,8,190,8,126,8,254,8,1,8,129,8,65,8,193,8,33,8,161,8,97,8,225,8,17,8,145,8,81,8,209,8,49,8,177,8,113,8,241,8,9,8,137,8,73,8,201,8,41,8,169,8,105,8,233,8,25,8,153,8,89,8,217,8,57,8,185,8,121,8,249,8,5,8,133,8,69,8,197,8,37,8,165,8,101,8,229,8,21,8,149,8,85,8,213,8,53,8,181,8,117,8,245,8,13,8,141,8,77,8,205,8,45,8,173,8,109,8,237,8,29,8,157,8,93,8,221,8,61,8,189,8,125,8,253,8,19,9,275,9,147,9,403,9,83,9,339,9,211,9,467,9,51,9,307,9,179,9,435,9,115,9,371,9,243,9,499,9,11,9,267,9,139,9,395,9,75,9,331,9,203,9,459,9,43,9,299,9,171,9,427,9,107,9,363,9,235,9,491,9,27,9,283,9,155,9,411,9,91,9,347,9,219,9,475,9,59,9,315,9,187,9,443,9,123,9,379,9,251,9,507,9,7,9,263,9,135,9,391,9,71,9,327,9,199,9,455,9,39,9,295,9,167,9,423,9,103,9,359,9,231,9,487,9,23,9,279,9,151,9,407,9,87,9,343,9,215,9,471,9,55,9,311,9,183,9,439,9,119,9,375,9,247,9,503,9,15,9,271,9,143,9,399,9,79,9,335,9,207,9,463,9,47,9,303,9,175,9,431,9,111,9,367,9,239,9,495,9,31,9,287,9,159,9,415,9,95,9,351,9,223,9,479,9,63,9,319,9,191,9,447,9,127,9,383,9,255,9,511,9,0,7,64,7,32,7,96,7,16,7,80,7,48,7,112,7,8,7,72,7,40,7,104,7,24,7,88,7,56,7,120,7,4,7,68,7,36,7,100,7,20,7,84,7,52,7,116,7,3,8,131,8,67,8,195,8,35,8,163,8,99,8,227,8],r.static_dtree=[0,5,16,5,8,5,24,5,4,5,20,5,12,5,28,5,2,5,18,5,10,5,26,5,6,5,22,5,14,5,30,5,1,5,17,5,9,5,25,5,5,5,21,5,13,5,29,5,3,5,19,5,11,5,27,5,7,5,23,5],r.static_l_desc=new r(r.static_ltree,t.extra_lbits,f+1,$,c),r.static_d_desc=new r(r.static_dtree,t.extra_dbits,0,l,c),r.static_bl_desc=new r(null,t.extra_blbits,0,u,7);var M=9,T=8,B=0,j=1,F=2,R=[new n(0,0,0,0,B),new n(4,4,8,4,j),new n(4,5,16,8,j),new n(4,6,32,32,j),new n(4,4,16,16,F),new n(8,16,32,32,F),new n(8,16,128,128,F),new n(8,32,128,256,F),new n(32,128,258,1024,F),new n(32,258,258,4096,F)],D=["need dictionary","stream end","","","stream error","data error","","buffer error","",""],z=0,q=1,U=2,H=3,G=32,Y=42,V=113,Q=666,X=8,W=0,J=1,K=2,Z=3,ee=258,te=ee+Z+1;s.prototype={deflateInit:function(e,t){var r=this;return r.dstate=new i,t||(t=c),r.dstate.deflateInit(r,e,t)},deflate:function(e){var t=this;return t.dstate?t.dstate.deflate(t,e):I},deflateEnd:function(){var e=this;if(!e.dstate)return I;var t=e.dstate.deflateEnd();return e.dstate=null,t},deflateParams:function(e,t){var r=this;return r.dstate?r.dstate.deflateParams(r,e,t):I},deflateSetDictionary:function(e,t){var r=this;return r.dstate?r.dstate.deflateSetDictionary(r,e,t):I},read_buf:function(e,t,r){var n=this,a=n.avail_in;return a>r&&(a=r),0===a?0:(n.avail_in-=a,e.set(n.next_in.subarray(n.next_in_index,n.next_in_index+a),t),n.next_in_index+=a,n.total_in+=a,a)},flush_pending:function(){var e=this,t=e.dstate.pending;t>e.avail_out&&(t=e.avail_out),0!==t&&(e.next_out.set(e.dstate.pending_buf.subarray(e.dstate.pending_out,e.dstate.pending_out+t),e.next_out_index),e.next_out_index+=t,e.dstate.pending_out+=t,e.total_out+=t,e.avail_out-=t,e.dstate.pending-=t,0===e.dstate.pending&&(e.dstate.pending_out=0))}};var re=e.zip||e;re.Deflater=re._jzlib_Deflater=o}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||"undefined"!=typeof global&&global||Function('return typeof this === "object" && this.content')()||Function("return this")()),function(e){function r(e){this.ok=!1,"#"==e.charAt(0)&&(e=e.substr(1,6)),e=e.replace(/ /g,""),e=e.toLowerCase();var t,r={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};for(var n in r)e==n&&(e=r[n]);for(var a=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(e){return[parseInt(e[1]),parseInt(e[2]),parseInt(e[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}}],i=0;i<a.length;i++){var s=a[i].re,o=a[i].process,c=s.exec(e);c&&(t=o(c),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var e=this.r.toString(16),t=this.g.toString(16),r=this.b.toString(16);return 1==e.length&&(e="0"+e),1==t.length&&(t="0"+t),1==r.length&&(r="0"+r),"#"+e+t+r}}"undefined"!=typeof define&&define.amd?define("RGBColor",function(){return r}):void 0!==t&&t.exports&&(t.exports=r),e.RGBColor=r}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||"undefined"!=typeof global&&global||Function('return typeof this === "object" && this.content')()||Function("return this")()),function(e){var t="+".charCodeAt(0),r="/".charCodeAt(0),n="0".charCodeAt(0),a="a".charCodeAt(0),i="A".charCodeAt(0),s="-".charCodeAt(0),o="_".charCodeAt(0),c=function(e){function t(e){o[u++]=e}var r,n,a,i,s,o;if(e.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var c=e.length;s="="===e.charAt(c-2)?2:"="===e.charAt(c-1)?1:0,o=new Uint8Array(3*e.length/4-s),a=s>0?e.length-4:e.length;var u=0;for(r=0,n=0;r<a;r+=4,n+=3)i=l(e.charAt(r))<<18|l(e.charAt(r+1))<<12|l(e.charAt(r+2))<<6|l(e.charAt(r+3)),t((16711680&i)>>16),t((65280&i)>>8),t(255&i);return 2===s?(i=l(e.charAt(r))<<2|l(e.charAt(r+1))>>4,t(255&i)):1===s&&(i=l(e.charAt(r))<<10|l(e.charAt(r+1))<<4|l(e.charAt(r+2))>>2,t(i>>8&255),t(255&i)),o},l=function(e){var c=e.charCodeAt(0);return c===t||c===s?62:c===r||c===o?63:c<n?-1:c<n+10?c-n+26+26:c<i+26?c-i:c<a+26?c-a+26:void 0};e.API.TTFFont=function(){function e(e,t,r){var n;if(this.rawData=e,n=this.contents=new f(e),this.contents.pos=4,"ttcf"===n.readString(4)){if(!t)throw new Error("Must specify a font name for TTC files.");throw new Error("Font "+t+" not found in TTC file.")}n.pos=0,this.parse(),this.subset=new O(this),this.registerTTF()}return e.open=function(t,r,n,a){var i;return i=c(n),new e(i,r,a)},e.prototype.parse=function(){return this.directory=new $(this.contents),this.head=new h(this),this.name=new x(this),this.cmap=new m(this),this.toUnicode=new Map,this.hhea=new y(this),this.maxp=new w(this),this.hmtx=new A(this),this.post=new v(this),this.os2=new g(this),this.loca=new C(this),this.glyf=new E(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var e,t,r,n,a;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=function(){var t,r,n,a;for(n=this.bbox,a=[],t=0,r=n.length;t<r;t++)e=n[t],a.push(Math.round(e*this.scaleFactor));return a}.call(this),this.stemV=0,this.post.exists?(n=this.post.italic_angle,t=n>>16,r=255&n,!0&t&&(t=-(1+(65535^t))),this.italicAngle=+(t+"."+r)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=1===(a=this.familyClass)||2===a||3===a||4===a||5===a||7===a,this.isScript=10===this.familyClass,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),0!==this.italicAngle&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(e){var t;return(null!=(t=this.cmap.unicode)?t.codeMap[e]:void 0)||0},e.prototype.widthOfGlyph=function(e){var t;return t=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*t},e.prototype.widthOfString=function(e,t,r){var n,a,i,s,o,c,r;for(e=""+e,s=0,a=o=0,c=e.length;0<=c?o<c:o>c;a=0<=c?++o:--o)n=e.charCodeAt(a),s+=this.widthOfGlyph(this.characterToGlyph(n))+r*(1e3/t)||0;return i=t/1e3,s*i},e.prototype.lineHeight=function(e,t){var r;return null==t&&(t=!1),r=t?this.lineGap:0,(this.ascender+r-this.decender)/1e3*e},e}();var u,f=function(){function e(e){this.data=null!=e?e:[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(e){return this.data[this.pos++]=e},e.prototype.readUInt32=function(){var e,t,r,n;return e=16777216*this.readByte(),t=this.readByte()<<16,r=this.readByte()<<8,n=this.readByte(),e+t+r+n},e.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},e.prototype.readInt32=function(){var e;return e=this.readUInt32(),e>=2147483648?e-4294967296:e},e.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},e.prototype.readUInt16=function(){var e,t;return e=this.readByte()<<8,t=this.readByte(),e|t},e.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},e.prototype.readInt16=function(){var e;return e=this.readUInt16(),e>=32768?e-65536:e},e.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},e.prototype.readString=function(e){var t,r,n;for(r=[],t=n=0;0<=e?n<e:n>e;t=0<=e?++n:--n)r[t]=String.fromCharCode(this.readByte());return r.join("")},e.prototype.writeString=function(e){var t,r,n,a;for(a=[],t=r=0,n=e.length;0<=n?r<n:r>n;t=0<=n?++r:--r)a.push(this.writeByte(e.charCodeAt(t)));return a},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(e){return this.writeInt16(e)},e.prototype.readLongLong=function(){var e,t,r,n,a,i,s,o;return e=this.readByte(),t=this.readByte(),r=this.readByte(),n=this.readByte(),a=this.readByte(),i=this.readByte(),s=this.readByte(),o=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^t)+1099511627776*(255^r)+4294967296*(255^n)+16777216*(255^a)+65536*(255^i)+256*(255^s)+(255^o)+1):72057594037927940*e+281474976710656*t+1099511627776*r+4294967296*n+16777216*a+65536*i+256*s+o},e.prototype.writeLongLong=function(e){var t,r;return t=Math.floor(e/4294967296),r=4294967295&e,this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t),this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(e){return this.writeInt32(e)},e.prototype.read=function(e){var t,r;for(t=[],r=0;0<=e?r<e:r>e;0<=e?++r:--r)t.push(this.readByte());return t},e.prototype.write=function(e){var t,r,n,a;for(a=[],r=0,n=e.length;r<n;r++)t=e[r],a.push(this.writeByte(t));return a},e}(),$=function(){function e(e){var t,r,n;for(this.scalarType=e.readInt(),this.tableCount=e.readShort(),this.searchRange=e.readShort(),this.entrySelector=e.readShort(),this.rangeShift=e.readShort(),this.tables={},r=0,n=this.tableCount;0<=n?r<n:r>n;0<=n?++r:--r)t={tag:e.readString(4),checksum:e.readInt(),offset:e.readInt(),length:e.readInt()},this.tables[t.tag]=t}var t;return e.prototype.encode=function(e){var r,n,a,i,s,o,c,l,u,$,p,d,h,_;d=Object.keys(e).length,o=Math.log(2),u=16*Math.floor(Math.log(d)/o),i=Math.floor(u/o),l=16*d-u,n=new f,n.writeInt(this.scalarType),n.writeShort(d),n.writeShort(u),n.writeShort(i),n.writeShort(l),a=16*d,c=n.pos+a,s=null,h=[];for(_ in e)for(p=e[_],n.writeString(_),n.writeInt(t(p)),n.writeInt(c),n.writeInt(p.length),h=h.concat(p),"head"===_&&(s=c),c+=p.length;c%4;)h.push(0),c++;return n.write(h),$=t(n.data),r=2981146554-$,n.pos=s+8,n.writeUInt32(r),n.data},t=function(e){var t,r,n,a;for(e=k.call(e);e.length%4;)e.push(0);for(r=new f(e),t=0,n=0,a=e.length;n<a;n+=4)t+=r.readUInt32();return 4294967295&t},e}(),p={}.hasOwnProperty,d=function(e,t){function r(){this.constructor=e}for(var n in t)p.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};u=function(){function e(e){var t;this.file=e,t=this.file.directory.tables[this.tag],this.exists=!!t,t&&(this.offset=t.offset,this.length=t.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var h=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return d(t,e),t.prototype.tag="head",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},t.prototype.encode=function(e){var t;return t=new f,t.writeInt(this.version),t.writeInt(this.revision),t.writeInt(this.checkSumAdjustment),t.writeInt(this.magicNumber),t.writeShort(this.flags),t.writeShort(this.unitsPerEm),t.writeLongLong(this.created),t.writeLongLong(this.modified),t.writeShort(this.xMin),t.writeShort(this.yMin),t.writeShort(this.xMax),t.writeShort(this.yMax),t.writeShort(this.macStyle),t.writeShort(this.lowestRecPPEM),t.writeShort(this.fontDirectionHint),t.writeShort(e),t.writeShort(this.glyphDataFormat),t.data},t}(u),_=function(){function e(e,t){var r,n,a,i,s,o,c,l,u,f,$,p,d,h,_,m,y,g,v;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=t+e.readInt(),f=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=3===this.platformID&&1===this.encodingID&&4===this.format||0===this.platformID&&4===this.format,this.codeMap={},this.format){case 0:for(o=m=0;m<256;o=++m)this.codeMap[o]=e.readByte();break;case 4:for(p=e.readUInt16(),$=p/2,e.pos+=6,a=function(){var t,r;for(r=[],o=t=0;0<=$?t<$:t>$;o=0<=$?++t:--t)r.push(e.readUInt16());return r}(),e.pos+=2,h=function(){var t,r;for(r=[],o=t=0;0<=$?t<$:t>$;o=0<=$?++t:--t)r.push(e.readUInt16());return r}(),c=function(){var t,r;for(r=[],o=t=0;0<=$?t<$:t>$;o=0<=$?++t:--t)r.push(e.readUInt16());return r}(),l=function(){var t,r;for(r=[],o=t=0;0<=$?t<$:t>$;o=0<=$?++t:--t)r.push(e.readUInt16());return r}(),n=(this.length-e.pos+this.offset)/2,s=function(){var t,r;for(r=[],o=t=0;0<=n?t<n:t>n;o=0<=n?++t:--t)r.push(e.readUInt16());return r}(),o=y=0,v=a.length;y<v;o=++y)for(_=a[o],d=h[o],r=g=d;d<=_?g<=_:g>=_;r=d<=_?++g:--g)0===l[o]?i=r+c[o]:(u=l[o]/2+(r-d)-($-o),0!==(i=s[u]||0)&&(i+=c[o])),this.codeMap[r]=65535&i}e.pos=f}return e.encode=function(e,t){var r,n,a,i,s,o,c,l,u,$,p,d,h,_,m,y,g,v,b,x,w,A,k,E,S,N,C,I,O,L,P,M,T,B,j,F,R,D,z,q,U,H,G,Y,V,Q;switch(I=new f,i=Object.keys(e).sort(function(e,t){return e-t}),t){case"macroman":for(h=0,_=function(){var e,t;for(t=[],d=e=0;e<256;d=++e)t.push(0);return t}(),y={0:0},a={},O=0,T=i.length;O<T;O++)n=i[O],null==y[G=e[n]]&&(y[G]=++h),a[n]={old:e[n],new:y[e[n]]},_[n]=y[e[n]];return I.writeUInt16(1),I.writeUInt16(0),I.writeUInt32(12),I.writeUInt16(0),I.writeUInt16(262),I.writeUInt16(0),I.write(_),{charMap:a,subtable:I.data,maxGlyphID:h+1};case"unicode":for(N=[],u=[],g=0,y={},r={},m=c=null,L=0,B=i.length;L<B;L++)n=i[L],b=e[n],null==y[b]&&(y[b]=++g),r[n]={old:b,new:y[b]},s=y[b]-n,null!=m&&s===c||(m&&u.push(m),N.push(n),c=s),m=n;for(m&&u.push(m),u.push(65535),N.push(65535),k=N.length,E=2*k,A=2*Math.pow(Math.log(k)/Math.LN2,2),$=Math.log(A/2)/Math.LN2,w=2*k-A,o=[],x=[],p=[],d=P=0,j=N.length;P<j;d=++P){if(S=N[d],l=u[d],65535===S){o.push(0),x.push(0);break}if(C=r[S].new,S-C>=32768)for(o.push(0),x.push(2*(p.length+k-d)),n=M=S;S<=l?M<=l:M>=l;n=S<=l?++M:--M)p.push(r[n].new);else o.push(C-S),x.push(0)}for(I.writeUInt16(3),I.writeUInt16(1),I.writeUInt32(12),I.writeUInt16(4),I.writeUInt16(16+8*k+2*p.length),I.writeUInt16(0),I.writeUInt16(E),I.writeUInt16(A),I.writeUInt16($),I.writeUInt16(w),U=0,F=u.length;U<F;U++)n=u[U],I.writeUInt16(n);for(I.writeUInt16(0),H=0,R=N.length;H<R;H++)n=N[H],I.writeUInt16(n);for(Y=0,D=o.length;Y<D;Y++)s=o[Y],I.writeUInt16(s);for(V=0,z=x.length;V<z;V++)v=x[V],I.writeUInt16(v);for(Q=0,q=p.length;Q<q;Q++)h=p[Q],I.writeUInt16(h);return{charMap:r,subtable:I.data,maxGlyphID:g+1}}},e}(),m=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return d(t,e),t.prototype.tag="cmap",t.prototype.parse=function(e){var t,r,n;for(e.pos=this.offset,this.version=e.readUInt16(),r=e.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=r?n<r:n>r;0<=r?++n:--n)t=new _(e,this.offset),this.tables.push(t),t.isUnicode&&null==this.unicode&&(this.unicode=t);return!0},t.encode=function(e,t){var r,n;return null==t&&(t="macroman"),r=_.encode(e,t),n=new f,n.writeUInt16(0),n.writeUInt16(1),r.table=n.data.concat(r.subtable),r},t}(u),y=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return d(t,e),t.prototype.tag="hhea",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},t}(u),g=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return d(t,e),t.prototype.tag="OS/2",t.prototype.parse=function(e){var t;if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=function(){var r,n;for(n=[],t=r=0;r<10;t=++r)n.push(e.readByte());return n}(),this.charRange=function(){var r,n;for(n=[],t=r=0;r<4;t=++r)n.push(e.readInt());return n}(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=function(){var r,n;for(n=[],t=r=0;r<2;t=++r)n.push(e.readInt());return n}(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},t}(u),v=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return d(t,e),t.prototype.tag="post",t.prototype.parse=function(e){var t,r,n,a,i;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:break;case 131072:for(n=e.readUInt16(),this.glyphNameIndex=[],t=a=0;0<=n?a<n:a>n;t=0<=n?++a:--a)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],i=[];e.pos<this.offset+this.length;)r=e.readByte(),i.push(this.names.push(e.readString(r)));return i;case 151552:return n=e.readUInt16(),this.offsets=e.read(n);case 196608:break;case 262144:return this.map=function(){var r,n,a;for(a=[],t=r=0,n=this.file.maxp.numGlyphs;0<=n?r<n:r>n;t=0<=n?++r:--r)a.push(e.readUInt32());return a}.call(this)}},t}(u),b=function(){function e(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID}return e}(),x=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return d(t,e),t.prototype.tag="name",t.prototype.parse=function(e){var t,r,n,a,i,s,o,c,l,u,f,$;for(e.pos=this.offset,e.readShort(),t=e.readShort(),s=e.readShort(),r=[],a=l=0;0<=t?l<t:l>t;a=0<=t?++l:--l)r.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+s+e.readShort()});for(o={},a=u=0,f=r.length;u<f;a=++u)n=r[a],e.pos=n.offset,c=e.readString(n.length),i=new b(c,n),null==o[$=n.nameID]&&(o[$]=[]),o[n.nameID].push(i);this.strings=o,this.copyright=o[0],this.fontFamily=o[1],this.fontSubfamily=o[2],this.uniqueSubfamily=o[3],this.fontName=o[4],this.version=o[5];try{this.postscriptName=o[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch(e){this.postscriptName=o[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=o[7],this.manufacturer=o[8],this.designer=o[9],this.description=o[10],this.vendorUrl=o[11],this.designerUrl=o[12],this.license=o[13],this.licenseUrl=o[14],this.preferredFamily=o[15],this.preferredSubfamily=o[17],this.compatibleFull=o[18],this.sampleText=o[19]},t}(u),w=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return d(t,e),t.prototype.tag="maxp",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},t}(u),A=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return d(t,e),t.prototype.tag="hmtx",t.prototype.parse=function(e){var t,r,n,a,i,s,o,c;for(e.pos=this.offset,this.metrics=[],t=i=0,o=this.file.hhea.numberOfMetrics;0<=o?i<o:i>o;t=0<=o?++i:--i)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(n=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var r,a;for(a=[],t=r=0;0<=n?r<n:r>n;t=0<=n?++r:--r)a.push(e.readInt16());return a}(),this.widths=function(){var e,t,r,n;for(r=this.metrics,n=[],e=0,t=r.length;e<t;e++)a=r[e],n.push(a.advance);return n}.call(this),r=this.widths[this.widths.length-1],c=[],t=s=0;0<=n?s<n:s>n;t=0<=n?++s:--s)c.push(this.widths.push(r));return c},t.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},t}(u),k=[].slice,E=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return d(t,e),t.prototype.tag="glyf",t.prototype.parse=function(e){return this.cache={}},t.prototype.glyphFor=function(e){e=e;var t,r,n,a,i,s,o,c,l,u;return e in this.cache?this.cache[e]:(a=this.file.loca,t=this.file.contents,r=a.indexOf(e),0===(n=a.lengthOf(e))?this.cache[e]=null:(t.pos=this.offset+r,s=new f(t.read(n)),i=s.readShort(),c=s.readShort(),u=s.readShort(),o=s.readShort(),l=s.readShort(),this.cache[e]=-1===i?new N(s,c,u,o,l):new S(s,i,c,u,o,l),this.cache[e]))},t.prototype.encode=function(e,t,r){var n,a,i,s,o,c;for(s=[],i=[],o=0,c=t.length;o<c;o++)a=t[o],n=e[a],i.push(s.length),n&&(s=s.concat(n.encode(r)));return i.push(s.length),{table:s,offsets:i}},t}(u),S=function(){function e(e,t,r,n,a,i){this.raw=e,this.numberOfContours=t,this.xMin=r,this.yMin=n,this.xMax=a,this.yMax=i,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),N=function(){function e(e,s,o,c,l){var u,f;for(this.raw=e,this.xMin=s,this.yMin=o,this.xMax=c,this.yMax=l,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],u=this.raw;;){if(f=u.readShort(),this.glyphOffsets.push(u.pos),this.glyphIDs.push(u.readShort()),!(f&r))break;u.pos+=f&t?4:2,f&i?u.pos+=8:f&n?u.pos+=4:f&a&&(u.pos+=2)}}var t,r,n,a,i;return t=1,a=8,r=32,n=64,i=128,e.prototype.encode=function(e){var t,r,n,a,i;for(r=new f(k.call(this.raw.data)),i=this.glyphIDs,t=n=0,a=i.length;n<a;t=++n)i[t],r.pos=this.glyphOffsets[t];return r.data},e}(),C=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return d(t,e),t.prototype.tag="loca",t.prototype.parse=function(e){var t,r;return e.pos=this.offset,t=this.file.head.indexToLocFormat,this.offsets=0===t?function(){var t,n,a;for(a=[],r=t=0,n=this.length;t<n;r=t+=2)a.push(2*e.readUInt16());return a}.call(this):function(){var t,n,a;for(a=[],r=t=0,n=this.length;t<n;r=t+=4)a.push(e.readUInt32());return a}.call(this)},t.prototype.indexOf=function(e){return this.offsets[e]},t.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},t.prototype.encode=function(e,t){for(var r=new Uint32Array(this.offsets.length),n=0,a=0,i=0;i<r.length;++i)if(r[i]=n,a<t.length&&t[a]==i){++a,r[i]=n;var s=this.offsets[i],o=this.offsets[i+1]-s;o>0&&(n+=o)}for(var c=new Array(4*r.length),l=0;l<r.length;++l)c[4*l+3]=255&r[l],c[4*l+2]=(65280&r[l])>>8,c[4*l+1]=(16711680&r[l])>>16,c[4*l]=(4278190080&r[l])>>24;return c},t}(u),I=function(e){var t,r,n;r={};for(t in e)n=e[t],r[n]=t;return r},O=function(){function e(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var e,t,r,n,a;n=this.font.cmap.tables[0].codeMap,e={},a=this.subset;for(t in a)r=a[t],e[t]=n[r];return e},e.prototype.glyphsFor=function(e){var t,r,n,a,i,s,o;for(n={},i=0,s=e.length;i<s;i++)a=e[i],n[a]=this.font.glyf.glyphFor(a);t=[];for(a in n)r=n[a],(null!=r?r.compound:void 0)&&t.push.apply(t,r.glyphIDs);if(t.length>0){o=this.glyphsFor(t);for(a in o)r=o[a],n[a]=r}return n},e.prototype.encode=function(e,t){var r,n,a,i,s,o,c,l,u,f,$,p,d,h,_;r=m.encode(this.generateCmap(),"unicode"),i=this.glyphsFor(e),$={0:0},_=r.charMap;for(n in _)o=_[n],$[o.old]=o.new;f=r.maxGlyphID;for(p in i)p in $||($[p]=f++);return l=I($),u=Object.keys(l).sort(function(e,t){return e-t}),d=function(){var e,t,r;for(r=[],e=0,t=u.length;e<t;e++)s=u[e],r.push(l[s]);return r}(),a=this.font.glyf.encode(i,d,$),c=this.font.loca.encode(a.offsets,d),h={cmap:this.font.cmap.raw(),glyf:a.table,loca:c,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(t)},this.font.os2.exists&&(h["OS/2"]=this.font.os2.raw()),this.font.directory.encode(h)},e}();e.API.PDFObject=function(){function e(){}var t;return t=function(e,t){return(Array(t+1).join("0")+e).slice(-t)},e.convert=function(r){var n,a,i,s;if(Array.isArray(r))return"["+function(){var t,a,i;for(i=[],t=0,a=r.length;t<a;t++)n=r[t],i.push(e.convert(n));return i}().join(" ")+"]";if("string"==typeof r)return"/"+r;if(null!=r?r.isString:void 0)return"("+r+")";if(r instanceof Date)return"(D:"+t(r.getUTCFullYear(),4)+t(r.getUTCMonth(),2)+t(r.getUTCDate(),2)+t(r.getUTCHours(),2)+t(r.getUTCMinutes(),2)+t(r.getUTCSeconds(),2)+"Z)";if("[object Object]"==={}.toString.call(r)){i=["<<"];for(a in r)s=r[a],i.push("/"+a+" "+e.convert(s));return i.push(">>"),i.join("\n")}return""+r},e}()}(c),function(e){var t;t=function(){function t(e){var t,r,n,a,i,s,o,c,l,u,f,$,p,d,h;for(this.data=e,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},s=null;;){switch(t=this.readUInt32(),u=function(){var e,t;for(t=[],o=e=0;e<4;o=++e)t.push(String.fromCharCode(this.data[this.pos++]));return t}.call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(t);break;case"fcTL":s&&this.animation.frames.push(s),this.pos+=4,s={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},i=this.readUInt16(),a=this.readUInt16()||100,s.delay=1e3*i/a,s.disposeOp=this.data[this.pos++],
s.blendOp=this.data[this.pos++],s.data=[];break;case"IDAT":case"fdAT":for("fdAT"===u&&(this.pos+=4,t-=4),e=(null!=s?s.data:void 0)||this.imgData,o=p=0;0<=t?p<t:p>t;o=0<=t?++p:--p)e.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(n=this.palette.length/3,this.transparency.indexed=this.read(t),this.transparency.indexed.length>n)throw new Error("More transparent colors than palette size");if((f=n-this.transparency.indexed.length)>0)for(o=d=0;0<=f?d<f:d>f;o=0<=f?++d:--d)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(t)[0];break;case 2:this.transparency.rgb=this.read(t)}break;case"tEXt":$=this.read(t),c=$.indexOf(0),l=String.fromCharCode.apply(String,$.slice(0,c)),this.text[l]=String.fromCharCode.apply(String,$.slice(c+1));break;case"IEND":return s&&this.animation.frames.push(s),this.colors=function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}.call(this),this.hasAlphaChannel=4===(h=this.colorType)||6===h,r=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*r,this.colorSpace=function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}.call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=t}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}var r,n,a,i,s,o;t.load=function(e,r,n){var a;return"function"==typeof r&&(n=r),a=new XMLHttpRequest,a.open("GET",e,!0),a.responseType="arraybuffer",a.onload=function(){var e,i;return e=new Uint8Array(a.response||a.mozResponseArrayBuffer),i=new t(e),"function"==typeof(null!=r?r.getContext:void 0)&&i.render(r),"function"==typeof n?n(i):void 0},a.send(null)},n=1,a=2,r=0,t.prototype.read=function(e){var t,r;for(r=[],t=0;0<=e?t<e:t>e;0<=e?++t:--t)r.push(this.data[this.pos++]);return r},t.prototype.readUInt32=function(){var e,t,r,n;return e=this.data[this.pos++]<<24,t=this.data[this.pos++]<<16,r=this.data[this.pos++]<<8,n=this.data[this.pos++],e|t|r|n},t.prototype.readUInt16=function(){var e,t;return e=this.data[this.pos++]<<8,t=this.data[this.pos++],e|t},t.prototype.decodePixels=function(e){function t(t,s,o,c){var l,u,f,$,p,d,h,_,m,y,g,v,b,x,w,A,k,E,S,N,C,I=Math.ceil((i.width-t)/o),O=Math.ceil((i.height-s)/c),L=i.width==I&&i.height==O;for(x=r*I,v=L?n:new Uint8Array(x*O),d=e.length,b=0,u=0;b<O&&a<d;){switch(e[a++]){case 0:for($=k=0;k<x;$=k+=1)v[u++]=e[a++];break;case 1:for($=E=0;E<x;$=E+=1)l=e[a++],p=$<r?0:v[u-r],v[u++]=(l+p)%256;break;case 2:for($=S=0;S<x;$=S+=1)l=e[a++],f=($-$%r)/r,w=b&&v[(b-1)*x+f*r+$%r],v[u++]=(w+l)%256;break;case 3:for($=N=0;N<x;$=N+=1)l=e[a++],f=($-$%r)/r,p=$<r?0:v[u-r],w=b&&v[(b-1)*x+f*r+$%r],v[u++]=(l+Math.floor((p+w)/2))%256;break;case 4:for($=C=0;C<x;$=C+=1)l=e[a++],f=($-$%r)/r,p=$<r?0:v[u-r],0===b?w=A=0:(w=v[(b-1)*x+f*r+$%r],A=f&&v[(b-1)*x+(f-1)*r+$%r]),h=p+w-A,_=Math.abs(h-p),y=Math.abs(h-w),g=Math.abs(h-A),m=_<=y&&_<=g?p:y<=g?w:A,v[u++]=(l+m)%256;break;default:throw new Error("Invalid filter algorithm: "+e[a-1])}if(!L){var P=((s+b*c)*i.width+t)*r,M=b*x;for($=0;$<I;$+=1){for(var T=0;T<r;T+=1)n[P++]=v[M++];P+=(o-1)*r}}b++}}var r=this.pixelBitlength/8,n=new Uint8Array(this.width*this.height*r),a=0,i=this;return null==e&&(e=this.imgData),0===e.length?new Uint8Array(0):(e=new u(e),e=e.getBytes(),1==i.interlaceMethod?(t(0,0,8,8),t(4,0,8,8),t(0,4,4,8),t(2,0,4,4),t(0,2,2,4),t(1,0,2,2),t(0,1,1,2)):t(0,0,1,1),n)},t.prototype.decodePalette=function(){var e,t,r,n,a,i,s,o,c;for(r=this.palette,i=this.transparency.indexed||[],a=new Uint8Array((i.length||0)+r.length),n=0,r.length,e=0,t=s=0,o=r.length;s<o;t=s+=3)a[n++]=r[t],a[n++]=r[t+1],a[n++]=r[t+2],a[n++]=null!=(c=i[e++])?c:255;return a},t.prototype.copyToImageData=function(e,t){var r,n,a,i,s,o,c,l,u,f,$;if(n=this.colors,u=null,r=this.hasAlphaChannel,this.palette.length&&(u=null!=($=this._decodedPalette)?$:this._decodedPalette=this.decodePalette(),n=4,r=!0),a=e.data||e,l=a.length,s=u||t,i=o=0,1===n)for(;i<l;)c=u?4*t[i/4]:o,f=s[c++],a[i++]=f,a[i++]=f,a[i++]=f,a[i++]=r?s[c++]:255,o=c;else for(;i<l;)c=u?4*t[i/4]:o,a[i++]=s[c++],a[i++]=s[c++],a[i++]=s[c++],a[i++]=r?s[c++]:255,o=c},t.prototype.decode=function(){var e;return e=new Uint8Array(this.width*this.height*4),this.copyToImageData(e,this.decodePixels()),e};try{s=e.document.createElement("canvas"),o=s.getContext("2d")}catch(e){return-1}return i=function(e){var t;return o.width=e.width,o.height=e.height,o.clearRect(0,0,e.width,e.height),o.putImageData(e,0,0),t=new Image,t.src=s.toDataURL(),t},t.prototype.decodeFrames=function(e){var t,r,n,a,s,o,c,l;if(this.animation){for(c=this.animation.frames,l=[],r=s=0,o=c.length;s<o;r=++s)t=c[r],n=e.createImageData(t.width,t.height),a=this.decodePixels(new Uint8Array(t.data)),this.copyToImageData(n,a),t.imageData=n,l.push(t.image=i(n));return l}},t.prototype.renderFrame=function(e,t){var i,s,o;return s=this.animation.frames,i=s[t],o=s[t-1],0===t&&e.clearRect(0,0,this.width,this.height),(null!=o?o.disposeOp:void 0)===n?e.clearRect(o.xOffset,o.yOffset,o.width,o.height):(null!=o?o.disposeOp:void 0)===a&&e.putImageData(o.imageData,o.xOffset,o.yOffset),i.blendOp===r&&e.clearRect(i.xOffset,i.yOffset,i.width,i.height),e.drawImage(i.image,i.xOffset,i.yOffset)},t.prototype.animate=function(e){var t,r,n,a,i,s,o=this;return r=0,s=this.animation,a=s.numFrames,n=s.frames,i=s.numPlays,(t=function(){var s,c;if(s=r++%a,c=n[s],o.renderFrame(e,s),a>1&&r/a<i)return o.animation._timeout=setTimeout(t,c.delay)})()},t.prototype.stopAnimation=function(){var e;return clearTimeout(null!=(e=this.animation)?e._timeout:void 0)},t.prototype.render=function(e){var t,r;return e._png&&e._png.stopAnimation(),e._png=this,e.width=this.width,e.height=this.height,t=e.getContext("2d"),this.animation?(this.decodeFrames(t),this.animate(t)):(r=t.createImageData(this.width,this.height),this.copyToImageData(r,this.decodePixels()),t.putImageData(r,0,0))},t}(),e.PNG=t}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||"undefined"!=typeof global&&global||Function('return typeof this === "object" && this.content')()||Function("return this")());var l=function(){function e(){this.pos=0,this.bufferLength=0,this.eof=!1,this.buffer=null}return e.prototype={ensureBuffer:function(e){var t=this.buffer,r=t?t.byteLength:0;if(e<r)return t;for(var n=512;n<e;)n<<=1;for(var a=new Uint8Array(n),i=0;i<r;++i)a[i]=t[i];return this.buffer=a},getByte:function(){for(var e=this.pos;this.bufferLength<=e;){if(this.eof)return null;this.readBlock()}return this.buffer[this.pos++]},getBytes:function(e){var t=this.pos;if(e){this.ensureBuffer(t+e);for(var r=t+e;!this.eof&&this.bufferLength<r;)this.readBlock();var n=this.bufferLength;r>n&&(r=n)}else{for(;!this.eof;)this.readBlock();var r=this.bufferLength}return this.pos=r,this.buffer.subarray(t,r)},lookChar:function(){for(var e=this.pos;this.bufferLength<=e;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos])},getChar:function(){for(var e=this.pos;this.bufferLength<=e;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos++])},makeSubStream:function(e,t,r){for(var n=e+t;this.bufferLength<=n&&!this.eof;)this.readBlock();return new Stream(this.buffer,e,t,r)},skip:function(e){e||(e=1),this.pos+=e},reset:function(){this.pos=0}},e}(),u=function(){function e(e){throw new Error(e)}function t(t){var r=0,n=t[r++],a=t[r++];-1!=n&&-1!=a||e("Invalid header in flate stream"),8!=(15&n)&&e("Unknown compression method in flate stream"),((n<<8)+a)%31!=0&&e("Bad FCHECK in flate stream"),32&a&&e("FDICT bit set in flate stream"),this.bytes=t,this.bytesPos=r,this.codeSize=0,this.codeBuf=0,l.call(this)}if("undefined"!=typeof Uint32Array){var r=new Uint32Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),n=new Uint32Array([3,4,5,6,7,8,9,10,65547,65549,65551,65553,131091,131095,131099,131103,196643,196651,196659,196667,262211,262227,262243,262259,327811,327843,327875,327907,258,258,258]),a=new Uint32Array([1,2,3,4,65541,65543,131081,131085,196625,196633,262177,262193,327745,327777,393345,393409,459009,459137,524801,525057,590849,591361,657409,658433,724993,727041,794625,798721,868353,876545]),i=[new Uint32Array([459008,524368,524304,524568,459024,524400,524336,590016,459016,524384,524320,589984,524288,524416,524352,590048,459012,524376,524312,589968,459028,524408,524344,590032,459020,524392,524328,59e4,524296,524424,524360,590064,459010,524372,524308,524572,459026,524404,524340,590024,459018,524388,524324,589992,524292,524420,524356,590056,459014,524380,524316,589976,459030,524412,524348,590040,459022,524396,524332,590008,524300,524428,524364,590072,459009,524370,524306,524570,459025,524402,524338,590020,459017,524386,524322,589988,524290,524418,524354,590052,459013,524378,524314,589972,459029,524410,524346,590036,459021,524394,524330,590004,524298,524426,524362,590068,459011,524374,524310,524574,459027,524406,524342,590028,459019,524390,524326,589996,524294,524422,524358,590060,459015,524382,524318,589980,459031,524414,524350,590044,459023,524398,524334,590012,524302,524430,524366,590076,459008,524369,524305,524569,459024,524401,524337,590018,459016,524385,524321,589986,524289,524417,524353,590050,459012,524377,524313,589970,459028,524409,524345,590034,459020,524393,524329,590002,524297,524425,524361,590066,459010,524373,524309,524573,459026,524405,524341,590026,459018,524389,524325,589994,524293,524421,524357,590058,459014,524381,524317,589978,459030,524413,524349,590042,459022,524397,524333,590010,524301,524429,524365,590074,459009,524371,524307,524571,459025,524403,524339,590022,459017,524387,524323,589990,524291,524419,524355,590054,459013,524379,524315,589974,459029,524411,524347,590038,459021,524395,524331,590006,524299,524427,524363,590070,459011,524375,524311,524575,459027,524407,524343,590030,459019,524391,524327,589998,524295,524423,524359,590062,459015,524383,524319,589982,459031,524415,524351,590046,459023,524399,524335,590014,524303,524431,524367,590078,459008,524368,524304,524568,459024,524400,524336,590017,459016,524384,524320,589985,524288,524416,524352,590049,459012,524376,524312,589969,459028,524408,524344,590033,459020,524392,524328,590001,524296,524424,524360,590065,459010,524372,524308,524572,459026,524404,524340,590025,459018,524388,524324,589993,524292,524420,524356,590057,459014,524380,524316,589977,459030,524412,524348,590041,459022,524396,524332,590009,524300,524428,524364,590073,459009,524370,524306,524570,459025,524402,524338,590021,459017,524386,524322,589989,524290,524418,524354,590053,459013,524378,524314,589973,459029,524410,524346,590037,459021,524394,524330,590005,524298,524426,524362,590069,459011,524374,524310,524574,459027,524406,524342,590029,459019,524390,524326,589997,524294,524422,524358,590061,459015,524382,524318,589981,459031,524414,524350,590045,459023,524398,524334,590013,524302,524430,524366,590077,459008,524369,524305,524569,459024,524401,524337,590019,459016,524385,524321,589987,524289,524417,524353,590051,459012,524377,524313,589971,459028,524409,524345,590035,459020,524393,524329,590003,524297,524425,524361,590067,459010,524373,524309,524573,459026,524405,524341,590027,459018,524389,524325,589995,524293,524421,524357,590059,459014,524381,524317,589979,459030,524413,524349,590043,459022,524397,524333,590011,524301,524429,524365,590075,459009,524371,524307,524571,459025,524403,524339,590023,459017,524387,524323,589991,524291,524419,524355,590055,459013,524379,524315,589975,459029,524411,524347,590039,459021,524395,524331,590007,524299,524427,524363,590071,459011,524375,524311,524575,459027,524407,524343,590031,459019,524391,524327,589999,524295,524423,524359,590063,459015,524383,524319,589983,459031,524415,524351,590047,459023,524399,524335,590015,524303,524431,524367,590079]),9],s=[new Uint32Array([327680,327696,327688,327704,327684,327700,327692,327708,327682,327698,327690,327706,327686,327702,327694,0,327681,327697,327689,327705,327685,327701,327693,327709,327683,327699,327691,327707,327687,327703,327695,0]),5];return t.prototype=Object.create(l.prototype),t.prototype.getBits=function(t){for(var r,n=this.codeSize,a=this.codeBuf,i=this.bytes,s=this.bytesPos;n<t;)void 0===(r=i[s++])&&e("Bad encoding in flate stream"),a|=r<<n,n+=8;return r=a&(1<<t)-1,this.codeBuf=a>>t,this.codeSize=n-=t,this.bytesPos=s,r},t.prototype.getCode=function(t){for(var r=t[0],n=t[1],a=this.codeSize,i=this.codeBuf,s=this.bytes,o=this.bytesPos;a<n;){var c;void 0===(c=s[o++])&&e("Bad encoding in flate stream"),i|=c<<a,a+=8}var l=r[i&(1<<n)-1],u=l>>16,f=65535&l;return(0==a||a<u||0==u)&&e("Bad encoding in flate stream"),this.codeBuf=i>>u,this.codeSize=a-u,this.bytesPos=o,f},t.prototype.generateHuffmanTable=function(e){for(var t=e.length,r=0,n=0;n<t;++n)e[n]>r&&(r=e[n]);for(var a=1<<r,i=new Uint32Array(a),s=1,o=0,c=2;s<=r;++s,o<<=1,c<<=1)for(var l=0;l<t;++l)if(e[l]==s){for(var u=0,f=o,n=0;n<s;++n)u=u<<1|1&f,f>>=1;for(var n=u;n<a;n+=c)i[n]=s<<16|l;++o}return[i,r]},t.prototype.readBlock=function(){function t(e,t,r,n,a){for(var i=e.getBits(r)+n;i-- >0;)t[w++]=a}var o=this.getBits(3);if(1&o&&(this.eof=!0),0==(o>>=1)){var c,l=this.bytes,u=this.bytesPos;void 0===(c=l[u++])&&e("Bad block header in flate stream");var f=c;void 0===(c=l[u++])&&e("Bad block header in flate stream"),f|=c<<8,void 0===(c=l[u++])&&e("Bad block header in flate stream");var $=c;void 0===(c=l[u++])&&e("Bad block header in flate stream"),$|=c<<8,$!=(65535&~f)&&e("Bad uncompressed block length in flate stream"),this.codeBuf=0,this.codeSize=0;var p=this.bufferLength,d=this.ensureBuffer(p+f),h=p+f;this.bufferLength=h;for(var _=p;_<h;++_){if(void 0===(c=l[u++])){this.eof=!0;break}d[_]=c}return void(this.bytesPos=u)}var m,y;if(1==o)m=i,y=s;else if(2==o){for(var g=this.getBits(5)+257,v=this.getBits(5)+1,b=this.getBits(4)+4,x=Array(r.length),w=0;w<b;)x[r[w++]]=this.getBits(3);for(var A=this.generateHuffmanTable(x),k=0,w=0,E=g+v,S=new Array(E);w<E;){var N=this.getCode(A);16==N?t(this,S,2,3,k):17==N?t(this,S,3,3,k=0):18==N?t(this,S,7,11,k=0):S[w++]=k=N}m=this.generateHuffmanTable(S.slice(0,g)),y=this.generateHuffmanTable(S.slice(g,E))}else e("Unknown block type in flate stream");for(var d=this.buffer,C=d?d.length:0,I=this.bufferLength;;){var O=this.getCode(m);if(O<256)I+1>=C&&(d=this.ensureBuffer(I+1),C=d.length),d[I++]=O;else{if(256==O)return void(this.bufferLength=I);O-=257,O=n[O];var L=O>>16;L>0&&(L=this.getBits(L));var k=(65535&O)+L;O=this.getCode(y),O=a[O],L=O>>16,L>0&&(L=this.getBits(L));var P=(65535&O)+L;I+k>=C&&(d=this.ensureBuffer(I+k),C=d.length);for(var M=0;M<k;++M,++I)d[I]=d[I-P]}}},t}}();window.tmp=u,r.default=c;var f=r.default;r.rewire=s,r.restore=o,t.exports=c},{}]},{},[86]);
>>>>>>> first  compliation with opal 1.0
